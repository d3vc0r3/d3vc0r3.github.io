

<!DOCTYPE html>
<html class="no-js sub-menu">

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta charset="utf-8" />
    <link href="/images/favicon.png" rel="icon" size="32x32">
    <!-- web fullscreen -->
    <meta name="apple-mobile-web-app-capable" content="yes"><!-- ios -->
    <meta name="mobile-web-app-capable" content="yes"><!-- android -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0,user-scalable=0" />
    <meta name="format-detection" content="telephone=no">
    <title>Your NAS is not your NAS ! | DEVCORE 戴夫寇爾</title>
    <link rel="stylesheet" href="/css/style.css" />
    <script src="/js/modernizr-custom.js"></script>
    <script src="/js/jquery-3.6.0.min.js"></script>
    <script src="/js/site.js"></script>
    <meta name="description" property="og:description" content="我們已成功在 NAS 中找到一個嚴重漏洞，並且成功寫出概念證明程式，證實可以利用在 Synology、QNAP 及 Asustor 等主流 NAS 上利用。我們也認為 Netatalk 是在 NAS 中新一代的後門!" />
    <meta name="keywords" content="RCE, Netatalk, Synology, QNAP, Asustor" />
    <meta property="og:site_name" content="DEVCORE 戴夫寇爾" />
    <meta property="og:title" content="Your NAS is not your NAS ! | DEVCORE 戴夫寇爾" />
    <meta property="og:url" content="https://devco.re/blog/2022/03/28/your-NAS-is-not-your-NAS/" />
    <meta property="og:type" content="website" />
    <meta property="og:image" content="https://devco.re/assets/img/blog/20220328/cover.png" />
    <meta name="twitter:card" content="summary">
    <meta name="twitter:site" content="d3vc0r3">
    <meta name="twitter:title" content="Your NAS is not your NAS ! | DEVCORE 戴夫寇爾">
    <meta name="twitter:description" content="我們已成功在 NAS 中找到一個嚴重漏洞，並且成功寫出概念證明程式，證實可以利用在 Synology、QNAP 及 Asustor 等主流 NAS 上利用。我們也認為 Netatalk 是在 NAS 中新一代的後門!">
    <meta name="twitter:creator" content="d3vc0r3">
    <meta name="twitter:image:src" content="https://devco.re/assets/img/blog/20220328/cover.png">
    <meta name="twitter:domain" content="devco.re">
    <meta name="google-site-verification" content="lMNi_XT6UmeGqeYI_vLHu5PDRi_uNVfnA2NdDGS4-lM" />
    <meta name="msvalidate.01" content="119FDBB7730BE45B162515BBB1FF6B33" />
    <meta name="alexaVerifyID" content="j-Es9N9SD7ckfA2EokOz9SZzhok" />
    <meta name='yandex-verification' content='4561963cf1d18fe3' />
    <meta property="fb:admins" content="120968921404653" />

    <link rel="canonical" href="https://devco.re/blog/2022/03/28/your-NAS-is-not-your-NAS/"/>
    <link rel="alternate" type="application/rss+xml" title="DEVCORE 戴夫寇爾" href="https://devco.re/rss">

    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-GHXJ9PS005"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-GHXJ9PS005');
    </script>
    <link rel="stylesheet" href="/fonts/inter.css" />
    <link rel="stylesheet" href="/css/highlighter.css" />
    <!-- <script src="https://cdn.jsdelivr.net/gh/google/code-prettify@master/loader/run_prettify.js"></script> -->
</head>
<body>
    <!-- 導覽列 start -->
    <header class="header">
<div class="container">
    <!-- logo start -->
    <div class="logo">
        <a href="/">
            <img src="/images/logo.svg"/>
        </a>
    </div>
    <!-- logo end -->
    <!-- 主選單 start -->
    <nav class="nav">
        <ul class="menu">
            <li class="dropdown">
                <div class="menuLable">
                    <span>服務<i class="icon arrow_down"></i></span>

                    <div class="menuItem">
                        <a href="/services/red-team/">
                            <div class="item">

                                <h2>
                                    <i class="icon menu service-red-team"></i>
                                    紅隊演練
                                </h2>
                                <p class="two-line">
                                    在不影響企業營運前提下，無所不用其極，從各種進入點執行模擬入侵攻擊，達成企業指定的演練情境。
                                </p>
                            </div>
                        </a>
                        <a href="/services/penetration-test/">
                            <div class="item">
                                <h2>
                                    <i class="icon menu service-penetration-test"></i>
                                    滲透測試
                                </h2>
                                <p class="two-line">
                                    以駭客思維及手法嘗試入侵企業指定系統，找出潛在漏洞，驗證企業資料與設備是否可被竊取或破壞。
                                </p>
                            </div>
                        </a>
                        <a href="/services/security-consulting/">
                            <div class="item">
                                <h2>
                                    <i class="icon menu service-security-consulting"></i>
                                    資安顧問服務
                                </h2>
                                <p class="two-line">
                                    以紅隊演練為基礎，提供攻擊者視角與可能入侵路徑，協助企業評估資安資源優先順序，並擬定長期防禦策略。
                                </p>
                            </div>
                        </a>
                        <a href="/services/security-training/">
                            <div class="item">
                                <h2>
                                    <i class="icon menu service-security-training"></i>
                                    資安教育訓練
                                </h2>
                                <p class="two-line">
                                    從攻擊思維出發，協助企業有效預防資安事故並防禦；以及事件發生時，如何快速判定攻擊目的、手法、漏洞與及應變方式。
                                </p>
                            </div>
                        </a>

                    </div>
                </div>
            </li>

            <li class="dropdown">
                <div class="menuLable">
                    <span>研究<i class="icon arrow_down"></i></span>

                    <div class="menuItem">
                        <a href="/research/overview/">
                            <div class="item">
                                <h2>
                                    <i class="icon menu search-circle"></i>
                                    總覽概要
                                </h2>
                                <p class="two-line">
                                    持續精研資安最新技術及漏洞研究趨勢，全方位檢測企業產品安全性、吸取經驗並轉化為紅隊演練工具與手法。
                                </p>
                            </div>
                        </a>
                        <a href="/research/awards/">
                            <div class="item">
                                <h2>
                                    <i class="icon menu badge-check"></i>
                                    競賽與獎項
                                </h2>
                                <p class="two-line">
                                    國際級資訊安全競賽獎項肯定。
                                </p>
                            </div>
                        </a>
                        <a href="/research/bug-bounty/">
                            <div class="item">
                                <h2>
                                    <i class="icon menu puzzle"></i>
                                    企業漏洞回報
                                </h2>
                                <p class="two-line">
                                    研究企業系統中的資安風險及各種可能的突破口，並通報企業修補。
                                </p>
                            </div>
                        </a>
                        <a href="/research/talks/">
                            <div class="item">
                                <h2>
                                    <i class="icon menu globe"></i>
                                    國際研討會
                                </h2>
                                <p class="two-line">
                                    參與全球資安盛會，發表、交流漏洞的知識與資訊。
                                </p>
                            </div>
                        </a>
                        <a href="/research/cve/">
                            <div class="item">
                                <h2>
                                    <i class="icon menu view-list"></i>
                                    CVE 漏洞列表
                                </h2>
                                <p class="two-line">
                                    挖掘並回報國際知名產品與服務的重大漏洞。
                                </p>
                            </div>
                        </a>
                    </div>
                </div>


            </li>

            <li class="dropdown">
                <div class="menuLable" href="#">
                    <span>公司<i class="icon arrow_down"></i></span>

                    <div class="menuItem">
                        <a href="/company/about/">
                        <div class="item">
                            <h2>
                                <i class="icon menu company"></i>
                                公司簡介
                            </h2>
                            <p>
                                DEVCORE 戴夫寇爾由世界級白帽駭客團隊創立，提供紅隊演練、滲透測試、資安顧問服務、資安教育訓練等服務。
                            </p>
                        </div>
                        </a>
                        <a href="/company/our-team/">
                            <div class="item">
                                <h2>
                                    <i class="icon menu team"></i>
                                    團隊成員
                                </h2>
                                <p class="two-line">
                                    由熱衷挑戰、具備駭客思維的資安專家組成，專注於創新攻擊手法研究，並以「高道德、高自律、高嚴謹」為最高指導原則。
                                </p>
                            </div>
                        </a>
                        <a href="/company/history/">
                            <div class="item">
                                <h2>
                                    <i class="icon menu milestone"></i>
                                    成就與沿革
                                </h2>
                                <p class="two-line">
                                    長期聚焦於攻擊研究，屢屢獲邀參與全球知名資安研討會，已揭露數百個重要產品漏洞、協助企業提升防禦能量。
                                </p>
                            </div>
                        </a>
                        <a href="/company/csr/">
                            <div class="item">
                                <h2>
                                    <i class="icon menu heart"></i>
                                    企業社會責任
                                </h2>
                                <p class="two-line">
                                    提供多元實習管道和研習計畫，提升新世代人才資安能量，推廣資訊安全意識。
                                </p>
                            </div>
                        </a>
                        <a href="/company/jobs/">
                            <div class="item">
                                <h2>
                                    <i class="icon menu briefcase"></i>
                                    工作機會
                                </h2>
                                <p class="two-line">
                                    加入 DEVCORE，共同改善資安產業結構，與我們一起打造更安全的世界。
                                </p>
                            </div>
                        </a>
                    </div>
                </div>
            </li>
            <li class="dropdown">
                <div class="menuLable">
                    <span>新聞<i class="icon arrow_down"></i></span>
                    <div class="menuItem">
                        <a href="/blog/">
                            <div class="item">
                                <h2>
                                    <i class="icon menu newspaper"></i>
                                    BLOG
                                </h2>
                                <p>
                                    DEVCORE 最新消息。
                                </p>
                            </div>
                        </a>
                        <a href="/media-kit/">
                            <div class="item">
                                <h2>
                                    <i class="icon menu download"></i>
                                    媒體素材下載
                                </h2>
                                <p>
                                    使用 DEVCORE 商標須遵循的使用規範。
                                </p>
                            </div>
                        </a>
                    </div>
                </div>
            </li>
            <li>
                <a class="menuLable" href="/search/">搜尋</a>
            </li>
            <li>
                <a class="menuLable" href="/contact/">聯絡我們</a>
            </li>
        </ul>
    </nav>
    <!-- 主選單 end -->
</div>


<!-- 手機板選單  start-->
<nav class="nav-m" id="menu-m">
    <ul class="menu">
        <li>
            <div class="menuLable">
                <span>服務</span>
                <div class="menuItem">
                    <a href="/services/red-team/" class="fullwidth">
                        <div class="item">
                            <h2>
                                <i class="icon service-red-team"></i>
                                紅隊演練
                            </h2>
                        </div>
                    </a>
                    <a href="/services/penetration-test/" class="fullwidth">
                        <div class="item">
                            <h2>
                                <i class="icon service-penetration-test"></i>
                                滲透測試
                            </h2>
                        </div>
                    </a>
                    <a href="/services/security-consulting/" class="fullwidth">
                        <div class="item">
                            <h2>
                                <i class="icon service-security-consulting"></i>
                                顧問服務
                            </h2>
                        </div>
                    </a>
                    <a href="/services/security-training/" class="fullwidth">
                        <div class="item">
                            <h2>
                                <i class="icon service-security-training"></i>
                                教育訓練
                            </h2>
                        </div>
                    </a>
                </div>
            </div>
        </li>
        <li>
            <div class="menuLable">
                <span>資安研究</span>
                <div class="menuItem">
                    <a href="/research/overview/" class="fullwidth">
                        <div class="item">
                            <h2>總覽概要</h2>
                        </div>
                    </a>
                    <a href="/research/awards/">
                        <div class="item">
                            <h2>競賽與獎項</h2>
                        </div>
                    </a>
                    <a href="/research/bug-bounty/">
                        <div class="item">
                            <h2>Bug Bounty</h2>
                        </div>
                    </a>
                    <a href="/research/talks/">
                        <div class="item">
                            <h2>國際研討會</h2>
                        </div>
                    </a>
                    <a href="/research/cve/">
                        <div class="item">
                            <h2>CVE 漏洞列表</h2>
                        </div>
                    </a>
                </div>
            </div>
        </li>

        <li>
            <div class="menuLable">
                <span>公司</span>
                <div class="menuItem">
                    <a href="/company/about/" class="fullwidth">
                        <div class="item">
                            <h2>公司簡介</h2>
                        </div>
                    </a>
                    <a href="/company/our-team/">
                        <div class="item">
                            <h2>團隊成員</h2>
                        </div>
                    </a>
                    <a href="/company/history/">
                        <div class="item">
                            <h2>成就與沿革</h2>
                        </div>
                    </a>
                    <a href="/company/csr/">
                        <div class="item">
                            <h2>企業社會責任</h2>
                        </div>
                    </a>
                    <a href="/company/jobs/">
                        <div class="item">
                            <h2>工作機會</h2>
                        </div>
                    </a>
                </div>
            </div>
        </li>
        <li>
            <div class="menuLable">
                <span>新聞</span>
                <div class="menuItem">
                    <!-- <a href="/blog/">
                    <div class="item">
                        <h2>所有文章</h2>
                    </div>
                    </a> -->
                    <!-- <a href="">
                        <div class="item">
                            <h2>案例剖析</h2>
                        </div>
                    </a> -->
                    <!-- <a href="">
                        <div class="item">
                            <h2>科普文章</h2>
                        </div>
                    </a>
                    <a href="">
                        <div class="item">
                            <h2>技術專欄</h2>
                        </div>
                    </a>
                    <a href="">
                        <div class="item">
                            <h2>資安新聞</h2>
                        </div>
                    </a> -->
                    <a href="/blog/">
                        <div class="item">
                            <h2>BLOG</h2>
                        </div>
                    </a>
                    <a href="/media-kit/">
                        <div class="item">
                            <h2>媒體素材下載</h2>
                        </div>
                    </a>
                </div>
            </div>
        </li>
        <li>
            <div class="menuLable">
                <div class="menuItem">
                    <a href="/search/" class="fullwidth">
                        <div class="item">
                            <h2 class="center">
                                <i class="icon search"></i>
                                搜尋
                            </h2>
                        </div>
                    </a>
                    <a href="/contact/" class="fullwidth">
                        <div class="item">
                            <h2 class="center">
                                <i class="icon chat-alt"></i>
                                聯絡我們
                            </h2>
                        </div>
                    </a>
                </div>
            </div>
        </li>
        <li>
            <div class="menuLable">
                <span><i class="icon translate"></i>Language</span>
                <div class="menuItem">
                    <a href="/">
                    <div class="item">
                        <h2>中文</h2>
                    </div>
                    </a>
                    <a href="/en">
                        <div class="item">
                            <h2>English</h2>
                        </div>
                    </a>
                </div>
            </div>
        </li>
    </ul>
</nav>
<!-- 手機板選單  end-->
    </header>
    <!-- 導覽列 end -->

    <!-- tab 選單 start -->
    <div class="sub-nav">
        <div class="container">
            <h1>BLOG</h1>
            <ul class="tab">
                <li>
                    <a href="/blog/">所有文章</a>
                </li>
                <li>
                    <a href="/blog/category/最新消息/">最新消息</a>
                </li>
                <li>
                    <a href="/blog/category/技術專欄/">技術專欄</a>
                </li>
                <li>
                    <a href="/blog/category/科普文章/">科普文章</a>
                </li>
                <li>
                    <a href="/blog/category/資安新聞/">資安新聞</a>
                </li>
                <li>
                    <a href="/media-kit/">媒體素材下載</a>
                </li>
            </ul>
        </div>
    </div>
    <!-- tab 選單 end -->
    
    <div class="main">
        <!-- 文章外層layer -->
        <section class="narrow">
            <!-- 文章 start -->
            <article class="article_body">
                <div class="content">
                    <a class="category" href="/blog/category/技術專欄">技術專欄</a>
                    <span class="tag">

                      <a href="/blog/tag/RCE/">#RCE</a> <a href="/blog/tag/NAS/">#NAS</a> <a href="/blog/tag/IoT/">#IoT</a> 
                    </span>
                    <h1>
                        Your NAS is not your NAS !
                    </h1>
                    
                    
                    <div class="author_detail">
                        <span class="avatar">
                            <a href="/blog/author/angelboy">
                                <div class="circle">
                                    <i class="user" style="background-image: url('/assets/img/avatar/orig/angelboy.png');" ></i>
                                </div>
                            </a>
                        </span>
                        <span class="author"><a href="/blog/author/angelboy">Angelboy</a></span>
                        <span class="date">2022-03-28</span>
                    </div>
                    
                    
                    <div class="article_img">
                        <img src="https://devco.re/assets/img/blog/20220328/cover.png"/>
                    </div>
                    

                    <hr>

                    <!-- 文章內容 -->
                    <div class="article_content">
<p><a href="/blog/2022/03/28/your-NAS-is-not-your-NAS-en/">English Version</a>
<a href="/blog/2022/03/28/your-NAS-is-not-your-NAS/">中文版本</a></p>

<p>前年我們在 Synology 的 NAS 中發現了 <a href="https://www.zerodayinitiative.com/advisories/ZDI-21-492/">Pre-auth RCE 的漏洞(CVE-2021-31439)</a>，並在 Pwn2Own Tokyo 中取得了 Synology DS418 play 的控制權，而成功獲得 Pwn2Own 的點數，後續也發現這個漏洞不只存在 Synology 的 NAS，也同時存在多數廠牌的 NAS 中，這篇研究將講述這漏洞的細節及我們的利用方式。</p>

<p>此份研究亦發表於 <a href="https://hitcon.org/2021/">HITCON 2021</a>，你可以從<a href="https://hitcon.org/2021/agenda/03f06675-261d-4c97-b524-33ef9cc6ccb2/%E4%BD%A0%E7%9A%84%20NAS%20%E4%B8%8D%E6%98%AF%E4%BD%A0%E7%9A%84%20NAS%20!.pdf">這裡</a>取得投影片！</p>

<h2 id="network-attached-storage">Network Attached Storage</h2>

<p>早期 NAS 一般用途為讓伺服器本身與資料分開也為了做異地備援而使用的設備，功能上主要單純讓使用者可以直接在網路上存取資料及分享檔案，現今的 NAS 更是提供多種服務，不止檔案分享更加方便，也與 IoT 的環境更加密切，例如 SMB/AFP 等服務，可輕易的讓不同系統的電腦分享檔案，普及率也遠比以前高很多。</p>

<p>現今的 NAS，也可裝上許多套件，更是有不少人拿來架設 Server，在這智慧家庭的年代中，更是會有不少人與 home assistant 結合，使得生活更加便利。</p>

<p><img src="/assets/img/blog/20220328/1.png" alt="" /></p>

<h2 id="motivation">Motivation</h2>

<h3 id="為何我們要去研究-nas-呢-">為何我們要去研究 NAS 呢 ?</h3>

<h4 id="紅隊需求">紅隊需求</h4>
<p>過去在我們團隊在執行紅隊過程中，NAS 普遍會出現在企業的內網中，有時更會暴露在外網，有時更會存放不少企業的機密資料在 NAS 上，因此 NAS 漸漸被我們關注，戰略價值也比以往高很多。</p>

<h4 id="勒索病毒">勒索病毒</h4>
<p>近年來因為 NAS 日益普及，常被拿來放個人的重要資料，使 NAS 成為了勒索病毒的目標，通常駭客組織都會利用漏洞入侵 NAS 後，將存放在 NAS 中的檔案都加密後勒索，而今年年初才又爆發一波 locker 系列的事件，我們希望可以減少類似的事情再次發生，因而提高 NAS 研究的優先程度，來增加 NAS 安全性。也為了我們實現讓世界更安全的理想。</p>

<h4 id="pwn2own-mobile-2020">Pwn2Own Mobile 2020</h4>
<p>最後一點是 NAS 從 2020 開始，成為了 Pwn2Own Mobile 的主要目標之一，又剛好前年我們也想嘗試挑戰看看 Pwn2Own 的舞台，所以決定以 NAS 作為當時研究的首要目標，前年 Pwn2Own 的目標為 Synology 及 WD ，由於 Synology 為台灣企業常見設備，所以我們最後選擇了 Synology 開始研究。</p>

<h2 id="recon">Recon</h2>

<h3 id="environment">Environment</h3>
<ul>
  <li>DS918+</li>
  <li>DSM 6.2.3-25426</li>
</ul>

<p>我們的測試環境是 DS918+ 與 Pwn2own 目標極為類似的型號，我們為了更佳符合平常會遇到的環境以及 Pwn2Own 中要求，會是全部 default setting 的狀態。</p>

<h3 id="attack-surface">Attack surface</h3>

<p><img src="/assets/img/blog/20220328/2.png" alt="" /></p>

<p>首先可先用 netstat 看 tcp 和 udp 中有哪些 port 是對外開放，可以看到 tcp 及 udp 中 在 default 環境下，就開了不少服務，像是 tcp 的 smb/nginx/afpd 等</p>

<p><img src="/assets/img/blog/20220328/3.png" alt="" /></p>

<p>而 udp 中則有 minissdpd/findhost/snmpd 等，多數都是一些用來幫助尋找設備的協定。</p>

<p>我們這邊挑了幾個 Service 做初步的分析</p>

<h4 id="dsm-web-interface">DSM Web interface</h4>
<p>首先是 DSM Web 介面，最直覺也最直接的一部分，這部分大概也會是最多人去分析的一塊，有明顯的入口點，在古老時期常有 command injection 漏洞，但後來 Synology 有嚴格規範後徹底改善這問題，程式也採用相對保守的方式開發，相對安全不少。</p>

<h4 id="smb">SMB</h4>
<p>Synology 中的 SMB 協定，使用的是 Open Source 的 <a href="https://www.samba.org/">Samba</a> ，因使用的人眾多，進行 code review 及漏洞挖掘的人也不少，使得每年會有不少小洞，近期最嚴重的就是 <a href="https://www.samba.org/samba/security/CVE-2017-7494.html">SambaCry</a>，但由於較多人在 review 安全性相對也比其他服務安全。</p>

<h4 id="iscsi-manager">iSCSI Manager</h4>
<p>主要協助使用者管理與監控 iSCSI 服務，由 Synology 自行開發，近期算比較常出現漏洞的地方，但需要花不少時間 Reverse ，不過是個不錯的目標，如果沒有其他攻擊面，可能會優先分析。</p>

<h4 id="netatalk">Netatalk</h4>
<p>最後一個要提的是 Netatalk 也就是 afp 協定，基本上沒什麼改，大部分沿用 open source 的 Netatalk，近期最嚴重的漏洞為 2018 的 Pre-auth RCE (CVE-2018-1160)，關於這漏洞可參考 <a href="https://medium.com/tenable-techblog/exploiting-an-18-year-old-bug-b47afe54172">Exploiting an 18 Year Old Bug</a> ，Netatalk 相對其他 Service 過去的漏洞少非常多，是比較少被注意到的一塊，並且已經長時間沒在更新維護。</p>

<p>我們經過整體分析後， 認為 Netatalk 也會是 Synology 中最軟的一塊，且有 <a href="http://netatalk.sourceforge.net/">Source code</a> 可以看，所以我們最後決定先分析他。當然也還有其他 service 跟攻擊面，不過這邊由於篇幅因素及並沒有花太多時間去研究就不一一分析介紹了。我們這次的重點就在於 Netatalk。</p>

<h2 id="netatalk-1">Netatalk</h2>
<p>Apple Filing Protocol (AFP) 是個類似 SMB 的檔案傳輸協定，提供 Mac 來傳輸及分享檔案，因 Apple 本身並沒有開源，為了讓 Unlx like 的系統也可以使用，於是誕生了 Netatalk，Netatalk 是個實作 Mac 的 AFP 協定的 OpenSource 專案，為了讓 Mac 可以更方便的用 NAS 來分享檔案，幾乎每一廠牌的 NAS 都會使用。</p>

<h3 id="netatalk-in-synology">Netatalk in Synology</h3>
<p>Synology 中的 netatalk 是預設開啟，版本是改自 3.1.8 的 netatalk，並且有在定期追蹤安全性更新，只要剛裝好就可以用 afp 協定來與 Synology NAS 分享檔案，而 binary 本身保護有 ASLR/NX/StackGuard。</p>

<p><img src="/assets/img/blog/20220328/4.png" alt="" /></p>

<h4 id="dsi">DSI</h4>

<p>講漏洞之前，先帶大家來看一下 netatalk 中，部分重要結構，首先是 DSI，Netatalk 在連線時是使用的 DSI (Data Stream interface) 來傳遞資訊，Server 跟 Client 都是通過 DSI 這個協定來溝通，每個 connection 的 packet 都會有 DSI 的 header 在 packet 前面</p>

<p>DSI Packet Header :</p>

<p><img src="/assets/img/blog/20220328/5.png" alt="" /></p>

<p>DSI 封包中內容大致上會如上圖所示，會有 Flag/Command 等等 metadata 以及 payload 通常就會是一個 DSI Header + payload 的結構</p>

<p>AFP over DSI :</p>

<p><img src="/assets/img/blog/20220328/6.png" alt="" /></p>

<p>afp 協定的通訊過程大概如上圖所示，使用 AFP 時，client 會先去拿 server 資訊，來確定有哪些認證的方式還有使用的版本等等資訊，這個部分可以不做，然後會去 Open Session 來，開啟新的 Session，接著就可以執行 AFP 的 command ，但在未認證之前，只可以做登入跟登出等相關操作，我們必須用 login 去驗證使用者身份，只要權限沒問題接下來就可像 SMB 一樣做檔案操作</p>

<p>在 Netatalk 實作中，會用 dsi_block 作為封包的結構</p>

<p>dsi_block :</p>

<p><img src="/assets/img/blog/20220328/7.png" alt="" /></p>

<ul>
  <li>dsi_flag 就是指該 packet 是 request or reply</li>
  <li>dsi_command 表示我們的 request 要做的事情
    <ul>
      <li>DSICloseSession</li>
      <li>DSICommand</li>
      <li>DSIGetStatus</li>
      <li>DSIOpenSession</li>
    </ul>
  </li>
  <li>dsi_code
    <ul>
      <li>Error code</li>
      <li>For reply</li>
    </ul>
  </li>
  <li>dsi_doff
    <ul>
      <li>DSI data offset</li>
      <li>Using in DSIWrite</li>
    </ul>
  </li>
  <li>dsi_len
    <ul>
      <li>The Length of Payload</li>
    </ul>
  </li>
</ul>

<p>DSI : A descriptor of dsi stream</p>

<p><img src="/assets/img/blog/20220328/8.png" alt="" /></p>

<p>在 netatalk 中，除了原始封包結構外，也會將封包及設定檔 parse 完後，將大部分的資訊，存放到另外一個名為 DSI 結構中，例如 server_quantum 及 payload 內容等，以便後續的操作。</p>

<p><img src="/assets/img/blog/20220328/9.png" alt="" /></p>

<p>而封包中的 Payload 會存放在 DSI 中 command 的 buffer 中，該 buffer 大小，取自於 server_quantum，該數值則是取自於 afp 的設定檔 afp.conf 中。</p>

<p><img src="/assets/img/blog/20220328/10.png" alt="" /></p>

<p>如果沒特別設定，則會取用 default 大小 0x100000。</p>

<p>有了初步了解後，我們可以講講漏洞。</p>

<h3 id="vulnerability">Vulnerability</h3>

<p><img src="/assets/img/blog/20220328/11.png" alt="" /></p>

<p>我們發現的漏洞就發生在，執行 dsi command 時，讀取 payload 內容發生了 overflow，此時並不需登入就可以觸發。問題函式是在 dsi_stream_receive</p>

<p><img src="/assets/img/blog/20220328/12.png" alt="" /></p>

<p>這是一個將接收到封包的資訊 parse 後放到 DSI 結構的 function，這個 function 接收封包資料時，會先根據 header 中的 <code class="language-plaintext highlighter-rouge">dsi_len</code> 來決定要讀多少資料到 command buffer 中，而一開始有驗證<code class="language-plaintext highlighter-rouge">dsi_cmdlen</code> 不可超過 server quantum 也就是 command buffer 大小。</p>

<p><img src="/assets/img/blog/20220328/13.png" alt="" /></p>

<p>然而如上圖黃匡處，如果有給 <code class="language-plaintext highlighter-rouge">dsi_doff</code> ，則會將 <code class="language-plaintext highlighter-rouge">dsi_doff</code> 作為 cmdlen 大小，但這邊卻沒去檢查是否有超過 command buffer。</p>

<p><img src="/assets/img/blog/20220328/14.png" alt="" /></p>

<p>使得 <code class="language-plaintext highlighter-rouge">dsi_strem_read</code> 以這個大小來讀取 paylaod 到 command buffer 中，此時 command buffer 大小為 0x100000，如果 <code class="language-plaintext highlighter-rouge">dsi_doff</code> 大小超過 0x100000 就會發生 heap overflow。</p>

<h3 id="exploitation">Exploitation</h3>
<p>由於是 heap overflow，所以我們這邊必須先理解 heap 上有什麼東西可以利用，在 DSM 中的 Netatalk 所使用的 Memory Allocator 是 glibc 2.20，而在 glibc 中，當 malloc 大小超過 0x20000 時，就會使用 mmap 來分配記憶體空間，而我們在 netatalk 所使用的大小則是 0x100000 超過 0x20000 因此會用 mmap 來分配我們的 command buffer。</p>

<p><img src="/assets/img/blog/20220328/15.png" alt="" /></p>

<p>因為是以 mmap 分配的關係，最後分配出來的空間則會在 Thread Local Storage 區段上面，而不是在正常的 heap segment 上，如上圖的紅框處。</p>

<p><img src="/assets/img/blog/20220328/16.png" alt="" /></p>

<p>afpd 的 memory layout 如上圖所示，上述紅框那塊就是，紅色+橘色這區段，在 command buffer 下方的是 Thread-local Storage。</p>

<h4 id="thread-local-storage">Thread-local Storage</h4>
<p>Thread-local Storage(TLS) 是用來存放 thread 的區域變數，每個 thread 都會有自己的 TLS，在 Thread 建立時就會分配，當 Thread 結束的時候就會釋放，而 main thread 的 TLS 則會在 Process 建立時就會分配，如前面圖片中的橘色區段，因此我們可利用 heap overflow 的漏洞來覆蓋掉大部分存放在 TLS 上的變數。</p>

<h4 id="target-in-tls">Target in TLS</h4>
<p>事實上來說 TLS 可控制 RIP 的變數有不少，這邊提出幾個比較常見的</p>

<ul>
  <li>第一個是 main arena，主要是 glibc 記憶體管理個結構，改 main arena 可以讓記憶體分配到任意記憶體位置，做任意寫入，但構造上比較麻煩。</li>
  <li>第二個是 pointer guard 可藉由修改 pointer guard 來改變原本呼叫的 function pointer ，但這邊需要先有 leak 跟知道原本 pointer guard 的值才能達成</li>
  <li><strong>第三個則是改 <code class="language-plaintext highlighter-rouge">tls_dtor_list</code> ，不須 leak 比較符合我們現在的狀況</strong></li>
</ul>

<h4 id="overwrite-tls_dtor_list">Overwrite <code class="language-plaintext highlighter-rouge">tls_dtor_list</code></h4>
<p>這技巧是由 project zero 在 2014 所提出的<a href="https://googleprojectzero.blogspot.com/2014/08/the-poisoned-nul-byte-2014-edition.html">方法</a>，覆蓋 TLS 上的 tls_dtor_list 來做利用，藉由覆蓋該變數可在程式結束時控制程式流程。</p>

<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">struct</span> <span class="n">dtor_list</span>
<span class="p">{</span>
    <span class="n">dtor_func</span> <span class="n">func</span><span class="p">;</span>
    <span class="kt">void</span> <span class="o">*</span><span class="n">obj</span><span class="p">;</span>
    <span class="k">struct</span> <span class="n">link_map</span> <span class="o">*</span><span class="n">map</span><span class="p">;</span>
    <span class="k">struct</span> <span class="n">dtor_list</span> <span class="o">*</span><span class="n">next</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<p>這邊就稍微提一下這個方法，<code class="language-plaintext highlighter-rouge">tls_dtor_list</code> 是個 <code class="language-plaintext highlighter-rouge">dtor_list</code> object 的 singly linked list 主要是存放 thread local storage 的 destructor，在 thread 結束時會去看這個 linked list 並去呼叫 destructor function，我們可藉由覆蓋 <code class="language-plaintext highlighter-rouge">tls_dtor_list</code> 指向我們所構造的 dtor_list。</p>

<p><img src="/assets/img/blog/20220328/17.png" alt="" /></p>

<p>而當程式結束呼叫 exit() 時，會去呼叫 <code class="language-plaintext highlighter-rouge">call_tls_dtors()</code> ，該 function 會去取 <code class="language-plaintext highlighter-rouge">tls_dtor_list</code> 中的 object 並去呼叫每個 destructor，此時如果我們可以控制 <code class="language-plaintext highlighter-rouge">tls_dtor_list</code> 就會去使用我們所構造的 <code class="language-plaintext highlighter-rouge">dtor_list</code> 來呼叫我們指定的函式。</p>

<p><img src="/assets/img/blog/20220328/18.png" alt="" /></p>

<p>但在新版本和 synology 的 libc 中，dtor_list 的 function pointer 有被 pointer guard 保護，導致正常情況下，我們並不好利用，一樣需要先 leak 出 pointer guard 才能好好控制 rip 到我們想要的位置上。</p>

<p>但有趣的是 pointer guard 也會在 TLS 上，他會存在  TLS 中的 tcbhead_t 結構中，如果我們 overflow 夠多，也可以在 overflow <code class="language-plaintext highlighter-rouge">tls_dtor_list</code> 的同時，也將 pointer guard 也一併清掉，這樣就可以讓我們不用處理 pointer guard 問題。</p>

<p><img src="/assets/img/blog/20220328/19.png" alt="" /></p>

<p>先來講講 tcbhead_t 這結構，這個結構主要是 Thread Control Block (TCB)，有點類似 Windows 中的 TEB 結構 是 thread 的 descriptor，主要會用來存放 thread 的各種資訊，而在 x86_64 的 Linux 架構的 usermode 下，fs 暫存器會指向這位置，每當我們要存取 thread local variable 時，都會透過 fs 暫存器去 存取，我們可以看到 TCB 結構會有 stack guard 及 pointer guard 等資訊，也就是說當我們在拿 pointer guard 時，也是用 fs 暫存器從這個結構取出的。</p>

<p><img src="/assets/img/blog/20220328/20.png" alt="" /></p>

<p>我們回頭看一下 TLS 上的結構分佈，可以看到 <code class="language-plaintext highlighter-rouge">tls_dtor_list</code> 後方就是這個，<code class="language-plaintext highlighter-rouge">tcbhead_t</code> 結構。只要我們 overflow 夠多就可以蓋掉 pointer guard，然而此時會出現另外一個問題。</p>

<p><img src="/assets/img/blog/20220328/21.png" alt="" /></p>

<p>因為 stack guard 在 pointer guard 前，當我們蓋掉 pointer guard 的同時，也會蓋掉 stack guard。那麼蓋掉 stack guard 會有什麼影響呢？</p>

<p><img src="/assets/img/blog/20220328/22.png" alt="" /></p>

<p>在我們呼叫 <code class="language-plaintext highlighter-rouge">dsi_stream_receive()</code> 時，因為有開啟 stack guard 保護的關係，會先從 TLS 上，取得 stack guard 放在 stack 上，等到我們呼叫 dsi_stream_read 去 trigger overflow 且蓋掉 pointer guard 及 stack guard 後，在 <code class="language-plaintext highlighter-rouge">dsi_stream_receive()</code> 返回時，會去檢查 stack guard 是否與 TLS 中的相同，但因為這時候的 TLS 的 stack guard 已經被我們蓋掉了，導致檢查不通過而中止程式，就會造成我們無法利用這個技巧來達成 RCE。</p>

<h4 id="bypass-stack-guard">Bypass stack guard</h4>

<p><img src="/assets/img/blog/20220328/23.png" alt="" /></p>

<p>在 netatalk(afpd) 的架構中，事實上每次連線都會 fork 一個新的 process 來 handle 使用者的 request，而 Linux 中的 process 有個特性是 fork 出來的 process，memory address 及 stack gurad 等都會與原先的 parent process 相同，因此我們可以利用 CTF 常見的招式，一個 byte 一個 bytes  brute-force 的方式來獲得 stack guard 。</p>

<h4 id="brute-force-stack-guard">Brute-force stack guard</h4>

<p>基本概念是 在 overflow 之後，我們可以只蓋 TLS 中的 stack guard 最尾端一個 byte ，每次連線都蓋不同的 byte，一旦與 stack guard 不同，就會因為 abort 而中斷連線，我們可依據連線的中斷與否，判斷我們所覆蓋的數值是否與 stack guard 相同。</p>

<p><img src="/assets/img/blog/20220328/24.png" alt="" /></p>

<p>以上圖來說，我們假設 stack guard 是 <code class="language-plaintext highlighter-rouge">0xdeadbeeffacebc00</code>，由於 stack guard 特性，最低一個 byte 一定會是 0 ，這邊從第二個 byte 蓋起，這邊可以先蓋 00 試看看連線是否被中斷，如果被中斷代表蓋的數值是錯的，接下來我們就測其他數值看看有沒有中斷，依此類推，測到 0xbc 發現沒有中斷，代表第二個 byte 是 0xbc，接下來就繼續蓋第三 byte ，一樣從 0x00 蓋到沒中斷，直到蓋滿 8 bytes 的 stack guard 都沒中斷連線後，我們就可以知道 stack guard 的值是什麼，接下來我們就可以解決 stack guard 問題。</p>

<h4 id="construct-the-_dtor_list-to-control-rip">Construct the <code class="language-plaintext highlighter-rouge">_dtor_list</code> to control RIP</h4>

<p>在解決 stack guard 問題後，netatalk 已可正常運作，接下來我們需要構造 <code class="language-plaintext highlighter-rouge">_dtor_list</code> 結構並結束程式來控制 RIP，在當時的 synology 的 afpd 中並沒有開啟 PIE，我們可以在 afpd 的 data 段中，構造 <code class="language-plaintext highlighter-rouge">_dtor_list</code>。</p>

<p><img src="/assets/img/blog/20220328/25.png" alt="" /></p>

<p>剛好在使用 dhx2 method 的 login 功能中，會將我們要登入的 username 複製到 global 的 buffer 中，所以我們可以將這結構跟著 username 一起寫入固定的已知位置。</p>

<p><img src="/assets/img/blog/20220328/26.png" alt="" /></p>

<p>在一切都構造完成後，我們這邊可以觸發正常功能的 <code class="language-plaintext highlighter-rouge">DSICloseSession</code> 即可觸發 <code class="language-plaintext highlighter-rouge">exit()</code></p>

<h4 id="tls_dtor_list-in-synology"><code class="language-plaintext highlighter-rouge">tls_dtor_list</code> in Synology</h4>

<p><img src="/assets/img/blog/20220328/27.png" alt="" /></p>

<p>在 reverse 後，發現 synology 的 glibc 中，會使用 <code class="language-plaintext highlighter-rouge">__tls_get_addr()</code> 來取得 <code class="language-plaintext highlighter-rouge">tls_dtor_list</code>，並非直接存取 <code class="language-plaintext highlighter-rouge">tls_dtor_list</code> 這個全域變數，而這函式的取得方式則會從前述 <code class="language-plaintext highlighter-rouge">tcbhead_t</code> 中先取 div 欄位後，再取得其中的 <code class="language-plaintext highlighter-rouge">tls_dtor_list</code> ，因此我們需要連同 <code class="language-plaintext highlighter-rouge">tcb-&gt;div</code> 一起構造在固定位置，另外一點是 Synology 的 afpd 中並沒有 system 可用，但事實上有 execl 可以使用，只是參數稍微複雜一點而已。</p>

<p><img src="/assets/img/blog/20220328/28.png" alt="" /></p>

<p>最後我們構造的結構如上圖所示，我們將 tcb 及 dtor_list 結構都構造在 username buffer 中，觸發 exit() 後，就會去執行 execl 並取得反連 shell。</p>

<center><div class="videowrapper"><iframe width="560" height="420" src="https://www.youtube.com/embed/ocZkWuSCr4Y" frameborder="0"> </iframe></div></center>

<h3 id="remark">Remark</h3>

<p>在一般的 Netatalk 中，是會啟用 PIE ，不太容易在已知位置構造 <code class="language-plaintext highlighter-rouge">_dtor_list</code>，實際上也可以用類似方法 leak 出 libc 位置，依舊是 exploitable，該漏洞不只影響 Synology 也會影響到大部分有使用 Netatalk 的設備。</p>

<h3 id="other-vendor">Other vendor</h3>

<p>我們測試了許多家有使用到 Netatalk 的廠商，發現不少家有存在類似的問題，部分是 unexploitable 但也有部分是 exploitable。我們這邊實測了 QNAP 及 Asustor，皆有成功獲得 shell。</p>

<h4 id="qnap">QNAP</h4>
<ul>
  <li>We tested on TS451
    <ul>
      <li>QTS 4.5.4.1741</li>
    </ul>
  </li>
  <li>Not enable by default</li>
  <li>Protection
    <ul>
      <li><strong>No Stack Guard</strong></li>
      <li>No PIE</li>
    </ul>
  </li>
  <li>內建 system</li>
</ul>

<p><img src="/assets/img/blog/20220328/29.png" alt="" />
<img src="/assets/img/blog/20220328/30.png" alt="" /></p>

<h4 id="asustor">Asustor</h4>
<ul>
  <li>We tested on AS5202T
    <ul>
      <li>ADM 3.5.7.RJR1</li>
    </ul>
  </li>
  <li>Not enable by default</li>
  <li>Protection
    <ul>
      <li><strong>No Stack Guard</strong></li>
      <li>No PIE</li>
    </ul>
  </li>
  <li>內建 system</li>
</ul>

<p><img src="/assets/img/blog/20220328/31.png" alt="" /></p>

<p>QNAP 及 Asustor 兩家 NAS 都沒有開啟 Stack guard，不需 brute-force 即可獲得反連 shell。</p>

<p>這個漏洞在 Synology 尚未修補時，只要 default 裝好就可以利用，<strong>不需任何認證</strong>，而 QNAP 及 Asustor 雖然不是預設開啟，但不少有使用 Mac 的用戶，還是會為了方便把它打開，基本上只要是 NAS 幾乎都會用到 Netatalk，絕大多數的 NAS 都有影響，只要有開啟 Netatalk，攻擊者可以利用這個漏洞打下大部分的 NAS。<strong>你的 NAS 就再也不會是你的 NAS。</strong></p>

<p><img src="/assets/img/blog/20220328/32.png" alt="" /></p>

<p>我們後來也從 shodan 上發現，其實也有非常多人將 netatalk 開在外網，光在 shodan 上就有 13 萬台機器，其中大部分是 Synology。</p>

<h2 id="mitigation">Mitigation</h2>
<h3 id="update">Update</h3>
<p>目前上述三台皆已修補，請尚未更新的用戶更新到最新</p>
<ul>
  <li>Synology
    <ul>
      <li>https://www.synology.com/zh-hk/security/advisory/Synology_SA_20_26</li>
    </ul>
  </li>
  <li>QNAP
    <ul>
      <li>https://www.qnap.com/en/security-advisory/qsa-21-50</li>
    </ul>
  </li>
  <li>Asustor
    <ul>
      <li>https://www.asustor.com/service/release_notes#ADM%203.5.7.RKU2</li>
    </ul>
  </li>
</ul>

<p>該漏洞也在近期釋出的 <a href="https://netatalk.sourceforge.io/3.1/ReleaseNotes3.1.13.html">Netatalk 3.1.13</a> 版本中修復，如有使用到 Netatalk 3.1.13 以前版本，也請務必更新。</p>

<h3 id="disable-afp">Disable AFP</h3>
<ul>
  <li>沒使用 AFP 時，最好直接關掉或只限制在內網存取。該 project 幾乎已經很少維護，繼續使用風險極高。</li>
  <li>改用 SMB <strong>相對安全</strong>
    <ul>
      <li>如果想要用類似功能，建議可使用 SMB 相對安全不少，但只能說相對安全，不能說絕對沒問題，建議還是將相關服務都開在內網就好，沒用到的能關就關</li>
    </ul>
  </li>
</ul>

<h2 id="summary">Summary</h2>
<p>我們已成功在 NAS 中找到一個嚴重漏洞，並且成功寫出概念證明程式，證實可以利用在 Synology、QNAP 及 Asustor 等主流 NAS 上利用。我們也認為 Netatalk 是在 NAS 中新一代的後門!</p>

<p>未來希望有使用到第三方套件的 NAS 廠商，可以多重新審視一下第三方套件所帶來的安全性問題，強烈建議可以自行 Review 一次，並且注意其他廠商是否也有修復同樣套件上的漏洞，很有可能自己也會受到影響，也希望使用 NAS 的用戶，也能多多重視不要把 NAS 開在外網，能關的服務就盡可能關閉，以減少攻擊面，讓攻擊者有機可趁。</p>

<h2 id="to-be-continue">To be continue</h2>
<p>事實上，我們並不只有找到一個漏洞，我們也發現還有不少問題，也運用在去年的 Pwn2Own Austin 上，這部分我們在大部分廠商修復後會在公開其他的研究，就敬請期待 Part II。</p>


                    </div>
                    <!-- 文章內容 -->
                </div>
            </article>
            <!-- 文章 end -->
        </section>
        
         <!-- 作者 -->
        <section>
            <div class="container article_footer">
                <div class="author_info">
                    <a href="/blog/author/angelboy">
                        <div class="circle" style="background-image: url(/assets/img/avatar/orig/angelboy.png);"></div>
                    </a>
                    <div>
                        <a class="author" href="/blog/author/angelboy">
                            <h3>Angelboy</h3>
                        </a>
                        <span>Senior Security Researcher</span>
                        <p>
                            I am 👼 :)
                        </p>
                    </div>
                </div>
            </div>
        </section>
        

        <!-- 相關文章 -->
        <section class="recommand articles-list">
            <div class="container">
              
                <!-- 相關文章 Item -->
                <article class="article">
                    <div class="content">
                        <a class="category" href="/blog/category/最新消息">最新消息</a>
                        <span class="tag">
    
                          <a href="/blog/tag/公告/">#公告</a> <a href="/blog/tag/徵才/">#徵才</a> 
                        </span>
                        <h2>
                            <a href="/blog/2023/01/14/3rd-internship-program-recruit/">DEVCORE 2023 第三屆實習生計畫</a> 
                        </h2>
                    
                    
                        <span class="date">2023-01-14</span>
                        <p class="line-litmit-3">DEVCORE 第三屆實習生計畫開始，計畫目的希望能培育人才、增強新世代的資安技能，如果您對這個計畫有興趣，歡迎來信報名！
                        </p>
                    </div>
                </article>
              
                <!-- 相關文章 Item -->
                <article class="article">
                    <div class="content">
                        <a class="category" href="/blog/category/最新消息">最新消息</a>
                        <span class="tag">
    
                          <a href="/blog/tag/公告/">#公告</a> 
                        </span>
                        <h2>
                            <a href="/blog/2023/01/12/DEVCORE-conference-registration-open-now/">DEVCORE Conference 2023 即日起開放報名</a> 
                        </h2>
                    
                    
                        <span class="date">2023-01-12</span>
                        <p class="line-litmit-3">純攻擊導向的專業技術研討會 DEVCORE Conference 將於 3 月 10 日至 11 日再次盛大舉行
                        </p>
                    </div>
                </article>
              
                <!-- 相關文章 Item -->
                <article class="article">
                    <div class="content">
                        <a class="category" href="/blog/category/最新消息">最新消息</a>
                        <span class="tag">
    
                          <a href="/blog/tag/公告/">#公告</a> 
                        </span>
                        <h2>
                            <a href="/blog/2022/12/23/2022-devcore-national-cyber-security-scholarship-results-announcement/">DEVCORE 2022 年度全國資訊安全獎學金頒獎餐敘順利落幕</a> 
                        </h2>
                    
                    
                        <span class="date">2022-12-23</span>
                        <p class="line-litmit-3">全國資訊安全獎學金頒獎餐敘順利落幕，期待獲獎同學們未來持續深耕資安知識與技術，在資安舞台上發光發熱！
                        </p>
                    </div>
                </article>
              

            </div>
        </section>
    </div>

    <!-- footer -->
    <footer>
<div class="container footer">
    <div class="logo">
        <a href="/">
            <img src="/images/logo.svg"/>
        </a>
        <div class="social">
            <a href="https://www.facebook.com/D3VC0RE"><i class="icon facebook"></i></a>
            <a href="https://twitter.com/d3vc0r3"><i class="icon twitter"></i></a>
        </div>
    </div>

    <div class="column">
        <h6 class="mobile_toggle">服務</h6>
        <ul>
            <li><a href="/services/red-team/">紅隊演練</a></li>
            <li><a href="/services/penetration-test/">滲透測試</a></li>
            <li><a href="/services/security-consulting/">資安顧問服務</a></li>
            <li><a href="/services/security-training/">資安教育訓練</a></li>
        </ul>
    </div>

    <div class="column">
        <h6 class="mobile_toggle">研究</h6>
        <ul>
            <li><a href="/research/overview/">總覽概要</a></li>
            <li><a href="/research/awards/">競賽與獎項</a></li>
            <li><a href="/research/bug-bounty/">企業漏洞回報</a></li>
            <li><a href="/research/talks/">國際研討會</a></li>
            <li><a href="/research/cve/">CVE 漏洞列表</a></li>
        </ul>
    </div>

    <div class="column">
        <h6 class="mobile_toggle">公司</h6>
        <ul>
            <li><a href="/company/about/">公司簡介</a></li>
            <li><a href="/company/our-team/">團隊成員</a></li>
            <li><a href="/company/history/">成就與沿革</a></li>
            <li><a href="/company/csr/">企業社會責任</a></li>
            <li><a href="/company/jobs/">工作機會</a></li>
            <li><a href="/contact/">聯絡我們</a></li>
        </ul>
    </div>

    <div class="column">
        <h6 class="mobile_toggle">新聞</h6>
        <ul>
            <li><a href="/blog/">BLOG</a></li>
            <li><a href="/media-kit/">媒體素材下載</a></li>
        </ul>
    </div>

    <!-- divider 分隔線 -->
    <div class="divider"></div>

    <div class="copyright">
        <div class="info">
            <span>© 2023 DEVCORE 戴夫寇爾股份有限公司. <b class="line-block">All right reserved.</b></span>
            <span><a href="/privacy-policy/">Privacy Policy</a></span>
        </div>
        <div class="lang">
            <!-- <i class="icon translate"></i>
            <select>
                <option value="">Language</option>
                <option value="">中文</option>
                <option value="">English</option>
            </select> -->
            <span>Language :<a href="/">中文</a>|<a href="/en/">English</a></span>
        </div>
    </div>

</div>
    </footer>
</body>
</html>

