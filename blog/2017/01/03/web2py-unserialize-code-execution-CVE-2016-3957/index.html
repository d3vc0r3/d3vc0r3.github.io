
<!DOCTYPE html>
<html lang="zh-TW">
  <head>
    <meta charset="utf-8" />
    <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible" />
    <meta content="width=device-width, initial-scale=1" name="viewport" />
    <title>WEB2PY 反序列化的安全問題－CVE-2016-3957 | DEVCORE 戴夫寇爾</title><link href="/assets/themes/devcore-v2/stylesheets/webpack_bundle.css" rel="stylesheet" />
    <link href="/assets/themes/devcore-v2/images/favicon.png" rel="icon" size="32x32">
    <meta name="description" property="og:description" content="在一次滲透測試的過程中，我們遇到了用 web2py 框架建構的應用程式。為了成功滲透目標，我們研究了 web2py，發現該框架範例應用程式中存在三個資訊洩漏問題，這些洩漏都會導致遠端命令執行 (RCE)。由於範例應用程式預設是開啟的，若沒有手動關閉，攻擊者可以直接利用洩漏資訊取得系統執行權限。這些問題編號分別為：CVE-2016-3952、CVE-2016-3953、CVE-2016-3954、CVE-2016-3957。" />
    <meta name="keywords" content="CVE, Vulnerability, infoleak, Pentest, Advisory" />
    <meta property="og:site_name" content="DEVCORE 戴夫寇爾" />
    <meta property="og:title" content="WEB2PY 反序列化的安全問題－CVE-2016-3957 | DEVCORE 戴夫寇爾" />
    <meta property="og:url" content="https://devco.re/blog/2017/01/03/web2py-unserialize-code-execution-CVE-2016-3957/" />
    <meta property="og:type" content="website" />
    <meta property="og:image" content="https://devco.re/assets/img/blog/20170103/web2py.png" />
    <meta name="twitter:card" content="summary">
    <meta name="twitter:site" content="d3vc0r3">
    <meta name="twitter:title" content="WEB2PY 反序列化的安全問題－CVE-2016-3957 | DEVCORE 戴夫寇爾">
    <meta name="twitter:description" content="在一次滲透測試的過程中，我們遇到了用 web2py 框架建構的應用程式。為了成功滲透目標，我們研究了 web2py，發現該框架範例應用程式中存在三個資訊洩漏問題，這些洩漏都會導致遠端命令執行 (RCE)。由於範例應用程式預設是開啟的，若沒有手動關閉，攻擊者可以直接利用洩漏資訊取得系統執行權限。這些問題編號分別為：CVE-2016-3952、CVE-2016-3953、CVE-2016-3954、CVE-2016-3957。">
    <meta name="twitter:creator" content="d3vc0r3">
    <meta name="twitter:image:src" content="https://devco.re/assets/img/blog/20170103/web2py.png">
    <meta name="twitter:domain" content="devco.re">
    <meta name="google-site-verification" content="lMNi_XT6UmeGqeYI_vLHu5PDRi_uNVfnA2NdDGS4-lM" />
    <meta name="msvalidate.01" content="119FDBB7730BE45B162515BBB1FF6B33" />
    <meta name="alexaVerifyID" content="j-Es9N9SD7ckfA2EokOz9SZzhok" />
    <meta name='yandex-verification' content='4561963cf1d18fe3' />
    <meta property="fb:admins" content="120968921404653" />

    <link rel="canonical" href="https://devco.re/blog/2017/01/03/web2py-unserialize-code-execution-CVE-2016-3957/"/>
    <link rel="alternate" type="application/rss+xml" title="DEVCORE 戴夫寇爾" href="https://devco.re/rss">

    <!-- Google Tag Manager -->
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
    new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
    j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
    'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-K5B8NW');</script>
    <!-- End Google Tag Manager -->
  </head>
  <body>
    <div class="page">
      <div class="container--wrapper">
        <div class="topbar">
          <div class="topbar__brand">
            <a href="/">
                <div class="logo">
                  DEVCORE 戴夫寇爾
                </div></a>
            <p class="slogan">
              我們提供<a href="/services/penetration-test" class="link">滲透測試</a>、<a href="/services/red-team" class="link">紅隊演練</a>、<a href="/services/security-consulting" class="link">資安顧問</a>與<a href="/services/security-training" class="link">教育訓練</a>服務
            </p>
          </div>
          <div class="drawer" id="drawer">
            <div class="drawer__container">
              <nav class="main-menu">
                <div class="hidden">
                  主選單
                </div>
                <a href="/services/penetration-test" class="main-menu__link mobile-only">滲透測試</a>
                <a href="/services/red-team" class="main-menu__link mobile-only">紅隊演練</a>
                <a href="/services/security-consulting" class="main-menu__link mobile-only">資安顧問</a>
                <a href="/services/security-training" class="main-menu__link mobile-only">教育訓練</a>
                <a href="/about/" class="main-menu__link">駭客思維</a><a href="/blog/" class="main-menu__link">最新訊息</a><a href="/search/" class="main-menu__link main-menu__search desktop-only"><span class="hidden">搜尋</span><svg class="icon-search icon"><use xlink:href="#icon-search" /></svg></a>
              </nav>
              <a href="/contact/" class="drawer__contact button--dense">聯絡我們</a>
              <nav class="lang-menu">
                <div class="lang-menu__label">
                  語言:
                </div>
                <a href="/" class="lang-menu__link">中文</a>
                <a href="/en/" class="lang-menu__link">English</a>
              </nav>
            </div>
          </div><span class="topbar__menu mobile-only">menu</span><button class="appearance-none topbar__hamburger mobile-only" data-toggle="#drawer" id="drawer-toggle" type="button">
            <div class="bars">
              <div class="bar"></div>
              <div class="bar"></div>
              <div class="bar"></div>
            </div>
          </button>
        </div>
      </div><main role="main">


          <div class="container--wrapper">
            <div class="container">
              <section class="blog-header">
                <small class="blog-header__category"><a href="/blog/category/技術專欄/">技術專欄</a></small>
                <img src="https://devco.re/assets/img/blog/20170103/web2py.png" class="blog-header__image" alt="WEB2PY 反序列化的安全問題－CVE-2016-3957" />
                <h1 class="blog-header__title">
                  WEB2PY 反序列化的安全問題－CVE-2016-3957
                </h1>
                <div class="blog-header__tags">
                  
                  <a href="/blog/tag/CVE/" class="blog-header__tag">CVE</a><a href="/blog/tag/Vulnerability/" class="blog-header__tag">Vulnerability</a><a href="/blog/tag/infoleak/" class="blog-header__tag">infoleak</a><a href="/blog/tag/Pentest/" class="blog-header__tag">Pentest</a><a href="/blog/tag/Advisory/" class="blog-header__tag">Advisory</a>
                </div>
          
          
                <p class="blog-header__info">
                  By <span class="blog-author-photo" style="background-image: url(/assets/themes/devcore-v2/images/avatar/shaolinhsu.jpg)"></span> <a href="/blog/author/shaolin" class="author-name">Shaolin</a> <time class="date">on 2017-01-03 </time>
                </p>
          
              </section>
              <article class="article">
          <h3 id="前言">前言</h3>

<p>在一次滲透測試的過程中，我們遇到了用 web2py 框架建構的應用程式。為了成功滲透目標，我們研究了 web2py，發現該框架範例應用程式中存在三個資訊洩漏問題，這些洩漏都會導致遠端命令執行 (RCE)。由於範例應用程式預設是開啟的，若沒有手動關閉，攻擊者可以直接利用洩漏資訊取得系統執行權限。這些問題編號分別為：CVE-2016-3952、CVE-2016-3953、CVE-2016-3954、CVE-2016-3957。</p>

<!-- more -->

<h3 id="背景老生常談的-pickle-code-execution">背景－老生常談的 Pickle Code Execution</h3>

<p>在繼續說明前必須要先認知什麼是反序列化的安全問題？反序列化的安全問題在本質上其實是物件注入，它的嚴重性取決於所注入的物件本身是否會造成危險行為，例如讀寫檔。一般來說要透過反序列化建構一個成功的攻擊有兩個要點：</p>

<ul>
  <li>是否可控制目標所要反序列化的字串。</li>
  <li>危險行為在反序列化後是否會被執行。這在實務上大概有下面兩種情形：
    <ul>
      <li>危險行為是寫在魔法方法 (Magic Method) 裡面，例如 PHP 的 __construct 在物件生成時一定會執行。</li>
      <li>反序列化後覆蓋既有物件，導致正常程式流程出現危險結果。</li>
    </ul>
  </li>
</ul>

<p>反序列化的問題在每個程式語言都會發生，但通常需要搭配看程式碼拼湊出可以用的攻擊流程，比較難利用。不過，某些實作序列化的函式庫會將程式邏輯也序列化成字串，因此攻擊者可以自定義物件直接使用，不再需要拼湊，例如今天要提的 Python Pickle。</p>

<p>直接舉個 Pickle 的例子如下，我們製造了一個會執行系統指令 <code class="highlighter-rouge">echo success</code> 的物件 <code class="highlighter-rouge">Malicious</code>，並且序列化成字串 <code class="highlighter-rouge">"cposix\nsystem\np1\n(S'echo success'\np2\ntp3\nRp4\n."</code>。當受害者反序列化這個字串，即觸發執行該系統指令，因此印出 <code class="highlighter-rouge">success</code>。</p>

<div class="highlight"><pre><code class="language-py" data-lang="py"><span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span> <span class="nn">os</span>
<span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span> <span class="nn">cPickle</span>
<span class="o">&gt;&gt;&gt;</span> <span class="k">class</span> <span class="nc">Malicious</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
<span class="o">...</span>   <span class="k">def</span> <span class="nf">__reduce__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="o">...</span>     <span class="k">return</span> <span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">,(</span><span class="s">&quot;echo success&quot;</span><span class="p">,))</span>
<span class="o">...</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">serialize</span> <span class="o">=</span> <span class="n">cPickle</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">Malicious</span><span class="p">())</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">serialize</span>
<span class="s">&quot;cposix</span><span class="se">\n</span><span class="s">system</span><span class="se">\n</span><span class="s">p1</span><span class="se">\n</span><span class="s">(S&#39;echo success&#39;</span><span class="se">\n</span><span class="s">p2</span><span class="se">\n</span><span class="s">tp3</span><span class="se">\n</span><span class="s">Rp4</span><span class="se">\n</span><span class="s">.&quot;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">cPickle</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">serialize</span><span class="p">)</span>
<span class="n">success</span>
<span class="mi">0</span></code></pre></div>

<p>這就是 Pickle 誤用反序列化所造成的命令執行風險。攻擊者很容易可以產生一個含有任意命令執行的序列化字串，進而讓受害者在進行反序列化的過程中觸發執行惡意命令。</p>

<h3 id="反序列化--序列化字串可控">反序列化 ＋ 序列化字串可控</h3>

<p>本次發現的問題主要來自 web2py 本身的 session cookie 使用 Pickle 處理序列化需求 (CVE-2016-3957)，而且因為 session cookie 的加密字串固定 (CVE-2016-3953)，攻擊者可任意偽造惡意的序列化字串造成前面所介紹的命令執行風險。細節如下。</p>

<h4 id="cve-2016-3957">CVE-2016-3957<sup id="fnref:note1"><a href="#fn:note1" class="footnote">1</a></sup></h4>

<p>web2py 的應用程式如果使用 cookie 來儲存 session 資訊，那麼在每次接到使用者請求時會將 session cookie 用一個 secure_loads 函式將 cookie 內容讀入。 [<a href="https://github.com/web2py/web2py/blob/R-2.14.1/gluon/globals.py#L846">Ref</a>]</p>

<div class="highlight-name">gluon/globals.py#L846</div>

<div class="highlight"><pre><code class="language-py" data-lang="py"><span class="k">if</span> <span class="n">response</span><span class="o">.</span><span class="n">session_storage_type</span> <span class="o">==</span> <span class="s">&#39;cookie&#39;</span><span class="p">:</span>
            <span class="c"># check if there is session data in cookies</span>
            <span class="k">if</span> <span class="n">response</span><span class="o">.</span><span class="n">session_data_name</span> <span class="ow">in</span> <span class="n">cookies</span><span class="p">:</span>
                <span class="n">session_cookie_data</span> <span class="o">=</span> <span class="n">cookies</span><span class="p">[</span><span class="n">response</span><span class="o">.</span><span class="n">session_data_name</span><span class="p">]</span><span class="o">.</span><span class="n">value</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">session_cookie_data</span> <span class="o">=</span> <span class="bp">None</span>
            <span class="k">if</span> <span class="n">session_cookie_data</span><span class="p">:</span>
                <span class="n">data</span> <span class="o">=</span> <span class="n">secure_loads</span><span class="p">(</span><span class="n">session_cookie_data</span><span class="p">,</span> <span class="n">cookie_key</span><span class="p">,</span>
                                    <span class="n">compression_level</span><span class="o">=</span><span class="n">compression_level</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">data</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
            <span class="n">response</span><span class="o">.</span><span class="n">session_id</span> <span class="o">=</span> <span class="bp">True</span></code></pre></div>

<p>secure_loads 函式內容如下，在一連串解密後會用 pickle.loads 方法將解密內容反序列化，在這裡確定 cookie 內容會使用 Pickle 處理。[<a href="https://github.com/web2py/web2py/blob/R-2.14.1/gluon/utils.py#L200">Ref</a>]</p>

<div class="highlight-name">gluon/utils.py#L200</div>

<div class="highlight"><pre><code class="language-py" data-lang="py"><span class="k">def</span> <span class="nf">secure_loads</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">encryption_key</span><span class="p">,</span> <span class="n">hash_key</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">compression_level</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="k">if</span> <span class="s">&#39;:&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">None</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">hash_key</span><span class="p">:</span>
        <span class="n">hash_key</span> <span class="o">=</span> <span class="n">sha1</span><span class="p">(</span><span class="n">encryption_key</span><span class="p">)</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">()</span>
    <span class="n">signature</span><span class="p">,</span> <span class="n">encrypted_data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">&#39;:&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">actual_signature</span> <span class="o">=</span> <span class="n">hmac</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="n">hash_key</span><span class="p">,</span> <span class="n">encrypted_data</span><span class="p">)</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">()</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">compare</span><span class="p">(</span><span class="n">signature</span><span class="p">,</span> <span class="n">actual_signature</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">None</span>
    <span class="n">key</span> <span class="o">=</span> <span class="n">pad</span><span class="p">(</span><span class="n">encryption_key</span><span class="p">[:</span><span class="mi">32</span><span class="p">])</span>
    <span class="n">encrypted_data</span> <span class="o">=</span> <span class="n">base64</span><span class="o">.</span><span class="n">urlsafe_b64decode</span><span class="p">(</span><span class="n">encrypted_data</span><span class="p">)</span>
    <span class="n">IV</span><span class="p">,</span> <span class="n">encrypted_data</span> <span class="o">=</span> <span class="n">encrypted_data</span><span class="p">[:</span><span class="mi">16</span><span class="p">],</span> <span class="n">encrypted_data</span><span class="p">[</span><span class="mi">16</span><span class="p">:]</span>
    <span class="n">cipher</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">AES_new</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">IV</span><span class="o">=</span><span class="n">IV</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">cipher</span><span class="o">.</span><span class="n">decrypt</span><span class="p">(</span><span class="n">encrypted_data</span><span class="p">)</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">rstrip</span><span class="p">(</span><span class="s">&#39; &#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">compression_level</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">zlib</span><span class="o">.</span><span class="n">decompress</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">pickle</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>  <span class="c"># &lt;-- Bingo!!!</span>
    <span class="k">except</span> <span class="ne">Exception</span><span class="p">,</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">None</span></code></pre></div>

<p>因此，如果知道連線中用以加密 cookie 內容的 encryption_key，攻擊者就可以偽造 session cookie，進而利用 pickle.loads 進行遠端命令執行。</p>

<h4 id="cve-2016-3953">CVE-2016-3953</h4>

<p>很幸運的，我們發現 web2py 預設開啟的範例應用程式是使用 session cookie，並且有一個寫死的密鑰：<code class="highlighter-rouge">yoursecret</code>。[<a href="https://github.com/web2py/web2py/blob/R-2.14.1/applications/examples/models/session.py">Ref</a>]</p>

<div class="highlight-name">applications/examples/models/session.py</div>

<div class="highlight"><pre><code class="language-py" data-lang="py"><span class="n">session</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">request</span><span class="p">,</span><span class="n">response</span><span class="p">,</span><span class="n">cookie_key</span><span class="o">=</span><span class="s">&#39;yoursecret&#39;</span><span class="p">)</span></code></pre></div>

<p>因此，web2py 的使用者如果沒有手動關閉範例應用程式，攻擊者就可以直接在 http://[target]/examples/ 頁面發動攻擊取得主機操作權。</p>

<h4 id="proof-of-concept">Proof of Concept</h4>

<p>我們嘗試用 <code class="highlighter-rouge">yoursecret</code> 作為 encryption_key 偽造一個合法的 session cookie，並將一個會執行系統指令 sleep 的物件塞入其中。帶著此 session cookie 連入 web2py 官網範例應用程式(http://www.web2py.com/examples)，情形如下：</p>

<p>當插入的物件會執行指令 sleep 3 時，網站回應時間為 6.8 秒</p>

<p><img src="/assets/img/blog/20170103/POC1.png" alt="POC1" /></p>

<p>當插入的物件會執行指令 sleep 5 時，網站回應時間為 10.8 秒</p>

<p><img src="/assets/img/blog/20170103/POC2.png" alt="POC2" /></p>

<p>確實會因為塞入的 session cookie 值不同而有所延遲，證明網站的確執行了（兩次）我們偽造的物件內容。<sup id="fnref:note2"><a href="#fn:note2" class="footnote">2</a></sup></p>

<h3 id="其他洩漏導致-rce">其他洩漏導致 RCE</h3>

<p>此外，在 web2py 範例應用程式為了示範框架的特性，因此洩漏了許多環境變數。其中有兩個變數較為敏感，間接也會導致端命令執行，分別如下。</p>

<h4 id="cve-2016-3954">CVE-2016-3954</h4>

<p>在 http://[target]/examples/simple_examples/status 頁面中，response 分頁內容洩漏了 session_cookie_key 值。這個值就是用來加密前面所介紹的 session cookie，搭配 CVE-2016-3957 Pickle 的問題可直接遠端命令執行。</p>

<p><img src="/assets/img/blog/20170103/CVE-2016-3954.png" alt="CVE-2016-3954" /></p>

<p>無論使用者是否自行更改 session_cookie_key，或是該值是系統隨機產生。此介面仍然可以取得機敏資訊藉以造成危害。</p>

<h4 id="cve-2016-3952">CVE-2016-3952</h4>

<p>http://[target]/examples/template_examples/beautify 頁面洩漏了系統環境變數，當使用者是使用 standalone 版本時，管理者的密碼就會在環境變數裡出現。這個密碼可登入 http://[target]/admin 管理介面，管理介面內提供方便的功能得以執行任意指令。</p>

<p><img src="/assets/img/blog/20170103/CVE-2016-3952.png" alt="CVE-2016-3952" /></p>

<h3 id="官方修復">官方修復</h3>

<p>Version 2.14.1 移除洩漏的環境變數。[<a href="https://github.com/web2py/web2py/commit/9706d125b42481178d2b423de245f5d2faadbf40">Ref</a>]</p>

<p>Version 2.14.2 使用不固定字串作為 session_cookie_key，並移除洩漏頁面。</p>

<div class="highlight-name">applications/examples/models/session.py</div>

<div class="highlight"><pre><code class="language-py" data-lang="py"><span class="kn">from</span> <span class="nn">gluon.utils</span> <span class="kn">import</span> <span class="n">web2py_uuid</span>
<span class="n">cookie_key</span> <span class="o">=</span> <span class="n">cache</span><span class="o">.</span><span class="n">ram</span><span class="p">(</span><span class="s">&#39;cookie_key&#39;</span><span class="p">,</span><span class="k">lambda</span><span class="p">:</span> <span class="n">web2py_uuid</span><span class="p">(),</span><span class="bp">None</span><span class="p">)</span>
<span class="n">session</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">request</span><span class="p">,</span><span class="n">response</span><span class="p">,</span><span class="n">cookie_key</span><span class="o">=</span><span class="n">cookie_key</span><span class="p">)</span></code></pre></div>

<h3 id="總結">總結</h3>

<p>web2py 框架預設會開啟一個範例應用程式，路徑為 http://[target]/examples/。<br /><br />
由於這個應用程式使用 Pickle 來處理序列化的 session cookie，且因為加密字串為寫死的 <code class="highlighter-rouge">yoursecret</code>，任何人可竄改 session cookie 的內容，藉此進行 Pickle 命令執行攻擊。<br /><br />
該範例程式介面中也存在 session_cookie_key、管理者密碼洩漏問題，兩個都會導致任意命令執行。除此之外，在這個應用程式中洩漏許多系統配置、路徑等資訊，有機會被拿來做進階攻擊。<br /><br />
在 2.14.2 版本後已經修復所有洩漏問題，當然最好的解決辦法就是關閉這個範例應用程式。</p>

<p>最後，來整理從開發者的角度在這個案例中該注意的要點：</p>

<ol>
  <li>小心處理序列化字串，使用者若有機會改變該字串值，有機會被插入未預期的惡意物件，造成惡意的結果。</li>
  <li>正式產品中切記要移除任何跟開發相關的配置。</li>
</ol>

<h3 id="時間軸">時間軸</h3>

<ul>
  <li>2016/03/08 發現問題與其他研究</li>
  <li>2016/03/09 回報官方 <a href="https://github.com/web2py/web2py/issues/1205">GitHub Issue</a></li>
  <li>2016/03/15 成功與開發者 email 聯繫</li>
  <li>2016/03/15 官方修復管理者密碼洩漏問題 (CVE-2016-3952)</li>
  <li>2016/03/25 官方修復其他弱點並發佈 2.14.2 版本</li>
</ul>

<h3 id="附註">附註</h3>

<div class="footnotes">
  <ol>
    <li id="fn:note1">
      <p>其實 CVE-2016-3957 並非不安全的設計，在跟 CVE team 溝通的過程中發現 web2py 開始使用 JSON 取代 Pickle [<a href="https://github.com/web2py/web2py/commit/0820926b500a321060ef6a76ce89fd35a252f8b0">Ref</a>]，因此判定 web2py 認為目前的設計是不洽當的，給予此編號。後來官方因故將 Pickle 改了回來，不過在沒有洩漏加密字串的前提下已經是安全的了。 <a href="#fnref:note1" class="reversefootnote">&#8617;</a></p>
    </li>
    <li id="fn:note2">
      <p>在自行架設的 web2py 環境中只會執行一次，沒有去細追 web2py 官方網站為何執行兩次。 <a href="#fnref:note2" class="reversefootnote">&#8617;</a></p>
    </li>
  </ol>
</div>

              </article>
              <p class="sns-widgets">
                Share this on <button class="appearance-none sns-widgets__button" id="sns-facebook" type="button">Facebook</button> or <button class="appearance-none sns-widgets__button" id="sns-twitter" type="button">Twitter</button>
              </p>
          
              <div class="heading--side-lined">
                About <span class="blog-author-photo" style="background-image: url(/assets/themes/devcore-v2/images/avatar/shaolinhsu.jpg)"></span> <a href="/blog/author/shaolin" class="blog-author-name">Shaolin</a> 
              </div>
              <p class="blog-author-info">
                喜愛資訊技術、喜歡跟別人走不一樣的路。有一點點智障的熱血人，期望能利用資訊的力量對世界有所貢獻。
              </p>
          
              <div class="heading--side-lined">
                讀者留言
              </div>
              <div class="blog-comments">
                


  <div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_developer = 1;
    var disqus_shortname = 'd3vc0r3'; // required: replace example with your forum shortname
    
    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">blog comments powered by <span class="logo-disqus">Disqus</span></a>




              </div>
            </div>
          </div>






</main>
      <div class="container--wrapper">

        <div class="relative-posts">
          <div class="heading--side-lined container">
            最新消息
          </div>
          <div class="relative-posts__cells">
  
            <section class="card">
              <a href="/blog/2022/09/21/202209-security-researcher-recruitment/">
                <div class="card__thumbnail" style="background-image: url(https://devco.re/assets/img/blog/20220921/cover.png)"></div>
                <h3 class="card__title">
                  DEVCORE 徵求資安研究員
                </h3></a>
              <div class="card__tags">
  
                <a href="/blog/tag/公告/" class="card__tag">公告</a><a href="/blog/tag/徵才/" class="card__tag">徵才</a>
              </div>
              <small class="card__category"><a href="/blog/category/最新消息/">最新消息</a></small>
            </section>
  
            <section class="card">
              <a href="/blog/2022/08/26/2022-devcore-national-cyber-security-scholarship/">
                <div class="card__thumbnail" style="background-image: url(https://devco.re/assets/img/blog/20220826/cover.jpeg)"></div>
                <h3 class="card__title">
                  戴夫寇爾持續投入資安人才培育 - 啟動全國資訊安全獎學金計劃、延續資安教育活動贊助計劃
                </h3></a>
              <div class="card__tags">
  
                <a href="/blog/tag/公告/" class="card__tag">公告</a>
              </div>
              <small class="card__category"><a href="/blog/category/最新消息/">最新消息</a></small>
            </section>
  
            <section class="card">
              <a href="/blog/2022/07/25/2nd-internship-program-recruit/">
                <div class="card__thumbnail" style="background-image: url(https://devco.re/assets/img/blog/20220127/cover.png)"></div>
                <h3 class="card__title">
                  DEVCORE 2022 第二屆實習生計畫
                </h3></a>
              <div class="card__tags">
  
                <a href="/blog/tag/公告/" class="card__tag">公告</a><a href="/blog/tag/徵才/" class="card__tag">徵才</a>
              </div>
              <small class="card__category"><a href="/blog/category/最新消息/">最新消息</a></small>
            </section>
  
          </div>
        </div>


        <div class="contact-section container">
          <h2 class="contact-section__title">
            用最真實的攻擊，驗證企業的防禦
          </h2>
          <a href="/contact/" class="home-contact__button button--dense">聯絡我們</a>
        </div>

        <footer class="main-footer">
          <div class="main-footer__about">
            戴夫寇爾提供<br class="mobile-only" /><a href="/services/penetration-test" class="link">滲透測試</a>、<a href="/services/red-team" class="link">紅隊演練</a>、<a href="/services/security-consulting" class="link">資安顧問</a>與<a href="/services/security-training" class="link">教育訓練</a>服務<br />在<a href="https://www.facebook.com/D3VC0RE" class="link" target="_blank">Facebook</a>或<a href="https://twitter.com/d3vc0r3" class="link" target="_blank">Twitter</a>上追蹤我們的<a href="/blog/" class="link">最新訊息</a><br />瞭解更多戴夫寇爾的<a href="/about/" class="link">駭客思維</a>
          </div>
          <div class="main-footer__snses"><a href="https://www.facebook.com/D3VC0RE" class="main-footer__sns" target="_blank">
                <svg class="icon-fb icon"><use xlink:href="#icon-fb" /></svg></a><a href="https://twitter.com/d3vc0r3" class="main-footer__sns" target="_blank">
                <svg class="icon-twitter icon"><use xlink:href="#icon-twitter" /></svg></a>
          </div>
          <address class="main-footer__address">
            <ul class="list--unstyled">
              <li>
                地址 105608 台北市松山區八德路三段 32 號 13 樓
              </li>
              <li>
                Email contact@devco.re
              </li>
              <li>
                電話 02-2577-0925
              </li>
              <li>
                傳真 02-2577-0928
              </li>
              <li>
                統編 53955237
              </li>
            </ul>
          </address><small class="main-footer__copyright"><a href="/" class="logo">DEVCORE</a>©2022 DEVCORE 戴夫寇爾</small>
        </footer>
      </div>
    </div>
    <script src="/assets/themes/devcore-v2/javascripts/webpack_bundle.js"></script>



  <script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-30830800-1']);
  _gaq.push(['_trackPageview', location.pathname + location.search + location.hash]);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>




    <!-- Google Tag Manager (noscript) -->
    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-K5B8NW"
    height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <!-- End Google Tag Manager (noscript) -->

  </body>
</html>




