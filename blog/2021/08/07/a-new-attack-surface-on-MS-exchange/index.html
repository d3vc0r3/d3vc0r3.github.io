
<!DOCTYPE html>
<html lang="zh-TW">
  <head>
    <meta charset="utf-8" />
    <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible" />
    <meta content="width=device-width, initial-scale=1" name="viewport" />
    <title>ProxyLogon 僅僅只是冰山一角，一個針對 Microsoft Exchange Server 的全新攻擊面！ | DEVCORE 戴夫寇爾</title><link href="/assets/themes/devcore-v2/stylesheets/webpack_bundle.css" rel="stylesheet" />
    <link href="/assets/themes/devcore-v2/images/favicon.png" rel="icon" size="32x32">
    <meta name="description" property="og:description" content="隨著更深入的從架構層去研究 ProxyLogon，我們發現它不僅僅只是一個漏洞，而是一整個新的、沒有人提過的攻擊面可讓駭客或安全研究員去挖掘更多的漏洞。" />
    <meta name="keywords" content="CVE-2021-26855,CVE-2021-27065,CVE-2021-31195,CVE-2021-31196,CVE-2021-31207,CVE-2021-33768,CVE-2021-34473,CVE-2021-34523" />
    <meta property="og:site_name" content="DEVCORE 戴夫寇爾" />
    <meta property="og:title" content="ProxyLogon 僅僅只是冰山一角，一個針對 Microsoft Exchange Server 的全新攻擊面！ | DEVCORE 戴夫寇爾" />
    <meta property="og:url" content="https://devco.re/blog/2021/08/07/a-new-attack-surface-on-MS-exchange/" />
    <meta property="og:type" content="website" />
    <meta property="og:image" content="https://devco.re/assets/img/blog/20210807/cover.png" />
    <meta name="twitter:card" content="summary">
    <meta name="twitter:site" content="d3vc0r3">
    <meta name="twitter:title" content="ProxyLogon 僅僅只是冰山一角，一個針對 Microsoft Exchange Server 的全新攻擊面！ | DEVCORE 戴夫寇爾">
    <meta name="twitter:description" content="隨著更深入的從架構層去研究 ProxyLogon，我們發現它不僅僅只是一個漏洞，而是一整個新的、沒有人提過的攻擊面可讓駭客或安全研究員去挖掘更多的漏洞。">
    <meta name="twitter:creator" content="d3vc0r3">
    <meta name="twitter:image:src" content="https://devco.re/assets/img/blog/20210807/cover.png">
    <meta name="twitter:domain" content="devco.re">
    <meta name="google-site-verification" content="lMNi_XT6UmeGqeYI_vLHu5PDRi_uNVfnA2NdDGS4-lM" />
    <meta name="msvalidate.01" content="119FDBB7730BE45B162515BBB1FF6B33" />
    <meta name="alexaVerifyID" content="j-Es9N9SD7ckfA2EokOz9SZzhok" />
    <meta name='yandex-verification' content='4561963cf1d18fe3' />
    <meta property="fb:admins" content="120968921404653" />

    <link rel="canonical" href="https://devco.re/blog/2021/08/07/a-new-attack-surface-on-MS-exchange/"/>
    <link rel="alternate" type="application/rss+xml" title="DEVCORE 戴夫寇爾" href="https://devco.re/rss">

    <!-- Google Tag Manager -->
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
    new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
    j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
    'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-K5B8NW');</script>
    <!-- End Google Tag Manager -->
  </head>
  <body>
    <div class="page">
      <div class="container--wrapper">
        <div class="topbar">
          <div class="topbar__brand">
            <a href="/">
                <div class="logo">
                  DEVCORE 戴夫寇爾
                </div></a>
            <p class="slogan">
              我們提供<a href="/services/penetration-test" class="link">滲透測試</a>、<a href="/services/red-team" class="link">紅隊演練</a>、<a href="/services/security-consulting" class="link">資安顧問</a>與<a href="/services/security-training" class="link">教育訓練</a>服務
            </p>
          </div>
          <div class="drawer" id="drawer">
            <div class="drawer__container">
              <nav class="main-menu">
                <div class="hidden">
                  主選單
                </div>
                <a href="/services/penetration-test" class="main-menu__link mobile-only">滲透測試</a>
                <a href="/services/red-team" class="main-menu__link mobile-only">紅隊演練</a>
                <a href="/services/security-consulting" class="main-menu__link mobile-only">資安顧問</a>
                <a href="/services/security-training" class="main-menu__link mobile-only">教育訓練</a>
                <a href="/about/" class="main-menu__link">駭客思維</a><a href="/blog/" class="main-menu__link">最新訊息</a><a href="/search/" class="main-menu__link main-menu__search desktop-only"><span class="hidden">搜尋</span><svg class="icon-search icon"><use xlink:href="#icon-search" /></svg></a>
              </nav>
              <a href="/contact/" class="drawer__contact button--dense">聯絡我們</a>
              <nav class="lang-menu">
                <div class="lang-menu__label">
                  語言:
                </div>
                <a href="/" class="lang-menu__link">中文</a>
                <a href="/en/" class="lang-menu__link">English</a>
              </nav>
            </div>
          </div><span class="topbar__menu mobile-only">menu</span><button class="appearance-none topbar__hamburger mobile-only" data-toggle="#drawer" id="drawer-toggle" type="button">
            <div class="bars">
              <div class="bar"></div>
              <div class="bar"></div>
              <div class="bar"></div>
            </div>
          </button>
        </div>
      </div><main role="main">


          <div class="container--wrapper">
            <div class="container">
              <section class="blog-header">
                <small class="blog-header__category"><a href="/blog/category/技術專欄/">技術專欄</a></small>
                <img src="https://devco.re/assets/img/blog/20210807/cover.png" class="blog-header__image" alt="ProxyLogon 僅僅只是冰山一角，一個針對 Microsoft Exchange Server 的全新攻擊面！" />
                <h1 class="blog-header__title">
                  ProxyLogon 僅僅只是冰山一角，一個針對 Microsoft Exchange Server 的全新攻擊面！
                </h1>
                <div class="blog-header__tags">
                  
                  <a href="/blog/tag/Advisory/" class="blog-header__tag">Advisory</a><a href="/blog/tag/CVE/" class="blog-header__tag">CVE</a><a href="/blog/tag/RCE/" class="blog-header__tag">RCE</a><a href="/blog/tag/SSRF/" class="blog-header__tag">SSRF</a>
                </div>
          
          
                <p class="blog-header__info">
                  Updated <time class="date">2021-08-07 </time>
                </p>
          
              </section>
              <article class="article">
          <style type="text/css">
    table {
        width: 100%;
        overflow: auto;
        word-break: normal;
        word-break: keep-all;
        font-size: 0.6em;
    }

    table th {
        font-weight: bold
    }

    table th,
    table td {
        padding: 5px 11px;
        border: 1px solid #ddd;
    }

    table tr {
        background-color: #fff;
        border-top: 1px solid #ccc;
    }

    table tr:nth-child(2n) {
        background-color: #f8f8f8;
    }
    .center-image {
        margin: 0 auto;
        display: block;
    }
</style>

<p>Microsoft Exchange Server 作為當今世界上最常見的郵件解決方案，已經幾乎是企業以及政府每日工作與維繫安全不可或缺的一部分！在今年一月，我們回報了一系列的 Exchange Server 漏洞給 Microsoft，並且將這個漏洞它命名為 <a href="https://proxylogon.com/">ProxyLogon</a>，相信如果您有在關注業界新聞，一定也聽過這個名字！ProxyLogon 也許是 Exchange 歷史上最嚴重、影響力也最大的一個漏洞！</p>

<p>隨著更深入的從架構層去研究 ProxyLogon，我們發現它不僅僅只是一個漏洞，而是一整個新的、沒有人提過的攻擊面可讓駭客或安全研究員去挖掘更多的漏洞。因此我們專注深入研究這個攻擊面，並從中發現了至少八個漏洞，這些漏洞涵蓋了伺服器端、客戶端，甚至密碼學漏洞，我們並將這些漏洞組合成了三個攻擊鏈：</p>

<ol>
  <li>ProxyLogon: 最知名、影響力也最大的 Exchange 攻擊鏈</li>
  <li>ProxyOracle: 一個可以還原任意 Exchange 使用者明文密碼的攻擊鏈</li>
  <li>ProxyShell: 我們在 Pwn2Own 2021 上展示打掉 Exchange 的攻擊鏈</li>
</ol>

<p><img src="/assets/img/blog/20210807/1.png" alt="" /></p>

<p>所有我們找到的漏洞都是邏輯漏洞，這代表相較於記憶體毀損類型的漏洞，這些漏洞更容易被重現以及利用，我們也將成果發表至 <a href="https://www.blackhat.com/us-21/briefings/schedule/index.html#proxylogon-is-just-the-tip-of-the-iceberg-a-new-attack-surface-on-microsoft-exchange-server-23442">Black Hat USA</a> 及 <a href="https://defcon.org/html/defcon-29/dc-29-speakers.html#tsai">DEFCON</a> 上，也同時獲得了 2021 Pwnie Awards 年度 Best Server-Side Bug 獎項，如果你有興趣的話可以從這邊下載會議的投影片!</p>

<ul>
  <li>ProxyLogon is Just the Tip of the Iceberg: A New Attack Surface on Microsoft Exchange Server! <a href="https://i.blackhat.com/USA21/Wednesday-Handouts/us-21-ProxyLogon-Is-Just-The-Tip-Of-The-Iceberg-A-New-Attack-Surface-On-Microsoft-Exchange-Server.pdf">[投影片]</a> <a href="https://www.youtube.com/watch?v=5mqid-7zp8k">[影片]</a></li>
</ul>

<p>本次提及的漏洞皆經過負責任的漏洞接露程序回報給微軟、並獲得修復，您可以從下面這張圖查看詳細的漏洞編號及回報時間表。</p>

<table>
  <thead>
    <tr>
      <th style="text-align: center">Report Time</th>
      <th style="text-align: center">Name</th>
      <th style="text-align: center">CVE</th>
      <th style="text-align: center">Patch Time</th>
      <th style="text-align: center">CAS<sup>[1]</sup></th>
      <th style="text-align: center">Reported By</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center">Jan 05, 2021</td>
      <td style="text-align: center">ProxyLogon</td>
      <td style="text-align: center"><a href="https://msrc.microsoft.com/update-guide/vulnerability/CVE-2021-26855">CVE-2021-26855</a></td>
      <td style="text-align: center">Mar 02, 2021</td>
      <td style="text-align: center">Yes</td>
      <td style="text-align: center">Orange Tsai, Volexity and MSTIC</td>
    </tr>
    <tr>
      <td style="text-align: center">Jan 05, 2021</td>
      <td style="text-align: center">ProxyLogon</td>
      <td style="text-align: center"><a href="https://msrc.microsoft.com/update-guide/vulnerability/CVE-2021-27065">CVE-2021-27065</a></td>
      <td style="text-align: center">Mar 02, 2021</td>
      <td style="text-align: center">-</td>
      <td style="text-align: center">Orange Tsai, Volexity and MSTIC</td>
    </tr>
    <tr>
      <td style="text-align: center">Jan 17, 2021</td>
      <td style="text-align: center">ProxyOracle</td>
      <td style="text-align: center"><a href="https://msrc.microsoft.com/update-guide/vulnerability/CVE-2021-31196">CVE-2021-31196</a></td>
      <td style="text-align: center">Jul 13, 2021</td>
      <td style="text-align: center">Yes</td>
      <td style="text-align: center">Orange Tsai</td>
    </tr>
    <tr>
      <td style="text-align: center">Jan 17, 2021</td>
      <td style="text-align: center">ProxyOracle</td>
      <td style="text-align: center"><a href="https://msrc.microsoft.com/update-guide/vulnerability/CVE-2021-31195">CVE-2021-31195</a></td>
      <td style="text-align: center">May 11, 2021</td>
      <td style="text-align: center">-</td>
      <td style="text-align: center">Orange Tsai</td>
    </tr>
    <tr>
      <td style="text-align: center">Apr 02, 2021</td>
      <td style="text-align: center">ProxyShell<sup>[2]</sup></td>
      <td style="text-align: center"><a href="https://msrc.microsoft.com/update-guide/vulnerability/CVE-2021-34473">CVE-2021-34473</a></td>
      <td style="text-align: center">Apr 13, 2021</td>
      <td style="text-align: center">Yes</td>
      <td style="text-align: center">Orange Tsai working with ZDI</td>
    </tr>
    <tr>
      <td style="text-align: center">Apr 02, 2021</td>
      <td style="text-align: center">ProxyShell<sup>[2]</sup></td>
      <td style="text-align: center"><a href="https://msrc.microsoft.com/update-guide/vulnerability/CVE-2021-34523">CVE-2021-34523</a></td>
      <td style="text-align: center">Apr 13, 2021</td>
      <td style="text-align: center">Yes</td>
      <td style="text-align: center">Orange Tsai working with ZDI</td>
    </tr>
    <tr>
      <td style="text-align: center">Apr 02, 2021</td>
      <td style="text-align: center">ProxyShell<sup>[2]</sup></td>
      <td style="text-align: center"><a href="https://msrc.microsoft.com/update-guide/vulnerability/CVE-2021-31207">CVE-2021-31207</a></td>
      <td style="text-align: center">May 11, 2021</td>
      <td style="text-align: center">-</td>
      <td style="text-align: center">Orange Tsai working with ZDI</td>
    </tr>
    <tr>
      <td style="text-align: center">Jun 02, 2021</td>
      <td style="text-align: center">-</td>
      <td style="text-align: center">-</td>
      <td style="text-align: center">-</td>
      <td style="text-align: center">Yes</td>
      <td style="text-align: center">Orange Tsai</td>
    </tr>
    <tr>
      <td style="text-align: center">Jun 02, 2021</td>
      <td style="text-align: center">-</td>
      <td style="text-align: center"><a href="https://msrc.microsoft.com/update-guide/vulnerability/CVE-2021-33768">CVE-2021-33768</a></td>
      <td style="text-align: center">Jul 13, 2021</td>
      <td style="text-align: center">-</td>
      <td style="text-align: center">Orange Tsai and Dlive</td>
    </tr>
  </tbody>
</table>

<div style="font-size:0.6em; line-height: 1.6;">
<br /><em>[1] Bugs relate to this new attack surface direclty</em><br />
<em>[2] Pwn2Own 2021 bugs</em>
</div>

<p>更詳盡的技術細節我們已陸續公布，後續連結會持續更新於本文，敬請期待：</p>
<ul>
  <li><a href="/blog/2021/08/06/a-new-attack-surface-on-MS-exchange-part-1-ProxyLogon/">A New Attack Surface on MS Exchange Part 1 - ProxyLogon!</a></li>
  <li><a href="/blog/2021/08/06/a-new-attack-surface-on-MS-exchange-part-2-ProxyOracle/">A New Attack Surface on MS Exchange Part 2 - ProxyOracle!</a></li>
  <li><a href="/blog/2021/08/22/a-new-attack-surface-on-MS-exchange-part-3-ProxyShell/">A New Attack Surface on MS Exchange Part 3 - ProxyShell!</a></li>
  <li><a href="/blog/2022/10/19/a-new-attack-surface-on-MS-exchange-part-4-ProxyRelay/">A New Attack Surface on MS Exchange Part 4 - ProxyRelay!</a></li>
</ul>


              </article>
              <p class="sns-widgets">
                Share this on <button class="appearance-none sns-widgets__button" id="sns-facebook" type="button">Facebook</button> or <button class="appearance-none sns-widgets__button" id="sns-twitter" type="button">Twitter</button>
              </p>
          
              <div class="heading--side-lined">
                讀者留言
              </div>
              <div class="blog-comments">
                


  <div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_developer = 1;
    var disqus_shortname = 'd3vc0r3'; // required: replace example with your forum shortname
    
    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">blog comments powered by <span class="logo-disqus">Disqus</span></a>




              </div>
            </div>
          </div>






</main>
      <div class="container--wrapper">

        <div class="relative-posts">
          <div class="heading--side-lined container">
            最新消息
          </div>
          <div class="relative-posts__cells">
  
            <section class="card">
              <a href="/blog/2023/01/14/3rd-internship-program-recruit/">
                <div class="card__thumbnail" style="background-image: url(https://devco.re/assets/img/blog/20230114/cover.jpg)"></div>
                <h3 class="card__title">
                  DEVCORE 2023 第三屆實習生計畫
                </h3></a>
              <div class="card__tags">
  
                <a href="/blog/tag/公告/" class="card__tag">公告</a><a href="/blog/tag/徵才/" class="card__tag">徵才</a>
              </div>
              <small class="card__category"><a href="/blog/category/最新消息/">最新消息</a></small>
            </section>
  
            <section class="card">
              <a href="/blog/2023/01/12/DEVCORE-conference-registration-open-now/">
                <div class="card__thumbnail" style="background-image: url(https://devco.re/assets/img/blog/20230112/cover.jpg)"></div>
                <h3 class="card__title">
                  DEVCORE Conference 2023 即日起開放報名
                </h3></a>
              <div class="card__tags">
  
                <a href="/blog/tag/公告/" class="card__tag">公告</a>
              </div>
              <small class="card__category"><a href="/blog/category/最新消息/">最新消息</a></small>
            </section>
  
            <section class="card">
              <a href="/blog/2022/12/23/2022-devcore-national-cyber-security-scholarship-results-announcement/">
                <div class="card__thumbnail" style="background-image: url(https://devco.re/assets/img/blog/20221223/cover.jpg)"></div>
                <h3 class="card__title">
                  DEVCORE 2022 年度全國資訊安全獎學金頒獎餐敘順利落幕
                </h3></a>
              <div class="card__tags">
  
                <a href="/blog/tag/公告/" class="card__tag">公告</a>
              </div>
              <small class="card__category"><a href="/blog/category/最新消息/">最新消息</a></small>
            </section>
  
          </div>
        </div>


        <div class="contact-section container">
          <h2 class="contact-section__title">
            用最真實的攻擊，驗證企業的防禦
          </h2>
          <a href="/contact/" class="home-contact__button button--dense">聯絡我們</a>
        </div>

        <footer class="main-footer">
          <div class="main-footer__about">
            戴夫寇爾提供<br class="mobile-only" /><a href="/services/penetration-test" class="link">滲透測試</a>、<a href="/services/red-team" class="link">紅隊演練</a>、<a href="/services/security-consulting" class="link">資安顧問</a>與<a href="/services/security-training" class="link">教育訓練</a>服務<br />在<a href="https://www.facebook.com/D3VC0RE" class="link" target="_blank">Facebook</a>或<a href="https://twitter.com/d3vc0r3" class="link" target="_blank">Twitter</a>上追蹤我們的<a href="/blog/" class="link">最新訊息</a><br />瞭解更多戴夫寇爾的<a href="/about/" class="link">駭客思維</a>
          </div>
          <div class="main-footer__snses"><a href="https://www.facebook.com/D3VC0RE" class="main-footer__sns" target="_blank">
                <svg class="icon-fb icon"><use xlink:href="#icon-fb" /></svg></a><a href="https://twitter.com/d3vc0r3" class="main-footer__sns" target="_blank">
                <svg class="icon-twitter icon"><use xlink:href="#icon-twitter" /></svg></a>
          </div>
          <address class="main-footer__address">
            <ul class="list--unstyled">
              <li>
                地址 105608 台北市松山區八德路三段 32 號 13 樓
              </li>
              <li>
                Email contact@devco.re
              </li>
              <li>
                電話 02-2577-0925
              </li>
              <li>
                傳真 02-2577-0928
              </li>
              <li>
                統編 53955237
              </li>
            </ul>
          </address><small class="main-footer__copyright"><a href="/" class="logo">DEVCORE</a>©2023 DEVCORE 戴夫寇爾</small>
        </footer>
      </div>
    </div>
    <script src="/assets/themes/devcore-v2/javascripts/webpack_bundle.js"></script>



  <script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-30830800-1']);
  _gaq.push(['_trackPageview', location.pathname + location.search + location.hash]);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>




    <!-- Google Tag Manager (noscript) -->
    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-K5B8NW"
    height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <!-- End Google Tag Manager (noscript) -->

  </body>
</html>




