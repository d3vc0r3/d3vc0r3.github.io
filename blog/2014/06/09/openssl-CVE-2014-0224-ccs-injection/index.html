
<!DOCTYPE html>
<html lang="zh-TW">
  <head>
    <meta charset="utf-8" />
    <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible" />
    <meta content="width=device-width, initial-scale=1" name="viewport" />
    <title>OpenSSL 再爆嚴重漏洞，部分重要網站仍在風險中！ | DEVCORE 戴夫寇爾</title><link href="/assets/themes/devcore-v2/stylesheets/webpack_bundle.css" rel="stylesheet" />
    <link href="/assets/themes/devcore-v2/images/favicon.png" rel="icon" size="32x32">
    <meta name="description" property="og:description" content="OpenSSL 團隊於 6/5 修補了六項安全漏洞，其中 CVE-2014-0224、CVE-2014-0195 兩項被列為 Critical，分別來看看這兩個弱點到底造成了什麼危害。" />
    <meta name="keywords" content="OpenSSL, Vulnerability, CVE" />
    <meta property="og:site_name" content="DEVCORE 戴夫寇爾" />
    <meta property="og:title" content="OpenSSL 再爆嚴重漏洞，部分重要網站仍在風險中！ | DEVCORE 戴夫寇爾" />
    <meta property="og:url" content="https://devco.re/blog/2014/06/09/openssl-CVE-2014-0224-ccs-injection/" />
    <meta property="og:type" content="website" />
    
    <meta name="twitter:card" content="summary">
    <meta name="twitter:site" content="d3vc0r3">
    <meta name="twitter:title" content="OpenSSL 再爆嚴重漏洞，部分重要網站仍在風險中！ | DEVCORE 戴夫寇爾">
    <meta name="twitter:description" content="OpenSSL 團隊於 6/5 修補了六項安全漏洞，其中 CVE-2014-0224、CVE-2014-0195 兩項被列為 Critical，分別來看看這兩個弱點到底造成了什麼危害。">
    <meta name="twitter:creator" content="d3vc0r3">
    
    <meta name="twitter:domain" content="devco.re">
    <meta name="google-site-verification" content="lMNi_XT6UmeGqeYI_vLHu5PDRi_uNVfnA2NdDGS4-lM" />
    <meta name="msvalidate.01" content="119FDBB7730BE45B162515BBB1FF6B33" />
    <meta name="alexaVerifyID" content="j-Es9N9SD7ckfA2EokOz9SZzhok" />
    <meta name='yandex-verification' content='4561963cf1d18fe3' />
    <meta property="fb:admins" content="120968921404653" />

    <link rel="canonical" href="https://devco.re/blog/2014/06/09/openssl-CVE-2014-0224-ccs-injection/"/>
    <link rel="alternate" type="application/rss+xml" title="DEVCORE 戴夫寇爾" href="https://devco.re/rss">

    <!-- Google Tag Manager -->
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
    new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
    j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
    'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-K5B8NW');</script>
    <!-- End Google Tag Manager -->
  </head>
  <body>
    <div class="page">
      <div class="container--wrapper">
        <div class="topbar">
          <div class="topbar__brand">
            <a href="/">
                <div class="logo">
                  DEVCORE 戴夫寇爾
                </div></a>
            <p class="slogan">
              我們提供<a href="/services/penetration-test" class="link">滲透測試</a>、<a href="/services/red-team" class="link">紅隊演練</a>、<a href="/services/security-consulting" class="link">資安顧問</a>與<a href="/services/security-training" class="link">教育訓練</a>服務
            </p>
          </div>
          <div class="drawer" id="drawer">
            <div class="drawer__container">
              <nav class="main-menu">
                <div class="hidden">
                  主選單
                </div>
                <a href="/services/penetration-test" class="main-menu__link mobile-only">滲透測試</a>
                <a href="/services/red-team" class="main-menu__link mobile-only">紅隊演練</a>
                <a href="/services/security-consulting" class="main-menu__link mobile-only">資安顧問</a>
                <a href="/services/security-training" class="main-menu__link mobile-only">教育訓練</a>
                <a href="/about/" class="main-menu__link">駭客思維</a><a href="/blog/" class="main-menu__link">最新訊息</a><a href="/search/" class="main-menu__link main-menu__search desktop-only"><span class="hidden">搜尋</span><svg class="icon-search icon"><use xlink:href="#icon-search" /></svg></a>
              </nav>
              <a href="/contact/" class="drawer__contact button--dense">聯絡我們</a>
              <nav class="lang-menu">
                <div class="lang-menu__label">
                  語言:
                </div>
                <a href="/" class="lang-menu__link">中文</a>
                <a href="/en/" class="lang-menu__link">English</a>
              </nav>
            </div>
          </div><span class="topbar__menu mobile-only">menu</span><button class="appearance-none topbar__hamburger mobile-only" data-toggle="#drawer" id="drawer-toggle" type="button">
            <div class="bars">
              <div class="bar"></div>
              <div class="bar"></div>
              <div class="bar"></div>
            </div>
          </button>
        </div>
      </div><main role="main">


          <div class="container--wrapper">
            <div class="container">
              <section class="blog-header">
                <small class="blog-header__category"><a href="/blog/category/資安新聞/">資安新聞</a></small>
                
                <h1 class="blog-header__title">
                  OpenSSL 再爆嚴重漏洞，部分重要網站仍在風險中！
                </h1>
                <div class="blog-header__tags">
                  
                  <a href="/blog/tag/OpenSSL/" class="blog-header__tag">OpenSSL</a><a href="/blog/tag/Vulnerability/" class="blog-header__tag">Vulnerability</a><a href="/blog/tag/CVE/" class="blog-header__tag">CVE</a>
                </div>
          
          
                <p class="blog-header__info">
                  By <span class="blog-author-photo" style="background-image: url(/assets/themes/devcore-v2/images/avatar/shaolinhsu.jpg)"></span> <a href="/blog/author/shaolin" class="author-name">Shaolin</a> <time class="date">on 2014-06-09 </time>
                </p>
          
              </section>
              <article class="article">
          <p>(本篇最後更新時間：2014.6.9 15:40 pm)</p>

<p>OpenSSL 團隊於 6/5 修補了<a href="http://www.openssl.org/news/secadv_20140605.txt">六項安全漏洞</a>，<a href="http://www.sans.org/about/">SANS</a> 在<a href="https://isc.sans.edu/diary/Critical+OpenSSL+Patch+Available+Patch+Now/18211">這篇文章</a>中整理了這幾個漏洞的摘要，這裡截圖表格如下：</p>

<p><a href="/assets/img/blog/20140609/openssl_0605_table.png"><img src="/assets/img/blog/20140609/openssl_0605_table.png" alt="OpenSSL 0605 安全更新比較表" /></a></p>

<p>其中 CVE-2014-0224、CVE-2014-0195 兩項被列為 Critical，我們分別來看看這兩個弱點到底造成了什麼危害。</p>

<!-- more -->

<h3 id="cve-2014-0224-ccs-injection-vulnerability">CVE-2014-0224 (CCS Injection Vulnerability)</h3>

<h4 id="說明">說明</h4>

<p>加密通訊被視為預防<a href="http://zh.wikipedia.org/wiki/%E4%B8%AD%E9%97%B4%E4%BA%BA%E6%94%BB%E5%87%BB">中間人攻擊</a>的解法之一，利用 SSL 協定防止竊聽、竄改傳輸資料是一種常見的方式。然而 OpenSSL 這次出現在 ChangeCipherSpec（更改密鑰規格）的設計瑕疵，讓攻擊者有辦法解密所有通訊內容，讓加密保護徹底失效。</p>

<p>該弱點原理是 OpenSSL 伺服器端在實作 handshake 時並未檢查訊息的順序（嚴格來說是 ChangeCipherSpec 的順序），所以攻擊者可以提前送出 ChangeCipherSpec 訊息，使伺服器在還未初始完畢的狀態先去做 ChangeCipherSpec 的動作，最終造成加解密可解的狀況，是以此弱點稱之為 CCS Injection。更多的細節請參考原通報者 Masashi Kikuchi 的<a href="http://ccsinjection.lepidum.co.jp/blog/2014-06-05/CCS-Injection-en/index.html">部落格</a>，佐以<a href="https://www.imperialviolet.org/2014/06/05/earlyccs.html">這篇</a>附程式碼的解說，OpenSSL github 上關於 CVE-2014-0224 的 <a href="https://github.com/openssl/openssl/commit/a91be10833e61bcdc9002de28489405101c52650">fix</a> 也可以幫助了解。</p>

<h4 id="誰應該注意">誰應該注意</h4>

<p>所有靠 OpenSSL 保護連線的應用服務都需要注意。又尤其是銀行、金流服務這些連線中存在金融資訊的服務，若不注意會造成信用卡卡號洩漏，網路銀行被盜用。經過實際檢測，<strong>目前仍有銀行單位和金流單位使用有問題的 OpenSSL 版本</strong>。消費者需要特別注意，在使用前也可透過下面小工具來輔助檢查自己所使用的服務使否存在風險：</p>

<ul>
  <li>Tripwire 提供的<a href="http://www.tripwire.com/state-of-security/incident-detection/detection-script-for-cve-2014-0224-openssl-cipher-change-spec-injection/">小程式</a> (python)</li>
  <li>測試網站 <a href="http://ccsbug.exposed/">http://ccsbug.exposed/</a></li>
</ul>

<p>慶幸的是，此弱點只發生在用戶端及伺服器端皆使用有問題 OpenSSL 版本的狀況下。一般來說，桌面端的瀏覽器都不是使用 OpenSSL，所以一般使用者可以稍微安心。問題比較大的是 android 使用者，android 內建 OpenSSL，許多 app 呼叫它來進行加密傳輸，所以建議 android 用戶在 google 釋出更新前，不要使用手機連線到有問題的服務，或使用自帶 SSL 的 app，例如：firefox、最新版 Chrome (35.0.1916.141)…。</p>

<p>另外，若使用者常用到一些加密連線服務，例如 VPN，請自行注意所使用軟體是否使用 OpenSSL，以免受到 CCS Injection 的影響。</p>

<p><a href="/assets/img/blog/20140609/logo.png"><img src="/assets/img/blog/20140609/logo.png" alt="CCS Injection Vulnerability" /></a></p>

<p>最後說個題外話，原來現在發表漏洞還要為漏洞出張圖，在 Hacker News 原討論串的<a href="https://news.ycombinator.com/item?id=7851357#up_7851735">這篇回應</a>，就有人說：『這個漏洞有 logo 嗎？如果沒有我就不打算認真看待它！』XD</p>

<h3 id="cve-2014-0195-dtls-arbitrary-code-execution">CVE-2014-0195 (DTLS arbitrary code execution)</h3>

<h4 id="說明-1">說明</h4>

<p>OpenSSL 在處理 <a href="http://en.wikipedia.org/wiki/Datagram_Transport_Layer_Security">DTLS</a> 訊息上，為了避免 IP fragmentation，所以做了一些處理機制，這個處理機制並沒有好好驗證 DLTS ClientHello 中的 fragment 長度（嚴格來說是在正確的位置做驗證），若攻擊者發送一個很長的 fragment，能造成緩衝區溢位攻擊。更多的細節請參考<a href="http://h30499.www3.hp.com/t5/HP-Security-Research-Blog/ZDI-14-173-CVE-2014-0195-OpenSSL-DTLS-Fragment-Out-of-Bounds/ba-p/6501002#.U5FqnvmSyD4">這篇文章</a>。</p>

<p>比較有趣的是那段出問題的程式碼是一位有名德國工程師 Robin Seggelmann 寫的，有名的點在於上次非常嚴重的 <a href="http://devco.re/blog/2014/04/09/openssl-heartbleed-CVE-2014-0160/">Heartbleed</a> 事件也是他寫的 code XD</p>

<h4 id="誰應該注意-1">誰應該注意</h4>

<p>使用 OpenSSL 且有用到 DTLS 的服務提供者，通常是 VoIP、WebRTC、VPN 這類服務，這個風險有可能會造成伺服器被入侵。</p>

<h3 id="修補">修補</h3>

<p>除了上面所提及兩個嚴重風險，這次的更新也同時修復了幾個 DOS 的弱點，強烈建議伺服器端更新。<br />
請確認 OpenSSL 已經更新到下面版本，並且有重新啟動讓其生效。</p>
<ul>
  <li>OpenSSL 0.9.8za</li>
  <li>OpenSSL 1.0.0m</li>
  <li>OpenSSL 1.0.1h</li>
</ul>

<p>更新資訊依據所用的系統分別如下：</p>
<ul>
  <li><a href="http://www.ubuntu.com/usn/usn-2232-1/">Ubuntu</a></li>
  <li><a href="https://lists.debian.org/debian-security-announce/2014/msg00129.html">Debian</a></li>
  <li><a href="https://www.freebsd.org/security/advisories/FreeBSD-SA-14:14.openssl.asc">FreeBSD</a></li>
  <li><a href="http://lists.centos.org/pipermail/centos-announce/2014-June/020344.html">CentOS</a></li>
  <li><a href="https://rhn.redhat.com/errata/RHSA-2014-0624.html">Red Hat 5</a></li>
  <li><a href="https://rhn.redhat.com/errata/RHSA-2014-0625.html">Red Hat 6</a></li>
  <li><a href="https://aws.amazon.com/jp/security/security-bulletins/openssl-security-advisory/">Amazon Linux AMI</a></li>
</ul>

<h3 id="小結">小結</h3>

<p>這次 OpenSSL 做了數個安全性的更新，雖然不若<a href="http://devco.re/blog/2014/04/11/openssl-heartbleed-how-to-hack-how-to-protect/">之前 Heartbleed 那麼嚴重</a>，但卻也讓使用者暴露在風險中。建議有使用 OpenSSL 都應該更新到最新版本，尤其是一些大型的銀行及金流服務，更應儘速更新。</p>

              </article>
              <p class="sns-widgets">
                Share this on <button class="appearance-none sns-widgets__button" id="sns-facebook" type="button">Facebook</button> or <button class="appearance-none sns-widgets__button" id="sns-twitter" type="button">Twitter</button>
              </p>
          
              <div class="heading--side-lined">
                About <span class="blog-author-photo" style="background-image: url(/assets/themes/devcore-v2/images/avatar/shaolinhsu.jpg)"></span> <a href="/blog/author/shaolin" class="blog-author-name">Shaolin</a> 
              </div>
              <p class="blog-author-info">
                喜愛資訊技術、喜歡跟別人走不一樣的路。有一點點智障的熱血人，期望能利用資訊的力量對世界有所貢獻。
              </p>
          
              <div class="heading--side-lined">
                讀者留言
              </div>
              <div class="blog-comments">
                


  <div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_developer = 1;
    var disqus_shortname = 'd3vc0r3'; // required: replace example with your forum shortname
    
    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">blog comments powered by <span class="logo-disqus">Disqus</span></a>




              </div>
            </div>
          </div>






</main>
      <div class="container--wrapper">

        <div class="relative-posts">
          <div class="heading--side-lined container">
            最新消息
          </div>
          <div class="relative-posts__cells">
  
            <section class="card">
              <a href="/blog/2021/06/22/devcore-202106-recruit/">
                <div class="card__thumbnail" style="background-image: url(https://devco.re/assets/img/blog/20150819/devcore_office_1.jpg)"></div>
                <h3 class="card__title">
                  DEVCORE 徵求紅隊演練工程師
                </h3></a>
              <div class="card__tags">
  
                <a href="/blog/tag/公告/" class="card__tag">公告</a><a href="/blog/tag/徵才/" class="card__tag">徵才</a>
              </div>
              <small class="card__category"><a href="/blog/category/最新消息/">最新消息</a></small>
            </section>
  
            <section class="card">
              <a href="/blog/2020/10/30/devcore-wargame-at-hitcon-2020/">
                <div class="card__thumbnail" style="background-image: url(https://devco.re/assets/img/blog/20201030/cover.png)"></div>
                <h3 class="card__title">
                  DEVCORE Wargame at HITCON 2020
                </h3></a>
              <div class="card__tags">
  
                <a href="/blog/tag/PHP/" class="card__tag">PHP</a><a href="/blog/tag/RCE/" class="card__tag">RCE</a>
              </div>
              <small class="card__category"><a href="/blog/category/技術專欄/">技術專欄</a></small>
            </section>
  
            <section class="card">
              <a href="/blog/2020/10/13/mitigate-real-threats-by-framework-and-standards/">
                <div class="card__thumbnail" style="background-image: url(https://devco.re/assets/img/blog/20201013/5.png)"></div>
                <h3 class="card__title">
                  你的資安策略夠明確嗎？透過框架優先緩解真實威脅
                </h3></a>
              <div class="card__tags">
  
                <a href="/blog/tag/Strategy/" class="card__tag">Strategy</a>
              </div>
              <small class="card__category"><a href="/blog/category/科普文章/">科普文章</a></small>
            </section>
  
          </div>
        </div>


        <div class="contact-section container">
          <h2 class="contact-section__title">
            用最真實的攻擊，驗證企業的防禦
          </h2>
          <a href="/contact/" class="home-contact__button button--dense">聯絡我們</a>
        </div>

        <footer class="main-footer">
          <div class="main-footer__about">
            戴夫寇爾提供<br class="mobile-only" /><a href="/services/penetration-test" class="link">滲透測試</a>、<a href="/services/red-team" class="link">紅隊演練</a>、<a href="/services/security-consulting" class="link">資安顧問</a>與<a href="/services/security-training" class="link">教育訓練</a>服務<br />在<a href="https://www.facebook.com/D3VC0RE" class="link" target="_blank">Facebook</a>或<a href="https://twitter.com/d3vc0r3" class="link" target="_blank">Twitter</a>上追蹤我們的<a href="/blog/" class="link">最新訊息</a><br />瞭解更多戴夫寇爾的<a href="/about/" class="link">駭客思維</a>
          </div>
          <div class="main-footer__snses"><a href="https://www.facebook.com/D3VC0RE" class="main-footer__sns" target="_blank">
                <svg class="icon-fb icon"><use xlink:href="#icon-fb" /></svg></a><a href="https://twitter.com/d3vc0r3" class="main-footer__sns" target="_blank">
                <svg class="icon-twitter icon"><use xlink:href="#icon-twitter" /></svg></a>
          </div>
          <address class="main-footer__address">
            <ul class="list--unstyled">
              <li>
                地址 105608 台北市松山區八德路三段 32 號 13 樓
              </li>
              <li>
                Email contact@devco.re
              </li>
              <li>
                電話 02-2577-0925
              </li>
              <li>
                傳真 02-2577-0928
              </li>
              <li>
                統編 53955237
              </li>
            </ul>
          </address><small class="main-footer__copyright"><a href="/" class="logo">DEVCORE</a>©2021 DEVCORE 戴夫寇爾</small>
        </footer>
      </div>
    </div>
    <script src="/assets/themes/devcore-v2/javascripts/webpack_bundle.js"></script>



  <script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-30830800-1']);
  _gaq.push(['_trackPageview', location.pathname + location.search + location.hash]);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>




    <!-- Google Tag Manager (noscript) -->
    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-K5B8NW"
    height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <!-- End Google Tag Manager (noscript) -->

  </body>
</html>




