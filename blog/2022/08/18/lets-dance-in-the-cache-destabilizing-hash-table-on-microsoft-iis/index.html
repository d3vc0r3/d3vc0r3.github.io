

<!DOCTYPE html>
<html class="no-js sub-menu">

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta charset="utf-8" />
    <!-- web fullscreen -->
    <meta name="apple-mobile-web-app-capable" content="yes"><!-- ios -->
    <meta name="mobile-web-app-capable" content="yes"><!-- android -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0,user-scalable=0" />
    <meta name="format-detection" content="telephone=no">
    <title>Let's Dance in the Cache - Destabilizing Hash Table on Microsoft IIS | DEVCORE</title>
    <link rel="stylesheet" href="/css/style.css" />
    <script src="/js/modernizr-custom.js"></script>
    <script src="/js/jquery-3.6.0.min.js"></script>
    <script src="/js/site.js"></script>
    <link rel="stylesheet" href="/fonts/inter.css" />
    <link rel="stylesheet" href="/css/highlighter.css" />
    <!-- <script src="https://cdn.jsdelivr.net/gh/google/code-prettify@master/loader/run_prettify.js"></script> -->
</head>
<body class="en">
    <!-- 導覽列 start -->
    <header class="header">
<div class="container">
    <!-- logo start -->
    <div class="logo">
        <a href="/en/">
            <img src="/images/logo.svg"/>
        </a>
    </div>
    <!-- logo end -->
    <!-- 主選單 start -->
    <nav class="nav">
        <ul class="menu">
            <li class="dropdown">
                <div class="menuLable">
                    <span>Services<i class="icon arrow_down"></i></span>

                    <div class="menuItem">
                        <a href="/en/services/red-team/">
                            <div class="item">

                                <h2>
                                    <i class="icon menu service-red-team"></i>
                                    Red Team Assessment
                                </h2>
                                <p class="two-line">
                                    Perform comprehensive attack simulation from unlimited aspects to achieve the designated drill scenario without impacting enterprise operations.
                                </p>
                            </div>
                        </a>
                        <a href="/en/services/penetration-test/">
                            <div class="item">
                                <h2>
                                    <i class="icon menu service-penetration-test"></i>
                                    Penetration Testing
                                </h2>
                                <p class="two-line">
                                    Infiltrate designated enterprise systems with hacker mindset and techniques to uncover potential vulnerabilities, assessing the risk of breach or damage to enterprise assets.
                                </p>
                            </div>
                        </a>
                        <a href="/en/services/security-consulting/">
                            <div class="item">
                                <h2>
                                    <i class="icon menu service-security-consulting"></i>
                                    Security Consulting
                                </h2>
                                <p class="two-line">
                                    Assist enterprises in resource distribution and long-term defensive strategy development from the attacker's perspective based on red team assessment.
                                </p>
                            </div>
                        </a>
                        <a href="/en/services/security-training/">
                            <div class="item">
                                <h2>
                                    <i class="icon menu service-security-training"></i>
                                    Security Training
                                </h2>
                                <p class="two-line">
                                    Assist enterprises in defending and preventing incidents efficiently from the attacker's perspective, including response procedures and analysis of attack targets, techniques, and vulnerabilities.
                                </p>
                            </div>
                        </a>

                    </div>
                </div>
            </li>

            <li class="dropdown">
                <div class="menuLable">
                    <span>Research<i class="icon arrow_down"></i></span>

                    <div class="menuItem">
                        <a href="/en/research/overview/">
                            <div class="item">
                                <h2>
                                    <i class="icon menu search-circle"></i>
                                    Overview
                                </h2>
                                <p class="two-line">
                                    Research leading cybersecurity techniques and trends, perform comprehensive security assessments of enterprise products, and evolve the red team with broad experience.
                                </p>
                            </div>
                        </a>
                        <a href="/en/research/awards/">
                            <div class="item">
                                <h2>
                                    <i class="icon menu badge-check"></i>
                                    Competitions and Awards
                                </h2>
                                <p class="two-line">
                                    Awards from international cybersecurity competitions.
                                </p>
                            </div>
                        </a>
                        <a href="/en/research/bug-bounty/">
                            <div class="item">
                                <h2>
                                    <i class="icon menu puzzle"></i>
                                    Enterprise Vulnerability Reports
                                </h2>
                                <p class="two-line">
                                    Research into the risk of enterprise systems, identify potential weaknesses, and report to vendors.
                                </p>
                            </div>
                        </a>
                        <a href="/en/research/talks/">
                            <div class="item">
                                <h2>
                                    <i class="icon menu globe"></i>
                                    International Conferences
                                </h2>
                                <p class="two-line">
                                    Publish vulnerability research and share security knowledge at international cybersecurity conferences.
                                </p>
                            </div>
                        </a>
                        <a href="/en/research/cve/">
                            <div class="item">
                                <h2>
                                    <i class="icon menu view-list"></i>
                                    CVE List
                                </h2>
                                <p class="two-line">
                                    Uncover and report critical vulnerabilities in leading international products and services.
                                </p>
                            </div>
                        </a>
                    </div>
                </div>


            </li>

            <li class="dropdown">
                <div class="menuLable" href="#">
                    <span>Company<i class="icon arrow_down"></i></span>

                    <div class="menuItem">
                        <a href="/en/company/about/">
                        <div class="item">
                            <h2>
                                <i class="icon menu company"></i>
                                Company Overview
                            </h2>
                            <p>
                                DEVCORE was founded by a world-class white hat hacker team, providing cybersecurity services and focusing on Red Team Assessment and Penetration Testing services.
                            </p>
                        </div>
                        </a>
                        <a href="/en/company/our-team/">
                            <div class="item">
                                <h2>
                                    <i class="icon menu team"></i>
                                    Team Members
                                </h2>
                                <p class="two-line">
                                    A team of experts with a hacker mindset, exploring new exploitation techniques, and upholding strict morality, self-discipline, and caution.
                                </p>
                            </div>
                        </a>
                        <a href="/en/company/history/">
                            <div class="item">
                                <h2>
                                    <i class="icon menu milestone"></i>
                                    Achievements
                                </h2>
                                <p class="two-line">
                                    The history, research achievements, and award information of DEVCORE.
                                </p>
                            </div>
                        </a>
                        <a href="/en/company/csr/">
                            <div class="item">
                                <h2>
                                    <i class="icon menu heart"></i>
                                    Corporate Social Responsibility
                                </h2>
                                <p class="two-line">
                                    Provide diverse internship channels and scholarship programs to nurture the next generation and promote cybersecurity awareness.
                                </p>
                            </div>
                        </a>
                        <a href="/en/company/jobs/">
                            <div class="item">
                                <h2>
                                    <i class="icon menu briefcase"></i>
                                    Job Opportunities
                                </h2>
                                <p class="two-line">
                                    Join us to secure the world and improve the cybersecurity industry together.
                                </p>
                            </div>
                        </a>
                    </div>
                </div>
            </li>
            <li class="dropdown">
                <div class="menuLable">
                    <span>News<i class="icon arrow_down"></i></span>
                    <div class="menuItem">
                        <a href="/en/blog/">
                            <div class="item">
                                <h2>
                                    <i class="icon menu newspaper"></i>
                                    BLOG
                                </h2>
                                <p>
                                    Latest news
                                </p>
                            </div>
                        </a>
                        <a href="/en/media-kit/">
                            <div class="item">
                                <h2>
                                    <i class="icon menu download"></i>
                                    Media Resources
                                </h2>
                                <p>
                                    Guidelines for the use of the DEVCORE trademark.
                                </p>
                            </div>
                        </a>
                    </div>
                </div>
            </li>
            <li>
                <a class="menuLable" href="/en/search/">Search</a>
            </li>
            <li>
                <a class="menuLable" href="/en/contact/">Contact</a>
            </li>
        </ul>
    </nav>
    <!-- 主選單 end -->
</div>


<!-- 手機板選單  start-->
<nav class="nav-m" id="menu-m">
    <ul class="menu">
        <li>
            <div class="menuLable">
                <span>Services</span>
                <div class="menuItem">
                    <a href="/en/services/red-team/" class="fullwidth">
                        <div class="item">
                            <h2>
                                <i class="icon service-red-team"></i>
                                Red Team Assessment
                            </h2>
                        </div>
                    </a>
                    <a href="/en/services/penetration-test/" class="fullwidth">
                        <div class="item">
                            <h2>
                                <i class="icon service-penetration-test"></i>
                                Penetration Testing
                            </h2>
                        </div>
                    </a>
                    <a href="/en/services/security-consulting/" class="fullwidth">
                        <div class="item">
                            <h2>
                                <i class="icon service-security-consulting"></i>
                                Security Consulting
                            </h2>
                        </div>
                    </a>
                    <a href="/en/services/security-training/" class="fullwidth">
                        <div class="item">
                            <h2>
                                <i class="icon service-security-training"></i>
                                Security Training
                            </h2>
                        </div>
                    </a>
                </div>
            </div>
        </li>
        <li>
            <div class="menuLable">
                <span>Research</span>
                <div class="menuItem">
                    <a href="/en/research/overview/" class="fullwidth">
                        <div class="item">
                            <h2>Overview</h2>
                        </div>
                    </a>
                    <a href="/en/research/awards/">
                        <div class="item">
                            <h2>Competitions and Awards</h2>
                        </div>
                    </a>
                    <a href="/en/research/bug-bounty/">
                        <div class="item">
                            <h2>Enterprise Vulnerability Reports</h2>
                        </div>
                    </a>
                    <a href="/en/research/talks/">
                        <div class="item">
                            <h2>International Conferences</h2>
                        </div>
                    </a>
                    <a href="/en/research/cve/">
                        <div class="item">
                            <h2>CVE List</h2>
                        </div>
                    </a>
                </div>
            </div>
        </li>

        <li>
            <div class="menuLable">
                <span>Company</span>
                <div class="menuItem">
                    <a href="/en/company/about/" class="fullwidth">
                        <div class="item">
                            <h2>Company Overview</h2>
                        </div>
                    </a>
                    <a href="/en/company/our-team/">
                        <div class="item">
                            <h2>Team Members</h2>
                        </div>
                    </a>
                    <a href="/en/company/history/">
                        <div class="item">
                            <h2>Achievements</h2>
                        </div>
                    </a>
                    <a href="/en/company/csr/">
                        <div class="item">
                            <h2>Corporate Social Responsibility</h2>
                        </div>
                    </a>
                    <a href="/en/company/jobs/">
                        <div class="item">
                            <h2>Job Opportunities</h2>
                        </div>
                    </a>
                </div>
            </div>
        </li>
        <li>
            <div class="menuLable">
                <span>News</span>
                <div class="menuItem">
                    <a href="/en/blog/">
                        <div class="item">
                            <h2>BLOG</h2>
                        </div>
                    </a>
                    <a href="/en/media-kit/">
                        <div class="item">
                            <h2>Media Resources</h2>
                        </div>
                    </a>
                </div>
            </div>
        </li>
        <li>
            <div class="menuLable">
                <div class="menuItem">
                    <a href="/en/search/" class="fullwidth">
                        <div class="item">
                            <h2 class="center">
                                <i class="icon search"></i>
                                Search
                            </h2>
                        </div>
                    </a>
                    <a href="/en/contact/" class="fullwidth">
                        <div class="item">
                            <h2 class="center">
                                <i class="icon chat-alt"></i>
                                Contact
                            </h2>
                        </div>
                    </a>
                </div>
            </div>
        </li>
        <li>
            <div class="menuLable">
                <span><i class="icon translate"></i>Language</span>
                <div class="menuItem">
                    <a href="/">
                    <div class="item">
                        <h2>中文</h2>
                    </div>
                    </a>
                    <a href="/en">
                        <div class="item">
                            <h2>English</h2>
                        </div>
                    </a>
                </div>
            </div>
        </li>
    </ul>
</nav>
<!-- 手機板選單  end-->
    </header>
    <!-- 導覽列 end -->

    <!-- tab 選單 start -->
    <div class="sub-nav">
        <div class="container">
            <h1>BLOG</h1>
            <ul class="tab">
                <li>
                    <a href="/en/blog/">All Articles</a>
                </li>
                <li>
                    <a href="/en/blog/category/Tech%20Editorials/">Tech Editorials</a>
                </li>
                <li>
                    <a href="/en/media-kit/">Media Resources</a>
                </li>
            </ul>
        </div>
    </div>
    <!-- tab 選單 end -->
    
    <div class="main">
        <!-- 文章外層layer -->
        <section class="narrow">
            <!-- 文章 start -->
            <article class="article_body">
                <div class="content">
                    <a class="category" href="/en/blog/category/Tech Editorials">Tech Editorials</a>
                    <span class="tag">

                      <a href="/en/blog/tag/CVE/">#CVE</a> <a href="/en/blog/tag/BugBounty/">#BugBounty</a> <a href="/en/blog/tag/Vulnerability/">#Vulnerability</a> 
                    </span>
                    <h1>
                        Let's Dance in the Cache - Destabilizing Hash Table on Microsoft IIS
                    </h1>
                    
                    
                    <div class="author_detail">
                        <span class="avatar">
                            <a href="/en/blog/author/orange">
                                <div class="circle">
                                    <i class="user" style="background-image: url('/assets/img/avatar/orig/orange.png');" ></i>
                                </div>
                            </a>
                        </span>
                        <span class="author"><a href="/en/blog/author/orange">Orange Tsai</a></span>
                        <span class="date">2022-08-18</span>
                    </div>
                    
                    
                    <div class="article_img">
                        <img src="https://devco.re/assets/img/blog/20220818/cover.png"/>
                    </div>
                    

                    <hr>

                    <!-- 文章內容 -->
                    <div class="article_content">
<p>Hi, this is my fifth time speaking at <a href="https://www.blackhat.com/us-22/briefings/schedule/index.html#lets-dance-in-the-cache---destabilizing-hash-table-on-microsoft-iis-27199">Black Hat USA</a> and <a href="https://forum.defcon.org/node/241837">DEFCON</a>. You can get the slide copy and video there:</p>
<ul>
  <li><a href="https://i.blackhat.com/USA-22/Wednesday/US-22-Tsai-Lets-Dance-in-the-Cache-Destabilizing-Hash-Table-on-Microsoft-IIS.pdf">Let’s Dance in the Cache - Destabilizing Hash Table on Microsoft IIS (slides)</a></li>
  <li><a href="#TBD">Let’s Dance in the Cache - Destabilizing Hash Table on Microsoft IIS (video - TBD)</a></li>
</ul>

<p>As the most fundamental Data Structure in Computer Science, Hash Table is extensively used in Computer Infrastructures, such as Operating Systems, Programming Languages, Databases, and Web Servers. Also, because of its importance, Microsoft has designed its own Hash Table algorithm from a very early stage, and applied it heavily to its web server, IIS.</p>

<p>Since IIS does not release its source code, I guess the algorithm implementation details should be an unexplored area to discover bugs. Therefore, <strong>this research mainly focuses on the Hash Table implementation and its usage</strong>. We also look into the Cache mechanism because most of the Hash Table usages in IIS are Cache-Related!</p>

<p>Because most of the details are in the slides, please forgive me this time for this brief write-ups instead of a full blog.</p>

<ul>
  <li><a href="https://msrc.microsoft.com/update-guide/vulnerability/CVE-2022-22025">CVE-2022-22025</a> - Microsoft IIS Hash-Flooding DoS</li>
  <li><a href="https://msrc.microsoft.com/update-guide/vulnerability/CVE-2022-22040">CVE-2022-22040</a> - Microsoft IIS Cache Poisoning Attack</li>
  <li><a href="https://msrc.microsoft.com/update-guide/vulnerability/CVE-2022-30209">CVE-2022-30209</a> - Microsoft IIS Authentication Bypass</li>
</ul>

<p><br /></p>

<p><em>P.S. All vulnerabilities addressed in this blog have been reported responsibly to Microsoft and patched in July 2022.</em></p>

<h2 id="1-iis-hash-flooding-dos">1. IIS Hash-Flooding DoS</h2>

<p>It’s hard to imagine that we can still see such a classic Algorithmic Complexity Attack as Hash-Flooding Attack in IIS in 2022. Although Microsoft has configured a thread deleting outdated records every 30 seconds to mitigate the attack, we still found a key-splitting bug in the implementation to <strong>amplify our power by over 10 times to defeat the guardian by zero hashes</strong>. Through this bug we can <strong>make a default installed IIS Server unresponsive</strong> with about 30 connections per second!</p>

<p>Because this bug also qualifies for the <a href="https://www.microsoft.com/en-us/msrc/bounty-windows-insider-preview">Windows Insider Preview Bounty Program</a>, we also rewarded $30,000 for this DoS. This is the maximum bounty for the category of Denial-of-Service!</p>

<p>You can check the full demo video here:</p>

<iframe width="560" height="315" src="https://www.youtube.com/embed/VtnDkzYPNCk" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe>

<h2 id="2-iis-cache-poisoning-attack">2. IIS Cache Poisoning Attack</h2>

<p>Compared with other <a href="https://portswigger.net/research/practical-web-cache-poisoning">marvelous Cache Poisoning research</a>, this one is relatively plain. The bug is found in the component of Output Caching, the module responsible for caching dynamic responses to reduce expensive database or filesystem access on web stacks.</p>

<p>Output Caching uses a bad Query String parser that only takes the first occurrence as the Cache-Key when Query String keys are duplicated. This behavior is actually not a problem independently. However, it’s a trouble in the view of the whole architecture with the backend, ASP.NET. The backend concatenates the value of all repeated keys together, which leads to an inconsistency between parser behaviors. Therefore, <strong>a classic HTTP Parameter Pollution can make IIS cache the wrong result</strong>!</p>

<h2 id="3-iis-authentication-bypass">3. IIS Authentication Bypass</h2>

<p>This may be the most interesting bug of this talk. LKRHash is a Hash Table algorithm designed and <a href="https://patents.google.com/patent/US6578131">patented</a> by Microsoft in 1997. It’s based on <a href="https://en.wikipedia.org/wiki/Linear_hashing">Linear Hashing</a> and created by <a href="https://en.wikipedia.org/wiki/Paul_Larson">Paul Larson</a> of Microsoft Research, Murali Krishnan and George Reilly of the IIS team.</p>

<p>LKRHash aims to build a scalable and high-concurrent Hash Table under the multithreading and multi-core environment. The creators put a lot of effort into making this implementation portable, flexible and customizable to adapt to multiple products across Microsoft. An application can define its own Table-Related functions, such as the Hash Function, the Key Extracting Function, or the Key Comparing Function. This kind of extensibility creates a bunch of opportunities for vulnerability mining. So, under this context, we cares more about the relationship between the records, the keys, and the functions.</p>

<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">CLKRHashTable</span><span class="o">::</span><span class="n">CLKRHashTable</span><span class="p">(</span>
    <span class="n">this</span><span class="p">,</span>
    <span class="s">"TOKEN_CACHE"</span><span class="p">,</span>   <span class="c1">// An identifier for debugging</span>
    <span class="n">pfnExtractKey</span><span class="p">,</span>   <span class="c1">// Extract key from record</span>
    <span class="n">pfnCalcKeyHash</span><span class="p">,</span>  <span class="c1">// Calculate hash signature of key</span>
    <span class="n">pfnEqualKeys</span><span class="p">,</span>    <span class="c1">// Compare two keys</span>
    <span class="n">pfnAddRefRecord</span><span class="p">,</span> <span class="c1">// AddRef in FindKey, etc</span>
    <span class="mi">4</span><span class="p">.</span><span class="mi">0</span><span class="p">,</span>             <span class="c1">// Bound on the average chain length.</span>
    <span class="mi">1</span><span class="p">,</span>               <span class="c1">// Initial size of hash table.</span>
    <span class="mi">0</span><span class="p">,</span>               <span class="c1">// Number of subordinate hash tables.</span>
    <span class="mi">0</span>                <span class="c1">// Allow multiple identical keys?</span>
<span class="p">);</span>
</code></pre></div></div>

<p>Because “Logon” is an expensive operation, to improve the performance, IIS cached all tokens for password-based authentications, such as Basic Authentication by default, and the bug we found this time is located in the logic of the key-comparing function when a collision occurs.</p>

<p>If a login attempt whose hash hits a key that is already in the cache, LKRHash enters the application-specific <code class="language-plaintext highlighter-rouge">pfnEqualKeys</code> function to determine whether the key is correct or not. The application-specific logic of <code class="language-plaintext highlighter-rouge">TokenCacheModule</code> is as follows:</p>

<p><img src="/assets/img/blog/20220818/1.png" alt="" /></p>

<p>As the logic compares several parts to make the decision, it’s weird why IIS compares the username twice.</p>

<p>I guess the original intent was to compare the password. However, the developer copy-and-pasted the code but forgot to replace the variable name. That leads to that <strong>an attacker can reuse another user’s logged-in token with random passwords</strong>.</p>

<p>To build the smallest PoC to test your own, you can create a testing account and configure the Basic Authentication on your IIS.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># add a test account, please ensure to remove that after testing</span>
<span class="o">&gt;</span> net user orange test-for-CVE-2022-30209-auth-bypass /add

<span class="c"># the source of login is not important, this can be done outside IIS.</span>
<span class="o">&gt;</span> curl <span class="nt">-I</span> <span class="nt">-su</span> <span class="s1">'orange:test-for-CVE-2022-30209-auth-bypass'</span> <span class="s1">'http://&lt;iis&gt;/protected/'</span> | findstr HTTP
HTTP/1.1 200 OK
</code></pre></div></div>

<p>Under the attacker’s terminal:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># script for sanity check</span>
<span class="o">&gt;</span> <span class="nb">type </span>test.py
def HashString<span class="o">(</span>password<span class="o">)</span>:
    j <span class="o">=</span> 0
    <span class="k">for </span>c <span class="k">in </span>map<span class="o">(</span>ord, password<span class="o">)</span>:
        j <span class="o">=</span> c + <span class="o">(</span>101<span class="k">*</span>j<span class="o">)</span>&amp;0xffffffff
    <span class="k">return </span>j

assert HashString<span class="o">(</span><span class="s1">'test-for-CVE-2022-30209-auth-bypass'</span><span class="o">)</span> <span class="o">==</span> HashString<span class="o">(</span><span class="s1">'ZeeiJT'</span><span class="o">)</span>

<span class="c"># before the successful login</span>
<span class="o">&gt;</span> curl <span class="nt">-I</span> <span class="nt">-su</span> <span class="s1">'orange:ZeeiJT'</span> <span class="s1">'http://&lt;iis&gt;/protected/'</span> | findstr HTTP
HTTP/1.1 401 Unauthorized

<span class="c"># after the successful login</span>
<span class="o">&gt;</span> curl <span class="nt">-I</span> <span class="nt">-su</span> <span class="s1">'orange:ZeeiJT'</span> <span class="s1">'http://&lt;iis&gt;/protected/'</span> | findstr HTTP
HTTP/1.1 200 OK
</code></pre></div></div>

<p>As you can see, the attacker can log into the user <code class="language-plaintext highlighter-rouge">orange</code> with another password whose hash is the same as the original one.</p>

<p>However, it’s not easy to collide the hash. The probability of each attempt is only worth 1/2^32 because the hash is a 32-Bit Integer, and the attacker has no way to know the hash of existing cache keys. It’s a ridiculous number to make exploiting this bug like playing a lottery. The only pro is that the attempt costs nothing, and you have unlimited tries!</p>

<p>To make this bug more practical, we proposed several ways to win the lottery, such as:</p>

<ol>
  <li>Increase the odds of the collision - LKRHash combined LCGs to scramble the result to make the hash more random. However, we can lower the key space because the LCG is not one-to-one mapping under the 32-Bit Integer. There must be results that will never appear so that we can pre-compute a dictionary that excludes the password whose hash is not in the results and <strong>increase the success rate by 13% at least</strong>!</li>
  <li>Regain the initiative - By understanding the root cause, we brainstorm several use cases that <strong>can cache the token in memory forever and no longer wait for user interaction</strong>, such as the IIS feature <a href="https://docs.microsoft.com/en-us/troubleshoot/developer/webapps/iis/www-authentication-authorization/understanding-identities">Connect As</a> or leveraging software design patterns.</li>
</ol>

<p>We have also proved this attack works naturally on Microsoft Exchange Server. By leveraging the default activated <code class="language-plaintext highlighter-rouge">Exchange Active Monitoring</code> service, we can enter <code class="language-plaintext highlighter-rouge">HealthMailbox</code>’s mailbox without passwords! This authentication-less account hijacking is useful for further exploitations such as phishing or chaining another post-auth RCE together!</p>

<p><img src="/assets/img/blog/20220818/2.png" alt="" /></p>

<h1 id="timeline">Timeline</h1>

<ul>
  <li>Mar 16, 2022 - We reported the IIS Cache Poisoning to Microsoft through the MSRC portal.</li>
  <li>Apr 09, 2022 - We reported the IIS Hash-Flooding DoS to Microsoft through the MSRC portal.</li>
  <li>Apr 10, 2022 - We reported the IIS Authentication Bypass to Microsoft through the MSRC portal.</li>
  <li>Jul 12, 2022 - Microsoft fixed everything at July’s Patch Tuesday.</li>
</ul>


                    </div>
                    <!-- 文章內容 -->
                </div>
            </article>
            <!-- 文章 end -->
        </section>
        
         <!-- 作者 -->
        <section>
            <div class="container article_footer">
                <div class="author_info">
                    <a href="/en/blog/author/orange">
                        <div class="circle" style="background-image: url(/assets/img/avatar/orig/orange.png);"></div>
                    </a>
                    <div>
                        <a class="author" href="/en/blog/author/orange">
                            <h3>Orange Tsai</h3>
                        </a>
                        <span>Principal Security Researcher</span>
                        <p>
                            I am Orange : )
                        </p>
                    </div>
                </div>
            </div>
        </section>
        

    </div>

    <!-- footer -->
    <footer>
<div class="container footer">
    <div class="logo">
        <a href="/en/">
            <img src="/images/logo.svg"/>
        </a>
        <div class="social">
            <a href="https://www.facebook.com/D3VC0RE"><i class="icon facebook"></i></a>
            <a href="https://twitter.com/d3vc0r3"><i class="icon twitter"></i></a>
        </div>
    </div>

    <div class="column">
        <h6 class="mobile_toggle">Services</h6>
        <ul>
            <li><a href="/en/services/red-team/">Red Team Assessment</a></li>
            <li><a href="/en/services/penetration-test/">Penetration Testing</a></li>
            <li><a href="/en/services/security-consulting/">Security Consulting</a></li>
            <li><a href="/en/services/security-training/">Security Training</a></li>
        </ul>
    </div>

    <div class="column">
        <h6 class="mobile_toggle">Research</h6>
        <ul>
            <li><a href="/en/research/overview/">Overview</a></li>
            <li><a href="/en/research/awards/">Competitions and Awards</a></li>
            <li><a href="/en/research/bug-bounty/">Enterprise Vulnerability Reports</a></li>
            <li><a href="/en/research/talks/">International Conferences</a></li>
            <li><a href="/en/research/cve/">CVE List</a></li>
        </ul>
    </div>

    <div class="column">
        <h6 class="mobile_toggle">Company</h6>
        <ul>
            <li><a href="/en/company/about/">Company Overview</a></li>
            <li><a href="/en/company/our-team/">Team Members</a></li>
            <li><a href="/en/company/history/">Achievements</a></li>
            <li><a href="/en/company/csr/">Corporate Social Responsibility</a></li>
            <li><a href="/en/company/jobs/">Job Opportunities</a></li>
            <li><a href="/en/contact/">Contact</a></li>
        </ul>
    </div>

    <div class="column">
        <h6 class="mobile_toggle">News</h6>
        <ul>
            <li><a href="/en/blog/">Blog</a></li>
            <li><a href="/en/media-kit/">Media Resources</a></li>
        </ul>
    </div>

    <!-- divider 分隔線 -->
    <div class="divider"></div>

    <div class="copyright">
        <div class="info">
            <span>© 2023 DEVCORE <b class="line-block">All right reserved.</b></span>
            <span><a href="/en/privacy-policy/">Privacy Policy</a></span>
        </div>
        <div class="lang">
            <!-- <i class="icon translate"></i>
            <select>
                <option value="">Language</option>
                <option value="">中文</option>
                <option value="">English</option>
            </select> -->
            <span>Language :<a href="/">中文</a>|<a href="/en/">English</a></span>
        </div>
    </div>

</div>
    </footer>
</body>
</html>










